<?xml version="1.0" encoding="ISO-8859-1"?>

<!--
W3C rules retrieved from:
http://www.w3.org/TR/html401/struct/global.html
-->
<anti-samy-rules>
    <directives>
        <directive name="omitXmlDeclaration" value="true"/>
        <directive name="omitDoctypeDeclaration" value="true"/>
        <directive name="useXHTML" value="false"/>
        <directive name="formatOutput" value="false"/>
        <directive name="embedStyleSheets" value="false"/>
        <directive name="embedStyleSheets" value="false"/>
        <directive name="maxInputSize" value="5000000" />
    </directives>

    <common-regexps>
        <!--
            From W3C:
            This attribute assigns a class name or set of class names to an
            element. Any number of elements may be assigned the same class
            name or names. Multiple class names must be separated by white
            space characters.
        -->
        <regexp name="onsiteURL" value="^(?![\p{L}\p{N}\\\.\#@\$%\+&amp;;\-_~,\?=/!]*(&amp;colon))[\p{L}\p{N}\\\.\#@\$%\+&amp;;\-_~,\?=/!]*"/>
        <regexp name="offsiteURL" value="(\s)*((ht|f)tp(s?)://|mailto:)[\p{L}\p{N}]+[~\p{L}\p{N}\p{Zs}\-_\.@\#\$%&amp;;:,\?=/\+!\(\)]*(\s)*"/>
    </common-regexps>

    <tag-rules>
        <!-- rich text -->

        <tag name="div" action="validate"/>
        <tag name="i" action="validate"/>
        <tag name="b" action="validate"/>
        <tag name="em" action="validate"/>
        <tag name="blockquote" action="validate"/>
        <tag name="tt" action="validate"/>
        <tag name="strong" action="validate"/>
        <tag name="span" action="validate">
            <attribute name="class">
                <regexp-list>
                    <regexp value=".*"/>
                </regexp-list>
            </attribute>
        </tag>

        <tag name="br" action="validate"/>

        <tag name="quote" action="validate"/>
        <tag name="ecode" action="validate"/>


        <tag name="a" action="validate">
            <attribute name="href">
                <regexp-list>
                    <regexp value=".*"/>
                </regexp-list>
            </attribute>
            <attribute name="nohref">
                <regexp-list>
                    <regexp value=".*"/>
                </regexp-list>
            </attribute>
            <attribute name="rel">
                <regexp-list>
                    <regexp value=".*"/>
                </regexp-list>
            </attribute>
            <attribute name="target">
                <regexp-list>
                    <regexp value=".*"/>
                </regexp-list>
            </attribute>

        </tag>

        <tag name="ul" action="validate"/>
        <tag name="ol" action="validate"/>
        <tag name="li" action="validate"/>
        <tag name="u"  action="validate">
            <attribute name="class">
                <regexp-list>
                    <regexp value=".*"/>
                </regexp-list>
            </attribute>
        </tag>
        <tag name="h1"  action="validate">
            <attribute name="class">
                <regexp-list>
                    <regexp value=".*"/>
                </regexp-list>
            </attribute>
        </tag>
        <tag name="h2"  action="validate">
            <attribute name="class">
                <regexp-list>
                    <regexp value=".*"/>
                </regexp-list>
            </attribute>
        </tag>
        <tag name="h3"  action="validate">
            <attribute name="class">
                <regexp-list>
                    <regexp value=".*"/>
                </regexp-list>
            </attribute>
        </tag>
        <tag name="h4"  action="validate">
            <attribute name="class">
                <regexp-list>
                    <regexp value=".*"/>
                </regexp-list>
            </attribute>
        </tag>
        <tag name="h5"  action="validate">
            <attribute name="class">
                <regexp-list>
                    <regexp value=".*"/>
                </regexp-list>
            </attribute>
        </tag>
        <tag name="h6"  action="validate">
            <attribute name="class">
                <regexp-list>
                    <regexp value=".*"/>
                </regexp-list>
            </attribute>
        </tag>


        <!-- workflow tags -->

        <tag name="workflow" action="validate"/>
        <tag name="parameter" action="validate">
            <attribute name="name">
                <regexp-list>
                    <regexp value=".*"/>
                </regexp-list>
            </attribute>
            <attribute name="type">
                <regexp-list>
                    <regexp value=".*"/>
                </regexp-list>
            </attribute>
        </tag>
        <tag name="expression" action="validate">
            <attribute name="name">
                <regexp-list>
                    <regexp value=".*"/>
                </regexp-list>
            </attribute>
        </tag>
        <tag name="module" action="validate">
            <attribute name="name">
                <regexp-list>
                    <regexp value=".*"/>
                </regexp-list>
            </attribute>
        </tag>
        <tag name="criteria" action="validate">
            <attribute name="pattern">
                <regexp-list>
                    <regexp value=".*"/>
                </regexp-list>
            </attribute>
        </tag>
        <tag name="condition" action="validate">
            <attribute name="sequence">
                <regexp-list>
                    <regexp value=".*"/>
                </regexp-list>
            </attribute>
        </tag>
        <tag name="field" action="validate">
            <attribute name="name">
                <regexp-list>
                    <regexp value=".*"/>
                </regexp-list>
            </attribute>
            <attribute name="aggregate">
                <regexp-list>
                    <regexp value=".*"/>
                </regexp-list>
            </attribute>
        </tag>
        <tag name="orderBy" action="validate">
            <attribute name="name">
                <regexp-list>
                    <regexp value=".*"/>
                </regexp-list>
            </attribute>
            <attribute name="sort">
                <regexp-list>
                    <regexp value=".*"/>
                </regexp-list>
            </attribute>
        </tag>
        <tag name="sort" action="validate"/>
        <tag name="limit" action="validate"/>
        <tag name="groupBy" action="validate"/>
        <tag name="function" action="validate"/>
        <tag name="constant" action="validate"/>
        <tag name="expr" action="validate"/>
        <tag name="print" action="validate"/>
        <tag name="iterator" action="validate">
            <attribute name="var">
                <regexp-list>
                    <regexp value=".*"/>
                </regexp-list>
            </attribute>
        </tag>
        <tag name="conditions" action="validate"/>
        <tag name="if" action="validate">
            <attribute name="criteria">
                <regexp-list>
                    <regexp value=".*"/>
                </regexp-list>
            </attribute>
        </tag>
        <tag name="elseif" action="validate">
            <attribute name="criteria">
                <regexp-list>
                    <regexp value=".*"/>
                </regexp-list>
            </attribute>
        </tag>
        <tag name="else" action="validate" />
        <tag name="result" action="validate"/>

        <!-- tag used in /api/errors -->
        <tag name="anonymous" action="validate" />
    </tag-rules>

    <allowed-empty-tags>
        <literal-list>
            <literal value="br"/>
            <literal value="hr"/>
            <literal value="a"/>
            <literal value="img"/>
        </literal-list>
    </allowed-empty-tags>

</anti-samy-rules>