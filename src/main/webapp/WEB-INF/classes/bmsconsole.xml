<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE struts PUBLIC
    "-//Apache Software Foundation//DTD Struts Configuration 2.5//EN"
    "http://struts.apache.org/dtds/struts-2.5.dtd">

<struts>

	<package name="home" strict-method-invocation="false" namespace="/home"  extends="struts-default,json-default">
		<result-types>
			<result-type name="tiles"
				class="org.apache.struts2.views.tiles.TilesResult" />
		</result-types>
		<interceptors>
			<interceptor name="authinterceptor"
				class="com.facilio.bmsconsole.interceptors.AuthInterceptor" />
			<interceptor-stack name="defaultInterceptor">
				<interceptor-ref name="defaultStack" />
				<interceptor-ref name="authinterceptor" />
				<interceptor-ref name="json">
					<param name="enableSMD">true</param>
				</interceptor-ref>
			</interceptor-stack>
		</interceptors>

		<default-interceptor-ref name="defaultInterceptor" />
		<global-results>
			<result name="login" type="redirect">
				<param name="location">/login</param>
				<param name="parse">false</param>
			</result>
			<result name="unauthorized" type="redirect">
				<param name="location">/jsps/unauthorized.jsp</param>
				<param name="parse">false</param>
			</result>
		</global-results>

  	<action name="index" class="com.facilio.bmsconsole.actions.HomePageActions">
            <result  type="tiles">homepage</result>
        </action>
     	<action name="*menu" class="com.facilio.bmsconsole.actions.HomePageActions" method="{1}">
            <result  type="tiles">homepage</result>
            <allowed-methods>showCalendar</allowed-methods>
        </action>     
    <action name="calendar" class="com.facilio.bmsconsole.actions.CalendarAction" method="show">
    	<result name="success">/jsps/calendar.jsp</result>
    </action> 
    <action name="centraldispatch" class="com.facilio.bmsconsole.actions.CalendarAction" method="centraldispatch">
    	<result name="success">/jsps/centraldispatch.jsp</result>
    </action>     
    <action name="certificate" class="com.facilio.bmsconsole.actions.Certificate">
    </action>
    <action name="controller" class="com.facilio.bmsconsole.actions.DeviceAction" method="show">
    	<result name="success">/jsps/device.jsp</result>
    </action>
    <action name="newDevice" class="com.facilio.bmsconsole.actions.DeviceAction" method="showAdd">
    	<result name="success">/jsps/newdevice.jsp</result>
    </action>
    <action name="addController" class="com.facilio.bmsconsole.actions.DeviceAction" method="add">
    </action>
    <action name="downloadAgent" class="com.facilio.bmsconsole.actions.DeviceAction" method="downloadAgent">
    </action>
    <action name="showDeviceData" class="com.facilio.bmsconsole.actions.DeviceAction" method="showDeviceData">
    	<result name="success">/jsps/devicedata.jsp</result>
    </action>
    <action name="showTree" class="com.facilio.bmsconsole.actions.DeviceAction" method="showTree">
    </action>
    <action name="showDevices" class="com.facilio.bmsconsole.actions.DeviceAction" method="showDevices">
    	<result name="success">/jsps/devicetree.jsp</result>
    </action>
    <action name="showConfigureDevice" class="com.facilio.bmsconsole.actions.DeviceAction" method="showConfigureDevice">
    	<result name="success">/jsps/deviceconf.jsp</result>
    </action>
    <action name="configureDevice" class="com.facilio.bmsconsole.actions.DeviceAction" method="configureDevice">
    </action>
    <action name="enableDeviceMonitoring" class="com.facilio.bmsconsole.actions.DeviceAction" method="enableDeviceMonitoring">
    </action>
     <action name="disableDeviceMonitoring" class="com.facilio.bmsconsole.actions.DeviceAction" method="disableDeviceMonitoring">
    </action>
	<action name="addDevice" class="com.facilio.bmsconsole.actions.DeviceAction" method="addDevice">
    </action>
    <action name="rearrangeDevices" class="com.facilio.bmsconsole.actions.DeviceAction" method="rearrangeDevices">
    </action>
    <action name="updateControllerInstances" class="com.facilio.bmsconsole.actions.DeviceAction" method="updateControllerInstances">
    </action>
    
   	<action name="admin" class="com.facilio.bmsconsole.actions.AdminAction" method="show">
		<result name="success">/jsps/admin.jsp</result>
	</action>
    
    <action name="users" class="com.facilio.bmsconsole.actions.UserAction" method="userList">
		<result name="success">/jsps/usersList.jsp</result>
	</action>
	
    <action name="groups" class="com.facilio.bmsconsole.group.actions.GroupListAction">
		<result name="success">/jsps/groups/groupsList.jsp</result>
	</action>

	<action name="ticket" class="com.facilio.bmsconsole.actions.TicketAction" method="ticketList">
		<result name="success">/jsps/listview.jsp</result>
	</action>
	
	<action name="task" class="com.facilio.bmsconsole.actions.TaskAction" method="taskList">
		<result name="success">/jsps/listview.jsp</result>
	</action>
	
	<action name="campus" class="com.facilio.bmsconsole.actions.CampusAction" method="campusList">
		<result name="success">/jsps/listview.jsp</result>
	</action>
	
	<action name="building" class="com.facilio.bmsconsole.actions.BuildingAction" method="buildingList">
		<result name="success">/jsps/listview.jsp</result>
	</action>
	
	<action name="floor" class="com.facilio.bmsconsole.actions.FloorAction" method="floorList">
		<result name="success">/jsps/listview.jsp</result>
	</action>
	
	<action name="space" class="com.facilio.bmsconsole.actions.SpaceAction" method="spaceList">
		<result name="success">/jsps/listview.jsp</result>
	</action>
	
	<action name="zone" class="com.facilio.bmsconsole.actions.ZoneAction" method="zoneList">
		<result name="success">/jsps/listview.jsp</result>
	</action>
	
	<action name="reports" class="com.facilio.bmsconsole.actions.ReportActions">
        <result name="success">/jsps/reports.jsp</result>
    </action>
    
	<action name="locations" class="com.facilio.bmsconsole.actions.LocationActions">
        <result name="success">/jsps/locations.jsp</result>
    </action>
    
    <action name="skills" class="com.facilio.bmsconsole.actions.SkillActions">
        <result name="success">/jsps/skills.jsp</result>
    </action>
    
	<action name="rules" class="com.facilio.bmsconsole.actions.WorkflowRuleActions">
        <result name="success">/jsps/assignmentRules.jsp</result>
    </action>
	</package>
	<package name="modules" namespace="/home/modules" extends="home">
		<action name="newCustomField" class="com.facilio.bmsconsole.actions.NewCFAction">
			<result name="success">/jsps/newCFs.jsp</result>
		</action>
		
		<action name="addCF" class="com.facilio.bmsconsole.actions.AddCFAction">
			<result name="success" type="json">
				<param name="includeProperties">fieldIds</param>
			</result>
		</action>
	</package>

	<package name="controllers" namespace="/home/controller" extends="home">
		<action name="*" class="com.facilio.bmsconsole.actions.DeviceAction" method="showDeviceInfo">
    		<result name="success">/jsps/deviceinfo.jsp</result>
    	</action>
    </package>
    
    <package name="admin" namespace="/home/admin" extends="home">
		<action name="addJob" class="com.facilio.bmsconsole.actions.AdminAction" method="addJob">
    	</action>
    	<action name="deleteJob" class="com.facilio.bmsconsole.actions.AdminAction" method="deleteJob">
    	</action>
		<action name="jobs" class="com.facilio.bmsconsole.actions.AdminAction" method="jobs">
    		<result name="success">/jsps/adminjobs.jsp</result>
    	</action>
    </package>

	<package name="ticket" namespace="/home/ticket" extends="home">
		<action name="new" class="com.facilio.bmsconsole.actions.TicketAction" method="newTicket">
			<result name="success">/jsps/newForm.jsp</result>
			<result name="ajaxsuccess">/jsps/newForm.jsp</result>
		</action>

		<action name="add" class="com.facilio.bmsconsole.actions.TicketAction" method="addTicket">
			<result name="success" type="json">
				<param name="includeProperties">ticketId</param>
			</result>
		</action>

		<action name="*" class="com.facilio.bmsconsole.actions.TicketAction" method="ticketList">
			<param name="viewName">{1}</param>
			<result name="success">/jsps/listview.jsp</result>
		</action>
	</package>
	
	<package name="ticketSummary" namespace="/home/ticket/summary" extends="ticket">
		<action name="*" class="com.facilio.bmsconsole.actions.TicketAction" method="viewTicket">
			<param name="ticketId">{1}</param>
			<result name="success">/jsps/viewTicket.jsp</result>
		</action>
	</package>
	
	<package name="attachment" namespace="/home/attachment" extends="home">
		<action name="add" class="com.facilio.bmsconsole.actions.AttachmentAction" method="addAttachment">
			<result name="success" type="json">
				<param name="includeProperties">^attachmentId\[\d+\]</param>
			</result>
		</action>
		
		<action name="delete" class="com.facilio.bmsconsole.actions.AttachmentAction" method="deleteAttachment">
			<result name="success" type="json">
				<param name="includeProperties">^attachmentId\[\d+\]</param>
			</result>
		</action>
		
		<action name="view" class="com.facilio.bmsconsole.actions.AttachmentAction" method="viewAttachment">
			<result name="success" type="stream">
		      <param name="contentType">${fileInfo.contentType}</param>
		      <param name="inputName">downloadStream</param>
		      <param name="contentDisposition">attachment;filename="${fileInfo.fileName}"</param>
		      <param name="contentLength">${fileInfo.fileSize}</param>
		      <param name="bufferSize">4096</param>
		    </result>
		    <result name="error">/jsps/viewAttachmentError.jsp</result>
		</action>
	</package>
	
	<package name="task" namespace="/home/task" extends="home">
		<action name="new" class="com.facilio.bmsconsole.actions.TaskAction" method="newTask">
			<result name="success">/jsps/newForm.jsp</result>
		</action>

		<action name="add" class="com.facilio.bmsconsole.actions.TaskAction" method="addTask">
			<result name="success" type="json">
				<param name="includeProperties">taskId</param>
			</result>
		</action>
		
		<action name="addNote" class="com.facilio.bmsconsole.actions.TaskNotes" method="addNote">
			<result name="success" type="json">
				<param name="includeProperties">note.noteId</param>
			</result>
		</action>
		
		<action name="*" class="com.facilio.bmsconsole.actions.TaskAction" method="taskList">
			<param name="viewName">{1}</param>
			<result name="success">/jsps/listview.jsp</result>
		</action>
	</package>
	
	<package name="taskSummary" namespace="/home/task/summary" extends="task">
		<action name="*" class="com.facilio.bmsconsole.actions.TaskAction" method="viewTask">
			<param name="taskId">{1}</param>
			<result name="success">/jsps/viewTask.jsp</result>
		</action>
	</package>
	
	<package name="rules" namespace="/home/rules" extends="home">
		<action name="*" class="com.facilio.bmsconsole.actions.WorkflowRuleActions" method="{1}">
			<result name="assignmentRules">/jsps/rules/assignmentRules.jsp</result>
			<result name="newAssignmentRule">/jsps/rules/newAssignmentRule.jsp</result>
			<result name="addAssignmentRuleSuccess" type="json">
				<param name="includeProperties">ruleId</param>
			</result>
			<allowed-methods>assignmentRules,newAssignmentRule,addAssignmentRule,businessRules</allowed-methods>
		</action>
	</package>
	
	<package name="locations" namespace="/home/locations" extends="home">
		<action name="popup" class="com.facilio.bmsconsole.actions.LocationActions">
			<result name="success">/jsps/locationsPopup.jsp</result>
		</action>
		<action name="*" class="com.facilio.bmsconsole.actions.LocationActions" method="{1}">
			<result name="new_location">/jsps/newLocation.jsp</result>
			<result name="add_location_success" type="json">
				<param name="includeProperties">locationId</param>
			</result>
			<allowed-methods>create,add</allowed-methods>
		</action>
	</package>
	
	<package name="skills" namespace="/home/skills" extends="home">
		<action name="*" class="com.facilio.bmsconsole.actions.SkillActions" method="{1}">
			<result name="add_skill_success" type="json">
				<param name="includeProperties">skillId</param>
			</result>
			<allowed-methods>add</allowed-methods>
		</action>
	</package>
	
	<package name="users" namespace="/home/users" extends="home">
		<action name="popup" class="com.facilio.bmsconsole.actions.UserAction" method="userList">
			<result name="success">/jsps/usersListPopup.jsp</result>
		</action>
		
		<action name="new" class="com.facilio.bmsconsole.actions.NewUserAction">
			<result name="success">/jsps/inviteUser.jsp</result>
		</action>

		<action name="save" class="com.facilio.bmsconsole.actions.AddUserAction">
			<result name="success" type="json">
				<param name="includeProperties">userId</param>
			</result>
			<result name="error" type="json">
				<param name="statusCode">500</param>
				<param name="ignoreHierarchy">false</param>
				<param name="includeProperties">^actionErrors.*,^fieldErrors.*</param>
			</result>
		</action>
		
		<action name="update" class="com.facilio.bmsconsole.actions.AddUserAction">
			<result name="success" type="json">
				<param name="includeProperties">userId</param>
			</result>
			<result name="error" type="json">
				<param name="statusCode">500</param>
				<param name="ignoreHierarchy">false</param>
				<param name="includeProperties">^actionErrors.*,^fieldErrors.*</param>
			</result>
		</action>
		
		<action name="resetpassword" class="com.facilio.bmsconsole.actions.AddUserAction">
			<result name="success" type="json">
				<param name="includeProperties">userId</param>
			</result>
			<result name="error" type="json">
				<param name="statusCode">500</param>
				<param name="ignoreHierarchy">false</param>
				<param name="includeProperties">^actionErrors.*,^fieldErrors.*</param>
			</result>
		</action>

		<action name="*" class="com.facilio.bmsconsole.actions.ViewUserAction">
			<param name="userId">{1}</param>
			<result name="success">/jsps/viewUser.jsp</result>
		</action>
		
		<action name="edit" class="com.facilio.bmsconsole.actions.EditUserAction">
			<result name="success">/jsps/editUser.jsp</result>
		</action>
	</package>
	
	<package name="groups" namespace="/home/groups" extends="home">
		<action name="new" class="com.facilio.bmsconsole.group.actions.NewGroupAction">
			<result name="success">/jsps/groups/newGroup.jsp</result>
		</action>

		<action name="save" class="com.facilio.bmsconsole.group.actions.AddGroupAction">
			<result name="success" type="json">
				<param name="includeProperties">groupId</param>
			</result>
			<result name="error" type="json">
				<param name="statusCode">500</param>
				<param name="ignoreHierarchy">false</param>
				<param name="includeProperties">^actionErrors.*,^fieldErrors.*</param>
			</result>
		</action>
		
		<action name="update" class="com.facilio.bmsconsole.group.actions.AddGroupAction">
			<result name="success" type="json">
				<param name="includeProperties">groupId</param>
			</result>
			<result name="error" type="json">
				<param name="statusCode">500</param>
				<param name="ignoreHierarchy">false</param>
				<param name="includeProperties">^actionErrors.*,^fieldErrors.*</param>
			</result>
		</action>
		
		<action name="delete" class="com.facilio.bmsconsole.group.actions.AddGroupAction">
			<result name="success" type="json">
				<param name="statusCode">200</param>
				<param name="status">deleted</param>
			</result>
			<result name="error" type="json">
				<param name="statusCode">500</param>
				<param name="ignoreHierarchy">false</param>
				<param name="includeProperties">^actionErrors.*,^fieldErrors.*</param>
			</result>
		</action>
		
		<action name="getGroupMembers" class="com.facilio.bmsconsole.group.actions.GetGroupMembersAction">
			<result name="success" type="json">
				<param name="root">members</param>
			</result>
		</action>

		<action name="*" class="com.facilio.bmsconsole.group.actions.ViewGroupAction">
			<param name="groupId">{1}</param>
			<result name="success">/jsps/groups/viewGroup.jsp</result>
		</action>
		
		<action name="edit" class="com.facilio.bmsconsole.group.actions.EditGroupAction">
			<result name="success">/jsps/groups/editGroup.jsp</result>
		</action>
	</package>
	
	<package name="internal" namespace="/internal"
		extends='struts-default,tiles-default,json-default'>
		<action name="addFromMail"
			class="com.facilio.bmsconsole.actions.SupportMailParseAction">
			<interceptor-ref name="defaultStack" />
			<interceptor-ref name="json">
				<param name="enableSMD">true</param>
			</interceptor-ref>
			<result name="success" type="json">
				<param name="includeProperties">ticketId</param>
			</result>
		</action>
	</package>

	<package name="login" namespace="/" extends='struts-default,tiles-default'>
		<action name="login" class="com.facilio.bmsconsole.actions.LoginAction" method="login">
			<result name="loginpage">/jsps/login.jsp</result>
			<result name="loginsuccess">/jsps/loginSuccess.jsp</result>
			<result name="samlresponse">/jsps/samlLoginSuccess.jsp</result>
		</action>
		<action name="logout" class="com.facilio.bmsconsole.actions.LoginAction" method="logout">
			<result>/jsps/logout.jsp</result>
		</action>
	</package>
	
	<package name="unauth" namespace="/login" extends='struts-default,tiles-default'>
		<action name="validate" class="com.facilio.bmsconsole.actions.LoginAction" method="validateLogin">
			<result>/jsps/validateLogin.jsp</result>
		</action>
	<action name="signup" class="com.facilio.bmsconsole.actions.LoginAction" method="signup">
			<result>/jsps/validateLogin.jsp</result>
		</action>

	</package>
	
	<package name="campus" namespace="/home/campus" extends="home">
		<action name="popup" class="com.facilio.bmsconsole.actions.CampusAction" method="campusList">
			<result name="success">/jsps/campusListPopup.jsp</result>
		</action>
		
		<action name="new" class="com.facilio.bmsconsole.actions.CampusAction" method="newCampus">
			<result name="success">/jsps/newForm.jsp</result>
			<result name="ajaxsuccess">/jsps/newForm.jsp</result>
		</action>

		<action name="add" class="com.facilio.bmsconsole.actions.CampusAction" method="addCampus">
			<result name="success" type="json">
				<param name="includeProperties">campusId</param>
			</result>
		</action>

		<action name="*" class="com.facilio.bmsconsole.actions.CampusAction" method="viewCampus">
			<param name="campusId">{1}</param>
			<result name="success">/jsps/viewCampus.jsp</result>
		</action>
	</package>
	
	<package name="building" namespace="/home/building" extends="home">
		<action name="popup" class="com.facilio.bmsconsole.actions.BuildingAction" method="buildingList">
			<result name="success">/jsps/buildingListPopup.jsp</result>
		</action>
		
		<action name="new" class="com.facilio.bmsconsole.actions.BuildingAction" method="newBuilding">
			<result name="success">/jsps/newForm.jsp</result>
			<result name="ajaxsuccess">/jsps/newForm.jsp</result>
		</action>

		<action name="add" class="com.facilio.bmsconsole.actions.BuildingAction" method="addBuilding">
			<result name="success" type="json">
				<param name="includeProperties">buildingId</param>
			</result>
		</action>

		<action name="*" class="com.facilio.bmsconsole.actions.BuildingAction" method="viewBuilding">
			<param name="buildingId">{1}</param>
			<result name="success">/jsps/viewBuilding.jsp</result>
		</action>
	</package>
	
	<package name="floor" namespace="/home/floor" extends="home">
		<action name="popup" class="com.facilio.bmsconsole.actions.FloorAction" method="floorList">
			<result name="success">/jsps/floorListPopup.jsp</result>
		</action>
		
		<action name="new" class="com.facilio.bmsconsole.actions.FloorAction" method="newFloor">
			<result name="success">/jsps/newForm.jsp</result>
			<result name="ajaxsuccess">/jsps/newForm.jsp</result>
		</action>

		<action name="add" class="com.facilio.bmsconsole.actions.FloorAction" method="addFloor">
			<result name="success" type="json">
				<param name="includeProperties">floorId</param>
			</result>
		</action>

		<action name="*" class="com.facilio.bmsconsole.actions.FloorAction" method="viewFloor">
			<param name="floorId">{1}</param>
			<result name="success">/jsps/viewFloor.jsp</result>
		</action>
	</package>
	
	<package name="space" namespace="/home/space" extends="home">
		<action name="new" class="com.facilio.bmsconsole.actions.SpaceAction" method="newSpace">
			<result name="success">/jsps/newForm.jsp</result>
			<result name="ajaxsuccess">/jsps/newForm.jsp</result>
		</action>

		<action name="add" class="com.facilio.bmsconsole.actions.SpaceAction" method="addSpace">
			<result name="success" type="json">
				<param name="includeProperties">spaceId</param>
			</result>
		</action>

		<action name="*" class="com.facilio.bmsconsole.actions.SpaceAction" method="viewSpace">
			<param name="spaceId">{1}</param>
			<result name="success">/jsps/viewSpace.jsp</result>
		</action>
	</package>
	
	<package name="zone" namespace="/home/zone" extends="home">
		<action name="new" class="com.facilio.bmsconsole.actions.ZoneAction" method="newZone">
			<result name="success">/jsps/newForm.jsp</result>
			<result name="ajaxsuccess">/jsps/newForm.jsp</result>
		</action>

		<action name="add" class="com.facilio.bmsconsole.actions.ZoneAction" method="addZone">
			<result name="success" type="json">
				<param name="includeProperties">zoneId</param>
			</result>
		</action>

		<action name="*" class="com.facilio.bmsconsole.actions.ZoneAction" method="viewZone">
			<param name="zoneId">{1}</param>
			<result name="success">/jsps/viewZone.jsp</result>
		</action>
	</package>
</struts>
