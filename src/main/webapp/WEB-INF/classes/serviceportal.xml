<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE struts PUBLIC
    "-//Apache Software Foundation//DTD Struts Configuration 2.5//EN"
    "http://struts.apache.org/dtds/struts-2.5.dtd">

<struts>

	<package name="serviceportal" strict-method-invocation="false" namespace="/api/service"  extends="struts-default,json-default">
		<result-types>
			<result-type name="tiles"
				class="org.apache.struts2.views.tiles.TilesResult" />
		</result-types>
		<interceptors>
			<interceptor name="portalinterceptor"
				class="com.facilio.serviceportal.actions.PortalAuthInterceptor" />
			<interceptor-stack name="defaultInterceptor">
				<interceptor-ref name="defaultStack" />
				<interceptor-ref name="portalinterceptor" />
				<interceptor-ref name="json">
					<param name="enableSMD">true</param>
				</interceptor-ref>
			</interceptor-stack>
		</interceptors>

		<default-interceptor-ref name="defaultInterceptor" />
		<global-results>
			<result name="login">/service/login.jsp
			</result>
			<result name="unauthorized" type="redirect">
				<param name="location">/jsps/serviceportal/unauthorized.jsp</param>
				<param name="parse">false</param>
			</result>
			</global-results>

		
  	<action name="index" >
        <result>/service/index.jsp</result>
    </action>
		
		<action name="getrequests"
			class="com.facilio.bmsconsole.actions.WorkOrderRequestAction" method="viewWorkOrderRequest">
			<param name="moduleName">workorderrequest</param>
			<param name="permission">READ,READ_TEAM,READ_OWN</param>
			<result name="success" type="json">
				<param name="includeProperties">^workorderrequest.*</param>
			</result>
		</action>
        <action name="apisignup" class="com.facilio.auth.actions.FacilioAuthAction"
        method="signupPortalUser">
                <result name="success" type="json">
                        <param name="includeProperties">jsonresponse.*</param>
                </result>
				<result name="error" type="json">
					<param name="includeProperties">jsonresponse.*</param>
				</result>
        </action>
  
    <action name="login" class="com.facilio.auth.actions.FacilioAuthAction" method="validateLogin">
		<result name="samllogin">/service/samllogin.jsp</result>
		                <result name="success" type="json">
                        <param name="includeProperties">jsonresponse.*</param>
                </result>
				<result name="error" type="json">
			<param name="includeProperties">jsonresponse.*</param>
		</result>
		</action>
	
	<action name="faciliosubmit" class="com.facilio.auth.actions.FacilioAuthAction"
		method="validateLogin">
		<result name="success" type="json">
				<param name="includeProperties">jsonresponse.*</param>
		</result>
		<result name="error" type="json">
				<param name="includeProperties">jsonresponse.*</param>
		</result>

	</action>

        <action name="changePassword" class="com.facilio.auth.actions.FacilioAuthAction"
                method="changePortalPassword">
            <result name="success" type="json">
                <param name="includeProperties">jsonresponse.*</param>
            </result>
            <result name="error" type="json">
                <param name="includeProperties">jsonresponse.*</param>
            </result>
        </action>

        <action name="fresetPassword" class="com.facilio.auth.actions.FacilioAuthAction"
                method="resetPassword">
            <param name="auth">false</param>
            <result name="success" type="json">
                <param name="includeProperties">invitation.*</param>
            </result>
        </action>

		<action name="account" class="com.facilio.bmsconsole.actions.LoginAction"
				method="portalAccount">
			<result name="success" type="json">
				<param name="includeProperties">account.*</param>
			</result>
		</action>
		
		<action name="tenantuser" class="com.facilio.bmsconsole.actions.TenantAction" 
				method="tenantServicePortal">
			<result name="success" type="json">
				<param name="includeProperties">^item.*</param>
			</result>
		</action>
		
		<action name="meta" class="com.facilio.bmsconsole.actions.ModuleAction"
			method="metadata">
			<result name="success" type="json">
				<param name="enumAsBean">true</param>
				<param name="includeProperties">meta.*</param>
			</result>
		</action>
		
		<action name="uploadUserAvatar" class="com.facilio.bmsconsole.actions.UserAction"
			method="uploadUserAvatar">
			<result name="success" type="json">
				<param name="includeProperties">avatarUrl</param>
			</result>
		</action>
		<action name="deleteUserAvatar" class="com.facilio.bmsconsole.actions.UserAction"
			method="deleteUserAvatar">
			<result name="success" type="json">
				<param name="includeProperties">avatarUrl</param>
			</result>
		</action>

		<action name="updateProfile" class="com.facilio.bmsconsole.actions.UserAction" method="updateMyProfile">
			<result name="success" type="json">
			</result>
		</action>
   		<action name="samllogin" class="com.facilio.customerportal.actions.Authentication" method="samllogin">
   			<result>/service/samllogin.jsp</result>
		</action>

		<action name="addRequest"
				class="com.facilio.bmsconsole.actions.WorkOrderRequestAction" method="addWorkOrderRequest">
			<param name="moduleName">workorder</param>
			<param name="permission">CREATE</param>
			<result name="success" type="json">
				<param name="includeProperties">workOrderRequestId</param>
			</result>
		</action>

		<action name="myrequests" class="com.facilio.bmsconsole.actions.WorkOrderRequestAction" method="workOrderRequestList">
			<param name="viewName">myrequests</param>
			<result name="success" type="json">
				<param name="includeProperties">workOrderRequests,workOrderRequests\[\d+\],workOrderRequests\[\d+\].*</param>
			</result>
		</action>
		
		<action name="assets" class="com.facilio.bmsconsole.actions.AssetAction" method="assetList">
			<param name="moduleName">asset</param>
			<param name="permission">READ</param>
			<result name="success" type="json">
				<param name="includeProperties">assets,assets\[\d+\],assets\[\d+\].*</param>
			</result>
		</action>
		<action name="closeWorkorderRequest"
			class="com.facilio.bmsconsole.actions.WorkOrderRequestAction" method="closeWorkOrderRequest">
			<param name="permission">WORKORDER_CREATE</param>
			<result name="success" type="json">
				<param name="includeProperties">rowsUpdated</param>
			</result>
		</action>
		<action name="activities" class="com.facilio.bmsconsole.actions.WorkOrderRequestAction"
			method="getActivitiesList">
			<param name="moduleName">workorder</param>
			<param name="permission">READ,READ_TEAM,READ_OWN</param>
			<result name="success" type="json">
				<param name="root">activities</param>
			</result>
		</action> 
		<action name="attachment" class="com.facilio.bmsconsole.actions.AttachmentAction" method="attachmentList">
			<result name="success" type="json">
				<param name="includeProperties">attachments,attachments\[\d+\],attachments\[\d+\].*</param>
			</result>
		</action>
		<action name="notelist" class="com.facilio.bmsconsole.actions.NoteAction"
			method="getNotesList">
			<!-- <param name="permission">WORKORDER_READ,TASK_READ</param> -->
			<result name="success" type="json">
				<param name="root">notes</param>
			</result>
		</action>
		<action name="addNotes" class="com.facilio.bmsconsole.actions.NoteAction"
			method="addNote">
			<param name="permission">WORKORDER_READ,TASK_READ</param>
			<result name="success" type="json">
				<param name="includeProperties">^note.*</param>
			</result>
		</action>
		
        <action name="logout" class="com.facilio.auth.actions.FacilioAuthAction"
                method="apiLogout">
            <result name="success" type="json">
                <param name="includeProperties">^account.*</param>
            </result>
        </action>
	
		<action name="picklist" class="com.facilio.bmsconsole.actions.PickListAction">
			<result name="success" type="json">
				<param name="root">pickList</param>
			</result>
		</action>
		
		<action name="getFormMeta" class="com.facilio.bmsconsole.actions.FormAction"
			method="fetchFormMeta">
			<result name="success" type="json">
				<param name="includeProperties">form.*</param>
			</result>
		</action>
		<action name="getFields" class="com.facilio.bmsconsole.actions.FormAction" method="fetchFormFields">
			<result name="success" type="json">
				<param name="includeProperties">fields.*</param>
			</result>
		</action>
		<action name="edit" class="com.facilio.bmsconsole.actions.FormAction" method="editForm">
			<result name="success" type="json">
				<param name="includeProperties">res</param>
			</result>
		</action>
		
		<action name="getallassetreadings" class="com.facilio.bmsconsole.actions.ReadingAction"
			method="getAllAssetReadings">
			<param name="moduleName">setup</param>
			<param name="permission">ASSET_SETTINGS</param>
			<result name="success" type="json">
				<param name="includeProperties">moduleMap.*, assetCount.*</param>
			</result>
		</action>
		
		<action name="readingReport" class="com.facilio.bmsconsole.actions.V2ReportAction" method="fetchReadingsData">
			<result name="success" type="json">
				<param name="ignoreHierarchy">false</param>
				<param name="includeProperties">responseCode, ^result.*</param>
			</result>
		</action>
		<action name="dashboardWithFolder" class="com.facilio.bmsconsole.actions.DashboardAction" method="getPortalDashboardFolder">
			<result name="success" type="json">
				<param name="includeProperties">dashboardFolders,dashboardFolders\[\d+\],dashboardFolders\[\d+\].*</param>
			</result>
		</action>
		<action name="basespace" class="com.facilio.bmsconsole.actions.BaseSpaceAction"
			method="baseSpaceList">
				<param name="moduleName">space</param>
				<param name="permission">READ</param>
				<result name="success" type="json">
				<param name="includeProperties">basespaces,basespaces\[\d+\],basespaces\[\d+\].*</param>
			</result>
		</action>
	</package>
	
</struts>
