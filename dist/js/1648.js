"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[1648],{
/***/696709:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return PivotBuilder}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/energy/pivot/PivotBuilder.vue?vue&type=template&id=3c7a701a&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"pivot-builder  height-100   d-flex flex-col white-background"},[_c("header",{staticClass:"fc-report-header flex-shrink-0"},[_c("div",{staticClass:"pull-left report-title-section"},[_c("el-input",{staticClass:"fc-report-input-title newreport-title-input pL10",attrs:{autofocus:!0,placeholder:_vm.$t("common.wo_report.new_report"),prop:"reportName",type:"text"},model:{value:_vm.reportObject.name,callback:function($$v){_vm.$set(_vm.reportObject,"name",$$v)},expression:"reportObject.name"}})],1),_c("div",{staticClass:"pull-right report-btn-section"},[_c("f-report-options",{staticClass:"pL10",attrs:{isActionsDisabled:_vm.isNoConfig,optionsToEnable:[5],reportObject:_vm.reportObject,config:_vm.config,pdf:!1}})],1)]),_c("div",{staticClass:"d-flex flex-grow pivot-builder-body items-stretch overflow-hidden"},[_c("transition",{attrs:{name:"fc-scale-panel"}},[_c("div",{directives:[{name:"show",rawName:"v-show",value:_vm.leftPaneVisibility,expression:"leftPaneVisibility"}],staticClass:"width45  overflow-x-hidden flex-shrink-0 pivot-left-pane  pL20 pR20 pT10 pB40 overflow-y-scroll"},[_c("div",{directives:[{name:"show",rawName:"v-show",value:"CONFIG"==_vm.leftPaneActiveTab,expression:"leftPaneActiveTab == 'CONFIG'"}]},[_c("div",{staticClass:"fc-text-pink fw6 text-uppercase"},[_vm._v(" "+_vm._s(_vm.$t("pivot.build"))+" ")]),_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.module"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width100 mT5",attrs:{filterable:"",placeholder:"Select","popper-class":"fc-group-select",loading:_vm.moduleLoading,"loading-text":_vm.$t("pivot.loading"),disabled:_vm.isModuleAvailable},model:{value:_vm.config.moduleName,callback:function($$v){_vm.$set(_vm.config,"moduleName",$$v)},expression:"config.moduleName"}},[_c("el-option-group",{attrs:{label:_vm.$t("pivot.systemModules")}},_vm._l(_vm.moduleOptions.systemModules,(function(module,index){return _c("el-option",{key:index,attrs:{label:module.displayName,value:module.name}})})),1),_vm.moduleOptions.customModules&&_vm.moduleOptions.customModules.length>0?_c("el-option-group",{attrs:{label:_vm.$t("pivot.customModules")}},_vm._l(_vm.moduleOptions.customModules,(function(module,index){return _c("el-option",{key:index,attrs:{label:module.displayName,value:module.name}})})),1):_vm._e()],1),_c("div",{staticClass:"pivot-pane-criteria mT20 d-flex justify-content-space align-center"},[_c("div",{staticClass:"pivot-criteria-config-text"},[_c("div",{staticClass:"fc-grey7-12 f14 text-left "},[_vm._v(" "+_vm._s(_vm.$t("pivot.criteria"))+" ")]),_c("div",{staticClass:"fc-grey2 f11 text-left pT5 pB5",class:[{fwBold:_vm.config.criteria},{pointer:_vm.config.criteria}],on:{click:_vm.resetCriteria}},[_vm._v(" "+_vm._s(_vm.config.criteria?_vm.$t("pivot.criteriaReset"):_vm.$t("pivot.criteriaDefault"))+" ")])]),_c("i",{staticClass:"el-icon-edit report-edit-icon pointer",class:[_vm.config.moduleName?["pointer"]:["cursor-not-allowed"]],on:{click:_vm.openAddCriteriaDialog}})]),_c("div",{staticClass:"timeline-filter-section"},[_c("el-checkbox",{staticClass:"mT15  p5 fc-grey7-12 f14 text-left line-height25",staticStyle:{border:"none"},attrs:{label:_vm.$t("pivot.timelineFilter")},on:{change:_vm.toggleTimelineFilter},model:{value:_vm.config.showTimelineFilter,callback:function($$v){_vm.$set(_vm.config,"showTimelineFilter",$$v)},expression:"config.showTimelineFilter"}}),_vm.config.showTimelineFilter?_c("div",{staticClass:"date-field-section"},[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.rowDateField"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width100 mT5 date-field-select",attrs:{filterable:"",placeholder:"Select"},on:{change:_vm.configChanged},model:{value:_vm.config.dateFieldId,callback:function($$v){_vm.$set(_vm.config,"dateFieldId",$$v)},expression:"config.dateFieldId"}},_vm._l(_vm.dateFieldOptions,(function(dateField,index){return _c("el-option",{key:"date-field-option"+index,attrs:{label:dateField.displayName,value:dateField.id}})})),1)],1):_vm._e()],1),_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT20 d-flex"},[_vm._v(" "+_vm._s(_vm.$t("pivot.rows"))+" "),_c("div",{staticClass:"fc-dark-blue2-12  mL-auto",class:[_vm.config.moduleName?["pointer"]:["cursor-not-allowed"]],on:{click:_vm.openAddRowDialog}},[_vm._v(" "+_vm._s(_vm.$t("pivot.add"))+" ")])]),_c("draggable",{attrs:{list:_vm.config.rows,options:_vm.draggableOptions},on:{change:_vm.handleReorder}},_vm._l(_vm.config.rows,(function(row,index){return _c("div",{key:index,staticClass:"field-row mT10 ",style:_vm.isColumnHidden(row.alias)},[_c("div",{staticClass:"task-handle mR10 pointer"},[_c("img",{attrs:{src:__webpack_require__(271791)}})]),_c("div",{staticClass:"mT-auto mB-auto"},[_vm._v(" "+_vm._s(_vm.config.templateJSON.columnFormatting[row.alias].label)+" ")]),_c("div",{staticClass:"mL-auto mT-auto mB-auto"},[_c("div",{staticClass:"mR10 inline"},[_c("i",{staticClass:"el-icon-view pointer mR10",on:{click:function($event){return _vm.hideShowRow(row)}}}),_c("i",{staticClass:"el-icon-edit pointer mR10",on:{click:function($event){return _vm.editRow(row,index)}}}),_c("i",{staticClass:"el-icon-delete pointer trash-icon",on:{click:function($event){return _vm.removeRow(row,index)}}})])])])})),0),_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT20 d-flex"},[_vm._v(" "+_vm._s(_vm.$t("pivot.data"))+" "),_c("div",{staticClass:"fc-dark-blue2-12  mL-auto",class:[_vm.config.moduleName?["pointer"]:["cursor-not-allowed"]],on:{click:_vm.openAddDataDialog}},[_vm._v(" "+_vm._s(_vm.$t("pivot.add"))+" ")])]),_c("draggable",{attrs:{list:_vm.config.data,options:_vm.draggableOptions},on:{change:_vm.handleReorder}},_vm._l(_vm.config.data,(function(data,index){return _c("div",{key:index,staticClass:"field-row mT10",style:_vm.isColumnHidden(data.alias)},[_c("div",{staticClass:"task-handle mR10 pointer"},[_c("img",{attrs:{src:__webpack_require__(271791)}})]),_c("div",{staticClass:"mT-auto mB-auto"},[_vm._v(" "+_vm._s(_vm.config.templateJSON.columnFormatting[data.alias].label)+" ")]),_c("div",{staticClass:"mL-auto mT-auto mB-auto"},[_c("div",{staticClass:"mR10 inline"},[_c("i",{staticClass:"el-icon-view pointer mR10",on:{click:function($event){return _vm.hideShowData(data)}}}),_c("i",{staticClass:"el-icon-edit pointer mR10",on:{click:function($event){return _vm.editData(data,index)}}}),_c("i",{staticClass:"el-icon-delete pointer trash-icon",on:{click:function($event){return _vm.removeData(data,index)}}})])])])})),0),_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT20 d-flex"},[_vm._v(" "+_vm._s(_vm.$t("pivot.formula"))+" "),_c("div",{staticClass:"fc-dark-blue2-12  mL-auto",class:[_vm.config.moduleName?["pointer"]:["cursor-not-allowed"]],on:{click:_vm.openAddFormulaDialog}},[_vm._v(" "+_vm._s(_vm.$t("pivot.add"))+" ")])]),_c("draggable",{attrs:{list:_vm.config.formula,options:_vm.draggableOptions},on:{change:_vm.handleReorder}},_vm._l(_vm.config.formula,(function(formula,index){return _c("div",{key:index,staticClass:"field-row mT10",style:_vm.isColumnHidden(formula.alias)},[_c("div",{staticClass:"task-handle mR10 pointer"},[_c("img",{attrs:{src:__webpack_require__(271791)}})]),_c("div",{staticClass:"mT-auto mB-auto"},[_vm._v(" "+_vm._s(_vm.config.templateJSON.columnFormatting[formula.alias].label)+" ")]),_c("div",{staticClass:"mL-auto mT-auto mB-auto"},[_c("div",{staticClass:"mR10 inline"},[_c("i",{staticClass:"el-icon-view pointer mR10",on:{click:function($event){return _vm.hideShowFormula(formula)}}}),_c("i",{staticClass:"el-icon-edit pointer mR10",on:{click:function($event){return _vm.editFormula(formula,index)}}}),_c("i",{staticClass:"el-icon-delete pointer trash-icon",on:{click:function($event){return _vm.removeFormula(formula,index)}}})])])])})),0),_vm.config.moduleName&&_vm.config.rows.length&&_vm.config.data.length?_c("div",{staticClass:"pivot-sort-section"},[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT20"},[_vm._v(" "+_vm._s(_vm.$t("pivot.sortColumn"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width100 mT5",attrs:{filterable:"",placeholder:"Select sort column","popper-class":"fc-group-select"},on:{change:_vm.configChanged},model:{value:_vm.config.sortBy.alias,callback:function($$v){_vm.$set(_vm.config.sortBy,"alias",$$v)},expression:"config.sortBy.alias"}},[_c("el-option-group",{attrs:{label:_vm.$t("pivot.rows")}},_vm._l(_vm.config.rows,(function(row,index){return _c("el-option",{key:index,attrs:{label:_vm.config.templateJSON.columnFormatting[row.alias].label||row.field.displayName,value:row.alias}})})),1),_c("el-option-group",{attrs:{label:_vm.$t("pivot.data")}},_vm._l(_vm.config.data,(function(data,index){return _c("el-option",{key:index,attrs:{label:_vm.config.templateJSON.columnFormatting[data.alias].label||(data.field||data.readingField).displayName,value:data.alias}})})),1)],1),_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT20"},[_vm._v(" "+_vm._s(_vm.$t("pivot.sortOrder"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width100 mT5",attrs:{placeholder:"Ascending/Descending"},on:{change:_vm.configChanged},model:{value:_vm.config.sortBy.order,callback:function($$v){_vm.$set(_vm.config.sortBy,"order",$$v)},expression:"config.sortBy.order"}},[_c("el-option",{attrs:{label:_vm.$t("pivot.asc"),value:2}}),_c("el-option",{attrs:{label:_vm.$t("pivot.desc"),value:3}})],1),_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.limit"))+" ")]),_c("el-input",{staticClass:"fc-input-full-border2 width100 mT5",attrs:{"controls-position":"right",type:"number",step:20,min:1,max:400,placeholder:"Ascending/Descending"},on:{change:_vm.configChanged},model:{value:_vm.config.sortBy.limit,callback:function($$v){_vm.$set(_vm.config.sortBy,"limit",_vm._n($$v))},expression:"config.sortBy.limit"}})],1):_vm._e(),_vm.showAddRowDialog?_c("AddRowDialog",{attrs:{visibility:_vm.showAddRowDialog,pivotBaseModuleName:_vm.config.moduleName,editConfig:_vm.editConfig,formatConfig:_vm.formatConfig,index:_vm.editIndex},on:{"update:visibility":function($event){_vm.showAddRowDialog=$event},save:_vm.rowAdded,update:_vm.pivotRowUpdated,updateCancel:_vm.pivotUpdateReset}}):_vm._e(),_vm.showAddCriteriaDialog?_c("AddCriteriaDialog",{attrs:{visibility:_vm.showAddCriteriaDialog,criteria:_vm.config.criteria,moduleName:_vm.config.moduleName},on:{"update:visibility":function($event){_vm.showAddCriteriaDialog=$event},save:_vm.criteriaSaved}}):_vm._e(),_vm.showAddDataDialog?_c("AddDataDialog",{attrs:{visibility:_vm.showAddDataDialog,pivotBaseModuleName:_vm.config.moduleName,editConfig:_vm.editConfig,formatConfig:_vm.formatConfig,index:_vm.editIndex},on:{"update:visibility":function($event){_vm.showAddDataDialog=$event},save:_vm.pivotDataAdded,update:_vm.pivotDataUpdated,updateCancel:_vm.pivotUpdateReset}}):_vm._e(),_vm.columnFormatConfig.visibility?_c("ColumnFormatDialog",{attrs:{visibility:_vm.columnFormatConfig.visibility,field:_vm.columnFormatConfig.field,alias:_vm.columnFormatConfig.alias,editConfig:_vm.columnFormatConfig.editConfig,isDataColumn:_vm.columnFormatConfig.isDataColumn,fieldName:_vm.columnFormatConfig.fieldName},on:{close:function($event){_vm.columnFormatConfig.visibility=!1},columnFormatConfig:_vm.columnFormatConfigAdded}}):_vm._e(),_vm.conditionalFormatConfig.visibility?_c("ConditionalFormatDialog",{attrs:{visibility:_vm.conditionalFormatConfig.visibility,alias:_vm.conditionalFormatConfig.alias,variables:_vm.conditionalFormatConfig.fields,editConfig:_vm.conditionalFormatConfig.editConfig},on:{"update:visibility":function($event){return _vm.$set(_vm.conditionalFormatConfig,"visibility",$event)},closeDialog:function($event){_vm.conditionalFormatConfig.visibility=!1,_vm.conditionalFormatConfig.editConfig={}},conditionFormatAdded:_vm.conditionFormatAdded}}):_vm._e(),_vm.cellVisualizationConfig.visibility?_c("cell-visualization-dialog",{attrs:{visibility:_vm.cellVisualizationConfig.visibility,alias:_vm.cellVisualizationConfig.alias,editConfig:_vm.cellVisualizationConfig.editConfig,referenceDataColumnOptions:_vm.referenceDataColumnOptions},on:{"update:visibility":function($event){return _vm.$set(_vm.cellVisualizationConfig,"visibility",$event)},closeDialog:function($event){_vm.cellVisualizationConfig.visibility=!1,_vm.cellVisualizationConfig.editConfig={}},cellVisualizationConfigAdded:_vm.cellVisualizationConfigAdded}}):_vm._e(),_vm.showAddFormulaDialog?_c("add-formula-dialog",{attrs:{visibility:_vm.showAddFormulaDialog,moduleName:_vm.config.moduleName,formatConfig:_vm.formatConfig,editConfig:_vm.editConfig,pivotFieldMap:_vm.pivotFieldMap,index:_vm.editIndex},on:{"update:visibility":function($event){_vm.showAddFormulaDialog=$event},save:_vm.pivotFormulaAdded,update:_vm.pivotFormulaUpdated,updateCancel:_vm.pivotUpdateReset}}):_vm._e()],1),_c("div",{directives:[{name:"show",rawName:"v-show",value:"SETTINGS"==_vm.leftPaneActiveTab,expression:"leftPaneActiveTab == 'SETTINGS'"}]},[_c("div",{staticClass:"fc-text-pink fw6 text-uppercase"},[_vm._v(" "+_vm._s(_vm.$t("pivot.theme"))+" ")]),_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.rowSpacing"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width100 mT5",attrs:{filterable:"",placeholder:"Select"},model:{value:_vm.config.templateJSON.theme.density,callback:function($$v){_vm.$set(_vm.config.templateJSON.theme,"density",$$v)},expression:"config.templateJSON.theme.density"}},[_c("el-option",{attrs:{label:_vm.$t("pivot.small"),value:"SMALL"}}),_c("el-option",{attrs:{label:_vm.$t("pivot.medium"),value:"MEDIUM"}}),_c("el-option",{attrs:{label:_vm.$t("pivot.large"),value:"LARGE"}})],1),_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.fontSize"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width100 mT5",attrs:{filterable:"",placeholder:"Select"},model:{value:_vm.config.templateJSON.theme.fontSize,callback:function($$v){_vm.$set(_vm.config.templateJSON.theme,"fontSize",$$v)},expression:"config.templateJSON.theme.fontSize"}},[_c("el-option",{attrs:{label:_vm.$t("pivot.small"),value:"small"}}),_c("el-option",{attrs:{label:_vm.$t("pivot.medium"),value:"medium"}}),_c("el-option",{attrs:{label:_vm.$t("pivot.large"),value:"large"}})],1),_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.themeColor"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width100 mT5",attrs:{filterable:"",placeholder:"Select"},model:{value:_vm.config.templateJSON.theme.class,callback:function($$v){_vm.$set(_vm.config.templateJSON.theme,"class",$$v)},expression:"config.templateJSON.theme.class"}},_vm._l(_vm.pivotThemeOptions,(function(theme){return _c("el-option",{key:"pivotTheme-"+theme.name,attrs:{label:theme.name,value:theme.class}})})),1),_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.grid"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width100 mT5",attrs:{filterable:"",placeholder:"Select"},model:{value:_vm.config.templateJSON.theme.grid,callback:function($$v){_vm.$set(_vm.config.templateJSON.theme,"grid",$$v)},expression:"config.templateJSON.theme.grid"}},[_c("el-option",{attrs:{label:_vm.$t("pivot.both"),value:"both"}}),_c("el-option",{attrs:{label:_vm.$t("pivot.horizontal"),value:"horizontal"}}),_c("el-option",{attrs:{label:_vm.$t("pivot.vertical"),value:"vertical"}}),_c("el-option",{attrs:{label:_vm.$t("pivot.none"),value:"none"}})],1),_c("el-checkbox",{staticClass:"mT15",model:{value:_vm.config.templateJSON.theme.number,callback:function($$v){_vm.$set(_vm.config.templateJSON.theme,"number",$$v)},expression:"config.templateJSON.theme.number"}},[_vm._v(_vm._s(_vm.$t("pivot.showRowNumbers")))]),_c("el-checkbox",{staticClass:"mT15",model:{value:_vm.config.templateJSON.theme.stripe,callback:function($$v){_vm.$set(_vm.config.templateJSON.theme,"stripe",$$v)},expression:"config.templateJSON.theme.stripe"}},[_vm._v(_vm._s(_vm.$t("pivot.stripes")))])],1)])]),_c("div",{staticClass:"pivot-main relative width75 flex-grow  pL75 pT25 pB25 pR25"},[_c("PaneSwitch",{attrs:{isPaneExpanded:_vm.leftPaneVisibility,activeTab:_vm.leftPaneActiveTab},on:{"update:isPaneExpanded":function($event){_vm.leftPaneVisibility=$event},"update:is-pane-expanded":function($event){_vm.leftPaneVisibility=$event},"update:activeTab":function($event){_vm.leftPaneActiveTab=$event},"update:active-tab":function($event){_vm.leftPaneActiveTab=$event}}}),_c("PivotTable",{ref:"pivotTable",attrs:{sortBy:_vm.config.sortBy,showTimelineFilter:_vm.config.showTimelineFilter,dateOperator:_vm.config.dateOperator,dateValue:_vm.config.dateValue,pivotTable:_vm.pivotTable,loading:_vm.tableLoading,isNoConfig:_vm.isNoConfig,theme:_vm.config.templateJSON.theme,enableColumnFormat:!0,columnFormatting:_vm.config.templateJSON.columnFormatting,fetchPivotDataError:_vm.fetchPivotDataError},on:{"update:loading":function($event){_vm.tableLoading=$event},sortChanged:_vm.handleTableSortIconClick,pickerChanged:_vm.handlePickerChange,columnResizeEvent:_vm.columnResizeEvent,openColumnFormatDialog:_vm.openColumnFormatDialog,openConditionalFormatDialog:_vm.openConditionalFormatDialog,openCellVisualizationDialog:_vm.openCellVisualizationDialog,columnPinningEvent:_vm.columnPinningEvent,columnTextWarpEvent:_vm.columnTextWarpEvent}})],1)],1)])},staticRenderFns=[],objectSpread2=__webpack_require__(595082),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),slicedToArray=__webpack_require__(554621),toConsumableArray=__webpack_require__(488478),api=(__webpack_require__(434284),__webpack_require__(670560),__webpack_require__(169358),__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(300268),__webpack_require__(865137),__webpack_require__(538077),__webpack_require__(339772),__webpack_require__(425728),__webpack_require__(450886),__webpack_require__(634338),__webpack_require__(506203),__webpack_require__(162506),__webpack_require__(648324),__webpack_require__(241830),__webpack_require__(32284)),NewDateHelper=__webpack_require__(105534),utils_field=__webpack_require__(815872),vuedraggable_umd=__webpack_require__(909980),vuedraggable_umd_default=__webpack_require__.n(vuedraggable_umd),AddRowDialogvue_type_template_id_729ceca1_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"pivot-add-row"},[_c("el-dialog",{staticClass:"pivot-add-row-dialog",attrs:{visible:_vm.visibility,"show-close":!1,"append-to-body":!0,title:_vm.$t("pivot.addRow"),width:"40%"}},[_c("div",{staticClass:"body"},[_vm.loading?_c("spinner",{attrs:{show:_vm.loading,size:"80"}}):_c("div",{staticClass:"add-row-content"},[1==_vm.showSubmodule?_c("div",[_c("div",{staticClass:"module-field-select"},[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.field"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width75 ",attrs:{filterable:"","default-first-option":"",placeholder:"Select Field","popper-class":"fc-group-select","value-key":"uuid",disabled:_vm.editConfig},on:{change:_vm.moduleFieldChanged},model:{value:_vm.selectedModuleField,callback:function($$v){_vm.selectedModuleField=$$v},expression:"selectedModuleField"}},_vm._l(_vm.mainModuleFields,(function(field){return _c("el-option",{key:field.uuid,attrs:{label:field.displayName,value:field.uuid}})})),1)],1),_vm.showLookupPropertyDropDown?_c("div",{staticClass:"lookup-field-select"},[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.selectLookupField"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width75 ",attrs:{filterable:"","default-first-option":"",placeholder:"Select","popper-class":"fc-group-select","value-key":"uuid"},on:{change:_vm.lookupFieldChanged},model:{value:_vm.selectedLookupField,callback:function($$v){_vm.selectedLookupField=$$v},expression:"selectedLookupField"}},_vm._l(_vm.lookupFieldOptions,(function(field){return _c("el-option",{key:field.uuid,attrs:{label:field.displayName,value:field.id}})})),1)],1):_vm._e(),_c("div",{staticClass:"rename-column"},[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.columnName"))+" ")]),_c("el-input",{staticClass:"fc-input-full-border2 width75 mT5 ",attrs:{placeholder:"Rename"},model:{value:_vm.columnName,callback:function($$v){_vm.columnName=$$v},expression:"columnName"}})],1),_vm.showTimeAggregation?_c("div",[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.datePeriod"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width75 mT5 module-date-period-select ",attrs:{filterable:"",placeholder:"Select"},model:{value:_vm.moduleDatePeriod,callback:function($$v){_vm.moduleDatePeriod=$$v},expression:"moduleDatePeriod"}},_vm._l(_vm.timeAggregation,(function(aggr,index){return _c("el-option",{key:"module-date-period"+index,attrs:{label:aggr.name,value:aggr.value}})})),1)],1):_vm._e()]):_c("div",[_c("div",{staticClass:"rename-column"},[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.columnName"))+" ")]),_c("el-input",{staticClass:"fc-input-full-border2 width75 mT5 ",attrs:{placeholder:"Rename"},model:{value:_vm.columnName,callback:function($$v){_vm.columnName=$$v},expression:"columnName"}})],1)])])],1),_c("div",{staticClass:"dialog-save-cancel"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.closeDialog}},[_vm._v(" Cancel")]),_c("el-button",{staticClass:"modal-btn-save mL0",attrs:{type:"primary"},on:{click:_vm.save}},[_vm._v("Done")])],1)])],1)},AddRowDialogvue_type_template_id_729ceca1_staticRenderFns=[],validation=(__webpack_require__(976801),__webpack_require__(990260)),constant=__webpack_require__(354754),uuid=__webpack_require__(455877),PivotDefaults=__webpack_require__(706214),AddRowDialogvue_type_script_lang_js={props:["visibility","pivotBaseModuleName","editConfig","index","formatConfig"],
// components: {
//   NewCriteriaBuilder,
// },
data:function(){return{meta:{},moduleField:{},selectedModuleField:null,lookupField:{},selectedLookupField:null,loading:!0,showSubmodule:"1",submoduleList:[],submoduleFields:[],selectedSubmoduleFieldId:null,selectedSubmoduleField:{},selectedSubmoduleId:null,selectedSubmodule:{},selectedSortFieldId:{},sortOrder:"1",criteria:null,columnName:null,refreshKey:0,showLookupPropertyDropDown:!1,lookupFieldOptions:[],showTimeAggregation:!1,TimeAggregation:0,moduleDatePeriod:0,timeAggregation:PivotDefaults/* timeAggregation */.tP}},created:function(){this.loadRowOptions();
// this.loadSubmodules()
},methods:{loadSubmodules:function(value){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var _yield$API$get,data;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.next=2,api/* API */.bl.get("v2/report/getDataModuleList?moduleName=".concat(_this.pivotBaseModuleName));case 2:_yield$API$get=_context.sent,data=_yield$API$get.data,_this.submoduleList=data.modules,_this.selectedSubmoduleId=data.modules[0].moduleId,_this.selectedSubmodule=data.modules[0],"2"==value?_this.columnName="":_this.submoduleChange(),_this.editConfig&&_this.initProps();case 9:case"end":return _context.stop()}}),_callee)})))()},updateCriteria:function(newValue){this.isValidCriteria(newValue)&&(this.criteria=newValue)},isValidCriteria:function(criteria){if(!criteria.conditions)return!1;//all conditions empty ,invalid criteria
var areAllConditionsEmpty=!1;return areAllConditionsEmpty=Object.keys(criteria.conditions).every((function(conditionKey){var condition=criteria.conditions[conditionKey];return(0,validation/* isEmpty */.xb)(condition)})),!areAllConditionsEmpty},
// sortFieldChange() {
// },
getMainField:function(fields){
//get main field or first field
return fields.find((function(field){return field.mainField}))||fields[0]},isEmpty:validation/* isEmpty */.xb,initProps:function(){var self=this;
// if (this.editConfig.subModuleFieldId) {
//   this.showSubmodule = '2'
//   this.selectedSubmoduleFieldId = this.editConfig.subModuleFieldId
//   this.sortOrder = this.editConfig.sortOrder.toString()
//   this.selectedSubmoduleField = this.editConfig.field
//   this.selectedSortFieldId = this.editConfig.sortField.id
//   this.criteria = this.editConfig.criteria
//   this.selectedSubmodule = this.submoduleList.find(
//     el => el.moduleId == self.editConfig.field.moduleId
//   )
//   this.selectedSubmoduleId = this.selectedSubmodule.moduleId
//   // this.submoduleChange()
//   // this.submoduleFieldChange()
// } else
-1!==this.editConfig.lookupFieldId?(this.moduleField=this.mainModuleFields.find((function(field){return field.id==self.editConfig.lookupFieldId&&self.editConfig.moduleName==field.lookupModule.name})),this.selectedModuleField=this.moduleField.uuid,this.moduleFieldChanged(this.selectedModuleField),this.lookupField=this.editConfig.field,this.selectedLookupField=this.editConfig.field.id,this.lookupFieldChanged(this.lookupField.id)):(this.moduleField=this.mainModuleFields.find((function(field){return field.id==self.editConfig.field.id})),this.selectedModuleField=this.moduleField.uuid,this.moduleFieldChanged(this.selectedModuleField)),this.columnName=this.formatConfig.label},loadRowOptions:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var resp,data,error,meta;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,api/* API */.bl.get("v2/report/getTabularRowReportFields",{moduleName:_this2.pivotBaseModuleName});case 2:resp=_context2.sent,data=resp.data,error=resp.error,error?_this2.$message.error("Error loading row options "):(
//api format getTabularRowReportFields/asset ->meta{asset:fields,relatedModule(vendor):fields}
//take main module 'asset'.for each lookup field in asset ,fill fields from lookup's module
meta=data.meta,_this2.meta=meta,
//add a unique uuid to each field, some fields have same name and id, Asset.building and asset.space
Object.keys(meta).forEach((function(moduleName){meta[moduleName].forEach((function(field){field.uuid=(0,uuid.v4)(),["site","building","floor","space"].includes(moduleName)&&(field.aggr=constant/* default */.Z.SPACE_AGGREGATE_OPERATOR.getOperatorId(moduleName))}))})),_this2.mainModuleFields=meta[_this2.pivotBaseModuleName],_this2.loading=!1,_this2.moduleField=_this2.getMainField(_this2.mainModuleFields),_this2.selectedModuleField=_this2.moduleField.uuid,_this2.columnName=_this2.moduleField.displayName,_this2.editConfig&&_this2.initProps());case 5:case"end":return _context2.stop()}}),_callee2)})))()},submoduleChange:function(){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var self,_yield$API$get2,data,result;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return self=_this3,_this3.selectedSubmodule=_this3.submoduleList.find((function(mod){return mod.moduleId===self.selectedSubmoduleId})),_context3.next=4,api/* API */.bl.get("/module/metafields?moduleName=".concat(_this3.selectedSubmodule.name));case 4:_yield$API$get2=_context3.sent,data=_yield$API$get2.data,result=JSON.parse(JSON.stringify(data)),_this3.submoduleFields=result.meta.fields.filter((function(el){return"LOOKUP"!==el.dataTypeEnum})),_this3.editConfig||(_this3.selectedSubmoduleFieldId=_this3.submoduleFields[0].id),_this3.submoduleFieldChange();case 10:case"end":return _context3.stop()}}),_callee3)})))()},submoduleFieldChange:function(){var self=this;this.selectedSubmoduleField=this.submoduleFields.find((function(mod){return mod.id==self.selectedSubmoduleFieldId})),this.selectedSubmoduleField&&(this.columnName=this.selectedSubmoduleField.displayName)},moduleFieldChanged:function(){
//if selected field is a lookup field , show another dropbox with lookupmodule's fields
var selectedField=this.selectedModuleField;this.moduleField=this.meta[this.pivotBaseModuleName].find((function(field){return field.uuid==selectedField})),selectedField=this.moduleField,this.showTimeAggregation=(0,utils_field/* isDateTimeField */.K)(selectedField)||(0,utils_field/* isDateField */.y2)(selectedField),this.columnName=selectedField.displayName,this.lookupField={},this.showLookupPropertyDropDown=!1,"LOOKUP"==selectedField.dataTypeEnum&&this.meta[selectedField.lookupModule.name]&&(this.lookupFieldOptions=this.meta[selectedField.lookupModule.name],this.showLookupPropertyDropDown=!0,this.lookupField=this.getMainField(this.lookupFieldOptions))},lookupFieldChanged:function(){var selectedField=this.selectedLookupField;this.lookupField=this.lookupFieldOptions.find((function(el){return el.id==selectedField})),selectedField=this.lookupField,this.columnName=selectedField.displayName},closeDialog:function(){this.editConfig&&this.$emit("updateCancel"),this.$emit("update:visibility",!1)},save:function(){var rowObj={},formatting=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},PivotDefaults/* defaultColFormat */.WW.rowColumn),{},{label:this.columnName}),self=this;(0,validation/* isEmpty */.xb)(this.lookupField)?"1"==this.showSubmodule?(rowObj.field=this.moduleField,rowObj.lookupFieldId=-1,rowObj.aggr=this.moduleField.aggr||0,rowObj.moduleName=this.pivotBaseModuleName):(
//subModuleFieldId
rowObj.field=this.selectedSubmoduleField,rowObj.lookupFieldId=-1,rowObj.aggr=this.selectedSubmoduleField.aggr||0,rowObj.moduleName=this.selectedSubmoduleField.name,rowObj.subModuleFieldId=this.selectedSubmoduleField.id,rowObj.criteria=this.criteria,rowObj.sortField=this.submoduleFields.find((function(el){return el.id==self.selectedSortFieldId})),rowObj.sortOrder=parseInt(this.sortOrder)):(rowObj.field=this.lookupField,rowObj.lookupFieldId=this.moduleField.id,//if lookup's property selected .also send lookup field's id
rowObj.aggr=this.lookupField.aggr||0,rowObj.moduleName=this.moduleField.lookupModule.name),
// rowObj.field.aggr = this.timeAggregation
rowObj.field.aggr=this.moduleDatePeriod,this.editConfig?(rowObj.alias=this.editConfig.alias,this.$emit("update",{params:{row:rowObj,formatting:formatting},index:this.index})):this.$emit("save",{row:rowObj,formatting:formatting})}}},pivot_AddRowDialogvue_type_script_lang_js=AddRowDialogvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(pivot_AddRowDialogvue_type_script_lang_js,AddRowDialogvue_type_template_id_729ceca1_render,AddRowDialogvue_type_template_id_729ceca1_staticRenderFns,!1,null,null,null)
/* harmony default export */,AddRowDialog=component.exports,AddDataDialogvue_type_template_id_21518d68_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"pivot-add-data"},[_c("el-dialog",{staticClass:"pivot-add-data-dialog",attrs:{visible:_vm.visibility,"show-close":!1,"append-to-body":!0,title:_vm.$t("pivot.addData"),width:"50%"}},[_c("div",[_vm.loading?_c("spinner",{attrs:{show:_vm.loading,size:"80"}}):_vm._e(),!_vm.loading&&_vm.pivotBaseModule&&_vm.pivotBaseModule.displayName?_c("div",{staticClass:"body"},[_vm.canShowReadingDataOptions?_c("div",[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.dataModuleType"))+" ")]),_c("div",{staticClass:"choose-data-module-type mT5"},[_c("el-radio",{staticClass:"fc-radio-btn",attrs:{label:_vm.PIVOT_DATA_MODULE_TYPE.MODULE,disabled:_vm.isEditing},on:{change:_vm.changeDataModuleType},model:{value:_vm.dataModuleType,callback:function($$v){_vm.dataModuleType=$$v},expression:"dataModuleType"}},[_vm._v(_vm._s(_vm.$t("pivot.module")))]),_c("el-radio",{staticClass:"fc-radio-btn",attrs:{label:_vm.PIVOT_DATA_MODULE_TYPE.READING,disabled:_vm.isEditing},on:{change:_vm.changeDataModuleType},model:{value:_vm.dataModuleType,callback:function($$v){_vm.dataModuleType=$$v},expression:"dataModuleType"}},[_vm._v(_vm._s(_vm.$t("pivot.reading")))])],1)]):_vm._e(),_vm.dataModuleType==_vm.PIVOT_DATA_MODULE_TYPE.MODULE?_c("div",{key:"module-section-"+_vm.refreshKey},[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.module"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width60 mT5 module-select",attrs:{filterable:"",placeholder:"Select","popper-class":"fc-group-select","value-key":"name",disabled:_vm.isEditing},on:{change:_vm.changeNonReadingModule},model:{value:_vm.nonReadingModule,callback:function($$v){_vm.nonReadingModule=$$v},expression:"nonReadingModule"}},[_c("el-option-group",{attrs:{label:_vm.$t("pivot.mainModule")}},[_c("el-option",{attrs:{label:_vm.pivotBaseModule.displayName,value:_vm.pivotBaseModule}})],1),_c("el-option-group",{attrs:{label:_vm.$t("pivot.subModules")}},_vm._l(_vm.submoduleOptions,(function(submodule,index){return _c("el-option",{key:"non-reading-module-options"+index,attrs:{label:submodule.displayName,value:submodule}})})),1)],1),_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.metric"))+" ")]),_c("div",{staticClass:"width60 align-center metric-aggr-section"},[_c("el-row",[_c("el-col",{attrs:{span:18}},[_c("el-select",{staticClass:"fc-input-full-border-select2 width100  mT5  flex-grow metric-select",attrs:{filterable:"",placeholder:"Select","value-key":"completeColumnName",disabled:_vm.isEditing},on:{change:_vm.initColumnName},model:{value:_vm.metricField,callback:function($$v){_vm.metricField=$$v},expression:"metricField"}},_vm._l(_vm.metricOptions,(function(metric,index){return _c("el-option",{key:"metric-option"+index,attrs:{label:metric.displayName,value:metric}})})),1)],1),_c("el-col",{attrs:{span:6}},[_c("el-select",{staticClass:"fc-input-full-border-select2 width100 mL5 mT5 reading-field-select",attrs:{disabled:_vm.metricAggregationDisabled,placeholder:"Select"},model:{value:_vm.metricAggregation,callback:function($$v){_vm.metricAggregation=$$v},expression:"metricAggregation"}},_vm._l(_vm.aggrOptions,(function(option,index){return _c("el-option",{key:"aggr-option"+index,attrs:{label:option.label,value:option.value}})})),1)],1)],1)],1),_vm.isEmpty(_vm.metricField)?_vm._e():_c("div",[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.columnName"))+" ")]),_c("el-input",{staticClass:"fc-input-full-border2 width60 mT5 ",attrs:{placeholder:"Rename"},model:{value:_vm.columnName,callback:function($$v){_vm.columnName=$$v},expression:"columnName"}})],1),_vm.moduleSelected?_c("div",[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.dateField"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width60 mT5 module-date-field-select",attrs:{filterable:"",placeholder:"Select"},model:{value:_vm.dateFieldId,callback:function($$v){_vm.dateFieldId=$$v},expression:"dateFieldId"}},_vm._l(_vm.dateFieldOptions,(function(dateField,index){return _c("el-option",{key:"module-date-field-option"+index,attrs:{label:dateField.displayName,value:dateField.id}})})),1),_c("el-row",{staticClass:"width60"},[_c("el-col",{attrs:{span:12}},[-99!=_vm.dateFieldId?_c("div",[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.datePeriod"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border-select2 mT5 module-date-period-select",staticStyle:{width:"95%"},attrs:{filterable:"",placeholder:"Select"},model:{value:_vm.moduleDatePeriod,callback:function($$v){_vm.moduleDatePeriod=$$v},expression:"moduleDatePeriod"}},_vm._l(_vm.datePeriodOptions,(function(datePeriod,index){return _c("el-option",{key:"module-date-period"+index,attrs:{label:datePeriod.label,value:datePeriod.dateOperator}})})),1)],1):_vm._e()]),_c("el-col",{staticStyle:{float:"right"},attrs:{span:12}},[-99!=_vm.dateFieldId?_c("div",[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("common.header.base_line"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width100 mT5 module-date-period-select",staticStyle:{width:"95%"},attrs:{filterable:"",clearable:"",placeholder:"Baseline"},model:{value:_vm.baselinePeriod,callback:function($$v){_vm.baselinePeriod=$$v},expression:"baselinePeriod"}},_vm._l(_vm.baselinePeriodOptions,(function(datePeriod,index){return _c("el-option",{key:"module-base-period"+index,attrs:{label:datePeriod.name,value:datePeriod.name}})})),1)],1):_vm._e()])],1),20==_vm.moduleDatePeriod?_c("div",[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.customRange"))+" ")]),_c("el-date-picker",{staticClass:"width60 fc-input-full-border2 mT5",attrs:{type:"datetimerange",placeholder:"Select start date and time","value-format":"timestamp"},model:{value:_vm.customDateRange,callback:function($$v){_vm.customDateRange=$$v},expression:"customDateRange"}})],1):_vm._e(),-99!=_vm.dateFieldId?_c("div",[_c("el-checkbox",{staticClass:"width60 mT15",model:{value:_vm.excludeFromTimelineFilter,callback:function($$v){_vm.excludeFromTimelineFilter=$$v},expression:"excludeFromTimelineFilter"}},[_vm._v(_vm._s(_vm.$t("pivot.excludeFromTLF")))])],1):_vm._e(),_c("div",{staticClass:"data-criteria mT30"},[_c("new-criteria-builder",{key:_vm.refreshKey,ref:"criteriaBuilder",staticClass:"stateflow-criteria",attrs:{lookupModuleFieldsList:_vm.nonReadingModuleFields,lookupFieldModuleName:_vm.nonReadingModule.name,title:"Show options that match",exrule:_vm.criteria,module:_vm.nonReadingModule.name},on:{condition:_vm.updateCriteria},model:{value:_vm.criteria,callback:function($$v){_vm.criteria=$$v},expression:"criteria"}})],1)],1):_vm._e()],1):_vm.dataModuleType==_vm.PIVOT_DATA_MODULE_TYPE.READING?_c("div",{key:"reading-section"+_vm.refreshKey},[_vm.showAssetReadings?_c("div",{staticClass:"asset-cat-reading-field-section"},[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.assetCategory"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width60 mT5 asset-cat-select",attrs:{filterable:"",placeholder:"Select","value-key":"name",disabled:_vm.isEditing},on:{change:_vm.changeAssetCategoryEvent},model:{value:_vm.assetCategoryIndex,callback:function($$v){_vm.assetCategoryIndex=$$v},expression:"assetCategoryIndex"}},_vm._l(_vm.assetCategoryOptions||[],(function(option,index){return _c("el-option",{key:"asset-category-option"+index,attrs:{label:option.displayName,value:index}})})),1),_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.readingField"))+" ")]),_c("div",{staticClass:"width60 align-center metric-aggr-section"},[_c("el-row",[_c("el-col",{attrs:{span:18}},[_c("el-select",{staticClass:"fc-input-full-border-select2 width100 mT5 reading-field-select",attrs:{filterable:"",placeholder:"Select",disabled:_vm.isEditing,"value-key":"name"},on:{change:_vm.initColumnName},model:{value:_vm.readingField,callback:function($$v){_vm.readingField=$$v},expression:"readingField"}},_vm._l(_vm.readingFieldOptions||[],(function(option,index){return _c("el-option",{key:"reading-field-option"+index,attrs:{label:option.displayName,value:option}})})),1)],1),_c("el-col",{attrs:{span:6}},[_c("el-select",{staticClass:"fc-input-full-border-select2 width100 mL5 mT5 reading-field-select",attrs:{placeholder:"Select"},model:{value:_vm.metricAggregation,callback:function($$v){_vm.metricAggregation=$$v},expression:"metricAggregation"}},_vm._l(_vm.aggrOptions,(function(option,index){return _c("el-option",{key:"aggr-option"+index,attrs:{label:option.label,value:option.value}})})),1)],1)],1)],1)],1):_vm._e(),_vm.showSiteBuildingFloorReadings?_c("div",{staticClass:"site-floor-buinding-reading-section"},[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.readingField"))+" ")]),_c("div",{staticClass:"width60 align-center metric-aggr-section"},[_c("el-row",[_c("el-col",{attrs:{span:18}},[_c("el-select",{staticClass:"fc-input-full-border-select2 width100 mT5 reading-field-select",attrs:{filterable:"",placeholder:"Select",disabled:_vm.isEditing,"value-key":"name"},on:{change:_vm.initColumnName},model:{value:_vm.readingField,callback:function($$v){_vm.readingField=$$v},expression:"readingField"}},_vm._l(_vm.readingFieldOptions||[],(function(option,index){return _c("el-option",{key:"reading-field-option"+index,attrs:{label:option.displayName,value:option}})})),1)],1),_c("el-col",{attrs:{span:6}},[_c("el-select",{staticClass:"fc-input-full-border-select2 width100 mL5 mT5 reading-field-select",attrs:{placeholder:"Select"},model:{value:_vm.metricAggregation,callback:function($$v){_vm.metricAggregation=$$v},expression:"metricAggregation"}},_vm._l(_vm.aggrOptions,(function(option,index){return _c("el-option",{key:"aggr-option"+index,attrs:{label:option.label,value:option.value}})})),1)],1)],1)],1)]):_vm._e(),_vm.showSpaceReadings?_c("div",{staticClass:"space-reading-field-section"},[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.assetCategory"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width60 mT5 asset-cat-select",attrs:{filterable:"",placeholder:"Select","value-key":"name",disabled:_vm.isEditing},on:{change:_vm.changeSpaceCategoryEvent},model:{value:_vm.spaceCategoryId,callback:function($$v){_vm.spaceCategoryId=$$v},expression:"spaceCategoryId"}},[_c("el-option",{attrs:{label:"All Categories",value:-1}}),_vm._l(_vm.spaceCategoryOptions||[],(function(option,index){return _c("el-option",{key:"space-category-option"+index,attrs:{label:option.name,value:option.id}})}))],2),_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.readingField"))+" ")]),_c("div",{staticClass:"width60 align-center metric-aggr-section"},[_c("el-row",[_c("el-col",{attrs:{span:18}},[_c("el-select",{staticClass:"fc-input-full-border-select2 width100 mT5 reading-field-select",attrs:{filterable:"",placeholder:"Select",disabled:_vm.isEditing,"value-key":"name"},on:{change:_vm.initColumnName},model:{value:_vm.readingField,callback:function($$v){_vm.readingField=$$v},expression:"readingField"}},_vm._l(_vm.readingFieldOptions||[],(function(option,index){return _c("el-option",{key:"reading-field-option"+index,attrs:{label:option.displayName,value:option}})})),1)],1),_c("el-col",{attrs:{span:6}},[_c("el-select",{staticClass:"fc-input-full-border-select2 width100 mL5 mT5 reading-field-select",attrs:{placeholder:"Select"},model:{value:_vm.metricAggregation,callback:function($$v){_vm.metricAggregation=$$v},expression:"metricAggregation"}},_vm._l(_vm.aggrOptions,(function(option,index){return _c("el-option",{key:"aggr-option"+index,attrs:{label:option.label,value:option.value}})})),1)],1)],1)],1)],1):_vm._e(),_vm.isEmpty(_vm.readingField)?_vm._e():_c("div",[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.columnName"))+" ")]),_c("el-input",{staticClass:"fc-input-full-border2 width60 mT5 ",attrs:{placeholder:"Rename"},model:{value:_vm.columnName,callback:function($$v){_vm.columnName=$$v},expression:"columnName"}})],1),_c("el-row",{staticClass:"width60"},[_c("el-col",{attrs:{span:12}},[_c("div",[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.datePeriod"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border-select2 mT5 reading-date-period-select",staticStyle:{width:"95%"},attrs:{filterable:"",placeholder:"Select"},model:{value:_vm.readingDatePeriod,callback:function($$v){_vm.readingDatePeriod=$$v},expression:"readingDatePeriod"}},_vm._l(_vm.datePeriodOptions,(function(readingDatePeriod,index){return _c("el-option",{key:"reading-date-period"+index,attrs:{label:readingDatePeriod.label,value:readingDatePeriod.dateOperator}})})),1)],1)]),_c("el-col",{staticStyle:{float:"right"},attrs:{span:12}},[_c("div",[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("common.header.base_line"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width100 mT5 module-date-period-select",staticStyle:{width:"95%"},attrs:{filterable:"",clearable:"",placeholder:"Baseline"},model:{value:_vm.baselinePeriod,callback:function($$v){_vm.baselinePeriod=$$v},expression:"baselinePeriod"}},_vm._l(_vm.baselinePeriodOptions,(function(datePeriod,index){return _c("el-option",{key:"module-base-period"+index,attrs:{label:datePeriod.name,value:datePeriod.name}})})),1)],1)])],1),20==_vm.readingDatePeriod?_c("div",[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.customRange"))+" ")]),_c("el-date-picker",{staticClass:"width60 fc-input-full-border2 mT5",staticStyle:{width:"60% !important","border-radius":"5px !important"},attrs:{type:"datetimerange",placeholder:"Select start date and time","value-format":"timestamp"},model:{value:_vm.customDateRange,callback:function($$v){_vm.customDateRange=$$v},expression:"customDateRange"}})],1):_vm._e(),_c("div",[_c("el-checkbox",{staticClass:"width60 mT15",model:{value:_vm.excludeFromTimelineFilter,callback:function($$v){_vm.excludeFromTimelineFilter=$$v},expression:"excludeFromTimelineFilter"}},[_vm._v(_vm._s(_vm.$t("pivot.excludeFromTLF")))])],1)],1):_vm._e()]):_vm._e(),_c("div",{staticClass:"dialog-save-cancel"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.closeDialog}},[_vm._v(" "+_vm._s(_vm.$t("pivot.cancel"))+" ")]),_c("el-button",{staticClass:"modal-btn-save mL0",attrs:{type:"primary"},on:{click:_vm.save}},[_vm._v(" "+_vm._s(_vm.$t("pivot.done"))+" ")])],1)],1)])],1)},AddDataDialogvue_type_template_id_21518d68_staticRenderFns=[],NewCriteriaBuilder=__webpack_require__(859850),vuex_esm=__webpack_require__(420629),PIVOT_DATA_MODULE_TYPE={MODULE:1,READING:2},readingSupportedModules=["asset","site","building","floor","space"],AddDataDialogvue_type_script_lang_js={props:["visibility","pivotBaseModuleName","editConfig","index","formatConfig","referenceDataColumnOptions"],components:{NewCriteriaBuilder:NewCriteriaBuilder/* default */.Z},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({assetCategoryOptions:"assetCategory"})),(0,vuex_esm/* mapState */.rn)({spaceCategoryOptions:"spaceCategory"})),{},{dateFieldOptions:function(){var options=[];options.push({id:-99,displayName:"NONE"});var dateFields=this.nonReadingModuleFields.filter((function(field){return(0,utils_field/* isDateTypeField */.S6)(field)}));return options.push.apply(options,(0,toConsumableArray/* default */.Z)(dateFields)),options},moduleSelected:function(){return!(0,validation/* isEmpty */.xb)(this.nonReadingModule)},canShowReadingDataOptions:function(){return readingSupportedModules.includes(this.pivotBaseModuleName)},metricAggregationDisabled:function(){return!this.metricField||!this.metricField.name||"id"==this.metricField.name},isEditing:function(){return!(0,validation/* isEmpty */.xb)(this.editConfig)},showAssetReadings:function(){return"asset"==this.pivotBaseModuleName},showSiteBuildingFloorReadings:function(){return["site","building","floor"].includes(this.pivotBaseModuleName)},showSpaceReadings:function(){return"space"==this.pivotBaseModuleName}}),data:function(){return{PIVOT_DATA_MODULE_TYPE:PIVOT_DATA_MODULE_TYPE,refreshKey:0,nonReadingModule:{},
//moduleType->module
nonReadingModuleFields:[],readingModule:{},baselinePeriodOptions:{},baselinePeriod:null,dataModuleType:PIVOT_DATA_MODULE_TYPE.MODULE,pivotBaseModule:null,submoduleOptions:[],metricField:{},metricAggregation:3,metricOptions:[],criteria:null,excludeFromTimelineFilter:!1,dateFieldId:-99,customDateRange:[],columnName:null,
//Readings options
assetCategory:{},spaceCategoryId:-1,readingFieldOptions:[],readingField:{},datePeriodOptions:PivotDefaults/* datePeriodOptions */.SD,loading:!0,assetCategoryIndex:0,moduleDatePeriod:28,readingDatePeriod:28,aggrOptions:[{label:"COUNT",value:1},{label:"AVG",value:2},{label:"SUM",value:3},{label:"MIN",value:4},{label:"MAX",value:5}]}},created:function(){this.initSelectStatements()},methods:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({isEmpty:validation/* isEmpty */.xb},(0,vuex_esm/* mapActions */.nv)(["loadAssetCategory","loadSpaceCategory"])),{},{initColumnName:function(field){this.columnName=field.displayName,"id"!=this.metricField.name||this.editConfig||(
//for id fields only COUNT is allowed
this.metricAggregation=1)},initProps:function(){var _this=this;this.dataModuleType=parseInt(this.editConfig.moduleType),this.baselinePeriod=this.editConfig.baselineLabel,this.excludeFromTimelineFilter=this.editConfig.excludeFromTimelineFilter,this.customDateRange=[this.editConfig.startTime,this.editConfig.endTime],2==this.dataModuleType?("asset"==this.pivotBaseModuleName?(this.assetCategoryIndex=this.assetCategoryOptions.findIndex((function(at){return at.assetModuleID==_this.editConfig.parentModuleId})),this.assetCategory=this.assetCategoryOptions[this.assetCategoryIndex],this.changeAssetCategory().then((function(){_this.readingField=_this.readingFieldOptions.find((function(rf){return rf.id==_this.editConfig.readingField.id}))}))):["site","floor","building"].includes(this.pivotBaseModuleName)?this.readingField=this.readingFieldOptions.find((function(rf){return rf.id==_this.editConfig.readingField.id})):"space"==this.pivotBaseModuleName&&this.loadSpaceCategory().then((function(){var spaceCategory=_this.spaceCategoryOptions.find((function(sp){return sp.id==_this.editConfig.parentModuleId}));_this.spaceCategoryId=null!==spaceCategory&&void 0!==spaceCategory&&spaceCategory.id?null===spaceCategory||void 0===spaceCategory?void 0:spaceCategory.id:-1,_this.loadSpaceReadingFields(_this.spaceCategoryId).then((function(){_this.readingField=_this.readingFieldOptions.find((function(rf){return rf.id==_this.editConfig.readingField.id}))}))})),this.readingDatePeriod=this.editConfig.datePeriod,this.columnName=this.formatConfig.label?this.formatConfig.label:this.editConfig.field.displayName):(this.editConfig.moduleName!=this.pivotBaseModuleName?this.nonReadingModule=this.submoduleOptions.find((function(submodule){return submodule.name==_this.editConfig.moduleName})):this.nonReadingModule=this.pivotBaseModule.module,this.changeNonReadingModule().then((function(){-1==_this.editConfig.field.id?_this.metricField=_this.metricOptions.find((function(fd){return fd.name==_this.editConfig.field.name})):_this.metricField=_this.nonReadingModuleFields.find((function(fd){return fd.id==_this.editConfig.field.id})),_this.dateFieldId=_this.editConfig.dateFieldId,_this.moduleDatePeriod=_this.editConfig.datePeriod,_this.columnName=_this.formatConfig.label?_this.formatConfig.label:_this.editConfig.field.displayName,_this.criteria=_this.editConfig.criteria}))),this.metricAggregation=this.editConfig.aggr},initSelectStatements:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.next=2,_this2.loadNonReadingModuleOptions();case 2:return _context.next=4,_this2.loadPivotBaseModuleMeta();case 4:return _context.next=6,_this2.loadMetricOptions();case 6:return _context.next=8,_this2.loadNonReadingModuleFields();case 8:return _context.next=10,_this2.loadBaselineOptions();case 10:if("asset"!=_this2.pivotBaseModuleName){_context.next=15;break}return _context.next=13,_this2.loadAssetCategory();case 13:_context.next=23;break;case 15:if(!["site","building","floor"].includes(_this2.pivotBaseModuleName)){_context.next=20;break}return _context.next=18,_this2.loadSiteBuildingFloorReadings(_this2.pivotBaseModuleName);case 18:_context.next=23;break;case 20:if("space"!=_this2.pivotBaseModuleName){_context.next=23;break}return _context.next=23,_this2.loadSpaceCategory();case 23:_this2.editConfig&&_this2.initProps();case 24:case"end":return _context.stop()}}),_callee)})))()},loadNonReadingModuleFields:function(){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var _yield$API$get,data,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,api/* API */.bl.get("v2/modules/meta/".concat(_this3.nonReadingModule.name));case 2:_yield$API$get=_context2.sent,data=_yield$API$get.data,error=_yield$API$get.error,error?_this3.$message.error("Error loading all fields for module"):_this3.nonReadingModuleFields=data.meta.fields;case 6:case"end":return _context2.stop()}}),_callee2)})))()},loadAssetReadingFields:function(){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var data1,data2;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,api/* API */.bl.get("v2/readings/assetcategory",{id:_this4.assetCategory.id,excludeEmptyFields:!0,fetchValidationRules:!1,readingType:"connected"});case 2:return data1=_context3.sent,_context3.next=5,api/* API */.bl.get("v2/readings/assetcategory",{id:_this4.assetCategory.id,excludeEmptyFields:!0,fetchValidationRules:!1,readingType:"available"});case 5:data2=_context3.sent,data1.data.error||data2.data.error?_this4.$message.error("error loading reading fields for asset category"):_this4.readingFieldOptions=[].concat((0,toConsumableArray/* default */.Z)(data1.data.readings),(0,toConsumableArray/* default */.Z)(data2.data.readings));case 7:case"end":return _context3.stop()}}),_callee3)})))()},
//not used
loadSiteBuildingFloorReadings:function(moduleName){var _this5=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){var _yield$API$post,data,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,api/* API */.bl.post("reading/getallspacetypereadings",{spaceType:_this5.getSpaceType(moduleName)});case 2:_yield$API$post=_context4.sent,data=_yield$API$post.data,error=_yield$API$post.error,error?_this5.$message.error("error loading reading fields for ".concat(moduleName)):_this5.readingFieldOptions=_this5.getSiteReadingFields(data);case 6:case"end":return _context4.stop()}}),_callee4)})))()},getSiteReadingFields:function(data){var fields=[],keys=Object.keys(data.moduleMap);return keys.forEach((function(key){fields.push.apply(fields,(0,toConsumableArray/* default */.Z)(data.moduleMap[key]))})),fields},getSpaceType:function(moduleName){switch(moduleName){case"site":return"Sites";case"building":return"Buildings";case"floor":return"Floors"}},changeSpaceCategoryEvent:function(value){this.spaceCategoryId=value,this.loadSpaceReadingFields(value)},loadSpaceReadingFields:function(id){var _this6=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee5(){var data1,data2;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context5){while(1)switch(_context5.prev=_context5.next){case 0:return _this6.readingFieldOptions=[],_context5.next=3,api/* API */.bl.get("v2/readings/spacecategory",{id:id,readingType:"available"});case 3:return data1=_context5.sent,_context5.next=6,api/* API */.bl.get("v2/readings/spacecategory",{id:id,readingType:"connected"});case 6:data2=_context5.sent,_this6.readingFieldOptions=[].concat((0,toConsumableArray/* default */.Z)(data1.data.readings),(0,toConsumableArray/* default */.Z)(data2.data.readings));case 8:case"end":return _context5.stop()}}),_callee5)})))()},changeNonReadingModule:function(){var _this7=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee6(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context6){while(1)switch(_context6.prev=_context6.next){case 0:if(_this7.dataModuleType!=PIVOT_DATA_MODULE_TYPE.MODULE||(0,validation/* isEmpty */.xb)(_this7.nonReadingModule)){_context6.next=7;break}return _this7.metricOptions=[],_this7.nonReadingModuleFields=[],_context6.next=5,_this7.loadMetricOptions();case 5:return _context6.next=7,_this7.loadNonReadingModuleFields();case 7:case"end":return _context6.stop()}}),_callee6)})))()},loadBaselineOptions:function(){var _this8=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee7(){var _yield$API$get2,data;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context7){while(1)switch(_context7.prev=_context7.next){case 0:return _context7.next=2,api/* API */.bl.get("/baseline/all");case 2:_yield$API$get2=_context7.sent,data=_yield$API$get2.data,data&&(_this8.baselinePeriodOptions=JSON.parse(JSON.stringify(data)));case 5:case"end":return _context7.stop()}}),_callee7)})))()},changeAssetCategoryEvent:function(value){this.assetCategory=this.assetCategoryOptions[value],this.changeAssetCategory()},changeAssetCategory:function(){var _this9=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee8(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context8){while(1)switch(_context8.prev=_context8.next){case 0:if((0,validation/* isEmpty */.xb)(_this9.assetCategory)){_context8.next=4;break}return _this9.readingField={},_context8.next=4,_this9.loadAssetReadingFields();case 4:case"end":return _context8.stop()}}),_callee8)})))()},updateCriteria:function(newValue){this.isValidCriteria(newValue)&&(this.criteria=newValue)},isValidCriteria:function(criteria){if(!criteria.conditions)return!1;//all conditions empty ,invalid criteria
var areAllConditionsEmpty=!1;return areAllConditionsEmpty=Object.keys(criteria.conditions).every((function(conditionKey){var condition=criteria.conditions[conditionKey];return(0,validation/* isEmpty */.xb)(condition)})),!areAllConditionsEmpty},loadMetricOptions:function(){var _this10=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee9(){var resp,data,error,idMetric;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context9){while(1)switch(_context9.prev=_context9.next){case 0:return _context9.next=2,api/* API */.bl.get("v2/report/getMetricsList",{moduleName:_this10.nonReadingModule.name});case 2:resp=_context9.sent,data=resp.data,error=resp.error,error?_this10.$message.error("Error loading metric list"):(_this10.metricOptions=data.Fields,idMetric=_this10.metricOptions.find((function(metricField){return"ID"==metricField.dataTypeEnum})),idMetric&&(_this10.metricField=idMetric,_this10.initColumnName(_this10.metricField)));case 5:case"end":return _context9.stop()}}),_callee9)})))()},loadPivotBaseModuleMeta:function(){var _this11=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee10(){var moduleMetaResp,data,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context10){while(1)switch(_context10.prev=_context10.next){case 0:return _context10.next=2,api/* API */.bl.get("v2/modules/meta/".concat(_this11.pivotBaseModuleName));case 2:moduleMetaResp=_context10.sent,data=moduleMetaResp.data,error=moduleMetaResp.error,error?_this11.$message.error("Error fetching base module meta"):(_this11.pivotBaseModule=JSON.parse(JSON.stringify(data.meta)),_this11.nonReadingModule=_this11.pivotBaseModule);case 5:case"end":return _context10.stop()}}),_callee10)})))()},changeDataModuleType:function(){this.isEditing||this.resetDefauts(),this.dataModuleType==PIVOT_DATA_MODULE_TYPE.MODULE?this.loadNonReadingModuleOptions():"asset"==this.pivotBaseModuleName?this.changeAssetCategoryEvent(0):["site","building","floor"].includes(this.pivotBaseModuleName)?this.loadSiteBuildingFloorReadings(this.pivotBaseModuleName):"space"==this.pivotBaseModuleName&&this.loadSpaceCategory()},loadNonReadingModuleOptions:function(){var _this12=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee11(){var resp,data,error,submodules;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context11){while(1)switch(_context11.prev=_context11.next){case 0:return _context11.next=2,api/* API */.bl.get("/v2/report/getDataModuleList",{moduleName:_this12.pivotBaseModuleName});case 2:resp=_context11.sent,data=resp.data,error=resp.error,error?_this12.$message.error("Error loading  module list"):(submodules=data.modules,//module submodule up to itself case, wo -parent wo , remove the submodule here
_this12.submoduleOptions=submodules.filter((function(module){return module.name!=_this12.pivotBaseModuleName}))),_this12.loading=!1;case 6:case"end":return _context11.stop()}}),_callee11)})))()},resetDefauts:function(){this.refreshKey++,this.nonReadingModule={},this.submoduleOptions=[],this.metricField={},this.metricAggregation=3,this.metricOptions=[],this.criteria=null,this.dateFieldId=-99,this.nonReadingModuleFields=[],this.moduleDatePeriod=28,this.readingDatePeriod=28,this.readingModule={},this.readingField={},this.readingFieldOptions=[],this.assetCategory={}},closeDialog:function(){this.$emit("updateCancel"),this.$emit("update:visibility",!1)},getParentModuleId:function(){return"asset"==this.pivotBaseModuleName?this.assetCategory.assetModuleID:"space"==this.pivotBaseModuleName?this.spaceCategoryId:void 0},save:function(){var params={moduleType:this.dataModuleType,aggr:this.metricAggregation,baselineLabel:this.baselinePeriod,excludeFromTimelineFilter:this.excludeFromTimelineFilter};this.customDateRange.length>0&&(params=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},params),{},{startTime:this.customDateRange[0],endTime:this.customDateRange[1]})),this.dataModuleType==PIVOT_DATA_MODULE_TYPE.MODULE?params=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},params),{field:this.metricField,moduleName:this.nonReadingModule.name,dateFieldId:this.dateFieldId,datePeriod:this.moduleDatePeriod,criteria:this.criteria}):this.dataModuleType==PIVOT_DATA_MODULE_TYPE.READING&&(params=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},params),{readingField:this.readingField,datePeriod:this.readingDatePeriod,parentModuleId:this.getParentModuleId()})),this.pivotBaseModule.name!==this.nonReadingModule.name&&this.dataModuleType==PIVOT_DATA_MODULE_TYPE.MODULE&&(params=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},params),{},{subModuleFieldId:this.metricField.id}));var formatting=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},PivotDefaults/* defaultColFormat */.WW.dataColumn),{},{label:this.columnName});this.editConfig?(params.alias=this.editConfig.alias,this.$emit("update",{params:{data:params,formatting:formatting},index:this.index})):this.$emit("save",{data:params,formatting:formatting})}})},pivot_AddDataDialogvue_type_script_lang_js=AddDataDialogvue_type_script_lang_js,AddDataDialog_component=(0,componentNormalizer/* default */.Z)(pivot_AddDataDialogvue_type_script_lang_js,AddDataDialogvue_type_template_id_21518d68_render,AddDataDialogvue_type_template_id_21518d68_staticRenderFns,!1,null,null,null)
/* harmony default export */,AddDataDialog=AddDataDialog_component.exports,ColumnFormatDialogvue_type_template_id_1030e81a_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"pivot-add-data-dialog",attrs:{visible:_vm.visibility,"show-close":!1,"append-to-body":!0,title:_vm.$t("pivot.columnFormat"),width:"30%"}},[_c("div",[_vm.loading?_c("spinner",{attrs:{show:_vm.loading,size:"80"}}):_vm._e(),_vm.loading?_vm._e():_c("div",{staticClass:"body"},[_c("div",{staticClass:"main-layout-cft"},[_c("el-row",[_c("el-row",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.columnName"))+" ")]),_c("el-row",{staticClass:"f14 text-left line-height25 mT5"},[_c("el-input",{staticClass:"fc-input-full-border2 width60",attrs:{disabled:""},model:{value:_vm.fieldName,callback:function($$v){_vm.fieldName=$$v},expression:"fieldName"}})],1)],1),_c("el-row",[_c("el-row",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.dataType"))+" ")]),_c("el-row",{staticClass:"f14 text-left line-height25 mT5"},[_c("el-input",{staticClass:"fc-input-full-border2 width60",attrs:{disabled:""},model:{value:_vm.fieldDataType,callback:function($$v){_vm.fieldDataType=$$v},expression:"fieldDataType"}})],1)],1),_vm.showUnitSelectorOption?_c("el-row",[_c("el-row",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.unit"))+" ")]),_c("el-row",{staticClass:"f14 text-left line-height25 mT10"},[_c("el-input",{staticClass:"fc-input-full-border2 width60",attrs:{disabled:""},model:{value:_vm.field.unit,callback:function($$v){_vm.$set(_vm.field,"unit",$$v)},expression:"field.unit"}})],1)],1):_vm._e(),_c("el-row",[_c("el-row",[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.alignment"))+" ")])]),_c("el-row",[_c("el-select",{staticClass:"fc-input-full-border-select2 width60 mT5 module-select",attrs:{filterable:"",placeholder:"Select","popper-class":"fc-group-select"},model:{value:_vm.config.textAlign,callback:function($$v){_vm.$set(_vm.config,"textAlign",$$v)},expression:"config.textAlign"}},_vm._l(_vm.textAlignOptions,(function(textAlign,index){return _c("el-option",{key:"textAlign-options"+index,attrs:{label:textAlign.label,value:textAlign.value}})})),1)],1)],1),_vm.showDecimalPoints?_c("div",{staticClass:"decimal-points-input"},[_c("el-row",[_c("el-row",[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.decimalPoints"))+" ")])]),_c("el-row",[_c("el-input",{staticClass:"fc-input-full-border2  mT5",attrs:{type:"number"},model:{value:_vm.config.decimalPoints,callback:function($$v){_vm.$set(_vm.config,"decimalPoints",$$v)},expression:"config.decimalPoints"}})],1)],1)],1):_vm._e()],1),_vm.showUnitOption?_c("div",{staticClass:"metric-block mT20 "},[_c("label",{staticClass:"fc-modal-sub-title"},[_vm._v(" "+_vm._s(_vm.$t("pivot.unit"))+" ")]),_vm.showUnitSelectorOption?_c("div",{staticClass:"metric-display-unit-selecter"},[_c("el-row",[_c("el-row",[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.displayUnit"))+" ")])]),_c("el-row",[_c("el-select",{staticClass:"fc-input-full-border-select2 width60 mT5 module-select",attrs:{filterable:"",placeholder:"Select","popper-class":"fc-group-select"},on:{change:_vm.converToUnitChanged},model:{value:_vm.config.displayUnit,callback:function($$v){_vm.$set(_vm.config,"displayUnit",$$v)},expression:"config.displayUnit"}},_vm._l(_vm.metricUnitOptions,(function(metric,index){return _c("el-option",{key:"displayUnit-options"+index,attrs:{label:metric.displayName,value:metric.unitId}})})),1)],1)],1)],1):_c("div",{staticClass:"metric-custom-unit-input-box mT10"},[_c("el-row",[_c("el-row",[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT5"},[_vm._v(" "+_vm._s(_vm.$t("pivot.customUnit"))+" ")])]),_c("el-row",[_c("el-input",{staticClass:"fc-input-full-border-select2 mT5 width60 module-select",attrs:{placeholder:"Custom unit"},model:{value:_vm.config.customUnit,callback:function($$v){_vm.$set(_vm.config,"customUnit",$$v)},expression:"config.customUnit"}})],1)],1)],1),_c("div",{staticClass:"show-unit-at-selecter mT10"},[_c("el-row",[_c("el-row",[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25"},[_vm._v(" "+_vm._s(_vm.$t("pivot.showUnitAt"))+" ")])]),_c("el-col",{attrs:{span:12}},[_c("el-select",{staticClass:"fc-input-full-border-select2 width100 mT5 module-select",attrs:{filterable:"",placeholder:"Select","popper-class":"fc-group-select"},on:{change:_vm.unitShowAtChanged},model:{value:_vm.unitDisplayLocation,callback:function($$v){_vm.unitDisplayLocation=$$v},expression:"unitDisplayLocation"}},_vm._l(_vm.unitDisplayOptions,(function(unitDisplay,index){return _c("el-option",{key:"unitDisplay-options"+index,attrs:{label:unitDisplay.label,value:unitDisplay.value}})})),1)],1),_c("el-col",{attrs:{span:12}},[_c("el-radio-group",{staticClass:"fc-input-full-border-select2  width100 mT5 mL5 module-select",model:{value:_vm.config.prefix,callback:function($$v){_vm.$set(_vm.config,"prefix",$$v)},expression:"config.prefix"}},[_c("el-radio-button",{attrs:{label:!0}},[_vm._v(_vm._s(_vm.$t("pivot.prefix")))]),_c("el-radio-button",{attrs:{label:!1}},[_vm._v(_vm._s(_vm.$t("pivot.suffix")))])],1)],1)],1)],1)]):_vm._e(),_vm.showNumberFormatBlock?_c("div",{staticClass:"separator-block mT20"},[_c("label",{staticClass:"fc-modal-sub-title"},[_vm._v(" "+_vm._s(_vm.$t("pivot.separator"))+" ")]),_c("div",{staticClass:"show-unit-at-selecter mT10"},[_c("el-row",[_c("el-row",[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT5"},[_vm._v(" "+_vm._s(_vm.$t("pivot.localeSeparator"))+" ")])]),_c("el-row",[_c("el-radio-group",{staticClass:"fc-input-full-border-select2  width60 mT5 module-select",model:{value:_vm.config.applyLocaleSeparator,callback:function($$v){_vm.$set(_vm.config,"applyLocaleSeparator",$$v)},expression:"config.applyLocaleSeparator"}},[_c("el-radio-button",{attrs:{label:!0}},[_vm._v(_vm._s(_vm.$t("pivot.default")))]),_c("el-radio-button",{attrs:{label:!1}},[_vm._v(_vm._s(_vm.$t("pivot.custom")))])],1)],1)],1)],1),_vm.showDecimalOptions?_c("div",{staticClass:"decimal-separetor-selecter"},[_c("el-row",[_c("el-row",[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.decimalSeparator"))+" ")])]),_c("el-row",[_c("el-select",{staticClass:"fc-input-full-border-select2 width60 mT5 module-select",attrs:{filterable:"",placeholder:"Select","popper-class":"fc-group-select"},model:{value:_vm.config.decimalSeparator,callback:function($$v){_vm.$set(_vm.config,"decimalSeparator",$$v)},expression:"config.decimalSeparator"}},_vm._l(_vm.decimalSeparatorOptions,(function(decimalSeparator,index){return _c("el-option",{key:"decimalSeparator-options"+index,attrs:{label:decimalSeparator.label,value:decimalSeparator.value}})})),1)],1)],1)],1):_vm._e(),_vm.showThousandSeparator?_c("div",{staticClass:"thousand-separetor-selecter"},[_c("el-row",[_c("el-row",[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.thousandSeparator"))+" ")])]),_c("el-row",[_c("el-select",{staticClass:"fc-input-full-border-select2 width60 mT5 module-select",attrs:{filterable:"",placeholder:"Select","popper-class":"fc-group-select"},model:{value:_vm.config.thousandSeparator,callback:function($$v){_vm.$set(_vm.config,"thousandSeparator",$$v)},expression:"config.thousandSeparator"}},_vm._l(_vm.thousandSeparatorOptions,(function(thousandSeparator,index){return _c("el-option",{key:"thousandSeparator-options"+index,attrs:{label:thousandSeparator.label,value:thousandSeparator.value}})})),1)],1)],1)],1):_vm._e()]):_vm._e(),_vm.showEnumBlocKFormatValue||_vm.showBooleanBlocKFormatValue||_vm.isDataColumn?_c("div",{staticClass:"alias-block mT10 "},[_c("label",{staticClass:"fc-modal-sub-title"},[_vm._v(" "+_vm._s(_vm.$t("pivot.formatValues"))+" ")]),_vm.showBooleanBlocKFormatValue?_c("div",{staticClass:"boolean-block"},[_c("div",{staticClass:"true-alias"},[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.true"))+" ")]),_c("el-input",{staticClass:"fc-input-full-border-select2  mT5 module-select",attrs:{placeholder:"True"},model:{value:_vm.config.trueValue,callback:function($$v){_vm.$set(_vm.config,"trueValue",$$v)},expression:"config.trueValue"}})],1),_c("div",{staticClass:"false-alias"},[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.false"))+" ")]),_c("el-input",{staticClass:"fc-input-full-border-select2  mT5 module-select",attrs:{placeholder:"False"},model:{value:_vm.config.falseValue,callback:function($$v){_vm.$set(_vm.config,"falseValue",$$v)},expression:"config.falseValue"}})],1)]):_vm._e(),_vm.showEnumBlocKFormatValue?_c("div",{staticClass:"enum-block mT10 "},_vm._l(_vm.enumAliasList,(function(enumObj,index){return _c("div",{key:index,staticClass:"enum-alias"},[_c("el-row",[_c("el-row",[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(enumObj.value)+" ")])]),_c("el-row",[_c("el-input",{staticClass:"fc-input-full-border-select2 mT5 module-select",attrs:{placeholder:enumObj.value},model:{value:_vm.config.enumValues[enumObj.key],callback:function($$v){_vm.$set(_vm.config.enumValues,enumObj.key,$$v)},expression:"config.enumValues[enumObj.key]"}})],1)],1)],1)})),0):_vm._e(),_vm.isDataColumn?_c("div",{staticClass:"custom-null-val-block"},[_c("div",{staticClass:"boolean-block"},[_c("div",{staticClass:"false-alias"},[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.nullValue"))+" ")]),_c("el-input",{staticClass:"fc-input-full-border-select2  mT5 module-select",attrs:{placeholder:"--"},model:{value:_vm.config.customNullValue,callback:function($$v){_vm.$set(_vm.config,"customNullValue",$$v)},expression:"config.customNullValue"}})],1)])]):_vm._e()]):_vm._e()]),_c("div",{staticClass:"dialog-save-cancel"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.closeDialog}},[_vm._v(" "+_vm._s(_vm.$t("pivot.cancel")))]),_c("el-button",{staticClass:"modal-btn-save mL0",attrs:{type:"primary"},on:{click:_vm.save}},[_vm._v(_vm._s(_vm.$t("pivot.done")))])],1)],1)])},ColumnFormatDialogvue_type_template_id_1030e81a_scoped_true_staticRenderFns=[],ColumnFormatDialogvue_type_script_lang_js=(__webpack_require__(689730),{props:["field","alias","editConfig","visibility","isDataColumn","fieldName"],computed:{enumAliasList:function(){var _this=this,enumList=[],keys=Object.keys(this.field.enumMap);return keys.forEach((function(key){enumList.push({key:key,value:_this.field.enumMap[key]})})),enumList},fieldDataType:function(){var dataType=this.field.dataTypeEnum;return dataType[0]+dataType.slice(1).toLowerCase()},showUnitOption:function(){return(0,utils_field/* isDecimalField */.No)(this.field)||(0,utils_field/* isNumberField */.Z2)(this.field)||this.field.unit},showUnitSelectorOption:function(){return this.field.metricEnum},showThousandSeparator:function(){return(this.isDataColumn||(0,utils_field/* isDecimalField */.No)(this.field)||(0,utils_field/* isNumberField */.Z2)(this.field))&&!this.config.applyLocaleSeparator},showDecimalOptions:function(){return(0,utils_field/* isDecimalField */.No)(this.field)&&!this.config.applyLocaleSeparator},showDecimalPoints:function(){return(0,utils_field/* isDecimalField */.No)(this.field)},showBooleanBlocKFormatValue:function(){return this.isBooleanField(this.field)},showEnumBlocKFormatValue:function(){return this.isEnumField(this.field)},showNumberFormatBlock:function(){return this.isDataColumn||(0,utils_field/* isDecimalField */.No)(this.field)||(0,utils_field/* isNumberField */.Z2)(this.field)}},data:function(){return{config:{textAlign:null,unitId:-1,metricId:null,appendUnit:!1,displayUnit:-1,prefix:!1,headerUnit:!1,unit:null,decimalSeparator:".",decimalPoints:2,thousandSeparator:",",enumValues:{},applyLocaleSeparator:!0},unitDisplayLocation:0,textAlignOptions:[{label:"Center",value:"center"},{label:"Left",value:"left"},{label:"Right",value:"right"}],decimalSeparatorOptions:[{label:"Dot (.)",value:"."},{label:"Comma (,)",value:","},{label:"Single quote (')",value:"'"}],thousandSeparatorOptions:[{label:"Comma (,)",value:","},{label:"Dot (.)",value:"."}],unitDisplayOptions:[{label:"None",value:0},{label:"Header",value:1},{label:"Each row",value:2}],metricUnits:null,metricUnitOptions:null,metricOptions:null,loading:!1}},mounted:function(){var _this$editConfig;this.editConfig&&(this.config=JSON.parse(JSON.stringify(this.editConfig))),null!==(_this$editConfig=this.editConfig)&&void 0!==_this$editConfig&&_this$editConfig.textAlign||((0,utils_field/* isNumberField */.Z2)(this.field)||(0,utils_field/* isDecimalField */.No)(this.field)||(0,utils_field/* isIdField */.sh)(this.field)?this.config.textAlign="right":(0,utils_field/* isBooleanField */.Mw)(this.field)||(0,utils_field/* isEnumField */.Ri)(this.field)?this.config.textAlign="center":this.config.textAlign="left"),this.config.appendUnit||this.config.headerUnit?!this.config.appendUnit&&this.config.headerUnit?this.unitDisplayLocation=1:this.config.appendUnit&&!this.config.headerUnit&&(this.unitDisplayLocation=2):this.unitDisplayLocation=0,this.getDefaultMetricUnits()},methods:{isNumberField:utils_field/* isNumberField */.Z2,isDecimalField:utils_field/* isDecimalField */.No,isIdField:utils_field/* isIdField */.sh,isBooleanField:utils_field/* isBooleanField */.Mw,isEnumField:utils_field/* isEnumField */.Ri,closeDialog:function(){this.$emit("close")},save:function(){this.$emit("columnFormatConfig",{alias:this.alias,config:(0,objectSpread2/* default */.Z)({},this.config)})},metricUnitChanged:function(initial){var _this2=this,metric=this.metricOptions.find((function(mt){return mt.metricId==_this2.config.metricId}));metric&&(this.metricUnitOptions=this.metricUnits[metric._name]),this.field.unitId>0?(this.config.unitId=this.field.unitId,this.config.displayUnit=this.editConfig&&this.config.metricId==this.editConfig.metricId?this.editConfig.displayUnit:this.field.unitId,this.converToUnitChanged(this.config.convertToUnitId)):initial&&(this.config.unitId=this.metricUnitOptions[0].unitId,this.config.displayUnit=this.metricUnitOptions[0].unitId,this.converToUnitChanged(this.config.convertToUnitId))},getDefaultMetricUnits:function(){var _this3=this;api/* API */.bl.get("/units/getDefaultMetricUnits").then((function(_ref){var data=_ref.data,metricWithUnits=data.metricWithUnits,metrics=data.metrics;_this3.metricUnits=metricWithUnits,_this3.metricOptions=metrics,_this3.field.metric>0&&(_this3.config.metricId=_this3.field.metric),_this3.metricUnitChanged(!1)}))},unitShowAtChanged:function(value){0==value?(this.config.appendUnit=!1,this.config.headerUnit=!1):1==value?(this.config.appendUnit=!1,this.config.headerUnit=!0):2==value&&(this.config.appendUnit=!0,this.config.headerUnit=!1)},converToUnitChanged:function(optn){var unit=this.metricUnitOptions.find((function(ut){return(null===ut||void 0===ut?void 0:ut.unitId)==optn}));this.config.unit=null===unit||void 0===unit?void 0:unit.symbol}}}),pivot_ColumnFormatDialogvue_type_script_lang_js=ColumnFormatDialogvue_type_script_lang_js,ColumnFormatDialog_component=(0,componentNormalizer/* default */.Z)(pivot_ColumnFormatDialogvue_type_script_lang_js,ColumnFormatDialogvue_type_template_id_1030e81a_scoped_true_render,ColumnFormatDialogvue_type_template_id_1030e81a_scoped_true_staticRenderFns,!1,null,"1030e81a",null)
/* harmony default export */,ColumnFormatDialog=ColumnFormatDialog_component.exports,AddCriteriaDialogvue_type_template_id_6355c9e8_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"pivot-add-criteria"},[_c("el-dialog",{staticClass:"pivot-add-criteria-dialog",attrs:{visible:_vm.visibility,"show-close":!1,"append-to-body":!0,title:_vm.$t("pivot.criteria"),width:"50%"}},[_c("div",{staticClass:"body"},[_c("div",{staticClass:"base-module-criteria mT30"},[_c("new-criteria-builder",{ref:"criteriaBuilder",staticClass:"stateflow-criteria",attrs:{title:"Show options that match",exrule:_vm.criteriaModel,module:_vm.moduleName},on:{condition:_vm.updateCriteria},model:{value:_vm.criteriaModel,callback:function($$v){_vm.criteriaModel=$$v},expression:"criteriaModel"}})],1)]),_c("div",{staticClass:"dialog-save-cancel"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.closeDialog}},[_vm._v(" Cancel")]),_c("el-button",{staticClass:"modal-btn-save mL0",attrs:{type:"primary"},on:{click:_vm.save}},[_vm._v("Done")])],1)])],1)},AddCriteriaDialogvue_type_template_id_6355c9e8_staticRenderFns=[],utility_methods=(__webpack_require__(795765),__webpack_require__(879288),__webpack_require__(821552),__webpack_require__(773258)),AddCriteriaDialogvue_type_script_lang_js={props:["visibility","moduleName","criteria"],components:{NewCriteriaBuilder:NewCriteriaBuilder/* default */.Z},data:function(){return{criteriaModel:null}},created:function(){
//make copy of saved criteria state for criteria builder to mutate,sync parent state on save only
this.criteriaModel=(0,utility_methods/* deepCloneObject */.kh)(this.criteria)},methods:{updateCriteria:function(newValue){this.isValidCriteria(newValue)&&(this.criteriaModel=newValue)},isValidCriteria:function(criteria){if(!criteria.conditions)return!1;var conditions=criteria.conditions;for(var key in conditions)if(Number.isInteger(Number.parseInt(key))){var condition=conditions[key];if((0,validation/* isEmpty */.xb)(condition)||(0,validation/* isEmpty */.xb)(condition.operatorLabel))return!1}return!0},closeDialog:function(){this.$emit("update:visibility",!1)},save:function(){
//on save update saved criteria  state in parent comp
this.$emit("save",this.criteriaModel)}}},pivot_AddCriteriaDialogvue_type_script_lang_js=AddCriteriaDialogvue_type_script_lang_js,AddCriteriaDialog_component=(0,componentNormalizer/* default */.Z)(pivot_AddCriteriaDialogvue_type_script_lang_js,AddCriteriaDialogvue_type_template_id_6355c9e8_render,AddCriteriaDialogvue_type_template_id_6355c9e8_staticRenderFns,!1,null,null,null)
/* harmony default export */,AddCriteriaDialog=AddCriteriaDialog_component.exports,PivotTable=__webpack_require__(231910),PaneSwitchvue_type_template_id_62177f0f_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"pane-switch",class:{expanded:_vm.isPaneExpanded}},[_c("div",{},[_c("div",{staticClass:"text-center analytics-report-icon-bg line-height50 height50",class:{"analytics-report-icon-bg-active":"CONFIG"==_vm.activeTab},on:{click:function($event){return _vm.switchTab("CONFIG")}}},[_c("InlineSvg",{attrs:{src:"statistics",iconClass:"icon icon-sm-md  vertical-middle"}})],1),_c("div",{staticClass:"text-center analytics-report-icon-bg line-height50 height50",class:{"analytics-report-icon-bg-active":"SETTINGS"==_vm.activeTab},on:{click:function($event){return _vm.switchTab("SETTINGS")}}},[_c("InlineSvg",{attrs:{src:"settings-grey",iconClass:"icon icon-sm-md vertical-middle"}})],1),_c("div",{staticClass:"text-center analytics-report-icon-bg line-height50 height50",on:{click:function($event){return _vm.togglePaneVisibility()}}},[_c("InlineSvg",{staticClass:"pane-arrow",class:[{rotate180:!_vm.isPaneExpanded}],attrs:{src:"arrow-pointing-to-left2",iconClass:"icon icon-sm-md vertical-middle"}})],1)])])},PaneSwitchvue_type_template_id_62177f0f_scoped_true_staticRenderFns=[],PaneSwitchvue_type_script_lang_js={props:["isPaneExpanded","activeTab"],methods:{togglePaneVisibility:function(){this.$emit("update:isPaneExpanded",!this.isPaneExpanded)},switchTab:function(tab){this.$emit("update:activeTab",tab)}}},pivot_PaneSwitchvue_type_script_lang_js=PaneSwitchvue_type_script_lang_js,PaneSwitch_component=(0,componentNormalizer/* default */.Z)(pivot_PaneSwitchvue_type_script_lang_js,PaneSwitchvue_type_template_id_62177f0f_scoped_true_render,PaneSwitchvue_type_template_id_62177f0f_scoped_true_staticRenderFns,!1,null,"62177f0f",null)
/* harmony default export */,PaneSwitch=PaneSwitch_component.exports,utils_utility_methods=__webpack_require__(555005),FReportOptions=__webpack_require__(791514),AddFormulaDialogvue_type_template_id_ae6db264_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"pivot-add-row"},[_c("el-dialog",{staticClass:"pivot-add-row-dialog",attrs:{visible:_vm.visibility,"show-close":!1,"append-to-body":!0,title:_vm.$t("pivot.addFormula"),width:"50%"}},[_c("div",{staticClass:"body"},[_c("el-row",{staticClass:"mT20"},[_c("el-row",[_vm._v(" "+_vm._s(_vm.$t("pivot.formulaName"))+" ")]),_c("el-row",[_c("el-input",{staticClass:"fc-input-full-border2 mT10",attrs:{placeholder:"Formula Name"},model:{value:_vm.columnName,callback:function($$v){_vm.columnName=$$v},expression:"columnName"}})],1)],1),_c("el-row",{staticClass:"mT20"},[_c("el-row",[_c("el-col",{attrs:{span:18}},[_vm._v(" "+_vm._s(_vm.$t("pivot.expression"))+" ")]),_c("el-col",{attrs:{span:6}},[_vm._v(" "+_vm._s(_vm.$t("pivot.dataType"))+" ")])],1),_c("el-row",{staticClass:"mB10"},[_c("el-col",{attrs:{span:18}},[_c("el-input",{staticClass:"fc-input-full-border2 mT10  width90",attrs:{placeholder:"A + B"},model:{value:_vm.expression,callback:function($$v){_vm.expression=$$v},expression:"expression"}})],1),_c("el-col",{attrs:{span:6}},[_c("el-select",{staticClass:"fc-input-full-border-select2 mT10 module-date-field-select",attrs:{filterable:"",placeholder:"Select"},model:{value:_vm.dataTypeEnum,callback:function($$v){_vm.dataTypeEnum=$$v},expression:"dataTypeEnum"}},_vm._l(_vm.dataTypeOptions,(function(data,index){return _c("el-option",{key:"module-date-field-option"+index,attrs:{label:data.displayName,value:data.value}})})),1)],1)],1)],1),_c("div",{staticClass:"fbVariableLegendContainer mT10 formulalengendscontainer"},[_c("div",{staticClass:"mB10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.columns"))+" ")]),_c("table",{attrs:{border:"0",cellspacing:"0",cellpadding:"0"}},_vm._l(_vm.pivotFieldMap,(function(point,index){return _c("tr",{key:index,staticClass:"fbVariableLegend"},[_c("td",{staticClass:"fbVariableLegend mL10"},[_vm._v(_vm._s(point.paramAlias))]),_c("td",{staticClass:"fbVariableLegefbVariableLegendContainerndInfo"},[_c("span",[_vm._v(_vm._s(point.label))])])])})),0)])],1),_c("div",{staticClass:"dialog-save-cancel"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.closeDialog}},[_vm._v(" "+_vm._s(_vm.$t("pivot.cancel")))]),_c("el-button",{staticClass:"modal-btn-save mL0",attrs:{type:"primary"},on:{click:_vm.save}},[_vm._v(_vm._s(_vm.$t("pivot.done")))])],1)])],1)},AddFormulaDialogvue_type_template_id_ae6db264_staticRenderFns=[],AddFormulaDialogvue_type_script_lang_js=(__webpack_require__(564043),__webpack_require__(709873),__webpack_require__(857267),{props:["visibility","editConfig","pivotFieldMap","index","moduleName","formatConfig"],computed:{paramsMap:function(){var params={};return this.pivotFieldMap.forEach((function(pivotField){params[pivotField.paramAlias]=pivotField.alias})),params}},data:function(){return{meta:{},columnName:null,expression:null,dataTypeEnum:null,variablesUsedInExp:[],variableMap:{},dataTypeOptions:[{displayName:"Date",value:"DATE_TIME"},{displayName:"String",value:"STRING"},{displayName:"Number",value:"NUMBER"},{displayName:"Decimal",value:"DECIMAL"},{displayName:"Boolean",value:"BOOLEAN"}]}},created:function(){this.editConfig&&(this.columnName=this.formatConfig.label,this.expression=this.editConfig.expression,this.dataTypeEnum=this.editConfig.dataTypeEnum)},methods:{closeDialog:function(){this.editConfig&&this.$emit("updateCancel"),this.$emit("update:visibility",!1)},initExpressionParams:function(){var _this=this,params=Object.keys(this.paramsMap),regExString=/\(|\)|\+|\-|\\|\*|\/|\ |\%|\~|\&|\^|\>|\<|\=|\!/,expressionArray=this.expression.split(regExString);return expressionArray.forEach((function(variable){variable=variable.replace(" ","");var index=params.findIndex((function(p){return p==variable}));if(-1!=index){var alias=_this.paramsMap[variable];_this.variablesUsedInExp.push(alias),_this.variableMap[alias]=variable}})),this.expression},save:function(){if(this.columnName&&this.expression||null!=this.dataType){this.initExpressionParams();var config={columnName:this.columnName,dataTypeEnum:this.dataTypeEnum,moduleName:this.moduleName,expression:this.expression,variableMap:this.variableMap,field:null,criteria:null},formatting=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},PivotDefaults/* defaultColFormat */.WW.formulaColumn),{},{label:this.columnName});this.editConfig?(config.alias=this.editConfig.alias,this.$emit("update",{params:{data:config,formatting:formatting},index:this.index})):this.$emit("save",{data:config,formatting:formatting})}}}}),pivot_AddFormulaDialogvue_type_script_lang_js=AddFormulaDialogvue_type_script_lang_js,AddFormulaDialog_component=(0,componentNormalizer/* default */.Z)(pivot_AddFormulaDialogvue_type_script_lang_js,AddFormulaDialogvue_type_template_id_ae6db264_render,AddFormulaDialogvue_type_template_id_ae6db264_staticRenderFns,!1,null,null,null)
/* harmony default export */,AddFormulaDialog=AddFormulaDialog_component.exports,ConditionalFormatDialogvue_type_template_id_5576ae30_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"pivot-add-criteria"},[_c("el-dialog",{staticClass:"pivot-add-criteria-dialog",attrs:{visible:_vm.visibility,"show-close":!1,"append-to-body":!0,title:_vm.$t("pivot.conditionalFormatting"),width:"50%"}},[_c("div",{staticClass:"body"},[_vm.loading?_vm._e():_c("div",{staticClass:"pivot-add-criteria-dialog  p10"},[_c("el-collapse",{staticClass:"new-rule-collapse position-relative controllogic-collapse",attrs:{accordion:!0},model:{value:_vm.activeNames,callback:function($$v){_vm.activeNames=$$v},expression:"activeNames"}},[_c("draggable",{attrs:{list:_vm.conditionalFormatting,options:_vm.draggableOptions},on:{change:_vm.handleReorder}},_vm._l(_vm.conditionalFormatting,(function(conditional,index){return _c("el-collapse-item",{key:index,staticClass:"rule-border-blue mT20 position-relative",staticStyle:{"border-left":"1px solid rgb(228, 235, 241)"},attrs:{name:index}},[_c("template",{slot:"title"},[_c("div",{staticClass:"task-handle mR10 pointer"},[_c("img",{attrs:{src:__webpack_require__(271791)}})]),_vm._v(" "+_vm._s(_vm.$t("pivot.conditionalRule"))+" "+_vm._s(index+1)+" ")]),_c("div",{staticClass:"pT20"},[_c("div",{staticClass:"conditional-formatting"},[_c("new-criteria-builder",{key:_vm.refreshKey,staticClass:"graphics-criteria-builder",attrs:{title:_vm.$t("pivot.specifyCondition"),exrule:conditional.criteria,showSiteField:!0,module:"pivotbuilder",variables:_vm.filteredVariables},on:{condition:function(criteria){return _vm.getCriteria(criteria,index)}}}),_c("div",{staticClass:"style-container pB20"},[_c("el-row",[_c("label",{staticClass:"fc-modal-sub-title",attrs:{for:"name"}},[_vm._v(_vm._s(_vm.$t("pivot.formatting")))]),_c("div",{staticClass:"fc-sub-title-desc"},[_vm._v(" "+_vm._s(_vm.$t("pivot.specifyStyles"))+" ")])]),_c("el-row",{staticClass:"mT10",attrs:{gutter:10}},[_c("el-col",{attrs:{span:7}},[_c("div",{staticClass:"fc-input-label-txt mb5"},[_vm._v(" "+_vm._s(_vm.$t("pivot.cellBackground"))+" ")]),_c("div",{staticClass:"fc-color-picker card-color-container"},[_c("el-color-picker",{attrs:{predefine:_vm.getPredefinedColors()},model:{value:conditional.styles.bgColor,callback:function($$v){_vm.$set(conditional.styles,"bgColor",$$v)},expression:"conditional.styles.bgColor"}})],1)]),_c("el-col",{attrs:{span:7}},[_c("div",{staticClass:"fc-input-label-txt mb5"},[_vm._v(" "+_vm._s(_vm.$t("pivot.textBackground"))+" ")]),_c("div",{staticClass:"fc-color-picker card-color-container"},[_c("el-color-picker",{attrs:{predefine:_vm.getPredefinedColors()},model:{value:conditional.styles.textBgColor,callback:function($$v){_vm.$set(conditional.styles,"textBgColor",$$v)},expression:"conditional.styles.textBgColor"}})],1)]),_c("el-col",{attrs:{span:7}},[_c("div",{staticClass:"fc-input-label-txt mb5"},[_vm._v(" "+_vm._s(_vm.$t("pivot.textColor"))+" ")]),_c("div",{staticClass:"fc-color-picker card-color-container"},[_c("el-color-picker",{attrs:{predefine:_vm.getPredefinedColors()},model:{value:conditional.styles.textColor,callback:function($$v){_vm.$set(conditional.styles,"textColor",$$v)},expression:"conditional.styles.textColor"}})],1)])],1),_c("el-row",{staticClass:"mT20"},[_c("el-col",{attrs:{span:11}},[_c("p",{staticClass:"fc-input-label-txt pB5"},[_vm._v(" "+_vm._s(_vm.$t("pivot.displayValue"))+" ")]),_c("div",[_c("el-input",{staticClass:"fc-border-select",model:{value:conditional.styles.displayValue,callback:function($$v){_vm.$set(conditional.styles,"displayValue",$$v)},expression:"conditional.styles.displayValue"}})],1)]),_c("el-col",{attrs:{span:11}},[_c("p",{staticClass:"fc-input-label-txt pB5 mL10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.textStyle"))+" ")]),_c("div",[_c("el-select",{staticClass:"fc-border-select mL10 width100",attrs:{multiple:!0},model:{value:conditional.styles.textStyle,callback:function($$v){_vm.$set(conditional.styles,"textStyle",$$v)},expression:"conditional.styles.textStyle"}},[_c("el-option",{attrs:{label:_vm.$t("pivot.italic"),value:"italic"}}),_c("el-option",{attrs:{label:_vm.$t("pivot.bold"),value:"bold"}}),_c("el-option",{attrs:{label:"Strikethrough",value:"strike-through"}})],1)],1)])],1),_c("el-row",{staticClass:"mT20"},[conditional.styles.hasOwnProperty("blink")?_c("el-col",{attrs:{span:12}},[_c("div",[_c("el-checkbox",{model:{value:conditional.styles.blink,callback:function($$v){_vm.$set(conditional.styles,"blink",$$v)},expression:"conditional.styles.blink"}},[_vm._v(_vm._s(_vm.$t("pivot.blink")))])],1)]):_vm._e()],1)],1)],1),_vm.conditionalFormatting.length>1?_c("img",{staticClass:"delete-icon pointer",staticStyle:{height:"18px",width:"18px","margin-right":"3px"},attrs:{src:__webpack_require__(385769)},on:{click:function($event){return _vm.deleteRule(index)}}}):_vm._e()])],2)})),1)],1),_c("el-button",{staticClass:"fc-btn-green-medium-fill mT20 f14 fwBold",attrs:{type:"primary",icon:"el-icon-plus",circle:""},on:{click:_vm.addRule}})],1)]),_c("div",{staticClass:"dialog-save-cancel"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.closeDialog}},[_vm._v(" "+_vm._s(_vm.$t("pivot.cancel")))]),_c("el-button",{staticClass:"modal-btn-save mL0",attrs:{type:"primary"},on:{click:_vm.save}},[_vm._v(_vm._s(_vm.$t("pivot.done")))])],1)])],1)},ConditionalFormatDialogvue_type_template_id_5576ae30_staticRenderFns=[],colors=__webpack_require__(519898),card_constants=__webpack_require__(806186),ConditionalFormatDialogvue_type_script_lang_js={props:["variables","visibility","alias","editConfig"],components:{NewCriteriaBuilder:NewCriteriaBuilder/* default */.Z,draggable:vuedraggable_umd_default()},data:function(){return{loading:!1,predefinedColors:card_constants/* predefinedColors */.UH,activeNames:0,conditionalFormatting:[],draggableOptions:{animation:150,easing:"cubic-bezier(1, 0, 0, 1)",group:"tasksection",sort:!0},refreshKey:0}},mounted:function(){this.initConditionalFormatting()},watch:{visibility:function(){this.initConditionalFormatting()}},computed:{filteredVariables:function(){return this.variables}},methods:{rerender:function(){var _this=this;this.loading=!0,setTimeout((function(){_this.loading=!1,_this.cleardata()}),500)},cleardata:function(){this.conditionalFormatting=[],this.addRule()},initConditionalFormatting:function(){(0,validation/* isEmpty */.xb)(this.editConfig)||(0,validation/* isUndefined */.o8)(this.editConfig)?(this.conditionalFormatting=[],this.addRule()):this.conditionalFormatting=JSON.parse(JSON.stringify(this.editConfig))},getCriteria:function(criteria,index){this.conditionalFormatting[index]&&(this.conditionalFormatting[index].criteria=criteria)},getPredefinedColors:function(){return colors/* default */.Z.readingcardColors},deleteRule:function(key){this.conditionalFormatting.splice(key,1)},handleReorder:function(){this.refreshKey++},getEmptyCFObject:function(){var cf={criteria:{pattern:""},styles:{}};return cf.styles=this.setAdditionalStats(cf.styles),cf},setAdditionalStats:function(styles){return this.$set(styles,"blink",!1),this.$set(styles,"displayValue",null),this.$set(styles,"textStyle","normal"),this.$set(styles,"textBgColor",null),this.$set(styles,"textColor",null),this.$set(styles,"bgColor",null),styles},addRule:function(){this.conditionalFormatting.push(this.getEmptyCFObject())},save:function(){this.$emit("conditionFormatAdded",{prop:this.alias,formatting:this.conditionalFormatting}),this.$emit("update:visibility",!1)},closeDialog:function(){this.$emit("closeDialog")}}},pivot_ConditionalFormatDialogvue_type_script_lang_js=ConditionalFormatDialogvue_type_script_lang_js,ConditionalFormatDialog_component=(0,componentNormalizer/* default */.Z)(pivot_ConditionalFormatDialogvue_type_script_lang_js,ConditionalFormatDialogvue_type_template_id_5576ae30_render,ConditionalFormatDialogvue_type_template_id_5576ae30_staticRenderFns,!1,null,null,null)
/* harmony default export */,ConditionalFormatDialog=ConditionalFormatDialog_component.exports,CellVisualizationDialogvue_type_template_id_77213e15_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"pivot-add-data-dialog",attrs:{visible:_vm.visibility,"show-close":!1,"append-to-body":!0,title:_vm.$t("pivot.cellVisualization"),width:"40%"}},[_c("div",[_c("div",{staticClass:"body"},[_c("div",{staticClass:"pivot-cell-visual-dialog-wrapper"},[_c("div",{staticClass:"pivot-visual-config-section width60"},[_c("div",{staticClass:"visual-data-column"},[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.visualType"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border-select2  mT5 module-date-field-select width90",attrs:{filterable:"","default-first-option":!0,placeholder:"Select"},model:{value:_vm.visualConfig.visualType,callback:function($$v){_vm.$set(_vm.visualConfig,"visualType",$$v)},expression:"visualConfig.visualType"}},[_c("el-option",{key:"visual-type-option-1",attrs:{label:"Text",value:"text"}}),_c("el-option",{key:"visual-type-option-2",attrs:{label:"Data bar",value:"data-bar"}}),_c("el-option",{key:"visual-type-option-3",attrs:{label:"Compare",value:"compare"}}),_c("el-option",{key:"visual-type-option-4",attrs:{label:"Circle",value:"circle"}})],1)],1),_vm.visualConfig.visualType&&"text"!=_vm.visualConfig.visualType?_c("div",{staticClass:"progress-bar-settings"},[_c("div",{staticClass:"reference-value-difference  mT10"},[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.compareWith"))+" ")]),_c("el-radio-group",{staticClass:"fc-input-full-border-select2 mT10 module-select",on:{change:_vm.updateCompareWithValue},model:{value:_vm.compareWithModel,callback:function($$v){_vm.compareWithModel=$$v},expression:"compareWithModel"}},[_c("el-radio-button",{attrs:{label:_vm.$t("pivot.maxValue")}}),_c("el-radio-button",{attrs:{label:_vm.$t("pivot.constant")}}),_c("el-radio-button",{attrs:{label:_vm.$t("pivot.referenceColumn")}})],1)],1),"referenceColumn"==_vm.visualConfig.compareWith?_c("div",{staticClass:"reference-data-column"},[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.referenceColumn"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border-select2  mT5 module-date-field-select width90",attrs:{filterable:"",placeholder:"Select"},model:{value:_vm.visualConfig.referenceAlias,callback:function($$v){_vm.$set(_vm.visualConfig,"referenceAlias",$$v)},expression:"visualConfig.referenceAlias"}},_vm._l(_vm.referenceOptions,(function(dataColumn,index){return _c("el-option",{key:"reference-data-field-option"+index,attrs:{label:dataColumn.label,value:dataColumn.alias}})})),1)],1):_vm._e(),"constant"==_vm.visualConfig.compareWith?_c("div",{staticClass:"reference-data-column "},[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.constantValue"))+" ")]),_c("el-input",{staticClass:"fc-input-full-border2 mT10 width90",attrs:{placeholder:"Constant Value"},model:{value:_vm.visualConfig.constantValue,callback:function($$v){_vm.$set(_vm.visualConfig,"constantValue",$$v)},expression:"visualConfig.constantValue"}})],1):_vm._e(),_c("el-row",{staticClass:"color-picker-section-fill-color  mT10"},[_vm.showFillColor?_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"fill-color-wrapper"},[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mb5"},[_vm._v(" "+_vm._s(_vm.$t("pivot.fillColor"))+" ")]),_c("div",{staticClass:"fc-color-picker card-color-container mT5"},[_c("el-color-picker",{attrs:{predefine:_vm.getPredefinedColors()},model:{value:_vm.visualConfig.fillColor,callback:function($$v){_vm.$set(_vm.visualConfig,"fillColor",$$v)},expression:"visualConfig.fillColor"}})],1)])]):_vm._e(),_vm.showTextColor?_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"text-color"},[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25  mb5"},[_vm._v(" "+_vm._s(_vm.$t("pivot.textColor"))+" ")]),_c("div",{staticClass:"fc-color-picker card-color-container mT5"},[_c("el-color-picker",{attrs:{predefine:_vm.getPredefinedColors()},model:{value:_vm.visualConfig.textColor,callback:function($$v){_vm.$set(_vm.visualConfig,"textColor",$$v)},expression:"visualConfig.textColor"}})],1)])]):_vm._e()],1),_vm.showArrowColor?_c("el-row",{staticClass:"color-picker-section-arrow-color  mT10"},[_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"fill-color-wrapper"},[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25 mb5"},[_vm._v(" "+_vm._s(_vm.$t("pivot.upArrowColor"))+" ")]),_c("div",{staticClass:"fc-color-picker card-color-container mT5"},[_c("el-color-picker",{attrs:{predefine:_vm.getPredefinedColors()},model:{value:_vm.visualConfig.upArrowColor,callback:function($$v){_vm.$set(_vm.visualConfig,"upArrowColor",$$v)},expression:"visualConfig.upArrowColor"}})],1)])]),_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"text-color"},[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25  mb5"},[_vm._v(" "+_vm._s(_vm.$t("pivot.downArrowColor"))+" ")]),_c("div",{staticClass:"fc-color-picker card-color-container mT5"},[_c("el-color-picker",{attrs:{predefine:_vm.getPredefinedColors()},model:{value:_vm.visualConfig.downArrowColor,callback:function($$v){_vm.$set(_vm.visualConfig,"downArrowColor",$$v)},expression:"visualConfig.downArrowColor"}})],1)])])],1):_vm._e(),_vm.showValueOption?_c("div",{staticClass:"display-value mT10"},[_c("el-checkbox",{staticClass:"fc-grey7-12 f14 text-left line-height25  mT15",model:{value:_vm.visualConfig.showValue,callback:function($$v){_vm.$set(_vm.visualConfig,"showValue",$$v)},expression:"visualConfig.showValue"}},[_vm._v(_vm._s(_vm.$t("pivot.showValue")))])],1):_vm._e()],1):_vm._e()]),_c("div",{staticClass:"pivot-visual-preview-section width40 mT10 mL20"},[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25  mb5"},[_vm._v(" "+_vm._s(_vm.$t("pivot.preview"))+" ")]),"data-bar"==_vm.previewVisualType?_c("data-bar-view",{attrs:{value:_vm.previewValue,referenceValue:_vm.previewReferenceValue,visualConfig:_vm.visualConfig}}):"compare"==_vm.previewVisualType?_c("compare-view",{attrs:{value:_vm.previewValue,referenceValue:_vm.previewReferenceValue,visualConfig:_vm.visualConfig}}):"circle"==_vm.previewVisualType?_c("circle-view",{attrs:{value:_vm.previewValue,referenceValue:_vm.previewReferenceValue,visualConfig:_vm.visualConfig}}):_c("div",{staticClass:"text-preview"},[_vm._v(" "+_vm._s(_vm.previewValue)+" ")])],1)])]),_c("div",{staticClass:"dialog-save-cancel"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.closeDialog}},[_vm._v(" "+_vm._s(_vm.$t("pivot.cancel")))]),_c("el-button",{staticClass:"modal-btn-save mL0",attrs:{type:"primary"},on:{click:_vm.save}},[_vm._v(_vm._s(_vm.$t("pivot.done")))])],1)])])},CellVisualizationDialogvue_type_template_id_77213e15_scoped_true_staticRenderFns=[],DataBarView=__webpack_require__(959252),CompareView=__webpack_require__(51928),CircleView=__webpack_require__(971669),CellVisualizationDialogvue_type_script_lang_js={props:["alias","editConfig","visibility","referenceDataColumnOptions"],components:{DataBarView:DataBarView/* default */.Z,CompareView:CompareView/* default */.Z,CircleView:CircleView/* default */.Z},data:function(){return{visualConfig:{visualType:"text",compareWith:"maxValue",referenceAlias:null,constantValue:null,showValue:!1,upArrowColor:null,downArrowColor:null},compareWithModel:"Max value"}},computed:{referenceOptions:function(){var _this=this;return this.referenceDataColumnOptions.filter((function(option){return option.alias!=_this.alias}))},showFillColor:function(){return this.visualConfig.visualType&&"text"!=this.visualConfig.visualType&&"compare"!=this.visualConfig.visualType},showValueOption:function(){return this.visualConfig.visualType&&"text"!=this.visualConfig.visualType&&"compare"!=this.visualConfig.visualType},showTextColor:function(){return this.visualConfig&&"data-bar"==this.visualConfig.visualType},showArrowColor:function(){return this.visualConfig.visualType&&"compare"==this.visualConfig.visualType},previewVisualType:function(){return this.visualConfig.visualType},previewValue:function(){return 7},previewReferenceValue:function(){return 10}},mounted:function(){if(this.editConfig&&this.editConfig.visualType){this.visualConfig=JSON.parse(JSON.stringify(this.editConfig));var compareWith=this.visualConfig.compareWith;"maxValue"==compareWith?this.compareWithModel="Max value":"constant"==compareWith?this.compareWithModel="Constant":"referenceColumn"==compareWith&&(this.compareWithModel="Reference column")}},methods:{closeDialog:function(){this.$emit("closeDialog")},save:function(){this.$emit("cellVisualizationConfigAdded",{alias:this.alias,visualConfig:(0,objectSpread2/* default */.Z)({},this.visualConfig)})},getPredefinedColors:function(){return colors/* default */.Z.readingcardColors},updateCompareWithValue:function(label){"Max value"==label?this.visualConfig.compareWith="maxValue":"Constant"==label?this.visualConfig.compareWith="constant":"Reference column"==label&&(this.visualConfig.compareWith="referenceColumn")}}},pivot_CellVisualizationDialogvue_type_script_lang_js=CellVisualizationDialogvue_type_script_lang_js,CellVisualizationDialog_component=(0,componentNormalizer/* default */.Z)(pivot_CellVisualizationDialogvue_type_script_lang_js,CellVisualizationDialogvue_type_template_id_77213e15_scoped_true_render,CellVisualizationDialogvue_type_template_id_77213e15_scoped_true_staticRenderFns,!1,null,"77213e15",null)
/* harmony default export */,CellVisualizationDialog=CellVisualizationDialog_component.exports,field_utils=__webpack_require__(455344),PivotBuildervue_type_script_lang_js={name:"PivotBuilder",props:["id"],components:{FReportOptions:FReportOptions/* default */.Z,draggable:vuedraggable_umd_default(),AddRowDialog:AddRowDialog,AddDataDialog:AddDataDialog,AddCriteriaDialog:AddCriteriaDialog,PivotTable:PivotTable/* default */.Z,PaneSwitch:PaneSwitch,ColumnFormatDialog:ColumnFormatDialog,AddFormulaDialog:AddFormulaDialog,ConditionalFormatDialog:ConditionalFormatDialog,CellVisualizationDialog:CellVisualizationDialog},created:function(){var _this=this;this.$route.query.module&&!this.$route.query.reportId&&api/* API */.bl.get("v2/modules/meta/".concat(this.$route.query.module)).then((function(_ref){var error=_ref.error;error||(_this.isModuleAvailable=!0,_this.config.moduleName=_this.$route.query.module)})),this.loadModuleOptions().then((function(){var reportId=_this.$route.query.reportId;reportId&&api/* API */.bl.post("v2/report/executePivotReport",{reportId:reportId}).then((function(_ref2){var data=_ref2.data;_this.config.moduleName=data.report.module.name,_this.config.templateJSON=data.pivotTemplateJSON,_this.config.sortBy=data.sorting,_this.loadDateFields(),_this.reportObject.name=data.report.name,_this.config.rows=data.rows,_this.config.data=data.data,_this.config.formula=data.formula,_this.config.criteria=data.criteria,_this.config.startTime=data.startTime,_this.config.endTime=data.endTime,-1==data.startTime&&-1==data.endTime||(_this.config.showTimelineFilter=!0),_this.reportObject=data.report,_this.reportObject.reportType=5,_this.config.showTimelineFilter&&(_this.config.dateOperator=data.dateOperator,_this.config.dateValue=data.dateValue,_this.config.dateFieldId=data.dateField),_this.isModuleAvailable=!0,_this.configChanged(),_this.pivotUpdateReset()}))}))},watch:{"config.moduleName":{immediate:!0,handler:function(){
//clear all options when module changes
this.$route.query.reportId||(this.config.rows=[],this.config.data=[],this.config.formula=[],this.loadDateFields())}},"config.templateJSON.theme.number":{immediate:!0,handler:function(){this.configChanged()}}},computed:{isNewPivotReport:function(){return!this.reportId},reportId:function(){var reportId=this.id;return reportId&&!isNaN(reportId)?parseInt(reportId):null},dateFieldOptions:function(){var options=[];options.push({id:-99,displayName:"NONE"});var dateFields=this.dateFields||[];return options.push.apply(options,(0,toConsumableArray/* default */.Z)(dateFields)),options},isNoConfig:function(){return!(this.config.rows.length>0&&this.config.data.length>0)},referenceDataColumnOptions:function(){var _this$pivotTable,_this$pivotTable2,_this2=this;if(null===(_this$pivotTable=this.pivotTable)||void 0===_this$pivotTable||!_this$pivotTable.pivotAliasVsField)return[];var fielsAliases=Object.keys(null===(_this$pivotTable2=this.pivotTable)||void 0===_this$pivotTable2?void 0:_this$pivotTable2.pivotAliasVsField),formulaValidFieldAliases=[],pivotFieldMapLocal=[];return fielsAliases.forEach((function(key){if(key.startsWith("data"))formulaValidFieldAliases.push(key);else{var _this2$pivotTable,field=null===(_this2$pivotTable=_this2.pivotTable)||void 0===_this2$pivotTable?void 0:_this2$pivotTable.pivotAliasVsField[key];((0,field_utils/* isNumberField */.Z2)(field)||(0,field_utils/* isDecimalField */.No)(field))&&formulaValidFieldAliases.push(key)}})),formulaValidFieldAliases.forEach((function(alias){pivotFieldMapLocal.push({alias:alias,label:_this2.config.templateJSON.columnFormatting[alias].label})})),pivotFieldMapLocal},pivotFieldMap:function(){var _this$pivotTable3,_this3=this,fielsAliases=Object.keys(null===(_this$pivotTable3=this.pivotTable)||void 0===_this$pivotTable3?void 0:_this$pivotTable3.pivotAliasVsField),formulaValidFieldAliases=[],pivotFieldMapLocal=[];return fielsAliases.forEach((function(key){key.startsWith("formula")||formulaValidFieldAliases.push(key)})),formulaValidFieldAliases.forEach((function(alias){pivotFieldMapLocal.push({alias:alias,paramAlias:_this3.getCharAlias(alias),label:_this3.config.templateJSON.columnFormatting[alias].label})})),pivotFieldMapLocal.sort((function(a,b){return a.paramAlias>b.paramAlias?1:-1})),pivotFieldMapLocal}},data:function(){return{datePeriodOptions:PivotDefaults/* datePeriodOptions */.SD,draggableOptions:{animation:150,easing:"cubic-bezier(1, 0, 0, 1)",group:"tasksection",sort:!0},isModuleAvailable:!1,editConfig:null,
// edit config
editIndex:-1,
// edit index
formatConfig:null,moduleLoading:!0,moduleOptions:{systemModules:[],customModules:[]},rowOptions:[],
/**  PIVOT MODULE,ROW,DATA AND COLUMNS*/
showAddCriteriaDialog:!1,dateFields:null,
/** *****************/
showAddRowDialog:!1,showAddDataDialog:!1,showAddFormulaDialog:!1,fetchPivotDataError:!1,leftPaneVisibility:!0,leftPaneActiveTab:"CONFIG",
//CONFIG || SETTINGS
tableLoading:!1,reportObject:{name:"New Pivot table",reportType:5},pivotTable:null,pivotThemeOptions:PivotDefaults/* pivotThemeOptions */.Jr,charAliasMap:{},config:{showTimelineFilter:!1,templateJSON:{theme:PivotDefaults/* defaultTheme */.uH,columnFormatting:{}},moduleName:null,criteria:null,rows:[],data:[],formula:[],drillDown:2,dateOperator:28,dateValue:null,dateFieldId:-99,startTime:-1,endTime:-1,sortBy:{alias:null,order:3,limit:40}},columnFormatConfig:{field:null,visibility:!1,isDataColumn:!1},conditionalFormatConfig:{variables:[],visibility:!1,prop:null,editConfig:{}},cellVisualizationConfig:{alias:null,visibility:!1,editConfig:{}}}},methods:{handleTableSortIconClick:function(newSortBy){this.config.sortBy=newSortBy,this.configChanged()},toggleTimelineFilter:function(val){
//on enabling filter pivottable doesn't emit pickerChange ,only on subsequent changes so set initial start and endtimes here
if(val){var _NewDateHelper$getDat=(0,slicedToArray/* default */.Z)(NewDateHelper/* default */.Z.getDatePickerObject(this.config.dateOperator,this.config.dateValue).value,2),startTime=_NewDateHelper$getDat[0],endTime=_NewDateHelper$getDat[1];this.config.startTime=startTime,this.config.endTime=endTime,this.config.dateValue=startTime+","+endTime}else this.config.startTime=-1,this.config.endTime=-1;this.configChanged()},handlePickerChange:function(datePickerObj){
//set current state of date picker in config object
var _datePickerObj$value=(0,slicedToArray/* default */.Z)(datePickerObj.value,2),startTime=_datePickerObj$value[0],endTime=_datePickerObj$value[1];this.config.startTime=startTime,this.config.endTime=endTime,this.config.dateOperator=datePickerObj.operatorId,this.config.dateValue=startTime+","+endTime,this.configChanged()},loadDateFields:function(){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var _yield$API$get,data,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(_this4.config.moduleName){_context.next=2;break}return _context.abrupt("return");case 2:return _context.next=4,api/* API */.bl.get("v2/modules/meta/".concat(_this4.config.moduleName));case 4:_yield$API$get=_context.sent,data=_yield$API$get.data,error=_yield$API$get.error,error?_this4.$message.error("Error loading date fields for module"):_this4.dateFields=data.meta.fields.filter((function(field){return(0,utils_field/* isDateTypeField */.S6)(field)}));case 8:case"end":return _context.stop()}}),_callee)})))()},resetCriteria:function(){this.config.criteria=null,this.configChanged()},criteriaSaved:function(criteria){this.showAddCriteriaDialog=!1,this.config.criteria=criteria,this.configChanged()},handleReorder:function(){this.configChanged()},loadModuleOptions:function(){var _this5=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var resp,data,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,api/* API */.bl.get("/v2/automation/module");case 2:resp=_context2.sent,data=resp.data,error=resp.error,error?_this5.$message.error("Error loading module list"):(_this5.moduleOptions.systemModules=data.modules.filter((function(e){return!e.custom})),_this5.moduleOptions.customModules=data.modules.filter((function(e){return e.custom})),_this5.moduleLoading=!1);case 5:case"end":return _context2.stop()}}),_callee2)})))()},openAddRowDialog:function(){this.config.moduleName&&(this.showAddRowDialog=!0)},openAddDataDialog:function(){this.config.moduleName&&(this.showAddDataDialog=!0)},openAddFormulaDialog:function(){this.config.moduleName&&(this.showAddFormulaDialog=!0)},openAddCriteriaDialog:function(){this.config.moduleName&&(this.showAddCriteriaDialog=!0)},columnResizeEvent:function(_ref3){var width=_ref3.width,column=_ref3.column;this.config.templateJSON.columnFormatting[column].width=width,this.config.templateJSON.columnFormatting[column].autoWidth=!1},columnPinningEvent:function(_ref4){var prop=_ref4.prop,value=_ref4.value;this.config.templateJSON.columnFormatting[prop].isFixed=value,this.configChanged()},openCellVisualizationDialog:function(alias){if(this.cellVisualizationConfig.alias=alias,alias.startsWith("data")){var index=this.config.data.findIndex((function(dt){return dt.alias==alias}));if(-1!=index&&this.config.data[index].visualConfig){var editConfig=(0,objectSpread2/* default */.Z)({},this.config.data[index].visualConfig);this.cellVisualizationConfig.editConfig=editConfig}}else{var _index=this.config.formula.findIndex((function(dt){return dt.alias==alias}));if(-1!=_index&&this.config.formula[_index].visualConfig){var _editConfig=(0,objectSpread2/* default */.Z)({},this.config.formula[_index].visualConfig);this.cellVisualizationConfig.editConfig=_editConfig}}this.cellVisualizationConfig.visibility=!0},cellVisualizationConfigAdded:function(_ref5){var alias=_ref5.alias,visualConfig=_ref5.visualConfig;if(alias.startsWith("data")){var index=this.config.data.findIndex((function(dt){return dt.alias==alias}));-1!=index&&(this.config.data[index].visualConfig=visualConfig)}else{var _index2=this.config.formula.findIndex((function(dt){return dt.alias==alias}));-1!=_index2&&(this.config.formula[_index2].visualConfig=visualConfig)}this.cellVisualizationConfig={alias:null,visibility:!1,editConfig:{}},this.configChanged()},openColumnFormatDialog:function(prop){var field;!this.pivotTable||null!==prop&&void 0!==prop&&prop.startsWith("formula")?(prop&&prop.startsWith("data")?field=this.config.data.find((function(dt){return dt.alias==prop})):prop&&prop.startsWith("row")?field=this.config.rows.find((function(row){return row.alias==prop})):prop&&prop.startsWith("formula")&&(field=this.config.formula.find((function(formula){return formula.alias==prop}))),!field||null!==prop&&void 0!==prop&&prop.startsWith("formula")?this.columnFormatConfig.field=field:this.columnFormatConfig.field=field.field):this.columnFormatConfig.field=this.pivotTable.pivotAliasVsField[prop];prop.startsWith("data")?this.columnFormatConfig.isDataColumn=!0:this.columnFormatConfig.isDataColumn=!1,this.config.templateJSON.columnFormatting[prop].format&&(this.columnFormatConfig.editConfig=(0,objectSpread2/* default */.Z)({},this.config.templateJSON.columnFormatting[prop].format)),this.config.templateJSON.columnFormatting[prop].label&&(this.columnFormatConfig.fieldName=this.config.templateJSON.columnFormatting[prop].label),this.columnFormatConfig.alias=prop,this.columnFormatConfig.visibility=!0},openConditionalFormatDialog:function(prop){var _this6=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var columnConfig;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return columnConfig=_this6.config.templateJSON.columnFormatting[prop],_this6.conditionalFormatConfig.alias=prop,_context3.next=4,_this6.getConditionalFormattingFields();case 4:_this6.conditionalFormatConfig.fields=_context3.sent,null!==columnConfig&&void 0!==columnConfig&&columnConfig.conditionalFormat&&(_this6.conditionalFormatConfig.editConfig=columnConfig.conditionalFormat),_this6.conditionalFormatConfig.visibility=!0;case 7:case"end":return _context3.stop()}}),_callee3)})))()},getConditionalFormattingFields:function(){var _this7=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){var _yield$_this7$$http$p,data;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,_this7.$http.post("v2/report/pivotMetaFields",{rows:_this7.config.rows,data:_this7.config.data,formula:_this7.config.formula,columnFormatting:_this7.config.templateJSON.columnFormatting});case 2:return _yield$_this7$$http$p=_context4.sent,data=_yield$_this7$$http$p.data,_context4.abrupt("return",data.meta);case 5:case"end":return _context4.stop()}}),_callee4)})))()},conditionFormatAdded:function(_ref6){var prop=_ref6.prop,formatting=_ref6.formatting;this.config.templateJSON.columnFormatting[prop].conditionalFormat=formatting,this.conditionalFormatConfig.editConfig=[],this.conditionalFormatConfig.visibility=!1,this.configChanged()},columnFormatConfigAdded:function(_ref7){var alias=_ref7.alias,config=_ref7.config;this.config.templateJSON.columnFormatting[alias].format=config,this.columnFormatConfig.visibility=!1,this.configChanged()},columnTextWarpEvent:function(_ref8){var prop=_ref8.prop,value=_ref8.value;this.config.templateJSON.columnFormatting[prop].textWarp=value,this.configChanged()},hideShowRow:function(row){var prop=row.alias,currentValue=this.config.templateJSON.columnFormatting[prop].hideColumn;this.config.templateJSON.columnFormatting[prop].hideColumn=!currentValue,this.configChanged()},hideShowData:function(data){var prop=data.alias,currentValue=this.config.templateJSON.columnFormatting[prop].hideColumn;this.config.templateJSON.columnFormatting[prop].hideColumn=!currentValue,this.configChanged()},hideShowFormula:function(formula){var prop=formula.alias,currentValue=this.config.templateJSON.columnFormatting[prop].hideColumn;this.config.templateJSON.columnFormatting[prop].hideColumn=!currentValue,this.configChanged()},rowAdded:function(_ref9){var row=_ref9.row,formatting=_ref9.formatting;
//remove preffix and send aliases of exiting rows
row.alias="row_"+(0,utility_methods/* getUniqueCharAlias */.ip)(this.config.rows.map((function(e){return e.alias.split("_")[1]}))),this.config.templateJSON.columnFormatting[row.alias]=formatting,this.config.rows.push(row),this.showAddRowDialog=!1,this.configChanged()},isColumnHidden:function(prop){var style={};return this.config.templateJSON.columnFormatting[prop].hideColumn&&(style["opacity"]=.5),style},removeRow:function(row,rowIndex){var formulasUsed=this.getFormulasUsed(row.alias);if(formulasUsed.length>0){var messageString="This column used in the the formula ".concat(1==formulasUsed.length?"column":"columns"," ( ").concat(formulasUsed.join(", ")," ), please try again after removing it."),promptObj={title:"Delete Row",message:messageString,rbHide:!0};this.$dialog.confirm(promptObj)}else this.config.rows.splice(rowIndex,1),this.$delete(this.config.templateJSON.columnFormatting,row.alias),this.resetSortByColumn(row.alias),this.configChanged()},getFormulasUsed:function(alias){var _this8=this,result=[];return this.config.formula.forEach((function(formula){var variablesUsedInExp=Object.keys(formula.variableMap);variablesUsedInExp.forEach((function(val){val==alias&&result.push(_this8.config.templateJSON.columnFormatting[formula.alias].label)}))})),result},resetSortByColumn:function(alias){
//when sort by column is deleted  , set first row column as sort column
this.config.sortBy.alias==alias&&(this.config.sortBy.order=2,this.config.rows.length?this.config.sortBy.alias=this.config.rows[0].alias:this.config.sortBy.alias=null)},pivotDataAdded:function(_ref10){var data=_ref10.data,formatting=_ref10.formatting;data.alias="data_"+(0,utility_methods/* getUniqueCharAlias */.ip)(this.config.data.map((function(e){return e.alias.split("_")[1]}))),this.config.templateJSON.columnFormatting[data.alias]=formatting,this.config.data.push(data),this.showAddDataDialog=!1,this.configChanged()},removeData:function(data,dataIndex){var formulasUsed=this.getFormulasUsed(data.alias);if(formulasUsed.length>0){var messageString="This column used in the the formula ".concat(1==formulasUsed.length?"column":"columns"," ( ").concat(formulasUsed.join(", ")," ), please try again after removing it."),promptObj={title:"Delete Data",message:messageString,rbHide:!0};this.$dialog.confirm(promptObj)}else this.config.data.splice(dataIndex,1),this.$delete(this.config.templateJSON.columnFormatting,data.alias),this.resetSortByColumn(data.alias),this.configChanged()},pivotFormulaAdded:function(_ref11){var data=_ref11.data,formatting=_ref11.formatting;data.alias="formula_"+(0,utility_methods/* getUniqueCharAlias */.ip)(this.config.formula.map((function(e){return e.alias.split("_")[1]}))),this.config.templateJSON.columnFormatting[data.alias]=formatting,this.config.formula.push(data),this.showAddFormulaDialog=!1,this.configChanged()},pivotFormulaUpdated:function(_ref12){var params=_ref12.params,index=_ref12.index,data=params.data,formatting=params.formatting;
// data.alias =
//   'formula_' +
//   getUniqueCharAlias(this.config.formula.map(e => e.alias.split('_')[1]))
this.config.templateJSON.columnFormatting[data.alias]=formatting,this.config.formula[index]=data,this.showAddFormulaDialog=!1,this.configChanged(),this.pivotUpdateReset()},removeFormula:function(formula,formulaIndex){this.config.formula.splice(formulaIndex,1),this.$delete(this.config.templateJSON.columnFormatting,formula.alias),this.resetSortByColumn(formula.alias),this.configChanged()},editData:function(data,index){
// to remove observer
this.editConfig=JSON.parse(JSON.stringify(data)),this.formatConfig=this.config.templateJSON.columnFormatting[this.editConfig.alias],this.editIndex=index,this.showAddDataDialog=!0},editRow:function(row,index){this.editConfig=JSON.parse(JSON.stringify(row)),this.formatConfig=this.config.templateJSON.columnFormatting[this.editConfig.alias],this.editIndex=index,this.showAddRowDialog=!0},editFormula:function(formula,index){this.editConfig=JSON.parse(JSON.stringify(formula)),this.formatConfig=this.config.templateJSON.columnFormatting[this.editConfig.alias],this.editIndex=index,this.showAddFormulaDialog=!0},pivotDataUpdated:function(_ref13){var params=_ref13.params,index=_ref13.index,data=params.data,formatting=params.formatting;
// data.alias =
//   'data_' +
//   getUniqueCharAlias(this.config.data.map(e => e.alias.split('_')[1]))
this.config.templateJSON.columnFormatting[data.alias]=formatting,this.config.data[index]=data,this.showAddDataDialog=!1,this.configChanged(),this.pivotUpdateReset()},pivotUpdateReset:function(){this.editConfig=null,this.formatConfig=null,this.editIndex=-1},pivotRowUpdated:function(_ref14){var params=_ref14.params,index=_ref14.index,row=params.row,formatting=params.formatting;
// let { row, index } = params
// row.alias =
//   'row_' +
//   getUniqueCharAlias(this.config.rows.map(e => e.alias.split('_')[1]))
this.config.templateJSON.columnFormatting[row.alias]=formatting,this.config.rows[index]=row,this.showAddRowDialog=!1,this.configChanged(),this.pivotUpdateReset()},getCharAlias:function(alias){var _this9=this,index=Object.keys(this.charAliasMap).findIndex((function(e){return _this9.charAliasMap[e]==alias})),keys=Object.keys(this.charAliasMap);if(-1!=index)return keys[index];keys=keys.map((function(e){return e.toLowerCase()}));var varAlias=(0,utility_methods/* getUniqueCharAlias */.ip)(keys),result=varAlias.toUpperCase();return this.charAliasMap[result]=alias,result},configChanged:function(){var _this10=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee5(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context5){while(1)switch(_context5.prev=_context5.next){case 0:_this10.config.rows.length&&_this10.config.data.length&&(
//first time rows and data added ,set first row as sort column
_this10.config.sortBy.alias||(_this10.config.sortBy.alias=_this10.config.rows[0].alias),_this10.tableLoading=!0,_this10.fetchPivotData().then((function(data){_this10.pivotTable=data,_this10.tableLoading=!1})));case 1:case"end":return _context5.stop()}}),_callee5)})))()},getConfig:function(){var config=(0,objectSpread2/* default */.Z)({},this.config);return-1==this.config.startTime&&-1==this.config.endTime&&(delete config.startTime,delete config.endTime,delete config.dateValue,delete config.dateOperator,delete config.dateFieldId),config},fetchPivotData:function(){var _this11=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee6(){var serverConfig,_yield$API$post,data,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context6){while(1)switch(_context6.prev=_context6.next){case 0:return serverConfig=_this11.getSerializedParams(_this11.getConfig()),_context6.next=3,api/* API */.bl.post("v2/report/fetchTabularReportData",(0,objectSpread2/* default */.Z)({},serverConfig));case 3:if(_yield$API$post=_context6.sent,data=_yield$API$post.data,error=_yield$API$post.error,!error){_context6.next=10;break}_this11.fetchPivotDataError=!0,_context6.next=13;break;case 10:return _this11.fetchPivotDataError=!1,Object.freeze(data.pivotTableData),_context6.abrupt("return",data);case 13:case"end":return _context6.stop()}}),_callee6)})))()},getSerializedParams:function(config){var serializedConfig=(0,utility_methods/* deepCloneObject */.kh)(config);return serializedConfig.rows.forEach((function(row){row.field=(0,utils_utility_methods/* serializeProps */._$)(row.field,["id","name","moduleId","tableName","aggr"])})),serializedConfig.data.forEach((function(data){data.field?data.field=(0,utils_utility_methods/* serializeProps */._$)(data.field,["id","name","moduleId","tableName","aggr"]):data.readingField&&(data.readingField=(0,utils_utility_methods/* serializeProps */._$)(data.readingField,["id","name","moduleId","tableName","aggr"]))})),serializedConfig}}},pivot_PivotBuildervue_type_script_lang_js=PivotBuildervue_type_script_lang_js,PivotBuilder_component=(0,componentNormalizer/* default */.Z)(pivot_PivotBuildervue_type_script_lang_js,render,staticRenderFns,!1,null,"3c7a701a",null)
/* harmony default export */,PivotBuilder=PivotBuilder_component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/1648.js.map