"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[71981],{
/***/436756:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FDialogNew}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/FDialogNew.vue?vue&type=template&id=388b7f7a
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"costdialog",class:["f-dialog",_vm.customClass],attrs:{visible:_vm.visible,"before-close":_vm.close,width:_vm.width,"append-to-body":!0},on:{"update:visible":function($event){_vm.visible=$event}}},[_c("div",{staticClass:"f-dialog-title",attrs:{slot:"title"},slot:"title"},[_vm._t("header",(function(){return[_c("div",{staticClass:"label-txt-black fwBold"},[_vm._v(" "+_vm._s(_vm.title)+" ")])]}))],2),_c("div",{staticClass:"f-dialog-content",style:_vm.styleCss},[_vm._t("content"),_vm._t("default")],2),_c("div",{staticClass:"f-footer row",staticStyle:{height:"46px"}},[_vm._t("footer",(function(){return[_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.close}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.loading},on:{click:_vm.save}},[_vm._v(_vm._s(_vm.loading?_vm.loadingTitle||"Saving...":_vm.confirmTitle||"Save"))])],1)]}))],2)])},staticRenderFns=[],FDialogNewvue_type_script_lang_js={props:["title","confirmTitle","visible","customClass","width","maxHeight","stayOnSave","loading","loadingTitle","record"],computed:{styleCss:function(){return this.maxHeight?{"max-height":this.maxHeight,overflow:"scroll"}:null}},methods:{close:function(){this.$emit("close"),this.$emit("update:visible",!1)},save:function(){this.$emit("save"),this.stayOnSave||this.$emit("update:visible",!1)}}},components_FDialogNewvue_type_script_lang_js=FDialogNewvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FDialogNewvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FDialogNew=component.exports},
/***/673362:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return SpaceAssetMultiChooser}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/SpaceAssetMultiChooser.vue?vue&type=template&id=0ccc2fed
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{attrs:{visible:_vm.visibility,fullscreen:!1,open:"top",width:"60%","custom-class":" fc-dialog-up spaceassetchooser setup-dialog60","before-close":_vm.handleclose,"append-to-body":!0},on:{"update:visible":function($event){_vm.visibility=$event}}},[_c("div",{staticClass:"multi f-element",attrs:{id:"spaceassetchooser"}},[_vm.hideBanner?_vm._e():_c("banner",{attrs:{message:_vm.message,hideIcon:!_vm.selectedList.count}}),_c("div",{staticStyle:{height:"600px","overflow-y":"hidden"}},[_c("div",{staticStyle:{"background-color":"#ffffff",height:"100%",width:"100%",display:"inline-block"}},[_c("div",{staticClass:"flex-middle justify-content-space pT20 pL20 pR20"},[_vm.isAsset?_c("el-select",{staticClass:"inline asset-category fc-input-full-border2",attrs:{filterable:"",placeholder:_vm.assetCategory.placeHolder,disabled:!_vm.isAsset||_vm.disable},on:{change:_vm.onCategoryChange},model:{value:_vm.assetCategory.value,callback:function($$v){_vm.$set(_vm.assetCategory,"value",$$v)},expression:"assetCategory.value"}},_vm._l(_vm.assetCategory.options,(function(label,value){return _c("el-option",{key:value,attrs:{label:label,value:parseInt(value)}})})),1):_c("el-select",{staticClass:"inline asset-category fc-input-full-border2",attrs:{filterable:"",clearable:"",placeholder:_vm.spaceCategory.placeHolder},on:{change:_vm.onSpaceCategoryChange},model:{value:_vm.spaceCategory.value,callback:function($$v){_vm.$set(_vm.spaceCategory,"value",$$v)},expression:"spaceCategory.value"}},_vm._l(_vm.spaceCategory.options,(function(label,value){return _c("el-option",{key:value,attrs:{label:label,value:value}})})),1),_vm.hideBanner?_vm._e():_c("div",{staticClass:"pull-right"},[_c("el-radio-group",{on:{change:_vm.onIncludeTypeChange},model:{value:_vm.includeType,callback:function($$v){_vm.includeType=$$v},expression:"includeType"}},[_c("el-radio",{staticClass:"fc-radio",attrs:{label:"all"}},[_vm._v("All")]),_c("el-radio",{staticClass:"fc-radio",attrs:{label:"include"}},[_vm._v("Include")]),_c("el-radio",{staticClass:"fc-radio",attrs:{label:"exclude"}},[_vm._v("Exclude")])],1)],1)],1),_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"pT10 pB10",staticStyle:{"padding-left":"20px","padding-right":"20px","border-bottom":"1px solid #e6ecf3 !important"}},[_vm.showQuickSearch?_c("div",{staticStyle:{display:"inline-block",width:"100%"}},[_c("div",{staticClass:"col-6 fc-list-search"},[_c("div",{staticClass:"fc-list-search-wrapper relative chooser-search"},[_c("svg",{staticClass:"search-icon",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32"}},[_c("title",[_vm._v("search")]),_c("path",{attrs:{d:"M21.487 22.927l7.037 7.037c.473.473 1.238.475 1.71.003s.47-1.237-.003-1.71l-7.037-7.037c3.96-4.82 3.675-11.967-.846-16.487C17.539-.076 9.757-.092 4.966 4.699S.191 17.272 5 22.081c4.52 4.52 11.667 4.805 16.487.846zM6.679 6.413c3.848-3.848 10.099-3.836 13.962.027s3.875 10.114.027 13.962c-3.848 3.848-10.099 3.836-13.962-.027S2.831 10.261 6.679 6.413z"}})]),_c("input",{directives:[{name:"model",rawName:"v-model",value:_vm.quickSearchQuery,expression:"quickSearchQuery"}],ref:"quickSearchQuery",staticClass:"quick-search-input",attrs:{autofocus:"",type:"text",placeholder:"Search"},domProps:{value:_vm.quickSearchQuery},on:{keyup:function($event){return!$event.type.indexOf("key")&&_vm._k($event.keyCode,"enter",13,$event.key,"Enter")?null:_vm.setResourceData.apply(null,arguments)},input:function($event){$event.target.composing||(_vm.quickSearchQuery=$event.target.value)}}}),_c("svg",{staticClass:"close-icon",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32","aria-hidden":"true"},on:{click:_vm.toggleQuickSearch}},[_c("title",[_vm._v("close")]),_c("path",{attrs:{d:"M17.992 16l8.796-8.796a1.409 1.409 0 0 0-1.992-1.992L16 14.008 7.204 5.212a1.409 1.409 0 0 0-1.992 1.992L14.008 16l-8.796 8.796a1.409 1.409 0 0 0 1.992 1.992L16 17.992l8.796 8.796a1.409 1.409 0 0 0 1.992-1.992L17.992 16z"}})])])])]):_c("div",{staticClass:"asset-chooser-select-block"},[_vm._l(_vm.resourceConfig,(function(field){return _c("div",{key:field.spaceType,staticClass:"inline"},[!_vm.resourceType||_vm.resourceType.includes(field.spaceType+1)?_c("el-select",{attrs:{multiple:"","collapse-tags":"",filterable:"",clearable:"",placeholder:field.placeHolder,disabled:4===field.spaceType&&!_vm.isAsset||field.disabled},on:{change:function($event){return _vm.onLocationChange(field)}},model:{value:field.value,callback:function($$v){_vm.$set(field,"value",$$v)},expression:"field.value"}},_vm._l(field.options,(function(option){return _c("el-option",{key:option.id,attrs:{label:option.name,value:option.id}})})),1):_vm._e()],1)})),_c("span",{staticClass:"searchicon pull-right pointer"},[_c("span",{on:{click:_vm.toggleQuickSearch}},[_c("i",{staticClass:"el-icon-search"})])])],2)])])],1),_c("div",{staticClass:"scroll-multichooser"},[_c("el-row",[_c("el-col",{staticClass:"table-scroll-chooser",attrs:{span:_vm.hideBanner?16:24}},[_c("v-infinite-scroll",{staticStyle:{"max-height":"500px","overflow-y":"scroll","padding-bottom":"50px"},attrs:{loading:_vm.loading,offset:20},on:{bottom:_vm.nextPage}},[_c("table",{staticClass:" pT15 fc-list-view-table border-right-table"},[_c("thead",[_c("tr",{staticClass:"tablerow pT30",staticStyle:{"background-color":"#ffffff",padding:"15px"}},[_c("td",{staticClass:"headerrow "},[_c("el-checkbox",{attrs:{disabled:"exclude"===_vm.includeType&&!_vm.hideBanner},on:{change:_vm.onSelectAllChange},model:{value:_vm.selectall,callback:function($$v){_vm.selectall=$$v},expression:"selectall"}})],1),_c("td",{staticClass:"headerrow width30"},[_vm._v("#ID")]),_c("td",{staticClass:"headerrow width30"},[_vm._v("NAME")]),_c("td",{staticClass:"headerrow width30"},[_vm._v("CATEGORY")])])]),_c("tbody",[_vm._l(_vm.spaceList,(function(space){return _vm.isAsset?_vm._e():_c("tr",{key:space.id,staticClass:"tablerow",class:{selectedrow:space.selected}},[_c("td",{staticClass:"contentrow"},[_c("el-checkbox",{on:{change:function($event){return _vm.toggleSelect(space,!0)}},model:{value:space.selected,callback:function($$v){_vm.$set(space,"selected",$$v)},expression:"space.selected"}})],1),_c("td",{staticClass:"contentrow width30",on:{click:function($event){return $event.stopPropagation(),_vm.toggleSelect(space)}}},[_vm._v(" #"+_vm._s(1==space.spaceType?"SI"+space.id:2==space.spaceType?"BU"+space.id:3==space.spaceType?"FL"+space.id:4==space.spaceType?"SP"+space.id:space.id)+" ")]),_c("td",{staticClass:"contentrow width30",on:{click:function($event){return $event.stopPropagation(),_vm.toggleSelect(space)}}},[_vm._v(" "+_vm._s(space.name)+" ")]),_c("td",{staticClass:"contentrow width30"},[_vm._v(" "+_vm._s(space.spaceTypeVal)+" ")])])})),_vm._l(_vm.assetList,(function(asset){return _vm.isAsset?_c("tr",{key:asset.id,staticClass:"tablerow",class:{selectedrow:asset.selected}},[_c("td",{staticClass:"contentrow"},[_c("el-checkbox",{on:{change:function($event){return _vm.toggleSelect(asset,!0)}},model:{value:asset.selected,callback:function($$v){_vm.$set(asset,"selected",$$v)},expression:"asset.selected"}})],1),_c("td",{staticClass:"contentrow width30",on:{click:function($event){return $event.stopPropagation(),_vm.toggleSelect(asset)}}},[_vm._v(" #"+_vm._s(asset.id)+" ")]),_c("td",{staticClass:"contentrow width30",on:{click:function($event){return $event.stopPropagation(),_vm.toggleSelect(asset)}}},[_vm._v(" "+_vm._s(asset.name)+" ")]),_c("td",{staticClass:"contentrow width30"},[_vm._v(" "+_vm._s(asset.category?_vm.getAssetCategory(asset.category.id).displayName:"---")+" ")])]):_vm._e()})),_vm.spaceList&&_vm.spaceList.length<1&&_vm.assetList&&_vm.assetList.length<1?_c("tr",{staticStyle:{background:"none",border:"none","margin-top":"20px"}},[_c("td",{staticClass:"text-center label-txt-black",staticStyle:{"border-bottom":"none","font-size":"14px","padding-top":"40px",cursor:"auto"},attrs:{colspan:"100%"}},[_vm._v(" No "+_vm._s(_vm.isAsset?"Asset":"Space")+" to display! ")])]):_vm._e()],2)])])],1),_vm.hideBanner?_c("el-col",{staticClass:"chooser-selected-container",attrs:{span:8}},[_c("div",{staticClass:"chooser-scroll-block"},[_vm.selectedList&&_vm.selectedList.length?_c("div",{staticClass:"count-message"},[_vm._v(" "+_vm._s(_vm.message)+" ")]):_vm._e(),_vm._l(_vm.selectedList,(function(resource,value){return _c("div",{key:value,staticClass:"selected-field"},[_vm._v(" "+_vm._s(resource.name)+" "),_c("i",{staticClass:"el-icon-close remove",on:{click:function($event){return _vm.deSelect(resource)}}})])}))],2)]):_vm._e()],1)],1),_c("div",{staticClass:"f-footer row"},[_c("button",{staticClass:"footer-btn footer-btn-secondary col-6",attrs:{type:"button"},on:{click:_vm.handleclose}},[_c("span",[_vm._v("Cancel")])]),_c("button",{staticClass:"footer-btn footer-btn-primary col-6",attrs:{type:"button"},on:{click:_vm.associate}},[_c("span",[_vm._v("Ok")])])])],1)]),_c("div",{staticStyle:{position:"absolute",top:"45%",left:"45%","z-index":"5"}},[_c("spinner",{attrs:{show:_vm.resourceLoading,size:"70"}})],1)],1)])},staticRenderFns=[],objectSpread2=__webpack_require__(595082),v_infinite_scroll=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(670560),__webpack_require__(450886),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(339772),__webpack_require__(162506),__webpack_require__(561364)),v_infinite_scroll_default=__webpack_require__.n(v_infinite_scroll),ResourceMixin=__webpack_require__(22637),FBannervue_type_template_id_85b57242_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_vm.message?_c("div",{staticClass:"banner-block",style:{"background-color":_vm.bannerColor}},[_c("div",{staticClass:"banner-content"},[_c("i",{directives:[{name:"show",rawName:"v-show",value:!_vm.hideIcon,expression:"!hideIcon"}],class:["banner-icon flLeft",_vm.bannerIcon],style:{color:_vm.bannerTextColor},attrs:{"aria-hidden":"true"}}),_c("p",{staticClass:"banner-txt flLeft",style:{color:_vm.bannerTextColor}},[_vm._v(" "+_vm._s(_vm.message)+" ")])])]):_vm._e()])},FBannervue_type_template_id_85b57242_staticRenderFns=[],FBannervue_type_script_lang_js={props:["message","icon","color","textColor","hideIcon"],computed:{bannerColor:function(){var color;return this.color?color=this.color:this.isError||(color="#ecf3da"),color},bannerTextColor:function(){var color;return this.textColor?color=this.textColor:this.isError||(color="#67933a"),color},bannerIcon:function(){var icon;return this.icon?icon=this.icon:this.isError||(icon="el-icon-circle-check-outline"),icon}}},components_FBannervue_type_script_lang_js=FBannervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FBannervue_type_script_lang_js,FBannervue_type_template_id_85b57242_render,FBannervue_type_template_id_85b57242_staticRenderFns,!1,null,null,null)
/* harmony default export */,FBanner=component.exports,vuex_esm=__webpack_require__(420629),SpaceAssetMultiChooservue_type_script_lang_js={mixins:[ResourceMixin/* default */.Z],props:["visibility","disable","hideBanner"],components:{Banner:FBanner,VInfiniteScroll:v_infinite_scroll_default()},data:function(){return{selectall:!1,showQuickSearch:!1,includeType:"all",selectedList:[]}},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapGetters */.Se)(["getAssetCategory"])),{},{message:function(){var message,selectedCount=this.selectedList.length;if("all"===this.includeType&&this.categoryName)message="All "+this.categoryName+"s have been selected";else if("all"!==this.includeType&&selectedCount){var includeMsg;includeMsg=this.hideBanner?" Selected":"include"===this.includeType?" Included":" Excluded";var resource=(this.categoryName?this.categoryName:"")+(this.showAsset?" Asset":" Space");message=selectedCount+" "+resource+(selectedCount>1?"s":"")+includeMsg}else message=this.resourceType?"No Space Selected":"No Asset Selected";return message},categoryName:function(){return!this.assetCategory||this.assetCategory.value<=0?"":this.assetCategory.options[this.assetCategory.value]}}),created:function(){var _this=this;this.$store.dispatch("loadSpaceCategory"),this.$store.dispatch("loadAssetCategory").then((function(){_this.initResourceData()}))},watch:{visibility:function(val){val?this.reInit():val||!this.query||this.selectedList&&this.selectedList.length||this.$emit("associate",{})},query:function(val){this.quickSearchQuery=val,val&&(this.showQuickSearch=!0,this.setResourceData())},initialResourcesFecthed:function(val){val&&this.setInitialData()}},methods:{reInit:function(){this.showQuickSearch=!1,this.quickSearchQuery=null,this.checkAndInitResourceData()},deSelect:function(object){var resource=this.resourceList.find((function(resource){return resource.id===object.id}));resource?resource.selected=!1:resource=object,this.setSelectedResource(resource),this.setIncludeTypeOnChange()},handleclose:function(){this.$emit("update:visibility",!1),this.$emit("update:siteId",null)},openSpace:function(){this.isAsset=!1,this.loadSpace()},openAsset:function(){this.isAsset=!0,this.loadAsset()},associate:function(){var obj={};"all"!==this.includeType&&(obj.resourceList=this.selectedList,obj.isInclude="include"===this.includeType),this.$emit("associate",obj)},toggleQuickSearch:function(){var _this2=this;this.showQuickSearch=!this.showQuickSearch,this.showQuickSearch?this.$nextTick((function(){_this2.$refs.quickSearchQuery.focus()})):(this.quickSearchQuery=null,this.setResourceData())},onCategoryChange:function(){this.assetCategory.value?this.includeType="all":this.setIncludeTypeOnChange(),this.onCategorySelected(),this.selectedList=[]},onSpaceCategoryChange:function(){this.spaceCategory;this.onSpaceCategorySelected(),this.selectedList=[]},onSelectAllChange:function(){var _this3=this;this.selectedList=[],this.resourceList.forEach((function(resource){_this3.$set(resource,"selected",_this3.selectall),_this3.setSelectedResource(resource)})),this.setIncludeTypeOnChange()},toggleSelect:function(resource,alreadyChanged){alreadyChanged||this.$set(resource,"selected",!resource.selected),this.setSelectedResource(resource),this.selectall=this.selectedList.length===this.resourceList.length,this.setIncludeTypeOnChange()},setInitialData:function(){var _this4=this;if(this.initialData){var selectedResources=this.initialData.selectedResources;this.includeType=selectedResources&&selectedResources.length?this.initialData.isIncludeResource?"include":"exclude":"all";var idArray=[];selectedResources&&(this.selectedList=[],this.resourceList.forEach((function(resource){var resourceSelectedObj=_this4.initialData.selectedResources.some((function(selctedResource){return selctedResource.id===resource.id}));_this4.$set(resource,"selected",resourceSelectedObj),_this4.setSelectedResource(resource)}))),this.selectedList&&selectedResources&&this.selectedList.length<selectedResources.length&&(this.selectedList=[],this.initialData.selectedResources.forEach((function(d){idArray.push(d.id)})),this.$util.loadResource(idArray).then((function(fields){_this4.selectedList=fields})))}},setIncludeTypeOnChange:function(){"all"===this.includeType?this.includeType="include":this.selectedList.length||(this.includeType="all")},onIncludeTypeChange:function(){var _this5=this;"all"===this.includeType&&(this.resourceList.forEach((function(resource){_this5.$set(resource,"selected",!1)})),this.selectedList=[],this.selectall=!1)},isSelected:function(resourceId){return this.selectedList.find((function(resource){return resource.id===resourceId}))},onLocationChange:function(field){var _this6=this;this.onLocationSelected(field).then((function(){_this6.setListSelected()})),this.setIncludeTypeOnChange()},setResourceData:function(){var _this7=this;this.loadResourceData().then((function(){_this7.setListSelected()}))},setListSelected:function(){var _this8=this,selectedIds=this.selectedList.map((function(resource){return resource.id}));this.isAsset?this.assetList.map((function(asset){return selectedIds.includes(asset.id)&&_this8.$set(asset,"selected",!0),asset})):this.spaceList.map((function(space){return selectedIds.includes(space.id)&&_this8.$set(space,"selected",!0),space}))},setSelectedResource:function(resource){if(resource.selected)this.selectedList.push(this.$helpers.cloneObject(resource));else{var idx=this.selectedList.findIndex((function(sr){return sr.id===resource.id}));-1!==idx&&this.selectedList.splice(idx,1)}}}},components_SpaceAssetMultiChooservue_type_script_lang_js=SpaceAssetMultiChooservue_type_script_lang_js,SpaceAssetMultiChooser_component=(0,componentNormalizer/* default */.Z)(components_SpaceAssetMultiChooservue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,SpaceAssetMultiChooser=SpaceAssetMultiChooser_component.exports},
/***/681121:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return SetReadingValue}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/readings/SetReadingValue.vue?vue&type=template&id=f05d1da2
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("f-dialog",{attrs:{title:_vm.getTitle,visible:!0,loading:_vm.isSaving,stayOnSave:!0,record:_vm.record,width:_vm.$mobile?"90%":"30%"},on:{save:_vm.saveReading,close:_vm.closeDialog}},[_vm.readingObj?_c("div",{staticClass:"pB30 mT10",attrs:{slot:"content"},slot:"content"},[_c("div",{staticClass:"mb5"},[_vm._v(_vm._s(_vm.getSubTitle))]),_c("div",{staticStyle:{display:"flex"}},[_vm.isBooleanField(_vm.readingObj.field)?_c("div",{staticClass:"pT10 width60"},[_vm._v(" "+_vm._s(_vm.readingObj.field.falseVal||"False")+" "),_c("el-switch",{staticClass:"pL10 pR10",attrs:{disabled:_vm.isNullValueSelected},model:{value:_vm.readingObj.value,callback:function($$v){_vm.$set(_vm.readingObj,"value",$$v)},expression:"readingObj.value"}}),_vm._v(" "+_vm._s(_vm.readingObj.field.trueVal||"True")+" ")],1):_vm.isEnumField(_vm.readingObj.field)?_c("div",{staticClass:"width80"},[_c("el-select",{staticClass:"fc-input-full-border-select2 width90",attrs:{disabled:_vm.isNullValueSelected,filterable:"","collapse-tags":""},model:{value:_vm.readingObj.value,callback:function($$v){_vm.$set(_vm.readingObj,"value",$$v)},expression:"readingObj.value"}},_vm._l(_vm.fieldOptions,(function(item,index){return _c("el-option",{key:index,attrs:{label:item.label,value:item.value}})})),1)],1):_c("div",{staticClass:"width80"},[_c("el-input",{staticClass:"fc-input-full-border2 control-action-reading-field",staticStyle:{width:"90%","text-align":"left"},attrs:{disabled:_vm.isNullValueSelected,"controls-position":"right",type:_vm.fieldType},model:{value:_vm.readingObj.value,callback:function($$v){_vm.$set(_vm.readingObj,"value",$$v)},expression:"readingObj.value"}},[_vm.readingObj.field.unit?_c("template",{slot:"append"},[_vm._v(_vm._s(_vm.readingObj.field.unit)+" ")]):_vm._e()],2)],1),_c("div",{staticStyle:{"padding-top":"10px"}},[_c("el-checkbox",{on:{change:function($event){return _vm.changeValue()}},model:{value:_vm.isNullValueSelected,callback:function($$v){_vm.isNullValueSelected=$$v},expression:"isNullValueSelected"}},[_vm._v("null")])],1)])]):_c("div",{staticClass:"pB40 mT10"},[_vm._v("Loading....")])])},staticRenderFns=[],FDialogNew=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(434284),__webpack_require__(212826),__webpack_require__(436756)),validation=__webpack_require__(990260),utility_methods=__webpack_require__(555005),utils_field=__webpack_require__(815872),SetReadingValuevue_type_script_lang_js={props:["reading","saveAction","closeAction","recordId","recordName","fieldId","groupId","pointId"],components:{FDialog:FDialogNew/* default */.Z},data:function(){return{readingObj:null,isSaving:!1,record:null,recordLoading:!1,isNullValueSelected:!1}},created:function(){var _this=this;this.isBooleanField=utils_field/* isBooleanField */.Mw,this.isEnumField=utils_field/* isEnumField */.Ri,this.reading?this.readingObj=this.reading:this.groupId?this.$http.get("/v2/controlAction/getControlGroupMeta?controlGroupId="+this.groupId).then((function(response){response.data.result&&response.data.result.controlActionGroup&&(_this.readingObj=response.data.result.controlActionGroup)})):this.pointId?this.$http.get("/v2/controlAction/getControllablePoints").then((function(response){response.data.result&&response.data.result.controllablePoints&&response.data.result.controllablePoints.length&&(_this.readingObj=response.data.result.controllablePoints.find((function(rt){return rt.id===_this.pointId})))})):this.$util.loadLatestReading(this.recordId,!1,!1,null,this.fieldId).then((function(fields){fields&&fields.length&&(_this.readingObj=fields[0])}))},mounted:function(){var _this2=this;this.recordId&&(this.recordLoading=!0,this.$util.getAssetById(this.recordId).then((function(assetObj){_this2.record=assetObj,_this2.recordLoading=!1})))},computed:{fieldOptions:function(){return this.readingObj?(0,utility_methods/* constructFieldOptions */.aE)(this.readingObj.field.enumMap||[]):[]},fieldType:function(){var readingObj=this.readingObj,_ref=readingObj||{},field=_ref.field;return(0,validation/* isEmpty */.xb)(field)||!(0,utils_field/* isNumberField */.Z2)(field)&&!(0,utils_field/* isDecimalField */.No)(field)?"text":"number"},getTitle:function(){return this.readingObj?this.recordLoading?"Loading...":this.recordId&&this.record?this.record.name:this.readingObj.field.displayName:"Loading..."},getSubTitle:function(){return this.readingObj?this.recordLoading?"Loading...":this.recordId&&this.record?this.readingObj.field.displayName:"Set Reading":"Loading..."}},methods:{validate:function(){return(0,validation/* isEmpty */.xb)(this.readingObj.value)?(this.error=!0,this.errorMessage="Please enter a value for the reading"):(this.error=!1,this.errorMessage=""),!this.error},saveReading:function(){var _this$$util,_this3=this;if(this.isNullValueSelected||this.validate()){var newValue;this.isSaving=!0,newValue=null==this.readingObj.value?null:this.readingObj.value.toString();var data=[this.recordId,this.readingObj.field.fieldId,
// this.readingObj.value.toString(),
newValue,this.recordName,this.readingObj.field.displayName,this.groupId];(_this$$util=this.$util).setReadingValue.apply(_this$$util,data).then((function(){_this3.saveAction(_this3.readingObj),_this3.isSaving=!1})).catch((function(){_this3.isSaving=!1}))}},closeDialog:function(){this.closeAction(this.readingObj)},changeValue:function(){this.readingObj.value=null}}},readings_SetReadingValuevue_type_script_lang_js=SetReadingValuevue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(readings_SetReadingValuevue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,SetReadingValue=component.exports},
/***/971981:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return ControlGroupsList}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/controls/ControlPoints/ControlGroupsList.vue?vue&type=template&id=4bff15cd
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"height100 control-group-list-page"},[-1===_vm.openGroupId?_c("div",{staticClass:"fc-list-view p10 pT0 mT10 fc-list-table-container height100vh fc-table-td-height fc-table-viewchooser pB100 block",class:_vm.$route.query.search?"fc-list-table-search-scroll":""},[_vm.loading?_c("div",{staticClass:"flex-middle fc-empty-white"},[_c("spinner",{attrs:{show:_vm.loading,size:"80"}})],1):_c("div",[_c("el-table",{attrs:{data:_vm.controlgroupload,width:"100%",height:"auto",type:"index",index:_vm.indexMethod,fit:!0}},[_c("template",{slot:"empty"},[_c("img",{staticClass:"mT50",attrs:{src:__webpack_require__(15482),width:"100",height:"100"}}),_c("div",{staticClass:"mT10 label-txt-black f14 op6"},[_vm._v(" "+_vm._s(_vm.$t("common._products.no_control_groups_available"))+" ")])]),_c("el-table-column",{attrs:{fixed:"",label:"Name",width:"300",prop:"name"},scopedSlots:_vm._u([{key:"default",fn:function(scope){return[_c("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"top",animation:"shift-away",arrow:!0},expression:"{\n                placement: 'top',\n                animation: 'shift-away',\n                arrow: true,\n              }"}],staticClass:"max-width300px textoverflow-ellipsis",attrs:{title:scope.row.name}},[_vm._v(" "+_vm._s(scope.row.name)+" ")])]}}],null,!1,1376697849)}),_c("el-table-column",{attrs:{label:_vm.$t("common._common._asset_category"),width:"250",prop:""},scopedSlots:_vm._u([{key:"default",fn:function(scope){return[_vm._v(" "+_vm._s(scope.row.assetCategoryContext.displayName)+" ")]}}],null,!1,1274420593)}),_c("el-table-column",{attrs:{label:_vm.$t("common._common._space_asset"),width:"200",prop:""},scopedSlots:_vm._u([{key:"default",fn:function(scope){return[_vm._v(" "+_vm._s(_vm.getResourceName(scope.row))+" ")]}}],null,!1,1701061577)}),_c("el-table-column",{attrs:{label:_vm.$t("common.tabs._reading"),width:"200",prop:""},scopedSlots:_vm._u([{key:"default",fn:function(scope){return[_vm._v(" "+_vm._s(scope.row.field.displayName)+" ")]}}],null,!1,4019142124)}),_c("el-table-column",{attrs:{label:_vm.$t("common._common.is_sandbox"),width:"150",prop:""},scopedSlots:_vm._u([{key:"default",fn:function(scope){return[_c("el-switch",{staticClass:"Notification-toggle",attrs:{"active-value":1,"inactive-value":2,"active-color":"rgba(57, 178, 194, 0.8)","inactive-color":"#e5e5e5"},on:{change:function($event){return _vm.changestatus(scope.row,scope.row.mode)}},model:{value:scope.row.mode,callback:function($$v){_vm.$set(scope.row,"mode",$$v)},expression:"scope.row.mode"}})]}}],null,!1,1778877685)}),_c("el-table-column",{staticClass:"visibility-visible-actions",attrs:{label:"",width:"180",prop:""},scopedSlots:_vm._u([{key:"default",fn:function(scope){return[_c("button",{staticClass:"fc__border__btn visibility-hide-actions",staticStyle:{padding:"5px 16px"},on:{click:function($event){return _vm.setdialogShow(scope.row)}}},[_vm._v(" "+_vm._s(_vm.$t("common.header._command"))+" ")])]}}],null,!1,4010479801)}),_c("el-table-column",{staticClass:"visibility-visible-actions",attrs:{prop:"",label:"",width:"100"},scopedSlots:_vm._u([{key:"default",fn:function(scope){return[_c("div",{staticClass:"text-center"},[_c("i",{staticClass:"el-icon-edit pointer visibility-hide-actions",on:{click:function($event){return _vm.editControlGroup(scope.row)}}}),_c("i",{staticClass:"el-icon-delete pointer visibility-hide-actions mL10",on:{click:function($event){return _vm.deleteControlGroup(scope.row)}}})])]}}],null,!1,2319637925)})],2)],1)]):_vm._e(),_vm.controlPopup.visible?_c("SetReadingPopup",{staticClass:"setReadingDialog",attrs:{saveAction:_vm.resetControlValue,groupId:_vm.controlPopup.reading.id,reading:_vm.controlPopup.reading,closeAction:_vm.resetControlValue}}):_vm._e(),_vm.controlGroupVisible?_c("new-group-form",{attrs:{controlgroup:_vm.selectedControlGroup,visibility:_vm.controlGroupVisible},on:{"update:visibility":function($event){_vm.controlGroupVisible=$event}}}):_vm._e()],1)},staticRenderFns=[],objectSpread2=__webpack_require__(595082),NewControlGroupForm=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(434284),__webpack_require__(169358),__webpack_require__(665640)),SetReadingValue=__webpack_require__(681121),vuex_esm=__webpack_require__(420629),ControlGroupsListvue_type_script_lang_js={created:function(){this.$store.dispatch("loadAssetCategory")},data:function(){return{loading:!0,controlgroupload:[],controlGroupVisible:!1,selectedControlGroup:null,selectedScope:null,controlPopup:{visible:!1,reading:null}}},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({count:function(state){return state.rule.count}})),{},{openGroupId:function(){return this.$route.params.id?parseInt(this.$route.params.id):-1},assetCategoryList:function(){return this.$store.state.assetCategory},rules:function(state){return state.rule.rules}}),components:{NewGroupForm:NewControlGroupForm/* default */.Z,SetReadingPopup:SetReadingValue/* default */.Z},mounted:function(){this.loadGroupList()},methods:{loadGroupList:function(){var _this=this,self=this;self.loading=!0;var url="/v2/controlAction/getControlGroups";this.$http.get(url).then((function(response){200===response.status&&(_this.controlgroupload=response.data.result.controlActionGroups?response.data.result.controlActionGroups:[],_this.loading=!1)}))},getCategoryName:function(categoryId){if(categoryId>0&&this.assetCategoryList){var category=this.assetCategoryList.find((function(category){return category.id===categoryId}));if(category)return category.name}},getResourceName:function(rule){if(rule.assetCategoryId>0){var message,selectedCount,isIncluded=rule.includedResources&&rule.includedResources.length;isIncluded?selectedCount=rule.includedResources.length:rule.excludedResources&&rule.excludedResources.length&&(selectedCount=rule.excludedResources.length);var categoryName=this.getCategoryName(rule.assetCategoryId);return message=selectedCount?(isIncluded?selectedCount:"Some")+" "+categoryName+(!isIncluded||selectedCount>1?"s":""):"All "+categoryName+"s",message}return rule.resourceId>0?rule.matchedResources[Object.keys(rule.matchedResources)[0]].name:"---"},resetControlValue:function(){this.controlPopup={visible:!1,reading:null}},changestatus:function(scopeRow,mode){var jsonParams={controlGroup:{id:scopeRow.id,mode:mode}},self=this;self.$http.post("/v2/controlAction/updateControlGroup",jsonParams).then((function(response){var res=response.data.result;res&&res.controlGroup&&self.$message.success("Switched to "+(1===res.controlGroup.mode?"Sand Box":"Live")+" status successfully.")})).catch((function(error){}))},indexMethod:function(index){return 2*index},editControlGroup:function(controlData){this.controlGroupVisible=!0,this.selectedControlGroup=controlData},setdialogShow:function(value){this.controlPopup.visible=!0,this.controlPopup.reading=value},deleteControlGroup:function(scopeRow){var queryparams={controlGroup:{id:scopeRow.id}},self=this;self.$dialog.confirm({title:this.$t("common.header.delete_control_logic"),message:this.$t("common._common.are_you_want_delete_control_logic"),rbDanger:!0,rbLabel:this.$t("common._common.delete")}).then((function(value){value&&self.$http.post("/v2/controlAction/deleteControlGroup",queryparams).then((function(response){0===response.data.responseCode?self.$message.success(this.$t("common.products.control_group_deleted_successfully")):self.$message.error(response.data.message)}))}))}}},ControlPoints_ControlGroupsListvue_type_script_lang_js=ControlGroupsListvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(ControlPoints_ControlGroupsListvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,ControlGroupsList=component.exports},
/***/665640:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return NewControlGroupForm}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/controls/ControlPoints/NewControlGroupForm.vue?vue&type=template&id=410e97d8
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("el-dialog",{attrs:{visible:_vm.visibility,"before-close":_vm.closeDialog,"append-to-body":!0,"custom-class":"fc-dialog-form fc-dialog-right setup-dialog40 setup-dialog fc-animated slideInRight"},on:{"update:visible":function($event){_vm.visibility=$event}}},[_c("el-form",{ref:"controlgroup",attrs:{model:_vm.controlgroupData,"label-position":"top"}},[_c("div",{staticClass:"new-header-container"},[_c("div",{staticClass:"new-header-text"},[_c("div",{staticClass:"fc-setup-modal-title"},[_vm._v(" "+_vm._s(_vm.isNew?_vm.$t("common.header.new_control_group"):_vm.$t("common.header.edit_control_group"))+" ")])])]),_c("div",{staticClass:"new-body-modal"},[_c("el-form-item",{attrs:{label:"Name"}},[_c("el-input",{staticClass:"fc-input-full-border2",attrs:{autofocus:"",placeholder:_vm.$t("common.products.control_group_name")},model:{value:_vm.controlgroupData.name,callback:function($$v){_vm.$set(_vm.controlgroupData,"name",$$v)},expression:"controlgroupData.name"}})],1),_c("el-row",{attrs:{gutter:20}},[_c("el-col",{attrs:{span:12}},[_c("el-form-item",{attrs:{label:_vm.$t("common._common.asset_category")}},[_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{filterable:"",placeholder:_vm.$t("common._common.select")},on:{change:function($event){return _vm.loadThresholdFields(!0)}},model:{value:_vm.controlgroupData.assetCategoryId,callback:function($$v){_vm.$set(_vm.controlgroupData,"assetCategoryId",$$v)},expression:"controlgroupData.assetCategoryId"}},_vm._l(_vm.assetCategory,(function(category,index){return _c("el-option",{key:index,attrs:{label:category.displayName,value:parseInt(category.id)}})})),1)],1)],1),_c("el-col",{attrs:{span:12}},[_c("el-form-item",{attrs:{label:_vm.$t("common.products.assets")}},[_c("el-input",{staticClass:"fc-border-select fc-input-full-border-select2 width100",attrs:{disabled:""},model:{value:_vm.resourceLabel,callback:function($$v){_vm.resourceLabel=$$v},expression:"resourceLabel"}},[_c("i",{staticClass:"el-input__icon el-icon-search",staticStyle:{"line-height":"0px !important","font-size":"16px !important",cursor:"pointer"},attrs:{slot:"suffix"},on:{click:function($event){_vm.chooserVisibility=!0}},slot:"suffix"})])],1)],1)],1),_c("el-row",{attrs:{gutter:20}},[_c("el-col",{attrs:{span:12}},[_c("el-form-item",{attrs:{label:_vm.$t("common.tabs.reading")}},[_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{filterable:"",placeholder:_vm.$t("common.wo_report.select_reading")},on:{change:function($event){return _vm.setMetricModule(_vm.controlgroupData.metricFieldName)}},model:{value:_vm.controlgroupData.metricFieldName,callback:function($$v){_vm.$set(_vm.controlgroupData,"metricFieldName",$$v)},expression:"controlgroupData.metricFieldName"}},_vm._l(_vm.assetCategoryFields,(function(field){return _c("el-option",{key:field.name+field.id,attrs:{label:field.displayName,value:field.id}})})),1)],1)],1),_c("el-col",{attrs:{span:12}},[_c("el-form-item",{attrs:{label:_vm.$t("common.wo_report.buildings")}},[_c("el-select",{staticClass:"fc-tag width100",attrs:{"collapse-tags":"",multiple:"",filterable:"",placeholder:_vm.$t("common.wo_report.select_building")},model:{value:_vm.controlgroupData.buildings,callback:function($$v){_vm.$set(_vm.controlgroupData,"buildings",$$v)},expression:"controlgroupData.buildings"}},_vm._l(_vm.buildingListOptions,(function(building){return _c("el-option",{key:building.id,attrs:{label:building.name,value:building.id}})})),1)],1)],1)],1)],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){return _vm.closeDialog()}}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.saving},on:{click:function($event){return _vm.submitForm()}}},[_vm._v(" "+_vm._s(_vm.saving?_vm.$t("common._common.submitting"):_vm.$t("common._common._save")))])],1)])],1),_c("space-asset-multi-chooser",{attrs:{resourceType:[3],visibility:_vm.chooserVisibility,initialValues:_vm.resourceData,query:_vm.resourceQuery,showAsset:!0,disable:!0},on:{associate:_vm.associateResource,"update:visibility":function($event){_vm.chooserVisibility=$event}}})],1)},staticRenderFns=[],esm_typeof=__webpack_require__(103336),objectSpread2=__webpack_require__(595082),SpaceAssetMultiChooser=(__webpack_require__(450886),__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(434284),__webpack_require__(659749),__webpack_require__(386544),__webpack_require__(425728),__webpack_require__(169358),__webpack_require__(673362)),WorkFlowMixin=__webpack_require__(522098),vuex_esm=__webpack_require__(420629),NewControlGroupFormvue_type_script_lang_js={mixins:[WorkFlowMixin/* default */.Z],props:["visibility","isNew","controlgroup","floorobj","building"],data:function(){return{saving:!1,buildingListOptions:[],controlgroupData:{id:"",name:"",assetCategoryId:null,metricFieldName:null,buildings:null,floor:{id:null,name:""}},selectedResourceList:[],chooserVisibility:!1,resourceQuery:null,thresholdFields:null,assetCategoryFields:[],isIncludeResource:!1,resourceType:"asset"}},mounted:function(){this.getfetchGroup(),this.loadBuildingList(),this.init()},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({assetCategory:function(state){return state.assetCategory}})),{},{resourceData:function(){return{assetCategory:this.controlgroupData.assetCategoryId,isIncludeResource:this.isIncludeResource,selectedResources:Array.isArray(this.selectedResourceList)?this.selectedResourceList.map((function(resource){return{id:resource&&"object"===(0,esm_typeof/* default */.Z)(resource)?resource.id:resource}})):this.selectedResourceList.id}},isAsset:function(){return"asset"===this.resourceType},isMultiResource:function(){return this.isAsset&&(!this.controlgroupData||this.controlgroupData.assetCategoryId>0)},resourceLabel:function(){var _this=this;if(this.controlgroupData.assetCategoryId>0){var message,category=this.assetCategory.filter((function(d){return d.id===_this.controlgroupData.assetCategoryId})),selectedCount=this.selectedResourceList.length;if(selectedCount){var includeMsg=this.isIncludeResource?"included":"excluded";if(1===selectedCount)return this.selectedResourceList[0].name;message=selectedCount+" "+category[0].name+(selectedCount>1?"s":"")+" "+includeMsg}else message="All "+category[0].name+"s selected";return message}return this.selectedResourceList.id>0?this.selectedResourceList.name:null}}),watch:{isNew:function(){this.init()},created:function(){this.$store.dispatch("loadAssetCategory")}},components:{SpaceAssetMultiChooser:SpaceAssetMultiChooser/* default */.Z},methods:{init:function(){this.isNew?this.controlgroupData={name:"",assetCategoryId:null,metricFieldName:null,floor:{id:null,name:""},buildings:[]}:this.controlgroupData=this.controlgroup,
// load building list
this.isnew&&(this.floorobj=null),this.floorobj&&(
// if (!this.isnew) {
this.siteId=this.floorobj.siteId,this.loadBuildingList(),this.floor={name:this.floorobj&&this.floorobj.name?this.floorobj.name:null,area:this.floorobj.area>0?this.floorobj.area:null,maxOccupancy:this.floorobj&&this.floorobj.maxOccupancy>0?this.floorobj.maxOccupancy:null,description:this.floorobj.description,id:this.floorobj.id,building:{id:this.floorobj&&this.floorobj.building&&this.floorobj.building.id?parseInt(this.floorobj.building.id):null,name:this.floorobj.building&&this.floorobj.building.name?this.floorobj.building.name:this.building&&this.building.name?this.building.name:null}})},associateResource:function(selectedObj){"asset"===this.resourceType&&selectedObj.resourceList&&selectedObj.resourceList.length&&(this.selectedResourceList=selectedObj.resourceList,this.isIncludeResource=selectedObj.isInclude),this.chooserVisibility=!1,this.resourceQuery=null},loadThresholdFields:function(){var self=this;self.loading=!0,this.assetCategoryFields=[];var url="/v2/controlAction/getControllableFields?assetCategoryId="+this.controlgroupData.assetCategoryId;this.$http.get(url).then((function(response){200===response.status&&(response.data.result.controllableFields&&(self.assetCategoryFields=response.data.result.controllableFields),self.loading=!1)}))},loadAssets:function(){var self=this,url="/asset/all";this.$http.get(url).then((function(response){response.data&&(
// self.assetList = response.data.assets
self.isnew&&!self.isDependant||(self.isMultiResource?self.selectedResourceList=response.data.assets.filter((function(asset){return self.selectedResourceList.some((function(resource){return resource.id===asset.id}))})):self.selectedResource=response.data.assets.find((function(asset){return asset.id===self.selectedResource.id})),self.loadThresholdFields(self.isMultiResource)))}))},closeDialog:function(){this.$emit("update:visibility",!1)},loadBuildingList:function(){var _this2=this;this.$util.loadSpace(2,null,[{key:"site",value:this.siteId}]).then((function(response){_this2.buildingListOptions=response.basespaces}))},loadBuilding:function(){if(this.controlgroupData.building.name=this.controlgroupData.building.name,this.controlgroupData.building.id=parseInt(this.controlgroupData.building.id),!this.isnew){var self=this;self.$http.get("/floor/"+self.floorobj.id).then((function(response){self.floor=response.data.record}))}},submitForm:function(){var url,_this3=this,self=this;self.saving=!0;var payload={controlGroup:{name:this.controlgroupData.name,assetCategoryId:this.controlgroupData.assetCategoryId,fieldId:this.controlgroupData.metricFieldName,mode:1,controlGroupSpaces:this.controlgroupData.buildings.map((function(id){return{spaceId:id}})),controlGroupInclExclContexts:this.selectedResourceList.map((function(resource){return{resourceId:resource.id,isInclude:_this3.isIncludeResource}}))}};this.controlgroupData.id?(payload.controlGroup.id=this.controlgroupData.id,url="/v2/controlAction/updateControlGroup",self.$http.post(url,payload).then((function(response){0===response.data.responseCode?(_this3.controlgroupData={name:"",assetCategoryId:null,metricFieldName:null,floor:{id:null,name:""},buildings:[]},self.$message.success(_this3.$t("common.products.control_group_edited_successfully")),self.$emit("update:visibility",!1),self.$emit("saved")):self.$message.error(response.data.message),self.saving=!1})).catch((function(error){self.saving=!1,self.$message.error(_this3.$t("common.wo_report.unable_to_edit"))}))):(url="/v2/controlAction/addControlGroup",self.$http.post(url,payload).then((function(response){0===response.data.responseCode?(_this3.controlgroupData=response.data.result.controlgroup,_this3.controlgroupData={name:"",assetCategoryId:null,metricFieldName:null,floor:{id:null,name:""},buildings:[]},self.$message.success(_this3.$t("common.products.control_group_added_successfully")),self.$emit("update:visibility",!1),self.$emit("saved")):self.$message.error(response.data.message),self.saving=!1})).catch((function(error){self.$message.error(_this3.$t("common.wo_report.unable_to_add"))})))},getfetchGroup:function(){if(this.controlgroup){var self=this;self.loading=!0;var url="/v2/controlAction/getControlGroupMeta?controlGroupId="+this.controlgroup.id;this.$http.get(url).then((function(response){200===response.status&&(response.data.result.controlgroup&&(self.controlgroupData.name=response.data.result.controlgroup),self.loading=!1)}))}},groupRuleParse:function(group){group.controlgroupData.assetCategoryId>0?(this.resourceType="asset",group.controlgroupData.includedResources&&group.controlgroupData.includedResources.length?(this.isIncludeResource=!0,this.selectedResourceList=group.controlgroupData.includedResources.map((function(id){return{id:id}}))):group.controlgroupData.excludedResources&&(this.selectedResourceList=group.controlgroupData.excludedResources.map((function(id){return{id:id}}))),this.loadAssets()):(group.controlgroupData.assetCategoryId=null,this.selectedResourceList=group.controlgroupData.matchedResources[Object.keys(group.controlgroupData.matchedResources)[0]],2===this.selectedResourceList.resourceType?(this.resourceType="asset",this.loadAssets(),this.loadThresholdFields()):(this.resourceType="space",this.loadThresholdFields()))}}},ControlPoints_NewControlGroupFormvue_type_script_lang_js=NewControlGroupFormvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(ControlPoints_NewControlGroupFormvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,NewControlGroupForm=component.exports},
/***/15482:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"img/noData-light.3b5d6592.png";
/***/}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/71981.js.map