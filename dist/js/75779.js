(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[75779],{
/***/785869:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return Subheader}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/Subheader.vue?vue&type=template&id=fa337eb6
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"subheader-section",class:{filterclass:!0===_vm.querry}},[_c("div",{staticClass:"subheader-div"},[_c("ul",{staticClass:"subheader-tabs pull-left"},[_vm._t("prefix"),_vm._l(_vm.activeMenuList,(function(item,index){return[item.multilevel?_c("li",{key:index,staticClass:"sh-multilevel-header",class:{"router-link-exact-active active":_vm.getTabTitlenew(item)!==item.label||_vm.$route.params&&"chilleroverview"===_vm.$route.params.dashboardlink}},[_c("el-popover",{attrs:{placement:"bottom",width:"200","popper-class":"sh-popup-tree",trigger:"hover"},model:{value:_vm.closepop,callback:function($$v){_vm.closepop=$$v},expression:"closepop"}},[_vm._l(item.children,(function(d,index){return item.children?_c("div",{key:index,staticClass:"p5 parent-sh"},[_c("div",{staticClass:"sh-pop-parent p5 pointer",class:{active:d.path.path===_vm.$route.path},on:{click:function($event){return _vm.getparent(d)}}},[_vm._v(" "+_vm._s(d.label)+" ")]),d.children?_c("div",{staticClass:"p5 sh-con-header"},_vm._l(d.children,(function(c,idx){return d.children?_c("div",{key:idx,staticClass:"child-sh"},[_c("div",{staticClass:"sh-pop-child p5 pointer",class:{active:c.path.path===_vm.$route.path},on:{click:function($event){return _vm.getchild(c)}}},[_c("i",{staticClass:"fa fa-circle sh-indicater",class:{active:c.path.path===_vm.$route.path}}),_vm._v(_vm._s(c.label)+" ")])]):_vm._e()})),0):_vm._e()]):_vm._e()})),_c("a",{attrs:{slot:"reference"},slot:"reference"},[_vm._v(" "+_vm._s(_vm.getTabTitlenew(item))+" "),_c("i",{staticClass:"switch-icon-dropdown el-icon-arrow-down",staticStyle:{float:"right",margin:"5px"}})])],2),_c("div",{staticClass:"sh-selection-bar"})],1):item.disable?_c("li",{key:index,class:{"router-link-exact-active active":_vm.getTabTitle(item)!==item.label}},[_c("el-dropdown",{on:{command:_vm.openChild}},[_c("a",[_vm._v(" "+_vm._s(_vm.getTabTitle(item))+" "),_c("i",{staticClass:"switch-icon-dropdown el-icon-arrow-down",staticStyle:{float:"right",margin:"5px"}})]),_c("div",{staticClass:"sh-selection-bar"}),_c("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},_vm._l(item.childrens,(function(child,childindex){return _c("el-dropdown-item",{key:childindex,attrs:{command:{curentItem:child,parentItem:item},disabled:child.disable}},[_vm._v(_vm._s(child.label))])})),1)],1)],1):item.childrens||!_vm.showCurrentViewOnly||_vm.currentView===item.name?_c("router-link",{key:index,attrs:{tag:"li",to:item.childrens&&item.childrens.find((function(cl){return cl.path.path===_vm.$route.path}))?item.childrens.find((function(cl){return cl.path.path===_vm.$route.path})).path:item.path}},[_c("a",[_vm._v(_vm._s(_vm.getTabTitle(item)))]),item.childrens?_c("div",{staticStyle:{float:"right",margin:"3px"}},[_c("el-dropdown",{on:{command:_vm.openChild}},[_c("i",{staticClass:"switch-icon-dropdown el-icon-arrow-down"}),_c("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},_vm._l(item.childrens,(function(child,childindex){return _c("el-dropdown-item",{key:childindex,attrs:{command:{curentItem:child,parentItem:item},disabled:child.disable}},[_vm._v(_vm._s(child.label))])})),1)],1)],1):_vm._e(),item.disable?_vm._e():_c("div",{staticClass:"sh-selection-bar"})]):_vm._e()]})),_vm.moreMenuList.length&&!_vm.showCurrentViewOnly?_c("li",{staticClass:"pointer",class:{active:_vm.isMoreMenuActive}},[_c("div",[_c("svg",{staticStyle:{"enable-background":"new 0 0 408 408"},attrs:{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",id:"Capa_1",x:"0px",y:"0px",width:"18px",height:"18px",viewBox:"0 0 408 408","xml:space":"preserve"}},[_c("g",[_c("g",{attrs:{id:"more-horiz"}},[_c("path",{attrs:{d:"M51,153c-28.05,0-51,22.95-51,51s22.95,51,51,51s51-22.95,51-51S79.05,153,51,153z M357,153c-28.05,0-51,22.95-51,51    s22.95,51,51,51s51-22.95,51-51S385.05,153,357,153z M204,153c-28.05,0-51,22.95-51,51s22.95,51,51,51s51-22.95,51-51    S232.05,153,204,153z",fill:"#b1bdc9"}})])])])]),_c("q-popover",{ref:"shpopover",on:{open:_vm.moreMenuOpened,close:_vm.moreMenuClosed}},[_c("q-list",{staticClass:"scroll q-list-item",staticStyle:{"min-width":"150px"},attrs:{link:""}},[_vm._l(_vm.moreMenuList,(function(item,index){return _c("q-item",{key:index,on:{click:function($event){return _vm.openSubTab(item,index)}}},[_c("q-item-main",{staticStyle:{"font-size":"13px"},attrs:{label:item.label}})],1)})),_vm.showRearrange?_c("q-item",{staticClass:"rearrange-button",attrs:{menu:_vm.menu},on:{click:_vm.rearrange}},[_c("q-item-main",{staticStyle:{"font-size":"13px"},attrs:{label:_vm.$t("setup.users_management.rearrange")}})],1):_vm._e()],2)],1)],1):_vm._e()],2),_vm._t("suffix"),_c("div",{class:_vm.positionsheaders},[_vm._t("default")],2)],2)])},staticRenderFns=[],toConsumableArray=__webpack_require__(488478),quasar_esm=(__webpack_require__(670560),__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(538077),__webpack_require__(162506),__webpack_require__(564043),__webpack_require__(857267),__webpack_require__(634338),__webpack_require__(902918),__webpack_require__(450886),__webpack_require__(434284),__webpack_require__(641358)),Subheadervue_type_script_lang_js={computed:{currentView:function(){return this.$route.params.viewname},querry:function(){return""===this.$route.query.filters||!!this.$route.query.filters}},props:["menu","filtersRetain","newbtn","type","parent","positionsheader","showRearrange","listCount","showCurrentViewOnly","maxVisibleMenu"],components:{QPopover:quasar_esm/* QPopover */.oe,QList:quasar_esm/* QList */.tu,QItem:quasar_esm/* QItem */.ry,QItemMain:quasar_esm/* QItemMain */.Ui},data:function(){return{positionsheaders:"pull-right",closepop:!1,activeMenuList:[],moreMenuList:[],seletedvalue:null,isMoreMenuActive:!1}},watch:{$route:function(to,from){if(this.filtersRetain&&from.path!==to.path)for(var i=0;i<this.filtersRetain.length;i++){var key1=from.query.hasOwnProperty(this.filtersRetain[i]);key1&&this.$router.push({query:from.query})}this.setFirstMenu(),this.$emit("tabChange")},menu:function(newVal){this.multilevelheader()}},mounted:function(){this.multilevelheader()},methods:{getTabTitle:function(item){var _this=this;if(item.path.path!==this.$route.path&&item.childrens&&item.childrens.length){var child=item.childrens.find((function(it){return it.path.path===_this.$route.path}));if(child)return child.label}return item.label},getTabTitlenew:function(item){var _this2=this;if(item.path.path!==this.$route.path&&item.children&&item.children.length){var child=item.children.find((function(it){return it.path.path===_this2.$route.path})),ch=item.children.filter((function(it){return it.children}));if(child)return child.label;for(var i=0;i<ch.length;i++){var c=ch[i].children&&ch[i].children.find((function(rt){return rt.path.path===_this2.$route.path}));if(c)return c.label}}return item.label},getparent:function(data){data.path&&data.path.path&&(this.$router.push({path:data.path.path}),this.closepop=!1)},getchild:function(data){data.path&&data.path.path&&(this.$router.push({path:data.path.path}),this.closepop=!1)},selectheader:function(value,event){this.seletedvalue=value,this.$router.push(value[value.length-1])},multilevelheader:function(){this.seletedvalue=["/app/em/newdashboard/chilleroverview/391"],this.loadMenuList()},multiheaderClickEvent:function(){},callbackMethod:function(newVal){},handleFcAfterDateBack:function(data,event){},onClickChild:function(value){},openChild:function(obj){this.$router.push(obj.curentItem.path)},companyListSelected:function(label,id){},loadMenuList:function(){var self=this;self.positionsheaders=self.positionsheader||"pull-right",self.activeMenuList=[],self.moreMenuList=[];var accessibleMenu=this.menu.filter((function(m){return"undefined"===typeof m.permission||self.$hasPermission(m.permission)?m:void 0}));for(var idx in accessibleMenu)parseInt(idx)<(this.maxVisibleMenu||4)?this.activeMenuList.push(accessibleMenu[idx]):this.moreMenuList.push(accessibleMenu[idx]);this.setFirstMenu()},openSubTab:function(item,index,keepQuery){if(item&&item.disable&&item.childrens.length){var data=[];if(data=item.childrens.filter((function(rt){return rt.label!==item.label})),data.length){this.moreMenuList.splice(index,1);var lastMenu=this.activeMenuList.pop();this.moreMenuList.splice(0,0,lastMenu),this.activeMenuList.push(item),this.$router.push({path:data[0].path.path}),this.isMoreMenuActive&&this.$refs.shpopover.close()}}else{this.moreMenuList.splice(index,1);var _lastMenu=this.activeMenuList.pop();this.moreMenuList.splice(0,0,_lastMenu),this.activeMenuList.push(item),keepQuery?this.$router.replace({path:item.path.path,query:this.$route.query}):this.$router.push(item.path),this.isMoreMenuActive&&this.$refs.shpopover.close()}},setFirstMenu:function(){var _this3=this;if(this.parent&&(this.$route.path===this.parent||this.$route.path+"/"===this.parent)&&this.activeMenuList.length){var primaryView=this.activeMenuList.find((function(menu){return menu.primary}));primaryView||(primaryView=this.activeMenuList[0]),this.$router.replace({path:primaryView.path.path,query:this.$route.query,params:primaryView.path.params})}else this.checkAndSetMoreList(this.currentView);if(![].concat((0,toConsumableArray/* default */.Z)(this.activeMenuList),(0,toConsumableArray/* default */.Z)(this.moreMenuList)).find((function(menu){return menu.path.path===_this3.$route.path}))){var portfolio=[].concat((0,toConsumableArray/* default */.Z)(this.activeMenuList),(0,toConsumableArray/* default */.Z)(this.moreMenuList)).find((function(menu){return menu.path.path.endsWith("portfolio")}));if(portfolio&&null!==portfolio&&void 0!==portfolio&&portfolio.childrens){var currentBuilding=portfolio.childrens.find((function(menu){return menu.path.path===_this3.$route.path}));currentBuilding&&(currentBuilding.childrens=portfolio.childrens,this.activeMenuList.find((function(menu){return menu.path.path.endsWith("portfolio")}))?this.activeMenuList=this.activeMenuList.map((function(ele){return ele.path.path===portfolio.path.path?currentBuilding:ele})):this.moreMenuList=this.moreMenuList.map((function(ele){return ele.path.path===portfolio.path.path?currentBuilding:ele})))}else this.menu.length&&"/app/em/newdashboard"===this.$route.path&&(this.menu[0].disable&&this.menu[0].childrens&&this.menu[0].childrens.length>1&&this.menu[0].childrens[0].disable?this.$router.push(this.menu[0].childrens[1].path.path):this.$router.push(this.menu[0].path.path))}},moreMenuOpened:function(){this.isMoreMenuActive=!0},moreMenuClosed:function(){this.isMoreMenuActive=!1},checkAndSetMoreList:function(newView){if(newView){var index,menu=this.moreMenuList.find((function(menu,idx){if(menu.name===newView)return index=idx,!0}));menu&&this.openSubTab(menu,index,!0)}},rearrange:function(){this.$refs.shpopover.close(),this.$emit("rearrange")}}},components_Subheadervue_type_script_lang_js=Subheadervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_Subheadervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,Subheader=component.exports},
/***/795214:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return ViewsList}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/ViewsList.vue?vue&type=template&id=6fc27591
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"viewlist-page"},[_c("div",[_c("transition",{attrs:{name:"fade"}},[_c("outside-click",{staticClass:"workorder-list-container",attrs:{visibility:_vm.canShowViewsList},on:{"update:visibility":function($event){_vm.canShowViewsList=$event}}},[_c("div",{staticClass:"position-relative"},[_c("div",{staticClass:"fc-viewlist-header"},[_c("div",{staticClass:"label-txt-black fw-bold mB20 mT20"},[_vm._v(" "+_vm._s(_vm.$t("common._common.views"))+" "),_c("i",{staticClass:"el-icon-close fR label-txt-black fw-bold pointer",on:{click:function($event){_vm.canShowViewsList=!1}}})]),_c("input",{directives:[{name:"model",rawName:"v-model",value:_vm.search,expression:"search"}],staticClass:"list-search-input",attrs:{type:"text",autofocus:"",placeholder:_vm.$t("common._common.search")},domProps:{value:_vm.search},on:{input:function($event){$event.target.composing||(_vm.search=$event.target.value)}}})]),_c("div",{staticClass:"height100 overflow-y-scroll pB50",staticStyle:{height:"calc(100vh - 200px)"}},[""===_vm.search||_vm.newGroup?_vm._e():_c("div",{staticClass:"mT20"},[_c("div",{staticClass:"wo-list-block"},_vm._l(_vm.filteredViews,(function(views,index){return _c("div",{key:index},[_c("div",{staticClass:"individual-view label-txt-black pT10 pB10 visibility-visible-actions pointer",on:{click:function($event){return _vm.changeView(views,index,_vm.filteredViews)}}},[_c("div",{staticClass:"width80 ellipsis"},[_vm._v(" "+_vm._s(views.displayName)+" ")]),_vm.showEditIcon?_c("i",{class:[!1===views.isDefault?"el-icon-edit pointer edit-icon visibility-hide-actions fR customEdit":"el-icon-edit pointer edit-icon visibility-hide-actions fR"],on:{click:function($event){return $event.stopPropagation(),_vm.edit(views)}}}):_vm._e(),_vm._v("    "),!1===views.isDefault?_c("i",{staticClass:"el-icon-delete pointer edit-icon visibility-hide-actions fR delete-icon",on:{click:function($event){return $event.stopPropagation(),_vm.deleteView(views)}}}):_vm._e()])])})),0)]),_vm.newGroup?_c("div",[""!==_vm.search?_c("div",{staticClass:"mT20"},[_c("div",{staticClass:"wo-list-block"},_vm._l(_vm.filteredViews,(function(views,index){return _c("div",{key:index},[_c("div",{staticClass:"individual-view label-txt-black pT10 pB10 visibility-visible-actions pointer",on:{click:function($event){return _vm.changeView(views,index,_vm.filteredViews)}}},[_c("div",{staticClass:"width80 ellipsis"},[_vm._v(" "+_vm._s(views.displayName)+" ")]),_vm.showEditIcon?_c("i",{class:[!1===views.isDefault?"el-icon-edit pointer edit-icon visibility-hide-actions fR customEdit":"el-icon-edit pointer edit-icon visibility-hide-actions fR"],on:{click:function($event){return $event.stopPropagation(),_vm.edit(views,!0)}}}):_vm._e(),_vm._v("    "),!1===views.isDefault?_c("i",{staticClass:"el-icon-delete pointer edit-icon visibility-hide-actions fR delete-icon",on:{click:function($event){return $event.stopPropagation(),_vm.deleteView(views,_vm.view.displayName)}}}):_vm._e()])])})),0)]):_vm._e(),_vm._l(_vm.preparingViews,(function(view,key){return""===_vm.search&&"sensorAlarmViews"!==view.name?_c("div",{key:key},[!_vm.$validation.isEmpty(_vm.preparingViews)&&_vm.preparingViews.length>1?_c("div",{staticClass:"fc-text-pink13 bold pB10 mT20"},[_vm._v(" "+_vm._s(view.displayName)+" ")]):_vm._e(),_c("div",{staticClass:"wo-list-block"},_vm._l(view.views,(function(views,index){return _c("div",{key:index},[_c("div",{staticClass:"individual-view label-txt-black pT10 pB10 visibility-visible-actions pointer",on:{click:function($event){return _vm.changeView(views,key)}}},[_c("div",{staticClass:"width80 ellipsis"},[_vm._v(" "+_vm._s(views.displayName)+" ")]),_vm.showEditIcon?_c("i",{class:[!1===views.isDefault?"el-icon-edit pointer edit-icon visibility-hide-actions fR customEdit":"el-icon-edit pointer edit-icon visibility-hide-actions fR"],on:{click:function($event){return $event.stopPropagation(),_vm.edit(views,!0)}}}):_vm._e(),_vm._v("    "),!1===views.isDefault?_c("i",{staticClass:"el-icon-delete pointer edit-icon visibility-hide-actions fR delete-icon",on:{click:function($event){$event.stopPropagation(),_vm.deleteView(views,view.views.indexOf(views))}}}):_vm._e()])])})),0)]):_vm._e()}))],2):_vm._e(),_vm._l(_vm.preparingViews,(function(view,key){return""!==_vm.search||_vm.newGroup?_vm._e():_c("div",{key:key},[_c("div",{staticClass:"fc-text-pink13 bold pB10 mT20"},[_vm._v(" "+_vm._s(_vm.mainViewsList[key])+" ")]),_c("div",{staticClass:"wo-list-block"},_vm._l(_vm.preparingViews[key],(function(views,index){return _c("div",{key:index},[_c("div",{staticClass:"individual-view label-txt-black pT10 pB10 visibility-visible-actions pointer",on:{click:function($event){return _vm.changeView(views,key)}}},[_c("div",{staticClass:"width80 ellipsis"},[_vm._v(" "+_vm._s(views.displayName)+" ")]),_vm.showEditIcon?_c("i",{class:[!1===views.isDefault?"el-icon-edit pointer edit-icon visibility-hide-actions fR customEdit":"el-icon-edit pointer edit-icon visibility-hide-actions fR"],on:{click:function($event){return $event.stopPropagation(),_vm.edit(views)}}}):_vm._e(),_vm._v("    "),!1===views.isDefault?_c("i",{staticClass:"el-icon-delete pointer edit-icon visibility-hide-actions fR delete-icon",on:{click:function($event){return $event.stopPropagation(),_vm.deleteView(views)}}}):_vm._e()])])})),0)])}))],2),_vm.showViewSchedulerListTab?_c("div",{staticClass:"position-relative fc-viewlist-fixed"},[_c("div",{staticClass:"scheduled-viewall",on:{click:function($event){return _vm.loadViewReports()}}},[_vm._v(" View All Scheduled List ")])]):_vm._e()])])],1)],1),_vm.showSaveDialog?_c("div",[_c("save-as-new-view",{attrs:{newViewName:_vm.newViewName,share:_vm.shareTo,modName:_vm.metaInfo.module.name,selectedColumn:_vm.selectedColumn,config:_vm.config,showSaveDialog:_vm.showSaveDialog},on:{"update:showSaveDialog":function($event){_vm.showSaveDialog=$event},"update:show-save-dialog":function($event){_vm.showSaveDialog=$event}}})],1):_vm._e()])},staticRenderFns=[],createForOfIteratorHelper=__webpack_require__(566347),objectSpread2=__webpack_require__(595082),vuex_esm=(__webpack_require__(169358),__webpack_require__(670560),__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(564043),__webpack_require__(61514),__webpack_require__(434284),__webpack_require__(420629)),validation=__webpack_require__(990260),FilterMixin=__webpack_require__(63331),OutsideClick=__webpack_require__(21864),SaveAsNewViewvue_type_template_id_26e2d34a_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("el-dialog",{staticStyle:{"z-index":"999999","overflow-y":"scroll !important"},attrs:{visible:_vm.showSaveDialog,"append-to-body":!0,fullscreen:!0,"custom-class":"fc-dialog-form fc-dialog-right setup-dialog55 setup-dialog save-dialog","before-close":_vm.closeDialog},on:{"update:visible":function($event){_vm.showSaveDialog=$event}}},[_c("div",{staticClass:"wo-save-dialog"},[_c("p",{staticClass:"setup-modal-title",staticStyle:{margin:"0"}},[_vm._v("Edit View")]),_c("el-row",[_vm.viewDetail.isDefault?_c("el-col",{attrs:{span:13}},[_c("el-input",{attrs:{disabled:_vm.newViewNames,placeholder:"Name"},model:{value:_vm.newViewNames,callback:function($$v){_vm.newViewNames=$$v},expression:"newViewNames"}})],1):_c("el-col",{attrs:{span:13}},[_c("el-input",{attrs:{placeholder:"Name"},model:{value:_vm.newViewNames,callback:function($$v){_vm.newViewNames=$$v},expression:"newViewNames"}})],1)],1),_vm.config.disableColumnCustomization?_vm._e():_c("div",[_c("div",{staticClass:"wo-save-subH"},[_vm._v("CUSTOMIZE COLUMNS")]),_c("div",{staticClass:"wo-save-greytxt"},[_vm._v(" Drag and drop columns that you wish to save in this view ")]),_c("div",{staticClass:"wo-rearrage-container"},[_c("div",{staticClass:"wo-rearrage-left wo-rearrange-box mR40"},[_c("p",{staticClass:"rearrange-box-header"},[_c("span",{staticClass:"rearrange-box-H"},[_vm._v("AVAILABLE COLUMNS")])]),_c("div",{staticClass:"rearrange-box-body"},[_vm.moduleMeta?_c("div",[_c("draggable",{staticClass:"dragArea",attrs:{options:{group:"people"}},model:{value:_vm.allColumns,callback:function($$v){_vm.allColumns=$$v},expression:"allColumns"}},_vm._l(_vm.availableColumns,(function(element,index){return _c("div",{key:index,staticClass:"rearrange-el-block"},[_c("span",{staticClass:"rearrange-plus-icon",staticStyle:{cursor:"pointer"},on:{click:function($event){return _vm.addcolumn(element,index,_vm.availableColumns)}}},[_vm._v("+")]),_c("span",{staticClass:"rearrange-txt"},[_vm._v(_vm._s(element.label))]),_c("span",{staticStyle:{"text-align":"right",float:"right","margin-right":"4px","margin-top":"4px"}},[_c("img",{staticClass:"icon-right",staticStyle:{height:"16px"},attrs:{src:__webpack_require__(57197)}})])])})),0)],1):_vm._e()])]),_c("div",{staticClass:"wo-rearrage-right wo-rearrange-box"},[_c("p",{staticClass:"rearrange-box-header"},[_c("span",{staticClass:"rearrange-box-H"},[_vm._v("SELECTED COLUMNS")])]),_c("div",{staticClass:"rearrange-box-body"},[_vm.moduleMeta?_c("div",[_vm._l(_vm.fixedSelectedCol,(function(col,index){return _c("div",{key:index,staticClass:"rearrange-el-block",staticStyle:{border:"solid 1px #f0f0f0"}},[_c("span",{staticClass:"rearrange-txt2",staticStyle:{opacity:"0.5"}},[_vm._v(_vm._s(col.label))])])})),_c("draggable",{staticClass:"dragArea",attrs:{options:{group:"people"}},model:{value:_vm.selectedColumns,callback:function($$v){_vm.selectedColumns=$$v},expression:"selectedColumns"}},_vm._l(_vm.selectedColumns,(function(element,index){return _c("div",{key:index,staticClass:"rearrange-el-block"},[_c("span",[_c("i",{staticClass:"el-icon-close rearrange-plus-icon3",staticStyle:{"font-size":"16px","font-weight":"600",cursor:"pointer"},on:{click:function($event){return _vm.removeColumn(element,index,_vm.selectedColumns)}}})]),_c("span",{staticClass:"rearrange-txt2"},[_vm._v(_vm._s(element.label))]),_c("span",{staticStyle:{"text-align":"right",float:"right","margin-right":"4px","margin-top":"4px"}},[_c("img",{staticClass:"icon-right",staticStyle:{height:"16px"},attrs:{src:__webpack_require__(57197)}})])])})),0)],2):_vm._e()])])])]),Object.keys(_vm.filtersApplies).length>"0"?_c("div",{staticClass:"wo-save-subH"},[_vm._v(" FILTERS ")]):_vm._e(),Object.keys(_vm.filtersApplies).length>"0"?_c("div",{staticClass:"fc-grey-text-input-label pB10"},[_vm._v(" Existing Filters ")]):_vm._e(),Object.keys(_vm.filtersApplies).length>"0"?_c("div",[_c("new-tag",{staticClass:"saveas-newtag",attrs:{config:_vm.configsData,filters:_vm.filtersApplies,showCloseIcon:!1}})],1):_vm._e(),_vm.viewDetail.isDefault?_c("div"):_c("div",[_c("div",{staticClass:"fc-grey-text-input-label pB10 pT10"},[_vm._v("New Filters")]),_vm.showAddFilter||Object.keys(_vm.appliedFilters).length>"0"?_c("div",[_c("new-tag",{staticClass:"saveas-newtag",attrs:{config:_vm.config,filters:_vm.appliedFilters,showFilterAdd:_vm.showAddFilter,showCloseIcon:!0}})],1):_vm._e()]),_c("div",{staticClass:"wo-save-subH"},[_vm._v("SHARING PERMISSIONS")]),_c("el-row",{staticStyle:{margin:"0px"},attrs:{align:"middle",gutter:20}},[_c("el-col",{staticStyle:{"padding-right":"35px","padding-left":"0px"},attrs:{span:24}},[_c("div",{staticClass:"add"},[_c("el-radio",{staticClass:"newradio",attrs:{label:1},model:{value:_vm.shareTo,callback:function($$v){_vm.shareTo=$$v},expression:"shareTo"}},[_vm._v("Only Me")]),_c("el-radio",{staticClass:"newradio",attrs:{label:2},model:{value:_vm.shareTo,callback:function($$v){_vm.shareTo=$$v},expression:"shareTo"}},[_vm._v("Everyone")]),_c("el-radio",{staticClass:"newradio",attrs:{label:3},model:{value:_vm.shareTo,callback:function($$v){_vm.shareTo=$$v},expression:"shareTo"}},[_vm._v("Specific")])],1)])],1),3===_vm.shareTo?_c("el-row",{staticClass:"mT30 el-select-block"},[_c("el-col",{attrs:{span:24}},[_c("label",{staticClass:"sharing-label"},[_vm._v("Team")]),_c("el-select",{staticClass:"width60",attrs:{multiple:"","collapse-tags":"",placeholder:_vm.$t("common.wo_report.choose_users")},model:{value:_vm.sharedGroups,callback:function($$v){_vm.sharedGroups=$$v},expression:"sharedGroups"}},_vm._l(_vm.groups,(function(group){return _c("el-option",{key:group.id,attrs:{label:group.name,value:group.id}})})),1)],1)],1):_vm._e(),3===_vm.shareTo?_c("el-row",{staticClass:"mT30 el-select-block"},[_c("el-col",{attrs:{span:24}},[_c("label",{staticClass:"sharing-label"},[_vm._v("Role")]),_c("el-select",{staticClass:"width60",attrs:{multiple:"","collapse-tags":"",placeholder:_vm.$t("common.wo_report.choose_roles")},model:{value:_vm.sharedRoles,callback:function($$v){_vm.sharedRoles=$$v},expression:"sharedRoles"}},_vm._l(_vm.roles,(function(role){return _c("el-option",{key:role.id,attrs:{label:role.name,value:role.id}})})),1)],1)],1):_vm._e(),3===_vm.shareTo?_c("el-row",{staticClass:"mT30 el-select-block"},[_c("el-col",{attrs:{span:24}},[_c("label",{staticClass:"sharing-label"},[_vm._v("Staff")]),_c("el-select",{staticClass:"width60",attrs:{multiple:"","collapse-tags":"",placeholder:_vm.$t("common.wo_report.choose_teams")},model:{value:_vm.sharedUsers,callback:function($$v){_vm.sharedUsers=$$v},expression:"sharedUsers"}},_vm._l(_vm.users,(function(user){return _c("el-option",{key:user.id,attrs:{label:user.name,value:user.id}})})),1)],1)],1):_vm._e()],1),_c("span",{staticClass:"dialog-footer modal-footer-fixed",attrs:{slot:"footer"},slot:"footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){_vm.showSaveDialog=!1}}},[_vm._v("Cancel")]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:function($event){return _vm.saveAsNewView()}}},[_vm._v("Save")])],1)])],1)},SaveAsNewViewvue_type_template_id_26e2d34a_staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),toConsumableArray=__webpack_require__(488478),ViewMixin=(__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(450886),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(648324),__webpack_require__(857267),__webpack_require__(947522),__webpack_require__(162506),__webpack_require__(634338),__webpack_require__(453877)),picklist=__webpack_require__(961358),vuedraggable_umd=__webpack_require__(909980),vuedraggable_umd_default=__webpack_require__.n(vuedraggable_umd),NewTag=__webpack_require__(588633),SaveAsNewViewvue_type_script_lang_js={mixins:[FilterMixin/* default */.Z,ViewMixin/* default */.Z],props:["newViewName","share","selectedColumn","config","showSaveDialog","modName"],data:function(){return{allColumns:[],selectedColumns:[],nonSelectableColumns:["assignmentGroup","asset","week","hour","month","day","localId","photoId","space","hideToCustomer","parentAssetId","moduleState","stateFlowId","id"],configsData:{},availableColumns:[],loading:!1,showAddFilter:!0,filterApplied:!1,newViewNames:this.newViewName,
// showSaveDialog: false,
selectedResourceName:null,chooserVisibility:!1,shareTo:this.share,filtersApplies:{},sharedGroups:[],sharedUsers:[],sharedRoles:[],viewSharing:[]}},watch:{allFields:{handler:function(val){this.allColumns=this.$helpers.cloneObject(val),this.checkColumns(),this.setOptions()},deep:!0},appliedFilters:function(val){val?this.filterApplied=!0:this.filterApplied&&this.reset(null,!0)},share:function(val,oldVal){this.shareTo=this.share,this.$emit("update:newViewName",val)},newViewName:function(val,oldVal){this.init(),this.newViewNames=this.newViewName,this.$emit("update:newViewName",val)},selectedColumn:function(val,oldVal){this.init(),this.$emit("update:selectedColumn",val)},viewColumns:{handler:function(){this.availableColumns=[],this.selectedColumns=[],this.checkColumns()}},shareTo:function(val,oldVal){3===val&&this.sharedUsers.push(this.userDetails.id)},showSaveDialog:function(val,oldVal){this.$emit("update:showSaveDialog",val)},viewFilters:function(){this.init(),this.reset(null,!0)}},mounted:function(){this.allColumns=this.$helpers.cloneObject(this.allFields),this.init(),this.checkColumns()},created:function(){var _this=this;Promise.all([this.$store.dispatch("loadTicketCategory"),this.$store.dispatch("loadTicketStatus","workorder"),this.$store.dispatch("loadTicketType"),this.$store.dispatch("loadTicketPriority"),this.$store.dispatch("loadAssetCategory"),this.$store.dispatch("loadAssetDepartment"),this.$store.dispatch("loadAssetType"),this.$store.dispatch("loadAlarmSeverity"),this.$store.dispatch("loadRoles"),this.$store.dispatch("loadGroups")]).then((function(){return _this.setOptions()}))},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({users:function(state){return state.users},groups:function(state){return state.groups},ticketstatus:function(state){return state.ticketStatus.workorder},ticketpriority:function(state){return state.ticketPriority},ticketcategory:function(state){return state.ticketCategory},alarmseverity:function(state){return state.alarmSeverity},assetcategory:function(state){return state.assetCategory},assetdepartment:function(state){return state.assetDepartment},assettype:function(state){return state.assetType},moduleMeta:function(state){return state.view.metaInfo},viewDetail:function(state){return state.view.currentViewDetail},userDetails:function(state){return state.account.user},roles:function(state){return state.roles}})),(0,vuex_esm/* mapActions */.nv)({loadModuleMeta:"view/loadModuleMeta",loadViews:"view/loadViews",loadGroupViews:"view/loadGroupViews",loadViewDetail:"view/loadViewDetail",savesorting:"view/savesorting"})),(0,vuex_esm/* mapGetters */.Se)(["getTicketTypePickList","getCurrentUser"])),{},{tickettype:function(){return this.getTicketTypePickList()},appliedFilters:function(){return this.$route.query.search?JSON.parse(this.$route.query.search):null},allFields:function(){var _this2=this,obj=[];return this.moduleMeta&&this.moduleMeta.fields&&(obj=this.moduleMeta.fields.filter((function(field){return(_this2.config.availableColumns||-1!==_this2.config.availableColumns.indexOf(field.name)||!field.default)&&(!_this2.config.fixedCols||!_this2.config.fixedCols.includes(field.name))})).map((function(field,idx){return{id:field.id,label:field.columnDisplayName||field.displayName,key:field.name||""}}))),obj},fixedSelectedCol:function(){var _this3=this;return this.config.fixedCols&&this.moduleMeta.fields?this.moduleMeta.fields.filter((function(field){return _this3.config.fixedCols.includes(field.name)})).map((function(field){return{id:field.id,label:field.columnDisplayName||field.displayName}})):[]},includeParentFilter:function(){return this.$route.query.includeParentFilter&&("true"===this.$route.query.includeParentFilter||!0===this.$route.query.includeParentFilter)},currentView:function(){return this.$route.params.viewname||null},viewFilters:function(){return this.viewDetail?this.viewDetail.filters:null}}),components:{draggable:vuedraggable_umd_default(),NewTag:NewTag/* default */.Z},methods:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapActions */.nv)({editView:"view/editView"})),{},{newView:function(){this.viewDetail.isDefault,this.saveAsNewView()},editOldView:function(){this.apply(),this.editViews()},apply:function(){var _this4=this;this.$emit("hideSearch");var filters={},_loop=function(){"rule"===fieldName&&_this4.config.data.rule.push({moduleName:"alarmRaeding"});var field=_this4.config.data[fieldName],key=field.key||fieldName;if((1===field.operatorId||2===field.operatorId||field.value)&&(1===field.operatorId||2===field.operatorId||!Array.isArray(field.value)||field.value.length))if(field.customdate)_this4.setCustomDateFilters(filters,fieldName,_this4.config);else{var filterObj={operatorId:field.operatorId||("space"===fieldName?38:"subject"===fieldName?5:36)};if(1!==field.operatorId&&2!==field.operatorId||(field.value="subject"===fieldName?"":[]),"assignedTo"===fieldName){var users=[],groups=[];field.value.forEach((function(user){-1!==user.indexOf("_group")?groups.push(user.substring(0,user.indexOf("_group"))):users.push(user)})),users.length&&(filterObj.value=users),groups.length&&(filterObj.value=groups,key="assignedToId"===key?"assignmentGroupId":"assignmentGroup"),filters[key]=filterObj}else filterObj.value=Array.isArray(field.value)?field.value.map((function(val){return val+""})):[field.value],"space"===fieldName||"asset"===fieldName?(key=field.key||"resource",filters[key]||(filters[key]=[]),filters[key].push(filterObj)):filters[key]=filterObj}};for(var fieldName in this.config.data)_loop();if(Object.keys(filters).length>"0"){var queryParam={search:JSON.stringify(filters)};this.config.includeParentCriteria&&(queryParam.includeParentFilter=!0),this.$router.replace({query:queryParam})}this.filterApplied=!0,this.$refs.select1.blur()},closeDialog:function(){this.showSaveDialog=!1,this.$emit("update:visibility",!1)},reset:function(event,resetValueOnly){for(var field in this.filterApplied=!1,this.config.data){var data=this.config.data[field];data.value=data.single?"":[]}
// setting height back to normal for select tags
var elem=document.getElementById("new-view-filter");elem&&elem.querySelectorAll(".el-input__inner").forEach((function(node){node.style.removeProperty("height")})),!resetValueOnly&&this.appliedFilters&&this.$router.replace({path:this.$route.path,query:{}})},addcolumn:function(element,index,allColumns){this.selectedColumns.push(element),allColumns.splice(index,1)},removeColumn:function(element,index,selectedColumns){this.availableColumns.push(element),selectedColumns.splice(index,1)},saveAsNewView:function(){var _this5=this;if(this.newViewNames&&this.selectedColumns.length){this.applySharing();var a1,fields=null;if(!this.config.disableColumnCustomization){var columns=[].concat((0,toConsumableArray/* default */.Z)(this.fixedSelectedCol),(0,toConsumableArray/* default */.Z)(this.selectedColumns));fields=columns.map((function(col){return{fieldId:col.id,columnDisplayName:col.label,fieldName:col.key||""}}))}a1=this.modName?this.modName:this.config.moduleName;var data={moduleName:a1,view:{displayName:this.newViewNames,fields:fields,id:this.viewDetail.id,includeParentCriteria:!0,name:this.viewDetail.name,viewSharing:this.viewSharing},parentView:this.currentView},finalFilteredJsonWithParentFilters={};finalFilteredJsonWithParentFilters=this.filtersApplies?(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},this.filtersApplies),this.appliedFilters):this.appliedFilters,data.view.filtersJson=JSON.stringify(finalFilteredJsonWithParentFilters),this.editView(data).then((function(data){_this5.resetValues(),
// this.$router.replace({
//   path: this.config.path + data.view.name,
//   query: {},
// })
_this5.showSaveDialog=!1,_this5.$message.success("View Edited successfully!")})).catch((function(error){_this5.$message.error(error.message)}))}},applySharing:function(){var self=this;if(this.viewSharing=[],1===self.shareTo)this.viewSharing.push({type:1,userId:self.getCurrentUser().ouid});else if(3===self.shareTo){if(self.sharedUsers.length>0){this.viewSharing.push({type:1,userId:self.getCurrentUser().ouid});for(var i=0;i<self.sharedUsers.length;i++)self.sharedUsers[i]!==self.getCurrentUser().ouid&&this.viewSharing.push({type:1,userId:self.sharedUsers[i]})}if(self.sharedRoles.length>0)for(var _i=0;_i<self.sharedRoles.length;_i++)this.viewSharing.push({type:2,roleId:self.sharedRoles[_i]});if(self.sharedGroups.length>0)for(var _i2=0;_i2<self.sharedGroups.length;_i2++)this.viewSharing.push({type:3,groupId:self.sharedGroups[_i2]})}},onFilterChanged:function(value){this.apply(),this.filterApplied&&(this.filterApplied=!1)},isDateOperatorWithValue:function(operatorId){
// TODO get value from date operator
return[39,40,41,50,59,60,61].includes(operatorId)},loadPickList:function(moduleName,field){var _this6=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var _yield$getFieldOption,error,options;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _this6.picklistOptions={},_context.next=3,(0,picklist/* getFieldOptions */._K)({field:{lookupModuleName:moduleName,skipDeserialize:!0}});case 3:_yield$getFieldOption=_context.sent,error=_yield$getFieldOption.error,options=_yield$getFieldOption.options,error?_this6.$message.error(error.message||"Error Occured"):_this6.$set(field,"options",options);case 7:case"end":return _context.stop()}}),_callee)})))()},setCustomDateFilters:function(filters,fieldName,config){var _this7=this,constructDateFilter=function(val){val=val.split("_");var operatorId=1===val.length?parseInt(val[0]):parseInt(val[1]),filter={operatorId:operatorId};if(20===operatorId){var dateRange=config.data[fieldName].dateRange;if(!dateRange||!dateRange.length)return!1;filter.value=config.data[fieldName].dateRange.map((function(date){return _this7.$helpers.getTimeInOrg(date)+""}))}else _this7.isDateOperatorWithValue(operatorId)&&(filter.value=[val[0]]);return filter},filterVal=config.data[fieldName].value,key=config.data[fieldName].key||fieldName;if(Array.isArray(filterVal))filters[key]=[],filterVal.forEach((function(fval){var filter=constructDateFilter(fval);filter&&filters[key].push(filter)}));else{var filter=constructDateFilter(filterVal);filter&&(filters[key]=filter)}},formatOptions:function(field,list){var _this8=this,data=this.config.data;data[field]&&list.forEach((function(val){_this8.$set(data[field].options,val.id,val.name)}))},associateResource:function(resource,field){this.$set(field,"chooserVisibility",!1),field.value=resource.resourceList?resource.resourceList.map((function(res){return res.id})):[],this.onFilterChanged(),this.apply()},setFieldValue:function(filterVal,field,fieldKey){filterVal&&("assignmentGroup"===fieldKey||"assignedTo"===fieldKey?(filterVal="assignmentGroup"===fieldKey?filterVal.filter((function(id){return"-100"!==id})).map((function(id){return id+"_group"})):filterVal,field.value&&!field.single?field.value=[].concat((0,toConsumableArray/* default */.Z)(field.value),(0,toConsumableArray/* default */.Z)(filterVal)):field.value=filterVal):field.value=filterVal)},setOptions:function(){var data=this.config.data,userOptions={};this.users.forEach((function(user){userOptions[user.id]=user.name})),data.assignedTo&&(data.assignedTo.options=userOptions,this.groups.forEach((function(group){data.assignedTo.options[group.id+"_group"]=group.name}))),data.issuedTo&&(data.issuedTo.options=userOptions),data.issuedBy&&(data.issuedBy.options=userOptions),data.requestedBy&&(data.requestedBy.options=userOptions),data.requestedFor&&(data.requestedFor.options=userOptions),data.status&&((0,validation/* isEmpty */.xb)(this.ticketstatus)||this.ticketstatus.forEach((function(status){data.status.options[status.id]=status.displayName}))),data.category&&this.loadPickList("ticketcategory",data.category),data.tenant&&this.loadPickList("tenant",data.tenant),data.itemType&&this.loadPickList("itemTypes",data.itemType),data.toolType&&this.loadPickList("toolTypes",data.toolType),data.storeRoom&&this.loadPickList("storeRoom",data.storeRoom),data.fromStore&&this.loadPickList("storeRoom",data.fromStore),data.toStore&&this.loadPickList("storeRoom",data.toStore),data.vendor&&this.loadPickList("vendors",data.vendor),data.priority&&((0,validation/* isEmpty */.xb)(this.ticketpriority)||this.ticketpriority.forEach((function(prior){data.priority.options[prior.id]=prior.displayName}))),data.acknowledgedBy&&(data.acknowledgedBy.options=userOptions),data.clearedBy&&(data.clearedBy.options=userOptions),data.severity&&((0,validation/* isEmpty */.xb)(this.alarmseverity)||this.alarmseverity.forEach((function(severity){data.severity.options[severity.id]=severity.severity,data.previousSeverity&&(data.previousSeverity.options[severity.id]=severity.severity)}))),data.severity&&((0,validation/* isEmpty */.xb)(this.alarmseverity)||this.alarmseverity.forEach((function(severity){data.severity.options[severity.id]=severity.severity}))),data.ticketType&&((0,validation/* isEmpty */.xb)(this.tickettype)||(data.ticketType.options=this.tickettype)),data.frequency&&(data.frequency.options=Object.assign({},{0:"Once"},this.$constants.FACILIO_FREQUENCY)),this.formatOptions("assetCategory",this.assetcategory),this.formatOptions("assetDepartment",this.assetdepartment),this.formatOptions("assetType",this.assettype)},editViews:function(){var _this9=this,data={moduleName:this.config.moduleName,view:{name:this.viewDetail.name,id:this.viewDetail.id}};this.appliedFilters&&(data.view.filtersJson=JSON.stringify(this.appliedFilters)),this.editView(data).then((function(data){_this9.resetValues(),
// this.$router.replace({
//   path: this.config.path + data.view.name,
//   query: {},
// })
_this9.showSaveDialog=!1,_this9.$message.success("View Edited successfully!"),_this9.subheaderMenu()})).catch((function(){_this9.$message.error("View creation failed!")}))},queryHandler:function(){this.query=null,this.reset()},resetValues:function(){this.filterApplied=!1,this.allColumns=this.$helpers.cloneObject(this.allFields),this.selectedColumns=[],this.newViewNames="",this.sharedGroups=[],this.sharedUsers=[],this.sharedRoles=[],this.viewSharing=[]},getLookupValue:function(field,filter,fieldName){var _this10=this,name=Object.keys(filter.value)[0],lookupFilter=filter.value[name],operatorId=lookupFilter.operatorId,valuesToCheck=lookupFilter.value,optionsToSelect=[],idsArr=Object.keys(this.config.data[fieldName].options);
// TODO needs to check more operators and support multiple lookups
// TODO needs to get operatorid from metainfo
// All the option values for the field
return"typeCode"===name&&"status"===fieldName&&(valuesToCheck=["Closed"],"1"===lookupFilter.value[0]&&(operatorId=4)),idsArr.forEach((function(id){
// TODO check more operator ids
valuesToCheck.includes(_this10.config.data[fieldName].options[id])?4!==operatorId&&optionsToSelect.push(id):4===operatorId&&optionsToSelect.push(id)})),optionsToSelect},getValuesFromFilter:function(field,filter,fieldName){var value;
// TODO temporary...needs to improve
if(35===filter.operatorId)value=this.getLookupValue(field,filter,fieldName);else if(15===filter.operatorId||15===field.operatorId)value=filter.value&&"true"===filter.value[0]?"true":"false";else if(!field.customdate||filter.value&&filter.value.length||!field.options[filter.operatorId]){if(filter.value)if("date"===field.type&&20===filter.operatorId)value="20",field.dateRange=filter.value;else if(this.isDateOperatorWithValue(filter.operatorId))value=filter.value[0]+"_"+filter.operatorId,value=field.single?value:[value];else if(10===filter.operatorId||10===field.operatorId){var options=this.config.data[fieldName].options,idsArr=Object.keys(options);value=[],idsArr.forEach((function(id){filter.value.includes(id)||value.push(id)}))}else value=field.single?filter.value[0]:filter.value}else value=field.single?filter.operatorId+"":[filter.operatorId+""];return value},applyFilter:function(){var _this11=this,filters={};this.filtersApplies={};var _loop2=function(){"rule"===fieldName&&_this11.configsData.data.rule.push({moduleName:"alarmRaeding"});var field=_this11.configsData.data[fieldName],key=field.key||fieldName;if((1===field.operatorId||2===field.operatorId||field.value)&&(1===field.operatorId||2===field.operatorId||!Array.isArray(field.value)||field.value.length))if(field.customdate)_this11.setCustomDateFilters(filters,fieldName,_this11.configsData);else{var filterObj={operatorId:field.operatorId||("space"===fieldName?38:"subject"===fieldName||"name"===fieldName||"title"===fieldName?5:36)};if(1!==field.operatorId&&2!==field.operatorId||(field.value="subject"===fieldName||"name"===fieldName||"title"===fieldName?"":[]),"assignedTo"===fieldName){var users=[],groups=[];field.value.forEach((function(user){-1!==user.indexOf("_group")?groups.push(user.substring(0,user.indexOf("_group"))):users.push(user)})),users.length&&(filterObj.value=users),groups.length&&(filterObj.value=groups,key="assignedToId"===key?"assignmentGroupId":"assignmentGroup"),filters[key]=filterObj}else filterObj.value=Array.isArray(field.value)?field.value.map((function(val){return val+""})):[field.value],"space"===fieldName||"asset"===fieldName?(key=field.key||"resource",filters[key]||(filters[key]=[]),filters[key].push(filterObj)):filters[key]=filterObj}};for(var fieldName in this.configsData.data)_loop2();Object.keys(filters).length&&(this.filtersApplies=null,this.filtersApplies=filters,this.filtersApplies&&(this.appliedFilters+=this.filtersApplies))},init:function(){var _this12=this,filters=Object.assign({},this.viewFilters);this.filtersApplies={},this.configsData=this.$helpers.cloneObject(this.config);var self=this,fieldKeyMap={};for(var fieldName in this.configsData.data)this.configsData.data.hasOwnProperty(fieldName)&&this.configsData.data[fieldName].key&&(fieldKeyMap[this.configsData.data[fieldName].key]=fieldName);var _loop3=function(fieldKey){if(filters.hasOwnProperty(fieldKey)||"assignmentGroup"===fieldKey){var field,filterVal,filter=filters[fieldKey],_fieldName="assignmentGroup"===fieldKey?"assignedTo":fieldKey,isResourceField=!1;if("resource"===_fieldName||"resourceId"===_fieldName?(field=_this12.configsData.data.space||_this12.configsData.data.asset?{parent:"resource"}:null,isResourceField=!0):field=_this12.configsData.data[_fieldName]||_this12.configsData.data[fieldKeyMap[_fieldName]],field)Array.isArray(filter)?(filterVal=[],filter.forEach((function(fval){isResourceField&&(filterVal=[],field=38===fval.operatorId?_this12.configsData.data.space:_this12.configsData.data.asset);var val=self.getValuesFromFilter(field,fval,fieldKeyMap[_fieldName]||_fieldName);Array.isArray(val)?filterVal=[].concat((0,toConsumableArray/* default */.Z)(filterVal),(0,toConsumableArray/* default */.Z)(val)):15===field.operatorId?filterVal=val:filterVal.push(val),isResourceField&&self.setFieldValue(filterVal,field,fieldKey)}))):(isResourceField&&(field=38===filter.operatorId?_this12.configsData.data.space:_this12.configsData.data.asset),filterVal=self.getValuesFromFilter(field,filter,fieldKeyMap[_fieldName]||_fieldName)),Array.isArray(filter)&&isResourceField||self.setFieldValue(filterVal,field,fieldKey)}};for(var fieldKey in filters)_loop3(fieldKey);var viewDetail=this.viewDetail;if(!(0,validation/* isEmpty */.xb)(viewDetail)){var viewSharing=viewDetail.viewSharing;if(3===this.shareTo)for(var i=0;i<viewSharing.length;i++)(0,validation/* isEmpty */.xb)(viewSharing[i].typeEnum)||("USER"===viewSharing[i].typeEnum?this.sharedUsers.push(viewSharing[i].userId):"ROLE"===viewSharing[i].typeEnum?this.sharedRoles.push(viewSharing[i].roleId):"GROUP"===viewSharing[i].typeEnum&&this.sharedGroups.push(viewSharing[i].groupId))}this.applyFilter()},checkColumns:function(){for(var j in this.selectedColumns=[],this.allColumns){var k=!1;for(var i in this.viewColumns)this.allColumns[j].label===this.viewColumns[i].displayName&&(this.selectedColumns.push(this.allColumns[j]),k=!0);k||this.nonSelectableColumns.includes(this.allColumns[j].key)||this.availableColumns.push(this.allColumns[j])}}})},components_SaveAsNewViewvue_type_script_lang_js=SaveAsNewViewvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_SaveAsNewViewvue_type_script_lang_js,SaveAsNewViewvue_type_template_id_26e2d34a_render,SaveAsNewViewvue_type_template_id_26e2d34a_staticRenderFns,!1,null,null,null)
/* harmony default export */,SaveAsNewView=component.exports,ViewsListvue_type_script_lang_js={mixins:[FilterMixin/* default */.Z],props:["views","preparingViews","mainViewsList","parentPathList","showListWorkorder","config","showEditIcon","moduleName","newGroup","showViewSchedulerListTab"],data:function(){return{search:"",showSaveDialog:!1,newViewName:"",shareTo:"",selectedColumn:{id:null,label:null}}},watch:{preparingViews:function(val,oldVal){this.$emit("update:preparingViews",val)}},mounted:function(){},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapActions */.nv)({loadModuleMeta:"view/loadModuleMeta",loadViews:"view/loadViews",loadGroupViews:"view/loadGroupViews",loadViewDetail:"view/loadViewDetail",savesorting:"view/savesorting"})),(0,vuex_esm/* mapGetters */.Se)(["getTicketTypePickList"])),{},{canShowViewsList:{get:function(){return this.showListWorkorder},set:function(value){this.$emit("update:showListWorkorder",value)}},tickettype:function(){return this.getTicketTypePickList()},filteredViews:function(){var self=this;if(this.parentPathList){var allModuleViews=[],allModuleKeys=Object.keys(this.mainViewsList);for(var moduleKey in allModuleKeys)for(var prepView in this.preparingViews[allModuleKeys[moduleKey]]){this.preparingViews[allModuleKeys[moduleKey]][prepView]["moduleName"]=allModuleKeys[moduleKey];var temp=this.preparingViews[allModuleKeys[moduleKey]][prepView];allModuleViews.push(temp)}return allModuleViews.filter((function(view){return view.displayName.toLowerCase().indexOf(self.search.toLowerCase())>=0}))}if(this.newGroup){for(var lists=[],i=0;i<self.preparingViews.length;i++)for(var j=0;j<self.preparingViews[i].views.length;j++)lists.push(self.preparingViews[i].views[j]);return lists.filter((function(b){return b.displayName.toLowerCase().indexOf(self.search.toLowerCase())>=0}))}return this.views.filter((function(view){return view.displayName.toLowerCase().indexOf(self.search.toLowerCase())>=0}))}}),components:{OutsideClick:OutsideClick/* default */.Z,SaveAsNewView:SaveAsNewView},created:function(){this.$store.dispatch("loadTicketCategory"),this.$store.dispatch("loadTicketStatus","workorder"),this.$store.dispatch("loadTicketType"),this.$store.dispatch("loadTicketPriority"),this.$store.dispatch("loadAssetCategory"),this.$store.dispatch("loadAssetDepartment"),this.$store.dispatch("loadAssetType"),this.$store.dispatch("loadAlarmSeverity"),this.$store.dispatch("loadGroups")},methods:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({users:function(state){return state.users},groups:function(state){return state.groups},ticketstatus:function(state){return state.ticketStatus.workorder},ticketpriority:function(state){return state.ticketPriority},ticketcategory:function(state){return state.ticketCategory},alarmseverity:function(state){return state.alarmSeverity},assetcategory:function(state){return state.assetCategory},assetdepartment:function(state){return state.assetDepartment},assettype:function(state){return state.assetType},moduleMeta:function(state){return state.view.metaInfo},viewDetail:function(state){return state.view.currentViewDetail}})),{},{changeView:function(views,mainListName,filteredList){
// this.$router.push(views.name)
views&&(views.path?this.$router.push(views.path):this.parentPathList&&filteredList&&filteredList[mainListName]?this.$router.push(this.parentPathList[filteredList[mainListName].moduleName]+views.name):this.parentPathList&&mainListName&&this.parentPathList[mainListName]?this.$router.push(this.parentPathList[mainListName]+views.name):"asset"===this.config.moduleName||"newreadingalarm"===this.config.moduleName?(""===views.moduleName&&(views.moduleName="asset"),this.$store.dispatch("view/loadModuleMeta",views.moduleName),this.$router.push(views.name)):this.$router.push(views.name)),this.canShowViewsList=!1,this.showListDialog=!1},deleteView:function(a){this.$emit("delete",a,"index")},loadViewReports:function(){var moduleName=this.moduleName;"workorder"===moduleName?this.$router.push("/app/wo/schedule"):"newreadingalarm"===moduleName?this.$router.push("/app/fa/schedule"):this.$router.push("/app/at/schedule")},edit:function(view){var a,_this=this,self=this;if(self.newGroup)""===view.moduleName||"newreadingalarm"===view.moduleName?(view.moduleName=this.moduleName,a=this.moduleName):a=view.moduleName,this.$store.dispatch("view/loadModuleMeta",a).then((function(){_this.$router.push(view.name),self.selectedColumn=[];var url="/view/"+view.name+"?moduleName="+a;self.$http.get(url).then((function(response){if(self.newViewName=response.data.displayName,response&&response.data){var viewSharing=response.data.viewSharing;if((0,validation/* isEmpty */.xb)(viewSharing))_this.shareTo=2;else{viewSharing=viewSharing.filter((function(viewSharingContext){return"APP"!=viewSharingContext.typeEnum}));var sharingTypeLength=viewSharing.length;sharingTypeLength>1?_this.shareTo=3:1===sharingTypeLength&&viewSharing[0].userId===_this.$account.user.ouid?_this.shareTo=1:_this.shareTo=2}}if(response.data.fields){var _step,_iterator=(0,createForOfIteratorHelper/* default */.Z)(response.data.fields);try{for(_iterator.s();!(_step=_iterator.n()).done;){var t=_step.value;(0,validation/* isEmpty */.xb)(t.field)?self.selectedColumn.push({id:t.field&&t.field.fieldId?t.field.fieldId:-1,label:t.field&&t.field.displayName?t.field.displayName:t.columnDisplayName,fieldName:t.fieldName}):self.selectedColumn.push({id:t.field&&t.field.fieldId?t.field.fieldId:-1,label:t.field&&t.field.displayName?t.field.displayName:t.columnDisplayName})}}catch(err){_iterator.e(err)}finally{_iterator.f()}}self.$router.push(response.data.name),self.canShowViewsList=!1,self.showSaveDialog=!0}))}));else{self.selectedColumn=[];var url="/view/"+view.name+"?moduleName="+self.config.moduleName;self.$http.get(url).then((function(response){if(self.newViewName=response.data.displayName,response&&response.data){var viewSharing=response.data.viewSharing;if((0,validation/* isEmpty */.xb)(viewSharing))_this.shareTo=2;else{viewSharing=viewSharing.filter((function(viewSharingContext){return"APP"!=viewSharingContext.typeEnum}));var sharingTypeLength=viewSharing.length;sharingTypeLength>1?_this.shareTo=3:1===sharingTypeLength&&viewSharing[0].userId===_this.$account.user.ouid?_this.shareTo=1:_this.shareTo=2}}if(response.data.fields){var _step2,_iterator2=(0,createForOfIteratorHelper/* default */.Z)(response.data.fields);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var t=_step2.value;self.selectedColumn.push({id:t.field.fieldId,label:t.field.displayName})}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}self.$router.push(response.data.name)})),self.canShowViewsList=!1,self.showSaveDialog=!0}}})},components_ViewsListvue_type_script_lang_js=ViewsListvue_type_script_lang_js,ViewsList_component=(0,componentNormalizer/* default */.Z)(components_ViewsListvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,ViewsList=ViewsList_component.exports},
/***/929593:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FPagination}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/list/FPagination.vue?vue&type=template&id=7641710c&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_vm.total>0?_c("div",{staticClass:"flex-center-row-space mT-5",class:{"fc-black-small-txt-12":!_vm.hideToggle}},[_c("el-popover",{attrs:{placement:"bottom",trigger:"click",disabled:_vm.disablePopup}},[_c("span",{staticClass:"p8 pointer",class:[!_vm.disablePopup&&"button-hover"],attrs:{slot:"reference"},slot:"reference"},[_vm.from!==_vm.to?_c("span",[_vm._v(_vm._s(_vm.from)+" - ")]):_vm._e(),_c("span",[_vm._v(_vm._s(_vm.to))]),_vm._v(" of "+_vm._s(_vm.total)+" ")]),_c("el-pagination",{attrs:{layout:"prev, pager, next",total:_vm.total,"pager-count":5,"page-size":_vm.perPage,"current-page":_vm.page},on:{"current-change":_vm.handleCurrentChange,"update:pageSize":function($event){_vm.perPage=$event},"update:page-size":function($event){_vm.perPage=$event},"update:currentPage":function($event){_vm.page=$event},"update:current-page":function($event){_vm.page=$event}}})],1),_vm.hideToggle?_vm._e():_c("span",[_c("span",{staticClass:"el-icon-arrow-left pagination-arrow fc-black-small-txt-12 f16 fw-bold pointer p5",class:{disable:_vm.from<=1},on:{click:function($event){_vm.from>1&&_vm.prev()}}}),_c("span",{staticClass:"el-icon-arrow-right pagination-arrow fc-black-small-txt-12 f16 fw-bold pointer p5",class:{disable:_vm.to===_vm.total},on:{click:function($event){_vm.to!==_vm.total&&_vm.next()}}})])],1):_vm._e()])},staticRenderFns=[],router=(__webpack_require__(879288),__webpack_require__(670560),__webpack_require__(329435)),FPaginationvue_type_script_lang_js={props:{total:[Number,String],perPage:Number,hideToggle:{type:Boolean,default:!1},pageNo:Number,hidePopover:{type:Boolean,default:!1}},data:function(){return{from:0,to:0,page:1}},created:function(){(0,router/* isWebTabsEnabled */.tj)()&&document.addEventListener("keydown",this.keyDownHandler)},mounted:function(){this.init()},beforeDestroy:function(){(0,router/* isWebTabsEnabled */.tj)()&&document.removeEventListener("keydown",this.keyDownHandler)},computed:{pageQuery:function(){var _ref=this.$route||{},query=_ref.query,_ref2=query||{},page=_ref2.page;return parseInt(page)||1},hasMorePage:function(){return this.total/this.perPage>1},disablePopup:function(){return this.hidePopover||!this.hasMorePage}},watch:{total:function(){this.init()},pageQuery:function(){this.init()}},methods:{init:function(){if(this.page=this.pageQuery,this.from=(this.page-1)*this.perPage+1,this.from>this.total&&this.from&&this.from>0&&this.total&&this.total>0)this.reset();else{var to=this.from+this.perPage-1;this.to=this.total>to?to:this.total}},handleCurrentChange:function(val){this.page=val,this.from=(this.page-1)*this.perPage+1,this.to=this.total>=this.from+this.perPage?this.from+this.perPage-1:this.total,this.setPage()},next:function(){this.from=this.to+1,this.to+=this.perPage,this.to>this.total&&(this.to=this.total),this.page++,this.setPage()},prev:function(){this.to=this.from-1,this.from-=this.perPage,this.from<=1?this.from=this.page=1:this.page--,this.setPage()},reset:function(){this.page=1,this.setPage(!0)},setPage:function(isReset){if(this.pageNo)this.$emit("onPageChanged",this.page);else{var query={};Object.assign(query,this.$route.query),query?query.page=this.page:query={page:this.page},this.$router.push({query:query}),isReset||this.$emit("onPageChanged",this.page)}},keyDownHandler:function(e){e.shiftKey&&("ArrowRight"===e.key&&this.to!==this.total?this.next():"ArrowLeft"===e.key&&this.from>1&&this.prev())}}},list_FPaginationvue_type_script_lang_js=FPaginationvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(list_FPaginationvue_type_script_lang_js,render,staticRenderFns,!1,null,"7641710c",null)
/* harmony default export */,FPagination=component.exports},
/***/358413:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"9d59ae35bdc11a0bea83920c3922ecfd.svg";
/***/}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/75779.js.map