(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[3214],{
/***/684508:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return NewReport}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/report/forms/NewReport.vue?vue&type=template&id=73397e96
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"height100 new-report-page"},[_vm.loading?_c("div",{staticClass:"flex-middle justify-content-center"},[_c("spinner",{attrs:{show:_vm.loading,size:"80"}})],1):_c("el-form",{ref:"newReportForm",staticClass:"fc-form",attrs:{"label-position":"top"}},[_c("div",{staticClass:"row"},[_c("div",{staticClass:"col-12"},[_c("div",{staticClass:"fc-report-header"},[_c("div",{staticClass:"pull-left report-title-section"},[_c("el-input",{staticClass:"fc-report-input-title newreport-title-input pL10",attrs:{autofocus:!0,placeholder:_vm.$t("common.wo_report.new_report"),prop:"reportName",type:"text"},model:{value:_vm.computedReportName,callback:function($$v){_vm.computedReportName=$$v},expression:"computedReportName"}})],1),_c("div",{staticClass:"pull-right report-btn-section"},[_c("f-report-options",{staticClass:"pull-right analytics-page-options-building-analysis newreport-page-options",attrs:{savedReport:_vm.savedReport,config:_vm.configFromReport?_vm.configFromReport:_vm.serverConfig,moduleName:_vm.moduleName,moduleFromRoute:_vm.$attrs.moduleName,iscustomModule:_vm.iscustomModule,optionClass:"analytics-page-options",optionsToEnable:[5,1,2],reportObject:_vm.reportObject,resultObject:_vm.resultObject,params:_vm.reportObject?_vm.reportObject.params:null,pdf:!1},on:{"update:savedReport":function($event){_vm.savedReport=$event},"update:saved-report":function($event){_vm.savedReport=$event}}})],1)])])]),_c("div",{staticClass:"report-main-con"},[_vm.hideSideBar?_vm._e():_c("div",{class:{"report-sidebar-con":!_vm.hideSideBar,"report-sidebar-hide":_vm.hideSideBar}},[_vm.showInnerPanel?_c("div",{class:{"analytics-sidebar-bg":_vm.secondPanelToggle}},[_c("div",{staticClass:"new-report-sidebar col-3"},[_c("div",{staticClass:"report-sidebar-inner"},[_c("div",{staticClass:"pB20 pL20 pR20"},[0===_vm.moduleTypes.length?_c("div",{staticClass:"fc-black2-12"},[_vm._v(" "+_vm._s(_vm.$t("home.dashboard.generate_chart"))+" ")]):_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"label-txt-black pB5"},[_vm._v(" "+_vm._s(_vm.$t("home.reports.module_name"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border-select2 report-input-select width100",on:{change:_vm.setModuleType},model:{value:_vm.config.moduleType,callback:function($$v){_vm.$set(_vm.config,"moduleType",$$v)},expression:"config.moduleType"}},_vm._l(_vm.moduleTypes,(function(moduleType,moduleTypeIdx){return _c("el-option",{key:moduleTypeIdx,attrs:{label:moduleType.displayName,value:moduleType.id}})})),1)],1)],1),"yes"===this.$route.meta.switch||_vm.isNewAlarmModule||_vm.isWebTabsEnabled?_c("div",[_c("div",[_c("el-row",{staticClass:"pB20 pT20"},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"label-txt-black pB5"},[_vm._v(" "+_vm._s(_vm.$t("home.reports.module"))+" ")])]),_c("el-select",{staticClass:"fc-input-full-border-select2 report-input-select width100",attrs:{filterable:"",disabled:!!this.$route.query.module},on:{change:function($event){return _vm.setmodule(_vm.moduleswitch)}},model:{value:_vm.moduleswitch,callback:function($$v){_vm.moduleswitch=$$v},expression:"moduleswitch"}},_vm._l(_vm.getModuleList,(function(moduleObj){return _c("el-option",{key:moduleObj.name,attrs:{label:moduleObj.displayName,value:moduleObj.name}})})),1)],1)],1)]):_vm._e(),_vm.subModulesList.length?_c("div",[_c("div",[_c("el-row",{staticClass:"pB20"},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"label-txt-black pB5"},[_vm._v(" "+_vm._s(_vm.$t("home.reports.submodule"))+" ")])]),_c("el-select",{staticClass:"fc-input-full-border-select2 report-input-select width100",attrs:{filterable:"",disabled:!!this.$route.query.module,clearable:""},on:{change:function($event){return _vm.setmodule(_vm.submodule,_vm.moduleswitch)}},model:{value:_vm.submodule,callback:function($$v){_vm.submodule=$$v},expression:"submodule"}},_vm._l(_vm.subModulesList,(function(module){return _c("el-option",{key:module.name,attrs:{label:module.displayName,value:module.name}})})),1)],1)],1)]):_vm._e(),_c("el-row",{staticClass:"pB20",class:{pT20:"yes"!==this.$route.meta.switch&&!_vm.isNewAlarmModule&&!_vm.isWebTabsEnabled}},[_c("el-col",{class:_vm.config.dimension.subDimension&&"LOOKUP"===_vm.config.dimension.subDimension.dataTypeEnum?"pR10":"",attrs:{span:_vm.config.dimension.subDimension&&"LOOKUP"===_vm.config.dimension.subDimension.dataTypeEnum?20:24}},[_c("div",{staticClass:"label-txt-black pB5"},[_vm._v(" "+_vm._s(_vm.$t("home.reports.dimension"))+" ")]),_c("div",{staticClass:"fc-input-div-full-border-f14",on:{click:function($event){return _vm.showSecondPanel(_vm.activePanelEnum.DIMENSION)}}},[_vm.config.dimension.subDimension?_c("span",[_vm._v(_vm._s(_vm.config.dimension.subDimension.displayName))]):_c("span",[_vm._v(_vm._s(_vm.$t("common._common.select")))]),_c("i",{staticClass:"pointer mT12 el-icon-arrow-right pull-right"})])]),_vm.config.dimension.subDimension&&"LOOKUP"===_vm.config.dimension.subDimension.dataTypeEnum?_c("el-col",{staticClass:"pT20",attrs:{span:4}},[_c("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{arrow:!0,animation:"perspective"},expression:"{ arrow: true, animation: 'perspective' }"}],staticClass:"fc-input-div-full-border-f14 pointer",staticStyle:{"text-overflow":"initial !important"},attrs:{title:"Dimension Filters","data-position":"top"},on:{click:function($event){return _vm.lookUpFilter()}}},[_c("span",[_c("img",{attrs:{slot:"reference",src:__webpack_require__(7634)},slot:"reference"})])])]):_vm._e()],1),_c("el-row",[_c("div",{staticClass:"label-txt-black pB5"},[_vm._v(" "+_vm._s(_vm.$t("home.reports.metric"))+" "),_c("span",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"top",arrow:!0,animation:"shift-away"},expression:"{\n                        placement: 'top',\n                        arrow: true,\n                        animation: 'shift-away',\n                      }"}],staticClass:"fc-dark-blue2-12 pointer pull-right",class:{"pointer-events-none":null===_vm.config.dimension.dimension||null!==_vm.config.groupBy.dimension},attrs:{title:"Add Metric",disabled:null!==_vm.config.groupBy.dimension||null===_vm.config.dimension.dimension},on:{click:function($event){return _vm.addMetric()}}},[_vm._v("Add")])])]),0==_vm.config.metric.length?_c("el-row",{staticClass:"pB20",attrs:{disabled:!0}},[_c("el-col",{staticClass:"pR10",attrs:{span:20}},[_c("div",{staticClass:"fc-input-div-full-border-f14 pL10 pointer",class:{"pointer-events-none":null==_vm.config.dimension.dimension},on:{click:function($event){return _vm.showSecondPanel(_vm.activePanelEnum.METRIC)}}},[_c("span",[_vm._v(_vm._s(_vm.$t("common._common.select"))),_c("i",{staticClass:"pointer mT12 el-icon-arrow-right pull-right"})])])]),_c("el-col",{attrs:{span:4}},[_c("div",{staticClass:"fc-input-div-full-border-f14 pointer"},[_c("el-popover",{attrs:{disabled:!0,placement:"top-start",width:"90",trigger:"hover","popper-class":"metric-popover"},model:{value:_vm.toggleMetricAggregation,callback:function($$v){_vm.toggleMetricAggregation=$$v},expression:"toggleMetricAggregation"}},[_vm._l(_vm.metricAggregation,(function(metricAggr,metricAggrIdx){return _c("div",{key:metricAggrIdx,staticClass:"pointer pT5 pB5 fc-label-hover label-txt-black f14 text-center",attrs:{value:metricAggr.value}},[_vm._v(" "+_vm._s(metricAggr.label)+" ")])})),_c("img",{attrs:{slot:"reference",disabled:!0,src:__webpack_require__(667527)},slot:"reference"})],2)],1)])],1):_vm._l(_vm.config.metric,(function(cMetric,cMetricIdx){return _c("el-row",{key:cMetricIdx,staticClass:"pB20",attrs:{disabled:null==_vm.config.dimension.dimension}},[_c("el-col",{staticClass:"pR10",attrs:{span:20}},[_c("div",{staticClass:"fc-input-div-full-border-f14 pL10 pointer",class:{"pointer-events-none":null==_vm.config.dimension.dimension},on:{click:function($event){_vm.showSecondPanel(_vm.activePanelEnum.METRIC),_vm.currentMetric=cMetricIdx}}},[0!==_vm.config.metric.length?_c("span",[_c("span",{staticClass:"metric-tag"},[_vm._v(_vm._s(cMetric.displayName)+" "),_vm.config.metric.length>1?_c("i",{staticClass:"el-icon-close pointer",on:{click:function($event){return $event.stopPropagation(),_vm.removeMetric(cMetricIdx)}}}):_vm._e()]),_c("i",{staticClass:"mT12 el-icon-arrow-right pull-right"})]):_c("span",[_vm._v(_vm._s(_vm.$t("common._common.select"))),_c("i",{staticClass:"pointer mT12 el-icon-arrow-right pull-right"})])])]),_c("el-col",{attrs:{span:4}},[_c("div",{staticClass:"fc-input-div-full-border-f14 pointer"},[_c("el-popover",{attrs:{disabled:!_vm.showMetricAggregation(cMetric),placement:"top-start",width:"90",trigger:"hover","popper-class":"metric-popover"},model:{value:_vm.toggleMetricAggregation[cMetric.fieldId+"__"+cMetric.name],callback:function($$v){_vm.$set(_vm.toggleMetricAggregation,cMetric.fieldId+"__"+cMetric.name,$$v)},expression:"\n                          toggleMetricAggregation[\n                            cMetric.fieldId + '__' + cMetric.name\n                          ]\n                        "}},[_vm._l(_vm.metricAggregation,(function(metricAggr,metricAggrIdx){return _c("div",{key:metricAggrIdx,staticClass:"pointer pT5 pB5 fc-label-hover label-txt-black f14 text-center",class:{"selected-field-background":_vm.config.metricAggregation&&metricAggr.value===_vm.config.metricAggregation[cMetric.fieldId+"__"+cMetric.name]},attrs:{value:metricAggr.value},on:{click:function($event){return _vm.setMetricAggregation(metricAggr.value,cMetricIdx)}}},[_vm._v(" "+_vm._s(metricAggr.label)+" ")])})),_c("img",{attrs:{slot:"reference",disabled:!_vm.showMetricAggregation(cMetric),src:__webpack_require__(667527)},slot:"reference"})],2)],1)])],1)})),_vm.config.metric.length<2&&(!_vm.config.baseLine||-1===_vm.config.baseLine[0])?_c("el-row",{staticClass:"pB20",attrs:{disabled:null===_vm.config.dimension.dimension}},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"label-txt-black pB5"},[_vm._v(" "+_vm._s(_vm.$t("home.reports.group_by"))+" ")]),_c("div",{staticClass:"fc-input-div-full-border-f14",class:{"pointer-events-none":null==_vm.config.dimension.dimension},on:{click:function($event){return _vm.showSecondPanel(_vm.activePanelEnum.GROUPBY)}}},[_vm.config.groupBy.subDimension?_c("span",{staticClass:"metric-tag"},[_vm._v(_vm._s(_vm.config.groupBy.subDimension.displayName)),_c("i",{staticClass:"el-icon-close pointer",on:{click:function($event){return $event.stopPropagation(),_vm.removeGroupBy.apply(null,arguments)}}})]):_c("span",[_vm._v(_vm._s(_vm.$t("common._common.select")))]),_vm.config.groupBy.subDimension?_vm._e():_c("i",{staticClass:"pointer mT12 el-icon-arrow-right pull-right"})])])],1):_vm._e(),_vm.config.dimension.subDimension&&5!==_vm.config.dimension.subDimension.dataType&&6!==_vm.config.dimension.subDimension.dataType?_c("el-row",{staticClass:"pB20"},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"label-txt-black pB5"},[_vm._v(" "+_vm._s(_vm.$t("home.reports.date_filter"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border-select2 report-input-select width100",attrs:{placeholder:"Select Time Field"},on:{change:_vm.setCustomDateField},model:{value:_vm.config.customDateField,callback:function($$v){_vm.$set(_vm.config,"customDateField",$$v)},expression:"config.customDateField"}},_vm._l(_vm.timeFields,(function(timeField,timeFieldIdx){return _c("el-option",{key:timeFieldIdx,attrs:{label:timeField.displayName,value:timeField.id+"_"+timeField.name}})})),1)],1)],1):_vm._e(),_vm.baselinelist&&null===_vm.config.groupBy.dimension&&(_vm.config.dimension.subDimension&&(5===_vm.config.dimension.subDimension.dataType||6===_vm.config.dimension.subDimension.dataType)||_vm.config.customDateField)?_c("el-row",{staticClass:"pB20"},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"label-txt-black pB5"},[_vm._v("Base Line")]),_c("el-cascader",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"fc-input-full-border-select2 report-input-select width100",attrs:{placeholder:"Compare to",options:_vm.baseLineCasecaderOptions,value:_vm.config.baseLine,title:"Compare with Baseline","data-arrow":"true"},on:{change:_vm.onBaseLineChange}})],1)],1):_vm._e(),_c("el-row",{staticClass:"pB20",attrs:{disabled:null===_vm.config.dimension.dimension||"Time"===_vm.config.dimension.dimension.displayName||null!==_vm.config.groupBy.dimension}},[_c("el-col",{attrs:{span:13}},[_c("div",{staticClass:"label-txt-black pB5"},[_vm._v(" "+_vm._s(_vm.$t("home.reports.sorting"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border-select2 report-input-select",attrs:{disabled:null===_vm.config.dimension.dimension||"Time"===_vm.config.dimension.dimension.displayName||null!==_vm.config.groupBy.dimension,placeholder:"Select"},on:{change:_vm.handleSort},model:{value:_vm.config.sorting,callback:function($$v){_vm.$set(_vm.config,"sorting",$$v)},expression:"config.sorting"}},_vm._l(_vm.sortingOrder,(function(sortOrder,sortOrderIdx){return _c("el-option",{key:sortOrderIdx,attrs:{value:sortOrder.value,label:sortOrder.label}})})),1)],1),_c("el-col",{staticClass:"mL10",attrs:{span:10}},[_c("div",{staticClass:"label-txt-black pB5"},[_vm._v(" "+_vm._s(_vm.$t("home.reports.range"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border-select2 report-input-select",attrs:{disabled:null===_vm.config.dimension.dimension||"Time"===_vm.config.dimension.dimension.displayName||null!==_vm.config.groupBy.dimension,placeholder:"Select"},on:{change:_vm.handleRange},model:{value:_vm.config.range,callback:function($$v){_vm.$set(_vm.config,"range",$$v)},expression:"config.range"}},_vm._l(_vm.ranges,(function(range,rangeIdx){return _c("el-option",{key:rangeIdx,attrs:{value:range,label:range}})})),1)],1)],1),_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"label-txt-black pB10 pB5"},[_vm._v(" "+_vm._s(_vm.$t("home.reports.criteria"))+" ")]),_c("div",{staticClass:"fL"},[_vm.criteriaTrigger?_c("div",[_c("div",{staticClass:"fc-black2 f14 fw-bold pB5"},[_vm._v(" "+_vm._s(_vm.$t("home.reports.criteria_applied"))+" ")]),_c("div",{staticClass:"fc-grey2 f12 pB5"})]):_c("div",[_c("div",{staticClass:"fc-black2 f14 fw-bold pB5"},[_vm._v(" "+_vm._s("All "+_vm.moduleDisplayName)+" ")]),_c("div",{staticClass:"fc-grey2 f12 pB5"},[_vm._v(" "+_vm._s(_vm.$t("home.reports.default"))+" ")])])]),_c("div",{staticClass:"fR"},[_vm.isCriteriaEmpty()&&_vm.isDataFilterEmpty()?_vm._e():_c("span",{staticClass:"pointer label-txt-blue2 pR10",on:{click:_vm.resetCriteria}},[_vm._v(_vm._s(_vm.$t("common._common.reset")))]),_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-edit report-edit-icon pointer",attrs:{title:_vm.isCriteriaEmpty()&&_vm.isDataFilterEmpty()?_vm.$t("home.reports.add_criteria"):_vm.$t("home.reports.edit_criteria")},on:{click:function($event){_vm.showCriteriaBuilder=!0}}})])])],1)],2),_c("div",{staticClass:"border-top5"},[_c("div",{staticClass:"pL20 pR20"},[_c("el-row",{staticClass:"clearboth pT20"},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"fL"},[_c("div",{staticClass:"fc-black2 f14 fw-bold pB5"},[_vm._v(" "+_vm._s(_vm.$t("home.reports.user_filter"))+" ")])]),_c("div",{staticClass:"fR"},[_c("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"top",arrow:!0,animation:"shift-away"},expression:"{\n                            placement: 'top',\n                            arrow: true,\n                            animation: 'shift-away',\n                          }"}],staticClass:"fc-dark-blue4-12 pointer",attrs:{title:_vm.$t("common._common.edit")},on:{click:function($event){_vm.showUserFilter=!0}}},[_vm._v(" "+_vm._s(null===_vm.config.userFilters||_vm.config.userFilters&&0===_vm.config.userFilters.length?_vm.$t("common._common.add"):_vm.$t("common._common.edit"))+" ")])])])],1),null!==_vm.config.userFilters?_c("div",_vm._l(_vm.config.userFilters,(function(filterConfig,filterConfigIdx){return _c("el-row",{key:filterConfigIdx,staticClass:"mT10"},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"fc-input-div-full-border width100"},[_c("div",{staticClass:"fL"},[_c("div",{staticClass:"label-txt-black fw4"},[_vm._v(" "+_vm._s(filterConfig.name)+" ")])]),_c("div",{staticClass:"fR border-left1 pL15 pointer",on:{click:function($event){return _vm.openFilterConfig(filterConfig)}}},[_c("img",{attrs:{src:__webpack_require__(948950),width:"14",height:"14"}})])])])],1)})),1):_vm._e()],1)]),_c("div",{staticClass:"border-top5 mT20"},[_c("div",{staticClass:"pL20 pR20"},[_c("el-row",{staticClass:"clearboth pT20"},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"fL"},[_c("div",{staticClass:"fc-black2 f14 fw-bold pB5"},[_vm._v(" "+_vm._s(_vm.$t("home.reports.drilldown"))+" ")])]),_c("div",{staticClass:"fR"},[_c("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"top",arrow:!0,animation:"shift-away"},expression:"{\n                            placement: 'top',\n                            arrow: true,\n                            animation: 'shift-away',\n                          }"}],staticClass:"fc-dark-blue4-12 pointer",attrs:{title:_vm.$t("common._common.edit")},on:{click:function($event){_vm.showDrilldownConfig=!0}}},[_vm._v(" "+_vm._s(null===_vm.config.reportDrilldownPath||_vm.config.reportDrilldownPath&&0===_vm.config.reportDrilldownPath.length?_vm.$t("common._common.add"):_vm.$t("common._common.edit"))+" ")])])])],1)],1)])])]),_c("div",{staticClass:"report-sidebar-position-setup"},[_vm.secondPanelToggle?_c("div",{staticClass:"sidebar-close-btn pointer"},[_c("div",[_c("i",{staticClass:"el-icon-close",on:{click:_vm.closeActivePanel}})])]):_vm._e(),_vm.secondPanelToggle?_c("div",{staticClass:"report-assets-points-Scontainer assets-points-Scontainer-lalign pL10 pR10"},[_c("div",{staticClass:"report-sidebar-inner"},[_c("div",{staticClass:"report-sidebar-secondpanel-scroll"},[_vm.activePanel===_vm.activePanelEnum.DIMENSION?_c("div",[_c("div",{staticClass:"building-points-search building-points-height"},[_c("el-input",{attrs:{placeholder:"Search",autofocus:""},model:{value:_vm.filterQuery,callback:function($$v){_vm.filterQuery=$$v},expression:"filterQuery"}})],1),_vm._l(_vm.filteredDimensionConfig,(function(dimension,dimensionIdx){return _c("el-row",{key:dimensionIdx},[_c("div",{staticClass:"label-txt-black pB10 f14 pT10 pL10 pR10 fw-bold",class:[{"fw-bold":!!_vm.config.dimension.dimension&&_vm.config.dimension.dimension.displayName===dimension.displayName}]},[_vm._v(" "+_vm._s(dimension.displayName)+" "),_vm.config.dimension.dimension&&_vm.config.dimension.dimension.displayName===dimension.displayName?_c("span",{staticClass:"active-arrow position-relative fR"}):_vm._e()]),dimension.showSubFields?_c("div",_vm._l(dimension.subFields,(function(field,fieldIdx){return _c("el-row",{key:fieldIdx,staticClass:"pointer label-txt-black pB10 f14 pT10 pL10 pR10 fc-label-hover",class:{"selected-field-background":!!_vm.config.dimension.subDimension&&(_vm.config.dimension.subDimension.displayName===field.displayName&&_vm.config.dimension.subDimension.moduleId===field.moduleId)}},[_c("div",{staticClass:"mL5 pointer",on:{click:function($event){return _vm.setDimension(dimension,field)}}},[_vm._v(" "+_vm._s(field.displayName)+" ")])])})),1):_vm._e()])}))],2):_vm.activePanel===_vm.activePanelEnum.METRIC?_c("div",_vm._l(_vm.metrics,(function(metric,metricIdx){return _c("div",{key:metricIdx,staticClass:"pointer label-txt-black pB10 f14 pT10 pL10 pR10 fc-label-hover",class:{pointer:!0,"asset-list-block-txt":!0,"selected-field-background":!!_vm.config.metric&&!!_vm.metricSelected(metric)}},[_c("div",{on:{click:function($event){return _vm.setDimension(metric)}}},[_vm._v(" "+_vm._s(metric.displayName)+" ")])])})),0):_vm.activePanel===_vm.activePanelEnum.GROUPBY?_c("div",[_c("div",{staticClass:"building-points-search building-points-height"},[_c("el-input",{attrs:{placeholder:"Search",autofocus:""},model:{value:_vm.filterQuery,callback:function($$v){_vm.filterQuery=$$v},expression:"filterQuery"}})],1),_vm._l(_vm.filteredGroupByConfig,(function(group,groupIdx){return _c("el-row",{key:groupIdx},[_c("div",{staticClass:"label-txt-black pB10 f14 pT10 pL10 pR10 fw-bold",class:[{"asset-list-header-txt":!0},{"fw-bold":!!_vm.config.groupBy.dimension&&_vm.config.groupBy.dimension.displayName===group.displayName}]},[_vm._v(" "+_vm._s(group.displayName)+" "),_vm.config.groupBy.dimension&&_vm.config.groupBy.dimension.displayName===group.displayName?_c("span",{staticClass:"active-arrow position-relative",staticStyle:{left:"60%"}}):_vm._e()]),group.showSubFields?_c("div",_vm._l(group.subFields,(function(groupByField,groupByFieldIdx){return groupByField.show?_c("el-row",{key:groupByFieldIdx,staticClass:"pointer label-txt-black pB10 f14 pT10 pL10 pR10 fc-label-hover pointer asset-list-block-txt",class:{"asset-list-txt":!0,"selected-field-background":!!_vm.config.groupBy.subDimension&&(_vm.config.groupBy.subDimension.displayName===groupByField.displayName&&_vm.config.dimension.subDimension.moduleId===groupByField.moduleId)}},[_c("div",{staticClass:"mL5 pointer",on:{click:function($event){return _vm.setDimension(group,groupByField)}}},[_vm._v(" "+_vm._s(groupByField.displayName)+" ")])]):_vm._e()})),1):_vm._e()])}))],2):_vm._e()])])]):_vm._e()])]):_vm._e(),_vm.showChartCustomization?_c("div",{staticClass:"customize-container building-customize-container col-4"},[_c("div",{staticClass:"customize-header"},[_c("div",{staticClass:"customize-H"},[_vm._v(" "+_vm._s(_vm.$t("home.reports.chart_customization"))+" ")])]),_c("div",{staticClass:"customize-body"},[_c("f-chart-customization",{staticClass:"report-chart-customization",attrs:{optionsToEnable:null===_vm.config.groupBy.dimension?[1,2,3,4]:[2,3,4],report:_vm.reportObject,resultDataPoints:_vm.resultObject?_vm.resultObject.report.dataPoints:[]}})],1)]):_vm._e()]),_vm.hideSideBar?_vm._e():_c("div",{staticClass:"report-settings-group",style:{left:_vm.cssLeft}},[_c("el-button-group",[_c("el-button",{staticClass:"report-settings-btn",class:{"analytics-report-icon-bg-active":_vm.showInnerPanel},attrs:{type:"primary"},on:{click:function($event){_vm.showInnerPanel=!0,_vm.showChartCustomization=!1}}},[_c("InlineSvg",{attrs:{src:"statistics",iconClass:"icon icon-sm-md  vertical-middle report-option-img report-rotate-icons"}})],1),_c("el-button",{staticClass:"report-settings-btn report-settings-btn2",class:{"analytics-report-icon-bg-active":_vm.showChartCustomization},attrs:{type:"primary",disabled:null===_vm.reportObject||"undefined"===typeof _vm.reportObject},on:{click:function($event){_vm.showChartCustomization=!0,_vm.showInnerPanel=!1}}},[_c("InlineSvg",{attrs:{src:"settings-grey",iconClass:"icon icon-sm-md vertical-middle report-option-img"}})],1),_c("el-button",{staticClass:"report-settings-btn report-settings-btn3",attrs:{type:"primary"},on:{click:_vm.toggleSideBar}},[_c("InlineSvg",{attrs:{src:"arrow-pointing-to-left2",iconClass:"icon icon-sm-md vertical-middle report-option-img report-rotate-icons"}})],1)],1)],1),_vm.hideSideBar?_c("div",{staticClass:"report-settings-group settings-group-edge"},[_c("el-button-group",[_c("el-button",{staticClass:"report-settings-btn",class:{"analytics-report-icon-bg-active":_vm.showInnerPanel},attrs:{type:"primary"},on:{click:function($event){_vm.hideSideBar=!1,_vm.showInnerPanel=!0,_vm.showChartCustomization=!1}}},[_c("InlineSvg",{attrs:{src:"statistics",iconClass:"icon icon-sm-md  vertical-middle report-option-img report-rotate-icons"}})],1),_c("el-button",{staticClass:"report-settings-btn report-settings-btn2",class:{"analytics-report-icon-bg-active":_vm.showChartCustomization},attrs:{type:"primary",disabled:null===_vm.reportObject||"undefined"===typeof _vm.reportObject},on:{click:function($event){_vm.hideSideBar=!1,_vm.showChartCustomization=!0,_vm.showInnerPanel=!1}}},[_c("InlineSvg",{attrs:{src:"settings-grey",iconClass:"icon icon-sm-md vertical-middle report-option-img"}})],1),_c("el-button",{staticClass:"report-settings-btn report-settings-btn3",staticStyle:{transform:"rotate(180deg)"},attrs:{type:"primary"},on:{click:_vm.toggleSideBar}},[_c("InlineSvg",{attrs:{src:"arrow-pointing-to-left2",iconClass:"icon icon-sm-md vertical-middle report-option-img report-rotate-icons"}})],1)],1)],1):_vm._e(),_c("div",{staticClass:"height100 scrollable",class:{"report-graph-con-chartCustom-apply":!0===_vm.showChartCustomization&&!1===_vm.hideSideBar,"report-graph-con":!_vm.hideSideBar&&!1===_vm.showChartCustomization,"report-graph-con-stretch":_vm.hideSideBar}},[_c("div",[_c("div",{staticClass:"report-preview text-center pT0 new-report-page-chart",staticStyle:{"margin-bottom":"50px"}},[_c("div",{staticClass:"reports-chart"},[_vm.showChart?_c("f-new-analytic-modular-report",{ref:"analyticReport",attrs:{savedReport:_vm.savedReport,reportid:_vm.reportId,module:_vm.computedModule,showDatePicker:_vm.showDatePicker,serverConfig:_vm.serverConfig},on:{"update:serverConfig":function($event){_vm.serverConfig=$event},"update:server-config":function($event){_vm.serverConfig=$event},reportLoaded:_vm.populateReportObjects}}):_vm._e()],1)])])])]),_c("el-dialog",{staticClass:"fc-dialog-center-container fc-dialog-header-hide",attrs:{visible:_vm.showCriteriaBuilder,width:"50%","lock-scroll":!1},on:{"update:visible":function($event){_vm.showCriteriaBuilder=$event}}},[_c("el-tabs",{staticClass:"fc-analytics-filter-tab pattern-visible",model:{value:_vm.activeTab,callback:function($$v){_vm.activeTab=$$v},expression:"activeTab"}},[_c("el-tab-pane",{staticClass:"criteria-scroll",attrs:{label:"Add Criteria",name:"criteria"}},[_c("div",{staticClass:"height400"},[_c("CriteriaBuilder",{attrs:{moduleName:_vm.moduleName},model:{value:_vm.config.criteria,callback:function($$v){_vm.$set(_vm.config,"criteria",$$v)},expression:"config.criteria"}})],1)]),_c("el-tab-pane",{attrs:{label:"Data Filter",name:"dataFilter"}},[_c("div",{staticClass:"height400"},[_vm.isMetricsEmpty?_vm._e():_c("aggr-data-filter",{staticClass:"report-criteria-buuilder",attrs:{having:_vm.config.having,metrics:_vm.metrics.filter((function(metric){return!metric.defaultMetric}))},on:{setDataFilter:_vm.setDataFilter}})],1)])],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){_vm.showCriteriaBuilder=!1}}},[_vm._v(_vm._s(_vm.$t("common._common.close")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:_vm.addCriteriaAndResconstruct}},[_vm._v(_vm._s(_vm.$t("common.wo_report.apply")))])],1)],1),_vm.config.userFilters?_c("ModularUserFilters",{attrs:{config:_vm.currentUserFilter,moduleName:_vm.getSelectedModuleName(),visibility:_vm.showFilterConfigDialog},on:{"update:visibility":function($event){_vm.showFilterConfigDialog=$event},filter:_vm.setConfigForUserFilter}}):_vm._e(),_c("ModularUserFiltersList",{attrs:{existingConfig:_vm.config.userFilters,moduleName:this.$helpers.isLicenseEnabled("NEW_ALARMS")&&"alarm"===this.moduleName?"newreadingalarm":this.moduleName,visibility:_vm.showUserFilter},on:{"update:visibility":function($event){_vm.showUserFilter=$event},setFilter:_vm.setUserFilter}}),_vm.showLookUpFilter?_c("LookUpFilter",{attrs:{config:_vm.lookUpFilterConfig,visibility:_vm.showLookUpFilter},on:{"update:visibility":function($event){_vm.showLookUpFilter=$event},setLookUpFilterConfig:_vm.setLookUpFilterConfig}}):_vm._e(),_vm.showDrilldownConfig?_c("DrilldownConfig",{attrs:{visibility:_vm.showDrilldownConfig,reportSettings:_vm.config.reportSettings,reportDrilldownPath:_vm.config.reportDrilldownPath,timeAggregators:_vm.timeAggregators,isDimensionTime:_vm.serverConfig&&_vm.serverConfig.isTime,dateField:_vm.serverConfig&&_vm.serverConfig.dateField,initialDimensionConfig:_vm.initialDimensionConfig,moduleResourceField:_vm.moduleResourceField,reportModuleId:_vm.moduleId},on:{"update:visibility":function($event){_vm.showDrilldownConfig=$event},"update:reportSettings":function($event){return _vm.$set(_vm.config,"reportSettings",$event)},"update:report-settings":function($event){return _vm.$set(_vm.config,"reportSettings",$event)},"update:reportDrilldownPath":function($event){return _vm.$set(_vm.config,"reportDrilldownPath",$event)},"update:report-drilldown-path":function($event){return _vm.$set(_vm.config,"reportDrilldownPath",$event)},save:_vm.drilldownConfigSaved}}):_vm._e()],1)],1)},staticRenderFns=[],esm_typeof=__webpack_require__(103336),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),createForOfIteratorHelper=__webpack_require__(566347),objectSpread2=__webpack_require__(595082),toConsumableArray=__webpack_require__(488478),NewDataFormatHelper=(__webpack_require__(689730),__webpack_require__(260228),__webpack_require__(76265),__webpack_require__(538077),__webpack_require__(670560),__webpack_require__(434284),__webpack_require__(976801),__webpack_require__(634338),__webpack_require__(425728),__webpack_require__(450886),__webpack_require__(843843),__webpack_require__(169358),__webpack_require__(564043),__webpack_require__(709873),__webpack_require__(506203),__webpack_require__(162506),__webpack_require__(659749),__webpack_require__(386544),__webpack_require__(804911)),FNewAnalyticModularReport=__webpack_require__(247942),dist=__webpack_require__(191853),FReportOptions=__webpack_require__(791514),FChartCustomization=__webpack_require__(472511),NewDateHelper=__webpack_require__(105534),ModularUserFiltersvue_type_template_id_1364091d_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"fc-dialog-center-container",attrs:{title:_vm.currentFilterConfig?_vm.currentFilterConfig.name+": Configure filter":"",visible:_vm.visibility,width:"60%","append-to-body":!0,"show-close":!1,"close-on-click-modal":!1},on:{"update:visible":function($event){_vm.visibility=$event},keydown:function($event){return!$event.type.indexOf("key")&&_vm._k($event.keyCode,"esc",27,$event.key,["Esc","Escape"])?null:_vm.closeConfigDialog.apply(null,arguments)}}},[_c("div",{staticClass:"height400 overflow-y-scroll pB80"},[_c("el-row",[_c("el-col",{attrs:{span:14}},[_c("div",{staticClass:"fc-grey-text-input-label"}),_c("el-select",{staticClass:"fc-input-full-border-select2 width100",model:{value:_vm.currentFilterConfig.component.componentType,callback:function($$v){_vm.$set(_vm.currentFilterConfig.component,"componentType",$$v)},expression:"currentFilterConfig.component.componentType"}},_vm._l(Object.keys(_vm.getAvailableComponents),(function(compo,compoIdx){return _c("el-option",{key:compoIdx,attrs:{value:parseInt(compo),label:_vm.componentType[compo].displayLabel}})})),1)],1)],1),_c("div",{staticClass:"border-bottom4 pT20 width100 inline-block"},[_c("div",{staticClass:"fL"},[_c("div",{staticClass:"pT10 pB10"},[_c("el-checkbox",{on:{change:function($event){return _vm.selectAll()}},model:{value:_vm.showAll,callback:function($$v){_vm.showAll=$$v},expression:"showAll"}},[_vm._v("Show All")])],1)]),_c("div",{staticClass:"fR"},[_c("div",{staticClass:"flex-middle pT10 pB10"},[_c("div",{staticClass:"label-txt-black pointer",on:{click:function($event){return _vm.clearSelection()}}},[_vm._v(" Clear All ")]),_c("div",{staticClass:"fc-pink-circle-txt mL10"},[_vm._v(" "+_vm._s(Object.keys(_vm.fieldValues).filter((function(field){return!0===_vm.fieldValues[field]})).length)+" ")])])])]),_c("div",{staticClass:"clearboth"},_vm._l(_vm.computedValueList,(function(row,rowIdx){return _c("el-row",{key:rowIdx},_vm._l(Object.keys(row),(function(field,fieldIdx){return _c("el-col",{key:fieldIdx,staticClass:"pR10",attrs:{span:12}},[_c("div",{staticClass:"flex-middle visibility-visible-actions pointer justify-content-space fc-check-grey-border"},[_c("el-checkbox",{attrs:{disabled:!0===_vm.showAll},on:{click:function($event){return _vm.setField(field,$event)}},model:{value:_vm.fieldValues[field],callback:function($$v){_vm.$set(_vm.fieldValues,field,$$v)},expression:"fieldValues[field]"}},[_vm._v(_vm._s(row[field]))]),_vm.currentFilterConfig&&_vm.currentFilterConfig.defaultValues[_vm.currentFilterConfig.defaultValues.length-1]!==field?_c("div",{staticClass:"text-right fc-text-pink visibility-hide-actions",on:{click:function($event){return _vm.setDefault(field)}}},[_vm._v(" Set Default ")]):_c("div",{staticClass:"text-right fc-text-pink"},[_vm._v("Default")])],1)])})),1)})),1),_c("div",{staticClass:"pT10 pB10"},[_c("el-checkbox",{attrs:{disabled:1===_vm.currentFilterConfig.chooseValue.type},model:{value:_vm.currentFilterConfig.chooseValue.otherEnabled,callback:function($$v){_vm.$set(_vm.currentFilterConfig.chooseValue,"otherEnabled",$$v)},expression:"currentFilterConfig.chooseValue.otherEnabled"}},[_vm._v("Others")])],1)],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.closeConfigDialog}},[_vm._v("CANCEL")]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:_vm.addUserFilter}},[_vm._v("SAVE")])],1)])},ModularUserFiltersvue_type_template_id_1364091d_staticRenderFns=[],modularUserFilter=__webpack_require__(884900),ModularUserFiltersvue_type_script_lang_js={props:["visibility","moduleName","config"],watch:{config:{handler:function(oldValue,newValue){null===this.config?this.resetUserFilters():this.loadAll()},deep:!0}},mixins:[modularUserFilter/* default */.Z],computed:{getAvailableComponents:function(){for(var temp={},_i=0,_Object$keys=Object.keys(this.componentType);_i<_Object$keys.length;_i++){var component=_Object$keys[_i];this.currentFilterConfig&&this.currentFilterConfig.component.availableComponents.includes(parseInt(component))&&(temp[component]=this.componentType[component])}return temp},computedValueList:function(){var values=[];if(this.config)for(var i=0;i<=this.currentFilterConfig.allValues.length-2;i+=2){var row=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},this.currentFilterConfig.allValues[i]),this.currentFilterConfig.allValues[i+1]);values.push(row)}return values}},created:function(){"undefined"!==typeof this.config&&null!==this.config&&this.loadAll()},data:function(){return{currentFilterConfig:null,showAll:!1,showAny:!1,isDefault:!1,defaultField:null,showOthers:!1,fieldValues:{}}},methods:{loadAll:function(){if("undefined"!==typeof this.config&&null!==this.config)if(this.fieldValues={},this.currentFilterConfig=this.$helpers.cloneObject(this.config),this.config.chooseValue.type===this.type.all){this.showAll=!0,this.showAny=!1,0!==this.config.defaultValues.length&&(this.isDefault=!0);var _step,_iterator=(0,createForOfIteratorHelper/* default */.Z)(this.currentFilterConfig.allValues);try{for(_iterator.s();!(_step=_iterator.n()).done;){var value=_step.value;this.$set(this.fieldValues,Object.keys(value)[0],!0)}}catch(err){_iterator.e(err)}finally{_iterator.f()}}else{this.showAny=!0,this.showAll=!1,0!==this.config.defaultValues.length&&(this.isDefault=!0);var _step2,_iterator2=(0,createForOfIteratorHelper/* default */.Z)(this.currentFilterConfig.allValues);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _value=_step2.value;this.currentFilterConfig.chooseValue.values.includes(Object.keys(_value)[0])?this.$set(this.fieldValues,Object.keys(_value)[0],!0):this.$set(this.fieldValues,Object.keys(_value)[0],!1)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}},setDefault:function(field){!0===this.isDefault?(!1===this.showAll&&this.$set(this.fieldValues,this.defaultField,!1),this.$set(this.fieldValues,field,!0),this.defaultField=field,this.currentFilterConfig.defaultValues=[],this.currentFilterConfig.defaultValues.push(field)):(this.defaultField=field,this.$set(this.fieldValues,field,!0),this.currentFilterConfig.defaultValues=[],this.currentFilterConfig.defaultValues.push(field),this.isDefault=!0)},selectAll:function(){if(!0===this.showAll)for(var field in this.$set(this.currentFilterConfig.chooseValue,"otherEnabled",!1),this.showAny=!1,this.currentFilterConfig.chooseValue.type=this.type.all,this.fieldValues)this.$set(this.fieldValues,field,!0);else for(var _field in this.showAny=!0,this.currentFilterConfig.chooseValue.type=this.type.any,this.isDefault=!1,this.currentFilterConfig.defaultValues=[],this.fieldValues)this.$set(this.fieldValues,_field,!1)},clearSelection:function(){for(var key in this.fieldValues)this.$set(this.fieldValues,key,!1);this.showAll=!1},resetUserFilters:function(){this.currentFilterConfig=null,this.currentFilterConfig=null,this.showAll=!1,this.showAny=!1,this.isDefault=!1,this.fieldValues={}},
// resetUserFilters(){
//   console.log('Resetting User filters!!!')
//   Object.keys(this.selectedFields).forEach((field) =>{
//     this.selectedFields[field] = false
//   })
//   this.fieldConfigs = {}
//   this.currentFilterConfig = null
// },
filterLookupValues:function(val){var _step3,_iterator3=(0,createForOfIteratorHelper/* default */.Z)(val);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var fieldId=_step3.value;this.currentFilterConfig.filterLookupValues.push(this.currentFilterConfig.values[fieldId])}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}},setField:function(field){this.showAny=!0,this.showAll=!1,this.fieldValues[field]?this.$set(this.fieldValues,field,!0):this.$set(this.fieldValues,field,!1)},setValues:function(){for(var key in this.currentFilterConfig.chooseValue.values=[],this.fieldValues)!0===this.fieldValues[key]&&this.currentFilterConfig.chooseValue.values.push(key)},addUserFilter:function(){this.setValues(),this.$emit("filter",this.currentFilterConfig),this.closeConfigDialog()},closeConfigDialog:function(){this.$emit("update:visibility",!1)}}},components_ModularUserFiltersvue_type_script_lang_js=ModularUserFiltersvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_ModularUserFiltersvue_type_script_lang_js,ModularUserFiltersvue_type_template_id_1364091d_render,ModularUserFiltersvue_type_template_id_1364091d_staticRenderFns,!1,null,null,null)
/* harmony default export */,ModularUserFilters=component.exports,ModularUserFilterListvue_type_template_id_241732c0_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"fc-dialog-center-container",attrs:{title:"Select user filter",visible:_vm.visibility,width:"25%","append-to-body":!0,"before-close":_vm.closeDialog,"close-on-click-modal":!1},on:{"update:visible":function($event){_vm.visibility=$event},keydown:function($event){return!$event.type.indexOf("key")&&_vm._k($event.keyCode,"esc",27,$event.key,["Esc","Escape"])?null:_vm.closeDialog.apply(null,arguments)}}},[_c("div",{staticClass:"height330 overflow-y-scroll pB50"},[_c("div",{},_vm._l(_vm.moduleFields,(function(moduleField,moduleFieldIdx){return _c("div",{key:moduleFieldIdx,staticClass:"pT10 pB10"},[_c("el-checkbox",{on:{change:function($event){return _vm.addField(moduleField.fieldId,$event)}},model:{value:_vm.selectedFields[moduleField.fieldId],callback:function($$v){_vm.$set(_vm.selectedFields,moduleField.fieldId,$$v)},expression:"selectedFields[moduleField.fieldId]"}},[_vm._v(_vm._s(moduleField.displayName?moduleField.displayName:moduleField.name))])],1)})),0)]),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"btn-green-full",attrs:{type:"primary"},on:{click:function($event){return _vm.addUserFilter()}}},[_vm._v(_vm._s(_vm.$t("common._common.add")))])],1)])},ModularUserFilterListvue_type_template_id_241732c0_staticRenderFns=[],ModularUserFilterListvue_type_script_lang_js=(__webpack_require__(186466),{props:["visibility","moduleName","existingConfig"],mixins:[modularUserFilter/* default */.Z],data:function(){return{selectedFields:{},moduleFields:[],moduleOperators:[],fieldConfigs:{}}},watch:{existingConfig:{handler:function(oldValue,newValue){if("undefined"!==typeof this.existingConfig)if(null===this.existingConfig)this.resetUserFilters();else{this.fieldConfigs={};var _step,_iterator=(0,createForOfIteratorHelper/* default */.Z)(this.existingConfig);try{for(_iterator.s();!(_step=_iterator.n()).done;){var config=_step.value;this.$set(this.selectedFields,config.fieldId,!0),this.$set(this.fieldConfigs,config.fieldId,config)}}catch(err){_iterator.e(err)}finally{_iterator.f()}}},deep:!0},moduleName:{handler:function(oldValue,newValue){oldValue!==newValue&&this.render()},immediate:!0}},methods:{addField:function(fieldId){if(this.selectedFields[fieldId]){var facilioField=this.moduleFields.filter((function(field){return field.fieldId===fieldId}));if(0!==facilioField.length)if("undefined"!==typeof this.existingConfig&&null!==this.existingConfig){var field=this.existingConfig[fieldId];field?this.$set(this.fieldConfigs,field.fieldId,field):this.getDefaultSettingsForField(facilioField[0],this.moduleName)}else this.getDefaultSettingsForField(facilioField[0],this.moduleName)}else delete this.fieldConfigs[fieldId]},addUserFilter:function(){for(var field in this.fieldConfigs){var config=this.fieldConfigs[field];config.chooseValue.values=[];var _step2,_iterator2=(0,createForOfIteratorHelper/* default */.Z)(config.allValues);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var val=_step2.value;config.chooseValue.values.push(Object.keys(val)[0])}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}this.$emit("setFilter",Object.values(this.fieldConfigs))},resetUserFilters:function(){for(var fieldId in this.selectedFields)this.$set(this.selectedFields,fieldId,!1);this.fieldConfigs={}},closeDialog:function(){this.$emit("update:visibility",!1)},render:function(){var _this=this;this.moduleFields=[],this.$http.get("/module/meta?moduleName="+this.moduleName).then((function(response){_this.moduleOperators=response.data.meta.operators;var _step3,_iterator3=(0,createForOfIteratorHelper/* default */.Z)(response.data.meta.fields);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var fieldObj=_step3.value;7===fieldObj.dataType&&_this.moduleFields.push(fieldObj)}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}if("undefined"!==typeof _this.moduleName&&"undefined"!==typeof _this.existingConfig&&null!==_this.existingConfig){var _step4,_iterator4=(0,createForOfIteratorHelper/* default */.Z)(_this.existingConfig);try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var fieldConfig=_step4.value;_this.$set(_this.selectedFields,fieldConfig.fieldId,!0)}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}var _step5,_iterator5=(0,createForOfIteratorHelper/* default */.Z)(_this.existingConfig);try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var config=_step5.value;_this.$set(_this.fieldConfigs,config.fieldId,config)}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}}}))}},created:function(){
// this.render()
}}),components_ModularUserFilterListvue_type_script_lang_js=ModularUserFilterListvue_type_script_lang_js,ModularUserFilterList_component=(0,componentNormalizer/* default */.Z)(components_ModularUserFilterListvue_type_script_lang_js,ModularUserFilterListvue_type_template_id_241732c0_render,ModularUserFilterListvue_type_template_id_241732c0_staticRenderFns,!1,null,null,null)
/* harmony default export */,ModularUserFilterList=ModularUserFilterList_component.exports,LookupFiltervue_type_template_id_adce070c_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"fc-dialog-center-container",attrs:{title:_vm.filterConfig?_vm.filterConfig.name:"",visible:_vm.visibility,width:"40%","append-to-body":!0,"show-close":!1,"before-close":_vm.closeConfigDialog,"close-on-click-modal":!1},on:{"update:visible":function($event){_vm.visibility=$event}}},[_c("div",{staticClass:"height400 overflow-y-scroll pB80"},[Object.keys(_vm.filterConfig.allValues).length<=_vm.maxCount?_c("div",{staticClass:"border-bottom4 width100 inline-block"},[_c("div",{staticClass:"fL"},[_c("div",{staticClass:"pT10 pB10"},[_c("el-checkbox",{on:{change:function($event){return _vm.selectAll()}},model:{value:_vm.select_All,callback:function($$v){_vm.select_All=$$v},expression:"select_All"}},[_vm._v("Select All")])],1)])]):_vm._e(),_c("div",{staticClass:"clearboth"},[Object.keys(_vm.filterConfig.allValues).length?_vm._e():_c("div",{staticClass:"pT20 pB20 pL20"},[_vm._v(" Loading... ")]),_c("el-row",[_c("el-checkbox-group",{staticClass:"fdimension-filter-group",attrs:{max:_vm.maxCount},model:{value:_vm.selectedValues,callback:function($$v){_vm.selectedValues=$$v},expression:"selectedValues"}},_vm._l(_vm.filterConfig.allValues,(function(value,key){return _c("el-checkbox",{key:key,attrs:{label:parseInt(key)}},[_vm._v(_vm._s(value))])})),1)],1)],1)]),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.closeConfigDialog}},[_vm._v("CANCEL")]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:_vm.saveFilter}},[_vm._v("SAVE")])],1)])},LookupFiltervue_type_template_id_adce070c_staticRenderFns=[],LookupFiltervue_type_script_lang_js={props:["visibility","config"],watch:{config:{handler:function(oldValue,newValue){null===this.config?this.reset():this.load()},deep:!0}},created:function(){"undefined"!==typeof this.config&&null!==this.config&&this.load()},data:function(){return{filterConfig:null,select_All:!1,selectedValues:[],chooseValues:[],maxCount:15}},methods:{load:function(){this.filterConfig=this.$helpers.cloneObject(this.config),this.selectedValues=this.filterConfig.chooseValues},selectAll:function(){if(!0===this.select_All){var values=[];for(var field in this.filterConfig.allValues)values.push(parseInt(field));this.selectedValues=values}else this.selectedValues=[]},reset:function(){this.filterConfig=null,this.selectedValues=[],this.select_All=!1},saveFilter:function(){this.filterConfig.chooseValues=this.selectedValues,this.$emit("setLookUpFilterConfig",this.filterConfig),this.closeConfigDialog()},closeConfigDialog:function(){this.$emit("update:visibility",!1)}}},components_LookupFiltervue_type_script_lang_js=LookupFiltervue_type_script_lang_js,LookupFilter_component=(0,componentNormalizer/* default */.Z)(components_LookupFiltervue_type_script_lang_js,LookupFiltervue_type_template_id_adce070c_render,LookupFiltervue_type_template_id_adce070c_staticRenderFns,!1,null,null,null)
/* harmony default export */,LookupFilter=LookupFilter_component.exports,DrilldownConfigvue_type_template_id_596f050a_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"drilldown-config"},[_c("el-dialog",{staticClass:"drilldown-config-dialog",attrs:{visible:_vm.visibility,"show-close":!1,"append-to-body":!0,title:_vm.$t("reportdrilldown.configure"),width:"60%"}},[_c("div",{staticClass:"body"},[_c("div",{staticClass:"title mB10"},[_vm._v(" "+_vm._s(_vm.$t("reportdrilldown.clickAction"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border-h35 mB20 width200px ",model:{value:_vm.reportSettingsModel.clickAction,callback:function($$v){_vm.$set(_vm.reportSettingsModel,"clickAction",$$v)},expression:"reportSettingsModel.clickAction"}},[_c("el-option",{attrs:{value:1,label:_vm.$t("reportdrilldown.none")}}),_c("el-option",{attrs:{value:2,label:_vm.$t("reportdrilldown.list")}}),_c("el-option",{attrs:{value:3,label:_vm.$t("reportdrilldown.drilldown")}}),_c("el-option",{attrs:{value:4,label:"Dashboard Action"}})],1),3===_vm.reportSettingsModel.clickAction?_c("div",{staticClass:"path-config-cont "},[_c("div",{staticClass:"option-config-separator"}),_c("div",{staticClass:"title mB20 mT20"},[_vm._v(" "+_vm._s(_vm.$t("reportdrilldown.path"))+" ")]),_vm._l(_vm.reportDrilldownPathModel,(function(drillStep,drillStepIndex){return _c("drill-step-select",{key:drillStepIndex,class:[{"is-last":drillStepIndex==_vm.reportDrilldownPathModel.length-1}],attrs:{dimensions:_vm.isDimensionTime?_vm.timeDimensions:_vm.nonTimeDimensions},on:{add:_vm.addDrillStep,remove:_vm.removeDrillStep},model:{value:_vm.reportDrilldownPathModel[drillStepIndex],callback:function($$v){_vm.$set(_vm.reportDrilldownPathModel,drillStepIndex,$$v)},expression:"reportDrilldownPathModel[drillStepIndex]"}})}))],2):_vm._e()],1),_c("div",{staticClass:"dialog-save-cancel"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.closeDialog}},[_vm._v(" "+_vm._s(_vm.$t("common._common.cancel")))]),_c("el-button",{staticClass:"modal-btn-save mL0",attrs:{type:"primary"},on:{click:_vm.save}},[_vm._v(_vm._s(_vm.$t("common._common.done")))])],1)])],1)},DrilldownConfigvue_type_template_id_596f050a_staticRenderFns=[],utility_methods=(__webpack_require__(947522),__webpack_require__(773258)),DrillStepSelectvue_type_template_id_100a3df6_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"x-field-select width40 d-flex"},[_c("el-select",{staticClass:"fc-input-full-border-h35   mB20 width100",attrs:{placeholder:"Select",filterable:"","popper-class":"fc-group-select"},model:{value:_vm.selectModel,callback:function($$v){_vm.selectModel=$$v},expression:"selectModel"}},_vm._l(_vm.dimensions,(function(dimension,dimensionIndex){return _c("el-option-group",{key:dimensionIndex,attrs:{label:dimension.displayName}},_vm._l(dimension.subFields,(function(field,fieldIndex){return _c("el-option",{key:fieldIndex,attrs:{label:field.displayName,value:field.fieldId_xAggr}})})),1)})),1),_c("img",{staticClass:"add-remove-icons",attrs:{src:__webpack_require__(353654)},on:{click:function($event){return _vm.$emit("add")}}}),_c("img",{staticClass:"add-remove-icons",attrs:{src:__webpack_require__(385769)},on:{click:function($event){return _vm.$emit("remove")}}})],1)},DrillStepSelectvue_type_template_id_100a3df6_staticRenderFns=[],slicedToArray=__webpack_require__(554621),DrillStepSelectvue_type_script_lang_js=(__webpack_require__(648324),{props:["value","dimensions"],data:function(){return{}},computed:{
//use xfield ID as v-model unique key
selectModel:{get:function(){return this.value.fieldId_xAggr},set:function(fieldId_xAggr){var fieldObj=null;this.dimensions.forEach((function(dimension){dimension.subFields.forEach((function(subField){subField.fieldId_xAggr==fieldId_xAggr&&(fieldObj=subField)}))}));var _fieldId_xAggr$split=fieldId_xAggr.split("_"),_fieldId_xAggr$split2=(0,slicedToArray/* default */.Z)(_fieldId_xAggr$split,2),field_id=_fieldId_xAggr$split2[0],xAggr=_fieldId_xAggr$split2[1];isNaN(field_id)||(
//field_id can also be string , formula fields , fieldName is stored as field_id
field_id=parseInt(field_id)),xAggr=parseInt(xAggr);var drillStepMeta={fieldId_xAggr:fieldId_xAggr,xAggr:xAggr,xField:{field_id:field_id,module_id:fieldObj.moduleId}};this.$emit("input",drillStepMeta)}}}}),reports_DrillStepSelectvue_type_script_lang_js=DrillStepSelectvue_type_script_lang_js,DrillStepSelect_component=(0,componentNormalizer/* default */.Z)(reports_DrillStepSelectvue_type_script_lang_js,DrillStepSelectvue_type_template_id_100a3df6_render,DrillStepSelectvue_type_template_id_100a3df6_staticRenderFns,!1,null,null,null)
/* harmony default export */,DrillStepSelect=DrillStepSelect_component.exports,DrilldownConfigvue_type_script_lang_js={components:{DrillStepSelect:DrillStepSelect},props:["visibility","reportSettings","reportDrilldownPath","initialDimensionConfig","timeAggregators","isDimensionTime","moduleResourceField","reportModuleId",
//fill formula fields moduleId with this
"dateField"],computed:{
//For space fields field ID is same but xAgg field{id:123123,value:26} differs and for other fields aggregation is null/0 but field ID differs
//so construct a unique identifier fieldId_xAgg and use it as v-model key
nonTimeDimensions:function(){var _this=this,temp=(0,utility_methods/* deepCloneObject */.kh)(this.initialDimensionConfig);return temp=temp.filter((function(e){return"Time"!=e.displayName})),temp.forEach((function(dimension){"Space"==dimension.displayName&&_this.moduleResourceField?dimension.subFields.forEach((function(field){field.id||(
//only space category field has an id, for others use resource field id AS ID
field.id=_this.moduleResourceField.id,field.moduleId=_this.moduleResourceField.moduleId)})):dimension.subFields.forEach((function(field){-1==field.id&&(
//formula fields
field.id=field.name,field.moduleId=_this.reportModuleId)}))})),temp.forEach((function(dimension){dimension.subFields.forEach((function(field){var xAgg=field.value&&field.value>-1?field.value:0;field.fieldId_xAggr=field.id+"_"+xAgg}))})),temp},timeDimensions:function(){var _this2=this;
//for report with X-Time axis ,show aggregators as options
if(this.isDimensionTime&&this.dateField){var temp=(0,utility_methods/* deepCloneObject */.kh)(this.timeAggregators);temp.forEach((function(timeAggr){var xAggr=timeAggr.value&&timeAggr.value>-1?timeAggr.value:0;timeAggr.id=_this2.dateField.field_id,timeAggr.moduleId=_this2.dateField.module_id,timeAggr.fieldId_xAggr=timeAggr.id+"_"+xAggr}));var dimensions=[{displayName:"Time",subFields:temp}];return dimensions}return null}},created:function(){this.reportSettingsModel=(0,utility_methods/* deepCloneObject */.kh)(this.reportSettings),this.reportDrilldownPath&&0!=this.reportDrilldownPath.length?(this.reportDrilldownPathModel=(0,utility_methods/* deepCloneObject */.kh)(this.reportDrilldownPath),this.reportDrilldownPathModel.forEach((function(drillStep){
//zero x aggr doesn't get saved in ENUM BMSaggragate operator field
drillStep.xAggr<0&&(drillStep.xAggr=0),drillStep.fieldId_xAggr=drillStep.xField.field_id+"_"+drillStep.xAggr}))):
//add first drill step if no path configured
this.addDrillStep()},data:function(){return{reportDrilldownPathModel:[],reportSettingsModel:null}},methods:{closeDialog:function(){this.$emit("update:visibility",!1)},save:function(){this.$emit("update:reportSettings",this.reportSettingsModel),this.$emit("update:reportDrilldownPath",this.reportDrilldownPathModel),this.$emit("save")},
// serialize(reportSettingsModel)
// {
//   // TO DO , send only required props . FIX data type wrong at source
//     reportSettingsModel.forEach(e=>{
//       if(e.xField&&!isNaN(e.xField.field_id))
//       {
//           e.xField.field_id=parseInt(e.xField.field_id)
//       }
//     }
//     )
//     return reportSettingsModel
// },
removeDrillStep:function(){this.reportDrilldownPathModel.splice(this.reportDrilldownPathModel.length-1,1)},addDrillStep:function(){
//copy option 1 and add
var firstOption=null;firstOption=this.isDimensionTime?this.timeDimensions[0].subFields[0]:this.nonTimeDimensions[0].subFields[0];var field_id=firstOption.fieldId_xAggr.split("_")[0];isNaN(field_id)||(field_id=parseInt(field_id));var xAggr=parseInt(firstOption.fieldId_xAggr.split("_")[1]),module_id=firstOption.moduleId,drillStep={fieldId_xAggr:firstOption.fieldId_xAggr,xAggr:xAggr,xField:{field_id:field_id,module_id:module_id}};this.reportDrilldownPathModel.push(drillStep)}}},reports_DrilldownConfigvue_type_script_lang_js=DrilldownConfigvue_type_script_lang_js,DrilldownConfig_component=(0,componentNormalizer/* default */.Z)(reports_DrilldownConfigvue_type_script_lang_js,DrilldownConfigvue_type_template_id_596f050a_render,DrilldownConfigvue_type_template_id_596f050a_staticRenderFns,!1,null,null,null)
/* harmony default export */,DrilldownConfig=DrilldownConfig_component.exports,AggregatedDataFiltervue_type_template_id_e4729d10_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("div",{staticClass:"criteria-container"},_vm._l(_vm.dataFilter,(function(filter,idx){return _c("div",{key:idx,staticClass:"criteria-condition-block"},[_c("div",{staticClass:"criteria-alphabet-block pR5"},[_c("div",{staticClass:"alphabet-circle"},[_vm._v(" "+_vm._s(idx+1)+" ")])]),_c("div",{staticClass:"creteria-dropdown pR5"},[_c("el-select",{staticClass:"fc-border-select",attrs:{filterable:"",placeholder:"Select"},model:{value:filter.field,callback:function($$v){_vm.$set(filter,"field",$$v)},expression:"filter.field"}},_vm._l(_vm.metrics,(function(field,idx1){return _c("el-option",{key:idx1,attrs:{label:field.displayName,value:field.name+"_"+field.fieldId}})})),1)],1),_c("div",{staticClass:"creteria-dropdown pR5 width20"},[_c("el-select",{staticClass:"select-operator-input fc-border-select",attrs:{disabled:!filter.field||"undefined"===typeof filter.field,placeholder:"Select aggregation"},model:{value:filter.aggregateOperator,callback:function($$v){_vm.$set(filter,"aggregateOperator",$$v)},expression:"filter.aggregateOperator"}},_vm._l(_vm.aggregateOperators,(function(operator,idx2){return _c("el-option",{key:idx2,attrs:{label:operator.label,value:operator.value}})})),1)],1),_c("div",{staticClass:"creteria-dropdown pR5 width20"},[_c("el-select",{staticClass:"select-operator-input fc-border-select",attrs:{disabled:!filter.aggregateOperator||"undefined"===typeof filter.aggregateOperator,placeholder:"Select operator"},model:{value:filter.operator,callback:function($$v){_vm.$set(filter,"operator",$$v)},expression:"filter.operator"}},_vm._l(_vm.NumberOperators,(function(operator,idx3){return _c("el-option",{key:idx3,attrs:{label:operator.operator,value:operator.operatorId}})})),1)],1),_c("div",{staticClass:"creteria-input"},[_c("div",[_c("el-input",{staticClass:"fc-border-select",attrs:{disabled:!filter.operator||"undefined"===typeof filter.operator,type:"number"},model:{value:filter.value,callback:function($$v){_vm.$set(filter,"value",$$v)},expression:"filter.value"}})],1)]),_c("div",{staticClass:"creteria-delete-icon flex-middle"},[Object.keys(_vm.dataFilter).length-1===idx?_c("img",{staticClass:"delete-icon",staticStyle:{height:"18px",width:"18px"},attrs:{src:__webpack_require__(353654)},on:{click:function($event){return _vm.addFilter()}}}):_vm._e(),0!==Object.keys(_vm.dataFilter).length?_c("img",{staticClass:"delete-icon",staticStyle:{height:"18px",width:"18px","margin-right":"3px"},attrs:{src:__webpack_require__(385769)},on:{click:function($event){return _vm.removeFilter(idx)}}}):_vm._e()])])})),0)])},AggregatedDataFiltervue_type_template_id_e4729d10_staticRenderFns=[],AggregatedDataFiltervue_type_script_lang_js={data:function(){return{NumberOperators:{"<=":{dynamicOperator:!1,operator:"<=",operatorId:12,valueNeeded:!0,_name:"LESS_THAN_EQUAL"},
// 'is not empty': {
//   dynamicOperator: false,
//   operator: 'is not empty',
//   operatorId: 2,
//   valueNeeded: false,
//   _name: 'IS_NOT_EMPTY',
// },
// 'is empty': {
//   dynamicOperator: false,
//   operator: 'is empty',
//   operatorId: 1,
//   valueNeeded: false,
//   _name: 'IS_EMPTY',
// },
"!=":{dynamicOperator:!1,operator:"!=",operatorId:10,valueNeeded:!0,_name:"NOT_EQUALS"},"<":{dynamicOperator:!1,operator:"<",operatorId:11,valueNeeded:!0,_name:"LESS_THAN"},"=":{dynamicOperator:!1,operator:"=",operatorId:9,valueNeeded:!0,_name:"EQUALS"},">":{dynamicOperator:!1,operator:">",operatorId:13,valueNeeded:!0,_name:"GREATER_THAN"},">=":{dynamicOperator:!1,operator:">=",operatorId:14,valueNeeded:!0,_name:"GREATER_THAN_EQUAL"}},aggregateOperators:[{label:"Avg",value:2},{label:"Sum",value:3},{label:"Min",value:4},{label:"Max",value:5}],dataFilter:[]}},props:["having","metrics"],mounted:function(){this.addFilter(),this.initData()},methods:{addFilter:function(){this.dataFilter.push({field:void 0,aggregateOperator:void 0,operatorId:void 0,value:void 0})},initData:function(){if(this.having&&this.having.length>0){var _step,filterArray=[],_iterator=(0,createForOfIteratorHelper/* default */.Z)(this.having);try{for(_iterator.s();!(_step=_iterator.n()).done;){var filter=_step.value,temp={};temp.field=filter.fieldName+"_"+filter.fieldId,temp.aggregateOperator=filter.aggregateOperator,temp.operator=filter.operator,temp.value=filter.value,filterArray.push(temp)}}catch(err){_iterator.e(err)}finally{_iterator.f()}this.dataFilter=filterArray}},removeFilter:function(key){this.$delete(this.dataFilter,key),0===this.dataFilter.length&&this.addFilter()}},watch:{dataFilter:{handler:function(after){if(after&&after.length>0){var _step2,filterArray=[],_iterator2=(0,createForOfIteratorHelper/* default */.Z)(after);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var filter=_step2.value,temp={};if(filter.field&&"undefined"!==typeof filter.field){var fieldValue=filter.field.split("_");temp.fieldName=fieldValue[0],temp.fieldId=parseInt(fieldValue[1]),temp.aggregateOperator=filter.aggregateOperator,temp.operator=filter.operator,temp.value=filter.value,temp.fieldName&&temp.fieldId&&temp.aggregateOperator&&temp.operator&&temp.value&&"undefined"!==typeof temp.value&&filterArray.push(temp)}}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}this.$emit("setDataFilter",filterArray)}else this.$emit("setDataFilter",[])},deep:!0}}},report_AggregatedDataFiltervue_type_script_lang_js=AggregatedDataFiltervue_type_script_lang_js,AggregatedDataFilter_component=(0,componentNormalizer/* default */.Z)(report_AggregatedDataFiltervue_type_script_lang_js,AggregatedDataFiltervue_type_template_id_e4729d10_render,AggregatedDataFiltervue_type_template_id_e4729d10_staticRenderFns,!1,null,null,null)
/* harmony default export */,AggregatedDataFilter=AggregatedDataFilter_component.exports,vuex_esm=__webpack_require__(420629),validation=__webpack_require__(990260),isString=__webpack_require__(747037),isString_default=__webpack_require__.n(isString),api=__webpack_require__(32284),router=__webpack_require__(329435),picklist=__webpack_require__(961358),NewReportvue_type_script_lang_js={components:{CriteriaBuilder:dist/* CriteriaBuilder */.IP,FNewAnalyticModularReport:FNewAnalyticModularReport/* default */.Z,FReportOptions:FReportOptions/* default */.Z,FChartCustomization:FChartCustomization/* default */.Z,ModularUserFilters:ModularUserFilters,ModularUserFiltersList:ModularUserFilterList,LookUpFilter:LookupFilter,AggrDataFilter:AggregatedDataFilter,DrilldownConfig:DrilldownConfig},mixins:[NewDataFormatHelper/* default */.Z,modularUserFilter/* default */.Z],data:function(){return{loading:!1,dialogVisible:!1,toggleMetricAggregation:{},newReportFolderName:null,reportObject:null,resultObject:null,filterQuery:null,sortingOrder:[{label:"Ascending",value:2},{label:"Descending",value:3}],activeTab:"criteria",ranges:(0,toConsumableArray/* default */.Z)(Array(21).keys()).slice(1),reportName:"New Report",reportDescription:"description",showInnerPanel:!0,showChartCustomization:!1,hideSideBar:!1,savedReport:null,configFromReport:null,currentUserFilter:null,showCriteriaBuilder:!1,showUserFilter:!1,showDrilldownConfig:!1,showFilterConfigDialog:!1,showChart:!1,serverConfig:{},criteria:null,currentMetric:null,moduleswitch:null,moduleName:null,customModuleList:null,etisalatModuleList:[],subModulesList:[],parentModule:null,submodule:null,moduleDisplayName:null,moduleField:null,moduleList:[{displayName:"WorkOrders",name:"workorder",module:"workorder",license:"MAINTENANCE"},{displayName:"Asset",name:"asset",module:"asset",license:"SPACE_ASSET"},{displayName:"Items",name:"item",module:"item",license:"INVENTORY"},{displayName:"Tools",name:"tool",module:"item",license:"INVENTORY"},{displayName:"Item transactions",name:"itemTransactions",module:"item",license:"INVENTORY"},{displayName:"Tool transactions",name:"toolTransactions",module:"item",license:"INVENTORY"},{displayName:"Item types",name:"itemTypes",module:"item",license:"INVENTORY"},{displayName:"Tool types",name:"toolTypes",module:"item",license:"INVENTORY"},{displayName:"Storerooms",name:"storeRoom",module:"item",license:"INVENTORY"},{displayName:"Transfer Request",name:"transferrequest",module:"item",license:"TRANSFER_REQUEST"},{displayName:"Shipments",name:"shipment",module:"item",license:"INVENTORY"},{displayName:"Purchase contracts",name:"purchasecontracts",module:"contracts",license:"CONTRACT"},{displayName:"Labour contracts",name:"labourcontracts",module:"contracts",license:"CONTRACT"},{displayName:"Warranty contracts",name:"warrantycontracts",module:"contracts",license:"CONTRACT"},{displayName:"Rental lease contracts",name:"rentalleasecontracts",module:"contracts",license:"CONTRACT"},{displayName:"Visits",name:"visitorlog",module:"visitorlog",license:"VISITOR"},{displayName:"Visitors",name:"visitor",module:"visitorlog",license:"VISITOR"},{displayName:"Watchlist",name:"watchlist",module:"visitorlog",license:"VISITOR"},{displayName:"Tenants",name:"tenant",module:"tenant",license:"TENANTS"},{displayName:"Vendors",name:"vendors",module:"asset",license:"VENDOR"},{displayName:"Tenant Contacts",name:"tenantcontact",module:"tenant",license:"TENANTS"},{displayName:"Tenant Units",name:"tenantunit",module:"tenant",license:"TENANTS"},{displayName:"Quotes",name:"quote",module:"tenant",license:"QUOTATION"},{displayName:"Faults",name:"newreadingalarm",module:"alarm",license:"NEW_ALARMS"},{displayName:"Fault Occurrences",name:"readingalarmoccurrence",module:"alarm",license:"NEW_ALARMS"},{displayName:"BMS Alarms",name:"bmsalarm",module:"alarm",license:"NEW_ALARMS"},{displayName:"ML Alarms",name:"mlAnomalyAlarm",module:"alarm",license:"ANOMALY"},{displayName:"ML Alarm Occurrences",name:"anomalyalarmoccurrence",module:"alarm",license:"ANOMALY"},{displayName:"Violation Alarms",name:"violationalarm",module:"alarm",license:"NEW_ALARMS"},{displayName:"Violation Alarm Occurrences",name:"violationalarmoccurrence",module:"alarm",license:"NEW_ALARMS"},{displayName:"Out of Schedules",name:"operationalarm",module:"alarm",license:"OPERATIONAL_ALARM"},{displayName:"Out of Schedules Occurrences",name:"operationalarmoccurrence",module:"alarm",license:"OPERATIONAL_ALARM"},{displayName:"Sensor/Meter Faults",name:"sensorrollupalarm",module:"alarm",license:"NEW_ALARMS"},{displayName:"Sensor/Meter Fault Occurrences",name:"sensorrollupalarmoccurrence",module:"alarm",license:"NEW_ALARMS"},{displayName:"Base Alarms",name:"basealarm",module:"alarm",license:"NEW_ALARMS"},{displayName:"Base Alarm Occurrences",name:"alarmoccurrence",module:"alarm",license:"NEW_ALARMS"},{displayName:"Fault Events",name:"readingevent",module:"alarm",license:"NEW_ALARMS"},{displayName:"BMS Alarm Events",name:"bmsevent",module:"alarm",license:"NEW_ALARMS"},{displayName:"ML Alarm Events",name:"mlAnomalyEvent",module:"alarm",license:"ANOMALY"},{displayName:"Violation Alarm Events",name:"violationevent",module:"alarm",license:"NEW_ALARMS"},{displayName:"Out of Schedule Events",name:"operationevent",module:"alarm",license:"OPERATIONAL_ALARM"},{displayName:"Sensor/Meter Fault Events",name:"sensorevent",module:"alarm",license:"NEW_ALARMS"},{displayName:"Base Events",name:"baseevent",module:"alarm",license:"NEW_ALARMS"},{displayName:"Service Requests",name:"serviceRequest",module:"serviceRequest",license:"SERVICE_REQUEST"},{displayName:"Purchase Order",name:"purchaseorder",module:"purchaseorder",license:"PURCHASE"},{displayName:"Purchase Request",name:"purchaserequest",module:"purchaseorder",license:"PURCHASE"},{displayName:"Budget",name:"budget",module:"budget",license:"BUDGET_MONITORING"},{displayName:"Inspection Template",name:"inspectionTemplate",module:"inspectionTemplate",license:"INSPECTION"},{displayName:"Inspection",name:"inspectionResponse",module:"inspectionTemplate",license:"INSPECTION"},{displayName:"Planned Maintenance",name:"plannedmaintenance",module:"workorder",license:"PM_PLANNER"}],aggr:{YEARLY:8,MONTHLY:10,WEEKLY:11,DAILY:12,HOURLY:20,QUARTERLY:25,HIGHRES:0},moduleResourceField:null,metrics:[],metricAggregation:[{label:"AVG",value:2},{label:"SUM",value:3},{label:"MIN",value:4},{label:"MAX",value:5}],spaceAggregators:[{displayName:"Site",name:"site",value:21,field_Id:5,dataType:7,show:!0},{displayName:"Building",name:"building",value:22,field_Id:6,dataType:7,show:!0},{displayName:"Floor",name:"floor",value:23,field_Id:7,dataType:7,show:!0},{displayName:"Space",name:"space",value:26,field_Id:8,dataType:7,show:!0}],moduleTypes:[],moduleMap:null,parentlookupFileds:null,timeAggregators:[{displayName:"High-res",label:"highres",value:0,selected:!1,field_Id:0},{displayName:"Hourly",label:"hourly",value:20,selected:!1,field_Id:1},{displayName:"Daily",label:"daily",value:12,selected:!1,field_Id:2},{displayName:"Weekly",label:"weekly",value:11,selected:!1,field_Id:3},{displayName:"Monthly",label:"monthly",value:10,selected:!1,field_Id:4},{displayName:"Quarterly",label:"quarterly",value:25,selected:!1,field_Id:9}],showReportFolderList:!1,reportFolders:[],activePanel:1,activePanelEnum:{DIMENSION:1,METRIC:2,GROUPBY:3},groupBy:[],initialDimensionConfig:[],secondPanelToggle:!1,thirdPanelLoadingToggle:!1,timeFields:[],chartType:null,config:{moduleType:1,dimension:{dimension:null,subDimension:null},metric:[],metricAggregation:null,groupBy:{dimension:null,subDimension:null},range:null,sorting:null,customDateField:null,criteria:null,userFilters:null,having:null,baseLine:null,reportSettings:{clickAction:2,isShowListAtDrillEnd:!0},reportDrilldownPath:null},criteriaTrigger:!1,showLookUpFilter:!1,lookUpFilterConfig:{allValues:{},chooseValues:[]},baselinelist:[],baseLineCasecaderOptions:[],oldBaseLine:null}},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({getModuleList:function(){var _this=this;return(0,router/* isWebTabsEnabled */.tj)()&&this.$attrs.modules?this.$attrs.modules:this.isEtisalat?this.etisalatModuleList:this.iscustomModule?this.customModuleList:this.moduleList.filter((function(module){return module.module===_this.$route.meta.module&&(_this.$helpers.isLicenseEnabled(module.license)||"workorder"===module.license)}))},filteredDimensionConfig:function(){var _this2=this;if(!this.filterQuery||""===this.filterQuery)return this.initialDimensionConfig;var _step,config=[],_iterator=(0,createForOfIteratorHelper/* default */.Z)(this.initialDimensionConfig);try{for(_iterator.s();!(_step=_iterator.n()).done;){var record=_step.value,temp=Object.assign({},record);null!=temp.subFields&&(temp.subFields=temp.subFields.filter((function(field){return field.displayName.toLowerCase().indexOf(_this2.filterQuery.toLowerCase())>=0})),temp.subFields.length>0&&config.push(temp))}}catch(err){_iterator.e(err)}finally{_iterator.f()}return config},filteredGroupByConfig:function(){var _this3=this;if(!this.filterQuery||""===this.filterQuery)return this.groupBy;var _step2,config=[],_iterator2=(0,createForOfIteratorHelper/* default */.Z)(this.groupBy);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var record=_step2.value,temp=Object.assign({},record);null!=temp.subFields&&(temp.subFields=temp.subFields.filter((function(field){return field.displayName.toLowerCase().indexOf(_this3.filterQuery.toLowerCase())>=0})),temp.subFields.length>0&&config.push(temp))}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}return config},isMetricsEmpty:function(){var ActualMetrics=this.metrics.filter((function(metric){return!metric.defaultMetric}));return!(ActualMetrics.length>0)},isNewAlarmModule:function(){return!("alarm"!==this.$route.meta.module||!this.$helpers.isLicenseEnabled("NEW_ALARMS"))},isWebTabsEnabled:function(){return(0,router/* isWebTabsEnabled */.tj)()},computedModule:function(){var module={};return module["moduleName"]=this.moduleName,module["moduleDisplayName"]=this.moduleDisplayName,module["moduleId"]=this.moduleId,this.moduleResourceField&&(module["resourceField"]=this.moduleResourceField),module["meta"]={fieldMeta:{}},module},iscustomModule:function(){return!(!this.$route.meta.moduleType||"custom"!==this.$route.meta.moduleType)},isEtisalat:function(){return this.$helpers.isEtisalat()},cssLeft:function(){return this.showChartCustomization?"409px !important":"309px !important"},computedCriteriaDescription:function(){return this.isCriteriaEmpty()&&this.isDataFilterEmpty()?"All "+this.moduleDisplayName:"Criteria Applied"},computedReportName:{get:function(){return this.savedReport?this.savedReport.name:this.resultObject&&this.resultObject.report.name?this.resultObject.report.name:this.reportName},set:function(newValue){this.savedReport?this.savedReport.name=newValue:this.reportObject?(this.reportName=newValue,this.reportObject.name=newValue):this.reportName=newValue}},reportId:function(){return this.$route.query.reportId&&this.$route.query.module?(this.moduleName=this.$route.query.module,this.$route.query.reportId):null},showDatePicker:function(){return!!this.serverConfig&&!!this.serverConfig.isTime}},(0,vuex_esm/* mapGetters */.Se)(["getTicketStatusPickList"])),(0,vuex_esm/* mapState */.rn)({ticketstatus:function(state){return state.ticketStatus.workorder}})),created:function(){this.init()},methods:{init:function(){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var _yield$API$get,data,error,customModule;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(_this4.loading=!0,_this4.loadBaseline(),_this4.moduleName=_this4.$attrs.moduleName||_this4.$route.meta.module,_this4.$route.query&&_this4.$route.query.module&&(_this4.moduleName=_this4.$route.query.module),"workorder"===_this4.moduleName&&_this4.$store.dispatch("loadTicketStatus","workorder"),"alarm"===_this4.moduleName&&_this4.$helpers.isLicenseEnabled("NEW_ALARMS")&&(_this4.moduleName="newreadingalarm"),!_this4.isEtisalat){_context.next=11;break}_this4.etisalatModuleList=[],api/* API */.bl.get("v2/module/lists?defaultModules=true").then((function(_ref){var error=_ref.error,data=_ref.data;if(error){var message=error.message;_this4.$message.error(message)}else if(data.modules){if(data.modules.systemModules&&data.modules.systemModules.length){var filteredModules=data.modules.systemModules.filter((function(module){return["workorder","asset","vendors"].includes(module.name)}));_this4.etisalatModuleList=_this4.etisalatModuleList.concat(filteredModules)}if(data.modules.customModules&&data.modules.customModules.length&&(_this4.etisalatModuleList=_this4.etisalatModuleList.concat(data.modules.customModules)),_this4.etisalatModuleList)if(_this4.$route.query.module){var selectedModule=_this4.etisalatModuleList.find((function(module){return module.name===_this4.$route.query.module}));selectedModule?(_this4.moduleName=selectedModule.name,_this4.moduleId=selectedModule.moduleId):(_this4.moduleName=_this4.etisalatModuleList[0].name,_this4.moduleId=_this4.etisalatModuleList[0].moduleId)}else _this4.moduleName=_this4.etisalatModuleList[0].name,_this4.moduleId=_this4.etisalatModuleList[0].moduleId;_this4.moduleswitch="".concat(_this4.moduleName),_this4.$http("/module/meta?moduleName="+_this4.moduleName).then((function(response){_this4.moduleId=response.data.meta.module.moduleId,api/* API */.bl.get("/v3/report/fields",{moduleName:_this4.moduleName},{force:!0}).then((function(response){response.error?_this4.$message.error("Error while getting fields"):_this4.prepareData(response.data.meta),_this4.loading=!1}))}))}})),_context.next=23;break;case 11:if(!("custom"===_this4.moduleName||_this4.$route.meta&&"custom"===_this4.$route.meta.moduleType)){_context.next=20;break}return _context.next=14,api/* API */.bl.get("/v3/report/modules/list",{});case 14:_yield$API$get=_context.sent,data=_yield$API$get.data,error=_yield$API$get.error,error||(_this4.customModuleList=data.customModules,(0,validation/* isEmpty */.xb)(_this4.customModuleList)||(_this4.$route.query.module?(customModule=_this4.customModuleList.find((function(module){return module.name===_this4.$route.query.module})),customModule?(_this4.moduleName=customModule.name,_this4.moduleId=customModule.moduleId):(_this4.moduleName=_this4.customModuleList[0].name,_this4.moduleId=_this4.customModuleList[0].moduleId)):(_this4.moduleName=_this4.customModuleList[0].name,_this4.moduleId=_this4.customModuleList[0].moduleId),_this4.moduleswitch="".concat(_this4.moduleName),api/* API */.bl.get("/v3/report/fields",{moduleName:_this4.moduleName},{force:!0}).then((function(response){response.error?_this4.$message.error("Error while getting fields"):_this4.prepareData(response.data.meta),_this4.loading=!1})))),_context.next=23;break;case 20:"contracts"===_this4.moduleName&&(_this4.moduleName="purchasecontracts"),_this4.moduleswitch="".concat(_this4.moduleName),_this4.$http("/module/meta?moduleName="+_this4.moduleName).then((function(response){_this4.moduleId=response.data.meta.module.moduleId,api/* API */.bl.get("/v3/report/fields",{moduleName:_this4.moduleName},{force:!0}).then((function(response){response.error?_this4.$message.error("Error while getting fields"):_this4.prepareData(response.data.meta),_this4.loading=!1}))}));case 23:"custom"!==_this4.moduleName&&api/* API */.bl.get("/v3/report/sub_modules/list",{moduleName:_this4.moduleName},{force:!0}).then((function(response){if(response.error)_this4.$message.error("Error while fetching SubModules");else if(response.data.modules&&response.data.modules.length>0){var mainModules=_this4.moduleList.map((function(module){return module.name}));_this4.subModulesList=response.data.modules.filter((function(module){return!mainModules.includes(module.name)}))}})),_this4.reportId&&(_this4.showChart=!0),_this4.$store.dispatch("loadTicketStatus","workorder");case 26:case"end":return _context.stop()}}),_callee)})))()},loadBaseline:function(){var _this5=this;api/* API */.bl.get("/baseline/all").then((function(_ref2){var error=_ref2.error,data=_ref2.data;if(error)_this5.$message.error(error.message||"Error Occured");else{_this5.baselinelist=data||[],_this5.baseLineCasecaderOptions=[],_this5.baseLineCasecaderOptions.push({label:"None",value:-1});var _step3,_iterator3=(0,createForOfIteratorHelper/* default */.Z)(_this5.baselinelist);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var b=_step3.value,children=null;"PREVIOUS_MONTH"===b.rangeTypeEnum||"ANY_MONTH"===b.rangeTypeEnum?children=[{label:"Same date",value:4},{label:"Same week",value:1}]:"PREVIOUS_YEAR"!==b.rangeTypeEnum&&"ANY_YEAR"!==b.rangeTypeEnum||(children=[{label:"Same date",value:3},{label:"Same week",value:1}]),"PREVIOUS"!==b.rangeTypeEnum&&_this5.baseLineCasecaderOptions.push({label:b.name,value:b.id,children:children})}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}}}))},onBaseLineChange:function(newBaseLine){this.oldBaseLine&&this.oldBaseLine[0]===newBaseLine[0]||(this.oldBaseLine=(0,toConsumableArray/* default */.Z)(newBaseLine),this.$set(this.config,"baseLine",newBaseLine),this.$set(this.serverConfig,"baseLine",newBaseLine))},heatmapToggle:function(){"heatmap"===this.chartType||this.reportObject&&this.reportObject.options&&"heatmap"===this.reportObject.options.type?this.chartType=null:this.chartType="heatmap"},getModuleName:function(module){switch(module){case"asset":return"Assets";case"item":return"Items";case"tool":return"Tools";case"itemtransactions":return"Item Transactions";case"tooltransactions":return"Tool Transactions";case"assetbreakdown":return"Asset Downtime"}},getSelectedModuleName:function(){return this.$helpers.isLicenseEnabled("NEW_ALARMS")&&"alarm"===this.moduleName?"newreadingalarm":this.moduleName},setmodule:function(moduleswitch,parentModule){var _this6=this;parentModule&&(""===moduleswitch?(moduleswitch=parentModule,this.parentModule=null):this.parentModule=parentModule),this.metrics=[],this.currentUserFilter=null,this.lookUpFilterConfig={allValues:{},chooseValues:[]},this.config={moduleType:1,dimension:{dimension:null,subDimension:null},metric:[],metricAggregation:null,groupBy:{dimension:null,subDimension:null},range:null,sorting:null,customDateField:null,criteria:null,userFilters:null,having:null,reportSettings:{clickAction:2,isShowListAtDrillEnd:!0},reportDrilldownPath:null},this.moduleName="".concat(moduleswitch),this.$http("/module/meta?moduleName="+this.moduleName).then((function(response){_this6.moduleId=response.data.meta.module.moduleId,api/* API */.bl.post("/v3/report/fields",{moduleName:_this6.moduleName},{force:!0}).then((function(response){response.error,_this6.prepareData(response.data.meta)})),_this6.showChart=!1,_this6.serverConfig={},_this6.moduleResourceField=null})),parentModule||api/* API */.bl.get("/v3/report/sub_modules/list",{moduleName:this.moduleName},{force:!0}).then((function(response){if(response.error)_this6.$message.error("Error while fetching SubModules");else if(response.data.modules&&response.data.modules.length>0){var mainModules=_this6.moduleList.map((function(module){return module.name}));_this6.subModulesList=response.data.modules.filter((function(module){return!mainModules.includes(module.name)}))}})),this.reportId&&(this.showChart=!0)},setConfigForUserFilter:function(changedConfig){this.showFilterConfigDialog=!1;var _step4,temp=[],_iterator4=(0,createForOfIteratorHelper/* default */.Z)(this.config.userFilters);try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var config=_step4.value;config.fieldId===changedConfig.fieldId?temp.push(changedConfig):temp.push(config)}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}this.$set(this.config,"userFilters",temp),this.$set(this.serverConfig,"userFilters",temp)},drilldownConfigSaved:function(){this.$set(this.serverConfig,"reportSettings",this.config.reportSettings),this.$set(this.serverConfig,"reportDrilldownPath",this.config.reportDrilldownPath),this.showDrilldownConfig=!1},openFilterConfig:function(filterConfig){this.currentUserFilter=filterConfig,this.showFilterConfigDialog=!0},metricSelected:function(metric){var _step5,_iterator5=(0,createForOfIteratorHelper/* default */.Z)(this.config.metric);try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var m=_step5.value;if(metric.fieldId===m.fieldId&&metric.name===m.name)return!0}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}return!1},showMetricAggregation:function(metric){return!metric.defaultMetric||(this.toggleMetricAggregation[metric.fieldId+"__"+metric.name]=!1,!1)},addMetric:function(){this.currentMetric=null,this.activePanel=this.activePanelEnum.METRIC,this.secondPanelToggle=!0},resetUserFilters:function(){this.config.userFilters=null,this.currentUserFilter=null,this.$set(this.serverConfig,"userFilters",null)},setUserFilter:function(val){this.config.userFilters=val,this.showUserFilter=!1,val&&0==val.length&&(this.currentUserFilter=null),this.$set(this.serverConfig,"userFilters",val)},setModuleType:function(val){this.config.moduleType=val,this.serverConfig.moduleType?this.serverConfig.moduleType=val:this.$set(this.serverConfig,"moduleType",val)},isCriteriaEmpty:function(){if(this.config.criteria){for(var numberOfConditions=0,_i=0,_Object$keys=Object.keys(this.config.criteria.conditions);_i<_Object$keys.length;_i++){var condition=_Object$keys[_i];0!==Object.keys(this.config.criteria.conditions[parseInt(condition)]).length&&"undefined"!==typeof this.config.criteria.conditions[parseInt(condition)].fieldName&&(numberOfConditions+=1)}return!(numberOfConditions>0)}return null===this.config.criteria},isDataFilterEmpty:function(){if(null===this.config.having)return!0;if(this.config.having.length>0){var _step6,numberOfConditions=0,_iterator6=(0,createForOfIteratorHelper/* default */.Z)(this.config.having);try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var condition=_step6.value;"undefined"===typeof condition.fieldName&&"undefined"===typeof condition.fieldId||(numberOfConditions+=1)}}catch(err){_iterator6.e(err)}finally{_iterator6.f()}return!(numberOfConditions>0)}return!0},resetGroupBy:function(){var _step7,_iterator7=(0,createForOfIteratorHelper/* default */.Z)(this.groupBy);try{for(_iterator7.s();!(_step7=_iterator7.n()).done;){var _step8,group=_step7.value,_iterator8=(0,createForOfIteratorHelper/* default */.Z)(group.subFields);try{for(_iterator8.s();!(_step8=_iterator8.n()).done;){var subField=_step8.value;subField.show=!0}}catch(err){_iterator8.e(err)}finally{_iterator8.f()}}}catch(err){_iterator7.e(err)}finally{_iterator7.f()}},setCustomDateField:function(customDateFieldId){var dateFieldSplit=customDateFieldId.split(/_(.+)/);this.config.customDateField=dateFieldSplit.length&&0===parseInt(dateFieldSplit[0])?null:customDateFieldId,this.updateReportObject();var oldValue=this.serverConfig;if(0===parseInt(dateFieldSplit[0]))oldValue["isCustomDateField"]=!1,oldValue.baseLine&&(oldValue.baseLine=null);else{var customDateField=this.timeFields.filter((function(field){return field.fieldId&&field.fieldId===parseInt(dateFieldSplit[0])&&field.name&&field.name===dateFieldSplit[1]}));if(this.computedModule["meta"]["fieldMeta"]["customDateField"]=customDateField.length>0?customDateField[0].moduleId:null,oldValue["isCustomDateField"]=!0,null===this.serverConfig.dateField||"undefined"===typeof this.serverConfig.dateField){var dateObject=NewDateHelper/* default */.Z.getDatePickerObject(22);oldValue["dateFilter"]=dateObject;var dateField={};dateField["operator"]=dateObject.operatorId,dateField["field_id"]=parseInt(dateFieldSplit[0]),dateField["fieldName"]=dateFieldSplit[1],dateField["module_id"]=this.moduleId,dateField["date_value"]=dateObject&&dateObject.value?dateObject.value.join(","):"",oldValue["dateField"]=dateField,this.serverConfig=oldValue}else{var _dateField=this.serverConfig.dateField;_dateField.field_id=parseInt(dateFieldSplit[0]),_dateField["fieldName"]=dateFieldSplit[1],_dateField["module_id"]=this.moduleId,this.$set(this.serverConfig,"dateField",_dateField)}}},filtergroupBy:function(){var _step9,_iterator9=(0,createForOfIteratorHelper/* default */.Z)(this.groupBy);try{for(_iterator9.s();!(_step9=_iterator9.n()).done;){var dimension=_step9.value;if(dimension.displayName===this.config.dimension.dimension.displayName){var _step10,_iterator10=(0,createForOfIteratorHelper/* default */.Z)(dimension.subFields);try{for(_iterator10.s();!(_step10=_iterator10.n()).done;){var field=_step10.value;field.hasOwnProperty("fieldId")?-1===field.fieldId?field.displayName===this.config.dimension.subDimension.displayName?field.show=!1:field.show=!0:field.fieldId===this.config.dimension.subDimension.fieldId?field.show=!1:field.show=!0:(field.hasOwnProperty("value")&&(field.value,this.config.dimension.subDimension.value),field.show=!0)}}catch(err){_iterator10.e(err)}finally{_iterator10.f()}}else{var _step11,_iterator11=(0,createForOfIteratorHelper/* default */.Z)(dimension.subFields);try{for(_iterator11.s();!(_step11=_iterator11.n()).done;){var _field=_step11.value;_field.show=!0}}catch(err){_iterator11.e(err)}finally{_iterator11.f()}}}}catch(err){_iterator9.e(err)}finally{_iterator9.f()}},resetCriteria:function(){this.config.criteria={conditions:{1:{columnName:void 0,fieldName:void 0,operatorId:void 0,value:void 0}},pattern:"(1)",resourceOperator:!1},this.config.having=[{fieldId:void 0,fieldName:void 0,aggregateOperator:void 0,operatorId:void 0,value:void 0}],this.criteriaTrigger=!1,this.updateReportObject(),this.$set(this.serverConfig,"criteria",null),this.$set(this.serverConfig,"having",null)},getAllDefaults:function(data){
// Load all metrics
var defaultMetric={};defaultMetric["displayName"]="Number of "+this.moduleDisplayName,defaultMetric["defaultMetric"]=!0,defaultMetric["fieldId"]=-1,defaultMetric["name"]="default",this.moduleMap=data.moduleMap,this.parentlookupFileds=data.parentlookupFileds?data.parentlookupFileds:{},this.metrics.push(defaultMetric);var _step12,_iterator12=(0,createForOfIteratorHelper/* default */.Z)(data.metrics);try{for(_iterator12.s();!(_step12=_iterator12.n()).done;){var metric=_step12.value;this.metrics.push(metric),this.toggleMetricAggregation[metric.fieldId+"__"+metric.name]=!1}
// Laod all dimensions
}catch(err){_iterator12.e(err)}finally{_iterator12.f()}var _step13,_this$timeFields,_iterator13=(0,createForOfIteratorHelper/* default */.Z)(data.dimensionListOrder);try{for(_iterator13.s();!(_step13=_iterator13.n()).done;){var dimension=_step13.value;if("resource_fields"!==dimension){var dimensionData=data.dimension[dimension];if(dimensionData){var _step17,baseconfig={displayName:this.getStringWithCaps(dimension),subFields:[],showSubFields:!0},_iterator17=(0,createForOfIteratorHelper/* default */.Z)(dimensionData);try{for(_iterator17.s();!(_step17=_iterator17.n()).done;){var _field2=_step17.value;_field2["selected"]=!0,baseconfig.subFields.push(_field2)}}catch(err){_iterator17.e(err)}finally{_iterator17.f()}
// load all Group BY fields
if(this.initialDimensionConfig.push(baseconfig),"time"!==dimension.toLowerCase()){var _step18,fields=[],_iterator18=(0,createForOfIteratorHelper/* default */.Z)(baseconfig.subFields);try{for(_iterator18.s();!(_step18=_iterator18.n()).done;){var field=_step18.value;5!==field.dataType&&6!==field.dataType&&fields.push(field)}}catch(err){_iterator18.e(err)}finally{_iterator18.f()}var groupBaseField=this.$helpers.cloneObject(baseconfig);groupBaseField.subFields=fields,this.groupBy.push(groupBaseField)}}}}
// Load space in dimension
}catch(err){_iterator13.e(err)}finally{_iterator13.f()}if(data.dimension.resource_fields){this.moduleResourceField=data.dimension["resource_fields"][0];var spaceConfig={displayName:"Space",subFields:this.spaceAggregators,showSubFields:!0};if(data.dimension.space){var _step14,_iterator14=(0,createForOfIteratorHelper/* default */.Z)(data.dimension.space);try{for(_iterator14.s();!(_step14=_iterator14.n()).done;){var spaceField=_step14.value;spaceField["show"]=!0,spaceConfig.subFields.push(spaceField)}}catch(err){_iterator14.e(err)}finally{_iterator14.f()}}this.initialDimensionConfig.push(spaceConfig),this.groupBy.push(spaceConfig)}else if(data.dimension.siteId){var _spaceConfig={displayName:"Space",subFields:[this.spaceAggregators[0]],showSubFields:!0};if(data.dimension.space){var _step15,_iterator15=(0,createForOfIteratorHelper/* default */.Z)(data.dimension.space);try{for(_iterator15.s();!(_step15=_iterator15.n()).done;){var _spaceField=_step15.value;_spaceField["show"]=!0,_spaceConfig.subFields.push(_spaceField)}}catch(err){_iterator15.e(err)}finally{_iterator15.f()}}this.initialDimensionConfig.push(_spaceConfig),this.groupBy.push(_spaceConfig)}(this.timeFields=[],this.timeFields.push({name:"none",displayName:"None",id:0}),(0,validation/* isEmpty */.xb)(this.initialDimensionConfig.filter((function(config){return"Time"===config.displayName}))))||(_this$timeFields=this.timeFields).push.apply(_this$timeFields,(0,toConsumableArray/* default */.Z)(this.initialDimensionConfig.filter((function(config){return"Time"===config.displayName}))[0].subFields));
// Load ModuleTypes
if(data.moduleType&&0!==data.moduleType.length){var _step16,_iterator16=(0,createForOfIteratorHelper/* default */.Z)(data.moduleType);try{for(_iterator16.s();!(_step16=_iterator16.n()).done;){var type=_step16.value,temp={};temp["displayName"]=type.displayName,temp["id"]=type.type,temp["selected"]=0===this.moduleTypes.length,temp["field_id"]=type.type,this.moduleTypes.push(temp)}}catch(err){_iterator16.e(err)}finally{_iterator16.f()}}},prepareData:function(data){
// metrics
if(this.initialDimensionConfig=[],this.groupBy=[],data.displayName?this.moduleDisplayName=data.displayName:this.moduleDisplayName=this.moduleName,"workorder"!==this.moduleName)this.getAllDefaults(data);else{this.moduleMap=data.moduleMap,this.parentlookupFileds=data.parentlookupFileds?data.parentlookupFileds:{},this.timeFields=[],this.timeFields.push({name:"none",displayName:"None",id:0});var _step19,_iterator19=(0,createForOfIteratorHelper/* default */.Z)(data.dimension.time);try{for(_iterator19.s();!(_step19=_iterator19.n()).done;){var dimension=_step19.value;"sysModifiedTime"!==dimension.name&&"sysCreatedTime"!==dimension.name&&this.timeFields.push(dimension)}}catch(err){_iterator19.e(err)}finally{_iterator19.f()}var _step20,_iterator20=(0,createForOfIteratorHelper/* default */.Z)(data.metrics);try{for(_iterator20.s();!(_step20=_iterator20.n()).done;){var metric=_step20.value;"actualWorkDuration"===metric.name&&(metric.displayName="Work Duration"),this.metrics.push(metric)}}catch(err){_iterator20.e(err)}finally{_iterator20.f()}var defaultMetric={};defaultMetric["displayName"]="Number of "+this.moduleDisplayName,defaultMetric["defaultMetric"]=!0,defaultMetric["fieldId"]=-1,defaultMetric["name"]="default",this.metrics.push(defaultMetric);var _step21,_iterator21=(0,createForOfIteratorHelper/* default */.Z)(data.dimensionListOrder);try{for(_iterator21.s();!(_step21=_iterator21.n()).done;){var _dimension=_step21.value;if("resource_fields"!==_dimension.toLowerCase()){var _step24,dimensionData=data.dimension[_dimension],baseconfig={displayName:this.getStringWithCaps(_dimension),subFields:[],showSubFields:!0},_iterator24=(0,createForOfIteratorHelper/* default */.Z)(dimensionData);try{for(_iterator24.s();!(_step24=_iterator24.n()).done;){var _field3=_step24.value;"actualworkstart"===_field3.name.toLowerCase()&&(_field3.displayName="Start Time"),_field3["selected"]=!0,baseconfig.subFields.push(_field3)}}catch(err){_iterator24.e(err)}finally{_iterator24.f()}if(this.initialDimensionConfig.push(baseconfig),"time"!==_dimension){var _step25,fields=[],_iterator25=(0,createForOfIteratorHelper/* default */.Z)(baseconfig.subFields);try{for(_iterator25.s();!(_step25=_iterator25.n()).done;){var field=_step25.value;5!==field.dataType&&6!==field.dataType&&fields.push(field)}}catch(err){_iterator25.e(err)}finally{_iterator25.f()}var groupBaseField=this.$helpers.cloneObject(baseconfig);groupBaseField.subFields=fields,this.groupBy.push(groupBaseField)}}}
// load space in initial Dimension config and group by
}catch(err){_iterator21.e(err)}finally{_iterator21.f()}this.moduleResourceField=data.dimension["resource_fields"][0];var spaceConfig={displayName:"Space",subFields:this.spaceAggregators,showSubFields:!0};if(data.dimension.space){var _step22,_iterator22=(0,createForOfIteratorHelper/* default */.Z)(data.dimension.space);try{for(_iterator22.s();!(_step22=_iterator22.n()).done;){var spaceField=_step22.value;spaceField["show"]=!0,spaceConfig.subFields.push(spaceField)}}catch(err){_iterator22.e(err)}finally{_iterator22.f()}}
// // Load ModuleTypes
if(this.initialDimensionConfig.push(spaceConfig),this.groupBy.push(spaceConfig),data.moduleType&&0!==data.moduleType.length){var _step23,_iterator23=(0,createForOfIteratorHelper/* default */.Z)(data.moduleType);try{for(_iterator23.s();!(_step23=_iterator23.n()).done;){var type=_step23.value,temp={};temp["displayName"]=type.displayName,temp["id"]=type.type,temp["selected"]=0===this.moduleTypes.length,temp["field_id"]=type.type,this.moduleTypes.push(temp)}}catch(err){_iterator23.e(err)}finally{_iterator23.f()}}}this.addGroupRequirements()},updateReportObject:function(){this.reportObject&&(this.reportObject.options.initialConfig=this.config)},addGroupRequirements:function(){var _step26,_iterator26=(0,createForOfIteratorHelper/* default */.Z)(this.groupBy);try{for(_iterator26.s();!(_step26=_iterator26.n()).done;){var _step27,groupBy=_step26.value,_iterator27=(0,createForOfIteratorHelper/* default */.Z)(groupBy.subFields);try{for(_iterator27.s();!(_step27=_iterator27.n()).done;){var field=_step27.value;field["show"]=!0}}catch(err){_iterator27.e(err)}finally{_iterator27.f()}}}catch(err){_iterator26.e(err)}finally{_iterator26.f()}},removeGroupBy:function(){this.config.groupBy.subDimension=null,this.config.groupBy.dimension=null,this.updateReportObject(),this.build(this.config,this.moduleResourceField)},removeMetric:function(metricIdx){
// only for one Metric
var metric=this.config.metric[metricIdx];delete this.config.metricAggregation[metric.fieldId+"__"+metric.name],this.config.metric.splice(metricIdx,1),this.config.sorting=null,this.config.range=null,this.build(this.config,this.moduleResourceField)},handleSort:function(sortVal){this.config.sorting=sortVal,this.$set(this.serverConfig,"sortOrder",sortVal)},handleRange:function(rangeVal){this.config.range=rangeVal,this.$set(this.serverConfig,"limit",rangeVal)},setMetricAggregation:function(metricAggr,metricIdx){var metric=this.config.metric[metricIdx];this.toggleMetricAggregation[metric.fieldId+"__"+metric.name]=!1,this.config.metricAggregation[metric.fieldId+"__"+metric.name]=metricAggr,this.updateReportObject(),this.serverConfig.yField&&(this.serverConfig.yField[metricIdx].aggr=metricAggr)},showReportFolders:function(){var _this7=this,url="/v3/report/folders?moduleName=asset";["workorder","alarm","alarmoccurence"].includes(this.moduleName)?url="/v3/report/folders?moduleName="+this.moduleName:"visitor"===this.$route.meta.module&&(url="/v3/report/folders?moduleName=visitor"),api/* API */.bl.get(url).then((function(response){response.error||(_this7.reportFolders=response.data.reportFolders,_this7.showReportFolderList=!0)})).catch((function(error){_this7.showReportFolderList=!1,_this7.reportFolders=[]}))},closeActivePanel:function(){this.secondPanelToggle&&(this.secondPanelToggle=!1)},showActiveArrow:function(name){var _this8=this;this.$nextTick((function(){return!!_this8.config.dimension.dimension&&name===_this8.config.dimension.dimension.displayName}))},showSecondPanel:function(activator){this.activePanel=activator,activator===this.activePanelEnum.DIMENSION||this.activePanelEnum.METRIC,this.secondPanelToggle=!0},cancel:function(){this.openPanel=!1,this.$emit("update:openPanel",this.openPanel)},setDimension:function(dimension,child){this.activePanel===this.activePanelEnum.DIMENSION?("Time"===dimension.displayName&&this.resetGroupBy(),this.config.dimension.dimension=dimension,this.config.dimension.subDimension=child,this.filtergroupBy(),this.build(this.config,this.moduleResourceField)):this.activePanel===this.activePanelEnum.METRIC?null!==this.currentMetric?(this.config.metric[this.currentMetric]=dimension,this.build(this.config,this.moduleResourceField)):null==this.currentMetric&&(this.config.metric.push(dimension),this.build(this.config,this.moduleResourceField)):(this.config.groupBy.dimension=dimension,this.config.groupBy.subDimension=child,this.build(this.config,this.moduleResourceField)),this.filterQuery=null,this.updateReportObject()},toggleSideBar:function(){this.hideSideBar?(this.hideSideBar=!1,this.$refs["analyticReport"]&&this.$refs["analyticReport"].resize()):(this.hideSideBar=!0,this.$refs["analyticReport"]&&this.$refs["analyticReport"].resize())},populateReportObjects:function(report,result){if(this.reportObject=report,this.resultObject=result,null===this.reportObject||this.reportObject.name||(this.reportObject["name"]=this.reportName),this.reportId&&null===this.savedReport&&(this.savedReport=result.report),null!==this.config.dimension.dimension&&null!==this.reportObject&&(this.reportObject.options["initialConfig"]=this.config),this.$route.query.duplicate&&this.$route.query.reportId&&null!==this.reportObject&&(this.reportObject["name"]=this.computedReportName,this.reportObject["description"]=this.computedReportDescription),this.reportId&&null===this.config.dimension.dimension){var config=this.reconstructConfig(result);config.userFilters?this.loadAllValues(config):(this.config=config,this.build(this.config,this.moduleResourceField)),this.reconstructLookUpFilterConfig(result)}},setCriteria:function(criteria){this.config.criteria=criteria,this.updateReportObject()},setDataFilter:function(dataFilter){this.config.having=dataFilter,this.updateReportObject()},reconstructConfig:function(result){var config=null;if(result.report.chartState){if("object"===(0,esm_typeof/* default */.Z)(result.report.chartState))config=result.report.chartState.initialConfig;else{var chartState=JSON.parse(result.report.chartState);config=chartState.initialConfig}
//initialize reportSettings(drilldown settings)
result.report.reportSettings&&(
//new report has no reportsettings in resp
config.reportSettings=result.report.reportSettings),config.reportDrilldownPath=result.report.reportDrilldownPath}
// Done for backward compatibility for existing new reports (metric structure and user Filters)
if(!Array.isArray(config.metric)){var temp=config.metric;if(config.metric.defaultMetric?(temp["fieldId"]=-1,temp["name"]="default",config.metric=[],config.metric.push(temp)):config.metric.push(temp),config.metricAggregation){var aggr=config.metricAggregation;config.metricAggregation={},config.metricAggregation[temp.fieldId+"__"+temp.name]=aggr}config.hasOwnProperty("userFilters")||(config["userFilters"]=null)}return config.hasOwnProperty("having")||(config["having"]=null),config},getDimensionModuleId:function(config){return this.moduleMap&&Object.keys(this.moduleMap).includes(config.dimension.dimension.displayName.toLowerCase())?this.moduleMap[config.dimension.dimension.displayName.toLowerCase()]:this.moduleId},getGroupByModuleId:function(config){return this.moduleMap&&Object.keys(this.moduleMap).includes(config.groupBy.dimension.displayName.toLowerCase())?this.moduleMap[config.groupBy.dimension.displayName.toLowerCase()]:this.moduleId},getDimensionLookupFieldId:function(config){return this.parentlookupFileds&&Object.keys(this.parentlookupFileds).includes(config.dimension.dimension.displayName.toLowerCase())?this.parentlookupFileds[config.dimension.dimension.displayName.toLowerCase()].fieldId:null},getGroupByLookupFieldId:function(config){return this.parentlookupFileds&&Object.keys(this.parentlookupFileds).includes(config.groupBy.dimension.displayName.toLowerCase())?this.parentlookupFileds[config.groupBy.dimension.displayName.toLowerCase()].fieldId:null},buildDimensionObjectForServer:function(config,moduleResourceField){var serverConfig={},xField={};if(config.moduleType&&0!==this.moduleTypes.length?serverConfig["moduleType"]=config.moduleType:0!==this.moduleTypes.length&&(
// backward compatability for reports without module type
config.moduleType=1,this.config["moduleType"]=1,serverConfig["moduleType"]=1),"Time"===config.dimension.dimension.displayName)-1===config.dimension.subDimension.fieldId?(xField["field_id"]=config.dimension.subDimension.name,xField["nullFieldId"]=!0):(xField["field_id"]=config.dimension.subDimension.fieldId,xField["nullFieldId"]=!1),xField["aggr"]=this.resultObject&&this.resultObject.report.xAggr&&(5===this.resultObject.report.dataPoints[0].xAxis.dataType||6===this.resultObject.report.dataPoints[0].xAxis.dataType)?this.resultObject.report.xAggr:12,xField["module_id"]=this.moduleId,this.computedModule["meta"]["fieldMeta"]["xField"]=xField.module_id,serverConfig["xField"]=xField,serverConfig["isTime"]=!0;else if("Space"===config.dimension.dimension.displayName)"Site"!==config.dimension.subDimension.displayName||moduleResourceField?config.dimension.subDimension.fieldId&&-1!==config.dimension.subDimension.fieldId?(xField["field_id"]=config.dimension.subDimension.fieldId,xField["module_id"]=this.moduleMap["space"]):(xField["field_id"]=moduleResourceField.fieldId,xField["aggr"]=config.dimension.subDimension.value,xField["module_id"]=this.moduleId):(xField["field_id"]="siteId",xField["module_id"]=this.moduleId),this.computedModule["meta"]["fieldMeta"]["xField"]=xField.module_id,serverConfig["xField"]=xField,serverConfig["isTime"]=!1;else{
// covered for asset and the module itself
-1===config.dimension.subDimension.fieldId?xField["field_id"]=config.dimension.subDimension.name:xField["field_id"]=config.dimension.subDimension.fieldId,xField["module_id"]=this.getDimensionModuleId(config);var dimensionLookupFieldId=this.getDimensionLookupFieldId(config);dimensionLookupFieldId&&(xField["lookupFieldId"]=dimensionLookupFieldId),xField["selectedIds"]=this.getLookUpFilterIds(config),this.computedModule["meta"]["fieldMeta"]["xField"]=xField.module_id,5===config.dimension.subDimension.dataType||6===config.dimension.subDimension.dataType&&config.dimension.subDimension.moduleId!==this.moduleId?(serverConfig["isTime"]=!0,xField["aggr"]=this.resultObject&&this.resultObject.report.xAggr&&(5===this.resultObject.report.dataPoints[0].xAxis.dataType||6===this.resultObject.report.dataPoints[0].xAxis.dataType)?this.resultObject.report.xAggr:12):serverConfig["isTime"]=!1,serverConfig["xField"]=xField}if(0!==config.metric.length){serverConfig["yField"]=[];var _step28,_iterator28=(0,createForOfIteratorHelper/* default */.Z)(config.metric);try{for(_iterator28.s();!(_step28=_iterator28.n()).done;){var metric=_step28.value;if(metric.defaultMetric)serverConfig["yField"].push(null);else{var yField={};-1===metric.fieldId?(yField["field_id"]=metric.name,yField["module_id"]=this.moduleId,this.computedModule["meta"]["fieldMeta"]["yField"]=yField.module_id):(yField["field_id"]=metric.fieldId,yField["module_id"]=this.moduleId,this.computedModule["meta"]["fieldMeta"]["yField"]=yField.module_id),null===config.metricAggregation&&metric.fieldId?(this.config.metricAggregation={},this.config.metricAggregation[metric.fieldId+"__"+metric.name]=this.metricAggregation[1].value,yField["aggr"]=this.config.metricAggregation[metric.fieldId+"__"+metric.name]):yField["aggr"]=config.metricAggregation[metric.fieldId+"__"+metric.name],"undefined"===typeof yField["aggr"]&&(this.config.metricAggregation[metric.fieldId+"__"+metric.name]=this.metricAggregation[1].value,yField["aggr"]=this.config.metricAggregation[metric.fieldId+"__"+metric.name]),serverConfig["yField"].push(yField)}}}catch(err){_iterator28.e(err)}finally{_iterator28.f()}}else serverConfig["yField"]=null;if(config.groupBy.dimension&&config.groupBy.subDimension){var groupBy={};if("Time"===config.groupBy.dimension.displayName)-1===config.groupBy.subDimension.fieldId?(groupBy["field_id"]=config.groupBy.subDimension.name,groupBy["module_id"]=this.moduleId,this.computedModule["meta"]["fieldMeta"]["groupBy"]=groupBy.module_id):(groupBy["field_id"]=config.groupBy.subDimension.fieldId,groupBy["module_id"]=this.moduleId,this.computedModule["meta"]["fieldMeta"]["groupBy"]=groupBy.module_id),groupBy["aggr"]=this.serverConfig.groupBy&&this.serverConfig.groupBy.aggr?this.serverConfig.groupBy.aggr:12,serverConfig["groupBy"]=[groupBy];else if("Space"===config.groupBy.dimension.displayName)"Site"===config.groupBy.subDimension.displayName?(groupBy["field_id"]="siteId",groupBy["module_id"]=this.moduleId):config.groupBy.subDimension.fieldId&&-1!==config.groupBy.subDimension.fieldId?(groupBy["field_id"]=config.groupBy.subDimension.fieldId,groupBy["module_id"]=this.moduleMap["space"]):(groupBy["field_id"]=moduleResourceField.fieldId,groupBy["aggr"]=config.groupBy.subDimension.value,groupBy["module_id"]=this.moduleId),this.computedModule["meta"]["fieldMeta"]["groupBy"]=groupBy.module_id,serverConfig["groupBy"]=[groupBy];else{
// covered for asset and the module itself
-1===config.groupBy.subDimension.fieldId?groupBy["field_id"]=config.groupBy.subDimension.name:groupBy["field_id"]=config.groupBy.subDimension.fieldId,groupBy["module_id"]=this.getGroupByModuleId(config);var groupByLookupFieldId=this.getGroupByLookupFieldId(config);groupByLookupFieldId&&(groupBy["lookupFieldId"]=groupByLookupFieldId),this.computedModule["meta"]["fieldMeta"]["groupBy"]=groupBy.module_id,serverConfig["groupBy"]=[groupBy]}}else serverConfig["groupBy"]=null;
// apply criteria
// sorting
if(this.isCriteriaEmpty()?serverConfig["criteria"]=null:serverConfig["criteria"]=this.config.criteria,
// apply criteria
this.isDataFilterEmpty()?serverConfig["having"]=null:serverConfig["having"]=this.config.having,"Time"!==config.dimension.dimension.displayName&&null===config.groupBy.dimension){var sortFields=[],sortOrder=0;if(serverConfig["yField"]&&serverConfig["yField"].length>1&&null!==serverConfig["yField"][0]){var firstYField=serverConfig["yField"][0];sortFields.push(firstYField)}else sortFields.push({field_id:"y-field"});this.config.sorting||(this.config.sorting=3),sortOrder=this.config.sorting,serverConfig["sortOrder"]=sortOrder,serverConfig["sortFields"]=sortFields,config.range?serverConfig["limit"]=config.range:(this.config.range=15,serverConfig["limit"]=this.config.range)}else serverConfig["sortFields"]=null,serverConfig["sortOrder"]=null,serverConfig["limit"]=null;return config.customDateField&&"Time"!==config.dimension.dimension.displayName?serverConfig["isCustomDateField"]=!0:serverConfig["isCustomDateField"]=!1,this.config.userFilters&&(serverConfig["userFilters"]=this.config.userFilters),this.config.reportSettings&&(serverConfig["reportSettings"]=this.config.reportSettings),this.config.reportDrilldownPath&&(serverConfig["reportDrilldownPath"]=this.config.reportDrilldownPath),
// baseline
(this.config.customDateField||"Time"===this.config.dimension.dimension.displayName)&&this.config.baseLine&&(serverConfig["baseLine"]=this.config.baseLine),serverConfig},build:function(config,moduleResourceField){
// handle for fsave as report
this.secondPanelToggle=!1,this.configFromReport=null;var element=this.buildDimensionObjectForServer(config,moduleResourceField);if(element["mode"]=4,element["hideChart"]=!1,element.xField.aggr&&"Time"===config.dimension.dimension.displayName&&this.activePanel===this.activePanelEnum.DIMENSION&&!this.serverConfig.dateField){if(this.savedReport)element["dateFilter"]=NewDateHelper/* default */.Z.getDatePickerObject(this.savedReport.dateOperator,[this.savedReport.dateRange.startTime,this.savedReport.dateRange.endTime]);else switch(element.xField.aggr){case this.aggr.YEARLY:element["dateFilter"]=NewDateHelper/* default */.Z.getDatePickerObject(44);break;case this.aggr.MONTHLY:case this.aggr.QUARTERLY:element["dateFilter"]=NewDateHelper/* default */.Z.getDatePickerObject(44);break;case this.aggr.WEEKLY:element["dateFilter"]=NewDateHelper/* default */.Z.getDatePickerObject(28);break;case this.aggr.DAILY:element["dateFilter"]=NewDateHelper/* default */.Z.getDatePickerObject(31);break;case this.aggr.HOURLY:element["dateFilter"]=NewDateHelper/* default */.Z.getDatePickerObject(22);break}var dateField={};dateField["operator"]=element.dateFilter.operatorId,dateField["field_id"]=this.config.dimension.subDimension.fieldId,dateField["fieldName"]=this.config.dimension.subDimension.name,dateField["module_id"]=this.moduleId,49===element.dateFilter.operatorId||50===element.dateFilter.operatorId||51===element.dateFilter.operatorId?dateField["date_value"]=Math.abs(element.dateFilter.offset)+"":20===element.dateFilter.operatorId?dateField["date_value"]=element.dateFilter.value.join(","):dateField["date_value"]=element.dateFilter.value[0]+"",element["dateField"]=dateField}else this.savedReport&&!this.serverConfig.dateField&&-1!==this.resultObject.report.dateOperator?(element["dateFilter"]=this.resultObject.dateRange,element["dateField"]=this.config.customDateField?this.getDateFieldParam(this.resultObject.dateRange,this.config.customDateField,this.moduleId):this.getDateFieldParam(this.resultObject.dateRange,element.xField.field_id+"_"+element.xField.fieldName,this.moduleId)):(this.serverConfig.dateField&&!0===element.isTime?(this.serverConfig.dateField["field_id"]=this.config.dimension.subDimension.fieldId,this.serverConfig.dateField["fieldName"]=this.config.dimension.subDimension.name,this.serverConfig.dateField["module_id"]=this.moduleId,element["dateField"]=this.serverConfig.dateField):element["dateField"]=this.serverConfig.dateField?this.computeDateFieldParamFromExisting(this.serverConfig.dateField,element):this.getDateFieldParam(NewDateHelper/* default */.Z.getDatePickerObject(22),element.xField.field_id+"_"+element.xField.fieldName,this.moduleId),element["dateFilter"]=this.serverConfig.dateFilter?this.serverConfig.dateFilter:NewDateHelper/* default */.Z.getDatePickerObject(22));if(this.config.metric&&0===this.config.metric.length){this.currentMetric=0;var defaultMetric={};2===element.moduleType?defaultMetric["displayName"]="Number of workrequests":defaultMetric["displayName"]="Number of "+this.moduleDisplayName,defaultMetric["fieldId"]=-1,defaultMetric["name"]="default",defaultMetric["defaultMetric"]=!0,this.config.metric.push(defaultMetric)}this.showChart=!0,this.serverConfig=element},computeDateFieldParamFromExisting:function(existingDateField,newServerConfig){var dateField={},customDateFieldSplit=this.config.customDateField?this.config.customDateField.split(/_(.+)/):[null,null];return dateField["operator"]=existingDateField.operator,dateField["field_id"]=!0===newServerConfig.isTime?newServerConfig.xField.field_id:customDateFieldSplit[0]?parseInt(customDateFieldSplit[0]):null,dateField["fieldName"]=!0===newServerConfig.isTime?newServerConfig.xField.fieldName:customDateFieldSplit[1],!0===newServerConfig.isTime?dateField["module_id"]=newServerConfig.xField.module_id:dateField["module_id"]=this.moduleId,dateField["date_value"]=existingDateField.date_value,dateField},getDateFieldParam:function(dateObj,element,moduleId){var dateField={};if(isString_default()(element)){var customDateFieldSplit=element.split(/_(.+)/);dateField["field_id"]=parseInt(customDateFieldSplit[0]),dateField["fieldName"]=customDateFieldSplit[1]}else dateField["field_id"]=element,dateField["fieldName"]=null;return dateField["operator"]=dateObj.operatorId,dateField["module_id"]=moduleId,49===dateObj.operatorId||50===dateObj.operatorId||51===dateObj.operatorId?dateField["date_value"]=Math.abs(dateObj.offset)+"":20===dateObj.operatorId?dateField["date_value"]=dateObj.value.join(","):dateField["date_value"]=dateObj.value[0]+"",dateField},addCriteriaAndResconstruct:function(){if(!this.isCriteriaEmpty()){if(!this.validateOperatorId())return;this.criteriaTrigger=!0,this.$set(this.serverConfig,"criteria",this.config.criteria)}this.$set(this.serverConfig,"having",this.config.having),this.createTrigger=!1,this.showCriteriaBuilder=!1},validateOperatorId:function(){if(this.config.criteria){for(var _i2=0,_Object$keys2=Object.keys(this.config.criteria.conditions);_i2<_Object$keys2.length;_i2++){var condition=_Object$keys2[_i2];if(""===this.config.criteria.conditions[parseInt(condition)].operatorId||null===this.config.criteria.conditions[parseInt(condition)].operatorId)return this.$message.error("Operator cannot be null"),!1}return!0}},lookUpFilter:function(){var self=this,field=self.config.dimension.subDimension;if(field.displayName!=this.lookUpFilterConfig.name){if("ticketstatus"===field.lookupModule.name){var _step29,tstatus=this.$store.state.ticketStatus["workorder"],tstatusMap={},_iterator29=(0,createForOfIteratorHelper/* default */.Z)(tstatus);try{for(_iterator29.s();!(_step29=_iterator29.n()).done;){var st=_step29.value;tstatusMap[st.id]=st.displayName}}catch(err){_iterator29.e(err)}finally{_iterator29.f()}self.lookUpFilterConfig.allValues=tstatusMap}else self.lookUpFilterConfig.allValues={},(0,picklist/* getFieldOptions */._K)({field:{lookupModuleName:field.lookupModule.name,skipDeserialize:!0}}).then((function(_ref3){var error=_ref3.error,options=_ref3.options;error?self.$message.error(error.message||"Error Occured"):self.lookUpFilterConfig.allValues=options}));self.lookUpFilterConfig.name=field.displayName,self.lookUpFilterConfig.chooseValues=[],self.showLookUpFilter=!0}else self.showLookUpFilter=!0},setLookUpFilterConfig:function(config){this.showLookUpFilter=!1,this.lookUpFilterConfig=config,this.config.dimension.subDimension.selectedIds=config.chooseValues,this.serverConfig.xField.selectedIds=config.chooseValues},getLookUpFilterIds:function(config){return config.dimension.subDimension.selectedIds},reconstructLookUpFilterConfig:function(result){var _this9=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var field,tstatus,tstatusMap,_iterator30,_step30,st,_yield$getFieldOption,error,options;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if(!result.report.dataPoints[0].xAxis.selectValuesOnly){_context2.next=19;break}if(field=_this9.config.dimension.subDimension,_this9.lookUpFilterConfig.chooseValues=result.report.dataPoints[0].xAxis.selectValuesOnly,_this9.setLookUpFilterConfig(_this9.lookUpFilterConfig),_this9.lookUpFilterConfig.name=field.displayName,"ticketstatus"!==field.lookupModule.name){_context2.next=13;break}tstatus=_this9.$store.state.ticketStatus["workorder"],tstatusMap={},_iterator30=(0,createForOfIteratorHelper/* default */.Z)(tstatus);try{for(_iterator30.s();!(_step30=_iterator30.n()).done;)st=_step30.value,tstatusMap[st.id]=st.displayName}catch(err){_iterator30.e(err)}finally{_iterator30.f()}_this9.lookUpFilterConfig.allValues=tstatusMap,_context2.next=19;break;case 13:return _context2.next=15,(0,picklist/* getFieldOptions */._K)({field:{lookupModuleName:field.lookupModule.name,skipDeserialize:!0}});case 15:_yield$getFieldOption=_context2.sent,error=_yield$getFieldOption.error,options=_yield$getFieldOption.options,error?_this9.$message.error(error.message||"Error Occured"):_this9.lookUpFilterConfig.allValues=options;case 19:case"end":return _context2.stop()}}),_callee2)})))()}}},forms_NewReportvue_type_script_lang_js=NewReportvue_type_script_lang_js,NewReport_component=(0,componentNormalizer/* default */.Z)(forms_NewReportvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,NewReport=NewReport_component.exports},
/***/7634:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"a9487fe98c87670f4c21aa6dfd4aef8d.svg";
/***/},
/***/948950:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"7d5fd8230a42692887ff0d154bbf092e.svg";
/***/}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/3214.js.map