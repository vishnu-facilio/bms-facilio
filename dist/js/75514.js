(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[75514],{
/***/703117:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return AlarmModel}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/AlarmModel.vue?vue&type=template&id=5b251d32
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticStyle:{background:"#fff",width:"400px",height:"420px !important"}},[_vm._m(0),_c("div",{staticClass:"model-container",staticStyle:{background:"#fff"}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v("Category")]),_c("el-select",{staticClass:"fc-input-full-border2 width100",model:{value:_vm.alarmRequest.category,callback:function($$v){_vm.$set(_vm.alarmRequest,"category",$$v)},expression:"alarmRequest.category"}},_vm._l(_vm.ticketcategory,(function(category){return _c("el-option",{key:category.id,attrs:{label:category.displayName,value:category.id}})})),1),_c("p",{staticClass:"fc-input-label-txt mT20"},[_vm._v("Team/Staff")]),_c("div",{staticStyle:{border:"1px solid #d8dce5",display:"inline-block",position:"relative",width:"100%",height:"40px","line-height":"40px","padding-left":"10px","padding-right":"10px","border-radius":"3px"}},[_c("span",[_vm._v(_vm._s(_vm.getTeamStaffLabel(_vm.alarmRequest)))]),_vm._m(1),_c("f-assignment",{attrs:{model:_vm.alarmRequest,viewtype:"form"}})],1),_c("p",{staticClass:"fc-input-label-txt mT20"},[_vm._v("Priority")]),_c("el-select",{staticClass:"fc-input-full-border2 width100",model:{value:_vm.alarmRequest.priority,callback:function($$v){_vm.$set(_vm.alarmRequest,"priority",$$v)},expression:"alarmRequest.priority"}},_vm._l(_vm.ticketpriority,(function(priority){return _c("el-option",{key:priority.priority,attrs:{label:priority.displayName,value:parseInt(priority.id)}})})),1),_c("p",{staticClass:"fc-input-label-txt mT20"},[_vm._v("Site")]),_c("el-select",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"fc-input-full-border2 width100",attrs:{filterable:"",clearable:"","collapse-tags":"",placeholder:"Sites"},model:{value:_vm.alarmRequest.siteId,callback:function($$v){_vm.$set(_vm.alarmRequest,"siteId",$$v)},expression:"alarmRequest.siteId"}},_vm._l(_vm.sites,(function(site,index){return _c("el-option",{key:index,attrs:{label:site.name,value:site.id}})})),1)],1),_c("div",{staticClass:"modal-dialog-footer",staticStyle:{background:"#fff"}},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.closeDialog}},[_vm._v("CANCEL")]),_c("el-button",{staticClass:"modal-btn-save",on:{click:function($event){return _vm.createWO()}}},[_vm._v("CREATE")])],1)])},staticRenderFns=[function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticStyle:{padding:"20px 20px 10px 20px"},attrs:{label:"Create Workorder"}},[_c("div",{staticClass:"setup-modal-title"},[_vm._v("Create workorder")])])},function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("span",{staticStyle:{float:"right"}},[_c("i",{staticClass:"el-icon-arrow-down",staticStyle:{position:"relative",top:"-4px",right:"3px",color:"#c0c4cc"}})])}],objectSpread2=__webpack_require__(595082),vuex_esm=__webpack_require__(420629),FAssignment=__webpack_require__(383274),TeamStaffMixin=__webpack_require__(462599),AlarmModelvue_type_script_lang_js={props:["id"],components:{FAssignment:FAssignment/* default */.Z},mixins:[TeamStaffMixin/* default */.Z],data:function(){return{alarmRequest:{category:null,assignedTo:{id:-1},assignmentGroup:{id:-1},siteId:null,priority:null}}},created:function(){this.$store.dispatch("loadTicketCategory"),this.$store.dispatch("loadTicketPriority"),this.$store.dispatch("loadGroups")},computed:(0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({users:function(state){return state.users},sites:function(state){return state.sites},ticketcategory:function(state){return state.ticketCategory},ticketpriority:function(state){return state.ticketPriority}})),methods:{createWO:function(event){this.$emit("submit",this.alarmRequest)},closeDialog:function(){this.reset(),this.$emit("closed")},reset:function(){this.alarmRequest={category:null,assignedTo:{id:-1},assignmentGroup:{id:-1},priority:null}}}},components_AlarmModelvue_type_script_lang_js=AlarmModelvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_AlarmModelvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,AlarmModel=component.exports},
/***/349318:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return Comments}});
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/objectSpread2.js
var render,staticRenderFns,objectSpread2=__webpack_require__(595082),esm_typeof=__webpack_require__(103336),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),vuex_esm=(__webpack_require__(634338),__webpack_require__(670560),__webpack_require__(843097),__webpack_require__(420629)),api=__webpack_require__(32284),Commentsvue_type_script_lang_js={props:["module","record","notify","parentModule","isServicePortal","setNoOfNotesLength"],created:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.next=2,_this.availablePortalApps();case 2:_this.canShowSharing&&(_this.newComment.commentSharing=_this.defaultSharingApps),_this.loadComments();case 4:case"end":return _context.stop()}}),_callee)})))()},data:function(){return{isAddingNotes:!1,loading:!0,selectedPortal:[],portalApps:[],defaultSharingApps:[],comments:[],newComment:{parentModuleLinkName:this.module,parentId:this.record.id,body:null,notifyRequester:!1,commentSharing:[]},commentFocus:!1}},watch:{record:function(recordObj){this.loadComments()},comments:function(newVal){this.record&&"object"===(0,esm_typeof/* default */.Z)(this.record)&&this.setNoOfNotesLength&&
//this.record.noOfNotes = this.comments.length
this.setNoOfNotesLength(this.comments.length)}},computed:(0,objectSpread2/* default */.Z)({showNotifyRequester:function(){return"undefined"===typeof this.notify||this.notify}},(0,vuex_esm/* mapGetters */.Se)(["getCurrentUser"])),methods:{availablePortalApps:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var _yield$API$get,error,data,licensedPortalApps,commentSharingPreferences;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,api/* API */.bl.get("/v3/commentPreferences/sharingOptions");case 2:_yield$API$get=_context2.sent,error=_yield$API$get.error,data=_yield$API$get.data,error?_this2.$message.error(error.message||_this2.$t("common._common.error_occured")):(licensedPortalApps=data.licensedPortalApps,commentSharingPreferences=data.commentSharingPreferences,_this2.portalApps=licensedPortalApps,_this2.defaultSharingApps=commentSharingPreferences);case 6:case"end":return _context2.stop()}}),_callee2)})))()},loadComments:function(){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var url;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:if(_this3.record&&"object"===(0,esm_typeof/* default */.Z)(_this3.record)){_context3.next=2;break}return _context3.abrupt("return");case 2:return _this3.loading=!0,_this3.newComment.parentId=_this3.record.id,url="/note/get?module=",_this3.isServicePortal&&(url="/notelist?module="),_context3.abrupt("return",_this3.$http.get(url+_this3.module+"&parentId="+_this3.record.id+"&parentModuleName="+_this3.parentModule).then((function(response){_this3.loading=!1,_this3.comments=response.data})).catch((function(error){_this3.loading=!1,_this3.comments=[]})));case 7:case"end":return _context3.stop()}}),_callee3)})))()},reset:function(){this.newComment={parentModuleLinkName:this.module,parentId:this.record.id,body:null,notifyRequester:!1},this.canShowSharing&&(this.newComment.commentSharing=this.defaultSharingApps)},addComment:function(){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){var param,url,record,parentModule,module,_yield$API$post,data,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:if(!_this4.newComment.body){_context4.next=13;break}return _this4.isServicePortal&&(_this4.newComment.notifyRequester=!0),param={note:_this4.newComment,module:_this4.module,parentModuleName:_this4.parentModule},"basealarmnotes"===_this4.module&&(param.alarmOccurrenceId=_this4.record.occurrence?_this4.record.occurrence.id:-1),_this4.isAddingNotes=!0,url="v2/notes/add",_this4.$helpers.isLicenseEnabled("THROW_403_WEBTAB")&&(record=_this4.record,parentModule=_this4.parentModule,module=_this4.module,url="v2/notes/".concat(module,"/").concat(parentModule,"/add/").concat(record.id)),_context4.next=9,api/* API */.bl.post(url,param);case 9:_yield$API$post=_context4.sent,data=_yield$API$post.data,error=_yield$API$post.error,error?_this4.$message.error(error.message||"Error Occured"):(_this4.reset(),_this4.comments.push(data.Notes),_this4.closeComment(),_this4.isAddingNotes=!1);case 13:case"end":return _context4.stop()}}),_callee4)})))()}}},base_Commentsvue_type_script_lang_js=Commentsvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(base_Commentsvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,Comments=component.exports;
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/typeof.js
},
/***/147105:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return relatedlist_Comments}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/relatedlist/Comments.vue?vue&type=template&id=9c5de910
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"fc-comments"},[_vm.loading?_c("div",{staticClass:"text-center"},[_c("spinner",{attrs:{show:_vm.loading}})],1):_c("div",{staticClass:"comment-msg-container"},_vm._l(_vm.comments,(function(comment){return _c("div",{key:comment.id,staticClass:"fc-comment-row"},[_c("div",{staticClass:"flLeft f12 secondary-color comment-by"},[_c("user-avatar",{staticClass:"comments-avatar",attrs:{size:"md",user:comment.createdBy,id:comment.createdBy.id}}),_c("div",{staticClass:"pL45 comment-time"},[_c("i",{staticClass:"fa fa-circle",staticStyle:{opacity:"0.4px",color:"rgba(140,161,173,0.30)","font-size":"8px","padding-right":"5px"},attrs:{"aria-hidden":"true"}}),_vm._v(" "+_vm._s(_vm._f("fromNow")(comment.createdTime))+" ")])],1),null!=comment.bodyHTML?_c("div",{staticClass:"markdown-style",domProps:{innerHTML:_vm._s(comment.bodyHTML)}}):_vm._e(),_c("div",{staticClass:"clearboth"})])})),0),_c("div",{staticClass:"row new-comment-area width100 mT20",attrs:{id:"commentBoxPar"}},[_c("form",{staticClass:"col-12",on:{submit:function($event){return $event.preventDefault(),_vm.addComment.apply(null,arguments)}}},[_c("div",{staticClass:"markdown-inside"},[_c("textarea",{directives:[{name:"model",rawName:"v-model",value:_vm.newComment.body,expression:"newComment.body"}],ref:"commentBoxRef",staticClass:"comment-box pT10",class:{height75:_vm.commentFocus,height35:!_vm.commentFocus},staticStyle:{"font-size":"13px","letter-spacing":"0.3px",color:"#333333","border-color":"#d0d9e2 !important","border-radius":"3px",width:"100%",height:"40px"},attrs:{placeholder:_vm.placeholder?_vm.placeholder:_vm.$t("common._common.write_comment")},domProps:{value:_vm.newComment.body},on:{focus:_vm.focusCommentBox,input:function($event){$event.target.composing||_vm.$set(_vm.newComment,"body",$event.target.value)}}}),_vm._v(" "),_c("button",{class:[_vm.commentFocus?"show":"hide"],on:{click:_vm.markdownhelplist}},[_c("img",{staticClass:"pull-right pointer",attrs:{src:__webpack_require__(773339)}})])]),this.markdownshow?[_c("markdown-help-list",{attrs:{markdownshow:_vm.markdownshow},on:{"update:markdownshow":function($event){_vm.markdownshow=$event}}})]:_vm._e(),_vm.commentFocus?_c("div",[_c("div",{staticClass:"flRight"},[_c("button",{staticClass:"comment-btn"},[_vm._v(" "+_vm._s(_vm.btnLabel?_vm.btnLabel:_vm.$t("common._common.comment"))+" ")])]),!_vm.isServicePortal&&_vm.showNotifyRequester?_c("div",{staticClass:"flLeft"},[_c("input",{directives:[{name:"model",rawName:"v-model",value:_vm.newComment.notifyRequester,expression:"newComment.notifyRequester"}],staticClass:"notify-requester-checkbox",attrs:{type:"checkbox",name:"notifyRequester"},domProps:{checked:Array.isArray(_vm.newComment.notifyRequester)?_vm._i(_vm.newComment.notifyRequester,null)>-1:_vm.newComment.notifyRequester},on:{change:function($event){var $$a=_vm.newComment.notifyRequester,$$el=$event.target,$$c=!!$$el.checked;if(Array.isArray($$a)){var $$v=null,$$i=_vm._i($$a,$$v);$$el.checked?$$i<0&&_vm.$set(_vm.newComment,"notifyRequester",$$a.concat([$$v])):$$i>-1&&_vm.$set(_vm.newComment,"notifyRequester",$$a.slice(0,$$i).concat($$a.slice($$i+1)))}else _vm.$set(_vm.newComment,"notifyRequester",$$c)}}}),_c("label",{staticClass:"notify-req",attrs:{for:"notifyRequester"}},[_vm._v(_vm._s(_vm.$t("common._common.notify")))])]):_vm._e(),_c("div",{staticClass:"clearboth"})]):_vm._e()],2)])])},staticRenderFns=[],User=(__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(228436),__webpack_require__(426803)),Comments=__webpack_require__(349318),MarkdownHelpList=__webpack_require__(566302),Commentsvue_type_script_lang_js={extends:Comments/* default */.Z,props:["placeholder","btnLabel"],components:{UserAvatar:User/* default */.Z,MarkdownHelpList:MarkdownHelpList/* default */.Z},data:function(){return{markdownshow:!1}},created:function(){window.addEventListener("click",this.blurCommentBox)},methods:{markdownhelplist:function(){this.markdownshow=!0},focusCommentBox:function(){this.$refs.commentBoxRef.focus(),this.commentFocus=!0},blurCommentBox:function(e){var itTargetPar=e.path.filter((function(ele){if("commentBoxPar"===ele.id)return!0}));this.newComment.body&&""!==this.newComment.body.trim()||itTargetPar.length||(this.commentFocus=!1)}}},relatedlist_Commentsvue_type_script_lang_js=Commentsvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(relatedlist_Commentsvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,relatedlist_Comments=component.exports},
/***/575514:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return NewAlarmSummary}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/firealarm/alarms/v1/NewAlarmSummary.vue?vue&type=template&id=b6a13f48
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_vm.alarm?_c("div",[_c("div",{staticClass:"alarm-summary-header"},[_c("div",{staticClass:"fL"},[_c("div",{staticClass:"fc-id"},[_vm._v("#"+_vm._s(_vm.alarm.serialNumber))]),_c("div",{staticClass:"fc-black3-24 max-width650px textoverflow-height-ellipsis"},[_vm._v(" "+_vm._s(_vm.alarm.subject?_vm.alarm.subject:"---")+" ")]),_c("div",[_vm.alarm.severity?_c("div",{staticClass:"flex-middle mT10"},[_c("div",{staticClass:"uppercase secondary-color summaryseverityTag f11",style:{"background-color":_vm.getAlarmSeverity(_vm.alarm.severity.id).color}},[_vm._v(" "+_vm._s(_vm.alarm.severity.id?_vm.getAlarmSeverity(_vm.alarm.severity.id).displayName:"---")+" ")]),_c("div",{staticClass:"fc-blue-label mL10 f11 letter-spacing: 0.7px;",staticStyle:{"margin-top":"-4px"}},[_vm._v(" "+_vm._s(_vm._f("fromNow")(_vm.alarm.modifiedTime))+" ")])]):_vm._e()])]),_c("div",{staticClass:"fR"},[_c("div",{staticClass:"triangle-close"},[_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"close-summary-icon material-icons pull-right pointer",attrs:{"data-theme":"light","data-arrow":"true"},on:{click:_vm.closeSummary}},[_vm._v("close")])]),_c("div",{staticClass:"display-flex"},[!_vm.alarm.isAcknowledged&&_vm.isActiveAlarm(_vm.alarm)&&_vm.$hasPermission("alarm:ACKNOWLEDGE_ALARM")?_c("el-button",{staticClass:"fc-btn-green-lg-fill",on:{click:function($event){return _vm.acknowledgeAlarms()}}},[_vm._v("Acknowledge")]):_vm.isActiveAlarm(_vm.alarm)?_c("div",{staticClass:"q-item-label mR10 status-btn2"},[_c("span",{staticClass:"pB10 fc-summary-ack ellipsis"},[_vm._v("Acknowledged by "+_vm._s(_vm.alarm.acknowledgedBy?_vm.$store.getters.getUser(_vm.alarm.acknowledgedBy.id).name:"Unknown"))]),_c("div",{staticClass:"text-right"},[_vm._v("  "),_c("span",{staticClass:"fc-summary-timeago text-right"},[_vm._v(_vm._s(_vm._f("fromNow")(_vm.alarm.acknowledgedTime>0?_vm.alarm.acknowledgedTime:new Date)))])])]):_c("div",{staticClass:"q-item-label fc-summary-ack status-btn1 pR10 pointer"},[_vm._v(" Unacknowledged ")]),_vm.isActiveAlarm(_vm.alarm)&&_vm.$hasPermission("alarm:CLEAR_ALARM")?_c("el-button",{staticClass:"fc-btn-green-lg-border",on:{click:function($event){return _vm.updateAlarmsStatus()}}},[_vm._v("CLEAR")]):_vm._e(),_vm.isActiveAlarm(_vm.alarm)?_c("q-icon",{staticClass:"fc-btn-ico-lg mL10",attrs:{slot:"right",name:"more_vert"},slot:"right"},[_c("q-popover",{ref:"moreactionspopover"},[_c("q-list",{staticClass:"no-border",attrs:{link:""}},[_c("q-item",[_c("q-item-main",{attrs:{label:"Delete"},on:{click:function($event){return _vm.deleteAlarmById()}}})],1),_c("q-item",[_c("q-item-main",{attrs:{label:"Export CSV"},on:{click:function($event){_vm.exportSummary(1),_vm.$refs.moreactionspopover.close()}}})],1),_c("q-item",[_c("q-item-main",{attrs:{label:"Export Excel"},on:{click:function($event){_vm.exportSummary(2),_vm.$refs.moreactionspopover.close()}}})],1),_vm.alarm.woId>0?_c("q-item",[_c("q-item-main",{attrs:{label:"View Workorder"},on:{click:function($event){_vm.openWorkorder(_vm.alarm.woId),_vm.$refs.moreactionspopover.close()}}})],1):_vm.$hasPermission("alarm:CREATE_WO")?_c("q-item",[_c("q-item-main",{attrs:{label:"Create Workorder"},on:{click:function($event){_vm.createWoDialog([_vm.alarm.id]),_vm.$refs.moreactionspopover.close()}}})],1):_vm._e()],1)],1)],1):_vm._e()],1)])])]):_c("div"),_c("div",{staticClass:"alarm-summary-body clearboth"},[_c("div",{staticClass:"alarm-summary-body-left"},[_c("div",{staticClass:"alaram-summary-body-scroll"},[_c("div",{staticClass:"alarm-summary-inner"},[_vm.alarm.ruleId||_vm.alarm.readingVal?_vm._e():_c("div",{staticClass:"fc-white-bg-container mB10"},[_c("div",{staticClass:"fc-blue-label f11 text-uppercase letter-spacing07"},[_vm._v(" Source ")]),_c("div",{staticClass:"label-txt-black mT10 line-height20"},[_vm._v(" "+_vm._s(_vm.alarm.source?_vm.alarm.source:"---")+" ")])]),_vm.alarm.sourceTypeEnum&&"THRESHOLD_ALARM"===_vm.alarm.sourceTypeEnum?_c("div",{staticClass:"alarm-summary-box-block"},[_vm.alarm.readingMessage&&!_vm.alarm.problem?_c("div",{staticClass:"alarm-summary-box-left alarm-summary-box mR10"},[_vm.alarm&&_vm.alarm.problem?_c("div",[_c("div",{staticClass:"fc-blue-label f11 text-uppercase letter-spacing07"},[_vm._v(" PROBLEM ")]),_c("div",{staticClass:"label-txt-black mT10 line-height20"},[_vm._v(" "+_vm._s(_vm.alarm.problem)+" ")])]):_vm.alarm&&_vm.alarm.readingMessage&&!_vm.alarm.problem?_c("div",[_c("div",{staticClass:"fc-blue-label f11 text-uppercase letter-spacing07"},[_vm._v(" Message ")]),_c("div",{staticClass:"label-txt-black mT10 line-height20"},[_vm._v(" "+_vm._s(_vm.loadmsg())+" ")])]):_vm._e()]):_vm._e(),_vm.alarm.readingVal&&_vm.readingField.displayName?_c("div",{staticClass:"alarm-summary-box-left alarm-summary-box",style:_vm.alarm.readingMessage?"width:100%":""},[_c("el-row",[_vm.alarm.readingVal&&_vm.readingField.displayName?_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"fc-blue-label f11 text-uppercase letter-spacing07"},[_vm._v(" Threshold Metric ")]),_c("div",{staticClass:"label-txt-black mT10 line-height20"},[_vm._v(" "+_vm._s(_vm.alarm.readingFieldId?_vm.readingField?_vm.readingField.displayName:_vm.loadFieldDetails():"---")+" ")])]):_c("el-col",{attrs:{span:12}}),_vm.alarm.readingVal&&_vm.readingField.unit?_c("el-col",{staticClass:"pL20",attrs:{span:12}},[_c("div",{staticClass:"fc-blue-label f11 text-uppercase letter-spacing07"},[_vm._v(" RECORDED VALUE ")]),_c("div",{staticClass:"label-txt-black mT10 line-height20"},[_vm._v(" "+_vm._s(Number(_vm.alarm.readingVal).toFixed(2))+" "+_vm._s(_vm.loadReadingField())+" ")])]):_vm._e()],1)],1):_vm._e()]):_vm._e(),_vm.alarm.data?_c("div",{staticClass:"alarm-summary-box-block mT10"},[_c("div",{staticClass:"alarm-summary-box-left alarm-summary-box width100"},[_c("el-row",_vm._l(_vm.alarm.data,(function(key,value){return _c("el-col",{key:value,attrs:{span:6}},[_c("div",{staticClass:"fc-blue-label f11 text-uppercase letter-spacing07"},[_vm._v(" "+_vm._s(_vm.getFieldByName(value).displayName)+" ")]),_c("div",{staticClass:"label-txt-black line-height20 mT10"},[_vm._v(" "+_vm._s(_vm.$helpers.unitValueString(_vm.getFieldByName(value),_vm.formattedKey(key)))+" ")])])})),1)],1)]):_vm._e(),_c("div",{staticClass:"alarm-summary-box-block mT10"},[_c("div",{staticClass:"alarm-summary-box-left alarm-summary-box"},[_c("div",{staticClass:"fc-blue-label f11 text-uppercase letter-spacing07"},[_vm._v(" Condition ")]),_vm.alarm.condition?_c("div",{staticClass:"label-txt-black mT10 line-height20"},[_vm._v(" "+_vm._s(_vm.alarm.condition?_vm.alarm.condition:"---")+" ")]):_c("div",{staticClass:"label-txt-black mT10 line-height20"},[_vm._v("---")])]),_c("div",{staticClass:"alarm-summary-box-left alarm-summary-box mL10"},[_c("el-row",[_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"fc-blue-label f11 text-uppercase letter-spacing07"},[_vm._v(" Created On ")]),_vm.alarm.createdTime?_c("div",{staticClass:"fc-black-13 mT10 line-height20 text-left"},[_vm._v(" "+_vm._s(_vm._f("formatDate")(_vm.alarm.createdTime))+" ")]):_c("div",{staticClass:"label-txt-black mT10"},[_vm._v("---")])]),_c("el-col",{staticClass:"pL10 pR0",attrs:{span:12}},[_c("div",{staticClass:"fc-blue-label f11 text-uppercase letter-spacing07"},[_vm._v(" Last Recorded ")]),_vm.alarm.modifiedTime?_c("div",{staticClass:"fc-black-13 mT10 line-height20 text-left"},[_vm._v(" "+_vm._s(_vm._f("formatDate")(_vm.alarm.modifiedTime))+" ")]):_c("div",{staticClass:"label-txt-black mT10"},[_vm._v("---")])])],1)],1)]),_vm.alarm&&_vm.alarm.readingVal||12===_vm.alarm.sourceType||9===_vm.alarm.sourceType?_c("div",{staticClass:"alarm-summary-graph-container"},[_c("div",{staticClass:"alarm-summary-graph-inner"},[_vm._m(0),_c("div",{},[_vm.analyticsConfig?_c("f-new-analytic-report",{ref:"newAlarmAnalyticReport",staticClass:"alarm-summary-chart",attrs:{config:_vm.analyticsConfig}}):_vm._e()],1),_c("div",{staticClass:"analytics-txt pB0"},[_c("div",{staticClass:"fc-summary-content-div"},[_c("div",{staticClass:"content analytics-txt",staticStyle:{cursor:"pointer",color:"rgb(57, 178, 194)","font-size":"13px","text-align":"right","font-weight":"500","margin-right":"20px"},on:{click:function($event){return _vm.Analytics(_vm.alarm.id,null,12!==_vm.alarm.sourceType)}}},[_vm._v(" Go to Analytics "),_c("img",{staticStyle:{width:"13px",height:"9px"},attrs:{src:__webpack_require__(862620)}})])])]),_c("div",[_vm.alarm.possibleCauses||_vm.alarm.recommendation>0?_c("div",[_c("div",{staticClass:"pL20 pR20 mT10 pT20 pB20 border-top3"},[_vm.alarm.possibleCauses?_c("div",[_c("div",{staticClass:"fc-blue-label f11 text-uppercase letter-spacing07"},[_vm._v(" POSSIBLE CAUSES ")]),_c("div",{staticClass:"label-txt-black mT10 line-height20 space-preline"},[_vm._v(" "+_vm._s(_vm.alarm.possibleCauses)+" ")])]):_vm.alarm.possibleCauses?_vm._e():_c("div")]),_c("div",{staticClass:"mT10 pL20 pR20 pB20"},[_vm.alarm.recommendation?_c("div",[_c("div",{staticClass:"fc-blue-label f11 text-uppercase letter-spacing07"},[_vm._v(" POSSIBLE SOLUTIONS ")]),_c("div",{staticClass:"label-txt-black mT10 line-height20 space-preline"},[_vm._v(" "+_vm._s(_vm.alarm.recommendation)+" ")])]):_vm.alarm.recommendation?_c("div"):_vm._e()])]):_vm._e()])])]):_vm._e(),_vm.additionInfo&&_vm.additionInfo.rcaJSONArray&&_vm.additionInfo.rcaJSONArray.length>0?_c("div",{staticClass:"mB10 position-relative"},[_c("div",{staticClass:"fc-grey2 mT20 fw-bold text-uppercase f11"},[_vm._v(" Root Cause Analysis ")]),_c("el-collapse",{ref:"alarmlistcollapse",staticClass:"dashboard-collapse alarm-summary-dashboard",attrs:{accordion:""},model:{value:_vm.activeRule,callback:function($$v){_vm.activeRule=$$v},expression:"activeRule"}},_vm._l(_vm.additionInfo.rcaJSONArray,(function(rca,index){return _c("el-collapse-item",{key:index,staticClass:"pT10 position-relative",attrs:{name:rca.rcaRule.id}},[_c("template",{slot:"title"},[_c("div",{staticClass:"fL width90"},[_c("div",{staticClass:"fc-black3-16 text-capitalize"},[_vm._v(" "+_vm._s(rca.rcaRule.actions[0].template&&rca.rcaRule.actions[0].template.originalTemplate?rca.rcaRule.actions[0].template.originalTemplate.problem:null)+" "),_c("span",{staticClass:"fc-grey2-text12 bold",staticStyle:{"text-transform":"lowercase"}},[_vm._v(" ("+_vm._s(rca.rcaRule?"v"+rca.rcaRule.versionNumber:null)+")")]),rca.isActive?_c("span",{staticClass:"fc-grey2 f10 f10 pL20"},[_c("i",{staticClass:"fa fa-circle pR10 fc-green",attrs:{"aria-hidden":"true"}}),_vm._v("Active ")]):_c("span",{staticClass:"fc-grey2 f10 pL20"},[_c("i",{staticClass:"fa fa-circle pR10 fc-red f10",attrs:{"aria-hidden":"true"}}),_vm._v(" Inactive ")])])]),_c("div",{staticClass:"fR"},[_c("i",{staticClass:"el-icon-arrow-up f16"}),_c("i",{staticClass:"el-icon-arrow-down f16"})])]),_c("div",{staticClass:"clear"},[_c("div",[rca.analyticsConfig?_c("f-new-analytic-report",{ref:"newAnalyticReport",refInFor:!0,staticClass:"alarm-summary-chart alarm-summary-chart-root-cause",attrs:{config:rca.analyticsConfig}}):_vm._e()],1),_c("div",{staticClass:"analytics-txt"},[_c("div",{staticClass:"fc-summary-content-div"},[_c("div",{staticClass:"content analytics-txt",staticStyle:{cursor:"pointer",color:"rgb(57, 178, 194)","font-size":"13px","text-align":"right","font-weight":"500","margin-right":"20px"},on:{click:function($event){return _vm.Analytics(_vm.alarm.id,null,!1,rca.rcaRule.id)}}},[_vm._v(" Go to Analytics "),_c("img",{staticStyle:{width:"13px",height:"9px"},attrs:{src:__webpack_require__(862620)}})])])])]),rca.rcaRule.actions&&rca.rcaRule.actions[0]?_c("div",{staticClass:"pT20 pL20 pB20 pR20 border-top3"},[_c("div",{staticClass:"fc-blue-label f11 text-uppercase letter-spacing07"},[_vm._v(" POSSIBLE CAUSES ")]),_c("div",{staticClass:"label-txt-black mT10 line-height20 space-preline"},[_vm._v(" "+_vm._s(rca.rcaRule.actions[0].template&&rca.rcaRule.actions[0].template.originalTemplate?rca.rcaRule.actions[0].template.originalTemplate.possibleCauses:null)+" ")])]):_vm._e(),_c("div",{staticClass:"pL20 pB20 pR20"},[_c("div",{staticClass:"fc-blue-label f11 text-uppercase letter-spacing07"},[_vm._v(" POSSIBLE SOLUTIONS ")]),_c("div",{staticClass:"label-txt-black mT10 line-height20 space-preline"},[_vm._v(" "+_vm._s(rca.rcaRule.actions[0].template&&rca.rcaRule.actions[0].template.originalTemplate?rca.rcaRule.actions[0].template.originalTemplate.recommendation:null)+" ")])])],2)})),1)],1):_vm._e(),_c("div",{staticClass:"fc-white-bg-container mT10 p0 alarm-comment-con"},[_c("div",{staticClass:"row pT20",staticStyle:{"border-bottom":"1px solid #f4f4f4"}},[_c("div",{staticClass:"col-12"},[_c("div",{staticClass:"row pL20"},[_c("div",{staticClass:"col-1 fc-black-13 text-left pointer bold",on:{click:function($event){return _vm.selectSubSection("comment")}}},[_vm._v(" Comments "),_c("div",{class:{wosactive:"comment"===_vm.subSection},staticStyle:{width:"50%"}})]),_c("div",{staticClass:"col-1 fc-black-13 text-left pointer bold mL60",on:{click:function($event){return _vm.selectSubSection("event")}}},[_vm._v(" Events "),_c("div",{class:{wosactive:"event"===_vm.subSection},staticStyle:{width:"50%"}})]),_c("div",{staticClass:"col-3 fc-black-13 text-left pointer bold mL40",on:{click:function($event){return _vm.selectSubSection("relatedalarms")}}},[_vm._v(" Related Alarms "),_c("div",{class:{wosactive:"relatedalarms"===_vm.subSection},staticStyle:{width:"30%"}})])])])]),"relatedalarms"===_vm.subSection?_c("div",[_vm.relatedAlarmsLoading?_c("spinner",{attrs:{show:_vm.relatedAlarmsLoading,size:"50"}}):!_vm.relatedalarms||!_vm.relatedalarms.length||1===_vm.relatedalarms.length&&_vm.relatedalarms[0].id===_vm.alarm.id?_c("div",{staticClass:"empty-msg"},[_vm._v(" No related alarms found. ")]):_vm._l(_vm.relatedalarms,(function(relatedalarm,index){return _vm.alarm.id!==relatedalarm.id?_c("el-row",{key:index,staticClass:"pR10 pT10 pB10 mL20 mR20",staticStyle:{"line-height":"2.79","border-bottom":"solid 1px rgba(151, 151, 151, 0.2)"}},[_c("el-col",{attrs:{span:2}},[_c("router-link",{attrs:{to:"/app/fa/faults/summary/"+relatedalarm.id}},[_c("div",{staticClass:"id-color f13 pull-left pointer"},[_vm._v(" #"+_vm._s(relatedalarm.serialNumber)+" ")])])],1),_c("el-col",{attrs:{span:15}},[_c("div",{staticClass:"event-content2"},[_vm._v(" "+_vm._s(relatedalarm.subject)+" ")])]),_c("el-col",{attrs:{span:2}},[_c("div",{staticClass:"fc-id",style:{color:_vm.getAlarmSeverity(_vm.alarm.severity.id).color}},[_vm._v(" "+_vm._s("Clear"===_vm.getAlarmSeverity(relatedalarm.severity.id).severity&&relatedalarm.previousSeverity?_vm.getAlarmSeverity(relatedalarm.previousSeverity.id).severity:_vm.getAlarmSeverity(relatedalarm.severity.id).severity)+" ")])]),_c("el-col",{attrs:{span:5}},[_c("div",{staticStyle:{"font-size":"12px","letter-spacing":"0.4px","text-align":"right",color:"#919191"}},[_vm._v(" "+_vm._s(_vm._f("formatDate")(relatedalarm.modifiedTime))+" ")])])],1):_vm._e()}))],2):_vm._e(),"event"===_vm.subSection?_c("div",{staticClass:"row event-inner-container"},[_vm.eventsLoading?_c("spinner",{attrs:{show:_vm.eventsLoading,size:"50"}}):_c("table",{staticStyle:{"margin-bottom":"100px"},attrs:{width:"100%;"}},_vm._l(_vm.events,(function(event,index){return _c("tr",{key:index,staticStyle:{"border-bottom":"solid 1px rgba(151, 151, 151, 0.2)","line-height":"2.79"}},[_c("td",{staticStyle:{width:"100%"}},[_c("div",{staticClass:"event-msg"},[_c("router-link",{attrs:{to:"/app/fa/events/all/summary/"+event.id}},[_c("div",{staticClass:"id-color f12 pull-left pointer"},[_c("span",{staticClass:"f11"},[_vm._v("#")]),_vm._v(_vm._s(event.id)+" ")])]),_c("div",{staticClass:"event-content"},[_vm._v(" "+_vm._s(event.eventMessage)+" ")]),_c("div",{staticStyle:{float:"right","font-size":"12px","letter-spacing":"0.4px","text-align":"right",color:"#919191"}},[_vm._v(" "+_vm._s(_vm._f("formatDate")(event.createdTime))+" ")]),_c("div",{staticStyle:{clear:"both"}})],1)])])})),0)],1):_vm._e(),"comment"===_vm.subSection?_c("comments",{staticStyle:{"margin-left":"40px","margin-right":"30px"},attrs:{module:"ticketnotes",parentModule:"alarm",record:_vm.alarm,notify:!1}}):_vm._e()],1)])])]),_c("div",{staticClass:"alarm-summary-body-right clearboth"},[_c("div",{staticClass:"alaram-summary-body-scroll mL30 mR20"},[_vm.alarm.createdTime&&-1===_vm.alarm.clearedTime?_c("div",{staticClass:"mT20"},[_c("div",{staticClass:"fc-blue-label f11 text-uppercase"},[_vm._v("ALARM DURATION")]),_c("timer",{directives:[{name:"tippy",rawName:"v-tippy",value:{html:"#timer_popover_"+_vm.alarm.id,distance:0,interactive:!0,theme:"light",animation:"scale",arrow:!0},expression:"{\n              html: '#timer_popover_' + alarm.id,\n              distance: 0,\n              interactive: true,\n              theme: 'light',\n              animation: 'scale',\n              arrow: true,\n            }"}],staticClass:"alarm-timer p10",attrs:{time:_vm.alarm.createdTime,twoDigits:_vm.showingTwoDigit,title:_vm._f("formatDate")(_vm.alarm.createdTime)}})],1):_vm.alarm.createdTime&&-1!==_vm.alarm.clearedTime?_c("div",{staticClass:"mT20"},[_c("div",{staticClass:"fc-blue-label f11 text-uppercase"},[_vm._v("ALARM DURATION")]),_c("timer",{directives:[{name:"tippy",rawName:"v-tippy",value:{html:"#timer_popover_"+_vm.alarm.id,distance:0,interactive:!0,theme:"light",animation:"scale",arrow:!0},expression:"{\n              html: '#timer_popover_' + alarm.id,\n              distance: 0,\n              interactive: true,\n              theme: 'light',\n              animation: 'scale',\n              arrow: true,\n            }"}],staticClass:"alarm-timer p10",attrs:{time:_vm.alarm.clearedTime-_vm.alarm.createdTime,staticTime:!0,twoDigits:_vm.showingTwoDigit,title:_vm._f("formatDate")(_vm.alarm.clearedTime-_vm.alarm.createdTime)}})],1):_vm._e(),_vm.resource?_c("div",{staticClass:"asset-con"},[_c("div",{staticClass:"mT20"},[_c("div",{staticClass:"fc-blue-label f11 text-uppercase"},[_vm._v("ASSET CATEGORY")]),_vm.resource&&_vm.resource.category&&_vm.resource.category.id?_c("div",{staticClass:"mT10 label-txt-black"},[_vm._v(" "+_vm._s(_vm.resource&&_vm.getAssetCategoryById(_vm.resource.category.id).displayName?_vm.getAssetCategoryById(_vm.resource.category.id).displayName:"---")+" ")]):_vm._e()]),_c("div",{staticClass:"mT25"},[_c("div",{staticClass:"fc-blue-label f11 text-uppercase"},[_vm._v("ASSET NAME")]),_vm.resource&&_vm.resource.name?_c("div",{staticClass:"mT10 label-txt-black pointer",on:{click:function($event){return _vm.openAsset(_vm.alarm.resource.id)}}},[_vm._v(" "+_vm._s(_vm.resource.name?_vm.resource.name:"---")+" ")]):_vm._e()]),_vm.resource&&_vm.resource.space&&_vm.resource.space.name&&"---"!==_vm.getSpace(1,_vm.alarm.resource.space.id)?_c("div",{staticClass:"mT25"},[_c("div",{staticClass:"fc-blue-label f11 text-uppercase"},[_vm._v("SITE")]),_c("div",{staticClass:"mT10 label-txt-black pointer",on:{click:function($event){return _vm.openSite(_vm.alarm.resource.space.id)}}},[_vm._v(" "+_vm._s(_vm.alarm.resource&&_vm.alarm.resource.space&&_vm.alarm.resource.space.id?_vm.getSpace(1,_vm.alarm.resource.space.id):"---")+" ")])]):_vm._e(),_vm.resource&&_vm.resource.space&&_vm.resource.space.name&&"---"!==_vm.getSpace(2,_vm.alarm.resource.space.id)?_c("div",{staticClass:"mT25"},[_c("div",{staticClass:"fc-blue-label f11 text-uppercase"},[_vm._v("BUILDING")]),_c("div",{staticClass:"mT10 label-txt-black pointer",on:{click:function($event){return _vm.openBuilding(_vm.alarm.resource.space.id)}}},[_vm._v(" "+_vm._s(_vm.alarm.resource&&_vm.alarm.resource.space&&_vm.alarm.resource.space.id?_vm.getSpace(2,_vm.alarm.resource.space.id):"---")+" ")])]):_vm._e(),_vm.resource&&_vm.resource.space&&_vm.resource.space.name&&"---"!==_vm.getSpace(3,_vm.alarm.resource.space.id)?_c("div",{staticClass:"mT25"},[_c("div",{staticClass:"fc-blue-label f11 text-uppercase"},[_vm._v("FLOOR")]),_c("div",{staticClass:"mT10 label-txt-black pointer",on:{click:function($event){return _vm.openFloor(_vm.alarm.resource.space.id)}}},[_vm._v(" "+_vm._s(_vm.alarm.resource&&_vm.alarm.resource.space&&_vm.alarm.resource.space.id?_vm.getSpace(3,_vm.alarm.resource.space.id):"---")+" ")])]):_vm._e(),_vm.resource&&_vm.resource.space&&_vm.resource.space.name&&"---"!==_vm.getSpace(4,_vm.alarm.resource.space.id)?_c("div",{staticClass:"mT25"},[_c("div",{staticClass:"fc-blue-label f11 text-uppercase"},[_vm._v("SPACE")]),_c("div",{staticClass:"mT10 label-txt-black pointer",on:{click:function($event){return _vm.openSpace(_vm.alarm.resource.space.id)}}},[_vm._v(" "+_vm._s(_vm.alarm.resource&&_vm.alarm.resource.space&&_vm.alarm.resource.space.id?_vm.getSpace(4,_vm.alarm.resource.space.id):"---")+" ")])]):_vm._e()]):_vm._e(),_vm.alarm&&_vm.alarm.woId&&_vm.workorder?_c("div",{staticClass:"mT25"},[_c("div",{},[_c("div",{staticClass:"fc-text-pink11"},[_vm._v("WORKORDER")]),_vm.workorder&&_vm.workorder.id?_c("div",{staticClass:"label-txt-black mT5 pointer fc-id",on:{click:function($event){return _vm.openWorkorder(_vm.alarm.woId)}}},[_vm._v(" #"+_vm._s(_vm.workorder.id)+" ")]):_vm._e(),_vm.workorder&&_vm.workorder.subject?_c("div",{staticClass:"label-txt-black mT5 pointer",on:{click:function($event){return _vm.openWorkorder(_vm.alarm.woId)}}},[_vm._v(" "+_vm._s(_vm.workorder.subject?_vm.workorder.subject:"---")+" ")]):_vm._e()]),_c("div",[_vm.workorder&&_vm.workorder.dueDate&&-1!==_vm.workorder.dueDate?_c("div",{staticClass:"mT20"},[_c("div",{staticClass:"fc-blue-label f11"},[_vm._v("Due Time")]),_vm.workorder&&_vm.workorder.dueDate?_c("div",{staticClass:"mT10 label-txt-black"},[_vm._v(" "+_vm._s(-1!==_vm.workorder.dueDate?_vm.workorder.dueDateString:"")+" ")]):_vm._e()]):_vm._e(),_c("div",{staticClass:"mT20"},[_c("div",{staticClass:"fc-blue-label f11"},[_vm._v("Status")]),_vm.workorder&&_vm.workorder.status&&_vm.workorder.status.displayName?_c("div",{staticClass:"mT10 label-txt-black"},[_vm._v(" "+_vm._s(_vm.workorder.status.displayName?_vm.workorder.status.displayName:"---")+" ")]):_vm._e()]),_vm.workorder&&_vm.workorder.assignedTo>0?_c("div",{staticClass:"mT20"},[_c("div",{staticClass:"fc-blue-label f11"},[_vm._v("ASSIGNED TO")]),_vm.workorder&&_vm.workorder.assignedTo&&_vm.workorder.assignedTo.name?_c("div",{staticClass:"mT10 label-txt-black"},[_vm._v(" "+_vm._s(_vm.workorder.assignedTo.name?_vm.workorder.assignedTo.name:"---")+" ")]):_vm._e()]):_vm._e(),_c("div",{staticClass:"mT20"},[_c("div",{staticClass:"fc-blue-label f11"},[_vm._v("PRIORITY")]),_vm.workorder&&_vm.workorder.priority&&_vm.workorder.priority.priority?_c("div",{staticClass:"mT10 label-txt-black"},[_c("i",{staticClass:"fa fa-circle f9",style:{color:_vm.workorder.priority.colour},attrs:{"aria-hidden":"true"}}),_vm._v(" "+_vm._s(_vm.workorder.priority.priority?_vm.workorder.priority.priority:"---")+" ")]):_vm._e()])])]):_vm._e()])])]),_vm.showAssetExport?_c("el-dialog",{staticClass:"dialog-header-remove export-dialog",attrs:{visible:_vm.showAssetExport,width:"30%"},on:{"update:visible":function($event){_vm.showAssetExport=$event}}},[_c("div",{staticClass:"new-header-container"},[_c("div",{staticClass:"new-header-text"},[_c("div",{staticClass:"fc-setup-modal-title"},[_vm._v("Export Alarm summary")])])]),_c("div",{staticClass:"export-body-dailog"},[_c("div",[_c("el-checkbox",{staticStyle:{"padding-bottom":"10px","padding-left":"40px","padding-top":"10px"},attrs:{checked:"",disabled:""}},[_vm._v("All Events")])],1),_c("el-checkbox-group",{staticClass:"check-padding-remove",model:{value:_vm.selectedFields,callback:function($$v){_vm.selectedFields=$$v},expression:"selectedFields"}},[_c("div",{staticClass:"row"},_vm._l(_vm.assetFields,(function(field){return _c("el-checkbox",{key:field.id,staticClass:"check-width",attrs:{label:field.id}},[_vm._v(_vm._s(field.displayName))])})),1)])],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){return _vm.closeExportDialog()}}},[_vm._v("CANCEL")]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:function($event){return _vm.exportEvent()}}},[_vm._v("EXPORT DATA")])],1)]):_vm._e(),_vm.exportDownloadUrl?_c("iframe",{staticStyle:{display:"none"},attrs:{src:_vm.exportDownloadUrl}}):_vm._e(),_c("q-modal",{ref:"createWOModel",attrs:{noBackdropDismiss:"","content-classes":"fc-model","content-css":{padding:"0px",background:"#f7f8fa",Width:"10vw",Height:"30vh"}}},[_c("alarm-model",{ref:"confirmWoModel",on:{submit:_vm.createWO,closed:_vm.closeWoDialog}})],1)],1)},staticRenderFns=[function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"alarm-summary-graph-header"},[_c("div",{staticClass:"fc-black-16 bold fL"},[_vm._v("Alarms Report")])])}],createForOfIteratorHelper=__webpack_require__(566347),objectSpread2=__webpack_require__(595082),Timer=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(538077),__webpack_require__(434284),__webpack_require__(564043),__webpack_require__(857267),__webpack_require__(670560),__webpack_require__(634338),__webpack_require__(114857)),Comments=__webpack_require__(147105),AlarmModel=__webpack_require__(703117),moment_moment=__webpack_require__(730381),moment_default=__webpack_require__.n(moment_moment),quasar_esm=__webpack_require__(641358),vuex_esm=__webpack_require__(420629),FNewAnalyticReport=__webpack_require__(794925),JumpToHelper=__webpack_require__(921466),AnalyticsMixin=__webpack_require__(244936),NewDateHelper=__webpack_require__(105534),router=__webpack_require__(329435),validation=__webpack_require__(990260),NewReportHelper=__webpack_require__(562023),d3=__webpack_require__(348727),log_map_getters=__webpack_require__(160799),log_map_state=__webpack_require__(766331),NewAlarmSummaryvue_type_script_lang_js={name:"NewAlarmSummary",mixins:[JumpToHelper/* default */.Z,NewReportHelper/* default */.Z,AnalyticsMixin/* default */.Z,NewDateHelper/* default */.Z],data:function(){return{alarmFields:[],assetFields:[],activeRule:null,workorder:null,eventsLoading:!1,relatedAlarmsLoading:!1,summary:!0,showAssetExport:!1,severity:{},subSection:"comment",events:[],showingTwoDigit:!0,relatedalarms:[],selectedFields:[],chartOperatorId:null,exportDownloadUrl:null,asset:null,exportType:null,readingField:null,analyticsConfig:null,loading:!0,isAcknowledged:!1,additionInfo:null}},components:{FNewAnalyticReport:FNewAnalyticReport["default"],Timer:Timer/* default */.Z,Comments:Comments/* default */.Z,QItem:quasar_esm/* QItem */.ry,QItemMain:quasar_esm/* QItemMain */.Ui,QModal:quasar_esm/* QModal */.hc,QIcon:quasar_esm/* QIcon */.oF,QPopover:quasar_esm/* QPopover */.oe,QList:quasar_esm/* QList */.tu,AlarmModel:AlarmModel/* default */.Z},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({alarms:function(state){return state.alarm.alarms},users:function(state){return state.users},severityStatus:function(state){return state.alarmSeverity}})),(0,log_map_state/* mapStateWithLogging */.g)({spaces:function(state){return state.spaces}})),(0,vuex_esm/* mapGetters */.Se)({getTicketPriority:"getTicketPriority",getTicketCategory:"getTicketCategory",getAssetCategoryById:"getAssetCategory",getAlarmSeverity:"getAlarmSeverity"})),(0,log_map_getters/* mapGettersWithLogging */.t)({storeGetSpace:"getSpace"})),{},{alarm:{
// getter
get:function(){return this.$store.state.alarm.currentAlarm},
// setter
set:function(newValue){}},alarmId:function(){return parseInt(this.$route.params.id)},resource:function(){return this.alarm&&this.alarm.resource?this.alarm.resource:null}}),created:function(){this.$store.dispatch("loadTicketPriority"),this.$store.dispatch("loadTicketCategory"),this.$store.dispatch("loadAssetCategory"),this.$store.dispatch("loadAlarmSeverity"),this.$store.dispatch("alarm/fetchAlarm",{id:parseInt(this.$route.params.id)})},watch:{alarm:function(){var _this=this,title="[#"+this.alarm.serialNumber+"] "+this.alarm.subject;this.setTitle(title),this.loadFieldDetails(),this.loadWoDetails(),this.activeRule=null,"event"===this.subSection?this.loadEvents(this.alarm.id):"relatedalarms"===this.subSection&&this.alarm.entityId&&this.loadRelatedAlarms(this.alarm.entityId);var config={alarmId:this.alarm.id,isWithPrerequsite:!(12===this.alarm.sourceType||9===this.alarm.sourceType||this.alarm.ruleId<0),dateFilter:this.getDatePickerObject(),hidechartoptions:!0,hidetabular:!0,hidecharttypechanger:!0,fixedChartHeight:300,isFromAlarmSummary:!0,applyReportDate:12===this.alarm.sourceType||9===this.alarm.sourceType};(this.alarm.readingVal||12===this.alarm.sourceType||9===this.alarm.sourceType)&&(this.analyticsConfig?(this.analyticsConfig=null,this.$nextTick((function(){_this.analyticsConfig=config}))):this.analyticsConfig=config)},activeRule:{handler:function(newValue,oldValue){null!==newValue&&this.handleChange(newValue)}},subSection:function(){"event"===this.subSection?this.loadEvents(this.alarm.id):"relatedalarms"===this.subSection&&this.alarm.entityId&&this.loadRelatedAlarms(this.alarm.entityId)},alarmId:function(newVal){this.$store.dispatch("alarm/fetchAlarm",{id:this.alarmId}),this.loadAssetDetails(),this.loadWoDetails()}},mounted:function(){this.loadAssetDetails(),this.loadWoDetails()},methods:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({formattedKey:function(key){return d3.format(",")(key)}},(0,vuex_esm/* mapActions */.nv)({assignAlarmApi:"alarm/assignAlarm",addAlarmApi:"alarm/addAlarm",updateAlarmStatus:"alarm/updateAlarmStatus",notifyAlarm:"alarm/notifyAlarm",acknowledgeAlarm:"alarm/acknowledgeAlarm",getRelatedWorkorderId:"alarm/getRelatedWorkorderId",deleteAlarm:"alarm/deleteAlarm"})),{},{acknowledgeAlarms:function(){this.acknowledgeAlarm({alarm:this.alarm,isAcknowledged:!0,acknowledgedBy:this.$account.user}),this.isAcknowledged=!0,this.loadAssetDetails()},updateAlarmsStatus:function(){this.updateAlarmStatus({alarm:this.alarm,clearedTime:Date.now(),severity:this.severityStatus.find((function(status){return"Clear"===status.severity}))}),this.alarm.clearedBy=this.$account.user},loadRCAReport:function(){var _this2=this;this.additionInfo&&this.additionInfo.rcaJSONArray&&this.additionInfo.rcaJSONArray.length>0&&this.additionInfo.rcaJSONArray.forEach((function(d){_this2.$set(d,"analyticsConfig",null),_this2.$nextTick((function(){_this2.$set(d,"analyticsConfig",{alarmId:_this2.alarm.id,readingRuleId:d.rcaRule.id,dateFilter:_this2.getDatePickerObject(),hidechartoptions:!0,hidetabular:!0,hidecharttypechanger:!0,fixedChartHeight:300,isFromAlarmSummary:!0,applyReportDate:12===_this2.alarm.sourceType})}))}))},loadAssetDetails:function(){var _this3=this;this.loadAlarmFields(),this.$http.post("/alarm/fetchAlarmSummary",{id:[this.$route.params.id]}).then((function(response){_this3.alarm?_this3.additionInfo=response.data.alarms[0].additionInfo:(_this3.alarm=response.data.alarms[0],_this3.additionInfo=_this3.alarm.additionInfo),_this3.loadRCAReport(),_this3.isAcknowledged&&(_this3.alarm.isAcknowledged=!0,_this3.alarm.acknowledgedBy=_this3.$account.user,_this3.isAcknowledged=!1)})).catch((function(error){}))},loadAlarmFields:function(){var _this4=this;this.$util.loadFields("alarm",!1).then((function(fields){_this4.alarmFields=fields}))},getFieldByName:function(field){var fields=this.alarmFields.filter((function(d){return d.name===field}));return fields[0]},handleChange:function(changedId){if(this.$refs.newAnalyticReport&&this.$refs.newAnalyticReport.length>0){var _step,_iterator=(0,createForOfIteratorHelper/* default */.Z)(this.$refs.newAnalyticReport);try{for(_iterator.s();!(_step=_iterator.n()).done;){var ref=_step.value;if(ref.config.readingRuleId===changedId){var index=this.$refs.newAnalyticReport.indexOf(ref);this.$refs.newAnalyticReport[index].resize()}}}catch(err){_iterator.e(err)}finally{_iterator.f()}}},loadmsg:function(){return this.alarm.readingMessage.replace("&deg;C","°C")},loadReadingField:function(){return this.readingField.unit.replace("&deg;C","°C")},getDatePickerObject:function(){var modifiedTime;return modifiedTime=this.alarm.createdTime,this.alarm.modifiedTime>0&&(modifiedTime=this.alarm.modifiedTime),NewDateHelper/* default */.Z.getDatePickerObject(12===this.alarm.sourceType?20:62,""+modifiedTime)},chartOperatorHandling:function(operatorId){this.chartOperatorId=operatorId},loadWoDetails:function(){var self=this;if(this.alarm&&this.alarm.woId&&this.alarm.woId>0){var url="/workorder/summary/"+this.alarm.woId;return self.$http.get(url).then((function(response){self.workorder=response.data.workorder}))}self.workorder=null,this.$forceUpdate()},forceUpdate:function(){this.$forceUpdate()},exportEvent:function(type){var array={alarmId:this.alarmId,fieldId:this.selectedFields,type:this.exportType,parentId:this.alarm.resource.id},self=this,url="event/eventExport";self.$message({showClose:!0,message:"Downloading...",type:"success"}),this.$http.post(url,array).then((function(response){self.exportDownloadUrl=response.data.fileUrl,self.showAssetExport=!1}))},closeExportDialog:function(){this.showAssetExport=!1,this.selectedFields=[]},exportSummary:function(type){var _this5=this;this.exportType=type,this.showAssetExport=!0,this.$util.loadAssetReadingFields(this.alarm.resource.id).then((function(fields){_this5.assetFields=fields}))},createWoDialog:function(id){this.createWoIds=id,this.$refs["createWOModel"].open(),this.$refs.confirmWoModel.reset()},getSpace:function(spaceType,spaceId){var obj=this.storeGetSpace(spaceId);if(obj){if(1===spaceType)return 1===obj.spaceType?obj.name:this.getSpace(1,obj.siteId);if(2===spaceType){if(2===obj.spaceType)return obj.name;if(3===obj.spaceType||4===obj.spaceType)return this.getSpace(2,obj.buildingId)}else if(3===spaceType){if(3===obj.spaceType)return obj.name;if(4===obj.spaceType)return this.getSpace(3,obj.floorId)}else if(4===spaceType&&4===obj.spaceType)return obj.name}return"---"},loadFieldDetails:function(){var self=this;if(self.alarm.sourceTypeEnum&&"THRESHOLD_ALARM"===self.alarm.sourceTypeEnum){var url="/field/"+this.alarm.readingFieldId;self.$http.get(url).then((function(response){self.readingField=response.data.field}))}},goToAnalytics:function(){this.$router.replace({path:"/app/em/analytics/reading",query:{alarmId:this.alarm.id}})},Analytics:function(alarmId,datePicker,isWithPrerequsite,ruleId){var buildingId=this.alarm.resource.space.buildingId;this.jumpAlarmToAnalytics(alarmId,datePicker,isWithPrerequsite,ruleId,buildingId)},openEvent:function(id){var url="/app/fa/events/all/summary/"+id;this.$router.replace({path:url})},openAsset:function(id){if(id)if((0,router/* isWebTabsEnabled */.tj)()){var _ref=(0,router/* findRouteForModule */.Jp)("asset",router/* pageTypes */.As.OVERVIEW)||{},name=_ref.name;name&&this.$router.push({name:name,params:{viewname:"all",id:id}})}else{var url="/app/at/assets/all/"+id+"/overview";this.$router.replace({path:url})}},findRoute:function(){if((0,router/* isWebTabsEnabled */.tj)()){var tabType=router/* tabTypes */.VF.CUSTOM,config={type:"portfolio"},route=(0,router/* findRouteForTab */.OD)(tabType,{config:config})||{};return(0,validation/* isEmpty */.xb)(route)?null:this.$router.resolve({name:route.name}).href}return"/app/home/portfolio"},openSite:function(id){if(id){var obj=this.storeGetSpace(id),sid=obj.siteId;if(sid){var parentPath=this.findRoute();if(parentPath){var url="".concat(parentPath,"/site/").concat(sid,"/overview");this.$router.replace({path:url})}}}},openBuilding:function(id){if(id){var obj=this.storeGetSpace(id),sid=obj.siteId,bid=this.storeGetSpace(id).id;if(bid&&sid){var parentPath=this.findRoute();if(parentPath){var url="".concat(parentPath,"/site/").concat(sid,"/building/").concat(bid);this.$router.replace({path:url})}}}},openFloor:function(id){if(id){var obj=this.storeGetSpace(id),sid=obj.siteId,bid=this.storeGetSpace(id).id;if(bid&&sid){var parentPath=this.findRoute();if(parentPath){var url="".concat(parentPath,"/site/").concat(sid,"/floor/").concat(bid);this.$router.replace({path:url})}}}},openSpace:function(id){if(id){var obj=this.storeGetSpace(id),sid=obj.siteId,bid=this.storeGetSpace(id).id;if(bid&&sid){var parentPath=this.findRoute();if(parentPath){var url="".concat(parentPath,"/site/").concat(sid,"/space/").concat(bid);this.$router.replace({path:url})}}}},isActiveAlarm:function(alarm){return"Clear"!==this.getAlarmSeverity(alarm.severity.id).severity},loadEvents:function(alarmId){var self=this,queryObj={alarmId:alarmId};self.eventsLoading=!0,self.$http.post("event/alarm",queryObj).then((function(response){self.eventsLoading=!1,self.events=response.data.events})).catch((function(error){self.eventsLoading=!1}))},loadRelatedAlarms:function(entityId){var self=this,queryObj={entityId:entityId};self.relatedAlarmsLoading=!0,self.$http.post("alarmentity/alarm",queryObj).then((function(response){self.relatedAlarmsLoading=!1,self.relatedalarms=response.data.alarms})).catch((function(error){self.relatedAlarmsLoading=!1}))},assignAlarm:function(alarm,userId,userName){var data={id:[alarm.id],alarm:{assignedTo:{id:userId,name:userName}}};this.assignAlarmApi({data:data,alarm:alarm})},closeSummary:function(){this.summary=!1;var newpath=this.$route.path.substring(0,this.$route.path.indexOf("/newsummary/"));this.$router.push({path:newpath,query:this.$route.query})},deleteAlarmById:function(){var self=this;self.$dialog.confirm({title:"Delete Alarm",message:"Are you sure you want to delete this Alarm?",rbDanger:!0,rbLabel:"Delete"}).then((function(value){if(value){self.deleteAlarm([self.alarm.id]),self.$message({message:"Alarm deleted successfully!",type:"success"});var newpath="/app/fa/faults/unacknowledged/summary/"+self.alarms[0].id;self.$router.replace({path:newpath})}}))},createWO:function(data){var self=this,fields={};data.category&&(fields.category={id:data.category,name:this.getTicketCategory(data.category).name}),data.priority&&(fields.priority={id:data.priority,name:this.getTicketPriority(data.priority)}),data.assignedTo&&(fields.assignedTo=data.assignedTo),data.assignmentGroup&&(fields.assignmentGroup=data.assignmentGroup),self.$store.dispatch("alarm/createWoFromAlarm",{id:this.createWoIds,fields:fields}).then((function(){self.$dialog.notify("Workorder created successfully!"),self.$refs["createWOModel"].close()}))},closeWoDialog:function(){this.$refs["createWOModel"].close()},selectSubSection:function(section){this.subSection=section},alarmstatus:function(status){return 1===status?"":2===status?"Suppressed":3===status?"Cleared":void 0},openWorkorder:function(id){if(!(id>0))return!1;if((0,router/* isWebTabsEnabled */.tj)()){var _ref2=(0,router/* findRouteForModule */.Jp)("workorder",router/* pageTypes */.As.OVERVIEW)||{},name=_ref2.name;name&&this.$router.push({name:name,params:{viewname:"all",id:id}})}else this.$router.push({path:"/app/wo/orders/summary/"+id})},onlyInternalProps:function(additionInfo){for(var key in additionInfo)if(""!==key&&"resourceId"!==key&&"eventStateEnum"!==key&&"internalStateEnum"!==key&&"PUBLISH_TYPE"!==key)return!1;return!0}}),filters:{moment:function(date,format){return moment_default()(date).format(format)},getFollowerUser:function(value,users){if(-1!==value.indexOf("@")){var userObj=users.find((function(user){return user.email===value}));if(userObj)return userObj}return{name:value}},sensorName:function(deviceId,devices){var sensorName;for(var key in devices)devices[key].id===deviceId&&(sensorName=devices[key].name);return sensorName},sensorType:function(deviceId,devices){var sensorType;for(var key in devices)devices[key].id===deviceId&&(sensorType=devices[key].type);return sensorType}}},v1_NewAlarmSummaryvue_type_script_lang_js=NewAlarmSummaryvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(v1_NewAlarmSummaryvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,NewAlarmSummary=component.exports},
/***/773339:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"2ec28172b828295676202641adbd2566.svg";
/***/},
/***/862620:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"99feee13c865562d98860641f93e90d9.svg";
/***/}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/75514.js.map