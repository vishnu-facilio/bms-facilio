"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[21683,71569],{
/***/396289:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return AgentPoints}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/agent/AgentPoints.vue?vue&type=template&id=4b0ab198
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"page-width-cal agent-point-page"},[_c("el-header",{staticClass:"fc-agent-main-header",attrs:{height:"80"}},[_c("div",{staticClass:"flex-middle justify-content-space"},[_c("div",{staticClass:"fc-agent-black-26"},[_vm._v(_vm._s(_vm.$t("agent.agent.points")))]),_c("div",{staticClass:"flex-middle flex-row"},[_c("transition",{attrs:{name:"fade"}},[_vm.isNiagaraAgent?_vm._e():_c("el-button",{staticClass:"fc-agent-add-btn mR20",on:{click:function($event){return _vm.showAddPoint()}}},[_c("i",{staticClass:"el-icon-plus pR5 fwBold"}),_vm._v("Add Points ")])],1),_c("div",{staticClass:"agent-point-search flex-middle"},[_vm.showQuickSearches?_c("div",{staticClass:"row",staticStyle:{"margin-right":"20px"}},[_c("div",{staticClass:"fc-list-search"},[_c("div",{staticClass:"fc-list-search-wrapper fc-list-search-wrapper-reading relative"},[_c("svg",{staticClass:"search-icon3",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 32 32"}},[_c("title",[_vm._v("search")]),_c("path",{attrs:{d:"M21.487 22.927l7.037 7.037c.473.473 1.238.475 1.71.003s.47-1.237-.003-1.71l-7.037-7.037c3.96-4.82 3.675-11.967-.846-16.487C17.539-.076 9.757-.092 4.966 4.699S.191 17.272 5 22.081c4.52 4.52 11.667 4.805 16.487.846zM6.679 6.413c3.848-3.848 10.099-3.836 13.962.027s3.875 10.114.027 13.962c-3.848 3.848-10.099 3.836-13.962-.027S2.831 10.261 6.679 6.413z"}})]),_c("input",{directives:[{name:"model",rawName:"v-model",value:_vm.querySearch,expression:"querySearch"}],ref:"querySearch",staticClass:"quick-search-input6",attrs:{autofocus:"",type:"text",placeholder:"Search"},domProps:{value:_vm.querySearch},on:{keyup:function($event){return!$event.type.indexOf("key")&&_vm._k($event.keyCode,"enter",13,$event.key,"Enter")?null:_vm.quickSearches()},input:function($event){$event.target.composing||(_vm.querySearch=$event.target.value)}}}),_c("svg",{staticClass:"close-icon6",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 32 32","aria-hidden":"true"},on:{click:_vm.closeSearches}},[_c("title",[_vm._v("close")]),_c("path",{attrs:{d:"M17.992 16l8.796-8.796a1.409 1.409 0 0 0-1.992-1.992L16 14.008 7.204 5.212a1.409 1.409 0 0 0-1.992 1.992L14.008 16l-8.796 8.796a1.409 1.409 0 0 0 1.992 1.992L16 17.992l8.796 8.796a1.409 1.409 0 0 0 1.992-1.992L17.992 16z"}})])])])]):_vm._e(),_c("el-tooltip",{attrs:{effect:"dark",content:_vm.$t("common._common.search"),placement:"left"}},[_vm.$validation.isEmpty(_vm.points)?_vm._e():_c("AdvancedSearch",{key:"point-search",attrs:{moduleName:_vm.getPointModuleName,moduleDisplayName:"Point"}})],1),_c("span",{staticClass:"separator"},[_vm._v("|")]),_c("pagination",{ref:"f-page",attrs:{total:_vm.listCount,perPage:_vm.perPage}}),_vm.listCount?_c("span",{staticClass:"separator"},[_vm._v("|")]):_vm._e(),_c("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{arrow:!0,arrowType:"round",animation:"fade"},expression:"{ arrow: true, arrowType: 'round', animation: 'fade' }"}],staticClass:"flex-middle",attrs:{content:"Refresh"},on:{click:_vm.listRefresh}},[_c("i",{staticClass:"el-icon-refresh fwBold f16"})])],1),_c("div"),_vm.showDialog?_c("agent-point-form",{attrs:{isNew:_vm.isNew,visibility:_vm.showDialog},on:{"update:visibility":function($event){_vm.showDialog=$event}}}):_vm._e()],1)])]),_c("div",[_c("FTags",{key:_vm.getPointModuleName,attrs:{moduleName:_vm.getPointModuleName}})],1),_c("div",{staticClass:"flex-middle mL15 justify-content-space mR20"},[_c("div",{staticClass:"flex-middle flex-no-wrap width100 position-relative pT10"},[_c("div",[_c("SelectAgent",{on:{onAgentFilter:_vm.updateAgentId}})],1),_c("div",{staticClass:"mL20"},[_c("div",{staticClass:"f12 fc-pink pB5 bold"},[_vm._v("Protocol")]),_c("el-select",{staticClass:"fc-input-full-border-select2",attrs:{filterable:"",placeholder:"Select Controller Type"},on:{change:_vm.onTypeChange},model:{value:_vm.selectedType,callback:function($$v){_vm.selectedType=$$v},expression:"selectedType"}},[_vm._l(_vm.$constants.ControllerTypes,(function(label,value){return[_vm.availableTypes.includes(parseInt(value))?_c("el-option",{key:value,attrs:{label:label,value:parseInt(value)}}):_vm._e()]}))],2)],1),null!=_vm.lookupModuleName?_c("div",{staticClass:"mL20"},[_c("div",{staticClass:"f12 fc-pink pB5 bold"},[_vm._v("Controller")]),_c("FLookupFieldWrapper",{key:_vm.lookupModuleName,staticClass:"width250px",attrs:{field:{lookupModule:{name:_vm.lookupModuleName},multiple:!0},filterConstruction:_vm.constructAgentFilter,hideLookupIcon:!1,disabled:!1},on:{recordSelected:_vm.onControllerDevice},model:{value:_vm.selectedControllerIds,callback:function($$v){_vm.selectedControllerIds=$$v},expression:"selectedControllerIds"}})],1):_vm._e(),!_vm.isMeterLicenseEnabled||"commissioned"!==_vm.agentPointsTab&&"subscribes"!==_vm.agentPointsTab?_vm._e():_c("div",{staticClass:"mL20"},[_c("div",{staticClass:"f12 fc-pink pB5 bold"},[_vm._v("Scope")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{placeholder:"Select Scope",filterable:""},on:{change:function($event){return _vm.getPoints()}},model:{value:_vm.selectedScope,callback:function($$v){_vm.selectedScope=$$v},expression:"selectedScope"}},_vm._l(_vm.scopeList,(function(readingScope){return _c("el-option",{key:readingScope.value,attrs:{label:readingScope.label,value:readingScope.value}})})),1)],1),_c("div",{staticClass:"mL20 flex-middle pT20"},[_c("div",{staticClass:"cmd-btn"},["unconfigured"!==this.agentPointsTab||1!==_vm.agentType&&2!=_vm.agentType&&9!=_vm.agentType?_vm._e():_c("div",[_c("el-dropdown",{staticClass:"adv-configure",attrs:{disabled:_vm.configureDisabled,"split-button":"",trigger:"click",loading:_vm.configuring},on:{click:_vm.configureInterval,command:_vm.configureAll},scopedSlots:_vm._u([{key:"dropdown",fn:function(){return[_c("el-dropdown-menu",[_c("el-tooltip",{attrs:{disabled:_vm.showConfigureAllPointsTooltip,content:"Apply filter",placement:"bottom"}},[_c("span",[_c("el-dropdown-item",{attrs:{disabled:!_vm.allowConfigureAllPoints,command:"all"}},[_vm._v(" Configure All Points ("+_vm._s(_vm.configurePointsCount)+") ")])],1)])],1)]},proxy:!0}],null,!1,3615612886)},[_vm._v(" "+_vm._s(_vm.configuring?"Configuring..":"CONFIGURE")+" ")])],1),"configured"===this.agentPointsTab&&(!1!==this.isNiagaraAgent||5!=this.selectedType&&4!=this.selectedType)?_c("el-button",{staticClass:"fc-white-btn",attrs:{disabled:_vm.configureDisabled,type:"button",loading:_vm.unconfiguring},on:{click:_vm.unConfigurePoint}},[_vm._v(_vm._s(_vm.unconfiguring?"Unconfiguring..":"UNCONFIGURE"))]):_vm._e(),"unconfigured"===_vm.agentPointsTab&&(!0===this.isNiagaraAgent||3!=this.selectedType&&4!=this.selectedType&&5!=this.selectedType&&!1===this.isNiagaraAgent)?_c("el-button",{staticClass:"fc-white-btn",attrs:{disabled:_vm.configureDisabled,type:"button",loading:_vm.subscribing},on:{click:_vm.onSubscribeClicked}},[_vm._v(_vm._s(_vm.subscribing?"Subscribing..":"SUBSCRIBE")+" ")]):_vm._e(),"subscribed"===this.agentPointsTab?_c("el-button",{staticClass:"fc-white-btn",attrs:{disabled:_vm.configureDisabled,type:"button",loading:_vm.unsubscribing},on:{click:_vm.unSubscribed}},[_vm._v(_vm._s(_vm.unsubscribing?"Unsubscribing..":"UNSUBSCRIBE")+" ")]):_vm._e()],1),_c("el-dropdown",{staticClass:"mL10 fc-btn-ico-lg pointer",staticStyle:{padding:"2px 10px 3px"},attrs:{disabled:_vm.$validation.isEmpty(_vm.points)},on:{command:function($event){return _vm.exportPoints($event)}}},[_c("span",{staticClass:"el-dropdown-link"},[_c("inline-svg",{attrs:{src:"svgs/new-download",iconClass:"icon export-icon icon-sm-md"}})],1),_c("el-dropdown-menu",{staticClass:"controller-dropdown-item",attrs:{slot:"dropdown"},slot:"dropdown"},[_c("el-dropdown-item",{attrs:{command:"1"}},[_vm._v(_vm._s(_vm.$t("common.wo_report.export_csv")))]),_c("el-dropdown-item",{attrs:{command:"2"}},[_vm._v(_vm._s(_vm.$t("common.wo_report.export_xcl")))])],1)],1)],1)])]),_c("div",{staticClass:"white-bg mL20 mR20 mT10"},[_c("el-tabs",{staticClass:"agent-tabs",on:{"tab-click":function($event){return _vm.tabSwitch()}},model:{value:_vm.agentPointsTab,callback:function($$v){_vm.agentPointsTab=$$v},expression:"agentPointsTab"}},_vm._l(_vm.tabs,(function(tab){return _c("el-tab-pane",{key:tab.key,attrs:{label:tab.label,name:tab.key}},[_vm.loading?_c("div",{staticClass:"flex-middle fc-empty-white m10 fc-agent-empty-state fc-agent-empty-state-points"},[_c("spinner",{attrs:{show:_vm.loading,size:"80"}})],1):_vm._e(),_vm.$validation.isEmpty(_vm.points)&&!_vm.loading?_c("div",{staticClass:"height100vh fc-empty-white flex-middle justify-content-center flex-direction-column fc-agent-table m10 fc-agent-empty-state fc-agent-empty-state-points"},[_c("inline-svg",{attrs:{src:"svgs/list-empty",iconClass:"icon text-center icon-xxxxlg"}}),_c("div",{staticClass:"q-item-label nowo-label"},[_vm._v(" "+_vm._s(_vm.$t("agent.empty.no_points"))+" ")])],1):_vm._e(),_vm.loading||_vm.$validation.isEmpty(_vm.points)?_vm._e():_c("div",{staticClass:"fc-agent-table scrollbar-style fc-list-table-container",class:_vm.pointsTableHeight()},[_c("el-table",{ref:"multipleSelection",refInFor:!0,staticClass:"fc-list-view height100vh fc-table-td-height fc-table-viewchooser pB100 fc-table-th-pLalign-reduce",staticStyle:{width:"100%"},attrs:{data:_vm.points,height:"auto"},on:{"selection-change":_vm.selectPoint}},[_c("el-table-column",{attrs:{type:"selection",width:"75",fixed:"left"}}),_c("el-table-column",{attrs:{label:"Name",width:"280",fixed:"left"},scopedSlots:_vm._u([{key:"default",fn:function(point){return[_vm.isNiagaraAgent&&point.row.displayName?_c("div",{staticClass:"bold"},[_vm._v(" "+_vm._s(point.row.displayName)+" ")]):_c("div",{staticClass:"bold"},[_vm._v(" "+_vm._s(point.row.name)+" ")])]}}],null,!0)}),_c("el-table-column",{attrs:{label:"controller",width:"200"},scopedSlots:_vm._u([{key:"default",fn:function(point){return[_vm._v(" "+_vm._s(point.row.deviceName)+" ")]}}],null,!0)}),1===_vm.selectedType&&1===_vm.agentType&&"commissioned"!=_vm.agentPointsTab?_c("el-table-column",{attrs:{label:"description",width:"300"},scopedSlots:_vm._u([{key:"default",fn:function(point){return[_vm._v(_vm._s(point.row.description))]}}],null,!0)}):_vm._e(),1!==_vm.selectedType||1!==_vm.agentType&&2!==_vm.agentType||"commissioned"==_vm.agentPointsTab?_vm._e():_c("el-table-column",{attrs:{label:"actual Unit",width:"200"},scopedSlots:_vm._u([{key:"default",fn:function(point){return[_vm._v(_vm._s(point.row.actualUnit))]}}],null,!0)}),2===_vm.agentType?_c("el-table-column",{attrs:{label:"Link Name",width:"200"},scopedSlots:_vm._u([{key:"default",fn:function(point){return[_vm._v(_vm._s(point.row.name))]}}],null,!0)}):_vm._e(),1===_vm.selectedType?_c("el-table-column",{attrs:{label:"Instance",width:"200"},scopedSlots:_vm._u([{key:"default",fn:function(point){return[_vm._v(_vm._s(point.row.instanceNumber))]}}],null,!0)}):_vm._e(),4===_vm.selectedType||5===_vm.selectedType?_c("el-table-column",{attrs:{label:"register Type",width:"200"},scopedSlots:_vm._u([{key:"default",fn:function(point){return[_vm._v(_vm._s(_vm.$constants.AgentModbusRegisterType[point.row.registerType]))]}}],null,!0)}):_vm._e(),4===_vm.selectedType||5===_vm.selectedType?_c("el-table-column",{attrs:{label:"register Number",width:"200"},scopedSlots:_vm._u([{key:"default",fn:function(point){return[_vm._v(_vm._s(point.row.registerNumber))]}}],null,!0)}):_vm._e(),1===_vm.selectedType?_c("el-table-column",{attrs:{label:"instance Type",width:"200"},scopedSlots:_vm._u([{key:"default",fn:function(point){return[_vm._v(_vm._s(_vm.$constants.AgentInstancePoint[point.row.instanceType]))]}}],null,!0)}):_vm._e(),14===_vm.selectedType?_c("el-table-column",{attrs:{label:"Group Name",width:"200"},scopedSlots:_vm._u([{key:"default",fn:function(point){return[_vm._v(_vm._s(point.row.groupName))]}}],null,!0)}):_vm._e(),14===_vm.selectedType?_c("el-table-column",{attrs:{label:"Prop Name",width:"200"},scopedSlots:_vm._u([{key:"default",fn:function(point){return[_vm._v(_vm._s(point.row.propName))]}}],null,!0)}):_vm._e(),6===_vm.selectedType?_c("el-table-column",{attrs:{label:"path",width:"250"},scopedSlots:_vm._u([{key:"default",fn:function(point){return[_vm._v(_vm._s(point.row.path))]}}],null,!0)}):_vm._e(),1!==_vm.agentType||"configured"!==_vm.agentPointsTab&&"commissioned"!==_vm.agentPointsTab?_vm._e():_c("el-table-column",{attrs:{label:"Interval",width:"200"},scopedSlots:_vm._u([{key:"default",fn:function(point){return[_c("el-tooltip",{attrs:{content:_vm.selectedAgentInterval(),placement:"bottom",disabled:_vm.isAgentInterval(point.row)}},[_c("span",[_vm._v(" "+_vm._s(point.row.interval>0?point.row.interval+" mins":"Agent interval")+" ")])])]}}],null,!0)}),"commissioned"===_vm.agentPointsTab?_c("el-table-column",{attrs:{label:_vm.$constants.ReadingScope[_vm.selectedScope]["typeLabel"],width:"200"},scopedSlots:_vm._u([{key:"default",fn:function(point){return[_vm._v(" "+_vm._s(_vm.getCategory(point.row))+" ")]}}],null,!0)}):_vm._e(),"commissioned"===_vm.agentPointsTab?_c("el-table-column",{attrs:{label:_vm.$constants.ReadingScope[_vm.selectedScope]["scopeLabel"],width:"200"},scopedSlots:_vm._u([{key:"default",fn:function(point){return[_vm._v(" "+_vm._s(_vm.getAsset(point.row))+" ")]}}],null,!0)}):_vm._e(),"commissioned"===_vm.agentPointsTab?_c("el-table-column",{attrs:{label:"Reading",width:"200"},scopedSlots:_vm._u([{key:"default",fn:function(point){return[_vm._v(" "+_vm._s(_vm.getReading(point))+" ")]}}],null,!0)}):_vm._e(),"commissioned"===_vm.agentPointsTab?_c("el-table-column",{attrs:{label:"Unit",width:"200"},scopedSlots:_vm._u([{key:"default",fn:function(point){return[_vm._v(" "+_vm._s(_vm.getUnit(point))+" ")]}}],null,!0)}):_vm._e(),_c("el-table-column",{attrs:{label:"created Time",width:"200"},scopedSlots:_vm._u([{key:"default",fn:function(point){return[_vm._v(" "+_vm._s(_vm._f("formatDate")(point.row.createdTime,!0))+" ")]}}],null,!0)}),"commissioned"===_vm.agentPointsTab?_c("el-table-column",{attrs:{label:"Mapped Time",width:"200"},scopedSlots:_vm._u([{key:"default",fn:function(point){return[_vm.$validation.isEmpty(point.row.mappedTime)?_vm._e():_c("span",[_vm._v(" "+_vm._s(_vm._f("formatDate")(point.row.mappedTime))+" ")])]}}],null,!0)}):_vm._e(),"unconfigured"!=_vm.agentPointsTab?_c("el-table-column",{attrs:{label:"Last Recorded Time",width:"200"},scopedSlots:_vm._u([{key:"default",fn:function(point){return[_c("el-tooltip",{attrs:{effect:"dark",content:_vm.getLastRecordedTime(point),placement:"bottom"}},[_vm.$validation.isEmpty(point.row.lastRecordedTime)?_vm._e():_c("span",[_vm._v(" "+_vm._s(_vm._f("fromNow")(point.row.lastRecordedTime))+" ")])])]}}],null,!0)}):_vm._e(),"unconfigured"!=_vm.agentPointsTab?_c("el-table-column",{attrs:{label:"Last Recorded value",width:"200"},scopedSlots:_vm._u([{key:"default",fn:function(point){return[_vm._v(" "+_vm._s(point.row.lastRecordedValue))]}}],null,!0)}):_vm._e(),_c("el-table-column",{attrs:{label:"writable",width:"200"},scopedSlots:_vm._u([{key:"default",fn:function(point){return[_c("el-switch",{attrs:{disabled:"unconfigured"==_vm.agentPointsTab,"active-color":"rgba(57, 178, 194, 0.8)","inactive-color":"#df5d5d"},on:{change:function($event){return _vm.toggleWritable(point.row,point.row.writable)}},model:{value:point.row.writable,callback:function($$v){_vm.$set(point.row,"writable",$$v)},expression:"point.row.writable"}})]}}],null,!0)}),1!=_vm.selectedType||1!=_vm.agentType&&2!=_vm.agentType?_vm._e():_c("el-table-column",{staticClass:"visibility-visible-actions",attrs:{width:"100"},scopedSlots:_vm._u([{key:"default",fn:function(point){return[_c("div",{staticClass:"visibility-hide-actions text-right mR30"},[_c("el-dropdown",{on:{command:function($event){return _vm.onOptionsSelect($event,point.row)}}},[_c("span",{staticClass:"el-dropdown-link"},[_c("i",{staticClass:"el-icon-more controller-more"})]),_c("el-dropdown-menu",{staticClass:"controller-dropdown-item",attrs:{slot:"dropdown"},slot:"dropdown"},[_c("el-dropdown-item",{attrs:{command:"properties"}},[_vm._v(_vm._s(_vm.$t("agent.agent.properties")))])],1)],1)],1)]}}],null,!0)})],1)],1)])})),1)],1),_c("div",{staticClass:"help-icon-position pointer",on:{click:function($event){return _vm.helpDialogOpen()}}},[_c("inline-svg",{staticClass:"vertical-middle",attrs:{src:"svgs/question",iconClass:"icon icon-xxlll"}})],1),_vm.showHelpDialog?_c("agent-help",{attrs:{visibility:_vm.showHelpDialog},on:{"update:visibility":function($event){_vm.showHelpDialog=$event}}}):_vm._e(),_vm.showThresholdDialog?_c("f-dialog",{attrs:{visible:_vm.showThresholdDialog,title:"Set Threshold Values",width:"40%",maxHeight:"500px",customClass:"threshold-value-dialog",confirmTitle:"Subscribe",stayOnSave:!0},on:{"update:visible":function($event){_vm.showThresholdDialog=$event},save:_vm.subscribed}},[_c("div",{staticClass:"pT10 pB10"},[_c("el-row",{staticClass:"pB20 threshold-value-item",attrs:{gutter:10}},[_c("el-col",{attrs:{span:10}},[_vm._v("Name")]),_c("el-col",{attrs:{span:10}},[_vm._v("Threshold")])],1),_vm._l(_vm.selectedInstances.filter((function(inst){return 4!=inst.dataType&&8!=inst.dataType})),(function(instance){return _c("el-row",{key:instance.id,staticClass:"pB20 threshold-value-item",attrs:{gutter:10}},[_c("el-col",{attrs:{span:10}},[_vm._v(_vm._s(instance.name))]),_c("el-col",{attrs:{span:10}},[_c("el-input",{staticClass:"el-input-textbox-full-border",attrs:{type:"number",min:5},model:{value:instance.threshold,callback:function($$v){_vm.$set(instance,"threshold",$$v)},expression:"instance.threshold"}},[_c("template",{slot:"append"},[_vm._v("(%)")])],2)],1)],1)}))],2)]):_vm._e(),_c("div",[_c("el-dialog",{staticClass:"fc-dialog-center-container",staticStyle:{"z-index":"999999"},attrs:{title:_vm.$t("agent.agent.set_interval"),visible:_vm.intervalDialog,width:"30%","append-to-body":!0,"before-close":_vm.closeIntervalDialog},on:{"update:visible":function($event){_vm.intervalDialog=$event}}},[_c("div",{staticClass:"height150"},[_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{placeholder:"Select"},model:{value:_vm.interval,callback:function($$v){_vm.interval=$$v},expression:"interval"}},_vm._l(_vm.intervalTiming,(function(interval){return _c("el-option",{key:interval.value,attrs:{label:interval.label,value:interval.value}})})),1)],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel f13",on:{click:_vm.closeIntervalDialog}},[_vm._v(_vm._s(_vm.$t("agent.agent.cancel")))]),_c("el-button",{staticClass:"modal-btn-save f13",on:{click:function($event){return _vm.configurePoints(_vm.interval)}}},[_vm._v(_vm._s(_vm.$t("agent.agent.set_interval")))])],1)])],1),_c("div",[_c("el-dialog",{staticClass:"agents-dialog fc-dialog-center-container",staticStyle:{"z-index":"9999999999"},attrs:{title:"Properties",visible:_vm.showProperties,width:"40%","append-to-body":!0},on:{"update:visible":function($event){_vm.showProperties=$event}}},[_c("div",{staticClass:"label-txt-black line-height24"},[_vm.$validation.isEmpty(_vm.pointProps)?_c("div",[_c("div",{staticClass:"bold "},[_vm._v("No Properties")])]):_c("div",[_c("div",{staticClass:"fc-json-view bold "},[_vm._v("States :")]),_vm._l(_vm.pointProps,(function(label,value){return _c("div",{key:value,staticClass:"fc-json-view mL50"},[_vm._v(" "+_vm._s(label)+" ")])}))],2)])])],1),_vm.exportUrl?_c("iframe",{staticStyle:{display:"none"},attrs:{src:_vm.exportUrl}}):_vm._e()],1)},staticRenderFns=[],esm_typeof=__webpack_require__(103336),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),objectSpread2=__webpack_require__(595082),FDialogNew=(__webpack_require__(450886),__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(564043),__webpack_require__(61514),__webpack_require__(169358),__webpack_require__(857267),__webpack_require__(947522),__webpack_require__(670560),__webpack_require__(648324),__webpack_require__(821057),__webpack_require__(634338),__webpack_require__(434284),__webpack_require__(436756)),FPagination=__webpack_require__(929593),HelpPointsvue_type_template_id_05606c32_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("el-dialog",{staticStyle:{"z-index":"999999"},attrs:{visible:_vm.visibility,fullscreen:!0,"append-to-body":!0,"custom-class":"fc-dialog-form fc-dialog-right setup-dialog25 setup-dialog","before-close":_vm.closeDialog},on:{"update:visible":function($event){_vm.visibility=$event}}},[_c("div",{staticClass:"new-header-container"},[_c("div",{staticClass:"new-header-text"},[_c("div",{staticClass:"fc-setup-modal-title"},[_vm._v("Agent points helper")])])]),_c("div",{staticClass:"new-body-modal pT0 pL0 pR0 mT0"},[_c("el-collapse",{staticClass:"fc-agent-collapse fc-pushing-data-collapse",attrs:{accordion:""},model:{value:_vm.activeNames,callback:function($$v){_vm.activeNames=$$v},expression:"activeNames"}},[_c("el-collapse-item",{attrs:{title:"Discover",name:"1"}},[_c("div",{staticClass:"fc-black-14 text-left line-height25 break-word"},[_vm._v(" Discover action is used to discover the points in the selected controller(s). This action currently supports only BACNet IP, OPC XML/DA and OPC UA protocols in Facilio Agent. ")])]),_c("el-collapse-item",{attrs:{title:"Configure",name:"2"}},[_c("div",{staticClass:"fc-black-14 text-left line-height25 break-word"},[_vm._v(" This action is used to configure the points in which we are interested. These values of these points are collected at the configured interval of the agent and published to the cloud. ")])]),_c("el-collapse-item",{attrs:{title:"Unconfigure",name:"3"}},[_c("div",{staticClass:"fc-black-14 text-left line-height25 break-word"},[_vm._v(" This action is used to unconfigure the points for which we no longer need the values. ")])]),_c("el-collapse-item",{attrs:{title:"Add Points",name:"4"}},[_c("div",{staticClass:"fc-black-14 text-left line-height25 break-word"},[_vm._v(" This action is used to add points to the agent for the protocols for which the discovery is not possible. Currently we add points for Modbus protocols in Facilio Agent. ")])])],1)],1)])],1)},HelpPointsvue_type_template_id_05606c32_staticRenderFns=[],HelpPointsvue_type_script_lang_js={props:["visibility"],data:function(){return{activeNames:["1"]}},methods:{closeDialog:function(){this.$emit("update:visibility",!1)}}},AgentHelperDocs_HelpPointsvue_type_script_lang_js=HelpPointsvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(AgentHelperDocs_HelpPointsvue_type_script_lang_js,HelpPointsvue_type_template_id_05606c32_render,HelpPointsvue_type_template_id_05606c32_staticRenderFns,!1,null,null,null)
/* harmony default export */,HelpPoints=component.exports,AgentAddPointFormvue_type_template_id_2951a264_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("el-dialog",{staticStyle:{"z-index":"999999"},attrs:{visible:_vm.visibility,fullscreen:!0,"append-to-body":!0,"custom-class":"fc-dialog-form fc-dialog-right setup-dialog40 setup-dialog","before-close":_vm.closeDialog},on:{"update:visible":function($event){_vm.visibility=$event}}},[_c("el-form",{ref:"agentPointForm",staticClass:"fc-form",attrs:{model:_vm.newPoints,"label-position":"top","label-width":"120px"}},[_c("div",{staticClass:"new-header-container"},[_c("div",{staticClass:"new-header-text"},[_c("div",{staticClass:"fc-setup-modal-title"},[_vm._v(" New Point ")])])]),_c("div",{staticClass:"new-body-modal"},[_c("div",{staticClass:"setup-input-block pB10"},[_c("el-row",[_c("el-col",{attrs:{span:12}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v(" Agent ")]),_c("el-form-item",[_c("el-select",{staticClass:"width100",attrs:{prop:"agents",filterable:"",placeholder:"Select Agent"},on:{change:function($event){return _vm.updateSelectedType()}},model:{value:_vm.selectedAgentId,callback:function($$v){_vm.selectedAgentId=$$v},expression:"selectedAgentId"}},_vm._l(this.agentFilter,(function(agent,index){return _c("el-option",{key:index,attrs:{label:agent.displayName||agent.name,value:agent.id,"no-data-text":"No Agent available",clearable:""}})})),1)],1)],1)],1)],1),_c("div",{staticClass:"setup-input-block pB10"},[_c("el-row",[_c("el-col",{attrs:{span:12}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v(" Type ")]),_c("el-form-item",[_c("el-select",{staticClass:"width100",attrs:{prop:"selectedType",filterable:"",required:!0,placeholder:"Select Controller Type"},on:{change:function($event){return _vm.changeControllerType()}},model:{value:_vm.selectedType,callback:function($$v){_vm.selectedType=$$v},expression:"selectedType"}},[_c("el-option",{key:"Modbus Ip",attrs:{label:"Modbus Ip",value:"4"}}),_c("el-option",{key:"Modbus Rtu",attrs:{label:"Modbus Rtu",value:"5"}})],1)],1)],1)],1)],1),null!=_vm.lookupModuleName&&null!=_vm.selectedType?_c("div",{staticClass:"setup-input-block pB10"},[_c("el-row",[_c("el-col",{attrs:{span:12}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v("Controller")]),_c("FLookupFieldWrapper",{key:_vm.lookupModuleName,attrs:{field:{lookupModule:{name:_vm.lookupModuleName},multiple:!1},filterConstruction:_vm.constructAgentFilter,hideLookupIcon:!1,disabled:!1},model:{value:_vm.newPoints.controllerId,callback:function($$v){_vm.$set(_vm.newPoints,"controllerId",$$v)},expression:"newPoints.controllerId"}})],1)],1)],1):_vm._e(),_c("div",{staticClass:"setup-input-block pB10"},[_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v("Name")]),_c("el-form-item",{attrs:{prop:"name"}},[_c("el-input",{staticClass:"fc-input-txt width100",attrs:{placeholder:"Enter the Name",req:""},model:{value:_vm.newPoints.name,callback:function($$v){_vm.$set(_vm.newPoints,"name",$$v)},expression:"newPoints.name"}})],1)],1)],1)],1),_c("div",{staticClass:"setup-input-block pB10"},[_c("el-row",[_c("el-col",{attrs:{span:12}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v("Register Type")]),_c("el-form-item",{attrs:{prop:"function"}},[_c("el-select",{staticClass:"width100",attrs:{filterable:"",required:!0,placeholder:"Select Register type"},model:{value:_vm.newPoints.registerType,callback:function($$v){_vm.$set(_vm.newPoints,"registerType",$$v)},expression:"newPoints.registerType"}},_vm._l(_vm.registerType,(function(type,index){return _c("el-option",{key:index,attrs:{label:type.label,value:type.value}})})),1)],1)],1)],1)],1),_vm.$validation.isEmpty(_vm.newPoints.registerType)?_vm._e():_c("div",{staticClass:"setup-input-block pB10"},[_c("el-row",[_c("el-col",{attrs:{span:12}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v("Modbus DataType")]),_c("el-form-item",{attrs:{prop:"datatype"}},[_c("el-select",{staticClass:"width100",attrs:{required:!0,placeholder:"Select the modbus"},model:{value:_vm.newPoints.dataType,callback:function($$v){_vm.$set(_vm.newPoints,"dataType",$$v)},expression:"newPoints.dataType"}},[1==this.newPoints.registerType||2==this.newPoints.registerType?_c("div",[_c("el-option",{key:"BINARY",attrs:{label:"BINARY",value:"1"}})],1):_c("div",_vm._l(_vm.modbusDataTypes,(function(type,index){return _c("el-option",{key:index,attrs:{label:type.label,value:type.value}})})),1)])],1)],1)],1)],1),_c("div",{staticClass:"setup-input-block pB10"},[_c("el-row",[_c("el-col",{attrs:{span:12}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v("Register Number")]),_c("el-form-item",{attrs:{prop:"registerNumber"}},[_c("el-input",{staticClass:"fc-input-txt width100",attrs:{placeholder:"Enter register number"},model:{value:_vm.newPoints.registerNumber,callback:function($$v){_vm.$set(_vm.newPoints,"registerNumber",$$v)},expression:"newPoints.registerNumber"}})],1)],1)],1)],1),_c("div",{staticClass:"setup-input-block pB10"},[_c("el-row",[_c("el-col",{attrs:{span:12}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v("Interval")]),_c("el-form-item",{attrs:{prop:"function"}},[_c("el-select",{staticClass:"width100",attrs:{filterable:"",required:!0,placeholder:"Select point interval"},model:{value:_vm.newPoints.interval,callback:function($$v){_vm.$set(_vm.newPoints,"interval",$$v)},expression:"newPoints.interval"}},_vm._l(_vm.intervalTiming,(function(type,index){return _c("el-option",{key:index,attrs:{label:type.label,value:type.value}})})),1)],1)],1)],1)],1)]),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){return _vm.closeDialog()}}},[_vm._v("CANCEL")]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.saving},on:{click:function($event){return _vm.submitForm("agentForm")}}},[_vm._v(_vm._s(_vm.saving?"Saving...":"SAVE"))])],1)])],1)],1)},AgentAddPointFormvue_type_template_id_2951a264_staticRenderFns=[],vuex_esm=__webpack_require__(420629),constant=__webpack_require__(354754),FLookupFieldWrapper=__webpack_require__(201117),AgentAddPointFormvue_type_script_lang_js={data:function(){return{saving:!1,agents:[],selectedType:null,selectedAgentId:null,newPoints:{name:"",controllerType:"",registerType:"",registerNumber:"",modbusDataType:"",controllerId:"",interval:0},registerType:[{value:1,label:"Coils Status"},{value:2,label:"Inputs Status"},{value:3,label:"Holding Register"},{value:4,label:"Input Register"}],modbusDataTypes:[{value:2,label:"TWO_BYTE_INT_UNSIGNED"},{value:3,label:"TWO_BYTE_INT_SIGNED"},{value:4,label:"FOUR_BYTE_INT_UNSIGNED"},{value:5,label:"FOUR_BYTE_INT_SIGNED"},{value:6,label:"FOUR_BYTE_INT_UNSIGNED_SWAPPED"},{value:7,label:"FOUR_BYTE_INT_SIGNED_SWAPPED"},{value:10,label:"EIGHT_BYTE_INT_UNSIGNED"},{value:11,label:"EIGHT_BYTE_INT_SIGNED"},{value:12,label:"EIGHT_BYTE_INT_UNSIGNED_SWAPPED"},{value:13,label:"EIGHT_BYTE_INT_SIGNED_SWAPPED"},{value:14,label:"EIGHT_BYTE_FLOAT"},{value:15,label:"EIGHT_BYTE_FLOAT_SWAPPED"},{value:16,label:"TWO_BYTE_BCD"},{value:17,label:"FOUR_BYTE_BCD"},{value:20,label:"FOUR_BYTE_BCD_SWAPPED"},{value:22,label:"TWO_BYTE_INT_UNSIGNED_SWAPPED"},{value:23,label:"TWO_BYTE_INT_SIGNED_SWAPPED"},{value:24,label:"FOUR_BYTE_INT_UNSIGNED_SWAPPED_SWAPPED"},{value:25,label:"FOUR_BYTE_INT_SIGNED_SWAPPED_SWAPPED"}],intervalTiming:[{value:0,label:"Agent interval"},{value:2,label:"2 Mins"},{value:5,label:"5 Mins"},{value:10,label:"10 Mins"},{value:15,label:"15 Mins"}],lookupModuleName:null}},mounted:function(){this.loadAgents()},components:{FLookupFieldWrapper:FLookupFieldWrapper/* default */.Z},props:["visibility","isNew","model"],computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({sites:function(state){return state.site}})),{},{agentFilter:function(){return this.agents.filter((function(agent){return 1===agent.agentType}))}}),methods:{closeDialog:function(){this.$emit("update:visibility",!1)},cancel:function(){this.$emit("canceled")},resetForm:function(){this.$refs["agentPointForm"].resetFields()},modbusData:function(){},submitForm:function(){var _this=this;this.saving=!0;var pointDataPayload={name:this.newPoints.name,controllerType:parseInt(this.selectedType),agentId:parseInt(this.selectedAgentId),modbusDataType:parseInt(this.newPoints.dataType),registerType:parseInt(this.newPoints.registerType),registerNumber:parseInt(this.newPoints.registerNumber),controllerId:parseInt(this.newPoints.controllerId),interval:parseInt(this.newPoints.interval)};this.isNew&&this.$http.post("/v2/modbus/addPoint",pointDataPayload).then((function(response){200===response.status&&(_this.$message("Modbus Point will be added in a while."),_this.saving=!1,_this.resetForm(),_this.$emit("saved"),_this.$emit("update:visibility",!1))}))},loadAgents:function(){var _this2=this;this.loading=!0,this.$http.get("/v2/agent/getFilter").then((function(response){_this2.loading=!1,_this2.agents=response.data.result&&response.data.result.data?response.data.result.data:[]})).catch((function(){_this2.agents=[],_this2.loading=!1}))},changeControllerType:function(){var newPoints=this.newPoints;newPoints.controllerId=null,this.lookupModuleName=constant/* default */.Z.ControllerModuleName[this.selectedType]},updateSelectedType:function(){this.selectedType=null},constructAgentFilter:function(){return{agentId:{operatorId:9,value:["".concat(this.selectedAgentId)]}}}}},components_AgentAddPointFormvue_type_script_lang_js=AgentAddPointFormvue_type_script_lang_js,AgentAddPointForm_component=(0,componentNormalizer/* default */.Z)(components_AgentAddPointFormvue_type_script_lang_js,AgentAddPointFormvue_type_template_id_2951a264_render,AgentAddPointFormvue_type_template_id_2951a264_staticRenderFns,!1,null,null,null)
/* harmony default export */,AgentAddPointForm=AgentAddPointForm_component.exports,AgentMixin=(__webpack_require__(199029),__webpack_require__(405921)),AdvancedSearch=__webpack_require__(784823),FTags=__webpack_require__(775676),validation=__webpack_require__(990260),filters=__webpack_require__(273861),SelectAgent=__webpack_require__(505572),api=__webpack_require__(32284),AgentPointsvue_type_script_lang_js={title:function(){return"Agent Points"},data:function(){return{points:[],loading:!1,agentPointsTab:null,selectedAgent:null,resourceMap:[],fieldMap:[],unitMap:[],tabs:[{key:"unconfigured",label:"Unconfigured"},{key:"configured",label:"Configured"},{key:"commissioned",label:"Commissioned"},{key:"subscribed",label:"Subscribed"}],listCount:null,agent:null,selectedAgentId:null,selectedType:null,controllers:[],controller:null,selectedControllerIds:[],selectedPoint:[],realPoints:[],showHelpDialog:!1,selectedPoints:[],allPointsSelected:!1,perPage:50,showDialog:!1,isNew:!0,pointDisabled:!1,querySearch:null,showThresholdDialog:!1,logical:!1,discovering:!1,configuring:!1,unconfiguring:!1,subscribing:!1,unsubscribing:!1,options:[{value:5,label:"Greater than"},{value:6,label:"Less than"},{value:7,label:"Greater than or equals"},{value:8,label:"Less than or equals"},{value:9,label:"Equals"},{value:10,label:"Precentage"}],intervalTiming:[{value:0,label:"Agent interval"},{value:2,label:"2 Mins"},{value:5,label:"5 Mins"},{value:10,label:"10 Mins"},{value:15,label:"15 Mins"}],interval:0,configureWithCriteria:!1,configureWithControllerIds:!1,value:-1,canSubscribe:!1,showQuickSearches:!1,isNiagaraAgent:!1,intervalDialog:!1,lookupModuleName:null,exportUrl:null,showProperties:!1,pointProps:{},scopeList:[{value:1,label:"Asset"},{value:3,label:"Meter"}],selectedScope:1,isMeterLicenseEnabled:!1}},mixins:[AgentMixin/* default */.Z],computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapGetters */.Se)(["getAssetCategory","getMeterUtility"])),{},{configurePointsCount:function(){return Math.min(this.listCount,5e3)},availableTypes:function(){return this.controllers&&this.controllers.map((function(controller){return controller.controllerType}))},getPointModuleName:function(){return constant/* default */.Z.PointModuleName[this.selectedType]},filterControllers:function(){var _this=this;return this.controllers&&this.controllers.filter((function(con){return con.controllerType===_this.selectedType}))},page:function(){return this.$route.query.page||1},selectedInstances:function(){var _this2=this;return this.points&&this.selectedPoints?this.points.filter((function(inst){return _this2.selectedPoints.includes(inst.id)})):[]},showConfigureAllPointsTooltip:function(){return this.selectedPoints.length!=this.points.length||this.allowConfigureAllPoints},allowConfigureAllPoints:function(){return this.selectedPoints.length==this.points.length&&!(0,validation/* isNullOrUndefined */.le)(this.filters)},configureDisabled:function(){return!this.selectedPoints.length},filters:function(){return this.$route.query.search?JSON.parse(this.$route.query.search):null}}),mounted:function(){this.setAgentPointsTab()},created:function(){this.$store.dispatch("loadAssetCategory"),this.$store.dispatch("loadMeterUtility"),this.isMeterLicenseEnabled=this.$helpers.isLicenseEnabled("METER")},watch:{page:function(val){1!=val?this.getPoints(!0):this.getPoints()},filters:{handler:function(newVal,oldVal){newVal!==oldVal&&this.getPoints()}},selectedControllerId:function(){var query=this.$route.query,controllerId=this.$route.query.controllerId;controllerId&&this.$router.replace({query:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},query),{},{controllerId:this.selectedControllerId})})}},components:{AgentHelp:HelpPoints,Pagination:FPagination/* default */.Z,AgentPointForm:AgentAddPointForm,FDialog:FDialogNew/* default */.Z,AdvancedSearch:AdvancedSearch/* default */.Z,FTags:FTags["default"],SelectAgent:SelectAgent/* default */.Z,FLookupFieldWrapper:FLookupFieldWrapper/* default */.Z},methods:{getConfigureAllPointsContent:function(){return null!=this.agentType&&(1==this.agentType&&1==this.selectedType||2==this.agentType)?"Select at least one controller or apply filter":"Apply filter"},onOptionsSelect:function(command,point){switch(command){case"properties":this.showPointProperties(point);break}},showPointProperties:function(point){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var id,url,_yield$API$get,data,inputValues,listOfLabels;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return id=point.id,url="/v2/commissioning/inputValues?pointId=".concat(id),_context.next=4,api/* API */.bl.get(url);case 4:_yield$API$get=_context.sent,data=_yield$API$get.data,inputValues=data.inputValues,(0,validation/* isEmpty */.xb)(inputValues)?_this3.pointProps={}:(listOfLabels=[],inputValues.forEach((function(item){if(!(0,validation/* isEmpty */.xb)(item.inputLabel)){var value=item.inputLabel;listOfLabels.push(value)}})),_this3.pointProps=listOfLabels),_this3.showProperties=!0;case 9:case"end":return _context.stop()}}),_callee)})))()},getDisplayName:function(displayName){if(displayName.length){var val=displayName.substr(displayName.lastIndexOf("/")+1);if(val.length)return val}return null},selectedAgentInterval:function(){return this.selectedAgent.interval+" mins"},isAgentInterval:function(value){var interval=value.interval;return!(0,validation/* isEmpty */.xb)(interval)},
/* onOptionsSelect(command, point) {
       if (command === 'set') {
         this.pointSetValue(point.row)
       }
     }, */
helpDialogOpen:function(){this.showHelpDialog=!0},selectPoint:function(selectedPo){this.selectedPoints=selectedPo.map((function(value){return value.id}))},unConfigurePoint:function(){var _this4=this;if(this.isConnected){this.loading=!0,this.unconfiguring=!0;var params={recordIds:this.selectedPoints,controllerType:this.selectedType};this.$http.post("/v2/point/unconfigure",params).then((function(response){if(200===response.data.responseCode){var self=_this4;self.$message.info("Points will be unconfigured in a while."),self.loading=!1,self.unconfiguring=!1,self.getPoints()}else _this4.unconfiguring=!1,_this4.loading=!1,_this4.$message.error(response.data.message)})),this.selectedPoints=[]}else this.$message.warning(this.$t("agent.agent.agent_offline_msg"))},showAddPoint:function(){this.showDialog=!0},onSubscribeClicked:function(){var booleanAndEnumInstances=this.selectedInstances.filter((function(inst){return 4==inst.dataType||8==inst.dataType}));booleanAndEnumInstances.length==this.selectedInstances.length?this.subscribed():this.showThresholdDialog=!0},subscribed:function(){var _this5=this;if(this.isConnected){if(this.validateThreshold()&&this.validateLogicalPoint()){this.showThresholdDialog=!1,this.subscribing=!0,this.loading=!0;var instances=this.selectedInstances.map((function(instance){var inst={id:instance.id};return instance.threshold&&(inst.thresholdJson=JSON.stringify({operator:10,threshold:instance.threshold,stepCount:instance.stepCountVal})),inst}));this.$http.post("/v2/point/subscribe",{instances:instances,controllerType:this.selectedType}).then((function(response){if(200===response.data.responseCode){var self=_this5;self.$message.info("Points will be subscribed in a while."),self.loading=!1,self.subscribing=!1,self.getPoints()}else _this5.subscribing=!1,_this5.loading=!1,_this5.$message.error(response.data.message)})),this.selectedPoints=[]}}else this.$message.warning(this.$t("agent.agent.agent_offline_msg"))},validateThreshold:function(){var lessThreshold=this.selectedInstances.some((function(inst){return inst.threshold<5}));return!lessThreshold||(this.$message.error("The difference should be greater than or equal to 5 percentage"),!1)},validateLogicalPoint:function(){var _this6=this;if(1==this.selectedInstances[0].logical){var validate=this.selectedInstances.every((function(inst){return inst.controllerId===_this6.selectedInstances[0].controllerId&&inst.logical===_this6.selectedInstances[0].logical}));return validate?(this.logical=!0,!0):(this.$message.error("Please select same Controller Points."),this.logical=!1,!1)}return!0},unSubscribed:function(){var _this7=this;if(this.isConnected){if(this.validateLogicalPoint()){this.loading=!0,this.unsubscribing=!0;var instances=this.selectedInstances.map((function(instance){var inst={id:instance.id};return instance.threshold&&(inst.thresholdJson=JSON.stringify({operator:instance.operatorValue,threshold:instance.threshold,stepCount:instance.stepCountVal})),inst}));this.$http.post("/v2/point/unsubscribe",{instances:instances,controllerType:this.selectedType}).then((function(response){if(200===response.data.responseCode){var self=_this7;self.$message.info("Points will be unsubscribed in a while."),self.loading=!1,self.unsubscribing=!1,self.getPoints()}else _this7.$message.error(response.data.message),_this7.loading=!1,_this7.unsubscribing=!1})),this.selectedPoints=[]}}else this.$message.warning(this.$t("agent.agent.agent_offline_msg"))},discoverPoint:function(){var _this8=this;if(this.isConnected){this.loading=!0,this.discovering=!0;var params={recordIds:this.selectedControllerIds};this.$http.post("/v2/device/discoverPoints",params).then((function(response){if(200===response.data.responseCode){var self=_this8;self.$message.info("Points will be discovered in a while."),self.loading=!1,self.discovering=!1,self.getPoints()}else _this8.loading=!1,_this8.discovering=!1,_this8.$message.error(response.data.message)}))}else this.$message.warning(this.$t("agent.agent.agent_offline_msg"))},configureInterval:function(){1===this.agentType?
// Temp. Will be supported for all
this.intervalDialog=!0:this.configurePoints()},configureAll:function(command){"all"==command&&((0,validation/* isNullOrUndefined */.le)(this.filters)||(this.configureWithCriteria=!0,this.configureInterval())
/* else {
          this.configureWithControllerIds = true
          this.configureInterval()
        } */)},configurePointsWithControllerIds:function(){var _this9=this,params={recordIds:this.selectedControllerIds,controllerType:this.selectedType,agentId:this.selectedAgentId};this.interval>0&&(params.interval=this.interval),this.$http.post("/v2/point/configureAll",params).then((function(response){if(200===response.data.responseCode){var self=_this9;self.$message.info("Points will be configured in a while."),self.loading=!1,self.configuring=!1,_this9.intervalDialog=!1,self.getPoints()}else _this9.loading=!1,_this9.configuring=!1,_this9.$message.error(response.data.message),_this9.intervalDialog=!1})),this.configureWithControllerIds=!1,this.selectedPoints=[]},configurePointsUsingFilterOrPointIds:function(){var _this10=this;if(this.validateLogicalPoint()){var params={recordIds:this.selectedPoints,controllerType:this.selectedType,logical:this.logical,agentId:this.selectedAgentId,controllerIds:this.selectedControllerIds};this.interval>0&&(params.interval=this.interval),this.configureWithCriteria&&(params.filters=JSON.stringify(this.filters),params.recordIds=[]),this.$http.post("/v2/point/configure",params).then((function(response){if(200===response.data.responseCode){var self=_this10;self.$message.info("Points will be configured in a while."),self.loading=!1,self.configuring=!1,_this10.intervalDialog=!1,self.getPoints()}else _this10.loading=!1,_this10.configuring=!1,_this10.$message.error(response.data.message),_this10.intervalDialog=!1})),this.selectedPoints=[],this.configureWithCriteria=!1}},configurePoints:function(){this.isConnected?(this.loading=!0,this.configuring=!0,
/* if(this.configureWithControllerIds){
         this.configurePointsWithControllerIds()
         return;
      } */
this.configurePointsUsingFilterOrPointIds()):this.$message.warning(this.$t("agent.agent.agent_offline_msg"))},toggleWritable:function(point){var _this11=this;if(point.agentWritable){var id=point.id,isActive=point.writable,url=isActive?"/v2/point/makeWritable":"/v2/point/disableWritable";return this.$http.post(url,{recordIds:[id]}).then((function(_ref){var data=_ref.data;if(200!==data.responseCode)throw new Error;_this11.$message.success(isActive?"Point marked as writable":"Point marked as not writable")})).catch((function(){_this11.$set(point,"active",!isActive),_this11.$message("Could not update settings")}))}this.$message.error("Selected point is Read only")},getPoints:function(loadMore){var _this12=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var url,params,response,error,data;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if(_this12.lookupModuleName=constant/* default */.Z.ControllerModuleName[_this12.selectedType],null!=_this12.selectedType){_context2.next=3;break}return _context2.abrupt("return");case 3:return url="/v3/point/list",params=_this12.getPointsUrl(),loadMore||_this12.loadCount(),_this12.loading=!0,_context2.next=9,api/* API */.bl.post(url,params);case 9:response=_context2.sent,error=response.error,data=response.data,error?_this12.$message.error(error.message||"Error Occured"):(_this12.points=data.data?data.data:[],_this12.resourceMap=data.resourceMap?data.resourceMap:[],_this12.fieldMap=data.fieldMap?data.fieldMap:[],_this12.unitMap=data.unitMap?data.unitMap:[],_this12.loading=!1);case 12:case"end":return _context2.stop()}}),_callee2)})))()},loadCount:function(){var _this13=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var url,params,_yield$API$post,error,data;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return url="/v3/point/count",params=_this13.getPointsUrl(!0),_context3.next=4,api/* API */.bl.post(url,params);case 4:_yield$API$post=_context3.sent,error=_yield$API$post.error,data=_yield$API$post.data,error?_this13.$message.error(error.message||"Error Occured"):_this13.listCount=data.count||0;case 8:case"end":return _context3.stop()}}),_callee3)})))()},getPointsUrl:function(isCount){var status,filters=this.filters;switch(this.agentPointsTab){case"unconfigured":status="UNCONFIGURED";break;case"configured":status="CONFIGURED";break;case"commissioned":status="COMMISSIONED",this.isMeterLicenseEnabled&&(filters=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},filters),{},{readingScope:{operatorId:9,value:["".concat(this.selectedScope)]}}));break;case"subscribed":status="SUBSCRIBED",this.isMeterLicenseEnabled&&(filters=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},filters),{},{readingScope:{operatorId:9,value:["".concat(this.selectedScope)]}}));break}var queryObj={controllerType:this.selectedType,status:status,agentId:this.selectedAgentId,moduleName:this.getPointModuleName};return(0,validation/* isEmpty */.xb)(this.selectedControllerIds)||(queryObj.controllerIds=this.selectedControllerIds),isCount||(queryObj["page"]=this.page,queryObj["perPage"]=this.perPage),(0,validation/* isEmpty */.xb)(filters)||(queryObj["filters"]=JSON.stringify(filters)),queryObj},selectAgent:function(selectedSh){this.selectedPoint=selectedSh.map((function(value){return value.id}))},loadControllers:function(){var _this14=this;this.isConnected=this.selectedAgent.connected,this.setLoading(!0),this.setResetFields(),this.$http.get("/v2/controller/getFilter?agentId=".concat(this.selectedAgentId)).then((function(response){if(_this14.controllers=response.data.result.data?response.data.result.data.filter((function(c){return c.controllerType>-1})):[],_this14.controllers.length){_this14.controllers=response.data.result.data,_this14.selectedType=(0,validation/* isNullOrUndefined */.le)(_this14.$route.query.controllerType)?_this14.controllers[0].controllerType:parseInt(_this14.$route.query.controllerType);var id=_this14.$route.query.controllerId;if(!(0,validation/* isEmpty */.xb)(id)&&null!=id){_this14.selectedControllerIds.push(id);var query=Object.assign({},_this14.$route.query);delete query.controllerId,delete query.controllerType,_this14.$router.replace({query:query})}_this14.getPoints()}_this14.setLoading(!1)})).catch((function(){_this14.setLoading(!1),_this14.controllers=[]}))},setControllers:function(controllers){this.controllers=controllers},onControllerDevice:function(controllers){(0,validation/* isEmpty */.xb)(this.selectedPoints)||(this.selectedPoints=[]),this.selectedControllerIds=controllers.map((function(controller){return controller.value}));var page=this.$route.query.page;if(page){var query=Object.assign({},this.$route.query);delete query.page,this.$router.replace({query:query})}this.getPoints()},setLoading:function(isLoading){this.$emit("update:loading",isLoading)},onTypeChange:function(){if(this.selectedPoints=[],this.filterControllers.length){this.selectedControllerIds=[];var page=this.$route.query.page,query=Object.assign({},this.$route.query);page&&delete query.page,query.controllerType=this.selectedType,this.$router.replace({query:query}),this.getPoints()}},listRefresh:function(){this.getPoints()},quickSearches:function(){var string=this.querySearch;string&&(this.getPoints(!0),this.loadCount())},toggleQuickSearches:function(){var _this15=this;this.showQuickSearches=!this.showQuickSearches,this.showQuickSearches&&this.$nextTick((function(){_this15.$refs.querySearch.focus()}))},closeSearches:function(){this.toggleQuickSearches(),this.querySearch=null,this.getPoints(!0),this.loadCount()},setResetFields:function(){this.selectedType=null,this.selectedControllerIds=[],this.points=[],this.listCount=0},closeIntervalDialog:function(){this.intervalDialog=!1},getAsset:function(point){if((0,validation/* isNullOrUndefined */.le)(point.readingScope)&&(point.readingScope=1),this.resourceMap.hasOwnProperty(point.readingScope)&&"object"===(0,esm_typeof/* default */.Z)(this.resourceMap[point.readingScope]))return this.$getProperty(this.resourceMap,"".concat(point.readingScope,".").concat(point.resourceId),"---");var resourceId=this.$getProperty(point,"resourceId");return this.resourceMap[resourceId]},getReading:function(point){var fieldId=this.$getProperty(point,"row.fieldId"),reading=this.fieldMap[fieldId].name;
//let name = reading.name
return reading},getUnit:function(point){var unitId=this.$getProperty(point,"row.unit"),unit=this.unitMap[unitId];return unit},getCategory:function(point){var readingScope=point.readingScope;point.categoryId;if(1==readingScope||(0,validation/* isNullOrUndefined */.le)(readingScope)){var category=this.getAssetCategory(point.categoryId);return(0,validation/* isEmpty */.xb)(category)?"---":category.displayName}if(3==readingScope){var utility=this.getMeterUtility(point.categoryId);return(0,validation/* isEmpty */.xb)(utility)?"---":utility.displayName}},getLastRecordedTime:function(point){var lastRecordedTime=this.$getProperty(point,"row.lastRecordedTime");return this.lastRecordedTime=(0,filters.formatDate)(lastRecordedTime),this.lastRecordedTime},setAgentPointsTab:function(){var agentPointsTab=this.$getProperty(this.$route.query,"agentPointsTab");(0,validation/* isEmpty */.xb)(agentPointsTab)?this.agentPointsTab="unconfigured":this.agentPointsTab=agentPointsTab},updateAgentId:function(selectedAgent){this.selectedAgent=selectedAgent,this.selectedAgentId=selectedAgent.id,this.agentType=selectedAgent.agentType,this.isNiagaraAgent=2===selectedAgent.agentType,this.lookupModuleName=null;var page=this.$route.query.page,type=this.$route.query.controllerType,query=Object.assign({},this.$route.query);page&&delete query.page,type&&delete query.controllerType,query.agentId=this.selectedAgentId,this.$router.replace({query:query}),this.selectedPoints=[],this.loadControllers()},constructAgentFilter:function(){return{agentId:{operatorId:9,value:["".concat(this.selectedAgentId)]}}},tabSwitch:function(){(0,validation/* isEmpty */.xb)(this.selectedPoints)||(this.selectedPoints=[]),1!=this.selectedScope&&(this.selectedScope=1);var page=this.$route.query.page,query=Object.assign({},this.$route.query);page&&delete query.page,query.agentPointsTab=this.agentPointsTab,this.$router.replace({query:query}),this.getPoints()},pointsTableHeight:function(){var filters=this.filters;return(0,validation/* isNull */.Ft)(filters)?"agent-list-scroll":"filter-applied"},exportPoints:function(command){var _this16=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){var url,params,_yield$API$post2,data,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:return url="/v3/point/export",params=_this16.getPointsUrl(),params["type"]=command,_this16.$message.success({message:"Downloading",type:"success",showClose:!0}),_context4.next=6,api/* API */.bl.post(url,params);case 6:_yield$API$post2=_context4.sent,data=_yield$API$post2.data,error=_yield$API$post2.error,error?_this16.$message.error(error.message||"Error Occurred"):_this16.exportUrl=data.fileUrl;case 10:case"end":return _context4.stop()}}),_callee4)})))()}}},agent_AgentPointsvue_type_script_lang_js=AgentPointsvue_type_script_lang_js,AgentPoints_component=(0,componentNormalizer/* default */.Z)(agent_AgentPointsvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,AgentPoints=AgentPoints_component.exports},
/***/505572:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return SelectAgent}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/agent/components/SelectAgent.vue?vue&type=template&id=3f191645
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_vm.hideLabel?_vm._e():_c("div",{staticClass:"fc-pink f12 pB5 bold"},[_vm._v("Agent")]),_c("el-select",{staticClass:"fc-input-full-border-select2",attrs:{disabled:!_vm.disableSelect&&_vm.$validation.isEmpty(_vm.agentSearch),remote:"",filterable:"","default-first-option":"",placeholder:"Select Agent",loading:_vm.isAgentLoading,"loading-text":"Searching","remote-method":function(query){return _vm.searchAgent({searchText:query})}},on:{change:function($event){return _vm.getControllers()}},model:{value:_vm.selectedAgentId,callback:function($$v){_vm.selectedAgentId=$$v},expression:"selectedAgentId"}},_vm._l(_vm.agents,(function(agent){return _c("el-option",{key:agent.id,attrs:{label:agent.displayName||agent.name,value:agent.id,"no-data-text":"No Agent available",clearable:""}})})),1)],1)},staticRenderFns=[],validation=(__webpack_require__(634338),__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(425728),__webpack_require__(990260)),debounce=(__webpack_require__(32284),__webpack_require__(23279)),debounce_default=__webpack_require__.n(debounce),SelectAgentvue_type_script_lang_js={data:function(){return{isAgentLoading:!1,agents:null,selectedAgentId:null,defaultIds:[],selectedAgent:null,agentSearch:"",disableSelect:!1}},props:["discoverableAgents","hideLabel","filterActiveAgents","defaultAgent"],mounted:function(){this.getAgents()},methods:{getAgents:function(){var _this=this;this.defaultIds=this.$route.query.agentId;var url="/v2/agent/list?page=1&perPage=50";(0,validation/* isEmpty */.xb)(this.defaultIds)||(url="".concat(url,"&defaultIds=").concat(this.defaultIds)),(0,validation/* isEmpty */.xb)(this.agentSearch)||(url="".concat(url,"&querySearch=").concat(this.agentSearch)),this.$set(this,"isAgentLoading",!0),this.$http.get(url).then((function(response){_this.$set(_this,"isAgentLoading",!1),_this.agents=response.data.result&&response.data.result.data?response.data.result.data:[],_this.disableSelect=!0,_this.discoverableAgents&&(_this.agents=_this.agents.filter((function(agent){return 1===agent.agentType||2===agent.agentType||9===agent.agentType||6===agent.agentType}))),_this.filterActiveAgents&&(_this.agents=_this.agents.filter((function(agent){return 1==agent.connected}))),_this.agents.length&&(0,validation/* isEmpty */.xb)(_this.agentSearch)&&(null!=_this.defaultAgent?_this.selectedAgentId=_this.defaultAgent:_this.selectedAgentId=parseInt(_this.$route.query.agentId)||_this.agents[0].id,_this.getSelectedAgent(),null!=_this.selectedAgent&&_this.$emit("onAgentFilter",_this.selectedAgent)),_this.disableSelect=!(0,validation/* isEmpty */.xb)(_this.agents)})).catch((function(){_this.agents=[],_this.$set(_this,"isAgentLoading",!1)}))},getControllers:function(){this.getSelectedAgent(),null!=this.selectedAgent&&this.$emit("onAgentFilter",this.selectedAgent)},getSelectedAgent:function(){var _this2=this;this.selectedAgent=this.agents.find((function(agent){return agent.id===_this2.selectedAgentId}))},searchAgent:debounce_default()((function(){var props=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},searchText=props.searchText;this.agentSearch=searchText,this.getAgents()}),1e3)}},components_SelectAgentvue_type_script_lang_js=SelectAgentvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_SelectAgentvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,SelectAgent=component.exports},
/***/436756:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FDialogNew}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/FDialogNew.vue?vue&type=template&id=388b7f7a
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"costdialog",class:["f-dialog",_vm.customClass],attrs:{visible:_vm.visible,"before-close":_vm.close,width:_vm.width,"append-to-body":!0},on:{"update:visible":function($event){_vm.visible=$event}}},[_c("div",{staticClass:"f-dialog-title",attrs:{slot:"title"},slot:"title"},[_vm._t("header",(function(){return[_c("div",{staticClass:"label-txt-black fwBold"},[_vm._v(" "+_vm._s(_vm.title)+" ")])]}))],2),_c("div",{staticClass:"f-dialog-content",style:_vm.styleCss},[_vm._t("content"),_vm._t("default")],2),_c("div",{staticClass:"f-footer row",staticStyle:{height:"46px"}},[_vm._t("footer",(function(){return[_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.close}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.loading},on:{click:_vm.save}},[_vm._v(_vm._s(_vm.loading?_vm.loadingTitle||"Saving...":_vm.confirmTitle||"Save"))])],1)]}))],2)])},staticRenderFns=[],FDialogNewvue_type_script_lang_js={props:["title","confirmTitle","visible","customClass","width","maxHeight","stayOnSave","loading","loadingTitle","record"],computed:{styleCss:function(){return this.maxHeight?{"max-height":this.maxHeight,overflow:"scroll"}:null}},methods:{close:function(){this.$emit("close"),this.$emit("update:visible",!1)},save:function(){this.$emit("save"),this.stayOnSave||this.$emit("update:visible",!1)}}},components_FDialogNewvue_type_script_lang_js=FDialogNewvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FDialogNewvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FDialogNew=component.exports},
/***/201117:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FLookupFieldWrapper}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/FLookupFieldWrapper.vue?vue&type=template&id=0b196d62
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"lookup-wrapper"},[_vm.fieldObj.field?_c("FLookupField",{class:{"handle-wizard-icon":_vm.handleWizardIcon},attrs:{model:_vm.modelObj,field:_vm.fieldObj,disabled:_vm.disabled,siteId:_vm.siteId,hideLookupIcon:_vm.hideWizard,hideDropDown:_vm.hideDropDown,preHookFilterConstruction:_vm.filterConstruction,fetchOptionsOnLoad:_vm.fetchOptionsOnLoad,fetchOptionsMethod:_vm.fetchOptionsMethod},on:{"update:model":function($event){_vm.modelObj=$event},showLookupWizard:_vm.showLookupWizard,recordSelected:_vm.onRecordSelected}}):_c("el-input"),!_vm.hideWizard&&_vm.canShowLookupWizard?_c("div",[_c("FLookupFieldWizard",{attrs:{canShowLookupWizard:_vm.canShowLookupWizard,selectedLookupField:_vm.fieldObj,siteId:_vm.siteId,withReadings:_vm.withReadings},on:{"update:canShowLookupWizard":function($event){_vm.canShowLookupWizard=$event},"update:can-show-lookup-wizard":function($event){_vm.canShowLookupWizard=$event},setLookupFieldValue:_vm.setLookupFieldValue,showMainFieldSearch:function($event){return _vm.onWizardShow(!1)}}})],1):_vm._e()],1)},staticRenderFns=[],slicedToArray=__webpack_require__(554621),FLookupField=(__webpack_require__(879288),__webpack_require__(260228),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(450886),__webpack_require__(947522),__webpack_require__(670560),__webpack_require__(425728),__webpack_require__(434284),__webpack_require__(634338),__webpack_require__(891719),__webpack_require__(855048)),validation=__webpack_require__(990260),FLookupFieldWrappervue_type_script_lang_js={name:"f-lookup-field-wrapper",props:{value:[Number,String,Array],label:String,
// Label of selected value if any
formField:Object,field:Object,
// Pass field object if form field not available and field avaialble
moduleName:String,
// Pass module name and field name if field object not avaialble
fieldName:String,disabled:{type:Boolean,default:!1},siteId:Number,hideWizard:{type:Boolean,default:!1},hideDropDown:{type:Boolean,default:!1},fetchOptionsOnLoad:{type:Boolean,default:!0},fetchOptionsMethod:{type:Function},withReadings:Boolean,handleWizardIcon:{
// To handle wizard icon css
type:Boolean,default:!0},filterConstruction:{type:Function,default:function(field){return field.filters}}},components:{FLookupField:FLookupField/* default */.Z,FLookupFieldWizard:function(){return Promise.all(/* import() */[__webpack_require__.e(93208),__webpack_require__.e(50232),__webpack_require__.e(93765),__webpack_require__.e(95953),__webpack_require__.e(35309),__webpack_require__.e(18778),__webpack_require__.e(12303),__webpack_require__.e(84290),__webpack_require__.e(31721),__webpack_require__.e(64418),__webpack_require__.e(5603),__webpack_require__.e(57432),__webpack_require__.e(435),__webpack_require__.e(72230),__webpack_require__.e(94255),__webpack_require__.e(67683),__webpack_require__.e(44178),__webpack_require__.e(91132),__webpack_require__.e(20280),__webpack_require__.e(78256),__webpack_require__.e(22200),__webpack_require__.e(49081),__webpack_require__.e(89472),__webpack_require__.e(12085),__webpack_require__.e(55754),__webpack_require__.e(86494),__webpack_require__.e(3037),__webpack_require__.e(49908),__webpack_require__.e(22061),__webpack_require__.e(31602),__webpack_require__.e(73609),__webpack_require__.e(99751),__webpack_require__.e(42054)]).then(__webpack_require__.bind(__webpack_require__,499751))}},data:function(){return{fieldObj:{isDataLoading:!1,options:[],lookupModuleName:"",field:null,filters:{},isDisabled:!1},canShowLookupWizard:!1}},computed:{modelObj:{get:function(){return(0,validation/* isEmpty */.xb)(this.value)?this.value:(0,validation/* isArray */.kJ)(this.value)?this.value.map((function(val){return parseInt(val)})):parseInt(this.value)},set:function(value){this.$emit("input",value)}}},created:function(){this.handleDefaultOption()},mounted:function(){var formField=this.formField,field=this.field;(0,validation/* isEmpty */.xb)(formField)?(0,validation/* isEmpty */.xb)(field)?this.fetchField():this.setField(field):this.fieldObj=formField},watch:{canShowLookupWizard:function(value){value||this.onWizardShow(value)}},methods:{showLookupWizard:function(field,canShow){this.fieldObj=field,this.canShowLookupWizard=canShow,this.onWizardShow(!0)},setLookupFieldValue:function(props){var _this=this,field=props.field,_ref=field||{},multiple=_ref.multiple,selectedItems=_ref.selectedItems;if(multiple){var valueArr=[];selectedItems.forEach((function(item){var value=item.value,label=item.label;_this.addOption(value,label),valueArr.push(value)})),this.modelObj=valueArr,this.onRecordSelected(selectedItems,valueArr)}else{var _ref2=selectedItems||[],_ref3=(0,slicedToArray/* default */.Z)(_ref2,1),selectedItem=_ref3[0],value=selectedItem.value,label=selectedItem.label;this.addOption(value,label),this.modelObj=value,this.onRecordSelected(selectedItem)}this.onWizardShow(!1)},onWizardShow:function(show){this.$emit("showingLookupWizard",show)},fetchField:function(){var _this2=this,moduleName=this.moduleName,fieldName=this.fieldName;this.$util.loadModuleMeta(moduleName).then((function(meta){var field=meta.fields.find((function(field){return field.name===fieldName}));_this2.setField(field)}))},onRecordSelected:function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];this.$emit.apply(this,["recordSelected"].concat(args))},handleDefaultOption:function(){var label=this.label,value=this.value;(0,validation/* isEmpty */.xb)(label)||(0,validation/* isEmpty */.xb)(value)||this.addOption(value,label)},setField:function(field){var fieldObj=this.fieldObj;fieldObj.field=field,fieldObj.multiple=field.multiple,fieldObj.lookupModuleName=field.lookupModule.name,(0,validation/* isArray */.kJ)(this.modelObj)?fieldObj.selectedItems=this.modelObj.map((function(id){return{value:id}})):fieldObj.selectedItems={value:this.modelObj}},addOption:function(id,label){var fieldObj=this.fieldObj,options=fieldObj.options,newOptionObj={label:label,value:id};(0,validation/* isEmpty */.xb)(options)?options.push(newOptionObj):options.some((function(option){return option.value===id}))||options.unshift(newOptionObj),this.$set(this.fieldObj,"options",options)}}},components_FLookupFieldWrappervue_type_script_lang_js=FLookupFieldWrappervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FLookupFieldWrappervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FLookupFieldWrapper=component.exports},
/***/855048:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FLookupField}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/forms/FLookupField.vue?vue&type=template&id=473d4b8e
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.isFieldLoading?_c("FieldLoader",{attrs:{isLoading:_vm.isFieldLoading}}):_c("div",{staticClass:"f-lookup-chooser f-lookup-chooser-container"},[_c("el-select",{ref:"selectBox",class:["fc-input-full-border-select2 width100",(!_vm.canHideLookupIcon||_vm.canShowQuickCreateIcon)&&"resource-search",_vm.isMultiple&&"fc-tag",_vm.hideDropDown&&!_vm.disabled&&"skip-disable"],attrs:{"collapse-tags":"",remote:_vm.isRemote,filterable:"",clearable:_vm.canHideLookupIcon,multiple:_vm.isMultiple,popperAppendToBody:_vm.popperAppendToBody,"remote-method":function(searchText){return _vm.remoteMethod(searchText)},loading:_vm.field.isDataLoading,"loading-text":_vm.$t("common._common.searching"),disabled:_vm.disabled||_vm.hideDropDown,placeholder:_vm.field.placeHolderText||"Select"},on:{change:_vm.recordSelected},model:{value:_vm.modelObj,callback:function($$v){_vm.modelObj=$$v},expression:"modelObj"}},[_c("div",{staticClass:"flRight d-flex",class:!_vm.disabled&&"pointer",attrs:{slot:"prefix"},slot:"prefix"},[_vm.canShowSystemClear?_c("div",{staticClass:"flookup-remove-icon-alignment flookup-remove-icon",on:{click:_vm.clearData}},[_c("i",{staticClass:"el-icon-circle-close pointer fc-lookup-icon f13"})]):_vm._e(),_vm.canHideLookupIcon?_vm._e():_c("div",{staticClass:"icon-class-alignment",on:{click:function($event){return $event.stopPropagation(),_vm.openLookupFieldWizard(_vm.field)}}},[_c("inline-svg",{attrs:{src:"lookup",iconClass:"icon icon-sm-md fc-lookup-icon"}})],1),_vm.canShowQuickCreateIcon?_c("div",{staticClass:"icon-class-alignment",on:{click:function($event){return $event.stopPropagation(),_vm.openQuickCreate()}}},[_c("el-tooltip",{attrs:{effect:"dark",content:"Add\n          "+_vm.moduleDisplayName,placement:"top"}},[_c("inline-svg",{attrs:{src:"add-pink",iconClass:"icon icon-sm-md fc-lookup-icon"}})],1)],1):_vm._e()]),_vm._l(_vm.field.options,(function(option,index){return _c("el-option",{key:option.value+" "+index,staticClass:"fc-input-full-border-select2 width100",attrs:{label:option.label,value:option.value}},[_c("span",{staticClass:"fL"},[_vm._v(_vm._s(option.label))]),_vm.$validation.isEmpty(option.secondaryLabel)?_vm._e():_c("span",{staticClass:"select-float-right-text13"},[_vm._v(_vm._s(option.secondaryLabel))]),_vm.getIsSiteDecommissioned(option)?_c("span",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"select-float-right-text13 pL10",attrs:{title:_vm.$t("setup.decommission.decommissioned")}},[_c("fc-icon",{staticClass:"fR pT10",attrs:{group:"alert",name:"decommissioning",size:"16"}})],1):_vm._e()])}))],2),_vm.showQuickCreateData?_c("QuickCreateData",{attrs:{canShowDialog:_vm.showQuickCreateData,quickCreateField:_vm.field,setAddedRecord:_vm.setAddedRecord},on:{"update:canShowDialog":function($event){_vm.showQuickCreateData=$event},"update:can-show-dialog":function($event){_vm.showQuickCreateData=$event}}}):_vm._e()],1)},staticRenderFns=[],objectSpread2=__webpack_require__(595082),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),toConsumableArray=__webpack_require__(488478),validation=(__webpack_require__(879288),__webpack_require__(260228),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(434284),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(450886),__webpack_require__(538077),__webpack_require__(425728),__webpack_require__(634338),__webpack_require__(990260)),constant=__webpack_require__(354754),picklist=__webpack_require__(961358),field_utils=__webpack_require__(455344),FieldLoader=__webpack_require__(62979),isEqual=__webpack_require__(618446),isEqual_default=__webpack_require__.n(isEqual),LOOKUP_FIELD_PLACEHOLDER_MAP={people:{value:"${LOGGED_PEOPLE}",label:"Current User"},users:{value:"${LOGGED_USER}",label:"Current User"}},FLookupFieldvue_type_script_lang_js={name:"f-lookup-field",props:{model:{},field:{type:Object},disabled:{type:Boolean},siteId:{type:[Number,String]},categoryId:{type:Number},hideLookupIcon:{type:Boolean,default:!1},popperAppendToBody:{required:!1,type:Boolean,default:!0},fetchOptionsOnLoad:{type:Boolean,default:!0},fetchOptionsMethod:{type:Function},preHookFilterConstruction:{type:Function,default:function(field){return field.filters}},hideDropDown:{type:Boolean,default:!1},skipLoading:{type:Boolean,default:!1},isClearable:{type:Boolean,default:!0},userfilmoduleEnum:{type:String},parentModuleId:{type:Number},selectedOptions:{type:Array}},components:{FieldLoader:FieldLoader/* default */.Z,QuickCreateData:function(){return Promise.all(/* import() */[__webpack_require__.e(93208),__webpack_require__.e(50232),__webpack_require__.e(93765),__webpack_require__.e(95953),__webpack_require__.e(35309),__webpack_require__.e(18778),__webpack_require__.e(12303),__webpack_require__.e(84290),__webpack_require__.e(31721),__webpack_require__.e(64418),__webpack_require__.e(5603),__webpack_require__.e(57432),__webpack_require__.e(435),__webpack_require__.e(72230),__webpack_require__.e(94255),__webpack_require__.e(67683),__webpack_require__.e(44178),__webpack_require__.e(91132),__webpack_require__.e(20280),__webpack_require__.e(78256),__webpack_require__.e(22200),__webpack_require__.e(49081),__webpack_require__.e(89472),__webpack_require__.e(12085),__webpack_require__.e(55754),__webpack_require__.e(86494),__webpack_require__.e(3037),__webpack_require__.e(49908),__webpack_require__.e(22061),__webpack_require__.e(31602),__webpack_require__.e(73609),__webpack_require__.e(41323),__webpack_require__.e(99751),__webpack_require__.e(11305),__webpack_require__.e(80390),__webpack_require__.e(89142),__webpack_require__.e(97770),__webpack_require__.e(76422),__webpack_require__.e(99813)]).then(__webpack_require__.bind(__webpack_require__,676433))}},data:function(){return{localSearch:!1,isLoadedOnce:!1,currentModelValue:!1,showQuickCreateData:!1}},computed:{customOptions:function(){var _ref=this||{},field=_ref.field,_ref2=field||{},lookupModule=_ref2.lookupModule;if((0,validation/* isEmpty */.xb)(lookupModule))return[];var _ref3=lookupModule||{},name=_ref3.name;return(0,validation/* isEmpty */.xb)(LOOKUP_FIELD_PLACEHOLDER_MAP[name])?[]:[LOOKUP_FIELD_PLACEHOLDER_MAP[name]]},modelObj:{get:function(){return this.model},set:function(value){this.currentModelValue=value,this.$emit("update:model",value)}},moduleDisplayName:function(){var field=this.field,_ref4=field.field||{},lookupModule=_ref4.lookupModule,_ref5=lookupModule||{},displayName=_ref5.displayName;return displayName},isFieldLoading:function(){var field=this.field,defaultIds=this.defaultIds,skipLoading=this.skipLoading,isLoadedOnce=this.isLoadedOnce;return!skipLoading&&!isLoadedOnce&&!(0,validation/* isEmpty */.xb)(defaultIds)&&field.isDataLoading},isPickListTypeModule:function(){var field=this.field,fieldObj=field.field,_ref6=fieldObj||field,lookupModule=_ref6.lookupModule,_ref7=lookupModule||{},type=_ref7.type;
// type 1 is for base entity modules
return!!type&&1!==type},isRemote:function(){var localSearch=this.localSearch;return!localSearch},canHideLookupIcon:function(){var hideLookupIcon=this.hideLookupIcon,isPickListTypeModule=this.isPickListTypeModule,hideDropDown=this.hideDropDown,field=this.field,userfilmoduleEnum=this.userfilmoduleEnum,_ref8=field||{},config=_ref8.config,canHide=!1;if(!(0,validation/* isEmpty */.xb)(config)){var canShowLookupWizard=this.$getProperty(config,"canShowLookupWizard",null);(0,validation/* isNull */.Ft)(canShowLookupWizard)||(canHide=!canShowLookupWizard)}return!hideDropDown&&("PICK_LIST"===userfilmoduleEnum||(canHide||hideLookupIcon||isPickListTypeModule))},canShowQuickCreateIcon:function(){var disabled=this.disabled,field=this.field,_ref9=field||{},config=_ref9.config,canShow=!1;return(0,validation/* isEmpty */.xb)(config)||(canShow=this.$getProperty(config,"canShowQuickCreate")),disabled&&(canShow=!1),canShow},isSiteEnabled:function(){var siteId=Number(this.$cookie.get("fc.currentSite")),currentSiteId=siteId>0?siteId:-1;return!(0,validation/* isEmpty */.xb)(currentSiteId)},isMultiple:function(){var field=this.field;return!!field.multiple},resourceModuleName:function(){var field=this.field,config=field.config,lookupModuleName=field.lookupModuleName,_ref10=config||{},isFiltersEnabled=_ref10.isFiltersEnabled,filterValue=_ref10.filterValue;if(isFiltersEnabled&&constant/* default */.Z.LOOKUP_FILTER_ENABLED_FIELDS.includes(lookupModuleName)){var moduleName=constant/* default */.Z.LOOKUP_FILTERS_MAP[filterValue];return moduleName}return null},isResourceField:function(){var field=this.field,name=field.name,isResourceField=(0,field_utils/* isChooserTypeField */.Rq)(field)||"resource"===name;return isResourceField},
// To prefill the existing values, we have to send default ids in picklist api
defaultIds:function(){var modelObj=this.modelObj,selectedOptions=this.selectedOptions,isPlaceHoldersEnabled=constant/* default */.Z.FIELD_PLACEHOLDERS.includes(modelObj)||!1,defaultIds=[],selectedOptionsArr=(selectedOptions||[]).map((function(option){return parseInt(option)}));return(0,validation/* isEmpty */.xb)(selectedOptions)?(0,validation/* isEmpty */.xb)(modelObj)||isPlaceHoldersEnabled||(defaultIds=(0,validation/* isArray */.kJ)(modelObj)?(0,toConsumableArray/* default */.Z)(modelObj):[modelObj]):defaultIds=(0,toConsumableArray/* default */.Z)(selectedOptionsArr),defaultIds=defaultIds.filter((function(val){return!constant/* default */.Z.FIELD_PLACEHOLDERS.includes(val)})),defaultIds},operatorLookupModule:function(){var field=this.field,_ref11=field||{},operatorLookupModule=_ref11.operatorLookupModule;return operatorLookupModule||{}},skipSiteFilter:function(){var field=this.field,_ref12=field||{},config=_ref12.config,_ref13=config||{},_ref13$skipSiteFilter=_ref13.skipSiteFilter,skipSiteFilter=void 0!==_ref13$skipSiteFilter&&_ref13$skipSiteFilter;return skipSiteFilter},canShowSystemClear:function(){var canHideLookupIcon=this.canHideLookupIcon,isClearable=this.isClearable,modelObj=this.modelObj,disabled=this.disabled;return!canHideLookupIcon&&!disabled&&(isClearable&&!(0,validation/* isEmpty */.xb)(modelObj))}},watch:{model:function(newVal){var _this=this,currentModelValue=this.currentModelValue,isRemote=this.isRemote;isEqual_default()(newVal,currentModelValue)||(isRemote&&this.getOptions({initialFetch:!0}).then((function(options){_this.$set(_this.field,"options",options)})),this.$set(this,"modelObj",newVal))},siteId:{handler:function(newVal,oldVal){var _this2=this,isSiteEnabled=this.isSiteEnabled,skipSiteFilter=this.skipSiteFilter;skipSiteFilter||isSiteEnabled||newVal===oldVal||this.getOptions({initialFetch:!0}).then((function(options){_this2.$set(_this2.field,"options",options)}))}},parentModuleId:{handler:function(newVal,oldVal){var _this3=this;newVal!==oldVal&&this.getOptions({initialFetch:!0}).then((function(options){_this3.$set(_this3.field,"options",options)}))}},operatorLookupModule:{handler:function(newVal,oldVal){var _this4=this;isEqual_default()(newVal,oldVal)||this.getOptions({initialFetch:!0}).then((function(options){_this4.$set(_this4.field,"options",options)}))}},"field.clientCriteria":{handler:function(newVal,oldVal){var _this5=this;isEqual_default()(newVal,oldVal)||this.getOptions({initialFetch:!0}).then((function(options){_this5.$set(_this5.field,"options",options)}))}},categoryId:{handler:function(newVal,oldVal){var _this6=this;isEqual_default()(newVal,oldVal)||this.getOptions({initialFetch:!0}).then((function(options){_this6.$set(_this6.field,"options",options)}))}},"field.options":{handler:function(value){var modelObj=this.modelObj;if(!(0,validation/* isEmpty */.xb)(value))if((0,validation/* isEmpty */.xb)(modelObj))this.field.selectedItems=[];else if((0,validation/* isArray */.kJ)(modelObj)){var selectedItems=value.filter((function(option){return modelObj.includes(option.value)}));this.field.selectedItems=selectedItems}else{var selectedItem=value.find((function(option){return option.value===modelObj}));this.field.selectedItems=[selectedItem]}},immediate:!0},isLoadedOnce:{handler:function(value){value&&this.$emit("optionsLoadedOnce")}}},created:function(){var _this7=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var fetchOptionsOnLoad,field,modelObj,customOptions,options;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:
// Have to skip fetching options initially, when module is 'resource' and filters is not enabled
if(fetchOptionsOnLoad=_this7.fetchOptionsOnLoad,field=_this7.field,modelObj=_this7.modelObj,customOptions=_this7.customOptions,_this7.currentModelValue=modelObj,_this7.getIsSiteDecommissioned=picklist/* getIsSiteDecommissioned */.Yx,!fetchOptionsOnLoad){_context2.next=12;break}return _context2.next=6,_this7.getOptions({initialFetch:!0});case 6:if(_context2.t0=_context2.sent,_context2.t0){_context2.next=9;break}_context2.t0=[];case 9:options=_context2.t0,_this7.$set(_this7.field,"options",[].concat((0,toConsumableArray/* default */.Z)(customOptions),(0,toConsumableArray/* default */.Z)(options))),_this7.$set(_this7,"isLoadedOnce",!0);case 12:_this7.remoteMethod=_this7.$helpers.debounce(function(){var _ref14=(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(searchText){var isDataLoading,_options;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(isDataLoading=field.isDataLoading,isDataLoading){_context.next=6;break}return _context.next=4,_this7.getOptions({searchText:searchText});case 4:_options=_context.sent,_this7.$set(_this7.field,"options",_options);case 6:case"end":return _context.stop()}}),_callee)})));return function(_x){return _ref14.apply(this,arguments)}}(),1e3);case 13:case"end":return _context2.stop()}}),_callee2)})))()},methods:{focus:function(){(0,validation/* isEmpty */.xb)(this.$refs["selectBox"])||this.$refs["selectBox"].focus()},getOptions:function(params){var _this8=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var searchText,initialFetch,fetchOptionsMethod,field,siteId,categoryId,isRemote,defaultIds,resourceModuleName,isResourceField,skipSiteFilter,selectedOptions,_field$filters,fieldFilters,options,filters,props,perPageCount,_yield$_this8$fetchOp,_yield$_this8$fetchOp2,optionsArr,error,_ref15,message,_yield$getFieldOption,_yield$getFieldOption2,_optionsArr,_error,meta,_ref16,_message,_meta$localSearch,localSearch;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:
/*
                Have to return empty options if field is of resourcetype, if filters havent be enabled
                and if no values selected already
              */
if(searchText=params.searchText,initialFetch=params.initialFetch,fetchOptionsMethod=_this8.fetchOptionsMethod,field=_this8.field,siteId=_this8.siteId,categoryId=_this8.categoryId,isRemote=_this8.isRemote,defaultIds=_this8.defaultIds,resourceModuleName=_this8.resourceModuleName,isResourceField=_this8.isResourceField,skipSiteFilter=_this8.skipSiteFilter,selectedOptions=_this8.selectedOptions,_field$filters=field.filters,fieldFilters=void 0===_field$filters?{}:_field$filters,options=[],(0,validation/* isEmpty */.xb)(resourceModuleName)||(field.resourceLookupModuleName=resourceModuleName),filters=_this8.preHookFilterConstruction(field),(0,validation/* isEmpty */.xb)(filters)||(field.filters=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},fieldFilters),filters)),(0,validation/* isEmpty */.xb)(categoryId)||(field.filters=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},field.filters),{},{category:{operator:"is",value:["".concat(categoryId)]}})),props={field:field,searchText:searchText},skipSiteFilter||(props=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},props),{},{siteId:siteId})),!(isResourceField&&(0,validation/* isEmpty */.xb)(resourceModuleName)&&(0,validation/* isEmpty */.xb)(defaultIds))){_context3.next=12;break}return _context3.abrupt("return",options);case 12:if(initialFetch&&isRemote&&(perPageCount=defaultIds.length>50?defaultIds.length:50,props=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},props),{},{page:1,perPage:perPageCount,defaultIds:defaultIds}),((0,validation/* isEmpty */.xb)(resourceModuleName)&&isResourceField||!(0,validation/* isEmpty */.xb)(selectedOptions))&&(
// Have to fetch only selected values, which is same as the number of defaultids
props=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},props),{},{perPage:defaultIds.length}))),_this8.$set(field,"isDataLoading",!0),(0,validation/* isEmpty */.xb)(fetchOptionsMethod)){_context3.next=25;break}return _context3.next=17,_this8.fetchOptionsMethod(props);case 17:_yield$_this8$fetchOp=_context3.sent,_yield$_this8$fetchOp2=_yield$_this8$fetchOp.options,optionsArr=void 0===_yield$_this8$fetchOp2?[]:_yield$_this8$fetchOp2,error=_yield$_this8$fetchOp.error,error&&(_ref15=error||{},message=_ref15.message,_this8.$message.error(message||"Error Occured")),options=optionsArr,_context3.next=35;break;case 25:return _context3.next=27,(0,picklist/* getFieldOptions */._K)(props);case 27:_yield$getFieldOption=_context3.sent,_yield$getFieldOption2=_yield$getFieldOption.options,_optionsArr=void 0===_yield$getFieldOption2?[]:_yield$getFieldOption2,_error=_yield$getFieldOption.error,meta=_yield$getFieldOption.meta,_error&&(_ref16=_error||{},_message=_ref16.message,_this8.$message.error(_message||"Error Occured")),meta&&(0,validation/* isEmpty */.xb)(searchText)&&(_meta$localSearch=meta.localSearch,localSearch=void 0!==_meta$localSearch&&_meta$localSearch,_this8.$set(_this8,"localSearch",localSearch)),options=_optionsArr;case 35:return _this8.$set(field,"isDataLoading",!1),_context3.abrupt("return",options);case 37:case"end":return _context3.stop()}}),_callee3)})))()},clearData:function(){this.$emit("update:model",""),this.recordSelected("")},recordSelected:function(value){var field=this.field,_this$field$options=this.field.options,options=void 0===_this$field$options?[]:_this$field$options,isMultiple=this.isMultiple,selectedValues=null;isMultiple?(selectedValues=options.filter((function(e){return(value||[]).includes(e.value)})),field.selectedItems=selectedValues):(selectedValues=options.find((function(e){return e.value==value}))||{},field.selectedItems=[],(0,validation/* isEmpty */.xb)(selectedValues)||(field.selectedItems=[selectedValues])),this.$emit("recordSelected",selectedValues,field)},openLookupFieldWizard:function(field){var disabled=this.disabled;disabled||this.$emit("showLookupWizard",field,!0)},openQuickCreate:function(){var disabled=this.disabled;disabled||(this.showQuickCreateData=!0)},setAddedRecord:function(props){var record=props.record,_ref17=record||{},id=_ref17.id,name=record.displayName||record.name||record.subject,field=this.field;field.selectedItems=[{value:id,label:name}],this.$emit("setLookupFieldValue",{field:(0,objectSpread2/* default */.Z)({},field)})}}},forms_FLookupFieldvue_type_script_lang_js=FLookupFieldvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(forms_FLookupFieldvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FLookupField=component.exports},
/***/62979:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FieldLoader}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/forms/FieldLoader.vue?vue&type=template&id=7252e23e
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.isLoading?_c("div",{staticClass:"field-loading loading-shimmer"}):_vm._e()},staticRenderFns=[],FieldLoadervue_type_script_lang_js={props:{isLoading:{type:Boolean,required:!0}}},forms_FieldLoadervue_type_script_lang_js=FieldLoadervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(forms_FieldLoadervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FieldLoader=component.exports},
/***/929593:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FPagination}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/list/FPagination.vue?vue&type=template&id=7641710c&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_vm.total>0?_c("div",{staticClass:"flex-center-row-space mT-5",class:{"fc-black-small-txt-12":!_vm.hideToggle}},[_c("el-popover",{attrs:{placement:"bottom",trigger:"click",disabled:_vm.disablePopup}},[_c("span",{staticClass:"p8 pointer",class:[!_vm.disablePopup&&"button-hover"],attrs:{slot:"reference"},slot:"reference"},[_vm.from!==_vm.to?_c("span",[_vm._v(_vm._s(_vm.from)+" - ")]):_vm._e(),_c("span",[_vm._v(_vm._s(_vm.to))]),_vm._v(" of "+_vm._s(_vm.total)+" ")]),_c("el-pagination",{attrs:{layout:"prev, pager, next",total:_vm.total,"pager-count":5,"page-size":_vm.perPage,"current-page":_vm.page},on:{"current-change":_vm.handleCurrentChange,"update:pageSize":function($event){_vm.perPage=$event},"update:page-size":function($event){_vm.perPage=$event},"update:currentPage":function($event){_vm.page=$event},"update:current-page":function($event){_vm.page=$event}}})],1),_vm.hideToggle?_vm._e():_c("span",[_c("span",{staticClass:"el-icon-arrow-left pagination-arrow fc-black-small-txt-12 f16 fw-bold pointer p5",class:{disable:_vm.from<=1},on:{click:function($event){_vm.from>1&&_vm.prev()}}}),_c("span",{staticClass:"el-icon-arrow-right pagination-arrow fc-black-small-txt-12 f16 fw-bold pointer p5",class:{disable:_vm.to===_vm.total},on:{click:function($event){_vm.to!==_vm.total&&_vm.next()}}})])],1):_vm._e()])},staticRenderFns=[],router=(__webpack_require__(879288),__webpack_require__(670560),__webpack_require__(329435)),FPaginationvue_type_script_lang_js={props:{total:[Number,String],perPage:Number,hideToggle:{type:Boolean,default:!1},pageNo:Number,hidePopover:{type:Boolean,default:!1}},data:function(){return{from:0,to:0,page:1}},created:function(){(0,router/* isWebTabsEnabled */.tj)()&&document.addEventListener("keydown",this.keyDownHandler)},mounted:function(){this.init()},beforeDestroy:function(){(0,router/* isWebTabsEnabled */.tj)()&&document.removeEventListener("keydown",this.keyDownHandler)},computed:{pageQuery:function(){var _ref=this.$route||{},query=_ref.query,_ref2=query||{},page=_ref2.page;return parseInt(page)||1},hasMorePage:function(){return this.total/this.perPage>1},disablePopup:function(){return this.hidePopover||!this.hasMorePage}},watch:{total:function(){this.init()},pageQuery:function(){this.init()}},methods:{init:function(){if(this.page=this.pageQuery,this.from=(this.page-1)*this.perPage+1,this.from>this.total&&this.from&&this.from>0&&this.total&&this.total>0)this.reset();else{var to=this.from+this.perPage-1;this.to=this.total>to?to:this.total}},handleCurrentChange:function(val){this.page=val,this.from=(this.page-1)*this.perPage+1,this.to=this.total>=this.from+this.perPage?this.from+this.perPage-1:this.total,this.setPage()},next:function(){this.from=this.to+1,this.to+=this.perPage,this.to>this.total&&(this.to=this.total),this.page++,this.setPage()},prev:function(){this.to=this.from-1,this.from-=this.perPage,this.from<=1?this.from=this.page=1:this.page--,this.setPage()},reset:function(){this.page=1,this.setPage(!0)},setPage:function(isReset){if(this.pageNo)this.$emit("onPageChanged",this.page);else{var query={};Object.assign(query,this.$route.query),query?query.page=this.page:query={page:this.page},this.$router.push({query:query}),isReset||this.$emit("onPageChanged",this.page)}},keyDownHandler:function(e){e.shiftKey&&("ArrowRight"===e.key&&this.to!==this.total?this.next():"ArrowLeft"===e.key&&this.from>1&&this.prev())}}},list_FPaginationvue_type_script_lang_js=FPaginationvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(list_FPaginationvue_type_script_lang_js,render,staticRenderFns,!1,null,"7641710c",null)
/* harmony default export */,FPagination=component.exports},
/***/784823:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return AdvancedSearch}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/newapp/components/search/AdvancedSearch.vue?vue&type=template&id=66305202
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("div",{staticClass:"d-flex align-center",on:{click:function($event){return _vm.openCloseSearch(!0)}}},[_vm._t("icon",(function(){return[_c("InlineSvg",{staticClass:"d-flex mT3 cursor-pointer",attrs:{src:"svgs/search",iconClass:"icon icon-sm self-center mR5"}})]}))],2),_vm.canShowSearchWiz?_c("el-dialog",{attrs:{title:_vm.title,visible:_vm.canShowSearchWiz,fullscreen:!0,"append-to-body":!0,"custom-class":"advance-search-container"},on:{"update:visible":function($event){_vm.canShowSearchWiz=$event}}},[_c("AdvancedSearch",{attrs:{moduleName:_vm.moduleName,searchParam:_vm.searchParam,hideQuery:_vm.hideQuery,filterList:_vm.filterList},on:{applyFilters:_vm.applyFilters,closeDialog:function(){return _vm.openCloseSearch(!1)}}})],1):_vm._e()],1)},staticRenderFns=[],objectSpread2=__webpack_require__(595082),router=(__webpack_require__(634338),__webpack_require__(564043),__webpack_require__(61514),__webpack_require__(329435)),dist=__webpack_require__(191853),validation=__webpack_require__(990260),vuex_esm=__webpack_require__(420629),AdvancedSearchvue_type_script_lang_js={props:["moduleName","moduleDisplayName","filterList","hideQuery","onSave"],components:{AdvancedSearch:dist/* AdvancedSearch */.ZJ},data:function(){return{searchText:"",canShowSearchWiz:!1,isSaving:!1,searchableFields:[],isOpenWizPressed:!1}},created:function(){(0,router/* isWebTabsEnabled */.tj)()&&(document.addEventListener("keydown",this.keyDownHandler),document.addEventListener("keyup",this.keyUpHandler))},beforeDestroy:function(){(0,router/* isWebTabsEnabled */.tj)()&&(document.removeEventListener("keydown",this.keyDownHandler),document.removeEventListener("keyup",this.keyUpHandler))},computed:{title:function(){var moduleDisplayName=this.moduleDisplayName,title="".concat(this.$t("commissioning.sheet.filter")," ").concat(moduleDisplayName," ").concat(this.$t("filters.search.by"));return title},searchParam:function(){var $route=this.$route,_ref=$route||{},query=_ref.query,_ref2=query||{},search=_ref2.search;return(0,validation/* isEmpty */.xb)(search)?"":search}},mounted:function(){this.fetchSearchableFields({moduleName:this.moduleName})},methods:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapActions */.nv)({fetchSearchableFields:"search/fetchSearchableFields"})),{},{openCloseSearch:function(canShow){this.searchText="",this.canShowSearchWiz=canShow},applyFilters:function(filters){var hideQuery=this.hideQuery;hideQuery?this.onSave({filters:filters}):this.$store.dispatch("search/applyFilters",filters),this.openCloseSearch(!1)},keyDownHandler:function(e){if(e.shiftKey&&"Slash"===e.code)this.isOpenWizPressed=!0;else{var _navigator=navigator,userAgentData=_navigator.userAgentData,platform=_navigator.platform,_ref3=userAgentData||{},userPlatform=_ref3.platform,currentOS=userPlatform||platform,isMac=currentOS.toUpperCase().indexOf("MAC")>=0;(isMac&&e.metaKey||!isMac&&e.ctrlKey)&&"Enter"===e.key&&this.applyFilter()}},keyUpHandler:function(){this.isOpenWizPressed&&(this.openCloseSearch(!0),this.isOpenWizPressed=!1)}})},search_AdvancedSearchvue_type_script_lang_js=AdvancedSearchvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(search_AdvancedSearchvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,AdvancedSearch=component.exports},
/***/199029:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return ControllerFilter}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/setup/agents/ControllerFilter.vue?vue&type=template&id=3d2f4fc8
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("el-row",{staticClass:"mT20",attrs:{gutter:20}},[_c("el-col",{attrs:{span:5}},[_c("div",{staticClass:"category-blue-txt pB10"},[_vm._v(_vm._s(_vm.$t("setup.setup.agent")))]),_c("el-select",{staticClass:"fc-input-full-border-select2 flLeft",attrs:{filterable:"",placeholder:"Select Agent",width:"250px"},on:{change:_vm.loadControllers},model:{value:_vm.selectedAgent,callback:function($$v){_vm.selectedAgent=$$v},expression:"selectedAgent"}},_vm._l(_vm.agents,(function(agent,index){return _c("el-option",{key:index,attrs:{label:agent.name,value:agent.id,"no-data-text":"No agents available"}})})),1)],1),_c("el-col",{attrs:{span:4}},[_c("div",{staticClass:"category-blue-txt pB10"},[_vm._v("Type")]),_c("el-select",{staticClass:"fc-input-full-border-select2 flLeft",attrs:{filterable:"",placeholder:"Select Type",width:"250px"},on:{change:_vm.onTypeChange},model:{value:_vm.selectedType,callback:function($$v){_vm.selectedType=$$v},expression:"selectedType"}},[_vm._l(_vm.$constants.ControllerTypes,(function(label,value){return[_vm.availableTypes.includes(parseInt(value))?_c("el-option",{key:value,attrs:{label:label,value:parseInt(value)}}):_vm._e()]}))],2)],1),_c("el-col",{attrs:{span:5}},[_c("div",{staticClass:"category-blue-txt pB10"},[_vm._v("Controller")]),_c("el-select",{staticClass:"fc-input-full-border-select2 flLeft",attrs:{filterable:"",placeholder:"Select Controller",width:"250px"},on:{change:function($event){return _vm.onControllerSelected()}},model:{value:_vm.selectedControllerId,callback:function($$v){_vm.selectedControllerId=$$v},expression:"selectedControllerId"}},_vm._l(_vm.filteredControllers,(function(controller,index){return _c("el-option",{key:index,attrs:{label:controller.name,value:controller.id,"no-data-text":"No controllers available"}})})),1)],1),_vm._t("default")],2)],1)},staticRenderFns=[],ControllerFiltervue_type_script_lang_js=(__webpack_require__(450886),__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(425728),{props:["loading"],data:function(){return{agents:[],selectedAgent:null,selectedType:null,controllers:[],selectedControllerId:null}},computed:{availableTypes:function(){return this.controllers.map((function(controller){return controller.controllerType}))},filteredControllers:function(){var _this=this;return this.controllers.filter((function(controller){return controller.controllerType===_this.selectedType}))},selectedController:function(){var _this2=this;return this.selectedControllerId?this.controllers.find((function(controller){return controller.id===_this2.selectedControllerId})):null}},mounted:function(){this.loadAgents()},methods:{loadAgents:function(){var _this3=this;this.setLoading(!0),this.$http.get("/v2/setup/agent/list").then((function(response){_this3.agents=response.data.result.agentDetails?response.data.result.agentDetails:[],_this3.agents.length?(_this3.selectedAgent=parseInt(_this3.$route.params.agentId)||_this3.agents[0].id,_this3.loadControllers()):_this3.setLoading(!1)})).catch((function(){_this3.agents=[],_this3.setLoading(!1)}))},loadControllers:function(){var _this4=this;this.setLoading(!0),this.selectedType=null,this.selectedControllerId=null,this.controllers=[],this.$http.get("/v2/setup/controllers?agentId=".concat(this.selectedAgent)).then((function(response){_this4.controllers=response.data.result.controllers?response.data.result.controllers.filter((function(c){return c.controllerType>-1})):[],_this4.controllers.length?(_this4.selectedControllerId=parseInt(_this4.$route.params.controllerId)||_this4.controllers[0].id,_this4.selectedType=_this4.selectedController.controllerType,_this4.onControllerSelected()):_this4.setLoading(!1)})).catch((function(_){_this4.controllers=[],_this4.setLoading(!1)}))},onTypeChange:function(){this.selectedControllerId=this.filteredControllers[0].id,this.onControllerSelected()},setLoading:function(isLoading){this.$emit("update:loading",isLoading)},onControllerSelected:function(){this.$emit("onControllerSelected",this.selectedController)}}}),agents_ControllerFiltervue_type_script_lang_js=ControllerFiltervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(agents_ControllerFiltervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,ControllerFilter=component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/21683.js.map