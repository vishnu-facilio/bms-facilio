(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[39836],{
/***/23324:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FieldMatcher2}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/FieldMatcher2.vue?vue&type=template&id=5224790a
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-form",{attrs:{inline:!0,"label-position":"left"}},_vm._l(_vm.fieldMatchers,(function(fieldMatcher,index){return _c("div",{key:index,staticClass:"field-matcher-bg"},[_c("el-row",{staticStyle:{margin:"0px","padding-top":"10px","padding-bottom":"15px"},attrs:{align:"middle",gutter:50}},[_c("el-col",{staticStyle:{"padding-left":"0px","padding-right":"0","margin-right":"20px"},attrs:{span:10}},[_c("div",{staticClass:"add"},[_c("el-select",{staticClass:"fc-border-select fc-input-full-border-select2 width100",attrs:{filterable:"","allow-create":"","default-first-option":"",placeholder:"Enter field name"},model:{value:fieldMatcher.field,callback:function($$v){_vm.$set(fieldMatcher,"field",$$v)},expression:"fieldMatcher.field"}},_vm._l(_vm.fieldList,(function(item){return _c("el-option",{key:item.value,attrs:{label:item.label,value:item.value}})})),1)],1)]),"alarmType"===fieldMatcher.field?_c("el-col",{staticStyle:{"padding-left":"0px","padding-right":"0"},attrs:{span:10}},[_c("el-select",{staticClass:"fc-border-select fc-input-full-border-select2",model:{value:fieldMatcher.value,callback:function($$v){_vm.$set(fieldMatcher,"value",$$v)},expression:"fieldMatcher.value"}},_vm._l(_vm.picklistOptions[fieldMatcher.field],(function(value,key){return _c("el-option",{key:key,attrs:{label:value,value:key}})})),1)],1):_c("el-col",{staticStyle:{"padding-left":"0px","padding-right":"0"},attrs:{span:10}},[_c("div",{staticClass:"add"},[_c("el-input",{staticClass:"fc-border-select fc-input-full-border-select2",attrs:{type:"text",placeholder:"Enter value"},model:{value:fieldMatcher.value,callback:function($$v){_vm.$set(fieldMatcher,"value",$$v)},expression:"fieldMatcher.value"}})],1)]),_c("el-col",{staticStyle:{"padding-top":"9px","padding-left":"10px","padding-right":"0"},attrs:{span:3}},[_c("img",{staticClass:"delete-icon",staticStyle:{height:"18px",width:"18px","margin-right":"4px"},attrs:{src:__webpack_require__(353654)},on:{click:_vm.addRow}}),1!==Object.keys(_vm.fieldMatchers).length?_c("img",{staticClass:"delete-icon",staticStyle:{height:"18px",width:"18px","margin-right":"3px"},attrs:{src:__webpack_require__(385769)},on:{click:function($event){return _vm.deleteRow(index)}}}):_vm._e()])],1)],1)})),0)},staticRenderFns=[],FieldMatcher2vue_type_script_lang_js=(__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(670560),__webpack_require__(162506),{props:["size","value","fields"],data:function(){return{picklistOptions:{},fieldMatchers:[{field:"",regex:""}],regex:null,fieldSeries:[{label:"Type",value:"type"},{label:"Subject",value:"subject"},{label:"Status",value:"status"},{label:"Space",value:"space"},{label:"Source Type",value:"sourcetype"},{label:"Serial Number",value:"serialnumber"},{label:"Scheduled Start",value:"scheduledstart"},{label:"Priority",value:"priority"},{label:"Tasks",value:"tasks"},{label:"Comments",value:"comments"},{label:"Closed Tasks",value:"closedtasks"},{label:"Attachments",value:"attachments"},{label:"Is Acknowledged",value:"isacknowledged"},{label:"Estimated End",value:"estimatedend"},{label:"Due Date",value:"duedate"},{label:"Device",value:"device"},{label:"Description",value:"description"},{label:"Created Time",value:"createdtime"},{label:"Cleared Time",value:"clearedtime"},{label:"Category",value:"category"},{label:"Assignment Group",value:"assignmentgroup"},{label:"Assigned To",value:"assignedto"},{label:"Asset",value:"asset"},{label:"Alarm Status",value:"alarmstatus"},{label:"Actual Work Start",value:"actualworkstart"},{label:"Actual Work End",value:"actualworkend"},{label:"Acknowledged Time",value:"acknowledgedtime"},{label:"Acknowledged By",value:"acknowledgedby"},{label:"Severity",value:"severity"},{value:"source",label:"Source"},{value:"condition",label:"Condition"},{value:"eventMessage",label:"Event Message"},{value:"alarmClass",label:"Alarm Class"},{label:"Category",value:"alarmType"}]}},computed:{fieldList:function(){var fieldsToReturn=this.fields||["alarmClass","priority"];return this.fieldSeries.filter((function(field){return fieldsToReturn.includes(field.value)}))}},mounted:function(){this.picklistOptions.alarmType=this.$constants.AlarmCategory,this.init()},watch:{fieldMatchers:function(newVal){this.$emit("input",this.fieldMatchers)}},methods:{init:function(){this.value&&(this.fieldMatchers=this.value,this.value.length||this.addRow())},addRow:function(){this.fieldMatchers.push({field:"",value:""})},deleteRow:function(index){this.fieldMatchers.splice(index,1)}}}),components_FieldMatcher2vue_type_script_lang_js=FieldMatcher2vue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FieldMatcher2vue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FieldMatcher2=component.exports},
/***/410806:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FCriteriaBuilder}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/criteria/FCriteriaBuilder.vue?vue&type=template&id=8977952a
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.loading?_vm._e():_c("div",{staticClass:"f-criteria-builder"},[_c("f-criteria-group",{attrs:{rule:_vm.criteriaGroup,moduleMeta:_vm.moduleMeta,size:_vm.fieldSize,isroot:"true",threshold:_vm.threshold,thresholdFieldName:_vm.thresholdFieldName},on:{removeChild:_vm.removeChild,thresholdmetric:_vm.thresholdmetric}})],1)},staticRenderFns=[],createForOfIteratorHelper=__webpack_require__(566347),FCriteriaGroupvue_type_template_id_96f43c26_render=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(434284),__webpack_require__(564043),__webpack_require__(322462),__webpack_require__(162506),__webpack_require__(670560),__webpack_require__(169358),__webpack_require__(506203),function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"f-criteria-group",class:{rootgroup:_vm.isroot&&!_vm.threshold,subgroup:!_vm.isroot&&!_vm.threshold,threshold:_vm.threshold}},[_c("el-card",{staticClass:"box-card"},[_c("div",{attrs:{slot:"header"},slot:"header"},[_vm.isroot&&!_vm.threshold?_c("span",[_c("span",{staticClass:"MATCH-TYPE"},[_vm._v("   MATCH TYPE   ")]),_vm.isroot?_c("span",{staticClass:"MATCH-TYPE"}):_vm._e(),_c("el-dropdown",{attrs:{trigger:"click"},on:{command:_vm.switchOperator},model:{value:_vm.rule.operator,callback:function($$v){_vm.$set(_vm.rule,"operator",$$v)},expression:"rule.operator"}},[_c("span",{staticClass:"el-dropdown-link"},[_c("span",{staticClass:"pointer"},[_c("span",{staticClass:"allwhite"},[_vm._v(" "+_vm._s(_vm.getOperatorLabel(_vm.rule.operator))),_c("i",{staticClass:"el-icon-arrow-down el-icon--right"})])])]),_c("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[_c("el-dropdown-item",{attrs:{command:"all"}},[_vm._v("ALL")]),_c("el-dropdown-item",{attrs:{command:"any"}},[_vm._v("ANY")])],1)],1)],1):_vm._e(),_vm.isroot?_vm._e():_c("span",[_c("span",{staticClass:"WATCH-TYPE"},[_vm._v("  MATCH TYPE  ")]),_vm.isroot?_vm._e():_c("span",{staticClass:"WATCH-TYPE"}),_c("el-dropdown",{attrs:{trigger:"click"},on:{command:_vm.switchOperator},model:{value:_vm.rule.operator,callback:function($$v){_vm.$set(_vm.rule,"operator",$$v)},expression:"rule.operator"}},[_c("span",{staticClass:"el-dropdown-link"},[_c("span",{staticClass:"pointer"},[_c("span",{staticClass:"all"},[_vm._v(" "+_vm._s(_vm.rule.operator)),_c("i",{staticClass:"el-icon-arrow-down el-icon--right"})])])]),_c("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[_c("el-dropdown-item",{attrs:{command:"ALL"}},[_vm._v("ALL")]),_c("el-dropdown-item",{attrs:{command:"ANY"}},[_vm._v("ANY")])],1)],1)],1),_vm.isroot?_vm._e():_c("el-button",{staticStyle:{float:"right",padding:"3px 0","font-size":"17px"},attrs:{type:"text",icon:"el-icon-minus"},on:{click:_vm.remove}})],1),_vm._l(_vm.rule.children,(function(child,idx){return _c(child.type,{key:idx,tag:"component",attrs:{index:idx,rule:child,size:_vm.size,moduleMeta:_vm.moduleMeta,threshold:_vm.threshold,thresholdFieldName:_vm.thresholdFieldName},on:{removeChild:_vm.removeChild,add:_vm.addRule,thresholdmetric:_vm.thresholdmetric}})})),_vm.isroot?_vm._e():_c("el-button",{staticClass:"adcomp",staticStyle:{"font-size":"17px",width:"16px",color:"#8778bb"},attrs:{type:"text",icon:"el-icon-circle-plus"},on:{click:_vm.addRule}}),_vm.isroot&&!_vm.threshold?_c("div",{staticStyle:{"margin-top":"21px","margin-bottom":"8px","margin-left":"0px"}},[_c("el-button",{staticStyle:{"border-color":"#39b2c2","font-size":"11px",color:"#39b2c2","font-weight":"bold"},attrs:{round:"",size:_vm.size,plain:"",icon:"el-icon-plus"},on:{click:_vm.addGroup}},[_vm._v("ADD GROUP")]),_vm.threshold?_vm._e():_c("el-button",{staticStyle:{"border-color":"#39b2c2","font-size":"11px",color:"#39b2c2","font-weight":"bold"},attrs:{round:"",size:_vm.size,icon:"el-icon-plus"},on:{click:_vm.addRule}},[_vm._v("ADD CONDITION")])],1):_vm._e()],2)],1)}),FCriteriaGroupvue_type_template_id_96f43c26_staticRenderFns=[],FCriteriaRulevue_type_template_id_1ccc6516_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"f-criteria-rule"},[_vm.rule.active?_c("div",[_c("el-card",{staticClass:"box-card active"},[_c("el-row",{staticStyle:{"margin-top":"-6px"},attrs:{gutter:10,span:8,align:"middle"}},[_c("el-col",{attrs:{md:6,lg:6}},[_vm.threshold?_c("el-select",{attrs:{disabled:"",size:_vm.size},model:{value:_vm.rule.fieldName,callback:function($$v){_vm.$set(_vm.rule,"fieldName",$$v)},expression:"rule.fieldName"}},_vm._l(_vm.moduleMeta.fields,(function(field,index){return _c("el-option",{key:index,attrs:{label:field.displayName,value:field.name}})})),1):_c("el-select",{attrs:{size:_vm.size},model:{value:_vm.rule.fieldName,callback:function($$v){_vm.$set(_vm.rule,"fieldName",$$v)},expression:"rule.fieldName"}},_vm._l(_vm.moduleMeta.fields,(function(field,index){return _c("el-option",{key:index,attrs:{label:field.displayName,value:field.name}})})),1)],1),_c("el-col",{attrs:{md:6,lg:6}},[_c("el-select",{staticClass:"rule-part",attrs:{size:_vm.size,disabled:!_vm.getOperators,filterable:"",placeholder:"Select operator"},model:{value:_vm.rule.operator,callback:function($$v){_vm.$set(_vm.rule,"operator",$$v)},expression:"rule.operator"}},_vm._l(_vm.getOperators,(function(operator,key){return _c("el-option",{key:operator,attrs:{label:key,value:key}})})),1)],1),_c("el-col",{staticStyle:{"background-color":"#fff"},attrs:{md:_vm.threshold?12:11,lg:_vm.threshold?12:11}},[_vm.isValueNeeded?_vm.getValueDataType?_c("div",[_vm.threshold||"NUMBER"!==_vm.getValueDataType.dataType&&"DECIMAL"!==_vm.getValueDataType.dataType?"NUMBER"===_vm.getValueDataType.dataType||"DECIMAL"===_vm.getValueDataType.dataType?_c("el-input",{staticClass:"rule-part",attrs:{size:_vm.size,type:"number"},model:{value:_vm.rule.value,callback:function($$v){_vm.$set(_vm.rule,"value",$$v)},expression:"rule.value"}}):"BOOLEAN"===_vm.getValueDataType.dataType?_c("el-select",{staticClass:"rule-part",attrs:{size:_vm.size},model:{value:_vm.rule.value,callback:function($$v){_vm.$set(_vm.rule,"value",$$v)},expression:"rule.value"}},[_c("el-option",{attrs:{label:"Yes",value:"true"}}),_c("el-option",{attrs:{label:"No",value:"false"}})],1):"DATE"===_vm.getValueDataType.dataType?_c("f-date-picker",{staticClass:"rule-part",attrs:{size:_vm.size,type:_vm.rule.operator.indexOf("between")>=0?"daterange":"date"},model:{value:_vm.rule.value,callback:function($$v){_vm.$set(_vm.rule,"value",$$v)},expression:"rule.value"}}):"DATE_TIME"===_vm.getValueDataType.dataType?_c("f-date-picker",{staticClass:"rule-part",attrs:{size:_vm.size,type:_vm.rule.operator.indexOf("between")>=0?"datetimerange":"datetime"},model:{value:_vm.rule.value,callback:function($$v){_vm.$set(_vm.rule,"value",$$v)},expression:"rule.value"}}):"LOOKUP"===_vm.getValueDataType.dataType&&"LOOKUP_SIMPLE"===_vm.getValueDataType.displayType||"LOOKUP"===_vm.getValueDataType.dataType&&"LOOKUP_POPUP"===_vm.getValueDataType.displayType?_c("el-select",{staticClass:"rule-part",attrs:{size:_vm.size,filterable:"",multiple:""},model:{value:_vm.rule.value,callback:function($$v){_vm.$set(_vm.rule,"value",$$v)},expression:"rule.value"}},_vm._l(_vm.picklistOptions,(function(value,key){return _c("el-option",{key:key,attrs:{label:value,value:key}})})),1):"LOOKUP"===_vm.getValueDataType.dataType&&"LOOKUP_POPUP1"===_vm.getValueDataType.displayType?_c("el-input",{staticClass:"rule-part",attrs:{size:_vm.size,placeholder:"Select records",readonly:!0,"suffix-icon":"el-icon-search"},model:{value:_vm.rule.value,callback:function($$v){_vm.$set(_vm.rule,"value",$$v)},expression:"rule.value"}}):_c("el-input",{staticClass:"rule-part",attrs:{size:_vm.size},model:{value:_vm.rule.value,callback:function($$v){_vm.$set(_vm.rule,"value",$$v)},expression:"rule.value"}}):_c("el-input-number",{staticClass:"rule-part",attrs:{size:_vm.size},model:{value:_vm.rule.value,callback:function($$v){_vm.$set(_vm.rule,"value",$$v)},expression:"rule.value"}})],1):_vm._e():_c("div",[_c("el-input",{staticClass:"rule-part",attrs:{size:_vm.size,disabled:""},model:{value:_vm.rule.value,callback:function($$v){_vm.$set(_vm.rule,"value",$$v)},expression:"rule.value"}})],1)]),0!==_vm.index?_c("el-button",{staticStyle:{float:"right","font-size":"13px",color:"black","margin-top":"-3px"},attrs:{type:"text",icon:"el-icon-delete"},on:{click:_vm.remove}}):_vm._e()],1)],1)],1):_c("div",{on:{click:_vm.toggle}},[_c("el-card",{staticClass:"box-card normal"},[_c("el-row",{attrs:{gutter:10,span:8,align:"middle"}},[_c("el-col",{attrs:{md:6,lg:6}},[_c("span",{staticClass:"pointer"},[_c("span",{staticClass:"Alarm-Class"},[_vm._v(_vm._s(_vm.rule.fieldName))])])]),_c("el-col",{attrs:{md:6,lg:6}},[_c("span",{staticClass:"pointer"},[_c("span",{staticClass:"Alarm-Class"},[_vm._v(_vm._s(_vm.rule.operator))])])]),_c("el-col",{attrs:{md:11,lg:11}},[_c("span",{staticClass:"pointer"},[_c("span",{staticClass:"Alarm-Class"},[_vm._v(_vm._s(_vm.rule.value))])])]),0!==_vm.index?_c("el-button",{staticClass:"pull-right",staticStyle:{"font-size":"13px",color:"black","margin-top":"-10px"},attrs:{type:"text",icon:"el-icon-delete"},on:{click:_vm.remove}}):_vm._e()],1)],1)],1)])},FCriteriaRulevue_type_template_id_1ccc6516_staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),FDatePicker=(__webpack_require__(538077),__webpack_require__(358551)),picklist=__webpack_require__(961358),FCriteriaRulevue_type_script_lang_js={name:"f-criteria-rule",props:["index","rule","moduleMeta","size","threshold","thresholdFieldName"],components:{FDatePicker:FDatePicker/* default */.Z},data:function(){return{picklistOptions:{},valueNotNeed:["is empty","is not empty","Today","Tomorrow","Yesterday","Starting Tomorrow","Till Yesterday","Last Month","Current Month","Next Month","Last Week","Current Week","Next Week"]}},watch:{"rule.fieldName":function(val){this.threshold&&this.$emit("thresholdmetric",val)}},created:function(){this.$store.dispatch("loadGroups")},mounted:function(){this.setThresholdMetric()},computed:{getOperators:function(){var _this=this;if(this.rule.fieldName&&""!==this.rule.fieldName){var field=this.moduleMeta.fields.filter((function(field){return field.name===_this.rule.fieldName}));if(field.length){if("LOOKUP"===field[0].dataTypeEnum._name&&field[0].specialType?this.loadSpecialTypePickList(field[0].specialType):"LOOKUP"===field[0].dataTypeEnum._name&&field[0].lookupModule&&this.loadPickList(field[0].lookupModule.name),field[0].specialType&&"basespace"===field[0].specialType){var oprs=this.moduleMeta.operators[field[0].dataTypeEnum._name];return oprs["is"]="BUILDING_IS",oprs}return this.moduleMeta.operators[field[0].dataTypeEnum._name]}}return null},getValueDataType:function(){var _this2=this;if(this.rule.operator&&""!==this.rule.operator){var field=this.moduleMeta.fields.filter((function(field){return field.name===_this2.rule.fieldName}));return"DATE"!==field[0].dataTypeEnum._name&&"DATE_TIME"!==field[0].dataTypeEnum._name||"Age in Days"!==this.rule.operator&&"Due in Days"!==this.rule.operator?{dataType:field[0].dataTypeEnum._name,displayType:field[0].displayType._name}:{dataType:"NUMBER",displayType:"NUMBER"}}return null},isValueNeeded:function(){if(this.rule.operator&&""!==this.rule.operator){var bool=-1===this.valueNotNeed.indexOf(this.rule.operator);return bool||(this.rule.value=""),bool}return this.rule.value="",!1}},methods:{setThresholdMetric:function(){this.rule.fieldName=this.thresholdFieldName},loadSpecialTypePickList:function(specialType){var self=this;if(self.picklistOptions={},"users"===specialType){var userList=self.$store.state.users;self.picklistOptions["${LOGGED_USER}"]="Current User";var _step,_iterator=(0,createForOfIteratorHelper/* default */.Z)(userList);try{for(_iterator.s();!(_step=_iterator.n()).done;){var user=_step.value;self.picklistOptions[user.id]=user.name}}catch(err){_iterator.e(err)}finally{_iterator.f()}}else if("groups"===specialType){var _step2,groupList=self.$store.state.groups,_iterator2=(0,createForOfIteratorHelper/* default */.Z)(groupList);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var group=_step2.value;self.picklistOptions[group.groupId]=group.name}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}else if("basespace"===specialType){var _step3,spaceList=self.$store.state.spaces,_iterator3=(0,createForOfIteratorHelper/* default */.Z)(spaceList);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var space=_step3.value;self.picklistOptions[space.id]=space.name}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}}},toggle:function(){this.rule.active=!this.rule.active},loadPickList:function(moduleName){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var _yield$getFieldOption,error,options;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _this3.picklistOptions={},_context.next=3,(0,picklist/* getFieldOptions */._K)({field:{lookupModuleName:moduleName,skipDeserialize:!0}});case 3:_yield$getFieldOption=_context.sent,error=_yield$getFieldOption.error,options=_yield$getFieldOption.options,error?_this3.$message.error(error.message||"Error Occured"):_this3.picklistOptions=options;case 7:case"end":return _context.stop()}}),_callee)})))()},remove:function(){this.$emit("removeChild",this.index)},add:function(){this.isroot||this.$emit("add",this.index)}}},criteria_FCriteriaRulevue_type_script_lang_js=FCriteriaRulevue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(criteria_FCriteriaRulevue_type_script_lang_js,FCriteriaRulevue_type_template_id_1ccc6516_render,FCriteriaRulevue_type_template_id_1ccc6516_staticRenderFns,!1,null,null,null)
/* harmony default export */,FCriteriaRule=component.exports,FCriteriaGroupvue_type_script_lang_js={data:function(){return{click:!1,rules:{label:"",value:""}}},name:"f-criteria-group",components:{FCriteriaRule:FCriteriaRule},mounted:function(){this.addRuleForRoot()},props:["index","rule","moduleMeta","size","isroot","threshold","thresholdFieldName"],methods:{thresholdmetric:function(val){this.$emit("thresholdmetric",val)},addRuleForRoot:function(){this.isroot&&this.rule.children.push({type:"f-criteria-rule",fieldName:"",operator:"",value:"",active:!0})},addRule:function(){
// if (!this.rule.children[i].fieldName === null) {
for(var i=0;i<this.rule.children.length;i++){var r=this.rule.children[i];""!==r.fieldName&&(r.active=!1)}this.rule.children.push({type:"f-criteria-rule",fieldName:"",operator:"",value:"",active:!0})},switchOperator:function(operator){this.rule.operator=operator},test:function(){},addGroup:function(){var self=this;self.rule.children.push({type:"f-criteria-group",operator:"ALL",children:[{type:"f-criteria-rule",fieldName:"",operator:"",value:"",active:!0}]})},removeChild:function(index){this.rule.children.splice(index,1)},remove:function(){this.$emit("removeChild",this.index)},getOperatorLabel:function(operator){return"all"===operator?"ALL":"ANY"}}},criteria_FCriteriaGroupvue_type_script_lang_js=FCriteriaGroupvue_type_script_lang_js,FCriteriaGroup_component=(0,componentNormalizer/* default */.Z)(criteria_FCriteriaGroupvue_type_script_lang_js,FCriteriaGroupvue_type_template_id_96f43c26_render,FCriteriaGroupvue_type_template_id_96f43c26_staticRenderFns,!1,null,null,null)
/* harmony default export */,FCriteriaGroup=FCriteriaGroup_component.exports,FCriteriaBuildervue_type_script_lang_js={props:["module","value","size","threshold","readingobj","resourceType","thresholdFieldName"],components:{FCriteriaGroup:FCriteriaGroup},data:function(){return{loading:!0,moduleMeta:null,criteriaGroup:null}},created:function(){this.$store.dispatch("loadSpaceCategory")},mounted:function(){var self=this;this.criteriaGroup=this.parseCriteriaObject(),this.loadModuleMeta(),this.$watch("criteriaGroup",(function(newVal){var criteriaObject=self.constructCriteriaObject(newVal);this.$emit("input",criteriaObject)}),{deep:!0})},
// watch: {
//   readingobj (val) {
//     if (this.threshold && this.module === 'asset') {
//       this.loadModuleMeta()
//     }
//   }
// },
computed:{fieldSize:function(){return this.size?this.size:"small"}},methods:{thresholdmetric:function(val){!this.threshold||"asset"!==this.module&&"space"!==this.module||this.$emit("thresholdfield",this.moduleMeta.fields.find((function(field){return field.name===val})))},loadModuleMeta:function(){var self=this;if(self.loading=!0,!self.threshold||"asset"!==self.module&&"space"!==self.module)self.$http.get("/module/meta?moduleName="+this.module).then((function(response){self.moduleMeta=response.data.meta,self.loading=!1}));else{var url=null;"asset"===self.module?url="/module/meta?moduleName="+self.module+"&assetId="+self.readingobj.id+"&categoryId="+self.readingobj.category.id+"&resourceType="+self.module:"space"===self.module&&(url="/module/meta?moduleName="+self.module+"&assetId="+self.readingobj.id+"&categoryId="+self.readingobj.spaceCategory.id+"&resourceType="+self.module),
// self.$http.get('/reading/getassetlatestdata?parentId=' + self.readingobj.id + '&parentCategoryId=' + self.readingobj.category.id)
self.$http.get(url).then((function(response){self.moduleMeta=response.data.meta,self.loading=!1}))}},parseCriteriaObject:function(){var criteriaObj={type:"f-criteria-group",operator:"all",children:[]};if(this.value){var SPLIT_REGX=/([1-9]\d*)|(\()|(\))|(and)|(or)/gi,matchList=this.value.pattern.match(SPLIT_REGX);matchList&&matchList.length&&(1===matchList.length&&(matchList.splice(0,0,"("),matchList.splice(2,0,")")),criteriaObj=this.parseCriteriaGroup(matchList,1))}return criteriaObj},parseCriteriaGroup:function(list,index){for(var group={type:"f-criteria-group",operator:"all",children:[]},i=index;i<list.length;i++){var match=list[i];if("("===match)return group.children.push(this.parseCriteriaGroup(list,i+1)),group;if(")"===match)return group;if("or"===match||"and"===match)group.operator="or"===match?"any":"all";else if(this.value.conditions[match]){var condition=this.value.conditions[match];if(condition.type="f-criteria-rule",condition.field&&condition.value&&""!==condition.value)if(-1!==condition.field.dataTypeEnum._name.indexOf("DATE")){var arr=condition.value.split(",");if(1===arr.length)condition.value=new Date(parseInt(arr[0]));else{var _step,dateList=[],_iterator=(0,createForOfIteratorHelper/* default */.Z)(arr);try{for(_iterator.s();!(_step=_iterator.n()).done;){var dateStr=_step.value;dateList.push(new Date(parseInt(dateStr)))}}catch(err){_iterator.e(err)}finally{_iterator.f()}condition.value=dateList}}else"LOOKUP"===condition.field.dataTypeEnum._name&&(condition.value=condition.value.split(","));group.children.push(condition)}}return group},constructCriteriaObject:function(obj){var pattern="",conditions={},seq=1;return obj&&(pattern=this.constructCriteriaGroup(seq,conditions,obj.operator,obj.children)),""!==pattern&&"()"!==pattern&&Object.keys(conditions).length>0?{pattern:pattern,conditions:conditions}:null},constructCriteriaGroup:function(seq,conditions,operator,children){var _this=this;if(!children.length)return"";for(var ptn="(",_loop=function(){var child=children[i];if(!("f-criteria-rule"!==child.type||child.fieldName&&""!==child.fieldName&&child.operator&&""!==child.operator))
// if condition is empty, skip it in the criteria
return 0;// continue
if("f-criteria-group"===child.type&&!child.children.length)
// if condition group is empty, skip it in the criteria
return 0;// continue
if(0!==i&&(ptn+=" "+("all"===operator?"and":"or")+" "),"f-criteria-group"===child.type&&child.children.length)ptn+=_this.constructCriteriaGroup(seq,conditions,child.operator,child.children);else{var condition=_this.$helpers.cloneObject(child),field=_this.moduleMeta.fields.find((function(field){return field.name===condition.fieldName}));if(Array.isArray(condition.value))if(2===condition.value.length&&condition.value[0]instanceof Date){
// date range
var val=condition.value[0].getTime()+","+condition.value[1].getTime();condition.value=val}else condition.value=condition.value.join();else condition.value instanceof Date&&(condition.value=condition.value.getTime());condition.operator&&(condition.operatorId=_this.moduleMeta.operators[field.dataTypeEnum._name][condition.operator].operatorId,delete condition.operator),condition.columnName=field.extendedModule.tableName+"."+field.columnName,ptn+=seq,conditions[seq]=condition,seq++}},i=0;i<children.length;i++)_loop();return ptn+=")",ptn},removeChild:function(index){this.criteriaObj.children.splice(index,1)}}},criteria_FCriteriaBuildervue_type_script_lang_js=FCriteriaBuildervue_type_script_lang_js,FCriteriaBuilder_component=(0,componentNormalizer/* default */.Z)(criteria_FCriteriaBuildervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FCriteriaBuilder=FCriteriaBuilder_component.exports},
/***/358551:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FDatePicker}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/assets/overview/FDatePicker.vue?vue&type=template&id=fd3cfbc4
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-date-picker",{ref:"date-picker",attrs:{appendToBody:_vm.appendToBody,clearable:!_vm.hideClear,type:_vm.type,"value-format":_vm.valueFormat,format:_vm.pickerFormat,placeholder:_vm.placeholder,disabled:_vm.disabled,editable:_vm.editable,"default-value":_vm.defaultValue,"picker-options":_vm.pickerOptions,"prefix-icon":_vm.prefixIcon,"clear-icon":_vm.clearIcon,"start-placeholder":_vm.startPlaceholder,"end-placeholder":_vm.endPlaceholder,"time-arrow-control":_vm.arrowControl,"default-time":_vm.defaultTime},on:{change:_vm.pickerChange},model:{value:_vm.ttime,callback:function($$v){_vm.ttime=$$v},expression:"ttime"}})},staticRenderFns=[],validation=(__webpack_require__(976801),__webpack_require__(564043),__webpack_require__(857267),__webpack_require__(756532),__webpack_require__(634338),__webpack_require__(450886),__webpack_require__(843843),__webpack_require__(990260)),constant=__webpack_require__(354754),moment_timezone=__webpack_require__(480008),moment_timezone_default=__webpack_require__.n(moment_timezone),FDatePickervue_type_script_lang_js={props:["appendToBody","value","value-format","format","default-value","placeholder","disabled","editable","picker-options","type","prefix-icon","clear-icon","start-placeholder","end-placeholder","hideClear","arrowControl","default-time"],mounted:function(){this.init()},data:function(){return{timeinorg:[]}},computed:{isRangeType:function(){var _ref=this||{},type=_ref.type;return["daterange","datetimerange"].includes(type)},defaultFormats:function(){var $timeformat=this.$timeformat,$dateformat=this.$dateformat,dateformat=($dateformat||"").replaceAll("Y","y");return dateformat=(dateformat||"").replaceAll("D","d"),{date:dateformat,month:"yyyy-MM",datetime:"".concat(dateformat," ").concat($timeformat),time:"".concat($timeformat),week:"yyyywWW",timerange:"".concat($timeformat),daterange:"".concat(dateformat),monthrange:"yyyy-MM",datetimerange:"".concat(dateformat," ").concat($timeformat),year:"yyyy"}},pickerFormat:function(){var _ref2=this||{},defaultFormats=_ref2.defaultFormats,type=_ref2.type,format=_ref2.format;return(0,validation/* isEmpty */.xb)(format)&&!(0,validation/* isEmpty */.xb)(defaultFormats[type])?defaultFormats[type]:format},ttime:{get:function(){var _this=this,_ref3=this||{},value=_ref3.value,isRangeType=_ref3.isRangeType;return(0,validation/* isEmpty */.xb)(value)?isRangeType?[]:"":isRangeType?value.map((function(val){return _this.getTimeInSystemZone(val)})):this.getTimeInSystemZone(value)},set:function(value){var isRangeType=this.isRangeType;if(isRangeType){if((0,validation/* isEmpty */.xb)(value))this.timeinorg=[];else for(var time in value)this.timeinorg[time]=this.$helpers.getTimeInOrg(value[time]);this.$emit("input",this.timeinorg),this.$emit("change",this.timeinorg)}else{var modifiedTimeFormat=this.$helpers.getTimeInOrg(value);this.$emit("input",modifiedTimeFormat),this.$emit("change",modifiedTimeFormat)}}}},methods:{pickerChange:function(){var isRangeType=this.isRangeType,value=this.value;if(isRangeType){if((0,validation/* isEmpty */.xb)(value))this.timeinorg=[];else for(var time in value)this.timeinorg[time]=this.$helpers.getTimeInOrg(value[time]);this.$emit("pickerChange",this.timeinorg)}else{var modifiedTimeFormat=this.$helpers.getTimeInOrg(value);this.$emit("pickerChange",modifiedTimeFormat)}},init:function(){var isRangeType=this.isRangeType,value=this.value;if(isRangeType){if((0,validation/* isEmpty */.xb)(value))this.timeinorg=[];else for(var time in value){var timeVal=parseInt(value[time]);this.timeinorg[time]=timeVal}this.$emit("input",this.timeinorg)}else if(!(0,validation/* isEmpty */.xb)(value)){var isPlaceHoldersEnabled=constant/* default */.Z.FIELD_PLACEHOLDERS.includes(value)||!1;isPlaceHoldersEnabled||this.$emit("input",value)}this.$emit("initialized")},focus:function(){this.$refs["date-picker"].focus()},getTimeInSystemZone:function(value){return new Date(moment_timezone_default().tz(value,this.$timezone).format("YYYY-MM-DD HH:mm:ss"))}}},overview_FDatePickervue_type_script_lang_js=FDatePickervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(overview_FDatePickervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FDatePicker=component.exports},
/***/339836:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return NewSpaceThresholdRule}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/setup/new/NewSpaceThresholdRule.vue?vue&type=template&id=cc7021f2
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("el-container",[_c("el-header",{staticClass:"boxheader"},[_c("span",[_c("el-button",{staticStyle:{"font-size":"17px",width:"14px",color:"#ef508f","font-weight":"bold"},attrs:{type:"text",icon:"el-icon-back"},on:{click:_vm.cancel}}),_c("span",{staticClass:"discription-textbox",staticStyle:{"padding-left":"7px"}},[_vm._v(_vm._s(_vm.$t("common._common.back_list")))])],1),_c("span",{staticClass:"pull-right",staticStyle:{padding:"19px"}},[_c("el-button",{staticStyle:{color:"#39b2c2","border-color":"#39b2c2","letter-spacing":"0.7px"},on:{click:_vm.cancel}},[_vm._v("CANCEL")]),_c("el-button",{attrs:{type:"primary"},on:{click:_vm.save}},[_vm._v("SAVE")])],1),_c("div",[_c("el-input",{staticClass:"Alarm-title",attrs:{placeholder:"New Space Threshold"},model:{value:_vm.model.readingRule.name,callback:function($$v){_vm.$set(_vm.model.readingRule,"name",$$v)},expression:"model.readingRule.name"}})],1)]),_c("el-main",{staticClass:"indent"},[_c("q-input",{staticClass:"edittext",staticStyle:{width:"75%","margin-top":"0px"},attrs:{type:"textarea","float-label":"Description","min-rows":1},model:{value:_vm.model.readingRule.description,callback:function($$v){_vm.$set(_vm.model.readingRule,"description",$$v)},expression:"model.readingRule.description"}}),_c("el-select",{attrs:{filterable:"",clearable:"",placeholder:"Select Asset"},model:{value:_vm.selectedAsset,callback:function($$v){_vm.selectedAsset=$$v},expression:"selectedAsset"}},_vm._l(_vm.assetList,(function(asset){return _c("el-option",{key:asset.id,attrs:{label:asset.name,value:asset.id}})})),1),"readingrule"===_vm.module&&""!==_vm.model.readingRule.module||"readingrule"!==_vm.module?_c("div",{staticClass:"boldtitle"},[_vm._v(" CONDITIONS ")]):_vm._e(),_vm.selectedAsset?_c("f-criteria-builder",{attrs:{readingobj:_vm.getAsset(_vm.selectedAsset),threshold:!0,module:"space"},on:{selectedModuleId:_vm.selectedModuleId},model:{value:_vm.model.readingRule.criteria,callback:function($$v){_vm.$set(_vm.model.readingRule,"criteria",$$v)},expression:"model.readingRule.criteria"}}):_vm._e(),_c("div",{staticClass:"fc-form-section",staticStyle:{"font-weight":"bold","padding-top":"10px"}},[_vm._v(" Alarm Details ")]),_c("el-row",{staticStyle:{"padding-left":"30px",margin:"0px","padding-top":"20px"},attrs:{align:"middle",gutter:50}},[_c("el-col",{staticStyle:{"padding-right":"35px","padding-left":"0px"},attrs:{span:12}},[_c("div",{staticClass:"textcolor"},[_vm._v("Message")]),_c("div",{staticClass:"add"},[_c("el-input",{staticStyle:{width:"100%"},attrs:{type:"text",placeholder:""},model:{value:_vm.newalarm.message,callback:function($$v){_vm.$set(_vm.newalarm,"message",$$v)},expression:"newalarm.message"}})],1)]),_c("el-col",{staticStyle:{"padding-right":"35px"},attrs:{span:12}},[_c("div",{staticClass:"textcolor"},[_vm._v("Severity")]),_c("div",{staticClass:"add"},[_c("el-select",{staticClass:"form-item ",staticStyle:{width:"100%"},attrs:{placeholder:""},model:{value:_vm.newalarm.severity,callback:function($$v){_vm.$set(_vm.newalarm,"severity",$$v)},expression:"newalarm.severity"}},[_c("el-option",{key:"Critical",attrs:{label:"Critical",value:"Critical"}}),_c("el-option",{key:"Major",attrs:{label:"Major",value:"Major"}}),_c("el-option",{key:"Minor",attrs:{label:"Minor",value:"Minor"}}),_c("el-option",{key:"Clear",attrs:{label:"Clear",value:"Clear"}})],1)],1)])],1),_c("el-row",{staticStyle:{"padding-left":"30px",margin:"0px","padding-top":"20px"},attrs:{align:"middle",gutter:50}},[_c("el-col",{staticStyle:{"padding-right":"35px","padding-left":"0px"},attrs:{span:12}},[_c("div",{staticClass:"textcolor"},[_vm._v("Alarm Class")]),_c("div",{staticClass:"add"},[_c("el-input",{staticStyle:{width:"100%"},attrs:{type:"text",placeholder:""},model:{value:_vm.newalarm.alarmClass,callback:function($$v){_vm.$set(_vm.newalarm,"alarmClass",$$v)},expression:"newalarm.alarmClass"}})],1)]),_c("el-col",{staticStyle:{"padding-right":"35px"},attrs:{span:12}},[_c("div",{staticClass:"textcolor"},[_vm._v("Priority")]),_c("div",{staticClass:"add"},[_c("el-input",{staticStyle:{width:"100%"},attrs:{type:"text",placeholder:""},model:{value:_vm.newalarm.priority,callback:function($$v){_vm.$set(_vm.newalarm,"priority",$$v)},expression:"newalarm.priority"}})],1)])],1),_c("div",{staticClass:"fc-form-section",staticStyle:{"padding-top":"30px","font-weight":"bold"}},[_vm._v(" Additional Information ")]),_c("div",{staticClass:"fc-rule-actions",staticStyle:{"padding-top":"30px","padding-left":"30px","padding-right":"30px"}},_vm._l(_vm.model.actions,(function(action,index){return _c("el-card",{key:index,staticClass:"fc-rule-action box-card"},[_c("el-row",{attrs:{gutter:10,align:"middle"}},[_c("el-col",{attrs:{md:24,lg:24}},[_c("field-matcher",{model:{value:action.templateJson.fieldMatcher,callback:function($$v){_vm.$set(action.templateJson,"fieldMatcher",$$v)},expression:"action.templateJson.fieldMatcher"}})],1)],1)],1)})),1)],1)],1)],1)},staticRenderFns=[],objectSpread2=__webpack_require__(595082),FCriteriaBuilder=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(670560),__webpack_require__(410806)),FieldMatcher2=__webpack_require__(23324),quasar_esm=__webpack_require__(641358),vuex_esm=__webpack_require__(420629),NewSpaceThresholdRulevue_type_script_lang_js={props:["visible"],data:function(){return{show:!1,moduleMeta:null,callmail:!1,callsms:!1,module:"alarm",saving:!1,model:{readingRule:{module:"",name:"",description:"",executionOrder:0,resourceId:-1,event:{moduleId:null,activityType:1},criteria:null,ruleType:2},actions:[{actionType:6,templateJson:{fieldMatcher:[]}}]},selectedAsset:null,assetList:[],readings:[],newalarm:{message:"",severity:"Minor",alarmClass:"",priority:""},rules:{"rule.name":[{required:!0,message:"Please enter rule name",trigger:"blur"}],"rule.activityType":[{required:!0,message:"Please select event type"}]},duration:-1}},created:function(){this.$store.dispatch("loadTicketPriority")},components:{FCriteriaBuilder:FCriteriaBuilder/* default */.Z,QInput:quasar_esm/* QInput */.Ke,FieldMatcher:FieldMatcher2/* default */.Z},computed:(0,objectSpread2/* default */.Z)({showDialog:function(){return this.visible}},(0,vuex_esm/* mapState */.rn)({ticketpriority:function(state){return state.ticketPriority}})),watch:{ticketpriority:function(){this.loadPolicyJson()}},mounted:function(){this.loadAssets()},methods:{selectedModuleId:function(val){this.model.readingRule.event.moduleId=val},getAsset:function(id){return this.assetList.find((function(at){return at.id===id}))},showcondition:function(){null==this.selectedAsset&&alert("asset null");var asset=this.getAsset(this.selectedAsset);alert(asset.category)},close:function(){this.$emit("update:visible",!1)},save:function(){var self=this;self.model.actions[0].templateJson.fieldMatcher.push({field:"message",value:this.newalarm.message}),self.model.actions[0].templateJson.fieldMatcher.push({field:"severity",value:this.newalarm.severity}),self.model.actions[0].templateJson.fieldMatcher.push({field:"alarmClass",value:this.newalarm.alarmClass}),self.model.actions[0].templateJson.fieldMatcher.push({field:"priority",value:this.newalarm.priority}),self.model.actions[0].templateJson.fieldMatcher.push({field:"assetId",value:this.selectedAsset}),""===this.model.readingRule.module&&(this.model.readingRule.module=this.module,self.model.readingRule.resourceId=self.selectedAsset),self.$http.post("/setup/addReadingrules",self.model),self.$emit("update:visible",!1),self.$router.push({path:"."})},actionSaved:function(action){this.model.actions.push(action)},cancel:function(){this.$emit("update:visible",!1),this.$router.push({path:"."})},loadAssets:function(){var self=this,url="/space/spacelist";this.$http.get(url).then((function(response){response.data&&(self.assetList=response.data.spaces)}))},showCreateNewDialog:function(){return!!this.$route.query.create},backto:function(){this.$router.push({path:"thresholdrules"})}}},new_NewSpaceThresholdRulevue_type_script_lang_js=NewSpaceThresholdRulevue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(new_NewSpaceThresholdRulevue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,NewSpaceThresholdRule=component.exports},
/***/353654:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"d7f1f315aba97cd14240ee6f3d34465f.svg";
/***/},
/***/385769:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"4a9843791f38c4a28fdf9f0a4584780d.svg";
/***/}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/39836.js.map