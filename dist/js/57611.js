"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[57611],{
/***/457611:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return ServiceRequestList}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/servicerequest/ServiceRequestList.vue?vue&type=template&id=59eaa91a&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("CommonListLayout",{staticClass:"custom-module-list-layout",attrs:{moduleName:_vm.moduleName,showViewRearrange:!0,showViewEdit:!0,visibleViewCount:3,getPageTitle:function(){return _vm.moduleDisplayName},hideSubHeader:_vm.canHideSubHeader,recordCount:_vm.recordCount,recordLoading:_vm.showLoading,pathPrefix:"/app/sr/serviceRequest/"},scopedSlots:_vm._u([{key:"header",fn:function(){return[_vm.canHideFilter?_vm._e():_c("AdvancedSearchWrapper",{key:"ftags-list-"+_vm.moduleName,attrs:{filters:_vm.filters,moduleName:_vm.moduleName,moduleDisplayName:_vm.moduleDisplayName}}),_vm.showSearch?_vm._e():[_vm.canShowVisualSwitch?_c("visual-type",{on:{onSwitchVisualize:function(val){return _vm.canShowListView=val}}}):_vm._e(),_c("div",[_vm.$hasPermission(_vm.moduleName+":CREATE")?_c("button",{staticClass:"fc-create-btn",on:{click:function($event){return _vm.redirectToFormCreation()}}},[_vm._v(" New Service Request ")]):_vm._e()])]]},proxy:!0},_vm.canShowCalendarHeader?{key:"sub-header",fn:function(){return[_vm.showListView?_vm._e():_c("CalendarDateWrapper")]},proxy:!0}:null,{key:"sub-header-actions",fn:function(){return[!_vm.isEmpty(_vm.records)&&_vm.showListView?[_c("pagination",{staticClass:"pL15 fc-black-small-txt-12",attrs:{total:_vm.recordCount,currentPageCount:_vm.currentPageCount,perPage:_vm.perPage,skipTotalCount:!0}}),_vm.recordCount>0?_c("span",{staticClass:"separator"},[_vm._v("|")]):_vm._e(),_c("el-tooltip",{attrs:{effect:"dark",content:_vm.$t("common._common.sort"),placement:"right"}},[_c("Sort",{key:_vm.moduleName+"-sort",attrs:{moduleName:_vm.moduleName},on:{onSortChange:_vm.updateSort}})],1),_c("span",{staticClass:"separator"},[_vm._v("|")]),_vm.isAltayerNonPrivilagedUser?_vm._e():[_c("f-export-settings",{attrs:{module:_vm.moduleName,viewDetail:_vm.viewDetail,showViewScheduler:!1,showMail:!1,filters:_vm.filters}})]]:_vm._e()]},proxy:!0},{key:"content",fn:function(){return[[_c("div",{staticClass:"height100 pB10"},[_vm.showLoading?_c("Spinner",{staticClass:"mT40",attrs:{show:_vm.showLoading}}):_vm.showListView?_c("div",{staticClass:"fc-card-popup-list-view"},[_c("div",{staticClass:"fc-list-view p10 pT0  fc-list-table-container height100vh fc-table-td-height fc-table-viewchooser pB100"},[_vm.$validation.isEmpty(_vm.records)?_c("div",{staticClass:"fc-list-empty-state-container"},[_c("inline-svg",{attrs:{src:"svgs/list-empty",iconClass:"icon text-center icon-xxxxlg"}}),_c("div",{staticClass:"q-item-label nowo-label"},[_vm._v(" "+_vm._s(_vm.$t("home.service_request.service_request_no_data"))+" ")])],1):_c("div",[_c("div",{staticClass:"column-customization-icon",attrs:{disabled:!_vm.isColumnCustomizable},on:{click:_vm.toShowColumnSettings}},[_c("el-tooltip",{attrs:{disabled:_vm.isColumnCustomizable,placement:"top",content:_vm.$t("common._common.you_dont_have_permission")}},[_c("inline-svg",{staticClass:"text-center position-absolute icon",attrs:{src:"column-setting"}})],1)],1),_vm.$validation.isEmpty(_vm.selectedListItemsIds)?_vm._e():_c("div",{staticClass:"pull-left table-header-actions"},[_c("div",{staticClass:"action-btn-slide btn-block"},[_c("el-dropdown",{attrs:{trigger:"click",placement:"bottom"},on:{command:_vm.assignRecords}},[_vm.$hasPermission(_vm.moduleName+":UPDATE")?_c("button",{staticClass:"btn btn--tertiary",attrs:{disabled:_vm.saving}},[_c("i",{staticClass:"fa fa-user-o b-icon"}),_vm._v(" Assign ")]):_vm._e(),_c("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[_vm._l(_vm.users,(function(user,index){return _c("el-dropdown-item",{key:"user-"+index,attrs:{command:{assignedTo:{id:user.id}}}},[_c("i",{staticClass:"fa fa-user secondary-color2 wo_assign-icon_user"}),_vm._v(" "+_vm._s(user.name)+" ")])})),_vm._l(_vm.groups,(function(group,index){return _c("el-dropdown-item",{key:"group-"+index,attrs:{command:{assignmentGroup:{id:group.id}}}},[_c("i",{staticClass:"fa fa-users secondary-color2 wo_assign-icon_user"}),_vm._v(" "+_vm._s(group.name)+" ")])}))],2)],1),_vm.$hasPermission(_vm.moduleName+":DELETE")?_c("button",{staticClass:"btn btn--tertiary",attrs:{disabled:_vm.saving},on:{click:function($event){return _vm.deleteRecords(_vm.selectedListItemsIds)}}},[_c("i",{staticClass:"el-icon-delete"}),_vm._v(" Delete ")]):_vm._e()],1),_c("CustomButton",{key:_vm.moduleName+"_"+_vm.viewname+"_"+_vm.POSITION.LIST_BAR,staticClass:"custom-button",attrs:{modelDataClass:_vm.modelDataClass,moduleName:_vm.moduleName,position:_vm.POSITION.LIST_BAR,selectedRecords:_vm.selectedListItemsObj},on:{onSuccess:_vm.onCustomButtonSuccess,onError:function(){}}})],1)]),_c("CommonList",{attrs:{records:_vm.records,viewDetail:_vm.viewDetail,moduleName:_vm.moduleName,redirectToOverview:_vm.openRecordSummary,slotList:_vm.slotList,height:"auto",fit:!0,canShowCustomButton:"true",refreshList:_vm.onCustomButtonSuccess},on:{"selection-change":_vm.selectItems},scopedSlots:_vm._u([{key:_vm.slotList[0].criteria,fn:function(ref){var record=ref.record;return[_c("router-link",{staticClass:"d-flex main-field-column label-txt-black",attrs:{to:_vm.openRecordSummary(record.id)}},[_c("el-tooltip",{attrs:{effect:"dark",content:_vm.getModeType(record),placement:"top","open-delay":600}},[_c("span",{staticClass:"flex-shrink-0",class:_vm.modeClass(record)})]),_c("el-tooltip",{attrs:{effect:"dark",content:_vm.$getProperty(record,"subject","---"),placement:"top","open-delay":600}},[_c("div",{staticClass:"self-center width200px"},[_c("span",{staticClass:"list-main-field"},[_vm._v(_vm._s(_vm.$getProperty(record,"subject","---")))])])])],1)]}},{key:_vm.slotList[1].criteria,fn:function(ref){var record=ref.record;return[_c("div",{staticClass:"p5"},[_vm._v(" "+_vm._s(_vm.getTeamOrStaff(record))+" ")])]}},{key:_vm.slotList[2].name,fn:function(ref){var record=ref.record;return[_c("div",{staticClass:"text-center"},[_vm.$hasPermission(_vm.moduleName+":UPDATE")?_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-edit pointer edit-icon-color visibility-hide-actions mL10",attrs:{"data-arrow":"true",title:_vm.$t("common._common.edit")},on:{click:function($event){return _vm.editRecord(record)}}}):_vm._e(),_vm.$hasPermission(_vm.moduleName+":DELETE")?_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-delete pointer edit-icon-color visibility-hide-actions mL10",attrs:{"data-arrow":"true",title:_vm.$t("common._common.delete")},on:{click:function($event){return _vm.deleteRecords([record.id])}}}):_vm._e()])]}},{key:_vm.slotList[3].name,fn:function(ref){var record=ref.record;return[_c("div",{staticClass:"fc-id"},[_vm._v(" "+_vm._s("# "+(record.id||"---"))+" ")])]}},{key:_vm.slotList[4].criteria,fn:function(ref){var record=ref.record;return[_c("span",[_vm._v(" "+_vm._s(_vm.getModeType(record))+" ")])]}}],null,!0)})],1)]):_vm.showListView?_vm._e():_c("CalendarView",{ref:"calendar",attrs:{moduleName:_vm.moduleName,record:_vm.records,viewDetail:_vm.viewDetail,viewname:_vm.viewname,filters:_vm.filters}}),_c("column-customization",{attrs:{visible:_vm.showColumnSettings,moduleName:_vm.moduleName,viewName:_vm.viewname},on:{"update:visible":function($event){_vm.showColumnSettings=$event}}})],1)]]},proxy:!0}],null,!0)},[_c("portal",{attrs:{to:"view-manager-link"}},[_c("div",{staticClass:"view-manager-btn",on:{click:_vm.getViewManagerRoute}},[_c("inline-svg",{staticClass:"d-flex",attrs:{src:"svgs/hamburger-menu",iconClass:"icon icon-sm"}}),_c("span",{staticClass:"label mL10 text-uppercase"},[_vm._v(" "+_vm._s(_vm.$t("viewsmanager.list.views_manager"))+" ")])],1)])],1)},staticRenderFns=[],defineProperty=__webpack_require__(482482),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),objectSpread2=__webpack_require__(595082),api=(__webpack_require__(564043),__webpack_require__(61514),__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(434284),__webpack_require__(648324),__webpack_require__(670560),__webpack_require__(634338),__webpack_require__(450886),__webpack_require__(32284)),vuex_esm=__webpack_require__(420629),validation=__webpack_require__(990260),router=__webpack_require__(329435),routeUtil=__webpack_require__(405759),OtherMixin=__webpack_require__(964967),CommonModuleList=__webpack_require__(347446),modeTypes={1:"New",2:"Customer Replied",3:"Admin Replied","-1":"Created"},ServiceRequestListvue_type_script_lang_js={extends:CommonModuleList["default"],mixins:[OtherMixin/* default */.Z],name:"ServiceRequestList",data:function(){return{modeTypes:modeTypes,saving:!1}},created:function(){this.$store.dispatch("view/loadModuleMeta",this.moduleName)},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({showSearch:function(state){return state.search.active},users:function(state){return state.users},groups:function(state){return state.groups}})),{},{nameColumn:function(){var viewColumns=this.viewColumns;return(viewColumns||[]).find((function(col){return"subject"===col.name}))||{}},moduleDisplayName:function(){var _this$metaInfo;return null===(_this$metaInfo=this.metaInfo)||void 0===_this$metaInfo?void 0:_this$metaInfo.displayName},slotList:function(){return[{criteria:JSON.stringify({name:"subject"})},{criteria:JSON.stringify({name:"assignedTo"})},{name:"editDelete",isActionColumn:!0,columnAttrs:{width:130,class:"visibility-visible-actions",fixed:"right"}},{name:"id",isHardcodedColumn:!0,columnAttrs:{"min-width":150,label:"ID",fixed:"left"}},{criteria:JSON.stringify({name:"mode"})}]}}),methods:{getViewManagerRoute:function(){var moduleName=this.moduleName,$route=this.$route,query=$route.query,route=(0,routeUtil/* findRouterForModuleInApp */.E)(moduleName,router/* pageTypes */.As.VIEW_MANAGER);route&&this.$router.push((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},route),{},{params:{moduleName:moduleName},query:(0,objectSpread2/* default */.Z)({},query)}))},modeClass:function(record){var modeClass={1:"is-new",2:"customer-replied",3:"admin-replied","-1":"created"},_ref=record||{},mode=_ref.mode;if(mode)return"service-request-mode-in-list-page ".concat(modeClass[mode])},deleteRecords:function(idList){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var value,moduleName,_yield$API$deleteReco,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.next=2,_this.$dialog.confirm({title:_this.$t("home.service_request.delete_service_request"),message:_this.$t("home.service_request.delete_service_request_confirmation"),rbDanger:!0,rbLabel:_this.$t("common._common.delete")});case 2:if(value=_context.sent,!value){_context.next=20;break}return _this.saving=!0,moduleName=_this.moduleName,_context.next=8,api/* API */.bl.deleteRecord(moduleName,idList);case 8:if(_yield$API$deleteReco=_context.sent,error=_yield$API$deleteReco.error,!error){_context.next=14;break}_this.$message.error(error.message||"Error Occurred"),_context.next=19;break;case 14:return _this.$message.success(_this.$t("home.service_request.service_request_delete_success")),_context.next=17,_this.refreshRecordDetails();case 17:_this.selectedListItemsIds=[],_this.selectedListItemsObj=[];case 19:_this.saving=!1;case 20:case"end":return _context.stop()}}),_callee)})))()},openRecordSummary:function(id){var moduleName=this.moduleName,viewname=this.viewname;if((0,router/* isWebTabsEnabled */.tj)()){var _ref2=(0,router/* findRouteForModule */.Jp)(moduleName,router/* pageTypes */.As.OVERVIEW)||{},name=_ref2.name,route={name:name,params:{viewname:viewname,id:id},query:this.$route.query};return name&&route}return{name:"serviceRequestSummary",query:this.$route.query,params:{viewname:viewname,id:id}}},redirectToFormCreation:function(){var moduleName=this.moduleName;if((0,router/* isWebTabsEnabled */.tj)()){var _ref3=(0,router/* findRouteForModule */.Jp)(moduleName,router/* pageTypes */.As.CREATE)||{},name=_ref3.name;name&&this.$router.push({name:name})}else this.$router.push({path:"/app/sr/serviceRequest/new"})},editRecord:function(_ref4){var id=_ref4.id,moduleName=this.moduleName;if((0,router/* isWebTabsEnabled */.tj)()){var _ref5=(0,router/* findRouteForModule */.Jp)(moduleName,router/* pageTypes */.As.EDIT)||{},name=_ref5.name;name&&this.$router.push({name:name,params:{id:id}})}else this.$router.push({path:"/app/sr/serviceRequest/edit/".concat(id)})},getTeamOrStaff:function(record){var _ref6=record||{},assignmentGroup=_ref6.assignmentGroup,assignedTo=_ref6.assignedTo,assignmentGroupName=this.$getProperty(assignmentGroup,"name","---"),assignedToName=this.$getProperty(assignedTo,"name","---");return(0,validation/* isEmpty */.xb)(assignmentGroup)||(0,validation/* isEmpty */.xb)(assignedTo)?(0,validation/* isEmpty */.xb)(assignmentGroup)?(0,validation/* isEmpty */.xb)(assignedToName)?"---":"".concat(assignedToName):"".concat(assignmentGroupName):"".concat(assignmentGroupName," / ").concat(assignedToName)},getModeType:function(record){var modeTypes=this.modeTypes,_ref7=record||{},mode=_ref7.mode;return this.$getProperty(modeTypes,"".concat(mode),"---")},assignRecords:function(_ref8){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var _ref8$assignedTo,assignedTo,_ref8$assignmentGroup,assignmentGroup,moduleName,recordMap,params,_yield$API$post,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _ref8$assignedTo=_ref8.assignedTo,assignedTo=void 0===_ref8$assignedTo?null:_ref8$assignedTo,_ref8$assignmentGroup=_ref8.assignmentGroup,assignmentGroup=void 0===_ref8$assignmentGroup?null:_ref8$assignmentGroup,moduleName=_this2.moduleName,recordMap=_this2.selectedListItemsIds.map((function(id){var record;return assignedTo?record={id:id,assignedTo:assignedTo}:assignmentGroup&&(record={id:id,assignmentGroup:assignmentGroup}),record})),params={moduleName:moduleName,data:(0,defineProperty/* default */.Z)({},moduleName,recordMap)},_this2.saving=!0,_context2.next=7,api/* API */.bl.post("v3/modules/data/bulkpatch",params);case 7:_yield$API$post=_context2.sent,error=_yield$API$post.error,error?_this2.$message.error((null===error||void 0===error?void 0:error.message)||"Error occurred while assigning"):(_this2.loadRecords(),_this2.selectedListItemsIds=[]),_this2.saving=!1;case 11:case"end":return _context2.stop()}}),_callee2)})))()}}},servicerequest_ServiceRequestListvue_type_script_lang_js=ServiceRequestListvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(servicerequest_ServiceRequestListvue_type_script_lang_js,render,staticRenderFns,!1,null,"59eaa91a",null)
/* harmony default export */,ServiceRequestList=component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/57611.js.map