(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[51633],{
/***/251633:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return ControlScheduleSummary}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/controls/controlschedule/ControlScheduleSummary.vue?vue&type=template&id=42528419&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"width80"},[_c("div",{staticClass:"summaryHeader d-flex"},[_c("div",{staticClass:"primary-field summary-header-heading pT5"},[_vm.$validation.isEmpty(_vm.schedule)?_vm._e():[_c("span",{staticClass:"fc-id"},[_vm._v("#"+_vm._s(_vm.schedule.id))]),_c("div",{staticClass:"heading-black18 f16 max-width500px textoverflow-ellipsis"},[_vm._v(" "+_vm._s(_vm.schedule.name)+" ")])]],2),_c("div",{staticClass:"display-flex mL-auto mB10"},[_c("button",{staticClass:"d-flex el-button fc-wo-border-btn pL15 pR15 self-center el-button--button",attrs:{type:"button"},on:{click:_vm.openEditRecord}},[_vm._m(0)]),_c("el-dropdown",{staticClass:"mL10 pointer",attrs:{trigger:"click"}},[_c("button",{staticClass:"d-flex el-button fc-wo-border-btn pL15 pR15 self-center el-button--button",attrs:{type:"button"}},[_c("span",[_c("img",{attrs:{src:__webpack_require__(935010),width:"16",height:"12"}})])]),_c("el-dropdown-menu",[_c("div",{staticClass:"p10 pointer",on:{click:_vm.deleteSchedule}},[_vm._v(" "+_vm._s(_vm.$t("common._common.delete"))+" ")])])],1)],1)]),_vm.isLoading?_c("div",{staticClass:"text-center width100 pT50 mT50"},[_c("spinner",{attrs:{show:_vm.isLoading,size:"80"}})],1):_vm.$validation.isEmpty(_vm.currBusinessHour)?_c("div",{staticClass:"height100vh fc-empty-white flex-middle justify-content-center flex-direction-column"},[_c("inline-svg",{attrs:{src:"svgs/emptystate/quotation",iconClass:"icon text-center icon-xxxxlg"}}),_c("div",{staticClass:"q-item-label nowo-label"},[_vm._v(" "+_vm._s(_vm.$t("quotation.list.no_data"))+" ")])],1):[_c("div",{staticClass:"m20 d-flex flex-column"},[_vm.$validation.isEmpty(_vm.currBusinessHour)?_vm._e():_c("ScheduleVisualizer",{staticClass:"visualizer-container",attrs:{schedule:_vm.currBusinessHour,isSameTimingForAll:!1}})],1)]],2)},staticRenderFns=[function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("span",[_c("i",{staticClass:"el-icon-edit",attrs:{tabindex:"0"}})])}],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),api=(__webpack_require__(434284),__webpack_require__(670560),__webpack_require__(32284)),ScheduleVisualizer=__webpack_require__(803582),router=__webpack_require__(329435),ControlScheduleSummaryvue_type_script_lang_js={props:["moduleName"],components:{ScheduleVisualizer:ScheduleVisualizer/* default */.Z},data:function(){return{businessHoursList:null,schedule:null,isLoading:!1,currBusinessHour:null}},created:function(){this.getCurrRecord()},computed:{recordId:function(){var id=this.$route.params.id;return id}},watch:{recordId:function(){this.getCurrRecord()}},methods:{getCurrRecord:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var id,_yield$API$fetchRecor,controlSchedule,error,singleDaybusinessHoursList;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _this.isLoading=!0,id=_this.recordId,_context.next=4,api/* API */.bl.fetchRecord("controlSchedule",{id:id});case 4:_yield$API$fetchRecor=_context.sent,controlSchedule=_yield$API$fetchRecor.controlSchedule,error=_yield$API$fetchRecor.error,error&&_this.$message.error(error.message||"Error Occured"),_this.schedule=controlSchedule,singleDaybusinessHoursList=controlSchedule.businessHoursContext.singleDaybusinessHoursList,_this.currBusinessHour=singleDaybusinessHoursList,_this.isLoading=!1;case 12:case"end":return _context.stop()}}),_callee)})))()},openEditRecord:function(){var id=this.$getProperty(this,"schedule.id","");if((0,router/* isWebTabsEnabled */.tj)()){var moduleName=this.moduleName,_ref=(0,router/* findRouteForModule */.Jp)(moduleName,router/* pageTypes */.As.EDIT)||{},name=_ref.name,route={name:name,params:{id:id}};this.$router.push(route)}else this.$router.push({name:"schedule-edit",params:{id:id}})},deleteSchedule:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var id,value,_yield$API$deleteReco,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return id=_this2.schedule.id,_context2.next=3,_this2.$dialog.confirm({title:_this2.$t("controls.controlSchedule.delete_schedule"),message:_this2.$t("controls.controlSchedule.delete_schedule_confirmation"),rbDanger:!0,rbLabel:_this2.$t("common._common.delete")});case 3:if(value=_context2.sent,!value){_context2.next=10;break}return _context2.next=7,api/* API */.bl.deleteRecord(_this2.moduleName,[id]);case 7:_yield$API$deleteReco=_context2.sent,error=_yield$API$deleteReco.error,error?_this2.$message.error(error.message||"Error Occured"):_this2.$router.push({name:"schedule-list"});case 10:case"end":return _context2.stop()}}),_callee2)})))()}}},controlschedule_ControlScheduleSummaryvue_type_script_lang_js=ControlScheduleSummaryvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(controlschedule_ControlScheduleSummaryvue_type_script_lang_js,render,staticRenderFns,!1,null,"42528419",null)
/* harmony default export */,ControlScheduleSummary=component.exports},
/***/803582:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return ScheduleVisualizer}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/controls/controlschedule/components/ScheduleVisualizer.vue?vue&type=template&id=dbecb28c&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"schedule-visualizer-container"},_vm._l(_vm.getTimeInterval,(function(hours,indexHours){return _c("div",{key:indexHours,class:["flex flex-row",0===indexHours&&"position-sticky bg-white zindex999"]},_vm._l(_vm.xAxis,(function(days,indexDays){return _c("div",{key:indexDays,class:[_vm.getCellClass(indexDays,indexHours)],style:_vm.cellDimension},[0===indexHours||0===indexDays?_c("div",[_vm._v(" "+_vm._s(_vm.getLabel(indexDays,indexHours))+" ")]):[_vm._l(_vm.getFifteenMinSplit(hours),(function(fifteenMinTime,index){return[_vm.getException(fifteenMinTime,days)?_c("el-popover",{key:index,staticClass:"fifteenMinCell",attrs:{placement:"right",title:_vm.getSchedule(fifteenMinTime,days).date,width:"200",trigger:"hover","open-delay":500,"close-delay":500}},[_c("div",{staticClass:"f13"},[_c("div",[_vm._v(" "+_vm._s(_vm.getException(fifteenMinTime,days).offSchedule?"Reduced Hours":"Extended Hours")+", ")]),_c("div",{staticClass:"font-bold"},[_vm._v(" "+_vm._s(_vm.getSchedule(fifteenMinTime,days).startTime)+" - "+_vm._s(_vm.getSchedule(fifteenMinTime,days).endTime)+" ")]),_c("div",{staticClass:"d-flex flex-column pT8"},[_c("div",{staticClass:"fc-link fc-link-animation f14 pointer mT3",on:{click:function($event){return _vm.editException(fifteenMinTime,days)}}},[_vm._v(" "+_vm._s(_vm.$t("common._common.edit"))+" ")]),_c("span",{staticClass:"separator"},[_vm._v("|")]),_c("div",{staticClass:"fc-link fc-link-animation f14 pointer mT3",on:{click:function($event){_vm.deleteException(_vm.getException(fifteenMinTime,days).id,fifteenMinTime,days)}}},[_vm._v(" "+_vm._s(_vm.$t("common._common.delete"))+" ")])])]),_c("template",{slot:"reference"},[_c("div",{class:["fifteenMinCell pointer",_vm.getScheduleClass(fifteenMinTime,days)]})])],2):_c("div",{key:index,class:["fifteenMinCell",_vm.getScheduleClass(fifteenMinTime,days)]})]}))]],2)})),0)})),0)},staticRenderFns=[],objectSpread2=__webpack_require__(595082),toConsumableArray=__webpack_require__(488478),helpers=(__webpack_require__(670560),__webpack_require__(634338),__webpack_require__(169358),__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(425728),__webpack_require__(778390)),validation=__webpack_require__(990260),cloneDeep=__webpack_require__(150361),cloneDeep_default=__webpack_require__.n(cloneDeep),ControlScheduleUtil=__webpack_require__(294323),moment=helpers/* default */.ZP.getOrgMoment,DAYS_IN_WEEK_FORMATTED=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],DAYS={SUNDAY:{value:7},MONDAY:{value:1},TUESDAY:{value:2},WEDNESDAY:{value:3},THURSDAY:{value:4},FRIDAY:{value:5},SATURDAY:{value:6}},SCHEDULE_TYPE_ENUM={SCHEDULE:"actualSchedule",EXTENDED_HOURS:"extendedHours",REDUCED_HOURS:"reducedHours"},ScheduleVisualizervue_type_script_lang_js={props:["scheduleDays","isSameTimingForAll","schedule","cellHeight"],data:function(){return{startHour:0,endHour:23,scheduleLookup:{SUNDAY:{value:7},MONDAY:{value:1},TUESDAY:{value:2},WEDNESDAY:{value:3},THURSDAY:{value:4},FRIDAY:{value:5},SATURDAY:{value:6}}}},computed:{getTimeInterval:function(){var startTime=moment(this.startHour,"HH:mm"),endTime=moment(this.endHour,"HH:mm");endTime.isBefore(startTime)&&endTime.add(1,"day");var timeStops=[];timeStops.push(null);while(startTime<=endTime)timeStops.push(new moment(startTime).format("hh:mm A")),startTime.add(1,"hours");return timeStops},cellDimension:function(){return"height: ".concat(this.cellHeight||"40px")},xAxis:function(){return[""].concat((0,toConsumableArray/* default */.Z)(Object.keys(this.scheduleLookup)))}},watch:{schedule:{handler:function(newVal){(0,validation/* isEmpty */.xb)(newVal)?this.scheduleLookup=cloneDeep_default()(DAYS):this.serializeSchedule()},deep:!0,immediate:!0}},methods:{getFifteenMinSplit:function(hours){return(0,ControlScheduleUtil/* getFifteenMinSplit */.FV)(hours)},serializeSchedule:function(){var _this=this,schedule=this.schedule;this.scheduleLookup=cloneDeep_default()(DAYS),schedule.forEach((function(currSchedule){var dayOfWeekEnum=currSchedule.dayOfWeekEnum,startTime=currSchedule.startTime,endTime=currSchedule.endTime,exception=currSchedule.exception,offSchedule=currSchedule.offSchedule,startTimeMilli=currSchedule.startTimeMilli,currDay=Object.keys(_this.scheduleLookup).find((function(week){return week===dayOfWeekEnum}));(0,ControlScheduleUtil/* get15SplitFor24Hour */.Tc)((0,ControlScheduleUtil/* getHour */.ex)(startTime,"HH:mm"),(0,ControlScheduleUtil/* getHour */.ex)(endTime,"HH:mm"),!0).forEach((function(hour){_this.scheduleLookup[currDay][hour]=(0,objectSpread2/* default */.Z)({offSchedule:!(0,validation/* isEmpty */.xb)(exception)&&offSchedule,dayOfWeekEnum:dayOfWeekEnum,scheduleType:_this.getScheduleType(exception,offSchedule),isException:!(0,validation/* isEmpty */.xb)(exception),exception:exception,date:_this.getDate(startTimeMilli),startTime:(0,ControlScheduleUtil/* getHour */.ex)(startTime,"hh:mm a"),endTime:(0,ControlScheduleUtil/* getHour */.ex)(endTime,"hh:mm a"),startTimeMilli:startTimeMilli},currSchedule)}))})),this.$forceUpdate()},getLabel:function(indexDays,indexHours){return 0===indexDays&&0===indexHours?"GMT".concat(moment().format("Z")):0===indexDays?"12:00 AM"===this.getTimeInterval[indexHours]?"":this.getTimeInterval[indexHours]:0===indexHours?DAYS_IN_WEEK_FORMATTED[indexDays-1]:""},getScheduleType:function(exception,offSchedule){return(0,validation/* isEmpty */.xb)(exception)?SCHEDULE_TYPE_ENUM["SCHEDULE"]:offSchedule?SCHEDULE_TYPE_ENUM["REDUCED_HOURS"]:SCHEDULE_TYPE_ENUM["EXTENDED_HOURS"]},getScheduleClass:function(time,days){if((0,validation/* isEmpty */.xb)(this.scheduleLookup)||(0,validation/* isEmpty */.xb)(this.scheduleLookup[days][time]))return"noSchedule";var scheduleType=this.scheduleLookup[days][time].scheduleType;return"".concat(scheduleType," ").concat(time)},getException:function(time,days){var scheduleObj=this.getSchedule(time,days);if(!(0,validation/* isEmpty */.xb)(scheduleObj)){var exception=scheduleObj.exception;return exception}},getSchedule:function(time,days){if(!(0,validation/* isEmpty */.xb)(this.scheduleLookup)&&!(0,validation/* isEmpty */.xb)(this.scheduleLookup[days][time]))return this.scheduleLookup[days][time]},getCellClass:function(day,hour){return 0===day&&0==hour?"schedule-container hour-header-cell":0===day?"hour-axis-cell":"schedule-container cell"},getDate:function(time){return moment(time).format("ddd - DD MMM")},deleteException:function(id,hour,day){this.$emit("deleteException",{id:id,slot:this.scheduleLookup[day][hour]})},editException:function(hour,day){this.$emit("editException",this.scheduleLookup[day][hour])}}},components_ScheduleVisualizervue_type_script_lang_js=ScheduleVisualizervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_ScheduleVisualizervue_type_script_lang_js,render,staticRenderFns,!1,null,"dbecb28c",null)
/* harmony default export */,ScheduleVisualizer=component.exports},
/***/935010:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"765af973ce02f8f593ec7a4e85d08efb.svg";
/***/}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/51633.js.map