(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[11476],{
/***/398758:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return AnalayticsFilter}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/energy/analytics/components/AnalayticsFilter.vue?vue&type=template&id=c060834c
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"building-popover"},[_c("div",{staticClass:"side-bar-site-details flex-middle"},[_vm.isSiteAnalysis?_c("div",[_c("InlineSvg",{staticClass:"pointer",attrs:{src:"svgs/spacemanagement/site",iconClass:"icon-50"}})],1):_c("div",{staticClass:"building-icon-container",staticStyle:{margin:"-10px -10px"}},[_c("InlineSvg",{staticClass:"pointer",attrs:{src:"svgs/spacemanagement/building",iconClass:"icon-50 resize_building_icon"}})],1),_c("div",{staticClass:"pL10 width100"},[_c("div",{staticClass:"display-flex-between-space"},[_c("div",{staticClass:"fc-id"},[_vm._v(_vm._s("#")+_vm._s(_vm.selectedBuildingId))]),_c("div",{staticStyle:{"margin-top":"12px","margin-right":"15px"}},[_c("div",{staticClass:"popover-text",attrs:{slot:"reference"},on:{click:function($event){return _vm.showLookupWizard()}},slot:"reference"},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.change_site_message_label"))+" ")])])]),_c("div",{staticClass:"display-flex-between-space",staticStyle:{"margin-top":"-8px"}},[_c("div",{staticClass:"label-text pointer label_text",on:{click:function($event){return _vm.showLookupWizard()}}},[_vm._v(" "+_vm._s(_vm.selectedBuildingLabel)+" ")])])])]),_vm.showingLookupWizard?_c("div",[_c("LookupWizard",{attrs:{canShowLookupWizard:_vm.showingLookupWizard,field:_vm.isSiteAnalysis?_vm.siteFieldObj:_vm.buildingFieldObj},on:{"update:canShowLookupWizard":function($event){_vm.showingLookupWizard=$event},"update:can-show-lookup-wizard":function($event){_vm.showingLookupWizard=$event},setLookupFieldValue:function(value){return _vm.toggleBuilding(value.field.selectedItems[0].value,value.field.selectedItems[0].label)}}})],1):_vm._e()])},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),ui_forms=(__webpack_require__(162506),__webpack_require__(670560),__webpack_require__(141323)),picklist=__webpack_require__(961358),AnalayticsFiltervue_type_script_lang_js={props:["config","selectedBuildings","multiple","zones","isSiteAnalysis"],components:{LookupWizard:ui_forms/* LookupWizard */.ns},data:function(){return{selectedBuildingsInternal:[],showingLookupWizard:!1,selectedBuildingLabel:"",selectedBuildingId:null,buildingFieldObj:{isDataLoading:!1,options:[],lookupModuleName:"building",field:{lookupModule:{name:"building",displayName:"Building"}},selectedItems:[],forceFetchAlways:!0,filters:{},isDisabled:!1},siteFieldObj:{isDataLoading:!1,options:[],lookupModuleName:"site",field:{lookupModule:{name:"site",displayName:"Site"}},selectedItems:[],forceFetchAlways:!0,filters:{},isDisabled:!1}}},created:function(){
// this.$store.dispatch('loadSites')
// this.$store.dispatch('loadBuildings')
},computed:{},mounted:function(){this.selectedBuildingsInternal=this.selectedBuildings,this.getBuildingLabel(),this.selectedBuildingId=this.selectedBuildings&&this.selectedBuildings[0]?this.selectedBuildings[0]:this.isSiteAnalysis?"No Sites":"No Buildings"},watch:{selectedBuildingsInternal:function(newVal){this.$emit("update:selectedBuildings",this.selectedBuildingsInternal)}},methods:{showLookupWizard:function(){this.showingLookupWizard=!0},getBuildingLabel:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(_this.selectedBuildingsInternal=_this.selectedBuildings,!_this.selectedBuildingsInternal[0]||_this.isSiteAnalysis){_context.next=6;break}return _context.next=4,(0,picklist/* getFieldValue */.oe)({lookupModuleName:"building",selectedOptionId:[_this.selectedBuildingsInternal[0]]}).then((function(_ref){var error=_ref.error,data=_ref.data;if(!error&&data){var value=data[0].label;_this.selectedBuildingLabel=value,_this.buildingFieldObj.selectedItems[0]={value:_this.selectedBuildingsInternal[0],label:_this.selectedBuildingLabel}}}));case 4:_context.next=12;break;case 6:if(!_this.selectedBuildingsInternal[0]||!_this.isSiteAnalysis){_context.next=11;break}return _context.next=9,(0,picklist/* getFieldValue */.oe)({lookupModuleName:"site",selectedOptionId:[_this.selectedBuildingsInternal[0]]}).then((function(_ref2){var error=_ref2.error,data=_ref2.data;if(!error&&data){var value=_this.$getProperty(data,"0.label");_this.selectedBuildingLabel=value,_this.siteFieldObj.selectedItems[0]={value:_this.selectedBuildingsInternal[0],label:_this.selectedBuildingLabel}}}));case 9:_context.next=12;break;case 11:_this.selectedBuildingLabel=_this.isSiteAnalysis?"No Sites":"No Buildings";case 12:case"end":return _context.stop()}}),_callee)})))()},toggleBuilding:function(buildingId,buildingName){if(this.multiple){var idx=this.selectedBuildingsInternal.indexOf(buildingId);-1!==idx?this.selectedBuildingsInternal.length>1&&this.selectedBuildingsInternal.splice(idx,1):this.selectedBuildingsInternal.push(buildingId)}else this.selectedBuildingsInternal=[buildingId],buildingId&&buildingName&&(this.selectedBuildingId=buildingId,this.selectedBuildingLabel=buildingName)},updateSelectedBuilding:function(buildings){this.selectedBuildingsInternal=buildings}}},components_AnalayticsFiltervue_type_script_lang_js=AnalayticsFiltervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_AnalayticsFiltervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,AnalayticsFilter=component.exports},
/***/608998:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FScatterPointSelector}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/report/components/FScatterPointSelector.vue?vue&type=template&id=51732f3c
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.visibility?_c("div",{staticClass:"newregression-analysis"},[_c("div",[_c("div",{staticClass:"scatter-main-con"},[_c("div",{staticClass:"building-analysis-sidebar-conatainer regression-analytics-container"},[_c("el-row",{staticClass:"mT20"},[_c("el-col",{attrs:{span:22}},[_c("div",{staticClass:"fc-text-pink"},[_vm._v("SERIES")])]),_vm.enableAddSeries?_c("el-col",{attrs:{span:2}},[_c("div",{staticClass:"pointer z-20",on:{click:function($event){return _vm.addSeries()}}},[_c("inline-svg",{staticClass:"vertical-middle",attrs:{src:"svgs/add-circled",iconClass:"icon icon-md icon-add mT5"}})],1)]):_vm._e()],1),_vm._l(_vm.config.result,(function(group,idx){return _c("div",{key:idx},[_c("div",{staticStyle:{"box-shadow":"none"}},[_c("div",{},[_c("div",{staticClass:" pB20 pL10 pR10 series-box"},[_c("el-row",[_c("el-col",{attrs:{span:_vm.config.result.length>1?22:24}},[_c("div",{staticClass:"label-txt-black f11 bold pT10"},[_vm._v(" SERIES "+_vm._s(idx+1)+" ")])]),_vm.config.result.length>1?_c("el-col",{attrs:{span:2}},[_c("div",{staticClass:"mT5",on:{click:function($event){return _vm.deleteSeries(idx)}}},[_c("span",{staticClass:"flRight"},[_c("i",{staticClass:"el-icon-more pointer f14 fc-grey6"})])])]):_vm._e()],1),_c("el-row",{staticClass:"pT20"},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"label-txt-black pB10"},[_vm._v(" Dimension ")]),group.metrics.selectedDataPoints.length?_vm._l(group.metrics.selectedDataPoints,(function(data,index){return[_c("el-row",{key:index,staticClass:"visibility-visible-actions"},[_c("el-col",{attrs:{span:_vm.analyticsConfig&&_vm.analyticsConfig.period?20:24}},[_c("div",{staticClass:"fc-input-div-full-border-f14",on:{click:function($event){_vm.config.firstPanel.selectedTab="METRICS",_vm.selectDefaultTab("METRICS"),_vm.selectorPanelShow=!0,_vm.currentIndex=idx,_vm.$emit("update:enableFloatimngIcon",!1)}}},[_c("span",[_vm._v(_vm._s(_vm.getFormatedData(data,"metrics",idx)))]),_c("i",{staticClass:" pointer mT12 el-icon-arrow-right pull-right "})])]),_vm.analyticsConfig&&_vm.analyticsConfig.period?_c("el-col",{staticClass:"pL10 ",attrs:{span:4}},[_c("div",{staticClass:"fc-input-div-full-border-f14 pointer pointer position-relative",staticStyle:{"padding-left":"12px"}},[_c("el-popover",{attrs:{placement:"top-start",width:"90",trigger:"click","popper-class":"metric-popover"}},[_vm._l(_vm.metricAggregation,(function(metricAggr,metricAggrIdx){return _c("div",{key:metricAggrIdx,staticClass:"pointer pT5 pB5 fc-label-hover label-txt-black f14 text-center",class:{active:group["metrics"].dataPoints[index]&&metricAggr.value===group["metrics"].dataPoints[index].yAxis.aggr},attrs:{value:metricAggr.value},on:{click:function($event){return _vm.setAggr(index,metricAggr.value,"metrics",idx)}}},[_vm._v(" "+_vm._s(metricAggr.label)+" ")])})),_c("img",{attrs:{slot:"reference",src:__webpack_require__(667527)},slot:"reference"})],2)],1)]):_vm._e()],1)]})):_c("div",{staticClass:"fc-input-div-full-border-f14 position-relative",class:{active:"METRICS"===_vm.config.firstPanel.selectedTab},on:{click:function($event){_vm.config.firstPanel.selectedTab="METRICS",_vm.selectorPanelShow=!0,_vm.currentIndex=idx,_vm.selectDefaultTab("METRICS"),_vm.$emit("update:enableFloatimngIcon",!1)}}},[_c("span",[_vm._v(_vm._s(_vm.$t("common._common.select")))]),_c("i",{staticClass:" pointer mT12 el-icon-arrow-right pull-right regression-right-icon"})])],2)],1),_c("el-row",{staticClass:"pT20"},[_c("el-col",{attrs:{span:24}},[_c("div",[_c("div",{staticClass:"label-txt-black pB10"},[_vm._v(" Metric ")]),group.dimension.selectedDataPoints.length?_c("div",{staticClass:"fc-dark-blue2-14 pointer pB10",staticStyle:{"text-align":"right"},on:{click:function($event){_vm.config.firstPanel.selectedTab="DIMENSION",_vm.selectDefaultTab("DIMENSION"),_vm.selectorPanelShow=!0,_vm.currentIndex=idx,_vm.$emit("update:enableFloatimngIcon",!1)}}}):_vm._e()]),group.dimension.selectedDataPoints.length?_vm._l(group.dimension.selectedDataPoints,(function(data1,index1){return[_c("el-row",{key:index1,staticClass:"visibility-visible-actions"},[_c("el-col",{attrs:{span:group.dimension.selectedDataPoints.length&&_vm.analyticsConfig&&_vm.analyticsConfig.period?20:24}},[_c("div",{staticClass:"fc-input-div-full-border-f14 position-relative"},[_c("span",[_vm._v(_vm._s(_vm.getFormatedData(data1,"dimension",idx)))])])]),_vm.analyticsConfig&&_vm.analyticsConfig.period?_c("el-col",{staticClass:"pL10 pB20",attrs:{span:4}},[_c("div",{staticClass:"fc-input-div-full-border-f14 pointer pointer position-relative",staticStyle:{"padding-left":"12px"}},[_c("el-popover",{attrs:{placement:"top-start",width:"90",trigger:"click","popper-class":"metric-popover"}},[_vm._l(_vm.metricAggregation,(function(metricAggr,metricAggrIdx){return _c("div",{key:metricAggrIdx,staticClass:"pointer pT5 pB5 fc-label-hover label-txt-black f14 text-center",class:{active:group["dimension"].dataPoints[index1]&&metricAggr.value===group["dimension"].dataPoints[index1].yAxis.aggr},attrs:{value:metricAggr.value},on:{click:function($event){return _vm.setAggr(index1,metricAggr.value,"dimension",idx)}}},[_vm._v(" "+_vm._s(metricAggr.label)+" ")])})),_c("img",{attrs:{slot:"reference",src:__webpack_require__(667527)},slot:"reference"})],2)],1)]):_vm._e()],1)]})):_c("div",{staticClass:"fc-input-div-full-border-f14 position-relative clearboth",on:{click:function($event){_vm.config.firstPanel.selectedTab="DIMENSION",_vm.selectDefaultTab("DIMENSION"),_vm.selectorPanelShow=!0,_vm.currentIndex=idx,_vm.$emit("update:enableFloatimngIcon",!1)}}},[_c("span",[_vm._v(_vm._s(_vm.$t("common._common.select")))]),_c("i",{staticClass:" pointer mT12 el-icon-arrow-right pull-right regression-right-icon"})])],2)],1)],1)])]),_c("div",{staticClass:"sidebar-position-setup regeression0-ananlysis"},[_vm.selectorPanelShow?_c("div",{staticClass:"sidebar-close-btn pointer",on:{click:function($event){_vm.cancel(),_vm.$emit("update:enableFloatimngIcon",!0)}}},[_vm._m(0,!0)]):_vm._e(),_vm.buildingIds&&_vm.buildingIds.length?_vm.selectorPanelShow&&_vm.currentIndex===idx&&_vm.loading?_c("div",{staticClass:"newanalytics-sidebar col-3"},[_c("spinner",{attrs:{show:_vm.loading}})],1):_vm._e():_c("div",[_vm._v(" No buildings selected. ")]),_vm.selectorPanelShow&&_vm.currentIndex===idx&&!_vm.loading?[_vm.loading||"DIMENSION"!==_vm.config.firstPanel.selectedTab?_vm._e():_c("div",{staticClass:"newanalytics-sidebar col-3"},[_c("div",{staticClass:"data-pointer-selector-popup"},[_c("analaytics-filter",{attrs:{selectedBuildings:_vm.selectedBuildings},on:{"update:selectedBuildings":function($event){_vm.selectedBuildings=$event},"update:selected-buildings":function($event){_vm.selectedBuildings=$event}}})],1),_c("div",[_vm.showQuickSearch?_c("div",[_c("div",{staticClass:"fc-list-search"},[_c("div",{staticClass:"fc-list-search-wrapper relative fc-list-search-wrapperbuilding-search"},[_c("input",{directives:[{name:"model",rawName:"v-model",value:_vm.searchKey,expression:"searchKey"}],ref:"quickSearchQuery",refInFor:!0,staticClass:"quick-search-input4",attrs:{autofocus:"",type:"text",placeholder:"Search"},domProps:{value:_vm.searchKey},on:{keyup:_vm.quickSearch,input:function($event){$event.target.composing||(_vm.searchKey=$event.target.value)}}}),_c("svg",{staticClass:"close-icon4",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 32 32","aria-hidden":"true"},on:{click:_vm.closeSearch}},[_c("title",[_vm._v("close")]),_c("path",{attrs:{d:"M17.992 16l8.796-8.796a1.409 1.409 0 0 0-1.992-1.992L16 14.008 7.204 5.212a1.409 1.409 0 0 0-1.992 1.992L14.008 16l-8.796 8.796a1.409 1.409 0 0 0 1.992 1.992L16 17.992l8.796 8.796a1.409 1.409 0 0 0 1.992-1.992L17.992 16z"}})])])])]):_vm._e(),_c("div",{staticClass:"building-analysis-side-block"},[_c("div",{staticClass:"building-hover-actions"},[_c("div",{staticClass:"sidebar-asset-H fL",on:{click:_vm.weatherPanelToggler}},[_vm._v(" Weather ")]),_vm.weatherPanel.show?_c("div",{attrs:{lass:"building-anlysis-active-block"}},_vm._l(_vm.weatherModules,(function(weatherModule,wIdx){return _c("div",{key:wIdx,class:["pointer","building-anlysis-label-txt","clearboth",{"asset-list-block-txt-active":_vm.weatherPanel.weatherCategory&&weatherModule.displayName===_vm.weatherPanel.weatherCategory.displayName}],on:{click:function($event){return _vm.loadWeatherReadings(weatherModule,wIdx)}}},[_c("i",{class:{"fa fa-circle":!0,"dot-blue-icon":!0===weatherModule.selected,"dot-grey-icon":!1===weatherModule.selected},attrs:{"aria-hidden":"true"}}),_c("div",{staticClass:"width80"},[_vm._v(" "+_vm._s(weatherModule.displayName)+" ")])])})),0):_vm._e()])]),_c("div",{staticClass:"building-analysis-side-block"},[_c("div",{staticClass:"building-hover-actions"},[_c("div",{staticClass:"sidebar-asset-H fL",on:{click:_vm.loadSpaceReadings}},[_vm._v(" Spaces ")])])]),_c("div",{staticClass:"building-analysis-side-block"},[_c("div",{staticClass:"building-hover-actions"},[_c("div",{staticClass:"sidebar-asset-H fL",on:{click:_vm.loadAssetCategories}},[_vm._v(" Assets ")])]),"assets"===_vm.config.mainPanel.currentModule?_c("div",{staticClass:"building-anlysis-active-block"},[_vm._l(_vm.config.mainPanel.assetCategories,(function(category,index){return _vm.config.mainPanel.assetCategories&&_vm.config.mainPanel.assetCategories.length?_c("div",{key:index,class:["building-anlysis-label-txt","clearboth",{"asset-list-block-txt-active":_vm.config.mainPanel.selectedAssetCategory===category.id}],on:{click:function($event){return _vm.openAssetCategory(category.id)}}},[_c("i",{class:{"fa fa-circle":!0,"dot-blue-icon":_vm.config.mainPanel.selectedAssetCategory===category.id,"dot-grey-icon":_vm.config.mainPanel.selectedAssetCategory!=category.id},attrs:{"aria-hidden":"true"}}),_c("div",{staticClass:"width80"},[_vm._v(_vm._s(category.displayName))])]):_vm._e()})),_vm.config.mainPanel.assetCategoriesLoading?_c("spinner",{staticClass:"clearboth",attrs:{show:_vm.config.mainPanel.assetCategoriesLoading}}):_vm.config.mainPanel.assetCategories.length?_vm._e():_c("div",{staticClass:"building-anlysis-label-txt clearboth"},[_vm._v(" -- No assets -- ")])],2):_vm._e()]),_c("div",{staticClass:"building-analysis-side-block"},[_c("div",{staticClass:"building-hover-actions"},[_c("div",{staticClass:"sidebar-asset-H fL",on:{click:_vm.loadEnPIReadings}},[_vm._v(" EnPI ")])])])])]),_vm.loading||"METRICS"!==_vm.config.firstPanel.selectedTab?_vm._e():_c("div",{staticClass:"newanalytics-sidebar col-3"},[_c("div",{staticClass:"data-pointer-selector-popup"},[_c("analaytics-filter",{attrs:{selectedBuildings:_vm.selectedBuildings},on:{"update:selectedBuildings":function($event){_vm.selectedBuildings=$event},"update:selected-buildings":function($event){_vm.selectedBuildings=$event}}})],1),_c("div",[_vm.showQuickSearch?_c("div",[_c("div",{staticClass:"fc-list-search"},[_c("div",{staticClass:"fc-list-search-wrapper relative fc-list-search-wrapperbuilding-search"},[_c("input",{directives:[{name:"model",rawName:"v-model",value:_vm.searchKey,expression:"searchKey"}],ref:"quickSearchQuery",refInFor:!0,staticClass:"quick-search-input4",attrs:{autofocus:"",type:"text",placeholder:"Search"},domProps:{value:_vm.searchKey},on:{keyup:_vm.quickSearch,input:function($event){$event.target.composing||(_vm.searchKey=$event.target.value)}}}),_c("svg",{staticClass:"close-icon4",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 32 32","aria-hidden":"true"},on:{click:_vm.closeSearch}},[_c("title",[_vm._v("close")]),_c("path",{attrs:{d:"M17.992 16l8.796-8.796a1.409 1.409 0 0 0-1.992-1.992L16 14.008 7.204 5.212a1.409 1.409 0 0 0-1.992 1.992L14.008 16l-8.796 8.796a1.409 1.409 0 0 0 1.992 1.992L16 17.992l8.796 8.796a1.409 1.409 0 0 0 1.992-1.992L17.992 16z"}})])])])]):_vm._e(),_c("div",{staticClass:"building-analysis-side-block"},[_c("div",{staticClass:"building-hover-actions"},[_c("div",{staticClass:"sidebar-asset-H fL",on:{click:_vm.loadAssetCategories}},[_vm._v(" Assets ")])]),"assets"===_vm.config.mainPanel.currentModule?_c("div",{staticClass:"building-anlysis-active-block"},[_vm._l(_vm.config.mainPanel.assetCategories,(function(category,index){return _vm.config.mainPanel.assetCategories&&_vm.config.mainPanel.assetCategories.length?_c("div",{key:index,class:["building-anlysis-label-txt","clearboth",{"asset-list-block-txt-active":_vm.config.mainPanel.selectedAssetCategory===category.id}],on:{click:function($event){return _vm.openAssetCategory(category.id)}}},[_c("i",{class:{"fa fa-circle":!0,"dot-blue-icon":_vm.config.mainPanel.selectedAssetCategory===category.id,"dot-grey-icon":_vm.config.mainPanel.selectedAssetCategory!=category.id},attrs:{"aria-hidden":"true"}}),_c("div",{staticClass:"width80"},[_vm._v(_vm._s(category.displayName))])]):_vm._e()})),_vm.config.mainPanel.assetCategoriesLoading?_c("spinner",{staticClass:"clearboth",attrs:{show:_vm.config.mainPanel.assetCategoriesLoading}}):_vm.config.mainPanel.assetCategories.length?_vm._e():_c("div",{staticClass:"building-anlysis-label-txt clearboth"},[_vm._v(" -- No assets -- ")])],2):_vm._e()]),_c("div",{staticClass:"building-analysis-side-block"},[_c("div",{staticClass:"building-hover-actions"},[_c("div",{staticClass:"sidebar-asset-H fL",on:{click:_vm.loadSpaceReadings}},[_vm._v(" Spaces ")])])]),_c("div",{staticClass:"building-analysis-side-block"},[_c("div",{staticClass:"building-hover-actions"},[_c("div",{staticClass:"sidebar-asset-H fL",on:{click:_vm.loadEnPIReadings}},[_vm._v(" EnPI ")])])]),_c("div",{staticClass:"building-analysis-side-block"},[_c("div",{staticClass:"building-hover-actions"},[_c("div",{staticClass:"sidebar-asset-H fL",on:{click:_vm.weatherPanelToggler}},[_vm._v(" Weather ")]),_vm.weatherPanel.show?_c("div",{attrs:{lass:"building-anlysis-active-block"}},_vm._l(_vm.weatherModules,(function(weatherModule,wIdx){return _c("div",{key:wIdx,class:["pointer","building-anlysis-label-txt","clearboth",{"asset-list-block-txt-active":_vm.weatherPanel.weatherCategory&&weatherModule.displayName===_vm.weatherPanel.weatherCategory.displayName}],on:{click:function($event){return _vm.loadWeatherReadings(weatherModule,wIdx)}}},[_c("i",{class:{"fa fa-circle":!0,"dot-blue-icon":!0===weatherModule.selected,"dot-grey-icon":!1===weatherModule.selected},attrs:{"aria-hidden":"true"}}),_c("div",{staticClass:"width80"},[_vm._v(" "+_vm._s(weatherModule.displayName)+" ")])])})),0):_vm._e()])])])]),_vm.config.assetPointsPanel.show?_c("div",{staticClass:"assets-points-Scontainer assets-points-Scontainer-lalign"},[_c("div",{staticClass:"assets-points-inner-container"},[_c("el-tabs",{on:{"tab-click":function($event){return _vm.openAssetCategory(_vm.config.mainPanel.selectedAssetCategory)}},model:{value:_vm.config.assetPointsPanel.activeSubTab,callback:function($$v){_vm.$set(_vm.config.assetPointsPanel,"activeSubTab",$$v)},expression:"config.assetPointsPanel.activeSubTab"}},[_c("el-tab-pane",{attrs:{label:"Points",name:"points"}},[_c("span",{attrs:{slot:"label"},slot:"label"},[_c("img",{staticStyle:{position:"relative",top:"4px",right:"7px"},attrs:{src:__webpack_require__(587758),width:"18px",height:"18px"}}),_vm._v("Points")]),_c("div",{staticClass:"building-points-search"},[_c("el-input",{attrs:{placeholder:"Filter points",autofocus:""},model:{value:_vm.config.assetPointsPanel.filterQuery,callback:function($$v){_vm.$set(_vm.config.assetPointsPanel,"filterQuery",$$v)},expression:"config.assetPointsPanel.filterQuery"}})],1),_c("div",{staticClass:"asset-list-container mT10"},[_vm.config.assetPointsPanel.loading?_c("spinner",{attrs:{show:_vm.config.assetPointsPanel.loading}}):_vm.config.assetPointsPanel.data&&_vm.config.assetPointsPanel.data.length?_vm._l(_vm.filteredAssetPointsPanel,(function(item,index){return _c("div",{key:index,staticClass:"asset-list-block-txt",class:{"asset-list-block-txt-active":_vm.config.assetPointsPanel.selectedAssetOrPoint===item.id},on:{click:function($event){return _vm.openPoint(item.id)}}},[_c("div",{staticClass:"asset-active-select-item"},[_vm._v(" "+_vm._s(item.displayName?item.displayName:item.name)+" ")])])})):_c("div",{staticClass:"asset-list-block-txt text-center"},[_vm._v(" No points. ")])],2)]),_c("el-tab-pane",{attrs:{label:"Assets",name:"assets"}},[_c("span",{attrs:{slot:"label"},slot:"label"},[_c("img",{staticStyle:{position:"relative",top:"4px",right:"8px"},attrs:{src:__webpack_require__(134105),width:"16px",height:"16px"}}),_vm._v("Assets")]),_c("div",{staticClass:"building-points-search"},[_c("el-input",{attrs:{placeholder:"Filter assets",autofocus:""},model:{value:_vm.config.assetPointsPanel.filterQuery,callback:function($$v){_vm.$set(_vm.config.assetPointsPanel,"filterQuery",$$v)},expression:"config.assetPointsPanel.filterQuery"}})],1),_c("div",{staticClass:"asset-list-container mT10"},[_vm.config.assetPointsPanel.loading?_c("spinner",{attrs:{show:_vm.config.assetPointsPanel.loading}}):_vm.config.assetPointsPanel.data&&_vm.config.assetPointsPanel.data.length?_vm._l(_vm.filteredAssetPointsPanel,(function(item,index){return _c("div",{key:index,staticClass:"asset-list-block-txt",class:{"asset-list-block-txt-active":_vm.config.assetPointsPanel.selectedAssetOrPoint===item.id},on:{click:function($event){return _vm.openAsset(item.id)}}},[_c("div",{staticClass:"asset-active-select-item"},[_vm._v(" "+_vm._s(item.name?item.name:item.displayName)+" ")])])})):_c("div",{staticClass:"asset-list-block-txt text-center"},[_vm._v(" No assets. ")])],2)])],1)],1)]):_vm._e(),_vm.config.selectReadingsPanel.show&&"DIMENSION"===_vm.config.firstPanel.selectedTab?_c("div",{staticClass:"assets-points-Scontainer assets-points-Scontainer-shadow"},[_c("div",[_c("div",{staticClass:"assets-points-inner-container readings-list-container"},[_vm._m(1,!0),_c("div",{staticClass:"building-points-search building-points-height"},[_c("el-input",{attrs:{placeholder:"Filter readings",autofocus:""},model:{value:_vm.config.selectReadingsPanel.filterQuery,callback:function($$v){_vm.$set(_vm.config.selectReadingsPanel,"filterQuery",$$v)},expression:"config.selectReadingsPanel.filterQuery"}})],1),_c("div",{staticClass:"mT10 readings-scroll asset-list-container"},[_vm.config.selectReadingsPanel.loading?_c("spinner",{attrs:{show:_vm.config.selectReadingsPanel.loading}}):_vm.config.selectReadingsPanel.data&&_vm.config.selectReadingsPanel.data.length?_c("el-checkbox-group",{staticClass:"building-check-list",on:{change:function($event){return _vm.prepareSavedPointsSummaryList(idx)}},model:{value:group.dimension.selectedDataPoints,callback:function($$v){_vm.$set(group.dimension,"selectedDataPoints",$$v)},expression:"group.dimension.selectedDataPoints"}},_vm._l(_vm.filteredReadingsPanel,(function(item,index){return _c("el-checkbox",{key:index,attrs:{label:item.id+"_"+_vm.config.selectReadingsPanel.parentId}},[_vm._v(_vm._s(item.displayName?item.displayName:item.name))])})),1):_c("div",{staticClass:"text-center"},[_vm._v(" No data found. ")])],1)]),group.dimension.selectedDataPoints&&group.dimension.selectedDataPoints.length?_c("div",{staticClass:"building-analysis-point-container reading-apply-container row"},[_c("div",{staticClass:"building-analysis-points-wrap col-12"},[_c("div",{staticClass:"building-analysis-points-btn fL col-4"},[_c("el-button",{staticClass:"btn-grey-fill pL30 pR30",attrs:{type:"button"},on:{click:_vm.cancel}},[_vm._v(_vm._s(_vm.$t("setup.users_management.cancel")))]),_c("el-button",{staticClass:"btn-blue-fill pL30 pR30 mL15",attrs:{type:"button"},on:{click:function($event){return _vm.apply(idx)}}},[_vm._v(_vm._s(_vm.$t("maintenance.pm_list.apply")))])],1)])]):_vm._e()])]):_vm._e(),_vm.config.selectReadingsPanel.show&&"METRICS"===_vm.config.firstPanel.selectedTab?_c("div",{staticClass:"assets-points-Scontainer assets-points-Scontainer-shadow"},[_c("div",[_c("div",{staticClass:"assets-points-inner-container readings-list-container"},[_vm._m(2,!0),_c("div",{staticClass:"building-points-search building-points-height"},[_c("el-input",{attrs:{placeholder:"Filter readings",autofocus:""},model:{value:_vm.config.selectReadingsPanel.filterQuery,callback:function($$v){_vm.$set(_vm.config.selectReadingsPanel,"filterQuery",$$v)},expression:"config.selectReadingsPanel.filterQuery"}})],1),_c("div",{staticClass:"mT10 readings-scroll asset-list-container"},[_vm.config.selectReadingsPanel.loading?_c("spinner",{attrs:{show:_vm.config.selectReadingsPanel.loading}}):_vm.config.selectReadingsPanel.data&&_vm.config.selectReadingsPanel.data.length?_vm._e():_c("div",{staticClass:"text-center"},[_vm._v(" No data found. ")]),_vm.config.selectReadingsPanel.show&&"METRICS"===_vm.config.firstPanel.selectedTab?_c("div",_vm._l(_vm.filteredReadingsPanel,(function(item,index){return _c("div",{key:index,staticClass:"asset-list-block-txt",on:{click:function($event){_vm.selectDataPoint(item.id+"_"+_vm.config.selectReadingsPanel.parentId,"metrics",idx),_vm.prepareSavedPointsSummaryList(idx),_vm.apply(idx)}}},[_vm._v(" "+_vm._s(item.displayName?item.displayName:item.name)+" "),group.metrics.selectedDataPoints[0]===item.id+"_"+_vm.config.selectReadingsPanel.parentId?_c("i",{staticClass:"el-icon-check regression-icon"}):_vm._e()])})),0):_vm._e()],1)])])]):_vm._e(),_vm.config.selectAssetsPanel.show&&"DIMENSION"===_vm.config.firstPanel.selectedTab?_c("div",{staticClass:"assets-points-Scontainer assets-points-Scontainer-shadow"},[_c("div",[_c("div",{staticClass:"assets-points-inner-container readings-list-container"},[_vm._m(3,!0),_c("div",{staticClass:"building-points-search building-points-height"},[_c("el-input",{attrs:{placeholder:"Filter assets",autofocus:""},model:{value:_vm.config.selectAssetsPanel.filterQuery,callback:function($$v){_vm.$set(_vm.config.selectAssetsPanel,"filterQuery",$$v)},expression:"config.selectAssetsPanel.filterQuery"}})],1),_c("div",{staticClass:"asset-list-container mT10"},[_vm.config.selectAssetsPanel.loading?_c("spinner",{attrs:{show:_vm.config.selectAssetsPanel.loading}}):_vm.config.selectAssetsPanel.data&&_vm.config.selectAssetsPanel.data.length?_c("el-checkbox-group",{staticClass:"building-check-list",on:{change:function($event){return _vm.prepareSavedPointsSummaryList(idx)}},model:{value:group.dimension.selectedDataPoints,callback:function($$v){_vm.$set(group.dimension,"selectedDataPoints",$$v)},expression:"group.dimension.selectedDataPoints"}},_vm._l(_vm.filteredAssetsPanel,(function(item,index){return _c("el-checkbox",{key:index,attrs:{label:_vm.config.selectAssetsPanel.readingId+"_"+item.id}},[_vm._v(_vm._s(item.displayName?item.displayName:item.name))])})),1):_c("div",[_vm._v(" No data found. ")])],1)]),group.dimension.selectedDataPoints&&group.dimension.selectedDataPoints.length?_c("div",{staticClass:"building-analysis-point-container row"},[_c("div",{staticClass:"building-analysis-points-wrap col-12"},[_c("div"),_c("div",{staticClass:"building-analysis-points-btn fL col-4"},[_c("el-button",{staticClass:"btn-grey-fill pL30 pR30",attrs:{type:"button"},on:{click:_vm.cancel}},[_vm._v(_vm._s(_vm.$t("setup.users_management.cancel")))]),_c("el-button",{staticClass:"btn-blue-fill pL30 pR30 mL15",attrs:{type:"button"},on:{click:function($event){return _vm.apply(idx)}}},[_vm._v(_vm._s(_vm.$t("maintenance.pm_list.apply")))])],1)])]):_vm._e()])]):_vm._e(),_vm.config.selectAssetsPanel.show&&"METRICS"===_vm.config.firstPanel.selectedTab?_c("div",{staticClass:"assets-points-Scontainer assets-points-Scontainer-shadow"},[_c("div",[_c("div",{staticClass:"assets-points-inner-container readings-list-container"},[_vm._m(4,!0),_c("div",{staticClass:"building-points-search building-points-height"},[_c("el-input",{attrs:{placeholder:"Filter assets",autofocus:""},model:{value:_vm.config.selectAssetsPanel.filterQuery,callback:function($$v){_vm.$set(_vm.config.selectAssetsPanel,"filterQuery",$$v)},expression:"config.selectAssetsPanel.filterQuery"}})],1),_c("div",{staticClass:"asset-list-container mT10"},[_vm.config.selectAssetsPanel.loading?_c("spinner",{attrs:{show:_vm.config.selectAssetsPanel.loading}}):_vm.config.selectAssetsPanel.data&&_vm.config.selectAssetsPanel.data.length?_vm._e():_c("div",[_vm._v(" No data found. ")]),_vm._l(_vm.filteredAssetsPanel,(function(item,index){return _c("div",{key:index,staticClass:"asset-list-block-txt",on:{click:function($event){_vm.selectDataPoint(_vm.config.selectAssetsPanel.readingId+"_"+item.id,"metrics",idx),_vm.prepareSavedPointsSummaryList(idx),_vm.apply(idx)}}},[_vm._v(" "+_vm._s(item.displayName?item.displayName:item.name)+" "),group.metrics.selectedDataPoints[0]===_vm.config.selectAssetsPanel.readingId+"_"+item.id?_c("i",{staticClass:"el-icon-check regression-icon"}):_vm._e()])}))],2)])])]):_vm._e()]:_vm._e()],2)])}))],2)])])]):_vm._e()},staticRenderFns=[function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{},[_c("i",{staticClass:"el-icon-close"})])},function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"select-reading-header"},[_c("div",{staticClass:"select-reading-H"},[_vm._v(" SELECT READINGS ")])])},function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"select-reading-header"},[_c("div",{staticClass:"select-reading-H"},[_vm._v(" SELECT READINGS ")])])},function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"select-reading-header"},[_c("div",{staticClass:"select-reading-H"},[_vm._v(" SELECT ASSETS ")])])},function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"select-reading-header"},[_c("div",{staticClass:"select-reading-H"},[_vm._v(" SELECT ASSETS ")])])}],toConsumableArray=__webpack_require__(488478),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),createForOfIteratorHelper=__webpack_require__(566347),objectSpread2=__webpack_require__(595082),AnalayticsFilter=(__webpack_require__(670560),__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(228436),__webpack_require__(434284),__webpack_require__(648324),__webpack_require__(947522),__webpack_require__(425728),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(162506),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(919649),__webpack_require__(450886),__webpack_require__(169358),__webpack_require__(398758)),AnalyticsMixin=__webpack_require__(244936),NewDateHelper=__webpack_require__(105534),vuex_esm=__webpack_require__(420629),api=__webpack_require__(32284),picklist=__webpack_require__(961358),FScatterPointSelectorvue_type_script_lang_js={props:["reportObject","reportConfig","visibility","enableFloatimngIcon","analyticsConfig"],mixins:[AnalyticsMixin/* default */.Z],data:function(){return{weatherReadings:[],config:{firstPanel:{selectedTab:"DIMENSION"},mainPanel:{currentModule:"",assetCategories:null,assetCategoriesLoading:!1,selectedAssetCategory:null,selectedDataPoints:[]},assetPointsPanel:{show:!1,activeSubTab:"points",data:null,loading:!0,selectedAssetOrPoint:null,filterQuery:""},selectReadingsPanel:{show:!1,data:null,loading:!1,parentId:null,filterQuery:""},selectAssetsPanel:{show:!1,data:null,loading:!1,readingId:null,filterQuery:""},result:[{dimension:{selectedDataPoints:[],dataPoints:[],summaryList:[],scatterPoints:[],addedDataPoints:[]},metrics:{selectedDataPoints:[],dataPoints:[],summaryList:[],scatterPoints:[],addedDataPoints:[]}}]},selectorPanelShow:!1,currentIndex:0,showSavedReport:!1,weatherPanel:{show:!1,weatherCategory:null},quitReset:!1,metricAggregation:[{label:"AVG",value:2},{label:"SUM",value:3},{label:"MIN",value:4},{label:"MAX",value:5}],loading:!0,readings:{categories:[],assets:{},categoryWithAssets:{},fields:{},categoryWithFields:{}},showQuickSearch:!1,toggleMetricAggregation:!1,quickSearchQuery:null,selectedBuildings:[],weatherModules:[{displayName:"Live Weather",moduleName:"weather",selected:!1},{displayName:"Daily Weather",moduleName:"weatherDaily",selected:!1},{displayName:"Degree Days",selected:!1},{displayName:"Psychrometric",moduleName:"psychrometric",selected:!1}],deleteRangePoint:!1,rangePointConfirmation:!1,pointDeletionStore:{},summaryList:[],allFields:{assets:[]},currentKey:0,siteId:null,firstTime:!0,default_building_id:null,selectedBuildingLabel:"No Buildings"}},components:{AnalayticsFilter:AnalayticsFilter/* default */.Z},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({assetCategory:function(state){return state.assetCategory}})),{},{enableAddSeries:function(){var _step,enable=!0,_iterator=(0,createForOfIteratorHelper/* default */.Z)(this.config.result);try{for(_iterator.s();!(_step=_iterator.n()).done;){var group=_step.value;if(!group.dimension.selectedDataPoints.length||!group.metrics.selectedDataPoints.length){enable=!1;break}}}catch(err){_iterator.e(err)}finally{_iterator.f()}return enable},getAvailablePeriods:function(){var operationOnId=this.analyticsConfig.dateFilter.operationOnId,avail=[],isRangeEnabled=!0;
// avail.push({
//   name:'Week of year', // W1, W2
//   value: 16,
//   enable: true
// })
// avail.push({
//   name:'Month of year', // Jan, Feb , march
//   value: 15,
//   enable: true
// })
return avail.push({name:"High-res",value:0,enable:6!==operationOnId?4!==operationOnId&&isRangeEnabled:isRangeEnabled}),avail.push({name:"Hourly",value:20,enable:6===operationOnId||4!==operationOnId}),avail.push({name:"Daily",value:12,enable:!0}),avail.push({name:"Weekly",value:11,enable:!0}),avail.push({name:"Monthly",value:10,enable:!0}),avail.push({name:"Quarterly",value:25,enable:4===operationOnId||5===operationOnId}),avail.push({name:"Yearly",value:8,enable:4===operationOnId}),avail.push({name:"Hour of day",
// 12, 1, 2, 3
value:19,enable:!0}),avail.push({name:"Day of week",
// sun, mon
value:17,enable:!0}),avail.push({name:"Day of month",
// 1,2,3
value:18,enable:!0}),avail},isRangeModeEnabled:function(){if("undefined"!==typeof this.reportObject&&null!==this.reportObject){var dP=this.reportObject.options.dataPoints.filter((function(point){return"rangeGroup"===point.type}));return 0!==dP.length}return!1},buildingIds:function(){if(this.selectedBuildings&&this.selectedBuildings.length){var _step2,buildingIds=[],_iterator2=(0,createForOfIteratorHelper/* default */.Z)(this.selectedBuildings);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var sb=_step2.value;buildingIds.push(parseInt(sb))}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}return buildingIds}return null},selectedBuildingName:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var _yield$getFieldValue,data,error,value;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(!_this.selectedBuildings||!_this.selectedBuildings.length){_context.next=8;break}if(1!==_this.selectedBuildings.length){_context.next=8;break}return _context.next=4,(0,picklist/* getFieldValue */.oe)({lookupModuleName:"building",selectedOptionId:[_this.selectedBuildings[0]]});case 4:_yield$getFieldValue=_context.sent,data=_yield$getFieldValue.data,error=_yield$getFieldValue.error,!error&&data&&(value=_this.$getProperty(data,"0.label"),_this.selectedBuildingLabel=value);case 8:case"end":return _context.stop()}}),_callee)})))()},filteredAssetPointsPanel:function(){var self=this;return this.config.assetPointsPanel.data&&this.config.assetPointsPanel.data.length?this.config.assetPointsPanel.filterQuery&&this.config.assetPointsPanel.filterQuery.trim().length?this.config.assetPointsPanel.data.filter((function(d){var name=d.displayName?d.displayName:d.name;if(name.toLowerCase().indexOf(self.config.assetPointsPanel.filterQuery.toLowerCase())>=0)return d})):this.config.assetPointsPanel.data:[]},filteredReadingsPanel:function(){var self=this;return this.config.selectReadingsPanel.data&&this.config.selectReadingsPanel.data.length?this.config.selectReadingsPanel.filterQuery&&this.config.selectReadingsPanel.filterQuery.trim().length?this.config.selectReadingsPanel.data.filter((function(d){var name=d.displayName?d.displayName:d.name;if(name.toLowerCase().indexOf(self.config.selectReadingsPanel.filterQuery.toLowerCase())>=0)return d})):this.config.selectReadingsPanel.data:[]},filteredAssetsPanel:function(){var self=this;return this.config.selectAssetsPanel.data&&this.config.selectAssetsPanel.data.length?this.config.selectAssetsPanel.filterQuery&&this.config.selectAssetsPanel.filterQuery.trim().length?this.config.selectAssetsPanel.data.filter((function(d){var name=d.displayName?d.displayName:d.name;if(name.toLowerCase().indexOf(self.config.selectAssetsPanel.filterQuery.toLowerCase())>=0)return d})):this.config.selectAssetsPanel.data:[]}}),watch:{analyticsConfig:{handler:function(newVal,oldVal){newVal.scatterConfig&&this.checkForEmpty()&&this.readings&&this.allFields.weather&&this.allFields.assets&&this.populateSelector()},deep:!0},buildingIds:function(newVal,oldVal){JSON.stringify(newVal)!==JSON.stringify(oldVal)&&(this.loadAssetCategories(),this.resetResetReadings())},selectedBuildings:function(newVal,oldVal){newVal!==oldVal&&(this.config.selectReadingsPanel.spaceObj=null,this.weatherModules.forEach((function(points){points.selected=!1})),this.weatherReadings.length&&(this.weatherReadings=[]),this.selectDefaultTab())},selectedBuildingName:function(){var _selectedBuildingName=(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(newVal){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,this.selectedBuildingName;case 2:this.$emit("selectBuildings",{name:this.selectedBuildingLabel,ids:this.selectedBuildings});case 3:case"end":return _context2.stop()}}),_callee2,this)})));function selectedBuildingName(_x){return _selectedBuildingName.apply(this,arguments)}return selectedBuildingName}(),getAvailablePeriods:{handler:function(newData,oldData){var _this2=this,avail=this.getAvailablePeriods,selected=avail.find((function(a){return a.value===_this2.analyticsConfig.period&&a.enable}));if(!selected){var filterName=this.analyticsConfig.dateFilter.operationOn,defaultPeriod=avail.filter((function(a){return a.enable}))[0].value;"week"===filterName||"month"===filterName?defaultPeriod=12:"year"===filterName&&(defaultPeriod=10),this.analyticsConfig.period=defaultPeriod}},immediate:!0}},created:function(){var _this3=this;Promise.all([this.$store.dispatch("loadAssetCategory"),this.loadDefaultBuilding()]).then((function(){_this3.setDefaultSelection(),_this3.preLoadWeatherReadings()}))},mounted:function(){this.populateSelector()},methods:{loadDefaultBuilding:function(){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var _data$pickList,_yield$API$get,data,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,api/* API */.bl.get("/v3/picklist/building",_this4.urlParams,{force:!0});case 2:_yield$API$get=_context3.sent,data=_yield$API$get.data,error=_yield$API$get.error,!error&&(null===data||void 0===data||null===(_data$pickList=data.pickList)||void 0===_data$pickList?void 0:_data$pickList.length)>0&&(_this4.default_building_id=data.pickList[0].value);case 6:case"end":return _context3.stop()}}),_callee3)})))()},prepareSavedPointsSummaryList:function(resultIndex){null!==this.savedPoints&&"undefined"!==typeof this.savedPoints||this.addToSummaryListNew(this.config.firstPanel.selectedTab.toLowerCase(),resultIndex)},addSeries:function(){this.config.result.push({dimension:{selectedDataPoints:[],dataPoints:[],summaryList:[],scatterPoints:[],addedDataPoints:[]},metrics:{selectedDataPoints:[],dataPoints:[],summaryList:[],scatterPoints:[],addedDataPoints:[]}})},deleteSeries:function(idx){this.config.result.splice(idx,1)},checkForEmpty:function(){var _step3,empty=!0,_iterator3=(0,createForOfIteratorHelper/* default */.Z)(this.config.result);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var group=_step3.value;if(group.dimension.selectedDataPoints.length||group.metrics.selectedDataPoints.length){empty=!1;break}}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}return empty},checkForChangedDataPoints:function(newAnalyticConfig){var diff=!1;if(newAnalyticConfig&&newAnalyticConfig.dataPoints&&0!==newAnalyticConfig.dataPoints.length){var dataPointList=this.getAllDataPoints();if(0===dataPointList.length)return!0;if(0!==dataPointList.length){var _step4,_iterator4=(0,createForOfIteratorHelper/* default */.Z)(this.analyticsConfig.dataPoints);try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var dp=_step4.value;if(!dataPointList.includes(dp.yAxis.fieldId+"_"+dp.parentId)){diff=!0;break}}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}}}return diff},getAllDataPoints:function(){var _step5,dataPoints=[],_iterator5=(0,createForOfIteratorHelper/* default */.Z)(this.config.result);try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var group=_step5.value;0!=group.dimension.selectedDataPoints.length&&0!==group.metrics.selectedDataPoints.length&&(dataPoints.push.apply(dataPoints,(0,toConsumableArray/* default */.Z)(group.metrics.selectedDataPoints)),dataPoints.push.apply(dataPoints,(0,toConsumableArray/* default */.Z)(group.dimension.selectedDataPoints)))}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}return dataPoints},populateSelector:function(){if(this.analyticsConfig&&this.analyticsConfig.scatterConfig&&0!==this.analyticsConfig.scatterConfig.length){this.quitReset=!0;var metricDataPoints=[],dimensionDataPoints=[];metricDataPoints.push(this.analyticsConfig.scatterConfig[0].yAxis.readingId+"_"+this.analyticsConfig.scatterConfig[0].yAxis.parentId);var result=[];for(var configIndex in this.analyticsConfig.scatterConfig){var _step6,config=this.analyticsConfig.scatterConfig[configIndex],_iterator6=(0,createForOfIteratorHelper/* default */.Z)(config.xAxis);try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var xPoint=_step6.value,idenString="";idenString=xPoint.readingId+"_"+xPoint.parentId,dimensionDataPoints.push(idenString)}}catch(err){_iterator6.e(err)}finally{_iterator6.f()}result[configIndex]={dimension:{selectedDataPoints:[],dataPoints:[],summaryList:[],scatterPoints:[],addedDataPoints:[]},metrics:{selectedDataPoints:[],dataPoints:[],summaryList:[],scatterPoints:[],addedDataPoints:[]}},result[configIndex].dimension.selectedDataPoints=dimensionDataPoints,result[configIndex].metrics.selectedDataPoints=metricDataPoints}for(var groupIndex in this.config.result=result,this.config.result)this.populateAddedDataPoints(this.config,groupIndex),this.getSelectedPointsMeta(groupIndex)}else this.config.result=[]},deleteDataPoint:function(dataPointIndex,resultIndex){0!==this.config.result[resultIndex].dimension.selectedDataPoints.length&&(this.config.result[resultIndex].dimension.selectedDataPoints.splice(dataPointIndex,1),0===this.config.result[resultIndex].dimension.selectedDataPoints.length&&(this.config.result[resultIndex].metrics.selectedDataPoints=[]),this.apply(resultIndex))},setAggr:function(index,value,mode,resultIndex){this.config.result[resultIndex][mode].dataPoints[index].yAxis.aggr=value,this.config.result[resultIndex][mode].scatterPoints[index].aggr=value,this.updateAndEmitData()},preLoadWeatherReadings:function(){this.loadWeatherReadings()},selectDefaultTab:function(mode){this.config.assetPointsPanel={show:!1,activeSubTab:"points",data:null,loading:!0,selectedAssetOrPoint:null,filterQuery:""},this.weatherPanel.weatherCategory=null,this.config.selectAssetsPanel.show=!1,this.config.selectReadingsPanel.show=!1,this.weatherModules.forEach((function(points){points.selected=!1})),"DIMENSION"===mode?(this.weatherPanel.show=!0,this.config.mainPanel.currentModule=""):(this.weatherPanel.show=!1,this.loadAssetCategories("METRICS"))},onPeriodChange:function(){this.analyticsConfig.dataPoints.length||(20===this.analyticsConfig.period?this.analyticsConfig.dateFilter=NewDateHelper/* default */.Z.getDatePickerObject(31):12===this.analyticsConfig.period?this.analyticsConfig.dateFilter=NewDateHelper/* default */.Z.getDatePickerObject(28):10===this.analyticsConfig.period?this.analyticsConfig.dateFilter=NewDateHelper/* default */.Z.getDatePickerObject(44):this.analyticsConfig.dateFilter=NewDateHelper/* default */.Z.getDatePickerObject(22))},closeAllPanels:function(){this.config.assetPointsPanel.show=!1,this.config.selectAssetsPanel.show=!0,this.config.selectReadingsPanel.show=!1},updateAndEmitData:function(){var data=[];if(this.enableAddSeries){var _step7,_iterator7=(0,createForOfIteratorHelper/* default */.Z)(this.config.result);try{for(_iterator7.s();!(_step7=_iterator7.n()).done;){var group=_step7.value,yAxis=group.metrics.scatterPoints[0];
// group.dimension.scatterPoints.forEach(function(xAxis) {
data.push({xAxis:group.dimension.scatterPoints,yAxis:yAxis})}}catch(err){_iterator7.e(err)}finally{_iterator7.f()}}this.config.scatterPoints=data,this.$emit("updateDataPoints",this.config)},getLabelFromDataPoints:function(label){var _step8,split=label.split("_"),parentId=parseInt(split[split.length-1]),readingId=parseInt(split[0]),_iterator8=(0,createForOfIteratorHelper/* default */.Z)(this.analyticsConfig.dataPoints);try{for(_iterator8.s();!(_step8=_iterator8.n()).done;){var dataPoint=_step8.value;if(dataPoint.parentId===parentId&&dataPoint.yAxis.fieldId===readingId&&dataPoint.name)return dataPoint.name}}catch(err){_iterator8.e(err)}finally{_iterator8.f()}return null},getFormatedData:function(label,mode,resultIndex){var text="";if(0!==this.analyticsConfig.dataPoints.length&&(text=this.getLabelFromDataPoints(label)),(""===text||null===text||"undefined"===typeof text)&&(text="",label&&mode))if("metrics"===mode)this.config.result[resultIndex][mode].addedDataPoints.forEach((function(points){if(points.resourceId===parseInt(label.split("_")[1])&&points.readingId===parseInt(label.split("_")[0])){var readingLabel=points.readingLabel?points.readingLabel:points.label,resourceLabel=points.resourceLabel?points.resourceLabel:points.location;text=resourceLabel?resourceLabel+" ( "+readingLabel+" )":readingLabel}}));else{var _step9,parentId=parseInt(label.split("_")[1]),readingId=parseInt(label.split("_")[0]),_iterator9=(0,createForOfIteratorHelper/* default */.Z)(this.config.result[resultIndex].dimension.summaryList);try{for(_iterator9.s();!(_step9=_iterator9.n()).done;){var _step10,point=_step9.value,_iterator10=(0,createForOfIteratorHelper/* default */.Z)(point.readings);try{for(_iterator10.s();!(_step10=_iterator10.n()).done;){var reading=_step10.value;if(reading.readingId===readingId&&reading.resourceId===parentId){var resourceLabel=reading.resourceLabel?reading.resourceLabel:reading.location?reading.location:"",readingLabel=reading.readingLabel?reading.readingLabel:reading.label;text=resourceLabel?text+resourceLabel+"( "+readingLabel+" )":readingLabel}}}catch(err){_iterator10.e(err)}finally{_iterator10.f()}}}catch(err){_iterator9.e(err)}finally{_iterator9.f()}}return text},showMetricAggregation:function(metric){return!0},selectDataPoint:function(datapoint,mode,resultIndex){this.config.result[resultIndex][mode].selectedDataPoints=[],this.config.result[resultIndex][mode].selectedDataPoints.push(datapoint)},convertToList:function(readings){var _step11,readingsObject={},_iterator11=(0,createForOfIteratorHelper/* default */.Z)(readings);try{for(_iterator11.s();!(_step11=_iterator11.n()).done;){var reading=_step11.value;readingsObject[reading.id]=reading}}catch(err){_iterator11.e(err)}finally{_iterator11.f()}return readingsObject},reduceDataPoints:function(toBeDeletedDataPoints){var uniqueKeys=new Set;return toBeDeletedDataPoints.map((function(dp){return uniqueKeys.add(dp.fieldId+"."+dp.parentId)})),1===uniqueKeys.size?[toBeDeletedDataPoints[0]]:toBeDeletedDataPoints},getCategoryFromId:function(reading){var readingSplit=reading.split("_"),assetObject=this.readings.assets[parseInt(readingSplit[readingSplit.length-1])];return this.buildingIds[0]===parseInt(readingSplit[1])?"":assetObject?"assets":"weather"},addToSummaryListNew:function(source,resultIndex){var _this5=this,existingReadings=[],points=[],self=this,panel=source||self.config.firstPanel.selectedTab.toLowerCase();if(this.config.result[resultIndex][panel].selectedDataPoints&&0!==this.config.result[resultIndex][panel].selectedDataPoints.length){var _step12,_iterator12=(0,createForOfIteratorHelper/* default */.Z)(this.config.result[resultIndex][panel].selectedDataPoints);try{for(_iterator12.s();!(_step12=_iterator12.n()).done;){var point=_step12.value,temp={point:point,isDone:!1};points.push(temp)}}catch(err){_iterator12.e(err)}finally{_iterator12.f()}if(0!==this.config.result[resultIndex][panel].summaryList.length){this.currentKey=this.currentKey+1;var _step13,_iterator13=(0,createForOfIteratorHelper/* default */.Z)(this.config.result[resultIndex][panel].summaryList);try{for(_iterator13.s();!(_step13=_iterator13.n()).done;){var _step15,group=_step13.value,_iterator15=(0,createForOfIteratorHelper/* default */.Z)(group.readings);try{for(_iterator15.s();!(_step15=_iterator15.n()).done;){var reading=_step15.value;existingReadings.push(reading)}}catch(err){_iterator15.e(err)}finally{_iterator15.f()}}}catch(err){_iterator13.e(err)}finally{_iterator13.f()}var _step14,_iterator14=(0,createForOfIteratorHelper/* default */.Z)(points);try{var _loop=function(){var dataPoint=_step14.value,readingSplit=dataPoint.point.split("_"),readingId=parseInt(readingSplit[0]),resourceId=parseInt(readingSplit[readingSplit.length-1]),reading=existingReadings.filter((function(element){return element.readingId+"_"+element.resourceId===readingId+"_"+resourceId}));if(0===reading.length)return 1;// continue
reading[0].marked=_this5.currentKey,dataPoint.isDone=!0};for(_iterator14.s();!(_step14=_iterator14.n()).done;)_loop()}catch(err){_iterator14.e(err)}finally{_iterator14.f()}}this.removeUnwantedReadings(resultIndex);var notInserted=points.filter((function(point){return!1===point.isDone}));if(0!==notInserted.length){var _step16,_iterator16=(0,createForOfIteratorHelper/* default */.Z)(notInserted);try{var _loop2=function(){var nInsert=_step16.value,readingSplit=nInsert.point.split("_"),category=_this5.getCategoryFromId(nInsert.point),readingObject=null;category&&""!==category&&_this5.allFields[category]&&(readingObject=_this5.allFields[category][parseInt(readingSplit[0])]);var categoryLabel=null,categoryId=null;if("assets"===category){for(var _i=0,_Object$keys=Object.keys(_this5.readings.categoryWithAssets);_i<_Object$keys.length;_i++){var cat=_Object$keys[_i];if(Object.keys(_this5.readings.categoryWithAssets[cat]).includes(readingSplit[readingSplit.length-1])){categoryId=parseInt(cat);break}categoryId=-1}categoryLabel=_this5.config.mainPanel.assetCategories.filter((function(categories){return categories.id===categoryId}))[0].name}else if("weather"===category){var _step17,_iterator17=(0,createForOfIteratorHelper/* default */.Z)(_this5.config.result[resultIndex][panel].summaryList);try{for(_iterator17.s();!(_step17=_iterator17.n()).done;){var _step18,_group=_step17.value,_iterator18=(0,createForOfIteratorHelper/* default */.Z)(_group.readings);try{for(_iterator18.s();!(_step18=_iterator18.n()).done;){var _reading=_step18.value;if(_reading.readingId+"_"+_reading.resourceId===readingSplit[0]+"_"+readingSplit[1]){categoryLabel=_group.label;break}}}catch(err){_iterator18.e(err)}finally{_iterator18.f()}}}catch(err){_iterator17.e(err)}finally{_iterator17.f()}categoryLabel||(readingObject&&(categoryLabel=_this5.weatherModules.filter((function(wModule){return wModule&&wModule.moduleName===readingObject.module}))),categoryLabel=categoryLabel&&0!==categoryLabel.length?categoryLabel[0].displayName:"Degree Days")}else 0!==_this5.allFields.length&&(_this5.allFields["space"]&&"undefined"!==typeof _this5.allFields["space"][parseInt(readingSplit[0])]?(readingObject=_this5.allFields["space"][parseInt(readingSplit[0])],categoryLabel="Space"):(readingObject=_this5.allFields["enpi"][parseInt(readingSplit[0])],categoryLabel="Enpi"));var existingGroup=self.config.result[resultIndex][panel].summaryList.filter((function(inGroup){return inGroup.label===categoryLabel}));if(0===self.config.result[resultIndex][panel].summaryList.length||0===existingGroup.length){var _reading2={};_reading2["readingId"]=parseInt(readingSplit[0]),_reading2["readingLabel"]=readingObject?readingObject.displayName:"",_reading2["resourceId"]=parseInt(readingSplit[readingSplit.length-1]),_reading2["resourceLabel"]="assets"===category?_this5.readings.assets[parseInt(readingSplit[readingSplit.length-1])]:null,_reading2["location"]=_this5.selectedBuildingLabel,_reading2["marked"]=_this5.currentKey;var temp={};temp["label"]=categoryLabel,temp["readings"]=[],"assets"===category&&(temp["categoryId"]=categoryId),temp.readings.push(_reading2),_this5.config.result[resultIndex][panel].summaryList.push(temp)}else{var _reading3={};_reading3["readingId"]=parseInt(readingSplit[0]),_reading3["readingLabel"]=readingObject?readingObject.displayName:"",_reading3["resourceId"]=parseInt(readingSplit[readingSplit.length-1]),_reading3["resourceLabel"]="assets"===category?_this5.readings.assets[parseInt(readingSplit[readingSplit.length-1])]:null,_reading3["location"]=_this5.selectedBuildingLabel,_reading3["marked"]=_this5.currentKey,existingGroup[0].readings.push(_reading3)}nInsert.isDone=!0};for(_iterator16.s();!(_step16=_iterator16.n()).done;)_loop2()}catch(err){_iterator16.e(err)}finally{_iterator16.f()}}}},removeUnwantedReadings:function(resultIndex){var _step19,_iterator19=(0,createForOfIteratorHelper/* default */.Z)(this.config.result[resultIndex][this.config.firstPanel.selectedTab.toLowerCase()].summaryList);try{for(_iterator19.s();!(_step19=_iterator19.n()).done;){var _step20,group=_step19.value,_iterator20=(0,createForOfIteratorHelper/* default */.Z)(group.readings);try{for(_iterator20.s();!(_step20=_iterator20.n()).done;){var reading=_step20.value;if(reading&&reading.marked!==this.currentKey){var readingIndex=group.readings.indexOf(reading);group.readings.splice(readingIndex,1)}0===group.readings.length&&this.config.result[resultIndex][this.config.firstPanel.selectedTab.toLowerCase()].summaryList.splice(this.config.result[resultIndex][this.config.firstPanel.selectedTab.toLowerCase()].summaryList.indexOf(group),1)}}catch(err){_iterator20.e(err)}finally{_iterator20.f()}}}catch(err){_iterator19.e(err)}finally{_iterator19.f()}},weatherPanelToggler:function(){this.weatherPanel.show?this.weatherPanel.show=!1:this.weatherPanel.show=!0},weatherModuleHandler:function(weatherModule,readings){if(weatherModule.moduleName){var _step21,filtered=[],_iterator21=(0,createForOfIteratorHelper/* default */.Z)(readings);try{for(_iterator21.s();!(_step21=_iterator21.n()).done;){var reading=_step21.value;reading.module===weatherModule.moduleName&&filtered.push(reading)}}catch(err){_iterator21.e(err)}finally{_iterator21.f()}return filtered}var _step22,_filtered=[],_iterator22=(0,createForOfIteratorHelper/* default */.Z)(readings);try{for(_iterator22.s();!(_step22=_iterator22.n()).done;){var _reading4=_step22.value;"cdd"!==_reading4.module&&"hdd"!==_reading4.module&&"wdd"!==_reading4.module||_filtered.push(_reading4)}}catch(err){_iterator22.e(err)}finally{_iterator22.f()}return _filtered},setDefaultSelection:function(){this.selectedBuildings=[],this.default_building_id&&(this.selectedBuildings=[this.default_building_id])},setSelectedBuildings:function(selectedBuildings){this.selectedBuildings=selectedBuildings},toggleQuickSearch:function(){var _this6=this;this.showQuickSearch=!this.showQuickSearch,this.showQuickSearch&&this.$nextTick((function(){_this6.$refs.quickSearchQuery.focus()}))},closeSearch:function(){this.toggleQuickSearch(),this.quickSearchQuery=null,this.quickSearch()},loadAssetCategories:function(){var self=this;self.weatherPanel.show=!1,self.weatherPanel.weatherCategory=null;var _step23,_iterator23=(0,createForOfIteratorHelper/* default */.Z)(self.weatherModules);try{for(_iterator23.s();!(_step23=_iterator23.n()).done;){var module=_step23.value;module.selected=!1}}catch(err){_iterator23.e(err)}finally{_iterator23.f()}if("assets"!==self.config.mainPanel.currentModule){self.config.mainPanel.currentModule="assets",self.config.mainPanel.selectedAssetCategory=null,self.config.mainPanel.assetCategories=null,self.config.mainPanel.assetCategoriesLoading=!0;var panels=[];self.config["assetPointsPanel"].show&&panels.push("assetPointsPanel"),self.config["selectReadingsPanel"].show&&panels.push("selectReadingsPanel"),self.config["selectAssetsPanel"].show&&panels.push("selectAssetsPanel"),self.togglePanel(panels),self.$http.post("/asset/getAssetCategoryWithReadings",{buildingIds:self.buildingIds}).then((function(response){var categoryIds=Object.keys(response.data);self.config.mainPanel.assetCategories=self.assetCategory.filter((function(ele){for(var index=0;index<categoryIds.length;index++){var element=categoryIds[index];if(parseInt(element)===ele.id)return ele.toggle=!1,ele}})),self.config.mainPanel.assetCategoriesLoading=!1,self.loading=!1,self.savedPoints&&"undefined"!==typeof self.savedPoints&&0!==self.savedPoints.length&&self.prepareSavedDataPoints()}))}else self.config.mainPanel.currentModule=""},resetResetReadings:function(){this.readings={categories:[],assets:{},categoryWithAssets:{},fields:{},categoryWithFields:{}}},togglePanel:function(){for(var self=this,configKeys=Object.keys(self.config),_len=arguments.length,panels=new Array(_len),_key=0;_key<_len;_key++)panels[_key]=arguments[_key];for(var _i2=0,_configKeys=configKeys;_i2<_configKeys.length;_i2++){var configKey=_configKeys[_i2];panels.indexOf(configKey)>=0?self.config[configKey].show=!0:(self.config[configKey].show=!1,self.config[configKey].selectedItem=null)}},openAssetCategory:function(categoryId){var _this7=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){var self,assetIds,readingIds;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:if(self=_this7,self.togglePanel("assetPointsPanel"),self.config.mainPanel.selectedAssetCategory=categoryId,self.config.assetPointsPanel.loading=!0,self.config.assetPointsPanel.selectedAssetOrPoint=null,!self.readings.categories.includes(categoryId)){_context4.next=9;break}"assets"===self.config.assetPointsPanel.activeSubTab?(assetIds=Object.keys(self.readings.categoryWithAssets[categoryId]),self.config.assetPointsPanel.data=assetIds.map((function(el){return{id:el,name:self.readings.assets[el]}})),self.config.assetPointsPanel.loading=!1):(readingIds=Object.keys(self.readings.categoryWithFields[categoryId]),self.config.assetPointsPanel.data=readingIds.map((function(el){return self.readings.fields[el]})),self.config.assetPointsPanel.loading=!1),_context4.next=12;break;case 9:if(!self.buildingIds){_context4.next=12;break}return _context4.next=12,self.$http.post("/asset/getReadingsForSpecificAssetCategory",{buildingIds:self.buildingIds,categoryIds:[categoryId]}).then((function(response){if(self.readings.categories.includes(categoryId)||self.readings.categories.push(categoryId),self.readings.categoryWithAssets[categoryId]=response.data.categoryWithAssets[categoryId],self.readings.categoryWithFields[categoryId]=response.data.categoryWithFields[categoryId],response.data.fields)for(var _i3=0,_Object$keys2=Object.keys(response.data.fields);_i3<_Object$keys2.length;_i3++){var fieldId=_Object$keys2[_i3];self.readings.fields[fieldId]||(self.readings.fields[fieldId]=response.data.fields[fieldId]),self.allFields["assets"]&&!self.allFields["assets"][fieldId]&&(self.allFields["assets"][fieldId]=response.data.fields[fieldId])}if(response.data.assets)for(var _i4=0,_Object$keys3=Object.keys(response.data.assets);_i4<_Object$keys3.length;_i4++){var assetId=_Object$keys3[_i4];self.readings.assets[assetId]||(self.readings.assets[assetId]=response.data.assets[assetId])}if("assets"===self.config.assetPointsPanel.activeSubTab){var _assetIds=Object.keys(self.readings.categoryWithAssets[categoryId]);self.config.assetPointsPanel.data=_assetIds.map((function(el){return{id:el,name:self.readings.assets[el]}})),self.config.assetPointsPanel.loading=!1}else{var _readingIds=Object.keys(self.readings.categoryWithFields[categoryId]);self.config.assetPointsPanel.data=_readingIds.map((function(el){return self.readings.fields[el]})),self.config.assetPointsPanel.loading=!1}}));case 12:case"end":return _context4.stop()}}),_callee4)})))()},openAsset:function(assetId){var self=this;self.config.assetPointsPanel.selectedAssetOrPoint=assetId,self.togglePanel("assetPointsPanel","selectReadingsPanel"),self.config.selectReadingsPanel.loading=!0,self.config.selectReadingsPanel.parentId=assetId;var fieldIds=self.readings.categoryWithAssets[self.config.mainPanel.selectedAssetCategory][assetId];self.config.selectReadingsPanel.data=fieldIds.map((function(el){return self.readings.fields[el]})),self.config.selectReadingsPanel.loading=!1},openPoint:function(pointId){var self=this;self.config.assetPointsPanel.selectedAssetOrPoint=pointId,self.togglePanel("assetPointsPanel","selectAssetsPanel"),self.config.selectAssetsPanel.loading=!0,self.config.selectAssetsPanel.readingId=pointId;var assetIds=self.readings.categoryWithFields[self.config.mainPanel.selectedAssetCategory][pointId];self.config.selectAssetsPanel.data=assetIds.map((function(el){return{id:el,name:self.readings.assets[el]}})),self.config.selectAssetsPanel.loading=!1},getReadingFields:function(readings){var _step24,data=[],_iterator24=(0,createForOfIteratorHelper/* default */.Z)(readings);try{for(_iterator24.s();!(_step24=_iterator24.n()).done;){var _step25,reading=_step24.value,_iterator25=(0,createForOfIteratorHelper/* default */.Z)(reading.fields);try{for(_iterator25.s();!(_step25=_iterator25.n()).done;){var field=_step25.value;field.module=reading.name,data.push(field)}}catch(err){_iterator25.e(err)}finally{_iterator25.f()}}}catch(err){_iterator24.e(err)}finally{_iterator24.f()}return data},loadSpaceReadings:function(){var self=this;self.config.mainPanel.currentModule="spaces",self.togglePanel("selectReadingsPanel"),self.config.selectReadingsPanel.loading=!0,self.config.selectReadingsPanel.parentId=self.buildingIds[0],self.$http.get("/reading/getspacespecificreadings?parentId="+self.buildingIds[0]).then((function(response){self.config.selectReadingsPanel.data=self.getReadingFields(response.data.filter((function(el){
// TODO check whether to show for building analysis also, all readings except enpi
if(3===el.type)return el}))),self.allFields["space"]=self.convertToList(self.config.selectReadingsPanel.data),self.config.selectReadingsPanel.loading=!1}))},loadWeatherReadings:function(weatherModule){var _this8=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee6(){var self,_iterator26,_step26,module,fetchWeatherReadings,response,siteId;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context6){while(1)switch(_context6.prev=_context6.next){case 0:self=_this8,self.weatherPanel.weatherCategory=weatherModule||self.weatherModules[0],_iterator26=(0,createForOfIteratorHelper/* default */.Z)(self.weatherModules);try{for(_iterator26.s();!(_step26=_iterator26.n()).done;)module=_step26.value,module.selected=!1}catch(err){_iterator26.e(err)}finally{_iterator26.f()}if(_this8.weatherReadings.length?self.config.selectReadingsPanel.loading=!1:self.config.selectReadingsPanel.loading=!0,self.config.mainPanel.currentModule=weatherModule?weatherModule.moduleName:self.weatherModules[0].moduleName,self.togglePanel("selectReadingsPanel"),weatherModule&&(weatherModule.selected=!0),fetchWeatherReadings=function(){var _ref=(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee5(siteId){var response;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context5){while(1)switch(_context5.prev=_context5.next){case 0:return _context5.next=2,self.$http.get("/reading/getspacespecificreadings?excludeForecastReadings=false&parentId="+siteId);case 2:response=_context5.sent,self.weatherReadings=response.data,self.config.selectReadingsPanel.data=weatherModule?self.weatherModuleHandler(weatherModule,self.getReadingFields(response.data)):self.weatherModuleHandler(self.weatherModules[0],self.getReadingFields(response.data)),self.allFields["weather"]=self.convertToList(self.config.selectReadingsPanel.data),self.config.selectReadingsPanel.loading=!1;case 7:case"end":return _context5.stop()}}),_callee5)})));return function(_x2){return _ref.apply(this,arguments)}}(),!self.config.selectReadingsPanel.spaceObj||!self.config.selectReadingsPanel.spaceObj.siteId){_context6.next=14;break}self.config.selectReadingsPanel.parentId=self.config.selectReadingsPanel.spaceObj.siteId,self.weatherReadings.length?(self.config.selectReadingsPanel.data=weatherModule?self.weatherModuleHandler(weatherModule,self.getReadingFields(self.weatherReadings)):self.weatherModuleHandler(self.weatherModules[0],self.getReadingFields(self.weatherReadings)),self.allFields["weather"]=self.convertToList(self.config.selectReadingsPanel.data),self.config.selectReadingsPanel.loading=!1):fetchWeatherReadings(self.config.selectReadingsPanel.spaceObj.siteId),_context6.next=18;break;case 14:return _context6.next=16,self.$http.get("/building/"+self.buildingIds[0]);case 16:response=_context6.sent,response.data.building?(siteId=response.data.building.siteId,self.config.selectReadingsPanel.parentId=siteId,self.config.selectReadingsPanel.spaceObj=response.data.building,fetchWeatherReadings(siteId)):self.$http.get("/zone/"+self.buildingIds[0]).then((function(response){if(response.data.zone){var _siteId=response.data.zone.siteId;self.config.selectReadingsPanel.parentId=_siteId,self.config.selectReadingsPanel.spaceObj=response.data.building,fetchWeatherReadings(_siteId)}}));case 18:case"end":return _context6.stop()}}),_callee6)})))()},loadEnPIReadings:function(){var self=this;self.config.mainPanel.currentModule="enpi",self.togglePanel("selectReadingsPanel"),self.config.selectReadingsPanel.loading=!0,self.config.selectReadingsPanel.parentId=self.buildingIds[0],self.$http.get("/reading/getspacespecificreadings?parentId="+self.buildingIds[0]).then((function(response){self.config.selectReadingsPanel.data=self.getReadingFields(response.data.filter((function(el){if(7===el.type)return el}))),self.allFields["enpi"]=self.convertToList(self.config.selectReadingsPanel.data),self.config.selectReadingsPanel.loading=!1}))},cancel:function(){
// remove not added data points
var _step27,_iterator27=(0,createForOfIteratorHelper/* default */.Z)(this.config.result);try{for(_iterator27.s();!(_step27=_iterator27.n()).done;){var group=_step27.value;if(group.metrics.selectedDataPoints.length>group.metrics.dataPoints.length){var length=group.metrics.selectedDataPoints.length-group.metrics.dataPoints.length;group.metrics.selectedDataPoints.splice(group.metrics.dataPoints.length-1,length)}}}catch(err){_iterator27.e(err)}finally{_iterator27.f()}this.selectorPanelShow=!1},apply:function(resultIndex){var config=this.$helpers.cloneObject(this.config);this.config.result[resultIndex].dimension.dataPoints=[],this.config.result[resultIndex].metrics.dataPoints=[],this.config.result[resultIndex].dimension.scatterPoints=[],this.config.result[resultIndex].metrics.scatterPoints=[],this.populateAddedDataPoints(config,resultIndex),0!==this.selectedBuildings.length&&""!==this.selectedBuildingLabel&&(this.config.result[resultIndex].meta={},this.config.result[resultIndex].meta["selectedBuildingIds"]=this.selectedBuildings,this.config.result[resultIndex].meta["selectedBuildingTitle"]=this.selectedBuildingLabel),this.$emit("update:enableFloatimngIcon",!0),this.getSelectedPointsMeta(resultIndex),this.updateAndEmitData(),this.selectorPanelShow=!1},populateAddedDataPoints:function(config,resultIndex){if(this.config.result[resultIndex].dimension.selectedDataPoints&&this.config.result[resultIndex].dimension.selectedDataPoints.length){var _step28,_iterator28=(0,createForOfIteratorHelper/* default */.Z)(this.config.result[resultIndex].dimension.selectedDataPoints);try{for(_iterator28.s();!(_step28=_iterator28.n()).done;){var dp=_step28.value,readingFieldId=parseInt(dp.split("_")[0]),parentId=parseInt(dp.split("_")[1]);this.config.result[resultIndex].dimension.dataPoints.push({parentId:parentId,yAxis:{fieldId:readingFieldId,aggr:this.setAggrPoint(dp,"dimension",config,this.readings.fields[readingFieldId],resultIndex)},prediction:!!(this.readings&&this.readings.fields&&this.readings.fields[readingFieldId]&&this.readings.fields[readingFieldId].module)&&11===this.readings.fields[readingFieldId].module.type,duplicateDataPoint:!1}),this.config.result[resultIndex].dimension.scatterPoints.push({parentId:parentId,aggr:this.setAggrPoint(dp,"dimension",config,this.readings.fields[readingFieldId],resultIndex),name:this.getFormatedData(dp,"dimension",resultIndex),readingId:readingFieldId,axis:"x",aliases:{}})}}catch(err){_iterator28.e(err)}finally{_iterator28.f()}}if(this.config.result[resultIndex].metrics.selectedDataPoints&&this.config.result[resultIndex].metrics.selectedDataPoints.length){var _step29,_iterator29=(0,createForOfIteratorHelper/* default */.Z)(this.config.result[resultIndex].metrics.selectedDataPoints);try{for(_iterator29.s();!(_step29=_iterator29.n()).done;){var _dp=_step29.value,_readingFieldId=parseInt(_dp.split("_")[0]),_parentId=parseInt(_dp.split("_")[1]);this.config.result[resultIndex].metrics.dataPoints.push({parentId:_parentId,displayName:this.readings.fields[_readingFieldId]?this.readings.fields[_readingFieldId].displayName:"",yAxis:{fieldId:_readingFieldId,aggr:this.setAggrPoint(_dp,"metrics",config,this.readings.fields[_readingFieldId],resultIndex)},prediction:!!(this.readings&&this.readings.fields&&this.readings.fields[_readingFieldId]&&this.readings.fields[_readingFieldId].module)&&11===this.readings.fields[_readingFieldId].module.type}),this.config.result[resultIndex].metrics.scatterPoints.push({parentId:_parentId,aggr:this.setAggrPoint(_dp,"metrics",config,this.readings.fields[_readingFieldId],resultIndex),name:this.getFormatedData(_dp,"metrics",resultIndex),readingId:_readingFieldId,axis:"y",aliases:{}})}}catch(err){_iterator29.e(err)}finally{_iterator29.f()}}},getSelectedPointsMeta:function(resultIndex){var points=[],metricPoints=[],self=this;this.config.result[resultIndex].dimension.dataPoints.length&&this.config.result[resultIndex].dimension.dataPoints.forEach((function(point){self.config.result[resultIndex].dimension.summaryList.length&&self.config.result[resultIndex].dimension.summaryList.forEach((function(summary){summary.readings.length&&summary.readings.forEach((function(data){data.resourceId===point.parentId&&data.readingId===point.yAxis.fieldId&&(data.label=summary.label,points.push(data))}))}))})),this.config.result[resultIndex].dimension.addedDataPoints=points,this.config.result[resultIndex].metrics.dataPoints.length&&this.config.result[resultIndex].metrics.dataPoints.forEach((function(point){self.config.result[resultIndex].metrics.summaryList.length&&self.config.result[resultIndex].metrics.summaryList.forEach((function(summary){summary.readings.length&&summary.readings.forEach((function(data){data.resourceId===point.parentId&&data.readingId===point.yAxis.fieldId&&(data.label=summary.label,metricPoints.push(data))}))}))})),this.config.result[resultIndex].metrics.addedDataPoints=metricPoints},setAggrPoint:function(dp,mode,config,readingFields,resultIndex){var aggr=readingFields&&readingFields.unit&&["currency","kwh","co2","kg","mwh"].includes(readingFields.unit.trim().toLowerCase())?3:2;if(dp&&config.result[resultIndex][mode].dataPoints.length){var resourceId=parseInt(dp.split("_")[1]),readingId=parseInt(dp.split("_")[0]);config.result[resultIndex][mode].dataPoints.forEach((function(point){point.parentId===resourceId&&point.yAxis&&point.yAxis.fieldId===readingId&&(aggr=point.yAxis.aggr)}))}return aggr}}},components_FScatterPointSelectorvue_type_script_lang_js=FScatterPointSelectorvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FScatterPointSelectorvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FScatterPointSelector=component.exports},
/***/839662:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return TrendLine}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/report/components/TrendLine.vue?vue&type=template&id=1413e50e
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"fc-dialog-center-container",attrs:{title:_vm.algorithmType?_vm.getTitle():"TrendLine",visible:_vm.visibility,width:"40%","append-to-body":!0,"show-close":!1,"before-close":_vm.closeTrendLine,"close-on-click-modal":!1},on:{"update:visible":function($event){_vm.visibility=$event}}},[_c("div",{staticClass:"height350 overflow-y-scroll pB80"},[_c("div",{staticClass:"customize-input-block"},[_c("el-row",[_vm.algorithmType?_vm._e():_c("el-col",{staticClass:"mR20",attrs:{span:12}},[_c("div",{staticClass:"label-txt-black"},[_vm._v("Type")]),_c("el-select",{staticClass:"fc-input-full-border2 width100 mT10",attrs:{placeholder:"Select"},model:{value:_vm.trendLineObj.type,callback:function($$v){_vm.$set(_vm.trendLineObj,"type",$$v)},expression:"trendLineObj.type"}},[_c("el-option",{attrs:{label:"Linear",value:"1"}}),_c("el-option",{attrs:{label:"Polynomial",value:"2"}})],1)],1),2==_vm.trendLineObj.type?_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"label-txt-black"},[_vm._v("Degree")]),_c("el-select",{staticClass:"fc-input-full-border2 width100 mT10",attrs:{placeholder:"Select"},model:{value:_vm.trendLineObj.degree,callback:function($$v){_vm.$set(_vm.trendLineObj,"degree",$$v)},expression:"trendLineObj.degree"}},_vm._l(9,(function(n){return _c("el-option",{key:n,attrs:{label:n+1,value:n+1}})})),1)],1):_vm._e()],1)],1),_c("div",{staticClass:"customize-input-block pT20"},[_c("el-row",[_c("el-col",{staticClass:"mR20",attrs:{span:12}},[_c("div",{staticClass:"label-txt-black"},[_vm._v("Decimals")]),_c("el-input",{staticClass:"fc-input-full-border2 width100 mT10",model:{value:_vm.trendLineObj.decimal,callback:function($$v){_vm.$set(_vm.trendLineObj,"decimal",_vm._n($$v))},expression:"trendLineObj.decimal"}})],1),_c("el-col",{staticClass:"pT40 pL20",attrs:{span:10}},[_c("el-checkbox",{directives:[{name:"tippy",rawName:"v-tippy"}],attrs:{label:"Show R²",title:"Show R²"},model:{value:_vm.trendLineObj.showr2,callback:function($$v){_vm.$set(_vm.trendLineObj,"showr2",$$v)},expression:"trendLineObj.showr2"}})],1)],1)],1),_c("div",{staticClass:"customize-input-block pT20"},[_c("el-row",[_c("el-col",{staticClass:"mR20",attrs:{span:24}},[_c("div",{staticClass:"label-txt-black"},[_vm._v("Data Points")]),_c("el-select",{staticClass:"fc-input-full-border2 width100 mT10 fc-tag",attrs:{placeholder:"All",multiple:"",filterable:"","collapse-tags":""},model:{value:_vm.trendLineObj.selectedPoints,callback:function($$v){_vm.$set(_vm.trendLineObj,"selectedPoints",$$v)},expression:"trendLineObj.selectedPoints"}},_vm._l(_vm.dataPoints.filter((function(dp){return"x"!==dp.axes})),(function(datapoint,index){return _c("el-option",{directives:[{name:"tippy",rawName:"v-tippy"}],key:index,attrs:{label:datapoint.label,title:datapoint.label,value:datapoint.alias}})})),1)],1)],1)],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.closeTrendLine}},[_vm._v("CANCEL")]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:_vm.saveTrendLine}},[_vm._v("SAVE")])],1)])])},staticRenderFns=[],TrendLinevue_type_script_lang_js=(__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(670560),{props:["visibility","report","algorithmType"],created:function(){"undefined"!==typeof this.report&&null!==this.report&&this.load()},data:function(){return{trendLineObj:null,dataPoints:[]}},methods:{load:function(){var _this=this;this.trendLineObj=this.$helpers.cloneObject(this.report.options.trendLine),this.dataPoints=this.$helpers.getDataPoints(this.report.options.dataPoints,[1,2],!1);var selectedPoints=[];this.dataPoints.forEach((function(dp){_this.trendLineObj.selectedPoints.includes(dp.alias)&&selectedPoints.push(dp.alias)})),this.trendLineObj.selectedPoints=selectedPoints,this.algorithmType&&(this.trendLineObj.type=this.algorithmType)},saveTrendLine:function(){this.$emit("onTrendLineChange",this.trendLineObj),this.closeTrendLine()},closeTrendLine:function(){this.$emit("update:visibility",!1)},getTitle:function(){switch(this.algorithmType){case"1":return"LINEAR ALGORITHM";case"2":return"POLYNOMIAL ALGORITHM";default:return"TRENDLINE"}}}}),components_TrendLinevue_type_script_lang_js=TrendLinevue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_TrendLinevue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,TrendLine=component.exports},
/***/134105:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"32593a37e7348ae1623e9e42913d7e55.svg";
/***/}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/11476.js.map