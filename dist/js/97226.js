"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[97226],{
/***/676474:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return V3LookupFieldWizard}});
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js
var render,staticRenderFns,regeneratorRuntime=__webpack_require__(150124),objectSpread2=__webpack_require__(595082),asyncToGenerator=__webpack_require__(548534),FLookupFieldWizard=(__webpack_require__(648324),__webpack_require__(499751)),api=__webpack_require__(32284),validation=__webpack_require__(990260),V3LookupFieldWizardvue_type_script_lang_js={name:"V3LookupFieldWizard",extends:FLookupFieldWizard["default"],methods:{fetchModulesData:function(){var _arguments=arguments,_this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var skipResetPage,moduleName,_this$filters,filters,perPage,page,_this$withReadings,withReadings,selectedLookupField,_ref,clientCriteria,additionalParams,_yield$API$fetchAll,list,meta,error,totalCount;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return skipResetPage=_arguments.length>0&&void 0!==_arguments[0]&&_arguments[0],moduleName=_this.moduleName,_this$filters=_this.filters,filters=void 0===_this$filters?{}:_this$filters,perPage=_this.perPage,page=_this.page,_this$withReadings=_this.withReadings,withReadings=void 0===_this$withReadings?null:_this$withReadings,selectedLookupField=_this.selectedLookupField,_ref=selectedLookupField||{},clientCriteria=_ref.clientCriteria,additionalParams=_ref.additionalParams,_context.next=5,api/* API */.bl.fetchAll(moduleName,(0,objectSpread2/* default */.Z)({withCount:!0,page:(0,validation/* isEmpty */.xb)(filters)||skipResetPage?page:1,filters:(0,validation/* isEmpty */.xb)(filters)?null:JSON.stringify(filters),perPage:perPage,viewName:"hidden-all",withReadings:withReadings,clientCriteria:(0,validation/* isEmpty */.xb)(clientCriteria)?null:JSON.stringify(clientCriteria)},additionalParams));case 5:_yield$API$fetchAll=_context.sent,list=_yield$API$fetchAll.list,meta=_yield$API$fetchAll.meta,error=_yield$API$fetchAll.error,totalCount=_this.$getProperty(meta,"pagination.totalCount",null),error?_this.$message.error(error.message):((0,validation/* isNullOrUndefined */.le)(list)||_this.$set(_this,"modulesList",list),(0,validation/* isNullOrUndefined */.le)(totalCount)||_this.$set(_this,"totalCount",totalCount)),_this.isSearchDataLoading=!1;case 12:case"end":return _context.stop()}}),_callee)})))()},loadDataCount:function(){}}},components_V3LookupFieldWizardvue_type_script_lang_js=V3LookupFieldWizardvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_V3LookupFieldWizardvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,V3LookupFieldWizard=component.exports;
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/objectSpread2.js
},
/***/997226:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return SafetyPlanHazardList}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/safetyplan/component/SafetyPlanHazardList.vue?vue&type=template&id=28974234&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticStyle:{height:"100%"}},[_vm.isLoading?_c("div",{staticClass:"flex-middle fc-empty-white"},[_c("spinner",{attrs:{show:_vm.isLoading,size:"80"}})],1):[_c("LineItemList",_vm._b({ref:"lineItemComponent",staticStyle:{height:"100%"},attrs:{config:_vm.listConfiguration,moduleDisplayName:_vm.moduleDisplayName,moduleName:_vm.moduleName,widgetDetails:_vm.widgetDetails,resizeWidget:_vm.resizeWidget,viewname:"hidden-all"},on:{onDelete:_vm.refreshPrecautions,emptyStateBtn:_vm.showWizard},scopedSlots:_vm._u([{key:"footer",fn:function(){return[_c("el-button",{staticClass:"line-item-list-footer-add-btn",attrs:{type:"primary"},on:{click:_vm.showWizard}},[_vm._v(" "+_vm._s(_vm.$t("common.safetyPlan.select_hazards"))+" ")])]},proxy:!0}])},"LineItemList",_vm.$attrs,!1)),_vm.canShowWizard?_c("V3LookupFieldWizard",{attrs:{canShowLookupWizard:_vm.canShowWizard,selectedLookupField:_vm.wizardField},on:{"update:canShowLookupWizard":function($event){_vm.canShowWizard=$event},"update:can-show-lookup-wizard":function($event){_vm.canShowWizard=$event},setLookupFieldValue:_vm.saveRecord}}):_vm._e()]],2)},staticRenderFns=[],defineProperty=__webpack_require__(482482),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),objectSpread2=__webpack_require__(595082),LineItemListOld=(__webpack_require__(634338),__webpack_require__(976801),__webpack_require__(450886),__webpack_require__(666237)),V3LookupFieldWizard=__webpack_require__(676474),api=__webpack_require__(32284),eventBus=__webpack_require__(398011),validation=__webpack_require__(990260),SafetyPlanHazardListvue_type_script_lang_js={props:["widget","details","resizeWidget"],components:{LineItemList:LineItemListOld/* default */.Z,V3LookupFieldWizard:V3LookupFieldWizard/* default */.Z},data:function(){return{canShowWizard:!1,isLoading:!1,parentModuleName:null}},computed:{moduleName:function(){var parentModuleName=this.parentModuleName;return parentModuleName+"Hazard"},moduleDisplayName:function(){return"Associated Hazards"},filters:function(){var details=this.details,parentModuleName=this.parentModuleName,id=details.id,filterObj={};return(0,validation/* isEmpty */.xb)(parentModuleName)||(filterObj[parentModuleName]={operatorId:36,value:["".concat(id)]}),filterObj},editConfig:function(){return{canHideEdit:!0}},deleteConfig:function(){return{canHideDelete:!1}},deletePopupDetails:function(){var moduleDisplayName="Hazard";return{title:"".concat(this.$t("custommodules.list.delete")," ").concat(moduleDisplayName),message:"".concat(this.$t("custommodules.list.delete_confirmation")," ").concat(moduleDisplayName,"?"),rbDanger:!0,rbLabel:this.$t("custommodules.list.delete")}},quickCreateConfig:function(){return{canHideAddBtn:!0}},columnCustomConfig:function(){return{canShowColumnConfig:!1}},listConfiguration:function(){var filters=this.filters,editConfig=this.editConfig,deleteConfig=this.deleteConfig,columnCustomConfig=this.columnCustomConfig,searchAndFilterConfig=this.searchAndFilterConfig,quickCreateConfig=this.quickCreateConfig,deletePopupDetails=this.deletePopupDetails;return(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({expand:!1,isSelectionEnabled:!1,isIndexEnabled:!1,filters:filters,canHideFooter:!0,deletePopupDetails:deletePopupDetails,mainfieldAction:function(){}},editConfig||{}),deleteConfig||{}),columnCustomConfig||{}),quickCreateConfig||{}),searchAndFilterConfig||{}),{},{canEnableMainFieldAction:!1})},widgetDetails:function(){var widget=this.widget,moduleDisplayName=this.moduleDisplayName,_ref=widget||{},relatedList=_ref.relatedList,_ref2=relatedList||{},summaryWidgetName=_ref2.summaryWidgetName,emptyStateText=this.$t("common.safetyPlan.no_hazard_added",{moduleName:moduleDisplayName});return{perPage:7,summaryWidgetName:summaryWidgetName,emptyStateText:emptyStateText,emptyStateBtnList:[{label:"Add Hazards",value:"add_hazard"}]}},searchAndFilterConfig:function(){return{canHideSearch:!1,canHideFilter:!1}},wizardField:function(){var _this$details;return{isDataLoading:!1,options:[],lookupModuleName:"hazard",field:{lookupModule:{name:"hazard",displayName:"Hazards"}},multiple:!0,forceFetchAlways:!0,selectedItems:[],additionalParams:{excludeAvailableHazards:null===(_this$details=this.details)||void 0===_this$details?void 0:_this$details.id,parentModuleName:this.parentModuleName}}}},created:function(){this.getParentModuleName()},mounted:function(){eventBus/* eventBus */.Y.$on("refresh-hazards",this.refreshList)},methods:{showWizard:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:_this.canShowWizard=!0;case 1:case"end":return _context.stop()}}),_callee)})))()},refreshList:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var component;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:component=_this2.$refs["lineItemComponent"],component&&component.refreshRecordList(!0),_this2.refreshPrecautions();case 3:case"end":return _context2.stop()}}),_callee2)})))()},refreshPrecautions:function(){eventBus/* eventBus */.Y.$emit("refresh-sf-precautions")},getParentModuleName:function(){var pageModuleName=this.$attrs.moduleName,baseSpaces=["site","building","floor","space"];baseSpaces.includes(pageModuleName)?this.parentModuleName="space":this.parentModuleName=pageModuleName},saveRecord:function(value){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var details,parentModuleName,_ref3,id,url,field,selectedData,successMsg,records,moduleName,params,_yield$API$post,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:if(_this3.isLoading=!0,details=_this3.details,parentModuleName=_this3.parentModuleName,_ref3=details||{},id=_ref3.id,url="v3/modules/data/bulkCreate",field=_this3.$getProperty(value,"field"),selectedData=_this3.$getProperty(field,"selectedItems"),successMsg="Hazards added successfully!",(0,validation/* isEmpty */.xb)(selectedData)){_context3.next=18;break}return records=selectedData.map((function(record){var value=record.value,data=(0,defineProperty/* default */.Z)({},parentModuleName,{id:id});return{data:data,hazard:{id:value}}})),moduleName="".concat(parentModuleName,"Hazard"),params={moduleName:moduleName,params:(0,defineProperty/* default */.Z)({},parentModuleName,id),data:(0,defineProperty/* default */.Z)({},moduleName,records)},_context3.next=13,api/* API */.bl.post(url,params);case 13:_yield$API$post=_context3.sent,error=_yield$API$post.error,error?_this3.$message.error((null===error||void 0===error?void 0:error.message)||_this3.$t("common.safetyPlan.error_occured")):(successMsg&&_this3.$message.success(successMsg),_this3.refreshPrecautions()),_context3.next=19;break;case 18:_this3.$message.error(_this3.$t("common.safetyPlan.error_occured"));case 19:_this3.closeWizard(),_this3.isLoading=!1;case 21:case"end":return _context3.stop()}}),_callee3)})))()},closeWizard:function(){this.$set(this.wizardField,"selectedItems",[]),this.canShowWizard=!1}}},component_SafetyPlanHazardListvue_type_script_lang_js=SafetyPlanHazardListvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(component_SafetyPlanHazardListvue_type_script_lang_js,render,staticRenderFns,!1,null,"28974234",null)
/* harmony default export */,SafetyPlanHazardList=component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/97226.js.map