(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[11228],{
/***/426803:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return User}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/avatar/User.vue?vue&type=template&id=c662fbbc
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.userObj?_c("div",{staticClass:"inline"},[_c("div",{staticClass:"fc-avatar-element q-item-division relative-position"},[_c("div",{staticClass:"q-item-side-left q-item-section"},[_vm.showPopover&&-1!==_vm.userObj.id?_c("avatarPopover",{attrs:{user:_vm.userObj,moduleName:_vm.moduleName}},[_c("span",{attrs:{slot:"reference"},slot:"reference"},[_c("avatar",{attrs:{size:_vm.size,user:_vm.userObj,color:_vm.color}})],1)]):_c("span",[_c("avatar",{attrs:{size:_vm.size,user:_vm.userObj,color:_vm.color}})],1)],1),_vm.showLabel?[_vm.user&&_vm.user.id>0||_vm.group&&_vm.group.id>0?_c("div",{staticClass:"wo-team-txt"},[_c("div",{staticClass:"assignment-avatar-name",class:{"color-d":!_vm.user}},[_vm._v(" "+_vm._s(_vm.user&&_vm.user.id>0?_vm.user.name||(_vm.users.find((function(usr){return usr.id===_vm.user.id}))||{}).name:"---")+" ")]),_c("div",{staticClass:"assignment-group-name",class:{"color-d":!_vm.group}},[_vm._v(" "+_vm._s(_vm.group?_vm.group.name||(_vm.$store.getters.getGroup(_vm.group.id)||{}).name:"---")+" ")])]):_c("div",{staticClass:"wo-team-txt",staticStyle:{"padding-top":"7px","font-size":"14px",color:"#aaa","letter-spacing":"0.2px"}},[_vm._v(" ---/--- ")])]:0!=_vm.name?_c("div",[_c("div",[_c("span",{staticClass:"q-item-label d-flex flex-wrap"},[_vm._v(_vm._s(_vm.userObj.name))])])]):_vm._e()],2)]):_vm._e()},staticRenderFns=[],objectSpread2=__webpack_require__(595082),Avatar=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(574752)),AvatarPopovervue_type_template_id_8ef9b9ec_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"avatar-popover-container"},[_c("el-popover",{ref:"popover1",staticStyle:{display:"block",padding:"0"},attrs:{placement:"top-start",trigger:"hover",width:"383",clas:"avatar-popover","popper-class":"avatar-popover",height:_vm.defaultheight,"open-delay":600},model:{value:_vm.popoverShown,callback:function($$v){_vm.popoverShown=$$v},expression:"popoverShown"}},[_c("div",{staticClass:"popover-content-block"},[_c("div",{staticClass:"popover-avatar"},[_c("avatar",{attrs:{size:_vm.size,user:_vm.user,color:_vm.color,showPopover:!1}})],1),_c("div",{staticClass:"popover-avatar-det"},[_c("div",{staticClass:"avatar-name-txt"},[_vm._v(" "+_vm._s(_vm.user.name?_vm.user.name:"----")+" ")]),_c("div",{staticClass:"mail-block"},[_c("img",{staticClass:"envelope-icon",staticStyle:{height:"13px","vertical-align":"middle"},attrs:{src:__webpack_require__(702638)}}),_c("span",{staticClass:"mail-txt"},[_vm._v(_vm._s(_vm.user.email?_vm.user.email:"----")+" ")])]),_c("div",[_c("img",{staticClass:"envelope-icon",staticStyle:{height:"15px"},attrs:{src:__webpack_require__(47424)}}),_c("span",{staticClass:"popover-phone-number"},[_vm._v(" "+_vm._s(_vm.user.mobile?_vm.user.mobile:"----")+" ")])])]),"workorder"===_vm.moduleName?_c("div",{staticClass:"popover-footer"},[_c("ul",[_c("li",{staticClass:"popover-footer-list",on:{click:function($event){return _vm.getOpen("open")}}},[_c("div",{staticClass:"open-result-txt"},[_vm._v(" "+_vm._s(_vm.result.openWorkOrdersCount)+" ")]),_c("div",{staticClass:"result-txt-black"},[_vm._v("OPEN")])]),_c("li",{staticClass:"popover-footer-list border-RL",on:{click:function($event){return _vm.getOpen("overdue")}}},[_c("div",{staticClass:"overdue-result-txt"},[_vm._v(" "+_vm._s(_vm.result.overDueWorkOrdersCount)+" ")]),_c("div",{staticClass:"result-txt-black"},[_vm._v("OVERDUE")])]),_c("li",{staticClass:"popover-footer-list",on:{click:function($event){return _vm.getOpen("duetoday")}}},[_c("div",{staticClass:"dueday-result-txt"},[_vm._v(" "+_vm._s(_vm.result.dueTodayWorkOrdersCount)+" ")]),_c("div",{staticClass:"result-txt-black"},[_vm._v("DUE TODAY")])])])]):_vm._e()]),_c("template",{slot:"reference"},[_vm._t("reference")],2)],2)],1)},AvatarPopovervue_type_template_id_8ef9b9ec_staticRenderFns=[],AvatarPopovervue_type_script_lang_js=(__webpack_require__(670560),__webpack_require__(648324),{props:["size","user","color","name","moduleName"],data:function(){return{defaultheight:"230px",result:{},popoverShown:!1,viewname:""}},components:{Avatar:Avatar["default"]},mounted:function(){
// this.showPopover = this.showpopoverFooter
this.moduleName&&(this.defaultheight="160px")},watch:{popoverShown:function(val){val&&this.userOpenDatas()}},methods:{userOpenDatas:function(){var self=this;self.$http.post("/widget/getUserCardData",{ouid:this.user.id}).then((function(response){200===response.status&&(self.result=response.data.result)}))},getOpen:function(viewName){var filter={assignedTo:{operator:"is",value:[this.user.id+""]}};this.$router.push("/app/wo/orders/"+viewName+"?search="+encodeURIComponent(JSON.stringify(filter)))}}}),components_AvatarPopovervue_type_script_lang_js=AvatarPopovervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_AvatarPopovervue_type_script_lang_js,AvatarPopovervue_type_template_id_8ef9b9ec_render,AvatarPopovervue_type_template_id_8ef9b9ec_staticRenderFns,!1,null,null,null)
/* harmony default export */,AvatarPopover=component.exports,vuex_esm=__webpack_require__(420629),Uservue_type_script_lang_js={created:function(){this.$store.dispatch("loadGroups")},components:{Avatar:Avatar["default"],AvatarPopover:AvatarPopover},props:{size:{type:String},user:{type:Object},avatarStyle:{type:Object},name:{type:Boolean,default:function(){return!0}},showLabel:{type:Boolean},showPopover:{type:Boolean},moduleName:{type:String},group:{type:Object},hovercard:{type:Boolean}},data:function(){return{hoverCardId:"userHoverCardId-"+(this.user?this.user.id:"unkown"),loadHoverCardData:!1,labelStatus:this.hideLabel}},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({users:function(state){return state.users}})),{},{userObj:function(){var _this=this,hasUser=this.user&&this.user.id>0,user=hasUser?this.$getProperty(this.user,"name")?this.user:this.users.find((function(usr){return usr.id===_this.user.id})):null;return user||{id:-1,name:"Unknown"}},color:function(){return-1!==this.userObj.id?"":this.group?"#c3c3c3":"#e3e3e3"}}),methods:{loadHoverCard:function(){this.loadHoverCardData=!0},hideHoverCard:function(){this.loadHoverCardData=!1}}},avatar_Uservue_type_script_lang_js=Uservue_type_script_lang_js,User_component=(0,componentNormalizer/* default */.Z)(avatar_Uservue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,User=User_component.exports},
/***/595118:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return DashboardShare}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/dashboard/components/DashboardShare.vue?vue&type=template&id=81a2e1e6
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("el-popover",{ref:"popover5",attrs:{placement:"bottom",width:"350",height:"400","popper-class":"sharepopover"},model:{value:_vm.sharingDialogVisible,callback:function($$v){_vm.sharingDialogVisible=$$v},expression:"sharingDialogVisible"}},[_c("div",{staticClass:"share-container"},[_c("el-row",{staticClass:"share-header",attrs:{align:"middle ",guttr:20}},[_c("el-col",{staticStyle:{"padding-right":"35px","padding-left":"0px"},attrs:{span:24}},[_c("div",{staticClass:"add"},[_c("el-radio",{attrs:{label:1},model:{value:_vm.shareTo,callback:function($$v){_vm.shareTo=$$v},expression:"shareTo"}},[_vm._v(" "+_vm._s(_vm.$t("panel.share.me")))]),_c("el-radio",{attrs:{label:2},model:{value:_vm.shareTo,callback:function($$v){_vm.shareTo=$$v},expression:"shareTo"}},[_vm._v(_vm._s(_vm.$t("panel.share.everyone")))]),_c("el-radio",{attrs:{label:3},model:{value:_vm.shareTo,callback:function($$v){_vm.shareTo=$$v},expression:"shareTo"}},[_vm._v(_vm._s(_vm.$t("panel.share.specific")))])],1)])],1),3===_vm.shareTo?_c("el-row",{staticStyle:{margin:"0px","padding-top":"20px"},attrs:{align:"middle",gutter:20}},[_c("el-col",{staticStyle:{"padding-right":"0px","padding-left":"0px"},attrs:{span:24}},[_c("div",{staticClass:"textcolor"},[_vm._v(_vm._s(_vm.$t("panel.share.users")))]),_c("div",{staticClass:"add"},[_c("el-select",{staticClass:"form-item ",staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:_vm.$t("common.wo_report.choose_users")},model:{value:_vm.sharedUsers,callback:function($$v){_vm.sharedUsers=$$v},expression:"sharedUsers"}},_vm._l(_vm.users,(function(user){return _c("el-option",{key:user.id,attrs:{label:user.name,value:user.id}})})),1)],1)])],1):_vm._e(),3===_vm.shareTo?_c("el-row",{staticStyle:{margin:"0px","padding-top":"20px"},attrs:{align:"middle",gutter:20}},[_c("el-col",{staticStyle:{"padding-right":"0px","padding-left":"0px"},attrs:{span:24}},[_c("div",{staticClass:"textcolor"},[_vm._v(_vm._s(_vm.$t("panel.share.roles")))]),_c("div",{staticClass:"add"},[_c("el-select",{staticClass:"form-item ",staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:_vm.$t("common.wo_report.choose_roles")},model:{value:_vm.sharedRoles,callback:function($$v){_vm.sharedRoles=$$v},expression:"sharedRoles"}},_vm._l(_vm.roles,(function(role){return _c("el-option",{key:role.id,attrs:{label:role.name,value:role.id}})})),1)],1)])],1):_vm._e(),3===_vm.shareTo?_c("el-row",{staticStyle:{margin:"0px","padding-top":"20px"},attrs:{align:"middle",gutter:20}},[_c("el-col",{staticStyle:{"padding-right":"0px","padding-left":"0px"},attrs:{span:24}},[_c("div",{staticClass:"textcolor"},[_vm._v(_vm._s(_vm.$t("panel.share.teams")))]),_c("div",{staticClass:"add"},[_c("el-select",{staticClass:"form-item ",staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:_vm.$t("common.wo_report.choose_teams")},model:{value:_vm.sharedGroups,callback:function($$v){_vm.sharedGroups=$$v},expression:"sharedGroups"}},_vm._l(_vm.groups,(function(group){return _c("el-option",{key:group.id,attrs:{label:group.name,value:group.id}})})),1)],1)])],1):_vm._e(),4===_vm.shareTo?_c("el-row",{staticStyle:{margin:"0px","padding-top":"20px"},attrs:{align:"middle",gutter:20}},[_c("el-col",{staticStyle:{"padding-right":"0px","padding-left":"0px"},attrs:{span:24}},[_c("div",{staticClass:"textcolor"},[_vm._v(_vm._s(_vm.$t("panel.share.portal")))]),_c("div",{staticClass:"add"},[_c("el-select",{staticClass:"form-item ",staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:_vm.$t("common.wo_report.choose_users")},model:{value:_vm.portalusers,callback:function($$v){_vm.portalusers=$$v},expression:"portalusers"}},_vm._l(_vm.portalusers,(function(user){return _c("el-option",{key:user.id,attrs:{label:user.name,value:user.id}})})),1)],1)])],1):_vm._e()],1),_c("div",{staticClass:"dialog-footer row"},[_c("div",{staticClass:"col-6 shareoverbtn shrbtn1",on:{click:function($event){_vm.sharingDialogVisible=!1}}},[_vm._v(" "+_vm._s(_vm.$t("panel.share.cancel"))+" ")]),_c("div",{staticClass:"col-6 shareoverbtn shrbtn2",on:{click:_vm.applySharing}},[_vm._v(" "+_vm._s(_vm.$t("panel.share.confirm"))+" ")])])]),_c("div",{directives:[{name:"popover",rawName:"v-popover:popover5",arg:"popover5"}]},[_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-share default dashboard-edit share-icon",attrs:{title:"Share","data-position":"top","data-arrow":"true"}})])],1)},staticRenderFns=[],objectSpread2=__webpack_require__(595082),ReportHelper=(__webpack_require__(670560),__webpack_require__(507815)),vuex_esm=__webpack_require__(420629),DashboardSharevue_type_script_lang_js={mixins:[ReportHelper/* default */.Z],props:["id","dashboard"],data:function(){return{shareTo:2,sharedUsers:[],sharedRoles:[],portalusers:[],sharedGroups:[],sharingDialogVisible:!1}},watch:{dashboard:{handler:function(newData,oldData){newData!==oldData&&this.loadSharing()},deep:!0}},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({groups:function(state){return state.groups},users:function(state){return state.users},roles:function(state){return state.roles}})),(0,vuex_esm/* mapGetters */.Se)(["getCurrentUser"])),{},{dashboardLink:function(){return this.$route.params.dashboardlink}}),created:function(){this.$store.dispatch("loadRoles"),this.$store.dispatch("loadGroups"),this.$store.dispatch("loadUsers")},mounted:function(){this.loadSharing(),this.loadPortalUsers()},methods:{loadPortalUsers:function(){var self=this;self.$http.get("/setup/portalusers").then((function(response){self.portalusers=response.data.users}))},loadSharing:function(){var self=this;null!==self.dashboard&&self.$http.get("/dashboardsharing/"+self.dashboard.id).then((function(response){if(response.data.dashboardSharing)if(0===response.data.dashboardSharing.length)self.shareTo=2;else{self.sharedUsers=[],self.sharedRoles=[],self.sharedGroups=[];for(var i=0;i<response.data.dashboardSharing.length;i++){var dashboardSharing=response.data.dashboardSharing[i];1===dashboardSharing.sharingType?self.sharedUsers.push(dashboardSharing.orgUserId):2===dashboardSharing.sharingType?self.sharedRoles.push(dashboardSharing.roleId):3===dashboardSharing.sharingType?self.sharedGroups.push(dashboardSharing.groupId):4===dashboardSharing.sharingType&&self.sharedUsers.push(dashboardSharing.orgUserId)}1===response.data.dashboardSharing.length&&1===self.sharedUsers.length&&self.sharedUsers[0]===self.getCurrentUser().ouid?self.shareTo=1:self.shareTo=3}}))},applySharing:function(){var self=this;self.sharingDialogVisible=!1;var dashboardSharing=[];if(1===self.shareTo)dashboardSharing.push({dashboardId:self.dashboard.id,sharingType:1,orgUserId:self.getCurrentUser().ouid});else if(3===self.shareTo){if(self.sharedUsers.length>0){dashboardSharing.push({dashboardId:self.dashboard.id,sharingType:1,orgUserId:self.getCurrentUser().ouid});for(var i=0;i<self.sharedUsers.length;i++)self.sharedUsers[i]!==self.getCurrentUser().ouid&&dashboardSharing.push({dashboardId:self.dashboard.id,sharingType:1,orgUserId:self.sharedUsers[i]})}if(self.sharedRoles.length>0)for(var _i=0;_i<self.sharedRoles.length;_i++)dashboardSharing.push({dashboardId:self.dashboard.id,sharingType:2,roleId:self.sharedRoles[_i]});if(self.sharedGroups.length>0)for(var _i2=0;_i2<self.sharedGroups.length;_i2++)dashboardSharing.push({dashboardId:self.dashboard.id,sharingType:3,groupId:self.sharedGroups[_i2]})}else if(4===self.shareTo&&self.sharedUsers.length>0)for(var _i3=0;_i3<self.sharedUsers.length;_i3++)self.sharedUsers[_i3]!==self.getCurrentUser().ouid&&dashboardSharing.push({dashboardId:self.dashboard.id,sharingType:1,orgUserId:self.sharedUsers[_i3]});self.$http.post("/dashboardsharing/apply",{dashboardId:self.dashboard.id,dashboardSharing:dashboardSharing}).then((function(response){self.$message({message:"Sharing applied successfully!",type:"success"})}))}}},components_DashboardSharevue_type_script_lang_js=DashboardSharevue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_DashboardSharevue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,DashboardShare=component.exports},
/***/171140:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return NewDashboard}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/dashboard/forms/NewDashboard.vue?vue&type=template&id=32f74c7c
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("f-form",{ref:"newDashboardForm",attrs:{type:"dialog50",title:"New Dashboard",model:_vm.model},on:{save:_vm.save},scopedSlots:_vm._u([{key:"form",fn:function(fscope){return[_c("el-row",{attrs:{gutter:50,align:"middle"}},[_c("el-col",{attrs:{span:24}},[_c("q-input",{staticClass:"form-item",attrs:{"float-label":"Name"},model:{value:fscope.formModel.dashboardName,callback:function($$v){_vm.$set(fscope.formModel,"dashboardName",$$v)},expression:"fscope.formModel.dashboardName"}})],1)],1),_c("el-row",{attrs:{gutter:50,align:"middle"}},[_c("el-col",{attrs:{span:24}},[_c("q-input",{staticClass:"form-item",attrs:{"float-label":"Description",type:"textarea"},model:{value:fscope.formModel.dashboardDesc,callback:function($$v){_vm.$set(fscope.formModel,"dashboardDesc",$$v)},expression:"fscope.formModel.dashboardDesc"}})],1)],1),_c("el-row",{attrs:{gutter:50,align:"middle"}},[_c("el-col",{attrs:{span:24}},[_c("q-select",{staticClass:"form-item",attrs:{"float-label":"Module",options:_vm._f("options")(_vm.supportedModules,"displayName","moduleId")},model:{value:fscope.formModel.moduleId,callback:function($$v){_vm.$set(fscope.formModel,"moduleId",$$v)},expression:"fscope.formModel.moduleId"}})],1)],1)]}}])})},staticRenderFns=[],quasar_esm=__webpack_require__(641358),FForm=__webpack_require__(570992),NewDashboardvue_type_script_lang_js={components:{QInput:quasar_esm/* QInput */.Ke,QSelect:quasar_esm/* QSelect */.zO,FForm:FForm/* default */.Z},data:function(){return{model:{dashboardName:null,dashboardDesc:null,moduleId:null},supportedModules:[]}},
// watch: {
//   visibility: function (newVal) {
//     this.visibilityState = newVal
//     if (this.visibilityState) {
//       this.$refs.newDashboardForm.open()
//     }
//     else {
//       this.$refs.newDashboardForm.close()
//     }
//   }
// },
mounted:function(){this.loadSupportedModules()},methods:{loadSupportedModules:function(){var self=this,url="/dashboard/supportedmodules";this.$http.get(url).then((function(response){response.data.modules&&(self.supportedModules=response.data.modules)}))},open:function(){this.$refs.newDashboardForm.open()},close:function(){this.$refs.newDashboardForm.close()},save:function(){var self=this,formModel=self.$refs.newDashboardForm.getFormModel(),formdata={dashboard:{dashboardName:formModel.dashboardName,moduleId:formModel.moduleId}};self.$http.post("/dashboard/add",formdata).then((function(response){self.$message({message:"Dashboard created successfully!",type:"success"}),self.close()}))}}},forms_NewDashboardvue_type_script_lang_js=NewDashboardvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(forms_NewDashboardvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,NewDashboard=component.exports},
/***/503658:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return BaseDialogBox}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/energy/pivot/Components/BaseDialogBox.vue?vue&type=template&id=4730d566
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_vm.visibility?_c("el-dialog",{attrs:{"custom-class":"base-dialog-box",title:_vm.title,visible:_vm.visibility,"append-to-body":!0,"show-close":!1,"close-on-click-modal":!1,width:_vm.width,"destroy-on-close":!0},on:{"update:visible":function($event){_vm.visibility=$event}}},[_c("div",{staticClass:"title-slot",style:{display:_vm.hideHeader?"none":"block"},attrs:{slot:"title"},slot:"title"},[_c("div",{staticClass:"title-div"},[_vm._v(" "+_vm._s(_vm.title)+" ")]),_c("hr")]),_c("div",{staticClass:"dialog-body"},[_vm._t("body")],2),_c("span",{class:_vm.isAlert?"dialog-footer-alert":"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[_c("el-button",{staticClass:"mR10 dialog-btn confirm-btn",attrs:{disabled:_vm.disableConfirm,type:"el-button  el-button--primary"},on:{click:_vm.onConfirm}},[_vm._v(_vm._s(_vm.confirmText))]),_c("el-button",{staticClass:"mL10 dialog-btn cancel-btn",attrs:{disabled:_vm.disableCancel},on:{click:_vm.onCancel}},[_vm._v(_vm._s(_vm.cancelText))]),_vm.onClearAll?_c("el-button",{staticClass:"clear-all-btn",staticStyle:{"margin-left":"20px !important","text-decoration":"underline"},attrs:{type:"text"},on:{click:_vm.onClearAll}},[_vm._v("Clear all")]):_vm._e()],1)]):_vm._e()],1)},staticRenderFns=[],BaseDialogBoxvue_type_script_lang_js={props:["title","visibility","width","onCancel","cancelText","onConfirm","confirmText","disableCancel","disableConfirm","hideHeader","onClearAll","isAlert"]},Components_BaseDialogBoxvue_type_script_lang_js=BaseDialogBoxvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(Components_BaseDialogBoxvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,BaseDialogBox=component.exports},
/***/303783:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return saveReportMixin}});
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js
var render,staticRenderFns,regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),objectSpread2=__webpack_require__(595082),NewReportSummaryHelper=(__webpack_require__(260228),__webpack_require__(670560),__webpack_require__(564043),__webpack_require__(857267),__webpack_require__(434284),__webpack_require__(228436),__webpack_require__(169358),__webpack_require__(648324),__webpack_require__(601458)),api=__webpack_require__(32284),vuex_esm=__webpack_require__(420629),router=__webpack_require__(329435),saveReportMixinvue_type_script_lang_js={props:["report","config"],mixins:[NewReportSummaryHelper/* default */.Z],mounted:function(){this.loadReportFolders()},computed:(0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapGetters */.Se)(["getCurrentUser"])),watch:{newReport:{handler:function(newState){}}},data:function(){return{moduleOptions:{},moduleLoading:!0,moduleNameLocal:null,reportFolders:[],newReport:{name:"",description:"",reportFolderId:"",analyticsType:1,addToDashboard:!1,isTemplate:!1},disableSaveButton:!1}},methods:{loadReportFolders:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var url,self;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:
// no module name case is energy data reports, DON't send moduleName prop as energydata.;leave null for energreports
url="/v3/report/folders?moduleName=energydata",self=_this,//pivot
url+="&isPivot=true",api/* API */.bl.get(url).then((function(response){response.error||(self.reportFolders=response.data.reportFolders)}));case 4:case"end":return _context.stop()}}),_callee)})))()},init:function(){this.report&&this.$helpers.copy(this.newReport,this.report)},saveFolder:function(folderName){var _this2=this,self=this;this.applySharing();var apiUrl=null;return apiUrl="/v3/report/folder/create?moduleName=energydata&isPivot=true",new Promise((function(resolve,reject){var a={reportFolder:{name:folderName,reportSharing:_this2.reportSharing}};
//adding folder type =>3 for pivot reports.TODO  send typeEnum for Reading and module reports too
self.report&&5==self.report.reportType&&(a.reportFolder.folderType=3),api/* API */.bl.post(apiUrl,a).then((function(response){response.error?(_this2.$message.error(response.error.message),reject(response.error)):response.data.reportFolder&&response.data.reportFolder.id?resolve(response):reject(response)})).catch((function(error){error&&reject(error)}))}))},applySharing:function(){var self=this;if(this.reportSharing=[],1===self.shareTo)this.reportSharing.push({type:1,userId:self.getCurrentUser().ouid});else if(3===self.shareTo){if(self.sharedUsers.length>0){this.reportSharing.push({type:1,userId:self.getCurrentUser().ouid});for(var i=0;i<self.sharedUsers.length;i++)self.sharedUsers[i]!==self.getCurrentUser().ouid&&this.reportSharing.push({type:1,userId:self.sharedUsers[i]})}if(self.sharedRoles.length>0)for(var _i=0;_i<self.sharedRoles.length;_i++)this.reportSharing.push({type:2,roleId:self.sharedRoles[_i]});if(self.sharedGroups.length>0)for(var _i2=0;_i2<self.sharedGroups.length;_i2++)this.reportSharing.push({type:3,groupId:self.sharedGroups[_i2]})}},addReport:function(override){this.disableSaveButton=!0,this.$emit("savingStarted");var self=this,newReportParams={},apiUrl=null;
//pivot report
apiUrl="v2/report/savePivotReport";var reportId=this.$route.query.reportId&&!this.$route.query.duplicate?this.$route.query.reportId:-1;
//apiUrl = reportId === -1 ? 'v3/report/pivot/create' : 'v3/report/pivot/update'
newReportParams=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},this.config),{},{reportContext:this.newReport}),reportId&&(newReportParams["reportId"]=reportId),self.saving=!0,api/* API */.bl.post(apiUrl,newReportParams).then((function(response){var reportContext=response.data.report;if(override){var reportURL=self.getRouterUrl(reportContext,self.viewModes().EDIT,!1),reportURLSplit=reportURL.split("?");reportURL=reportURLSplit[0],self.close(response.data),self.$router.replace({path:reportURL,query:{reportId:reportContext.id}})}else self.$router.push(self.getRouterUrl()+reportContext.id),
// self.$router.replace({ query: { reportId: reportContext.id } })
self.$emit("savingEnded"),
// let notifyInstance = self.$notify({
//   title: self.$t('common._common.report_saved_successfully'),
//   message: self.$t('common._common.click_here_to_open_report'),
//   type: 'success',
//   duration: 0,
//   customClass: 'report-save-success',
//   onClick: function() {
//     if (notifyInstance) {
//       notifyInstance.close()
//     }
//     let reportURL = null
//     reportURL = self.getRouterUrl()
//     self.$router.push({ path: reportURL })
//   },
// })
self.close(response.data),self.saving=!1})).catch((function(error){self.saving=!1,alert(error),self.$emit("savingEnded")}))},viewModes:function(){var viewModes={VIEW:1,EDIT:2};return viewModes},getRouterUrl:function(){var reportURL="/app/em/pivot/view/";if((0,router/* isWebTabsEnabled */.tj)()){var _findRouteForTab=(0,router/* findRouteForTab */.OD)(router/* pageTypes */.As.PIVOT_VIEW),name=_findRouteForTab.name;reportURL=this.$router.resolve({name:name}).href,reportURL+="/"}return reportURL},getReportObject:function(){this.close({report:this.newReport})},saveReport:function(){var self=this;if(this.newReport.name&&this.newReport.name.trim().length)if(this.newReport.reportFolderId){var reportFolderId=-1;try{reportFolderId=parseInt(this.newReport.reportFolderId)}catch(err){}this.disableSaveButton=!0,isNaN(reportFolderId)||reportFolderId<0?self.saveFolder(this.newReport.reportFolderId).then((function(response){reportFolderId=response.data.reportFolder.id,self.newReport.reportFolderId=reportFolderId,self.addReport()})):self.addReport()}else alert(this.$t("common.header.please_choose_folder_enter_new_folder"));else alert(this.$t("common.header.please_enter_the_report_name"))},close:function(reportObj){this.$emit("reportSaved",JSON.parse(JSON.stringify(reportObj.report))),this.newReport={name:"",description:"",reportFolderId:"",addToDashboard:!1}}}},Components_saveReportMixinvue_type_script_lang_js=saveReportMixinvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(Components_saveReportMixinvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,saveReportMixin=component.exports;
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js
},
/***/468652:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return Layout}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/energy/pivot/Layout.vue?vue&type=template&id=1023f960&scoped=true
var render=function(){var this$1=this,_vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"height-100 report-layout-pivot flex-middle"},[_vm.exportDownloadUrl?_c("iframe",{staticStyle:{display:"none"},attrs:{src:_vm.exportDownloadUrl}}):_vm._e(),_vm.leftPaneVisibility?_vm._e():_c("div",{class:"hamburger-menu",on:{click:_vm.handleBackButton}},[_c("i",{staticClass:"el-icon-back"})]),_c("el-dialog",{attrs:{visible:_vm.loading,"show-close":!1,"append-to-body":!0,"close-on-click-modal":!1,width:"0"}},[_c("img",{attrs:{src:__webpack_require__(918562)}})]),_vm.moduleSlectVisibility?_c("ModuleSelectDialogBoxViewPage",{attrs:{visibility:_vm.moduleSlectVisibility},on:{"update:visibility":function($event){_vm.moduleSlectVisibility=$event},dialogClosed:function($event){_vm.moduleSlectVisibility=!1}}}):_vm._e(),_c("PivotReportSideBar",{directives:[{name:"show",rawName:"v-show",value:_vm.leftPaneVisibility,expression:"leftPaneVisibility"}],ref:"pivotReportSidebar",staticClass:"report-summary",attrs:{moduleName:"energydata",reportid:"id",updateReports:_vm.updateReports,isPivot:!0},on:{reportChanged:_vm.reportChanged,folderClicked:_vm.folderReportView,sidebarLoaded:function($event){return _vm.defaultPageToggle(1)},clearReport:function($event){_vm.report=null},foldersEmpty:function($event){_vm.isFoldersEmpty=!0},foldersNotEmpty:function($event){_vm.isFoldersEmpty=!1}}}),_c("div",{staticClass:"header-bar"},[_vm.isFolderClicked||_vm.isReportPrevied?_c("div",{staticClass:"report-header-and-summary header-bar-background",style:_vm.leftPaneVisibility?"":"border-left:none"},[_vm.report||_vm.reportId||_vm.isFolderClicked?_c("div",{staticClass:"report-name-section",class:_vm.leftPaneVisibility?_vm.isReportPrevied||!_vm.leftPaneVisibility?"breadcrumb-view":"":"breadcrumb-view",style:_vm.leftPaneVisibility?"":"padding-left:50px;"},[_c("el-breadcrumb",{attrs:{separator:""}},[_vm.isFolderClicked?_c("inline-svg",{style:_vm.leftPaneVisibility?"margin-right:10px;paddinng-left:25px;":"margin-right:10px;",attrs:{src:"svgs/pivot/folder"}}):_vm._e(),_vm.isReportPrevied||_vm.isFolderClicked?_c("el-breadcrumb-item",{staticClass:"pivot-crumb",staticStyle:{"font-weight":"500 !important"},model:{value:_vm.selected_folder_Obj,callback:function($$v){_vm.selected_folder_Obj=$$v},expression:"selected_folder_Obj"}},[!_vm.leftPaneVisibility&&_vm.reportLoaded?_c("div",{class:_vm.isReportPrevied?"breadcrumb-text-folder":"",style:_vm.leftPaneVisibility||_vm.isReportPrevied?"":"margin-left:25px;margin-top:20px;"},[_vm._v(" "+_vm._s("--"!=_vm.report.description?_vm.report.description:"No Description")+" ")]):_c("div",{staticClass:"breadcrumb-text-folder",style:"color:black;"},[_vm._v(" "+_vm._s(_vm.selected_folder_Obj.folderName)+" ")])]):_vm._e(),_vm.isReportPrevied?_c("el-breadcrumb-item",{staticClass:"pivot-crumb",staticStyle:{"font-weight":"500 !important","font-size":"16px !important"}},[_vm._v(" "+_vm._s(_vm.selected_report_name))]):_vm._e()],1),_c("div",{style:"display:flex;margin:5px 35px 0 0;"},[_vm.isReportPrevied&&_vm.hasCreateEditPermission?_c("div",{staticStyle:{height:"26px",width:"74px","margin-bottom":"4px"}},[_c("el-button",{staticClass:"edit-button",attrs:{plain:""},on:{click:_vm.editReport}},[_c("InlineSvg",{attrs:{src:"svgs/pivot/edit",iconClass:"icon-sm flex icon"}}),_vm._v(" EDIT ")],1)],1):_vm._e(),_vm.isReportPrevied?_c("div",{staticClass:"more-button",staticStyle:{"margin-left":"20px","margin-bottom":"8px","margin-top":"2px",transform:"rotate(90deg)"}},[_c("el-dropdown",{attrs:{trigger:"click",placement:"bottom","hide-on-click":!1},on:{command:function(command){return _vm.handleCommand(command,_vm.isCloneToAnotherApp)}}},[_c("el-button",{attrs:{icon:"el-icon-more",size:"medium"},on:{click:function($event){$event.stopPropagation()}}}),_c("el-dropdown-menu",{staticStyle:{"margin-left":"155px"},attrs:{slot:"dropdown"},slot:"dropdown"},[_vm.hasDeletePermission?_c("el-dropdown-item",{attrs:{command:"delete"}},[_c("InlineSvg",{attrs:{src:"svgs/pivot/delete-icon",iconClass:"icon-sm flex icon"}}),_vm._v("Delete")],1):_vm._e(),_vm.hasCreateEditPermission?_c("el-dropdown-item",{attrs:{command:"duplicate"}},[_c("InlineSvg",{attrs:{src:"svgs/pivot/duplicate",iconClass:"icon-sm flex icon"}}),_vm._v(" Duplicate")],1):_vm._e(),_vm.hasCreateEditPermission?_c("el-dropdown-item",{attrs:{command:"move"}},[_c("el-popover",{attrs:{placement:"right",width:"185",title:"Folders",trigger:"hover"}},[_vm._l(_vm.reportFolders,(function(folder){return _c("div",{key:folder.id,staticClass:"pivot-folder-option",on:{click:function($event){return _vm.handleMoveFolder(folder,_vm.report)}}},[_vm._v(" "+_vm._s(folder.name)+" ")])})),_c("button",{staticClass:"move-btn",attrs:{slot:"reference"},slot:"reference"},[_c("InlineSvg",{attrs:{src:"svgs/pivot/Move",iconClass:"icon-sm flex icon"}}),_vm._v(" Move ")],1)],2)],1):_vm._e(),_vm.hasExportPermission?_c("el-dropdown-item",{attrs:{command:"export"}},[_c("el-popover",{attrs:{placement:"right",width:"185",trigger:"hover"}},[_c("div",{staticClass:"pivot-folder-option",on:{click:function(){return _vm.exportReport(1,this$1.report.id)}}},[_vm._v(" Export as CSV ")]),_c("div",{staticClass:"pivot-folder-option",on:{click:function(){return _vm.exportReport(2,this$1.report.id)}}},[_vm._v(" Export as Excel ")]),_c("button",{staticClass:"move-btn",attrs:{slot:"reference"},slot:"reference"},[_c("InlineSvg",{attrs:{src:"svgs/pivot/Export",iconClass:"icon-xs flex icon"}}),_vm._v(" Export ")],1)])],1):_vm._e(),_vm.hasSchedulePermission?_c("el-dropdown-item",{attrs:{command:"Schedule"}},[_c("img",{staticClass:"report-icon flex icon",staticStyle:{height:"14px",width:"14px","margin-left":"2px","margin-right":"8px"},attrs:{src:__webpack_require__(598685)}}),_vm._v(" Schedule Report ")]):_vm._e(),_c("el-dropdown-item",{attrs:{command:"Mail"}},[_c("img",{staticClass:"report icon flex icon",staticStyle:{height:"14px",width:"14px","margin-left":"2px","margin-right":"8px"},attrs:{src:__webpack_require__(2175)}}),_vm._v(" Send Mail ")]),_vm.hasCreateEditPermission?_c("el-dropdown-item",{attrs:{command:"CloneReport"}},[_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],class:["fa fa-clone"],attrs:{"data-position":"top","data-arrow":"true",title:_vm.$t("home.dashboard.duplicate_report")}}),_vm._v(" Clone to another app ")]):_vm._e()],1)],1)],1):_vm._e()])],1):_vm._e(),_vm.isReportPrevied||_vm.isEmptyFolderView?_vm._e():_c("div",{staticClass:"search-container-header pL10 pR23",staticStyle:{"margin-top":"1px"}},[_c("el-input",{staticClass:"fc-input-full-border2 pL5",attrs:{placeholder:"Search",type:"search","prefix-icon":"el-icon-search"},model:{value:_vm.searchText,callback:function($$v){_vm.searchText=$$v},expression:"searchText"}})],1),_c("div",{staticClass:"new-pivot-btn header-btn",style:_vm.isReportPrevied?"display:none":"",on:{click:function($event){_vm.moduleSlectVisibility=!0}}},[_c("i",{staticClass:"el-icon-plus pR5 fwBold",staticStyle:{transform:"scale(0.9)"}}),_vm._v("New Pivot Table ")])]):_vm._e(),_vm.isReportPrevied?_c("div",{staticClass:"pivot-summary-section",style:_vm.leftPaneVisibility?"":"width:94.5vw;"},[_vm.id?_c("PivotSummaryNew",{key:_vm.refreshPivotSummary,ref:"PivotSummaryNew",attrs:{id:_vm.id},on:{reportDeleted:_vm.handleReportDelete,summaryLoaded:function($event){return _vm.defaultPageToggle(2)}}}):_vm._e()],1):_vm._e(),_vm.isFoldersEmpty?_c("div",{staticClass:"default-view-page"},[_vm._m(0),_c("div",{staticClass:"new-pivot-btn",on:{click:function($event){_vm.moduleSlectVisibility=!0}}},[_c("i",{staticClass:"el-icon-plus pR5 fwBold",staticStyle:{transform:"scale(0.9)"}}),_vm._v("New Pivot Table ")])]):_vm._e(),_vm.isFolderClicked?_c("div",{class:_vm.leftPaneVisibility?"report-view-table":"report-view-table-fullscreen"},[_c("el-table",{attrs:{data:_vm.reportFoldersList,"cell-style":{margin:"4px 0"},"row-class-name":"report-row no-hover"},on:{"row-click":_vm.openReportDetails}},[_c("el-table-column",{attrs:{prop:"name",label:"Name",width:"35%","class-name":"pivot-table-name"}}),_c("el-table-column",{attrs:{prop:"description",label:"Description",width:"25%"}}),_c("el-table-column",{attrs:{prop:"moduleName",label:"Module",width:"20%"}}),_c("el-table-column",{attrs:{prop:"created_by",label:"Created by",width:"20%"},scopedSlots:_vm._u([{key:"default",fn:function(scope){return["--"!==scope.row.createdBy?_c("div",{staticClass:"pL25"},[_c("user-avatar",{directives:[{name:"tippy",rawName:"v-tippy"}],attrs:{size:"sm",user:_vm.$store.getters.getUser(scope.row.createdBy),name:!1,title:_vm.$store.getters.getUser(scope.row.createdBy).name}})],1):_c("div",{staticClass:"pL25"},[_c("span",{staticStyle:{"padding-left":"6px"}},[_vm._v(" "+_vm._s(scope.row.createdBy))])])]}}],null,!1,3311834525)}),_c("el-table-column",{attrs:{prop:"modified_time",label:"Modified on",width:"20%"}}),_c("el-table-column",{attrs:{prop:"modified_by",label:"Modified by",width:"20%"},scopedSlots:_vm._u([{key:"default",fn:function(scope){return["--"!==scope.row.modified_by?_c("div",{staticClass:"pL25"},[_c("user-avatar",{directives:[{name:"tippy",rawName:"v-tippy"}],attrs:{size:"sm",user:_vm.$store.getters.getUser(scope.row.modified_by),name:!1,title:_vm.$store.getters.getUser(scope.row.modified_by).name}})],1):_c("div",{staticClass:"pL25"},[_c("span",{staticStyle:{"padding-left":"6px"}},[_vm._v(_vm._s(scope.row.modified_by))])])]}}],null,!1,574441750)}),_c("el-table-column",{attrs:{align:"right",width:"20%"},scopedSlots:_vm._u([{key:"default",fn:function(scope){return[_c("div",{staticClass:"table-btn-container",staticStyle:{height:"100%",width:"100%"}},[_vm.hasCreateEditPermission?_c("el-button",{staticClass:"edit-btn",staticStyle:{"margin-right":"10px"},attrs:{size:"medium"},on:{click:function($event){return _vm.editReport(scope.row)}}},[_c("InlineSvg",{attrs:{src:"svgs/pivot/edit",iconClass:"icon-sm flex icon"}})],1):_vm._e(),_c("el-dropdown",{staticClass:"more-dropdown",attrs:{trigger:"click","hide-on-click":!1},on:{command:function(command){return _vm.handleCommand(command,_vm.isCloneToAnotherApp,scope.row)}}},[_c("el-button",{staticClass:"more-btn",attrs:{icon:"el-icon-more",size:"medium"},on:{click:function($event){$event.stopPropagation()}}}),_c("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[_vm.hasDeletePermission?_c("el-dropdown-item",{attrs:{command:"delete"}},[_c("InlineSvg",{attrs:{src:"svgs/pivot/delete-icon",iconClass:"icon-sm flex icon"}}),_vm._v("Delete")],1):_vm._e(),_vm.hasCreateEditPermission?_c("el-dropdown-item",{attrs:{command:"duplicate"}},[_c("InlineSvg",{attrs:{src:"svgs/pivot/duplicate",iconClass:"icon-sm flex icon"}}),_vm._v("Duplicate")],1):_vm._e(),_vm.hasCreateEditPermission?_c("el-dropdown-item",{attrs:{command:"move"}},[_c("el-popover",{attrs:{placement:"left",width:"185",title:"Folders",trigger:"hover"}},[_vm._l(_vm.reportFolders,(function(folder){return _c("div",{key:folder.id,staticClass:"pivot-folder-option",on:{click:function($event){return _vm.handleMoveFolder(folder,scope.row)}}},[_vm._v(" "+_vm._s(folder.name)+" ")])})),_c("button",{staticClass:"move-btn",attrs:{slot:"reference"},slot:"reference"},[_c("InlineSvg",{attrs:{src:"svgs/pivot/Move",iconClass:"icon-sm flex icon"}}),_vm._v(" Move ")],1)],2)],1):_vm._e(),_vm.hasExportPermission?_c("el-dropdown-item",{attrs:{command:"export"}},[_c("el-popover",{attrs:{placement:"left",width:"185",trigger:"hover"}},[_c("div",{staticClass:"pivot-folder-option",on:{click:function($event){return _vm.exportReport(1,scope.row.id)}}},[_vm._v(" Export as CSV ")]),_c("div",{staticClass:"pivot-folder-option",on:{click:function($event){return _vm.exportReport(2,scope.row.id)}}},[_vm._v(" Export as Excel ")]),_c("button",{staticClass:"move-btn",attrs:{slot:"reference"},slot:"reference"},[_c("InlineSvg",{attrs:{src:"svgs/pivot/Export",iconClass:"icon-sm flex icon"}}),_vm._v(" Export ")],1)])],1):_vm._e(),_vm.hasSchedulePermission?_c("el-dropdown-item",{attrs:{command:"Schedule"}},[_c("img",{staticClass:"report-icon flex icon",staticStyle:{height:"14px",width:"14px","margin-left":"2px","margin-right":"8px"},attrs:{src:__webpack_require__(598685)}}),_vm._v(" Schedule Report ")]):_vm._e(),_c("el-dropdown-item",{attrs:{command:"Mail"}},[_c("img",{staticClass:"report icon flex icon",staticStyle:{height:"14px",width:"14px","margin-left":"2px","margin-right":"8px"},attrs:{src:__webpack_require__(2175)}}),_vm._v(" Send Mail ")]),_vm.hasCreateEditPermission?_c("el-dropdown-item",{attrs:{command:"CloneReport"}},[_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],class:["fa fa-clone"],staticStyle:{"margin-left":"2px","margin-right":"8px"},attrs:{"data-position":"top","data-arrow":"true",title:_vm.$t("home.dashboard.duplicate_report")}}),_vm._v(" Clone to another app ")]):_vm._e()],1)],1)],1)]}}],null,!1,1833774747)})],1)],1):_vm._e()]),_vm.visibility.showEmailDialog?_c("email-report",{attrs:{moduleReportConfig:_vm.computedConfig,moduleName:_vm.moduleName,visibility:_vm.visibility.showEmailDialog,params:_vm.params,report:_vm.reportObject?_vm.reportObject.report:{},name:_vm.name,scheduledReportId:_vm.scheduledReportId,reportname:_vm.reportname},on:{"update:visibility":function($event){return _vm.$set(_vm.visibility,"showEmailDialog",$event)}}}):_vm._e(),_vm.visibility.showScheduleDialog?_c("schedule-report",{attrs:{moduleName:_vm.modulename,visibility:_vm.visibility.showScheduleDialog,report:_vm.reportObject?_vm.reportObject.report:{},scheduledReportId:_vm.scheduledReportId,reportname:_vm.reportname,isPivot:!0,name:_vm.name},on:{"update:visibility":function($event){return _vm.$set(_vm.visibility,"showScheduleDialog",$event)}}}):_vm._e(),_vm.isClone?_c("div",{staticClass:"dashboard-share dialog-box"},[_c("el-dialog",{staticClass:"fc-dialog-center-container pivot-share-dialog",attrs:{title:"Clone Report",visible:_vm.isClone,width:"35%","append-to-body":!0},on:{"update:visible":function($event){_vm.isClone=$event}}},[_c("div",[_c("div",{staticClass:"clonePopup"},[_c("el-form",{ref:"cloneDashboardForm",staticClass:"clone_dialog",attrs:{rules:_vm.rules,model:_vm.reportCloneObj}},[_c("el-form-item",{staticClass:"mB10",attrs:{label:"Report Name",prop:"name",required:!0}},[_c("el-input",{staticClass:"width300px fc-input-full-border2 pR15",model:{value:_vm.reportCloneObj.name,callback:function($$v){_vm.$set(_vm.reportCloneObj,"name",$$v)},expression:"reportCloneObj.name"}})],1),_vm.isCloneToAnotherApp?_c("el-form-item",{staticClass:"mB10",attrs:{label:"Target Application",prop:"name"}},[_c("el-select",{staticClass:"fc-input-full-border2 width300px pR15",attrs:{filterable:""},model:{value:_vm.reportCloneObj.selectedAppId,callback:function($$v){_vm.$set(_vm.reportCloneObj,"selectedAppId",$$v)},expression:"reportCloneObj.selectedAppId"}},_vm._l(_vm.apps,(function(app){return _c("el-option",{key:app.linkName,attrs:{label:app.name,value:app.id}})})),1)],1):_vm._e()],1)],1)]),_c("span",{staticClass:"dialog-footer row"},[_c("el-button",{staticClass:"col-6 shareoverbtn shrbtn1",on:{click:function($event){_vm.isClone=!1}}},[_vm._v(" "+_vm._s(_vm.$t("common._common.cancel"))+" ")]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.dashboardSaving},on:{click:function($event){return _vm.cloneReporttoAnotherApp(_vm.isCloneToAnotherApp)}}},[_vm._v(" "+_vm._s(_vm.$t("common._common._save"))+" ")])],1)])],1):_vm._e()],1)},staticRenderFns=[function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"default-image-container"},[_c("img",{staticClass:"default-image",attrs:{src:__webpack_require__(467886)}}),_c("a",[_vm._v("Learn more about Pivot Tables")])])}],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),PivotReportSideBar=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(434284),__webpack_require__(538077),__webpack_require__(659749),__webpack_require__(386544),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(902918),__webpack_require__(228436),__webpack_require__(670560),__webpack_require__(947522),__webpack_require__(212826),__webpack_require__(821479)),PivotSummaryNewvue_type_template_id_774bae08_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"pivot-report-summary  d-flex flex-direction-column white-background "},[_vm.exportDownloadUrl?_c("iframe",{staticStyle:{display:"none"},attrs:{src:_vm.exportDownloadUrl}}):_vm._e(),_c("div",{staticClass:"flex-grow pivot-wrapper"},[_c("PivotTableWrapper",{attrs:{reportId:_vm.id},on:{pivotReportLoaded:_vm.reportLoaded}})],1)])},PivotSummaryNewvue_type_template_id_774bae08_scoped_true_staticRenderFns=[],PivotTableWrapper=__webpack_require__(302347),api=__webpack_require__(32284),PivotSummaryNewvue_type_script_lang_js={mixins:[],props:["id"],components:{PivotTableWrapper:PivotTableWrapper/* default */.Z},data:function(){return{dateFilterObject:null,showPrintDetails:!1,reportContext:null,exportDownloadUrl:null,schedule:!1,email:!1,duplicateReportToggle:!1,renameDialogVisibility:!1,sendToDashBoard:!1}},computed:{moduleName:function(){return this.reportContext.module.name}},methods:{deleteReport:function(id){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var promptObj,deleteConfirmation,_API$post,data,error,confirmObj,widgetDeleteConfirm,resp;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return promptObj={title:"Delete Report",message:"Are you sure you want to delete this Report?",rbDanger:!0,rbLabel:"Delete"},_context.next=3,_this.$dialog.confirm(promptObj);case 3:if(deleteConfirmation=_context.sent,!deleteConfirmation){_context.next=24;break}if(_API$post=api/* API */.bl.post("/v2/report/deleteReport",{reportId:id}),data=_API$post.data,error=_API$post.error,!error){_context.next=10;break}_this.$message.error("Error deleting pivot report",error),
// API error on delete
_context.next=24;break;case 10:if(!data||!data.errorString){_context.next=22;break}
// Cannot delete as it's present in dashboard,confirm again
return confirmObj={title:"Delete Report",message:"This report is associated to a dashboard widget. Deleting this report will remove the widget from the dashboard. Are you sure you want to continue?",rbLabel:"Yes, delete",lbLabel:"No, cancel"},_context.next=14,_this.$dialog.confirm(confirmObj);case 14:if(widgetDeleteConfirm=_context.sent,!widgetDeleteConfirm){_context.next=20;break}return _context.next=18,api/* API */.bl.post("/v2/report/deleteReport",{reportId:id,deleteWithWidget:!0});case 18:resp=_context.sent,resp.error?_this.$message.error("Error deleting pivot report and widget",error):(_this.$emit("reportDeleted",{type:"new",reportId:id}),_this.$message.success("Report deleted successfully"));case 20:_context.next=24;break;case 22:_this.$emit("reportDeleted",{type:"new",reportId:id}),_this.$message.success("Report deleted successfully");case 24:case"end":return _context.stop()}}),_callee)})))()},duplicateReport:function(id){var path="/app/em/pivot/new?reportId=".concat(id,"&duplicate=true");this.$router.push({path:path})},editReport:function(id){var path="/app/em/pivot/new?reportId=".concat(id);this.$router.push({path:path})},reportLoaded:function(reportContext){var dateFilterObject=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.dateFilterObject=dateFilterObject,this.reportContext=reportContext,this.$emit("summaryLoaded",dateFilterObject)}}},pivot_PivotSummaryNewvue_type_script_lang_js=PivotSummaryNewvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(pivot_PivotSummaryNewvue_type_script_lang_js,PivotSummaryNewvue_type_template_id_774bae08_scoped_true_render,PivotSummaryNewvue_type_template_id_774bae08_scoped_true_staticRenderFns,!1,null,"774bae08",null)
/* harmony default export */,PivotSummaryNew=component.exports,EmailReportNew=__webpack_require__(853017),ScheduleReportNew=__webpack_require__(91699),element_ui_common=__webpack_require__(364720),newDashboardlayoutHelper=__webpack_require__(915552),router=__webpack_require__(329435),validation=__webpack_require__(990260),ModuleSelectDialogBoxViewPagevue_type_template_id_145aeb1b_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("base-dialog-box",{attrs:{visibility:_vm.visibility,onConfirm:_vm.saveModuleName,onCancel:_vm.closeDialog,disableCancel:!1,cancelText:"Cancel",confirmText:"Next",title:_vm.$t("pivot.moduleAnalyze"),width:"490px"},on:{"update:visibility":function($event){_vm.visibility=$event}}},[_c("div",{staticClass:"dialog-content-body",attrs:{slot:"body"},slot:"body"},[_c("el-row",{staticClass:"input-section"},[_c("el-col",{attrs:{span:8}},[_c("div",{staticClass:"module-text"},[_vm._v(" "+_vm._s(_vm.$t("pivot.name"))+" ")])]),_c("el-col",[_c("el-input",{staticClass:"fc-input-full-border-select2 name-field",model:{value:_vm.reportName,callback:function($$v){_vm.reportName=$$v},expression:"reportName"}}),!_vm.reportName&&_vm.validate?_c("div",{staticClass:"error-message"},[_vm._v(" Please enter Name ")]):_vm._e()],1)],1),_c("el-row",{staticClass:"input-section"},[_c("el-col",{attrs:{span:8}},[_c("div",{staticClass:"module-text description"},[_vm._v(" "+_vm._s(_vm.$t("pivot.description"))+" ")])]),_c("el-col",[_c("el-input",{staticClass:"description-area fc-input-full-border-select2 name-field",attrs:{type:"textarea",autosize:{minRows:2}},model:{value:_vm.description,callback:function($$v){_vm.description=$$v},expression:"description"}})],1)],1),_c("el-row",{staticClass:"input-section"},[_c("el-col",{attrs:{span:8}},[_c("div",{staticClass:"module-text"},[_vm._v(" "+_vm._s(_vm.$t("pivot.folder"))+" ")])]),_c("el-col",[_c("el-select",{staticClass:"fc-input-full-border2 width100",attrs:{filterable:!0,"allow-create":!0,placeholder:_vm.$t("pivot.click_enter_new_folder_name")},model:{value:_vm.folderId,callback:function($$v){_vm.folderId=$$v},expression:"folderId"}},_vm._l(_vm.reportFolders,(function(folder,idx){return _c("el-option",{key:idx,attrs:{label:folder.name,value:folder.id}})})),1),!_vm.folderId&&_vm.validate?_c("div",{staticClass:"error-message"},[_c("span",[_vm._v(" Click enter to add new folder")])]):_vm._e()],1)],1),_c("div",{staticClass:"module-select-heading"},[_vm._v("Choose data you want to analyse")]),_c("el-row",{staticClass:"input-section"},[_c("el-col",{attrs:{span:8}},[_c("div",{staticClass:"module-text"},[_vm._v(" "+_vm._s(_vm.$t("pivot.module"))+" ")])]),_c("el-col",[_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{filterable:"",placeholder:"Module Name","popper-class":"fc-group-select",loading:_vm.moduleLoading,"loading-text":_vm.$t("pivot.loading")},model:{value:_vm.moduleNameLocal,callback:function($$v){_vm.moduleNameLocal=$$v},expression:"moduleNameLocal"}},[_c("el-option-group",{attrs:{label:_vm.$t("pivot.systemModules")}},_vm._l(_vm.moduleOptions.systemModules,(function(module,index){return _c("el-option",{key:index,attrs:{label:module.displayName,value:module.name}})})),1),_vm.moduleOptions.customModules&&_vm.moduleOptions.customModules.length>0?_c("el-option-group",{attrs:{label:_vm.$t("pivot.customModules")}},_vm._l(_vm.moduleOptions.customModules,(function(module,index){return _c("el-option",{key:index,attrs:{label:module.displayName,value:module.name}})})),1):_vm._e()],1),!_vm.moduleNameLocal&&_vm.validate?_c("div",{staticClass:"error-message"},[_vm._v(" Please select Module ")]):_vm._e()],1)],1)],1)])],1)},ModuleSelectDialogBoxViewPagevue_type_template_id_145aeb1b_scoped_true_staticRenderFns=[],objectSpread2=__webpack_require__(595082),BaseDialogBox=__webpack_require__(503658),saveReportMixin=__webpack_require__(303783),vuex_esm=__webpack_require__(420629),ModuleSelectDialogBoxViewPagevue_type_script_lang_js={props:["visibility","moduleName"],components:{BaseDialogBox:BaseDialogBox/* default */.Z},computed:(0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({currentTab:function(state){return state.webtabs.selectedTab}})),mounted:function(){this.loadModuleOptions()},mixins:[saveReportMixin/* default */.Z],data:function(){return{moduleOptions:{},folderId:null,reportName:null,description:null,moduleLoading:!0,moduleNameLocal:null,validate:!1}},methods:{loadModuleOptions:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var params,_yield$API$get,data,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _this.moduleOptions.customModules=[],_this.moduleOptions.systemModules=[],params={},(0,router/* isWebTabsEnabled */.tj)()&&((0,validation/* isEmpty */.xb)(_this.currentTab)||(params["webTabId"]=_this.currentTab.id)),_context.next=6,api/* API */.bl.get("/v3/report/modules/list",params);case 6:_yield$API$get=_context.sent,data=_yield$API$get.data,error=_yield$API$get.error,error||(_this.moduleOptions.systemModules=data.systemModules,_this.moduleOptions.customModules=data.customModules,_this.moduleLoading=!1);case 10:case"end":return _context.stop()}}),_callee)})))()},closeDialog:function(){this.$emit("dialogClosed"),this.validate=!1},saveModuleName:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var url,_findRouteForTab,name;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if(_this2.getReportObject(),_this2.moduleNameLocal&&_this2.folderId&&_this2.reportName){_context2.next=4;break}return _this2.validate=!0,_context2.abrupt("return");case 4:url="/app/em/pivotbuilder/new",(0,router/* isWebTabsEnabled */.tj)()&&(_findRouteForTab=(0,router/* findRouteForTab */.OD)(router/* pageTypes */.As.PIVOT_FORM),name=_findRouteForTab.name,url=_this2.$router.resolve({name:name}).href),_this2.$router.push({path:url,query:{mName:_this2.moduleNameLocal,folderId:_this2.folderId,reportName:_this2.reportName,description:_this2.description?_this2.description:""}});case 7:case"end":return _context2.stop()}}),_callee2)})))()}}},Components_ModuleSelectDialogBoxViewPagevue_type_script_lang_js=ModuleSelectDialogBoxViewPagevue_type_script_lang_js,ModuleSelectDialogBoxViewPage_component=(0,componentNormalizer/* default */.Z)(Components_ModuleSelectDialogBoxViewPagevue_type_script_lang_js,ModuleSelectDialogBoxViewPagevue_type_template_id_145aeb1b_scoped_true_render,ModuleSelectDialogBoxViewPagevue_type_template_id_145aeb1b_scoped_true_staticRenderFns,!1,null,"145aeb1b",null)
/* harmony default export */,ModuleSelectDialogBoxViewPage=ModuleSelectDialogBoxViewPage_component.exports,User=__webpack_require__(426803),ReportTabPermissions=__webpack_require__(902040),Layoutvue_type_script_lang_js={mixins:[newDashboardlayoutHelper/* default */.Z,ReportTabPermissions/* default */.Z],props:["id"],data:function(){return{name:"pivot",reportObject:null,visibility:{showScheduleDialog:!1,showEmailDialog:!1},report_id:null,isClone:!1,reportCloneObj:{folder:null,selectedAppId:null,dashboard:null,name:null},rules:{folder:{required:!0,message:this.$t("common.placeholders.enter_folder_name")},name:{required:!0,message:this.$t("common.placeholders.enter_report_name"),trigger:"change"}},dashboardSaving:!1,isCloneToAnotherApp:!1,modulename:null,reportname:null,scheduledReportId:null,refreshPivotSummary:0,report:null,loading:!1,defaultPage:{summary:!1,sidebar:!1},showButtons:!1,moduleSlectVisibility:!1,leftPaneVisibility:!0,reportFolders:[],selected_folder_Obj:{folderName:"",folderId:null,folder:null},folderID:null,selected_report_name:"",reportList:[],isFolderClicked:!1,isReportPrevied:!1,isEmptyFolderView:!1,isFoldersEmpty:!1,searchText:"",updateReports:0,reportFetchError:!1,showMovePopOver:!1,currentFolder:{},exportDownloadUrl:null,visible:!0}},computed:{reportLoaded:function(){return!(0,validation/* isEmpty */.xb)(this.report)},reportFolderName:function(){var _this$reportFolders,_this=this;if(!this.report||!this.reportFolders)return"";var reportFolder=null===(_this$reportFolders=this.reportFolders)||void 0===_this$reportFolders?void 0:_this$reportFolders.find((function(f){return f.id===_this.report.reportFolderId}));return reportFolder.name},reportId:function(){return(0,router/* isWebTabsEnabled */.tj)()?this.isFolderClicked?null:this.$route.params.reportId:this.isFolderClicked?null:this.$route.params.id},reportFoldersList:function(){var _this2=this;if(null!==this&&void 0!==this&&this.reportList&&this.reportList.length>0&&this.reportList.filter((function(report){report.description||(report.description="--"),
// report.created_time = !isNaN(report.createdTime) ? Date(report.createdTime): '--'
report.created_by=report.createdBy?report.createdBy:"--",report.modified_time=isNaN(report.modifiedTime)?"--":Date(report.modifiedTime),report.modified_by=report.modifiedBy?report.modifiedBy:"--"})),(0,validation/* isEmpty */.xb)(this.searchText))return this.reportList;var filteredReports=this.reportList.filter((function(report){return report.name.toLowerCase().includes(_this2.searchText.toLowerCase())}));return(0,validation/* isEmpty */.xb)(filteredReports)?[]:filteredReports}},title:function(){return this.$t("pivot.documentTitle")},mounted:function(){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var _this3$$route,self,_this3$$route2;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _this3.availableApps(),self=_this3,_this3.initDefaultValues(),_context.next=5,_this3.loadReportFolders();case 5:_this3.$route.params.id?_this3.loadReport():null!==(_this3$$route=_this3.$route)&&void 0!==_this3$$route&&null!==(_this3$$route=_this3$$route.params)&&void 0!==_this3$$route&&_this3$$route.reportId?_this3.loadReport(null===(_this3$$route2=_this3.$route)||void 0===_this3$$route2||null===(_this3$$route2=_this3$$route2.params)||void 0===_this3$$route2?void 0:_this3$$route2.reportId):_this3.$route.query.folderId&&_this3.$refs["pivotReportSidebar"].collapseControl(_this3.$route.query.folderId),self.$route.path.endsWith("/view")&&self.openFirstFolder();case 7:case"end":return _context.stop()}}),_callee)})))()},watch:{id:function(){this.refreshPivotSummary++},report:{handler:function(newState){null!=newState&&(this.isFolderClicked=!1,this.leftPaneVisibility=!1)},immediate:!0}},components:{PivotReportSideBar:PivotReportSideBar["default"],PivotSummaryNew:PivotSummaryNew,EmailReport:EmailReportNew/* default */.Z,ScheduleReport:ScheduleReportNew/* default */.Z,ModuleSelectDialogBoxViewPage:ModuleSelectDialogBoxViewPage,UserAvatar:User/* default */.Z},created:function(){var id=this.id;(0,validation/* isEmpty */.xb)(id)||(this.leftPaneVisibility=!1)},methods:{
// loadPivotFolderManager(){
//   this.$router.push('/app/em/pivot/foldermanager')
// },
cloneReporttoAnotherApp:function(isCloneToAnotherPortal){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var reportObj,params,_yield$API$post,data,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if(reportObj=_this4.reportCloneObj,params=null,null!==reportObj&&void 0!==reportObj&&reportObj.name&&""!==(null===reportObj||void 0===reportObj?void 0:reportObj.name.trim())&&(null===reportObj||void 0===reportObj?void 0:reportObj.selectedAppId)>0&&(params={cloned_report_name:reportObj.name,target_app_id:reportObj.selectedAppId,cloned_app_id:_this4.cloned_app_id,report_id:_this4.report_id}),!params){_context2.next=12;break}return _this4.dashboardSaving=!0,_context2.next=7,api/* API */.bl.post("v3/report/pivot/clone",{data:params});case 7:_yield$API$post=_context2.sent,data=_yield$API$post.data,error=_yield$API$post.error,_this4.isClone=!1,!error&&null!==data&&void 0!==data&&data.cloned_report_name?_this4.$message.success("Report Cloned Successfully"):_this4.$message.error("Error while cloning report");case 12:_this4.dashboardSaving=!1;case 13:case"end":return _context2.stop()}}),_callee2)})))()},availableApps:function(){var _this5=this;api/* API */.bl.get("v2/application/list").then((function(_ref){var data=_ref.data,error=_ref.error;if(error)_this5.$message.error(error.message||"Error Occured");else{var _this5$apps;if(_this5.apps=data.application,(null===_this5||void 0===_this5||null===(_this5$apps=_this5.apps)||void 0===_this5$apps?void 0:_this5$apps.length)>1&&(_this5.isShowCloneToAnotherApp=!0),_this5.appId=((0,router/* getApp */.wx)()||{}).id,(0,validation/* isEmpty */.xb)(_this5.appId)){var defaultApp=_this5.apps.find((function(app){return"newapp"===app.linkName}))||_this5.apps[0];_this5.appId=defaultApp.id,_this5.reportCloneObj.selectedAppId=_this5.appId}_this5.reportCloneObj.selectedAppId=_this5.appId,_this5.loadDashboards(!0,_this5.appId)}}))},openClonePopup:function(id,name,isCloneToAnotherApp){this.isClone=!0,this.report_id=id,this.reportCloneObj.name=name,this.isCloneToAnotherApp=isCloneToAnotherApp||!1,this.isCloneToAnotherApp=!0},openFirstFolder:function(){this.$refs["pivotReportSidebar"].folderClicked(this.currentFolder)},handleBackButton:function(){this.leftPaneVisibility||(this.isFolderClicked=!0,this.isReportPrevied=!1),this.leftPaneVisibility=!this.leftPaneVisibility;var route_url="/app/em/pivot/view?folderId=".concat(this.currentFolder.id);if((0,router/* isWebTabsEnabled */.tj)()){var _findRouteForTab=(0,router/* findRouteForTab */.OD)(router/* pageTypes */.As.PIVOT_VIEW),name=_findRouteForTab.name;route_url=this.$router.resolve({name:name,query:{folderId:this.selected_folder_Obj.folderId}}).href}history.replaceState({},"",window.location.origin+route_url)},openFolder:function(){this.isReportPrevied=!1;var url="/app/em/pivot/view?folderId="+this.selected_folder_Obj.folderId;if((0,router/* isWebTabsEnabled */.tj)()){var _findRouteForTab2=(0,router/* findRouteForTab */.OD)(router/* pageTypes */.As.PIVOT_VIEW),name=_findRouteForTab2.name;url=this.$router.resolve({name:name,query:{folderId:this.selected_folder_Obj.folderId}}).href}this.$router.push(url),this.reportList=this.selected_folder_Obj.folder.reports,this.isFolderClicked=!0},initDefaultValues:function(){!1===this.isReportPrevied&&!1===this.isFolderClicked?this.isEmptyFolderView=!0:this.isEmptyFolderView=!1},handleReportDelete:function(obj){this.$refs["pivotReportSidebar"]&&this.$refs["pivotReportSidebar"].updateReports(obj)},view:function(row){},defaultPageToggle:function(val){1==val?this.defaultPage.sidebar=!0:2==val&&(this.defaultPage.summary=!0)},closePopover:function(){var popper=document.querySelectorAll(".el-popover");popper.forEach((function(pop){pop.remove()}))},Schedulereport:function(id,name,repname){this.visibility.showScheduleDialog=!0,this.scheduledReportId=id,this.modulename=name,this.reportname=repname},sendmail:function(id,name,repname){this.visibility.showEmailDialog=!0,this.scheduledReportId=id,this.modulename=name,this.reportname=repname},exportReport:function(type,id){var _this6=this;this.closePopover(),this.$message({message:"Exporting as "+this.$constants.FILE_FORMAT[type],showClose:!0,duration:0});var url="/v2/report/exportPivotReport",params={reportId:id.toString(),fileFormat:"".concat(type)};if(this.$refs["PivotSummaryNew"]){var dateFilterObject=this.$refs["PivotSummaryNew"].dateFilterObject;(0,validation/* isEmpty */.xb)(dateFilterObject)||(0,validation/* isEmpty */.xb)(dateFilterObject.value)||(params["startTime"]=dateFilterObject.value[0],params["endTime"]=dateFilterObject.value[1])}api/* API */.bl.post(url,params).then((function(response){element_ui_common.Message.closeAll(),response.data&&(_this6.exportDownloadUrl=response.data.fileUrl)}))},handleMoveFolder:function(newFolder,report){this.closePopover(),this.$refs["pivotReportSidebar"].moveReport(this.currentFolder,newFolder,report),this.handleReportDelete(report)},reportChanged:function(report){var _this$reportFolders2,_this7=this;this.isFolderClicked=!1,this.isReportPrevied=!0,this.leftPaneVisibility=-0,this.report=report;var reportFolder=null===(_this$reportFolders2=this.reportFolders)||void 0===_this$reportFolders2?void 0:_this$reportFolders2.find((function(f){return f.id===_this7.report.reportFolderId}));this.selected_report_name=report.name,this.selected_folder_Obj.folderName=reportFolder.name,this.selected_folder_Obj.folderId=reportFolder.id,this.selected_folder_Obj.folder=reportFolder},folderReportView:function(folder){var _this8=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_this8.currentFolder=folder,_this8.selected_folder_Obj.folderName=folder.name,_this8.selected_folder_Obj.folderId=folder.id,_this8.selected_folder_Obj.folder=folder,_this8.reportList=folder.reports,_this8.folderID!=folder.id?(_this8.isEmptyFolderView=!1,_this8.isReportPrevied=!1,_this8.isFolderClicked=!0,_this8.folderID=folder.id):(_this8.folderID=folder?folder.id:null,_this8.isFolderClicked=!0,_this8.isReportPrevied=!1,_this8.isEmptyFolderView=!1,_this8.report=null);case 6:case"end":return _context3.stop()}}),_callee3)})))()},loadReportFolders:function(){var _this9=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){var url,self;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:
// no module name case is energy data reports, DON't send moduleName prop as energydata.;leave null for energreports
return url="/v3/report/folders?moduleName=energydata",self=_this9,//pivot
url+="&isPivot=true",_context4.next=5,api/* API */.bl.get(url).then((function(response){response.error||(self.reportFolders=response.data.reportFolders)}));case 5:case"end":return _context4.stop()}}),_callee4)})))()},handleCommand:function(command,isCloneToAnotherApp,row){var report=row||this.report;"delete"==command?this.deleteReport(report):"duplicate"==command?this.duplicateReport(report):"move"==command?this.showMovePopOver=!0:"Mail"==command?this.sendmail(report.id,report.module.name,report.name):"CloneReport"==command?this.openClonePopup(report.id,report.name,isCloneToAnotherApp):"Schedule"==command&&(row?this.Schedulereport(row.id,row.module.name,row.name):this.Schedulereport(report.id,report.module.name,report.name))},openReportDetails:function(row){var _this10=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee5(){var route_url,_findRouteForTab3,name;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context5){while(1)switch(_context5.prev=_context5.next){case 0:_this10.loading=!0,route_url="/app/em/pivot/view/".concat(row.id),(0,router/* isWebTabsEnabled */.tj)()&&(_findRouteForTab3=(0,router/* findRouteForTab */.OD)(router/* pageTypes */.As.PIVOT_VIEW),name=_findRouteForTab3.name,route_url=_this10.$router.resolve({name:name,params:{reportId:row.id}}).href),_this10.$router.push(route_url),_this10.loadReport(row.id,!0),_this10.leftPaneVisibility=!1;case 6:case"end":return _context5.stop()}}),_callee5)})))()},loadReport:function(rowId,control_folder){var _this11=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee6(){var reportId,selected_report_folder;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context6){while(1)switch(_context6.prev=_context6.next){case 0:if(reportId=rowId||_this11.$route.params.id,_this11.isReportPrevied=!!reportId,_this11.isFolderClicked=!1,_this11.folderID=null,_this11.initDefaultValues(),selected_report_folder=_this11.reportFolders.filter((function(report_folder){if(report_folder&&report_folder.reports&&report_folder.reports.length){var selected_report=report_folder.reports.find((function(report){return report.id===parseInt(reportId)}));if(selected_report&&selected_report.id)return _this11.selected_report_name=selected_report.name,_this11.report=selected_report,report_folder}})),selected_report_folder&&selected_report_folder.length&&(_this11.selected_folder_Obj.folderName=selected_report_folder[0].name,_this11.selected_folder_Obj.folderId=selected_report_folder[0].id,_this11.selected_folder_Obj.folder=selected_report_folder[0],_this11.folderID=selected_report_folder[0].id),_this11.loading=!1,!control_folder)try{_this11.$refs["pivotReportSidebar"].collapseControl(_this11.folderID)}catch(_unused){}case 9:case"end":return _context6.stop()}}),_callee6)})))()},deleteReport:function(row){var _this12=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee7(){var id,promptObj,deleteConfirmation,_yield$API$post2,data,error,confirmObj,widgetDeleteConfirm,resp;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context7){while(1)switch(_context7.prev=_context7.next){case 0:return id=row.id,promptObj={title:"Delete Report",message:"Are you sure you want to delete this Report?",rbDanger:!0,rbLabel:"Delete"},_context7.next=4,_this12.$dialog.confirm(promptObj);case 4:if(deleteConfirmation=_context7.sent,!deleteConfirmation){_context7.next=34;break}return _context7.next=8,api/* API */.bl.post("/v2/report/deleteReport",{reportId:id||_this12.reportId});case 8:if(_yield$API$post2=_context7.sent,data=_yield$API$post2.data,error=_yield$API$post2.error,!error){_context7.next=15;break}_this12.$message.error("Error deleting pivot report",error),
// API error on delete
_context7.next=34;break;case 15:if(!data||!data.errorString){_context7.next=27;break}
// Cannot delete as it's present in dashboard,confirm again
return confirmObj={title:"Delete Report",message:"This report is associated to a dashboard widget. Deleting this report will remove the widget from the dashboard. Are you sure you want to continue?",rbLabel:"Yes, delete",lbLabel:"No, cancel"},_context7.next=19,_this12.$dialog.confirm(confirmObj);case 19:if(widgetDeleteConfirm=_context7.sent,!widgetDeleteConfirm){_context7.next=25;break}return _context7.next=23,api/* API */.bl.post("/v2/report/deleteReport",{reportId:_this12.reportId,deleteWithWidget:!0});case 23:resp=_context7.sent,resp.error?_this12.$message.error("Error deleting pivot report and widget",error):(_this12.$emit("reportDeleted",{type:"new",reportId:_this12.reportId}),_this12.$message.success("Report deleted successfully"));case 25:_context7.next=34;break;case 27:_this12.$emit("reportDeleted",{type:"new",reportId:_this12.reportId}),_this12.$message.success("Report deleted successfully"),_this12.report=null,_this12.isFolderClicked=!0,_this12.isReportPrevied=!1,_this12.leftPaneVisibility=!0,_this12.handleReportDelete(row);case 34:case"end":return _context7.stop()}}),_callee7)})))()},duplicateReport:function(row){var id=row.id,path="/app/em/pivotbuilder/new?reportId=".concat(id||this.reportId,"&duplicate=true");if((0,router/* isWebTabsEnabled */.tj)()){var _findRouteForTab4=(0,router/* findRouteForTab */.OD)(router/* pageTypes */.As.PIVOT_FORM),name=_findRouteForTab4.name;path=this.$router.resolve({name:name,query:{reportId:id||this.reportId,duplicate:!0}}).href}this.$router.push({path:path})},editReport:function(row){this.isFolderClicked=!1;var id=row.id,path="/app/em/pivotbuilder/new?reportId=".concat(id||this.reportId);if((0,router/* isWebTabsEnabled */.tj)()){var _findRouteForTab5=(0,router/* findRouteForTab */.OD)(router/* pageTypes */.As.PIVOT_FORM),name=_findRouteForTab5.name;path=this.$router.resolve({name:name,query:{reportId:id||this.reportId}}).href}this.$router.push({path:path})}}},pivot_Layoutvue_type_script_lang_js=Layoutvue_type_script_lang_js,Layout_component=(0,componentNormalizer/* default */.Z)(pivot_Layoutvue_type_script_lang_js,render,staticRenderFns,!1,null,"1023f960",null)
/* harmony default export */,Layout=Layout_component.exports},
/***/821479:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return PivotReportSideBar}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/energy/pivot/PivotReportSideBar.vue?vue&type=template&id=6128198d
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("div",{staticClass:"pivot-reports-sidebar"},[_c("div",{staticClass:"report-header-section"},[_c("div",{staticClass:"pivot-report-title flex-middle"},[_c("div",{staticClass:"pivot-summary-all-pivots"},[_c("el-popover",{attrs:{placement:"bottom-start",width:"185",trigger:"click"}},[_c("div",{staticStyle:{display:"flex","align-items":"center","margin-top":"10px"}},[_c("img",{staticClass:"report-icon flex icon",staticStyle:{height:"14px",width:"14px","margin-left":"2px","margin-right":"8px"},attrs:{src:__webpack_require__(598685)}}),_c("span",{staticStyle:{cursor:"pointer"},on:{click:_vm.loadScheduleReports}},[_vm._v("Scheduled Reports")])]),_c("div",{staticStyle:{display:"flex","align-items":"center","margin-top":"10px"}},[_c("InlineSvg",{staticStyle:{"margin-top":"4px","margin-right":"5px"},attrs:{src:"svgs/pivot/Manage",iconClass:"icon icon-sm"}}),_c("span",{staticStyle:{cursor:"pointer"},on:{click:_vm.loadPivotFolderManager}},[_vm._v("Manage Folders")])],1),_c("span",{staticStyle:{"letter-spacing":"0.5px",cursor:"pointer"},attrs:{slot:"reference"},on:{click:function($event){_vm.visible=!_vm.visible}},slot:"reference"},[_vm._v("Folders"),_c("i",{staticClass:"el-icon-arrow-down",staticStyle:{"font-size":"13px","font-weight":"1000","margin-left":"4px",cursor:"pointer","text-transform":"capitalize"}})])])],1)])]),_c("div",{staticClass:"search-container mT15 mB25 pR10 pL10"},[_c("el-input",{staticClass:"fc-input-full-border2 pL5",attrs:{placeholder:"Search",type:"search","prefix-icon":"el-icon-search"},model:{value:_vm.searchText,callback:function($$v){_vm.searchText=$$v},expression:"searchText"}})],1),_c("div",{staticClass:"rtree"},[_c("div",{staticClass:"report-sidebar-scroll"},[_vm.loading?_c("spinner",{attrs:{show:_vm.loading}}):_c("div",[_vm.newReportTree.length||_vm.reportTree.length?_vm._e():_c("div",{staticClass:"p15 flex-middle height80vh justify-content-center flex-direction-column"},[_c("div",[_c("inline-svg",{attrs:{src:"svgs/emptystate/reportlist",iconClass:"icon text-center icon-xxxlg"}})],1),_c("div",{staticClass:"nowo-label"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.no_reports"))+" ")])]),_vm.newReportTree?_c("div",{staticClass:"pB100 folder-list-container"},_vm._l(_vm.reportFoldersList,(function(folder,index2){return _c("div",{key:"new_"+index2,staticClass:"folder-container",attrs:{id:""+folder.id}},[_c("el-collapse",{attrs:{accordion:""},model:{value:_vm.expandFolder,callback:function($$v){_vm.expandFolder=$$v},expression:"expandFolder"}},[_c("el-collapse-item",{attrs:{name:folder.id}},[_c("template",{slot:"title"},[_c("div",{staticClass:"folder-title-section",on:{click:function($event){return $event.stopPropagation(),function(e){return _vm.folderClicked(folder,e)}.apply(null,arguments)}}},[_c("div",{staticClass:"report-folder-icon-section"},[_c("img",{attrs:{src:__webpack_require__(995637)}})]),_c("div",{staticClass:"r-folder-name"},[_vm._v(" "+_vm._s(folder.name)+" ")])])]),_c("draggable",{staticClass:"rfolder-children",attrs:{options:{group:"report"}},model:{value:folder.reports,callback:function($$v){_vm.$set(folder,"reports",$$v)},expression:"folder.reports"}},[folder.reports.length?_vm._e():_c("div",{staticClass:"rempty",staticStyle:{"margin-left":"30px"}},[_vm._v(" -- "+_vm._s(_vm.$t("common.wo_report.no_reports"))+" -- ")])])],2)],1)],1)})),0):_vm._e()])],1)])]),_vm.showDialog?_c("div",[_vm.showDialog?_c("f-dialog",{attrs:{visible:_vm.showDialog,width:"30%",confirmTitle:_vm.$t("common._common._save"),stayOnSave:!0,customClass:"qr-dialog"},on:{"update:visible":function($event){_vm.showDialog=$event},save:function($event){return _vm.addFolderPermission()},close:function($event){_vm.showDialog=!1}}},[_c("div",{staticClass:"fc-setup-modal-title"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.sharing_permission"))+" ")]),_c("div",{staticClass:"mT10"},[_c("div",[_c("el-radio",{staticClass:"fc-radio-btn pB10 pT10",attrs:{label:1},model:{value:_vm.shareTo,callback:function($$v){_vm.shareTo=$$v},expression:"shareTo"}},[_vm._v(_vm._s(_vm.$t("common.wo_report.only_me")))])],1),_c("div",[_c("el-radio",{staticClass:"fc-radio-btn pB10",attrs:{label:2},model:{value:_vm.shareTo,callback:function($$v){_vm.shareTo=$$v},expression:"shareTo"}},[_vm._v(_vm._s(_vm.$t("common.wo_report.everyone")))])],1),_c("div",[_c("el-radio",{staticClass:"fc-radio-btn pB10",attrs:{label:3},model:{value:_vm.shareTo,callback:function($$v){_vm.shareTo=$$v},expression:"shareTo"}},[_vm._v(_vm._s(_vm.$t("common.wo_report.specific")))])],1),3===_vm.shareTo?_c("el-row",{staticClass:"mT20 el-select-block"},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"label-txt-black pB5"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.team"))+" ")]),_c("el-select",{staticClass:"width100 fc-full-border-select-multiple2",attrs:{filterable:"",multiple:"","collapse-tags":"",placeholder:_vm.$t("common.wo_report.choose_users")},model:{value:_vm.sharedGroups,callback:function($$v){_vm.sharedGroups=$$v},expression:"sharedGroups"}},_vm._l(_vm.groups,(function(group){return _c("el-option",{key:group.id,attrs:{label:group.name,value:group.id}})})),1)],1)],1):_vm._e(),3===_vm.shareTo?_c("el-row",{staticClass:"mT20 el-select-block"},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"label-txt-black pB5"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.role"))+" ")]),_c("el-select",{staticClass:"width100 fc-full-border-select-multiple2",attrs:{filterable:"",multiple:"","collapse-tags":"",placeholder:_vm.$t("common.wo_report.choose_roles")},model:{value:_vm.sharedRoles,callback:function($$v){_vm.sharedRoles=$$v},expression:"sharedRoles"}},_vm._l(_vm.roles,(function(role){return _c("el-option",{key:role.id,attrs:{label:role.name,value:role.id}})})),1)],1)],1):_vm._e(),3===_vm.shareTo?_c("el-row",{staticClass:"mT20 el-select-block"},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"label-txt-black pB5"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.staff"))+" ")]),_c("el-select",{staticClass:"width100 fc-full-border-select-multiple2",attrs:{filterable:"",multiple:"","collapse-tags":"",placeholder:_vm.$t("common.wo_report.choose_teams")},model:{value:_vm.sharedUsers,callback:function($$v){_vm.sharedUsers=$$v},expression:"sharedUsers"}},_vm._l(_vm.users,(function(user){return _c("el-option",{key:user.id,attrs:{label:user.name,value:user.id}})})),1)],1)],1):_vm._e()],1),_c("div",{staticStyle:{padding:"25px 0px"}})]):_vm._e()],1):_vm._e()])},staticRenderFns=[],createForOfIteratorHelper=__webpack_require__(566347),objectSpread2=__webpack_require__(595082),vuedraggable_umd=(__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(670560),__webpack_require__(538077),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(434284),__webpack_require__(162506),__webpack_require__(450886),__webpack_require__(425728),__webpack_require__(564043),__webpack_require__(857267),__webpack_require__(909980)),vuedraggable_umd_default=__webpack_require__.n(vuedraggable_umd),ReportHelper=__webpack_require__(507815),FDialogNew=__webpack_require__(436756),vuex_esm=__webpack_require__(420629),validation=__webpack_require__(990260),api=__webpack_require__(32284),router=__webpack_require__(329435),PivotReportSideBarvue_type_script_lang_js={props:["isPivot"],mixins:[ReportHelper/* default */.Z],components:{draggable:vuedraggable_umd_default(),FDialog:FDialogNew/* default */.Z},data:function(){return{loading:!0,shareTo:2,reportSharing:[],sharedGroups:[],sharedUsers:[],sharedRoles:[],reportTree:[],showDialog:!1,newReportTree:[],newFolderName:"",folderShow:!1,folderState:{},editFolderId:null,reportFolderId:null,ids:[],searchText:"",expandFolder:[],visible:!1}},created:function(){this.$store.dispatch("loadRoles"),this.$store.dispatch("loadGroups"),this.$store.dispatch("loadUsers")},watch:{moduleName:{handler:function(){this.loadNewReportTree(),this.loadReportTree()},immediate:!0},newReportTree:{handler:function(newState){0==newState.length?this.$emit("foldersEmpty"):this.$emit("foldersNotEmpty")}}},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({groups:function(state){return state.groups},users:function(state){return state.users},roles:function(state){return state.roles}})),(0,vuex_esm/* mapGetters */.Se)(["getCurrentUser"])),{},{moduleName:function(){var _ref=this.$route.meta||{},moduleName=_ref.module;return(0,validation/* isEmpty */.xb)(moduleName)&&(moduleName=this.$attrs.moduleName),moduleName},reportFoldersList:function(){var _this=this;return this.expandFolder=[],(0,validation/* isEmpty */.xb)(this.searchText)?this.newReportTree:(this.newReportTree.forEach((function(folder){_this.expandFolder.push(folder.id)})),this.newReportTree.reduce((function(res,folder){var filteredReports=folder.reports.filter((function(report){return report.name.toLowerCase().includes(_this.searchText.toLowerCase())}));return(0,validation/* isEmpty */.xb)(filteredReports)||res.push((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},folder),{},{reports:filteredReports})),res}),[]))},createPermission:function(){var moduleName=this.moduleName;return(0,router/* isWebTabsEnabled */.tj)()&&moduleName||(moduleName=(this.getCurrentModule()||{}).module),"energydata"===moduleName&&(moduleName="energy"),!["workorder","alarm","energy"].includes(moduleName)||this.$hasPermission(moduleName+":CREATE_EDIT_REPORTS")},isModuleReport:function(){var moduleName=this.moduleName;return(0,router/* isWebTabsEnabled */.tj)()&&moduleName||(moduleName=(this.getCurrentModule()||{}).module),moduleName&&"energydata"!==moduleName},reportId:function(){var reportId=this.$route.params.id&&!isNaN(this.$route.params.id)?parseInt(this.$route.params.id):null;return reportId&&reportId>0?reportId:this.$attrs.reportid?parseInt(reportId):null}}),methods:{loadPivotFolderManager:function(){if((0,router/* isWebTabsEnabled */.tj)()){var _findRouteForTab=(0,router/* findRouteForTab */.OD)(router/* pageTypes */.As.PIVOT_VIEW_MANAGER),name=_findRouteForTab.name;this.$router.push({path:this.$router.resolve({name:name}).href,query:{activeTab:"folderViews"}})}else this.$router.push("/app/em/pivot/foldermanager?activeTab=folderViews")},loadScheduleReports:function(){if((0,router/* isWebTabsEnabled */.tj)()){var _findRouteForTab2=(0,router/* findRouteForTab */.OD)(router/* pageTypes */.As.PIVOT_VIEW_MANAGER),name=_findRouteForTab2.name;this.$router.push({path:this.$router.resolve({name:name}).href,query:{activeTab:"ScheduleViews"}})}else this.$router.push("/app/em/pivot/foldermanager?activeTab=ScheduleViews")},collapseControl:function(id){-1!==this.expandFolder.indexOf(id)||isNaN(id)?isNaN(id)||this.expandFolder.splice(this.expandFolder.indexOf(id),1):this.expandFolder.push(parseInt(id));
// if (this.expandFolder.find(f => f == id) == -1) this.expandFolder.push(id)
},
// folderSelected(event){
//   let heading=event.target.closest('.el-collapse-item__header')
//   heading.classList.add('is-active')
//   console.log(headiing)
// },
folderClicked:function(folder,event){this.toggleIsActive();//removes highlight for previously selected folder
var activeFolder=document.getElementById("".concat(folder.id));activeFolder.classList.add("selected-folder");var pivot_reports_list_sidebar=this.$refs["pivot_reports_list_sidebar"];pivot_reports_list_sidebar&&pivot_reports_list_sidebar.length>0&&pivot_reports_list_sidebar.forEach((function(report_list_active){report_list_active.classList.remove("active")}));var route_url="/app/em/pivot/view?folderId=".concat(folder.id);if((0,router/* isWebTabsEnabled */.tj)()){var _findRouteForTab3=(0,router/* findRouteForTab */.OD)(router/* pageTypes */.As.PIVOT_VIEW),name=_findRouteForTab3.name;route_url=this.$router.resolve({name:name,query:{folderId:folder.id}}).href}history.replaceState({},"",window.location.origin+route_url),this.$emit("folderClicked",folder),this.$emit("clearReport")},updateReports:function(report){this.newReportTree.forEach((function(folder){return folder.reports.forEach((function(r,index,reports){r.id==report.id&&reports.splice(index,1)}))}))},showPermissionDialig:function(folder){if(this.sharedGroups=[],this.sharedUsers=[],this.sharedRoles=[],folder&&folder.reportSharing&&folder.reportSharing.length>0){if(folder.reportSharing.length>1){this.shareTo=3;var _step,_iterator=(0,createForOfIteratorHelper/* default */.Z)(folder.reportSharing);try{for(_iterator.s();!(_step=_iterator.n()).done;){var sharing=_step.value;1===sharing.type?this.sharedUsers.push(sharing.userId):2===sharing.type?this.sharedRoles.push(sharing.roleId):3===sharing.type&&this.sharedGroups.push(sharing.groupId)}}catch(err){_iterator.e(err)}finally{_iterator.f()}}else 1===folder.reportSharing.length&&folder.reportSharing[0].userId===this.getCurrentUser().ouid&&(this.shareTo=1);for(var i=0;i<folder.reportSharing.length;i++)this.ids.push(folder.reportSharing[i].id)}else this.shareTo=2;this.reportFolderId=folder.id,this.showDialog=!0},addFolderPermission:function(){var _this2=this,self=this,moduleName=this.getCurrentModule().module;this.applySharing();var apiUrl=null;return apiUrl="undefined"!==typeof moduleName&&moduleName?"/v3/report/folder/permission/update?moduleName="+moduleName:"/v3/report/folder/permission/update?moduleName=energydata",new Promise((function(resolve,reject){var a={reportFolder:{reportSharing:_this2.reportSharing,ids:_this2.ids},folderId:_this2.reportFolderId};api/* API */.bl.put(apiUrl,a).then((function(response){response.error||(self.loadNewReportTree(),self.showDialog=!1)})).catch((function(error){error&&reject(error)}))}))},applySharing:function(){var self=this;if(this.reportSharing=[],1===self.shareTo)this.reportSharing.push({type:1,userId:self.getCurrentUser().ouid});else if(3===self.shareTo){if(self.sharedUsers.length>0){this.reportSharing.push({type:1,userId:self.getCurrentUser().ouid});for(var i=0;i<self.sharedUsers.length;i++)self.sharedUsers[i]!==self.getCurrentUser().ouid&&this.reportSharing.push({type:1,userId:self.sharedUsers[i]})}if(self.sharedRoles.length>0)for(var _i=0;_i<self.sharedRoles.length;_i++)this.reportSharing.push({type:2,roleId:self.sharedRoles[_i]});if(self.sharedGroups.length>0)for(var _i2=0;_i2<self.sharedGroups.length;_i2++)this.reportSharing.push({type:3,groupId:self.sharedGroups[_i2]})}},toggleEditFolder:function(folder){var _this3=this;this.editFolderId=folder.id,this.$nextTick((function(){Array.isArray(_this3.$refs["FolderName"])?_this3.$refs["FolderName"][0].focus():_this3.$refs["FolderName"].focus()}))},editFolderName:function(folder){var _this4=this,newName=this.folderState[folder.id].newName;if(""!==newName&&null!==newName){var reportFolder={};reportFolder["name"]=newName,reportFolder["id"]=folder.id,this.editFolderId=null,api/* API */.bl.put("/v3/report/folder/update",{reportFolder:reportFolder}).then((function(response){response.error?(_this4.$message({message:_this4.$t("common.wo_report.cannot_rename_folder"),type:"error"}),folder.name=_this4.folderState[folder.id].name):(folder.name=response.data.reportFolder.name,_this4.folderState[folder.id].name=folder.name,_this4.folderState[folder.id].newName=folder.name)})).catch((function(){_this4.$message({message:_this4.$t("common.wo_report.cannot_rename_folder"),type:"error"}),folder.name=_this4.folderState[folder.id].name}))}else this.$message({message:this.$t("common.wo_report.foldername_cannot_empty"),type:"error"});this.$forceUpdate()},addNewFolder:function(){var _this5=this,newFolder={};if(""===this.newFolderName||null===this.newFolderName)this.newFolderError=!0;else{newFolder["name"]=this.newFolderName;var moduleName=this.getCurrentModule().module;this.folderShow=!1,api/* API */.bl.post("/v3/report/folder/create",{reportFolder:newFolder,moduleName:moduleName}).then((function(response){if(response.error)_this5.$message.error("Error while creating report folder");else{_this5.newFolderName="";var _newFolder=response.data.reportFolder;_newFolder.reports=[],_this5.newReportTree.push(_newFolder);var folderState={};folderState["name"]=_newFolder.name,folderState["newName"]=_newFolder.name,folderState["setting"]=!1,_this5.folderState[_newFolder.id]=folderState}}))}},moveReport:function(currentFolder,newFolder,report){var curIndex,newIndex,reportIndex,_this6=this;for(var key in this.$set(this.folderState[currentFolder.id],"setting",!1),this.newReportTree)this.newReportTree[key].name===currentFolder.name&&(curIndex=key,reportIndex=this.newReportTree[key].reports.indexOf(report)),this.newReportTree[key].name===newFolder.name&&(newIndex=key);api/* API */.bl.put("/v3/report/moveto",{reportId:report.id,folderId:newFolder.id}).then((function(response){_this6.newReportTree[curIndex].reports.splice(reportIndex,1),_this6.newReportTree[newIndex].reports.push(report)})).catch((function(){_this6.$message({message:_this6.$t("common.wo_report.cannot_move_report"),type:"error"})}))},loadReportTree:function(){var self=this,moduleName=this.$route.query.module?this.$route.query.module:this.getCurrentModule().module;"energy"===moduleName&&(moduleName="energyData"),"custom"!==moduleName&&self.$http.get("/report/workorder/getAllWorkOrderReports?moduleName="+moduleName).then((function(response){var data=response.data.allWorkOrderJsonReports,treeData=data.map((function(d){if(d.expand=!1,self.reportId){var report=d.children.find((function(rt){return rt.widget.dataOptions.reportId===self.reportId}));report&&(d.expand=!0)}return d}));self.reportTree=treeData.filter((function(row){return"Default"!==row.label&&"Old Reports"!==row.label}))}))},loadNewReportTree:function(){var _this7=this,self=this,moduleName=this.getCurrentModule().module;this.$route.query.module&&(moduleName=this.$route.query.module),"energy"===moduleName&&(moduleName="energyData");var url="/v3/report/folders?moduleName="+moduleName;"custom"===moduleName&&(url="/v3/report/folders?moduleName=custommodule"),this.isPivot&&(url+="&isPivot=true"),api/* API */.bl.get(url).then((function(resp){if(resp.error)self.loading=!1;else{var data=resp.data.reportFolders,treeData=data.map((function(d){if(d.expand=!1,self.reportId){var report=d.reports.find((function(rt){return rt.id===self.reportId}));report&&(d.expand=!0)}return d}));if(self.newReportTree=treeData,_this7.$route.query.folderId){
// this.expandFolder.push(parseInt(this.$route.query.folderId))
var folder=_this7.newReportTree.find((function(f){return f.id==parseInt(_this7.$route.query.folderId)}));_this7.$emit("folderClicked",folder)}else self.newReportTree.length>0&&
// this.expandFolder.push(self.newReportTree[0].id)
_this7.$emit("folderClicked",self.newReportTree[0]);for(var key in self.loading=!1,self.newReportTree){var _folder=self.newReportTree[key],folderState={};folderState["name"]=_folder.name,folderState["newName"]=_folder.name,folderState["setting"]=!1,folderState["editFolder"]=!1,self.folderState[_folder.id]=folderState}}})),this.$emit("sidebarLoaded")},openFirstReport:function(){var reportLink;this.loading||this.reportId||this.$route.path.includes("scheduled")||(this.newReportTree.length&&this.newReportTree[0].reports.length?(this.newReportTree[0].expand=!0,reportLink=this.getNewReportLink(this.newReportTree[0].reports[0].id)):this.reportTree.length&&this.reportTree[0].children.length&&(this.reportTree[0].expand=!0,reportLink=this.getReportLink(this.reportTree[0].children[0].widget.dataOptions.reportId)),(0,validation/* isEmpty */.xb)(reportLink)||this.$router.replace({path:reportLink}))},isActiveReport:function(report){return this.toggleIsActive(),this.reportId===report.id},loadReport:function(report){var reportLink=this.getNewReportLink(report.id);this.$emit("reportChanged",report),this.$route.params.id!=report.id&&this.$router.replace({path:reportLink}),this.toggleIsActive()},toggleIsActive:function(){var headers=document.querySelectorAll("div.is-active");headers.forEach((function(h){return h.classList.remove("is-active")}));var prevActiveFolders=document.querySelectorAll(".selected-folder");prevActiveFolders.forEach((function(af){var _af$classList;return null===af||void 0===af||null===(_af$classList=af.classList)||void 0===_af$classList?void 0:_af$classList.remove("selected-folder")}))},removeReport:function(obj){var reportsType=obj.type,reportId=obj.reportId;if("new"===reportsType){if(this.newReportTree){var _step2,_iterator2=(0,createForOfIteratorHelper/* default */.Z)(this.newReportTree);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var folder=_step2.value,rep=folder.reports.find((function(rt){return rt.id===parseInt(reportId)}));if(rep){var reportIndex=folder.reports.indexOf(rep);if(reportIndex>=0){if(folder.reports.splice(reportIndex,1),reportIndex<folder.reports.length){var reportLink=this.getNewReportLink(folder.reports[reportIndex].id);return void this.$router.replace({path:reportLink})}if(reportIndex-1<folder.reports.length){var _reportLink=this.getNewReportLink(folder.reports[reportIndex-1].id);return void this.$router.replace({path:_reportLink})}}}}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}}else{var _step3,_iterator3=(0,createForOfIteratorHelper/* default */.Z)(this.reportTree);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var _folder2=_step3.value,_rep=_folder2.children.find((function(rt){return rt.widget.dataOptions.reportId===parseInt(reportId)}));if(_rep){var _reportIndex=_folder2.children.indexOf(_rep);if(_reportIndex>=0){if(_folder2.children.splice(_reportIndex,1),_reportIndex<_folder2.children.length){var _reportLink2=this.getReportLink(_folder2.children[_reportIndex].widget.dataOptions.reportId);return void this.$router.replace({path:_reportLink2})}if(_reportIndex-1<_folder2.children.length){var _reportLink3=this.getReportLink(_folder2.children[_reportIndex-1].widget.dataOptions.reportId);return void this.$router.replace({path:_reportLink3})}}}}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}}this.$router.push({path:this.getCurrentModule(!0).rootPath})},deleteReportFolder:function(folder){var self=this,promptObj={title:self.$t("common.wo_report.delete_folder"),message:self.$t("common.wo_report.delete_folder_msg"),rbDanger:!0,rbLabel:self.$t("common._common.delete")};self.$dialog.confirm(promptObj).then((function(value){value&&api/* API */.bl.post("/v3/report/folder/delete",{reportFolder:folder}).then((function(response){if(response.error)self.$message({message:self.$t("common.wo_report.cannot_delete_msg"),type:"error"});else{var index=self.newReportTree.indexOf(folder);self.newReportTree.splice(index,1),self.$message({message:self.$t("common.wo_report.folder_delete_success"),type:"success"})}})).catch((function(error){self.$message({message:self.$t("common.wo_report.cannot_delete_msg"),type:"error"})}))}))},expand:function(folder){folder.expand=!folder.expand},getReportLink:function(reportId){var rootPath=this.getCurrentModule(!0).rootPath;return rootPath+"/view/"+reportId},getNewReportLink:function(reportId){if((0,router/* isWebTabsEnabled */.tj)()){var routeObj=(0,router/* findRouteForTab */.OD)(router/* pageTypes */.As.PIVOT_VIEW),_ref2=routeObj||{},name=_ref2.name;return name?this.$router.resolve({name:name,params:{reportId:reportId}}).href:null}return"/app/em/pivot/view/".concat(reportId)},openScheduledReports:function(){var path;if((0,router/* isWebTabsEnabled */.tj)()){var routeObj;routeObj=this.moduleName?"energydata"===this.moduleName?(0,router/* findRouteForReport */.Mq)("analytics_reports",router/* pageTypes */.As.REPORT_SCHEDULED,{moduleName:this.moduleName}):(0,router/* findRouteForReport */.Mq)("module_reports",router/* pageTypes */.As.REPORT_SCHEDULED,{moduleName:this.moduleName}):(0,router/* findRouteForReport */.Mq)("analytics_reports",router/* pageTypes */.As.REPORT_SCHEDULED);var _ref3=routeObj||{},name=_ref3.name;name&&(path=this.$router.resolve({name:name}).href)}else path="".concat(this.getCurrentModule(!0).rootPath,"/scheduled");path&&this.$router.push({path:path})},handleReportCommond:function(cmd){if("delete"===cmd){var self=this,promptObj={title:self.$t("common.wo_report.delete_report"),rbLabel:"Delete"};self.$dialog.prompt(promptObj)}else"edit"===cmd&&this.$router.replace({path:this.getCurrentModule(!0).rootPath+"/edit"})},createNewReport:function(){this.isPivot?this.$router.push({name:"pivotcreate"}):this.isModuleReport&&this.newModularReport()},newModularReport:function(){var moduleName=this.getCurrentModule().module;if((0,router/* isWebTabsEnabled */.tj)()){var _ref4=(0,router/* findRouteForReport */.Mq)("module_reports",router/* pageTypes */.As.REPORT_FORM,{moduleName:moduleName})||{},name=_ref4.name;name&&this.$router.push({name:name})}else if(this.$helpers.isEtisalat())this.$router.push({path:"/app/em/modulereports/new"});else switch(moduleName){case"workorder":this.$router.push({path:"/app/wo/reports/new"});break;case"asset":this.$router.push({path:"/app/at/reports/new"});break;case"alarm":this.$router.push({path:"/app/fa/reports/new"});break;case"custom":this.$router.push({path:"/app/ca/reports/new"});break;case"tenant":this.$router.push({path:"/app/tm/reports/new"});break;case"contracts":this.$router.push({path:"/app/ct/reports/new"});break;case"visitorlog":this.$router.push({path:"/app/vi/reports/new"});break;case"serviceRequest":this.$router.push({path:"/app/sr/reports/new"});break;case"purchaseorder":this.$router.push({path:"/app/purchase/reports/new"});break;case"budget":case"budgetamount":this.$router.push({path:"/app/ac/reports/new"});break;case"item":case"tool":case"itemTransactions":case"tootTransactions":case"itemTypes":case"toolTypes":case"storeRoom":case"shipment":case"transferrequest":case"transferrequestshipmentreceivables":case"transferrequestpurchaseditems":this.$router.push({path:"/app/inventory/reports/new"});break;default:this.$router.push({path:"/app/at/reports/new"});break}},handleNewCommand:function(cmd){if("reportfolder"===cmd){var self=this,promptObj={title:self.$t("common.wo_report.new_report_folder"),promptPlaceholder:self.$t("common.wo_report.folder_name"),rbLabel:"Save"};self.$dialog.prompt(promptObj).then((function(value){if(null!==value){var reportFolderObj={name:value};self.$http.post("dashboard/addReportFolder?moduleName="+self.getCurrentModule().module,{reportFolderContext:reportFolderObj}).then((function(response){response.data.reportFolderContext?(self.$message({message:self.$t("common.wo_report.folder_created_success"),type:"success"}),self.reportTree.push(response.data.reportFolderContext)):self.$message({message:self.$t("common.wo_report.folder_creation_failed"),type:"warning"})}))}}))}else"tabular"===cmd?this.$router.replace({path:this.getCurrentModule(!0).rootPath+"/newtabular"}):"matrix"===cmd?this.$router.replace({path:this.getCurrentModule(!0).rootPath+"/newmatrix"}):this.$router.replace({path:this.getCurrentModule(!0).rootPath+"/new"})}}},pivot_PivotReportSideBarvue_type_script_lang_js=PivotReportSideBarvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(pivot_PivotReportSideBarvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,PivotReportSideBar=component.exports},
/***/995637:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"28819f73626316ae9c1527b9dd5cba58.svg";
/***/},
/***/918562:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"67c59d9754464d20a038b48dbd7228fb.svg";
/***/},
/***/467886:
/***/function(module,__unused_webpack_exports,__webpack_require__){"use strict";module.exports=__webpack_require__.p+"img/default-img.d0e17bde.png"}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/11228.js.map