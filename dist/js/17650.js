(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[17650],{
/***/297157:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return ErrorBanner}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/ErrorBanner.vue?vue&type=template&id=3d9e5288
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_vm.hasError?_c("div",{staticClass:"error-block",attrs:{id:"error"}},[_c("p",{staticClass:"error-txt"},[_c("i",{staticClass:"fa fa-info-circle",attrs:{"aria-hidden":"true"}}),_vm._v(" "+_vm._s(_vm.errorMessage?_vm.errorMessage:"Please fill all mandatory fields.")+" ")]),_c("i",{staticClass:"el-icon-close error-close-icon",on:{click:_vm.closeBanner}})]):_vm._e()])},staticRenderFns=[],ErrorBannervue_type_script_lang_js={props:["error","errorMessage"],computed:{hasError:{get:function(){return this.error},set:function(value){this.$emit("update:error",value)}}},methods:{closeBanner:function(){this.hasError=!1,this.$emit("update:errorMessage","")}}},components_ErrorBannervue_type_script_lang_js=ErrorBannervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_ErrorBannervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,ErrorBanner=component.exports},
/***/628539:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FEditor}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/FEditor.vue?vue&type=template&id=0c30c6a9
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{ref:"editor",attrs:{id:_vm.tid?_vm.tid:Math.random().toString(36).substr(2,9)}})},staticRenderFns=[],createClass=__webpack_require__(862833),classCallCheck=__webpack_require__(513087),inherits=__webpack_require__(793806),createSuper=__webpack_require__(624343),quill=(__webpack_require__(670560),__webpack_require__(634338),__webpack_require__(676095)),quill_default=__webpack_require__.n(quill),FEditorvue_type_script_lang_js={props:["value","placeholder","editorModules","disabled","tid","registerCustomModules"],data:function(){return{quill:null}},mounted:function(){this.registerPrototypes(),this.setupQuillEditor(),this.handleInitialContent(),this.registerEditorEventListeners(),this.$emit("ready",this.quill)},watch:{value:function(val){val===this.quill.root.innerHTML||this.quill.hasFocus()||(this.quill.root.innerHTML=val)},disabled:function(status){this.quill.enable(!status)}},beforeDestroy:function(){this.quill=null,delete this.quill},methods:{setupQuillEditor:function(){var modules={};this.editorModules&&(modules=this.editorModules);var editorConfig={debug:!1,modules:modules,theme:"snow",placeholder:this.placeholder?this.placeholder:"",readOnly:!!this.disabled&&this.disabled};this.quill=new(quill_default())(this.$el,editorConfig)},registerPrototypes:function(){quill_default().prototype.getHTML=function(){return this.container.querySelector(".ql-editor").innerHTML},quill_default().prototype.getWordCount=function(){return this.container.querySelector(".ql-editor").innerText.length};var Block=quill_default()["import"]("blots/block"),Div=function(_Block){(0,inherits/* default */.Z)(Div,_Block);var _super=(0,createSuper/* default */.Z)(Div);function Div(){return(0,classCallCheck/* default */.Z)(this,Div),_super.apply(this,arguments)}return(0,createClass/* default */.Z)(Div)}(Block);Div.tagName="div",Div.blotName="div",Div.allowedChildren=Block.allowedChildren,Div.allowedChildren.push(Block),quill_default().register(Div,!1),this.registerCustomModules&&this.registerCustomModules(quill_default())},registerEditorEventListeners:function(){this.quill.on("text-change",this.handleTextChange),this.quill.on("selection-change",this.handleSelectionChange),this.listenForEditorEvent("text-change"),this.listenForEditorEvent("selection-change"),this.listenForEditorEvent("editor-change")},listenForEditorEvent:function(type){var _this=this;this.quill.on(type,(function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];_this.$emit.apply(_this,[type].concat(args))}))},handleInitialContent:function(){this.value&&(this.quill.root.innerHTML=this.value)},handleSelectionChange:function(range,oldRange){!range&&oldRange?this.$emit("blur",this.quill):range&&!oldRange&&this.$emit("focus",this.quill)},handleTextChange:function(){var editorContent="<div><br></div>"===this.quill.getHTML()?"":this.quill.getHTML();this.$emit("input",editorContent)},removeFormat:function(){this.quill.removeFormat(0,this.quill.getLength())}}},components_FEditorvue_type_script_lang_js=FEditorvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FEditorvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FEditor=component.exports},
/***/720096:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return PreviewFile}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/PreviewFile.vue?vue&type=template&id=447c7e89
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.currentFile?_c("div",{directives:[{name:"show",rawName:"v-show",value:_vm.show,expression:"show"}],staticClass:"preview-file"},[_c("div",{staticClass:"top-toolbar"},[_c("div",{staticClass:"a-top-toolbar"},[_c("div",{staticClass:"file-name word-break-keep"},[_vm._v(" "+_vm._s(_vm.currentFile.fileName)+" ")]),_c("div",{staticClass:"top-toolbar-icon-right flex align-center"},[_vm.currentFile.contentType.includes("image")?[_c("div",{staticClass:"flex-middle pL15"},[_vm.showOriginalImage?_c("div",{staticClass:"fc-white-14 word-break-keep pointer",on:{click:_vm.showOriginalPhoto}},[_vm._v(" "+_vm._s(_vm.$t("common._common.view_original"))+" ")]):_vm._e(),_vm.showCompressedImage?_c("div",{staticClass:"fc-white-14 word-break-keep pointer",on:{click:_vm.showCompressedPhoto}},[_vm._v(" "+_vm._s(_vm.$t("common._common.view_default"))+" ")]):_vm._e()]),_c("div",{staticClass:"download-icon round flex-middle pL15",on:{click:function($event){return _vm.downloadAttachment(_vm.currentFile)}}},[_c("i",{staticClass:"el-icon-download op8",staticStyle:{color:"#ffff"}})])]:_vm._e(),_vm.currentFile.contentType.includes("pdf")?[_c("div",{staticClass:"download-icon round flex-middle pL15",on:{click:function($event){return _vm.downloadAttachment(_vm.currentFile)}}},[_c("i",{staticClass:"el-icon-download op8",staticStyle:{color:"#ffff"}})])]:_vm._e(),_vm.showDeleteOption()?_c("div",{staticClass:"flex-middle pL15",on:{click:function($event){return _vm.deletePreview()}}},[_c("inline-svg",{staticClass:"pointer edit-icon-color close vertical-text-top",attrs:{src:"svgs/delete",iconClass:"icon icon-md"}})],1):_vm._e(),_c("div",{staticClass:"pL15"},[_c("i",{staticClass:"el-icon-close close",on:{click:_vm.closePreview}})])],2)])]),_vm.currentFileIndex>0?_c("a",{staticClass:"el-icon-arrow-left prev",staticStyle:{"font-size":"30px"},on:{click:function($event){return _vm.plusSlides(-1)}}}):_vm._e(),_vm.currentFileIndex<_vm.files.length-1?_c("a",{staticClass:"el-icon-arrow-right next",staticStyle:{"font-size":"30px"},on:{click:function($event){return _vm.plusSlides(1)}}}):_vm._e(),_c("div",{staticClass:"preview-content"},[_vm.currentFile.contentType.includes("image")?[_vm.compressedImage?_c("img",{staticClass:"content",staticStyle:{"box-shadow":"none"},attrs:{src:_vm.$prependBaseUrl(_vm.currentFile.previewUrl)}}):_vm.originalImage?_c("img",{staticClass:"content original",staticStyle:{"box-shadow":"none"},attrs:{src:_vm.$prependBaseUrl(_vm.currentFile.previewUrl+"?fetchOriginal=true")}}):_vm._e()]:_vm.currentFile.contentType.includes("pdf")?_c("div",{staticClass:"width100 height-100"},[_c("iframe",{staticClass:"fc-preview-pdf",attrs:{src:_vm.$prependBaseUrl(_vm.currentFile.previewUrl),height:"100%",width:"100%"}})]):_vm.isVideoSupported(_vm.currentFile.contentType)?_c("div",{staticClass:"width100 height-100 fc-preview-video"},[_c("video",{attrs:{controls:""}},[_c("source",{attrs:{src:_vm.$prependBaseUrl(_vm.$getProperty(_vm.currentFile,"downloadUrl",null)),type:_vm.$getProperty(_vm.currentFile,"contentType")}}),_vm._v(" "+_vm._s(_vm.$t("common._common.browser_not_supported"))+" ")])]):_c("div",{staticClass:"no-preview"},[_c("div",{staticClass:"flex justify-center pT24"},[_c("inline-svg",{staticClass:"d-flex",attrs:{src:_vm.getFileIcon(_vm.currentFile),iconClass:"icon icon-60 overlay"}})],1),_c("div",{staticClass:"f14 pT12 pB12"},[_vm._v("No preview available")]),_c("div",{staticClass:"download-button"},[_c("a",{staticClass:"flex flex-row",staticStyle:{color:"#ffff"},on:{click:function($event){return _vm.downloadAttachment(_vm.currentFile)}}},[_c("div",[_vm._v("Download")])])])])],2),_vm.exportDownloadUrl?_c("iframe",{staticStyle:{display:"none"},attrs:{src:_vm.exportDownloadUrl}}):_vm._e()]):_vm._e()},staticRenderFns=[],validation=(__webpack_require__(339772),__webpack_require__(260228),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(228436),__webpack_require__(990260)),PreviewFilevue_type_script_lang_js={props:["previewFile","files","visibility","showDelete","isLockedState","isTaskClosed"],data:function(){return{show:!0,previewUrl:null,currentFileIndex:0,currentFile:null,imageMargin:null,exportDownloadUrl:null,originalImage:!1,compressedImage:!0,showOriginalImage:!0,showCompressedImage:!1}},destroyed:function(){window.removeEventListener("keyup",this.handler)},mounted:function(){window.addEventListener("keyup",this.handler),this.preloadImages()},watch:{},computed:{},methods:{handler:function(){
// If escape key is pressed...
27===event.keyCode?this.closePreview():37===event.keyCode?this.plusSlides(-1):39===event.keyCode&&this.plusSlides(1)},preloadImages:function(){this.currentFile=this.previewFile?this.previewFile:this.files[0],this.currentFileIndex=this.files.indexOf(this.currentFile)},plusSlides:function(n){var index=this.currentFileIndex+n;index<0&&(index=0),index>=this.files.length&&(index=this.files.length-1),this.currentFileIndex=index,this.currentFile=this.files[index]},closePreview:function(){this.$emit("update:visibility",!1)},deletePreview:function(){var currentFile=this.currentFile;this.$emit("onDelete",currentFile)},downloadAttachment:function(file){var _this=this,_ref=file||{},url=_ref.downloadUrl;this.exportDownloadUrl&&(this.exportDownloadUrl=null),this.$nextTick((function(){_this.exportDownloadUrl=url}))},showOriginalPhoto:function(){this.originalImage=!0,this.showCompressedImage=!0,this.showOriginalImage=!1,this.compressedImage=!1},showCompressedPhoto:function(){this.showCompressedImage=!1,this.originalImage=!1,this.showOriginalImage=!0,this.compressedImage=!0},getFileIcon:function(attachment){var contentType=attachment.contentType,FILE_TYPE_ICONS=this.$constants.FILE_TYPE_ICONS,selectedIndex=FILE_TYPE_ICONS.findIndex((function(icons){var fileTypes=icons.fileTypes;return fileTypes.some((function(type){return contentType.includes(type)}))}));return(0,validation/* isEmpty */.xb)(selectedIndex)?FILE_TYPE_ICONS[0].path:FILE_TYPE_ICONS[selectedIndex].path},isVideoSupported:function(contentType){contentType=contentType||"";var supportedTypes=["video/webm","video/mp4","video/ogg"];return supportedTypes.includes(contentType.trim().toLowerCase())},showDeleteOption:function(){var showDelete=this.showDelete,isLockedState=this.isLockedState,isTaskClosed=this.isTaskClosed;return showDelete&&!isLockedState&&!isTaskClosed}}},components_PreviewFilevue_type_script_lang_js=PreviewFilevue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_PreviewFilevue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,PreviewFile=component.exports},
/***/31766:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return SummaryAttachment2}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/relatedlist/SummaryAttachment2.vue?vue&type=template&id=8089043c
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"fc-attachments new-attachments"},[_vm.exportDownloadUrl?_c("iframe",{staticStyle:{display:"none"},attrs:{src:_vm.exportDownloadUrl}}):_vm._e(),_vm.loading?_c("div",{staticClass:"text-center"},[_c("spinner",{attrs:{show:_vm.loading}})],1):_c("div",[_c("div",{staticClass:"row fc-summary-attchment wo-fc-summary-attchment pL0"},_vm._l(_vm.attachments,(function(attachment,index){return _c("el-row",{key:attachment.attachmentId,staticClass:"attchment-row visibility-visible-actions"},[_c("el-col",{attrs:{span:22}},[_c("el-col",{staticClass:"mT5",attrs:{span:1}},[_c("img",{staticClass:"svg-icon",staticStyle:{width:"20px"},attrs:{src:__webpack_require__(250620)}})]),_c("el-col",{attrs:{span:18}},[_c("div",{staticClass:"pL10"},[attachment.previewUrl?_c("a",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"top",animation:"shift-away",arrow:!0},expression:"{\n                  placement: 'top',\n                  animation: 'shift-away',\n                  arrow: true,\n                }"}],staticClass:"self-center show text-left fc-black-13 textoverflow-ellipsis max-width300px",staticStyle:{border:"none"},attrs:{title:attachment.fileName},on:{click:function($event){return _vm.selectedFile(attachment)}}},[_vm._v(_vm._s(attachment.fileName))]):_c("a",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"top",animation:"shift-away",arrow:!0},expression:"{\n                  placement: 'top',\n                  animation: 'shift-away',\n                  arrow: true,\n                }"}],staticClass:"self-center show text-left fc-black-13 textoverflow-ellipsis max-width300px",staticStyle:{border:"none"},attrs:{title:attachment.fileName}},[_vm._v(_vm._s(attachment.fileName))]),_vm.getUser(attachment)>0?_c("div",{staticClass:"col-4 comment-file mT2",staticStyle:{border:"none"}},[_vm._v(" "+_vm._s(_vm.getUser(attachment))+" "),attachment.createdTime?_c("span",[_vm._v("| "+_vm._s(_vm._f("formatDate")(attachment.createdTime,"DD-MM_YYYY")))]):_vm._e()]):_c("div",{staticClass:"col-4 comment-file mT2",staticStyle:{border:"none"}},[_vm._v(" "+_vm._s(_vm._f("formatDate")(attachment.createdTime,"DD-MM_YYYY"))+" ")])])])],1),_c("el-col",{staticClass:"mT5 pointer",attrs:{span:2}},[_c("img",{staticClass:"mR10",attrs:{src:__webpack_require__(365565),width:"16",height:"15"},on:{click:function($event){return _vm.downloadAttachment(attachment.downloadUrl)}}}),_vm.canShowDelete(attachment)?_c("span",{on:{click:function($event){return _vm.deleteAttachment(attachment,index)}}},[_c("inline-svg",{staticClass:"pointer edit-icon-color mL10 visibility-hide-actions",attrs:{src:"svgs/delete",iconClass:"icon icon-xs fill-red"}})],1):_vm._e()])],1)})),1),_vm.diasbleAttachment?_vm._e():_c("form",{attrs:{enctype:"multipart/form-data",novalidate:""}},[_c("div",{staticClass:"dropbox"},[_c("input",{staticClass:"input-file",attrs:{type:"file",multiple:""},on:{change:function($event){return _vm.filesChange($event.target.files)}}}),_c("img",{staticClass:"mT10 mB10 opacity-05",attrs:{src:__webpack_require__(581121),width:"20",height:"20"}}),_c("p",[_vm._v(" "+_vm._s(_vm.$t("common.attachment_form.drag_and_drop_files"))),_c("br"),_vm._v(" "+_vm._s(_vm.$t("common.attachment_form.click_to_browse"))+" ")])])])]),_vm.visibility&&_vm.selectedAttachedFile?_c("preview-file",{attrs:{visibility:_vm.visibility,previewFile:_vm.selectedAttachedFile,files:_vm.attachments},on:{"update:visibility":function($event){_vm.visibility=$event}}}):_vm._e()],1)},staticRenderFns=[],objectSpread2=__webpack_require__(595082),PreviewFile=(__webpack_require__(670560),__webpack_require__(162506),__webpack_require__(821057),__webpack_require__(677049),__webpack_require__(821694),__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(434284),__webpack_require__(891719),__webpack_require__(339772),__webpack_require__(720096)),validation=__webpack_require__(990260),SummaryAttachment2vue_type_script_lang_js={props:["module","record","diasbleAttachment"],data:function(){return{loading:!0,status:{UPLOADING:1,SUCCESS:2,FAILED:3},attachments:[],formFieldName:"attachment",exportDownloadUrl:null,selectedAttachedFile:null,visibility:!1}},components:{PreviewFile:PreviewFile/* default */.Z},mounted:function(){this.loadAttachments()},watch:{record:function(recordObj){this.loadAttachments()}},methods:{canShowDelete:function(attachment){var _ref=attachment||{},uploadedBy=_ref.uploadedBy,status=_ref.status,SUCCESS=this.status.SUCCESS;return((0,validation/* isEmpty */.xb)(status)||status===SUCCESS)&&uploadedBy===this.$account.user.id},deleteAttachment:function(attachment,index){var _this=this,module=this.module,ids=[];ids.push(attachment.id);var obj={attachmentId:ids,module:module};this.$dialog.confirm({title:this.$t("common.header.delete_attachment"),message:this.$t("common.header.are_you_sure_you_want_to_delete_this_attachment"),rbDanger:!0,rbLabel:this.$t("common._common.delete")}).then((function(value){value&&_this.$http.post("/v2/attachments/delete",obj).then((function(_ref2){var _ref2$data=_ref2.data,message=_ref2$data.message,responseCode=_ref2$data.responseCode;_ref2$data.result;if(0!==responseCode)throw new Error(message);_this.attachments.splice(index,1)}))}))},selectedFile:function(inList){this.selectedAttachedFile=inList,this.visibility=!0},loadAttachments:function(){var self=this;return self.loading=!0,this.$http.get("/attachment?module="+this.module+"&recordId="+this.record.id).then((function(response){self.loading=!1,self.attachments=response.data.attachments?response.data.attachments:[]})).catch((function(error){error&&(self.loading=!1,self.attachments=null)}))},filesChange:function(files){var _this2=this,fileList=Array.from(files);if(fileList.length){var formData=new FormData;formData.append("module",this.module),formData.append("recordId",this.record.id);var _this$status=this.status,UPLOADING=_this$status.UPLOADING,SUCCESS=_this$status.SUCCESS,FAILED=_this$status.FAILED;fileList.forEach((function(file){var _ref3=file||{},name=_ref3.name,size=_ref3.size,type=_ref3.type,fileEntry={fileId:-1,fileName:name,fileSize:size,contentType:type,status:UPLOADING,error:null,previewUrl:null,uploadedBy:_this2.$account.user.id};formData.append(_this2.formFieldName,file,name),_this2.attachments.unshift(fileEntry)})),this.$http.post("/attachment/add",formData).then((function(_ref4){var data=_ref4.data;data.attachments.forEach((function(attachment){var fileId=attachment.fileId,fileName=attachment.fileName,fileSize=attachment.fileSize,attachmentIdx=_this2.attachments.findIndex((function(a){return a.fileName===fileName&&a.fileSize===fileSize}));if(!(0,validation/* isEmpty */.xb)(attachmentIdx)){var attachmentFile=_this2.attachments[attachmentIdx];attachmentFile=fileId?(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},attachmentFile),attachment),{},{status:SUCCESS}):(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},attachmentFile),{},{status:FAILED,error:"Upload failed."}),_this2.$set(_this2.attachments,attachmentIdx,attachmentFile)}}))})).catch((function(){fileList.forEach((function(file){var _ref5=file||{},name=_ref5.name,size=_ref5.size,attachmentIdx=_this2.attachments.findIndex((function(a){return a.fileName===name&&a.fileSize===size}));if(!(0,validation/* isEmpty */.xb)(attachmentIdx)){var attachmentFile=_this2.attachments[attachmentIdx];attachmentFile=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},attachmentFile),{},{status:FAILED,error:"Upload failed."}),_this2.$set(_this2.attachments,attachmentIdx,attachmentFile)}}))}))}},getUser:function(assign){if(null!==assign&&assign.id){var assignto=this.$store.getters.getUser(assign.id);return assignto?assignto.name:"---"}return"---"},downloadAttachment:function(url){this.exportDownloadUrl=url},icon:function(file){return file&&"image/png"===file?"statics/icons/png.svg":"statics/icons/pdf.svg"}}},relatedlist_SummaryAttachment2vue_type_script_lang_js=SummaryAttachment2vue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(relatedlist_SummaryAttachment2vue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,SummaryAttachment2=component.exports},
/***/9915:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return EmailCodeEditor}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/setup/actions/EmailCodeEditor.vue?vue&type=template&id=204823de
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("el-dialog",{staticClass:"fc-dialog-center-container",attrs:{"append-to-body":!0,title:"HTML Editor",visible:_vm.visibility,width:"50%","before-close":_vm.closeDialog},on:{"update:visible":function($event){_vm.visibility=$event}}},[_c("div",{staticStyle:{height:"443px"}},[_c("el-radio-group",{model:{value:_vm.codeShowAndPreview,callback:function($$v){_vm.codeShowAndPreview=$$v},expression:"codeShowAndPreview"}},[_c("el-radio",{staticClass:"fc-radio-btn",attrs:{label:"HTML Editor"}},[_vm._v("HTML Editor")]),_c("el-radio",{staticClass:"fc-radio-btn",attrs:{label:"Preview"}},[_vm._v("Preview")])],1),"HTML Editor"===_vm.codeShowAndPreview?_c("div",{staticClass:"mT20"},[_c("code-mirror",{attrs:{codeeditor:!0},model:{value:_vm.htmlEditor,callback:function($$v){_vm.htmlEditor=$$v},expression:"htmlEditor"}})],1):_vm._e(),"Preview"===_vm.codeShowAndPreview?_c("div",{staticClass:"mT20 html-editor-preview",domProps:{innerHTML:_vm._s(_vm.htmlEditor)}},[_vm._v(" "+_vm._s(_vm.htmlEditor)+" ")]):_vm._e()],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){return _vm.closeDialog()}}},[_vm._v("CANCEL")]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:function($event){return _vm.save()}}},[_vm._v("Insert")])],1)])],1)},staticRenderFns=[],CodeMirror=(__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(919324)),EmailCodeEditorvue_type_script_lang_js={props:["visibility","value"],data:function(){return{htmlEditor:"",codeShowAndPreview:"HTML Editor",content:""}},components:{CodeMirror:CodeMirror/* default */.Z},mounted:function(){this.htmlEditor=this.value},methods:{closeDialog:function(){this.$emit("update:visibility",!1)},save:function(){this.htmlEditor.includes("<script")||(this.$emit("input",this.htmlEditor),this.closeDialog())}}},actions_EmailCodeEditorvue_type_script_lang_js=EmailCodeEditorvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(actions_EmailCodeEditorvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,EmailCodeEditor=component.exports},
/***/617650:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return SendNotification}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/setup/actions/SendNotification.vue?vue&type=template&id=72eac266&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticStyle:{"z-index":"999999"},attrs:{visible:_vm.visibility,fullscreen:!0,"before-close":_vm.closeDialog,"custom-class":"fc-dialog-form fc-dialog-right setup-dialog50 no-header fc-el-msgBox fc-dialog-center-container fc-dialog-center-body-p0","append-to-body":!0},on:{"update:visible":function($event){_vm.visibility=$event}}},[_c("error-banner",{attrs:{error:_vm.error,errorMessage:_vm.errorMessage}}),_c("div",{staticClass:"setup-dialog-lay new-body-modal mT0 pB100 p0",staticStyle:{height:"calc(100vh - 200px)"}},[_c("div",{staticClass:"flex-middle width100 justify-content-space p20 border-bottom1px fc-email-template-notify-header",attrs:{slot:"title"},slot:"title"},[_c("div",{staticClass:"setup-modal-title"},[_vm._v(" "+_vm._s(_vm.config[_vm.mode]?_vm.config[_vm.mode].label:"")+" ")]),_vm.showNewTemplate?_vm._e():_c("div",["mail"===_vm.mode?_c("div",{staticClass:"fc-pdf-blue-txt-13 pointer pL10 bold fc-underline-hover",on:{click:function($event){return _vm.switchToNewTemplate()}}},[_vm._v(" "+_vm._s(_vm.$t("setup.emailTemplates.switch_to_new_template"))+" ")]):_vm._e()])]),_c("el-form",{ref:"numberValidateForm",staticClass:"p20",attrs:{model:_vm.template}},["mobile"===_vm.mode?_c("el-row",[_c("el-col",{staticClass:"el-select-block",attrs:{span:24}},[_c("div",{staticClass:"flex-middle justify-content-space width100"},[_c("div",{staticClass:"grey-text2 pB10"},[_vm._v("Application")])]),_c("el-select",{staticClass:"fc-input-full-border-select2",staticStyle:{width:"100%"},attrs:{filterable:"","default-first-option":""},on:{change:function($event){return _vm.showPushOption(_vm.template.application)}},model:{value:_vm.template.application,callback:function($$v){_vm.$set(_vm.template,"application",$$v)},expression:"template.application"}},_vm._l(_vm.appList,(function(app){return _c("el-option",{key:app.id,attrs:{label:app.name,value:app.id}})})),1)],1)],1):_vm._e(),_vm.showNewTemplate?_c("div",[_c("div",["mail"===_vm.mode?_c("el-row",{staticClass:"border-bottom24 pB30"},[_c("el-col",{staticClass:"el-select-block",attrs:{span:24}},[_c("div",[_c("div",[_c("p",{staticClass:"grey-text2 pB10"},[_vm._v("From")])])]),_c("el-select",{staticClass:"fc-input-full-border-select2 width100",model:{value:_vm.fromAddr,callback:function($$v){_vm.fromAddr=$$v},expression:"fromAddr"}},_vm._l(_vm.notificationMailAddresses,(function(addr){return _c("el-option",{key:addr.id,staticClass:"subject",attrs:{label:addr.email,value:addr.id}})})),1)],1)],1):_vm._e(),"mail"===_vm.mode||"mobile"===_vm.mode||"phonecall"===_vm.mode?_c("el-row",{staticClass:"mT20"},[_c("el-col",{staticClass:"el-select-block",attrs:{span:24}},[_c("div",{staticClass:"flex-middle justify-content-space width100 pB10"},[_c("div",{staticClass:"grey-text2 pB10"},[_vm._v("To")]),"mail"===_vm.mode?_c("div",{staticClass:"flex-middle"},[_vm.ccTextHide?_c("div",{staticClass:"fc-black2-label14 fc-text-underline pointer",on:{click:function($event){return _vm.toShowCcInput()}}},[_vm._v(" Cc ")]):_vm._e(),_vm.bccTextHide?_c("div",{staticClass:"fc-black2-label14 fc-text-underline pL10 pointer",on:{click:function($event){return _vm.toShowBccinput()}}},[_vm._v(" Bcc ")]):_vm._e()]):_vm._e()]),_c("el-select",{staticClass:"fc-input-full-border-select2",staticStyle:{width:"100%"},attrs:{multiple:"",filterable:"","collapse-tags":"","allow-create":!0,"default-first-option":"",disabled:_vm.isUserNonEditable},on:{change:function($event){return _vm.handlePlaceHolders()}},model:{value:_vm.toAddr,callback:function($$v){_vm.toAddr=$$v},expression:"toAddr"}},[_vm._l(_vm.userList,(function(user,index){return[_c("el-option-group",{key:user.label+"-"+index,attrs:{label:user.isGroup?user.label:""}},_vm._l(user.options,(function(item){return _c("el-option",{key:item.value,staticClass:"subject",attrs:{label:item.displayLabel?item.displayLabel:item.label,value:item.value}},[_vm._v(" "+_vm._s(item.displayLabel?item.displayLabel:item.label)+" ")])})),1)]}))],2)],1)],1):_vm._e(),"mobile"===_vm.mode?_c("el-row",{staticClass:"mT20"},[_c("el-col",{attrs:{span:24}},[_c("p",{staticClass:"grey-text2 pB10"},[_vm._v("Subject")]),_c("el-input",{staticClass:"subject fc-input-full-border2",attrs:{placeholder:"Please Enter the subject",type:"input"},model:{value:_vm.template.subject,callback:function($$v){_vm.$set(_vm.template,"subject",$$v)},expression:"template.subject"}})],1)],1):_vm._e(),_vm.showEmailInputCc?_c("div",["mail"===_vm.mode?_c("el-row",{staticClass:"mT20"},[_c("el-col",{staticClass:"el-select-block",attrs:{span:24}},[_c("p",{staticClass:"grey-text2 pB10"},[_vm._v("Cc")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{multiple:"",filterable:"","allow-create":!0,"default-first-option":"","collapse-tags":"",disabled:_vm.isUserNonEditable},on:{change:function($event){return _vm.handlePlaceHolders()}},model:{value:_vm.ccAddr,callback:function($$v){_vm.ccAddr=$$v},expression:"ccAddr"}},[_vm._l(_vm.userList,(function(user,index){return[_c("el-option-group",{key:user.label+"-"+index,attrs:{label:user.isGroup?user.label:""}},_vm._l(user.options,(function(item){return _c("el-option",{key:item.value,staticClass:"subject",attrs:{label:item.displayLabel?item.displayLabel:item.label,value:item.value}},[_vm._v(" "+_vm._s(item.displayLabel?item.displayLabel:item.label)+" ")])})),1)]}))],2)],1)],1):_vm._e()],1):_vm._e(),_vm.showEmailInputBc?_c("div",["mail"===_vm.mode?_c("el-row",{staticClass:"mT20"},[_c("el-col",{staticClass:"el-select-block",attrs:{span:24}},[_c("p",{staticClass:"grey-text2 pB10"},[_vm._v("Bcc")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{multiple:"",filterable:"","allow-create":!0,"default-first-option":"","collapse-tags":"",disabled:_vm.isUserNonEditable},on:{change:function($event){return _vm.handlePlaceHolders()}},model:{value:_vm.bccAddr,callback:function($$v){_vm.bccAddr=$$v},expression:"bccAddr"}},[_vm._l(_vm.userList,(function(user,index){return[_c("el-option-group",{key:user.label+"-"+index,attrs:{label:user.isGroup?user.label:""}},_vm._l(user.options,(function(item){return _c("el-option",{key:item.value,staticClass:"subject",attrs:{label:item.displayLabel?item.displayLabel:item.label,value:item.value}},[_vm._v(" "+_vm._s(item.displayLabel?item.displayLabel:item.label)+" ")])})),1)]}))],2)],1)],1):_vm._e()],1):_vm._e(),"mail"===_vm.mode?_c("div",{staticClass:"pT10 flex-center-row-space border-bottom24 pB30"},[_c("div",[_c("el-checkbox",{staticClass:"mT10",attrs:{disabled:!_vm.toAddr||_vm.toAddr.length<2},model:{value:_vm.sendAsSeparateMail,callback:function($$v){_vm.sendAsSeparateMail=$$v},expression:"sendAsSeparateMail"}},[_vm._v(_vm._s(_vm.$t("setup.notification.send_as_separate_mail")))])],1),_c("div",{staticClass:"fc-green4-label14 pointer",on:{click:function($event){return _vm.openScriptDialog()}}},[_vm._v(" "+_vm._s(_vm.$t("setup.emailTemplates.advanced_merge_fields"))+" ")])]):_vm._e(),"mail"===_vm.mode?_c("el-row",{staticClass:"mT20 mB20"},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"flex-middle justify-content-space"},[_c("div",{staticClass:"grey-text2"},[_vm._v(" "+_vm._s(_vm.$t("setup.emailTemplates.email_templates"))+" ")]),_c("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{arrow:!0,arrowType:"round"},expression:"{ arrow: true, arrowType: 'round' }"}],staticClass:"pointer",attrs:{content:"Refresh"},on:{click:_vm.getEmailTemplateList}},[_c("i",{staticClass:"el-icon-refresh fc-black2-14 fwBold f16"})])]),_vm.rerender?_c("el-select",{staticClass:"fc-input-full-border2 mT10 width100",attrs:{required:"",filterable:"","popper-class":"template-popover"},on:{change:function($event){return _vm.setEmailStructure(_vm.template.emailStructureId)}},model:{value:_vm.template.emailStructureId,callback:function($$v){_vm.$set(_vm.template,"emailStructureId",$$v)},expression:"template.emailStructureId"}},[_c("template",{slot:"empty"},[_vm.$validation.isEmpty(_vm.templateListData)?_c("div",[_c("div",{staticClass:"fc-black2-14 text-center fc-no-data-txt"},[_vm._v(" No data available ")]),_c("el-button",{staticClass:"btn-green-full filter-footer-btn fc-btn-position-absolute fw-bold send-notification-template-btn",on:{click:function($event){return _vm.gotoEmailTemplateCreation()}}},[_vm._v("Add new")])],1):_vm._e()]),_vm._l(_vm.templateListData,(function(template,keyTemplate){return _c("el-option",{key:keyTemplate,attrs:{label:template.name,value:template.id}})})),_c("el-button",{staticClass:"btn-green-full filter-footer-btn fc-btn-position-absolute fw-bold send-notification-template-btn",on:{click:function($event){return _vm.gotoEmailTemplateCreation()}}},[_vm._v("Add new")])],2):_vm._e()],1)],1):_vm._e()],1)]):_vm.showNewTemplate?_vm._e():_c("div",["mail"===_vm.mode?_c("el-row",[_c("el-col",{staticClass:"el-select-block",attrs:{span:24}},[_c("div",[_c("div",[_c("p",{staticClass:"grey-text2 pB10"},[_vm._v("From")])])]),_c("el-select",{staticClass:"fc-input-full-border-select2 width100",model:{value:_vm.fromAddr,callback:function($$v){_vm.fromAddr=$$v},expression:"fromAddr"}},_vm._l(_vm.notificationMailAddresses,(function(addr){return _c("el-option",{key:addr.id,staticClass:"subject",attrs:{label:addr.email,value:addr.id}})})),1)],1)],1):_vm._e(),_c("el-row",{staticClass:"mT20"},[_c("el-col",{staticClass:"el-select-block",attrs:{span:24}},[_c("div",{staticClass:"flex-middle justify-content-space width100"},[_c("div",{staticClass:"grey-text2 pB10"},[_vm._v("To")]),"mail"===_vm.mode?_c("div",{staticClass:"flex-middle pB10"},[_c("div",[_c("el-checkbox",{staticClass:"mT10",attrs:{disabled:!_vm.toAddr||_vm.toAddr.length<2},model:{value:_vm.sendAsSeparateMail,callback:function($$v){_vm.sendAsSeparateMail=$$v},expression:"sendAsSeparateMail"}},[_vm._v(_vm._s(_vm.$t("setup.notification.send_as_separate_mail")))])],1)]):_vm._e()]),_c("el-select",{staticClass:"fc-input-full-border-select2",staticStyle:{width:"100%"},attrs:{multiple:"","collapse-tags":"",filterable:"","allow-create":!0,"default-first-option":"",disabled:_vm.isUserNonEditable},on:{change:function($event){return _vm.handlePlaceHolders()}},model:{value:_vm.toAddr,callback:function($$v){_vm.toAddr=$$v},expression:"toAddr"}},[_vm._l(_vm.userList,(function(user,index){return[_c("el-option-group",{key:user.label+"-"+index,attrs:{label:user.isGroup?user.label:""}},_vm._l(user.options,(function(item){return _c("el-option",{key:item.value,staticClass:"subject",attrs:{label:item.displayLabel?item.displayLabel:item.label,value:item.value}},[_vm._v(" "+_vm._s(item.displayLabel?item.displayLabel:item.label)+" ")])})),1)]}))],2)],1)],1),"mail"===_vm.mode?_c("el-row",{staticClass:"mT20"},[_c("el-col",{staticClass:"el-select-block",attrs:{span:24}},[_c("p",{staticClass:"grey-text2 pB10"},[_vm._v("CC")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{multiple:"",filterable:"","collapse-tags":"","allow-create":!0,"default-first-option":"",disabled:_vm.isUserNonEditable},on:{change:function($event){return _vm.handlePlaceHolders()}},model:{value:_vm.ccAddr,callback:function($$v){_vm.ccAddr=$$v},expression:"ccAddr"}},[_vm._l(_vm.userList,(function(user,index){return[_c("el-option-group",{key:user.label+"-"+index,attrs:{label:user.isGroup?user.label:""}},_vm._l(user.options,(function(item){return _c("el-option",{key:item.value,staticClass:"subject",attrs:{label:item.displayLabel?item.displayLabel:item.label,value:item.value}},[_vm._v(" "+_vm._s(item.displayLabel?item.displayLabel:item.label)+" ")])})),1)]}))],2)],1)],1):_vm._e(),"mail"===_vm.mode?_c("el-row",{staticClass:"mT30"},[_c("el-col",{staticClass:"el-select-block",attrs:{span:24}},[_c("p",{staticClass:"grey-text2 pB10"},[_vm._v("BCC")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{multiple:"","collapse-tags":"",filterable:"","allow-create":!0,"default-first-option":"",disabled:_vm.isUserNonEditable},on:{change:function($event){return _vm.handlePlaceHolders()}},model:{value:_vm.bccAddr,callback:function($$v){_vm.bccAddr=$$v},expression:"bccAddr"}},[_vm._l(_vm.userList,(function(user,index){return[_c("el-option-group",{key:user.label+"-"+index,attrs:{label:user.isGroup?user.label:""}},_vm._l(user.options,(function(item){return _c("el-option",{key:item.value,staticClass:"subject",attrs:{label:item.displayLabel?item.displayLabel:item.label,value:item.value}},[_vm._v(" "+_vm._s(item.displayLabel?item.displayLabel:item.label)+" ")])})),1)]}))],2)],1)],1):_vm._e(),_c("div",["mobile"===_vm.mode||"mail"===_vm.mode?_c("el-row",{staticClass:"mT20"},[_c("el-col",{attrs:{span:24}},[_c("p",{staticClass:"grey-text2 pB10"},[_vm._v("Subject")]),_c("el-input",{staticClass:"subject fc-input-full-border2",attrs:{placeholder:"Please Enter the subject",type:"input"},model:{value:_vm.template.subject,callback:function($$v){_vm.$set(_vm.template,"subject",$$v)},expression:"template.subject"}})],1)],1):_vm._e(),"mail"===_vm.mode?_c("el-row",{staticClass:"mT30 mail-message-textarea pB0"},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"pB20"},[_c("div",{staticClass:"flex-middle justify-content-space pB10"},[_c("div",{staticClass:"flex-middle justify-content-space width100"},[_c("div",{staticClass:"grey-text2 pB5"},[_vm._v("Message")]),_c("div",{staticClass:"flex-middle"},[_c("div",[_c("div",{staticClass:"flex-middle"},[_c("div",{staticClass:"fc-pdf-blue-txt-13 pointer pL10 bold fc-underline-hover",on:{click:function($event){return _vm.openScriptDialog()}}},[_vm._v(" "+_vm._s(_vm.$t("setup.notification.configure_script"))+" ")]),_c("div",{staticClass:"fc-separator-lg mL10 mR10 self-center"}),_c("div",{staticClass:"fc-pdf-blue-txt-13 pointer pL10 bold fc-underline-hover",on:{click:function($event){return _vm.showFileSupportDialog()}}},[_vm._v(" "+_vm._s(_vm.$t("setup.notification.attach_files"))+" ")]),_c("div",{staticClass:"fc-separator-lg mL10 mR10 self-center"}),_vm.showHtmlEditor?_c("div",{staticClass:"fc-pdf-blue-txt-13 fc-underline-hover pointer bold",on:{click:function($event){return _vm.showPlain()}}},[_vm._v(" "+_vm._s(_vm.$t("setup.notification.plain_text"))+" ")]):_c("div",{staticClass:"fc-pdf-blue-txt-13 pointer pL10 bold fc-underline-hover",on:{click:function($event){return _vm.showRichEditor()}}},[_vm._v(" "+_vm._s(_vm.$t("setup.notification.rich_text_editor"))+" ")]),_c("div",{staticClass:"fc-separator-lg mL10 mR10 self-center"})])])])])]),_vm.showHtmlEditor?_c("div",{staticClass:"notification-editor-block"},[_c("div",{staticClass:"html-editor-icon pointer fc-link-blue14 bold",on:{click:function($event){return _vm.showCodeEditor()}}},[_vm._v(" "+_vm._s(_vm.$t("setup.notification.insert_html"))+" ")]),_c("f-editor",{ref:"templateEditor",staticClass:"height350",attrs:{editorModules:_vm.quillEditorConfig},model:{value:_vm.template.message,callback:function($$v){_vm.$set(_vm.template,"message",$$v)},expression:"template.message"}})],1):_c("el-input",{staticClass:"subject fc-input-full-border-select2 notification-txt-area",attrs:{type:"textarea",placeholder:"Type your message",autosize:{minRows:6,maxRows:6}},model:{value:_vm.template.message,callback:function($$v){_vm.$set(_vm.template,"message",$$v)},expression:"template.message"}})],1)])],1):_vm._e()],1)],1),_c("el-row",{staticClass:"mT20"},["mobile"===_vm.mode||"phonecall"===_vm.mode||"sms"===_vm.mode||"whatsapp"===_vm.mode?_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"grey-text2 pB10"},[_vm._v("Message")]),_c("el-input",{staticClass:"subject fc-input-full-border-select2 notification-txt-area",attrs:{type:"textarea",placeholder:"Type your message",autosize:{minRows:6,maxRows:6}},model:{value:_vm.template.message,callback:function($$v){_vm.$set(_vm.template,"message",$$v)},expression:"template.message"}})],1):_vm._e()],1),_c("el-row",["mobile"===_vm.mode&&_vm.showCheckIsPush?_c("div",{staticClass:"flex-middle pB10"},[_c("div",[_c("el-checkbox",{staticClass:"mT10",model:{value:_vm.isPushNotification,callback:function($$v){_vm.isPushNotification=$$v},expression:"isPushNotification"}},[_vm._v(_vm._s(_vm.$t("setup.notification.send_push_notifications")))])],1)]):_vm._e()])],1)],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("button",{staticClass:"modal-btn-cancel",attrs:{type:"button"},on:{click:_vm.closeDialog}},[_c("span",[_vm._v("Cancel")])]),_c("button",{staticClass:"modal-btn-save",attrs:{type:"button"},on:{click:_vm.save}},[_c("span",[_vm._v("Save")])])]),_vm.codeEditorVisible?_c("code-editor",{attrs:{options:{mode:"text/html"},visibility:_vm.codeEditorVisible},on:{"update:visibility":function($event){_vm.codeEditorVisible=$event}},model:{value:_vm.template.message,callback:function($$v){_vm.$set(_vm.template,"message",$$v)},expression:"template.message"}}):_vm._e(),_vm.showFileAttachDialog?_c("FilesAttachment",{attrs:{visibility:_vm.showFileAttachDialog,templateId:_vm.templateId,urlStringList:_vm.template.templateUrlStrings,fileIdsList:_vm.template.templateFileIds,fileFieldIdsList:_vm.template.templateFileFileIds,attachmentsList:_vm.attachmentsList},on:{"update:visibility":function($event){_vm.showFileAttachDialog=$event},onSave:_vm.onSaveAttachments}}):_vm._e(),_c("el-dialog",{staticClass:"fieldchange-Dialog pB15 fc-dialog-center-container fc-dialog-center-body-p0",attrs:{visible:_vm.showScriptDialog,width:"60%",title:"script","append-to-body":!0},on:{"update:visible":function($event){_vm.showScriptDialog=$event}}},[_c("div",{staticClass:"height350 overflow-y-scroll pB50"},[_vm.showScriptDialog?_c("code-mirror",{attrs:{codeeditor:!0},model:{value:_vm.template.userWorkflow,callback:function($$v){_vm.$set(_vm.template,"userWorkflow",$$v)},expression:"template.userWorkflow"}}):_vm._e()],1),_c("div",{staticClass:"modal-dialog-footer",staticStyle:{"z-index":"900"}},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){return _vm.actionSave(_vm.template)}}},[_vm._v("CANCEL")]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:function($event){return _vm.actionSave(_vm.template)}}},[_vm._v("Save")])],1)])],1)},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),toConsumableArray=__webpack_require__(488478),asyncToGenerator=__webpack_require__(548534),ErrorBanner=(__webpack_require__(260228),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(538077),__webpack_require__(300268),__webpack_require__(670560),__webpack_require__(634338),__webpack_require__(919649),__webpack_require__(425728),__webpack_require__(162506),__webpack_require__(947522),__webpack_require__(564043),__webpack_require__(857267),__webpack_require__(952003),__webpack_require__(68518),__webpack_require__(113440),__webpack_require__(212826),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(434284),__webpack_require__(506203),__webpack_require__(228436),__webpack_require__(297157)),NotificationHelper=__webpack_require__(683038),validation=__webpack_require__(586529),FilesAttachment=__webpack_require__(406609),EmailCodeEditor=__webpack_require__(9915),FEditor=__webpack_require__(628539),api=__webpack_require__(32284),CodeMirror=__webpack_require__(919324),router=__webpack_require__(329435),config={mail:{type:1,
// Template type
actionType:3,label:"Send Email Action",name:"New WorkOrder Email Template"},sms:{type:2,
// Template type
actionType:4,label:"Send SMS Action",name:"New WorkOrder SMS Template"},mobile:{type:8,
// Template type
actionType:7,label:"Send Notification",name:"New WorkOrder Push Notification Template"},web:{type:9,
// Template type
label:"Send Web Notification",name:"New WorkOrder Push Notification Template"},whatsapp:{type:26,
// Template type
actionType:26,label:"Send Whatsapp Action",name:"New WorkOrder Whatsapp Template"},phonecall:{type:27,
// Template type
actionType:27,label:"Make a Phone Call Action",name:"New WorkOrder Phone Call Template"}},quillEditorConfig={toolbar:[["bold","italic","underline","link",{list:"ordered"},{list:"bullet"},{indent:"-1"},{indent:"+1"},{size:["small",!1,"large","huge"]},{align:["","right","center","justify"]},{header:[1,2,3,4,5,6,!1]}]]},SendNotificationvue_type_script_lang_js={props:["visibility","option","mode","module"],components:{ErrorBanner:ErrorBanner/* default */.Z,CodeEditor:EmailCodeEditor/* default */.Z,FEditor:FEditor/* default */.Z,CodeMirror:CodeMirror/* default */.Z,FilesAttachment:FilesAttachment/* default */.Z},mixins:[NotificationHelper/* default */.Z],data:function(){return{rerender:!0,showNewTemplate:!1,template:{subject:"",message:"",originalTemplate:{to:""},workflow:{},userWorkflow:"",application:null,templateFileIds:[],templateUrlStrings:[],templateFileFileIds:[],attachmentList:[],emailStructureId:null},showScriptDialog:!1,showFileAttachDialog:!1,showCheckIsPush:!1,templateId:-1,toAddr:[],ccAddr:[],bccAddr:[],notificationMailAddresses:[],fromAddr:null,isPushNotification:!1,sendAsSeparateMail:!0,attachmentsList:[],templateFiles:[],templateUrls:[],error:!1,errorMessage:"",codeEditorVisible:!1,config:config,enableFormMode:"Plain text",vueEditorData:null,quillEditorConfig:quillEditorConfig,showHtmlEditor:!1,appList:[],userScriptHeader:"Map scriptFunc(Map "+this.module+") {\n",userScriptFooter:"\n}",templateListData:[],switchToEmailTemplate:!0,hideOldEditor:!0,hideOldViewTempalte:!0,showEmailInputCc:!1,showEmailInputBc:!1,showSwitchTemplateTxt:!0,ccTextHide:!0,bccTextHide:!0}},created:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.next=2,Promise.all([_this.loadApps(),_this.loadTemplate()]);case 2:api/* API */.bl.get("/v3/modules/data/list",{moduleName:"emailFromAddress"}).then((function(_ref){var data=_ref.data,error=_ref.error;error||(
/* sourceType=1 filters all addresses added for notifications */
data.emailFromAddress=data.emailFromAddress.filter((function(em){return 1===em.sourceType})),_this.notificationMailAddresses=(0,toConsumableArray/* default */.Z)(data.emailFromAddress),_this.notificationMailAddresses.length>0&&(_this.fromAddr=data.emailFromAddress.filter((function(em){return em.email.startsWith("noreply@")}))[0].id))})),_this.$store.dispatch("view/loadModuleMeta",_this.module),_this.getEmailTemplateList();case 5:case"end":return _context.stop()}}),_callee)})))()},computed:{appLinkName:function(){var appName=(0,router/* getApp */.wx)().linkName;return appName},isFtl:function(){var _ref2=this.option||{},templateId=_ref2.templateId,template=_ref2.template,templateJson=_ref2.templateJson,isFTLQuery="true"===this.$route.query.ftl;return templateId&&template?template.ftl:templateJson?templateJson.ftl||!1:isFTLQuery},isNewTemplate:function(){var _option$template,option=this.option;return null===option||(null===option||void 0===option||null===(_option$template=option.template)||void 0===_option$template?void 0:_option$template.emailStructureId)>0}},watch:{option:function(){this.loadTemplate(),this.handleTemplete()},visibility:function(val){val&&(this.loadTemplate(),this.handleTemplete())}},methods:{setEmailStructure:function(id){var _this2=this;this.rerender=!1,this.$set(this.template,"emailStructureId",id),this.$nextTick((function(){_this2.rerender=!0}))},handleTemplete:function(){this.isNewTemplate&&(this.showNewTemplate=!0)},loadAttachments:function(){var _this3=this,option=this.option,_ref3=option||{},template=_ref3.template;template.isAttachmentAdded&&api/* API */.bl.get("/v2/template/attachment/getList",{templateId:option.templateId}).then((function(_ref4){var data=_ref4.data,error=_ref4.error;error||(0,validation/* isEmpty */.xb)(data)||_this3.deserialize(data)}))},deserialize:function(data){var _ref5=data||{},attachmentUrlList=_ref5.attachmentUrlList,attachments=_ref5.attachments,attachmentFileFieldslList=_ref5.attachmentFileFieldslList;if(!(0,validation/* isEmpty */.xb)(attachmentUrlList)){for(var urls=[],i=0;i<attachmentUrlList.length;i++)urls.push(attachmentUrlList[i].urlString);this.template.templateUrlStrings=urls}if(!(0,validation/* isEmpty */.xb)(attachmentFileFieldslList)){for(var fileFields=[],_i=0;_i<attachmentFileFieldslList.length;_i++)fileFields.push(attachmentFileFieldslList[_i].fieldId);this.template.templateFileFileIds=fileFields}if(!(0,validation/* isEmpty */.xb)(attachments)){for(var ids=[],_i2=0;_i2<attachments.length;_i2++)ids.push(attachments[_i2].fileId);this.attachmentsList=attachments,this.template.templateFileIds=ids}},constructAttachmentList:function(){var _ref6=this||{},template=_ref6.template;this.template.attachmentList=[];var attachmentsList=[],templateFileIds=template.templateFileIds,templateUrlStrings=template.templateUrlStrings,templateFileFileIds=template.templateFileFileIds;if(!(0,validation/* isEmpty */.xb)(templateFileIds))for(var i=0;i<templateFileIds.length;i++){var obj={fileId:templateFileIds[i],type:1};attachmentsList.push(obj)}if(!(0,validation/* isEmpty */.xb)(templateFileFileIds))for(var _i3=0;_i3<templateFileFileIds.length;_i3++){var _obj={fieldId:templateFileFileIds[_i3],type:2};attachmentsList.push(_obj)}if(!(0,validation/* isEmpty */.xb)(templateUrlStrings))for(var _i4=0;_i4<templateUrlStrings.length;_i4++)if(!(0,validation/* isEmpty */.xb)(templateUrlStrings[_i4])){var _obj2={urlString:templateUrlStrings[_i4],type:3};attachmentsList.push(_obj2)}return(0,validation/* isEmpty */.xb)(attachmentsList)||(this.template.attachmentList=attachmentsList),attachmentsList},onSaveAttachments:function(urlArray,fileIds,attachments,fileFieldIds){this.template.templateUrlStrings=urlArray,this.template.templateFileIds=fileIds,this.template.templateFileFileIds=fileFieldIds,this.attachmentsList=attachments},handlePlaceHolders:function(){var toAddr=this.toAddr,ccAddr=this.ccAddr,bccAddr=this.bccAddr,addArr=[].concat((0,toConsumableArray/* default */.Z)(toAddr),(0,toConsumableArray/* default */.Z)(ccAddr),(0,toConsumableArray/* default */.Z)(bccAddr));addArr=(0,toConsumableArray/* default */.Z)(new Set(addArr));var placeholders=addArr.filter((function(add){return isNaN(add)&&add.startsWith("${cs.")}));if(!(0,validation/* isEmpty */.xb)(placeholders)){var placeHoldersGroup=this.constructPlaceHoldersOption(placeholders,"PlaceHolders"),placeHoldersGroupArr=this.userList.find((function(list){return"PlaceHolders"===list.label}));if(!(0,validation/* isEmpty */.xb)(placeHoldersGroupArr)){var index=this.userList.indexOf(placeHoldersGroupArr);this.userList.splice(index,1)}this.userList.push(placeHoldersGroup)}},constructPlaceHoldersOption:function(placeholders,groupLabel){var optionsArr=[];return placeholders.forEach((function(placeholder){var options={label:placeholder,value:placeholder};optionsArr.push(options)})),{label:groupLabel,options:optionsArr,isGroup:!0}},openScriptDialog:function(){this.showScriptDialog=!0},showFileSupportDialog:function(){this.showFileAttachDialog=!0},getScriptWorkflow:function(workflow){return(0,validation/* isEmpty */.xb)(workflow)||(0,validation/* isEmpty */.xb)(workflow.workflowV2String)?null:workflow.workflowV2String.replace(this.userScriptHeader,"").replace(new RegExp(this.userScriptFooter+"$"),"")},actionSave:function(){this.showScriptDialog=!1},loadApps:function(){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var _yield$API$get,data,error,_this4$$constants$app,FEATURE_GROUPING,WORK_CENTERS,PORTALS;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,api/* API */.bl.get("v2/application/fetchList?moduleName=".concat(_this4.module));case 2:_yield$API$get=_context2.sent,data=_yield$API$get.data,error=_yield$API$get.error,error||(_this4$$constants$app=_this4.$constants.appCategory,FEATURE_GROUPING=_this4$$constants$app.FEATURE_GROUPING,WORK_CENTERS=_this4$$constants$app.WORK_CENTERS,PORTALS=_this4$$constants$app.PORTALS,_this4.appList=data.application.filter((function(app){return[FEATURE_GROUPING,WORK_CENTERS,PORTALS].includes(app.appCategory)})));case 6:case"end":return _context2.stop()}}),_callee2)})))()},showPushOption:function(appId){this.showCheckIsPush=!1;var app=this.appList.find((function(app){return app.id===appId}))||this.appList[0],_ref7=app||{},linkName=_ref7.linkName;!(0,validation/* isEmpty */.xb)(app)&&["newapp","maintenance","service","tenant","vendor"].includes(linkName)&&(this.showCheckIsPush=!0)},loadTemplate:function(){var _this5=this;if(this.reset(),this.option)
// On editing after adding
if(this.option.templateJson){this.template.message=this.option.templateJson.message,this.template.subject=this.option.templateJson.subject,this.template.originalTemplate.to=this.option.templateJson.to,this.template.originalTemplate.cc=this.option.templateJson.cc,this.template.originalTemplate.bcc=this.option.templateJson.bcc,this.template.workflow=this.option.templateJson.workflow;var applink=this.appList.find((function(app){return"newapp"===app.linkName}))||{},id=applink.id,option=this.option,_ref8=option||{},templateJson=_ref8.templateJson,_ref9=templateJson||{},application=_ref9.application;this.template.application=application||id,this.isPushNotification=this.option.templateJson.isPushNotification,this.sendAsSeparateMail=this.option.templateJson.sendAsSeparateMail,this.templateFiles=this.option.templateJson.templateFiles,this.templateUrls=this.option.templateJson.templateUrls,this.template.templateFileIds=this.option.templateJson.templateFileIds,this.template.templateUrlStrings=this.option.templateJson.templateUrlStrings,this.template.templateFileFileIds=this.option.templateJson.templateFileFileIds,this.toAddr=this.$common.getUsersFromTemplate(this.template),this.ccAddr=this.$common.getUsersFromTemplate(this.template,"cc"),this.bccAddr=this.$common.getUsersFromTemplate(this.template,"bcc"),this.template.toType=this.option.templateJson.toType,this.showHtmlEditor=this.option.templateJson.html,this.$set(this.template,"emailStructureId",this.option.templateJson.emailStructureId),(0,validation/* isEmpty */.xb)(this.template.templateFileIds)&&(0,validation/* isEmpty */.xb)(this.template.templateUrlStrings)&&(0,validation/* isEmpty */.xb)(this.template.templateFileFileIds)?this.template.isAttachmentAdded=!1:this.template.isAttachmentAdded=!0,(0,validation/* isEmpty */.xb)(this.option.templateJson)||(0,validation/* isEmpty */.xb)(this.option.templateJson.userWorkflow)||(this.template.userWorkflow=this.getScriptWorkflow(this.option.templateJson.userWorkflow)),this.template.attachmentList=this.constructAttachmentList()}else
// On editing
this.option.templateId>0?(this.loadAttachments(),Object.assign(this.template,this.option.template),this.templateId=this.option.templateId,this.option.template&&this.option.template.from&&(this.fromAddr=this.notificationMailAddresses.filter((function(addr){return addr.id===_this5.option.template.fromID}))[0].id),(0,validation/* isEmpty */.xb)(this.option.template)||(0,validation/* isEmpty */.xb)(this.option.template.userWorkflow)||(this.template.userWorkflow=this.getScriptWorkflow(this.option.template.userWorkflow))):(
// Default template
this.template=this.option.template.originalTemplate,this.option.template.originalTemplate&&this.option.template.originalTemplate.sender),this.toAddr="web"!==this.mode?this.$common.getUsersFromTemplate(this.option.template):this.option.template.originalTemplate?this.option.template.originalTemplate.id.split():[],this.ccAddr=this.$common.getUsersFromTemplate(this.option.template,"cc"),this.bccAddr=this.$common.getUsersFromTemplate(this.option.template,"bcc"),this.template.toType=this.option.template.toType,this.sendAsSeparateMail=!1!==this.option.template.originalTemplate.sendAsSeparateMail,this.isPushNotification=this.option.template.originalTemplate.isSendNotification,this.showPushOption(),"mobile"===this.mode&&this.option.template.originalTemplate&&this.option.template.originalTemplate.data&&(this.template.message=this.option.template.originalTemplate.data.text,this.template.subject=this.option.template.originalTemplate.data.title),this.showHtmlEditor=this.option.template.originalTemplate.html;if("mobile"===this.mode){var defaultApp=this.appList.find((function(app){return"newapp"===app.linkName}))||{};this.template.application!==defaultApp.id?
// this.isPushNotification = false
this.showCheckIsPush=!0:(0,validation/* isEmpty */.xb)(this.template.application)&&(this.template.application=defaultApp.id,
// this.isPushNotification = true
this.showCheckIsPush=!0)}this.handlePlaceHolders()},closeDialog:function(){this.showNewTemplate=!1,this.$emit("update:visibility",!1)},validateFields:function(){return!this.template.message&&this.toAddr.length<=0?(this.error=!0,this.errorMessage=" Please fill field",!1):this.toAddr.length<=0?(this.error=!0,this.errorMessage="Add receiving address",!1):void(this.toAddr.length>=1&&(this.error=!1));
// else if (!this.template.message) {
//   this.error = true
//   this.errorMessage = 'Please give message'
//   return false
// }
// else if (this.toAddr && this.template.message) {
//   this.error = false
//   return true
// }
},save:function(){if(
// this.showNewTemplate = false
this.validateFields(),!this.error){var dataToSave=this.getDataToSave();this.$emit("onsave",dataToSave)}},getDataToSave:function(option,mode){option&&(this.option=option,this.mode=mode,this.loadTemplate());var data={type:this.config[this.mode].type,message:this.template.message,name:this.config[this.mode].name,workflow:{},ftl:this.isFtl,html:this.showHtmlEditor,toType:this.template.toType,sendAsSeparateMail:this.sendAsSeparateMail,templateFiles:this.templateFiles,templateUrls:this.templateUrls,isPushNotification:this.isPushNotification,fromAddr:this.fromAddr,templateFileIds:this.template.templateFileIds,templateUrlStrings:this.template.templateUrlStrings,templateFileFileIds:this.template.templateFileFileIds};return this.template.emailStructureId&&this.$set(data,"emailStructureId",this.template.emailStructureId),(0,validation/* isEmpty */.xb)(this.template.userWorkflow)||(data.userWorkflow={isV2Script:!0,workflowV2String:this.userScriptHeader+this.template.userWorkflow+this.userScriptFooter}),"mobile"===this.mode&&(data.isSendNotification=this.isPushNotification,data.application=this.template.application),this.$common.setUserMailWorkflow(this.toAddr,data,this.mode,this.module,this.isFtl,(0,validation/* isEmpty */.xb)(this.ccAddr)?null:{ids:this.ccAddr,key:"cc"},(0,validation/* isEmpty */.xb)(this.bccAddr)?null:{ids:this.bccAddr,key:"bcc"}),this.isFtl||this.$common.setExpressionFromPlaceHolder(data.workflow,this.template.message,this.module),"mail"!==this.mode&&"mobile"!==this.mode||(data.subject=this.template.subject,this.isFtl||this.$common.setExpressionFromPlaceHolder(data.workflow,this.template.subject)),(0,validation/* isEmpty */.xb)(data.templateUrlStrings)||this.$common.setExpressionFromPlaceHolder(data.workflow,data.templateUrlStrings.join()),"sms"!==this.mode&&"phonecall"!==this.mode&&"whatsapp"!==this.mode||(data.body=this.template.message),data.attachmentList=this.constructAttachmentList(),{actionType:this.config[this.mode].actionType,templateJson:data}},reset:function(){this.template={subject:"",message:"",originalTemplate:{to:""},workflow:{},userWorkflow:"",application:null},this.templateId=-1,this.template.fromAddr=null,this.toAddr=[],this.ccAddr=[],this.bccAddr=[],this.sendAsSeparateMail=!0,this.templateFiles=[],this.templateUrls=[],this.showHtmlEditor=!1},showCodeEditor:function(){this.codeEditorVisible=!0},showPlain:function(){var self=this;this.$confirm("Some formatting will be lost when converting to plain text.\n\n Are you sure want to continue?","Change to plain text",{confirmButtonText:"Change Format",cancelButtonText:"Cancel",cancelButtonClass:"msg-cancel-btn",confirmButtonClass:"msg-confirm-btn",customClass:"fc-el-msgBox",type:"warning"}).then((function(){self.$refs["templateEditor"].removeFormat(),self.template.message=self.template.message.replace(/<div([^>]*)>/gi,"").replace(/<br>/gi,"\n").replace(/<\/div>/gi,"").trim(),self.showHtmlEditor=!1})).catch((function(){}))},showRichEditor:function(){this.showHtmlEditor=!0,this.template.message&&(this.template.message="<div style='white-space:pre'>"+this.template.message+"</div>")},getEmailTemplateList:function(){var _this6=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var _yield$API$get2,error,data;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return _this6.loading=!0,_context3.next=3,api/* API */.bl.get("v2/template/email/list?moduleName=".concat(_this6.module));case 3:_yield$API$get2=_context3.sent,error=_yield$API$get2.error,data=_yield$API$get2.data,error?_this6.$message.error(error.message||"Error Occurred"):_this6.templateListData=data.emailStructures,_this6.loading=!1;case 8:case"end":return _context3.stop()}}),_callee3)})))()},switchToNewTemplate:function(){this.showNewTemplate=!0,this.showSwitchTemplateTxt=!1,this.hideOldViewTempalte=!1,this.existingSubjectShowHide=!1},toShowCcInput:function(){this.showEmailInputCc=!this.showEmailInputCc,this.ccTextHide=!1},toShowBccinput:function(){this.showEmailInputBc=!this.showEmailInputBc,this.bccTextHide=!1},gotoEmailTemplateCreation:function(){var routeData=this.$router.resolve({path:"/".concat(this.appLinkName,"/setup/customization/emailtemplates/").concat(this.module,"/new")});return window.open(routeData.href,"_blank")}}},actions_SendNotificationvue_type_script_lang_js=SendNotificationvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(actions_SendNotificationvue_type_script_lang_js,render,staticRenderFns,!1,null,"72eac266",null)
/* harmony default export */,SendNotification=component.exports},
/***/406609:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FilesAttachment}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/setup/actions/email-attachment/FilesAttachment.vue?vue&type=template&id=21ee64da
var DirectFileAttachment_render,DirectFileAttachment_staticRenderFns,render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"fieldchange-Dialog pB15 fc-dialog-center-container fc-dialog-center-body-p0",attrs:{visible:_vm.visibility,width:"60%",title:_vm.$t("setup.notification.mail_attachment"),"append-to-body":!0,"before-close":_vm.closeDialog},on:{"update:visible":function($event){_vm.visibility=$event}}},[_c("div",{staticClass:"setup-dialog-lay new-body-modal mT0 pB100 height400"},[_c("el-form",[_c("el-row",[_c("el-col",{staticClass:"el-select-block",attrs:{span:24}},[_c("div",{staticClass:"email-attachment"},[_vm._v(" "+_vm._s(_vm.$t("setup.notification.attach_file"))+": ")])])],1),_c("el-row",{staticClass:"mT30"},[_c("DirectFileAttachment",{attrs:{module:"templatefileattachment",record:"",templateId:_vm.templateId,attachmentsList:_vm.attachmentsList},on:{removeFileId:_vm.removeFileId,addAttachment:_vm.addAttachment}})],1),_c("el-row",{staticClass:"mT10"},[_c("el-col",{staticClass:"el-select-block",attrs:{span:24}},[_c("div",{staticClass:"email-attachment"},[_vm._v(" "+_vm._s(_vm.$t("setup.notification.add_urls"))+": ")])])],1),_c("el-row",[_c("UrlAttachment",{attrs:{module:"templateurlattachment",urlArray:_vm.urlArray},on:{"update:urlArray":function($event){_vm.urlArray=$event},"update:url-array":function($event){_vm.urlArray=$event}}})],1),_vm.$validation.isEmpty(_vm.fileFieldsList)?_vm._e():_c("el-row",{staticClass:"mT30"},[_c("el-col",{staticClass:"el-select-block",attrs:{span:24}},[_c("div",{staticClass:"email-attachment"},[_vm._v(" "+_vm._s(_vm.$t("setup.notification.select_file_fields"))+": ")])])],1),_vm.$validation.isEmpty(_vm.fileFieldsList)?_vm._e():_c("el-row",{staticClass:"mT20"},[_c("FileFieldAttachment",{attrs:{module:"templatefilefieldattachment",fileFieldsList:_vm.fileFieldsList,fileFieldIds:_vm.fileFieldIds},on:{"update:fileFieldIds":function($event){_vm.fileFieldIds=$event},"update:file-field-ids":function($event){_vm.fileFieldIds=$event}}})],1)],1)],1),_c("div",{staticClass:"modal-dialog-footer",staticStyle:{"z-index":"900"}},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){return _vm.closeDialog()}}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:function($event){return _vm.actionSave()}}},[_vm._v(_vm._s(_vm.$t("common._common._save")))])],1)])},staticRenderFns=[],objectSpread2=__webpack_require__(595082),SummaryAttachment2=(__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(670560),__webpack_require__(162506),__webpack_require__(434284),__webpack_require__(31766)),api=__webpack_require__(32284),DirectFileAttachmentvue_type_script_lang_js={props:["templateId","module","record","diasbleAttachment","attachmentsList"],extends:SummaryAttachment2/* default */.Z,watch:{attachments:function(value){this.$emit("update:attachmentsList",value)}},methods:{canShowDelete:function(){return!0},loadAttachments:function(){this.attachments=this.attachmentsList,this.loading=!1},filesChange:function(fileList){var _this=this;if(fileList.length){var formData=new FormData;formData.append("fileContent",fileList[0]),api/* API */.bl.post("/v2/files/add",formData).then((function(_ref){var data=_ref.data,error=_ref.error;if(error)_this.$message.error(error.message||"Error Occured");else{var attachmentIndexMap={},fileEntry={attachmentId:-1,fileId:data.fileInfo.fileId,fileName:fileList[0].name,fileSize:fileList[0].size,contentType:fileList[0].type,status:_this.status.UPLOADING,error:null,previewUrl:null};_this.attachments.push(fileEntry),attachmentIndexMap["0"]=_this.attachments.length-1,_this.$emit("addAttachment",data.fileInfo)}}))}},deleteAttachment:function(attachment,index){var _this2=this;if(attachment.id>0){var templateId=this.templateId,ids=[];ids.push(attachment.id);var formData={moduleName:"templatefileattachment",templateId:templateId,attachmentIds:ids};this.$dialog.confirm({title:this.$t("common.header.delete_attachment"),message:this.$t("common.header.are_you_sure_you_want_to_delete_this_attachment"),rbDanger:!0,rbLabel:this.$t("common._common.delete")}).then((function(value){value&&api/* API */.bl.post("/v2/template/attachment/delete",formData).then((function(_ref2){var error=_ref2.error;error&&_this2.$message.error(error.message||"Error Occured")}))}))}this.attachments.splice(index,1),this.$emit("removeFileId",attachment.fileId,index)}}},email_attachment_DirectFileAttachmentvue_type_script_lang_js=DirectFileAttachmentvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(email_attachment_DirectFileAttachmentvue_type_script_lang_js,DirectFileAttachment_render,DirectFileAttachment_staticRenderFns,!1,null,null,null)
/* harmony default export */,DirectFileAttachment=component.exports,UrlAttachmentvue_type_template_id_6a442304_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("el-form",[_vm.$validation.isEmpty(_vm.urls)?_c("div",[_c("el-row",{staticClass:"visibility-visible-actions"},[_c("div",{staticClass:"mT20"},[_c("el-col",{staticClass:"el-select-block",attrs:{span:19}},[_c("el-input",{staticClass:"fc-input-full-border2",on:{change:function($event){return _vm.update(_vm.urls[0])}},model:{value:_vm.urls[0],callback:function($$v){_vm.$set(_vm.urls,0,$$v)},expression:"urls[0]"}})],1),_c("el-col",{staticClass:"visibility-hide-actions",attrs:{span:3}},[_c("img",{staticClass:"delete-icon pointer",staticStyle:{height:"18px",width:"18px","margin-left":"32px","margin-top":"10px"},attrs:{src:__webpack_require__(353654)},on:{click:function($event){return _vm.addRow()}}})])],1)])],1):_c("div",_vm._l(_vm.urls,(function(url,index){return _c("el-row",{key:index,staticClass:"visibility-visible-actions"},[_c("div",{staticClass:"mT20"},[_c("el-col",{staticClass:"el-select-block",attrs:{span:19}},[_c("el-input",{staticClass:"fc-input-full-border2",on:{change:function($event){return _vm.update(url)}},model:{value:_vm.urls[index],callback:function($$v){_vm.$set(_vm.urls,index,$$v)},expression:"urls[index]"}})],1),_c("el-col",{staticClass:"visibility-hide-actions",attrs:{span:5}},[_c("img",{staticClass:"delete-icon pointer",staticStyle:{height:"18px",width:"18px","margin-left":"32px","margin-top":"10px"},attrs:{src:__webpack_require__(353654)},on:{click:function($event){return _vm.addRow()}}}),!_vm.$validation.isEmpty(_vm.urls)&&_vm.urls.length>1?_c("img",{staticClass:"delete-icon pointer",staticStyle:{height:"18px",width:"18px","margin-left":"10px"},attrs:{src:__webpack_require__(385769)},on:{click:function($event){return _vm.deleteRow(index)}}}):_vm._e()])],1)])})),1)])],1)},UrlAttachmentvue_type_template_id_6a442304_staticRenderFns=[],UrlAttachmentvue_type_script_lang_js={data:function(){return{}},props:["urlArray"],computed:{urls:{get:function(){return this.urlArray},set:function(value){this.$emit("update:urlArray",value)}}},methods:{update:function(){},addRow:function(){this.urls.push("")},deleteRow:function(index){this.urls.splice(index,1)}}},email_attachment_UrlAttachmentvue_type_script_lang_js=UrlAttachmentvue_type_script_lang_js,UrlAttachment_component=(0,componentNormalizer/* default */.Z)(email_attachment_UrlAttachmentvue_type_script_lang_js,UrlAttachmentvue_type_template_id_6a442304_render,UrlAttachmentvue_type_template_id_6a442304_staticRenderFns,!1,null,null,null)
/* harmony default export */,UrlAttachment=UrlAttachment_component.exports,FileFieldAttachmentvue_type_template_id_17916132_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("el-form",[_c("el-row",[_c("div",[_c("el-col",{staticClass:"el-select-block",attrs:{span:24}},[_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{filterable:"",clearable:"",multiple:"",placeholder:"Select File Fields"},model:{value:_vm.fileFields,callback:function($$v){_vm.fileFields=$$v},expression:"fileFields"}},_vm._l(_vm.fileFieldsList,(function(fileField,index){return _c("el-option",{key:index,attrs:{label:fileField.displayName||fileField.name,value:fileField.id}})})),1)],1)],1)])],1)],1)},FileFieldAttachmentvue_type_template_id_17916132_staticRenderFns=[],FileFieldAttachmentvue_type_script_lang_js={props:["fileFieldIds","fileFieldsList"],computed:{fileFields:{get:function(){return this.fileFieldIds},set:function(value){this.$emit("update:fileFieldIds",value)}}}},email_attachment_FileFieldAttachmentvue_type_script_lang_js=FileFieldAttachmentvue_type_script_lang_js,FileFieldAttachment_component=(0,componentNormalizer/* default */.Z)(email_attachment_FileFieldAttachmentvue_type_script_lang_js,FileFieldAttachmentvue_type_template_id_17916132_render,FileFieldAttachmentvue_type_template_id_17916132_staticRenderFns,!1,null,null,null)
/* harmony default export */,FileFieldAttachment=FileFieldAttachment_component.exports,vuex_esm=__webpack_require__(420629),validation=__webpack_require__(586529),FilesAttachmentvue_type_script_lang_js={props:["visibility","templateId","urlStringList","fileIdsList","attachmentsList","fileFieldIdsList"],components:{DirectFileAttachment:DirectFileAttachment,UrlAttachment:UrlAttachment,FileFieldAttachment:FileFieldAttachment},data:function(){return{canShowPreview:!0,selectedAttachment:null,fileFieldsList:[],attachments:[],urlArray:[],fileIds:[],fileFieldIds:[]}},computed:(0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({moduleMeta:function(state){return state.view.metaInfo}})),mounted:function(){this.init()},methods:{init:function(){var urlStringList=this.urlStringList,fileIdsList=this.fileIdsList,fileFieldIdsList=this.fileFieldIdsList;this.urlArray=urlStringList||[],this.fileIds=fileIdsList||[],this.fileFieldIds=fileFieldIdsList||[],this.attachments=this.attachmentsList;var moduleMeta=this.moduleMeta;if(!(0,validation/* isEmpty */.xb)(moduleMeta)){var fields=moduleMeta.fields,fileFields=[];(0,validation/* isEmpty */.xb)(fields)||(fields.forEach((function(field){var _ref=field||{},dataTypeEnum=_ref.dataTypeEnum,displayType=_ref.displayType;(0,validation/* isEmpty */.xb)(displayType)||"FILE"!==displayType._name||(0,validation/* isEmpty */.xb)(dataTypeEnum)||"FILE"!==dataTypeEnum._name||fileFields.push(field)})),this.fileFieldsList=fileFields)}},addAttachment:function(file){this.addFileId(file.fileId)},addFileId:function(fileId){this.fileIds.push(fileId)},removeFileId:function(fileId,index){this.fileIds.splice(index,1)},handleAttachment:function(){},closeDialog:function(){this.$emit("update:visibility",!1)},actionSave:function(){var urlArray=this.urlArray,fileIds=this.fileIds,attachments=this.attachments,fileFieldIds=this.fileFieldIds;this.closeDialog(),this.$emit("onSave",urlArray,fileIds,attachments,fileFieldIds)}}},email_attachment_FilesAttachmentvue_type_script_lang_js=FilesAttachmentvue_type_script_lang_js,FilesAttachment_component=(0,componentNormalizer/* default */.Z)(email_attachment_FilesAttachmentvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FilesAttachment=FilesAttachment_component.exports},
/***/365565:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"d022638208d4baab3e4d8fbec8ac38ca.svg";
/***/},
/***/250620:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"03daa5e7a5fe4964f41cd5e0c6dbcdb3.svg";
/***/}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/17650.js.map