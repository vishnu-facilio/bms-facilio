(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[21479],{
/***/436756:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FDialogNew}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/FDialogNew.vue?vue&type=template&id=388b7f7a
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"costdialog",class:["f-dialog",_vm.customClass],attrs:{visible:_vm.visible,"before-close":_vm.close,width:_vm.width,"append-to-body":!0},on:{"update:visible":function($event){_vm.visible=$event}}},[_c("div",{staticClass:"f-dialog-title",attrs:{slot:"title"},slot:"title"},[_vm._t("header",(function(){return[_c("div",{staticClass:"label-txt-black fwBold"},[_vm._v(" "+_vm._s(_vm.title)+" ")])]}))],2),_c("div",{staticClass:"f-dialog-content",style:_vm.styleCss},[_vm._t("content"),_vm._t("default")],2),_c("div",{staticClass:"f-footer row",staticStyle:{height:"46px"}},[_vm._t("footer",(function(){return[_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.close}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.loading},on:{click:_vm.save}},[_vm._v(_vm._s(_vm.loading?_vm.loadingTitle||"Saving...":_vm.confirmTitle||"Save"))])],1)]}))],2)])},staticRenderFns=[],FDialogNewvue_type_script_lang_js={props:["title","confirmTitle","visible","customClass","width","maxHeight","stayOnSave","loading","loadingTitle","record"],computed:{styleCss:function(){return this.maxHeight?{"max-height":this.maxHeight,overflow:"scroll"}:null}},methods:{close:function(){this.$emit("close"),this.$emit("update:visible",!1)},save:function(){this.$emit("save"),this.stayOnSave||this.$emit("update:visible",!1)}}},components_FDialogNewvue_type_script_lang_js=FDialogNewvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FDialogNewvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FDialogNew=component.exports},
/***/821479:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return PivotReportSideBar}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/energy/pivot/PivotReportSideBar.vue?vue&type=template&id=6128198d
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("div",{staticClass:"pivot-reports-sidebar"},[_c("div",{staticClass:"report-header-section"},[_c("div",{staticClass:"pivot-report-title flex-middle"},[_c("div",{staticClass:"pivot-summary-all-pivots"},[_c("el-popover",{attrs:{placement:"bottom-start",width:"185",trigger:"click"}},[_c("div",{staticStyle:{display:"flex","align-items":"center","margin-top":"10px"}},[_c("img",{staticClass:"report-icon flex icon",staticStyle:{height:"14px",width:"14px","margin-left":"2px","margin-right":"8px"},attrs:{src:__webpack_require__(598685)}}),_c("span",{staticStyle:{cursor:"pointer"},on:{click:_vm.loadScheduleReports}},[_vm._v("Scheduled Reports")])]),_c("div",{staticStyle:{display:"flex","align-items":"center","margin-top":"10px"}},[_c("InlineSvg",{staticStyle:{"margin-top":"4px","margin-right":"5px"},attrs:{src:"svgs/pivot/Manage",iconClass:"icon icon-sm"}}),_c("span",{staticStyle:{cursor:"pointer"},on:{click:_vm.loadPivotFolderManager}},[_vm._v("Manage Folders")])],1),_c("span",{staticStyle:{"letter-spacing":"0.5px",cursor:"pointer"},attrs:{slot:"reference"},on:{click:function($event){_vm.visible=!_vm.visible}},slot:"reference"},[_vm._v("Folders"),_c("i",{staticClass:"el-icon-arrow-down",staticStyle:{"font-size":"13px","font-weight":"1000","margin-left":"4px",cursor:"pointer","text-transform":"capitalize"}})])])],1)])]),_c("div",{staticClass:"search-container mT15 mB25 pR10 pL10"},[_c("el-input",{staticClass:"fc-input-full-border2 pL5",attrs:{placeholder:"Search",type:"search","prefix-icon":"el-icon-search"},model:{value:_vm.searchText,callback:function($$v){_vm.searchText=$$v},expression:"searchText"}})],1),_c("div",{staticClass:"rtree"},[_c("div",{staticClass:"report-sidebar-scroll"},[_vm.loading?_c("spinner",{attrs:{show:_vm.loading}}):_c("div",[_vm.newReportTree.length||_vm.reportTree.length?_vm._e():_c("div",{staticClass:"p15 flex-middle height80vh justify-content-center flex-direction-column"},[_c("div",[_c("inline-svg",{attrs:{src:"svgs/emptystate/reportlist",iconClass:"icon text-center icon-xxxlg"}})],1),_c("div",{staticClass:"nowo-label"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.no_reports"))+" ")])]),_vm.newReportTree?_c("div",{staticClass:"pB100 folder-list-container"},_vm._l(_vm.reportFoldersList,(function(folder,index2){return _c("div",{key:"new_"+index2,staticClass:"folder-container",attrs:{id:""+folder.id}},[_c("el-collapse",{attrs:{accordion:""},model:{value:_vm.expandFolder,callback:function($$v){_vm.expandFolder=$$v},expression:"expandFolder"}},[_c("el-collapse-item",{attrs:{name:folder.id}},[_c("template",{slot:"title"},[_c("div",{staticClass:"folder-title-section",on:{click:function($event){return $event.stopPropagation(),function(e){return _vm.folderClicked(folder,e)}.apply(null,arguments)}}},[_c("div",{staticClass:"report-folder-icon-section"},[_c("img",{attrs:{src:__webpack_require__(995637)}})]),_c("div",{staticClass:"r-folder-name"},[_vm._v(" "+_vm._s(folder.name)+" ")])])]),_c("draggable",{staticClass:"rfolder-children",attrs:{options:{group:"report"}},model:{value:folder.reports,callback:function($$v){_vm.$set(folder,"reports",$$v)},expression:"folder.reports"}},[folder.reports.length?_vm._e():_c("div",{staticClass:"rempty",staticStyle:{"margin-left":"30px"}},[_vm._v(" -- "+_vm._s(_vm.$t("common.wo_report.no_reports"))+" -- ")])])],2)],1)],1)})),0):_vm._e()])],1)])]),_vm.showDialog?_c("div",[_vm.showDialog?_c("f-dialog",{attrs:{visible:_vm.showDialog,width:"30%",confirmTitle:_vm.$t("common._common._save"),stayOnSave:!0,customClass:"qr-dialog"},on:{"update:visible":function($event){_vm.showDialog=$event},save:function($event){return _vm.addFolderPermission()},close:function($event){_vm.showDialog=!1}}},[_c("div",{staticClass:"fc-setup-modal-title"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.sharing_permission"))+" ")]),_c("div",{staticClass:"mT10"},[_c("div",[_c("el-radio",{staticClass:"fc-radio-btn pB10 pT10",attrs:{label:1},model:{value:_vm.shareTo,callback:function($$v){_vm.shareTo=$$v},expression:"shareTo"}},[_vm._v(_vm._s(_vm.$t("common.wo_report.only_me")))])],1),_c("div",[_c("el-radio",{staticClass:"fc-radio-btn pB10",attrs:{label:2},model:{value:_vm.shareTo,callback:function($$v){_vm.shareTo=$$v},expression:"shareTo"}},[_vm._v(_vm._s(_vm.$t("common.wo_report.everyone")))])],1),_c("div",[_c("el-radio",{staticClass:"fc-radio-btn pB10",attrs:{label:3},model:{value:_vm.shareTo,callback:function($$v){_vm.shareTo=$$v},expression:"shareTo"}},[_vm._v(_vm._s(_vm.$t("common.wo_report.specific")))])],1),3===_vm.shareTo?_c("el-row",{staticClass:"mT20 el-select-block"},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"label-txt-black pB5"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.team"))+" ")]),_c("el-select",{staticClass:"width100 fc-full-border-select-multiple2",attrs:{filterable:"",multiple:"","collapse-tags":"",placeholder:_vm.$t("common.wo_report.choose_users")},model:{value:_vm.sharedGroups,callback:function($$v){_vm.sharedGroups=$$v},expression:"sharedGroups"}},_vm._l(_vm.groups,(function(group){return _c("el-option",{key:group.id,attrs:{label:group.name,value:group.id}})})),1)],1)],1):_vm._e(),3===_vm.shareTo?_c("el-row",{staticClass:"mT20 el-select-block"},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"label-txt-black pB5"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.role"))+" ")]),_c("el-select",{staticClass:"width100 fc-full-border-select-multiple2",attrs:{filterable:"",multiple:"","collapse-tags":"",placeholder:_vm.$t("common.wo_report.choose_roles")},model:{value:_vm.sharedRoles,callback:function($$v){_vm.sharedRoles=$$v},expression:"sharedRoles"}},_vm._l(_vm.roles,(function(role){return _c("el-option",{key:role.id,attrs:{label:role.name,value:role.id}})})),1)],1)],1):_vm._e(),3===_vm.shareTo?_c("el-row",{staticClass:"mT20 el-select-block"},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"label-txt-black pB5"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.staff"))+" ")]),_c("el-select",{staticClass:"width100 fc-full-border-select-multiple2",attrs:{filterable:"",multiple:"","collapse-tags":"",placeholder:_vm.$t("common.wo_report.choose_teams")},model:{value:_vm.sharedUsers,callback:function($$v){_vm.sharedUsers=$$v},expression:"sharedUsers"}},_vm._l(_vm.users,(function(user){return _c("el-option",{key:user.id,attrs:{label:user.name,value:user.id}})})),1)],1)],1):_vm._e()],1),_c("div",{staticStyle:{padding:"25px 0px"}})]):_vm._e()],1):_vm._e()])},staticRenderFns=[],createForOfIteratorHelper=__webpack_require__(566347),objectSpread2=__webpack_require__(595082),vuedraggable_umd=(__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(670560),__webpack_require__(538077),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(434284),__webpack_require__(162506),__webpack_require__(450886),__webpack_require__(425728),__webpack_require__(564043),__webpack_require__(857267),__webpack_require__(909980)),vuedraggable_umd_default=__webpack_require__.n(vuedraggable_umd),ReportHelper=__webpack_require__(507815),FDialogNew=__webpack_require__(436756),vuex_esm=__webpack_require__(420629),validation=__webpack_require__(990260),api=__webpack_require__(32284),router=__webpack_require__(329435),PivotReportSideBarvue_type_script_lang_js={props:["isPivot"],mixins:[ReportHelper/* default */.Z],components:{draggable:vuedraggable_umd_default(),FDialog:FDialogNew/* default */.Z},data:function(){return{loading:!0,shareTo:2,reportSharing:[],sharedGroups:[],sharedUsers:[],sharedRoles:[],reportTree:[],showDialog:!1,newReportTree:[],newFolderName:"",folderShow:!1,folderState:{},editFolderId:null,reportFolderId:null,ids:[],searchText:"",expandFolder:[],visible:!1}},created:function(){this.$store.dispatch("loadRoles"),this.$store.dispatch("loadGroups"),this.$store.dispatch("loadUsers")},watch:{moduleName:{handler:function(){this.loadNewReportTree(),this.loadReportTree()},immediate:!0},newReportTree:{handler:function(newState){0==newState.length?this.$emit("foldersEmpty"):this.$emit("foldersNotEmpty")}}},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({groups:function(state){return state.groups},users:function(state){return state.users},roles:function(state){return state.roles}})),(0,vuex_esm/* mapGetters */.Se)(["getCurrentUser"])),{},{moduleName:function(){var _ref=this.$route.meta||{},moduleName=_ref.module;return(0,validation/* isEmpty */.xb)(moduleName)&&(moduleName=this.$attrs.moduleName),moduleName},reportFoldersList:function(){var _this=this;return this.expandFolder=[],(0,validation/* isEmpty */.xb)(this.searchText)?this.newReportTree:(this.newReportTree.forEach((function(folder){_this.expandFolder.push(folder.id)})),this.newReportTree.reduce((function(res,folder){var filteredReports=folder.reports.filter((function(report){return report.name.toLowerCase().includes(_this.searchText.toLowerCase())}));return(0,validation/* isEmpty */.xb)(filteredReports)||res.push((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},folder),{},{reports:filteredReports})),res}),[]))},createPermission:function(){var moduleName=this.moduleName;return(0,router/* isWebTabsEnabled */.tj)()&&moduleName||(moduleName=(this.getCurrentModule()||{}).module),"energydata"===moduleName&&(moduleName="energy"),!["workorder","alarm","energy"].includes(moduleName)||this.$hasPermission(moduleName+":CREATE_EDIT_REPORTS")},isModuleReport:function(){var moduleName=this.moduleName;return(0,router/* isWebTabsEnabled */.tj)()&&moduleName||(moduleName=(this.getCurrentModule()||{}).module),moduleName&&"energydata"!==moduleName},reportId:function(){var reportId=this.$route.params.id&&!isNaN(this.$route.params.id)?parseInt(this.$route.params.id):null;return reportId&&reportId>0?reportId:this.$attrs.reportid?parseInt(reportId):null}}),methods:{loadPivotFolderManager:function(){if((0,router/* isWebTabsEnabled */.tj)()){var _findRouteForTab=(0,router/* findRouteForTab */.OD)(router/* pageTypes */.As.PIVOT_VIEW_MANAGER),name=_findRouteForTab.name;this.$router.push({path:this.$router.resolve({name:name}).href,query:{activeTab:"folderViews"}})}else this.$router.push("/app/em/pivot/foldermanager?activeTab=folderViews")},loadScheduleReports:function(){if((0,router/* isWebTabsEnabled */.tj)()){var _findRouteForTab2=(0,router/* findRouteForTab */.OD)(router/* pageTypes */.As.PIVOT_VIEW_MANAGER),name=_findRouteForTab2.name;this.$router.push({path:this.$router.resolve({name:name}).href,query:{activeTab:"ScheduleViews"}})}else this.$router.push("/app/em/pivot/foldermanager?activeTab=ScheduleViews")},collapseControl:function(id){-1!==this.expandFolder.indexOf(id)||isNaN(id)?isNaN(id)||this.expandFolder.splice(this.expandFolder.indexOf(id),1):this.expandFolder.push(parseInt(id));
// if (this.expandFolder.find(f => f == id) == -1) this.expandFolder.push(id)
},
// folderSelected(event){
//   let heading=event.target.closest('.el-collapse-item__header')
//   heading.classList.add('is-active')
//   console.log(headiing)
// },
folderClicked:function(folder,event){this.toggleIsActive();//removes highlight for previously selected folder
var activeFolder=document.getElementById("".concat(folder.id));activeFolder.classList.add("selected-folder");var pivot_reports_list_sidebar=this.$refs["pivot_reports_list_sidebar"];pivot_reports_list_sidebar&&pivot_reports_list_sidebar.length>0&&pivot_reports_list_sidebar.forEach((function(report_list_active){report_list_active.classList.remove("active")}));var route_url="/app/em/pivot/view?folderId=".concat(folder.id);if((0,router/* isWebTabsEnabled */.tj)()){var _findRouteForTab3=(0,router/* findRouteForTab */.OD)(router/* pageTypes */.As.PIVOT_VIEW),name=_findRouteForTab3.name;route_url=this.$router.resolve({name:name,query:{folderId:folder.id}}).href}history.replaceState({},"",window.location.origin+route_url),this.$emit("folderClicked",folder),this.$emit("clearReport")},updateReports:function(report){this.newReportTree.forEach((function(folder){return folder.reports.forEach((function(r,index,reports){r.id==report.id&&reports.splice(index,1)}))}))},showPermissionDialig:function(folder){if(this.sharedGroups=[],this.sharedUsers=[],this.sharedRoles=[],folder&&folder.reportSharing&&folder.reportSharing.length>0){if(folder.reportSharing.length>1){this.shareTo=3;var _step,_iterator=(0,createForOfIteratorHelper/* default */.Z)(folder.reportSharing);try{for(_iterator.s();!(_step=_iterator.n()).done;){var sharing=_step.value;1===sharing.type?this.sharedUsers.push(sharing.userId):2===sharing.type?this.sharedRoles.push(sharing.roleId):3===sharing.type&&this.sharedGroups.push(sharing.groupId)}}catch(err){_iterator.e(err)}finally{_iterator.f()}}else 1===folder.reportSharing.length&&folder.reportSharing[0].userId===this.getCurrentUser().ouid&&(this.shareTo=1);for(var i=0;i<folder.reportSharing.length;i++)this.ids.push(folder.reportSharing[i].id)}else this.shareTo=2;this.reportFolderId=folder.id,this.showDialog=!0},addFolderPermission:function(){var _this2=this,self=this,moduleName=this.getCurrentModule().module;this.applySharing();var apiUrl=null;return apiUrl="undefined"!==typeof moduleName&&moduleName?"/v3/report/folder/permission/update?moduleName="+moduleName:"/v3/report/folder/permission/update?moduleName=energydata",new Promise((function(resolve,reject){var a={reportFolder:{reportSharing:_this2.reportSharing,ids:_this2.ids},folderId:_this2.reportFolderId};api/* API */.bl.put(apiUrl,a).then((function(response){response.error||(self.loadNewReportTree(),self.showDialog=!1)})).catch((function(error){error&&reject(error)}))}))},applySharing:function(){var self=this;if(this.reportSharing=[],1===self.shareTo)this.reportSharing.push({type:1,userId:self.getCurrentUser().ouid});else if(3===self.shareTo){if(self.sharedUsers.length>0){this.reportSharing.push({type:1,userId:self.getCurrentUser().ouid});for(var i=0;i<self.sharedUsers.length;i++)self.sharedUsers[i]!==self.getCurrentUser().ouid&&this.reportSharing.push({type:1,userId:self.sharedUsers[i]})}if(self.sharedRoles.length>0)for(var _i=0;_i<self.sharedRoles.length;_i++)this.reportSharing.push({type:2,roleId:self.sharedRoles[_i]});if(self.sharedGroups.length>0)for(var _i2=0;_i2<self.sharedGroups.length;_i2++)this.reportSharing.push({type:3,groupId:self.sharedGroups[_i2]})}},toggleEditFolder:function(folder){var _this3=this;this.editFolderId=folder.id,this.$nextTick((function(){Array.isArray(_this3.$refs["FolderName"])?_this3.$refs["FolderName"][0].focus():_this3.$refs["FolderName"].focus()}))},editFolderName:function(folder){var _this4=this,newName=this.folderState[folder.id].newName;if(""!==newName&&null!==newName){var reportFolder={};reportFolder["name"]=newName,reportFolder["id"]=folder.id,this.editFolderId=null,api/* API */.bl.put("/v3/report/folder/update",{reportFolder:reportFolder}).then((function(response){response.error?(_this4.$message({message:_this4.$t("common.wo_report.cannot_rename_folder"),type:"error"}),folder.name=_this4.folderState[folder.id].name):(folder.name=response.data.reportFolder.name,_this4.folderState[folder.id].name=folder.name,_this4.folderState[folder.id].newName=folder.name)})).catch((function(){_this4.$message({message:_this4.$t("common.wo_report.cannot_rename_folder"),type:"error"}),folder.name=_this4.folderState[folder.id].name}))}else this.$message({message:this.$t("common.wo_report.foldername_cannot_empty"),type:"error"});this.$forceUpdate()},addNewFolder:function(){var _this5=this,newFolder={};if(""===this.newFolderName||null===this.newFolderName)this.newFolderError=!0;else{newFolder["name"]=this.newFolderName;var moduleName=this.getCurrentModule().module;this.folderShow=!1,api/* API */.bl.post("/v3/report/folder/create",{reportFolder:newFolder,moduleName:moduleName}).then((function(response){if(response.error)_this5.$message.error("Error while creating report folder");else{_this5.newFolderName="";var _newFolder=response.data.reportFolder;_newFolder.reports=[],_this5.newReportTree.push(_newFolder);var folderState={};folderState["name"]=_newFolder.name,folderState["newName"]=_newFolder.name,folderState["setting"]=!1,_this5.folderState[_newFolder.id]=folderState}}))}},moveReport:function(currentFolder,newFolder,report){var curIndex,newIndex,reportIndex,_this6=this;for(var key in this.$set(this.folderState[currentFolder.id],"setting",!1),this.newReportTree)this.newReportTree[key].name===currentFolder.name&&(curIndex=key,reportIndex=this.newReportTree[key].reports.indexOf(report)),this.newReportTree[key].name===newFolder.name&&(newIndex=key);api/* API */.bl.put("/v3/report/moveto",{reportId:report.id,folderId:newFolder.id}).then((function(response){_this6.newReportTree[curIndex].reports.splice(reportIndex,1),_this6.newReportTree[newIndex].reports.push(report)})).catch((function(){_this6.$message({message:_this6.$t("common.wo_report.cannot_move_report"),type:"error"})}))},loadReportTree:function(){var self=this,moduleName=this.$route.query.module?this.$route.query.module:this.getCurrentModule().module;"energy"===moduleName&&(moduleName="energyData"),"custom"!==moduleName&&self.$http.get("/report/workorder/getAllWorkOrderReports?moduleName="+moduleName).then((function(response){var data=response.data.allWorkOrderJsonReports,treeData=data.map((function(d){if(d.expand=!1,self.reportId){var report=d.children.find((function(rt){return rt.widget.dataOptions.reportId===self.reportId}));report&&(d.expand=!0)}return d}));self.reportTree=treeData.filter((function(row){return"Default"!==row.label&&"Old Reports"!==row.label}))}))},loadNewReportTree:function(){var _this7=this,self=this,moduleName=this.getCurrentModule().module;this.$route.query.module&&(moduleName=this.$route.query.module),"energy"===moduleName&&(moduleName="energyData");var url="/v3/report/folders?moduleName="+moduleName;"custom"===moduleName&&(url="/v3/report/folders?moduleName=custommodule"),this.isPivot&&(url+="&isPivot=true"),api/* API */.bl.get(url).then((function(resp){if(resp.error)self.loading=!1;else{var data=resp.data.reportFolders,treeData=data.map((function(d){if(d.expand=!1,self.reportId){var report=d.reports.find((function(rt){return rt.id===self.reportId}));report&&(d.expand=!0)}return d}));if(self.newReportTree=treeData,_this7.$route.query.folderId){
// this.expandFolder.push(parseInt(this.$route.query.folderId))
var folder=_this7.newReportTree.find((function(f){return f.id==parseInt(_this7.$route.query.folderId)}));_this7.$emit("folderClicked",folder)}else self.newReportTree.length>0&&
// this.expandFolder.push(self.newReportTree[0].id)
_this7.$emit("folderClicked",self.newReportTree[0]);for(var key in self.loading=!1,self.newReportTree){var _folder=self.newReportTree[key],folderState={};folderState["name"]=_folder.name,folderState["newName"]=_folder.name,folderState["setting"]=!1,folderState["editFolder"]=!1,self.folderState[_folder.id]=folderState}}})),this.$emit("sidebarLoaded")},openFirstReport:function(){var reportLink;this.loading||this.reportId||this.$route.path.includes("scheduled")||(this.newReportTree.length&&this.newReportTree[0].reports.length?(this.newReportTree[0].expand=!0,reportLink=this.getNewReportLink(this.newReportTree[0].reports[0].id)):this.reportTree.length&&this.reportTree[0].children.length&&(this.reportTree[0].expand=!0,reportLink=this.getReportLink(this.reportTree[0].children[0].widget.dataOptions.reportId)),(0,validation/* isEmpty */.xb)(reportLink)||this.$router.replace({path:reportLink}))},isActiveReport:function(report){return this.toggleIsActive(),this.reportId===report.id},loadReport:function(report){var reportLink=this.getNewReportLink(report.id);this.$emit("reportChanged",report),this.$route.params.id!=report.id&&this.$router.replace({path:reportLink}),this.toggleIsActive()},toggleIsActive:function(){var headers=document.querySelectorAll("div.is-active");headers.forEach((function(h){return h.classList.remove("is-active")}));var prevActiveFolders=document.querySelectorAll(".selected-folder");prevActiveFolders.forEach((function(af){var _af$classList;return null===af||void 0===af||null===(_af$classList=af.classList)||void 0===_af$classList?void 0:_af$classList.remove("selected-folder")}))},removeReport:function(obj){var reportsType=obj.type,reportId=obj.reportId;if("new"===reportsType){if(this.newReportTree){var _step2,_iterator2=(0,createForOfIteratorHelper/* default */.Z)(this.newReportTree);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var folder=_step2.value,rep=folder.reports.find((function(rt){return rt.id===parseInt(reportId)}));if(rep){var reportIndex=folder.reports.indexOf(rep);if(reportIndex>=0){if(folder.reports.splice(reportIndex,1),reportIndex<folder.reports.length){var reportLink=this.getNewReportLink(folder.reports[reportIndex].id);return void this.$router.replace({path:reportLink})}if(reportIndex-1<folder.reports.length){var _reportLink=this.getNewReportLink(folder.reports[reportIndex-1].id);return void this.$router.replace({path:_reportLink})}}}}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}}else{var _step3,_iterator3=(0,createForOfIteratorHelper/* default */.Z)(this.reportTree);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var _folder2=_step3.value,_rep=_folder2.children.find((function(rt){return rt.widget.dataOptions.reportId===parseInt(reportId)}));if(_rep){var _reportIndex=_folder2.children.indexOf(_rep);if(_reportIndex>=0){if(_folder2.children.splice(_reportIndex,1),_reportIndex<_folder2.children.length){var _reportLink2=this.getReportLink(_folder2.children[_reportIndex].widget.dataOptions.reportId);return void this.$router.replace({path:_reportLink2})}if(_reportIndex-1<_folder2.children.length){var _reportLink3=this.getReportLink(_folder2.children[_reportIndex-1].widget.dataOptions.reportId);return void this.$router.replace({path:_reportLink3})}}}}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}}this.$router.push({path:this.getCurrentModule(!0).rootPath})},deleteReportFolder:function(folder){var self=this,promptObj={title:self.$t("common.wo_report.delete_folder"),message:self.$t("common.wo_report.delete_folder_msg"),rbDanger:!0,rbLabel:self.$t("common._common.delete")};self.$dialog.confirm(promptObj).then((function(value){value&&api/* API */.bl.post("/v3/report/folder/delete",{reportFolder:folder}).then((function(response){if(response.error)self.$message({message:self.$t("common.wo_report.cannot_delete_msg"),type:"error"});else{var index=self.newReportTree.indexOf(folder);self.newReportTree.splice(index,1),self.$message({message:self.$t("common.wo_report.folder_delete_success"),type:"success"})}})).catch((function(error){self.$message({message:self.$t("common.wo_report.cannot_delete_msg"),type:"error"})}))}))},expand:function(folder){folder.expand=!folder.expand},getReportLink:function(reportId){var rootPath=this.getCurrentModule(!0).rootPath;return rootPath+"/view/"+reportId},getNewReportLink:function(reportId){if((0,router/* isWebTabsEnabled */.tj)()){var routeObj=(0,router/* findRouteForTab */.OD)(router/* pageTypes */.As.PIVOT_VIEW),_ref2=routeObj||{},name=_ref2.name;return name?this.$router.resolve({name:name,params:{reportId:reportId}}).href:null}return"/app/em/pivot/view/".concat(reportId)},openScheduledReports:function(){var path;if((0,router/* isWebTabsEnabled */.tj)()){var routeObj;routeObj=this.moduleName?"energydata"===this.moduleName?(0,router/* findRouteForReport */.Mq)("analytics_reports",router/* pageTypes */.As.REPORT_SCHEDULED,{moduleName:this.moduleName}):(0,router/* findRouteForReport */.Mq)("module_reports",router/* pageTypes */.As.REPORT_SCHEDULED,{moduleName:this.moduleName}):(0,router/* findRouteForReport */.Mq)("analytics_reports",router/* pageTypes */.As.REPORT_SCHEDULED);var _ref3=routeObj||{},name=_ref3.name;name&&(path=this.$router.resolve({name:name}).href)}else path="".concat(this.getCurrentModule(!0).rootPath,"/scheduled");path&&this.$router.push({path:path})},handleReportCommond:function(cmd){if("delete"===cmd){var self=this,promptObj={title:self.$t("common.wo_report.delete_report"),rbLabel:"Delete"};self.$dialog.prompt(promptObj)}else"edit"===cmd&&this.$router.replace({path:this.getCurrentModule(!0).rootPath+"/edit"})},createNewReport:function(){this.isPivot?this.$router.push({name:"pivotcreate"}):this.isModuleReport&&this.newModularReport()},newModularReport:function(){var moduleName=this.getCurrentModule().module;if((0,router/* isWebTabsEnabled */.tj)()){var _ref4=(0,router/* findRouteForReport */.Mq)("module_reports",router/* pageTypes */.As.REPORT_FORM,{moduleName:moduleName})||{},name=_ref4.name;name&&this.$router.push({name:name})}else if(this.$helpers.isEtisalat())this.$router.push({path:"/app/em/modulereports/new"});else switch(moduleName){case"workorder":this.$router.push({path:"/app/wo/reports/new"});break;case"asset":this.$router.push({path:"/app/at/reports/new"});break;case"alarm":this.$router.push({path:"/app/fa/reports/new"});break;case"custom":this.$router.push({path:"/app/ca/reports/new"});break;case"tenant":this.$router.push({path:"/app/tm/reports/new"});break;case"contracts":this.$router.push({path:"/app/ct/reports/new"});break;case"visitorlog":this.$router.push({path:"/app/vi/reports/new"});break;case"serviceRequest":this.$router.push({path:"/app/sr/reports/new"});break;case"purchaseorder":this.$router.push({path:"/app/purchase/reports/new"});break;case"budget":case"budgetamount":this.$router.push({path:"/app/ac/reports/new"});break;case"item":case"tool":case"itemTransactions":case"tootTransactions":case"itemTypes":case"toolTypes":case"storeRoom":case"shipment":case"transferrequest":case"transferrequestshipmentreceivables":case"transferrequestpurchaseditems":this.$router.push({path:"/app/inventory/reports/new"});break;default:this.$router.push({path:"/app/at/reports/new"});break}},handleNewCommand:function(cmd){if("reportfolder"===cmd){var self=this,promptObj={title:self.$t("common.wo_report.new_report_folder"),promptPlaceholder:self.$t("common.wo_report.folder_name"),rbLabel:"Save"};self.$dialog.prompt(promptObj).then((function(value){if(null!==value){var reportFolderObj={name:value};self.$http.post("dashboard/addReportFolder?moduleName="+self.getCurrentModule().module,{reportFolderContext:reportFolderObj}).then((function(response){response.data.reportFolderContext?(self.$message({message:self.$t("common.wo_report.folder_created_success"),type:"success"}),self.reportTree.push(response.data.reportFolderContext)):self.$message({message:self.$t("common.wo_report.folder_creation_failed"),type:"warning"})}))}}))}else"tabular"===cmd?this.$router.replace({path:this.getCurrentModule(!0).rootPath+"/newtabular"}):"matrix"===cmd?this.$router.replace({path:this.getCurrentModule(!0).rootPath+"/newmatrix"}):this.$router.replace({path:this.getCurrentModule(!0).rootPath+"/new"})}}},pivot_PivotReportSideBarvue_type_script_lang_js=PivotReportSideBarvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(pivot_PivotReportSideBarvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,PivotReportSideBar=component.exports},
/***/995637:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"28819f73626316ae9c1527b9dd5cba58.svg";
/***/},
/***/598685:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"274712e4f5ec9e2930d39e8197292de9.svg";
/***/}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/21479.js.map