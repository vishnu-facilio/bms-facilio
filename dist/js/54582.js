(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[54582],{
/***/929593:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FPagination}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/list/FPagination.vue?vue&type=template&id=7641710c&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_vm.total>0?_c("div",{staticClass:"flex-center-row-space mT-5",class:{"fc-black-small-txt-12":!_vm.hideToggle}},[_c("el-popover",{attrs:{placement:"bottom",trigger:"click",disabled:_vm.disablePopup}},[_c("span",{staticClass:"p8 pointer",class:[!_vm.disablePopup&&"button-hover"],attrs:{slot:"reference"},slot:"reference"},[_vm.from!==_vm.to?_c("span",[_vm._v(_vm._s(_vm.from)+" - ")]):_vm._e(),_c("span",[_vm._v(_vm._s(_vm.to))]),_vm._v(" of "+_vm._s(_vm.total)+" ")]),_c("el-pagination",{attrs:{layout:"prev, pager, next",total:_vm.total,"pager-count":5,"page-size":_vm.perPage,"current-page":_vm.page},on:{"current-change":_vm.handleCurrentChange,"update:pageSize":function($event){_vm.perPage=$event},"update:page-size":function($event){_vm.perPage=$event},"update:currentPage":function($event){_vm.page=$event},"update:current-page":function($event){_vm.page=$event}}})],1),_vm.hideToggle?_vm._e():_c("span",[_c("span",{staticClass:"el-icon-arrow-left pagination-arrow fc-black-small-txt-12 f16 fw-bold pointer p5",class:{disable:_vm.from<=1},on:{click:function($event){_vm.from>1&&_vm.prev()}}}),_c("span",{staticClass:"el-icon-arrow-right pagination-arrow fc-black-small-txt-12 f16 fw-bold pointer p5",class:{disable:_vm.to===_vm.total},on:{click:function($event){_vm.to!==_vm.total&&_vm.next()}}})])],1):_vm._e()])},staticRenderFns=[],router=(__webpack_require__(879288),__webpack_require__(670560),__webpack_require__(329435)),FPaginationvue_type_script_lang_js={props:{total:[Number,String],perPage:Number,hideToggle:{type:Boolean,default:!1},pageNo:Number,hidePopover:{type:Boolean,default:!1}},data:function(){return{from:0,to:0,page:1}},created:function(){(0,router/* isWebTabsEnabled */.tj)()&&document.addEventListener("keydown",this.keyDownHandler)},mounted:function(){this.init()},beforeDestroy:function(){(0,router/* isWebTabsEnabled */.tj)()&&document.removeEventListener("keydown",this.keyDownHandler)},computed:{pageQuery:function(){var _ref=this.$route||{},query=_ref.query,_ref2=query||{},page=_ref2.page;return parseInt(page)||1},hasMorePage:function(){return this.total/this.perPage>1},disablePopup:function(){return this.hidePopover||!this.hasMorePage}},watch:{total:function(){this.init()},pageQuery:function(){this.init()}},methods:{init:function(){if(this.page=this.pageQuery,this.from=(this.page-1)*this.perPage+1,this.from>this.total&&this.from&&this.from>0&&this.total&&this.total>0)this.reset();else{var to=this.from+this.perPage-1;this.to=this.total>to?to:this.total}},handleCurrentChange:function(val){this.page=val,this.from=(this.page-1)*this.perPage+1,this.to=this.total>=this.from+this.perPage?this.from+this.perPage-1:this.total,this.setPage()},next:function(){this.from=this.to+1,this.to+=this.perPage,this.to>this.total&&(this.to=this.total),this.page++,this.setPage()},prev:function(){this.to=this.from-1,this.from-=this.perPage,this.from<=1?this.from=this.page=1:this.page--,this.setPage()},reset:function(){this.page=1,this.setPage(!0)},setPage:function(isReset){if(this.pageNo)this.$emit("onPageChanged",this.page);else{var query={};Object.assign(query,this.$route.query),query?query.page=this.page:query={page:this.page},this.$router.push({query:query}),isReset||this.$emit("onPageChanged",this.page)}},keyDownHandler:function(e){e.shiftKey&&("ArrowRight"===e.key&&this.to!==this.total?this.next():"ArrowLeft"===e.key&&this.from>1&&this.prev())}}},list_FPaginationvue_type_script_lang_js=FPaginationvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(list_FPaginationvue_type_script_lang_js,render,staticRenderFns,!1,null,"7641710c",null)
/* harmony default export */,FPagination=component.exports},
/***/481582:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return AddPlannedInventory}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/workorder/jobplan/plannedInventory/AddPlannedInventory.vue?vue&type=template&id=bb6707b4&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{attrs:{visible:!0,fullscreen:!1,"before-close":_vm.onClose,open:"top","custom-class":"fc-dialog-up Inventoryaddvaluedialog","append-to-body":!0,width:"55%"}},[_c("div",[_c("div",{staticClass:"new-header-container pL30"},[_c("div",{staticClass:"fc-setup-modal-title"},[_vm._v(" "+_vm._s(_vm.getTitle)+" ")])]),_vm.inventoryList.length?_c("div",{staticClass:"new-header-container popup-container"},[_c("div",{staticClass:"search-container"},[_c("el-input",{staticClass:"el-input-textbox-full-border",attrs:{autofocus:!0,type:"text",placeholder:_vm.$t("common._common.search")},on:{change:_vm.loadInventory},model:{value:_vm.inventorySearchQuerry,callback:function($$v){_vm.inventorySearchQuerry=$$v},expression:"inventorySearchQuerry"}},[_c("span",{staticClass:"sub-divider"},[_vm._v("|")]),_c("i",{staticClass:"el-input__icon el-icon-search pointer search-text",attrs:{slot:"suffix"},slot:"suffix"})])],1),_c("div",{staticClass:"pagination"},[_vm.newItemPartToggle?_c("pagination",{attrs:{total:_vm.listCount,perPage:20,hidePopover:!0},on:{onPageChanged:_vm.onPageChange}}):_vm._e()],1)]):_vm._e(),_c("div",{staticClass:"fc-inv-container-body"},[_vm.inventoryListLoading?_c("table",{staticClass:"width100"},[_c("tr",[_c("td",{attrs:{colspan:"100%"}},[_c("div",{staticClass:"iTloading in-no-data"},[_c("spinner",{attrs:{show:!0,size:"80"}})],1)])])]):_c("table",{staticClass:"setting-list-view-table width100 invent-table-dialog inventor-store-adde-table"},[_vm.inventoryList.length?_c("tbody",[_vm._l(_vm.inventoryList,(function(inventory,index){return _c("tr",{key:inventory.id,staticClass:"tablerow asset-hover-td height100px"},[_c("td",{staticClass:"width80"},[_c("div",[_vm._v(_vm._s(_vm.$getProperty(inventory,"name")))]),_c("div",{staticClass:"item-description",class:_vm.getSubjectClassname(inventory,index)},[_vm._v(" "+_vm._s(_vm.$getProperty(inventory,"description"))+" ")]),_c("div",{staticClass:"flex flex-direction-row pT6"},[_vm.canShowMore(inventory)?_c("a",{staticClass:"text-capitalize letter-spacing0_3 f13 pR8 pointer",on:{click:function($event){return _vm.toggleVisibility(index)}}},[_vm._v(_vm._s(_vm.showMoreLinkText(index)))]):_vm._e()])]),_c("td",{staticClass:"width160px text-align-inventory"},[0===inventory.addedQuantity?[_c("el-button",{staticClass:"f-number-input",attrs:{size:"mini"},on:{click:function($event){return _vm.inventoryAdd(inventory)}}},[_vm._v(_vm._s(_vm.$t("common._common._add")))])]:[_c("el-input-number",{staticClass:"f-number-input",attrs:{size:"mini",min:0,max:inventory.quantity},on:{change:function($event){return _vm.check(inventory,index)}},model:{value:inventory.addedQuantity,callback:function($$v){_vm.$set(inventory,"addedQuantity",$$v)},expression:"inventory.addedQuantity"}})]],2)])}))],2):_c("tbody",[_c("tr",[_c("td",{attrs:{colspan:"100%"}},[_c("div",{staticClass:"flex-middle justify-content-center flex-direction-column"},[_c("inline-svg",{attrs:{src:"svgs/emptystate/inventory",iconClass:"icon text-center icon-100"}}),_c("div",{staticClass:"nowo-label"},[_vm._v(" "+_vm._s(_vm.getEmptyMessage)+" ")])],1)])])])])]),_c("div",{staticClass:"modal-dialog-footer-parts-dialog"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){return _vm.cancel()}}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",staticStyle:{"margin-left":"0px !important"},attrs:{type:"primary"},on:{click:function($event){return _vm.addPlannedItems()}}},[_vm._v(_vm._s(_vm.$t("common._common._add")))])],1)])])},staticRenderFns=[],createForOfIteratorHelper=__webpack_require__(566347),regeneratorRuntime=__webpack_require__(150124),defineProperty=__webpack_require__(482482),asyncToGenerator=__webpack_require__(548534),api=(__webpack_require__(976801),__webpack_require__(450886),__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(648324),__webpack_require__(564043),__webpack_require__(709873),__webpack_require__(670560),__webpack_require__(162506),__webpack_require__(32284)),validation=__webpack_require__(990260),filters=__webpack_require__(638203),InventoryPagination=__webpack_require__(926460),eventBus=__webpack_require__(398011),AddPlannedInventoryvue_type_script_lang_js={name:"AddPlannedInventory",props:["onClose","jobPlanId","moduleName","workOrderId"],components:{Pagination:InventoryPagination/* default */.Z},data:function(){return{selectedIndex:[],selectedInventory:null,inventoryList:[],newItemPartToggle:!0,inventorySearchQuerry:null,listCount:null,page:1,searchPage:1,inventoryListLoading:!1}},created:function(){this.loadInventory()},computed:{getTitle:function(){return["jobPlanItems","workOrderPlannedItems"].includes(this.moduleName)?this.$t("common.products.items_list"):this.$t("common.products.tools_list")},getEmptyMessage:function(){return["jobPlanItems","workOrderPlannedItems"].includes(this.moduleName)?this.$t("common.products.no_item_present"):this.$t("common.products.no_tools_present")}},methods:{check:function(inventory,index){0===inventory.addedQuantity&&((0,validation/* isEmpty */.xb)(this.$getProperty(this.inventoryList,"".concat(index,".checked")))||(this.inventoryList[index].checked=!0))},cancel:function(){this.onClose(),this.newItemPartToggle=!1},inventoryAdd:function(inventory){inventory.addedQuantity=1,inventory.checked=!0},onPageChange:function(pageNo){var inventorySearchQuerry=this.inventorySearchQuerry;this.page=pageNo,(0,validation/* isEmpty */.xb)(inventorySearchQuerry)||(this.searchPage=pageNo),this.loadInventory()},addPlannedItems:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var inventoryToBeAdded,moduleName,url,params,_yield$API$post,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(inventoryToBeAdded=_this.inventoryList.filter((function(inventory){return!0===inventory.checked})).map((function(inventory){var paramObj={quantity:inventory.addedQuantity};return["jobPlanItems","jobPlanTools"].includes(_this.moduleName)?paramObj["jobPlan"]={id:_this.jobPlanId}:paramObj["workOrder"]={id:_this.workOrderId},["jobPlanItems","workOrderPlannedItems"].includes(_this.moduleName)?paramObj["itemType"]={id:inventory.id}:["jobPlanTools","workOrderPlannedTools"].includes(_this.moduleName)&&(paramObj["toolType"]={id:inventory.id},paramObj["duration"]=1),paramObj})),!(inventoryToBeAdded.length>0)){_context.next=12;break}return moduleName=_this.moduleName,url="v3/modules/bulkCreate/".concat(moduleName),params={data:(0,defineProperty/* default */.Z)({},_this.moduleName,inventoryToBeAdded),moduleName:"".concat(_this.moduleName)},_context.next=7,api/* API */.bl.post(url,params);case 7:_yield$API$post=_context.sent,error=_yield$API$post.error,error?_this.$message.error(error.message||_this.$t("common._common.error_adding_inventory")):(_this.$message.success(_this.$t("common._common.added_successfully")),_this.cancel(),_this.$emit("save"),eventBus/* eventBus */.Y.$emit("reloadOverallCost")),_context.next=13;break;case 12:_this.$message.error(_this.$t("common._common.select_inventory_error"));case 13:case"end":return _context.stop()}}),_callee)})))()},loadInventory:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var page,inventorySearchQuerry,searchPage,params,isItemTypes,inventoryTypeName,_yield$API$fetchAll,list,error,_iterator,_step,inventory;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _this2.inventoryListLoading=!0,page=_this2.page,inventorySearchQuerry=_this2.inventorySearchQuerry,searchPage=_this2.searchPage,params={page:page,perPage:20,filters:JSON.stringify({isRotating:{operatorId:15,value:["false"]}})},inventorySearchQuerry&&(params.filters=JSON.stringify({isRotating:{operatorId:15,value:["false"]},name:{operatorId:5,value:["".concat(inventorySearchQuerry)]}}),_this2.$set(params,"page",searchPage)),isItemTypes=["jobPlanItems","workOrderPlannedItems"].includes(_this2.moduleName),inventoryTypeName=isItemTypes?"itemTypes":"toolTypes",_context2.next=8,api/* API */.bl.fetchAll(inventoryTypeName,params);case 8:if(_yield$API$fetchAll=_context2.sent,list=_yield$API$fetchAll.list,error=_yield$API$fetchAll.error,!error){_context2.next=16;break}return _this2.$message.error(error||_this2.$t("common._common.planned_inventory_list_error_msg")),_context2.abrupt("return",{});case 16:_this2.listCount=list.length,_iterator=(0,createForOfIteratorHelper/* default */.Z)(list);try{for(_iterator.s();!(_step=_iterator.n()).done;)inventory=_step.value,inventory.checked=!1,inventory.addedQuantity=0}catch(err){_iterator.e(err)}finally{_iterator.f()}_this2.inventoryList=list,_this2.inventoryListLoading=!1;case 21:case"end":return _context2.stop()}}),_callee2)})))()},showMoreLinkText:function(index){var selectedIndex=this.selectedIndex;return-1!==selectedIndex.indexOf(index)?"View Less":"View More"},canShowMore:function(itemType){var description=this.$getProperty(itemType,"description");if(description){var descriptionLength=description.length,htmlToString=(0,filters/* htmlToText */.s9)(description).split(/\r\n|\r|\n/).length;return htmlToString>2||descriptionLength>130}return!1},getSubjectClassname:function(itemType,index){return this.canShowMore(itemType)?-1!==this.selectedIndex.indexOf(index)?"description-content description-content-viewMore":"description-content description-content-viewLess":"popover-description"},toggleVisibility:function(index){var selectedIndex=this.selectedIndex;if(-1===selectedIndex.indexOf(index))selectedIndex.push(index);else{var indexOfDesc=selectedIndex.indexOf(index);selectedIndex.splice(indexOfDesc,1)}}}},plannedInventory_AddPlannedInventoryvue_type_script_lang_js=AddPlannedInventoryvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(plannedInventory_AddPlannedInventoryvue_type_script_lang_js,render,staticRenderFns,!1,null,"bb6707b4",null)
/* harmony default export */,AddPlannedInventory=component.exports},
/***/254582:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return PlannedInventoryTools}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/workorder/jobplan/plannedInventory/PlannedInventoryTools.vue?vue&type=template&id=cbce40de&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"p30 white-bg-block"},[_c("div",{staticClass:"inline-flex"},[_c("div",{staticClass:"fc-v1-icon-bg"},[_c("InlineSvg",{attrs:{src:"svgs/settings3",iconClass:"icon icon-md stroke-white"}})],1),_c("div",{staticClass:"fc-black3-16 mL10 mT12"},[_vm._v(" "+_vm._s(_vm.$t("common.header.tools"))+" ")])]),_c("div",{ref:"plannedToolsWidget",staticClass:"inventory-table pT20"},[_vm.plannedToolsloading?_c("table",{staticClass:"width100"},[_c("tr",[_c("td",{staticClass:"iTloading in-no-data",attrs:{colspan:"100%"}},[_c("spinner",{attrs:{show:!0,size:"80"}})],1)])]):_c("table",{staticClass:"width100 inventory-table"},[_c("thead",[_c("tr",{staticClass:"border-top-none"},[_c("th",{staticClass:"border-top-none tool-header-sticky",staticStyle:{width:"30%"}},[_vm._v(" "+_vm._s(_vm.$t("common.header._tool"))+" ")]),_c("th",{staticStyle:{width:"25%"}},[_vm._v(_vm._s(_vm.$t("common._common.description")))]),_c("th",{staticClass:"pR0 border-top-none"},[_vm._v(" "+_vm._s(_vm.$t("common._common._quantity"))+" ")]),_c("th",{staticClass:"text-right width130px border-top-none"},[_vm._v(" "+_vm._s(_vm.$t("common._common.duration_hr"))+" ")]),_c("th",{staticClass:"text-right border-top-none width130px pR20 pL20"},[_vm._v(" "+_vm._s(_vm.$t("common.header.rate_hr"))+" ")]),_c("th",{staticClass:"text-right worktool-cost-sticky border-top-none"},[_vm._v(" "+_vm._s(_vm.$t("common.tabs._cost"))+" ")]),_c("th",{staticClass:"width40px worktool-cost-edit-sticky border-top-none"})])]),_vm.plannedInventoryTools.length?_c("tbody",[_vm._l(_vm.plannedInventoryTools,(function(plannedInventoryTool,index){return[_c("tr",{key:plannedInventoryTool.id,staticClass:"border-top4 border-bottom9 visibility-visible-actions pointer"},[_c("td",{staticClass:"width180px"},[plannedInventoryTool.id>-1?_c("div",{staticClass:"pL17"},[_vm._v(" "+_vm._s(_vm.$getProperty(plannedInventoryTool,"toolType.name"))+" ")]):_c("el-input",{staticClass:"fc-input-full-border2",attrs:{type:"text"}},[_c("i",{staticClass:"el-input__icon el-icon-search",staticStyle:{"line-height":"0px !important","font-size":"16px !important",cursor:"pointer"},attrs:{slot:"suffix"},on:{click:function($event){return _vm.addTools()}},slot:"suffix"})])],1),_c("td",{staticClass:"pL17"},[_vm._v(" "+_vm._s(_vm.$getProperty(plannedInventoryTool,"toolType.description","---"))+" ")]),_c("td",[_c("el-input",{staticClass:"fc-input-full-border2 width50px inventory-input-width text-center pL20",attrs:{type:"number"},on:{change:function($event){return _vm.updateQuantity(plannedInventoryTool)}},model:{value:plannedInventoryTool.quantity,callback:function($$v){_vm.$set(plannedInventoryTool,"quantity",$$v)},expression:"plannedInventoryTool.quantity"}})],1),_c("td",[_c("el-input",{staticClass:"fc-input-full-border2 width50px inventory-input-width text-center pL20",attrs:{type:"number"},on:{change:function($event){return _vm.updateDuration(plannedInventoryTool)}},model:{value:plannedInventoryTool.duration,callback:function($$v){_vm.$set(plannedInventoryTool,"duration",$$v)},expression:"plannedInventoryTool.duration"}})],1),_c("td",["---"!==_vm.getRate(plannedInventoryTool)?_c("currency",{staticClass:"text-right pR10",attrs:{value:_vm.getRate(plannedInventoryTool)}}):_c("div",{staticClass:"text-center"},[_vm._v(_vm._s("---"))])],1),_c("td",{staticClass:"text-right"},["---"!==_vm.totalCost(plannedInventoryTool)?_c("currency",{attrs:{value:_vm.totalCost(plannedInventoryTool)}}):_c("div",{staticClass:"text-center"},[_vm._v(_vm._s("---"))])],1),_c("td",{staticClass:"text-right"},[_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-delete pointer inv-delet-icon visibility-hide-actions pR10 pL10",attrs:{"data-arrow":"true",title:_vm.$t("common.header.delete_tool")},on:{click:function($event){return _vm.deletePlannedTool(plannedInventoryTool,index)}}})])])]}))],2):_c("tbody",[_c("tr",[_c("td",{staticClass:"inventory-td-selected pL20 pT10 pB10",on:{click:function($event){return _vm.addTools()}}},[_c("div",[_vm._v(_vm._s(_vm.$t("common.products.add_tool")))])]),_c("td",{staticClass:"pL20"},[_vm._v(" "+_vm._s("---")+" ")]),_c("td",{staticClass:"pT10 pB10"},[_c("el-input",{staticClass:"fc-input-full-border2 width50px inventory-input-width text-center pL20",attrs:{placeholder:"",type:"number",disabled:""}})],1),_c("td",{staticClass:"pT10 pB10 text-right"},[_c("el-input",{staticClass:"fc-input-full-border2 width50px inventory-input-width text-center mR10",attrs:{placeholder:"",type:"number",disabled:""}})],1),_c("td",{staticClass:"pT10 pB10"},[_c("div",{staticClass:"fc-grey3-13 text-right"},[_c("currency",{attrs:{value:0}})],1)]),_c("td",{staticClass:"pT10 pB10"},[_c("div",{staticClass:"fc-grey3-13 text-right"},[_c("currency",{attrs:{value:0}})],1)]),_c("td",{staticClass:"pT10 pB10"})])])])]),_vm.plannedToolsloading?_vm._e():_c("div",{staticClass:"item-add"},[_c("div",{staticClass:"green-txt-13 fc-v1-add-txt pointer fL"},[_vm.plannedInventoryTools.length?_c("span",{staticClass:"mR20",on:{click:function($event){return _vm.addTools()}}},[_c("img",{attrs:{src:__webpack_require__(353654)}}),_vm._v(" "+_vm._s(_vm.$t("common.products.add_tool"))+" ")]):_vm._e()]),_c("div",{staticClass:"fR inline-flex mR30"},[_c("div",{staticClass:"bold mR60"},[_vm._v(_vm._s(_vm.$t("common.header._total")))]),_c("div",{staticClass:"fc-black3-16 text-right bold pR7"},[_c("currency",{attrs:{value:_vm.toolsTotalCost}})],1)])]),_vm.showAddToolsDialog?_c("AddPlannedInventory",{attrs:{jobPlanId:_vm.details.id,moduleName:"jobPlanTools",onClose:function(){return _vm.showAddToolsDialog=!1,_vm.getPlannedTools()}}}):_vm._e()],1)},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),createForOfIteratorHelper=__webpack_require__(566347),InlineSvg=(__webpack_require__(897389),__webpack_require__(648324),__webpack_require__(162506),__webpack_require__(586166)),api=__webpack_require__(32284),AddPlannedInventory=__webpack_require__(481582),validation=__webpack_require__(990260),eventBus=__webpack_require__(398011),PlannedInventoryToolsvue_type_script_lang_js={name:"PlannedInventoryTools",components:{InlineSvg:InlineSvg/* default */.Z,AddPlannedInventory:AddPlannedInventory/* default */.Z},props:["details","resizeWidget"],data:function(){return{plannedToolsloading:!1,plannedInventoryTools:[],showAddToolsDialog:!1}},created:function(){this.getPlannedTools()},mounted:function(){this.autoResize()},computed:{toolsTotalCost:function(){var _step,plannedInventoryTools=this.plannedInventoryTools,totalCost=0,_iterator=(0,createForOfIteratorHelper/* default */.Z)(plannedInventoryTools);try{for(_iterator.s();!(_step=_iterator.n()).done;){var tool=_step.value,_ref=tool||{},cost=_ref.cost;(0,validation/* isEmpty */.xb)(cost)||(totalCost+=cost)}}catch(err){_iterator.e(err)}finally{_iterator.f()}return eventBus/* eventBus */.Y.$emit("toolsTotalCost",totalCost.toFixed(2)),totalCost}},methods:{autoResize:function(){var _this=this;this.$nextTick((function(){var container=_this.$refs["plannedToolsWidget"];if(container){var height=container.scrollHeight+180,width=container.scrollWidth;_this.resizeWidget({height:height,width:width})}}))},getRate:function(plannedInventoryTool){var unitPrice=this.$getProperty(plannedInventoryTool,"toolType.sellingPrice");return(0,validation/* isEmpty */.xb)(unitPrice)?"---":unitPrice},getPlannedTools:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var jobPlanid,params,_yield$API$fetchAll,list,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _this2.plannedToolsloading=!0,jobPlanid=_this2.$getProperty(_this2.details,"id"),params={filters:JSON.stringify({jobPlan:{operatorId:36,value:["".concat(jobPlanid)]}})},_context.next=5,api/* API */.bl.fetchAll("jobPlanTools",params);case 5:_yield$API$fetchAll=_context.sent,list=_yield$API$fetchAll.list,error=_yield$API$fetchAll.error,error?_this2.$message.error(error||_this2.$t("common._common.planned_tools_list_error_msg")):(_this2.plannedInventoryTools=list,_this2.plannedToolsloading=!1,_this2.autoResize());case 9:case"end":return _context.stop()}}),_callee)})))()},addTools:function(){this.showAddToolsDialog=!0},totalCost:function(plannedInventoryTool){var quantity=this.$getProperty(plannedInventoryTool,"quantity"),unitPrice=this.$getProperty(plannedInventoryTool,"toolType.sellingPrice"),duration=this.$getProperty(plannedInventoryTool,"duration"),cost=(0,validation/* isEmpty */.xb)(unitPrice)||(0,validation/* isEmpty */.xb)(duration)?"---":quantity*unitPrice*duration;return"---"!==cost&&(plannedInventoryTool.cost=cost),cost},updateQuantity:function(plannedInventoryTool){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var _ref2,quantity,id,data;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _ref2=plannedInventoryTool||{},quantity=_ref2.quantity,id=_ref2.id,data={quantity:quantity},_context2.next=4,_this3.updatePlannedTool(id,data);case 4:case"end":return _context2.stop()}}),_callee2)})))()},updateDuration:function(plannedInventoryTool){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var _ref3,duration,id,data;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return _ref3=plannedInventoryTool||{},duration=_ref3.duration,id=_ref3.id,data={duration:duration},_context3.next=4,_this4.updatePlannedTool(id,data);case 4:case"end":return _context3.stop()}}),_callee3)})))()},updatePlannedTool:function(id,data){var _this5=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){var _yield$API$updateReco,error,_ref4,quantity,errorMsg,_ref5,_quantity,successMsg;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,api/* API */.bl.updateRecord("jobPlanTools",{id:id,data:data});case 2:_yield$API$updateReco=_context4.sent,error=_yield$API$updateReco.error,error?(_ref4=data||{},quantity=_ref4.quantity,errorMsg=(0,validation/* isEmpty */.xb)(quantity)?_this5.$t("common._common.unable_to_update_duration"):_this5.$t("common._common.unable_to_update_quantity"),_this5.$message.error(error||errorMsg)):(_ref5=data||{},_quantity=_ref5.quantity,successMsg=(0,validation/* isEmpty */.xb)(_quantity)?_this5.$t("common._common.duration_updated_successfully"):_this5.$t("common._common.quantity_updated_successfully"),_this5.$message.success(successMsg),_this5.getPlannedTools(),eventBus/* eventBus */.Y.$emit("reloadOverallCost"));case 5:case"end":return _context4.stop()}}),_callee4)})))()},deletePlannedTool:function(plannedInventoryTool,index){var _this6=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee5(){var id,_yield$API$deleteReco,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context5){while(1)switch(_context5.prev=_context5.next){case 0:return id=plannedInventoryTool.id,_context5.next=3,api/* API */.bl.deleteRecord("jobPlanTools",[id]);case 3:_yield$API$deleteReco=_context5.sent,error=_yield$API$deleteReco.error,error?_this6.$message.error(error||_this6.$t("common._common.error_occurred_delete")):(_this6.plannedInventoryTools.splice(index,1),_this6.$message.success(_this6.$t("common._common.tool_del")),eventBus/* eventBus */.Y.$emit("reloadOverallCost"),_this6.autoResize());case 6:case"end":return _context5.stop()}}),_callee5)})))()}}},plannedInventory_PlannedInventoryToolsvue_type_script_lang_js=PlannedInventoryToolsvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(plannedInventory_PlannedInventoryToolsvue_type_script_lang_js,render,staticRenderFns,!1,null,"cbce40de",null)
/* harmony default export */,PlannedInventoryTools=component.exports},
/***/926460:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return InventoryPagination}});
// EXTERNAL MODULE: ./src/components/list/FPagination.vue + 7 modules
var render,staticRenderFns,FPagination=__webpack_require__(929593),InventoryPaginationvue_type_script_lang_js={name:"InventoryPagination",extends:FPagination/* default */.Z,methods:{setPage:function(isReset){this.pageNo?this.$emit("onPageChanged",this.page):isReset||this.$emit("onPageChanged",this.page)}}},widgets_InventoryPaginationvue_type_script_lang_js=InventoryPaginationvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(widgets_InventoryPaginationvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,InventoryPagination=component.exports},
/***/353654:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"d7f1f315aba97cd14240ee6f3d34465f.svg";
/***/}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/54582.js.map