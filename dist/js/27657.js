"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[27657],{
/***/634559:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FieldUpdateDialog}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/fields/FieldUpdateDialog.vue?vue&type=template&id=3a6c8a46
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("el-dialog",{staticClass:"fieldchange-Dialog pB15 fc-dialog-center-container",attrs:{visible:!0,width:"50%",title:"Field Change","custom-class":"dialog-header-padding","append-to-body":!0,"before-close":_vm.close}},[_c("div",{staticClass:"height330 overflow-y-scroll pB50"},_vm._l(_vm.fieldChange.templateJson.fieldMatcher,(function(fieldMatcher,index){return _c("div",{key:index},[_c("el-row",{staticClass:"visibility-visible-actions fc-row-hover pT10 pB10 pL10 pointer"},[_c("el-col",{attrs:{span:1}},[_c("div",{staticClass:"criteria-alphabet-block pT6"},[_c("div",{staticClass:"alphabet-circle"},[_vm._v(_vm._s(index+1))])])]),_c("el-col",{staticClass:"pL10",attrs:{span:9}},[_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{filterable:""},on:{change:function($event){return _vm.statusFieldName(fieldMatcher,index)}},model:{value:fieldMatcher.field,callback:function($$v){_vm.$set(fieldMatcher,"field",$$v)},expression:"fieldMatcher.field"}},_vm._l(_vm.updateFields,(function(field,index){return _c("el-option",{key:index,attrs:{label:field.displayName,value:field.name}})})),1)],1),_c("el-col",{attrs:{span:9}},[_c("div",{},[fieldMatcher.fieldObj?fieldMatcher.isSpacePicker?_c("div",[_c("el-input",{staticClass:"fc-input-full-border-select2 mL20 width100",attrs:{disabled:""},model:{value:_vm.field.parseLabel,callback:function($$v){_vm.$set(_vm.field,"parseLabel",$$v)},expression:"field.parseLabel"}},[_c("i",{staticClass:"el-input__icon el-icon-search",staticStyle:{"line-height":"0px !important","font-size":"16px !important",cursor:"pointer"},attrs:{slot:"suffix"},slot:"suffix"})])],1):_c("div",{staticClass:"flex-middle"},["NUMBER"===fieldMatcher.fieldObj[0].dataType||"DECIMAL"===fieldMatcher.fieldObj[0].dataType?_c("el-input",{staticClass:"fc-input-full-border-select2 mL20 width100",attrs:{type:"number"},model:{value:fieldMatcher.value,callback:function($$v){_vm.$set(fieldMatcher,"value",$$v)},expression:"fieldMatcher.value"}}):"BOOLEAN"===fieldMatcher.fieldObj[0].dataTypeEnum._name?_c("el-select",{staticClass:"fc-input-full-border-select2 mL20 width100pxss",model:{value:fieldMatcher.value,callback:function($$v){_vm.$set(fieldMatcher,"value",$$v)},expression:"fieldMatcher.value"}},[_c("el-option",{attrs:{label:fieldMatcher.fieldObj[0].trueVal?fieldMatcher.fieldObj[0].trueVal:"Yes",value:"true"}}),_c("el-option",{attrs:{label:fieldMatcher.fieldObj[0].falseVal?fieldMatcher.fieldObj[0].falseVal:"No",value:"false"}})],1):"ENUM"===fieldMatcher.fieldObj[0].dataTypeEnum._name?_c("el-select",{staticClass:"fc-input-full-border-select2 width100 mL20",attrs:{filterable:"","collapse-tags":""},model:{value:fieldMatcher.value,callback:function($$v){_vm.$set(fieldMatcher,"value",$$v)},expression:"fieldMatcher.value"}},_vm._l(_vm.picklistOptions[fieldMatcher.field],(function(value,key){return _c("el-option",{key:key,attrs:{label:value,value:key}})})),1):"DATE"===fieldMatcher.fieldObj[0].dataTypeEnum._name||"DATE_TIME"===fieldMatcher.fieldObj[0].dataTypeEnum._name?_c("el-row",{staticClass:"mL20"},[_c("el-col",{attrs:{span:7}},[_c("el-input",{staticClass:"fc-input-full-border-select2 width75px",attrs:{type:"number"},on:{change:function($event){return _vm.changeDataType(fieldMatcher)}},model:{value:fieldMatcher.dateObject.days,callback:function($$v){_vm.$set(fieldMatcher.dateObject,"days",$$v)},expression:"fieldMatcher.dateObject.days"}}),_c("div",{staticClass:"f12 fc-darkgrey text-left pT10 nowrap"},[_vm._v(" Days ")])],1),_c("el-col",{staticClass:"pL30",attrs:{span:7}},[_c("el-select",{staticClass:"fc-input-full-border-select2 width75px",attrs:{clearable:"",filterable:"",placeholder:"Num"},on:{change:function($event){return _vm.changeDataType(fieldMatcher)}},model:{value:fieldMatcher.dateObject.hours,callback:function($$v){_vm.$set(fieldMatcher.dateObject,"hours",$$v)},expression:"fieldMatcher.dateObject.hours"}},_vm._l(_vm.$constants.HOURS,(function(index){return _c("el-option",{key:index+1,attrs:{label:index,value:index}})})),1),_c("div",{staticClass:"f12 fc-darkgrey text-left pT10 nowrap"},[_vm._v(" Hours ")])],1),_c("el-col",{staticClass:"pL60",attrs:{span:7}},[_c("el-select",{staticClass:"fc-input-full-border-select2 width75px",attrs:{placeholder:"Num",filterable:""},on:{change:function($event){return _vm.changeDataType(fieldMatcher)}},model:{value:fieldMatcher.dateObject.minute,callback:function($$v){_vm.$set(fieldMatcher.dateObject,"minute",$$v)},expression:"fieldMatcher.dateObject.minute"}},_vm._l(_vm.minDuration,(function(index){return _c("el-option",{key:index+1,attrs:{label:index,value:index}})})),1),_c("div",{staticClass:"f12 fc-darkgrey text-left pT10 nowrap"},[_vm._v(" Mins ")])],1)],1):"LOOKUP"===fieldMatcher.fieldObj[0].dataTypeEnum._name&&"LOOKUP_SIMPLE"===fieldMatcher.fieldObj[0].displayType._name||"LOOKUP"===fieldMatcher.fieldObj[0].dataTypeEnum._name?_c("el-select",{staticClass:"fc-input-full-border-select2 width100 mL20",attrs:{filterable:"","collapse-tags":""},on:{change:function($event){return _vm.changeDataType(fieldMatcher)}},model:{value:fieldMatcher.valueArray,callback:function($$v){_vm.$set(fieldMatcher,"valueArray",$$v)},expression:"fieldMatcher.valueArray"}},_vm._l(_vm.picklistOptions[fieldMatcher.field],(function(value,key){return _c("el-option",{key:key,attrs:{label:value,value:key}})})),1):_c("el-input",{staticClass:"fc-input-full-border-select2 mL20 width130px",model:{value:fieldMatcher.value,callback:function($$v){_vm.$set(fieldMatcher,"value",$$v)},expression:"fieldMatcher.value"}})],1):_c("div",[_c("el-input",{staticClass:"fc-input-full-border-select2 mL20 width100",model:{value:fieldMatcher.value,callback:function($$v){_vm.$set(fieldMatcher,"value",$$v)},expression:"fieldMatcher.value"}})],1)])]),_c("el-col",{attrs:{span:5}},[_c("div",{staticClass:"visibility-hide-actions pT10 mR20 text-right pointer"},[_c("img",{staticClass:"pointer",attrs:{src:__webpack_require__(353654)},on:{click:_vm.addRow}}),_vm.fieldChange.templateJson.fieldMatcher.length>1&&1!==_vm.fieldChange.templateJson.fieldMatcher.length?_c("img",{staticClass:"pointer mL5",attrs:{src:__webpack_require__(385769)},on:{click:function($event){return _vm.deleteRow(index)}}}):_vm._e()])])],1)],1)})),0),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){return _vm.close()}}},[_vm._v("CANCEL")]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:function($event){return _vm.actionSave(_vm.fieldChange)}}},[_vm._v("Save")])],1)])],1)},staticRenderFns=[],validation=(__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(976801),__webpack_require__(434284),__webpack_require__(843843),__webpack_require__(670560),__webpack_require__(162506),__webpack_require__(990260)),FieldUpdateDialogvue_type_script_lang_js={props:["statusFieldName","fieldChange","moduleFields","module","picklistOptions","addRow","actionSave","fieldUpdateValue","durationConfig"],data:function(){return{moduleObj:{},excludeFields:["stateFlowId","siteId","photo","moduleState"],updateFieldName:{alarm:["severity"],newreadingalarm:["severity"],workorder:["assignedTo","assignmentGroup","category","dueDate","priority","type"],asset:["type","model","manufacturer","purchasedDate","retireDate","unitPrice","warrantyExpiryDate","department"],dealsandoffers:["active"]}}},computed:{updateFields:function(){var _this=this,fields=[],_this$moduleObj=this.moduleObj,moduleObj=void 0===_this$moduleObj?{}:_this$moduleObj,excludeFields=this.excludeFields,moduleFields=this.moduleFields,$getProperty=this.$getProperty,decommissionFields=["decommission","decommissionedBy","viewRecommissionedBtn","commissionedTime"];return(0,validation/* isEmpty */.xb)(moduleFields)?"CUSTOM"===$getProperty(moduleObj.typeEnum,"_name","")&&(fields=moduleFields.filter((function(field){return!excludeFields.includes(field.name)}))):(moduleFields=moduleFields.filter((function(field){return!decommissionFields.includes(field.name)})),fields=this.updateFieldName[this.module]?moduleFields.filter((function(field){return!field.default||_this.updateFieldName[_this.module]&&_this.updateFieldName[_this.module].includes(field.name)})):moduleFields),fields},minDuration:function(){var durationConfig=this.durationConfig;if(this.$getProperty(durationConfig,"minInterval")){for(var minutes=[],minInterval=durationConfig.minInterval,i=0;i<60;i+=minInterval)minutes.push(i);return minutes}return this.$constants.MINUTES}},mounted:function(){this.getMetaFields()},methods:{getMetaFields:function(){var _this2=this,module=this.module;if(module){var url="/module/meta?moduleName=".concat(module);this.$http.get(url).then((function(response){_this2.moduleObj=response.data.meta.module}))}},changeDataType:function(criteria){if("DATE_TIME"===criteria.fieldObj[0].dataTypeEnum._name||"DATE"===criteria.fieldObj[0].dataTypeEnum._name){if(criteria.dateObject){var interval=this.$helpers.daysHoursMinuToSec(criteria.dateObject);criteria.value=1e3*interval}}else criteria.valueArray&&(
// let values = criteria.valueArray.join()
criteria.value={id:criteria.valueArray});this.$forceUpdate()},deleteRow:function(index){this.fieldChange.templateJson.fieldMatcher.splice(index,1)},close:function(){this.$emit("update:fieldUpdateValue",!1)}}},fields_FieldUpdateDialogvue_type_script_lang_js=FieldUpdateDialogvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(fields_FieldUpdateDialogvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FieldUpdateDialog=component.exports},
/***/134077:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return ScriptEditor}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/newapp/setupActions/components/ScriptEditor.vue?vue&type=template&id=3fe27b0f
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"fieldchange-Dialog pB15 fc-dialog-center-container fc-dialog-center-body-p0",attrs:{visible:!0,width:"60%",title:_vm.$t("common.products.script"),"append-to-body":!0,"before-close":_vm.closeDialog}},[_c("div",{staticClass:"height350 overflow-y-scroll pB50"},[_c("CodeMirror",{attrs:{codeeditor:!0},model:{value:_vm.scriptData.workflowContext.workflowV2String,callback:function($$v){_vm.$set(_vm.scriptData.workflowContext,"workflowV2String",$$v)},expression:"scriptData.workflowContext.workflowV2String"}})],1),_c("div",{staticClass:"modal-dialog-footer",staticStyle:{"z-index":"900"}},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.closeDialog}},[_vm._v("CANCEL")]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:_vm.actionSave}},[_vm._v(" Save ")])],1)])},staticRenderFns=[],objectSpread2=__webpack_require__(595082),CodeMirror=__webpack_require__(919324),ScriptModel=__webpack_require__(721486),ScriptEditorvue_type_script_lang_js={props:["actionObj","moduleName"],components:{CodeMirror:CodeMirror/* default */.Z},data:function(){return{scriptData:null}},created:function(){var actionObj=this.actionObj,moduleName=this.moduleName,scriptObj=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},actionObj||{}),{},{moduleName:moduleName});this.scriptData=new ScriptModel/* ScriptModel */.q(scriptObj)},methods:{closeDialog:function(){this.$emit("onClose")},actionSave:function(){var isValid=this.scriptData.validate();isValid?(this.$emit("onSave",this.scriptData.serialize()),this.closeDialog()):this.$message.error("Script is Empty")}}},components_ScriptEditorvue_type_script_lang_js=ScriptEditorvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_ScriptEditorvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,ScriptEditor=component.exports},
/***/292974:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return StatusUpdate}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/newapp/setupActions/components/StatusUpdate.vue?vue&type=template&id=5163edd4&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"fieldchange-Dialog pB15 fc-dialog-center-container",attrs:{visible:!0,width:"40%",title:_vm.$t("setup.setup.change_status"),"custom-class":"dialog-header-padding","append-to-body":!0,"close-on-click-modal":!1,"show-close":!1}},[_vm.isLoading?_c("div",{staticClass:"height120"},[_c("span",{staticClass:"rectangle loading-shimmer"})]):_c("div",{staticClass:"height120 overflow-y-scroll"},[_c("el-select",{staticClass:"fc-input-full-border-select2 width100 mT5",attrs:{filterable:""},model:{value:_vm.statusUpdateObj.new_state,callback:function($$v){_vm.$set(_vm.statusUpdateObj,"new_state",$$v)},expression:"statusUpdateObj.new_state"}},_vm._l(_vm.statusList,(function(label,value){return _c("el-option",{key:value,attrs:{label:label,value:value}})})),1)],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.closeDialog}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:_vm.actionSave}},[_vm._v(" "+_vm._s(_vm.$t("common._common.save")))])],1)])},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),ChangeStatusModel=__webpack_require__(367389),validation=__webpack_require__(990260),StatusUpdatevue_type_script_lang_js={props:["actionObj","moduleName","moduleId"],data:function(){return{statusUpdateObj:{},statusList:{},isLoading:!1}},created:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var metaModuleId;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(_this.isLoading=!0,_this.statusUpdateObj=new ChangeStatusModel/* ChangeStatusModel */.M(_this.actionObj||{}),metaModuleId=null,!(0,validation/* isEmpty */.xb)(_this.moduleId)){_context.next=7;break}return _context.next=6,_this.fetchModuleId();case 6:metaModuleId=_context.sent;case 7:return _context.prev=7,_context.next=10,ChangeStatusModel/* ChangeStatusModel */.M.getTicketStatus(_this.moduleId||metaModuleId);case 10:_this.statusList=_context.sent,_context.next=16;break;case 13:_context.prev=13,_context.t0=_context["catch"](7),_this.$message.error(_context.t0.message);case 16:_this.isLoading=!1;case 17:case"end":return _context.stop()}}),_callee,null,[[7,13]])})))()},methods:{fetchModuleId:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _context2.prev=0,_context2.next=3,ChangeStatusModel/* ChangeStatusModel */.M.fetchMetaModuleId(_this2.moduleName);case 3:return _context2.abrupt("return",_context2.sent);case 6:_context2.prev=6,_context2.t0=_context2["catch"](0),_this2.$message.error(_context2.t0.message);case 9:case"end":return _context2.stop()}}),_callee2,null,[[0,6]])})))()},closeDialog:function(){this.$emit("onClose")},actionSave:function(){this.$emit("onSave",this.statusUpdateObj.serialize()),this.closeDialog()}}},components_StatusUpdatevue_type_script_lang_js=StatusUpdatevue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_StatusUpdatevue_type_script_lang_js,render,staticRenderFns,!1,null,"5163edd4",null)
/* harmony default export */,StatusUpdate=component.exports},
/***/662624:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return ActionConfig}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/setup/approvals/components/ActionConfig.vue?vue&type=template&id=2773adf3
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"actions-config mB20"},[_c("el-row",{staticClass:"mB10 flex-middle"},[_c("el-col",{attrs:{span:18}},[_vm._t("header")],2),_c("el-col",{attrs:{span:6}},[_c("el-dropdown",{staticClass:"fR",attrs:{"hide-on-click":"",trigger:"click"},on:{command:_vm.addAction}},[_c("div",{staticClass:"f13",staticStyle:{color:"#23b096"}},[_c("img",{staticClass:"pointer vertical-middle",staticStyle:{height:"18px",width:"18px","margin-right":"4px"},attrs:{src:__webpack_require__(353654)}}),_vm._v(" Add Action ")]),_c("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},_vm._l(_vm.supportedActions,(function(action,index){return _c("el-dropdown-item",{key:"actiontype-"+index,attrs:{command:_vm.actionsHash[action].actionParam}},[_vm._v(" "+_vm._s(_vm.actionsHash[action]&&_vm.actionsHash[action].label)+" ")])})),1)],1)],1)],1),_vm.$validation.isEmpty(_vm.actionsList)?_c("el-row",{staticClass:"action-row no-hover"},[_c("el-col",{attrs:{span:24}},[_c("p",{staticClass:"details-heading"},[_vm._v("No actions configured")])])],1):_vm._e(),_vm.isEmailConfi?_c("el-row",{staticClass:"action-row"},[_c("el-col",{attrs:{span:12}},[_c("p",{staticClass:"details-heading"},[_vm._v("Send Email")])]),_c("el-col",{staticClass:"pT4 text-right",attrs:{span:12}},[_c("span",{staticClass:"configured-green"},[_vm._v("Configured")]),_vm.isEmailConfi?_c("span",{staticClass:"mL20 action-edit-section"},[_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-edit pointer",attrs:{title:"Edit Mail"},on:{click:function($event){return _vm.editAction(_vm.emailContext)}}}),_c("span",{staticClass:"mL20 reset-txt pointer",on:{click:function($event){return _vm.reset("mail")}}},[_vm._v("Reset")])]):_vm._e()])],1):_vm._e(),_vm.isSmsConfi?_c("el-row",{staticClass:"action-row"},[_c("el-col",{attrs:{span:12}},[_c("p",{staticClass:"details-heading"},[_vm._v("Send SMS")])]),_c("el-col",{staticClass:"pT4 text-right",attrs:{span:12}},[_c("span",{staticClass:"configured-green"},[_vm._v("Configured")]),_vm.isSmsConfi?_c("span",{staticClass:"mL20 action-edit-section"},[_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-edit pointer",attrs:{title:"Edit Sms"},on:{click:function($event){return _vm.editAction(_vm.smsContent)}}}),_c("span",{staticClass:"mL20 reset-txt pointer",on:{click:function($event){return _vm.reset("sms")}}},[_vm._v("Reset")])]):_vm._e()])],1):_vm._e(),_vm.isMobileConfig?_c("el-row",{staticClass:"action-row"},[_c("el-col",{attrs:{span:12}},[_c("p",{staticClass:"details-heading"},[_vm._v("Send Mobile Notification")])]),_c("el-col",{staticClass:"pT4 text-right",attrs:{span:12}},[_c("span",{staticClass:"configured-green"},[_vm._v("Configured")]),_vm.isMobileConfig?_c("span",{staticClass:"mL20 action-edit-section"},[_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-edit pointer",attrs:{title:"Edit Mobile"},on:{click:function($event){return _vm.editAction(_vm.mobileContent)}}}),_c("span",{staticClass:"mL20 reset-txt pointer",on:{click:function($event){return _vm.reset("mobile")}}},[_vm._v("Reset")])]):_vm._e()])],1):_vm._e(),_vm.isFieldConfi?_c("el-row",{staticClass:"action-row"},[_c("el-col",{attrs:{span:12}},[_c("p",{staticClass:"details-heading"},[_vm._v("Field Update")])]),_c("el-col",{staticClass:"pT4 text-right",attrs:{span:12}},[_c("span",{staticClass:"configured-green"},[_vm._v("Configured")]),_vm.isFieldConfi?_c("span",{staticClass:"mL20 action-edit-section"},[_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-edit pointer",attrs:{title:"Edit Field"},on:{click:function($event){return _vm.editAction(_vm.fieldContext)}}}),_c("span",{staticClass:"mL20 reset-txt pointer",on:{click:function($event){return _vm.reset("fieldChange")}}},[_vm._v(" Reset ")])]):_vm._e()])],1):_vm._e(),_vm.isScriptConfi?_c("el-row",{staticClass:"action-row"},[_c("el-col",{attrs:{span:12}},[_c("p",{staticClass:"details-Heading"},[_vm._v("Execute Script")])]),_c("el-col",{staticClass:"pT4 text-right",attrs:{span:12}},[_c("span",{staticClass:"configured-green"},[_vm._v("Configured")]),_vm.isScriptConfi?_c("span",{staticClass:"mL20 action-edit-section"},[_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-edit pointer",attrs:{title:"Edit Script"},on:{click:function($event){return _vm.editAction(_vm.scriptData)}}}),_c("span",{staticClass:"mL20 reset-txt pointer",on:{click:function($event){return _vm.reset("script")}}},[_vm._v(" Reset ")])]):_vm._e()])],1):_vm._e(),_vm.isStatusConfig?_c("el-row",{staticClass:"action-row"},[_c("el-col",{attrs:{span:12}},[_c("p",{staticClass:"details-heading"},[_vm._v("Change Status")])]),_c("el-col",{staticClass:"pT4 text-right",attrs:{span:12}},[_c("span",{staticClass:"configured-green"},[_vm._v("Configured")]),_vm.isStatusConfig?_c("span",{staticClass:"mL20 action-edit-section"},[_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-edit pointer",attrs:{title:"Edit Status"},on:{click:function($event){return _vm.editAction(_vm.changeStatus)}}}),_c("span",{staticClass:"mL20 reset-txt pointer",on:{click:function($event){return _vm.reset("changeStatus")}}},[_vm._v(" Reset ")])]):_vm._e()])],1):_vm._e(),_c("send-notification",{ref:"notificationpage",staticClass:"ruleDialog",attrs:{visibility:_vm.actionEdit,mode:_vm.actionMode,option:_vm.actionData,module:_vm.module},on:{onsave:_vm.actionSave,"update:visibility":function($event){_vm.actionEdit=$event},"update:mode":function($event){_vm.actionMode=$event},"update:option":function($event){_vm.actionData=$event}}}),_vm.fieldUpdateValue?_c("field-update-dialog",{attrs:{statusFieldName:_vm.statusFieldName,fieldChange:_vm.fieldChange,moduleFields:_vm.moduleFields,module:_vm.module,picklistOptions:_vm.picklistOptions,addRow:_vm.addRow,actionSave:_vm.actionSave,fieldUpdateValue:_vm.fieldUpdateValue},on:{"update:fieldUpdateValue":function($event){_vm.fieldUpdateValue=$event},"update:field-update-value":function($event){_vm.fieldUpdateValue=$event}}}):_vm._e(),_vm.openStatusDialog?_c("ChangeStatusDialog",{attrs:{actionObj:_vm.changeStatus,moduleId:_vm.moduleId,moduleName:_vm.module},on:{onSave:_vm.actionSave,onClose:function($event){_vm.openStatusDialog=!1}}}):_vm._e(),_vm.showScriptDialog?_c("ScriptDialog",{attrs:{actionObj:_vm.scriptData,moduleName:_vm.module},on:{onSave:_vm.actionSave,onClose:function($event){_vm.showScriptDialog=!1}}}):_vm._e()],1)},staticRenderFns=[],createForOfIteratorHelper=__webpack_require__(566347),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),objectSpread2=__webpack_require__(595082),validation=(__webpack_require__(260228),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(947522),__webpack_require__(538077),__webpack_require__(434284),__webpack_require__(162506),__webpack_require__(339772),__webpack_require__(670560),__webpack_require__(648324),__webpack_require__(450886),__webpack_require__(990260)),cloneDeep=__webpack_require__(150361),cloneDeep_default=__webpack_require__.n(cloneDeep),vuex_esm=__webpack_require__(420629),FieldUpdateDialog=__webpack_require__(634559),StatusUpdate=__webpack_require__(292974),SendNotification=__webpack_require__(617650),picklist=__webpack_require__(961358),ScriptEditor=__webpack_require__(134077),ActionConfigvue_type_script_lang_js={props:["module","moduleFields","configuredActions","actionsHash","supportedActions","moduleId"],components:{SendNotification:SendNotification/* default */.Z,FieldUpdateDialog:FieldUpdateDialog/* default */.Z,ChangeStatusDialog:StatusUpdate/* default */.Z,ScriptDialog:ScriptEditor/* default */.Z},created:function(){var _this=this;Promise.all([this.$store.dispatch("loadTicketStatus",this.module),this.$store.dispatch("loadTicketPriority"),this.$store.dispatch("loadGroups")]).finally((function(){return _this.init()}))},data:function(){return{actionsList:[],isSaving:!1,isEmailConfi:!1,isSmsConfi:!1,isMobileConfig:!1,isFieldConfi:!1,isStatusConfig:!1,isScriptConfi:!1,showScriptDialog:!1,mobileContent:"",emailContext:"",fieldContext:"",smsContent:"",actionMode:"mail",actionEdit:!1,actionIndex:null,actionData:null,fieldUpdateValue:!1,openStatusDialog:!1,fieldChange:{actionType:13,templateJson:{fieldMatcher:[]}},changeStatus:{actionType:19,templateJson:{new_state:null}},scriptData:null,assets:null,categoryMetric:null,picklistOptions:{}}},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({users:function(state){return state.users},groups:function(state){return state.groups},ticketpriority:function(state){return state.ticketPriority}})),(0,vuex_esm/* mapGetters */.Se)(["getTicketStatusPickList"])),methods:{init:function(){var _this2=this,actionTypes=["mail","sms","mobile","fieldChange","changeStatus"];actionTypes.forEach(this.reset);var actions=cloneDeep_default()(this.configuredActions);(0,validation/* isEmpty */.xb)(actions)||actions.forEach((function(action){if(3===parseInt(action.actionType))_this2.isEmailConfi=!0,_this2.emailContext=action;else if(4===parseInt(action.actionType))_this2.isSmsConfi=!0,_this2.smsContent=action;else if(7===parseInt(action.actionType))_this2.isMobileConfig=!0,_this2.mobileContent=action;else if(13===parseInt(action.actionType)){_this2.isFieldConfi=!0;var index=0;if(!(0,validation/* isEmpty */.xb)(action.template)){var originalTemplate=action.template.originalTemplate,_loop=function(key){if(_this2.addRow(),Object.prototype.hasOwnProperty.call(originalTemplate,key)){var fieldMatcher=_this2.fieldChange.templateJson.fieldMatcher[index],field=_this2.moduleFields.filter((function(field){return field.name===key}));!(0,validation/* isEmpty */.xb)(field)&&_this2.setFieldMatcher(fieldMatcher,field,key,originalTemplate),_this2.statusFieldName(fieldMatcher,index),index++}};for(var key in originalTemplate)_loop(key);_this2.fieldContext=action}}else if(21===parseInt(action.actionType)){_this2.isScriptConfi=!0,_this2.scriptData=action;var templateJson={resultWorkflowContext:action.template.originalTemplate.workflowContext};_this2.scriptData=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},_this2.scriptData),{},{templateJson:templateJson})}else if(19===parseInt(action.actionType)){_this2.isStatusConfig=!0;var new_state=_this2.$getProperty(action,"template.originalTemplate.new_state"),_templateJson={new_state:new_state};_this2.changeStatus=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},action),{},{templateJson:_templateJson})}})),this.actionsList=(0,validation/* isEmpty */.xb)(actions)?[]:actions},getActions:function(){return this.actionsList||[]},close:function(){this.fieldChange={actionType:13,templateJson:{fieldMatcher:[]}},this.onClose()},addAction:function(cmd){this.actionMode=cmd,this.actionData=null,"script"===cmd?this.showScriptDialog=!0:"workorder"!==cmd&&"fieldChange"!==cmd&&"changeStatus"!==cmd&&"controls"!==cmd?this.actionEdit=!0:"fieldChange"===cmd?(this.fieldUpdateValue=!0,this.$getProperty(this.fieldChange,"templateJson.fieldMatcher.length",0)<=0&&this.addRow()):"changeStatus"===cmd&&(this.openStatusDialog=!0)},editAction:function(action){this.actionData=action,3===action.actionType?(this.actionMode="mail",this.isEmailConfi=!0,this.actionEdit=!0):4===action.actionType?(this.actionMode="sms",this.isSmsConfi=!0,this.actionEdit=!0):7===action.actionType?(this.actionMode="mobile",this.isMobileConfig=!0,this.actionEdit=!0):13===action.actionType?(this.isFieldConfi=!0,this.fieldUpdateValue=!0,this.actionMode="fieldChange"):19===action.actionType?(this.isStatusConfig=!0,this.openStatusDialog=!0,this.actionMode="changeStatus"):21===action.actionType&&(this.actionMode="script",this.showScriptDialog=!0,this.isScriptConfi=!0)},deleteAction:function(idx){var actions=this.getActions();actions.splice(idx,1),this.$emit("update:actionsList",actions)},actionSave:function(dataObj){var _this3=this,actions=this.getActions(),data=this.$helpers.cloneObject(dataObj),index=actions.findIndex((function(d){return d.actionType===data.actionType}));-1!==index&&actions.splice(index,1),3===data.actionType?(this.isEmailConfi=!0,this.emailContext=data):4===data.actionType?(this.isSmsConfi=!0,this.smsContent=data):7===data.actionType?(this.isMobileConfig=!0,this.formatMobileData(data.templateJson),this.mobileContent=data):13===data.actionType?(this.fieldUpdateValue=!1,this.fieldContext=data,this.isFieldConfi=!0):19===data.actionType?(this.openStatusDialog=!1,this.$nextTick((function(){_this3.isStatusConfig=!0,_this3.changeStatus=data}))):21===data.actionType&&(this.showScriptDialog=!1,this.isScriptConfi=!0,this.scriptData=data||{}),this.addModuleParam(data),actions.push(data),this.actionEdit=!1},reset:function(action){var actions=this.getActions();if("sms"===action){var idx=actions.findIndex((function(d){return 4===d.actionType}));actions.splice(idx,1),this.smsContent="",this.isSmsConfi=!1}else if("mail"===action){var _idx=actions.findIndex((function(d){return 3===d.actionType}));actions.splice(_idx,1),this.emailContext="",this.isEmailConfi=!1}else if("mobile"===action){var _idx2=actions.findIndex((function(d){return 7===d.actionType}));actions.splice(_idx2,1),this.mobileContent="",this.isMobileConfig=!1}else if("fieldChange"===action){var _idx3=actions.findIndex((function(d){return 13===d.actionType}));actions.splice(_idx3,1),this.isFieldConfi=!1}else if("changeStatus"===action){var _idx4=actions.findIndex((function(d){return 19===d.actionType}));this.changeStatus=null,actions.splice(_idx4,1),this.isStatusConfig=!1}else if("script"===action){var _idx5=actions.findIndex((function(d){return 21===d.actionType}));actions.splice(_idx5,1),this.isScriptConfi=!1,this.scriptData=null}},formatMobileData:function(data){var summaryPage=this.module.toUpperCase()+"_SUMMARY",message={content_available:!0,summary_id:"${"+this.module+".id}",sound:"default",module_name:this.module,priority:"high",text:data.message,click_action:summaryPage,title:data.subject};data.body=JSON.stringify({name:this.module.toUpperCase()+"_PUSH_NOTIFICATION",notification:message,data:message,id:data.id}),data.to=data.id,this.$common.setExpressionFromPlaceHolder(data.workflow,"${"+this.module+".id}")},addModuleParam:function(template){var _this4=this,workflowParameters=this.$getProperty(template,"templateJson.workflow.parameters"),ftl=this.$getProperty(template,"templateJson.ftl");ftl&&workflowParameters&&!workflowParameters.some((function(param){return param.name===_this4.module}))&&template.templateJson.workflow.parameters.push({name:this.module,typeString:"String"})},updateAction:function(actions){var _this5=this,newlist=[];return actions.filter((function(action){return 5!==action.actionType})).map((function(action){var template;if(3===action.actionType)template=_this5.$refs.notificationpage.getDataToSave(_this5.emailContext,"mail");else if(4===action.actionType)template=_this5.$refs.notificationpage.getDataToSave(_this5.smsContent,"sms");else if(7===action.actionType){var data=_this5.$refs.notificationpage.getDataToSave(_this5.mobileContent,"mobile");_this5.formatMobileData(data.templateJson),template=data}else if(13===action.actionType)template=_this5.fieldChange;else if(21===action.actionType)template={actionType:_this5.scriptData.actionType,templateJson:_this5.scriptData.templateJson};else if(19===action.actionType){var _ref=_this5.changeStatus||{},actionType=_ref.actionType,_ref$templateJson=_ref.templateJson,templateJson=void 0===_ref$templateJson?{}:_ref$templateJson;template={actionType:actionType,templateJson:templateJson}}_this5.addModuleParam(template),newlist.push(template||action)})),newlist},setFieldMatcher:function(fieldMatcher,field,key,originalTemplate){fieldMatcher.field=key,fieldMatcher.value=originalTemplate[key],"LOOKUP"===field[0].dataTypeEnum._name?(0,validation/* isEmpty */.xb)(originalTemplate[key].id)?(fieldMatcher.valueArray=originalTemplate[key],fieldMatcher.value=originalTemplate[key]):(fieldMatcher.valueArray=originalTemplate[key].id,fieldMatcher.value.id=originalTemplate[key].id):"DATE_TIME"!==field[0].dataTypeEnum._name&&"DATE"!==field[0].dataTypeEnum._name||(fieldMatcher.dateObject=this.$helpers.secTodaysHoursMinu(originalTemplate[key]/1e3)),fieldMatcher.fieldObj=field},statusFieldName:function(selectedField,index){var field=this.moduleFields.filter((function(field){return field.name===selectedField.field})),fieldMatcher=this.fieldChange.templateJson.fieldMatcher[index];if(fieldMatcher.fieldObj=field,fieldMatcher.isSpacePicker=!1,!(0,validation/* isEmpty */.xb)(field))if(fieldMatcher.columnName=field[0].completeColumnName,"ENUM"===field[0].dataTypeEnum._name&&this.$set(this.picklistOptions,field[0].name,field[0].enumMap),"LOOKUP"===field[0].dataTypeEnum._name&&field[0].specialType)this.loadSpecialTypePickList(field[0].specialType,field[0].name);else if("LOOKUP"===field[0].dataTypeEnum._name&&field[0].lookupModule)if("ticketstatus"===field[0].lookupModule.name)this.$set(this.picklistOptions,field[0].name,this.getTicketStatusPickList(this.module));else if("ticketpriority"===field[0].lookupModule.name){
// handling key value pair to match existing flow pattern
var priority={};this.ticketpriority.forEach((function(d){priority[d.id]=d.displayName})),this.$set(this.picklistOptions,field[0].name,priority)}else this.loadPickList(field[0].lookupModule.name,field[0].name)},loadPickList:function(moduleName,fieldName){var _this6=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var _yield$getFieldOption,error,options;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.next=2,(0,picklist/* getFieldOptions */._K)({field:{lookupModuleName:moduleName,skipDeserialize:!0}});case 2:_yield$getFieldOption=_context.sent,error=_yield$getFieldOption.error,options=_yield$getFieldOption.options,error?_this6.$message.error(error.message||"Error Occured"):_this6.$set(_this6.picklistOptions,fieldName,options);case 6:case"end":return _context.stop()}}),_callee)})))()},loadSpecialTypePickList:function(specialType,fieldName){var pickOption={};if("users"===specialType){var userList=this.users;pickOption["${LOGGED_USER}"]="Current User";var _step,_iterator=(0,createForOfIteratorHelper/* default */.Z)(userList);try{for(_iterator.s();!(_step=_iterator.n()).done;){var user=_step.value;pickOption[user.id]=user.name}}catch(err){_iterator.e(err)}finally{_iterator.f()}this.$set(this.picklistOptions,fieldName,pickOption)}else if("groups"===specialType){var _step2,groupList=this.groups,_iterator2=(0,createForOfIteratorHelper/* default */.Z)(groupList);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var group=_step2.value;pickOption[group.groupId]=group.name}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}this.$set(this.picklistOptions,fieldName,pickOption)}else"alarmType"===specialType?this.$set(this.picklistOptions,fieldName,this.$constants.AlarmCategory):"sourceType"===specialType&&this.$set(this.picklistOptions,fieldName,this.$constants.SourceType)},addRow:function(){this.$getProperty(this.fieldChange,"templateJson.fieldMatcher",[]).push({field:"",isSpacePicker:!1,value:null,parseLabel:null,valueArray:null,dateObject:{},fieldObj:null})},serialize:function(){return this.updateAction(this.getActions())}}},components_ActionConfigvue_type_script_lang_js=ActionConfigvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_ActionConfigvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,ActionConfig=component.exports},
/***/996440:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return Approvers}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/setup/approvals/components/Approvers.vue?vue&type=template&id=3e0dcf4a&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("div",{staticClass:"section-header",attrs:{id:"approvers-header"}},[_vm._v(" "+_vm._s(_vm.$t("common.header.approvers"))+" ")]),_c("div",{staticClass:"pL50 pR70 fc-input-label-txt",staticStyle:{"margin-top":"-10px"}},[_vm._v(" "+_vm._s(_vm.$t("common._common.specify_users_groups_and_roles"))+" ")]),_c("div",{staticClass:"p50 pT20 pR70 pB30 el-form",staticStyle:{"min-height":"230px"}},[_vm._l(_vm.activeApprovers,(function(approver,key){return _c("el-row",{key:key,staticClass:"criteria-condition-block"},[_c("div",{staticClass:"criteria-alphabet-block"},[_c("div",{staticClass:"alphabet-circle"},[_vm._v(" "+_vm._s(key+1)+" ")])]),_c("el-col",{attrs:{span:6}},[_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{placeholder:_vm.$t("common.products.select_type"),filterable:""},on:{change:function($event){return _vm.resetApproverId(key)}},model:{value:approver.type,callback:function($$v){_vm.$set(approver,"type",$$v)},expression:"approver.type"}},_vm._l(_vm.approverTypes,(function(type){return _c("el-option",{key:"type-"+type.id,attrs:{label:type.name,value:type.id}})})),1)],1),_c("el-col",{staticClass:"pL20",attrs:{span:15}},[_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{placeholder:_vm.$t("common._common.select"),filterable:""},model:{value:approver.approverId,callback:function($$v){_vm.$set(approver,"approverId",$$v)},expression:"approver.approverId"}},_vm._l(_vm.typeOptionMap[approver.type],(function(option,index){return _c("el-option",{key:"approveroption-"+index,attrs:{label:option.displayName||option.name,value:option.id}})})),1)],1),_c("el-col",{staticClass:"mT5 mL5 border-left action",attrs:{span:3}},[key+1===_vm.activeApprovers.length?_c("img",{staticClass:"delete-icon",staticStyle:{height:"18px",width:"18px"},attrs:{src:__webpack_require__(353654)},on:{click:_vm.addApprover}}):_vm._e(),_c("img",{staticClass:"delete-icon mL5",staticStyle:{height:"18px",width:"18px","margin-right":"3px"},attrs:{src:__webpack_require__(385769)},on:{click:function($event){return _vm.deleteApprovers(key)}}})])],1)})),_vm.activeApprovers&&_vm.activeApprovers.length>1?_c("el-row",{staticClass:"mT20 mB20"},[_c("el-col",{attrs:{span:24}},[_c("p",{staticClass:"text-fc-grey inline f14 pR30 mT10"},[_vm._v(" "+_vm._s(_vm.$t("common._common.to_be_performed"))+" ")]),_c("el-radio-group",{model:{value:_vm.allApprovalRequired,callback:function($$v){_vm.allApprovalRequired=$$v},expression:"allApprovalRequired"}},_vm._l(_vm.requiredApprovers,(function(type){return _c("el-radio",{key:type.value,staticClass:"fc-radio-btn",attrs:{label:type.value}},[_vm._v(_vm._s(type.label))])})),1),_vm.activeApprovers.length>1&&_vm.allApprovalRequired?_c("el-select",{staticClass:"fc-input-full-border-select2 width320px mL30 vertical-middle",model:{value:_vm.approvalOrder,callback:function($$v){_vm.approvalOrder=$$v},expression:"approvalOrder"}},_vm._l(_vm.approvalOrders,(function(field,index){return _c("el-option",{key:"approvalType-"+index,attrs:{label:field.label,value:field.value}})})),1):_vm._e()],1)],1):_vm._e()],2)])},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),toConsumableArray=__webpack_require__(488478),objectSpread2=__webpack_require__(595082),cloneDeep=(__webpack_require__(634338),__webpack_require__(260228),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(450886),__webpack_require__(162506),__webpack_require__(670560),__webpack_require__(538077),__webpack_require__(150361)),cloneDeep_default=__webpack_require__.n(cloneDeep),validation=__webpack_require__(990260),vuex_esm=__webpack_require__(420629),approverUtils=__webpack_require__(12637),requiredApprovers=[{label:"Any one",value:!1},{label:"All",value:!0}],approvalOrders=[{label:"Sequential",value:1},{label:"Parallel",value:2}],Approversvue_type_script_lang_js={name:"Approvers",props:{policy:{type:Object},moduleFields:{type:Array}},data:function(){return{approverTypes:approverUtils/* approverTypes */.xy,requiredApprovers:requiredApprovers,approvalOrders:approvalOrders,activeApprovers:[{approverId:null,type:null}],allApprovalRequired:!1,approvalOrder:1,typeOptionMap:[],canWatchForChanges:!1}},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({users:function(state){return state.users},teams:function(state){return state.groups},roles:function(state){return state.roles}})),{},{typeOptions:function(){return{users:[].concat((0,toConsumableArray/* default */.Z)(this.users),[{name:"Requester",id:"requester"}]),roles:this.roles,teams:this.teams,fields:this.moduleFields}},isNew:function(){return(0,validation/* isEmpty */.xb)(this.$route.params.id)},moduleName:function(){return this.$route.params.moduleName}}),watch:{policy:{handler:function(){Promise.all([this.$store.dispatch("loadUsers"),this.$store.dispatch("loadRoles"),this.$store.dispatch("loadGroups")]).then(this.init)},immediate:!0},activeApprovers:{handler:function(value){this.canWatchForChanges&&this.$emit("modified"),(0,validation/* isEmpty */.xb)(value)&&(this.activeApprovers=[{approverId:null,type:null}])},deep:!0},allApprovalRequired:function(value){this.approvalOrder=value?(0,validation/* isEmpty */.xb)(this.approvalOrder)?1:this.approvalOrder:-1},typeOptions:{handler:function(){var _handler=(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(typeOptions){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.next=2,(0,approverUtils/* getApproverOptions */.p9)(typeOptions);case 2:this.typeOptionMap=_context.sent;case 3:case"end":return _context.stop()}}),_callee,this)})));function handler(_x){return _handler.apply(this,arguments)}return handler}(),immediate:!0}},methods:{init:function(){var _this=this;if(!this.isNew){var _cloneDeep=cloneDeep_default()(this.policy),approvers=_cloneDeep.approvers,allApprovalRequired=_cloneDeep.allApprovalRequired,approvalOrder=_cloneDeep.approvalOrder;(0,validation/* isEmpty */.xb)(approvers)?this.activeApprovers=[{approverId:null,type:null}]:this.activeApprovers=approvers.map((function(approver){return(0,approverUtils/* deserializeApprover */.Hb)(approver)})),this.allApprovalRequired=allApprovalRequired,this.approvalOrder=approvalOrder||1,this.$nextTick((function(){return _this.canWatchForChanges=!0}))}},isEmptyApprover:function(approver){return(0,validation/* isEmpty */.xb)(approver.type)||(0,validation/* isEmpty */.xb)(approver.approverId)},deleteApprovers:function(index){var approver=this.activeApprovers[index];1!==this.activeApprovers.length||this.isEmptyApprover(approver)||this.addApprover(),this.activeApprovers.splice(index,1)},addApprover:function(){this.activeApprovers.push({type:null,approverId:null})},resetApproverId:function(index){var approver=this.activeApprovers[index];this.$set(this.activeApprovers,index,(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},approver),{},{approverId:null}))},serialize:function(){var _this2=this,approvers=this.activeApprovers.map((function(approver){return(0,approverUtils/* serializeApprover */.c_)(approver,{fields:_this2.moduleFields})})).filter((function(approver){return!(0,validation/* isEmpty */.xb)(approver)}));return(0,validation/* isEmpty */.xb)(approvers)&&(approvers=[]),{approvers:approvers,allApprovalRequired:!(approvers.length<1)&&this.allApprovalRequired,approvalOrder:approvers.length<1?-1:this.allApprovalRequired?this.approvalOrder:-1}}}},components_Approversvue_type_script_lang_js=Approversvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_Approversvue_type_script_lang_js,render,staticRenderFns,!1,null,"3e0dcf4a",null)
/* harmony default export */,Approvers=component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/27657.js.map