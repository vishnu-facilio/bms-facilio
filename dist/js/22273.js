"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[22273],{
/***/42525:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return ApprovalBar}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/approval/ApprovalBar.vue?vue&type=template&id=4fea8923&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("div",{class:["sidebar-loader",(_vm.loading||_vm.isSaving)&&"on"]}),_vm.loading?_c("div",{staticClass:"d-flex approval-bar"},[_vm._v(" "+_vm._s(_vm.$t("panel.loading_load"))+" ")]):_c("div",{staticClass:"d-flex approval-bar"},[_c("div",{staticClass:"approval-desc mR30 f14"},[_vm.isRejected?[_c("span",{staticClass:"bold"},[_vm._v(_vm._s(_vm.policyName))]),_vm._v(" "+_vm._s(_vm.$t("panel.was"))+" "),_c("span",{staticClass:"bold",staticStyle:{color:"#dd7171"}},[_vm._v(_vm._s(_vm.$t("panel.rejected")))]),_vm._v(" for this "+_vm._s(_vm.moduleDisplayName||_vm.moduleName)+". "),_vm.resendApproval?[_c("span",[_vm._v("You can")]),_vm.canShowEdit?[_c("span",{staticClass:"mL5"},[_vm._v("either")]),_c("span",{class:[_vm.isSaving&&"cursor-not-allowed"]},[_c("a",{class:["mL5 bold",_vm.isSaving&&"pointer-events-none"],on:{click:function($event){return _vm.$emit("onEdit")}}},[_vm._v(" edit ")])]),_c("span",{staticClass:"mL5"},[_vm._v("or")])]:_vm._e(),_c("span",{class:[_vm.isSaving&&"cursor-not-allowed"]},[_c("a",{class:["mL5 bold",_vm.isSaving&&"pointer-events-none"],on:{click:function($event){return _vm.requestToSave(_vm.resendApproval)}}},[_vm._v(" resend ")])]),_c("span",{staticClass:"mL5"},[_vm._v("for approval.")])]:_vm._e()]:_vm.hasApprovalList&&!_vm.hideApprovers?[_c("span",{staticClass:"bold"},[_vm._v(_vm._s(_vm.policyName))]),_vm._v(" is pending from "),_c("span",{staticClass:"bold"},[_vm._v(_vm._s(_vm.approvers[0].name))]),_vm.approvers.length>1?_c("el-popover",{attrs:{placement:"bottom",width:"200",trigger:"hover"}},[_vm._t("default",(function(){return[_c("div",{staticClass:"mL5 approvers-more-icon"},[_vm._v(" +"+_vm._s(_vm.approvers.length-1)+" ")])]}),{slot:"reference"}),_c("div",_vm._l(_vm.approvers.slice(1),(function(approver){return _c("div",{key:approver.name,staticClass:"mB10"},[_c("ApproverTypeAvatar",{attrs:{size:"md",user:approver,userType:_vm.getApproverType(approver),moduleName:_vm.moduleName,approvalMeta:_vm.approvalMeta}})],1)})),0)],2):_vm._e()]:(_vm.$validation.isEmpty(_vm.transitions),[_c("span",{staticClass:"bold"},[_vm._v(_vm._s(_vm.policyName))]),_vm._v(" is pending ")])],2),_vm.$validation.isEmpty(_vm.transitions)?_vm._e():_c("div",{staticClass:"approval-links text-uppercase f12 bold"},[_c("div",{class:[_vm.isSaving&&"cursor-not-allowed"]},[_vm.approveTransition?_c("a",{class:["link-approve mR15",_vm.isSaving&&"pointer-events-none"],on:{click:function($event){return _vm.requestToSave(_vm.approveTransition)}}},[_c("inline-svg",{attrs:{src:"tick-sign",iconClass:"icon icon-xs"}}),_vm._v(" "+_vm._s(_vm.approveTransition.name)+" ")],1):_vm._e(),_vm.rejectTransition?_c("a",{class:["link-reject",_vm.isSaving&&"pointer-events-none"],on:{click:function($event){return _vm.requestToSave(_vm.rejectTransition)}}},[_c("inline-svg",{attrs:{src:"svgs/close",iconClass:"icon icon-xxs"}}),_vm._v(" "+_vm._s(_vm.rejectTransition.name)+" ")],1):_vm._e()])])]),_vm.canShowForm?[_c("TransitionForm",{attrs:{moduleName:_vm.selectedTransition.moduleName,recordId:_vm.record.recordId,formId:_vm.selectedTransition.formId,record:_vm.record,transition:_vm.selectedTransition,approvalRule:_vm.approvalRule,saveAction:_vm.saveAction,closeAction:_vm.closeStateFlowForm,isV3:_vm.isV3}})]:_vm._e()],2)},staticRenderFns=[],toConsumableArray=__webpack_require__(488478),objectSpread2=__webpack_require__(595082),ApprovalButtons=(__webpack_require__(689730),__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(670560),__webpack_require__(425728),__webpack_require__(434284),__webpack_require__(976801),__webpack_require__(634338),__webpack_require__(840889)),ApprovalForm=__webpack_require__(548127),ApprovalUserAvatar=__webpack_require__(400438),validation=__webpack_require__(990260),vuex_esm=__webpack_require__(420629),ApprovalBarvue_type_script_lang_js={extends:ApprovalButtons/* default */.Z,props:["hideApprovers","canShowEdit","canHideMsg"],components:{TransitionForm:ApprovalForm/* default */.Z,ApproverTypeAvatar:ApprovalUserAvatar/* default */.Z},data:function(){return{isSaving:!1}},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({metaInfo:function(state){return state.view.metaInfo}})),{},{transitions:function(){return(0,validation/* isEmpty */.xb)(this.stateTransitions)?[]:(0,toConsumableArray/* default */.Z)(this.stateTransitions).slice(0,2)},policyName:function(){return(0,validation/* isEmpty */.xb)(this.approvalRule)?"Approval":this.$getProperty(this.approvalRule,"name")},shouldCurrentUserApprove:function(){return!(0,validation/* isEmpty */.xb)(this.transitions)},hasApprovalList:function(){return!(0,validation/* isEmpty */.xb)(this.approvers)},approvalMeta:function(){return{approvalList:this.pendingApprovalList}},approvers:function(){var approvers=[];return this.pendingApprovalList.forEach((function(approver){var value=approver.value,type=approver.type;(0,validation/* isEmpty */.xb)(value)?"TENANT"===type?approvers.push({name:"Tenant",type:"TENANT"}):"VENDOR"===type&&approvers.push({name:"Vendor",type:"VENDOR"}):(0,validation/* isArray */.kJ)(value)?approvers.push.apply(approvers,(0,toConsumableArray/* default */.Z)(value)):approvers.push(value)})),approvers},isRejected:function(){return"Rejected"===this.$getProperty(this.currentState,"status")},shouldCreateModuleRecord:function(){return!1},shouldCreateNotes:function(){return!1},approveTransition:function(){return this.transitions.find((function(t){return"Approve"===t.name}))},rejectTransition:function(){return this.transitions.find((function(t){return"Reject"===t.name}))},resendApproval:function(){return this.transitions.find((function(t){return!["Approve","Reject"].includes(t.name)}))},moduleDisplayName:function(){var _this$metaInfo;return null===(_this$metaInfo=this.metaInfo)||void 0===_this$metaInfo?void 0:_this$metaInfo.displayName}}),methods:{showMessage:function(transition){
/* override */
var name=transition.name,action="";["Approve","Reject"].includes(name)?"Approve"===name?action="approved":"Reject"===name&&(action="rejected"):action="resent for approval",this.$message.success("".concat(this.moduleDisplayName||this.moduleName," was ").concat(action))},requestToSave:function(transition){var _this=this;this.isSaving=!0,this.startTransition(transition).finally((function(){return _this.isSaving=!1}))},saveAction:function(formData){return this.transitionToState(formData)},getApproverType:function(approver){return approver.id?{type:"USER",value:approver}:approver},defaultResponseHandler:function(_ref,transition){var error=_ref.error,canShowForm=this.canShowForm;error?(!this.canHideMsg&&this.$message.error(error.message),this.$emit("onFailure",{error:error,transition:transition})):(canShowForm&&this.closeStateFlowForm(),this.fetchAvailableStates(),this.$emit("onSuccess",{error:error,transition:transition}),!this.canHideMsg&&this.showMessage(transition))}}},approval_ApprovalBarvue_type_script_lang_js=ApprovalBarvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(approval_ApprovalBarvue_type_script_lang_js,render,staticRenderFns,!1,null,"4fea8923",null)
/* harmony default export */,ApprovalBar=component.exports},
/***/760218:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return PageBuilder}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/page/PageBuilder.vue?vue&type=template&id=0dd0982f
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.showPage&&_vm.pagebuilderComponent?_c(_vm.pagebuilderComponent,_vm._b({tag:"component",attrs:{module:_vm.module},on:{forceOldPage:function($event){_vm.forceOld=!0}}},"component",_vm.$attrs,!1)):_vm._e()},staticRenderFns=[],objectSpread2=__webpack_require__(595082),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),vuex_esm=(__webpack_require__(260228),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(420629)),PageBuildervue_type_script_lang_js={props:["module"],data:function(){return{forceOld:!1,showPage:!1}},components:{NewPageBuilder:function(){return Promise.all(/* import() */[__webpack_require__.e(93208),__webpack_require__.e(50232),__webpack_require__.e(93765),__webpack_require__.e(95953),__webpack_require__.e(35309),__webpack_require__.e(18778),__webpack_require__.e(12303),__webpack_require__.e(84290),__webpack_require__.e(31721),__webpack_require__.e(64418),__webpack_require__.e(5603),__webpack_require__.e(57432),__webpack_require__.e(435),__webpack_require__.e(72230),__webpack_require__.e(94255),__webpack_require__.e(67683),__webpack_require__.e(44178),__webpack_require__.e(91132),__webpack_require__.e(20280),__webpack_require__.e(78256),__webpack_require__.e(22200),__webpack_require__.e(49081),__webpack_require__.e(89472),__webpack_require__.e(12085),__webpack_require__.e(55754),__webpack_require__.e(86494),__webpack_require__.e(3037),__webpack_require__.e(49908),__webpack_require__.e(22061),__webpack_require__.e(31602),__webpack_require__.e(73609),__webpack_require__.e(44119),__webpack_require__.e(88262),__webpack_require__.e(82080),__webpack_require__.e(88506)]).then(__webpack_require__.bind(__webpack_require__,110570))},OldPageBuilder:function(){return Promise.all(/* import() */[__webpack_require__.e(93208),__webpack_require__.e(50232),__webpack_require__.e(93765),__webpack_require__.e(95953),__webpack_require__.e(35309),__webpack_require__.e(18778),__webpack_require__.e(12303),__webpack_require__.e(84290),__webpack_require__.e(31721),__webpack_require__.e(64418),__webpack_require__.e(5603),__webpack_require__.e(57432),__webpack_require__.e(435),__webpack_require__.e(72230),__webpack_require__.e(94255),__webpack_require__.e(67683),__webpack_require__.e(44178),__webpack_require__.e(91132),__webpack_require__.e(20280),__webpack_require__.e(78256),__webpack_require__.e(22200),__webpack_require__.e(49081),__webpack_require__.e(89472),__webpack_require__.e(12085),__webpack_require__.e(55754),__webpack_require__.e(86494),__webpack_require__.e(3037),__webpack_require__.e(49908),__webpack_require__.e(22061),__webpack_require__.e(31602),__webpack_require__.e(73609),__webpack_require__.e(23803),__webpack_require__.e(55246)]).then(__webpack_require__.bind(__webpack_require__,223803))}},created:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(_context.prev=0,!_this.$helpers.isLicenseEnabled("PAGE_BUILDER")){_context.next=4;break}return _context.next=4,_this.$store.dispatch("pagebuilder/loadNewPageEnabledModules");case 4:_context.next=8;break;case 6:_context.prev=6,_context.t0=_context["catch"](0);case 8:_this.$nextTick((function(){_this.showPage=!0}));case 9:case"end":return _context.stop()}}),_callee,null,[[0,6]])})))()},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({newPageEnabledModules:function(state){return state.pagebuilder.newPageEnabledModules}})),{},{pagebuilderComponent:function(){var newPageEnabledModules=this.newPageEnabledModules,module=this.module,forceOld=this.forceOld,isNew=(newPageEnabledModules||[]).includes(module),showNew=!forceOld&&(this.showNewPageBuilder||isNew);return showNew?"NewPageBuilder":"OldPageBuilder"},showNewPageBuilder:function(){var query=this.$route.query,_query$showNewPageBui=query.showNewPageBuilder,showNewPageBuilder=void 0!==_query$showNewPageBui&&_query$showNewPageBui;return!0===showNewPageBuilder||"true"===showNewPageBuilder}})},page_PageBuildervue_type_script_lang_js=PageBuildervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(page_PageBuildervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,PageBuilder=component.exports},
/***/400438:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return ApprovalUserAvatar}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/approvals/components/ApprovalUserAvatar.vue?vue&type=template&id=443099a5&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"inline"},[_c("div",{staticClass:"fc-avatar-element q-item-division relative-position"},[_c("div",{staticClass:"q-item-side-left q-item-section"},[_vm.hasUser?_c("avatarPopover",{attrs:{user:_vm.userObj,moduleName:_vm.moduleName}},[_c("span",{attrs:{slot:"reference"},slot:"reference"},[_c("avatar",{attrs:{size:_vm.size,user:_vm.userObj,color:_vm.color}})],1)]):_vm.fieldType?_c("avatarPopover",{attrs:{user:_vm.fieldTypeUserValue,moduleName:_vm.moduleName}},[_c("span",{attrs:{slot:"reference"},slot:"reference"},[_c("avatar",{attrs:{size:_vm.size,user:_vm.fieldTypeUserValue,color:_vm.color}})],1)]):_c("div",{class:["icon-border",_vm.userTypeIcon[_vm.userType.type].background]},[_c("inline-svg",{class:["mT2",_vm.userTypeIcon[_vm.userType.type].marginLeft],attrs:{src:_vm.userTypeIcon[_vm.userType.type].icon,iconClass:"icon text-center fc-fill-path fill-path-white "+_vm.userTypeIcon[_vm.userType.type].iconSize}})],1)],1),_c("div",{staticClass:"flex-middle"},[_vm.$validation.isObject(_vm.typeLabel)?_c("span",{staticClass:"q-item-label d-flex flex-wrap"},[_vm._v(" "+_vm._s(_vm.typeLabel.value)+"  "),_vm.typeLabel.type?_c("span",{staticClass:"text-fc-grey mL5"},[_vm._v(" ("+_vm._s(_vm.typeLabel.type)+") ")]):_vm._e()]):_c("span",{staticClass:"q-item-label d-flex flex-wrap user-type"},[_vm._v(" "+_vm._s(_vm.typeLabel)+" ")]),_vm.approvers.length>1?_c("el-popover",{attrs:{placement:"bottom",width:"200",trigger:"hover"}},[_vm._t("default",(function(){return[_c("div",{staticClass:"approvers-more-icon"},[_vm._v("+"+_vm._s(_vm.approvers.length-1))])]}),{slot:"reference"}),_c("div",_vm._l(_vm.approvers.slice(1),(function(approver){return _c("div",{key:approver.name,staticClass:"mB10"},[_c("ApprovalUserAvatar",{attrs:{size:"md",user:approver,userType:_vm.getApproverType(approver),moduleName:_vm.moduleName,approvalMeta:_vm.approvalMeta}})],1)})),0)],2):_vm._e()],1)])])},staticRenderFns=[],validation=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(434284),__webpack_require__(990260)),User=__webpack_require__(426803),ApprovalUserAvatarvue_type_script_lang_js={name:"ApprovalUserAvatar",extends:User/* default */.Z,props:["userType","approvalMeta","approverObj"],computed:{hasUser:function(){var id=this.$getProperty(this.userObj,"id");return!(0,validation/* isEmpty */.xb)(id)},fieldType:function(){var _this$userType=this.userType,type=_this$userType.type,value=_this$userType.value;return"FIELD"===type&&!(0,validation/* isEmpty */.xb)(value)},fieldTypeUserValue:function(){var fieldType=this.fieldType,userType=this.userType,value=userType.value;return fieldType?(0,validation/* isArray */.kJ)(value)&&!(0,validation/* isEmpty */.xb)(value)?value[0]:value:null},fieldName:function(){var approverObj=this.approverObj,approvalMeta=this.approvalMeta,_ref=approvalMeta||{},_ref$approvalList=_ref.approvalList,approvalList=void 0===_ref$approvalList?[]:_ref$approvalList;if(!(0,validation/* isEmpty */.xb)(approvalList)){var displayName=approvalList.find((function(list){return list.approverGroup===approverObj.approverGroup})).field.displayName;return displayName}return null},color:function(){return-1!==this.userObj.id||this.fieldType?"":this.group?"#c3c3c3":"#e3e3e3"},userTypeIcon:function(){var userIcon={TENANT:{icon:"svgs/tenant",background:"green",iconSize:"icon-lg",marginLeft:"mL4"},VENDOR:{icon:"svgs/apps/vendor",background:"orange",iconSize:"icon-lg",marginLeft:"mL4"},ROLE:{icon:"svgs/role",background:"yellow",iconSize:"icon-xl",marginLeft:"mL3"},GROUP:{icon:"svgs/team",background:"blue",iconSize:"icon-xl",marginLeft:"mL3"},FIELD:{icon:"user",background:"brown",iconSize:"icon-lg",marginLeft:"mL4"}};return userIcon},typeLabel:function(){var _this$userType2=this.userType,type=_this$userType2.type,value=_this$userType2.value;if("USER"===type)return{value:this.userObj.name,type:null};if("TENANT"===type)return value?{value:value.name,type:"Tenant"}:"Tenant";if("VENDOR"===type)return value?{value:value.name,type:"Vendor"}:"Vendor";if("FIELD"===type){var _ref2=this.fieldTypeUserValue||{},name=_ref2.name;return{value:name||this.fieldName,type:"Field"}}return value.name},approvers:function(){var _this$userType3=this.userType,type=_this$userType3.type,value=_this$userType3.value;return"USER"===type?[this.userObj]:(0,validation/* isArray */.kJ)(value)?value:[value]}},methods:{getApproverType:function(approver){return approver.id?{type:"USER",value:approver}:approver}}},components_ApprovalUserAvatarvue_type_script_lang_js=ApprovalUserAvatarvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_ApprovalUserAvatarvue_type_script_lang_js,render,staticRenderFns,!1,null,"443099a5",null)
/* harmony default export */,ApprovalUserAvatar=component.exports},
/***/422273:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return Overview}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/base-module-v2/Overview.vue?vue&type=template&id=423f1686&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"custom-modules-overview",class:_vm.$validation.isEmpty(_vm.customClass)?"":_vm.customClass},[_vm.showActionDialog?_c("PortalAccessDialog",{attrs:{user:_vm.customModuleData,appLinkNames:_vm.allowedPortals,onSave:_vm.savePortalUser},on:{onClose:_vm.hideDialog}}):_vm._e(),_vm.isLoading?_vm._e():_c("div",{staticClass:"header pT10 pB15 pL20 pR20"},[_vm.$validation.isEmpty(_vm.customModuleData)?_vm._e():_c("div",{staticClass:"asset-details"},[_c("div",{staticClass:"d-flex flex-middle"},[_vm.showPhotoField?_c("div",{staticClass:"mR5"},[_vm.customModuleData[_vm.photoFieldName]?_c("div",[_c("img",{staticClass:"img-container",attrs:{src:_vm.getImage(_vm.customModuleData[_vm.photoFieldName])}})]):_vm.showAvatar?_c("div",[_c("avatar",{attrs:{size:"lg",user:{name:_vm.customModuleData.name}}})],1):_vm._e()]):_vm._e(),_c("div",{staticClass:"mL5"},[_c("div",{staticClass:"asset-id mT10"},[_vm.$account.portalInfo?_c("i",{directives:[{name:"tippy",rawName:"v-tippy",value:{animateFill:!1,animation:"shift-toward"},expression:"{ animateFill: false, animation: 'shift-toward' }"}],staticClass:"el-icon-back fc-grey3-text14 fw6 pR10 pointer",attrs:{content:"back",arrow:""},on:{click:_vm.back}}):_vm._e(),_vm._v(" #"+_vm._s(_vm.customModuleData.id)+" ")]),_c("div",{staticClass:"asset-name mb5 d-flex"},[_vm._v(" "+_vm._s(_vm.customModuleData[_vm.mainFieldKey])+" "),_vm.isStateFlowEnabled&&_vm.currentModuleState?_c("div",{staticClass:"fc-badge text-uppercase inline vertical-middle mL15"},[_vm._v(" "+_vm._s(_vm.currentModuleState)+" ")]):_vm._e()])])])]),_c("div",{staticClass:"d-flex flex-direction-row",staticStyle:{"margin-left":"auto"}},[_c("CustomButton",{staticClass:"p10",attrs:{record:Object.assign({},_vm.customModuleData,_vm.customModuleData&&_vm.customModuleData.data||{}),moduleName:_vm.moduleName,position:_vm.POSITION.SUMMARY},on:{refresh:function($event){return _vm.refreshObj()},onError:function(){}}}),321===_vm.$org.id&&"custom_tenantbilling"===_vm.moduleName?_c("el-button-group",{staticClass:"fc-group-btn2 flex-middle mR10"},[_c("el-button",{staticStyle:{height:"39px"},attrs:{type:"primary"},on:{click:_vm.summaryDownload}},[_c("inline-svg",{attrs:{src:"svgs/download2",iconClass:"icon vertical-middle icon-sm fill-grey2"}})],1),_c("el-button",{staticStyle:{height:"39px"},attrs:{type:"primary"},on:{click:_vm.openPrintPreview}},[_c("inline-svg",{attrs:{src:"svgs/print2",iconClass:"icon vertical-middle icon-sm fill-grey2"}})],1)],1):_vm._e(),_vm.downloadUrl?_c("iframe",{staticStyle:{display:"none"},attrs:{src:_vm.downloadUrl}}):_vm._e(),_vm.isStateFlowEnabled?[_c("TransitionButtons",{key:_vm.customModuleData.id,staticClass:"mR10",attrs:{moduleName:_vm.moduleName,record:_vm.customModuleData,updateUrl:_vm.updateUrl,transformFn:_vm.transformFormData,disabled:_vm.isApprovalEnabled,buttonClass:"asset-el-btn"},on:{currentState:function(){},transitionSuccess:function($event){return _vm.refreshObj()},transitionFailure:function(){}}})]:_vm._e(),_vm.isApprovalEnabled?_c("portal",{attrs:{to:"pagebuilder-sticky-top"}},[_c("ApprovalBar",{key:_vm.customModuleData.id+"approval-bar",staticClass:"approval-bar-shadow",attrs:{moduleName:_vm.moduleName,record:_vm.customModuleData,updateUrl:_vm.updateUrl,transformFn:_vm.transformFormData,hideApprovers:_vm.shouldHideApprovers},on:{onSuccess:function($event){return _vm.refreshObj()},onFailure:function(){}}})],1):_vm._e(),_vm.showEdit?_c("el-button",{staticClass:"fc-wo-border-btn pL15 pR15 self-center",attrs:{type:"button"},on:{click:function($event){return _vm.editCustomModuleData(_vm.customModuleData)}}},[_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-edit",attrs:{title:"Edit"}})]):_vm._e(),"tenantcontact"===_vm.moduleName||"vendorcontact"===_vm.moduleName?_c("el-button",{staticClass:"fc-wo-border-btn pL15 pR15 self-center",attrs:{type:"button"},on:{click:function($event){return _vm.showDialog(_vm.customModuleData)}}},[_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-setting",attrs:{title:"Application Access"}})]):_vm._e(),"employee"===_vm.moduleName?_c("el-dropdown",{staticClass:"fc-btn-ico-lg mL15 fc-btn-ico-lg pT5 pB5 pL8 pR8 pointer height40 mT4",attrs:{trigger:"click"}},[_c("div",{ref:"",staticClass:"flex-middle"},[_c("i",{staticClass:"el-icon-more pointer overview-icon-more-btn"}),_c("span",{staticClass:"pointer mL-auto text-fc-pink child-add"})]),_c("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[_c("el-dropdown-item",[_c("div",{on:{click:function($event){return _vm.showDialog(_vm.customModuleData)}}},[_vm._v("Portal Access")])])],1)],1):_vm._e(),_vm.$validation.isEmpty(_vm.subModulesList)?_vm._e():_c("el-dropdown",{staticClass:"mL10 custom-module-dropdown self-center",attrs:{trigger:"hover"},on:{command:function(moduleName){return _vm.openNewForm(moduleName)}}},[_c("el-button",{staticClass:"fc-wo-border-btn pL15 pR15",attrs:{type:"primary"}},[_c("i",{staticClass:"el-icon-plus"})]),_c("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},_vm._l(_vm.subModulesList,(function(module,index){return _c("el-dropdown-item",{key:index,attrs:{command:module.name}},[_vm._v(" "+_vm._s("Convert to "+(_vm.$constants.moduleSingularDisplayNameMap[module.name]?_vm.$constants.moduleSingularDisplayNameMap[module.name]:module.displayName))+" ")])})),1)],1)],2)]),_vm.customModuleData&&_vm.customModuleData.id?_c("page",{key:_vm.customModuleData.id,attrs:{module:_vm.moduleName,id:_vm.customModuleData.id,details:_vm.customModuleData,primaryFields:_vm.primaryFields,notesModuleName:_vm.notesModuleName,attachmentsModuleName:_vm.attachmentsModuleName,isV3Api:_vm.isV3Api}}):_vm._e(),_c("el-dialog",{staticClass:"dialog-d",attrs:{visible:_vm.showDeleteDialog,"custom-class":"setup-dialog45","show-close":!1},on:{"update:visible":function($event){_vm.showDeleteDialog=$event}}},[_c("div",{staticClass:"text-center fc-black-20"},[_vm._v(" Do you want to delete or dissociate from "+_vm._s(_vm.moduleName?_vm.moduleName:"")+" ? ")]),_c("span",{staticClass:"fc-dialog-center-container delete-dialog-footer padding-px18",attrs:{slot:"footer"},slot:"footer"},[_c("el-button",{on:{click:function($event){_vm.showDeleteDialog=!1}}},[_vm._v("CANCEL")]),_c("el-button",{staticClass:"delete-dissociate-buttons",on:{click:function($event){return _vm.dissociate()}}},[_vm._v("DISSOCIATE")]),_c("el-button",{staticClass:"delete-dissociate-buttons",on:{click:function($event){return _vm.deleteRecord()}}},[_vm._v("MOVE TO RECYCLE BIN")])],1)])],1)},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),objectSpread2=__webpack_require__(595082),PageBuilder=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(434284),__webpack_require__(670560),__webpack_require__(634338),__webpack_require__(760218)),Avatar=__webpack_require__(574752),TransitionButtons=__webpack_require__(987612),PortalAccessDialog=__webpack_require__(493482),vuex_esm=__webpack_require__(420629),eventBus=__webpack_require__(398011),validation=__webpack_require__(990260),ApprovalBar=__webpack_require__(42525),api=__webpack_require__(32284),CustomButton=__webpack_require__(623857),CustomButtonUtil=__webpack_require__(746095),router=__webpack_require__(329435),baseUrl=__webpack_require__(420499),Overviewvue_type_script_lang_js={components:{Page:PageBuilder/* default */.Z,TransitionButtons:TransitionButtons/* default */.Z,ApprovalBar:ApprovalBar/* default */.Z,Avatar:Avatar["default"],CustomButton:CustomButton/* default */.Z,PortalAccessDialog:PortalAccessDialog/* default */.Z},data:function(){return{updateUrl:"/v2/module/data/update",customModuleDataObj:{},showDeleteDialog:!1,notesModuleName:"cmdnotes",attachmentsModuleName:"cmdattachments",primaryFields:["name","photo","avatar"],customClass:null,isLoading:!1,showChangeStatusDialog:!1,showActionDialog:!1,showEmployeeActionDialog:!1,downloadUrl:null,POSITION:CustomButtonUtil/* POSITION_TYPE */.Rz,formFields:[],allowedPortals:[]}},created:function(){var _this=this,moduleName=this.moduleName;this.$store.dispatch("loadTicketStatus",moduleName||""),this.$store.dispatch("loadApprovalStatus"),this.$store.dispatch("loadSites"),eventBus/* eventBus */.Y.$on("show-delete-dialog",(function(relatedObj){var showDeleteDialog=relatedObj.showDeleteDialog;_this.openDeleteDialog(showDeleteDialog)}))},mounted:function(){this.loadCustomModuleData()},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({moduleMeta:function(state){return state.view.metaInfo},sites:function(state){return state.sites}})),(0,vuex_esm/* mapGetters */.Se)(["getApprovalStatus","isStatusLocked","getTicketStatus"])),{},{moduleName:function(){return this.$route.params.moduleName?this.$route.params.moduleName:this.$attrs.moduleName||""},isV3Api:function(){return!1},id:function(){var paramId=this.$attrs.id||this.$route.params.id;return paramId&&"null"!==paramId?parseInt(this.$route.params.id):""},customModuleData:function(){return this.$store.state.customModule.customModuledata},isStateFlowEnabled:function(){var hasState=this.$getProperty(this.customModuleData,"moduleState.id"),isCustomModule=this.$getProperty(this.moduleMeta,"module.custom"),isEnabled=this.$getProperty(this.moduleMeta,"module.stateFlowEnabled");return hasState&&(!isCustomModule||isCustomModule&&isEnabled)},isApprovalEnabled:function(){var customModuleData=this.customModuleData,_ref=customModuleData||{},approvalFlowId=_ref.approvalFlowId,approvalStatus=_ref.approvalStatus;return!(0,validation/* isEmpty */.xb)(approvalFlowId)&&!(0,validation/* isEmpty */.xb)(approvalStatus)},currentModuleState:function(){var moduleName=this.moduleName,customModuleData=this.customModuleData,currentStateId=this.$getProperty(customModuleData,"moduleState.id"),currentState=this.getTicketStatus(currentStateId,moduleName),_ref2=currentState||{},displayName=_ref2.displayName,status=_ref2.status;return(0,validation/* isEmpty */.xb)(displayName)?status||null:displayName},isRecordLocked:function(){var customModuleData=this.customModuleData,moduleName=this.moduleName;if(this.isStateFlowEnabled){var moduleState=this.$getProperty(customModuleData,"moduleState.id");return moduleState&&this.isStatusLocked(customModuleData.moduleState.id,moduleName)}return!1},isRequestedState:function(){var customModuleData=this.customModuleData,_ref3=customModuleData||{},approvalStatus=_ref3.approvalStatus;if((0,validation/* isEmpty */.xb)(approvalStatus))return!1;var statusObj=this.getApprovalStatus(approvalStatus.id);return this.$getProperty(statusObj,"requestedState",!1)},mainFieldKey:function(){return"name"},photoFieldName:function(){return"photoId"},showEdit:function(){var canShowEdit;canShowEdit=!this.$constants.isCustomModulePermissionsEnabled(this.$org.id)||this.$hasPermission("".concat(this.moduleName,":UPDATE"));var isNotLocked=!this.isStateFlowEnabled||!this.isRecordLocked&&!this.isRequestedState;return canShowEdit&&isNotLocked},showPhotoField:function(){if(this.formFields){var photoField=this.formFields.find((function(field){return"photo"===field.name}));return!!photoField&&!photoField.hideField}return!1},showAvatar:function(){return!1},subModulesList:function(){return[]},shouldHideApprovers:function(){return!1},isSuperAdmin:function(){var _this2=this;return"Super Administrator"===(this.userRoles.find((function(role){return role.id===_this2.customModuleData.roleId}))||{}).name},pdfUrl:function(){return window.location.protocol+"//"+window.location.host+"/app/pdf/tenantbilling?id=".concat(this.customModuleData.id)}}),watch:{id:function(newVal,oldVal){newVal&&oldVal!==newVal&&this.loadCustomModuleData()}},methods:{handleCommand:function(){var customModuleData=this.customModuleData,sites=this.sites,usedSite=sites.find((function(site){return site.id===customModuleData.siteId})),queryParam={};if(queryParam={tenant:customModuleData.id,tenantLabel:customModuleData.name,siteId:customModuleData.siteId,siteIdLabel:usedSite.name},320===this.$account.org.orgId&&(queryParam.resource=customModuleData.data.lookup.id,queryParam.resourceLabel=customModuleData.data.lookup.name),(0,router/* isWebTabsEnabled */.tj)()){var _ref4=(0,router/* findRouteForModule */.Jp)("workorder",router/* pageTypes */.As.CREATE)||{},name=_ref4.name;name&&this.$router.push({name:name,query:queryParam})}else this.$router.push({path:"/app/wo/create",query:queryParam})},transformFormData:function(returnObj,data){return returnObj["moduleData"]={id:this.customModuleData.id},data&&(data.comment&&(returnObj.comment=data.comment,delete data.comment),returnObj["moduleData"]=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},returnObj["moduleData"]),data),data.warrantyExpiryDate&&(returnObj["moduleData"]=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},returnObj["moduleData"]),{},{warrantyExpiryData:Date.parse(data.warrantyExpiryDate)}))),returnObj},getFormMeta:function(){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var _this3$customModuleDa,_this3$customModuleDa2,formId,moduleName,url,_yield$API$get,data,error,formFields;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _this3$customModuleDa=_this3.customModuleData,_this3$customModuleDa2=void 0===_this3$customModuleDa?{}:_this3$customModuleDa,formId=_this3$customModuleDa2.formId,moduleName=_this3.moduleName,url="/v2/forms/".concat(moduleName),_context.next=4,api/* API */.bl.get(url,{formId:formId||-1});case 4:_yield$API$get=_context.sent,data=_yield$API$get.data,error=_yield$API$get.error,error||(formFields=(data.form||{}).fields,_this3.formFields=formFields);case 8:case"end":return _context.stop()}}),_callee)})))()},loadCustomModuleData:function(){var _this4=this,moduleName=this.moduleName,id=this.id,queryObj={id:id,moduleName:moduleName};this.$set(this,"isLoading",!0),this.$store.dispatch("customModule/fetch",queryObj).then((function(){_this4.getFormMeta()})).catch((function(error){error&&_this4.$message.error(error)})).finally((function(){_this4.isLoading=!1}))},refreshObj:function(){this.loadCustomModuleData()},editCustomModuleData:function(){var moduleName=this.moduleName,id=this.id;if((0,router/* isWebTabsEnabled */.tj)()){var _ref5=(0,router/* findRouteForModule */.Jp)(moduleName,router/* pageTypes */.As.EDIT)||{},name=_ref5.name;name&&this.$router.push({name:name,params:{id:id}})}else{var creationName=this.$helpers.isEtisalat()?this.getEtisalatRouterName().edit:"custommodules-edit";this.$router.push({name:creationName,params:{moduleName:moduleName,id:id}})}},getEtisalatRouterName:function(){var data={new:"custommodules-new",edit:"custommodules-edit",list:"custommodules-list",summary:"custommodules-summary"};if(this.$route&&this.$route.name){var name=this.$route.name;"et1custommodules-list"===name||"et1custommodules-new"===name||"et1custommodules-edit"===name||"et1custommodules-summary"===name?(data["new"]="et1custommodules-new",data["edit"]="et1custommodules-edit",data["list"]="et1custommodules-edit",data["summary"]="et1custommodules-summary",data["modulePath"]="supp"):"et-custommodules-list"===name||"et-custommodules-edit"===name||"et-custommodules-new"===name||"et-custommodules-summary"===name?(data["new"]="et-custommodules-new",data["edit"]="et-custommodules-edit",data["list"]="et-custommodules-list",data["summary"]="et-custommodules-summary",data["modulePath"]="al"):"et2-custommodules-list"!==name&&"et2-custommodules-edit"!==name&&"et2-custommodules-new"!==name&&"et2-custommodules-summary"!==name||(data["new"]="et2-custommodules-new",data["edit"]="et2-custommodules-edit",data["list"]="et2-custommodules-list",data["summary"]="et2-custommodules-summary",data["modulePath"]="home")}return data},getImage:function(photoId){return"".concat((0,baseUrl/* getBaseURL */.BS)(),"/v2/files/preview/").concat(photoId)},openDeleteDialog:function(showDeleteDialog){this.showDeleteDialog=showDeleteDialog},deleteRecord:function(){eventBus/* eventBus */.Y.$emit("delete-record")},dissociate:function(){eventBus/* eventBus */.Y.$emit("dissociate")},back:function(){this.$router.go(-1)},showDialog:function(){this.showActionDialog=!0},hideDialog:function(){this.showActionDialog=!1},openNewForm:function(){},
// Temp added for demo.
// Please remove after checking if still required
summaryDownload:function(){var _this5=this;this.downloadUrl=null,this.$message({message:"Downloading...",showClose:!0,duration:0});var additionalInfo={showFooter:!1,footerStyle:"p {font-size:12px; margin-left:500px}",footerHtml:'<p>Page  <span class="pageNumber"></span> / <span class="totalPages"></span></p>'};api/* API */.bl.post("/v2/integ/pdf/create",{url:this.pdfUrl,additionalInfo:additionalInfo}).then((function(_ref6){var data=_ref6.data,error=_ref6.error;if(_this5.$message.closeAll(),error){var _error$message=error.message,message=void 0===_error$message?"Unable to fetch quote download link":_error$message;_this5.$message.error(message)}else{var _ref7=data||{},fileUrl=_ref7.fileUrl;_this5.downloadUrl=fileUrl||null}}))},openPrintPreview:function(){window.open(this.pdfUrl)}}},base_module_v2_Overviewvue_type_script_lang_js=Overviewvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(base_module_v2_Overviewvue_type_script_lang_js,render,staticRenderFns,!1,null,"423f1686",null)
/* harmony default export */,Overview=component.exports},
/***/493482:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return PortalAccessDialog}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/base-module-v2/PortalAccessDialog.vue?vue&type=template&id=e57bad3a
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"fc-dialog-center-container",attrs:{visible:!0,maxHeight:"300px",width:"38%","append-to-body":!0,title:"Portal Access","before-close":_vm.closeDialog}},[_vm.isLoading?_c("div",{staticClass:"height200 mT20"},[_c("Spinner",{attrs:{show:_vm.isLoading,size:"80"}})],1):_c("el-form",{ref:"portalAccessForm",staticClass:"pB50",attrs:{model:_vm.rolesMap,rules:_vm.rules}},[_c("el-row",{staticClass:"mB20"},[_c("div",{staticClass:"text-uppercase fw6"},[_vm._v(_vm._s("Role"))]),_c("div",{staticClass:"fc-heading-border-width43 mT5 width30px"})]),_vm._l(_vm.appLinkNames,(function(linkName){return _c("el-row",{key:linkName,staticClass:"mB10"},[_c("el-col",{staticClass:"mB10"},[_c("el-checkbox",{on:{change:function($event){return _vm.changeAccess(linkName)}},model:{value:_vm.userObj[_vm.linkNameVsDataKey[linkName]],callback:function($$v){_vm.$set(_vm.userObj,_vm.linkNameVsDataKey[linkName],$$v)},expression:"userObj[linkNameVsDataKey[linkName]]"}},[_vm._v(" "+_vm._s(_vm.linkNameVsDisplayName[linkName])+" ")])],1),_c("el-col",[_c("el-form-item",{attrs:{prop:linkName}},[_c("el-select",{staticClass:"fc-input-full-border2 width100",attrs:{placeholder:"Select role",filterable:"",loading:_vm.rolesLoading[linkName],disabled:!_vm.userObj[_vm.linkNameVsDataKey[linkName]]},model:{value:_vm.rolesMap[linkName],callback:function($$v){_vm.$set(_vm.rolesMap,linkName,$$v)},expression:"rolesMap[linkName]"}},_vm._l(_vm.rolesList[linkName],(function(role){return _c("el-option",{key:role.value,attrs:{label:role.label,value:role.value}})})),1)],1)],1)],1)})),_vm.showUserScopingOption||_vm.showPermissionSetOption?_c("el-row",{staticClass:"mB20 mT20"},[_c("div",{staticClass:"text-uppercase fw6"},[_vm._v(_vm._s("Data Sharing"))]),_c("div",{staticClass:"fc-heading-border-width43 mT5"})]):_vm._e(),_vm.showUserScopingOption?[_c("el-row",{staticClass:"fc-dialog-center-container"},[_c("el-col",{attrs:{span:24}},[_c("div",[_vm._v(_vm._s("User Scoping"))])])],1),_c("el-row",{staticClass:"mT10"},[_c("el-col",{attrs:{span:24}},[_c("el-form-item",[_c("el-select",{staticClass:"fc-input-full-border2 width100",attrs:{placeholder:"Select User Scoping",filterable:"",disabled:!_vm.showDataSharingOptions,clearable:"",loading:_vm.rolesLoading[_vm.selectedApp]},model:{value:_vm.userScopingValue,callback:function($$v){_vm.userScopingValue=$$v},expression:"userScopingValue"}},_vm._l(_vm.userScopingList,(function(userScoping){return _c("el-option",{key:userScoping.linkName,attrs:{label:userScoping.scopeName,value:userScoping.id}})})),1)],1)],1)],1)]:_vm._e(),_vm.showPermissionSetOption?[_c("el-row",{staticClass:"fc-dialog-center-container"},[_c("el-col",{attrs:{span:24}},[_c("div",[_vm._v(_vm._s("Permission Set"))])])],1),_c("el-row",{staticClass:"mT10"},[_c("el-col",{attrs:{span:24}},[_c("el-form-item",[_c("el-select",{staticClass:"fc-input-full-border2 width100",attrs:{placeholder:"Select Permission Set",multiple:"","collapse-tags":"",disabled:!_vm.showDataSharingOptions,filterable:"",clearable:"",loading:_vm.rolesLoading[_vm.selectedApp]},model:{value:_vm.userPermissionSets,callback:function($$v){_vm.userPermissionSets=$$v},expression:"userPermissionSets"}},_vm._l(_vm.permissionSet,(function(permissionSet){return _c("el-option",{key:permissionSet.linkName,attrs:{label:permissionSet.displayName,value:permissionSet.id}})})),1)],1)],1)],1)]:_vm._e()],2),_vm.isLoading?_vm._e():_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.closeDialog}},[_vm._v(" "+_vm._s(_vm.$t("common._common.cancel"))+" ")]),_c("el-button",{staticClass:"modal-btn-save",attrs:{loading:_vm.saving,type:"primary"},on:{click:_vm.save}},[_vm._v(" "+_vm._s(_vm.saving?_vm.$t("common._common._saving"):_vm.$t("common._common._save"))+" ")])],1)],1)},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),objectSpread2=__webpack_require__(595082),asyncToGenerator=__webpack_require__(548534),api=(__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(821057),__webpack_require__(648324),__webpack_require__(32284)),validation=__webpack_require__(990260),Spinner=__webpack_require__(604947),PortalAccessDialogvue_type_script_lang_js={props:["appLinkNames","user","onSave"],components:{Spinner:Spinner/* default */.Z},data:function(){return{rolesLoading:{vendor:!1,tenant:!1,client:!1,service:!1},linkNameVsDisplayName:{vendor:"Vendor Portal Access",tenant:"Tenant Portal Access",client:"Client Portal Access",service:"Occupant Portal Access",employee:"Employee Portal Access"},linkNameVsDataKey:{vendor:"isVendorPortalAccess",tenant:"isTenantPortalAccess",client:"isClientPortalAccess",service:"isOccupantPortalAccess",employee:"employeePortalAccess"},rolesList:{},rolesMap:{},userObj:{},rules:{},saving:!1,permissionSet:[],userPermissionSets:[],userScopingList:[],userScopingValue:null,selectedApp:null,firstPermissionSet:null,isLoading:!0}},created:function(){this.init()},computed:{showUserScopingOption:function(){var $helpers=this.$helpers;return $helpers.isLicenseEnabled("NEW_SETUP")&&$helpers.isLicenseEnabled("PEOPLE_USER_SCOPING")},showPermissionSetOption:function(){var $helpers=this.$helpers;return $helpers.isLicenseEnabled("NEW_SETUP")&&$helpers.isLicenseEnabled("PERMISSION_SET")},showDataSharingOptions:function(){var userObj=this.userObj,linkNameVsDataKey=this.linkNameVsDataKey,appLinkNames=this.appLinkNames,showOption=!1;return(0,validation/* isEmpty */.xb)(appLinkNames)||appLinkNames.forEach((function(linkName){showOption=showOption||userObj[linkNameVsDataKey[linkName]]})),showOption},getPrivilegedPermissionSet:function(){var _ref=this||{},permissionSet=_ref.permissionSet,privilegedPermissionSet=null;return(0,validation/* isEmpty */.xb)(permissionSet)||permissionSet.forEach((function(permissionSet){permissionSet.isPrivileged&&(privilegedPermissionSet=permissionSet)})),privilegedPermissionSet}},methods:{init:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var linkNameVsDataKey,user,_ref2,scopingId,permissionSets;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _this.isLoading=!0,linkNameVsDataKey=_this.linkNameVsDataKey,user=_this.user,_this.userObj=(0,objectSpread2/* default */.Z)({},user),_ref2=user||{},scopingId=_ref2.scopingId,permissionSets=_ref2.permissionSets,_this.userPermissionSets=permissionSets,_this.userScopingValue=scopingId,_context2.next=8,_this.loadPermissionSets();case 8:return _context2.next=10,_this.appLinkNames.forEach(function(){var _ref3=(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(linkName){var rolesMap,dataKey,rule;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return rolesMap=user.rolesMap,dataKey=linkNameVsDataKey[linkName],_this.$set(_this.userObj,dataKey,user[dataKey]),_this.rolesMap=rolesMap||{},_this.loadRoles(linkName),_context.next=7,_this.loadUserScopingList();case 7:rule={validator:function(rule,value,callback){var userObj=this.userObj,appLinkNames=this.appLinkNames,rolesMap=this.rolesMap,linkNameVsDataKey=this.linkNameVsDataKey,portalAccess=userObj[linkNameVsDataKey[linkName]];appLinkNames.includes(linkName)&&portalAccess&&!rolesMap[linkName]?callback(new Error("Please select role")):callback()}.bind(_this),trigger:"change"},_this.$set(_this.rules,linkName,rule);case 9:case"end":return _context.stop()}}),_callee)})));return function(_x){return _ref3.apply(this,arguments)}}());case 10:_this.isLoading=!1;case 11:case"end":return _context2.stop()}}),_callee2)})))()},loadPermissionSets:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var _yield$API$get,error,data,_ref4,result,_ref5,permissionSet,userObj,_ref6,permissionSets;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,api/* API */.bl.get("/v1/setup/permissionSet/userList",{page:1,perPage:5e3});case 2:_yield$API$get=_context3.sent,error=_yield$API$get.error,data=_yield$API$get.data,error?_this2.$message.error(error.message||"Error Occcured"):(_ref4=data||{},result=_ref4.result,_ref5=result||[],permissionSet=_ref5.permissionSet,_this2.permissionSet=permissionSet,userObj=_this2.userObj,_ref6=userObj||{},permissionSets=_ref6.permissionSets,_this2.userPermissionSets=permissionSets||[],(0,validation/* isEmpty */.xb)(permissionSet)||(_this2.firstPermissionSet=_this2.getPrivilegedPermissionSet));case 6:case"end":return _context3.stop()}}),_callee3)})))()},loadUserScopingList:function(){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){var _yield$API$get2,error,data,_ref7,result,_ref8,userScopingList,userObj,_ref9,scopingId;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,api/* API */.bl.get("/v1/setup/userScoping/userList",{page:1,perPage:5e3});case 2:_yield$API$get2=_context4.sent,error=_yield$API$get2.error,data=_yield$API$get2.data,error?_this3.$message.error(error.message||"Error Occcured"):(_ref7=data||{},result=_ref7.result,_ref8=result||[],userScopingList=_ref8.userScopingList,_this3.userScopingList=userScopingList,userObj=_this3.userObj,_ref9=userObj||{},scopingId=_ref9.scopingId,_this3.userScopingValue=scopingId);case 6:case"end":return _context4.stop()}}),_callee4)})))()},changeAccess:function(linkName){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee5(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context5){while(1)switch(_context5.prev=_context5.next){case 0:_this4.showRoleSelection(linkName),_this4.checkAndSetPermissionSet(linkName);case 2:case"end":return _context5.stop()}}),_callee5)})))()},showRoleSelection:function(linkName){var _this5=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee6(){var userObj,linkNameVsDataKey;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context6){while(1)switch(_context6.prev=_context6.next){case 0:if(userObj=_this5.userObj,linkNameVsDataKey=_this5.linkNameVsDataKey,_this5.selectedApp=linkName,!userObj[linkNameVsDataKey[linkName]]){_context6.next=6;break}return _this5.$set(_this5.rolesMap,linkName,null),_context6.next=6,_this5.loadRoles(linkName);case 6:case"end":return _context6.stop()}}),_callee6)})))()},checkAndSetPermissionSet:function(linkName){var _this6=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee7(){var userObj,linkNameVsDataKey,_ref10,firstPermissionSet;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context7){while(1)switch(_context7.prev=_context7.next){case 0:userObj=_this6.userObj,linkNameVsDataKey=_this6.linkNameVsDataKey,_this6.selectedApp=linkName,userObj[linkNameVsDataKey[linkName]]&&(_ref10=_this6||{},firstPermissionSet=_ref10.firstPermissionSet,(0,validation/* isEmpty */.xb)(firstPermissionSet)||(_this6.userPermissionSets=[null===firstPermissionSet||void 0===firstPermissionSet?void 0:firstPermissionSet.id]));case 3:case"end":return _context7.stop()}}),_callee7)})))()},loadRoles:function(linkName){var _this7=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee8(){var filters,_yield$API$get3,error,data,_ref11,pickList;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context8){while(1)switch(_context8.prev=_context8.next){case 0:if((0,validation/* isEmpty */.xb)(_this7.rolesList[linkName])){_context8.next=2;break}return _context8.abrupt("return");case 2:return _this7.rolesLoading[linkName]=!0,filters=JSON.stringify({appLinkNames:[linkName]}),_context8.next=6,api/* API */.bl.get("/v3/picklist/role",{filters:filters});case 6:_yield$API$get3=_context8.sent,error=_yield$API$get3.error,data=_yield$API$get3.data,error?_this7.$message.error(error.message||"Error Occcured"):(_ref11=data||{},pickList=_ref11.pickList,_this7.rolesList[linkName]=pickList||[]),_this7.rolesLoading[linkName]=!1;case 11:case"end":return _context8.stop()}}),_callee8)})))()},closeDialog:function(){this.$emit("onClose")},save:function(){var _this8=this;this.$refs["portalAccessForm"].validate((function(valid){if(!valid)return!1;var rolesMap=_this8.rolesMap,userObj=_this8.userObj,userRolesMap=userObj.rolesMap||{};_this8.showPermissionSetOption&&(userObj.permissionSets=_this8.userPermissionSets),_this8.showUserScopingOption&&(userObj.scopingId=_this8.userScopingValue),_this8.saving=!0,_this8.onSave((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},userObj),{},{rolesMap:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},userRolesMap),rolesMap)})).then((function(){return _this8.closeDialog()})).catch((function(){})).finally((function(){return _this8.saving=!1}))}))}}},base_module_v2_PortalAccessDialogvue_type_script_lang_js=PortalAccessDialogvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(base_module_v2_PortalAccessDialogvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,PortalAccessDialog=component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/22273.js.map