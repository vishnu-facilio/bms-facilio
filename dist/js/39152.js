"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[39152],{
/***/490966:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return ColumnCustomization}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/ColumnCustomization.vue?vue&type=template&id=3753cf18
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{attrs:{visible:_vm.showDialog,fullscreen:!0,"custom-class":"cc-dialog",title:_vm.$t("common._common.column_settings"),"append-to-body":!0},on:{"update:visible":function($event){_vm.showDialog=$event}}},[_c("div",{staticClass:"scrollable",staticStyle:{padding:"20px 0","max-height":"85vh"}},[_vm.fixedFields&&_vm.fixedFields.length?_c("div",{staticClass:"fixed-column"},[_c("el-checkbox-group",{model:{value:_vm.selectedFixedColumns,callback:function($$v){_vm.selectedFixedColumns=$$v},expression:"selectedFixedColumns"}},_vm._l(_vm.fixedFields,(function(field){return _c("el-checkbox",{key:field.fieldId,staticClass:"column-item",staticStyle:{border:"none"},attrs:{disabled:field.disabled,label:field.fieldId}},[_vm._v(_vm._s(_vm.getDisplayName(field)))])})),1)],1):_vm._e(),_c("el-divider",{staticClass:"mT0 mB20"}),_c("el-checkbox-group",{staticClass:"fc-column-checkbox pL20 pR20 pT0 pB0",model:{value:_vm.selectedColumns,callback:function($$v){_vm.selectedColumns=$$v},expression:"selectedColumns"}},[_c("draggable",{attrs:{options:_vm.dragOptions,list:_vm.sortedFields,"data-parent":"default"}},_vm._l(_vm.sortedFields,(function(field){return _c("el-checkbox",{key:field.name,staticClass:"column-item",class:{checkboxSelected:!0===field.edit},attrs:{label:field.name,value:field.name}},[_c("el-row",[_c("el-col",{attrs:{span:1}},[_c("inline-svg",{staticClass:"vertical-middle cursor-drag icon-right column-drag-icon",staticStyle:{cursor:"-webkit-grabbing"},attrs:{src:"drag-drop",iconClass:"icon icon-sm-md"}})],1),_c("el-col",{attrs:{span:22}},[field.edit?_c("el-input",{ref:"columnRenameInp",refInFor:!0,staticClass:"fc-input-border-remove width90 column-name-change-input",attrs:{placeholder:"Change your column name",autofocus:!0},on:{blur:function($event){field.edit=!1,_vm.$emit("update")},keyup:function($event){if(!$event.type.indexOf("key")&&_vm._k($event.keyCode,"enter",13,$event.key,"Enter"))return null;field.edit=!1,_vm.$emit("update")}},model:{value:field.columnDisplayName,callback:function($$v){_vm.$set(field,"columnDisplayName",$$v)},expression:"field.columnDisplayName"}}):_c("div",{},[_vm._v(" "+_vm._s(field.columnDisplayName)+" "),field.field&&field.field.displayName!==field.columnDisplayName?_c("span",{staticClass:"fc-grey-text12 pL5"},[_vm._v(_vm._s(field.field.displayName))]):_vm._e()])],1),_c("el-col",{staticClass:"visibility-hide-actions text-right",attrs:{span:1}},[_c("i",{staticClass:"el-icon-edit pR10 fc-grey3-text14 pL25 column-edit-icon",on:{click:function($event){return $event.stopPropagation(),$event.preventDefault(),_vm.showRenameColumn(field)}}})])],1)],1)})),1),_c("draggable",{attrs:{options:_vm.dragOptions,list:_vm.selectedlookupColumns,"data-parent":_vm.selectedLookup}},_vm._l(_vm.selectedlookupColumns,(function(field){return _c("el-checkbox",{key:field.fieldId,staticClass:"column-item",attrs:{label:field.fieldId,"data-field-id":field.fieldId},on:{change:function($event){return _vm.onLookupSelected(field)}}},[_vm._v(" "+_vm._s(field.columnDisplayName)+" ")])})),1)],1)],1),_c("div",{staticClass:"modal-dialog-footer",attrs:{slot:"footer"},slot:"footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){_vm.showDialog=!1}}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.isSaving,disabled:_vm.isSaving},on:{click:_vm.save}},[_vm._v(_vm._s(_vm.isSaving?_vm.$t("common._common._saving"):_vm.$t("common._common._save")))])],1)])},staticRenderFns=[],objectSpread2=__webpack_require__(595082),toConsumableArray=__webpack_require__(488478),vuex_esm=(__webpack_require__(670560),__webpack_require__(450886),__webpack_require__(434284),__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(425728),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(634338),__webpack_require__(339772),__webpack_require__(947522),__webpack_require__(420629)),vuedraggable_umd=__webpack_require__(909980),vuedraggable_umd_default=__webpack_require__.n(vuedraggable_umd),validation=__webpack_require__(990260),jquery=__webpack_require__(619755),jquery_default=__webpack_require__.n(jquery),columnConfigUtil=__webpack_require__(486613),ColumnCustomizationvue_type_script_lang_js={props:["visible","moduleName","viewName","relatedViewDetail","relatedMetaInfo","refreshRelatedList","excludeMainField"],data:function(){return{selectedColumns:[],selectedFixedColumns:[],showDialog:this.visible,sortedFields:this.allFields,nonSelectableColumns:["localId","photoId"],lookupMetaColumns:{},selectedLookup:"",dragOptions:{handle:".icon-right",ghostClass:"drag-ghost",dragClass:"custom-drag",animation:150},columnNameShow:!1,isSaving:!1,editedColumn:null}},components:{draggable:vuedraggable_umd_default()},created:function(){var _this$nonSelectableCo,nonSelectableColumns=this.$getProperty(this.columnConfig,"nonSelectableColumns");(0,validation/* isEmpty */.xb)(nonSelectableColumns)||(_this$nonSelectableCo=this.nonSelectableColumns).push.apply(_this$nonSelectableCo,(0,toConsumableArray/* default */.Z)(nonSelectableColumns));this.sortedFields=this.allFields},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({stateMetaInfo:function(state){return state.view.metaInfo},stateViewDetail:function(state){return state.view.currentViewDetail}})),{},{metaInfo:function(){var stateMetaInfo=this.stateMetaInfo,relatedMetaInfo=this.relatedMetaInfo;return(0,validation/* isEmpty */.xb)(relatedMetaInfo)?stateMetaInfo:relatedMetaInfo},viewDetail:function(){var stateViewDetail=this.stateViewDetail,relatedViewDetail=this.relatedViewDetail;return(0,validation/* isEmpty */.xb)(relatedViewDetail)?stateViewDetail:relatedViewDetail},currentView:function(){return this.viewName?this.viewName:this.$route.params.viewname?this.$route.params.viewname:"all"},columnConfig:function(){var _ref=this.$attrs||{},columnConfig=_ref.columnConfig;return(0,validation/* isEmpty */.xb)(columnConfig)?(0,columnConfigUtil/* getColumnConfig */.U)(this.moduleName):columnConfig},fixedColumns:function(){
// Will be disabled. User wont be able to select
var columnConfig=this.columnConfig;if(!(0,validation/* isEmpty */.xb)(columnConfig)){var fixedColumns=columnConfig.fixedColumns;return fixedColumns}return[]},fixedSelectableColumns:function(){
// Cannot change the order
var columnConfig=this.columnConfig;if(!(0,validation/* isEmpty */.xb)(columnConfig)){var fixedSelectableColumns=columnConfig.fixedSelectableColumns;return fixedSelectableColumns}return[]},availableColumns:function(){var columnConfig=this.columnConfig;if(!(0,validation/* isEmpty */.xb)(columnConfig)){var availableColumns=columnConfig.availableColumns;return availableColumns}return[]},metaColumns:function(){var _this=this,columns=[];return this.metaInfo&&this.metaInfo.fields&&this.viewDetail&&(columns=this.metaInfo.fields.map((function(field){return field.columnDisplayName=_this.viewDetail.defaultModuleFields&&_this.viewDetail.defaultModuleFields[field.name]?_this.viewDetail.defaultModuleFields[field.name].columnDisplayName:field.displayName,field}))),columns},allFields:function(){var _this2=this,viewFields=this.viewFields.filter((function(field){return 17!==_this2.$getProperty(field,"field.dataType")})),metaColumns=this.metaColumns.filter((function(field){return!_this2.viewFields.find((function(val){return val.name===field.name}))&&!(_this2.nonSelectableColumns||[]).includes(field.name)&&(!(_this2.availableColumns||{}).length||-1!==_this2.availableColumns.indexOf(field.name)||!field.default)&&17!==field.dataType})),columns=[].concat((0,toConsumableArray/* default */.Z)(viewFields),(0,toConsumableArray/* default */.Z)(metaColumns)).filter((function(field){return!(_this2.allFixedColumns||[]).includes(field.name)}));return columns},viewFields:function(){var _this3=this,columns=[];return this.viewDetail&&this.viewDetail.fields&&(columns=this.viewDetail.fields.map((function(vf){vf.name=(vf.field||{}).name||vf.fieldName,vf.fieldId=(vf.field||{}).fieldId;var defaultColumnName=_this3.viewDetail.defaultModuleFields&&_this3.viewDetail.defaultModuleFields[vf.name]?_this3.viewDetail.defaultModuleFields[vf.name].columnDisplayName:null;return vf.columnDisplayName=vf.columnDisplayName||defaultColumnName||vf.field.displayName,vf}))),columns},fixedFields:function(){var _this4=this;return this.metaColumns.filter((function(field){return(_this4.allFixedColumns||[]).includes(field.name)})).map((function(field){return field.disabled=(_this4.fixedColumns||[]).includes(field.name),field}))},allFixedColumns:function(){return(0,validation/* isEmpty */.xb)(this.fixedSelectableColumns)?this.fixedColumns:this.fixedColumns.concat(this.fixedSelectableColumns)},lookupList:function(){var _this5=this,fields=[];return(this.columnConfig||{}).lookupToShow&&this.metaColumns&&(fields=this.metaColumns.filter((function(field){return field.lookupModule&&(!_this5.columnConfig.lookupToShow.length||(_this5.columnConfig.lookupToShow||[]).includes(field.name))}))),fields},selectedlookupColumns:function(){var _this6=this;return this.lookupMetaColumns[this.selectedLookup]?this.lookupMetaColumns[this.selectedLookup].filter((function(field){return-1===_this6.sortedFields.findIndex((function(vf){return vf.fieldId===field.fieldId}))})).map((function(field){return field.columnDisplayName=field.displayName,field.parentFieldId=_this6.selectedLookupObj.fieldId,field})):[]},selectedLookupObj:function(){var _this7=this;return this.lookupList.find((function(field){return field.name===_this7.selectedLookup}))},mainField:function(){return this.metaColumns.find((function(field){return field.mainField}))}}),watch:{visible:function(val,oldVal){val&&this.reInit(),this.showDialog=val},showDialog:function(val,oldVal){this.$emit("update:visible",val)},allFields:function(val){this.sortedFields=val}},methods:{showRenameColumn:function(field){var _this8=this;this.$set(field,"edit",!0),this.$nextTick((function(){_this8.$refs["columnRenameInp"][0].focus()}))},save:function(){var _this9=this;this.isSaving=!0;var excludeMainField=this.excludeMainField,fields=[];fields=(0,validation/* isEmpty */.xb)(excludeMainField)?[{fieldId:this.mainField.id}].concat((0,toConsumableArray/* default */.Z)(this.sortedFields.filter((function(sf){return(_this9.selectedColumns||[]).includes(sf.name)})).map((function(sf){return{fieldId:sf.fieldId,parentFieldId:sf.parentFieldId,columnDisplayName:sf.columnDisplayName,fieldName:sf.name||sf.fieldName}})))):(0,toConsumableArray/* default */.Z)(this.sortedFields.filter((function(sf){return(_this9.selectedColumns||[]).includes(sf.name)})).map((function(sf){return{fieldId:sf.fieldId,parentFieldId:sf.parentFieldId,columnDisplayName:sf.columnDisplayName,fieldName:sf.name||sf.fieldName}}))),fields=[].concat((0,toConsumableArray/* default */.Z)(fields),(0,toConsumableArray/* default */.Z)(this.selectedFixedColumns.map((function(id){return{fieldId:id}}))));var self=this;this.$store.dispatch("view/customizeColumns",{moduleName:this.moduleName,viewName:this.currentView,fields:fields}).then((function(){self.isSaving=!1,self.showDialog=!1,self.$emit("refreshRelatedList"),self.$message.success(self.$t("common._common.view_updated_successfully"))})).catch((function(error){_this9.$message.error(error.message||_this9.$t("common._common.error_occured"))}))},editColumn:function(){this.editedColumn=this.field},reInit:function(){var _this10=this;this.selectedLookup="",this.selectedColumns=[],this.selectedFixedColumns=[],this.viewFields.forEach((function(vf){(_this10.allFixedColumns||[]).includes(vf.name)&&-1===vf.parentFieldId?(_this10.fixedSelectableColumns||[]).includes(vf.name)&&_this10.selectedFixedColumns.push(vf.fieldId):_this10.selectedColumns.push(vf.name)}))},loadModuleMeta:function(){var _this11=this;this.selectedLookup&&!this.lookupMetaColumns[this.selectedLookup]&&this.$http.get("/module/meta?moduleName="+this.selectedLookupObj.lookupModule.name).then((function(response){_this11.$set(_this11.lookupMetaColumns,_this11.selectedLookup,response.data.meta.fields)}))},getDisplayName:function(field){var displayName=field.columnDisplayName;if(this.viewDetail&&this.viewDetail.fields){var vf=this.viewDetail.fields.find((function(vf){return vf.name===field.name}));vf&&(displayName=vf.columnDisplayName||displayName)}return displayName},onLookupSelected:function(field){this.animate(field.fieldId,(function(){this.selectedlookupColumns=this.selectedlookupColumns.filter((function(lf){return lf.fieldId!==field.fieldId})),field.columnDisplayName+=" ("+this.selectedLookupObj.displayName+")",this.sortedFields.push(field)}))},animate:function(fieldId,cbk){var $selectedElement=jquery_default()('[data-field-id="'+fieldId+'"]'),oldOffset=$selectedElement.offset();$selectedElement.appendTo(jquery_default()("[data-parent='default']"));var newOffset=$selectedElement.offset(),temp=$selectedElement.clone().appendTo("body");temp.css({position:"absolute",left:oldOffset.left,top:oldOffset.top,zIndex:3e3,width:$selectedElement[0].offsetWidth}),$selectedElement.css("visibility","hidden");var self=this;temp.animate({top:newOffset.top,left:newOffset.left},350,(function(){
// $selectedElement.css('visibility', 'visible')
$selectedElement.remove(),temp.remove(),cbk.call(self)}))}}},components_ColumnCustomizationvue_type_script_lang_js=ColumnCustomizationvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_ColumnCustomizationvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,ColumnCustomization=component.exports},
/***/150159:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return SummaryFieldsWidget}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/page/widget/common/field-details/SummaryFieldsWidget.vue?vue&type=template&id=33a6a147&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"sfw-container"},[_vm.isLoading?_c("spinner",{attrs:{show:_vm.isLoading,size:"80"}}):_vm.$validation.isEmpty(_vm.detailsLayout)?_c("div",{ref:"content-container",staticClass:"sfw-empty-state-container"},[_c("inline-svg",{staticClass:"self-center",attrs:{src:"svgs/custom-empty-state",iconClass:"icon text-center icon-xxxxlg"}}),_c("div",{staticClass:"mT10 label-txt-black f14 self-center"},[_vm._v(" "+_vm._s(_vm.$t("common._common.error_summary_widget_field"))+" ")])],1):_c("div",{ref:"content-container"},[_c("FieldDetails",{attrs:{detailsLayout:_vm.detailsLayout,config:_vm.config},on:{fileDownload:_vm.downloadAttachment,lookupRedirect:_vm.redirectToSummary}})],1),_vm.needsShowMore&&!_vm.$validation.isEmpty(_vm.detailsLayout)?_c("div",{staticClass:"view-more"},[_c("a",{staticClass:" fc-link-animation text-capitalize letter-spacing0_3 f13 margin-auto view-text",on:{click:_vm.toggleVisibility}},[_vm._v(_vm._s(_vm.showMoreLinkText))])]):_vm._e(),_vm.exportDownloadUrl?_c("iframe",{staticStyle:{display:"none"},attrs:{src:_vm.exportDownloadUrl}}):_vm._e(),_vm.showPreview?_c("PreviewFile",{attrs:{visibility:_vm.showPreview,previewFile:_vm.previewFile,files:[_vm.previewFile]},on:{"update:visibility":function($event){_vm.showPreview=$event}}}):_vm._e()],1)},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),objectSpread2=__webpack_require__(595082),app=(__webpack_require__(634338),__webpack_require__(434284),__webpack_require__(450886),__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(782080)),api=__webpack_require__(32284),router=__webpack_require__(329435),validation=__webpack_require__(990260),picklist=__webpack_require__(961358),FetchViewsMixin=__webpack_require__(646716),PreviewFile=__webpack_require__(720096),dlv_umd=__webpack_require__(226905),dlv_umd_default=__webpack_require__.n(dlv_umd),vuex_esm=__webpack_require__(420629),lookupModulesRouterMap={workorder:function(id,viewname){return{name:"wosummarynew",params:{id:id,viewname:viewname}}},ticket:function(id,viewname){return{name:"wosummarynew",params:{id:id,viewname:viewname}}},asset:function(id,viewname){return{path:"/app/at/assets/".concat(viewname,"/").concat(id,"/overview")}},alarm:function(id,viewname){return{path:"/app/fa/faults/".concat(viewname,"/newsummary/").concat(id)}},vendors:function(id,viewname){return{path:"/app/vendor/vendors/".concat(viewname,"/summary/").concat(id)}},purchaseorder:function(id,viewname){return{name:"poSummary",params:{id:id,viewname:viewname}}},custom:function(id,viewname,moduleName){return{name:"custommodules-summary",params:{moduleName:moduleName,viewname:viewname,id:id}}}},dataConstructHash={DEFAULT:function(details,mainField){var name=mainField.name,value=details[name]||null;return{name:name,value:value}},ENUM_HASH:function(details,mainField){var name=mainField.name,value=details[name]||null,_ref=mainField||{},enumMap=_ref.field.enumMap,options=(0,objectSpread2/* default */.Z)({},enumMap);return{value:value,options:options,name:name}},FILE:function(details,mainField){var name=mainField.name,value=details["".concat(name,"FileName")]||null,url=details["".concat(name,"DownloadUrl")]||null,contentType=details["".concat(name,"ContentType")]||null,previewUrl=details["".concat(name,"Url")]||null,isClickable=!(0,validation/* isEmpty */.xb)(value);return{value:value,url:url,contentType:contentType,previewUrl:previewUrl,isClickable:isClickable,name:name}},DIGIT_HASH:function(details,mainField){var _ref2=mainField||{},name=_ref2.name,unit=dlv_umd_default()(mainField,"field.unit",null),value=details[name]||null,returnValue={name:name,value:value};return unit&&(returnValue.options={unit:unit}),returnValue},BOOLEAN:function(details,mainField){var _ref3=mainField||{},fieldObj=_ref3.field,name=_ref3.name,trueVal=fieldObj.trueVal,falseVal=fieldObj.falseVal,options={trueVal:trueVal,falseVal:falseVal},value=details[name]||null;return{options:options,name:name,value:value}},CURRENCY_FIELD:function(details,mainField){var _ref4=mainField||{},name=_ref4.name;return{value:details[name]||{},name:name}},MULTI_CURRENCY_FIELD:function(details,mainField){var _ref5=mainField||{},name=_ref5.name,_ref6=details||{},currencyCode=_ref6.currencyCode,exchangeRate=_ref6.exchangeRate;return{value:details[name]||null,name:name,currencyCode:currencyCode,exchangeRate:exchangeRate}},LOOKUP:function(details,mainField){return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var field,fieldName,parentLookupField,_ref7,lookupModule,moduleName,lookupModuleName,name,getFieldValue,id,idArr,_yield$fetchSecondLev,isClickable,value;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return field=mainField.field,fieldName=mainField.name,parentLookupField=mainField.parentLookupField,_ref7=field||{},lookupModule=_ref7.lookupModule,moduleName=lookupModule.name,lookupModuleName=(null===parentLookupField||void 0===parentLookupField?void 0:parentLookupField.name)||"",name=lookupModuleName?"".concat(lookupModuleName,".").concat(fieldName):"".concat(fieldName),getFieldValue=function(fieldName){var fieldValue=details[fieldName];return(0,validation/* isEmpty */.xb)(fieldValue)?[]:[fieldValue]},id=dlv_umd_default()(details,"".concat(name,".id"),null),idArr=(0,validation/* isEmpty */.xb)(id)?[]:[id],_context.next=10,fetchSecondLevelValues(mainField,getFieldValue,idArr);case 10:return _yield$fetchSecondLev=_context.sent,isClickable=_yield$fetchSecondLev.isClickable,value=_yield$fetchSecondLev.value,value=value[0]||null,_context.abrupt("return",{id:id,isClickable:isClickable,moduleName:moduleName,name:name,value:value});case 15:case"end":return _context.stop()}}),_callee)})))()},MULTI_LOOKUP:function(details,mainField){return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var field,fieldName,parentLookupField,_ref8,lookupModule,_ref9,moduleName,lookupModuleName,name,ids,id,getFieldValue,_yield$fetchSecondLev2,isClickable,value;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return field=mainField.field,fieldName=mainField.name,parentLookupField=mainField.parentLookupField,_ref8=field||{},lookupModule=_ref8.lookupModule,_ref9=lookupModule||{},moduleName=_ref9.name,lookupModuleName=(null===parentLookupField||void 0===parentLookupField?void 0:parentLookupField.name)||"",name=lookupModuleName?"".concat(lookupModuleName,".").concat(fieldName):"".concat(fieldName),ids=dlv_umd_default()(details,"".concat(name),null)||[],id=ids.map((function(lookupObj){return lookupObj.id})),getFieldValue=function(fieldName){return details[fieldName]||[]},_context2.next=10,fetchSecondLevelValues(mainField,getFieldValue,id);case 10:return _yield$fetchSecondLev2=_context2.sent,isClickable=_yield$fetchSecondLev2.isClickable,value=_yield$fetchSecondLev2.value,value=value.map((function(ml){return ml.moduleName=moduleName,ml})),_context2.abrupt("return",{value:value,isClickable:isClickable,name:name});case 15:case"end":return _context2.stop()}}),_callee2)})))()}},fetchSecondLevelValues=function(){var _ref10=(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(mainField,getFieldValue,id){var field,secondLevelLookup,name,_ref11,lookupModule,_ref12,moduleName,typeEnum,custom,value,isClickable;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:if(field=mainField.field,secondLevelLookup=mainField.secondLevelLookup,name=mainField.name,_ref11=field||{},lookupModule=_ref11.lookupModule,_ref12=lookupModule||{},moduleName=_ref12.name,typeEnum=_ref12.typeEnum,custom=_ref12.custom,isClickable="BASE_ENTITY"===typeEnum&&((0,router/* isWebTabsEnabled */.tj)()||custom),!secondLevelLookup){_context3.next=13;break}return _context3.next=7,fetchLookupName(moduleName,id);case 7:if(_context3.t0=_context3.sent,_context3.t0){_context3.next=10;break}_context3.t0=[];case 10:value=_context3.t0,_context3.next=14;break;case 13:value=getFieldValue(name)||[];case 14:return isClickable=!(0,validation/* isEmpty */.xb)(value)&&isClickable,_context3.abrupt("return",{isClickable:isClickable,value:value});case 16:case"end":return _context3.stop()}}),_callee3)})));return function(_x,_x2,_x3){return _ref10.apply(this,arguments)}}(),fetchLookupName=function(){var _ref13=(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(moduleName,id){var value,perPage,_yield$getFieldOption,error,options,filterOptions;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:if(value=[],(0,validation/* isEmpty */.xb)(id)){_context4.next=9;break}return perPage=id.length,_context4.next=5,(0,picklist/* getFieldOptions */._K)({perPage:perPage,field:{lookupModuleName:moduleName},defaultIds:id});case 5:_yield$getFieldOption=_context4.sent,error=_yield$getFieldOption.error,options=_yield$getFieldOption.options,(0,validation/* isEmpty */.xb)(error)&&(filterOptions=(options||[]).filter((function(item){return id.includes(item.value)})),value=filterOptions.map((function(item){return{name:item.label}})));case 9:return _context4.abrupt("return",value);case 10:case"end":return _context4.stop()}}),_callee4)})));return function(_x4,_x5){return _ref13.apply(this,arguments)}}(),SummaryFieldsWidgetvue_type_script_lang_js={props:["layoutParams","details","moduleName","primaryFields","widget","isV3Api","disableAutoResize","detailsLayoutProp","siteList"],components:{FieldDetails:app/* NewFieldDetails */.f3,PreviewFile:PreviewFile/* default */.Z},mixins:[FetchViewsMixin/* default */.Z],data:function(){return{appId:null,detailsLayout:null,sites:{},needsShowMore:!1,isAllVisible:!1,defaultWidgetHeight:(this.layoutParams||{}).h,config:null,isLoading:!1,exportDownloadUrl:null,showPreview:!1,previewFile:null}},created:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee5(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context5){while(1)switch(_context5.prev=_context5.next){case 0:_this.init();case 1:case"end":return _context5.stop()}}),_callee5)})))()},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({account:function(state){return state.account},currencyList:function(state){return state.activeCurrencies}})),{},{showMoreLinkText:function(){return this.isAllVisible?this.$t("common._common.view_less"):this.$t("common._common.view_more")},widgetName:function(){var _this$widget;return this.$attrs.widgetName||(null===(_this$widget=this.widget)||void 0===_this$widget?void 0:_this$widget.name)},multiCurrency:function(){var _ref14=this.account.data.currencyInfo||{},displaySymbol=_ref14.displaySymbol,currencyCode=_ref14.currencyCode,multiCurrencyEnabled=_ref14.multiCurrencyEnabled;return{displaySymbol:displaySymbol,currencyCode:currencyCode,multiCurrencyEnabled:multiCurrencyEnabled}}}),methods:{init:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee6(){var multiCurrency;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context6){while(1)switch(_context6.prev=_context6.next){case 0:return _this2.isLoading=!0,multiCurrency=_this2.multiCurrency,_context6.next=4,_this2.$store.dispatch("getActiveCurrencyList");case 4:return _this2.config={dateformat:_this2.$dateformat,timezone:_this2.$timezone,timeformat:_this2.$timeformat,org:_this2.$account.org,multiCurrency:multiCurrency,currencies:_this2.currencyList},_this2.appId=((0,router/* getApp */.wx)()||{}).id,_context6.next=8,_this2.fetchSites();case 8:return _context6.next=10,_this2.fetchDetails();case 10:_this2.isLoading=!1,_this2.$nextTick((function(){(0,validation/* isEmpty */.xb)(_this2.detailsLayout)?_this2.resizeWidget({height:250}):_this2.disableAutoResize?_this2.$emit("autoResize",_this2.$refs["content-container"]):_this2.autoResize()}));case 12:case"end":return _context6.stop()}}),_callee6)})))()},openAttachment:function(fileObj){var url=fileObj.url,contentType=fileObj.contentType,previewUrl=fileObj.previewUrl,value=fileObj.value;this.previewFile={fileName:value,contentType:contentType,downloadUrl:url,previewUrl:previewUrl},this.showPreview=!0},fetchDetails:function(){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee7(){var detailsLayout,moduleName,appId,widgetName,_yield$API$get,data,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context7){while(1)switch(_context7.prev=_context7.next){case 0:if(detailsLayout=null,!(0,validation/* isEmpty */.xb)(_this3.detailsLayoutProp)){_context7.next=11;break}return moduleName=_this3.moduleName,appId=_this3.appId,widgetName=_this3.widgetName,_context7.next=5,api/* API */.bl.get("v2/customPage/summaryFieldWidget",{moduleName:moduleName,appId:appId,widgetName:widgetName});case 5:_yield$API$get=_context7.sent,data=_yield$API$get.data,error=_yield$API$get.error,error||(detailsLayout=data),_context7.next=12;break;case 11:detailsLayout=_this3.detailsLayoutProp;case 12:return _context7.next=14,_this3.serializeDetailsLayout(detailsLayout);case 14:case"end":return _context7.stop()}}),_callee7)})))()},serializeDetailsLayout:function(data){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee9(){var _ref15,summaryFieldWidget,_ref16,groups,filteredGroup,detailsLayout;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context9){while(1)switch(_context9.prev=_context9.next){case 0:return _ref15=data||{},summaryFieldWidget=_ref15.summaryFieldWidget,_ref16=summaryFieldWidget||{},groups=_ref16.groups,filteredGroup=(groups||[]).filter((function(group){return!(0,validation/* isEmpty */.xb)(group.fields)})),detailsLayout=(filteredGroup||[]).map(function(){var _ref17=(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee8(group){var fields,colorCode,displayName,columns,serializedFields;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context8){while(1)switch(_context8.prev=_context8.next){case 0:return fields=group.fields,colorCode=group.colorCode,displayName=group.displayName,columns=group.columns,_context8.next=3,_this4.constructFieldValues(fields);case 3:return serializedFields=_context8.sent,_context8.abrupt("return",{name:displayName,fields:serializedFields,sectionConfig:{columns:columns,colorCode:colorCode}});case 5:case"end":return _context8.stop()}}),_callee8)})));return function(_x6){return _ref17.apply(this,arguments)}}()),_context9.next=6,Promise.all(detailsLayout);case 6:_this4.detailsLayout=_context9.sent;case 7:case"end":return _context9.stop()}}),_callee9)})))()},constructFieldValues:function(fields){var _this5=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee11(){var details,groupObj;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context11){while(1)switch(_context11.prev=_context11.next){case 0:return details=_this5.details,groupObj=fields.map(function(){var _ref18=(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee10(mainField){var _ref19,field,name,secondLevelLookup,parentLookupField,displayName,colSpan,colIndex,rowIndex,diplayTypeMain,_ref20,dataTypeEnum,displayType,recordHolder,_ref21,lookupModuleName,extraValues,siteId,siteLabel,value;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context10){while(1)switch(_context10.prev=_context10.next){case 0:if(_ref19=mainField||{},field=_ref19.field,name=_ref19.name,secondLevelLookup=_ref19.secondLevelLookup,parentLookupField=_ref19.parentLookupField,displayName=_ref19.displayName,colSpan=_ref19.colSpan,colIndex=_ref19.colIndex,rowIndex=_ref19.rowIndex,diplayTypeMain=_ref19.displayType,_ref20=field||{},dataTypeEnum=_ref20.dataTypeEnum,displayType=_ref20.displayType,recordHolder=details||{},(0,validation/* isEmpty */.xb)(parentLookupField)||secondLevelLookup||(_ref21=parentLookupField||{},lookupModuleName=_ref21.name,recordHolder=details[lookupModuleName]||{}),"siteId"!==name){_context10.next=12;break}siteId=details[name]||"",siteLabel=_this5.sites[siteId]||"",value=siteLabel||null,extraValues={name:name,value:value},dataTypeEnum="OTHERS",_context10.next=15;break;case 12:return _context10.next=14,_this5.getHash(dataTypeEnum)(recordHolder,mainField);case 14:extraValues=_context10.sent;case 15:return _context10.abrupt("return",(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({displayName:displayName},extraValues),{},{dataTypeEnum:dataTypeEnum,displayType:displayType||diplayTypeMain||null,fieldConfig:{rowIndex:rowIndex,colIndex:colIndex,colSpan:colSpan}}));case 16:case"end":return _context10.stop()}}),_callee10)})));return function(_x7){return _ref18.apply(this,arguments)}}()),_context11.abrupt("return",Promise.all(groupObj));case 3:case"end":return _context11.stop()}}),_callee11)})))()},getHash:function(dataTypeEnum){var currentDataType=dataTypeEnum;return["ENUM","SYSTEM_ENUM","MULTI_ENUM"].includes(dataTypeEnum)?currentDataType="ENUM_HASH":["NUMBER","DECIMAL"].includes(dataTypeEnum)&&(currentDataType="DIGIT_HASH"),dataConstructHash[currentDataType]||dataConstructHash["DEFAULT"]},downloadAttachment:function(field){var _this6=this,name=field.name,url=field.url,contentType=field.contentType,contentTypeArr=contentType.split("/");contentTypeArr.includes("image")?this.openAttachment(field):(0,validation/* isEmpty */.xb)(name)||(url=field.url,(0,validation/* isEmpty */.xb)(url)||(this.exportDownloadUrl&&(this.exportDownloadUrl=null),this.$nextTick((function(){_this6.exportDownloadUrl=url}))))},toggleVisibility:function(){var _this7=this;this.isAllVisible=!this.isAllVisible,this.isAllVisible?this.$nextTick((function(){var height=_this7.$refs["content-container"].scrollHeight+40,width=_this7.$refs["content-container"].scrollWidth;_this7.resizeWidget({height:height,width:width})})):this.$nextTick((function(){return _this7.resizeWidget({h:_this7.defaultWidgetHeight})}))},autoResize:function(){var _this8=this;this.$nextTick((function(){var container=_this8.$refs["content-container"];if(container){var height=_this8.$refs["content-container"].scrollHeight,width=_this8.$refs["content-container"].scrollWidth,dimensions=_this8.calculateDimensions({height:height,width:width});if(!(0,validation/* isEmpty */.xb)(dimensions)){var _ref22=dimensions||{},h=_ref22.h,params={};if(h<=_this8.defaultWidgetHeight)_this8.needsShowMore=!1,params={height:height,width:width};else{var _this8$defaultWidgetH=_this8.defaultWidgetHeight,defaultWidgetHeight=void 0===_this8$defaultWidgetH?8:_this8$defaultWidgetH;_this8.needsShowMore=h>defaultWidgetHeight,_this8.defaultWidgetHeight=defaultWidgetHeight,params=_this8.needsShowMore?{h:defaultWidgetHeight}:{h:h}}_this8.resizeWidget(params)}}}))},redirectToSummary:function(field){var _this9=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee12(){var _routerPath,freezeWidget,_ref23,moduleName,id,lookupModule,_ref24,custom,viewname,routerPath,_ref25,name,getRouterObj;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context12){while(1)switch(_context12.prev=_context12.next){case 0:return freezeWidget=_this9.$loading({target:".sfw-container"}),_ref23=field||{},moduleName=_ref23.moduleName,id=_ref23.id,lookupModule=_ref23.lookupModule,_ref24=lookupModule||{},custom=_ref24.custom,_context12.next=5,_this9.fetchView(moduleName);case 5:viewname=_context12.sent,routerPath=null,(0,router/* isWebTabsEnabled */.tj)()?(_ref25=(0,router/* findRouteForModule */.Jp)(moduleName,router/* pageTypes */.As.OVERVIEW)||{},name=_ref25.name,name&&(routerPath=_this9.$router.resolve({name:name,params:{viewname:viewname,id:id}}))):custom?routerPath=_this9.$router.resolve(lookupModulesRouterMap["custom"](id,viewname,moduleName)):(getRouterObj=lookupModulesRouterMap[moduleName],getRouterObj&&(routerPath=_this9.$router.resolve(getRouterObj(id,viewname)))),routerPath&&window.open(null===(_routerPath=routerPath)||void 0===_routerPath?void 0:_routerPath.href,"_blank"),freezeWidget.close();case 10:case"end":return _context12.stop()}}),_callee12)})))()},fetchSites:function(){var _this10=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee13(){var details,siteId,_yield$getFieldOption2,error,options;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context13){while(1)switch(_context13.prev=_context13.next){case 0:if(details=_this10.details,siteId=details.siteId||null,!(0,validation/* isEmpty */.xb)(siteId)){_context13.next=4;break}return _context13.abrupt("return");case 4:if(!(0,validation/* isEmpty */.xb)(_this10.siteList)||(0,validation/* isEmpty */.xb)(siteId)){_context13.next=13;break}return _context13.next=7,(0,picklist/* getFieldOptions */._K)({field:{lookupModuleName:"site",skipDeserialize:!0},defaultIds:[siteId],perPage:1});case 7:_yield$getFieldOption2=_context13.sent,error=_yield$getFieldOption2.error,options=_yield$getFieldOption2.options,error||(0,validation/* isEmpty */.xb)(options[siteId])||(_this10.sites=options),_context13.next=14;break;case 13:_this10.sites=_this10.siteList;case 14:case"end":return _context13.stop()}}),_callee13)})))()},resizeWidget:function(params){var $attrs=this.$attrs;return $attrs.resizeWidget(params)},calculateDimensions:function(params){var $attrs=this.$attrs;return null===$attrs||void 0===$attrs?void 0:$attrs.calculateDimensions(params)}}},field_details_SummaryFieldsWidgetvue_type_script_lang_js=SummaryFieldsWidgetvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(field_details_SummaryFieldsWidgetvue_type_script_lang_js,render,staticRenderFns,!1,null,"33a6a147",null)
/* harmony default export */,SummaryFieldsWidget=component.exports},
/***/67985:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return PopupLineItemForm}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/page/widget/common/line-items/PopupLineItemForm.vue?vue&type=template&id=247ab57c
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"line-item-popup-form",attrs:{visible:!0,fullscreen:!0,"append-to-body":!0,"close-on-click-modal":!1,"show-close":!1,"before-close":_vm.cancelForm,"custom-class":"line-item-popup-form-dialog"},scopedSlots:_vm._u([{key:"title",fn:function(){return[_vm.hasPreviousDialog?_c("div",{staticClass:"line-item-popup-form-header",on:{click:_vm.openPreviousDialog}},[_c("fc-icon",{staticClass:"mR8",attrs:{group:"dsm",name:"chevron-left",size:"16",color:"#3ab2c2"}}),_vm._v(" "+_vm._s(_vm.$t("common.header.previous"))+" ")],1):_vm._e(),_c("div",{staticClass:"line-item-popup-form-header-title"},[_vm._v(_vm._s(_vm.customTitle))])]},proxy:!0},{key:"footer",fn:function(){return[_c("el-button",{on:{click:_vm.cancelForm}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_c("el-button",{attrs:{type:"primary",loading:_vm.isSaving},on:{click:_vm.onClickSaveRecord}},[_vm._v(_vm._s(_vm.$t("common._common._save")))])]},proxy:!0}])},[_vm.forms.length>1?_c("div",{staticClass:"form-list-dropdown d-flex mT12"},[_c("el-select",{staticClass:"fc-input-full-border-select2 mL-auto",attrs:{"value-key":"name"},model:{value:_vm.selectedForm,callback:function($$v){_vm.selectedForm=$$v},expression:"selectedForm"}},_vm._l(_vm.forms,(function(form,index){return _c("el-option",{key:index,attrs:{value:form,label:form.displayName}})})),1)],1):_vm._e(),_vm.isLoading?_c("div",{staticClass:"loading-container d-flex"},[_c("Spinner",{attrs:{show:_vm.isLoading}})],1):_c("FWebform",{ref:"line-item-f-web-form",attrs:{form:_vm.formObj,module:_vm.moduleName,isSaving:_vm.isSaving,isEdit:_vm.isEdit,isV3Api:!0,isWidgetsSupported:!1,moduleData:_vm.moduleData,moduleDataId:_vm.moduleDataId,subFormRecords:_vm.subFormRecords,formLabelPosition:"1",modifyFieldPropsHook:_vm.config.modifyFieldPropsHook},on:{"update:form":function($event){_vm.formObj=$event},save:_vm.saveRecord,onBlur:_vm.config.onBlurHook,onWidgetChange:_vm.config.onWidgetChange}})],1)},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),objectSpread2=__webpack_require__(595082),asyncToGenerator=__webpack_require__(548534),CustomModulesCreation=__webpack_require__(383943),validation=__webpack_require__(990260),PopupLineItemFormvue_type_script_lang_js={extends:CustomModulesCreation["default"],props:["dataId","config","additionalParams","hideNotification","hasPreviousDialog","recordConversionDetails"],computed:{moduleDataId:function(){return this.dataId},isEdit:function(){return!(0,validation/* isEmpty */.xb)(this.dataId)},moduleName:function(){return this.$attrs.moduleName},moduleDisplayName:function(){return this.$attrs.moduleDisplayName},customTitle:function(){var customTitle,formTitle=this.config.formTitle,_ref=formTitle||{},defaultForm=_ref.defaultForm,addForm=_ref.addForm,editForm=_ref.editForm;return customTitle=this.isEdit&&editForm?editForm:!this.isEdit&&addForm?addForm:defaultForm||this.title,customTitle},loadDataManually:function(){var _ref2=this.recordConversionDetails||{},selectedLookupModuleId=_ref2.selectedLookupModuleId,currentBtnDetails=_ref2.currentBtnDetails,_ref3=currentBtnDetails||{},getRecordDetails=_ref3.getRecordDetails;return!(0,validation/* isEmpty */.xb)(selectedLookupModuleId)&&!(0,validation/* isEmpty */.xb)(getRecordDetails)&&(0,validation/* isFunction */.mf)(getRecordDetails)}},methods:{openPreviousDialog:function(){this.$emit("openPrevious")},cancelForm:function(){this.$emit("onClose")},loadModuleData:function(_ref4){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var moduleDataId,moduleName,customProps,loadDataManually,recordConversionDetails,_ref5,id,currentBtnDetails,_ref6,getRecordDetails,lookupModuleName,payload;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(moduleDataId=_ref4.moduleDataId,moduleName=_ref4.moduleName,_context.prev=1,customProps=_this.customProps,loadDataManually=_this.loadDataManually,recordConversionDetails=_this.recordConversionDetails,loadDataManually){_context.next=9;break}return _context.next=6,_this.modelDataClass.fetch((0,objectSpread2/* default */.Z)({moduleName:moduleName,id:moduleDataId},customProps));case 6:_this.moduleData=_context.sent,_context.next=15;break;case 9:return _ref5=recordConversionDetails||{},id=_ref5.selectedLookupModuleId,currentBtnDetails=_ref5.currentBtnDetails,_ref6=currentBtnDetails||{},getRecordDetails=_ref6.getRecordDetails,lookupModuleName=_ref6.lookupModuleName,payload=(0,objectSpread2/* default */.Z)({id:id,lookupModuleName:lookupModuleName,moduleName:moduleName},customProps),_context.next=14,getRecordDetails(payload);case 14:_this.moduleData=_context.sent;case 15:_context.next=20;break;case 17:_context.prev=17,_context.t0=_context["catch"](1),_this.showErrorToastMessage(_context.t0,_this.$t("custommodules.summary.record_summary_error"));case 20:case"end":return _context.stop()}}),_callee,null,[[1,17]])})))()},afterSerializeHook:function(_ref7){var data=_ref7.data,additionalParams=this.additionalParams,moduleData=this.moduleData,additionalPayLoad=(0,validation/* isFunction */.mf)(additionalParams)?additionalParams(data,moduleData):additionalParams;return(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},data),additionalPayLoad||{})},afterSaveHook:function(response){var _ref8=response||{},error=_ref8.error;this.$emit("onSave",response),error||this.cancelForm()},onClickSaveRecord:function(){var _this$$refs$lineItem;null===(_this$$refs$lineItem=this.$refs["line-item-f-web-form"])||void 0===_this$$refs$lineItem||_this$$refs$lineItem.saveRecord()},notificationHandler:function(response){if((0,validation/* isEmpty */.xb)(this.hideNotification)){var moduleDataId=this.moduleDataId,moduleDisplayName=this.moduleDisplayName,error=response.error;if(error){var _error$message=error.message,message=void 0===_error$message?"Error occured":_error$message;this.$message.error(message)}else{var successMsg="".concat(moduleDisplayName,moduleDataId?" updated successfully":" created successfully");this.$message.success(successMsg)}}}}},line_items_PopupLineItemFormvue_type_script_lang_js=PopupLineItemFormvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(line_items_PopupLineItemFormvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,PopupLineItemForm=component.exports},
/***/890608:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return ListPagination}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/newapp/components/ListPagination.vue?vue&type=template&id=31fbeab9&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.canShowPagination?_c("div",{staticClass:"flex-center-row-space fc-black-small-txt-12"},[_c("span",{staticClass:"el-icon-arrow-left pagination-arrow f16 pointer p5 fw-bold",class:{disable:_vm.from<=1},on:{click:function($event){_vm.from>1&&_vm.prev()}}}),_c("el-popover",{attrs:{placement:"bottom",trigger:"click",disabled:_vm.disablePopup}},[0!==_vm.currentPageCount?_c("div",{staticClass:"p8",class:[_vm.canShowPopup&&"button-hover pointer"],attrs:{slot:"reference"},slot:"reference"},[_vm.canShowPaginationParts?_c("div",{staticClass:"flex-middle justify-between "},[_vm.from!==_vm.to?_c("span",[_vm._v(_vm._s(_vm.from)+" - ")]):_vm._e(),_c("span",{staticClass:"mL5"},[_vm._v(_vm._s(_vm.to))]),_vm.skipTotalCount?_vm._e():_c("span",{staticClass:"d-flex lp-page"},[_c("span",[_vm._v(_vm._s("of"))]),_vm.shimmerLoading?_c("span",{staticClass:"count-shimmer-line loading-shimmer mT1 "}):_c("span",[_vm._v(_vm._s(_vm.total))])])]):_c("div",{staticClass:"page-shimmer-line loading-shimmer mT2"})]):_vm._e(),_vm.$validation.isEmpty(_vm.total)?_vm._e():_c("el-pagination",{staticClass:"pagination-without-count-popover",attrs:{layout:"prev, pager, next",total:_vm.total,"pager-count":5,"page-size":_vm.perPage,"current-page":_vm.page},on:{"current-change":_vm.handleCurrentChange,"update:pageSize":function($event){_vm.perPage=$event},"update:page-size":function($event){_vm.perPage=$event},"update:currentPage":function($event){_vm.page=$event},"update:current-page":function($event){_vm.page=$event}}})],1),_c("span",[_c("span",{staticClass:"el-icon-arrow-right pagination-arrow  f16 pointer p5 fw-bold",class:{disable:!_vm.canGoNextPage},on:{click:function($event){_vm.canGoNextPage&&_vm.next()}}})])],1):_vm._e()},staticRenderFns=[],objectSpread2=__webpack_require__(595082),router=(__webpack_require__(879288),__webpack_require__(670560),__webpack_require__(329435)),validation=__webpack_require__(990260),ListPaginationvue_type_script_lang_js={props:{total:[Number,String],currentPageCount:Number,perPage:{type:Number,default:50},currentPage:Number,hidePopover:{type:Boolean,default:!1},skipTotalCount:{type:Boolean,default:!1}},data:function(){return{from:0,to:0,page:1,shimmerLoading:!0,navigatingToNextPage:!0}},created:function(){(0,router/* isWebTabsEnabled */.tj)()&&document.addEventListener("keydown",this.keyDownHandler)},beforeDestroy:function(){(0,router/* isWebTabsEnabled */.tj)()&&document.removeEventListener("keydown",this.keyDownHandler)},computed:{pageQuery:function(){var _ref=this.$route||{},query=_ref.query,_ref2=query||{},page=_ref2.page;return parseInt(page)||1},hasMorePage:function(){return this.total/this.perPage>1},disablePopup:function(){return this.hidePopover||!this.hasMorePage},canShowPages:function(){return!(0,validation/* isEmpty */.xb)(this.total)},canGoNextPage:function(){return(0,validation/* isEmpty */.xb)(this.total)?this.perPage==this.currentPageCount:this.to!==this.total},canShowPaginationParts:function(){return!(!this.currentPageCount&&!this.total)},canShowPagination:function(){return 1!==this.page||!this.navigatingToNextPage||(this.currentPageCount>0||!(0,validation/* isEmpty */.xb)(this.total))},canShowPopup:function(){return!this.disablePopup&&!(0,validation/* isEmpty */.xb)(this.total)}},watch:{total:{handler:function(newVal){this.shimmerLoading=!0,(0,validation/* isEmpty */.xb)(newVal)||(this.shimmerLoading=!1),this.init()},immediate:!0},currentPageCount:function(newVal){!(0,validation/* isEmpty */.xb)(newVal)&&(0,validation/* isEmpty */.xb)(this.total)&&this.init()},pageQuery:function(val){val!==this.page&&this.init()}},methods:{init:function(){this.page=this.currentPage?this.currentPage:this.pageQuery,this.from=(this.page-1)*this.perPage+1;var to=this.from+this.perPage-1;this.to=(0,validation/* isEmpty */.xb)(this.total)?this.from+this.currentPageCount-1:this.total>to?to:this.total},handleCurrentChange:function(val){this.page=val,this.from=(this.page-1)*this.perPage+1,this.to=this.total>=this.from+this.perPage?this.from+this.perPage-1:this.total,this.setPage()},next:function(){if(this.from=this.to+1,!(0,validation/* isEmpty */.xb)(this.total)){var to=this.from+this.perPage-1;to>this.total&&(to=this.total),this.to=to}this.page++,this.navigatingToNextPage=!0,this.setPage()},prev:function(){this.to=this.from-1,this.from-=this.perPage,this.from<=1?(this.from=1,this.page=1):this.page--,this.navigatingToNextPage=!1,this.setPage()},setPage:function(){if(this.currentPage)this.$emit("update:currentPage",this.page);else{var query=(0,objectSpread2/* default */.Z)({},this.$route.query);(0,validation/* isEmpty */.xb)(query)?query={page:this.page}:query.page=this.page,this.$router.push({query:query})}},keyDownHandler:function(e){e.shiftKey&&("ArrowRight"!==e.key||this.to===this.total&&this.to===this.currentPageCount?"ArrowLeft"===e.key&&this.from>1&&this.prev():this.next())}}},components_ListPaginationvue_type_script_lang_js=ListPaginationvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_ListPaginationvue_type_script_lang_js,render,staticRenderFns,!1,null,"31fbeab9",null)
/* harmony default export */,ListPagination=component.exports},
/***/383943:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return CustomModulesCreation}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/custom-module/CustomModulesCreation.vue?vue&type=template&id=7325388c
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{class:[_vm.isCreateEditWidgetConfigured?"form-widget-container":"form-data-creation",_vm.isEmpty(_vm.widgetsArr)?"":"form-creation-widgets",_vm.customClassForContainer]},[_vm.showEmptyState?_c("div",{staticClass:"form-empty-container"},[_c("inline-svg",{staticClass:"d-flex module-view-empty-state",attrs:{src:"svgs/no-configuration",iconClass:"icon"}}),_c("div",{staticClass:"mB10 mT10 no-template-text f14 self-center"},[_vm._v(" "+_vm._s(_vm.$t("forms.live_form.no_forms"))+" ")]),_c("div",{staticClass:"contact-admin-text f14 self-center"},[_vm._v(" "+_vm._s(_vm.$t("forms.live_form.contact_admin"))+" ")])],1):_c("div",{staticClass:"height-100",class:[_vm.$validation.isEmpty(_vm.widgetsArr)?"":"form-left-container"]},[_vm.isCreateEditWidgetConfigured?_vm._e():_c("div",{staticClass:"header mT20 mB10 d-flex"},[_c("div",{staticClass:"title mT10"},[_vm._v(_vm._s(_vm.title))]),_vm.forms.length>1?_c("el-select",{staticClass:"fc-input-full-border-select2 mL-auto width25",attrs:{"value-key":"name"},model:{value:_vm.selectedForm,callback:function($$v){_vm.selectedForm=$$v},expression:"selectedForm"}},_vm._l(_vm.forms,(function(form,index){return _c("el-option",{key:index,attrs:{value:form,label:form.displayName}})})),1):_vm._e()],1),_vm.isLoading?_c("div",{staticClass:"loading-container d-flex"},[_c("Spinner",{attrs:{show:_vm.isLoading}})],1):_vm.isCreateEditWidgetConfigured?_c("ConnectedAppViewWidget",{attrs:{widgetId:_vm.widgetId,recordId:_vm.moduleDataId,context:_vm.moduleData}}):_c("f-webform",{ref:"f-webform",attrs:{form:_vm.formObj,module:_vm.moduleName,moduleDisplayName:_vm.moduleDisplayName,isSaving:_vm.isSaving,canShowPrimaryBtn:!0,canShowSecondaryBtn:!0,isEdit:_vm.isEdit,isV3Api:_vm.isV3Api,moduleData:_vm.moduleData,moduleDataId:_vm.moduleDataId,isWidgetsSupported:_vm.isWidgetsSupported,subFormRecords:_vm.subFormRecords,modifyFieldPropsHook:_vm.modifyFieldPropsHook},on:{"update:form":function($event){_vm.formObj=$event},onBlur:_vm.onBlurHook,onWidgetChange:_vm.onWidgetChange,save:_vm.saveRecord,cancel:_vm.redirectToList}})],1),_c("portal-target",{staticClass:"widgets-container",attrs:{name:"side-bar-widgets"}})],1)},staticRenderFns=[],slicedToArray=__webpack_require__(554621),regeneratorRuntime=__webpack_require__(150124),objectSpread2=__webpack_require__(595082),asyncToGenerator=__webpack_require__(548534),validation=(__webpack_require__(434284),__webpack_require__(670560),__webpack_require__(990260)),FormCreation=__webpack_require__(373729),ConnectedAppViewWidget=__webpack_require__(767004),FetchViewsMixin=__webpack_require__(646716),router=__webpack_require__(329435),CustomModuleData=__webpack_require__(689565),CustomModulesCreationvue_type_script_lang_js={extends:FormCreation/* default */.Z,props:["dataObj","selectedFormDetails"],components:{ConnectedAppViewWidget:ConnectedAppViewWidget["default"]},mixins:[FetchViewsMixin/* default */.Z],data:function(){return{widgetId:null,isEmpty:validation/* isEmpty */.xb}},computed:{showEmptyState:function(){var _ref=this||{},forms=_ref.forms;return!this.isLoading&&(0,validation/* isEmpty */.xb)(forms)&&!this.isCreateEditWidgetConfigured},moduleName:function(){var moduleName=this.$route.params.moduleName;// TODO: make this a prop and use directly
return moduleName||(moduleName=this.$attrs.moduleName),(0,validation/* isEmpty */.xb)(moduleName)?null:moduleName},moduleDisplayName:function(){return this.formObj&&this.formObj.module?this.formObj.module.displayName:""},isWidgetsSupported:function(){return!0},isCreateEditWidgetConfigured:function(){var widgetId=this.widgetId;return!(0,validation/* isEmpty */.xb)(widgetId)},isV3Api:function(){return!0},modelDataClass:function(){return CustomModuleData/* CustomModuleData */.u},customProps:function(){return{}},loadDataManually:function(){return!1}},methods:{init:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var moduleDataId,moduleName,loadDataManually,widgetId;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(moduleDataId=_this.moduleDataId,moduleName=_this.moduleName,loadDataManually=_this.loadDataManually,_this.isLoading=!0,(0,validation/* isEmpty */.xb)(moduleDataId)&&!loadDataManually){_context.next=7;break}return _context.next=5,_this.loadModuleData({moduleName:moduleName,moduleDataId:moduleDataId});case 5:_context.next=8;break;case 7:_this.moduleData=new _this.modelDataClass((0,objectSpread2/* default */.Z)({moduleName:moduleName},_this.dataObj||{}));case 8:if((0,validation/* isEmpty */.xb)(_this.selectedFormDetails)){_context.next=13;break}return _context.next=11,_this.loadFormData(null,_this.selectedFormDetails||null);case 11:return _this.selectedForm=_context.sent,_context.abrupt("return");case 13:return _context.next=15,_this.getCreateEditRecordWidgetId();case 15:if(widgetId=_context.sent,(0,validation/* isEmpty */.xb)(widgetId)){_context.next=21;break}_this.widgetId=widgetId,_this.isLoading=!1,_context.next=24;break;case 21:return _context.next=23,_this.loadFormsList(moduleName);case 23:_this.setInitialForm();case 24:_this.isLoading=!1;case 25:case"end":return _context.stop()}}),_callee)})))()},getCreateEditRecordWidgetId:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var isEdit,operatorValue,filters,_yield$_this2$modelDa,connectedAppWidgets,_ref2,_ref3,selectedWidget,_ref4,widgetId;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return isEdit=_this2.isEdit,operatorValue=isEdit?7:6,filters={entityType:{operatorId:9,value:["".concat(operatorValue)]}},_this2.isLoading=!0,_context2.prev=4,_context2.next=7,_this2.modelDataClass.loadWidgets(filters);case 7:return _yield$_this2$modelDa=_context2.sent,connectedAppWidgets=_yield$_this2$modelDa.connectedAppWidgets,_ref2=connectedAppWidgets||[],_ref3=(0,slicedToArray/* default */.Z)(_ref2,1),selectedWidget=_ref3[0],_ref4=selectedWidget||{},widgetId=_ref4.id,_context2.abrupt("return",widgetId);case 14:_context2.prev=14,_context2.t0=_context2["catch"](4),_this2.showErrorToastMessage(_context2.t0,_this2.$t("custommodules.form.widget_error"));case 17:case"end":return _context2.stop()}}),_callee2,null,[[4,14]])})))()},loadFormsList:function(moduleName){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return _context3.prev=0,_context3.next=3,_this3.modelDataClass.loadFormsList(moduleName);case 3:_this3.forms=_context3.sent,_context3.next=9;break;case 6:_context3.prev=6,_context3.t0=_context3["catch"](0),_this3.showErrorToastMessage(_context3.t0,_this3.$t("custommodules.form.form_template_error"));case 9:case"end":return _context3.stop()}}),_callee3,null,[[0,6]])})))()},loadModuleData:function(_ref5){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){var moduleDataId,moduleName,_ref6,customProps;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:return moduleDataId=_ref5.moduleDataId,moduleName=_ref5.moduleName,_context4.prev=1,_ref6=_this4||{},customProps=_ref6.customProps,_context4.next=5,_this4.modelDataClass.fetch((0,objectSpread2/* default */.Z)({moduleName:moduleName,id:moduleDataId},customProps));case 5:_this4.moduleData=_context4.sent,_context4.next=11;break;case 8:_context4.prev=8,_context4.t0=_context4["catch"](1),_this4.showErrorToastMessage(_context4.t0,_this4.$t("custommodules.summary.record_summary_error"));case 11:case"end":return _context4.stop()}}),_callee4,null,[[1,8]])})))()},loadFormData:function(formId,selectedFormDetails){var _this5=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee5(){var selectedForm,moduleName,moduleDataId,moduleData,loadDataManually,dataObj,formObj,form;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context5){while(1)switch(_context5.prev=_context5.next){case 0:return selectedForm=_this5.selectedForm,moduleName=_this5.moduleName,moduleDataId=_this5.moduleDataId,moduleData=_this5.moduleData,loadDataManually=_this5.loadDataManually,dataObj=_this5.dataObj,formObj={},_context5.prev=2,_context5.next=5,_this5.modelDataClass.loadFormData({formId:formId,moduleName:moduleName,selectedForm:selectedFormDetails||selectedForm});case 5:form=_context5.sent,(0,validation/* isEmpty */.xb)(form)||(formObj=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},form),{},{secondaryBtnLabel:_this5.$t("common._common.cancel"),primaryBtnLabel:_this5.$t("common._common._save")}),((0,validation/* isEmpty */.xb)(moduleDataId)||(0,validation/* isEmpty */.xb)(null===moduleData||void 0===moduleData?void 0:moduleData.id))&&!loadDataManually&&(0,validation/* isEmpty */.xb)(dataObj)||(formObj=_this5.moduleData.deserialize(formObj)),_this5.formObj=formObj),_context5.next=12;break;case 9:_context5.prev=9,_context5.t0=_context5["catch"](2),_this5.showErrorToastMessage(_context5.t0,_this5.$t("custommodules.form.form_details_error"));case 12:return _context5.abrupt("return",formObj);case 13:case"end":return _context5.stop()}}),_callee5,null,[[2,9]])})))()},saveRecord:function(formModel){var _this6=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee6(){var formObj,afterSaveHook,afterSerializeHook,response;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context6){while(1)switch(_context6.prev=_context6.next){case 0:return formObj=_this6.formObj,afterSaveHook=_this6.afterSaveHook,afterSerializeHook=_this6.afterSerializeHook,_this6.isSaving=!0,
//same params as serialize method
_context6.next=4,_this6.moduleData.save(formObj,formModel,afterSerializeHook);case 4:response=_context6.sent,_this6.isSaving=!1,
// Hook to handle notification after crud operation
_this6.notificationHandler(response),
// Hook to handle response after crud operation
!(0,validation/* isEmpty */.xb)(afterSaveHook)&&(0,validation/* isFunction */.mf)(afterSaveHook)&&_this6.afterSaveHook(response);case 8:case"end":return _context6.stop()}}),_callee6)})))()},afterSaveHook:function(response){var moduleName=this.moduleName,data=response[moduleName],id=data.id;this.redirectToSummary(id)},redirectToSummary:function(id){var _this7=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee7(){var moduleName,viewname,_ref7,name;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context7){while(1)switch(_context7.prev=_context7.next){case 0:return _this7.isSaving=!0,moduleName=_this7.moduleName,_context7.next=4,_this7.fetchView(moduleName);case 4:viewname=_context7.sent,_this7.isSaving=!1,(0,router/* isWebTabsEnabled */.tj)()?(_ref7=(0,router/* findRouteForModule */.Jp)(moduleName,router/* pageTypes */.As.OVERVIEW)||{},name=_ref7.name,name&&_this7.$router.push({name:name,params:{viewname:viewname,id:id}})):_this7.$router.push({name:"custommodules-summary",params:{id:id,viewname:viewname}}).catch((function(){}));case 7:case"end":return _context7.stop()}}),_callee7)})))()},redirectToList:function(){var moduleName=this.moduleName;if((0,router/* isWebTabsEnabled */.tj)()){var _ref8=(0,router/* findRouteForModule */.Jp)(moduleName,router/* pageTypes */.As.LIST)||{},name=_ref8.name;name&&this.$router.push({name:name})}else this.$router.push({name:"custommodules-list",params:{moduleName:moduleName}}).catch((function(){}))},showErrorToastMessage:function(error,customMsg){var message=(null===error||void 0===error?void 0:error.message)||customMsg;this.$message.error(message)}}},custom_module_CustomModulesCreationvue_type_script_lang_js=CustomModulesCreationvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(custom_module_CustomModulesCreationvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,CustomModulesCreation=component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/39152.js.map