"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[62423],{
/***/83322:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FNewChartSettings}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/newcharts/components/FNewChartSettings.vue?vue&type=template&id=bb085188
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-popover",{attrs:{width:250,"popper-class":"pT0 pB0"},model:{value:_vm.popoverVisibility,callback:function($$v){_vm.popoverVisibility=$$v},expression:"popoverVisibility"}},[_c("outside-click",{staticClass:"pT20 pB20",attrs:{visibility:_vm.popoverVisibility},on:{onOutsideClick:function($event){_vm.popoverVisibility=!1}}},[!1!==_vm.showChartMode?_c("div",{staticClass:"pL10 pB20"},[_c("div",{staticClass:"label-txt-black pb5"},[_vm._v("Mode")]),_c("div",{},[_c("el-radio-group",{staticClass:"fc-radio-btn chart-setting-group pT10",attrs:{disabled:_vm.disableChartMode},on:{change:_vm.onChartModeChange},model:{value:_vm.settings.chartMode,callback:function($$v){_vm.$set(_vm.settings,"chartMode",$$v)},expression:"settings.chartMode"}},[_c("el-radio",{attrs:{label:"single"}},[_vm._v("Single")]),_c("el-radio",{attrs:{label:"multi"}},[_vm._v("Multiple")])],1)],1)]):_vm._e(),!1!==_vm.showAlarm?_c("div",{staticClass:"pL10 pB20"},[_c("div",{staticClass:"label-txt-black pb5"},[_vm._v("Alarm")]),_c("div",[_c("el-radio-group",{staticClass:"chart-setting-group fc-radio-btn pT10",on:{change:function($event){return _vm.onSettingsChange("alarm")}},model:{value:_vm.settings.alarm,callback:function($$v){_vm.$set(_vm.settings,"alarm",$$v)},expression:"settings.alarm"}},[_c("el-radio",{attrs:{label:!0}},[_vm._v("Show")]),_c("el-radio",{attrs:{label:!1}},[_vm._v(_vm._s(_vm.$t("fields.properties.hideFieldTxt")))])],1)],1)]):_vm._e(),!1!==_vm.showTimePeriod?_c("div",{staticClass:"pL10 pB20"},[_c("div",{staticClass:"label-txt-black pb5"},[_vm._v("Time period")]),_c("div",[_c("el-radio-group",{staticClass:"chart-setting-group fc-radio-btn pT10",model:{value:_vm.settings.timeperiod,callback:function($$v){_vm.$set(_vm.settings,"timeperiod",$$v)},expression:"settings.timeperiod"}},[_c("el-radio",{attrs:{label:!0}},[_vm._v("Show")]),_c("el-radio",{attrs:{label:!1}},[_vm._v(_vm._s(_vm.$t("fields.properties.hideFieldTxt")))])],1)],1)]):_vm._e(),_vm.showFilterBar?_c("div",{staticClass:"pL10 pB20"},[_c("div",{staticClass:"label-txt-black pb5"},[_vm._v("Filter")]),_c("div",[_c("el-radio-group",{staticClass:"chart-setting-group fc-radio-btn pT10",on:{change:function($event){return _vm.onSettingsChange("filter")}},model:{value:_vm.settings.filterBar,callback:function($$v){_vm.$set(_vm.settings,"filterBar",$$v)},expression:"settings.filterBar"}},[_c("el-radio",{attrs:{label:!0}},[_vm._v("Show")]),_c("el-radio",{attrs:{label:!1}},[_vm._v(_vm._s(_vm.$t("fields.properties.hideFieldTxt")))])],1)],1)]):_vm._e()]),_c("div",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"mR30 pT5 chart-icon pointer flRight portfolio-equiv-icon pB8",attrs:{slot:"reference",title:"Report Settings","data-arrow":"true"},slot:"reference"},[_c("span",{on:{click:function($event){$event.stopPropagation(),_vm.popoverVisibility=!0}}},[_c("InlineSvg",{staticClass:"rotate90 fc-grey-svg2",staticStyle:{top:"2px"},attrs:{src:"svgs/equalization",iconClass:"icon icon-sm-md"}})],1)])],1)},staticRenderFns=[],NewDataFormatHelper=(__webpack_require__(169358),__webpack_require__(162506),__webpack_require__(670560),__webpack_require__(804911)),InlineSvg=__webpack_require__(586166),OutsideClick=__webpack_require__(21864),FNewChartSettingsvue_type_script_lang_js={props:["dataPoints","settings","showChartMode","showAlarm","showChart","showTable","showSafelimit","showTimePeriod","disableChartMode","showFilterBar"],data:function(){return{popoverVisibility:!1}},mixins:[NewDataFormatHelper/* default */.Z],components:{InlineSvg:InlineSvg/* default */.Z,OutsideClick:OutsideClick/* default */.Z},methods:{onChartModeChange:function(){if("multi"===this.settings.chartMode){var unitCount=this.countUnits(this.dataPoints);Object.keys(unitCount).length>1?(this.settings.autoGroup=!0,this.autoGroupDataPoints(unitCount)):this.settings.autoGroup=!1}else this.settings.autoGroup=!1,this.autoGroupDataPoints()},onToggleChart:function(){this.settings.chart||(this.settings.table=!0)},onToggleTable:function(){this.settings.table||(this.settings.chart=!0)},autoGroupDataPoints:function(unitCount){if(this.settings.autoGroup)this.groupDataPoints(unitCount,this.dataPoints);else
// remove groups enabled by autogrouping
for(var groupIndex=this.dataPoints.length-1;groupIndex>=0;groupIndex--)if("group"===this.dataPoints[groupIndex].type&&(!this.dataPoints[groupIndex].unit||!this.dataPoints[groupIndex].dataType))for(var group=this.dataPoints.splice(groupIndex,1),children=group[0].children,childIndex=children.length-1;childIndex>=0;childIndex--){var removedChild=children.splice(childIndex,1);this.dataPoints.push(removedChild[0])}},groupDataPoints:function(unitCount,dataPoints){this.dataPoints=this.groupPoints(unitCount,dataPoints)},onSettingsChange:function(option){this.$emit("onSettingsChange",option)}}},components_FNewChartSettingsvue_type_script_lang_js=FNewChartSettingsvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FNewChartSettingsvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FNewChartSettings=component.exports},
/***/974102:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return MultipleRegressionAnalysis}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/energy/analytics/newTools/v1/MultipleRegressionAnalysis.vue?vue&type=template&id=93c8893c
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"fc-energy-regression-page fc-energy-regression"},[_c("div",{staticClass:"fc__layout__flexes fc__layout__has__row fc__layout__box"},[_c("div",{staticClass:"fc__layout__flexes fc__layout__has__row fc__layout__box"},[_c("div",{staticClass:"fc__layout__flexes fc__layout__has__row fc__layout__asset_main p20 height100"},["undefined"!==typeof _vm.resultObj&&_vm.resultObj||0!==_vm.regressionInfo.length?_c("div",{staticClass:"fc__layout__flexes fc__main__con__width height100"},_vm._l(_vm.regressionInfo,(function(regressionResult,idx){return _c("div",{key:idx,staticClass:"fc__asset__main__scroll"},[_c("div",{staticClass:"white-bg p20 fc__layout__flexes position-relative"},[_c("div",{staticClass:"fc-black-13 bold text-left"},[_c("span",{staticClass:"regression-eq-title"},[_vm._v("Regression equation -")]),_c("span",{staticClass:"fc-black-14 fw4"},[_vm._v(_vm._s(regressionResult.expressionString?regressionResult.expressionString:""))])]),_c("div",[_c("table",{staticClass:"regression-table"},[_c("tr",[_c("td",{staticClass:"regression-table-first-td"},[_vm._v(" "+_vm._s("Y")+" ")]),_c("td",[_vm._v(" "+_vm._s(regressionResult.yPoint.name)+" ")])]),_vm._l(regressionResult.dataPoints,(function(dataPoint,dataPointIdx){return _c("tr",{key:dataPointIdx},[_c("td",{staticClass:"regression-table-first-td"},[_vm._v(" "+_vm._s(dataPoint.aliases.actual)+" ")]),_c("td",[_vm._v(" "+_vm._s(dataPoint.name)+" ")])])}))],2)])]),_c("div",{staticClass:"mT20"},[_c("div",{staticClass:"fc-grey2 f11 text-uppercase fwBold"},[_vm._v(" Regression Statistics ")]),_c("div",{staticClass:"white-bg fc__layout__flexes position-relative mT10"},[_c("el-row",{staticClass:"p20 border-bottom4"},[_c("el-col",{attrs:{span:5}},[_c("div",{staticClass:"fc-black-13 bold text-left"},[_vm._v(" Multiple R ")])]),_c("el-col",{attrs:{span:7}},[_c("div",{staticClass:"fc-black-13 text-left"},[_vm._v(" "+_vm._s(Math.sqrt(regressionResult.rsquared).toPrecision(2))+" ")])]),_c("el-col",{attrs:{span:5}},[_c("div",{staticClass:"fc-black-13 bold text-left"},[_vm._v(" Standard Error ")])]),_c("el-col",{attrs:{span:7}},[_c("div",{staticClass:"fc-black-13 text-left"},[_vm._v(" "+_vm._s(regressionResult.standardError)+" ")])])],1),_c("el-row",{staticClass:"p20 border-bottom4"},[_c("el-col",{attrs:{span:5}},[_c("div",{staticClass:"fc-black-13 bold text-left"},[_vm._v(" R Square ")])]),_c("el-col",{attrs:{span:7}},[_c("div",{staticClass:"fc-black-13 text-left"},[_vm._v(" "+_vm._s(regressionResult.rsquared)+" ")])]),_c("el-col",{attrs:{span:5}},[_c("div",{staticClass:"fc-black-13 bold text-left"},[_vm._v(" Observations ")])]),_c("el-col",{attrs:{span:7}},[_c("div",{staticClass:"fc-black-13 text-left"},[_vm._v(" "+_vm._s(regressionResult.observations)+" ")])])],1),_c("el-row",{staticClass:"p20"},[_c("el-col",{attrs:{span:5}},[_c("div",{staticClass:"fc-black-13 bold text-left"},[_vm._v(" Adjusted R Square ")])]),_c("el-col",{attrs:{span:7}},[_c("div",{staticClass:"fc-black-13 text-left"},[_vm._v(" "+_vm._s(regressionResult.adjustedrSquared)+" ")])])],1)],1)]),_c("div",{staticClass:"mT20"},[_c("div",{staticClass:"fc-grey2 f11 text-uppercase fwBold"},[_vm._v(" ANOVA ")]),_c("div",{staticClass:"white-bg fc__layout__flexes position-relative mT10 settings-table-hover-bg-remove"},[_c("table",{staticClass:"setting-list-view-table width100"},[_c("thead",[_c("tr",[_c("th",{staticClass:"setting-table-th setting-th-text"}),_vm._l(_vm.anovaResultKeys,(function(anovaColumn,idx2){return _c("th",{key:idx2,staticClass:"setting-table-th setting-th-text"},[_vm._v(" "+_vm._s(anovaColumn.displayName)+" ")])}))],2)]),_c("tbody",_vm._l(regressionResult.anovaMetrics,(function(anovaRecord,metricIdx){return _c("tr",{key:metricIdx},[_c("td",[_c("div",{staticClass:"fc-black-13 text-left"},[_vm._v(" "+_vm._s(_vm.stringWithCaps(anovaRecord.resultVariable))+" ")])]),_vm._l(_vm.anovaResultKeys,(function(metricColumn,columnIdx){return _c("td",{key:columnIdx},[_c("div",{staticClass:"fc-black-13 text-left"},[_vm._v(" "+_vm._s(-1===anovaRecord[metricColumn.name]?" ":anovaRecord[metricColumn.name])+" ")])])}))],2)})),0)])])]),_c("div",{staticClass:"mT20"},[_c("div",{staticClass:"fc-grey2 f11 text-uppercase fwBold"},[_vm._v(" Regression metrics ")]),_c("div",{staticClass:"white-bg fc__layout__flexes position-relative mT10 settings-table-hover-bg-remove"},[_c("table",{staticClass:"setting-list-view-table width100"},[_c("thead",[_c("tr",[_c("th",{staticClass:"setting-table-th setting-th-text"}),_vm._l(_vm.regressionStatKeys,(function(regressionStat,regressionStatIdx){return _c("th",{key:regressionStatIdx,staticClass:"setting-table-th setting-th-text"},[_vm._v(" "+_vm._s(regressionStat.displayName)+" ")])}))],2)]),_c("tbody",_vm._l(regressionResult.regressionMetrics,(function(metricRecord,metricRecordIdx){return _c("tr",{key:metricRecordIdx},[_c("td",[_c("div",{staticClass:"fc-black-13 text-left"},[_vm._v(" "+_vm._s(metricRecord.name)+" ")])]),_vm._l(_vm.regressionStatKeys,(function(stat,statIdx){return _c("td",{key:statIdx},[_c("div",{staticClass:"fc-black-13 text-left"},[_vm._v(" "+_vm._s(-1===metricRecord[stat.name]?"N/A":metricRecord[stat.name])+" ")])])}))],2)})),0)])])])])})),0):_vm._e()])])])])},staticRenderFns=[],createForOfIteratorHelper=__webpack_require__(566347),FNewAnalyticsModelHelper=(__webpack_require__(689730),__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(425728),__webpack_require__(434284),__webpack_require__(670560),__webpack_require__(146371)),MultipleRegressionAnalysisvue_type_script_lang_js={watch:{resultObj:{handler:function(newVal,oldVal){"undefined"!==typeof this.resultObj&&this.resultObj&&this.prepareRegressionInfo()},deep:!0},regressionMetrics:{handler:function(newVal,oldVal){"undefined"!==typeof this.regressionMetrics&&this.regressionMetrics&&this.prepareRegressionInfo()},deep:!0}},data:function(){return{regressionMetricKeys:null,regressionStatKeys:null,anovaResultKeys:null,regressionInfo:[]}},props:["resultObj","regressionMetrics","analyticsConfig"],created:function(){this.regressionMetricKeys=FNewAnalyticsModelHelper/* default */.Z.regressionMetrics(),this.regressionStatKeys=FNewAnalyticsModelHelper/* default */.Z.regressionStatistics(),this.anovaResultKeys=FNewAnalyticsModelHelper/* default */.Z.anovaResultKeys(),"undefined"!==typeof this.regressionMetrics&&null!==this.regressionMetrics?this.populateRegressionInfo():"undefined"!==typeof this.resultObj&&null!==this.resultObj&&this.prepareRegressionInfo()},methods:{populateRegressionInfo:function(){this.regressionInfo=this.regressionMetrics},stringWithCaps:function(string){var firstChar=string.charAt(0),remaining=string.slice(1);return firstChar.toUpperCase()+remaining.toLowerCase()},prepareRegressionInfo:function(){var _this=this;if("undefined"!==typeof this.resultObj&&null!==this.resultObj&&this.resultObj.reportData.data&&0!=this.resultObj.reportData.data.length&&this.resultObj.reportData.regressionResult&&0!==this.resultObj.reportData.regressionResult.length){this.regressionInfo=[];var _step,_iterator=(0,createForOfIteratorHelper/* default */.Z)(this.resultObj.regressionConfig);try{var _loop=function(){var config=_step.value,key=FNewAnalyticsModelHelper/* default */.Z.computeRegressionAlias(config),temp={};temp["alias"]=key;var result=_this.resultObj.reportData.regressionResult[key],regressionDataPoint=_this.resultObj.report.dataPoints.filter((function(dp){return dp.aliases.actual===key}));regressionDataPoint.length&&(temp["expressionString"]=regressionDataPoint[0].expressionString);var dataPoints=[],_loop2=function(alias){if("constant"!==alias){var dataPoint=_this.resultObj.report.dataPoints.find((function(dp){return dp.aliases.actual===alias}));dataPoint&&dataPoints.push(dataPoint)}};for(var alias in result.coefficientMap)_loop2(alias);var yDataPoint=_this.resultObj.report.dataPoints.find((function(dp){return dp.aliases.actual===config.yAxis.alias}));yDataPoint&&(temp["yPoint"]=yDataPoint),temp["dataPoints"]=dataPoints;var _step2,_iterator2=(0,createForOfIteratorHelper/* default */.Z)(_this.regressionMetricKeys);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var heading=_step2.value;temp[heading.name]=result[heading.name]}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}for(var variableName in temp["anovaMetrics"]=result["anovaMetrics"],result.regressionMetrics){var row=result.regressionMetrics[variableName];row["name"]=variableName}temp["regressionMetrics"]=result.regressionMetrics,_this.regressionInfo.push(temp)};for(_iterator.s();!(_step=_iterator.n()).done;)_loop()}catch(err){_iterator.e(err)}finally{_iterator.f()}}}},computed:{}},v1_MultipleRegressionAnalysisvue_type_script_lang_js=MultipleRegressionAnalysisvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(v1_MultipleRegressionAnalysisvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,MultipleRegressionAnalysis=component.exports},
/***/376662:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FDateTimeFilter}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/report/components/FDateTimeFilter.vue?vue&type=template&id=3d3d91c4
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"row report-user-filters"},[_vm._e()])},staticRenderFns=[],validation=(__webpack_require__(169358),__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(300268),__webpack_require__(990260)),FDateTimeFiltervue_type_script_lang_js={props:["filters","report"],watch:{filters:{handler:function(newVal,oldVal){newVal!=oldVal&&this.applyDateTimeFilter(newVal)}}},methods:{applyDateTimeFilter:function(filters){var _this$report,ttimeFilter=this.formTTimeFilter(filters);ttimeFilter&&4!==(null===this||void 0===this||null===(_this$report=this.report)||void 0===_this$report?void 0:_this$report.reportType)&&this.$emit("applyTTimeFilter",{filters:ttimeFilter,isTTimeFilter:!0})},formTTimeFilter:function(filters){var formTTimeFilerObj={},flag=!0;if(filters){var keys=Object.keys(filters);if(keys.forEach((function(key,index){key&&key.startsWith("ttime_")&&(formTTimeFilerObj[key]=filters[key])})),flag&&!(0,validation/* isEmpty */.xb)(formTTimeFilerObj))return formTTimeFilerObj}return null}}},components_FDateTimeFiltervue_type_script_lang_js=FDateTimeFiltervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FDateTimeFiltervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FDateTimeFilter=component.exports},
/***/862423:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FNewReport}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/report/components/FNewReport.vue?vue&type=template&id=b27e227c
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"height100 mobile-report fnew-report-page",class:{scrollable:_vm.config&&_vm.config.widget&&_vm.reportObj&&_vm.reportObj.options&&!1===_vm.reportObj.options.settings.chart,"scatter-main-con":_vm.isScatter},staticStyle:{"overflow-y":"scroll"}},[_vm.showHeadingOnlyForPdf&&_vm.pdfloading?_c("div",{staticClass:"text-center label-txt-black4 bold pB20"},[_vm.excludeParamsObj.title&&_vm.excludeParamsObj.logo?_vm._e():_c("div",{staticClass:"report-pdf-header",staticStyle:{overflow:"hidden"}},[_vm.$org.logoUrl?_c("div",{staticClass:"fc-report-cus-logo",class:{"logo-visible":_vm.excludeParamsObj.logo}},[_c("img",{staticStyle:{width:"100px",height:"50px"},attrs:{src:_vm.$org.logoUrl}})]):_c("div",{staticClass:"fc-logo-report",class:{"logo-visible":_vm.excludeParamsObj.logo}},[_vm.showLogo?_c("img",{attrs:{src:_vm.getFacilioLogoURL}}):_vm._e()]),_vm.excludeParamsObj.title?_vm._e():_c("div",{staticClass:"f18 fc-widget-label ellipsis max-width350px"},[_vm._v(" "+_vm._s(_vm.resultObj.report.name||"Analytical Report")+" ")])]),_vm.showPrintDetails||_vm.printView?_c("div",{staticClass:"fc-report-author-sec pdf-text-left pdf-margin-top"},[_vm.excludeParamsObj.description?_vm._e():_c("div",[_c("div",{staticClass:"fc-report-author-txt"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.generated_on"))+" "),_c("span",{staticClass:"fw6 pdf-left-margin"},[_vm._v(" "+_vm._s(_vm.formatDate())+" ")])]),_c("div",{staticClass:"fc-report-author-txt"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.generated_by"))+" "),_c("span",{staticClass:"fw6 pdf-left-margin"},[_vm._v(" "+_vm._s(_vm.$account.user.name)+" ")])])]),_vm.excludeParamsObj.filter?_vm._e():_c("div",[_c("div",{staticClass:"fc-report-author-txt flex-middle"},[_vm._v(" "+_vm._s(_vm.$t("common.date_picker.date_range")+":")+" "),_c("div",{staticClass:"f9 fw6 pdf-left-margin"},[_vm._v(" "+_vm._s(_vm.getDateRangeString)+" ")])]),_vm.isFilterApplied?_c("div",{staticClass:"fc-report-author-txt"},[_vm._v(" "+_vm._s(_vm.pdfFilter+" :")+" "),_c("span",{staticClass:"fw6 pdf-left-margin"},[_vm._v(" "+_vm._s(" "+_vm.displayName)+" ")])]):_vm._e()])]):_vm._e()]):_vm._e(),_c("div",{staticClass:"datefilter-hide-overlay"}),_vm.loading?_vm._e():_c("div",{staticStyle:{"text-align":"center"}},["undefined"!==typeof _vm.config&&_vm.widgetDatePicker?_c("portal",{staticClass:"tabulardata-datepicker",attrs:{to:"widget-datepicker"+_vm.config.widget.id,slim:""}},[_vm.dateFilter?_c("new-date-picker",{key:_vm.datePickerCompKey,staticClass:"filter-field date-filter-comp-new-report inline",attrs:{zone:_vm.$timezone,dateObj:_vm.dateFilter},on:{date:_vm.setDateFilter}}):_vm._e()],1):_vm.datePickerTarget?_c("portal",{staticClass:"tabulardata-datepicker",attrs:{to:"widget-datepicker"+_vm.datePickerTarget,slim:""}},[!_vm.hideTimelineFilterInsideWidget&&_vm.dateFilter?_c("new-date-picker",{key:_vm.datePickerCompKey,staticClass:"filter-field date-filter-comp-asset-summary inline",attrs:{zone:_vm.$timezone,dateObj:_vm.dateFilter},on:{date:_vm.setDateFilter}}):_vm._e()],1):[!_vm.hideTimelineFilterInsideWidget&&_vm.dateFilter?_c("new-date-picker",{key:_vm.datePickerCompKey,staticClass:"filter-field date-filter-comp-new-report inline",attrs:{zone:_vm.$timezone,dateObj:_vm.dateFilter},on:{date:_vm.setDateFilter}}):_vm._e()],_vm.reportObj&&!0===_vm.reportObj.options.settings.timeperiod&&_vm.showTimePeriod&&!_vm.isScatter?_c("div",{staticClass:"chart-icon pointer pB8 el-popover__reference",staticStyle:{"padding-left":"210px",top:"10px",height:"50px",position:"absolute"}},[_c("el-select",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"period-select width100 fwidget-report-period-select",attrs:{size:"mini",placeholder:"Period",title:"Time period","data-arrow":"true"},on:{change:_vm.onPeriodChange},model:{value:_vm.period,callback:function($$v){_vm.period=$$v},expression:"period"}},_vm._l(_vm.getAvailablePeriods,(function(period,index){return _c("el-option",{key:index,attrs:{label:period.name,value:period.value,disabled:!period.enable}})})),1)],1):_vm._e(),_vm.hideChartSettings||!_vm.reportObj||!_vm.reportObj.options||!_vm.reportObj.options.settings||_vm.config&&_vm.config.widget||_vm.isRegression||_vm.isHeatMap||_vm.isTreeMap||_vm.isScatter?_vm._e():_c("f-chart-settings",{staticClass:"freport-page-settings",attrs:{showTimePeriod:_vm.showTimePeriod,showSafelimit:_vm.showSafeLimit,settings:_vm.reportObj&&_vm.reportObj.options?_vm.reportObj.options.settings:null},on:{onSettingsChange:_vm.onSettingsChange}})],2),_vm.reportObj&&_vm.reportObj.options.common.filters&&_vm.reportObj.options.common.filters.filterState&&_vm.reportObj.options.common.filters.filterState.liveFilterField&&"none"!==_vm.reportObj.options.common.filters.filterState.liveFilterField&&!_vm.isRegression&&!1===_vm.loading&&_vm.resultObj&&4!==_vm.reportObj.reportType?_vm._e():_c("FDateTimeFilter",{attrs:{filters:_vm.dbFilterJson,report:_vm.reportObj},on:{applyTTimeFilter:_vm.applyTTimeFilter}}),_vm.reportObj&&_vm.reportObj.options.common.filters&&_vm.reportObj.options.common.filters.filterState&&_vm.reportObj.options.common.filters.filterState.liveFilterField&&"none"!==_vm.reportObj.options.common.filters.filterState.liveFilterField&&!_vm.isRegression&&!1===_vm.loading?_c("f-user-filters",{ref:"userFilter-"+(_vm.config&&_vm.config.widget&&_vm.config.widget.id?_vm.config.widget.id:_vm.reportId),attrs:{report:_vm.reportObj,filters:_vm.filter},on:{filterData:function(value){return _vm.liveFilterValue(value)},applyFilter:_vm.applyFilter,userFilterLoaded:_vm.userFilterLoaded}}):_vm._e(),_vm.reportTemplateAssetChooser?_c("div",{staticClass:"chart-icon pointer pB8 el-popover__reference mL10 mT10"},[_c("el-row",[_c("el-col",{staticClass:"text-left position-relative",attrs:{span:5}},[_c("el-select",{staticClass:"period-select fwidget-report-period-select width100 mB30",class:{"position-absolute":_vm.isWidget},attrs:{size:"mini",filterable:"",disabled:_vm.disbaleRPassetChooser},on:{change:_vm.applyTemplate},model:{value:_vm.reportTemplate.parentId,callback:function($$v){_vm.$set(_vm.reportTemplate,"parentId",$$v)},expression:"reportTemplate.parentId"}},_vm._l(_vm.reportTemplate.chooseValues,(function(val,valIdx){return _c("el-option",{key:valIdx,attrs:{label:val.name,value:val.id}})})),1)],1)],1)],1):_vm._e(),_vm.loading?_c("spinner",{attrs:{show:_vm.loading,size:"80"}}):_vm.failed?_c("div",{staticStyle:{"margin-top":"30px",opacity:"0.7","font-size":"13px",padding:"50px","line-height":"25px","text-align":"center"}},[_c("div",[_vm._v(_vm._s(_vm.$t("home.dashboard.data_loading_failed")))])]):_vm.reportObj.data?_c("div",{staticClass:"height100"},[_vm.isRegression?_vm._e():[_vm.isHeatMap?[_c("FNewHeatMap",{ref:"heatmap",attrs:{config:_vm.config,resultObject:_vm.resultObj,width:this.widgetWidth,height:this.widgetHeight,reportObject:_vm.reportObj},on:{"update:width":function($event){return _vm.$set(this,"widgetWidth",$event)},"update:height":function($event){return _vm.$set(this,"widgetHeight",$event)}}}),_vm.hideTable?_vm._e():_c("f-tabular-report",{ref:"newTable",staticClass:"newTable",attrs:{reportObject:_vm.resultObj,reportConfig:_vm.reportObj,hideColumn:_vm.hideColumn,widget:_vm.config?_vm.config.widget:null}})]:_vm.isTreeMap?[_c("FTreeMap",{ref:"treemap",attrs:{config:_vm.config,resultObject:_vm.resultObj,width:this.widgetWidth,height:this.widgetHeight,reportObject:_vm.reportObj},on:{"update:width":function($event){return _vm.$set(this,"widgetWidth",$event)},"update:height":function($event){return _vm.$set(this,"widgetHeight",$event)}}}),_vm.hideTable?_vm._e():_c("f-tabular-report",{ref:"newTable",staticClass:"newTable",attrs:{reportObject:_vm.resultObj,reportConfig:_vm.reportObj,hideColumn:_vm.hideColumn,widget:_vm.config?_vm.config.widget:null}})]:[_vm.reportObj&&_vm.reportObj.options&&_vm.reportObj.options.settings&&"multi"===_vm.reportObj.options.settings.chartMode&&!_vm.isScatter&&!1!==_vm.reportObj.options.settings.chart&&!_vm.showChart?_c("div",{class:{height100:_vm.config}},[_vm.$mobile?_c("f-mobile-multi-chart",{ref:"multiChart",attrs:{isWidget:!!_vm.config,config:_vm.config,width:_vm.config&&_vm.config.width?_vm.config.width:null,resultObj:_vm.resultObj,height:_vm.config&&_vm.config.height?_vm.config.height:null,data:_vm.reportObj.data,options:_vm.reportObj?_vm.reportObj.options:null,alarms:_vm.reportObj.alarms,dateRange:_vm.reportObj.dateRange,hidecharttypechanger:_vm.isRegression,booleanData:_vm.reportObj.booleanData}}):_c("f-multi-chart",{ref:"multiChart",attrs:{isWidget:!!_vm.config,width:_vm.config&&_vm.config.width?_vm.config.width:null,resultObj:_vm.resultObj,height:_vm.config&&_vm.config.height?_vm.config.height:null,data:_vm.reportObj.data,options:_vm.reportObj?_vm.reportObj.options:null,alarms:_vm.reportObj.alarms,dateRange:_vm.reportObj.dateRange,hidecharttypechanger:_vm.isRegression,booleanData:_vm.reportObj.booleanData}})],1):_vm.showChart?_vm._e():_c("div",{class:{height100:_vm.config&&_vm.reportObj&&!1!==_vm.reportObj.options.settings.chart}},[_vm.$route.meta&&_vm.$route.meta.dashboardlayout&&"mobile"===_vm.$route.meta.dashboardlayout?_c("f-mobile-chart",{ref:"newChart",attrs:{width:_vm.config&&_vm.config.width?_vm.config.width:null,resultObj:_vm.resultObj,height:_vm.config&&_vm.config.height?_vm.config.height:null,data:_vm.reportObj.data,options:_vm.reportObj?_vm.reportObj.options:null,dateRange:_vm.reportObj.dateRange,reportType:_vm.reportObj.reportType}}):_c("f-new-chart",{ref:"newChart",staticClass:"fc-single-chart-pdf",class:{"fc-scatter-chart":_vm.isScatter},attrs:{config:_vm.config,isWidget:!!_vm.config,width:_vm.config&&_vm.config.width?_vm.config.width:null,resultObj:_vm.resultObj,height:_vm.config&&_vm.config.height?_vm.config.height:null,data:_vm.reportObj.data,options:_vm.reportObj?_vm.reportObj.options:null,alarms:_vm.reportObj.alarms,dateRange:_vm.reportObj.dateRange,hidecharttypechanger:_vm.isRegression||_vm.isScatter,reportType:_vm.reportObj.reportType}})],1),_vm.hideTable||_vm.isScatter?_vm._e():_c("f-tabular-report",{ref:"newTable",staticClass:"newTable tabular-table-widget",attrs:{reportObject:_vm.resultObj,reportConfig:_vm.reportObj,hideColumn:_vm.hideColumn,widget:_vm.config?_vm.config.widget:null}})],!_vm.isScatter||_vm.hideTable||_vm.$mobile?_vm._e():[_vm.isPrinting?_c("f-tabular-report",{ref:"newTable",staticClass:"fc-tabular new-analytics-table",attrs:{reportObject:_vm.trendresultObj,reportConfig:_vm.trendreportObj,hideColumn:_vm.hideColumn}}):[_c("div",{staticClass:"white-bg-block mB10 width100"},[_c("div",{staticClass:"analytics-section mT20"},[_c("el-collapse",{staticClass:"fc-pushing-data-collapse fc-collapse-arrow-bg fc-analytics-collapse fc-scatter-collapse",model:{value:_vm.activeTable,callback:function($$v){_vm.activeTable=$$v},expression:"activeTable"}},[_c("el-collapse-item",{attrs:{title:"Undelying Data",name:"1"}},[_vm.activeTable.includes("1")?_c("div",[_vm.loading?_c("spinner",{staticClass:"analytics-spinner",attrs:{show:_vm.loading,size:"80"}}):_vm.failed?_c("div",{staticStyle:{"margin-top":"30px",opacity:"0.7","font-size":"13px",padding:"50px","line-height":"25px","text-align":"center"}},[_c("div",[_vm._v(" "+_vm._s(_vm.$t("home.dashboard.data_loading_failed"))+" ")])]):_vm.reportObj.data?_vm._e():_c("div",{staticStyle:{"margin-top":"30px","font-size":"13px",padding:"50px","line-height":"25px","text-align":"center"}},[_c("inline-svg",{attrs:{src:"svgs/emptystate/reportlist",iconClass:"icon text-center icon-100"}}),_c("div",{staticClass:"nowo-label f13"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.empty_data"))+" "),_vm.resultObj&&_vm.resultObj.dateRange?_c("span",{staticClass:"bold"},[_vm._v(_vm._s(_vm._f("formatPeriod")(_vm.resultObj.dateRange.value,"MMM DD, YYYY")))]):_vm._e()])],1),_c("f-tabular-report",{ref:"newTable",staticClass:"new-analytics-table",attrs:{reportObject:_vm.trendresultObj,reportConfig:_vm.trendreportObj,hideColumn:_vm.hideColumn,widget:!0,showWidgetTable:!0}})],1):_vm._e()])],1)],1)])]]],_vm.isRegression?_c("div",{staticClass:"mT10"},[_c("MultipleRegressionAnalysis",{attrs:{resultObj:_vm.resultObj}})],1):_vm._e()],2):_c("div",{staticStyle:{"font-size":"13px",padding:"80px 50px 50px 50px","line-height":"25px","text-align":"center"}},[_c("inline-svg",{attrs:{src:"svgs/emptystate/reportlist",iconClass:"icon text-center icon-100"}}),_c("div",{staticClass:"nowo-label f13"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.empty_data"))+" "),_vm.resultObj&&_vm.resultObj.dateRange?_c("span",{staticClass:"bold"},[_vm._v(_vm._s(_vm._f("formatPeriod")(_vm.resultObj.dateRange.value,"MMM DD, YYYY")))]):_vm._e()])],1)],1)},staticRenderFns=[],createForOfIteratorHelper=__webpack_require__(566347),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),toConsumableArray=__webpack_require__(488478),api=(__webpack_require__(169358),__webpack_require__(634338),__webpack_require__(689730),__webpack_require__(670560),__webpack_require__(260228),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(506203),__webpack_require__(434284),__webpack_require__(425728),__webpack_require__(947522),__webpack_require__(879288),__webpack_require__(300268),__webpack_require__(186466),__webpack_require__(648324),__webpack_require__(538077),__webpack_require__(32284)),NewDatePicker=__webpack_require__(900773),FNewChart=__webpack_require__(875963),FMobileChart=__webpack_require__(242208),FMobileMultiChart=__webpack_require__(696593),FMultiChart=__webpack_require__(649206),NewDataFormatHelper=__webpack_require__(804911),FTabularReportNew=__webpack_require__(979),NewDateHelper=__webpack_require__(105534),FNewChartSettings=__webpack_require__(83322),FUserFilters=__webpack_require__(405977),NewReportSummaryHelper=__webpack_require__(601458),MultipleRegressionAnalysis=__webpack_require__(974102),InlineSvg=__webpack_require__(586166),FNewHeatMap=__webpack_require__(283938),FTreeMap=__webpack_require__(650976),lodash=__webpack_require__(496486),deepmerge=__webpack_require__(708634),validation=__webpack_require__(990260),FDateTimeFilter=__webpack_require__(376662),moment_timezone=__webpack_require__(480008),moment_timezone_default=__webpack_require__.n(moment_timezone),vue_runtime_esm=__webpack_require__(720144),FNewReportvue_type_script_lang_js={props:["id","config","tabular","showTimePeriod","templateJson","hideChartSettings","hideTabularReport","datePickerTarget","dbTimelineFilter","dbFilterJson","qs","isLazyDashboard","isVisibleInViewport","showHeadingOnlyForPdf","hideColumn","showChart","printView"],mixins:[NewDataFormatHelper/* default */.Z,NewReportSummaryHelper/* default */.Z],components:{NewDatePicker:NewDatePicker/* default */.Z,FNewChart:FNewChart/* default */.Z,FMultiChart:FMultiChart/* default */.Z,FTabularReport:FTabularReportNew/* default */.Z,FMobileChart:FMobileChart/* default */.Z,FChartSettings:FNewChartSettings/* default */.Z,FUserFilters:FUserFilters/* default */.Z,FMobileMultiChart:FMobileMultiChart/* default */.Z,MultipleRegressionAnalysis:MultipleRegressionAnalysis/* default */.Z,InlineSvg:InlineSvg/* default */.Z,FNewHeatMap:FNewHeatMap/* default */.Z,FTreeMap:FTreeMap/* default */.Z,FDateTimeFilter:FDateTimeFilter/* default */.Z},data:function(){return{pdfloading:!1,applyFilterCallbackHook:!0,disbaleRPassetChooser:!1,loading:!0,failed:!1,reportObj:null,resultObj:null,showReportOptions:!1,dateFilter:null,userFilterApplied:null,period:null,reportTemplate:null,widgetWidth:null,widgetHeight:null,datePickerCompKey:1,activeTable:[],activeTrend:[],trendresultObj:null,trendreportObj:null,filter:{},displayName:[],isFilterApplied:!1,excludeParamsObj:{}}},mounted:function(){var _JSON$parse;this.$mobile?(this.widgetWidth=this.$el.clientWidth,this.widgetHeight=this.$mobile?this.config.height:this.$el.clientHeight-30):this.isPrinting&&(this.widgetWidth=this.$el.clientWidth);var _this$$route$query$ex=this.$route.query.excludeParams,excludeParams=void 0===_this$$route$query$ex?{}:_this$$route$query$ex;this.excludeParamsObj=(0,validation/* isEmpty */.xb)(excludeParams)?{}:null!==(_JSON$parse=JSON.parse(excludeParams))&&void 0!==_JSON$parse?_JSON$parse:{},this.init()},computed:{getFacilioLogoURL:function(){var brandConfig=this.brandConfig,logo=this.$getProperty(brandConfig,"logo",null);return logo},showLogo:function(){var brandConfig=this.brandConfig,showLogoInPDF=this.$getProperty(brandConfig,"showLogoInPDF",!0);return showLogoInPDF},brandConfig:function(){return window.brandConfig},getDateRangeString:function(){var dateRange=this.$getProperty(this.resultObj,"dateRange.value",{}),startTime=moment_timezone_default()(dateRange[0]).tz(vue_runtime_esm["default"].prototype.$timezone).format("DD/MM/YYYY"),endTime=moment_timezone_default()(dateRange[1]).tz(vue_runtime_esm["default"].prototype.$timezone).format("DD/MM/YYYY");return"".concat(startTime," to ").concat(endTime)},pdfFilter:function(){var filterName=this.$getProperty(this.reportObj,"options.common.filters.filterState.liveFilterField","Filter");return"".concat(filterName.charAt(0).toUpperCase()).concat(filterName.slice(1))},reportTemplateAssetChooser:function(){var resultObj=this.resultObj,reportTemplate=this.reportTemplate;return!!(resultObj&&resultObj.report&&4===resultObj.report.type&&reportTemplate&&0!==reportTemplate.chooseValues.length)},hideTimelineFilterInsideWidget:function(){var _this$config;return!(null===(_this$config=this.config)||void 0===_this$config||null===(_this$config=_this$config.dashboardObj)||void 0===_this$config||null===(_this$config=_this$config.dashboardFilter)||void 0===_this$config||!_this$config.hideFilterInsideWidgets)&&this.config.dashboardObj.dashboardFilter.hideFilterInsideWidgets},widgetDatePicker:function(){return!!(this.reportObj&&this.reportObj.options&&this.reportObj.options.settings&&!this.reportObj.options.settings.chart&&this.reportObj.options.settings.table)},isWidget:function(){return!!this.config},isPrinting:function(){return this.$route.query.print||this.$route.query.daterange||this.showHeadingOnlyForPdf;// daterange check temp
},computeSpaceAssetInitValue:function(){if(this.resultObj&&this.resultObj.report&&this.resultObj.report.reportTemplate){var temp={};return temp["assetCategory"]=this.resultObj.report.reportTemplate.categoryId+"",temp["isIncludeResource"]=!1,this.reportTemplate?(temp["selectedResource"]=[],temp.selectedResource.push(this.reportTemplate.parentId)):temp["selectedResource"]=[],temp["reportTemplate"]=!0,temp}return{}},getAvailablePeriods:function(){if(this.reportObj&&this.reportObj.dateRange){var operationOnId=this.reportObj.dateRange.operatorId,avail=[];
// avail.push({
//   name:'Week of year', // W1, W2
//   value: 16,
//   enable: true
// })
// avail.push({
//   name:'Month of year', // Jan, Feb , march
//   value: 15,
//   enable: true
// })
return avail.push({name:"High-res",value:0,enable:6===operationOnId||4!==operationOnId}),avail.push({name:"Hourly",value:20,enable:6===operationOnId||4!==operationOnId}),avail.push({name:"Daily",value:12,enable:!0}),avail.push({name:"Weekly",value:11,enable:!0}),avail.push({name:"Monthly",value:10,enable:!0}),avail.push({name:"Quarterly",value:25,enable:4===operationOnId||5===operationOnId}),avail.push({name:"Yearly",value:8,enable:4===operationOnId}),avail.push({name:"Hour of day",
// 12, 1, 2, 3
value:19,enable:!0}),avail.push({name:"Day of week",
// sun, mon
value:17,enable:!0}),avail.push({name:"Day of month",
// 1,2,3
value:18,enable:!0}),avail}return[]},isRegression:function(){return!!(this.resultObj&&this.resultObj.report&&this.resultObj.report.reportState&&this.resultObj.report.reportState.regressionConfig&&0!=this.resultObj.report.reportState.regressionConfig.length)},isScatter:function(){return!(!this.resultObj||!this.resultObj.report||8!==this.resultObj.report.analyticsType)},isHeatMap:function(){return!(!this.resultObj||!this.resultObj.report||3!==this.resultObj.report.analyticsType)},isTreeMap:function(){return!(!this.resultObj||!this.resultObj.report||7!==this.resultObj.report.analyticsType)},showSafeLimit:function(){return!this.resultObj||!this.resultObj.report||3!==this.resultObj.report.type},reportId:function(){return this.id?this.id:this.config?this.config.widget.dataOptions.newReportId:null},appliedDateRange:function(){if(this.$route.query.daterange)return JSON.parse(this.$route.query.daterange)},isSiteFilterApplied_toExport:function(){return this.$route.query.spaceId_forExport?this.$route.query.spaceId_forExport:null},isSiteFilterMode_toExport:function(){return this.$route.query.filterModeValue_toExport?this.$route.query.filterModeValue_toExport:null},appliedChartType:function(){
// Temp...will be changed for pdf once temp report support is implemented
return this.$route.query.charttype},hideTable:function(){return!!this.excludeParamsObj.table||(this.showOnlyImage||this.hideTabularReport)},appliedReportTemplate:function(){return this.$route.query.template},reportTemplteParams:function(){return this.$route.query.templateParams}},created:function(){if(this.dbTimelineFilter){var pickerObj=NewDateHelper/* default */.Z.getDatePickerObject(this.dbTimelineFilter.operatorId,this.dbTimelineFilter.dateValueString);this.dateFilter=pickerObj}if(this.qs){var qsParams=this.getQueryStringParams(this.qs);if(qsParams.startTime&&qsParams.endTime){var _pickerObj=NewDateHelper/* default */.Z.getDatePickerObject(20,qsParams.startTime+","+qsParams.endTime);this.dateFilter=_pickerObj}}this.$store.dispatch("loadAssetCategory")},watch:{
//when widget at bottom of dashboard is scrolled up , this prop changes from false to true,
isVisibleInViewport:function(newValue,oldValue){newValue&&this.init()},reportId:{handler:function(newData,oldData){this.period=null,this.dateFilter=!1,this.reportTemplate=null,this.init(!1)}},reportTemplteParams:{handler:function(newData,olddata){newData!==olddata&&this.reportTemplate&&this.setParamsToTemplate()},deep:!0},config:{handler:function(newData,oldData){newData&&oldData?newData.id!==oldData.id?this.init(!1):((this.isHeatMap||this.isTreeMap)&&(this.widgetWidth=this.$el.clientWidth,this.widgetHeight=this.$mobile?this.config.height:this.$el.clientHeight-30,this.$refs["heatmap"]?this.$refs["heatmap"].resize():this.$refs["treemap"]&&this.$refs["treemap"].resize()),this.$emit("reportLoaded",this.reportObj,this.resultObj)):this.init(!1)},deep:!0},dbTimelineFilter:function(newValue,oldValue){if(!(0,lodash.isEqual)(newValue,oldValue)){var pickerObj=NewDateHelper/* default */.Z.getDatePickerObject(newValue.operatorId,newValue.dateValueString);this.dateFilter=pickerObj,this.init(),this.datePickerCompKey++}},dbFilterJson:function(newValue,oldValue){(0,lodash.isEqual)(newValue,oldValue)||this.applyFilterJson(this.configdbUserFilterJson())}// 'getAvailablePeriods': {
//   handler (newData, oldData) {
//     if (this.reportObj) {
//       let avail = this.getAvailablePeriods
//       let selected = avail.find(a => a.value === this.reportObj.dateRange.period && a.enable)
//       if (!selected) {
//         let filterName = this.reportObj ? this.reportObj.dateRange.rangeType : ''
//         let filtered = avail.filter(a => a.enable)
//         let defaultPeriod =  (filtered && filtered.length) ? filtered[0].value : this.reportObj.dateRange.period
//         if (filterName === 'week' || filterName === 'W') {
//           defaultPeriod = 12
//         }
//         else if (filterName === 'month' || filterName === 'M') {
//           defaultPeriod = 12
//         }
//         else if (filterName === 'year' || filterName === 'Y') {
//           defaultPeriod = 10
//         }
//         this.reportObj.dateRange.period = defaultPeriod
//       }
//     }
//   },
//   immediate: true
// }
},methods:{liveFilterValue:function(value){var filterIds=[],_this$reportObj$param=this.reportObj.params,params=void 0===_this$reportObj$param?{}:_this$reportObj$param,key1="id",key2="name";(0,validation/* isEmpty */.xb)(params.parentId)?(0,validation/* isEmpty */.xb)(params.spaceId)||(filterIds=params.spaceId,"Site"===this.pdfFilter&&(key1="value",key2="label")):filterIds=params.parentId,this.displayName=(value||[]).reduce((function(acc,cur){return filterIds.includes(cur[key1])?[].concat((0,toConsumableArray/* default */.Z)(acc),[cur[key2]]):acc}),[]),this.displayName=this.displayName.join(", ")},initialReportCalled:function(){var _this$resultObj;this.dbFilterJson&&(4===(null===(_this$resultObj=this.resultObj)||void 0===_this$resultObj||null===(_this$resultObj=_this$resultObj.report)||void 0===_this$resultObj?void 0:_this$resultObj.type)?this.initReportTemplateAssetFilter():this.initDbuserFilterJson())},loadAsset:function(assetId){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var _yield$API$fetchRecor,asset;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.next=2,api/* API */.bl.fetchRecord("asset",{id:assetId});case 2:_yield$API$fetchRecor=_context.sent,asset=_yield$API$fetchRecor.asset,asset&&_this.reportTemplate.chooseValues.push({id:asset.id,name:asset.name});case 5:case"end":return _context.stop()}}),_callee)})))()},initReportTemplateAssetFilter:function(){var _this$reportTemplate,filter=this.getReportTemplateJson(this.dbFilterJson);
// this method helps to load template report while mount
null!==(_this$reportTemplate=this.reportTemplate)&&void 0!==_this$reportTemplate&&_this$reportTemplate.parentId&&null!==filter&&void 0!==filter&&filter.assetId&&(this.reportTemplate.parentId=filter.assetId,this.applyFilterCallbackHook=!1,this.prefillAsset(filter),this.applyTemplate())},prefillAsset:function(filter){var _this$reportTemplate2;
// this method will add missing assets
if(null!==(_this$reportTemplate2=this.reportTemplate)&&void 0!==_this$reportTemplate2&&_this$reportTemplate2.buildingId&&(
// removing the building filter becouse we load assets across the portfolio.
this.reportTemplate.buildingId=null),null!==this.reportTemplate.chooseValues){var asset=this.reportTemplate.chooseValues.find((function(rt){return rt.id===filter.assetId}));asset?this.disbaleRPassetChooser=!1:(this.disbaleRPassetChooser=!0,this.loadAsset(filter.assetId))}else this.disbaleRPassetChooser=!0,this.reportTemplate.chooseValues=[],this.loadAsset(filter.assetId)},userFilterLoaded:function(){
// user filter after load hook
},initDbuserFilterJson:function(){var filter=this.prepareUserFilterProps(this.configdbUserFilterJson(),this.reportObj);this.applyFilter(filter)},formatedValue:function(value){var values=[];return value.forEach((function(val){values.push(Number(val))})),values},getReportTemplateJson:function(data){var assetId=null;return(0,validation/* isEmpty */.xb)(data)||(0,validation/* isUndefined */.o8)(data)||Object.keys(data).forEach((function(key){if("asset"===key){var values=data[key].value;values.length&&(assetId=Number(values[0]))}})),{assetId:assetId}},configdbUserFilterJson:function(){var _this2=this,dbFilterJson=this.dbFilterJson,reportTemplateAssetChooser=this.reportTemplateAssetChooser;if(reportTemplateAssetChooser)return this.getReportTemplateJson(dbFilterJson);var filter={siteFilter:[],siteId:null,buildingFilter:[],buildingId:null,categoryFilter:[],assetFilter:[],assetId:null,ttimeFilter:{}};return(0,validation/* isEmpty */.xb)(dbFilterJson)||(0,validation/* isUndefined */.o8)(dbFilterJson)||Object.keys(dbFilterJson).forEach((function(key){if("site"===key){var values=dbFilterJson[key].value;values.length?filter.siteId=Number(values[0]):filter.siteId=null,filter.siteFilter=_this2.formatedValue(values)}else if("asset"===key){var _values=dbFilterJson[key].value;_values.length&&1===_values.length?filter.assetId=Number(_values[0]):_values.length&&_values.length>1&&(filter.assetFilter=_this2.formatedValue(_values))}else if("building"===key){var _values2=dbFilterJson[key].value;_values2.length&&1===_values2.length?filter.buildingId=Number(_values2[0]):_values2.length&&_values2.length>1&&(filter.buildingFilter=_this2.formatedValue(_values2))}else key&&key.startsWith("ttime_")&&(filter.ttimeFilter[key]=dbFilterJson[key])})),filter},applyFilterJson:function(filter){var userFilter=this.$refs["userFilter-".concat(this.config.widget.id)];this.reportTemplateAssetChooser?
// this method helps to load template report while dashboard filter change
filter.assetId&&(this.reportTemplate.parentId=filter.assetId,this.applyTemplate(),this.prefillAsset(filter)):userFilter&&(userFilter.reportFilter=filter,
// userFilter.initProps()
this.$nextTick((function(){userFilter.applyFilter()})))},getQueryStringParams:function(qs){var params={};if(qs){var _step,qsList=qs.split("&"),_iterator=(0,createForOfIteratorHelper/* default */.Z)(qsList);try{for(_iterator.s();!(_step=_iterator.n()).done;){var qsEntry=_step.value,key=qsEntry.split("=")[0],value=qsEntry.split("=")[1];params[key]=value}}catch(err){_iterator.e(err)}finally{_iterator.f()}}return params},setParamsToTemplate:function(){var self=this,reportTemplteParam=JSON.parse(self.reportTemplteParams);if(reportTemplteParam.type&&2===reportTemplteParam.type){var querryCategoryTemplate=reportTemplteParam.categoryTemplate;querryCategoryTemplate&&querryCategoryTemplate.fahu&&querryCategoryTemplate["fahu"]["parentId"]&&(Object.values(self.reportTemplate.categoryTemplate)[0].parentId=querryCategoryTemplate["fahu"]["parentId"]),querryCategoryTemplate&&querryCategoryTemplate.energymeter&&querryCategoryTemplate["energymeter"]["parentId"]&&(Object.values(self.reportTemplate.categoryTemplate)[1].parentId=querryCategoryTemplate["energymeter"]["parentId"])}else self.reportTemplate={},Object.keys(JSON.parse(this.reportTemplteParams)).forEach((function(rt){self.$set(self.reportTemplate,rt,Number(JSON.parse(self.reportTemplteParams)[rt]))}));this.initChart(self.reportTemplate)},applyTemplate:function(val){this.config&&this.config.widget&&this.config.widget.dataOptions&&this.config.widget.dataOptions.reportTemplate&&(this.config.widget.dataOptions.reportTemplate=null),this.config&&this.config.widget&&this.config.widget.dataOptions&&this.config.widget.dataOptions.newReport&&4===this.config.widget.dataOptions.newReport.type&&this.config.widget.dataOptions.newReport.reportTemplate&&(this.config.widget.dataOptions.newReport.reportTemplate=null),this.init(!1)},onPeriodChange:function(){this.initChart()},setDateFilter:function(dateFilter){this.dateFilter=dateFilter,this.userFilterApplied?this.applyFilter(this.userFilterApplied):this.initChart()},init:function(){this.$store.dispatch("loadAlarmSeverity"),this.isLazyDashboard&&!this.isVisibleInViewport||this.initChart()},resize:function(){this.$refs["newChart"]&&this.$refs["newChart"].resize(),this.$refs["heatmap"]&&this.$refs["heatmap"].resize(),this.$refs["treemap"]&&this.$refs["treemap"].resize(),this.$refs["multiChart"]&&this.$refs["multiChart"].resize(),this.$refs["newTable"]&&this.$refs["newTable"].resize()},renderTrendChart:function(){this.$refs["trendChart"]&&this.$refs["trendChart"].resize()},setAppliedFilterInParams:function(filters,params,categoryId){var _filters$siteFilter,_filters$buildingFilt,_filters$categoryFilt,_filters$assetFilter,_filters$assetFilter2;if(filters&&(null!==filters&&void 0!==filters&&filters.siteFilter||null!==filters&&void 0!==filters&&filters.buildingFilter||null!==filters&&void 0!==filters&&filters.categoryFilter||null!==filters&&void 0!==filters&&filters.assetFilter))if(null!==filters&&void 0!==filters&&null!==(_filters$siteFilter=filters.siteFilter)&&void 0!==_filters$siteFilter&&_filters$siteFilter.length||null!==filters&&void 0!==filters&&null!==(_filters$buildingFilt=filters.buildingFilter)&&void 0!==_filters$buildingFilt&&_filters$buildingFilt.length||null!==filters&&void 0!==filters&&null!==(_filters$categoryFilt=filters.categoryFilter)&&void 0!==_filters$categoryFilt&&_filters$categoryFilt.length||null!==filters&&void 0!==filters&&null!==(_filters$assetFilter=filters.assetFilter)&&void 0!==_filters$assetFilter&&_filters$assetFilter.length||(params.xCriteriaMode=2),null!==filters&&void 0!==filters&&null!==(_filters$assetFilter2=filters.assetFilter)&&void 0!==_filters$assetFilter2&&_filters$assetFilter2.length)params.xCriteriaMode=3,params.parentId=filters.assetFilter;else{var _filters$buildingFilt2,spaceFilter=null!==filters&&void 0!==filters&&null!==(_filters$buildingFilt2=filters.buildingFilter)&&void 0!==_filters$buildingFilt2&&_filters$buildingFilt2.length?filters.buildingFilter:filters.siteFilter;params.xCriteriaMode=4,params.spaceId=spaceFilter,params.assetCategory=filters.categoryFilter.length?filters.categoryFilter:categoryId,params.spaceId&&params.spaceId.length||(params.xCriteriaMode=2)}null!==filters&&void 0!==filters&&filters.ttimeFilter&&(params.ttimeFilter=JSON.stringify(filters.ttimeFilter))},formTTimeFilter:function(dbFilterJson){var formTTimeFilerObj={};if(dbFilterJson){var keys=Object.keys(dbFilterJson);if(keys.forEach((function(key,index){key&&key.startsWith("ttime_")&&(formTTimeFilerObj[key]=dbFilterJson[key])})),!(0,validation/* isEmpty */.xb)(formTTimeFilerObj))return formTTimeFilerObj}return null},initChart:function(reportTempl){var _this3=this,self=this,templateJson=this.templateJson;self.loading=!0,self.failed=!1,this.$nextTick((function(){var _JSON$parse2,_this3$appliedDateRan,_this3$appliedDateRan2,params={newFormat:!0};if(_this3.config&&_this3.config.widget&&_this3.config.widget.dataOptions&&_this3.config.widget.dataOptions.reportTemplate){var reportTemplate=null;if("string"===typeof _this3.config.widget.dataOptions.reportTemplate)try{reportTemplate=JSON.parse(_this3.config.widget.dataOptions.reportTemplate)}catch(e){}else reportTemplate=JSON.parse(JSON.stringify(_this3.config.widget.dataOptions.reportTemplate));reportTemplate&&reportTemplate.parentId&&reportTemplate.chooseValues&&0===reportTemplate.chooseValues.length&&(self.reportTemplate=JSON.parse(JSON.stringify(reportTemplate)))}else if(_this3.config&&_this3.config.widget&&_this3.config.widget.dataOptions&&_this3.config.widget.dataOptions.newReport&&4===_this3.config.widget.dataOptions.newReport.type&&_this3.config.widget.dataOptions.newReport.reportTemplate){var _reportTemplate=JSON.parse(JSON.stringify(_this3.config.widget.dataOptions.newReport.reportTemplate));_reportTemplate.parentId&&_reportTemplate.chooseValues&&0===_reportTemplate.chooseValues.length&&(self.reportTemplate=_reportTemplate)}(_this3.isWidget&&_this3.reportObj&&(params.showAlarms=_this3.reportObj.options.settings.alarm,params.showSafeLimit=_this3.reportObj.options.settings.safelimit),_this3.reportObj=null,_this3.appliedDateRange)?(params.startTime=null===(_this3$appliedDateRan=_this3.appliedDateRange)||void 0===_this3$appliedDateRan?void 0:_this3$appliedDateRan.startTime,params.endTime=null===(_this3$appliedDateRan2=_this3.appliedDateRange)||void 0===_this3$appliedDateRan2?void 0:_this3$appliedDateRan2.endTime):self.dateFilter&&self.dateFilter.value&&(params.startTime=self.dateFilter.value[0],params.endTime=self.dateFilter.value[1]);_this3.isSiteFilterApplied_toExport&&(params.spaceId_forExport=_this3.isSiteFilterApplied_toExport,params.filterModeValue_toExport=_this3.isSiteFilterMode_toExport),null!==self.period&&(params.xAggr=self.period);var appliedAssetFilter={};if(_this3.filter&&_this3.filter.siteFilter){var categoryId=[];self.setAppliedFilterInParams(_this3.filter,params,categoryId),null!==params&&void 0!==params&&params.parentId&&(appliedAssetFilter.parentId=params.parentId)}if(null!==_this3&&void 0!==_this3&&_this3.dbFilterJson&&Object.keys(_this3.dbFilterJson).length>0){var tTimeFilterVal=_this3.formTTimeFilter(_this3.dbFilterJson);tTimeFilterVal&&(params.ttimeFilter=JSON.stringify(tTimeFilterVal))}var url="/v3/report/reading/view?reportId="+_this3.reportId,unsavedReport=_this3.$getProperty(_this3,"$route.query.unsavedReport")||null;if(JSON.parse(unsavedReport)){url="/v3/report/reading/view",params["unsavedReport"]=!0;var reportDataId=_this3.$getProperty(_this3,"$route.query.reportDataId")||null;params["reportDataId"]=reportDataId}if(templateJson)url=url+"&templateString="+encodeURIComponent(JSON.stringify(templateJson)),null!==templateJson&&void 0!==templateJson&&templateJson.parentId&&(appliedAssetFilter.parentId=templateJson.parentId);else if(reportTempl)reportTempl.chooseValues=[],url=url+"&templateString="+encodeURIComponent(JSON.stringify(reportTempl)),null!==reportTempl&&void 0!==reportTempl&&reportTempl.parentId&&(appliedAssetFilter.parentId=reportTempl.parentId);else if(self.reportTemplate){if(2!==self.reportTemplate.templateType){var template=JSON.parse(JSON.stringify(self.reportTemplate));template.chooseValues=[],url=url+"&templateString="+encodeURIComponent(JSON.stringify(template)),null!==template&&void 0!==template&&template.parentId&&(appliedAssetFilter.parentId=template.parentId)}}else if(_this3.appliedReportTemplate){var _template=JSON.parse(_this3.appliedReportTemplate);_template.chooseValues=[],url=url+"&templateString="+encodeURIComponent(JSON.stringify(_template)),null!==_template&&void 0!==_template&&_template.parentId&&(appliedAssetFilter.parentId=_template.parentId)}var _this3$$route$query$f=_this3.$route.query.filters,filters=void 0===_this3$$route$query$f?{}:_this3$$route$query$f,filterObj=(0,validation/* isEmpty */.xb)(filters)?{}:null!==(_JSON$parse2=JSON.parse(filters))&&void 0!==_JSON$parse2?_JSON$parse2:{};(0,validation/* isEmpty */.xb)(filterObj)||(_this3.isFilterApplied=!0,params.xCriteriaMode=filterObj.xCriteriaMode,(0,validation/* isEmpty */.xb)(filterObj.spaceId)||(params.spaceId=filterObj.spaceId),(0,validation/* isEmpty */.xb)(filterObj.parentId)||(params.parentId=filterObj.parentId)),api/* API */.bl.put(url,params).then((function(response){if(response.error)self.$message.error("Error while fetching report data"),self.loading=!1,self.failed=!0;else{var _Object$keys,_self$reportObj,_self$appliedDateRang,_self$appliedDateRang2,result=response.data;if(!self.dateFilter)if(self.appliedDateRange)null!==(_self$appliedDateRang=self.appliedDateRange)&&void 0!==_self$appliedDateRang&&_self$appliedDateRang.startTime&&null!==(_self$appliedDateRang2=self.appliedDateRange)&&void 0!==_self$appliedDateRang2&&_self$appliedDateRang2.endTime?self.dateFilter=NewDateHelper/* default */.Z.getDatePickerObject(self.appliedDateRange.operatorId,self.appliedDateRange.startTime+","+self.appliedDateRange.endTime):self.dateFilter=NewDateHelper/* default */.Z.getDatePickerObject(self.appliedDateRange.operatorId,self.appliedDateRange.value);else self.dateFilter=NewDateHelper/* default */.Z.getDatePickerObject(result.report.dateOperator,result.report.dateValue);if(result.xAggr=response.data.report.xAggr,result&&result.report&&result.report.reportState&&result.report.reportState.hmAggr&&(result.report.hmAggr=result.report.reportState.hmAggr),result.dateRange=self.dateFilter,self.period=response.data.report.xAggr,result&&result.report&&8===result.report.analyticsType&&result.report.reportState&&result.report.reportState.scatterConfig){self.trendresultObj=deepmerge/* default */.Z.objectAssignDeep({},result),self.trendresultObj.report.chartState=null,self.prepareTrendReportObj(self.trendresultObj,params);var savedconfig=JSON.parse(result.report.reportState.scatterConfig);result.scatterConfig=savedconfig.datapoints}result.report.reportState&&null!==result.report.reportState.regressionConfig&&result.report.reportState.regressionType&&result.report.reportState.regressionConfig&&"multiple"!==result.report.reportState.regressionType&&(result.regression=!0,result.regressionType=result.report.reportState.regressionType,result.regressionConfig=result.report.reportState.regressionConfig);var _step2,_iterator2=(0,createForOfIteratorHelper/* default */.Z)(result.report.dataPoints);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var dp=_step2.value;if(!0===dp.xDataPoint){result["Readingdp"]=dp;break}}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}if(result.report.trendLineDataPoints&&(self.getTrendLineEquation(result),result.report.dataPoints=result.report.dataPoints.concat(result.report.trendLineDataPoints)),result.report.chartState){var chartStateObject=JSON.parse(result.report.chartState);if(11===chartStateObject.common.mode){var x=result.report.dataPoints[0].yAxis,y=result.report.dataPoints[0].xAxis;result.report.dataPoints[0].yAxis=y,result.report.dataPoints[0].xAxis=x}}if((null===(_Object$keys=Object.keys(appliedAssetFilter))||void 0===_Object$keys?void 0:_Object$keys.length)>0){var _this3$reportTemplate,assets=null===(_this3$reportTemplate=_this3.reportTemplate)||void 0===_this3$reportTemplate?void 0:_this3$reportTemplate.chooseValues;for(var aId in assets)assets[aId].id===appliedAssetFilter.parentId&&(appliedAssetFilter.name=assets[aId].name);result.appliedAssetFilter=appliedAssetFilter}if(self.reportObj=self.prepareReport(result,params),self.reportObj.alarms=self.prepareBooleanReport(result.reportData.aggr),"table"===(null===(_self$reportObj=self.reportObj)||void 0===_self$reportObj||null===(_self$reportObj=_self$reportObj.options)||void 0===_self$reportObj?void 0:_self$reportObj.type)&&_this3.$emit("hideChart"),4===result.report.type&&(null===self.reportTemplate&&(self.reportTemplate=JSON.parse(JSON.stringify(result.report.reportTemplate))),null===self.reportTemplate.parentId&&self.reportTemplate.defaultValue&&(self.reportTemplate.parentId=self.reportTemplate.defaultValue),0===self.reportTemplate.chooseValues.length&&(!0===self.reportTemplate.isVisibleInDashBoard||null===self.reportTemplate.isVisibleInDashBoard))){var _filters=self.getFiltersFromCriteria(self.reportTemplate);self.loadReportTemplateValues(self.reportTemplate,_filters)}if(self.reportTemplate&&result&&result.report&&4===result.report.type){var _template2=JSON.parse(JSON.stringify(self.reportTemplate));_template2.chooseValues=[],result.report.currentTemplate=_template2}result.report.reportState&&null!==result.report.reportState.regressionConfig&&result.report.reportState.regressionType&&result.report.reportState.regressionConfig&&"multiple"===result.report.reportState.regressionType&&(result.regression=!0,result.regressionType=result.report.reportState.regressionType,result.regressionConfig=result.report.reportState.regressionConfig),self.reportObj&&self.reportObj.options.mode&&(result.mode=self.reportObj.options.mode),self.resultObj=result,_this3.pdfloading=!0,self.appliedChartType&&self.reportObj&&(
// TODO remove
self.reportObj.options.type=self.appliedChartType),self.reportObj.params=params,self.$emit("reportLoaded",self.reportObj,self.resultObj),params&&params.spaceId_forExport&&(self.filter=self.prepareUserFilterProps(self.configdbUserFilterJson(),self.reportObj),self.filter.siteFilter=[Number(params.spaceId_forExport)]),self.$nextTick((function(){self.applyFilterCallbackHook&&self.dbFilterJson&&_this3.isOnlyTTimeFilter(self.dbFilterJson)&&self.initialReportCalled()})),self.loading=!1}})).catch((function(error){error&&(self.loading=!1,self.failed=!0)}))}))},loadInitialAssetName:function(reportTemplate){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var response;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,_this4.$http.get("/asset/summary/"+reportTemplate.parentId);case 2:response=_context2.sent,response&&_this4.$set(reportTemplate,"name",response.data.asset.name);case 4:case"end":return _context2.stop()}}),_callee2)})))()},isOnlyTTimeFilter:function(dbFilterJson){if(dbFilterJson){var flag=!1,keys=Object.keys(dbFilterJson);return keys.forEach((function(key,index){key&&!key.startsWith("ttime_")&&(flag=!0)})),flag}},applyTTimeFilter:function(filterObj){null!==filterObj&&void 0!==filterObj&&filterObj.isTTimeFilter&&this.applyFilter(filterObj.filters,filterObj.isTTimeFilter)},applyFilter:function(filters,isTTimeFilter){var _self$resultObj,_filters$siteFilter2,_filters$assetFilter3,_filters$categoryFilt2,_filters$buildingFilt3,params={newFormat:!0};if(isTTimeFilter){var tTimeFilterVal=this.formTTimeFilter(filters);tTimeFilterVal&&(params.ttimeFilter=JSON.stringify(tTimeFilterVal),filters.ttimeFilter=tTimeFilterVal)}this.filter=filters;var self=this;self.loading=!0,self.failed=!1;var _self$resultObj2,reportContext=null;(self.resultObj&&self.resultObj.report&&self.resultObj.report.id&&-1!=self.resultObj.report.id&&(reportContext=self.resultObj.report),params.mode=this.resultObj.mode,null!==(_self$resultObj=self.resultObj)&&void 0!==_self$resultObj&&null!==(_self$resultObj=_self$resultObj.report)&&void 0!==_self$resultObj&&_self$resultObj.analyticsType)&&(params.analyticsType=null===(_self$resultObj2=self.resultObj)||void 0===_self$resultObj2||null===(_self$resultObj2=_self$resultObj2.report)||void 0===_self$resultObj2?void 0:_self$resultObj2.analyticsType);var chartStateObject,sortField,limit,orderByFunc,chartState=self.resultObj.report.chartState,tabularState=self.resultObj.report.tabularState;self.reportObj&&self.reportObj.options&&self.reportObj.options.common&&self.reportObj.options.common.sorting?(self.reportObj.options.common.sorting.sortByField&&(sortField=self.reportObj.options.common.sorting.sortByField),self.reportObj.options.common.sorting.limit&&(limit=self.reportObj.options.common.sorting.limit,orderByFunc=self.reportObj.options.common.sorting.orderByFunc)):chartState&&(chartStateObject=JSON.parse(chartState),chartStateObject&&chartStateObject.options&&chartStateObject.options.common&&chartStateObject.options.common.sorting&&(chartStateObject.options.common.sorting.sortByField&&(sortField=chartStateObject.options.common.sorting.sortByField),chartStateObject.options.common.sorting.limit&&(limit=chartStateObject.options.common.sorting.limit,orderByFunc=chartStateObject.options.common.sorting.orderByFunc))),[1,2,3,4].includes(params.mode)&&(params.xAggr=this.resultObj.report.xAggr),this.appliedDateRange?(params.startTime=this.appliedDateRange.startTime,params.endTime=this.appliedDateRange.endTime):self.dateFilter&&self.dateFilter.value&&(params.startTime=self.dateFilter.value[0],params.endTime=self.dateFilter.value[1]);var _step3,fields=[],categoryId=[],_iterator3=(0,createForOfIteratorHelper/* default */.Z)(this.resultObj.report.dataPoints);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var dp=_step3.value;dp.metaData&&dp.metaData.categoryId&&-1===categoryId.indexOf(dp.metaData.categoryId)&&categoryId.push(dp.metaData.categoryId);var dataField={parentId:null,name:dp.name,metaData:dp.metaData,yAxis:{fieldId:dp.yAxis.fieldId,aggr:dp.yAxis.aggr,label:dp.name,dataType:dp.yAxis.dataType,unitStr:dp.yAxis.unitStr},aliases:dp.aliases,type:dp.type>0?dp.type:1,transformWorkflow:dp.transformWorkflow,rule_aggr_type:null===dp||void 0===dp?void 0:dp.rule_aggr_type};sortField&&sortField===dp.yAxis.fieldId&&(dataField.orderByFunc=orderByFunc,dataField.limit=limit),fields.push(dataField)}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}if(params.fields=JSON.stringify(fields),this.resultObj.report.baseLines&&this.resultObj.report.baseLines.length){var _step4,baseLines=[],_iterator4=(0,createForOfIteratorHelper/* default */.Z)(this.resultObj.report.baseLines);try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var bl=_step4.value;baseLines.push({baseLineId:bl.baseLineId,adjustType:bl.adjustType})}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}params.baseLines=JSON.stringify(baseLines)}filters&&!isTTimeFilter&&self.setAppliedFilterInParams(filters,params,categoryId),!isTTimeFilter&&filters&&(null!==filters&&void 0!==filters&&null!==(_filters$siteFilter2=filters.siteFilter)&&void 0!==_filters$siteFilter2&&_filters$siteFilter2.length||null!==filters&&void 0!==filters&&null!==(_filters$assetFilter3=filters.assetFilter)&&void 0!==_filters$assetFilter3&&_filters$assetFilter3.length||null!==filters&&void 0!==filters&&null!==(_filters$categoryFilt2=filters.categoryFilter)&&void 0!==_filters$categoryFilt2&&_filters$categoryFilt2.length||null!==filters&&void 0!==filters&&null!==(_filters$buildingFilt3=filters.buildingFilter)&&void 0!==_filters$buildingFilt3&&_filters$buildingFilt3.length)||(params.xCriteriaMode=6),self.$http.post("/v2/report/readingReport",params).then((function(response){var _result$report,result=response.data.result;result.xAggr=params.xAggr,result.mode=params.mode,result.report.analyticsType=(null===(_result$report=result.report)||void 0===_result$report?void 0:_result$report.analyticsType)>0?result.report.analyticsType:1,result.dateRange=self.dateFilter,result.report.chartState=chartState,result.report.tabularState=tabularState,self.reportObj=self.prepareReport(result),reportContext&&(result.report.id=reportContext.id,result.report.name=reportContext.name),self.resultObj=result,self.reportObj.params=params,self.$emit("reportLoaded",self.reportObj,self.resultObj),self.loading=!1,self.userFilterApplied=filters})).catch((function(error){self.userFilterApplied=filters,error&&(self.loading=!1,self.failed=!0)}))},onSettingsChange:function(changedOption){"alarm"===changedOption?this.reportObj.alarms&&this.reportObj.alarms.regions.length||!this.reportObj||!this.reportObj.options.settings.alarm||this.initChart():"safelimit"===changedOption&&this.reportObj&&!this.reportObj.options.safeLimit.length&&this.reportObj.options.settings.safelimit&&this.initChart()},getTrendLineEquation:function(result){var self=this,trendLineProp=result.reportData.trendLineProp,chartStateObject=JSON.parse(result.report.chartState),trendlineObj=chartStateObject.trendLine,decimalCount=trendlineObj.decimal,_loop=function(alias){var coef=trendLineProp[alias].coef;coef.forEach((function(data,index){coef[index]=self.showDecimal(data,decimalCount)+(0!==index?"x^"+index:"")})),coef.reverse(),coef=coef.join(" + ");var dataPoint=result.report.trendLineDataPoints.filter((function(dataPoint){return dataPoint.aliases.actual===alias}));dataPoint[0].name=coef,trendlineObj&&trendlineObj.showr2&&(dataPoint[0].name="R^2 = "+self.showDecimal(trendLineProp[dataPoint[0].aliases.actual].rSquare,decimalCount)+"; "+dataPoint[0].name)};for(var alias in trendLineProp)_loop(alias)},showDecimal:function(data,decimalCount){var splitData=data.split(".");return splitData[1]?splitData[0]+"."+splitData[1].slice(0,decimalCount):data},prepareTrendReportObj:function(result,params){var reportObj=this.prepareReport(result,params);reportObj.alarms=this.prepareBooleanReport(result.reportData.aggr),result.report.reportState&&null!==result.report.reportState.regressionConfig&&result.report.reportState.regressionType&&result.report.reportState.regressionConfig&&"multiple"===result.report.reportState.regressionType&&(result.regression=!0,result.regressionType=result.report.reportState.regressionType,result.regressionConfig=result.report.reportState.regressionConfig),this.reportObj&&this.reportObj.options.mode&&(result.mode=this.reportObj.options.mode),this.trendresultObj=result,this.trendreportObj=reportObj}}},components_FNewReportvue_type_script_lang_js=FNewReportvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FNewReportvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FNewReport=component.exports},
/***/405977:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FUserFilters}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/report/components/FUserFilters.vue?vue&type=template&id=6a598222
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"row report-user-filters"},[_c("div",{staticClass:"col-12"},[_c("div",["site"===_vm.liveFilterField&&"multi"===_vm.liveFilterType?_c("el-select",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"report-userfilter-select",attrs:{clearable:"",multiple:"","collapse-tags":"",placeholder:"All Sites",size:"mini"},on:{change:_vm.applyFilter},model:{value:_vm.reportFilter.siteFilter,callback:function($$v){_vm.$set(_vm.reportFilter,"siteFilter",$$v)},expression:"reportFilter.siteFilter"}},_vm._l(_vm.filterData,(function(d,index){return _c("el-option",{key:index,attrs:{label:d.label,value:d.value}})})),1):_vm._e(),"site"===_vm.liveFilterField&&"single"===_vm.liveFilterType?_c("el-select",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"report-userfilter-select",attrs:{clearable:"","collapse-tags":"",placeholder:"All Sites",size:"mini"},on:{change:_vm.applyFilter},model:{value:_vm.reportFilter.siteId,callback:function($$v){_vm.$set(_vm.reportFilter,"siteId",$$v)},expression:"reportFilter.siteId"}},_vm._l(_vm.filterData,(function(d,index){return _c("el-option",{key:index,attrs:{label:d.label,value:d.value}})})),1):_vm._e(),"building"===_vm.liveFilterField&&"multi"===_vm.liveFilterType?_c("el-select",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"report-userfilter-select",attrs:{clearable:"",multiple:"","collapse-tags":"",placeholder:"All Buildings",size:"mini"},on:{change:_vm.applyFilter},model:{value:_vm.reportFilter.buildingFilter,callback:function($$v){_vm.$set(_vm.reportFilter,"buildingFilter",$$v)},expression:"reportFilter.buildingFilter"}},_vm._l(_vm.filterData,(function(d,index){return _c("el-option",{key:index,attrs:{label:d.name,value:d.id}})})),1):_vm._e(),"building"===_vm.liveFilterField&&"single"===_vm.liveFilterType?_c("el-select",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"report-userfilter-select",attrs:{clearable:"","collapse-tags":"",placeholder:"All Buildings",size:"mini"},on:{change:_vm.applyFilter},model:{value:_vm.reportFilter.buildingId,callback:function($$v){_vm.$set(_vm.reportFilter,"buildingId",$$v)},expression:"reportFilter.buildingId"}},_vm._l(_vm.filterData,(function(d,index){return _c("el-option",{key:index,attrs:{label:d.name,value:d.id}})})),1):_vm._e(),"asset"===_vm.liveFilterField&&"multi"===_vm.liveFilterType?_c("el-select",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"report-userfilter-select",attrs:{clearable:"",multiple:"","collapse-tags":"",placeholder:"All Assets",size:"mini"},on:{change:_vm.applyFilter},model:{value:_vm.reportFilter.assetFilter,callback:function($$v){_vm.$set(_vm.reportFilter,"assetFilter",$$v)},expression:"reportFilter.assetFilter"}},_vm._l(_vm.filterData,(function(d,index){return _c("el-option",{key:index,attrs:{label:d.name,value:d.id}})})),1):_vm._e(),"asset"===_vm.liveFilterField&&"single"===_vm.liveFilterType?_c("el-select",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"report-userfilter-select",attrs:{clearable:"","collapse-tags":"",placeholder:"All Assets",size:"mini"},on:{change:_vm.applyFilter},model:{value:_vm.reportFilter.assetId,callback:function($$v){_vm.$set(_vm.reportFilter,"assetId",$$v)},expression:"reportFilter.assetId"}},_vm._l(_vm.filterData,(function(d,index){return _c("el-option",{key:index,attrs:{label:d.name,value:d.id}})})),1):_vm._e()],1)])])},staticRenderFns=[],createForOfIteratorHelper=__webpack_require__(566347),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),clone=(__webpack_require__(260228),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(670560),__webpack_require__(538077),__webpack_require__(648324),__webpack_require__(947522),__webpack_require__(879288),__webpack_require__(169358),__webpack_require__(766678)),clone_default=__webpack_require__.n(clone),NewDataFormatHelper=__webpack_require__(804911),api=__webpack_require__(32284),cloneDeep=__webpack_require__(150361),cloneDeep_default=__webpack_require__.n(cloneDeep),FUserFiltersvue_type_script_lang_js={props:["report","filters"],mixins:[NewDataFormatHelper/* default */.Z],data:function(){return{reportFilter:{siteFilter:[],siteId:null,buildingFilter:[],buildingId:null,categoryFilter:[],assetFilter:[],assetId:null},filterData:[],readings:null,sites:[],buildings:[],urlParams:{perPage:50,page:1,viewName:"hidden-all"}}},computed:{liveFilterField:function(){var _this$report;return this.report&&null!==this&&void 0!==this&&null!==(_this$report=this.report)&&void 0!==_this$report&&null!==(_this$report=_this$report.options)&&void 0!==_this$report&&null!==(_this$report=_this$report.common)&&void 0!==_this$report&&null!==(_this$report=_this$report.filters)&&void 0!==_this$report&&null!==(_this$report=_this$report.filterState)&&void 0!==_this$report&&_this$report.liveFilterField?this.report.options.common.filters.filterState.liveFilterField:null},liveFilterType:function(){var _this$report2;return this.report&&null!==this&&void 0!==this&&null!==(_this$report2=this.report)&&void 0!==_this$report2&&null!==(_this$report2=_this$report2.options)&&void 0!==_this$report2&&null!==(_this$report2=_this$report2.common)&&void 0!==_this$report2&&null!==(_this$report2=_this$report2.filters)&&void 0!==_this$report2&&null!==(_this$report2=_this$report2.filterState)&&void 0!==_this$report2&&_this$report2.liveFilterType?this.report.options.common.filters.filterState.liveFilterType:null}},created:function(){var _this=this;Promise.all([this.loadDefaultSites(),this.loadDefaultBuilding()]).then((function(){return _this.loadFilterData()})).then((function(){_this.initProps()}))},mounted:function(){},methods:{loadDefaultBuilding:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var _yield$API$get,data,error,_this2$buildings,params,_yield$API$get2,_data,_error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.next=2,api/* API */.bl.get("/v3/picklist/building",_this2.urlParams);case 2:if(_yield$API$get=_context.sent,data=_yield$API$get.data,error=_yield$API$get.error,error||!((null===data||void 0===data?void 0:data.pickList.length)>0)){_context.next=16;break}if(_this2.buildings=data.pickList,50!=(null===(_this2$buildings=_this2.buildings)||void 0===_this2$buildings?void 0:_this2$buildings.length)){_context.next=16;break}return params=cloneDeep_default()(_this2.urlParams),params.page=2,_context.next=12,api/* API */.bl.get("/v3/picklist/building",params);case 12:_yield$API$get2=_context.sent,_data=_yield$API$get2.data,_error=_yield$API$get2.error,!_error&&(null===_data||void 0===_data?void 0:_data.pickList.length)>0&&Array.prototype.push.apply(_this2.buildings,_data.pickList);case 16:case"end":return _context.stop()}}),_callee)})))()},loadDefaultSites:function(){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var _yield$API$get3,data,error,_this3$sites,params,_yield$API$get4,_data2,_error2;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,api/* API */.bl.get("/v3/picklist/site",_this3.urlParams);case 2:if(_yield$API$get3=_context2.sent,data=_yield$API$get3.data,error=_yield$API$get3.error,error||!((null===data||void 0===data?void 0:data.pickList.length)>0)){_context2.next=16;break}if(_this3.sites=data.pickList,50!=(null===(_this3$sites=_this3.sites)||void 0===_this3$sites?void 0:_this3$sites.length)){_context2.next=16;break}return params=cloneDeep_default()(_this3.urlParams),params.page=2,_context2.next=12,api/* API */.bl.get("/v3/picklist/site",params);case 12:_yield$API$get4=_context2.sent,_data2=_yield$API$get4.data,_error2=_yield$API$get4.error,!_error2&&(null===_data2||void 0===_data2?void 0:_data2.pickList.length)>0&&Array.prototype.push.apply(_this3.sites,_data2.pickList);case 16:case"end":return _context2.stop()}}),_callee2)})))()},loadFilterData:function(){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var sites,buildingList,buildings,self,assets,_data$pickList,selected_assets,_iterator,_step,aId,filters,params,_yield$API$get5,data,error,_yield$API$get6,_data3,_error3,assetList,assets_with_category,_iterator2,_step2,category_id,asset_id,_aId;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:if("site"!==_this4.liveFilterField){_context3.next=5;break}sites=clone_default()(_this4.sites)||[],_this4.report.options.common.filters.filterState&&_this4.report.options.common.filters.filterState.siteFilter&&_this4.report.options.common.filters.filterState.siteFilter.length?_this4.filterData=sites.filter((function(st){return _this4.report.options.common.filters.filterState.siteFilter.indexOf(st.value)>=0})):_this4.filterData=sites,_context3.next=36;break;case 5:if("building"!==_this4.liveFilterField){_context3.next=12;break}buildingList=clone_default()(_this4.buildings)||[],buildings=[],_this4.report.options.common.filters.filterState&&_this4.report.options.common.filters.filterState.buildingFilter&&_this4.report.options.common.filters.filterState.buildingFilter.length?_this4.filterData=buildingList.filter((function(building){_this4.report.options.common.filters.filterState.buildingFilter.indexOf(building.value)&&buildings.push({id:building.value,name:building.label})})):buildingList.filter((function(building){buildings.push({id:building.value,name:building.label})})),_this4.filterData=buildings,_context3.next=36;break;case 12:if("asset"!==_this4.liveFilterField){_context3.next=36;break}if(_this4.readings){_context3.next=36;break}if(self=_this4,assets=[],!(self.report.options.common.filters.filterState&&self.report.options.common.filters.filterState.assetFilter&&self.report.options.common.filters.filterState.assetFilter.length)){_context3.next=30;break}selected_assets=[],_iterator=(0,createForOfIteratorHelper/* default */.Z)(self.report.options.common.filters.filterState.assetFilter);try{for(_iterator.s();!(_step=_iterator.n()).done;)aId=_step.value,aId>0&&selected_assets.push(aId+"")}catch(err){_iterator.e(err)}finally{_iterator.f()}return filters=JSON.stringify({id:{operatorId:36,value:selected_assets}}),params={filters:filters},_context3.next=24,api/* API */.bl.get("/v3/picklist/asset",params);case 24:_yield$API$get5=_context3.sent,data=_yield$API$get5.data,error=_yield$API$get5.error,!error&&(null===data||void 0===data||null===(_data$pickList=data.pickList)||void 0===_data$pickList?void 0:_data$pickList.length)>0&&(data.pickList.forEach((function(element){assets.push({id:element.value,name:element.label})})),self.filterData=assets),_context3.next=36;break;case 30:return _context3.next=32,api/* API */.bl.get("/asset/getreadings");case 32:if(_yield$API$get6=_context3.sent,_data3=_yield$API$get6.data,_error3=_yield$API$get6.error,!_error3&&_data3){if(assetList=_data3.assets,self.report.options.common.filters.filterState&&self.report.options.common.filters.filterState.categoryFilter&&self.report.options.common.filters.filterState.categoryFilter.length){assets_with_category=_data3.categoryWithAssets,_iterator2=(0,createForOfIteratorHelper/* default */.Z)(self.report.options.common.filters.filterState.categoryFilter);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;)if(category_id=_step2.value,assets_with_category&&assets_with_category[category_id])for(asset_id in assets_with_category[category_id])assetList&&assetList[asset_id+""]&&assets.push({id:Number(asset_id),name:assetList[asset_id+""]})}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}else for(_aId in assetList)assets.push({id:Number(_aId),name:assetList[_aId+""]});self.filterData=assets}case 36:_this4.$emit("filterData",_this4.filterData);case 37:case"end":return _context3.stop()}}),_callee3)})))()},initProps:function(){var _this$filters;this.filters&&Object.keys(this.filters).length&&("single"==this.liveFilterType?(this.reportFilter.assetId=this.filters.assetFilter.length?this.filters.assetFilter[0]:null,this.reportFilter.buildingId=this.filters.buildingFilter.length?this.filters.buildingFilter[0]:null,this.reportFilter.siteId=this.filters.siteFilter.length?this.filters.siteFilter[0]:null):(this.reportFilter.assetFilter=this.filters.assetFilter.length?this.filters.assetFilter:[],this.reportFilter.buildingFilter=this.filters.buildingFilter.length?this.filters.buildingFilter:[],this.reportFilter.siteFilter=this.filters.siteFilter.length?this.filters.siteFilter:[]),null!==(_this$filters=this.filters)&&void 0!==_this$filters&&_this$filters.ttimeFilter&&Object.keys(this.filters.ttimeFilter).length>0&&(this.reportFilter.ttimeFilter=this.filters.ttimeFilter));this.$emit("userFilterLoaded")},applyFilter:function(){"site"===this.liveFilterField?"single"===this.liveFilterType&&(this.reportFilter.siteId?this.reportFilter.siteFilter=[this.reportFilter.siteId]:this.reportFilter.siteFilter=[]):"building"===this.liveFilterField?"single"===this.liveFilterType&&(this.reportFilter.buildingId?this.reportFilter.buildingFilter=[this.reportFilter.buildingId]:this.reportFilter.buildingFilter=[]):"asset"===this.liveFilterField&&"single"===this.liveFilterType&&(this.reportFilter.assetId?this.reportFilter.assetFilter=[this.reportFilter.assetId]:this.reportFilter.assetFilter=[]);var filters=this.prepareUserFilterProps(this.reportFilter,this.report,!0);this.$emit("applyFilter",filters)}}},components_FUserFiltersvue_type_script_lang_js=FUserFiltersvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FUserFiltersvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FUserFilters=component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/62423.js.map