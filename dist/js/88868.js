(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[88868],{
/***/919324:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return CodeMirror}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/CodeMirror.vue?vue&type=template&id=f33b888a
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("codemirror",{attrs:{options:_vm.cmOption,placeholder:_vm.placeholder},on:{input:_vm.onCmCodeChange,ready:_vm.onCmReady,focus:_vm.onCmFocus},model:{value:_vm.script,callback:function($$v){_vm.script=$$v},expression:"script"}})],1)},staticRenderFns=[],vue_codemirror=__webpack_require__(375055),CodeMirrorvue_type_script_lang_js=(__webpack_require__(304631),__webpack_require__(471707),__webpack_require__(959372),__webpack_require__(620017),__webpack_require__(796876),__webpack_require__(988386),{data:function(){return{script:null,cmOption:{tabSize:4,styleActiveLine:!0,mode:"text/javascript",theme:"default",lineNumbers:!0,line:!0,matchBrackets:!0,foldGutter:!0,placeholder:!1,hintOptions:{completeSingle:!1},showCursorWhenSelecting:!0}}},props:["value","options","placeholder"],components:{codemirror:vue_codemirror.codemirror},computed:{codemirror:function(){return this.$refs.myCm.codemirror}},watch:{value:{handler:function(){this.script=this.$helpers.cloneObject(this.value),this.options&&Object.assign(this.cmOption,this.options)},immediate:!0}},methods:{onCmReady:function(cm){},onCmFocus:function(cm){},onCmCodeChange:function(newCode){this.$emit("input",newCode)},addCode:function(code){this.script=this.script+="\n"+code+"\n"},onCmScroll:function(){}}}),components_CodeMirrorvue_type_script_lang_js=CodeMirrorvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_CodeMirrorvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,CodeMirror=component.exports},
/***/507008:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FPopover}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/FPopover.vue?vue&type=template&id=878762a4
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-popover",{ref:_vm.getRef,attrs:{"popper-class":"f-popover",width:_vm.width||""===_vm.width?_vm.width:280,placement:_vm.placement,trigger:_vm.trigger||"click",hide:"hide"},on:{show:function(){return _vm.$emit("show")}},model:{value:_vm.showpopover,callback:function($$v){_vm.showpopover=$$v},expression:"showpopover"}},[_c("div",{staticClass:"fc-popover-content"},[_vm._t("header",(function(){return[_c("div",{staticClass:"title uppercase f12 bold",staticStyle:{"letter-spacing":"1.1px",color:"#000000"}},[_vm._v(" "+_vm._s(_vm.title)+" ")])]})),_c("div",[_vm._t("content")],2)],2),_c("div",{staticClass:"f-footer row",staticStyle:{height:"46px"}},[_vm._t("footer",(function(){return[_c("button",{staticClass:"footer-btn footer-btn-secondary col-6",attrs:{type:"button"},on:{click:_vm.cancel}},[_c("span",[_vm._v(_vm._s(_vm.$t("setup.users_management.cancel")))])]),_c("button",{staticClass:"footer-btn footer-btn-primary col-6",attrs:{type:"button"},on:{click:_vm.save}},[_c("span",[_vm._v(_vm._s(_vm.confirmTitle?_vm.confirmTitle:_vm.$t("common._common.ok")))])])]}))],2),_c("template",{slot:"reference"},[_vm._t("reference")],2)],2)},staticRenderFns=[],FPopovervue_type_script_lang_js={props:["popperClass","placement","value","popperRef","trigger","title","width","maxHeight","confirmTitle"],data:function(){return{showpopover:!1}},watch:{showpopover:function(val){null!=this.value&&this.$emit("input",val)},value:function(val){this.showpopover=val}},mounted:function(){var element=this.$refs[this.getRef].$el;if(this.popperClass&&element.firstElementChild.classList.add(this.popperClass),this.maxHeight){var content=element.querySelector(".fc-popover-content");content.classList.add("scrollable"),content.style["max-height"]=this.maxHeight+"px"}},computed:{getRef:function(){return this.popperRef?this.popperRef:"fpopup"}},methods:{save:function(){this.showpopover=!1,this.$emit("save")},cancel:function(){this.showpopover=!1,this.$emit("close")},hide:function(){this.$emit("hide")}}},components_FPopovervue_type_script_lang_js=FPopovervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FPopovervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FPopover=component.exports},
/***/552154:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return NewRule}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/firealarm/rules/NewRule.vue?vue&type=template&id=7f890dac
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{attrs:{visible:_vm.visibility,width:"50%","append-to-body":!0,"custom-class":"fc-dialog-form fc-dialog-right setup-dialog","before-close":_vm.closeDialog},on:{"update:visible":function($event){_vm.visibility=$event}}},[_c("el-form",{ref:"rule",attrs:{model:_vm.rule,"label-position":"top"}},[_c("div",{staticClass:"new-header-container"},[_c("div",{staticClass:"new-header-text"},[_c("div",{staticClass:"fc-setup-modal-title"},[_vm._v(" "+_vm._s(_vm.isEdit?_vm.$t("common._common.edit"):_vm.$t("common._common._new"))+" "+_vm._s(_vm.$t("common.header.alarm_rule"))+" ")])])]),_c("div",{staticClass:"fc-right-dialog-body"},[_c("div",[_c("el-form-item",{attrs:{rules:[{required:!0,message:this.$t("common._common.name_is_required")}],prop:"preRequsite.name"}},[_c("div",{staticClass:"fc-red-txt14 mT10"},[_vm._v(" "+_vm._s(_vm.$t("common._common.rule_name"))+" ")]),_c("el-input",{staticClass:"fc-input-full-border2",attrs:{autofocus:"",placeholder:_vm.$t("common.header.alarm_rule_name")},model:{value:_vm.rule.preRequsite.name,callback:function($$v){_vm.$set(_vm.rule.preRequsite,"name",$$v)},expression:"rule.preRequsite.name"}})],1)],1),_c("div",[_c("el-form-item",{attrs:{label:"Description"}},[_c("el-input",{staticClass:"fc-input-full-border-select2",attrs:{type:"textarea",autosize:{minRows:3,maxRows:4},resize:"none",placeholder:_vm.$t("common._common.enter_desc")},model:{value:_vm.rule.preRequsite.description,callback:function($$v){_vm.$set(_vm.rule.preRequsite,"description",$$v)},expression:"rule.preRequsite.description"}})],1)],1),_c("div",[_c("el-form-item",{attrs:{label:"Alarm Type"}},[_c("el-radio",{staticClass:"fc-radio-btn",attrs:{disabled:_vm.isEdit,label:"asset",value:"asset"},model:{value:_vm.resourceType,callback:function($$v){_vm.resourceType=$$v},expression:"resourceType"}},[_vm._v(_vm._s(_vm.$t("common._common.asset")))]),_c("el-radio",{staticClass:"fc-radio-btn",attrs:{disabled:_vm.isEdit,label:"space",value:"space"},model:{value:_vm.resourceType,callback:function($$v){_vm.resourceType=$$v},expression:"resourceType"}},[_vm._v(_vm._s(_vm.$t("common.space_asset_chooser.space")))])],1)],1),_c("div",[_c("el-row",{attrs:{gutter:20}},[_c("el-col",{attrs:{span:12}},["asset"===_vm.resourceType?_c("el-form-item",{attrs:{rules:[{required:"asset"===_vm.resourceType,message:"Category is required"}],prop:"preRequsite.assetCategoryId"}},[_c("div",{staticClass:"fc-red-txt14"},[_vm._v(" "+_vm._s(_vm.$t("common._common.asset_category"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{disabled:_vm.isEdit,filterable:"",placeholder:_vm.$t("common._common.select")},on:{change:function($event){return _vm.loadThresholdFields(!0)}},model:{value:_vm.rule.preRequsite.assetCategoryId,callback:function($$v){_vm.$set(_vm.rule.preRequsite,"assetCategoryId",$$v)},expression:"rule.preRequsite.assetCategoryId"}},_vm._l(_vm.assetCategory,(function(category,index){return _c("el-option",{key:index,attrs:{label:category.displayName,value:parseInt(category.id)}})})),1)],1):_vm._e()],1),_c("el-col",{attrs:{span:12}},[_c("el-form-item",{attrs:{label:"asset"===_vm.resourceType?"Assets":"Space"}},[_c("el-input",{staticClass:"fc-border-select fc-input-full-border-select2 width100",attrs:{disabled:""},model:{value:_vm.resourceLabel,callback:function($$v){_vm.resourceLabel=$$v},expression:"resourceLabel"}},[_c("i",{staticClass:"el-input__icon el-icon-search",staticStyle:{"line-height":"0px !important","font-size":"16px !important",cursor:"pointer"},attrs:{slot:"suffix"},on:{click:function($event){_vm.chooserVisibility=!0}},slot:"suffix"})])],1)],1)],1),_c("el-row",{attrs:{gutter:20}},[_c("el-col",{staticClass:"mT10",attrs:{span:12}},[_c("div",{staticClass:"fc-red-txt14 mT10 mB10"},[_vm._v(" "+_vm._s(_vm.$t("common._common.threshold_metric"))+" ")]),_c("el-form-item",{attrs:{rules:[{required:!0,message:this.$t("common._common.please_select_threshold_metric")}],prop:"metricFieldName"}},[_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{disabled:_vm.isEdit,filterable:"",placeholder:_vm.$t("common._common.select")},on:{change:function($event){return _vm.setMetricModule(_vm.rule.metricFieldName,_vm.rule.preRequsite)}},model:{value:_vm.rule.metricFieldName,callback:function($$v){_vm.$set(_vm.rule,"metricFieldName",$$v)},expression:"rule.metricFieldName"}},_vm._l(_vm.thresholdFields,(function(field){return _c("el-option",{key:field.name+field.id,attrs:{label:field.displayName,value:field.name}})})),1)],1)],1)],1),_c("div",{staticClass:"fc-text-pink mT30"},[_vm._v(" "+_vm._s(_vm.$t("common.header.rule_condition"))+" ")]),_c("div",{staticClass:"pT10"},[_c("el-checkbox",{model:{value:_vm.isPrerequest,callback:function($$v){_vm.isPrerequest=$$v},expression:"isPrerequest"}},[_vm._v(_vm._s(_vm.$t("common.header.enable_pre_requisite")))])],1),_vm.isPrerequest?_c("div",[_c("div",{staticClass:"fc-dark-blue2-12 mT10"},[_vm._v(" "+_vm._s(_vm.$t("common.header.prerequisite"))+" ")]),_c("div",{staticClass:"fc-grey2-text13 mT5 mB10"},[_vm._v(" "+_vm._s(_vm.$t("common.header.condition_statement"))+" ")]),_c("f-condition-type",{staticClass:"p20 border-blue position-relative mT10",attrs:{modelData:_vm.rule.preRequsite,title:"Prerequiste",isSeverity:!0,thresholdFields:_vm.thresholdFields,metricFields:_vm.selectedMetricFields,assetCategoryId:_vm.rule.preRequsite.assetCategoryId},on:{"update:modelData":function($event){return _vm.$set(_vm.rule,"preRequsite",$event)},"update:model-data":function($event){return _vm.$set(_vm.rule,"preRequsite",$event)}}})],1):_vm._e()],1),_c("div",[_c("div",{staticClass:"fc-dark-blue2-12 mT10 pT10 text-uppercase"},[_vm._v(" "+_vm._s(_vm.$t("common.header.alarm_condition"))+" ")]),_c("div",{staticClass:"fc-grey2-text13 mT10 mB10"},[_vm._v(" "+_vm._s(_vm.$t("common.header.condition_statement"))+" ")]),_c("f-condition-type",{attrs:{title:"Alarm Condition",isSeverity:!0,modelData:_vm.rule.alarmTriggerRule,metricFields:_vm.selectedMetricFields,assetCategoryId:_vm.rule.preRequsite.assetCategoryId,thresholdFields:_vm.thresholdFields},on:{"update:modelData":function($event){return _vm.$set(_vm.rule,"alarmTriggerRule",$event)},"update:model-data":function($event){return _vm.$set(_vm.rule,"alarmTriggerRule",$event)}}}),_c("alarm-rule-action",{attrs:{emitData:_vm.emitaction,showUpdate:!1,thresholdFields:_vm.thresholdFields,model:_vm.rule.alarmTriggerRule.actions,isSeverity:!0,category:null,isUpdate:_vm.isUpdate},on:{"update:emitData":function($event){_vm.emitaction=$event},"update:emit-data":function($event){_vm.emitaction=$event},"update:model":function($event){return _vm.$set(_vm.rule.alarmTriggerRule,"actions",$event)},actions:_vm.appendAction},model:{value:_vm.rule.alarmTriggerRule,callback:function($$v){_vm.$set(_vm.rule,"alarmTriggerRule",$$v)},expression:"rule.alarmTriggerRule"}})],1),_c("div",{staticClass:"mT20"},[_c("el-checkbox",{on:{change:function($event){return _vm.changeClear()}},model:{value:_vm.rule.enableRootCause,callback:function($$v){_vm.$set(_vm.rule,"enableRootCause",$$v)},expression:"rule.enableRootCause"}},[_vm._v(_vm._s(_vm.$t("common.header.enable_root_cause_analysis")))])],1),_vm.rule.enableRootCause?_c("div",[_c("div",{staticClass:"fc-dark-blue2-12 mT30 text-uppercase"},[_vm._v(" "+_vm._s(_vm.$t("common.header.root_cause_condition"))+" ")]),_c("div",{staticClass:"fc-grey2-text13 mT10"},[_vm._v(" "+_vm._s(_vm.$t("common.header.create_single_multiple"))+" ")]),_c("alarm-trigger",{attrs:{title:"Root Cause",emitData:_vm.triggerData,isCondition:!0,context:_vm.rule.alarmRCARules,metricFields:_vm.selectedMetricFields,metric:_vm.rule.metricFieldName,category:_vm.rule.preRequsite.assetCategoryId?_vm.getAssetCategory(_vm.rule.preRequsite.assetCategoryId):{id:null},thresholdFields:_vm.thresholdFields,isActions:!0,showUpdate:!1,isUpdate:_vm.isUpdate},on:{"update:emitData":function($event){_vm.triggerData=$event},"update:emit-data":function($event){_vm.triggerData=$event},"update:context":function($event){return _vm.$set(_vm.rule,"alarmRCARules",$event)},triggerRule:function(data){return _vm.saveRule(data)}}})],1):_vm._e(),_c("div",{staticClass:"pT10"},[_c("el-checkbox",{on:{change:function($event){return _vm.changeClear()}},model:{value:_vm.rule.enableimpacts,callback:function($$v){_vm.$set(_vm.rule,"enableimpacts",$$v)},expression:"rule.enableimpacts"}},[_vm._v(_vm._s(_vm.$t("common.header.enable_impact")))])],1),_vm.rule.enableimpacts?_c("div",[_c("div",{staticClass:"fc-dark-blue2-12 mT30 text-uppercase"},[_vm._v(" "+_vm._s(_vm.$t("common.header.impact"))+" ")]),_c("div",{staticClass:"fc-grey2-text13 mT10"},[_vm._v(" "+_vm._s(_vm.$t("common.header.create_single_multiple"))+" ")]),_c("div",{staticClass:"pT20 pB20"},[_c("el-checkbox",{on:{change:function($event){_vm.rule.readingAlarmRuleContexts=[]}},model:{value:_vm.rule.isCondition,callback:function($$v){_vm.$set(_vm.rule,"isCondition",$$v)},expression:"rule.isCondition"}},[_vm._v(_vm._s(_vm.$t("common.header.condition_based")))])],1),_vm.rule.isCondition?_c("alarm-trigger",{attrs:{title:"Impact",emitData:_vm.impactData,isFormule:!0,isCondition:_vm.rule.isCondition,fields:_vm.alarmFields,context:_vm.rule.readingAlarmRuleContexts,metric:_vm.rule.metricFieldName,category:_vm.rule.preRequsite.assetCategoryId?_vm.getAssetCategory(_vm.rule.preRequsite.assetCategoryId):{id:null},thresholdFields:_vm.thresholdFields,isActions:!0,showUpdate:!0},on:{"update:context":function($event){return _vm.$set(_vm.rule,"readingAlarmRuleContexts",$event)},triggerRule:function(data){return _vm.addImpact(data)}}}):_c("div",[_c("f-field-update",{attrs:{emitData:_vm.fielUpdate,isServerity:!1,fields:_vm.alarmFields,model:_vm.rule.readingAlarmRuleContexts,editField:_vm.rule.readingAlarmRuleContexts&&_vm.rule.readingAlarmRuleContexts[0]?_vm.rule.readingAlarmRuleContexts[0].actions:null,category:_vm.getAssetCategory(_vm.rule.preRequsite.assetCategoryId)},on:{actions:function(data){return _vm.addImpact(data)},"update:model":function($event){return _vm.$set(_vm.rule,"readingAlarmRuleContexts",$event)}}})],1)],1):_vm._e(),_c("div",{staticClass:"pT10"},["asset"===_vm.resourceType?_c("el-checkbox",{model:{value:_vm.rule.reportBreakdown,callback:function($$v){_vm.$set(_vm.rule,"reportBreakdown",$$v)},expression:"rule.reportBreakdown"}},[_vm._v(_vm._s(_vm.$t("common.header.report_downtime")))]):_vm._e()],1),_c("div"),_c("div",[_c("div",{staticClass:"fc-dark-blue2-12 mT20"},[_vm._v(" "+_vm._s(_vm.$t("common.header.alarm_clear_when"))+" ")]),_c("div",{staticClass:"fc-grey2-text13 mT10"},[_vm._v(" "+_vm._s(_vm.$t("common.header.condition_to_clear_an_alarm"))+" ")])]),_c("div",{staticClass:"mT20"},[_c("el-form-item",[_c("el-radio",{staticClass:"fc-radio-btn",attrs:{label:!0,value:!0},on:{change:function($event){return _vm.changeClear()}},model:{value:_vm.rule.isAutoClear,callback:function($$v){_vm.$set(_vm.rule,"isAutoClear",$$v)},expression:"rule.isAutoClear"}},[_vm._v("Auto Clear")]),_c("el-radio",{staticClass:"fc-radio-btn",attrs:{label:!1,value:!1},on:{change:function($event){return _vm.changeClear()}},model:{value:_vm.rule.isAutoClear,callback:function($$v){_vm.$set(_vm.rule,"isAutoClear",$$v)},expression:"rule.isAutoClear"}},[_vm._v(_vm._s(_vm.$t("common.header.clear_based_condition")))])],1),_c("f-condition-type",{directives:[{name:"show",rawName:"v-show",value:!_vm.rule.isAutoClear,expression:"!rule.isAutoClear"}],staticClass:"p20 border-blue position-relative",attrs:{title:"Clear",modelData:_vm.rule.alarmClearRule,thresholdFields:_vm.thresholdFields},on:{"update:modelData":function($event){return _vm.$set(_vm.rule,"alarmClearRule",$event)},"update:model-data":function($event){return _vm.$set(_vm.rule,"alarmClearRule",$event)}}})],1)]),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){return _vm.closeDialog()}}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:function($event){return _vm.addRule()}}},[_vm._v(_vm._s(_vm.$t("common._common._save")))])],1)]),"space"===_vm.resourceType?_c("space-asset-chooser",{attrs:{visibility:_vm.chooserVisibility,initialValues:{},query:_vm.resourceQuery,showAsset:!1,picktype:"space"},on:{associate:_vm.associateResource,"update:visibility":function($event){_vm.chooserVisibility=$event}}}):_c("space-asset-multi-chooser",{attrs:{visibility:_vm.chooserVisibility,initialValues:_vm.resourceData,query:_vm.resourceQuery,showAsset:!0,disable:!0},on:{associate:_vm.associateResource,"update:visibility":function($event){_vm.chooserVisibility=$event}}})],1)},staticRenderFns=[],esm_typeof=__webpack_require__(103336),objectSpread2=__webpack_require__(595082),FConditionTypevue_type_template_id_3da6d45d_render=(__webpack_require__(450886),__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(434284),__webpack_require__(903650),__webpack_require__(169358),__webpack_require__(947522),__webpack_require__(425728),__webpack_require__(670560),__webpack_require__(162506),function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("el-row",{staticClass:"mT10",attrs:{gutter:20}},[_vm.isSeverity?_vm._e():_c("el-col",{attrs:{align:"left",span:12}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v(_vm._s(_vm.title)+" Metric")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{filterable:"",placeholder:"Select"},on:{change:function($event){return _vm.setMetricModule(_vm.metricFieldName,_vm.modelData)}},model:{value:_vm.modelData.readingFieldId,callback:function($$v){_vm.$set(_vm.modelData,"readingFieldId",$$v)},expression:"modelData.readingFieldId"}},_vm._l(_vm.categoryFields,(function(field){return _c("el-option",{key:field.name+_vm.title,attrs:{label:field.displayName,value:field.id}})})),1)],1),_c("el-col",{staticClass:"condition-type-width",attrs:{span:12}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v("Condition Type")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{"collapse-tags":""},on:{change:_vm.loadType},model:{value:_vm.modelData.thresholdType,callback:function($$v){_vm.$set(_vm.modelData,"thresholdType",$$v)},expression:"modelData.thresholdType"}},_vm._l(_vm.$constants.CONDITION_TYPE,(function(label,value){return _c("el-option",{key:value,attrs:{label:label,value:parseInt(value)}})})),1)],1)],1),_c("el-row",[2===_vm.modelData.thresholdType||3===_vm.modelData.thresholdType?_c("el-col",[3===_vm.modelData.thresholdType?_c("el-row",{staticClass:"mT20",attrs:{align:"middle",gutter:20}},[_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v("Baseline")]),_c("div",{staticClass:"add"},[_c("el-select",{staticClass:"form-item fc-input-full-border-select2 width100",attrs:{placeholder:"Choose Baseline"},model:{value:_vm.modelData.baselineId,callback:function($$v){_vm.$set(_vm.modelData,"baselineId",$$v)},expression:"modelData.baselineId"}},_vm._l(_vm.baselines,(function(baseline){return _c("el-option",{key:baseline.id,attrs:{label:baseline.name,value:baseline.id}})})),1)],1)])],1):_vm._e(),_c("el-row",{staticClass:"position-relative pT20 pB20",attrs:{align:"middle",gutter:20}},[_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v("Aggregation")]),_c("div",{staticClass:"add"},[_c("el-select",{staticClass:"form-item fc-input-full-border-select2 width100",attrs:{placeholder:"Choose Aggregation"},model:{value:_vm.modelData.aggregation,callback:function($$v){_vm.$set(_vm.modelData,"aggregation",$$v)},expression:"modelData.aggregation"}},[_c("el-option",{key:"sum",attrs:{label:"Sum",value:"sum"}}),_c("el-option",{key:"avg",attrs:{label:"Average",value:"avg"}}),_c("el-option",{key:"min",attrs:{label:"Minimum",value:"min"}}),_c("el-option",{key:"max",attrs:{label:"Maximum",value:"max"}})],1)],1)]),_c("el-col",{attrs:{span:12}},[_c("duration",{attrs:{label:"Date Range",labelClass:"fc-input-label-txt",format:"h",size:"l",minHour:!0},model:{value:_vm.modelData.dateRange,callback:function($$v){_vm.$set(_vm.modelData,"dateRange",$$v)},expression:"modelData.dateRange"}},[_c("el-col",{staticClass:"pT10",attrs:{slot:"prefix",span:3},slot:"prefix"},[_c("span",{staticClass:"textcolor vertical-sub"},[_vm._v("Last")])])],1)],1),_c("el-col",{staticClass:"mT20",attrs:{span:12}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v("Operator")]),_c("div",{staticClass:"add"},[_c("el-select",{staticClass:"form-item fc-input-full-border-select2 width100",attrs:{placeholder:"Choose Operator"},model:{value:_vm.modelData.operatorId,callback:function($$v){_vm.$set(_vm.modelData,"operatorId",$$v)},expression:"modelData.operatorId"}},[_c("el-option",{key:9,attrs:{label:"Equals",value:9}}),_c("el-option",{key:10,attrs:{label:"Not Equals",value:10}}),_c("el-option",{key:13,attrs:{label:"Greater Than",value:13}}),_c("el-option",{key:14,attrs:{label:"Greater Than Equals",value:14}}),_c("el-option",{key:11,attrs:{label:"Less Than",value:11}}),_c("el-option",{key:12,attrs:{label:"Less Than Equals",value:12}})],1)],1)]),3===_vm.modelData.thresholdType?_c("el-col",{staticClass:"mT20 pL10",attrs:{span:12}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v("Percentage")]),_c("div",{staticClass:"add"},[_c("el-input",{staticClass:"fc-input-select fc-input-full-border2 width100",attrs:{type:"number",placeholder:"0%"},model:{value:_vm.modelData.percentage,callback:function($$v){_vm.$set(_vm.modelData,"percentage",$$v)},expression:"modelData.percentage"}})],1)]):_vm._e(),2===_vm.modelData.thresholdType?_c("el-col",{staticClass:"mT20 pL10",attrs:{span:12}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v("Value")]),_c("div",{staticClass:"add"},[_c("el-input",{staticClass:"fc-input-full-border2 width100",attrs:{placeholder:"Enter Value"},model:{value:_vm.modelData.percentage,callback:function($$v){_vm.$set(_vm.modelData,"percentage",$$v)},expression:"modelData.percentage"}})],1)]):_vm._e()],1)],1):4===_vm.modelData.thresholdType?_c("el-col",[_vm.isBooleanMetric?_vm._e():_c("el-row",{staticClass:"mT20",attrs:{align:"middle",gutter:20}},[_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v("Lower Trigger")]),_c("div",{staticClass:"add"},[_c("el-input",{staticClass:"fc-input-full-border2 width100",attrs:{placeholder:"Lower Trigger Value"},model:{value:_vm.modelData.minFlapValue,callback:function($$v){_vm.$set(_vm.modelData,"minFlapValue",$$v)},expression:"modelData.minFlapValue"}})],1)]),_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v("Upper Trigger")]),_c("div",{staticClass:"add"},[_c("el-input",{staticClass:"fc-input-full-border2 width100",attrs:{placeholder:"Upper Trigger Value"},model:{value:_vm.modelData.maxFlapValue,callback:function($$v){_vm.$set(_vm.modelData,"maxFlapValue",$$v)},expression:"modelData.maxFlapValue"}})],1)])],1),_c("el-row",{staticClass:"mT20 mB20",attrs:{align:"middle",gutter:20}},[_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v("Flapping Frequency (n times)")]),_c("div",{staticClass:"add"},[_c("el-input",{staticClass:"fc-input-full-border2 width100",attrs:{placeholder:"Enter Flapping Frequency"},model:{value:_vm.modelData.flapFrequency,callback:function($$v){_vm.$set(_vm.modelData,"flapFrequency",$$v)},expression:"modelData.flapFrequency"}})],1)]),_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v(" Flapping Interval (period in minutes) ")]),_c("div",{staticClass:"add"},[_c("el-input",{staticClass:"fc-input-full-border2 width100",attrs:{placeholder:"Enter Flapping Interval"},model:{value:_vm.modelData.flapInterval,callback:function($$v){_vm.$set(_vm.modelData,"flapInterval",$$v)},expression:"modelData.flapInterval"}})],1)])],1)],1):1===_vm.modelData.thresholdType?_c("el-col",[_c("el-row",{staticClass:"mT20 mB20",attrs:{align:"middle"}},[_c("el-col",{attrs:{span:8}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v("Operator")]),_c("div",{staticClass:"add"},[_c("el-select",{staticClass:"form-item fc-input-full-border2 width100 pR10",attrs:{placeholder:"Choose Operator"},model:{value:_vm.modelData.operatorId,callback:function($$v){_vm.$set(_vm.modelData,"operatorId",$$v)},expression:"modelData.operatorId"}},[_c("el-option",{key:9,attrs:{label:"Equals",value:9}}),_c("el-option",{key:10,attrs:{label:"Not Equals",value:10}}),_c("el-option",{key:13,attrs:{label:"Greater Than",value:13}}),_c("el-option",{key:14,attrs:{label:"Greater Than Equals",value:14}}),_c("el-option",{key:11,attrs:{label:"Less Than",value:11}}),_c("el-option",{key:12,attrs:{label:"Less Than Equals",value:12}})],1)],1)]),_c("el-col",{attrs:{span:8}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v("Value")]),_c("div",{staticClass:"add"},[_vm.isNumberMetric?_c("el-popover",{attrs:{width:_vm.$refs.previnput&&_vm.$refs.previnput.$el?_vm.$refs.previnput.$el.clientWidth:"",trigger:"click","popper-class":"prev-popper"},model:{value:_vm.showPrevPopover,callback:function($$v){_vm.showPrevPopover=$$v},expression:"showPrevPopover"}},[_c("div",{staticClass:"prev-value",staticStyle:{cursor:"pointer",padding:"10px"},on:{click:_vm.setPrevValue}},[_vm._v(" "+_vm._s((this.selectedMetric?this.selectedMetric.displayName+"'s ":"")+"Previous Value")+" ")]),_c("div",{attrs:{slot:"reference"},slot:"reference"},[_c("el-input",{ref:"previnput",staticClass:"fc-input-full-border2",attrs:{placeholder:"Enter Value"},nativeOn:{keydown:function($event){_vm.showPrevPopover=!1}},model:{value:_vm.modelData.percentage,callback:function($$v){_vm.$set(_vm.modelData,"percentage",$$v)},expression:"modelData.percentage"}},[_c("i",{class:["prev-icon el-select__caret el-input__icon el-icon-arrow-down",{active:_vm.showPrevPopover}],staticStyle:{"line-height":"16px"},attrs:{slot:"suffix"},slot:"suffix"})])],1)]):_c("el-input",{staticClass:"fc-input-full-border2",attrs:{placeholder:"Enter Value"},model:{value:_vm.modelData.percentage,callback:function($$v){_vm.$set(_vm.modelData,"percentage",$$v)},expression:"modelData.percentage"}})],1)]),_c("el-col",{staticClass:"pL10",attrs:{span:8}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v("Occurrences")]),_c("div",{staticClass:"add"},[_c("el-input",{staticClass:"fc-input-select fc-input-full-border2",attrs:{type:"number",placeholder:"Enter Occurrences"},model:{value:_vm.modelData.occurences,callback:function($$v){_vm.$set(_vm.modelData,"occurences",$$v)},expression:"modelData.occurences"}})],1)])],1),_vm.modelData.occurences>0?_c("el-row",{staticStyle:{margin:"0px"},attrs:{align:"middle",gutter:20}},[_c("el-col",{staticStyle:{"padding-left":"0px"},attrs:{span:24}},[_c("div",{staticClass:"textcolor pT0"},[_c("el-radio",{staticClass:"fc-radio-btn",attrs:{label:1},on:{change:function($event){return _vm.changeOccurence()}},model:{value:_vm.modelData.consecutiveoroverperiod,callback:function($$v){_vm.$set(_vm.modelData,"consecutiveoroverperiod",$$v)},expression:"modelData.consecutiveoroverperiod"}},[_vm._v("Over Period")]),_c("el-radio",{staticClass:"fc-radio-btn",attrs:{label:2},on:{change:function($event){return _vm.changeOccurence()}},model:{value:_vm.modelData.consecutiveoroverperiod,callback:function($$v){_vm.$set(_vm.modelData,"consecutiveoroverperiod",$$v)},expression:"modelData.consecutiveoroverperiod"}},[_vm._v("Consecutive")])],1)])],1):_vm._e(),_vm.modelData.occurences>0&&1===_vm.modelData.consecutiveoroverperiod?_c("el-row",{staticClass:"mB20 mT20",attrs:{align:"middle"}},[_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v("Period")]),_c("div",{staticClass:"add"},[_c("el-select",{staticClass:"width100 fc-input-full-border-select2",attrs:{placeholder:"Choose Period"},on:{change:function($event){return _vm.changeOccurence()}},model:{value:_vm.modelData.overperiod,callback:function($$v){_vm.$set(_vm.modelData,"overperiod",$$v)},expression:"modelData.overperiod"}},[_c("el-option",{key:1,attrs:{label:"Last 1 Hour",value:1}}),_c("el-option",{key:3,attrs:{label:"Last 3 Hour",value:3}}),_c("el-option",{key:6,attrs:{label:"Last 6 Hour",value:6}}),_c("el-option",{key:12,attrs:{label:"Last 12 Hour",value:12}})],1)],1)])],1):_vm._e()],1):5===_vm.modelData.thresholdType?_c("el-col",{staticClass:"mB20 rule-condition-formula"},[_c("f-formula-builder",{staticStyle:{"padding-top":"20px"},attrs:{title:"",module:"thresholdrule",metric:_vm.selectedMetric,assetCategory:{id:_vm.assetCategoryId?_vm.assetCategoryId:_vm.modelData.assetCategoryId}},model:{value:_vm.modelData.workflow,callback:function($$v){_vm.$set(_vm.modelData,"workflow",$$v)},expression:"modelData.workflow"}})],1):6===_vm.modelData.thresholdType?_c("el-col",{staticClass:"mB20",attrs:{span:24}},[_c("function",{attrs:{metric:_vm.metricFields,resource:_vm.selectedResource},model:{value:_vm.modelData.workflow,callback:function($$v){_vm.$set(_vm.modelData,"workflow",$$v)},expression:"modelData.workflow"}})],1):_vm._e()],1)],1)}),FConditionTypevue_type_template_id_3da6d45d_staticRenderFns=[],FFormulaBuilder=(__webpack_require__(976801),__webpack_require__(902294)),FDuration=__webpack_require__(611097),FFormulaFunction=__webpack_require__(72875),vuex_esm=__webpack_require__(420629),WorkFlowMixin=__webpack_require__(522098),FConditionTypevue_type_script_lang_js={mixins:[WorkFlowMixin/* default */.Z],props:["modelData","isSeverity","thresholdFields","title","assetCategoryId","metricFields"],components:{FFormulaBuilder:FFormulaBuilder/* default */.Z,Duration:FDuration/* default */.Z,Function:FFormulaFunction/* default */.Z},watch:{modelData:function(newVal,oldVal){newVal!==oldVal&&(this.modelData=newVal,this.modelData&&3===this.modelData.thresholdType&&this.loadBaselines())}},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({alarmseverity:function(state){return state.alarmSeverity}})),{},{categoryFields:function(){return this.thresholdFields},isBooleanMetric:function(){return this.selectedMetric&&("BOOLEAN"===this.selectedMetric.dataTypeEnum||"BOOLEAN"===this.selectedMetric.dataTypeEnum._name)},isNumberMetric:function(){return this.selectedMetric&&(["NUMBER","DECIMAL"].includes(this.selectedMetric.dataTypeEnum)||["NUMBER","DECIMAL"].includes(this.selectedMetric.dataTypeEnum._name))}}),data:function(){return{thresholdType:1,showPrevPopover:!1,metricFieldName:null,baselines:[],model:{alarmSeverity:null,consecutiveoroverperiod:1,overperiod:null,occurences:null,workflow:null,readingRule:{module:"",name:"",description:"",executionOrder:0,resourceId:-1,readingFieldId:-1,assetCategoryId:null,event:{moduleId:null,activityType:1},criteria:null,baselineId:null,aggregation:null,overperiod:null,dateRange:1,operatorId:null,percentage:null,onSuccess:!1,parentRuleId:null}}}},mounted:function(){3===this.modelData.thresholdType&&this.loadBaselines(),this.modelData.readingFieldId>0&&(this.selectedMetric=this.modelData.readingField)},created:function(){this.$store.dispatch("loadAssetCategory"),this.$store.dispatch("loadAlarmSeverity")},methods:{setPrevValue:function(){this.model.readingRule.percentage="${previousValue}",this.showPrevPopover=!1},changeOccurence:function(){this.$forceUpdate()},loadType:function(){3===this.modelData.thresholdType&&this.loadBaselines()},loadBaselines:function(){var self=this;self.$http.get("/baseline/all").then((function(response){200===response.status&&(self.baselines=response.data)}))}}},components_FConditionTypevue_type_script_lang_js=FConditionTypevue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FConditionTypevue_type_script_lang_js,FConditionTypevue_type_template_id_3da6d45d_render,FConditionTypevue_type_template_id_3da6d45d_staticRenderFns,!1,null,null,null)
/* harmony default export */,FConditionType=component.exports,SpaceAssetChooser=__webpack_require__(372587),SpaceAssetMultiChooser=__webpack_require__(673362),AlarmTriggervue_type_template_id_65075d68_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("el-collapse",{staticClass:"new-rule-collapse position-relative",attrs:{accordion:!0},model:{value:_vm.activeNames,callback:function($$v){_vm.activeNames=$$v},expression:"activeNames"}},_vm._l(_vm.triggerRule,(function(trigger,index){return _c("el-collapse-item",{directives:[{name:"show",rawName:"v-show",value:!trigger.isDeleted,expression:"!trigger.isDeleted"}],key:index,staticClass:"pL10 pR20 pT10 pB10 rule-border-blue mT20 position-relative",attrs:{name:trigger.name}},[_c("template",{staticClass:"row",slot:"title"},[_vm._v(" "+_vm._s(trigger.name)+" ")]),_c("div",{staticClass:"row"},[index>0?_c("div",{staticClass:"fc-input-label-txt"},[_vm._v(" Dependant On "),_c("el-select",{staticClass:"fc-input-full-border-select2 width10",attrs:{filterable:""},model:{value:trigger.parentRuleName,callback:function($$v){_vm.$set(trigger,"parentRuleName",$$v)},expression:"trigger.parentRuleName"}},[_c("el-option",{key:"none",attrs:{label:"None",value:null}}),_vm._l(_vm.triggerRule,(function(option,position){return index>position?_c("el-option",{key:position,attrs:{label:option.name,value:option.name}}):_vm._e()}))],2)],1):_vm._e(),trigger.parentRuleName?_c("div",{staticClass:"fc-input-label-txt pL10"},[_vm._v(" On Condition "),_c("el-select",{staticClass:"fc-input-full-border-select2 width10",attrs:{filterable:""},model:{value:trigger.onSuccess,callback:function($$v){_vm.$set(trigger,"onSuccess",$$v)},expression:"trigger.onSuccess"}},[_c("el-option",{key:!0,attrs:{label:"Match",value:!0}}),_c("el-option",{key:!1,attrs:{label:"Not Match",value:!1}})],1)],1):_vm._e()]),_c("trigger-item",{attrs:{trigger:trigger,context:_vm.context,emitData:_vm.emitData,fields:_vm.fields,metric:_vm.metric,category:_vm.category,isActions:_vm.isActions,isCondition:_vm.isCondition,showUpdate:_vm.showUpdate,metricFields:_vm.metricFields,isFormule:_vm.isFormule,isUpdate:_vm.isUpdate},on:{"update:trigger":function($event){trigger=$event},actions:function(data){return _vm.updateTrigger(data,index)}}}),_c("img",{staticClass:"delete-icon pointer",staticStyle:{height:"18px",width:"18px","margin-right":"3px"},attrs:{src:__webpack_require__(385769)},on:{click:function($event){return _vm.deleteTrigger(index)}}})],2)})),1),_c("el-button",{staticClass:"add-border-btn bR3 mT20 mB10",on:{click:_vm.addTrigger}},[_c("i",{staticClass:"el-icon-plus",staticStyle:{"font-weight":"bold","margin-right":"4px"}}),_vm._v("ADD "+_vm._s(this.title))])],1)},AlarmTriggervue_type_template_id_65075d68_staticRenderFns=[],TriggerItemvue_type_template_id_6d9ab33e_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_vm.isFormule?_c("f-formula-builder",{staticClass:"pB20 rule-alarm-trigger",staticStyle:{"padding-top":"20px"},attrs:{title:"",module:"impact",metric:_vm.selectedMetric,assetCategory:{id:_vm.category.id}},model:{value:_vm.trigger.workflow,callback:function($$v){_vm.$set(_vm.trigger,"workflow",$$v)},expression:"trigger.workflow"}}):_c("f-condition-type",{attrs:{modelData:_vm.trigger,isSeverity:!0,metricFields:_vm.metricFields,assetCategoryId:_vm.category.id}}),_vm.isActions?_c("alarm-rule-action",{attrs:{showUpdate:_vm.showUpdate,fields:_vm.fields,model:_vm.trigger.actions,category:_vm.selectedCategory,isSeverity:!1,isUpdate:_vm.isUpdate,emitData:_vm.emitaction},on:{actions:function(data){return _vm.update(data)},"update:model":function($event){return _vm.$set(_vm.trigger,"actions",$event)}}}):_vm._e()],1)},TriggerItemvue_type_template_id_6d9ab33e_staticRenderFns=[],AlarmRuleActionvue_type_template_id_1c884c64_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_vm.templateAction&&_vm.templateAction.templateJson?_c("div",[_vm.showUpdate?_vm._e():_c("div",[_c("div",{staticClass:"fc-text-pink mT10"},[_vm._v(" ALARM DETAILS ")]),_vm.isSeverity?_c("el-form-item",{attrs:{label:"Severity"}},[_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{"collapse-tags":""},model:{value:_vm.templateAction.templateJson.fieldMatcher.severity,callback:function($$v){_vm.$set(_vm.templateAction.templateJson.fieldMatcher,"severity",$$v)},expression:"templateAction.templateJson.fieldMatcher.severity"}},_vm._l(_vm.alarmseverity,(function(label){return _c("el-option",{key:label.id,attrs:{label:label.displayName,value:label.severity}})})),1)],1):_vm._e(),_vm.isSeverity?_c("el-form-item",{attrs:{rules:[{required:!0,message:"Alarm Message is required"}]}},[_c("div",{staticClass:"fc-red-txt14 mT10"},[_vm._v("Alarm Message")]),_c("el-input",{staticClass:"fc-input-full-border2",attrs:{autofocus:"",placeholder:"Alarm Message"},model:{value:_vm.templateAction.templateJson.fieldMatcher.message,callback:function($$v){_vm.$set(_vm.templateAction.templateJson.fieldMatcher,"message",$$v)},expression:"templateAction.templateJson.fieldMatcher.message"}})],1):_vm._e(),_c("el-form-item",{attrs:{label:"Problem"}},[_c("el-input",{staticClass:"fc-input-full-border-textarea mT10",attrs:{type:"textarea",autofocus:"",placeholder:"Enter Problem",autosize:{minRows:3,maxRows:4},resize:"none"},model:{value:_vm.templateAction.templateJson.fieldMatcher.problem,callback:function($$v){_vm.$set(_vm.templateAction.templateJson.fieldMatcher,"problem",$$v)},expression:"templateAction.templateJson.fieldMatcher.problem"}})],1),_c("el-form-item",{attrs:{label:"Possible Causes"}},[_c("el-input",{staticClass:"fc-input-full-border-textarea mT10",attrs:{type:"textarea",autofocus:"",autosize:{minRows:3,maxRows:4},resize:"none",placeholder:"Enter Possible Causes"},model:{value:_vm.templateAction.templateJson.fieldMatcher.possibleCauses,callback:function($$v){_vm.$set(_vm.templateAction.templateJson.fieldMatcher,"possibleCauses",$$v)},expression:"templateAction.templateJson.fieldMatcher.possibleCauses"}})],1),_c("el-form-item",{attrs:{label:"Recommendation"}},[_c("el-input",{staticClass:"fc-input-full-border-textarea mT10",attrs:{type:"textarea",autosize:{minRows:3,maxRows:4},resize:"none",autofocus:"",placeholder:"Enter Recommendation"},model:{value:_vm.templateAction.templateJson.fieldMatcher.recommendation,callback:function($$v){_vm.$set(_vm.templateAction.templateJson.fieldMatcher,"recommendation",$$v)},expression:"templateAction.templateJson.fieldMatcher.recommendation"}})],1)],1),_vm.showUpdate?_c("f-field-update",{attrs:{isServerity:!0,fields:_vm.customFields,emitData:_vm.updateField,model:_vm.actions,editField:_vm.model,category:_vm.selectedCategory},on:{updateActions:function($event){return _vm.appendActions($event,_vm.index)},actions:function(data){return _vm.addUpdateAction(data)},"update:model":function($event){_vm.actions=$event}},model:{value:_vm.actions,callback:function($$v){_vm.actions=$$v},expression:"actions"}}):_vm._e()],1):_vm._e()])},AlarmRuleActionvue_type_template_id_1c884c64_staticRenderFns=[],FFieldUpdatevue_type_template_id_bc18fa96_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"overflow-y-scroll pB20"},[_vm.isServerity?_c("el-row",{attrs:{gutter:20}},[_c("el-col",{attrs:{span:12}},[_c("el-input",{staticClass:"fc-input-full-border2 width100",attrs:{disabled:""},model:{value:_vm.severity,callback:function($$v){_vm.severity=$$v},expression:"severity"}})],1),_c("el-col",{attrs:{span:12}},[_c("el-form-item",[_vm.fieldMatchers&&_vm.fieldMatchers[0]&&_vm.fieldMatchers[0].templateJson?_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{"collapse-tags":""},model:{value:_vm.fieldMatchers[0].templateJson.resultWorkflowContext.expressions[0].constant,callback:function($$v){_vm.$set(_vm.fieldMatchers[0].templateJson.resultWorkflowContext.expressions[0],"constant",$$v)},expression:"\n            fieldMatchers[0].templateJson.resultWorkflowContext.expressions[0]\n              .constant\n          "}},_vm._l(_vm.alarmseverity,(function(label){return _c("el-option",{key:label.id,attrs:{label:label.displayName,value:String(label.id)}})})),1):_vm._e()],1)],1)],1):_vm._e(),_vm._l(_vm.fieldMatchers,(function(fieldMatcher,index){return"severity"!==fieldMatcher.fieldName?_c("div",{key:index},[_c("el-row",{staticClass:"visibility-visible-actions pT10 pB10 pointer"},[_c("el-col",{attrs:{span:12}},[_c("el-select",{staticClass:"fc-input-full-border-select2 width100 pR10",attrs:{filterable:""},model:{value:fieldMatcher.fieldName,callback:function($$v){_vm.$set(fieldMatcher,"fieldName",$$v)},expression:"fieldMatcher.fieldName"}},_vm._l(_vm.fields,(function(field,index){return _c("el-option",{key:index,attrs:{label:field.displayName,value:field.name}})})),1)],1),_c("el-col",{staticClass:"pL10",attrs:{span:12}},[_c("el-col",{staticClass:"mT8",attrs:{span:9}},[_c("div",{staticClass:"flex-middle"},[_c("el-button",{class:fieldMatcher.isConfig?"success-green-btn":"small-border-btn",attrs:{disabled:!fieldMatcher.fieldName,type:"button"},on:{click:function($event){_vm.displayBuilder=!0,_vm.selectedIndex=index,_vm.selectedField=fieldMatcher}}},[_vm._v(_vm._s(fieldMatcher.isConfig?"Configured":"Configure"))]),fieldMatcher.isConfig?_c("div",{staticClass:"mL10",on:{click:function($event){_vm.displayBuilder=!0,_vm.selectedIndex=index,_vm.selectedField=fieldMatcher}}},[_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-edit pointer",attrs:{title:"Edit Field"}})]):_vm._e()],1)]),_c("el-col",{staticClass:"mT10 pL20",attrs:{span:12}},[_c("div",{staticClass:"visibility-hide-actions pointer"},[_c("img",{staticClass:"pointer",attrs:{src:__webpack_require__(353654)},on:{click:_vm.addRow}}),_vm.fieldMatchers.length>1&&1!==_vm.fieldMatchers.length?_c("img",{staticClass:"pointer mL5",attrs:{src:__webpack_require__(385769)},on:{click:function($event){return _vm.deleteRow(index)}}}):_vm._e()])])],1)],1)],1):_vm._e()})),_vm.selectedField?_c("el-dialog",{staticClass:"fieldchange-Dialog pB15 fileupdate-dialog fc-dialog-center-container",attrs:{visible:_vm.displayBuilder,width:"50%","append-to-body":!0,title:_vm.selectedField.fieldName},on:{"update:visible":function($event){_vm.displayBuilder=$event}}},[_c("div",{staticClass:"height300"},[_c("f-formula-builder",{staticClass:"rule-condition-formula",staticStyle:{"padding-top":"20px"},attrs:{title:"",module:"impact",assetCategory:_vm.category},model:{value:_vm.selectedField.templateJson.resultWorkflowContext,callback:function($$v){_vm.$set(_vm.selectedField.templateJson,"resultWorkflowContext",$$v)},expression:"selectedField.templateJson.resultWorkflowContext"}})],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){_vm.displayBuilder=!1}}},[_vm._v("CANCEL")]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:function($event){_vm.displayBuilder=!1,_vm.actionSave(_vm.selectedField)}}},[_vm._v("Save")])],1)]):_vm._e()],2)},FFieldUpdatevue_type_template_id_bc18fa96_staticRenderFns=[],FFieldUpdatevue_type_script_lang_js={components:{FFormulaBuilder:FFormulaBuilder/* default */.Z},props:["fields","visibility","editField","category","model","emitData","isServerity"],watch:{emitData:function(newVal,oldVal){oldVal!==newVal&&this.updateField()}},created:function(){this.$store.dispatch("loadAssetCategory"),this.$store.dispatch("loadAlarmSeverity")},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({alarmseverity:function(state){return state.alarmSeverity}})),{},{actions:function(){return this.model}}),data:function(){return{severity:"Severity",displayBuilder:!1,selectedField:null,selectedIndex:null,fieldMatchers:[],alarmServerityId:null,picklistOptions:{}}},mounted:function(){this.editField&&this.editField.length>0?this.editObj():(this.isServerity&&this.fieldMatchers.push({actionType:17,fieldName:"severity",templateJson:{resultWorkflowContext:{expressions:[{name:"severity",constant:null}]},metaJson:{fields:[]}}}),this.addRow())},methods:{editObj:function(){var _this=this,actions=this.editField;actions.forEach((function(d){_this.fieldMatchers.push({actionType:17,isConfig:!0,fieldName:d.template.metaJson.fields[0],templateJson:{resultWorkflowContext:d.template.originalTemplate.workflowContext,metaJson:{fields:[]}}})}))},actionSave:function(){this.fieldMatchers[this.selectedIndex].isConfig=!0},addRow:function(){this.fieldMatchers.push({actionType:17,fieldName:null,templateJson:{resultWorkflowContext:null,metaJson:{fields:[]}}}),this.$forceUpdate()},deleteRow:function(index){this.fieldMatchers.splice(index,1)},updateField:function(){var sendData=this.$helpers.cloneObject(this.fieldMatchers),index=[];sendData.forEach((function(d,i){d.templateJson.resultWorkflowContext||index.push(i),d.fieldName&&sendData[i].templateJson.metaJson.fields.push(d.fieldName)})),index&&index.forEach((function(d){sendData.splice(sendData.indexOf(d),1)})),this.$emit("actions",sendData)}}},workflow_FFieldUpdatevue_type_script_lang_js=FFieldUpdatevue_type_script_lang_js,FFieldUpdate_component=(0,componentNormalizer/* default */.Z)(workflow_FFieldUpdatevue_type_script_lang_js,FFieldUpdatevue_type_template_id_bc18fa96_render,FFieldUpdatevue_type_template_id_bc18fa96_staticRenderFns,!1,null,null,null)
/* harmony default export */,FFieldUpdate=FFieldUpdate_component.exports,AlarmRuleActionvue_type_script_lang_js={mixins:[WorkFlowMixin/* default */.Z],components:{FFieldUpdate:FFieldUpdate},data:function(){return{isChanged:!1,templateAction:{actionType:6,templateJson:{fieldMatcher:{problem:null,message:null,possibleCauses:null,severity:null,recommendation:null}}},actions:[],updateField:!1}},props:["model","metric","category","showUpdate","emitData","isSeverity","fields","isUpdate"],computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({alarmseverity:function(state){return state.alarmSeverity}})),{},{selectedCategory:function(){return this.category},customFields:function(){return this.fields}}),watch:{emitData:function(){this.emitData&&this.saveAction()},model:{handler:function(newVal,oldVal){newVal!==oldVal&&this.parseTemplate(newVal)}},"templateAction.templateJson.fieldMatcher":{handler:function(){this.isUpdate&&(this.isChanged=!0)},deep:!0}},mounted:function(){this.model&&this.model.length>0&&this.parseTemplate(this.model)},created:function(){this.$store.dispatch("loadAlarmSeverity")},methods:{parseTemplate:function(){var _this=this;this.model&&this.model.forEach((function(d){6===d.actionType&&(d.template&&d.template.originalTemplate?(_this.templateAction.templateJson.fieldMatcher.severity=d.template.originalTemplate.severity,_this.templateAction.templateJson.fieldMatcher.message=d.template.originalTemplate.message,_this.templateAction.templateJson.fieldMatcher.problem=d.template.originalTemplate.problem,_this.templateAction.templateJson.fieldMatcher.possibleCauses=d.template.originalTemplate.possibleCauses,_this.templateAction.templateJson.fieldMatcher.recommendation=d.template.originalTemplate.recommendation):null!==d.templateJson&&d.templateJson.fieldMatcher.forEach((function(d){_this.templateAction.templateJson.fieldMatcher[d.field]=d.value}))),_this.$forceUpdate()}))},appendActions:function(data){this.actions.push(data)},addUpdateAction:function(data){this.$emit("update:model",data),this.$emit("actions",data)},saveAction:function(){if(this.showUpdate)this.updateField=!0;else{this.isSeverity||delete this.templateAction.templateJson.fieldMatcher.severity;var actions=this.parseAction(this.templateAction);actions.isChanged=this.isChanged,this.$emit("update:model",[actions]),this.$emit("actions",[actions])}}}},workflow_AlarmRuleActionvue_type_script_lang_js=AlarmRuleActionvue_type_script_lang_js,AlarmRuleAction_component=(0,componentNormalizer/* default */.Z)(workflow_AlarmRuleActionvue_type_script_lang_js,AlarmRuleActionvue_type_template_id_1c884c64_render,AlarmRuleActionvue_type_template_id_1c884c64_staticRenderFns,!1,null,null,null)
/* harmony default export */,AlarmRuleAction=AlarmRuleAction_component.exports,TriggerItemvue_type_script_lang_js={props:["context","emitData","fields","metric","category","title","isActions","isCondition","showUpdate","metricFields","isFormule","trigger","isUpdate"],components:{FConditionType:FConditionType,AlarmRuleAction:AlarmRuleAction,FFormulaBuilder:FFormulaBuilder/* default */.Z},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({alarmseverity:function(state){return state.alarmSeverity}})),(0,vuex_esm/* mapGetters */.Se)(["getAssetCategory"])),{},{selectedMetric:function(){return this.metric},selectedCategory:function(){return this.getAssetCategory(this.category)}}),created:function(){this.$store.dispatch("loadAssetCategory"),this.$store.dispatch("loadAlarmSeverity")},data:function(){return{emitaction:!1,isHistory:!0,triggerRule:[],activeNames:["triggerName0"]}},watch:{trigger:{handler:function(newVal,oldVal){this.isHistory&&(this.trigger.isChanged=!0)},deep:!0},model:{handler:function(newVal,oldVal){this.isHistory&&(this.trigger.isChanged=!0)},deep:!0},context:function(){this.editTriggers()},emitData:function(){this.emitData&&(this.isHistory=!1,this.saveTrigger())}},methods:{changedObject:function(trigger){},editTriggers:function(){var _this=this;this.triggerRule=[],this.context&&(this.context.forEach((function(d){d.alarmType={message:"",problem:"",possibleCauses:"",recommendation:""},d.actions&&d.actions[0]&&d.actions[0].template&&d.actions[0].template.originalTemplate&&(d.alarmType.problem=d.actions[0].template.originalTemplate.problem,d.alarmType.possibleCauses=d.actions[0].template.originalTemplate.possibleCauses,d.alarmType.recommendation=d.actions[0].template.originalTemplate.recommendation),_this.triggerRule.push(d)})),this.$forceUpdate())},update:function(data){this.$emit("actions",data)},appendActions:function(data,index){this.triggerRule[index].actions.push(data)},saveTrigger:function(){this.emitaction=!0},deleteTrigger:function(key){this.$delete(this.triggerRule,key)}}},components_TriggerItemvue_type_script_lang_js=TriggerItemvue_type_script_lang_js,TriggerItem_component=(0,componentNormalizer/* default */.Z)(components_TriggerItemvue_type_script_lang_js,TriggerItemvue_type_template_id_6d9ab33e_render,TriggerItemvue_type_template_id_6d9ab33e_staticRenderFns,!1,null,null,null)
/* harmony default export */,TriggerItem=TriggerItem_component.exports,AlarmTriggervue_type_script_lang_js={props:["context","emitData","fields","metric","category","title","isActions","isCondition","showUpdate","metricFields","isFormule","isUpdate"],components:{TriggerItem:TriggerItem},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({alarmseverity:function(state){return state.alarmSeverity}})),(0,vuex_esm/* mapGetters */.Se)(["getAssetCategory"])),{},{selectedMetric:function(){return this.metric},selectedCategory:function(){return this.getAssetCategory(this.category)}}),created:function(){this.$store.dispatch("loadAssetCategory"),this.$store.dispatch("loadAlarmSeverity")},data:function(){return{emitaction:!1,triggerRule:[],activeNames:["triggerName0"]}},watch:{emitData:function(){this.emitData&&this.saveTrigger()}},mounted:function(){this.context&&this.context.length>0?this.editTriggers():this.addTrigger()},methods:{addTrigger:function(){this.triggerRule.push({index:this.triggerRule.length+1,thresholdType:1,onSuccess:!1,isChanged:!0,parentRuleName:null,actions:[],alarmType:{message:"",problem:"",possibleCauses:"",recommendation:""},name:this.title+" "+(this.triggerRule.length+1)})},editTriggers:function(){var _this=this;this.triggerRule=[],this.context&&(this.context.forEach((function(d){d.alarmType={message:"",problem:"",possibleCauses:"",recommendation:""},d.actions&&d.actions[0]&&d.actions[0].template&&d.actions[0].template.originalTemplate&&(d.alarmType.problem=d.actions[0].template.originalTemplate.problem,d.alarmType.possibleCauses=d.actions[0].template.originalTemplate.possibleCauses,d.alarmType.recommendation=d.actions[0].template.originalTemplate.recommendation),_this.triggerRule.push(d)})),this.$forceUpdate())},updateTrigger:function(data,index){this.triggerRule.length-1===index?this.$emit("triggerRule",this.triggerRule):this.triggerRule[index].actions=data},appendActions:function(data,index){this.triggerRule[index].actions.push(data)},saveTrigger:function(){this.emitaction=!0},deleteTrigger:function(key){this.triggerRule[key].isDeleted=!0,this.$forceUpdate()}}},components_AlarmTriggervue_type_script_lang_js=AlarmTriggervue_type_script_lang_js,AlarmTrigger_component=(0,componentNormalizer/* default */.Z)(components_AlarmTriggervue_type_script_lang_js,AlarmTriggervue_type_template_id_65075d68_render,AlarmTriggervue_type_template_id_65075d68_staticRenderFns,!1,null,null,null)
/* harmony default export */,AlarmTrigger=AlarmTrigger_component.exports,NewRulevue_type_script_lang_js={mixins:[WorkFlowMixin/* default */.Z],props:["visibility","ruleObj","ruleId","rules","isEditLoading"],components:{FConditionType:FConditionType,AlarmTrigger:AlarmTrigger,AlarmRuleAction:AlarmRuleAction,SpaceAssetChooser:SpaceAssetChooser/* default */.Z,FFieldUpdate:FFieldUpdate,SpaceAssetMultiChooser:SpaceAssetMultiChooser/* default */.Z},watch:{"rule.alarmTriggerRule":{handler:function(){this.isUpdate&&this.rule.alarmTriggerRule&&(this.rule.alarmTriggerRule.isChanged=!0)},deep:!0}},created:function(){this.$store.dispatch("loadAssetCategory"),this.$store.dispatch("loadAlarmSeverity")},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapGetters */.Se)(["getAssetCategory","getAlarmSeverityByDisplayName"])),{},{customFields:function(){return this.alarmFields}},(0,vuex_esm/* mapState */.rn)({assetCategory:function(state){return state.assetCategory}})),{},{isAsset:function(){return"asset"===this.resourceType},isMultiResource:function(){return this.isAsset&&(!this.rule.preRequsite||this.rule.preRequsite.assetCategoryId>0)},resourceData:function(){return{assetCategory:this.rule.preRequsite.assetCategoryId,isIncludeResource:this.isIncludeResource,selectedResources:Array.isArray(this.selectedResourceList)?this.selectedResourceList.map((function(resource){return{id:resource&&"object"===(0,esm_typeof/* default */.Z)(resource)?resource.id:resource}})):this.selectedResourceList.id}},resourceLabel:function(){var _this=this;if(this.rule.preRequsite.assetCategoryId>0){var message,category=this.assetCategory.filter((function(d){return d.id===_this.rule.preRequsite.assetCategoryId})),selectedCount=this.selectedResourceList.length;if(selectedCount){var includeMsg=this.isIncludeResource?"included":"excluded";if(1===selectedCount)return this.selectedResourceList[0].name;message=selectedCount+" "+category[0].name+(selectedCount>1?"s":"")+" "+includeMsg}else message="All "+category[0].name+"s selected";return message}return this.selectedResourceList.id>0?this.selectedResourceList.name:null}}),data:function(){return{orgId:this.$account.user.orgId,isUpdate:!1,isEdit:!1,emitaction:!1,thresholdFields:[],triggerData:!1,isPrerequest:!1,impactData:!1,fielUpdate:!1,selectedMetricFields:null,rule:{enableRootCause:!1,enableimpacts:!1,isCondition:!1,preRequsite:{name:null,consecutiveoroverperiod:1,dateRange:1,operatorId:null,percentage:null,overperiod:1,occurences:null,description:null,assetCategoryId:null,thresholdType:1,event:{moduleId:37,activityType:1}},isAutoClear:!0,autoClear:!0,reportBreakdown:!1,alarmTriggerRule:{isChanged:!0,consecutiveoroverperiod:1,dateRange:1,operatorId:null,percentage:null,overperiod:1,occurences:null,name:"alarmTriggerRule",actions:[],thresholdType:1,workflow:null,criteria:null},readingAlarmRuleContexts:[],alarmRCARules:[],deletedAlarmRCARules:[],alarmClearRule:{consecutiveoroverperiod:1,dateRange:1,operatorId:null,percentage:null,overperiod:1,occurences:null,name:"alarmClear",thresholdType:1,workflow:null,criteria:null}},resourceQuery:null,isIncludeResource:!1,metricFieldName:null,alarmFields:[],selectedResourceList:[],chooserVisibility:!1,resourceType:"asset"}},updated:function(){this.isUpdate=!0},mounted:function(){this.loadAlarmFields(),this.rules?(this.isEdit=!0,this.initData(this.ruleId)):(this.isEdit=!1,self.rule=null)},methods:{changeClear:function(){this.$forceUpdate()},initData:function(ruleId){this.rule=this.rules.alarmRule,this.parseRule(this.rules.alarmRule)},parseRule:function(rule){var _this2=this;if(rule.preRequsite&&(this.rule.metricFieldName=rule.alarmTriggerRule.readingField.name),rule.preRequsite.assetCategoryId>0?(this.resourceType="asset",rule.preRequsite.includedResources&&rule.preRequsite.includedResources.length?(this.isIncludeResource=!0,this.selectedResourceList=rule.preRequsite.includedResources.map((function(id){return{id:id}}))):rule.preRequsite.excludedResources&&(this.selectedResourceList=rule.preRequsite.excludedResources.map((function(id){return{id:id}}))),this.loadAssets()):(rule.preRequsite.assetCategoryId=null,this.selectedResourceList=rule.preRequsite.matchedResources[Object.keys(rule.preRequsite.matchedResources)[0]],2===this.selectedResourceList.resourceType?(this.resourceType="asset",this.loadAssets(),this.loadThresholdFields()):(this.resourceType="space",this.loadThresholdFields())),this.parseCondition(rule.preRequsite),rule.preRequsite.workflow&&(this.isPrerequest=!0),rule.alarmClearRule?(rule.isAutoClear=!1,rule.autoClear=!1,this.parseCondition(rule.alarmClearRule)):(rule.autoClear=!0,rule.isAutoClear=!0,rule.alarmClearRule={consecutiveoroverperiod:1,dateRange:1,operatorId:null,percentage:null,overperiod:null,occurences:null,name:"alarmClear",thresholdType:1,workflow:null,criteria:null}),this.parseCondition(rule.alarmTriggerRule),rule.alarmRCARules&&(rule.enableRootCause=!0,rule.alarmRCARules.forEach((function(d){d.parentRuleId>0&&Object.keys(rule.alarmRCARules).forEach((function(ds){if(rule.alarmRCARules[ds].id===d.parentRuleId){var preRule=rule.alarmRCARules[ds];d.parentRuleName=preRule.name}})),_this2.parseCondition(d)}))),rule.readingAlarmRuleContexts){for(var enableimpacts=!1,found=!1,i=0;i<rule.readingAlarmRuleContexts.length;i++)if(null!=rule.readingAlarmRuleContexts[i].actions)for(var j=0;j<rule.readingAlarmRuleContexts[i].actions.length;j++)if(22==rule.readingAlarmRuleContexts[i].actions[j].actionType){found=!0;break}rule.reportBreakdown=found,rule.reportBreakdown?rule.readingAlarmRuleContexts.length-1>0&&(enableimpacts=!0):enableimpacts=!0,enableimpacts&&(rule.enableimpacts=!0,rule.readingAlarmRuleContexts.forEach((function(d){d.thresholdType=5,d.workflow&&(rule.isCondition=!0),_this2.parseCondition(d)})))}},parseCondition:function(rule){rule.readingFieldId=rule.readingFieldId<0?null:rule.readingFieldId,4===rule.thresholdType?(rule.minFlapValue=rule.minFlapValue>0?rule.minFlapValue:null,rule.maxFlapValue=rule.maxFlapValue>0?rule.maxFlapValue:null,rule.flapInterval=rule.flapInterval/6e4,rule.flapFrequency=rule.flapFrequency>0?rule.flapFrequency:null):1===rule.thresholdType?(rule.occurences=rule.occurences<=0?null:rule.occurences,rule.operatorId=rule.operatorId<=0?null:rule.operatorId,rule.workflow&&(rule.occurences?(rule.occurences=rule.percentage<0?null:rule.percentage,rule.percentage=rule.workflow.expressions[0].aggregateCondition&&rule.workflow.expressions[0].aggregateCondition[0]?rule.workflow.expressions[0].aggregateCondition[0].value:null,rule.workflow.expressions[0].criteria.conditions["2"]?(rule.consecutiveoroverperiod=1,rule.overperiod=parseInt(rule.workflow.expressions[0].criteria.conditions["2"].value)):rule.consecutiveoroverperiod=2):(rule.occurences=null,rule.overPeriod=1,rule.consecutiveoroverperiod=1))):5===rule.thresholdType||6===rule.thresholdType?(rule.dateRange=rule.dateRange&&-1!==rule.dateRange?rule.dateRange:-1,rule.workflow||(rule.workflow={occurences:{}}),rule.workflow.occurences={occurences:rule.occurences,overPeriod:rule.overPeriod,consecutive:rule.consecutive}):-1===rule.thresholdType&&(rule.thresholdType=1,rule.occurences=null,rule.operatorId=null),delete rule.matchedResources,delete rule.operator},associateResource:function(selectedObj){"asset"===this.resourceType?selectedObj.resourceList&&selectedObj.resourceList.length&&(this.selectedResourceList=selectedObj.resourceList,this.isIncludeResource=selectedObj.isInclude,this.loadThresholdFields(this.isMultiResource)):("space"===this.resourceType&&(this.isIncludeResource=!0),this.selectedResourceList=selectedObj,this.loadThresholdFields(!1)),this.chooserVisibility=!1,this.resourceQuery=null},closeDialog:function(){this.$emit("update:visibility",!1)},addRule:function(){var _this3=this;this.$refs["rule"].validate((function(valid){_this3.isUpdate=!1,valid&&(_this3.emitaction=!0)}))},appendAction:function(data){(this.rule.alarmTriggerRule.isChanged||data[0].isChanged)&&(this.rule.alarmTriggerRule.actions=data),this.rule.enableRootCause?this.rule.enableimpacts?this.rule.isCondition?this.impactData=!0:this.fielUpdate=!0:this.addImpact(null):this.rule.enableimpacts?this.rule.isCondition?this.impactData=!0:this.fielUpdate=!0:(this.rule.readingAlarmRuleContexts=null,this.saveRule(null))},addImpact:function(data){data&&(this.rule.isCondition?(this.rule.readingAlarmRuleContexts=data,this.rule.readingAlarmRuleContexts.forEach((function(d){d.event={moduleName:"alarm",activityType:3}}))):(this.rule.readingAlarmRuleContexts={actions:data},this.rule.readingAlarmRuleContexts.name="Impact 1",this.rule.readingAlarmRuleContexts.event={moduleName:"alarm",activityType:3})),this.rule.enableRootCause?this.triggerData=!0:this.saveRule(null)},saveRule:function(data){var _this4=this;data&&(this.rule.alarmRCARules=data);var ruleObject=this.$helpers.cloneObject(this.rule),metricId=this.thresholdFields.find((function(field){return field.name===ruleObject.metricFieldName})).id;if(ruleObject.preRequsite.readingFieldId=metricId,ruleObject.preRequsite.assetCategoryId>0||(ruleObject.preRequsite.assetCategoryId=-1,ruleObject.preRequsite.resourceId=this.selectedResourceList.id),1===ruleObject.preRequsite.thresholdType&&null===ruleObject.preRequsite.operatorId||this.parseThersholdType(ruleObject.preRequsite,ruleObject.metricFieldName),this.isPrerequest||(ruleObject.preRequsite.workflow=null,ruleObject.preRequsite.workflowId=-99,ruleObject.preRequsite.operatorId=-99,ruleObject.preRequsite.percentage=""),this.selectedResourceList){var fieldName=this.isIncludeResource?"includedResources":"excludedResources",emptyFields="includedResources"===fieldName?"excludedResources":"includedResources";ruleObject.preRequsite[fieldName]=Array.isArray(this.selectedResourceList)?this.selectedResourceList.map((function(resource){return resource.id})):null,ruleObject.preRequsite[emptyFields]=null}if(ruleObject.isAutoClear?(ruleObject.autoClear=!0,ruleObject.alarmClearRule=null):(ruleObject.autoClear=!1,ruleObject.isAutoClear=!1),ruleObject.alarmClearRule&&ruleObject.alarmClearRule.readingFieldId>0?this.parseThersholdType(ruleObject.alarmClearRule,ruleObject.metricFieldName):ruleObject.isAutoClear?(ruleObject.autoClear=!0,ruleObject.alarmClearRule=null):(ruleObject.autoClear=!1,ruleObject.isAutoClear=!1),ruleObject.alarmTriggerRule&&(ruleObject.alarmTriggerRule.isChanged||ruleObject.alarmTriggerRule.actions[0].isChanged)?(ruleObject.alarmTriggerRule.readingFieldId=metricId,this.parseThersholdType(ruleObject.alarmTriggerRule,ruleObject.metricFieldName),ruleObject.alarmTriggerRule.resourceId=this.selectedResourceList.id):ruleObject.alarmTriggerRule=null,ruleObject.alarmRCARules){var spliceRule=[],deleteAlarm=[];ruleObject.alarmRCARules.forEach((function(d,i){if(d.isChanged||d.actions[0].isChanged){var problem=d.actions[0].templateJson.fieldMatcher.filter((function(d){return"problem"===d.field}));problem.length>0&&(d.name=d.actions[0].templateJson.fieldMatcher.filter((function(d){return"problem"===d.field}))[0].value),d.readingFieldId=metricId,_this4.parseThersholdType(d,ruleObject.metricFieldName),delete d.alarmType}else d.isDeleted?(spliceRule.push(i),deleteAlarm.push(d)):ruleObject.enableRootCause?spliceRule.push(i):(spliceRule.push(i),deleteAlarm.push(d))})),ruleObject.deletedAlarmRCARules=deleteAlarm,spliceRule=spliceRule.reverse(),spliceRule.forEach((function(d){ruleObject.alarmRCARules.splice(d,1)})),ruleObject.enableRootCause||(ruleObject.alarmRCARules=null)}if(ruleObject.enableimpacts&&(ruleObject.isCondition?ruleObject.readingAlarmRuleContexts.forEach((function(d){d.thresholdType=5,d.readingFieldId=metricId,_this4.parseThersholdType(d,ruleObject.metricFieldName)})):ruleObject.readingAlarmRuleContexts=[ruleObject.readingAlarmRuleContexts]),ruleObject.reportBreakdown){var reportDowntime={actions:[{actionType:22,templateJson:{}}],name:"Report Downtime",event:{moduleName:"alarm",activityType:1}};if(ruleObject.readingAlarmRuleContexts){for(var found=!1,i=0;i<ruleObject.readingAlarmRuleContexts.length;i++)for(var j=0;j<ruleObject.readingAlarmRuleContexts[i].actions.length;j++)if(22==ruleObject.readingAlarmRuleContexts[i].actions[j].actionType){found=!0;break}found||ruleObject.readingAlarmRuleContexts.push(reportDowntime)}else ruleObject.readingAlarmRuleContexts=[reportDowntime]}else if(!ruleObject.readingAlarmRuleContexts&&null!=ruleObject.readingAlarmRuleContexts)for(var k=0;k<ruleObject.readingAlarmRuleContexts.length;k++)for(var l=0;l<ruleObject.readingAlarmRuleContexts[k].actions.length;l++)22==ruleObject.readingAlarmRuleContexts[k].actions[l].actionType&&ruleObject.readingAlarmRuleContexts.splice(k,1);if(this.isEdit&&(delete ruleObject.allRuleList,ruleObject.preRequsite&&ruleObject.preRequsite.matchedResources&&delete ruleObject.preRequsite.matchedResources,ruleObject.alarmClearRule&&ruleObject.alarmClearRule.matchedResources&&delete ruleObject.alarmClearRule.matchedResources,ruleObject.alarmRCARules&&ruleObject.alarmRCARules.forEach((function(d){delete d.matchedResources})),ruleObject.readingAlarmRuleContexts&&ruleObject.readingAlarmRuleContexts.forEach((function(d){delete d.matchedResources}))),ruleObject.alarmTriggerRule&&ruleObject.alarmTriggerRule.actions){var alarmSeverity=ruleObject.alarmTriggerRule.actions[0].templateJson.fieldMatcher.find((function(d){return"severity"===d.field})).value;alarmSeverity&&(ruleObject.preRequsite.alarmSeverityId=this.getAlarmSeverityByDisplayName(alarmSeverity).id)}this.$util.newAddRule("alarm",{alarmRule:ruleObject},this.isEdit).then((function(rule){_this4.$emit("saved",!0),_this4.$emit("onSaveRule",rule),_this4.closeDialog()})).catch((function(error){error&&(_this4.triggerData=!1,_this4.impactData=!1,_this4.emitaction=!1,_this4.fielUpdate=!1,_this4.$message({message:error,type:"error"}))}))},loadAssets:function(){var self=this,url="/asset/all";this.$http.get(url).then((function(response){response.data&&(self.isnew&&!self.isDependant||(self.isMultiResource?self.selectedResourceList=response.data.assets.filter((function(asset){return self.selectedResourceList.some((function(resource){return resource.id===asset.id}))})):self.selectedResource=response.data.assets.find((function(asset){return asset.id===self.selectedResource.id})),self.loadThresholdFields(self.isMultiResource)))}))},addParam:function(name,type,data){data.workflow.parameters||(data.workflow.parameters=[]);var params=data.workflow.parameters;params.find((function(param){return param.name===name}))||params.push({name:name,typeString:type||"String"})},parseThersholdType:function(readingRule,metricFieldName){if(1===readingRule.thresholdType){var isExpressionValue="${previousValue}"===readingRule.percentage;!readingRule.hasOwnProperty("occurences")||readingRule.occurences<=0?(readingRule.occurences=readingRule.occurences>0?readingRule.occurences:null,readingRule.workflow={expressions:[],resultEvaluator:"",parameters:[{name:"resourceId",typeString:"Number"}]},readingRule.workflow.expressions.push({name:"a",aggregateString:"lastValue",fieldName:metricFieldName,moduleName:this.thresholdFields.find((function(field){return field.name===metricFieldName})).module.name,aggregateCondition:[],criteria:{pattern:"(1)",conditions:{1:{fieldName:"parentId",operatorId:9,sequence:"1",value:this.isMultiResource?"${resourceId}":this.selectedResourceList.id}}}}),delete readingRule.criteria,readingRule.workflow.resultEvaluator="a"+this.getOperatorSymbol(readingRule.operatorId)+(isExpressionValue?"previousValue":readingRule.percentage)):(delete readingRule.criteria,readingRule.workflow={expressions:[],resultEvaluator:"",parameters:[{name:"resourceId",typeString:"Number"}]},readingRule.workflow.expressions.push({name:"a",aggregateString:"count",fieldName:metricFieldName,moduleName:this.thresholdFields.find((function(field){return field.name===metricFieldName})).module.name,aggregateCondition:[],criteria:{pattern:"(1)",conditions:{1:{fieldName:"parentId",operatorId:9,sequence:"1",value:this.isMultiResource?"${resourceId}":this.selectedResourceList.id}}}}),readingRule.workflow.expressions[0].aggregateCondition.push({fieldName:metricFieldName,operatorId:readingRule.operatorId,sequence:"1",value:readingRule.percentage}),2===readingRule.consecutiveoroverperiod?(readingRule.workflow.expressions[0].aggregateString="count",readingRule.workflow.expressions[0].orderByFieldName="ttime",readingRule.workflow.expressions[0].sortBy="desc",readingRule.workflow.expressions[0].limit=readingRule.occurences):(readingRule.workflow.expressions[0].criteria.pattern="(1 and 2)",readingRule.workflow.expressions[0].criteria.conditions["2"]={fieldName:"ttime",operatorId:42,sequence:"2",value:readingRule.overperiod+",${ttime}"},this.addParam("ttime","Number",readingRule)),readingRule.percentage=readingRule.occurences,readingRule.workflow.resultEvaluator="a=="+readingRule.occurences)}else if(2===readingRule.thresholdType)readingRule.workflow={expressions:[],resultEvaluator:"",parameters:[{name:"resourceId",typeString:"Number"}]},readingRule.workflow.expressions.push({name:"a",aggregateString:readingRule.aggregation,fieldName:this.thresholdFields.find((function(field){return field.name===metricFieldName})).name,moduleName:this.thresholdFields.find((function(field){return field.name===metricFieldName})).module.name,criteria:{pattern:"(1 and 2)",conditions:{1:{fieldName:"parentId",operatorId:9,sequence:"1",value:this.isMultiResource?"${resourceId}":this.selectedResourceList.id},2:{fieldName:"ttime",operatorId:42,sequence:"2",value:readingRule.dateRange+",${ttime}"}}},aggregateCondition:[]}),this.addParam("ttime","Number",readingRule),"ccount"===readingRule.aggregation&&(readingRule.workflow.expressions[0].aggregateString="count",readingRule.workflow.expressions[0].orderByFieldName="ttime",readingRule.workflow.expressions[0].sortBy="desc",readingRule.workflow.expressions[0].limit=readingRule.percentage),readingRule.workflow.resultEvaluator="a"+this.getOperatorSymbol(readingRule.operatorId)+readingRule.percentage;else if(3===readingRule.thresholdType){readingRule.workflow={expressions:[],resultEvaluator:"",parameters:[{name:"resourceId",typeString:"Number"}]};var baselineExp={name:"a",aggregateString:readingRule.aggregation,fieldName:this.thresholdFields.find((function(field){return field.name===metricFieldName})).name,moduleName:this.thresholdFields.find((function(field){return field.name===metricFieldName})).module.name,criteria:{pattern:"(1 and 2)",conditions:{1:{fieldName:"parentId",operatorId:9,sequence:"1",value:this.isMultiResource?"${resourceId}":this.selectedResourceList.id},2:{fieldName:"ttime",operatorId:42,sequence:"2",value:readingRule.dateRange+",${ttime}"}}},conditionSeqVsBaselineId:{2:readingRule.baselineId}};this.addParam("ttime","Number",readingRule),readingRule.workflow.expressions.push(baselineExp);var baselineExpB=this.$helpers.cloneObject(baselineExp);baselineExpB.name="b",baselineExpB.conditionSeqVsBaselineId=null,readingRule.workflow.expressions.push(baselineExpB),readingRule.workflow.resultEvaluator="((b-a)/a)*100"+this.getOperatorSymbol(readingRule.operatorId)+readingRule.percentage}else 4===readingRule.thresholdType?readingRule.flapInterval=6e4*readingRule.flapInterval:5!==readingRule.thresholdType&&6!==readingRule.thresholdType||readingRule.workflow&&readingRule.workflow.occurences&&Object.assign(readingRule,readingRule.workflow.occurences)}}},rules_NewRulevue_type_script_lang_js=NewRulevue_type_script_lang_js,NewRule_component=(0,componentNormalizer/* default */.Z)(rules_NewRulevue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,NewRule=NewRule_component.exports},
/***/353654:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"d7f1f315aba97cd14240ee6f3d34465f.svg";
/***/},
/***/385769:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"4a9843791f38c4a28fdf9f0a4584780d.svg";
/***/}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/88868.js.map