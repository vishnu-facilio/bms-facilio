"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[7356,32686,80865,53021],{
/***/538772:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return QuotationSummary}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/quotation/v1/QuotationSummary.vue?vue&type=template&id=7ac8aaf5
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"custom-modules-overview overflow-y-scroll",class:_vm.$validation.isEmpty(_vm.customClass)?"":_vm.customClass},[!_vm.isLoading&&_vm.customModuleData?_c("div",{staticClass:"header pT10 pB15 pL20 pR20"},[_vm.$validation.isEmpty(_vm.customModuleData)?_vm._e():_c("div",{staticClass:"asset-details"},[_c("div",{staticClass:"d-flex flex-middle"},[_vm.showPhotoField?_c("div",[_vm.customModuleData[_vm.photoFieldName]?_c("div",[_c("img",{staticClass:"img-container",attrs:{src:_vm.getImage(_vm.customModuleData[_vm.photoFieldName])}})]):_vm.showAvatar?_c("div",[_c("avatar",{attrs:{size:"lg",user:{name:_vm.customModuleData.name}}})],1):_vm._e()]):_vm._e(),_c("div",{staticClass:"mL5"},[_c("div",{staticClass:"asset-name mb5 mT10"},[_vm._v(" "+_vm._s(_vm.customModuleData[_vm.mainFieldKey])+" "),_vm.currentModuleState?_c("div",{staticClass:"fc-badge text-uppercase inline vertical-middle mL15"},[_vm._v(" "+_vm._s(_vm.currentModuleState)+" ")]):_vm._e()]),_c("div",{staticClass:"asset-id mT10"},[_vm.$account.portalInfo?_c("i",{directives:[{name:"tippy",rawName:"v-tippy",value:{animateFill:!1,animation:"shift-toward"},expression:"{ animateFill: false, animation: 'shift-toward' }"}],staticClass:"el-icon-back fc-grey3-text14 fw6 pR10 pointer",attrs:{content:"back",arrow:""},on:{click:_vm.back}}):_vm._e(),_vm._v(" #"+_vm._s(_vm.customModuleData.parentId)+" ")])])])]),_c("div",{staticClass:"d-flex flex-direction-row",staticStyle:{"margin-left":"auto"}},[_c("el-button-group",{staticClass:"fc-group-btn2 flex-middle"},[_c("el-button",{attrs:{type:"primary"},on:{click:_vm.downloadQuotation}},[_c("inline-svg",{attrs:{src:"svgs/download2",iconClass:"icon vertical-middle icon-sm fill-grey2"}})],1),_c("el-button",{attrs:{type:"primary"},on:{click:_vm.openPrintPreview}},[_c("inline-svg",{attrs:{src:"svgs/print2",iconClass:"icon vertical-middle icon-sm fill-grey2"}})],1),_c("el-button",{attrs:{type:"primary"},on:{click:_vm.sendQuotationMail}},[_c("inline-svg",{attrs:{src:"svgs/mail",iconClass:"icon vertical-middle icon-sm fill-grey2"}})],1)],1),_c("CustomButton",{staticClass:"p10",attrs:{record:_vm.customModuleData,moduleName:_vm.moduleName,position:_vm.POSITION.SUMMARY},on:{refresh:function($event){return _vm.refreshObj(!0)},onError:function(){}}}),_vm.downloadUrl?_c("iframe",{staticStyle:{display:"none"},attrs:{src:_vm.downloadUrl}}):_vm._e(),_vm.isStateFlowEnabled?[_c("TransitionButtons",{key:_vm.customModuleData.id,staticClass:"mR10",attrs:{moduleName:_vm.moduleName,record:_vm.customModuleData,disabled:_vm.isApprovalEnabled,buttonClass:"asset-el-btn"},on:{currentState:function(){},transitionSuccess:function($event){return _vm.refreshObj(!0)},transitionFailure:function(){}}})]:_vm._e(),_vm.isApprovalEnabled?_c("portal",{attrs:{to:"pagebuilder-sticky-top"}},[_c("ApprovalBar",{key:_vm.customModuleData.id+"approval-bar",staticClass:"approval-bar-shadow",attrs:{moduleName:_vm.moduleName,record:_vm.customModuleData,hideApprovers:_vm.shouldHideApprovers},on:{onSuccess:function($event){return _vm.refreshObj()},onFailure:function(){}}})],1):_vm._e(),_vm.$hasPermission(_vm.moduleName+":UPDATE")?_c("el-dropdown",{staticClass:"mL10 self-center fc-btn-ico-lg pT3 pB3 pL8 pR8 pointer",attrs:{trigger:"click"},on:{command:function(action){return _vm.summaryDropDownAction(action)}}},[_c("span",{staticClass:"el-dropdown-link"},[_c("inline-svg",{staticClass:"vertical-middle",attrs:{src:"svgs/menu",iconClass:"icon icon-md"}})],1),_c("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[_c("el-dropdown-item",{key:1,attrs:{command:"associateterms"}},[_vm._v("Associate Terms")]),_vm.isRecordLocked||4!==_vm.customModuleData.customerType||_vm.isParentQuoteExists?_vm._e():_c("el-dropdown-item",{key:2,attrs:{command:"createCustomerQuote"}},[_vm._v("Convert to User Quote")]),_vm.showOptionViewCustomerQuote?_c("el-dropdown-item",{key:3,attrs:{command:"redirecttocustomerquote"}},[_vm._v("View Customer Quote")]):_vm._e(),_vm.isRecordLocked?_vm._e():_c("el-dropdown-item",{key:4,attrs:{command:"edit"}},[_vm._v("Edit")]),_vm.canShowRevise?_c("el-dropdown-item",{key:5,attrs:{command:"revise"}},[_vm._v("Revise")]):_vm._e()],1)],1):_vm._e()],2)]):_vm._e(),!_vm.isLoading&&_vm.customModuleData&&_vm.customModuleData.id?_c("page",{key:_vm.customModuleData.id,attrs:{module:_vm.moduleName,id:_vm.customModuleData.id,details:_vm.customModuleData,primaryFields:_vm.primaryFields,notesModuleName:_vm.notesModuleName,attachmentsModuleName:_vm.attachmentsModuleName,isV3Api:!0}}):_vm._e(),_c("el-dialog",{staticClass:"dialog-d",attrs:{visible:_vm.showDeleteDialog,"custom-class":"setup-dialog45","show-close":!1},on:{"update:visible":function($event){_vm.showDeleteDialog=$event}}},[_c("div",{staticClass:"text-center fc-black-20"},[_vm._v(" Do you want to delete or dissociate from "+_vm._s(_vm.moduleName?_vm.moduleName:"")+" ? ")]),_c("span",{staticClass:"fc-dialog-center-container delete-dialog-footer padding-px18",attrs:{slot:"footer"},slot:"footer"},[_c("el-button",{on:{click:function($event){_vm.showDeleteDialog=!1}}},[_vm._v("CANCEL")]),_c("el-button",{staticClass:"delete-dissociate-buttons",on:{click:function($event){return _vm.dissociate()}}},[_vm._v("DISSOCIATE")]),_c("el-button",{staticClass:"delete-dissociate-buttons",on:{click:function($event){return _vm.deleteRecord()}}},[_vm._v("MOVE TO RECYCLE BIN")])],1)]),_vm.associateTermsDialogVisibility?_c("QuotationTermsDialog",{attrs:{visibility:_vm.associateTermsDialogVisibility,record:_vm.customModuleData,associateUrl:"v2/quotation/associateTerms"},on:{"update:visibility":function($event){_vm.associateTermsDialogVisibility=$event},refreshSummary:_vm.refreshObj}}):_vm._e(),_vm.showMarkupDialog?_c("el-dialog",{staticClass:"agents-dialog fc-dialog-center-container fc-dialog-center-container-2",staticStyle:{"z-index":"9999999999"},attrs:{title:"Download Preferences",visible:_vm.showMarkupDialog,width:"40%","append-to-body":!0,"before-close":_vm.closemarkupDialog},on:{"update:visible":function($event){_vm.showMarkupDialog=$event}}},[_c("div",{staticClass:"label-txt-black line-height24"},[_c("el-checkbox",{model:{value:_vm.withMarkup,callback:function($$v){_vm.withMarkup=$$v},expression:"withMarkup"}},[_vm._v("Download With Markup Value")]),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-save f13 w100",on:{click:function($event){return _vm.downloadQuote(_vm.selectedRecord)}}},[_vm._v(_vm._s("Download"))])],1)],1)]):_vm._e()],1)},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),objectSpread2=__webpack_require__(595082),Overview=(__webpack_require__(634338),__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(434284),__webpack_require__(648324),__webpack_require__(670560),__webpack_require__(659749),__webpack_require__(386544),__webpack_require__(422273)),vuex_esm=__webpack_require__(420629),api=__webpack_require__(32284),TermsAssociationDialog=__webpack_require__(137287),eventBus=__webpack_require__(398011),validation=__webpack_require__(990260),CustomButton=__webpack_require__(623857),CustomButtonUtil=__webpack_require__(746095),cloneDeep=__webpack_require__(150361),cloneDeep_default=__webpack_require__.n(cloneDeep),router=__webpack_require__(329435),orgIdVsRevisionStatus={274:"rejectedbycustomer",407:"quoterevision"},QuotationSummaryvue_type_script_lang_js={extends:Overview/* default */.Z,components:{QuotationTermsDialog:TermsAssociationDialog/* default */.Z,CustomButton:CustomButton/* default */.Z},data:function(){return{childQuotes:[],isParentQuoteExists:!1,notesModuleName:"quotenotes",attachmentsModuleName:"quoteattachments",primaryFields:["subject","billToAddress","billDate","description","expiryDate","contact"],quotationDetails:null,associateTermsDialogVisibility:!1,downloadUrl:null,POSITION:CustomButtonUtil/* POSITION_TYPE */.Rz,quoteFormsList:[],withMarkup:!0,showMarkupDialog:!1,selectedRecord:null}},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({childQuote:function(){return this.childQuotes.length?this.childQuotes[0]:null},currentView:function(){return this.viewName?this.viewName:this.$route.params.viewname?this.$route.params.viewname:"all"},showOptionViewCustomerQuote:function(){var customerType=this.quotationDetails.customerType;return!(!this.isParentQuoteExists||null===this.childQuote||4!==customerType)},getCustomerTypeByApp:function(){return"tenant"===(0,router/* getApp */.wx)().linkName?"1":"client"===(0,router/* getApp */.wx)().linkName?"2":"vendor"===(0,router/* getApp */.wx)().linkName?"4":"occupant"===(0,router/* getApp */.wx)().linkName?"3":null},getCustomerTypeFromParent:function(){var _this$quotationDetail;return null!==(_this$quotationDetail=this.quotationDetails)&&void 0!==_this$quotationDetail&&null!==(_this$quotationDetail=_this$quotationDetail.workorder)&&void 0!==_this$quotationDetail&&null!==(_this$quotationDetail=_this$quotationDetail.tenant)&&void 0!==_this$quotationDetail&&_this$quotationDetail.id?1:2},getWokorderTenant:function(){var _this$quotationDetail2;return null!==(_this$quotationDetail2=this.quotationDetails)&&void 0!==_this$quotationDetail2&&null!==(_this$quotationDetail2=_this$quotationDetail2.workorder)&&void 0!==_this$quotationDetail2&&null!==(_this$quotationDetail2=_this$quotationDetail2.tenant)&&void 0!==_this$quotationDetail2&&_this$quotationDetail2.id?this.quotationDetails.workorder.tenant.id:null},getWokorder:function(){var _this$quotationDetail3;return null!==(_this$quotationDetail3=this.quotationDetails)&&void 0!==_this$quotationDetail3&&null!==(_this$quotationDetail3=_this$quotationDetail3.workorder)&&void 0!==_this$quotationDetail3&&_this$quotationDetail3.id?this.quotationDetails.workorder.id:null},getWokorderClinet:function(){var _this$quotationDetail4;return null!==(_this$quotationDetail4=this.quotationDetails)&&void 0!==_this$quotationDetail4&&null!==(_this$quotationDetail4=_this$quotationDetail4.workorder)&&void 0!==_this$quotationDetail4&&null!==(_this$quotationDetail4=_this$quotationDetail4.client)&&void 0!==_this$quotationDetail4&&_this$quotationDetail4.id?this.quotationDetails.workorder.client.id:null},moduleName:function(){return"quote"}},(0,vuex_esm/* mapGetters */.Se)(["getTicketStatus"])),{},{mainFieldKey:function(){return"subject"},customModuleData:function(){return this.quotationDetails}},(0,vuex_esm/* mapState */.rn)({ticketStatus:function(state){return state.ticketStatus.quote}})),{},{pdfUrl:function(){var url,id=this.id,appName=(0,router/* getApp */.wx)().linkName,record=this.customModuleData;return url=(0,router/* isWebTabsEnabled */.tj)()?this.canShowMarkup(record)&&this.withMarkup?"/".concat(appName,"/pdf/quotationpdf?quotationId=").concat(id,"&withmarkup=true"):this.canShowMarkup(record)&&!this.withMarkup?"/".concat(appName,"/pdf/quotationpdf?quotationId=").concat(id,"&withmarkup=false"):"/".concat(appName,"/pdf/quotationpdf?quotationId=").concat(id):"/app/pdf/quotationpdf?quotationId=".concat(id),window.location.protocol+"//"+window.location.host+url},moduleStateId:function(){return this.$getProperty(this,"customModuleData.moduleState.id")},canShowRevise:function(){var status=this.getTicketStatus(this.moduleStateId,"quote");return(orgIdVsRevisionStatus[this.$org.id]||"Sent")===(status||{}).status}}),title:function(){},mounted:function(){eventBus/* eventBus */.Y.$on("refesh-parent",this.refreshObj),this.loadCustomerQuote(),this.loadQuoteDependencies()},beforeDestroy:function(){eventBus/* eventBus */.Y.$off("refesh-parent",this.refreshObj)},methods:{downloadQuotation:function(){this.selectedRecord=null,this.showMarkupDialog=!1;var record=this.customModuleData;this.canShowMarkup(record)?(this.selectedRecord=record,this.showMarkupDialog=!0):this.downloadQuote(record)},closemarkupDialog:function(){this.showMarkupDialog=!1,this.selectedRecord=!1},downloadQuote:function(){var _this=this;this.closemarkupDialog(),this.downloadUrl=null,this.$message({message:"Downloading...",showClose:!0,duration:0});var additionalInfo={showFooter:!1,footerStyle:"p {font-size:12px; margin-left:500px}",footerHtml:'<p>Page  <span class="pageNumber"></span> / <span class="totalPages"></span></p>'};api/* API */.bl.post("/v2/integ/pdf/create",{url:this.pdfUrl,additionalInfo:additionalInfo}).then((function(_ref){var data=_ref.data,error=_ref.error;if(_this.$message.closeAll(),error){var _error$message=error.message,message=void 0===_error$message?"Unable to fetch quote download link":_error$message;_this.$message.error(message)}else{var _ref2=data||{},fileUrl=_ref2.fileUrl;_this.downloadUrl=fileUrl||null}_this.withMarkup=!0}))},canShowMarkup:function(){var _this$quotationDetail5;return(null===(_this$quotationDetail5=this.quotationDetails)||void 0===_this$quotationDetail5?void 0:_this$quotationDetail5.showMarkupValue)||!1},getRedirectFormId:function(cusType){var customerType=this.quotationDetails.customerType;if(cusType&&(customerType=cusType),customerType>-1){var customerTypeToFormsMap={1:"tenantquoteform",2:"clientquoteform",3:"default_quote_web_maintenance",4:"vendorquoteform"};if(customerType){var form=this.quoteFormsList.find((function(rt){return rt.name===customerTypeToFormsMap[customerType]?rt:null}));if(null!==form&&void 0!==form&&form.id)return form.id}}else if(this.quoteFormsList.length&&this.quoteFormsList[0]&&this.quoteFormsList[0].id)return this.quoteFormsList[0].id;return null},loadQuoteDependencies:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.next=2,_this2.loadQuoteForms();case 2:case"end":return _context.stop()}}),_callee)})))()},loadQuoteForms:function(){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var url,_yield$API$get,data,error,message,_ref3,_ref3$forms,forms;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return url="/v2/forms?moduleName=".concat("quote"),_context2.next=3,api/* API */.bl.get(url);case 3:_yield$API$get=_context2.sent,data=_yield$API$get.data,error=_yield$API$get.error,error?(message=error.message,_this3.$message.error(message)):(_ref3=data||{},_ref3$forms=_ref3.forms,forms=void 0===_ref3$forms?[]:_ref3$forms,_this3.quoteFormsList=forms);case 7:case"end":return _context2.stop()}}),_callee2)})))()},getFormIdfromQuote:function(){return this.getRedirectFormId(this.getCustomerTypeFromParent)},loadCustomerQuote:function(){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var _ref4,_ref4$page,page,_ref4$perPage,perPage,moduleName,id,filters,params,url,_yield$API$get2,data;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return _ref4=_this4||{},_ref4$page=_ref4.page,page=void 0===_ref4$page?1:_ref4$page,_ref4$perPage=_ref4.perPage,perPage=void 0===_ref4$perPage?1:_ref4$perPage,moduleName=_ref4.moduleName,id=_this4.id,filters={parentQuotationId:{operatorId:36,value:[id+""]},oneLevelLookup:{}},(0,validation/* isEmpty */.xb)(filters)||(filters=JSON.stringify(filters)),params={includeParentFilter:!0,page:page,perPage:perPage,moduleName:moduleName,withCount:!0,filters:filters},url="/v3/modules/data/list",_context3.next=8,api/* API */.bl.get(url,params);case 8:_yield$API$get2=_context3.sent,data=_yield$API$get2.data,null!==data&&void 0!==data&&data.quote&&data.quote.length&&(_this4.childQuotes=data.quote,_this4.isParentQuoteExists=!0);case 11:case"end":return _context3.stop()}}),_callee3)})))()},refreshObj:function(refreshList){this.loadCustomModuleData(),refreshList&&this.$emit("refreshSummaryList",!0)},loadCustomModuleData:function(){var _this5=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){var _yield$API$fetchRecor,quote,error,_error$message2,message;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:return _this5.isLoading=!0,_context4.next=3,api/* API */.bl.fetchRecord("quote",{id:_this5.id},{force:!0});case 3:_yield$API$fetchRecor=_context4.sent,quote=_yield$API$fetchRecor.quote,error=_yield$API$fetchRecor.error,(0,validation/* isEmpty */.xb)(error)?_this5.quotationDetails=quote:(_error$message2=error.message,message=void 0===_error$message2?"Error Occured while fetching Quote":_error$message2,_this5.$message.error(message)),_this5.isLoading=!1;case 8:case"end":return _context4.stop()}}),_callee4)})))()},editCustomModuleData:function(){var id=this.id,moduleName=this.moduleName;if((0,router/* isWebTabsEnabled */.tj)()){var _ref5=(0,router/* findRouteForModule */.Jp)(moduleName,router/* pageTypes */.As.EDIT)||{},name=_ref5.name;name&&this.$router.push({name:name,params:{id:id}})}else this.$router.push({path:"/app/tm/quotation/edit/".concat(id)})},transformFormData:function(returnObj,data){return returnObj["quote"]=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},returnObj["quote"]),data),returnObj},summaryDropDownAction:function(action){"edit"===action?this.editCustomModuleData(this.customModuleData):"associateterms"===action?this.associateTermsDialogVisibility=!0:"revise"===action?this.reviseQuotation():"createCustomerQuote"===action?this.createCustomerQuoteAction():"redirecttocustomerquote"===action&&this.redirectToCustomerQuote()},redirectToCustomerQuote:function(){var _this6=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee5(){var currentView,moduleName,id,_ref6,name;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context5){while(1)switch(_context5.prev=_context5.next){case 0:(0,router/* isWebTabsEnabled */.tj)()&&(currentView=_this6.currentView,moduleName=_this6.moduleName,id=_this6.childQuote.id,_ref6=(0,router/* findRouteForModule */.Jp)(moduleName,router/* pageTypes */.As.OVERVIEW)||{},name=_ref6.name,name&&_this6.$router.push({name:name,params:{viewname:currentView,id:id},query:_this6.$route.query}));case 1:case"end":return _context5.stop()}}),_callee5)})))()},createCustomerQuoteAction:function(){var quote=cloneDeep_default()(this.quotationDetails),formId=this.getFormIdfromQuote(quote),query={customerType:2,subject:quote.subject,description:quote.description||"",lineItems:quote.lineItems||[],siteId:quote.siteId,parentQuotationId:quote.id};if(null!==this.getWokorder&&(query["workorder"]=this.getWokorder),null!==this.getWokorderTenant&&(query["tenant"]=this.getWokorderTenant),null!==this.getWokorderClinet&&(query["client"]=this.getWokorderClinet),null!==quote&&void 0!==quote&&quote.billDate&&(query["billDate"]=quote.billDate),null!==quote&&void 0!==quote&&quote.expiryDate&&(query["expiryDate"]=quote.expiryDate),null!==quote&&void 0!==quote&&quote.markup&&(query["markup"]=quote.markup),formId&&(query["formId"]=formId),query["customerType"]=this.getCustomerTypeFromParent,(0,router/* isWebTabsEnabled */.tj)()){var _ref7=(0,router/* findRouteForModule */.Jp)("quote",router/* pageTypes */.As.CREATE)||{},name=_ref7.name;name&&this.$router.push({name:name,query:query})}},reviseQuotation:function(){var id=this.id,moduleName=this.moduleName;if((0,router/* isWebTabsEnabled */.tj)()){var _ref8=(0,router/* findRouteForModule */.Jp)(moduleName,router/* pageTypes */.As.EDIT)||{},name=_ref8.name;name&&this.$router.push({name:name,params:{id:id},query:{revise:!0}})}else this.$router.push({path:"/app/tm/quotation/edit/".concat(id,"?revise=true")})},openPrintPreview:function(){window.open(this.pdfUrl)},sendQuotationMail:function(){(0,validation/* isEmpty */.xb)(this.quotationDetails.contact)?this.$message.error("There is no contact information associated for the quotation"):this.$router.push({path:"sendmail"})},back:function(){if((0,router/* isWebTabsEnabled */.tj)()){var _ref9=(0,router/* findRouteForModule */.Jp)(this.moduleName,router/* pageTypes */.As.LIST)||{},name=_ref9.name;name&&this.$router.push({name:name})}else this.$router.go(-1)}}},v1_QuotationSummaryvue_type_script_lang_js=QuotationSummaryvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(v1_QuotationSummaryvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,QuotationSummary=component.exports},
/***/137287:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return TermsAssociationDialog}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/quotation/v1/TermsAssociationDialog.vue?vue&type=template&id=1b969984
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.visibility?_c("div",[_c("el-dialog",{attrs:{visible:_vm.visibility,title:_vm.$t("common.header.associate_terms"),fullscreen:!1,open:"top",width:"65%","before-close":_vm.closeDialog,"custom-class":"fc-dialog-center-container","append-to-body":!0},on:{"update:visible":function($event){_vm.visibility=$event}}},[_c("div",{staticClass:"height350"},[_c("el-table",{directives:[{name:"loading",rawName:"v-loading",value:_vm.loading,expression:"loading"}],ref:"table1",staticClass:"inventory-inner-table width100 termAsscociationTable ",attrs:{data:_vm.termsAndConditionTableList,height:"320","empty-text":_vm.$t("common.products.no_tc_available_associate"),"default-sort":{prop:"name",order:"descending"}},on:{"selection-change":_vm.selectTandC}},[_c("el-table-column",{attrs:{width:"60",type:"selection"}}),_c("el-table-column",{attrs:{prop:"name",sortable:"",label:_vm.$t("common.products._name")}}),_c("el-table-column",{attrs:{prop:"shortDesc",label:_vm.$t("common.products.short_description")}})],1)],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){return _vm.closeDialog()}}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.saving},on:{click:function($event){return _vm.associateTerms()}}},[_vm._v(_vm._s(_vm.$t("common._common.add")))])],1)])],1):_vm._e()},staticRenderFns=[],createForOfIteratorHelper=__webpack_require__(566347),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),api=(__webpack_require__(648324),__webpack_require__(450886),__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(670560),__webpack_require__(32284)),validation=__webpack_require__(990260),TermsAssociationDialogvue_type_script_lang_js={props:["visibility","record","associateUrl"],data:function(){return{loading:!1,saving:!1,selectedTandC:[],termsAndConditionTableList:[]}},created:function(){this.loadAllTermsAndConditions()},methods:{closeDialog:function(){this.$emit("update:visibility",!1)},selectTandC:function(list){this.selectedTandC=list},loadAllTermsAndConditions:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var params,_yield$API$fetchAll,list,error,termsAssociated,associatedTermsId;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _this.loading=!0,params={filters:JSON.stringify({isPublished:{operatorId:15,value:["true"]},isRevised:{operatorId:15,value:["false"]}})},_context.next=4,api/* API */.bl.fetchAll("termsandconditions",params);case 4:_yield$API$fetchAll=_context.sent,list=_yield$API$fetchAll.list,error=_yield$API$fetchAll.error,error?_this.$message.error(error||_this.$t("common._common.error_while_fetching_terms_and_conditions_list")):(termsAssociated=_this.$getProperty(_this,"record.termsAssociated",[]),(0,validation/* isArray */.kJ)(termsAssociated)&&(associatedTermsId=termsAssociated.map((function(term){return _this.$getProperty(term,"terms.id",-1)}))),_this.termsAndConditionTableList=(list||[]).filter((function(record){return!associatedTermsId.includes(record.id)}))),_this.loading=!1;case 9:case"end":return _context.stop()}}),_callee)})))()},associateTerms:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var tempTandCList,_iterator,_step,tandC,param,_yield$API$post,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:tempTandCList=[],_iterator=(0,createForOfIteratorHelper/* default */.Z)(_this2.selectedTandC);try{for(_iterator.s();!(_step=_iterator.n()).done;)tandC=_step.value,tempTandCList.push({terms:{id:tandC.id}})}catch(err){_iterator.e(err)}finally{_iterator.f()}return param={termsAssociated:tempTandCList,recordId:_this2.record.id},_this2.saving=!0,_context2.next=7,api/* API */.bl.post(_this2.associateUrl,param);case 7:_yield$API$post=_context2.sent,error=_yield$API$post.error,error?_this2.$message.error(error||_this2.$t("common.wo_report.unable_to_associate_terms")):(_this2.$emit("refreshSummary"),_this2.closeDialog()),_this2.saving=!1;case 11:case"end":return _context2.stop()}}),_callee2)})))()}}},v1_TermsAssociationDialogvue_type_script_lang_js=TermsAssociationDialogvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(v1_TermsAssociationDialogvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,TermsAssociationDialog=component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/7356.js.map