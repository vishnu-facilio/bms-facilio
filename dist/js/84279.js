(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[84279],{
/***/368768:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return NewPortfolioAnalysis}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/energy/analytics/newTools/NewPortfolioAnalysis.vue?vue&type=template&id=32643db8
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{key:_vm.$route.fullPath,staticClass:"analytics-section-new row"},[_c("div",{staticClass:"newanalytics-page-header"},[_c("div",{staticClass:"row"},[_c("div",{staticClass:"col-8"},[_c("div",{staticClass:"analytics-page-header-filters"},[_vm._m(0),_c("div",{staticClass:"col-2"},[_c("div",{staticClass:"fL"},[_c("div",{staticClass:"selected-buildings-analytics"},[_vm._v(" "+_vm._s(_vm.$t("common.header.portfolio_analysis"))+" ")])])]),_c("div",{staticClass:"col-4"},[_c("div",{staticClass:"mL20"},[_c("el-select",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"period-select",attrs:{placeholder:_vm.$t("common.header.dimension"),title:_vm.$t("common.header.dimension"),"data-arrow":"true"},on:{change:_vm.onModeChange},model:{value:_vm.analyticsConfig.mode,callback:function($$v){_vm.$set(_vm.analyticsConfig,"mode",$$v)},expression:"analyticsConfig.mode"}},[_c("el-option",{attrs:{label:_vm.$t("common.wo_report.time"),value:4}}),_c("el-option",{attrs:{label:_vm.$t("common.products.site"),value:6}}),_c("el-option",{attrs:{label:_vm.$t("common._common.building"),value:7}}),_c("el-option",{attrs:{label:_vm.$t("common._common.asset"),value:8}})],1),_vm.baseLineList&&!_vm.isActionsDisabled?_c("el-cascader",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"period-select",attrs:{placeholder:_vm.$t("common.wo_report.compare_to"),options:_vm.baseLineCasecaderOptions,value:_vm.analyticsConfig.baseLine,title:_vm.$t("common.wo_report.compare_with_baseline"),"data-arrow":"true"},on:{change:_vm.onBaseLineChange}}):_vm._e(),_vm.isTimeMode?_c("el-select",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"period-select",attrs:{placeholder:_vm.$t("common.wo_report.period"),title:_vm.$t("common.dashboard.time_period"),"data-arrow":"true"},on:{change:_vm.onPeriodChange},model:{value:_vm.analyticsConfig.period,callback:function($$v){_vm.$set(_vm.analyticsConfig,"period",$$v)},expression:"analyticsConfig.period"}},_vm._l(_vm.getAvailablePeriods,(function(period,index){return _c("el-option",{key:index,attrs:{label:period.name,value:period.value,disabled:!period.enable}})})),1):_vm._e(),_c("el-popover",{attrs:{"popper-class":"f-popover",placement:"right",width:350},model:{value:_vm.filtersPopover,callback:function($$v){_vm.filtersPopover=$$v},expression:"filtersPopover"}},[_c("div",{staticClass:"fc-popover-content"},[_c("div",{staticClass:"title uppercase f12 bold",staticStyle:{"letter-spacing":"1.1px",color:"#000000"}},[_vm._v(" "+_vm._s(_vm.$t("common._common.filters"))+" ")]),_c("div",{staticClass:"mT15"},[_c("el-form",{ref:"reportFilterForm",attrs:{model:_vm.reportFilterForm,"label-position":"top"}},[_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"assetFilter"}},[_c("p",{staticClass:"grey-text2"},[_vm._v(" "+_vm._s(_vm.$t("common._common.select_sites"))+" ")]),_c("el-select",{staticStyle:{width:"90%"},attrs:{filterable:"",multiple:"","collapse-tags":""},on:{change:function($event){return _vm.updateFilterdata("site")}},model:{value:_vm.reportFilterForm.siteFilter,callback:function($$v){_vm.$set(_vm.reportFilterForm,"siteFilter",$$v)},expression:"reportFilterForm.siteFilter"}},_vm._l(_vm.siteList,(function(site,index){return _vm.siteList&&_vm.siteList.length?_c("el-option",{key:index,attrs:{label:site.name,value:site.id}}):_vm._e()})),1)],1)],1)],1),_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"assetFilter"}},[_c("p",{staticClass:"grey-text2"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.select_buildings"))+" ")]),_c("el-select",{staticStyle:{width:"90%"},attrs:{filterable:"",multiple:"","collapse-tags":""},on:{change:function($event){return _vm.updateFilterdata("building")}},model:{value:_vm.reportFilterForm.buildingFilter,callback:function($$v){_vm.$set(_vm.reportFilterForm,"buildingFilter",$$v)},expression:"reportFilterForm.buildingFilter"}},_vm._l(_vm.buildingList,(function(building,index){return _vm.buildingList&&_vm.buildingList.length?_c("el-option",{key:index,attrs:{label:building.name,value:building.id}}):_vm._e()})),1)],1)],1)],1),_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"assetFilter"}},[_c("p",{staticClass:"grey-text2"},[_vm._v(" "+_vm._s(_vm.$t("common._common.select_asset_category"))+" ")]),_c("el-select",{staticStyle:{width:"90%"},attrs:{filterable:"",multiple:"","collapse-tags":""},on:{change:function($event){return _vm.updateFilterdata("category")}},model:{value:_vm.reportFilterForm.categoryFilter,callback:function($$v){_vm.$set(_vm.reportFilterForm,"categoryFilter",$$v)},expression:"reportFilterForm.categoryFilter"}},_vm._l(_vm.selectedCategory.categoryList,(function(category,index){return _vm.selectedCategory.categoryList&&_vm.selectedCategory.categoryList.length?_c("el-option",{key:index,attrs:{label:category.name,value:category.id}}):_vm._e()})),1)],1)],1)],1),_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"assetFilter"}},[_c("p",{staticClass:"grey-text2"},[_vm._v(" "+_vm._s(_vm.$t("common._common.select_assets"))+" ")]),_c("el-select",{staticStyle:{width:"90%"},attrs:{filterable:"",multiple:"","collapse-tags":""},model:{value:_vm.reportFilterForm.assetFilter,callback:function($$v){_vm.$set(_vm.reportFilterForm,"assetFilter",$$v)},expression:"reportFilterForm.assetFilter"}},_vm._l(_vm.selectedCategory.assetList,(function(asset,index){return _vm.selectedCategory.assetList&&_vm.selectedCategory.assetList.length?_c("el-option",{key:index,attrs:{label:_vm.assetsMap[Number(asset)],value:Number(asset)}}):_vm._e()})),1)],1)],1)],1),_c("el-row",[_c("el-col",{attrs:{span:12}},[_c("el-form-item",{attrs:{prop:"field"}},[_c("p",{staticClass:"grey-text2"},[_vm._v(" "+_vm._s(_vm.$t("common._common.live_filter"))+" ")]),_c("el-select",{staticStyle:{width:"90%"},attrs:{placeholder:_vm.$t("common.products._select_")},model:{value:_vm.reportFilterForm.liveFilterField,callback:function($$v){_vm.$set(_vm.reportFilterForm,"liveFilterField",$$v)},expression:"reportFilterForm.liveFilterField"}},[_c("el-option",{attrs:{value:"none",label:_vm.$t("common.wo_report.none")}}),_c("el-option",{attrs:{value:"site",label:_vm.$t("common.products.site")}}),_c("el-option",{attrs:{value:"building",label:_vm.$t("common._common.building")}}),_c("el-option",{attrs:{value:"asset",label:_vm.$t("common._common.asset")}})],1)],1)],1),_vm.reportFilterForm.liveFilterField&&"none"!==_vm.reportFilterForm.liveFilterField?_c("el-col",{attrs:{span:12}},[_c("el-form-item",{attrs:{prop:"selectBoxType"}},[_c("p",{staticClass:"grey-text2"},[_vm._v(" "+_vm._s(_vm.$t("common._common.type"))+" ")]),_c("el-select",{staticStyle:{width:"90%"},model:{value:_vm.reportFilterForm.liveFilterType,callback:function($$v){_vm.$set(_vm.reportFilterForm,"liveFilterType",$$v)},expression:"reportFilterForm.liveFilterType"}},[_c("el-option",{attrs:{value:"single",label:_vm.$t("common.header.single_select_box")}}),_c("el-option",{attrs:{value:"multi",label:_vm.$t("common.header.multi_select_box")}})],1)],1)],1):_vm._e()],1)],1)],1)]),_c("div",{staticClass:"f-footer row",staticStyle:{height:"46px"}},[_vm._t("footer",(function(){return[_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){_vm.filtersPopover=!1}}},[_vm._v(_vm._s(_vm.$t("setup.users_management.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:function($event){return _vm.applyFilter(null)}}},[_vm._v(_vm._s(_vm.$t("maintenance.pm_list.apply")))])],1)]}))],2),_c("el-button",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"pL15 pR15 position-relative",staticStyle:{top:"2px"},attrs:{slot:"reference",plain:"",title:_vm.$t("common._common.filters"),"data-arrow":"true"},slot:"reference"},[_c("InlineSvg",{staticClass:"rotate90 fc-grey-svg2",staticStyle:{top:"2px"},attrs:{src:"svgs/equalization",iconClass:"icon icon-sm-md"}})],1)],1),4!==_vm.analyticsConfig.mode?_c("el-popover",{attrs:{"popper-class":"f-popover",placement:"right",width:250},model:{value:_vm.sortPopover,callback:function($$v){_vm.sortPopover=$$v},expression:"sortPopover"}},[_c("div",{staticClass:"fc-popover-content",staticStyle:{"margin-bottom":"0px"}},[_c("div",{staticClass:"title uppercase f12 bold",staticStyle:{"letter-spacing":"1.1px",color:"#000000"}},[_vm._v(" "+_vm._s(_vm.$t("common._common.sorting"))+" ")]),_c("div",{staticClass:"mT15"},[_c("el-form",{ref:"reportSortingForm",attrs:{model:_vm.analyticsConfig.sorting,"label-position":"top"}},[_vm.resultObject&&_vm.resultObject.report.dataPoints.length>1?_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"orderByFunc"}},[_c("p",{staticClass:"grey-text2"},[_vm._v(" "+_vm._s(_vm.$t("common._common.sort_by"))+" ")]),_c("el-select",{staticStyle:{width:"90%"},model:{value:_vm.analyticsConfig.sorting.sortByField,callback:function($$v){_vm.$set(_vm.analyticsConfig.sorting,"sortByField",$$v)},expression:"analyticsConfig.sorting.sortByField"}},_vm._l(_vm.resultObject.report.dataPoints,(function(dp,index){return _c("el-option",{key:index,attrs:{label:dp.name,value:dp.yAxis.fieldId}})})),1)],1)],1)],1):_vm._e(),_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"orderByFunc"}},[_c("p",{staticClass:"grey-text2"},[_vm._v(" "+_vm._s(_vm.$t("common._common.sort_order"))+" ")]),_c("el-select",{staticStyle:{width:"90%"},model:{value:_vm.analyticsConfig.sorting.orderByFunc,callback:function($$v){_vm.$set(_vm.analyticsConfig.sorting,"orderByFunc",$$v)},expression:"analyticsConfig.sorting.orderByFunc"}},[_c("el-option",{attrs:{label:_vm.$t("common.wo_report"),value:1}}),_c("el-option",{attrs:{label:_vm.$t("common._common.ascending"),value:2}}),_c("el-option",{attrs:{label:_vm.$t("common._common.descending"),value:3}})],1)],1)],1)],1),_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"limit"}},[_c("p",{staticClass:"grey-text2"},[_vm._v(" "+_vm._s(_vm.$t("common._common.limit"))+" ")]),_c("el-select",{staticStyle:{width:"90%"},model:{value:_vm.analyticsConfig.sorting.limit,callback:function($$v){_vm.$set(_vm.analyticsConfig.sorting,"limit",$$v)},expression:"analyticsConfig.sorting.limit"}},_vm._l(15,(function(i){return i>=3?_c("el-option",{key:i,attrs:{label:i,value:i}}):_vm._e()})),1)],1)],1)],1)],1)],1)]),_c("el-button",{directives:[{name:"tippy",rawName:"v-tippy"}],staticStyle:{"font-size":"1rem",position:"relative",top:"2px",left:"18%","margin-left":"10px","margin-right":"10px",float:"right"},attrs:{slot:"reference",plain:"",icon:"el-icon-sort",title:_vm.$t("common._common.sorting"),"data-arrow":"true"},slot:"reference"})],1):_vm._e()],1)])])]),_c("div",{staticClass:"col-4",staticStyle:{"text-align":"right"}},[_c("f-report-options",{staticClass:"analytics-page-options-building-analysis",attrs:{isActionsDisabled:_vm.isActionsDisabled,optionClass:"analytics-page-options",optionsToEnable:[1,2,5],reportObject:_vm.reportObject,resultObject:_vm.resultObject,params:_vm.reportObject?_vm.reportObject.params:null,savedReport:_vm.analyticsConfig.savedReport}})],1)])]),_c("f-portfolio-data-point-selector",{ref:"building-selector",attrs:{visibility:_vm.showDataPointSelector,zones:_vm.zones,isSiteAnalysis:_vm.isSiteAnalysis},on:{"update:visibility":function($event){_vm.showDataPointSelector=$event},selectBuildings:_vm.setSelectedBuildings,updateDataPoints:_vm.updateDataPoints}}),_vm.reportObject?_c("div",{directives:[{name:"show",rawName:"v-show",value:_vm.showChartCustomization,expression:"showChartCustomization"}],staticClass:"customize-container fc-new-building-customize-container col-4"},[_c("div",{staticClass:"customize-header"},[_c("div",{staticClass:"customize-H"},[_vm._v(" "+_vm._s(_vm.$t("home.reports.chart_customization"))+" "),_c("i",{staticClass:"el-icon-close",on:{click:_vm.hideChartCustomizationDialog}})])]),_c("div",{staticClass:"customize-body"},[_vm.reportObject?_c("f-chart-customization",{directives:[{name:"show",rawName:"v-show",value:_vm.showChartCustomization,expression:"showChartCustomization"}],attrs:{report:_vm.reportObject,resultDataPoints:_vm.resultObject?_vm.resultObject.report.dataPoints:[],config:_vm.analyticsConfig},on:{close:function($event){_vm.showChartCustomization=!1},resetPoints:_vm.resetDataPointSelector}}):_vm._e()],1)]):_vm._e(),_c("div",{staticClass:"analytic-summary new-analytic-summary scrollable",class:{"col-12, mleft0":!_vm.showChartCustomization,"col-8, mleft447":_vm.showChartCustomization},style:_vm.showChartCustomization?"max-width: calc(100% - 450px) !important;":""},[_c("div",{directives:[{name:"show",rawName:"v-show",value:!_vm.showChartCustomization,expression:"!showChartCustomization"}],staticClass:"add-points-block"},[_c("el-button-group",[_c("el-button",{staticClass:"add-points-btn",attrs:{type:"primary"},on:{click:function($event){_vm.showDataPointSelector=!0}}},[_c("i",{staticClass:"el-icon-plus"}),_vm._v(_vm._s(_vm.$t("common.products.select_point")))]),_vm.reportObject?_c("el-button",{staticClass:"add-points-btn",attrs:{type:"primary"},on:{click:function($event){_vm.showDerivation=!0}}},[_c("img",{attrs:{src:__webpack_require__(857539),width:"17px",height:"17px"}})]):_vm._e()],1),_vm.reportObject?_c("el-button",{staticClass:"add-points-btn add-points-btn2",attrs:{type:"primary"},on:{click:function($event){return _vm.showChartCustomizationDialog()}}},[_c("img",{attrs:{src:__webpack_require__(108277),width:"17px",height:"17px"}})]):_vm._e()],1),_c("div",{ref:"chartSection",staticClass:"self-center fchart-section building-graph-container"},[_vm.analyticsConfig.dataPoints.length?_c("f-new-analytic-report",{ref:"newAnalyticReport",attrs:{config:_vm.analyticsConfig,baseLines:_vm.baseLineList},on:{"update:config":function($event){_vm.analyticsConfig=$event},reportLoaded:_vm.reportLoaded}}):_c("div",{staticClass:"text-center"},[_vm.reportId||_vm.alarmId||_vm.cardId?_c("div",{staticClass:"p15"},[_c("spinner",{attrs:{show:!0}})],1):_c("div",{staticClass:"p15 flex-middle height80vh justify-content-center flex-direction-column"},[_c("div",[_c("inline-svg",{attrs:{src:"svgs/emptystate/reportlist",iconClass:"icon text-center icon-xxxlg"}})],1),_c("div",{staticClass:"nowo-label"},[_vm._v(" "+_vm._s(_vm.$t("common._common.please_select_data_points_analyze"))+" ")])])])],1)]),_vm.showDerivation?_c("derivation",{attrs:{visibility:_vm.showDerivation,report:_vm.reportObject,config:_vm.analyticsConfig},on:{"update:visibility":function($event){_vm.showDerivation=$event}}}):_vm._e()],1)},staticRenderFns=[function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"col-2"},[_c("div",{staticClass:"building-avatar-block fL"},[_c("div",{staticClass:"building-avatar"},[_c("img",{attrs:{src:__webpack_require__(188742),height:"40px",width:"40px"}})])])])}],toConsumableArray=__webpack_require__(488478),objectSpread2=__webpack_require__(595082),createForOfIteratorHelper=__webpack_require__(566347),AnalyticsMixin=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(538077),__webpack_require__(169358),__webpack_require__(670560),__webpack_require__(434284),__webpack_require__(450886),__webpack_require__(634338),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(244936)),FNewAnalyticReport=__webpack_require__(794925),FPortfolioDataPointSelector=__webpack_require__(852244),FDerivation=__webpack_require__(486348),FChartCustomization=__webpack_require__(472511),FReportOptions=__webpack_require__(791514),NewDateHelper=__webpack_require__(105534),InlineSvg=__webpack_require__(586166),cloneDeep=__webpack_require__(150361),cloneDeep_default=__webpack_require__.n(cloneDeep),vuex_esm=__webpack_require__(420629),NewPortfolioAnalysisvue_type_script_lang_js={props:["mobileConfig"],mixins:[AnalyticsMixin/* default */.Z],components:{Derivation:FDerivation/* default */.Z,FNewAnalyticReport:FNewAnalyticReport["default"],FChartCustomization:FChartCustomization/* default */.Z,FPortfolioDataPointSelector:FPortfolioDataPointSelector/* default */.Z,FReportOptions:FReportOptions/* default */.Z,InlineSvg:InlineSvg/* default */.Z},data:function(){return{showDataPointSelector:!0,showChartCustomization:!1,assetsMap:null,assetCategoryMap:null,filtersPopover:!1,sortPopover:!1,showDerivation:!1,chartCustomizationActiveTab:"datapoints",selectedBaseLineId:"",baseLineList:null,baseLineCasecaderOptions:[],oldBaseLine:null,analyticsConfig:{name:"Portfolio Analysis",key:"PORTFOLIO_ANALYSIS",analyticsType:1,type:"reading",period:10,mode:4,baseLine:null,dateFilter:NewDateHelper/* default */.Z.getDatePickerObject(44),chartViewOption:0,dataPoints:[],filters:{xCriteriaMode:2},sorting:{sortByField:null,orderByFunc:3,limit:10}},reportObject:null,resultObject:null,selectedBuildings:[],selectedBuildingTitle:"",zones:null,buildingList:this.$store.state.buildings?cloneDeep_default()(this.$store.state.buildings):null,reportFilterForm:{siteFilter:[],buildingFilter:[],categoryFilter:[],assetFilter:[],enableLive:!1,liveFilterField:"none",liveFilterType:"single"},selectedCategory:{categoryId:[],assetList:null,allAsset:null,categoryList:null,allBuildings:this.$store.state.buildings?cloneDeep_default()(this.$store.state.buildings):null}}},watch:{getAvailablePeriods:{handler:function(newData,oldData){var _this=this,avail=this.getAvailablePeriods,selected=avail.find((function(a){return a.value===_this.analyticsConfig.period&&a.enable}));if(!selected){var filterName=this.analyticsConfig.dateFilter.operationOn,defaultPeriod=avail.filter((function(a){return a.enable}))[0].value;"week"===filterName||"month"===filterName?defaultPeriod=12:"year"===filterName&&(defaultPeriod=10),this.analyticsConfig.period=defaultPeriod}},immediate:!0},showChartCustomization:function(newVal){var self=this;self.$nextTick((function(){self.$refs["newAnalyticReport"]&&self.$refs["newAnalyticReport"].resize&&self.$refs["newAnalyticReport"].resize()}))}},mounted:function(){if(this.$route.query.filters){var filters=this.$route.query.filters,filtersJSON=JSON.parse(filters);this.analyticsConfig=filtersJSON}(this.reportId||this.alarmId||this.cardId)&&(this.showDataPointSelector=!1,this.$mobile?this.loadReport(this.mobileConfig):this.loadReport());var self=this;self.$http.get("/baseline/all").then((function(response){if(200===response.status){self.loadReadings(),self.baseLineList=response.data?response.data:[],self.baseLineCasecaderOptions=[],self.baseLineCasecaderOptions.push({label:"None",value:-1});var _step,_iterator=(0,createForOfIteratorHelper/* default */.Z)(self.baseLineList);try{for(_iterator.s();!(_step=_iterator.n()).done;){var b=_step.value,children=null;"PREVIOUS_MONTH"===b.rangeTypeEnum||"ANY_MONTH"===b.rangeTypeEnum?children=[{label:"Same date",value:4},{label:"Same week",value:1}]:"PREVIOUS_YEAR"!==b.rangeTypeEnum&&"ANY_YEAR"!==b.rangeTypeEnum||(children=[{label:"Same date",value:3},{label:"Same week",value:1}]),"PREVIOUS"!==b.rangeTypeEnum&&self.baseLineCasecaderOptions.push({label:b.name,value:b.id,children:children})}}catch(err){_iterator.e(err)}finally{_iterator.f()}}})),self.loadZones()},created:function(){this.$store.dispatch("loadAssetCategory"),this.$store.dispatch("loadSites"),this.$store.dispatch("loadBuildings")},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({assetCategory:function(state){return state.assetCategory}})),{},{siteList:function(){return this.$store.state.sites&&this.$store.state.sites.length?this.$store.state.sites:[]},isSiteAnalysis:function(){return!0},isSameDataPoint:function(){if(this.analyticsConfig&&this.analyticsConfig.dataPoints.length){var _step2,dp={},_iterator2=(0,createForOfIteratorHelper/* default */.Z)(this.analyticsConfig.dataPoints);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var d=_step2.value;dp[d.yAxis.fieldId]=!0}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}if(1===Object.keys(dp).length)return!0}return!1},getAvailablePeriods:function(){var operationOnId=this.analyticsConfig.dateFilter.operationOnId,avail=[];
// avail.push({
//   name:'Week of year', // W1, W2
//   value: 16,
//   enable: true
// })
// avail.push({
//   name:'Month of year', // Jan, Feb , march
//   value: 15,
//   enable: true
// })
return avail.push({name:this.$t("common._common.high_res"),value:0,enable:6===operationOnId||4!==operationOnId}),avail.push({name:this.$t("common.wo_report.hourly"),value:20,enable:6===operationOnId||4!==operationOnId}),avail.push({name:this.$t("common._common.daily"),value:12,enable:!0}),avail.push({name:this.$t("common._common.weekly"),value:11,enable:!0}),avail.push({name:this.$t("common._common.monthly"),value:10,enable:!0}),avail.push({name:this.$t("common.products.quarterly"),value:25,enable:4===operationOnId||5===operationOnId}),avail.push({name:this.$t("common._common.yearly"),value:8,enable:4===operationOnId}),avail.push({name:this.$t("common.header.hour_of_day"),
// 12, 1, 2, 3
value:19,enable:!0}),avail.push({name:this.$t("common.header.day_of_week"),
// sun, mon
value:17,enable:!0}),avail.push({name:this.$t("common.header.day_of_month"),
// 1,2,3
value:18,enable:!0}),avail},isTimeMode:function(){return 4===this.analyticsConfig.mode||5===this.analyticsConfig.mode}}),methods:{loadAlarmMeta:function(){var _this2=this;this.$http.post("/dashboard/getReportMetaForAlarms",{alarmId:this.$route.query.alarmId}).then((function(response){response.data&&response.data.reportMeta&&(_this2.analyticsConfig.dataPoints=response.data.reportMeta.dataPoints)}))},loadReadings:function(buildingList,siteList){var self=this;siteList?(self.loading=!0,self.$http.post("/asset/getreadings",{buildingIds:siteList||self.reportFilterForm.siteFilter}).then((function(response){self.loadAssetCategories(response.data)}))):self.buildingList?(self.loading=!0,self.$http.post("/asset/getreadings",{buildingIds:buildingList||self.selectedCategory.allBuildings.map((function(rt){return rt.id}))}).then((function(response){self.loadAssetCategories(response.data)}))):(self.loading=!0,self.$http.get("/asset/getreadings").then((function(response){self.loadAssetCategories(response.data)})))},loadAssetCategories:function(readings){var self=this;if(readings){var categoryIds=Object.keys(readings.categoryWithFields);self.selectedCategory.categoryList=self.assetCategory.filter((function(ele){for(var index=0;index<categoryIds.length;index++){var element=categoryIds[index];if(parseInt(element)===ele.id)return ele.toggle=!1,ele}})),self.filterAssetsFromCategory(readings)}},filterAssetsFromCategory:function(readings){var self=this;self.assetCategoryMap=readings.categoryWithAssets,this.selectedCategory.assetList=[];for(var i=0;i<this.reportFilterForm.categoryFilter.length;i++)this.selectedCategory.assetList=[].concat((0,toConsumableArray/* default */.Z)(this.selectedCategory.assetList),(0,toConsumableArray/* default */.Z)(Object.keys(this.assetCategoryMap[this.reportFilterForm.categoryFilter[i]])));this.selectedCategory.allAsset=self.selectedCategory.assetList,self.assetsMap=readings.assets},updateFilterdata:function(root){var _this3=this;if("site"===root)this.reportFilterForm.assetFilter=[],this.reportFilterForm.buildingFilter=[],this.reportFilterForm.siteFilter&&this.reportFilterForm.siteFilter.length?(this.buildingList=this.selectedCategory.allBuildings&&this.selectedCategory.allBuildings.length?this.selectedCategory.allBuildings.filter((function(f){return _this3.reportFilterForm.siteFilter.includes(f.siteId)})):null,this.buildingList&&this.buildingList.length?this.loadReadings(this.buildingList.map((function(rt){return rt.id}))):this.reportFilterForm.siteFilter&&this.reportFilterForm.siteFilter.length?this.loadReadings(!1,this.reportFilterForm.siteFilter):this.loadReadings()):(this.selectedCategory.assetList=this.selectedCategory.allAsset,this.buildingList=this.selectedCategory.allBuildings,this.buildingList&&this.buildingList.length?this.loadReadings(this.buildingList.map((function(rt){return rt.id}))):this.loadReadings());else if("building"===root)this.reportFilterForm.assetFilter=[],this.selectedCategory.assetList=null,this.reportFilterForm.buildingFilter&&this.reportFilterForm.buildingFilter.length?this.loadReadings(this.reportFilterForm.buildingFilter):(this.selectedCategory.assetList=this.selectedCategory.allAsset,this.loadReadings(this.buildingList.map((function(rt){return rt.id}))));else if("category"===root){this.selectedCategory.assetList=[];for(var i=0;i<this.reportFilterForm.categoryFilter.length;i++)this.selectedCategory.assetList=[].concat((0,toConsumableArray/* default */.Z)(this.selectedCategory.assetList),(0,toConsumableArray/* default */.Z)(Object.keys(this.assetCategoryMap[this.reportFilterForm.categoryFilter[i]])))}},reportLoaded:function(report,result){this.reportObject=report,this.resultObject=result,report.options.common&&report.options.common.buildingIds&&(!report.options.common.buildingIds.length&&this.selectedBuildings?this.reportObject.options.common.buildingIds=this.selectedBuildings:
// this.selectedBuildings = report.options.common.buildingIds
this.resetDataPointSelector(report.options.common.buildingIds))},loadZones:function(){var self=this;self.$http.get("/zone").then((function(response){response.data&&response.data.records&&(self.zones=response.data.records)}))},resetDataPointSelector:function(buildingIds){this.$refs["building-selector"].setInitialValues(this.analyticsConfig.dataPoints,buildingIds)},updateDataPoints:function(changedDataPoints){this.analyticsConfig.dataPoints=changedDataPoints,this.showDataPointSelector=!1},showChartCustomizationDialog:function(defaultTab){this.showChartCustomization=!0,defaultTab&&(this.chartCustomizationActiveTab=defaultTab)},hideChartCustomizationDialog:function(){this.showChartCustomization=!1},setSelectedBuildings:function(_ref){var name=_ref.name,ids=_ref.ids;this.selectedBuildingTitle=name,this.selectedBuildings=ids,this.reportObject&&this.reportObject.options&&this.reportObject.options.common&&(this.reportObject.options.common.buildingIds=this.selectedBuildings)},onPeriodChange:function(){if(!this.analyticsConfig.dataPoints.length){var filter="D";20===this.analyticsConfig.period?filter="W":12===this.analyticsConfig.period?filter="M":10===this.analyticsConfig.period&&(filter="Y"),this.analyticsConfig.dateFilter=this.getDefaultDateFilter(filter)}},onModeChange:function(){1!==this.analyticsConfig.mode&&(this.analyticsConfig.dataPoints=this.analyticsConfig.dataPoints.filter((function(dp){return 2!==dp.type})))},onBaseLineChange:function(newBaseLine){var _this4=this;if(!this.oldBaseLine||this.oldBaseLine[0]!==newBaseLine[0]){if(this.oldBaseLine&&-1!==this.oldBaseLine[0]){var oldBlName=this.baseLineList.find((function(bl){return bl.id===_this4.oldBaseLine[0]})).name,dp=this.reportObject.options.dataPoints.find((function(dp){return dp.baseLineName===oldBlName}));if(!this.checkAndDeletePointsRel(this.reportObject.options,dp.alias))return this.$message.error(dp.baseLineName+this.$t("common.header.has_been_derivation_please_delete_derivation")),void this.$set(this.analyticsConfig,"baseLine",this.oldBaseLine)}this.oldBaseLine=(0,toConsumableArray/* default */.Z)(newBaseLine),this.$set(this.analyticsConfig,"baseLine",newBaseLine)}},applyFilter:function(){if(this.reportFilterForm.siteFilter.length||this.reportFilterForm.buildingFilter.length||this.reportFilterForm.categoryFilter.length||this.reportFilterForm.assetFilter.length)if(this.reportFilterForm.assetFilter.length)this.analyticsConfig.filters={xCriteriaMode:3,parentId:this.reportFilterForm.assetFilter,filterState:this.$helpers.cloneObject(this.reportFilterForm)};else{var spaceFilter=this.reportFilterForm.buildingFilter.length?this.reportFilterForm.buildingFilter:this.reportFilterForm.siteFilter;this.analyticsConfig.filters={xCriteriaMode:4,assetCategory:this.reportFilterForm.categoryFilter,spaceId:spaceFilter,filterState:this.$helpers.cloneObject(this.reportFilterForm)}}else this.analyticsConfig.filters={xCriteriaMode:2,filterState:this.$helpers.cloneObject(this.reportFilterForm)};this.filtersPopover=!1}}},newTools_NewPortfolioAnalysisvue_type_script_lang_js=NewPortfolioAnalysisvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(newTools_NewPortfolioAnalysisvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,NewPortfolioAnalysis=component.exports},
/***/587758:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"5ee9b0f49c6e73cc51f35d51be8bad36.svg";
/***/},
/***/857539:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"0c4c867eeab407b0ed9771b49db7359e.svg";
/***/}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/84279.js.map