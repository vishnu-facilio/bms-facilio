"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[14927,71569],{
/***/784823:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return AdvancedSearch}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/newapp/components/search/AdvancedSearch.vue?vue&type=template&id=66305202
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("div",{staticClass:"d-flex align-center",on:{click:function($event){return _vm.openCloseSearch(!0)}}},[_vm._t("icon",(function(){return[_c("InlineSvg",{staticClass:"d-flex mT3 cursor-pointer",attrs:{src:"svgs/search",iconClass:"icon icon-sm self-center mR5"}})]}))],2),_vm.canShowSearchWiz?_c("el-dialog",{attrs:{title:_vm.title,visible:_vm.canShowSearchWiz,fullscreen:!0,"append-to-body":!0,"custom-class":"advance-search-container"},on:{"update:visible":function($event){_vm.canShowSearchWiz=$event}}},[_c("AdvancedSearch",{attrs:{moduleName:_vm.moduleName,searchParam:_vm.searchParam,hideQuery:_vm.hideQuery,filterList:_vm.filterList},on:{applyFilters:_vm.applyFilters,closeDialog:function(){return _vm.openCloseSearch(!1)}}})],1):_vm._e()],1)},staticRenderFns=[],objectSpread2=__webpack_require__(595082),router=(__webpack_require__(634338),__webpack_require__(564043),__webpack_require__(61514),__webpack_require__(329435)),dist=__webpack_require__(191853),validation=__webpack_require__(990260),vuex_esm=__webpack_require__(420629),AdvancedSearchvue_type_script_lang_js={props:["moduleName","moduleDisplayName","filterList","hideQuery","onSave"],components:{AdvancedSearch:dist/* AdvancedSearch */.ZJ},data:function(){return{searchText:"",canShowSearchWiz:!1,isSaving:!1,searchableFields:[],isOpenWizPressed:!1}},created:function(){(0,router/* isWebTabsEnabled */.tj)()&&(document.addEventListener("keydown",this.keyDownHandler),document.addEventListener("keyup",this.keyUpHandler))},beforeDestroy:function(){(0,router/* isWebTabsEnabled */.tj)()&&(document.removeEventListener("keydown",this.keyDownHandler),document.removeEventListener("keyup",this.keyUpHandler))},computed:{title:function(){var moduleDisplayName=this.moduleDisplayName,title="".concat(this.$t("commissioning.sheet.filter")," ").concat(moduleDisplayName," ").concat(this.$t("filters.search.by"));return title},searchParam:function(){var $route=this.$route,_ref=$route||{},query=_ref.query,_ref2=query||{},search=_ref2.search;return(0,validation/* isEmpty */.xb)(search)?"":search}},mounted:function(){this.fetchSearchableFields({moduleName:this.moduleName})},methods:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapActions */.nv)({fetchSearchableFields:"search/fetchSearchableFields"})),{},{openCloseSearch:function(canShow){this.searchText="",this.canShowSearchWiz=canShow},applyFilters:function(filters){var hideQuery=this.hideQuery;hideQuery?this.onSave({filters:filters}):this.$store.dispatch("search/applyFilters",filters),this.openCloseSearch(!1)},keyDownHandler:function(e){if(e.shiftKey&&"Slash"===e.code)this.isOpenWizPressed=!0;else{var _navigator=navigator,userAgentData=_navigator.userAgentData,platform=_navigator.platform,_ref3=userAgentData||{},userPlatform=_ref3.platform,currentOS=userPlatform||platform,isMac=currentOS.toUpperCase().indexOf("MAC")>=0;(isMac&&e.metaKey||!isMac&&e.ctrlKey)&&"Enter"===e.key&&this.applyFilter()}},keyUpHandler:function(){this.isOpenWizPressed&&(this.openCloseSearch(!0),this.isOpenWizPressed=!1)}})},search_AdvancedSearchvue_type_script_lang_js=AdvancedSearchvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(search_AdvancedSearchvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,AdvancedSearch=component.exports},
/***/622957:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return SetupEmptyState}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/setup/components/SetupEmptyState.vue?vue&type=template&id=839bdf38
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"fc-setup-empty"},[_c("div",{staticClass:"fc-setup-empty-image"},[_c("inline-svg",{attrs:{src:"svgs/list-empty",iconClass:"icon text-center icon-xxxxlg"}})],1),_c("div",{staticClass:"fc-setup-empty-txt"},[_vm._t("emptyHeading")],2),_c("div",{staticClass:"fc-setup-empty-txt-desc"},[_vm._t("emptyDescription")],2)])},staticRenderFns=[],componentNormalizer=__webpack_require__(801001),script={},component=(0,componentNormalizer/* default */.Z)(script,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,SetupEmptyState=component.exports},
/***/233432:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return SetupLoader}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/setup/components/SetupLoader.vue?vue&type=template&id=367e612c
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"fc-setup-loader"},[_vm._t("setupLoading")],2)},staticRenderFns=[],componentNormalizer=__webpack_require__(801001),script={},component=(0,componentNormalizer/* default */.Z)(script,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,SetupLoader=component.exports},
/***/996028:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return KPIHistoryLogs}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/setup/readingkpi/KPIHistoryLogs.vue?vue&type=template&id=c66654fc&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"kpi-history-log-page"},[_c("portal",{attrs:{to:"kpi-setup-tab-actions"}},[_c("div",{staticClass:"search-and-pagination-container flex-middle"},[_c("div",[_c("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{arrow:!0,arrowType:"round",animation:"fade"},expression:"{ arrow: true, arrowType: 'round', animation: 'fade' }"}],staticClass:"fc-portal-filter-border",attrs:{content:_vm.$t("common._common.refresh")},on:{click:_vm.reloadLogs}},[_c("i",{staticClass:"el-icon-refresh fwBold f16"})])]),_c("span",{staticClass:"separator"},[_vm._v("|")]),_c("AdvancedSearch",{key:_vm.moduleName+"-search",attrs:{moduleName:_vm.moduleName,moduleDisplayName:_vm.moduleDisplayName,hideQuery:!0,onSave:_vm.applyReadingKpiFilters,filterList:_vm.kpiFilterList}}),_c("span",{staticClass:"separator"},[_vm._v("|")]),_c("div",{staticClass:"pagination-container"},[_c("Pagination",{attrs:{currentPage:_vm.page,total:_vm.recordCount,perPage:_vm.perPage},on:{"update:currentPage":[function($event){_vm.page=$event},_vm.loadNextPage],"update:current-page":function($event){_vm.page=$event}}})],1)],1)]),_c("FTags",{key:"ftags-list-"+_vm.moduleName,staticClass:"border-tlbr-none mT0 mR0 mL0 mb5",attrs:{filterList:_vm.kpiFilterList,hideQuery:!0,hideSaveView:!0},on:{updateFilters:_vm.applyReadingKpiFilters,resetFilters:_vm.resetFilters}}),_vm.isLoading?_c("SetupLoader",{scopedSlots:_vm._u([{key:"setupLoading",fn:function(){return[_c("spinner",{attrs:{show:_vm.isLoading,size:"80"}})]},proxy:!0}],null,!1,3036156284)}):_vm.$validation.isEmpty(_vm.records)&&!_vm.isLoading?_c("SetupEmpty",{scopedSlots:_vm._u([{key:"emptyImage",fn:function(){return[_c("inline-svg",{attrs:{src:"svgs/copy2",iconClass:"icon icon-sm-md"}})]},proxy:!0},{key:"emptyHeading",fn:function(){return[_vm._v(" "+_vm._s(_vm.$t("kpi.historical.no_logs_available"))+" ")]},proxy:!0},{key:"emptyDescription",fn:function(){},proxy:!0}])}):_vm._e(),_c("div",{staticClass:"mB10 position-relative pB100 overflow-y-scroll"},[_c("el-row",{staticClass:"kpi-history-log-header"},[_c("el-col",{attrs:{span:5}},[_c("div",{staticClass:"history-log-header-txt"},[_vm._v(" "+_vm._s(_vm.$t("kpi.kpi.kpi_name"))+" ")])]),_c("el-col",{attrs:{span:3}},[_c("div",{staticClass:"history-log-header-txt"},[_vm._v(" "+_vm._s(_vm.$t("common.header.assets"))+" ")])]),_c("el-col",{attrs:{span:5}},[_c("div",{staticClass:"history-log-header-txt"},[_vm._v(" "+_vm._s(_vm.$t("rule.create.start_end_date"))+" ")])]),_c("el-col",{attrs:{span:4}},[_c("div",{staticClass:"history-log-header-txt"},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.status"))+" ")])]),_c("el-col",{attrs:{span:4}},[_c("div",{staticClass:"history-log-header-txt"},[_vm._v(" "+_vm._s(_vm.$t("setup.setupLabel.executed_by"))+" ")])]),_c("el-col",{attrs:{span:3}},[_c("div",{staticClass:"history-log-header-txt"},[_vm._v(" "+_vm._s(_vm.$t("setup.setupLabel.executed_time"))+" ")])])],1),_c("el-collapse",{staticClass:"kpi-history-logs-collapse",attrs:{accordion:!0},on:{change:_vm.handleChange},model:{value:_vm.activeNames,callback:function($$v){_vm.activeNames=$$v},expression:"activeNames"}},[_c("div",{staticClass:"collapse-scroll"},_vm._l(_vm.records,(function(record,index){return _c("el-collapse-item",{key:index,attrs:{name:index,data:record}},[_c("template",{slot:"title"},[_c("el-row",{staticClass:"width100 pL30"},[_c("el-col",{attrs:{span:5}},[_c("div",{staticClass:"flex-middle pT10"},[_c("i",{staticClass:"el-icon-caret-right"}),_c("i",{staticClass:"el-icon-caret-bottom"}),_c("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{arrow:!0,arrowType:"round",animation:"fade",distance:0,interactive:!0},expression:"{\n                      arrow: true,\n                      arrowType: 'round',\n                      animation: 'fade',\n                      distance: 0,\n                      interactive: true,\n                    }"}],staticClass:"fc-black-com f13 line-height20 overflow-handle setup-dialog60 ",attrs:{content:_vm.getRecordData(record,"kpi.name")}},[_vm._v(" "+_vm._s(_vm.getRecordData(record,"kpi.name"))+" ")])])]),_c("el-col",{attrs:{span:3}},[_c("div",{staticClass:"flex-middle pT10"},[_c("div",{staticClass:"fc-black-com f13 line-height20"},[_vm._v(" "+_vm._s(_vm.getResourceCount(record))+" "+_vm._s(_vm.$t("common.header.assets"))+" ")])])]),_c("el-col",{attrs:{span:5}},[_c("div",{staticClass:"flex-middle"},[_c("div",{staticClass:"fc-grey2 f13 line-height20 fw4"},[_vm._v(" "+_vm._s(_vm.$t("rule.create.start"))+" ")]),_c("div",{staticClass:"fc-black-com f13 pL5 line-height20 fw4"},[_vm._v(" "+_vm._s(_vm.getTimeDateFormat(record,"startTime"))+" "+_vm._s(_vm.getTimeFormat(record,"startTime"))+" ")])]),_c("div",{staticClass:"flex-middle"},[_c("div",{staticClass:"fc-grey2 f13 line-height20 fw4"},[_vm._v(" "+_vm._s(_vm.$t("rule.create.end"))+" ")]),_c("div",{staticClass:"fc-black-com f13 pL12 line-height20 fw4"},[_vm._v(" "+_vm._s(_vm.getTimeDateFormat(record,"endTime"))+" "+_vm._s(_vm.getTimeFormat(record,"endTime"))+" ")])])]),_c("el-col",{attrs:{span:4}},[_c("div",{staticClass:"fc-black-com f13 bold line-height20 flex-middle fw4 pT10"},[_c("div",[_vm._v(" "+_vm._s(_vm.getSuccessCount(record))+" / "+_vm._s(record.resourceCount)+" ")]),_c("div",{staticClass:"pL10",class:"f14 line-height20 fw4",style:{color:_vm.$constants.KPI_LOGGER_STATUS[record.status].color}},[_vm._v(" "+_vm._s(_vm.$constants.KPI_LOGGER_STATUS[record.status].label)+" ")])])]),_c("el-col",{attrs:{span:4}},[_c("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{arrow:!0,arrowType:"round",animation:"fade",distance:0,interactive:!0},expression:"{\n                    arrow: true,\n                    arrowType: 'round',\n                    animation: 'fade',\n                    distance: 0,\n                    interactive: true,\n                  }"}],staticClass:"fc-black-com f13 line-height20 fw4 overflow-handle pT10",attrs:{content:_vm.getCreatedUserName(record)}},[_vm._v(" "+_vm._s(_vm.getCreatedUserName(record))+" ")])]),_c("el-col",{attrs:{span:3}},[_c("div",{staticClass:"fc-black-com f13 line-height20 fw4 pT10"},[_vm._v(" "+_vm._s(_vm.getTimeDateFormat(record,"sysCreatedTime"))+" "+_vm._s(_vm.getTimeFormat(record,"sysCreatedTime"))+" ")])])],1)],1),_c("div",{staticClass:"resource-status-list"},[record.isLoading?_c("el-row",{staticClass:"kpi-history-collapse-child"},[_c("spinner",{attrs:{show:record.isLoading,size:"80"}})],1):_vm._e(),_vm._l(_vm.childrenMap[record.id],(function(child,childIndex){return _c("el-row",{key:childIndex,staticClass:"kpi-history-collapse-child"},[_c("el-col",{attrs:{span:5}},[_c("div",{staticClass:"hide-v"},[_vm._v(" "+_vm._s(_vm.$t("rule.create.dont_remove"))+" ")])]),_c("el-col",{attrs:{span:8}},[_c("div",{staticClass:"flex-middle"},[_c("div",{staticClass:"label-txt-black pL10"},[_vm._v(" "+_vm._s(child.name)+" ")])])]),_c("el-col",{staticClass:"text-left",attrs:{span:4}},[_c("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{arrow:!0,arrowType:"round",animation:"fade",maxWidth:"500"},expression:"{\n                    arrow: true,\n                    arrowType: 'round',\n                    animation: 'fade',\n                    maxWidth: '500',\n                  }"}],staticClass:"f14 pL10",style:{color:_vm.$constants.KPI_LOGGER_STATUS[child.status].color},attrs:{content:_vm.getErrMsg(child)}},[_vm._v(" "+_vm._s(_vm.$constants.KPI_LOGGER_STATUS[child.status].label)+" ")])]),_c("el-col",{attrs:{span:4}},[_c("div",{staticClass:"hide-v"},[_vm._v(" "+_vm._s(_vm.$t("rule.create.dont_remove"))+" ")])]),_c("el-col",{attrs:{span:3}},[_c("div",{staticClass:"hide-v"},[_vm._v(" "+_vm._s(_vm.$t("rule.create.dont_remove"))+" ")])])],1)}))],2)],2)})),1)])],1),_vm.showHistoricalDialog?_c("CreateKpiHistoricalDialog",{attrs:{kpiId:_vm.activeKpiId},on:{close:_vm.closeCreateDialog}}):_vm._e()],1)},staticRenderFns=[],objectSpread2=__webpack_require__(595082),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),SetupLoader=(__webpack_require__(648324),__webpack_require__(434284),__webpack_require__(233432)),SetupEmptyState=__webpack_require__(622957),WidgetPagination=__webpack_require__(806339),AdvancedSearch=__webpack_require__(784823),FTags=__webpack_require__(775676),api=__webpack_require__(32284),vuex_esm=__webpack_require__(420629),CustomModuleData=__webpack_require__(689565),CreateKpiHistoricalFormvue_type_template_id_0dcf35e1_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticStyle:{"z-index":"999999"},attrs:{title:_vm.$t("kpi.historical.kpi_history"),visible:!0,"append-to-body":!0,"custom-class":"setup-dialog40 kpi-historical-popup-dialog bR8","before-close":_vm.closeDialog}},[_c("el-form",{ref:"historyForm",attrs:{"label-position":"top",model:_vm.historyForm,rules:_vm.formRules}},[_c("el-form-item",{attrs:{label:"KPI Template",prop:"kpiId"}},[_c("FLookupField",{key:"kpi-lookup-field",ref:"kpi-lookup-field",attrs:{model:_vm.historyForm.kpiId,field:_vm.kpiField,preHookFilterConstruction:_vm.constructKpiTypeFilter},on:{"update:model":function($event){return _vm.$set(_vm.historyForm,"kpiId",$event)},showLookupWizard:_vm.showKpiLookupWizard}})],1),_c("el-form-item",{attrs:{label:"Asset",prop:"assets"}},[_c("FLookupField",{key:"assets-lookup-field",ref:"assets-lookup-field",attrs:{model:_vm.historyForm.assets,field:_vm.assetField,categoryId:_vm.assetCategoryId,disabled:_vm.isKpiSelected},on:{"update:model":function($event){return _vm.$set(_vm.historyForm,"assets",$event)},showLookupWizard:_vm.showAssetsLookupWizard}})],1),_c("el-form-item",{staticClass:"reading-kpi-date-picker",attrs:{label:"Interval",prop:"dateRange"}},[_c("FddHistoricalDatePicker",{on:{rangeChange:_vm.setDateRange}})],1),_c("el-form-item",{staticClass:"mB10"},[_c("div",{staticClass:"kpi-history-log-create-button"},[_c("el-button",{on:{click:_vm.closeDialog}},[_vm._v(" "+_vm._s(_vm.$t("common._common.cancel"))+" ")]),_c("el-button",{attrs:{type:"primary"},on:{click:_vm.onSubmit}},[_vm._v(" "+_vm._s(_vm.$t("common.products.create"))+" ")])],1)])],1),_vm.canShowLookupWizard?_c("div",[_vm.isNewLookupWizardEnabled?_c("LookupWizard",{attrs:{canShowLookupWizard:_vm.canShowLookupWizard,field:_vm.selectedLookupField},on:{"update:canShowLookupWizard":function($event){_vm.canShowLookupWizard=$event},"update:can-show-lookup-wizard":function($event){_vm.canShowLookupWizard=$event},setLookupFieldValue:_vm.setLookupFieldValue}}):_c("FLookupFieldWizard",{attrs:{canShowLookupWizard:_vm.canShowLookupWizard,selectedLookupField:_vm.selectedLookupField,categoryId:_vm.assetCategoryIdForWizard},on:{"update:canShowLookupWizard":function($event){_vm.canShowLookupWizard=$event},"update:can-show-lookup-wizard":function($event){_vm.canShowLookupWizard=$event},setLookupFieldValue:_vm.setLookupFieldValue}})],1):_vm._e()],1)},CreateKpiHistoricalFormvue_type_template_id_0dcf35e1_staticRenderFns=[],toConsumableArray=__webpack_require__(488478),validation=(__webpack_require__(450886),__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(891719),__webpack_require__(990260)),FLookupField=__webpack_require__(855048),FLookupFieldWizard=__webpack_require__(499751),ui_forms=__webpack_require__(141323),FddHistoricalDatePicker=__webpack_require__(748791),CreateKpiHistoricalFormvue_type_script_lang_js={props:["kpiId"],components:{FLookupField:FLookupField/* default */.Z,FLookupFieldWizard:FLookupFieldWizard["default"],FddHistoricalDatePicker:FddHistoricalDatePicker/* default */.Z,LookupWizard:ui_forms/* LookupWizard */.ns},created:function(){var kpiId=this.kpiId;(0,validation/* isEmpty */.xb)(kpiId)||(this.historyForm.kpiId=kpiId)},data:function(){return{kpiList:[],currentKpi:null,assetCategoryId:null,assetCategoryIdForWizard:null,historyForm:{kpiId:null,assets:null,dateRange:null},assetField:{isDataLoading:!1,options:[],lookupModuleName:"asset",placeHolderText:"".concat(this.$t("kpi.historical.assets")),field:{lookupModule:{name:"asset",displayName:"Asset"}},filters:{},multiple:!0},isKpiWizard:!1,kpiField:{isDataLoading:!1,options:[],lookupModuleName:"readingkpi",placeHolderText:"".concat(this.$t("kpi.historical.select_kpi")),field:{lookupModule:{name:"readingkpi",displayName:"Reading KPI"}},filters:{status:{operatorId:15,value:["true"]}},multiple:!1},canShowLookupWizard:!1,selectedLookupField:null,formRules:{kpiId:[{required:!0,message:"Please select a KPI",trigger:"blur"}],dateRange:[{required:!0,message:"Please choose a Date Range",trigger:"blur"}]}}},computed:{isKpiSelected:function(){var _this$historyForm=this.historyForm,_this$historyForm2=void 0===_this$historyForm?{}:_this$historyForm,kpiId=_this$historyForm2.kpiId;return(0,validation/* isEmpty */.xb)(kpiId)},isNewLookupWizardEnabled:function(){return this.$helpers.isLicenseEnabled("NEW_LOOKUP_WIZARD")}},watch:{"historyForm.kpiId":function(newVal){(0,validation/* isEmpty */.xb)(newVal)||this.loadKpi(newVal)}},methods:{reset:function(){this.historyForm={kpiId:null,assets:null,dateRange:null}},closeDialog:function(){this.reset(),this.$emit("close")},onSubmit:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:_this.$refs["historyForm"].validate((function(valid){valid&&_this.createHistory()}));case 1:case"end":return _context.stop()}}),_callee)})))()},createHistory:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var historyForm,_ref,kpiId,dateRange,assets,url,params,_yield$API$post,data,error,_ref2,success;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return historyForm=_this2.historyForm,_ref=historyForm||{},kpiId=_ref.kpiId,dateRange=_ref.dateRange,assets=_ref.assets,url="v3/readingKpi/historical/run",params={recordId:kpiId,assets:assets,startTime:dateRange[0],endTime:dateRange[1]},_context2.next=6,api/* API */.bl.post(url,params);case 6:_yield$API$post=_context2.sent,data=_yield$API$post.data,error=_yield$API$post.error,(0,validation/* isEmpty */.xb)(error)?(_ref2=data||{},success=_ref2.success,_this2.$message.success(success),_this2.closeDialog()):_this2.$message.error(error.message);case 10:case"end":return _context2.stop()}}),_callee2)})))()},loadKpi:function(){var _arguments=arguments,_this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var force,_this3$historyForm,_this3$historyForm2,kpiId,_yield$API$fetchRecor,readingkpi,_ref3,_ref3$assetCategory,_ref3$assetCategory2,id;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return force=!(_arguments.length>0&&void 0!==_arguments[0])||_arguments[0],_this3$historyForm=_this3.historyForm,_this3$historyForm2=void 0===_this3$historyForm?{}:_this3$historyForm,kpiId=_this3$historyForm2.kpiId,_context3.prev=2,_context3.next=5,api/* API */.bl.fetchRecord("readingkpi",{id:kpiId},{force:force});case 5:_yield$API$fetchRecor=_context3.sent,readingkpi=_yield$API$fetchRecor.readingkpi,_this3.currentKpi=readingkpi,_ref3=readingkpi||{},_ref3$assetCategory=_ref3.assetCategory,_ref3$assetCategory2=void 0===_ref3$assetCategory?{}:_ref3$assetCategory,id=_ref3$assetCategory2.id,_this3.assetCategoryId=id,_context3.next=15;break;case 12:_context3.prev=12,_context3.t0=_context3["catch"](2),_this3.$message.error(_context3.t0.message);case 15:case"end":return _context3.stop()}}),_callee3,null,[[2,12]])})))()},showKpiLookupWizard:function(field,canShow){this.isKpiWizard=!0,this.assetCategoryIdForWizard=null,this.showLookupWizard(field,canShow)},showAssetsLookupWizard:function(field,canShow){this.isKpiWizard=!1,this.assetCategoryIdForWizard=this.assetCategoryId,this.showLookupWizard(field,canShow)},showLookupWizard:function(field,canShow){this.$set(this,"selectedLookupField",field),this.$set(this,"canShowLookupWizard",canShow)},setLookupFieldValue:function(props){var historyForm=this.historyForm,field=props.field,_ref4=field||{},_ref4$options=_ref4.options,options=void 0===_ref4$options?[]:_ref4$options,_ref4$selectedItems=_ref4.selectedItems,selectedItems=void 0===_ref4$selectedItems?[]:_ref4$selectedItems,selectedItemIds=[];if(!(0,validation/* isEmpty */.xb)(selectedItems))if(selectedItemIds=selectedItems.map((function(item){return item.value})),(0,validation/* isEmpty */.xb)(options))options=(0,toConsumableArray/* default */.Z)(selectedItems);else{var _options,ids=options.map((function(item){return item.value})),newOptions=selectedItems.filter((function(item){return!ids.includes(item.value)}));(_options=options).unshift.apply(_options,(0,toConsumableArray/* default */.Z)(newOptions))}this.isKpiWizard?this.$set(historyForm,"kpiId",selectedItemIds[0]):(this.$set(historyForm,"assets",selectedItemIds),this.isKpiWizard=!1),this.$set(this.selectedLookupField,"options",options)},setDateRange:function(dateObj){this.historyForm.dateRange=(0,toConsumableArray/* default */.Z)(dateObj)},constructKpiTypeFilter:function(){return{kpiType:{operator:"is",value:["1","2"]}}}}},readingkpi_CreateKpiHistoricalFormvue_type_script_lang_js=CreateKpiHistoricalFormvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(readingkpi_CreateKpiHistoricalFormvue_type_script_lang_js,CreateKpiHistoricalFormvue_type_template_id_0dcf35e1_render,CreateKpiHistoricalFormvue_type_template_id_0dcf35e1_staticRenderFns,!1,null,null,null)
/* harmony default export */,CreateKpiHistoricalForm=component.exports,KPIHistoryLogsvue_type_script_lang_js={props:["showHistoricalDialog"],components:{SetupLoader:SetupLoader/* default */.Z,SetupEmpty:SetupEmptyState/* default */.Z,Pagination:WidgetPagination/* default */.Z,AdvancedSearch:AdvancedSearch/* default */.Z,FTags:FTags["default"],CreateKpiHistoricalDialog:CreateKpiHistoricalForm},data:function(){return{showDialog:!1,isLoading:!1,records:[],kpiFilterList:[],recordCount:null,page:1,perPage:20,childrenMap:{},activeNames:[],activeKpiId:null}},created:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _this.setActiveKpi(),_context.next=3,_this.loadRecords({force:!0});case 3:_this.$store.dispatch("view/loadModuleMeta","readingrule"),_this.$store.dispatch("loadAssetCategory");case 5:case"end":return _context.stop()}}),_callee)})))()},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({assetCategoryList:function(state){return state.assetCategory}})),(0,vuex_esm/* mapGetters */.Se)(["getUser"])),{},{moduleName:function(){return"kpiLogger"},moduleDisplayName:function(){return"KPI Logger"},modelDataClass:function(){return CustomModuleData/* CustomModuleData */.u}}),methods:{getSuccessCount:function(record){var _ref=record||{},successCount=_ref.successCount;return(0,validation/* isEmpty */.xb)(successCount)?0:successCount},getTimeDateFormat:function(record,timeProp){return this.$helpers.formatDateFull(this.getRecordData(record,timeProp))},getTimeFormat:function(record,timeProp){return this.$helpers.formatTimeFull(this.getRecordData(record,timeProp))},resetPage:function(){this.page=1},resetFilters:function(){this.kpiFilterList=[],this.resetPage(),this.loadRecords({filters:this.kpiFilterList})},applyReadingKpiFilters:function(_ref2){var filters=_ref2.filters;this.kpiFilterList=filters,this.resetPage(),this.loadRecords()},loadRecords:function(props){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var _ref3,force,moduleName,page,perPage,kpiFilterList,params,_yield$API$get,data,meta,_ref4,kpiLogger,_ref5,pagination,_ref6,totalCount;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _context2.prev=0,_ref3=props||{},force=_ref3.force,moduleName=_this2.moduleName,page=_this2.page,perPage=_this2.perPage,kpiFilterList=_this2.kpiFilterList,params={moduleName:moduleName,page:page,perPage:perPage,force:force,filters:JSON.stringify((0,objectSpread2/* default */.Z)({isSysCreated:{operatorId:15,value:["false"]}},kpiFilterList)),withCount:!0,orderBy:"SYS_CREATED_TIME",orderType:"desc"},_this2.isLoading=!0,_context2.next=7,api/* API */.bl.get("v3/modules/data/list",params);case 7:_yield$API$get=_context2.sent,data=_yield$API$get.data,meta=_yield$API$get.meta,_ref4=data||{},kpiLogger=_ref4.kpiLogger,_this2.records=kpiLogger,_ref5=meta||{},pagination=_ref5.pagination,_ref6=pagination||{},totalCount=_ref6.totalCount,_this2.recordCount=totalCount,_context2.next=20;break;case 17:_context2.prev=17,_context2.t0=_context2["catch"](0),_this2.$message.error(_context2.t0);case 20:_this2.isLoading=!1;case 21:case"end":return _context2.stop()}}),_callee2,null,[[0,17]])})))()},reloadLogs:function(){this.loadRecords()},loadNextPage:function(page){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return _this3.page=page,_context3.next=3,_this3.loadRecords();case 3:case"end":return _context3.stop()}}),_callee3)})))()},getRecordData:function(record,property){return this.$getProperty(record,"".concat(property),"---")},getResourceCount:function(record){var _ref7=record||{},resourceCount=_ref7.resourceCount;return resourceCount},getErrMsg:function(child){var _ref8=child||{},errMsg=_ref8.errMsg;return(0,validation/* isEmpty */.xb)(errMsg)?"Success":"(".concat(errMsg,")")},handleChange:function(index){var records=this.records,currentParent=records[index],_ref9=currentParent||{},parentId=_ref9.id;(0,validation/* isEmpty */.xb)(parentId)||(0,validation/* isEmpty */.xb)(this.childrenMap[parentId])&&this.handleNodeClick(currentParent)},handleNodeClick:function(parentLogger){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){var _ref10,id,url,_yield$API$get2,data,error,message;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:return _ref10=parentLogger||{},id=_ref10.id,url="/v3/readingKpi/historical/fetchAssetDetails",_this4.$set(parentLogger,"isLoading",!0),_context4.next=5,api/* API */.bl.get(url,{parentLoggerId:id});case 5:_yield$API$get2=_context4.sent,data=_yield$API$get2.data,error=_yield$API$get2.error,error?(message=error.message,_this4.$message.error(message||"Error Occured")):(_this4.$set(parentLogger,"isLoading",!1),_this4.childrenMap[id]=Object.assign(_this4.$getProperty(data,"assetList",[])));case 9:case"end":return _context4.stop()}}),_callee4)})))()},closeCreateDialog:function(){this.activeKpiId=null,this.$emit("closeCreateDialog")},setActiveKpi:function(){var $route=this.$route,_ref11=$route||{},params=_ref11.params,_ref12=params||{},kpiId=_ref12.kpiId;(0,validation/* isEmpty */.xb)(kpiId)||(this.activeKpiId=kpiId,this.$emit("openCreateDialog"))},getCreatedUserName:function(readingKpi){var _ref13=readingKpi||{},sysCreatedBy=_ref13.sysCreatedBy;return this.getUserName(sysCreatedBy)},getUserName:function(userObj){if(!(0,validation/* isEmpty */.xb)(userObj)){var _ref14=null!==userObj&&void 0!==userObj?userObj:{},id=_ref14.id,currentUser=this.getUser(id),_ref15=null!==currentUser&&void 0!==currentUser?currentUser:{},name=_ref15.name;return"Unknown"===name?"---":name}return"---"}}},readingkpi_KPIHistoryLogsvue_type_script_lang_js=KPIHistoryLogsvue_type_script_lang_js,KPIHistoryLogs_component=(0,componentNormalizer/* default */.Z)(readingkpi_KPIHistoryLogsvue_type_script_lang_js,render,staticRenderFns,!1,null,"c66654fc",null)
/* harmony default export */,KPIHistoryLogs=KPIHistoryLogs_component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/14927.js.map