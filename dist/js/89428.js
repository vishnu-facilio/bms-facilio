(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[89428,32686,80865,53021],{
/***/646716:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FetchViewsMixin}});
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js
var render,staticRenderFns,regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),validation=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(434284),__webpack_require__(990260)),api=__webpack_require__(32284),FetchViewsMixinvue_type_script_lang_js={methods:{fetchView:function(moduleName){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var params,_yield$API$get,data,error,_ref,groupViews;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.prev=0,params={moduleName:moduleName,groupType:1,viewType:1},_context.next=4,api/* API */.bl.get("/v2/views/viewList",params);case 4:if(_yield$API$get=_context.sent,data=_yield$API$get.data,error=_yield$API$get.error,error){_context.next=10;break}return _ref=data||{},groupViews=_ref.groupViews,_context.abrupt("return",_this.getFirstView(groupViews));case 10:_context.next=15;break;case 12:return _context.prev=12,_context.t0=_context["catch"](0),_context.abrupt("return","all");case 15:case"end":return _context.stop()}}),_callee,null,[[0,12]])})))()},getFirstView:function(groupViews){var _ref2=(groupViews||[]).find((function(group){return!(0,validation/* isEmpty */.xb)(group.views)}))||{},views=_ref2.views,_this$$getProperty=this.$getProperty(views,"0",{}),name=_this$$getProperty.name;return name||"all"}}},base_FetchViewsMixinvue_type_script_lang_js=FetchViewsMixinvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(base_FetchViewsMixinvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FetchViewsMixin=component.exports;
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js
},
/***/874249:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return RichTextArea}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/forms/RichTextArea.vue?vue&type=template&id=7711575b
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.isRichText?_c("div",{staticClass:"richtext-area"},[_c("RichText",{style:{minHeight:_vm.minHeight,maxHeight:_vm.maxHeight,overflow:_vm.overflow},attrs:{readOnly:_vm.disabled,placeholder:_vm.placeholder,hideImgTool:_vm.hideImgTool,hideUnorderedList:_vm.hideUnorderedList,hideOrderedList:_vm.hideOrderedList,secondaryToolbar:_vm.secondaryToolbar,istoolbarPositionBottom:_vm.istoolbarPositionBottom,isMoreOption:_vm.isMoreOption,customToolOrder:_vm.customToolOrder,iconColor:_vm.iconColor},scopedSlots:_vm._u([_vm.canShowModeToggle?{key:"editorMode",fn:function(){return[_c("div",{staticClass:"self-center marginL-auto mR15 cursor-pointer mode-btn",on:{click:function($event){return _vm.changeMode()}}},[_vm._v(" "+_vm._s(_vm.$t("forms.builder.plain_text_mode"))+" ")])]},proxy:!0}:null],null,!0),model:{value:_vm.content,callback:function($$v){_vm.content=$$v},expression:"content"}})],1):_c("div",{staticClass:"richtext-area plain-text-mode"},[_c("div",{staticClass:"richtext-editor"},[_c("div",{staticClass:"richtext-toolbar"},[_c("div",{staticClass:"toolbar-button marginL-auto cursor-pointer mode-btn",on:{click:function($event){return _vm.changeMode()}}},[_vm._v(" "+_vm._s(_vm.$t("forms.builder.switch_to_richtext"))+" ")])]),_c("el-input",{key:"plain-text",staticClass:"richtext-content",attrs:{type:"textarea",resize:"none",placeholder:_vm.placeholder},model:{value:_vm.content,callback:function($$v){_vm.content=$$v},expression:"content"}})],1)])},staticRenderFns=[],ui_forms=(__webpack_require__(879288),__webpack_require__(141323)),filters=__webpack_require__(638203),RichTextAreavue_type_script_lang_js={props:{value:{type:String},field:{type:Object},rows:{type:Number,default:10},maxRows:{type:Number,default:12},disabled:{type:Boolean,default:!1},placeholder:{type:String,default:"Enter text here"},isEdit:{type:Boolean,default:!1},hideImgTool:{type:Boolean,default:!1},hideOrderedList:{type:Boolean,default:!1},hideUnorderedList:{type:Boolean,default:!1},isRichTextMode:{type:Boolean,default:!0},canShowModeToggle:{type:Boolean,default:!1},istoolbarPositionBottom:{type:Boolean},customToolOrder:{type:Array},isMoreOption:{type:Boolean},secondaryToolbar:{type:Boolean},iconColor:{type:String}},components:{RichText:ui_forms/* RichText */.Ho},computed:{content:{get:function(){return this.value},set:function(value){this.$emit("input",value)}},isRichText:{get:function(){return this.isRichTextMode},set:function(value){this.$emit("update:isRichTextMode",value)}},
// Assuming a <p></p> tag inside editor
// has fonts-size 1rem and margin-bottom 1rem
minHeight:function(){return"".concat(2*this.rows,"rem")},maxHeight:function(){return"".concat(2*this.maxRows,"rem")},overflow:function(){return"hidden"}},methods:{changeMode:function(){var isRichText=this.isRichText,value=this.value;if(isRichText)this.showConfirmModeSwitch();else{var htmlContent="<p>".concat(value,"</p>");this.content=htmlContent,this.proceedChangingModes()}},showConfirmModeSwitch:function(){var _this=this,dialogObj={htmlMessage:"".concat(this.$t("forms.builder.switch_alert")),rbDanger:!0,rbLabel:"Confirm"};this.$dialog.confirm(dialogObj).then((function(canProceed){if(canProceed){var value=_this.value,textContent=(0,filters/* htmlToText */.s9)(value);_this.content=textContent,_this.proceedChangingModes()}}))},proceedChangingModes:function(){var isRichText=this.isRichText;this.isRichText=!isRichText}}},forms_RichTextAreavue_type_script_lang_js=RichTextAreavue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(forms_RichTextAreavue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,RichTextArea=component.exports},
/***/113662:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return NewInspectionTemplate}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/inspection/inspection-template/NewInspectionTemplate.vue?vue&type=template&id=4a676a62&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.bulkMode?_vm._e():_c("div",{staticClass:"form-data-creation inspection-form-template",class:[_vm.$validation.isEmpty(_vm.widgetsArr)?"":"form-creation-widgets",_vm.customClassForContainer]},[_c("div",{class:[_vm.$validation.isEmpty(_vm.widgetsArr)?"":"form-left-container"]},[_c("div",{staticClass:"header mT20 mB10 d-flex"},[_c("div",{staticClass:"title mT10"},[_vm._v(_vm._s(_vm.title))]),_vm.forms.length>1?_c("el-select",{staticClass:"fc-input-full-border-select2 mL-auto width25",attrs:{"value-key":"name"},model:{value:_vm.selectedForm,callback:function($$v){_vm.selectedForm=$$v},expression:"selectedForm"}},_vm._l(_vm.forms,(function(form,index){return _c("el-option",{key:index,attrs:{value:form,label:form.displayName}})})),1):_vm._e()],1),_c("div",{staticClass:"inspection-form-creation"},[_vm.isLoading?_c("div",{staticClass:"loading-container d-flex"},[_c("Spinner",{attrs:{show:_vm.isLoading}})],1):[_c("f-webform",{attrs:{form:_vm.formObj,module:_vm.moduleName,moduleDisplayName:_vm.moduleDisplayName,isSaving:_vm.isSaving,canShowPrimaryBtn:!1,canShowSecondaryBtn:!1,isEdit:_vm.isEdit,isV3Api:_vm.isV3Api,isWidgetsSupported:_vm.isWidgetsSupported,moduleData:_vm.moduleData,moduleDataId:_vm.moduleDataId},on:{"update:form":function($event){_vm.formObj=$event},onFormModelChange:_vm.onFormModelChange}}),_c("div",{staticClass:"trigger-section-container mT20 white-background"},[_c("div",{staticClass:"pL70 pR70"},[_c("div",{staticClass:"section-heading pT50 text-uppercase"},[_vm._v(" "+_vm._s(_vm.$t("qanda.template.triggers"))+" "),_c("div",{staticClass:"fc-heading-border-width43 mT15"})]),_c("div",{staticClass:"pT20 pB20"},_vm._l(_vm.triggersList,(function(trigger,index){return _c("div",{key:index,class:["trigger-list",0===index&&"border-top"]},[_c("div",{staticClass:"d-flex align-center"},[_c("div",{staticClass:"dot-green fL mR10"}),_vm._v(" "+_vm._s(trigger.name)+" ")]),_c("div",{staticClass:"trigger-actions"},[2===_vm.$getProperty(_vm.inspectionModel,"creationType.id")?_c("div",{staticClass:"items-center d-flex mR20 cursor-pointer",on:{click:function($event){return _vm.openSpaceAssetLookup(index)}}},[_c("Spinner",{attrs:{show:_vm.selectedTrigerIndexLoading==index,size:"30"}}),_c("inline-svg",{staticClass:"vertical-middle",attrs:{src:"location-icon",iconClass:"icon icon-sm location-icon mT3"}}),_vm.$validation.isEmpty(trigger.assets)?_c("div",{staticClass:"mL5"},[_vm._v(" "+_vm._s(_vm.$t("qanda.template.select_space_assets"))+" ")]):_c("div",{staticClass:"mL5"},[_vm._v(" "+_vm._s(_vm.getMultiAssetLabel(trigger.assets))+" ")])],1):_vm._e(),_c("div",{staticClass:"d-flex items-center trigger-actions visibility-hide-actions mT3"},[_c("i",{staticClass:"el-icon-edit  edit-icon-grey pL5 pointer",on:{click:function($event){return _vm.editTrigger(trigger,index)}}}),_c("div",{staticClass:"pL10 pointer",on:{click:function($event){return _vm.deleteTrigger(index)}}},[_c("img",{attrs:{src:__webpack_require__(385769),height:"14",width:"14"}})])])])])})),0),_vm.$validation.isEmpty(_vm.triggersList)?_c("div",{staticClass:"d-flex items-center mR40 flex-col"},[_c("inline-svg",{attrs:{src:"svgs/emptystate/readings-empty",iconClass:"icon text-center icon-xxxlg mB10 mT10"}}),_c("span",{staticClass:"empty-state-text"},[_vm._v(_vm._s(_vm.$t("qanda.template.no_triggers")))])],1):_vm._e(),_c("div",{class:["d-flex mB60",_vm.$validation.isEmpty(_vm.triggersList)&&"pT10 mR40 justify-center"]},[_c("el-button",{staticClass:"add-trigger-btn mT10",on:{click:_vm.openTrigger}},[_vm._v(_vm._s(_vm.$t("qanda.template.add_trigger")))])],1)]),_c("div",{staticClass:"flex-grow flex-shrink white-background"}),_c("div",{staticClass:"inspection-btn-footer"},[_c("el-button",{staticClass:"modal-btn-cancel text-uppercase",on:{click:function($event){return _vm.redirectToList()}}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_c("el-button",{staticClass:"modal-btn-save mL0",attrs:{loading:_vm.saving},on:{click:_vm.save}},[_vm._v(" "+_vm._s(_vm.saving?_vm.$t("common._common._saving"):_vm.$t("common._common._save"))+" ")])],1)])]],2)]),_vm.openTriggerDialog?_c("el-dialog",{staticClass:"fc-dialog-center-container new-add-triger-dialog fc-dialog-header-hide",attrs:{visible:_vm.openTriggerDialog,"append-to-body":!0},on:{"update:visible":function($event){_vm.openTriggerDialog=$event}}},[_c("div",{staticClass:"positon-relative trigger-dialog-body"},[_c("trigger",{attrs:{trigger:_vm.triggerEdit,customTriggerTypes:[1,4]}})],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.cancelTriggerSave}},[_vm._v("Cancel")]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:_vm.saveTrigger}},[_vm._v("SAVE")])],1)]):_vm._e(),_c("portal-target",{staticClass:"widgets-container",attrs:{name:"side-bar-widgets"}}),_vm.showLookupFieldWizard?_c("FLookupFieldWizard",{attrs:{canShowLookupWizard:_vm.showLookupFieldWizard,selectedLookupField:_vm.fieldObj},on:{"update:canShowLookupWizard":function($event){_vm.showLookupFieldWizard=$event},"update:can-show-lookup-wizard":function($event){_vm.showLookupFieldWizard=$event},setLookupFieldValue:_vm.setLookupFieldValue}}):_vm._e()],1)},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),objectSpread2=__webpack_require__(595082),asyncToGenerator=__webpack_require__(548534),validation=(__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(450886),__webpack_require__(434284),__webpack_require__(670560),__webpack_require__(162506),__webpack_require__(169358),__webpack_require__(976801),__webpack_require__(634338),__webpack_require__(506203),__webpack_require__(689730),__webpack_require__(990260)),FormCreation=__webpack_require__(373729),PMMixin=__webpack_require__(369087),PMTrigger=__webpack_require__(438817),api=__webpack_require__(32284),FLookupFieldWizard=__webpack_require__(499751),FetchViewsMixin=__webpack_require__(646716),SeasonTriggerMixin=__webpack_require__(747192),router=__webpack_require__(329435),NewInspectionTemplatevue_type_script_lang_js={name:"NewInspectionTemplate",extends:FormCreation/* default */.Z,mixins:[PMMixin/* default */.Z,FetchViewsMixin/* default */.Z,SeasonTriggerMixin/* default */.Z],data:function(){return{saving:!1,inspectionModel:{},openTriggerDialog:!1,triggerEdit:{},triggersList:[],currentTriggerIndex:null,loading:!1,record:null,showLookupFieldWizard:!1,fieldObj:{},selectedTriggerIndex:null,selectedTrigerIndexLoading:null}},components:{Trigger:PMTrigger/* default */.Z,FLookupFieldWizard:FLookupFieldWizard["default"]},created:function(){this.moduleDataId&&this.deserialise()},computed:{moduleName:function(){return"inspectionTemplate"},moduleDisplayName:function(){return this.formObj&&this.formObj.module?this.formObj.module.displayName:""},isV3Api:function(){return!0},isWidgetsSupported:function(){return!0},title:function(){var moduleDisplayName=this.moduleDisplayName,moduleDataId=this.moduleDataId,title="";return title=(0,validation/* isEmpty */.xb)(moduleDataId)?"Create ".concat(moduleDisplayName):"Edit ".concat(moduleDisplayName),title},moduleDataId:function(){var id=this.$route.params.id;return id?parseInt(id):null}},methods:{deserialise:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var moduleDataId,moduleName,_yield$API$fetchRecor,data,error,_ref,triggers;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _this.loading=!0,moduleDataId=_this.moduleDataId,moduleName=_this.moduleName,_context.next=4,api/* API */.bl.fetchRecord(moduleName,{id:moduleDataId});case 4:_yield$API$fetchRecor=_context.sent,data=_yield$API$fetchRecor[moduleName],error=_yield$API$fetchRecor.error,error?_this.$message.error("Error Occured"):(_ref=data||{},triggers=_ref.triggers,triggers.forEach((function(trigger){var schedule=_this.$getProperty(trigger,"schedule.scheduleInfo"),startTime=_this.$getProperty(trigger,"schedule.startTime"),assets=_this.$getProperty(trigger,"resInclExclList"),_ref2=trigger||{},type=_ref2.type;2===type&&(type=4),(0,validation/* isEmpty */.xb)(assets)||(assets=assets.map((function(asset){var resource=asset.resource;return(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},asset),{},{label:resource.name,value:resource.id})}))),_this.triggersList.push((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},trigger),{},{type:type,schedule:schedule,assets:assets||[],startTime:startTime}))})),_this.record=data),_this.loading=!1;case 9:case"end":return _context.stop()}}),_callee)})))()},redirectToList:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var viewname,_ref3,name;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,_this2.fetchView(_this2.moduleName);case 2:viewname=_context2.sent,(0,router/* isWebTabsEnabled */.tj)()?(_ref3=(0,router/* findRouteForModule */.Jp)(_this2.moduleName,router/* pageTypes */.As.LIST)||{},name=_ref3.name,name&&_this2.$router.push({name:name,params:{viewname:viewname},query:_this2.$route.query})):_this2.$router.push({name:"inspectionTemplateList",params:{viewname:"all"}});case 4:case"end":return _context2.stop()}}),_callee2)})))()},redirectToSummary:function(id){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var viewname,_ref4,name;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,_this3.fetchView(_this3.moduleName);case 2:viewname=_context3.sent,(0,router/* isWebTabsEnabled */.tj)()?(_ref4=(0,router/* findRouteForModule */.Jp)(_this3.moduleName,router/* pageTypes */.As.OVERVIEW)||{},name=_ref4.name,name&&_this3.$router.push({name:name,params:{viewname:viewname,id:id},query:_this3.$route.query})):_this3.$router.push({name:"inspectionTemplateSummary",params:{id:id,viewname:"all"}});case 4:case"end":return _context3.stop()}}),_callee3)})))()},onFormModelChange:function(model){var inspectionModel=this.inspectionModel;this.inspectionModel=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},inspectionModel),model)},openTrigger:function(){var type=1,startDate=new Date;startDate.setHours(0,0,0,0);var startTime=startDate.getTime(),name="Trigger ".concat(this.triggersList.length+1);this.triggerEdit={name:name,type:type,startDate:startDate,startTime:startTime,basedOn:"Date",schedule:{times:["00:00"],frequency:1,skipEvery:-1,values:[],frequencyType:1,weekFrequency:-1,yearlyDayValue:null,monthValue:-1,yearlyDayOfWeekValues:[]},customTrigger:{customModuleId:null,fieldId:null,days:null,hours:null},stopAfter:"never",endTime:new Date,startReading:null,readingFieldId:null,stopAfterReading:"never",endReading:null,readingInterval:null,assignedTo:null,reminders:[],criteria:null,sharingContext:{shareTo:2,sharedRoles:[],sharedUsers:[],sharedGroups:[]}},this.currentTriggerIndex=null,this.openTriggerDialog=!0},cancelTriggerSave:function(){this.openTriggerDialog=!1},saveTrigger:function(){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){var triggerEdit,currentTriggerIndex,frequencyType,basedOn;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,_this4.canSaveTrigger();case 2:if(_context4.sent){_context4.next=4;break}return _context4.abrupt("return");case 4:triggerEdit=_this4.triggerEdit,currentTriggerIndex=_this4.currentTriggerIndex,frequencyType=_this4.$getProperty(triggerEdit,"schedule.frequencyType",null),basedOn=_this4.$getProperty(triggerEdit,"basedOn",null),(0,validation/* isEmpty */.xb)(frequencyType)||(frequencyType=_this4.$constants.FACILIO_FREQUENCY[frequencyType],"Monthly"===frequencyType?"Date"===basedOn?_this4.$setProperty(_this4,"triggerEdit.schedule.frequencyType",3):_this4.$setProperty(_this4,"triggerEdit.schedule.frequencyType",4):"Quarterly"===frequencyType?"Date"===basedOn?_this4.$setProperty(_this4,"triggerEdit.schedule.frequencyType",7):_this4.$setProperty(_this4,"triggerEdit.schedule.frequencyType",8):"Half Yearly"===frequencyType?"Date"===basedOn?_this4.$setProperty(_this4,"triggerEdit.schedule.frequencyType",9):_this4.$setProperty(_this4,"triggerEdit.schedule.frequencyType",10):"Annually"===frequencyType&&("Date"===basedOn?_this4.$setProperty(_this4,"triggerEdit.schedule.frequencyType",5):_this4.$setProperty(_this4,"triggerEdit.schedule.frequencyType",6))),(0,validation/* isEmpty */.xb)(currentTriggerIndex)?_this4.triggersList.push(triggerEdit):_this4.triggersList[currentTriggerIndex]=triggerEdit,_this4.currentTriggerIndex=null,_this4.openTriggerDialog=!1;case 11:case"end":return _context4.stop()}}),_callee4)})))()},deleteTrigger:function(index){this.triggersList.splice(index,1)},editTrigger:function(trigger,index){if(this.triggerEdit=this.$helpers.cloneObject(trigger),1===this.$getProperty(trigger,"type",null)){var frequencyType=this.$getProperty(trigger,"schedule.frequencyType",null);frequencyType%2?this.$setProperty(this,"triggerEdit.basedOn","Date"):this.$setProperty(this,"triggerEdit.basedOn","Week"),3===frequencyType||4===frequencyType?this.$setProperty(this,"triggerEdit.schedule.frequencyType",3):7===frequencyType||8===frequencyType?this.$setProperty(this,"triggerEdit.schedule.frequencyType",4):9===frequencyType||10===frequencyType?this.$setProperty(this,"triggerEdit.schedule.frequencyType",5):5!==frequencyType&&6!==frequencyType||this.$setProperty(this,"triggerEdit.schedule.frequencyType",6)}this.currentTriggerIndex=index,this.openTriggerDialog=!0},save:function(){var _this5=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee5(){var inspectionModel,triggersList,moduleName,moduleDataId,formObj,_ref5,formId,data,serializedData,promise,_promise,record,error,id;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context5){while(1)switch(_context5.prev=_context5.next){case 0:if(_this5.saving=!0,inspectionModel=_this5.inspectionModel,triggersList=_this5.triggersList,moduleName=_this5.moduleName,moduleDataId=_this5.moduleDataId,formObj=_this5.formObj,_ref5=formObj||{},formId=_ref5.id,data=_this5.serializeValues(inspectionModel,triggersList,formObj),serializedData=_this5.serializedData(formObj,inspectionModel),data=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},data),serializedData),(0,validation/* isEmpty */.xb)(formId)||(data.formId=formId),(0,validation/* isEmpty */.xb)(moduleDataId)){_context5.next=13;break}return _context5.next=10,api/* API */.bl.updateRecord(moduleName,{id:moduleDataId,data:data});case 10:promise=_context5.sent,_context5.next=16;break;case 13:return _context5.next=15,api/* API */.bl.createRecord(moduleName,{data:data});case 15:promise=_context5.sent;case 16:_promise=promise,record=_promise[moduleName],error=_promise.error,error?_this5.$message.error(error.message||"Error Occured"):(id=record.id,(0,validation/* isEmpty */.xb)(moduleDataId)&&_this5.createPage(id),_this5.redirectToSummary(id)),_this5.saving=!1;case 19:case"end":return _context5.stop()}}),_callee5)})))()},createPage:function(templateId){return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee6(){var data;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context6){while(1)switch(_context6.prev=_context6.next){case 0:return data={name:"Page 1",description:"",parent:templateId,position:1},_context6.next=3,api/* API */.bl.createRecord("qandaPage",{data:data});case 3:case"end":return _context6.stop()}}),_callee6)})))()},serializeValues:function(model,triggerList,formObj){var _formObj$fields=formObj.fields,formFieldObj=void 0===_formObj$fields?[]:_formObj$fields,data=(0,objectSpread2/* default */.Z)({},model);return Object.keys(data).forEach((function(field){var isFileTypeField=formFieldObj.some((function(currField){return"FILE"===currField.displayTypeEnum&&currField.name===field}));if(isFileTypeField&&delete data[field],["creationType","assignmentType"].includes(field)){var _ref6=data[field]||{},id=_ref6.id;data[field]=id}if("assignment"===field){var _ref7=data["assignment"]||{},assignedTo=_ref7.assignedTo,assignmentGroup=_ref7.assignmentGroup;(0,validation/* isEmpty */.xb)(assignedTo.id)||(data["assignedTo"]=assignedTo),(0,validation/* isEmpty */.xb)(assignmentGroup.id)||(data["assignmentGroup"]=assignmentGroup),delete data["assignment"]}if("siteId"===field&&!(0,validation/* isEmpty */.xb)(data[field])){var _ref8=data[field]||{},_id=_ref8.id;data[field]=_id}((0,validation/* isObject */.Kn)(data[field])&&(0,validation/* areValuesEmpty */.sD)(data[field])||(0,validation/* isEmpty */.xb)(data[field]))&&delete data[field]})),triggerList=triggerList.map((function(trigger){var _ref9=trigger||{},name=_ref9.name,type=_ref9.type,schedule=_ref9.schedule,assets=_ref9.assets,startTime=_ref9.startTime;4===type&&(type=2);var param={name:name,type:type,schedule:{scheduleInfo:schedule,startTime:startTime}};if(!(0,validation/* isEmpty */.xb)(assets)){var resInclExclList=assets.map((function(asset){var _ref10=asset||{},value=_ref10.value;return{resource:{id:value},isInclude:!0}}));param["resInclExclList"]=resInclExclList}return param})),data=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},data),{},{triggers:triggerList}),data},setLookupFieldValue:function(value){var selectedItems=this.$getProperty(value,"field.selectedItems"),selectedTriggerIndex=this.selectedTriggerIndex,triggersList=this.triggersList,selectedTrigger=triggersList[selectedTriggerIndex];selectedTrigger["assets"]=selectedItems,triggersList.splice(selectedTriggerIndex,1,selectedTrigger),this.$set(this,"triggersList",triggersList),this.selectedTriggerIndex=null},openSpaceAssetLookup:function(index){var _this6=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee7(){var inspectionModel,_ref11,assignmentType,buildings,spaceCategory,assetCategory,sites,creationType,param,_yield$API$post,data,error,_ref12,criteria,module,_fieldObj,triggersList,fieldObj,selectedTrigger,assets;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context7){while(1)switch(_context7.prev=_context7.next){case 0:if(_this6.selectedTrigerIndexLoading=index,inspectionModel=_this6.inspectionModel,_ref11=inspectionModel||{},assignmentType=_ref11.assignmentType,buildings=_ref11.buildings,spaceCategory=_ref11.spaceCategory,assetCategory=_ref11.assetCategory,sites=_ref11.sites,creationType=_ref11.creationType,2!==creationType.id){_context7.next=12;break}return param={assignmentTypeId:(assignmentType||{}).id,baseSpaceIds:buildings,spaceCategoryId:(spaceCategory||{}).id,assetCategoryId:(assetCategory||{}).id,siteIds:sites},Object.keys(param).forEach((function(paramProperty){(0,validation/* isEmpty */.xb)(param[paramProperty])&&delete param[paramProperty]})),_context7.next=8,api/* API */.bl.post("v3/resourceAllocation/getModuleAndCrtieriaFromConfig",param);case 8:_yield$API$post=_context7.sent,data=_yield$API$post.data,error=_yield$API$post.error,error?_this6.$message.error(error.message||"Error Occured"):(_ref12=data||{},criteria=_ref12.criteria,module=_ref12.module,_fieldObj={isDataLoading:!1,options:[],lookupModuleName:module,field:{lookupModule:{name:module,displayName:module}},forceFetchAlways:!0,filters:{},clientCriteria:criteria,isDisabled:!1,multiple:!0},"asset"===module&&(_fieldObj.filters={storeRoom:{operatorId:1}}),_this6.fieldObj=_fieldObj);case 12:_this6.selectedTrigerIndexLoading=null,_this6.selectedTriggerIndex=index,triggersList=_this6.triggersList,fieldObj=_this6.fieldObj,selectedTrigger=triggersList[index],assets=selectedTrigger.assets,(0,validation/* isEmpty */.xb)(assets)?_this6.$set(fieldObj,"selectedItems",[]):_this6.$set(fieldObj,"selectedItems",assets),_this6.showLookupFieldWizard=!0;case 19:case"end":return _context7.stop()}}),_callee7)})))()},getMultiAssetLabel:function(assets){return assets=assets.map((function(asset){return asset.label})),assets.length>2?"".concat(assets.slice(0,2).join(", "),", +").concat(Math.abs(assets.length-2)):"".concat(assets.join(", "))}}},inspection_template_NewInspectionTemplatevue_type_script_lang_js=NewInspectionTemplatevue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(inspection_template_NewInspectionTemplatevue_type_script_lang_js,render,staticRenderFns,!1,null,"4a676a62",null)
/* harmony default export */,NewInspectionTemplate=component.exports},
/***/188742:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"22bc1f7e3fecc069519710728d363ce9.svg";
/***/}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/89428.js.map