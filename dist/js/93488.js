(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[93488],{
/***/252788:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return BuildingAnalysis}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/energy/analytics/newTools/BuildingAnalysis.vue?vue&type=template&id=4c4a8c59
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"building-analysis-page"},[_vm.isRegression?_c("div",{staticClass:"regression-analysis-page-options-con flex-middle"},[_c("f-report-options",{staticClass:"analytics-page-options-building-analysis ",attrs:{isActionsDisabled:_vm.isActionsDisabled,optionClass:"analytics-page-options",optionsToEnable:_vm.computeReportOptions,reportObject:_vm.reportObject,resultObject:_vm.resultObject,params:_vm.reportObject?_vm.reportObject.params:null,savedReport:_vm.analyticsConfig.savedReport},on:{"update:savedReport":function($event){return _vm.$set(_vm.analyticsConfig,"savedReport",$event)},"update:saved-report":function($event){return _vm.$set(_vm.analyticsConfig,"savedReport",$event)}}})],1):_vm._e(),_c("div",{key:_vm.$route.path,staticClass:"analytics-section-new row"},[_vm.isRegression?_vm._e():_c("div",{staticClass:"newanalytics-page-header"},[_c("div",{staticClass:"row"},[_c("div",{staticClass:"col-8"},[_c("div",{staticClass:"analytics-page-header-filters"},[_vm.isRegression?_vm._e():_c("div",{staticClass:"col-2"},[_vm._m(0)]),_c("div",{staticClass:"col-2"},[_c("div",{staticClass:"fL"},[_c("div",{staticClass:"selected-buildings-analytics"},[_vm._v(" "+_vm._s(_vm.isSiteAnalysis?_vm.$t("common.products.site_analysis"):_vm.$t("common.products.building_analysis"))+" ")])])]),_c("div",{staticClass:"col-4"},[_c("div",{staticClass:"mL20"},[_vm.isRegression?_vm._e():_c("el-select",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"period-select",attrs:{placeholder:_vm.$t("common._common.mode"),title:_vm.$t("common._common.mode"),"data-arrow":"true"},on:{change:_vm.onModeChange},model:{value:_vm.analyticsConfig.mode,callback:function($$v){_vm.$set(_vm.analyticsConfig,"mode",$$v)},expression:"analyticsConfig.mode"}},[_c("el-option",{attrs:{label:_vm.$t("common.wo_report.time"),value:1}}),_c("el-option",{attrs:{label:_vm.$t("common.products.series"),value:2}}),_vm.isSameDataPoint?_c("el-option",{attrs:{label:_vm.$t("common.products.conslidated"),value:3}}):_vm._e()],1),!_vm.baseLineList||_vm.isActionsDisabled||_vm.isRegression?_vm._e():_c("el-cascader",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"period-select",attrs:{placeholder:_vm.$t("common._wo_report.compare_to"),options:_vm.baseLineCasecaderOptions,value:_vm.analyticsConfig.baseLine,title:_vm.$t("common.wo_report.compare_with_baseline"),"data-arrow":"true"},on:{change:_vm.onBaseLineChange}}),2===_vm.analyticsConfig.mode||_vm.isRegression?_vm._e():_c("el-select",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"period-select",attrs:{placeholder:_vm.$t("common.wo_report.period"),title:_vm.$t("common.dashboard.time_period"),"data-arrow":"true"},on:{change:_vm.onPeriodChange},model:{value:_vm.analyticsConfig.period,callback:function($$v){_vm.$set(_vm.analyticsConfig,"period",$$v)},expression:"analyticsConfig.period"}},_vm._l(_vm.getAvailablePeriods,(function(period,index){return _c("el-option",{key:index,attrs:{label:period.name,value:period.value,disabled:!period.enable}})})),1)],1)])])]),_c("div",{staticClass:"col-4",staticStyle:{"text-align":"right"}},[_c("f-report-options",{staticClass:"analytics-page-options-building-analysis",attrs:{isActionsDisabled:_vm.isActionsDisabled,optionClass:"analytics-page-options",optionsToEnable:_vm.computeReportOptions,reportObject:_vm.reportObject,resultObject:_vm.resultObject,params:_vm.reportObject?_vm.reportObject.params:null,savedReport:_vm.analyticsConfig.savedReport},on:{"update:savedReport":function($event){return _vm.$set(_vm.analyticsConfig,"savedReport",$event)},"update:saved-report":function($event){return _vm.$set(_vm.analyticsConfig,"savedReport",$event)}}})],1)])]),_vm.isRegression?_c("FRegressionPointSelector",{attrs:{visibility:_vm.showRegressionPointSelector,enableFloatimngIcon:_vm.enableFloatimngIcon,analyticsConfig:_vm.analyticsConfig},on:{resetState:_vm.resetState,"update:visibility":function($event){_vm.showRegressionPointSelector=$event},"update:enableFloatimngIcon":function($event){_vm.enableFloatimngIcon=$event},"update:enable-floatimng-icon":function($event){_vm.enableFloatimngIcon=$event},updateDataPoints:_vm.applyregression,"update:analyticsConfig":function($event){_vm.analyticsConfig=$event},"update:analytics-config":function($event){_vm.analyticsConfig=$event}}}):_c("f-data-point-selector",{ref:"building-selector",attrs:{reportObject:_vm.reportObject?_vm.reportObject:null,savedPoints:_vm.analyticsConfig.savedReport&&_vm.resultObject?_vm.dataPointSummaryList:null,visibility:_vm.showDataPointSelector,zones:_vm.zones,isSiteAnalysis:_vm.isSiteAnalysis},on:{"update:visibility":function($event){_vm.showDataPointSelector=$event},selectBuildings:_vm.setSelectedBuildings,updateDataPoints:_vm.updateDataPoints}}),_vm.reportObject&&!_vm.isRegression?_c("div",{directives:[{name:"show",rawName:"v-show",value:_vm.showChartCustomization,expression:"showChartCustomization"}],staticClass:"customize-container building-customize-container col-4"},[_c("div",{staticClass:"customize-header"},[_c("div",{staticClass:"customize-H"},[_vm._v(" "+_vm._s(_vm.$t("home.reports.chart_customization"))+" "),_c("i",{staticClass:"el-icon-close",on:{click:_vm.hideChartCustomizationDialog}})])]),_c("div",{staticClass:"customize-body"},[_vm.reportObject?_c("f-chart-customization",{directives:[{name:"show",rawName:"v-show",value:_vm.showChartCustomization,expression:"showChartCustomization"}],attrs:{report:_vm.reportObject,resultDataPoints:_vm.resultObject?_vm.resultObject.report.dataPoints:[],config:_vm.analyticsConfig},on:{close:function($event){_vm.showChartCustomization=!1},resetPoints:_vm.resetDataPointSelector}}):_vm._e()],1)]):_vm._e(),_c("div",{staticClass:"analytic-summary new-analytic-summary scrollable",class:{"col-12, mleft0":!_vm.showChartCustomization,"col-8, mleft447":_vm.showChartCustomization,"regression-bg":_vm.isRegression&&_vm.analyticsConfig.regressionType&&"multiple"===_vm.analyticsConfig.regressionType},style:_vm.showChartCustomization?"max-width: calc(100% - 450px) !important;":""},[_c("div",{directives:[{name:"show",rawName:"v-show",value:!_vm.showChartCustomization,expression:"!showChartCustomization"}],staticClass:"add-points-block"},[_vm.isRegression?_vm._e():_c("el-button-group",[_c("el-button",{staticClass:"add-points-btn",attrs:{type:"primary"},on:{click:function($event){_vm.showDataPointSelector=!0}}},[_c("i",{staticClass:"el-icon-plus"}),_vm._v(_vm._s(_vm.$t("home.dashboard.add_points")))]),_vm.reportObject&&1===_vm.analyticsConfig.mode?_c("el-button",{staticClass:"add-points-btn",attrs:{type:"primary"},on:{click:function($event){_vm.showDerivation=!0}}},[_c("img",{attrs:{src:__webpack_require__(857539),width:"17px",height:"17px"}})]):_vm._e()],1),_vm.reportObject?_c("el-button",{staticClass:"add-points-btn add-points-btn2",attrs:{type:"primary"},on:{click:function($event){return _vm.showChartCustomizationDialog()}}},[_c("img",{attrs:{src:__webpack_require__(108277),width:"17px",height:"17px"}})]):_vm._e()],1),_c("div",{ref:"chartSection",class:["self-center fchart-section building-graph-container",{"prediction-timings-container":_vm.analyticsConfig.predictionTimings&&_vm.analyticsConfig.predictionTimings.length>1,"regression-analysis-chart":_vm.isRegression}]},[_vm.analyticsConfig.dataPoints.length?_vm.isRegression?_vm._e():_c("f-new-analytic-report",{ref:"newAnalyticReport",attrs:{config:_vm.analyticsConfig,baseLines:_vm.baseLineList},on:{"update:config":function($event){_vm.analyticsConfig=$event},reportLoaded:_vm.reportLoaded}}):_c("div",{staticClass:"text-center"},[_vm.reportId||_vm.alarmId||_vm.cardId?_c("div",{staticClass:"p15"},[_c("spinner",{attrs:{show:!0}})],1):_vm.repid?_c("div",{staticClass:"p15"},[_vm.repid?_c("f-new-report",{attrs:{id:_vm.repid},on:{reportLoaded:_vm.reportLoaded}}):_vm._e()],1):_c("div",{staticClass:"p15 flex-middle height80vh justify-content-center flex-direction-column"},[_c("div",[_c("inline-svg",{attrs:{src:"svgs/emptystate/reportlist",iconClass:"icon text-center icon-xxxlg"}})],1),_c("div",{staticClass:"nowo-label"},[_vm._v(" "+_vm._s(_vm.$t("common._common.please_select_data_points_analyze"))+" ")])])]),_vm.isRegression&&_vm.analyticsConfig&&_vm.analyticsConfig.regressionConfig&&0!=_vm.analyticsConfig.regressionConfig.length?_c("FNewAnalyticRegression",{ref:"newAnalyticRegressionReport",staticClass:"regression-single",attrs:{config:_vm.analyticsConfig,baseLines:_vm.baseLineList},on:{reportLoaded:_vm.reportLoaded,"update:config":function($event){_vm.analyticsConfig=$event}}}):_vm._e()],1)]),_vm.showDerivation?_c("derivation",{attrs:{visibility:_vm.showDerivation,report:_vm.reportObject,config:_vm.analyticsConfig},on:{"update:visibility":function($event){_vm.showDerivation=$event}}}):_vm._e()],1)])},staticRenderFns=[function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"building-avatar-block fL"},[_c("div",{staticClass:"building-avatar"},[_c("img",{attrs:{src:__webpack_require__(188742),height:"40px",width:"40px"}})])])}],toConsumableArray=__webpack_require__(488478),createForOfIteratorHelper=__webpack_require__(566347),FNewReport=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(538077),__webpack_require__(169358),__webpack_require__(670560),__webpack_require__(434284),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(648324),__webpack_require__(947522),__webpack_require__(339772),__webpack_require__(634338),__webpack_require__(862423)),AnalyticsMixin=__webpack_require__(244936),FNewAnalyticReport=__webpack_require__(794925),FDataPointSelector=__webpack_require__(287374),FDerivation=__webpack_require__(486348),FChartCustomization=__webpack_require__(472511),FReportOptions=__webpack_require__(791514),NewDateHelper=__webpack_require__(105534),FRegressionPointSelectorvue_type_template_id_5b4a8e65_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.visibility?_c("div",{staticClass:"newregression-analysis"},[_c("div",{staticClass:"sidebar-position-setup regeression0-ananlysis"},[_vm.selectorPanelShow?_c("div",{staticClass:"sidebar-close-btn pointer",on:{click:function($event){_vm.cancel(),_vm.$emit("update:enableFloatimngIcon",!0)}}},[_vm._m(0)]):_vm._e(),_c("div",{staticClass:"report-main-con"},[_c("div",{staticClass:"building-analysis-sidebar-conatainer regression-analytics-container"},[_c("div",{staticClass:"new-report-sidebar col-3",staticStyle:{"box-shadow":"none"}},[_c("div",{staticClass:"report-sidebar-inner"},[_c("div",{staticClass:" pB20 pL20 pR20"},[_c("div",{staticClass:"fc-text-pink"},[_vm._v(" "+_vm._s(_vm.$t("home.dashboard.generate_chart"))+" ")]),_c("el-row",{staticClass:"pT20"},[_c("div",{staticClass:"label-txt-black pB5"},[_vm._v(" "+_vm._s(_vm.$t("common.header.regression_type"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border2 width100",on:{change:function($event){_vm.quitReset=!1}},model:{value:_vm.regressionType,callback:function($$v){_vm.regressionType=$$v},expression:"regressionType"}},_vm._l(_vm.regressionTypeList,(function(type,typeIndex){return _c("el-option",{key:typeIndex,attrs:{label:type.displayName,value:type.name}})})),1)],1),_c("el-row",{staticClass:"pT20"},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"label-txt-black pB10"},[_vm._v(" "+_vm._s(_vm.$t("common.header.dependent_variable"))+" ")]),_vm.config.result.metrics.selectedDataPoints.length?_vm._l(_vm.config.result.metrics.selectedDataPoints,(function(data,index){return[_c("el-row",{key:index,staticClass:"visibility-visible-actions"},[_c("el-col",{attrs:{span:_vm.analyticsConfig&&_vm.analyticsConfig.period?20:24}},[_c("div",{staticClass:"fc-input-div-full-border-f14",on:{click:function($event){_vm.config.firstPanel.selectedTab="METRICS",_vm.selectDefaultTab("METRICS"),_vm.selectorPanelShow=!0,_vm.$emit("update:enableFloatimngIcon",!1)}}},[_c("span",[_vm._v(_vm._s(_vm.getFormatedData(data,"metrics")))]),_c("i",{staticClass:" pointer mT12 el-icon-arrow-right pull-right "})])]),_vm.analyticsConfig&&_vm.analyticsConfig.period?_c("el-col",{staticClass:"pL10 ",attrs:{span:4}},[_c("div",{staticClass:"fc-input-div-full-border-f14 pointer pointer position-relative",staticStyle:{"padding-left":"12px"}},[_c("el-popover",{attrs:{placement:"top-start",width:"90",trigger:"click","popper-class":"metric-popover"}},[_vm._l(_vm.metricAggregation,(function(metricAggr,metricAggrIdx){return _c("div",{key:metricAggrIdx,staticClass:"pointer pT5 pB5 fc-label-hover label-txt-black f14 text-center",class:{active:_vm.config.result["metrics"].dataPoints[index]&&metricAggr.value===_vm.config.result["metrics"].dataPoints[index].yAxis.aggr},attrs:{value:metricAggr.value},on:{click:function($event){return _vm.setAggr(index,metricAggr.value,"metrics")}}},[_vm._v(" "+_vm._s(metricAggr.label)+" ")])})),_c("img",{attrs:{slot:"reference",src:__webpack_require__(667527)},slot:"reference"})],2)],1)]):_vm._e()],1)]})):_c("div",{staticClass:"fc-input-div-full-border-f14 position-relative",class:{active:"METRICS"===_vm.config.firstPanel.selectedTab},on:{click:function($event){_vm.config.firstPanel.selectedTab="METRICS",_vm.selectorPanelShow=!0,_vm.selectDefaultTab("METRICS"),_vm.$emit("update:enableFloatimngIcon",!1)}}},[_c("span",[_vm._v(_vm._s(_vm.$t("common._common.select")))]),_c("i",{staticClass:" pointer mT12 el-icon-arrow-right pull-right regression-right-icon"})])],2)],1),_c("el-row",{staticClass:"pT20"},[_c("el-col",{attrs:{span:24}},[_c("div",[_c("div",{staticClass:"label-txt-black pB10 fL"},[_vm._v(" "+_vm._s(_vm.$t("common.header.independent_variables"))+" ")]),_vm.config.result.dimension.selectedDataPoints.length?_c("div",{staticClass:"fc-dark-blue2-12 pointer",staticStyle:{"text-align":"right"},on:{click:function($event){_vm.config.firstPanel.selectedTab="DIMENSION",_vm.selectDefaultTab("DIMENSION"),_vm.selectorPanelShow=!0,_vm.$emit("update:enableFloatimngIcon",!1)}}},[_vm._v(" "+_vm._s(_vm.$t("common._common.add"))+" ")]):_vm._e()]),_vm.config.result.dimension.selectedDataPoints.length?_vm._l(_vm.config.result.dimension.selectedDataPoints,(function(data1,index1){return[_c("el-row",{key:index1,staticClass:"visibility-visible-actions"},[_c("el-col",{staticClass:"pB20",attrs:{span:_vm.config.result.dimension.selectedDataPoints.length&&_vm.analyticsConfig&&_vm.analyticsConfig.period?18:22}},[_c("div",{staticClass:"fc-input-div-full-border-f14 position-relative"},[_c("span",[_vm._v(_vm._s(_vm.getFormatedData(data1,"dimension")))])])]),_vm.analyticsConfig&&_vm.analyticsConfig.period?_c("el-col",{staticClass:"pL10 pB20",attrs:{span:4}},[_c("div",{staticClass:"fc-input-div-full-border-f14 pointer pointer position-relative",staticStyle:{"padding-left":"12px"}},[_c("el-popover",{attrs:{placement:"top-start",width:"90",trigger:"click","popper-class":"metric-popover"}},[_vm._l(_vm.metricAggregation,(function(metricAggr,metricAggrIdx){return _c("div",{key:metricAggrIdx,staticClass:"pointer pT5 pB5 fc-label-hover label-txt-black f14 text-center",class:{active:_vm.config.result["dimension"].dataPoints[index1]&&metricAggr.value===_vm.config.result["dimension"].dataPoints[index1].yAxis.aggr},attrs:{value:metricAggr.value},on:{click:function($event){return _vm.setAggr(index1,metricAggr.value,"dimension")}}},[_vm._v(" "+_vm._s(metricAggr.label)+" ")])})),_c("img",{attrs:{slot:"reference",src:__webpack_require__(667527)},slot:"reference"})],2)],1)]):_vm._e(),_c("el-col",{staticClass:"mT10",staticStyle:{"text-align":"right"},attrs:{span:2}},[_c("i",{staticClass:"el-icon-delete pointer fc-red3 f16 visibility-hide-actions",staticStyle:{"vertical-align":"sub"},on:{click:function($event){return _vm.deleteDataPoint(index1)}}})])],1)]})):_c("div",{staticClass:"fc-input-div-full-border-f14 position-relative clearboth",on:{click:function($event){_vm.config.firstPanel.selectedTab="DIMENSION",_vm.selectDefaultTab("DIMENSION"),_vm.selectorPanelShow=!0,_vm.$emit("update:enableFloatimngIcon",!1)}}},[_c("span",[_vm._v(_vm._s(_vm.$t("common._common.select")))]),_c("i",{staticClass:" pointer mT12 el-icon-arrow-right pull-right regression-right-icon"})])],2)],1),_c("el-row",{staticClass:"clearboth pT20"},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"label-txt-black pB10"},[_vm._v(" "+_vm._s(_vm.$t("common.dashboard.time_period"))+" ")]),2!==_vm.analyticsConfig.mode?_c("el-select",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"period-select fc-input-full-border2 width100",attrs:{placeholder:"Period",title:_vm.$t("common.dashboard.time_period"),"data-arrow":"true"},on:{change:_vm.onPeriodChange},model:{value:_vm.analyticsConfig.period,callback:function($$v){_vm.$set(_vm.analyticsConfig,"period",$$v)},expression:"analyticsConfig.period"}},_vm._l(_vm.getAvailablePeriods,(function(period,index2){return _c("el-option",{key:index2,attrs:{label:period.name,value:period.value,disabled:!period.enable}})})),1):_vm._e()],1)],1)],1)]),_c("div",{staticClass:"saved-regressions-link",on:{click:function($event){_vm.showSavedReport=!0}}},[_vm._v(" "+_vm._s(_vm.$t("common._common.view_saved_regressions"))+" ")])]),_vm.buildingIds&&_vm.buildingIds.length?_vm.selectorPanelShow&&_vm.loading?_c("div",{staticClass:"newanalytics-sidebar col-3"},[_c("spinner",{attrs:{show:_vm.loading}})],1):_vm._e():_c("div",[_vm._v(" "+_vm._s(_vm.$t("common.products.no_building_selected"))+" ")]),_vm.selectorPanelShow&&!_vm.loading?[_vm.loading||"DIMENSION"!==_vm.config.firstPanel.selectedTab?_vm._e():_c("div",{staticClass:"newanalytics-sidebar col-3"},[_c("div",{staticClass:"data-pointer-selector-popup"},[_c("analaytics-filter",{attrs:{selectedBuildings:_vm.selectedBuildings},on:{"update:selectedBuildings":function($event){_vm.selectedBuildings=$event},"update:selected-buildings":function($event){_vm.selectedBuildings=$event}}})],1),_c("div",[_vm.showQuickSearch?_c("div",[_c("div",{staticClass:"fc-list-search"},[_c("div",{staticClass:"fc-list-search-wrapper relative fc-list-search-wrapperbuilding-search"},[_c("input",{directives:[{name:"model",rawName:"v-model",value:_vm.searchKey,expression:"searchKey"}],ref:"quickSearchQuery",staticClass:"quick-search-input4",attrs:{autofocus:"",type:"text",placeholder:"Search"},domProps:{value:_vm.searchKey},on:{keyup:_vm.quickSearch,input:function($event){$event.target.composing||(_vm.searchKey=$event.target.value)}}}),_c("svg",{staticClass:"close-icon4",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 32 32","aria-hidden":"true"},on:{click:_vm.closeSearch}},[_c("title",[_vm._v(_vm._s(_vm.$t("common._common.close")))]),_c("path",{attrs:{d:"M17.992 16l8.796-8.796a1.409 1.409 0 0 0-1.992-1.992L16 14.008 7.204 5.212a1.409 1.409 0 0 0-1.992 1.992L14.008 16l-8.796 8.796a1.409 1.409 0 0 0 1.992 1.992L16 17.992l8.796 8.796a1.409 1.409 0 0 0 1.992-1.992L17.992 16z"}})])])])]):_vm._e(),_c("div",{staticClass:"building-analysis-side-block"},[_c("div",{staticClass:"building-hover-actions"},[_c("div",{staticClass:"sidebar-asset-H fL",on:{click:_vm.weatherPanelToggler}},[_vm._v(" "+_vm._s(_vm.$t("common._common.weather"))+" ")]),_vm.weatherPanel.show?_c("div",{attrs:{lass:"building-anlysis-active-block"}},_vm._l(_vm.weatherModules,(function(weatherModule,wIdx){return _c("div",{key:wIdx,class:["pointer","building-anlysis-label-txt","clearboth",{"asset-list-block-txt-active":_vm.weatherPanel.weatherCategory&&weatherModule.displayName===_vm.weatherPanel.weatherCategory.displayName}],on:{click:function($event){return _vm.loadWeatherReadings(weatherModule,wIdx)}}},[_c("i",{class:{"fa fa-circle":!0,"dot-blue-icon":!0===weatherModule.selected,"dot-grey-icon":!1===weatherModule.selected},attrs:{"aria-hidden":"true"}}),_c("div",{staticClass:"width80"},[_vm._v(" "+_vm._s(weatherModule.displayName)+" ")])])})),0):_vm._e()])]),_c("div",{staticClass:"building-analysis-side-block"},[_c("div",{staticClass:"building-hover-actions"},[_c("div",{staticClass:"sidebar-asset-H fL",on:{click:_vm.loadSpaceReadings}},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.spaces"))+" ")])])]),_c("div",{staticClass:"building-analysis-side-block"},[_c("div",{staticClass:"building-hover-actions"},[_c("div",{staticClass:"sidebar-asset-H fL",on:{click:_vm.loadAssetCategories}},[_vm._v(" "+_vm._s(_vm.$t("common.products.assets"))+" ")])]),"assets"===_vm.config.mainPanel.currentModule?_c("div",{staticClass:"building-anlysis-active-block"},[_vm._l(_vm.config.mainPanel.assetCategories,(function(category,index){return _vm.config.mainPanel.assetCategories&&_vm.config.mainPanel.assetCategories.length?_c("div",{key:index,class:["building-anlysis-label-txt","clearboth",{"asset-list-block-txt-active":_vm.config.mainPanel.selectedAssetCategory===category.id}],on:{click:function($event){return _vm.openAssetCategory(category.id)}}},[_c("i",{class:{"fa fa-circle":!0,"dot-blue-icon":_vm.config.mainPanel.selectedAssetCategory===category.id,"dot-grey-icon":_vm.config.mainPanel.selectedAssetCategory!=category.id},attrs:{"aria-hidden":"true"}}),_c("div",{staticClass:"width80"},[_vm._v(_vm._s(category.displayName))])]):_vm._e()})),_vm.config.mainPanel.assetCategoriesLoading?_c("spinner",{staticClass:"clearboth",attrs:{show:_vm.config.mainPanel.assetCategoriesLoading}}):_vm.config.mainPanel.assetCategories.length?_vm._e():_c("div",{staticClass:"building-anlysis-label-txt clearboth"},[_vm._v(" "+_vm._s(_vm.$t("common.products.no_assets"))+" ")])],2):_vm._e()]),_c("div",{staticClass:"building-analysis-side-block"},[_c("div",{staticClass:"building-hover-actions"},[_c("div",{staticClass:"sidebar-asset-H fL",on:{click:_vm.loadEnPIReadings}},[_vm._v(" "+_vm._s(_vm.$t("common._common.enpi"))+" ")])])])])]),_vm.loading||"METRICS"!==_vm.config.firstPanel.selectedTab?_vm._e():_c("div",{staticClass:"newanalytics-sidebar col-3"},[_c("div",{staticClass:"data-pointer-selector-popup"},[_c("analaytics-filter",{attrs:{selectedBuildings:_vm.selectedBuildings},on:{"update:selectedBuildings":function($event){_vm.selectedBuildings=$event},"update:selected-buildings":function($event){_vm.selectedBuildings=$event}}})],1),_c("div",[_vm.showQuickSearch?_c("div",[_c("div",{staticClass:"fc-list-search"},[_c("div",{staticClass:"fc-list-search-wrapper relative fc-list-search-wrapperbuilding-search"},[_c("input",{directives:[{name:"model",rawName:"v-model",value:_vm.searchKey,expression:"searchKey"}],ref:"quickSearchQuery",staticClass:"quick-search-input4",attrs:{autofocus:"",type:"text",placeholder:_vm.$t("common._common.search")},domProps:{value:_vm.searchKey},on:{keyup:_vm.quickSearch,input:function($event){$event.target.composing||(_vm.searchKey=$event.target.value)}}}),_c("svg",{staticClass:"close-icon4",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 32 32","aria-hidden":"true"},on:{click:_vm.closeSearch}},[_c("title",[_vm._v(_vm._s(_vm.$t("common._common.close")))]),_c("path",{attrs:{d:"M17.992 16l8.796-8.796a1.409 1.409 0 0 0-1.992-1.992L16 14.008 7.204 5.212a1.409 1.409 0 0 0-1.992 1.992L14.008 16l-8.796 8.796a1.409 1.409 0 0 0 1.992 1.992L16 17.992l8.796 8.796a1.409 1.409 0 0 0 1.992-1.992L17.992 16z"}})])])])]):_vm._e(),_c("div",{staticClass:"building-analysis-side-block"},[_c("div",{staticClass:"building-hover-actions"},[_c("div",{staticClass:"sidebar-asset-H fL",on:{click:_vm.loadAssetCategories}},[_vm._v(" "+_vm._s(_vm.$t("common.products.assets"))+" ")])]),"assets"===_vm.config.mainPanel.currentModule?_c("div",{staticClass:"building-anlysis-active-block"},[_vm._l(_vm.config.mainPanel.assetCategories,(function(category,index){return _vm.config.mainPanel.assetCategories&&_vm.config.mainPanel.assetCategories.length?_c("div",{key:index,class:["building-anlysis-label-txt","clearboth",{"asset-list-block-txt-active":_vm.config.mainPanel.selectedAssetCategory===category.id}],on:{click:function($event){return _vm.openAssetCategory(category.id)}}},[_c("i",{class:{"fa fa-circle":!0,"dot-blue-icon":_vm.config.mainPanel.selectedAssetCategory===category.id,"dot-grey-icon":_vm.config.mainPanel.selectedAssetCategory!=category.id},attrs:{"aria-hidden":"true"}}),_c("div",{staticClass:"width80"},[_vm._v(_vm._s(category.displayName))])]):_vm._e()})),_vm.config.mainPanel.assetCategoriesLoading?_c("spinner",{staticClass:"clearboth",attrs:{show:_vm.config.mainPanel.assetCategoriesLoading}}):_vm.config.mainPanel.assetCategories.length?_vm._e():_c("div",{staticClass:"building-anlysis-label-txt clearboth"},[_vm._v(" "+_vm._s(_vm.$t("common.products.no_assets"))+" ")])],2):_vm._e()]),_c("div",{staticClass:"building-analysis-side-block"},[_c("div",{staticClass:"building-hover-actions"},[_c("div",{staticClass:"sidebar-asset-H fL",on:{click:_vm.loadSpaceReadings}},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.spaces"))+" ")])])]),_c("div",{staticClass:"building-analysis-side-block"},[_c("div",{staticClass:"building-hover-actions"},[_c("div",{staticClass:"sidebar-asset-H fL",on:{click:_vm.loadEnPIReadings}},[_vm._v(" "+_vm._s(_vm.$t("common._common.enpi"))+" ")])])]),_c("div",{staticClass:"building-analysis-side-block"},[_c("div",{staticClass:"building-hover-actions"},[_c("div",{staticClass:"sidebar-asset-H fL",on:{click:_vm.weatherPanelToggler}},[_vm._v(" "+_vm._s(_vm.$t("common._common.weather"))+" ")]),_vm.weatherPanel.show?_c("div",{attrs:{lass:"building-anlysis-active-block"}},_vm._l(_vm.weatherModules,(function(weatherModule,wIdx){return _c("div",{key:wIdx,class:["pointer","building-anlysis-label-txt","clearboth",{"asset-list-block-txt-active":_vm.weatherPanel.weatherCategory&&weatherModule.displayName===_vm.weatherPanel.weatherCategory.displayName}],on:{click:function($event){return _vm.loadWeatherReadings(weatherModule,wIdx)}}},[_c("i",{class:{"fa fa-circle":!0,"dot-blue-icon":!0===weatherModule.selected,"dot-grey-icon":!1===weatherModule.selected},attrs:{"aria-hidden":"true"}}),_c("div",{staticClass:"width80"},[_vm._v(" "+_vm._s(weatherModule.displayName)+" ")])])})),0):_vm._e()])])])]),_vm.config.assetPointsPanel.show?_c("div",{staticClass:"assets-points-Scontainer assets-points-Scontainer-lalign"},[_c("div",{staticClass:"assets-points-inner-container"},[_c("el-tabs",{on:{"tab-click":function($event){return _vm.openAssetCategory(_vm.config.mainPanel.selectedAssetCategory)}},model:{value:_vm.config.assetPointsPanel.activeSubTab,callback:function($$v){_vm.$set(_vm.config.assetPointsPanel,"activeSubTab",$$v)},expression:"config.assetPointsPanel.activeSubTab"}},[_c("el-tab-pane",{attrs:{label:"Points",name:"points"}},[_c("span",{attrs:{slot:"label"},slot:"label"},[_c("img",{staticStyle:{position:"relative",top:"4px",right:"7px"},attrs:{src:__webpack_require__(587758),width:"18px",height:"18px"}}),_vm._v(_vm._s(_vm.$t("common.header.controlpoints")))]),_c("div",{staticClass:"building-points-search"},[_c("el-input",{attrs:{placeholder:"Filter points",autofocus:""},model:{value:_vm.config.assetPointsPanel.filterQuery,callback:function($$v){_vm.$set(_vm.config.assetPointsPanel,"filterQuery",$$v)},expression:"config.assetPointsPanel.filterQuery"}})],1),_c("div",{staticClass:"asset-list-container mT10"},[_vm.config.assetPointsPanel.loading?_c("spinner",{attrs:{show:_vm.config.assetPointsPanel.loading}}):_vm.config.assetPointsPanel.data&&_vm.config.assetPointsPanel.data.length?_vm._l(_vm.filteredAssetPointsPanel,(function(item,index){return _c("div",{key:index,staticClass:"asset-list-block-txt",class:{"asset-list-block-txt-active":_vm.config.assetPointsPanel.selectedAssetOrPoint===item.id},on:{click:function($event){return _vm.openPoint(item.id)}}},[_c("div",{staticClass:"asset-active-select-item"},[_vm._v(" "+_vm._s(item.displayName?item.displayName:item.name)+" ")])])})):_c("div",{staticClass:"asset-list-block-txt text-center"},[_vm._v(" "+_vm._s(_vm.$t("common.products.no_points"))+" ")])],2)]),_c("el-tab-pane",{attrs:{label:"Assets",name:"assets"}},[_c("span",{attrs:{slot:"label"},slot:"label"},[_c("img",{staticStyle:{position:"relative",top:"4px",right:"8px"},attrs:{src:__webpack_require__(134105),width:"16px",height:"16px"}}),_vm._v(_vm._s(_vm.$t("common.products.assets")))]),_c("div",{staticClass:"building-points-search"},[_c("el-input",{attrs:{placeholder:_vm.$t("common.header.filter_assets"),autofocus:""},model:{value:_vm.config.assetPointsPanel.filterQuery,callback:function($$v){_vm.$set(_vm.config.assetPointsPanel,"filterQuery",$$v)},expression:"config.assetPointsPanel.filterQuery"}})],1),_c("div",{staticClass:"asset-list-container mT10"},[_vm.config.assetPointsPanel.loading?_c("spinner",{attrs:{show:_vm.config.assetPointsPanel.loading}}):_vm.config.assetPointsPanel.data&&_vm.config.assetPointsPanel.data.length?_vm._l(_vm.filteredAssetPointsPanel,(function(item,index){return _c("div",{key:index,staticClass:"asset-list-block-txt",class:{"asset-list-block-txt-active":_vm.config.assetPointsPanel.selectedAssetOrPoint===item.id},on:{click:function($event){return _vm.openAsset(item.id)}}},[_c("div",{staticClass:"asset-active-select-item"},[_vm._v(" "+_vm._s(item.name?item.name:item.displayName)+" ")])])})):_c("div",{staticClass:"asset-list-block-txt text-center"},[_vm._v(" "+_vm._s(_vm.$t("common.products._no_assets"))+" ")])],2)])],1)],1)]):_vm._e(),_vm.config.selectReadingsPanel.show&&"DIMENSION"===_vm.config.firstPanel.selectedTab?_c("div",{staticClass:"assets-points-Scontainer assets-points-Scontainer-shadow"},[_c("div",[_c("div",{staticClass:"assets-points-inner-container readings-list-container"},[_c("div",{staticClass:"select-reading-header"},[_c("div",{staticClass:"select-reading-H"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.select_readings"))+" ")])]),_c("div",{staticClass:"building-points-search building-points-height"},[_c("el-input",{attrs:{placeholder:"Filter readings",autofocus:""},model:{value:_vm.config.selectReadingsPanel.filterQuery,callback:function($$v){_vm.$set(_vm.config.selectReadingsPanel,"filterQuery",$$v)},expression:"config.selectReadingsPanel.filterQuery"}})],1),_c("div",{staticClass:"mT10 readings-scroll asset-list-container"},[_vm.config.selectReadingsPanel.loading?_c("spinner",{attrs:{show:_vm.config.selectReadingsPanel.loading}}):_vm.config.selectReadingsPanel.data&&_vm.config.selectReadingsPanel.data.length?_c("el-checkbox-group",{staticClass:"building-check-list",model:{value:_vm.config.result.dimension.selectedDataPoints,callback:function($$v){_vm.$set(_vm.config.result.dimension,"selectedDataPoints",$$v)},expression:"config.result.dimension.selectedDataPoints"}},_vm._l(_vm.filteredReadingsPanel,(function(item,index){return _c("el-checkbox",{key:index,attrs:{label:item.id+"_"+_vm.config.selectReadingsPanel.parentId}},[_vm._v(_vm._s(item.displayName?item.displayName:item.name))])})),1):_c("div",{staticClass:"text-center"},[_vm._v(" "+_vm._s(_vm.$t("common.header.no_data_found"))+" ")])],1)]),_vm.config.result.dimension.selectedDataPoints&&_vm.config.result.dimension.selectedDataPoints.length?_c("div",{staticClass:"building-analysis-point-container reading-apply-container row"},[_c("div",{staticClass:"building-analysis-points-wrap col-12"},[_c("div",{staticClass:"building-analysis-points-btn fL col-4"},[_c("el-button",{staticClass:"btn-grey-fill pL30 pR30",attrs:{type:"button"},on:{click:_vm.cancel}},[_vm._v(_vm._s(_vm.$t("setup.users_management.cancel")))]),_c("el-button",{staticClass:"btn-blue-fill pL30 pR30 mL15",attrs:{type:"button"},on:{click:_vm.apply}},[_vm._v(_vm._s(_vm.$t("maintenance.pm_list.apply")))])],1)])]):_vm._e()])]):_vm._e(),_vm.config.selectReadingsPanel.show&&"METRICS"===_vm.config.firstPanel.selectedTab?_c("div",{staticClass:"assets-points-Scontainer assets-points-Scontainer-shadow"},[_c("div",[_c("div",{staticClass:"assets-points-inner-container readings-list-container"},[_c("div",{staticClass:"select-reading-header"},[_c("div",{staticClass:"select-reading-H"},[_vm._v(" "+_vm._s(_vm.$t("common.products.select_readings"))+" ")])]),_c("div",{staticClass:"building-points-search building-points-height"},[_c("el-input",{attrs:{placeholder:_vm.$t("common.header.filter_readings"),autofocus:""},model:{value:_vm.config.selectReadingsPanel.filterQuery,callback:function($$v){_vm.$set(_vm.config.selectReadingsPanel,"filterQuery",$$v)},expression:"config.selectReadingsPanel.filterQuery"}})],1),_c("div",{staticClass:"mT10 readings-scroll asset-list-container"},[_vm.config.selectReadingsPanel.loading?_c("spinner",{attrs:{show:_vm.config.selectReadingsPanel.loading}}):_vm.config.selectReadingsPanel.data&&_vm.config.selectReadingsPanel.data.length?_vm._e():_c("div",{staticClass:"text-center"},[_vm._v(" "+_vm._s(_vm.$t("common.header.no_data_found"))+" ")]),_vm.config.selectReadingsPanel.show&&"METRICS"===_vm.config.firstPanel.selectedTab?_c("div",_vm._l(_vm.filteredReadingsPanel,(function(item,index){return _c("div",{key:index,staticClass:"asset-list-block-txt",on:{click:function($event){_vm.selectDataPoint(item.id+"_"+_vm.config.selectReadingsPanel.parentId,"metrics"),_vm.apply()}}},[_vm._v(" "+_vm._s(item.displayName?item.displayName:item.name)+" "),_vm.config.result.metrics.selectedDataPoints[0]===item.id+"_"+_vm.config.selectReadingsPanel.parentId?_c("i",{staticClass:"el-icon-check regression-icon"}):_vm._e()])})),0):_vm._e()],1)])])]):_vm._e(),_vm.config.selectAssetsPanel.show&&"DIMENSION"===_vm.config.firstPanel.selectedTab?_c("div",{staticClass:"assets-points-Scontainer assets-points-Scontainer-shadow"},[_c("div",[_c("div",{staticClass:"assets-points-inner-container readings-list-container"},[_c("div",{staticClass:"select-reading-header"},[_c("div",{staticClass:"select-reading-H"},[_vm._v(" "+_vm._s(_vm.$t("common._common.select_assets"))+" ")])]),_c("div",{staticClass:"building-points-search building-points-height"},[_c("el-input",{attrs:{placeholder:"Filter assets",autofocus:""},model:{value:_vm.config.selectAssetsPanel.filterQuery,callback:function($$v){_vm.$set(_vm.config.selectAssetsPanel,"filterQuery",$$v)},expression:"config.selectAssetsPanel.filterQuery"}})],1),_c("div",{staticClass:"asset-list-container mT10"},[_vm.config.selectAssetsPanel.loading?_c("spinner",{attrs:{show:_vm.config.selectAssetsPanel.loading}}):_vm.config.selectAssetsPanel.data&&_vm.config.selectAssetsPanel.data.length?_c("el-checkbox-group",{staticClass:"building-check-list",model:{value:_vm.config.result.dimension.selectedDataPoints,callback:function($$v){_vm.$set(_vm.config.result.dimension,"selectedDataPoints",$$v)},expression:"config.result.dimension.selectedDataPoints"}},_vm._l(_vm.filteredAssetsPanel,(function(item,index){return _c("el-checkbox",{key:index,attrs:{label:_vm.config.selectAssetsPanel.readingId+"_"+item.id}},[_vm._v(_vm._s(item.displayName?item.displayName:item.name))])})),1):_c("div",[_vm._v(" "+_vm._s(_vm.$t("common.header.no_data_found"))+" ")])],1)]),_vm.config.result.dimension.selectedDataPoints&&_vm.config.result.dimension.selectedDataPoints.length?_c("div",{staticClass:"building-analysis-point-container row"},[_c("div",{staticClass:"building-analysis-points-wrap col-12"},[_c("div"),_c("div",{staticClass:"building-analysis-points-btn fL col-4"},[_c("el-button",{staticClass:"btn-grey-fill pL30 pR30",attrs:{type:"button"},on:{click:_vm.cancel}},[_vm._v(_vm._s(_vm.$t("setup.users_management.cancel")))]),_c("el-button",{staticClass:"btn-blue-fill pL30 pR30 mL15",attrs:{type:"button"},on:{click:_vm.apply}},[_vm._v(_vm._s(_vm.$t("maintenance.pm_list.apply")))])],1)])]):_vm._e()])]):_vm._e(),_vm.config.selectAssetsPanel.show&&"METRICS"===_vm.config.firstPanel.selectedTab?_c("div",{staticClass:"assets-points-Scontainer assets-points-Scontainer-shadow"},[_c("div",[_c("div",{staticClass:"assets-points-inner-container readings-list-container"},[_c("div",{staticClass:"select-reading-header"},[_c("div",{staticClass:"select-reading-H"},[_vm._v(" "+_vm._s(_vm.$t("common._common.select_assets"))+" ")])]),_c("div",{staticClass:"building-points-search building-points-height"},[_c("el-input",{attrs:{placeholder:"Filter assets",autofocus:""},model:{value:_vm.config.selectAssetsPanel.filterQuery,callback:function($$v){_vm.$set(_vm.config.selectAssetsPanel,"filterQuery",$$v)},expression:"config.selectAssetsPanel.filterQuery"}})],1),_c("div",{staticClass:"asset-list-container mT10"},[_vm.config.selectAssetsPanel.loading?_c("spinner",{attrs:{show:_vm.config.selectAssetsPanel.loading}}):_vm.config.selectAssetsPanel.data&&_vm.config.selectAssetsPanel.data.length?_vm._e():_c("div",[_vm._v(" "+_vm._s(_vm.$t("common.header.no_data_found"))+" ")]),_vm._l(_vm.filteredAssetsPanel,(function(item,index){return _c("div",{key:index,staticClass:"asset-list-block-txt",on:{click:function($event){_vm.selectDataPoint(_vm.config.selectAssetsPanel.readingId+"_"+item.id,"metrics"),_vm.apply()}}},[_vm._v(" "+_vm._s(item.displayName?item.displayName:item.name)+" "),_vm.config.result.metrics.selectedDataPoints[0]===_vm.config.selectAssetsPanel.readingId+"_"+item.id?_c("i",{staticClass:"el-icon-check regression-icon"}):_vm._e()])}))],2)])])]):_vm._e()]:_vm._e()],2)])]),_c("el-dialog",{staticClass:"fc-dialog-center-container",attrs:{visible:_vm.deleteRangePoint,title:"Delete Range point",width:"40%","append-to-body":!0,"show-close":!1,"close-on-click-modal":!1},on:{"update:visible":function($event){_vm.deleteRangePoint=$event},keydown:function($event){if(!$event.type.indexOf("key")&&_vm._k($event.keyCode,"esc",27,$event.key,["Esc","Escape"]))return null;_vm.deleteRangePoint=!1}}},[_c("div",{staticClass:"height200"},[_c("div",[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.this_datapoint_is_part_of_range"))+" ")]),_c("div",[_vm._v(_vm._s(_vm.$t("common.wo_report.sure_want_to_delete_it")))]),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.cancelRangeDeletion}},[_vm._v(_vm._s(_vm.$t("common._common.close")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:_vm.deleteRangePoints}},[_vm._v(_vm._s(_vm.$t("common._common.delete")))])],1)])]),_c("saved-reg-report",{attrs:{visibility:_vm.showSavedReport},on:{"update:visibility":function($event){_vm.showSavedReport=$event}}})],1):_vm._e()},FRegressionPointSelectorvue_type_template_id_5b4a8e65_staticRenderFns=[function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{},[_c("i",{staticClass:"el-icon-close"})])}],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),objectSpread2=__webpack_require__(595082),AnalayticsFilter=(__webpack_require__(919649),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(228436),__webpack_require__(162506),__webpack_require__(450886),__webpack_require__(398758)),FNewAnalyticsModelHelper=__webpack_require__(146371),SavedRegReportvue_type_template_id_7f79c5ef_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.visibility?_c("div",{staticClass:"analytics-sidebar-bg"},[_c("div",{staticClass:"left-sidebar-position-setup"},[_c("div",{staticClass:"sidebar-close-btn pointer",staticStyle:{left:"-37 px"},on:{click:_vm.cancel}},[_vm._m(0)]),_c("div",{staticClass:"building-analysis-sidebar-conatainer"},[_c("div",{staticClass:"fc-text-pink fw6 pL20 pT20"},[_vm._v("SAVED REPORTS")]),null!==_vm.report?_c("div",[_c("div",{staticClass:"mT20"},_vm._l(_vm.report,(function(folder){return _c("div",{key:folder.id,attrs:{to:_vm.getReportLink(folder.id)}},[_c("div",{staticClass:"label-txt-black pointer pT15 pB15 pL20 pR20 folder-hover",on:{click:function($event){return _vm.openreport(folder.id)}}},[_vm._v(" "+_vm._s(folder.name)+" ")])])})),0)]):_c("div",{staticClass:"mT20 mL20"},[_vm._v(" No saved regression reports to display. ")])]),_c("div",{staticClass:"col-9 reports-summary",attrs:{id:"printable-area"}},[_c("router-view")],1)])]):_vm._e()},SavedRegReportvue_type_template_id_7f79c5ef_staticRenderFns=[function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{},[_c("i",{staticClass:"el-icon-close"})])}],api=__webpack_require__(32284),SavedRegReportvue_type_script_lang_js={props:["visibility"],data:function(){return{report:null}},mounted:function(){var self=this,params={reportType:3};api/* API */.bl.get("/v3/report/reading/all",params).then((function(response){response.error||(self.report=response.data.regressionReport)}))},methods:{cancel:function(){this.$emit("update:visibility",!1)},getReportLink:function(id){return"/app/em/reportview/"+id},openreport:function(id){this.$router.push({path:"/app/em/analytics/regression",query:{reportId:id}}),this.$emit("update:visibility",!1)}}},components_SavedRegReportvue_type_script_lang_js=SavedRegReportvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_SavedRegReportvue_type_script_lang_js,SavedRegReportvue_type_template_id_7f79c5ef_render,SavedRegReportvue_type_template_id_7f79c5ef_staticRenderFns,!1,null,null,null)
/* harmony default export */,SavedRegReport=component.exports,vuex_esm=__webpack_require__(420629),picklist=__webpack_require__(961358),FRegressionPointSelectorvue_type_script_lang_js={props:["reportObject","reportConfig","visibility","enableFloatimngIcon","analyticsConfig"],mixins:[AnalyticsMixin/* default */.Z],data:function(){return{regressionTypeList:[{name:"single",displayName:this.$t("common._common.simple_linear_regression")},{name:"multiple",displayName:this.$t("common._common.multi_linear_regression")}],regressionType:"single",weatherReadings:[],config:{firstPanel:{selectedTab:"DIMENSION"},mainPanel:{currentModule:"",assetCategories:null,assetCategoriesLoading:!1,selectedAssetCategory:null,selectedDataPoints:[]},assetPointsPanel:{show:!1,activeSubTab:"points",data:null,loading:!0,selectedAssetOrPoint:null,filterQuery:""},selectReadingsPanel:{show:!1,data:null,loading:!1,parentId:null,filterQuery:""},selectAssetsPanel:{show:!1,data:null,loading:!1,readingId:null,filterQuery:""},result:{dimension:{selectedDataPoints:[],dataPoints:[],summaryList:[],regressionPoints:[],addedDataPoints:[]},metrics:{selectedDataPoints:[],dataPoints:[],summaryList:[],regressionPoints:[],addedDataPoints:[]}}},selectorPanelShow:!1,showSavedReport:!1,weatherPanel:{show:!1,weatherCategory:null},quitReset:!1,metricAggregation:[{label:"AVG",value:2},{label:"SUM",value:3},{label:"MIN",value:4},{label:"MAX",value:5}],loading:!0,readings:{categories:[],assets:{},categoryWithAssets:{},fields:{},categoryWithFields:{}},showQuickSearch:!1,toggleMetricAggregation:!1,quickSearchQuery:null,selectedBuildings:[],weatherModules:[{displayName:this.$t("common._common.live_weather"),moduleName:"weather",selected:!1},{displayName:this.$t("common._common.daily_weather"),moduleName:"weatherDaily",selected:!1},{displayName:this.$t("common._common.degree_days"),selected:!1},{displayName:this.$t("common._common.psychrometric"),moduleName:"psychrometric",selected:!1}],deleteRangePoint:!1,rangePointConfirmation:!1,pointDeletionStore:{},summaryList:[],allFields:{assets:[]},currentKey:0,siteId:null,firstTime:!0,urlParams:{perPage:50,page:1,viewName:"hidden-all"},default_building_id:null,selectedBuildingLabel:"No Buildings"}},components:{AnalayticsFilter:AnalayticsFilter/* default */.Z,SavedRegReport:SavedRegReport},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({assetCategory:function(state){return state.assetCategory}})),{},{moreThanOneLocation:function(){var locationSet=new Set;if(0!==this.config.result[this.config.firstPanel.selectedTab.toLowerCase()].summaryList.length){var _step,_iterator=(0,createForOfIteratorHelper/* default */.Z)(this.config.result[this.config.firstPanel.selectedTab.toLowerCase()].summaryList);try{for(_iterator.s();!(_step=_iterator.n()).done;){var _step2,group=_step.value,_iterator2=(0,createForOfIteratorHelper/* default */.Z)(group.readings);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var reading=_step2.value;locationSet.add(reading.location)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}}catch(err){_iterator.e(err)}finally{_iterator.f()}return locationSet.size>1}return!1},getAvailablePeriods:function(){var operationOnId=this.analyticsConfig.dateFilter.operationOnId,avail=[],isRangeEnabled=!0;return avail.push({name:"High-res",value:0,enable:6!==operationOnId?4!==operationOnId&&isRangeEnabled:isRangeEnabled}),avail.push({name:"Hourly",value:20,enable:6===operationOnId||4!==operationOnId}),avail.push({name:"Daily",value:12,enable:!0}),avail.push({name:"Weekly",value:11,enable:!0}),avail.push({name:"Monthly",value:10,enable:!0}),avail.push({name:"Quarterly",value:25,enable:4===operationOnId||5===operationOnId}),avail.push({name:"Yearly",value:8,enable:4===operationOnId}),avail.push({name:"Hour of day",
// 12, 1, 2, 3
value:19,enable:!0}),avail.push({name:"Day of week",
// sun, mon
value:17,enable:!0}),avail.push({name:"Day of month",
// 1,2,3
value:18,enable:!0}),avail},isRangeModeEnabled:function(){if("undefined"!==typeof this.reportObject&&null!==this.reportObject){var dP=this.reportObject.options.dataPoints.filter((function(point){return"rangeGroup"===point.type}));return 0!==dP.length}return!1},showFourthPanel:function(){return 0!==this.config.result[this.config.firstPanel.selectedTab.toLowerCase()].summaryList.length},buildingIds:function(){if(this.selectedBuildings&&this.selectedBuildings.length){var _step3,buildingIds=[],_iterator3=(0,createForOfIteratorHelper/* default */.Z)(this.selectedBuildings);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var sb=_step3.value;buildingIds.push(parseInt(sb))}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}return buildingIds}return null},selectedBuildingName:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var _yield$getFieldValue,data,error,value;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(!_this.selectedBuildings||!_this.selectedBuildings.length){_context.next=8;break}if(1!==_this.selectedBuildings.length){_context.next=8;break}return _context.next=4,(0,picklist/* getFieldValue */.oe)({lookupModuleName:"building",selectedOptionId:[_this.selectedBuildings[0]]});case 4:_yield$getFieldValue=_context.sent,data=_yield$getFieldValue.data,error=_yield$getFieldValue.error,!error&&data&&(value=_this.$getProperty(data,"0.label"),_this.selectedBuildingLabel=value);case 8:case"end":return _context.stop()}}),_callee)})))()},filteredAssetPointsPanel:function(){var self=this;return this.config.assetPointsPanel.data&&this.config.assetPointsPanel.data.length?this.config.assetPointsPanel.filterQuery&&this.config.assetPointsPanel.filterQuery.trim().length?this.config.assetPointsPanel.data.filter((function(d){var name=d.displayName?d.displayName:d.name;if(name.toLowerCase().indexOf(self.config.assetPointsPanel.filterQuery.toLowerCase())>=0)return d})):this.config.assetPointsPanel.data:[]},filteredReadingsPanel:function(){var self=this;return this.config.selectReadingsPanel.data&&this.config.selectReadingsPanel.data.length?this.config.selectReadingsPanel.filterQuery&&this.config.selectReadingsPanel.filterQuery.trim().length?this.config.selectReadingsPanel.data.filter((function(d){var name=d.displayName?d.displayName:d.name;if(name.toLowerCase().indexOf(self.config.selectReadingsPanel.filterQuery.toLowerCase())>=0)return d})):this.config.selectReadingsPanel.data:[]},filteredAssetsPanel:function(){var self=this;return this.config.selectAssetsPanel.data&&this.config.selectAssetsPanel.data.length?this.config.selectAssetsPanel.filterQuery&&this.config.selectAssetsPanel.filterQuery.trim().length?this.config.selectAssetsPanel.data.filter((function(d){var name=d.displayName?d.displayName:d.name;if(name.toLowerCase().indexOf(self.config.selectAssetsPanel.filterQuery.toLowerCase())>=0)return d})):this.config.selectAssetsPanel.data:[]}}),watch:{analyticsConfig:{handler:function(newVal,oldVal){newVal.regressionConfig&&this.checkForEmpty()&&this.readings&&this.allFields.weather&&this.allFields.assets&&this.populateSelector()},deep:!0},regressionType:function(newVal,oldVal){!1===this.quitReset&&oldVal&&newVal!=oldVal&&(this.closeAllPanels(),delete this.config.regressionPoints,Object.assign(this.$data.config.mainPanel,this.$options.data().config.mainPanel),Object.assign(this.$data.config.result,this.$options.data().config.result),this.regressionType=newVal,this.$emit("resetState",!0))},buildingIds:function(newVal,oldVal){JSON.stringify(newVal)!==JSON.stringify(oldVal)&&(this.loadAssetCategories(),this.resetResetReadings())},selectedBuildings:function(newVal,oldVal){newVal!==oldVal&&(this.config.selectReadingsPanel.spaceObj=null,this.weatherModules.forEach((function(points){points.selected=!1})),this.weatherReadings.length&&(this.weatherReadings=[]),this.selectDefaultTab())},selectedBuildingName:function(){var _selectedBuildingName=(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(newVal){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,this.selectedBuildingName;case 2:this.$emit("selectBuildings",{name:this.selectedBuildingLabel,ids:this.selectedBuildings});case 3:case"end":return _context2.stop()}}),_callee2,this)})));function selectedBuildingName(_x){return _selectedBuildingName.apply(this,arguments)}return selectedBuildingName}(),getAvailablePeriods:{handler:function(newData,oldData){var _this2=this,avail=this.getAvailablePeriods,selected=avail.find((function(a){return a.value===_this2.analyticsConfig.period&&a.enable}));if(!selected){var filterName=this.analyticsConfig.dateFilter.operationOn,defaultPeriod=avail.filter((function(a){return a.enable}))[0].value;"week"===filterName||"month"===filterName?defaultPeriod=12:"year"===filterName&&(defaultPeriod=10),this.analyticsConfig.period=defaultPeriod}},immediate:!0},"config.result.dimension.selectedDataPoints":{handler:function(newVal,oldVal){0===newVal.length||null!==this.savedPoints&&"undefined"!==typeof this.savedPoints||this.addToSummaryListNew("dimension")},deep:!0},"config.result.metrics.selectedDataPoints":{handler:function(newVal,oldVal){0===newVal.length||null!==this.savedPoints&&"undefined"!==typeof this.savedPoints||(this.addToSummaryListNew("metrics"),this.getSelectedPointsMeta())},deep:!0}},created:function(){var _this3=this;Promise.all([this.$store.dispatch("loadAssetCategory"),this.loadDefaultBuilding()]).then((function(){_this3.setDefaultSelection(),_this3.preLoadWeatherReadings()}))},methods:{loadDefaultBuilding:function(){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var _data$pickList,_yield$API$get,data,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,api/* API */.bl.get("/v3/picklist/building",_this4.urlParams,{force:!0});case 2:_yield$API$get=_context3.sent,data=_yield$API$get.data,error=_yield$API$get.error,!error&&(null===data||void 0===data||null===(_data$pickList=data.pickList)||void 0===_data$pickList?void 0:_data$pickList.length)>0&&(_this4.default_building_id=data.pickList[0].value);case 6:case"end":return _context3.stop()}}),_callee3)})))()},checkForEmpty:function(){return 0===this.config.result.dimension.selectedDataPoints.length&&0===this.config.result.metrics.selectedDataPoints.length},checkForChangedDataPoints:function(newAnalyticConfig){var diff=!1;if(newAnalyticConfig&&newAnalyticConfig.dataPoints&&0!==newAnalyticConfig.dataPoints.length){var dataPointList=this.getAllDataPoints();if(0===dataPointList.length)return!0;if(0!==dataPointList.length){var _step4,_iterator4=(0,createForOfIteratorHelper/* default */.Z)(this.analyticsConfig.dataPoints);try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var dp=_step4.value;if(!dataPointList.includes(dp.yAxis.fieldId+"_"+dp.parentId)){diff=!0;break}}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}}}return diff},getAllDataPoints:function(){var dataPoints=[];return 0!=this.config.result.dimension.selectedDataPoints.length&&0!==this.config.result.metrics.selectedDataPoints.length&&(dataPoints.push.apply(dataPoints,(0,toConsumableArray/* default */.Z)(this.config.result.metrics.selectedDataPoints)),dataPoints.push.apply(dataPoints,(0,toConsumableArray/* default */.Z)(this.config.result.dimension.selectedDataPoints))),dataPoints},populateSelector:function(){if(this.analyticsConfig&&this.analyticsConfig.regressionConfig&&0!==this.analyticsConfig.regressionConfig.length){this.quitReset=!0,this.regressionType=this.analyticsConfig.regressionType;var metricDataPoints=[],dimensionDataPoints=[];metricDataPoints.push(this.analyticsConfig.regressionConfig[0].yAxis.readingId+"_"+this.analyticsConfig.regressionConfig[0].yAxis.parentId);var _step5,_iterator5=(0,createForOfIteratorHelper/* default */.Z)(this.analyticsConfig.regressionConfig);try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var _step6,config=_step5.value,_iterator6=(0,createForOfIteratorHelper/* default */.Z)(config.xAxis);try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var xPoint=_step6.value,idenString="";idenString=xPoint.readingId+"_"+xPoint.parentId,dimensionDataPoints.push(idenString)}}catch(err){_iterator6.e(err)}finally{_iterator6.f()}}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}var result={dimension:{selectedDataPoints:[],dataPoints:[],summaryList:[],regressionPoints:[],addedDataPoints:[]},metrics:{selectedDataPoints:[],dataPoints:[],summaryList:[],regressionPoints:[],addedDataPoints:[]}};result.dimension.selectedDataPoints=dimensionDataPoints,result.metrics.selectedDataPoints=metricDataPoints,this.config.result=result,this.populateAddedDataPoints(this.config),this.getSelectedPointsMeta()}},deleteDataPoint:function(dataPointIndex){0!==this.config.result.dimension.selectedDataPoints.length&&(this.config.result.dimension.selectedDataPoints.splice(dataPointIndex,1),0===this.config.result.dimension.selectedDataPoints.length&&(this.config.result.metrics.selectedDataPoints=[]),this.apply())},setAggr:function(index,value,mode){this.config.result[mode].dataPoints[index].yAxis.aggr=value,this.config.result[mode].regressionPoints[index].aggr=value,this.updateAndEmitData()},preLoadWeatherReadings:function(){this.loadWeatherReadings()},selectDefaultTab:function(mode){this.config.assetPointsPanel={show:!1,activeSubTab:"points",data:null,loading:!0,selectedAssetOrPoint:null,filterQuery:""},this.weatherPanel.weatherCategory=null,this.config.selectAssetsPanel.show=!1,this.config.selectReadingsPanel.show=!1,this.weatherModules.forEach((function(points){points.selected=!1})),"DIMENSION"===mode?(this.weatherPanel.show=!0,this.config.mainPanel.currentModule=""):(this.weatherPanel.show=!1,this.loadAssetCategories("METRICS"))},removedataPoint:function(index){this.config.result.metrics.selectedDataPoints[index];this.config.result.metrics.dataPoints.splice(index,1),this.config.result.metrics.selectedDataPoints.splice(index,1),this.config.result.metrics.regressionPoints.splice(index,1),this.updateAndEmitData()},onPeriodChange:function(){this.analyticsConfig.dataPoints.length||(20===this.analyticsConfig.period?this.analyticsConfig.dateFilter=NewDateHelper/* default */.Z.getDatePickerObject(31):12===this.analyticsConfig.period?this.analyticsConfig.dateFilter=NewDateHelper/* default */.Z.getDatePickerObject(28):10===this.analyticsConfig.period?this.analyticsConfig.dateFilter=NewDateHelper/* default */.Z.getDatePickerObject(44):this.analyticsConfig.dateFilter=NewDateHelper/* default */.Z.getDatePickerObject(22))},closeAllPanels:function(){this.config.assetPointsPanel.show=!1,this.config.selectAssetsPanel.show=!0,this.config.selectReadingsPanel.show=!1},updateAndEmitData:function(){var data=[];if(0!=this.config.result.dimension.regressionPoints.length&&0!=this.config.result.metrics.regressionPoints.length)if(this.regressionType===FNewAnalyticsModelHelper/* default */.Z.regressionTypes().SINGLE){this.config["regressionType"]=FNewAnalyticsModelHelper/* default */.Z.regressionTypes().SINGLE;var yAxis=this.config.result.metrics.regressionPoints[0];this.config.result.dimension.regressionPoints.forEach((function(xAxis){data.push({xAxis:[xAxis],yAxis:yAxis,groupAlias:null,isMultiple:!1})}))}else{this.config["regressionType"]=FNewAnalyticsModelHelper/* default */.Z.regressionTypes().MULTIPLE;var _step7,xAxis=[],_yAxis=this.config.result.metrics.regressionPoints[0],_iterator7=(0,createForOfIteratorHelper/* default */.Z)(this.config.result.dimension.regressionPoints);try{for(_iterator7.s();!(_step7=_iterator7.n()).done;){var point=_step7.value;xAxis.push(point)}}catch(err){_iterator7.e(err)}finally{_iterator7.f()}data.push({xAxis:xAxis.length?xAxis:null,yAxis:_yAxis,groupAlias:null,isMultiple:!0})}this.config.regressionPoints=data,this.$emit("updateDataPoints",this.config)},getLabelFromDataPoints:function(label){var _step8,split=label.split("_"),parentId=parseInt(split[split.length-1]),readingId=parseInt(split[0]),_iterator8=(0,createForOfIteratorHelper/* default */.Z)(this.analyticsConfig.dataPoints);try{for(_iterator8.s();!(_step8=_iterator8.n()).done;){var dataPoint=_step8.value;if(dataPoint.parentId===parentId&&dataPoint.yAxis.fieldId===readingId&&dataPoint.name)return dataPoint.name}}catch(err){_iterator8.e(err)}finally{_iterator8.f()}return null},getFormatedData:function(label,mode){var text="";if(0!==this.analyticsConfig.dataPoints.length&&(text=this.getLabelFromDataPoints(label)),(""===text||null===text||"undefined"===typeof text)&&(text="",label&&mode))if("metrics"===mode)this.config.result[mode].addedDataPoints.forEach((function(points){if(points.resourceId===parseInt(label.split("_")[1])&&points.readingId===parseInt(label.split("_")[0])){var readingLabel=points.readingLabel?points.readingLabel:points.label,resourceLabel=points.resourceLabel?points.resourceLabel:points.location;text=resourceLabel?resourceLabel+" ( "+readingLabel+" )":readingLabel}}));else{var _step9,parentId=parseInt(label.split("_")[1]),readingId=parseInt(label.split("_")[0]),_iterator9=(0,createForOfIteratorHelper/* default */.Z)(this.config.result.dimension.summaryList);try{for(_iterator9.s();!(_step9=_iterator9.n()).done;){var _step10,point=_step9.value,_iterator10=(0,createForOfIteratorHelper/* default */.Z)(point.readings);try{for(_iterator10.s();!(_step10=_iterator10.n()).done;){var reading=_step10.value;if(reading.readingId===readingId&&reading.resourceId===parentId){var resourceLabel=reading.resourceLabel?reading.resourceLabel:reading.location?reading.location:"",readingLabel=reading.readingLabel?reading.readingLabel:reading.label;text=resourceLabel?text+resourceLabel+"( "+readingLabel+" )":readingLabel}}}catch(err){_iterator10.e(err)}finally{_iterator10.f()}}}catch(err){_iterator9.e(err)}finally{_iterator9.f()}}return text},showMetricAggregation:function(metric){return!0},selectDataPoint:function(datapoint,mode){this.config.result[mode].selectedDataPoints=[],this.config.result[mode].selectedDataPoints.push(datapoint)},checkForRangePoints:function(newVal){if(this.reportObject&&0!==this.config.result[this.config.firstPanel.selectedTab.toLowerCase()].summaryList.length){var rangeGroups=this.reportObject.options.dataPoints.filter((function(dP){return"rangeGroup"===dP.type}));if(0!==rangeGroups.length){var _step11,inRangeGroup=new Set,_iterator11=(0,createForOfIteratorHelper/* default */.Z)(rangeGroups);try{for(_iterator11.s();!(_step11=_iterator11.n()).done;){var _step13,rGroup=_step11.value,_iterator13=(0,createForOfIteratorHelper/* default */.Z)(rGroup.children);try{for(_iterator13.s();!(_step13=_iterator13.n()).done;){var child=_step13.value;inRangeGroup.add(child.fieldId+"_"+child.parentId),this.pointDeletionStore["readingId"]=child.fieldId,this.pointDeletionStore["resourceId"]=child.parentId}}catch(err){_iterator13.e(err)}finally{_iterator13.f()}}}catch(err){_iterator11.e(err)}finally{_iterator11.f()}var _step12,_iterator12=(0,createForOfIteratorHelper/* default */.Z)(inRangeGroup);try{for(_iterator12.s();!(_step12=_iterator12.n()).done;){var inPoint=_step12.value;if(!newVal.includes(inPoint))return void(this.deleteRangePoint=!0)}}catch(err){_iterator12.e(err)}finally{_iterator12.f()}}}},getAllSummaryDataPoints:function(mode){var allDataPoints=[],selector=mode||this.config.firstPanel.selectedTab.toLowerCase();if(this.config.result[selector].summaryList)for(var key in this.config.result[selector].summaryList)allDataPoints.push.apply(allDataPoints,(0,toConsumableArray/* default */.Z)(this.config.result[selector].summaryList[key].readings));return allDataPoints},convertToList:function(readings){var _step14,readingsObject={},_iterator14=(0,createForOfIteratorHelper/* default */.Z)(readings);try{for(_iterator14.s();!(_step14=_iterator14.n()).done;){var reading=_step14.value;readingsObject[reading.id]=reading}}catch(err){_iterator14.e(err)}finally{_iterator14.f()}return readingsObject},cancelRangeDeletion:function(){this.pointDeletionStore={};var _step15,dataPoints=[],_iterator15=(0,createForOfIteratorHelper/* default */.Z)(this.reportObject.options.dataPoints);try{for(_iterator15.s();!(_step15=_iterator15.n()).done;){var dp=_step15.value;dp.children&&0!==dp.children.length?dataPoints.push.apply(dataPoints,(0,toConsumableArray/* default */.Z)(JSON.parse(JSON.stringify(dp.children)))):dataPoints.push(JSON.parse(JSON.stringify(dp)))}}catch(err){_iterator15.e(err)}finally{_iterator15.f()}for(var _i=0,_dataPoints=dataPoints;_i<_dataPoints.length;_i++){var dataPoint=_dataPoints[_i];dataPoint["aliases"]={},dataPoint.aliases["actual"]=dataPoint.alias,dataPoint["yAxis"]={},dataPoint.yAxis["fieldId"]=dataPoint.fieldId}this.setInitialValues(dataPoints,null,"restoreRange"),this.deleteRangePoint=!1},deleteRangePoints:function(){
// obtain range points
var existingDataPoints=(0,toConsumableArray/* default */.Z)(this.config.result.dimension.selectedDataPoints),readingId=this.pointDeletionStore["readingId"],resourceId=this.pointDeletionStore["resourceId"],tobeDeleted=[];if(this.reportObject){var _step16,_iterator16=(0,createForOfIteratorHelper/* default */.Z)(this.reportObject.options.dataPoints);try{for(_iterator16.s();!(_step16=_iterator16.n()).done;){var dP=_step16.value;if("rangeGroup"===dP.type){var inDp=dP.children.filter((function(rDp){return rDp.fieldId===readingId&&rDp.parentId===resourceId}));if(0!==inDp.length){tobeDeleted.push.apply(tobeDeleted,(0,toConsumableArray/* default */.Z)(dP.children));break}}}
// to reduce dataPoints
}catch(err){_iterator16.e(err)}finally{_iterator16.f()}var _step17,toBeDeleted=this.reduceDataPoints(tobeDeleted),_iterator17=(0,createForOfIteratorHelper/* default */.Z)(toBeDeleted);try{for(_iterator17.s();!(_step17=_iterator17.n()).done;){var dataPoint=_step17.value,index=existingDataPoints.indexOf(dataPoint.fieldId+"_"+dataPoint.parentId);-1!==index&&existingDataPoints.splice(index,1)}}catch(err){_iterator17.e(err)}finally{_iterator17.f()}this.config.result.dimension.selectedDataPoints=existingDataPoints,this.addToSummaryListNew(this.config.firstPanel.selectedTab.toLowerCase()),this.deleteRangePoint=!1}},reduceDataPoints:function(toBeDeletedDataPoints){var uniqueKeys=new Set;return toBeDeletedDataPoints.map((function(dp){return uniqueKeys.add(dp.fieldId+"."+dp.parentId)})),1===uniqueKeys.size?[toBeDeletedDataPoints[0]]:toBeDeletedDataPoints},addAssetToGroup:function(label,reading,assetCategory){if(this.config.result[this.config.firstPanel.selectedTab.toLowerCase()].summaryList&&0===this.config.result[this.config.firstPanel.selectedTab.toLowerCase()].summaryList.length){var temp={};temp["label"]=label,temp["categoryId"]=assetCategory,temp["readings"]=[],temp.readings.push(reading),this.config.result[this.config.firstPanel.selectedTab.toLowerCase()].summaryList.push(temp)}else if(this.config.result[this.config.firstPanel.selectedTab.toLowerCase()].summaryList&&this.config.result[this.config.firstPanel.selectedTab.toLowerCase()].summaryList.length>0){var readingGroup=this.config.result[this.config.firstPanel.selectedTab.toLowerCase()].summaryList.filter((function(group){return group.label===label}));if(0!==readingGroup.length)readingGroup[0].readings.push(reading);else{var _temp={};_temp["label"]=label,_temp["categoryId"]=assetCategory,_temp["readings"]=[],_temp.readings.push(reading),this.config.result[this.config.firstPanel.selectedTab.toLowerCase()].summaryList.push(_temp)}}},getRangeGroup:function(reading){if(this.reportObject){var _step18,_iterator18=(0,createForOfIteratorHelper/* default */.Z)(this.reportObject.options.dataPoints);try{for(_iterator18.s();!(_step18=_iterator18.n()).done;){var dataPoint=_step18.value;if("rangeGroup"===dataPoint.type&&dataPoint.children){var _step19,_iterator19=(0,createForOfIteratorHelper/* default */.Z)(dataPoint.children);try{for(_iterator19.s();!(_step19=_iterator19.n()).done;){var child=_step19.value;if(child.fieldId===reading.readingId&&child.parentId===reading.resourceId)return!0}}catch(err){_iterator19.e(err)}finally{_iterator19.f()}}}}catch(err){_iterator18.e(err)}finally{_iterator18.f()}}},removeDataPointFromGroup:function(reading,readingGroupIndex){if(this.isRangeModeEnabled){
// to find range point
var isRangePoint=this.getRangeGroup(reading);isRangePoint?(this.deleteRangePoint=!0,this.pointDeletionStore["readingId"]=reading.readingId,this.pointDeletionStore["resourceId"]=reading.resourceId):this.removePoint(reading,readingGroupIndex)}else this.removePoint(reading,readingGroupIndex)},removePoint:function(reading,readingGroupIndex){var readingGroup=this.config.result[this.config.firstPanel.selectedTab.toLowerCase()].summaryList[readingGroupIndex],readingSumId=reading.readingId+"_"+reading.resourceId;"DIMESION"===this.config.firstPanel.selectedTab?this.config.result.dimension.selectedDataPoints.splice(this.config.result.dimension.selectedDataPoints.indexOf(readingSumId),1):this.config.result.metrics.selectedDataPoints.splice(this.config.result.metrics.selectedDataPoints.indexOf(readingSumId),1);var readingIndex=readingGroup.readings.indexOf(reading);readingGroup.readings.splice(readingIndex,1),0===readingGroup.readings.length&&this.config.result[this.config.firstPanel.selectedTab.toLowerCase()].summaryList.splice(readingGroupIndex,1)},getCategoryFromId:function(reading){var readingSplit=reading.split("_"),assetObject=this.readings.assets[parseInt(readingSplit[readingSplit.length-1])];return this.buildingIds[0]===parseInt(readingSplit[1])?"":assetObject?"assets":"weather"},addToSummaryListNew:function(source){var _this5=this,existingReadings=[],points=[],self=this,panel=source||self.config.firstPanel.selectedTab.toLowerCase();if(this.config.result[panel].selectedDataPoints&&0!==this.config.result[panel].selectedDataPoints.length){var _step20,_iterator20=(0,createForOfIteratorHelper/* default */.Z)(this.config.result[panel].selectedDataPoints);try{for(_iterator20.s();!(_step20=_iterator20.n()).done;){var point=_step20.value,temp={point:point,isDone:!1};points.push(temp)}}catch(err){_iterator20.e(err)}finally{_iterator20.f()}if(0!==this.config.result[panel].summaryList.length){this.currentKey=this.currentKey+1;var _step21,_iterator21=(0,createForOfIteratorHelper/* default */.Z)(this.config.result[panel].summaryList);try{for(_iterator21.s();!(_step21=_iterator21.n()).done;){var _step23,group=_step21.value,_iterator23=(0,createForOfIteratorHelper/* default */.Z)(group.readings);try{for(_iterator23.s();!(_step23=_iterator23.n()).done;){var reading=_step23.value;existingReadings.push(reading)}}catch(err){_iterator23.e(err)}finally{_iterator23.f()}}}catch(err){_iterator21.e(err)}finally{_iterator21.f()}var _step22,_iterator22=(0,createForOfIteratorHelper/* default */.Z)(points);try{var _loop=function(){var dataPoint=_step22.value,readingSplit=dataPoint.point.split("_"),readingId=parseInt(readingSplit[0]),resourceId=parseInt(readingSplit[readingSplit.length-1]),reading=existingReadings.filter((function(element){return element.readingId+"_"+element.resourceId===readingId+"_"+resourceId}));if(0===reading.length)return 1;// continue
reading[0].marked=_this5.currentKey,dataPoint.isDone=!0};for(_iterator22.s();!(_step22=_iterator22.n()).done;)_loop()}catch(err){_iterator22.e(err)}finally{_iterator22.f()}}this.removeUnwantedReadings();var notInserted=points.filter((function(point){return!1===point.isDone}));if(0!==notInserted.length){var _step24,_iterator24=(0,createForOfIteratorHelper/* default */.Z)(notInserted);try{var _loop2=function(){var nInsert=_step24.value,readingSplit=nInsert.point.split("_"),category=_this5.getCategoryFromId(nInsert.point),readingObject=null;category&&""!==category&&_this5.allFields[category]&&(readingObject=_this5.allFields[category][parseInt(readingSplit[0])]);var categoryLabel=null,categoryId=null;if("assets"===category){for(var _i2=0,_Object$keys=Object.keys(_this5.readings.categoryWithAssets);_i2<_Object$keys.length;_i2++){var cat=_Object$keys[_i2];if(Object.keys(_this5.readings.categoryWithAssets[cat]).includes(readingSplit[readingSplit.length-1])){categoryId=parseInt(cat);break}categoryId=-1}categoryLabel=_this5.config.mainPanel.assetCategories.filter((function(categories){return categories.id===categoryId}))[0].name}else if("weather"===category){var _step25,_iterator25=(0,createForOfIteratorHelper/* default */.Z)(_this5.config.result[panel].summaryList);try{for(_iterator25.s();!(_step25=_iterator25.n()).done;){var _step26,_group=_step25.value,_iterator26=(0,createForOfIteratorHelper/* default */.Z)(_group.readings);try{for(_iterator26.s();!(_step26=_iterator26.n()).done;){var _reading=_step26.value;if(_reading.readingId+"_"+_reading.resourceId===readingSplit[0]+"_"+readingSplit[1]){categoryLabel=_group.label;break}}}catch(err){_iterator26.e(err)}finally{_iterator26.f()}}}catch(err){_iterator25.e(err)}finally{_iterator25.f()}categoryLabel||(readingObject&&(categoryLabel=_this5.weatherModules.filter((function(wModule){return wModule&&wModule.moduleName===readingObject.module}))),categoryLabel=categoryLabel&&0!==categoryLabel.length?categoryLabel[0].displayName:"Degree Days")}else 0!==_this5.allFields.length&&(_this5.allFields["space"]&&"undefined"!==typeof _this5.allFields["space"][parseInt(readingSplit[0])]?(readingObject=_this5.allFields["space"][parseInt(readingSplit[0])],categoryLabel="Space"):(readingObject=_this5.allFields["enpi"][parseInt(readingSplit[0])],categoryLabel="Enpi"));var existingGroup=self.config.result[panel].summaryList.filter((function(inGroup){return inGroup.label===categoryLabel}));if(0===self.config.result[panel].summaryList.length||0===existingGroup.length){var _reading2={};_reading2["readingId"]=parseInt(readingSplit[0]),_reading2["readingLabel"]=readingObject?readingObject.displayName:"",_reading2["resourceId"]=parseInt(readingSplit[readingSplit.length-1]),_reading2["resourceLabel"]="assets"===category?_this5.readings.assets[parseInt(readingSplit[readingSplit.length-1])]:null,_reading2["location"]=_this5.selectedBuildingLabel,_reading2["marked"]=_this5.currentKey;var temp={};temp["label"]=categoryLabel,temp["readings"]=[],"assets"===category&&(temp["categoryId"]=categoryId),temp.readings.push(_reading2),_this5.config.result[panel].summaryList.push(temp)}else{var _reading3={};_reading3["readingId"]=parseInt(readingSplit[0]),_reading3["readingLabel"]=readingObject?readingObject.displayName:"",_reading3["resourceId"]=parseInt(readingSplit[readingSplit.length-1]),_reading3["resourceLabel"]="assets"===category?_this5.readings.assets[parseInt(readingSplit[readingSplit.length-1])]:null,_reading3["location"]=_this5.selectedBuildingLabel,_reading3["marked"]=_this5.currentKey,existingGroup[0].readings.push(_reading3)}nInsert.isDone=!0};for(_iterator24.s();!(_step24=_iterator24.n()).done;)_loop2()}catch(err){_iterator24.e(err)}finally{_iterator24.f()}}}},removeUnwantedReadings:function(){var _step27,_iterator27=(0,createForOfIteratorHelper/* default */.Z)(this.config.result[this.config.firstPanel.selectedTab.toLowerCase()].summaryList);try{for(_iterator27.s();!(_step27=_iterator27.n()).done;){var _step28,group=_step27.value,_iterator28=(0,createForOfIteratorHelper/* default */.Z)(group.readings);try{for(_iterator28.s();!(_step28=_iterator28.n()).done;){var reading=_step28.value;if(reading&&reading.marked!==this.currentKey){var readingIndex=group.readings.indexOf(reading);group.readings.splice(readingIndex,1)}0===group.readings.length&&this.config.result[this.config.firstPanel.selectedTab.toLowerCase()].summaryList.splice(this.config.result[this.config.firstPanel.selectedTab.toLowerCase()].summaryList.indexOf(group),1)}}catch(err){_iterator28.e(err)}finally{_iterator28.f()}}}catch(err){_iterator27.e(err)}finally{_iterator27.f()}},weatherPanelToggler:function(){this.weatherPanel.show?this.weatherPanel.show=!1:this.weatherPanel.show=!0},weatherModuleHandler:function(weatherModule,readings){if(weatherModule.moduleName){var _step29,filtered=[],_iterator29=(0,createForOfIteratorHelper/* default */.Z)(readings);try{for(_iterator29.s();!(_step29=_iterator29.n()).done;){var reading=_step29.value;reading.module===weatherModule.moduleName&&filtered.push(reading)}}catch(err){_iterator29.e(err)}finally{_iterator29.f()}return filtered}var _step30,_filtered=[],_iterator30=(0,createForOfIteratorHelper/* default */.Z)(readings);try{for(_iterator30.s();!(_step30=_iterator30.n()).done;){var _reading4=_step30.value;"cdd"!==_reading4.module&&"hdd"!==_reading4.module&&"wdd"!==_reading4.module||_filtered.push(_reading4)}}catch(err){_iterator30.e(err)}finally{_iterator30.f()}return _filtered},setDefaultSelection:function(){this.selectedBuildings=[],this.default_building_id&&(this.selectedBuildings=[this.default_building_id])},setSelectedBuildings:function(selectedBuildings){this.selectedBuildings=selectedBuildings},toggleQuickSearch:function(){var _this6=this;this.showQuickSearch=!this.showQuickSearch,this.showQuickSearch&&this.$nextTick((function(){_this6.$refs.quickSearchQuery.focus()}))},closeSearch:function(){this.toggleQuickSearch(),this.quickSearchQuery=null,this.quickSearch()},loadAssetCategories:function(){var self=this;self.weatherPanel.show=!1,self.weatherPanel.weatherCategory=null;var _step31,_iterator31=(0,createForOfIteratorHelper/* default */.Z)(self.weatherModules);try{for(_iterator31.s();!(_step31=_iterator31.n()).done;){var module=_step31.value;module.selected=!1}}catch(err){_iterator31.e(err)}finally{_iterator31.f()}if("assets"!==self.config.mainPanel.currentModule){self.config.mainPanel.currentModule="assets",self.config.mainPanel.selectedAssetCategory=null,self.config.mainPanel.assetCategories=null,self.config.mainPanel.assetCategoriesLoading=!0;var panels=[];self.config["assetPointsPanel"].show&&panels.push("assetPointsPanel"),self.config["selectReadingsPanel"].show&&panels.push("selectReadingsPanel"),self.config["selectAssetsPanel"].show&&panels.push("selectAssetsPanel"),self.togglePanel(panels),self.$http.post("/asset/getAssetCategoryWithReadings",{buildingIds:self.buildingIds}).then((function(response){var categoryIds=Object.keys(response.data);self.config.mainPanel.assetCategories=self.assetCategory.filter((function(ele){for(var index=0;index<categoryIds.length;index++){var element=categoryIds[index];if(parseInt(element)===ele.id)return ele.toggle=!1,ele}})),self.config.mainPanel.assetCategoriesLoading=!1,self.loading=!1,self.savedPoints&&"undefined"!==typeof self.savedPoints&&0!==self.savedPoints.length&&self.prepareSavedDataPoints()}))}else self.config.mainPanel.currentModule=""},resetResetReadings:function(){this.readings={categories:[],assets:{},categoryWithAssets:{},fields:{},categoryWithFields:{}}},removeSelectedDataPoint:function(dataPoint,index){this.config.result[this.config.firstPanel.selectedTab.toLowerCase()].selectedDataPoints.splice(index,1)},togglePanel:function(){for(var self=this,configKeys=Object.keys(self.config),_len=arguments.length,panels=new Array(_len),_key=0;_key<_len;_key++)panels[_key]=arguments[_key];for(var _i3=0,_configKeys=configKeys;_i3<_configKeys.length;_i3++){var configKey=_configKeys[_i3];"regressionType"!==configKey&&(panels.indexOf(configKey)>=0?self.config[configKey].show=!0:(self.config[configKey].show=!1,self.config[configKey].selectedItem=null))}},openAssetCategory:function(categoryId){var _this7=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){var self,assetIds,readingIds;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:if(self=_this7,self.togglePanel("assetPointsPanel"),self.config.mainPanel.selectedAssetCategory=categoryId,self.config.assetPointsPanel.loading=!0,self.config.assetPointsPanel.selectedAssetOrPoint=null,!self.readings.categories.includes(categoryId)||!self.readings.categoryWithAssets[categoryId]){_context4.next=9;break}"assets"===self.config.assetPointsPanel.activeSubTab?(assetIds=Object.keys(self.readings.categoryWithAssets[categoryId]),self.config.assetPointsPanel.data=assetIds.map((function(el){return{id:el,name:self.readings.assets[el]}})),self.config.assetPointsPanel.loading=!1):(readingIds=Object.keys(self.readings.categoryWithFields[categoryId]),self.config.assetPointsPanel.data=readingIds.map((function(el){return self.readings.fields[el]})),self.config.assetPointsPanel.loading=!1),_context4.next=12;break;case 9:if(!self.buildingIds){_context4.next=12;break}return _context4.next=12,self.$http.post("/asset/getReadingsForSpecificAssetCategory",{buildingIds:self.buildingIds,categoryIds:[categoryId]}).then((function(response){if(self.readings.categories.includes(categoryId)||self.readings.categories.push(categoryId),response.data.categoryWithAssets[categoryId]&&(self.readings.categoryWithAssets[categoryId]=response.data.categoryWithAssets[categoryId]),response.data.categoryWithFields[categoryId]&&(self.readings.categoryWithFields[categoryId]=response.data.categoryWithFields[categoryId]),response.data.fields)for(var _i4=0,_Object$keys2=Object.keys(response.data.fields);_i4<_Object$keys2.length;_i4++){var fieldId=_Object$keys2[_i4];self.readings.fields[fieldId]||(self.readings.fields[fieldId]=response.data.fields[fieldId]),self.allFields["assets"]&&!self.allFields["assets"][fieldId]&&(self.allFields["assets"][fieldId]=response.data.fields[fieldId])}if(response.data.assets)for(var _i5=0,_Object$keys3=Object.keys(response.data.assets);_i5<_Object$keys3.length;_i5++){var assetId=_Object$keys3[_i5];self.readings.assets[assetId]||(self.readings.assets[assetId]=response.data.assets[assetId])}if("assets"===self.config.assetPointsPanel.activeSubTab&&self.readings.categoryWithAssets[categoryId]){var _assetIds=Object.keys(self.readings.categoryWithAssets[categoryId]);self.config.assetPointsPanel.data=_assetIds.map((function(el){return{id:el,name:self.readings.assets[el]}})),self.config.assetPointsPanel.loading=!1}else if(self.readings.categoryWithFields[categoryId]){var _readingIds=Object.keys(self.readings.categoryWithFields[categoryId]);self.config.assetPointsPanel.data=_readingIds.map((function(el){return self.readings.fields[el]})),self.config.assetPointsPanel.loading=!1}else self.config.assetPointsPanel.loading=!1}));case 12:case"end":return _context4.stop()}}),_callee4)})))()},openAsset:function(assetId){var self=this;self.config.assetPointsPanel.selectedAssetOrPoint=assetId,self.togglePanel("assetPointsPanel","selectReadingsPanel"),self.config.selectReadingsPanel.loading=!0,self.config.selectReadingsPanel.parentId=assetId;var fieldIds=self.readings.categoryWithAssets[self.config.mainPanel.selectedAssetCategory][assetId];self.config.selectReadingsPanel.data=fieldIds.map((function(el){return self.readings.fields[el]})),self.config.selectReadingsPanel.loading=!1},openPoint:function(pointId){var self=this;self.config.assetPointsPanel.selectedAssetOrPoint=pointId,self.togglePanel("assetPointsPanel","selectAssetsPanel"),self.config.selectAssetsPanel.loading=!0,self.config.selectAssetsPanel.readingId=pointId;var assetIds=self.readings.categoryWithFields[self.config.mainPanel.selectedAssetCategory][pointId];self.config.selectAssetsPanel.data=assetIds.map((function(el){return{id:el,name:self.readings.assets[el]}})),self.config.selectAssetsPanel.loading=!1},getReadingFields:function(readings){var _step32,data=[],_iterator32=(0,createForOfIteratorHelper/* default */.Z)(readings);try{for(_iterator32.s();!(_step32=_iterator32.n()).done;){var _step33,reading=_step32.value,_iterator33=(0,createForOfIteratorHelper/* default */.Z)(reading.fields);try{for(_iterator33.s();!(_step33=_iterator33.n()).done;){var field=_step33.value;field.module=reading.name,data.push(field)}}catch(err){_iterator33.e(err)}finally{_iterator33.f()}}}catch(err){_iterator32.e(err)}finally{_iterator32.f()}return data},loadSpaceReadings:function(){var self=this;self.config.mainPanel.currentModule="spaces",self.togglePanel("selectReadingsPanel"),self.config.selectReadingsPanel.loading=!0,self.config.selectReadingsPanel.parentId=self.buildingIds[0],self.$http.get("/reading/getspacespecificreadings?parentId="+self.buildingIds[0]).then((function(response){self.config.selectReadingsPanel.data=self.getReadingFields(response.data.filter((function(el){
// TODO check whether to show for building analysis also, all readings except enpi
if(3===el.type)return el}))),self.allFields["space"]=self.convertToList(self.config.selectReadingsPanel.data),self.config.selectReadingsPanel.loading=!1}))},loadWeatherReadings:function(weatherModule){var _this8=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee6(){var self,_iterator34,_step34,module,fetchWeatherReadings,response,siteId;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context6){while(1)switch(_context6.prev=_context6.next){case 0:self=_this8,self.weatherPanel.weatherCategory=weatherModule||self.weatherModules[0],_iterator34=(0,createForOfIteratorHelper/* default */.Z)(self.weatherModules);try{for(_iterator34.s();!(_step34=_iterator34.n()).done;)module=_step34.value,module.selected=!1}catch(err){_iterator34.e(err)}finally{_iterator34.f()}if(_this8.weatherReadings.length?self.config.selectReadingsPanel.loading=!1:self.config.selectReadingsPanel.loading=!0,self.config.mainPanel.currentModule=weatherModule?weatherModule.moduleName:self.weatherModules[0].moduleName,self.togglePanel("selectReadingsPanel"),weatherModule&&(weatherModule.selected=!0),fetchWeatherReadings=function(){var _ref=(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee5(siteId){var response;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context5){while(1)switch(_context5.prev=_context5.next){case 0:return _context5.next=2,self.$http.get("/reading/getspacespecificreadings?excludeForecastReadings=false&parentId="+siteId);case 2:response=_context5.sent,self.weatherReadings=response.data,self.config.selectReadingsPanel.data=weatherModule?self.weatherModuleHandler(weatherModule,self.getReadingFields(response.data)):self.weatherModuleHandler(self.weatherModules[0],self.getReadingFields(response.data)),self.allFields["weather"]=self.convertToList(self.config.selectReadingsPanel.data),self.config.selectReadingsPanel.loading=!1;case 7:case"end":return _context5.stop()}}),_callee5)})));return function(_x2){return _ref.apply(this,arguments)}}(),!self.config.selectReadingsPanel.spaceObj||!self.config.selectReadingsPanel.spaceObj.siteId){_context6.next=14;break}self.config.selectReadingsPanel.parentId=self.config.selectReadingsPanel.spaceObj.siteId,self.weatherReadings.length?(self.config.selectReadingsPanel.data=weatherModule?self.weatherModuleHandler(weatherModule,self.getReadingFields(self.weatherReadings)):self.weatherModuleHandler(self.weatherModules[0],self.getReadingFields(self.weatherReadings)),self.allFields["weather"]=self.convertToList(self.config.selectReadingsPanel.data),self.config.selectReadingsPanel.loading=!1):fetchWeatherReadings(self.config.selectReadingsPanel.spaceObj.siteId),_context6.next=18;break;case 14:return _context6.next=16,self.$http.get("/building/"+self.buildingIds[0]);case 16:response=_context6.sent,response.data.building?(siteId=response.data.building.siteId,self.config.selectReadingsPanel.parentId=siteId,self.config.selectReadingsPanel.spaceObj=response.data.building,fetchWeatherReadings(siteId)):self.$http.get("/zone/"+self.buildingIds[0]).then((function(response){if(response.data.zone){var _siteId=response.data.zone.siteId;self.config.selectReadingsPanel.parentId=_siteId,self.config.selectReadingsPanel.spaceObj=response.data.building,fetchWeatherReadings(_siteId)}}));case 18:case"end":return _context6.stop()}}),_callee6)})))()},loadEnPIReadings:function(){var self=this;self.config.mainPanel.currentModule="enpi",self.togglePanel("selectReadingsPanel"),self.config.selectReadingsPanel.loading=!0,self.config.selectReadingsPanel.parentId=self.buildingIds[0],self.$http.get("/reading/getspacespecificreadings?parentId="+self.buildingIds[0]).then((function(response){self.config.selectReadingsPanel.data=self.getReadingFields(response.data.filter((function(el){if(7===el.type)return el}))),self.allFields["enpi"]=self.convertToList(self.config.selectReadingsPanel.data),self.config.selectReadingsPanel.loading=!1}))},cancel:function(){
// remove not added data points
if(this.config.result.metrics.selectedDataPoints.length>this.config.result.metrics.dataPoints.length){var length=this.config.result.metrics.selectedDataPoints.length-this.config.result.metrics.dataPoints.length;this.config.result.metrics.selectedDataPoints.splice(this.config.result.metrics.dataPoints.length-1,length)}this.selectorPanelShow=!1},apply:function(){var config=this.$helpers.cloneObject(this.config);this.config.result.dimension.dataPoints=[],this.config.result.metrics.dataPoints=[],this.config.result.dimension.regressionPoints=[],this.config.result.metrics.regressionPoints=[],this.populateAddedDataPoints(config),0!==this.selectedBuildings.length&&""!==this.selectedBuildingLabel&&(this.config.result.meta={},this.config.result.meta["selectedBuildingIds"]=this.selectedBuildings,this.config.result.meta["selectedBuildingTitle"]=this.selectedBuildingLabel),this.$emit("update:enableFloatimngIcon",!0),this.getSelectedPointsMeta(),this.updateAndEmitData(),this.selectorPanelShow=!1},populateAddedDataPoints:function(config){if(this.config.result.dimension.selectedDataPoints&&this.config.result.dimension.selectedDataPoints.length){var _step35,_iterator35=(0,createForOfIteratorHelper/* default */.Z)(this.config.result.dimension.selectedDataPoints);try{for(_iterator35.s();!(_step35=_iterator35.n()).done;){var dp=_step35.value,readingFieldId=parseInt(dp.split("_")[0]),parentId=parseInt(dp.split("_")[1]);this.config.result.dimension.dataPoints.push({parentId:parentId,yAxis:{fieldId:readingFieldId,aggr:this.setAggrPoint(dp,"dimension",config,this.readings.fields[readingFieldId])},prediction:!!(this.readings&&this.readings.fields&&this.readings.fields[readingFieldId]&&this.readings.fields[readingFieldId].module)&&11===this.readings.fields[readingFieldId].module.type,duplicateDataPoint:!1}),this.config.result.dimension.regressionPoints.push({parentId:parentId,aggr:this.setAggrPoint(dp,"dimension",config,this.readings.fields[readingFieldId]),readingId:readingFieldId,axis:"x"})}}catch(err){_iterator35.e(err)}finally{_iterator35.f()}}if(this.config.result.metrics.selectedDataPoints&&this.config.result.metrics.selectedDataPoints.length){var _step36,_iterator36=(0,createForOfIteratorHelper/* default */.Z)(this.config.result.metrics.selectedDataPoints);try{for(_iterator36.s();!(_step36=_iterator36.n()).done;){var _dp=_step36.value,_readingFieldId=parseInt(_dp.split("_")[0]),_parentId=parseInt(_dp.split("_")[1]);this.config.result.metrics.dataPoints.push({parentId:_parentId,displayName:this.readings.fields[_readingFieldId]?this.readings.fields[_readingFieldId].displayName:"",yAxis:{fieldId:_readingFieldId,aggr:this.setAggrPoint(_dp,"metrics",config,this.readings.fields[_readingFieldId])},prediction:!!(this.readings&&this.readings.fields&&this.readings.fields[_readingFieldId]&&this.readings.fields[_readingFieldId].module)&&11===this.readings.fields[_readingFieldId].module.type}),this.config.result.metrics.regressionPoints.push({parentId:_parentId,aggr:this.setAggrPoint(_dp,"metrics",config,this.readings.fields[_readingFieldId]),readingId:_readingFieldId,axis:"y"})}}catch(err){_iterator36.e(err)}finally{_iterator36.f()}}},getSelectedPointsMeta:function(){var points=[],metricPoints=[],self=this;this.config.result.dimension.dataPoints.length&&this.config.result.dimension.dataPoints.forEach((function(point){self.config.result.dimension.summaryList.length&&self.config.result.dimension.summaryList.forEach((function(summary){summary.readings.length&&summary.readings.forEach((function(data){data.resourceId===point.parentId&&data.readingId===point.yAxis.fieldId&&(data.label=summary.label,points.push(data))}))}))})),this.config.result.dimension.addedDataPoints=points,this.config.result.metrics.dataPoints.length&&this.config.result.metrics.dataPoints.forEach((function(point){self.config.result.metrics.summaryList.length&&self.config.result.metrics.summaryList.forEach((function(summary){summary.readings.length&&summary.readings.forEach((function(data){data.resourceId===point.parentId&&data.readingId===point.yAxis.fieldId&&(data.label=summary.label,metricPoints.push(data))}))}))})),this.config.result.metrics.addedDataPoints=metricPoints},checkAndReduceRangeTraces:function(dataPoints){var _step37,finalDataPoints=[],keyAndDataPoints={},_iterator37=(0,createForOfIteratorHelper/* default */.Z)(dataPoints);try{for(_iterator37.s();!(_step37=_iterator37.n()).done;){var dP=_step37.value;keyAndDataPoints.hasOwnProperty(dP.fieldId+"."+dP.parentId)||(keyAndDataPoints[dP.fieldId+"."+dP.parentId]=[]),keyAndDataPoints[dP.fieldId+"."+dP.parentId].push(dP)}
//reducing data point
}catch(err){_iterator37.e(err)}finally{_iterator37.f()}for(var key in keyAndDataPoints)if(3===keyAndDataPoints[key].length){var aliases=keyAndDataPoints[key][0].aliases.actual.split("."),dataPoint=this.$helpers.cloneObject(keyAndDataPoints[key][0]);dataPoint.aliases.actual=aliases[0],finalDataPoints.push(dataPoint)}else finalDataPoints.push(keyAndDataPoints[key][0]);return finalDataPoints},setAggrPoint:function(dp,mode,config,readingFields){var aggr=readingFields&&readingFields.unit&&["currency","kwh","co2","kg","mwh"].includes(readingFields.unit.trim().toLowerCase())?3:2;if(dp&&config.result[mode].dataPoints.length){var resourceId=parseInt(dp.split("_")[1]),readingId=parseInt(dp.split("_")[0]);config.result[mode].dataPoints.forEach((function(point){point.parentId===resourceId&&point.yAxis&&point.yAxis.fieldId===readingId&&(aggr=point.yAxis.aggr)}))}return aggr},setInitialValues:function(dataPoints,buildings){var _this9=this,finalDataPoints=this.checkAndReduceRangeTraces(dataPoints);finalDataPoints.length!==this.config.result.dimension.selectedDataPoints.length&&(this.config.result.dimension.selectedDataPoints=[],finalDataPoints.forEach((function(dp){2===dp.type||dp.duplicateDataPoint||_this9.config.result.dimension.selectedDataPoints.push(dp.yAxis.fieldId+"_"+dp.parentId)}))),buildings&&buildings.length&&!this.selectedBuildings.includes(buildings[0])&&this.setSelectedBuildings(buildings)}}},components_FRegressionPointSelectorvue_type_script_lang_js=FRegressionPointSelectorvue_type_script_lang_js,FRegressionPointSelector_component=(0,componentNormalizer/* default */.Z)(components_FRegressionPointSelectorvue_type_script_lang_js,FRegressionPointSelectorvue_type_template_id_5b4a8e65_render,FRegressionPointSelectorvue_type_template_id_5b4a8e65_staticRenderFns,!1,null,null,null)
/* harmony default export */,FRegressionPointSelector=FRegressionPointSelector_component.exports,FNewAnalyticRegressionvue_type_template_id_eb0e6360_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"analytics-section regression-analytics-section"},[_c("div",{staticClass:"new-analytics-filter-section",staticStyle:{"text-align":"center"}},[_vm.config.hidedatepicker?_vm._e():_c("new-date-picker",{ref:"newDatePicker",staticClass:"filter-field date-filter-comp inline",attrs:{zone:_vm.$timezone,dateObj:_vm.config.dateFilter,isDateFixed:_vm.config.applyReportDate},on:{date:_vm.setDateFilter}}),!_vm.config.hidechartoptions&&_vm.reportObj&&!0===!_vm.isRegression?_c("f-chart-settings",{attrs:{dataPoints:_vm.reportObj.options.dataPoints,settings:_vm.reportObj.options.settings,showChart:!1,showTable:!1,showChartMode:_vm.reportObj.data&&Object.keys(_vm.reportObj.data).length>2,showAlarm:!(!_vm.reportObj.options||!_vm.reportObj.options.common||1!==_vm.reportObj.options.common.type),showSafelimit:!(!_vm.reportObj.options||!_vm.reportObj.options.common||1!==_vm.reportObj.options.common.type||"undefined"!==typeof _vm.resultObj.regression),disableChartMode:_vm.reportObj.booleanData},on:{onSettingsChange:_vm.onSettingsChange}}):_vm._e(),_vm.resultObj&&_vm.resultObj.report&&0!==_vm.resultObj.report.dataPoints.length&&!_vm.isRegression?_c("span"):_vm._e()],1),_vm.loading?_c("spinner",{staticClass:"analytics-spinner",attrs:{show:_vm.loading,size:"80"}}):_vm.failed?_c("div",{staticStyle:{"margin-top":"30px",opacity:"0.7","font-size":"13px",padding:"50px","line-height":"25px","text-align":"center"}},[_c("div",[_vm._v(_vm._s(_vm.$t("home.dashboard.data_loading_failed")))])]):_vm.resultObj&&0===_vm.resultObj.reportData.data.length?_c("div",{staticStyle:{"margin-top":"30px",opacity:"0.git 7","font-size":"13px",padding:"50px","line-height":"25px","text-align":"center"}},[_c("inline-svg",{attrs:{src:"svgs/emptystate/reportlist",iconClass:"icon text-center icon-100"}}),_c("div",{staticClass:"nowo-label f13"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.empty_data"))+" "),_vm.resultObj&&_vm.resultObj.dateRange?_c("span",{staticClass:"bold"},[_vm._v(_vm._s(_vm._f("formatPeriod")(_vm.resultObj.dateRange.value,"MMM DD, YYYY")))]):_vm._e()])],1):0==_vm.regressionModelList.length?_c("div",{staticStyle:{"margin-top":"30px",opacity:"0.git 7","font-size":"13px",padding:"50px","line-height":"25px","text-align":"center"}},[_c("img",{staticClass:"no-chart-data",staticStyle:{width:"10%"},attrs:{src:__webpack_require__(15482)}}),_c("div",{staticClass:"mT15"},[_vm._v(_vm._s(_vm.regressionErrorMessage))])]):_vm.config&&_vm.config.regressionType===_vm.regressionTypes.SINGLE?_c("div",{staticClass:"height100"},[0!==Object.keys(_vm.regressionReportObjectList).length?_c("div",{staticClass:"fc-regression-scroll"},[_vm._l(Object.keys(_vm.regressionReportObjectList),(function(report,reportIdx){return _c("f-new-chart",{key:reportIdx,ref:"newChart",refInFor:!0,attrs:{data:_vm.regressionReportObjectList[report].data,options:_vm.regressionReportObjectList[report].options,alarms:_vm.regressionReportObjectList[report].alarms,dateRange:_vm.regressionReportObjectList[report].dateRange,resultObj:_vm.resultObj,hidecharttypechanger:_vm.config.hidecharttypechanger||_vm.isRegression,fixedChartHeight:270,config:_vm.config,showWidgetLegends:!1}})})),0!==_vm.regressionModelList.length?_c("el-tabs",{staticClass:"single-regression-tab mT50",model:{value:_vm.activeRegressionModel,callback:function($$v){_vm.activeRegressionModel=$$v},expression:"activeRegressionModel"}},_vm._l(_vm.regressionModelList,(function(regressionInfo,regressionInfoIdx){return _c("el-tab-pane",{key:regressionInfoIdx,attrs:{label:regressionInfo[0].dataPoints[0].name,name:regressionInfo[0].alias}},[_c("MultipleRegressionAnalysis",{staticClass:"regression-single-chart-scroll",attrs:{regressionMetrics:regressionInfo,analyticsConfig:_vm.config}})],1)})),1):_vm._e()],2):_vm._e()]):_c("div",[_c("MultipleRegressionAnalysis",{attrs:{resultObj:_vm.resultObj,analyticsConfig:_vm.config}})],1)],1)},FNewAnalyticRegressionvue_type_template_id_eb0e6360_staticRenderFns=[],NewDatePicker=__webpack_require__(900773),FNewChart=__webpack_require__(875963),NewDataFormatHelper=__webpack_require__(804911),FChartSettings=__webpack_require__(746036),MultipleRegressionAnalysis=__webpack_require__(974102),FNewAnalyticRegressionvue_type_script_lang_js={props:["config","baseLines","readings"],mixins:[NewDataFormatHelper/* default */.Z,AnalyticsMixin/* default */.Z,NewDateHelper/* default */.Z],components:{NewDatePicker:NewDatePicker/* default */.Z,FNewChart:FNewChart/* default */.Z,
// FMultiChart,
// FMobileChart,
FChartSettings:FChartSettings/* default */.Z,
// FMobileMultiChart,
MultipleRegressionAnalysis:MultipleRegressionAnalysis/* default */.Z},data:function(){return{loading:!0,predictive:!0,failed:!1,reportObj:null,reportList:{},resultObj:null,regressionTypes:null,activeRegressionModel:null}},created:function(){this.regressionTypes=FNewAnalyticsModelHelper/* default */.Z.regressionTypes(),this.$store.dispatch("loadAssetCategory")},mounted:function(){this.init()},computed:{regressionErrorMessage:function(){var errorMessage="";return"single"===this.config.regressionType?errorMessage="Data is not enough to construct a model using regression.":this.resultObj&&this.resultObj.regressionConfig&&0!=this.resultObj.regressionConfig.length&&(errorMessage=2===this.resultObj.regressionConfig[0].errorState?"Data available is not enough to construct a model using regression":"A Model cannot be constructed with the available data using regression."),errorMessage},regressionModelList:function(){var _this=this,regressionMetrics=[],regressionMetricKeys=FNewAnalyticsModelHelper/* default */.Z.regressionMetrics();if(this.resultObj&&this.resultObj.reportData.regressionResult){var _step,_iterator=(0,createForOfIteratorHelper/* default */.Z)(this.resultObj.regressionConfig);try{var _loop=function(){var config=_step.value,key=FNewAnalyticsModelHelper/* default */.Z.computeRegressionAlias(config),temp={};temp["alias"]=key;var result=_this.resultObj.reportData.regressionResult[key];if(result){var regressionDataPoint=_this.resultObj.report.dataPoints.filter((function(dp){return dp.aliases.actual===key}));regressionDataPoint.length&&(temp["expressionString"]=regressionDataPoint[0].expressionString);var dataPoints=[],_loop2=function(alias){if("constant"!==alias){var dataPoint=_this.resultObj.report.dataPoints.find((function(dp){return dp.aliases.actual===alias}));dataPoint&&dataPoints.push(dataPoint)}};for(var alias in result.coefficientMap)_loop2(alias);var yPoint=_this.resultObj.report.dataPoints.find((function(dp){return dp.aliases.actual===config.yAxis.alias}));yPoint&&(temp["yPoint"]=yPoint),temp["dataPoints"]=dataPoints;var _step2,_iterator2=(0,createForOfIteratorHelper/* default */.Z)(regressionMetricKeys);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var heading=_step2.value;temp[heading.name]=result[heading.name]}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}for(var variableName in temp["anovaMetrics"]=result["anovaMetrics"],result.regressionMetrics){var row=result.regressionMetrics[variableName];row["name"]=variableName}temp["regressionMetrics"]=result.regressionMetrics,regressionMetrics.push([temp])}};for(_iterator.s();!(_step=_iterator.n()).done;)_loop()}catch(err){_iterator.e(err)}finally{_iterator.f()}}return this.config.regressionType===FNewAnalyticsModelHelper/* default */.Z.regressionTypes().SINGLE&&regressionMetrics.length!==this.config.regressionConfig.length?[]:regressionMetrics},regressionReportObjectList:function(){var reportList=[];if(this.resultObj&&this.resultObj.regressionConfig)for(var reportKey in this.reportList){var reportObject=this.reportList[reportKey];reportObject.data&&0!=reportObject.data.length&&reportList.push(reportObject)}return this.config.regressionConfig.length!==reportList.length?[]:reportList},isRegression:function(){return!!this.$route.path.includes("regression")}},watch:{config:{handler:function(newData,oldData){this.config.applyReportDate||this.init(!1)},deep:!0}},methods:{setDateFilter:function(dateFilter){this.$set(this.config,"dateFilter",dateFilter);
// this.$emit('update:config', this.config)
},init:function(){this.initChart()},resize:function(){this.$refs["newChart"]&&this.$refs["newChart"].resize(),this.$refs["multiChart"]&&this.$refs["multiChart"].resize(),this.$refs["newTable"]&&this.$refs["newTable"].resize()},getReportParams:function(){var baselines,baselineNames,_this2=this;if(this.config.baseLine&&Array.isArray(this.config.baseLine)&&this.config.baseLine.length){if(this.config.baseLine[0]>0){var bl={};bl.baseLineId=this.config.baseLine[0],this.config.baseLine.length>1&&(bl.adjustType=this.config.baseLine[1]);var blList=[];blList.push(bl),baselines=blList}}else this.config.baseLine&&this.config.baseLine>0&&(baselines=[{baseLineId:this.config.baseLine}]);baselines&&this.baseLines&&(baselineNames=[],baselines.forEach((function(baseline){var baseLineName=_this2.baseLines.find((function(bl){return bl.id===baseline.baseLineId})).name;baselineNames.push(baseLineName)})));var fields=[];if(3===this.config.mode){var _step3,parentId=[],fieldId=null,yAggr=3,_iterator3=(0,createForOfIteratorHelper/* default */.Z)(this.config.dataPoints);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var dp=_step3.value;parentId.push(dp.parentId),fieldId=dp.yAxis.fieldId,yAggr=dp.yAxis.aggr}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}fields.push({parentId:parentId,yAxis:{fieldId:fieldId,aggr:0!==this.config.period&&0===yAggr?3:yAggr},type:1,aliases:{actual:"A"}}),this.setAlias(fields,baselineNames)}else{this.setAlias(this.config.dataPoints,baselineNames);var _step4,_iterator4=(0,createForOfIteratorHelper/* default */.Z)(this.config.dataPoints);try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var _dp=_step4.value,metaData={};_dp.categoryId&&(metaData.categoryId=_dp.categoryId),fields.push({parentId:_dp.parentId?Array.isArray(_dp.parentId)?_dp.parentId:[_dp.parentId]:null,name:_dp.name,metaData:metaData,yAxis:_dp.yAxis,aliases:_dp.aliases,type:_dp.type>0?_dp.type:1,predictedTime:_dp.predictedTime})}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}}if(this.config.sorting&&(6===this.config.mode||7===this.config.mode||8===this.config.mode)&&(this.config.sorting.orderByFunc||this.config.sorting.limit)){var sortByField=this.config.sorting.sortByField;if(sortByField){var _field=fields.find((function(f){return f.yAxis.fieldId===sortByField}));_field||(sortByField=null)}sortByField||(sortByField=fields[0].yAxis.fieldId,this.config.sorting.sortByField=fields[0].yAxis.fieldId);var field=fields.find((function(f){return f.yAxis.fieldId===sortByField}));field&&(field.defaultSortPoint=!0,this.config.sorting.orderByFunc&&(field.orderByFunc=this.config.sorting.orderByFunc),this.config.sorting.limit&&(field.limit=this.config.sorting.limit))}this.config.regressionConfig&&0!==this.config.regressionConfig.length&&this.setRegressionConfigAlias();var params={mode:this.config.mode,startTime:this.config.dateFilter.value[0],endTime:this.config.dateFilter.value[1],xAggr:1===this.config.mode||3===this.config.mode||4===this.config.mode||5===this.config.mode?this.config.period:0,fields:JSON.stringify(fields),transformWorkflow:this.config.transformWorkflow};if(this.reportObj&&this.reportObj.options&&this.reportObj.options.settings?(params.showAlarms=this.reportObj.options.settings.alarm,params.showSafeLimit=this.reportObj.options.settings.safelimit):this.config.savedReport?(params.showAlarms=this.config.savedReport.showAlarms,params.showSafeLimit=this.config.savedReport.showSafeLimit):params.showSafeLimit=!0,baselines&&(params.baseLines=JSON.stringify(baselines)),this.config.filters&&this.config.filters.xCriteriaMode)if(params.xCriteriaMode=this.config.filters.xCriteriaMode,this.config.filters.parentId&&this.config.filters.parentId.length)params.parentId=this.config.filters.parentId;else{var categoryId=this.config.filters.assetCategory;if(!categoryId||!categoryId.length){categoryId=[];var _step5,_iterator5=(0,createForOfIteratorHelper/* default */.Z)(this.config.dataPoints);try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var _dp2=_step5.value;-1===categoryId.indexOf(_dp2.categoryId)&&categoryId.push(_dp2.categoryId)}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}}categoryId.length&&(params.assetCategory=categoryId),this.config.filters.spaceId&&this.config.filters.spaceId.length&&(params.spaceId=this.config.filters.spaceId)}return this.$route.query&&this.$route.query.alarmId&&(params.alarmId=parseInt(this.$route.query.alarmId),params.showAlarms=!0),params},setRegressionConfigAlias:function(){var _step6,_this3=this,_iterator6=(0,createForOfIteratorHelper/* default */.Z)(this.config.regressionConfig);try{var _loop3=function(){var conf=_step6.value,yDataPoint=_this3.config.dataPoints.filter((function(dp){return dp.parentId===conf.yAxis.parentId&&dp.yAxis.fieldId===conf.yAxis.readingId}));0!==yDataPoint.length&&(conf.yAxis["alias"]=yDataPoint[0].aliases.actual);var _step7,_iterator7=(0,createForOfIteratorHelper/* default */.Z)(conf.xAxis);try{var _loop4=function(){var xPoint=_step7.value,xDataPoint=_this3.config.dataPoints.filter((function(dp){return dp.parentId===xPoint.parentId&&dp.yAxis.fieldId===xPoint.readingId}));0!==xDataPoint.length&&(xPoint.alias=xDataPoint[0].aliases.actual)};for(_iterator7.s();!(_step7=_iterator7.n()).done;)_loop4();
// if(this.config.regressionType === this.regressionTypes.MULTIPLE){
// }
// else{
//   let xDataPoint = this.config.dataPoints.filter((dp) => dp.parentId === conf.xAxis.parentId && dp.yAxis.fieldId === conf.xAxis.readingId)
//   if(xDataPoint.length !== 0){
//     conf.xAxis['alias'] = xDataPoint[0].aliases.actual
//   }
// }
}catch(err){_iterator7.e(err)}finally{_iterator7.f()}};for(_iterator6.s();!(_step6=_iterator6.n()).done;)_loop3()}catch(err){_iterator6.e(err)}finally{_iterator6.f()}},initChart:function(){var self=this;self.loading=!0,self.failed=!1;
// let apiURL = this.config.api ? this.config.api : (this.config.regressionConfig && this.config.regressionType === this.regressionTypes.SINGLE )? '/v2/report/readingReport' : '/v2/report/regressionreport'
var apiURL="/v3/report/reading/regression",params=null;this.config.alarmId&&(apiURL="/v2/report/fetchReadingsFromAlarm",params={alarmId:this.config.alarmId,mode:1,xAggr:0,startTime:this.config.dateFilter.value[0],endTime:this.config.dateFilter.value[1],showAlarms:!0,regressionConfig:this.config.regressionConfig}),this.config.readingRuleId&&(params.readingRuleId=this.config.readingRuleId),this.config.isWithPrerequsite&&(params.isWithPrerequsite=this.config.isWithPrerequsite),params||(params=self.getReportParams()),params.newFormat=!0,
// if(this.config.regressionConfig && this.config.regressionConfig.length != 0 && this.config.regressionType === this.regressionTypes.MULTIPLE){
//   params['regressionConfig'] = this.config.regressionConfig
// }
this.config.regressionConfig&&(params["regressionConfig"]=this.config.regressionConfig,params["regressionType"]=this.config.regressionType),api/* API */.bl.post(apiURL,params).then((function(response){if(!response.error){var result=response.data.result?response.data.result:response.data;if(!result)return self.loading=!1,void(self.failed=!0);result.xAggr=params.xAggr,result.mode=params.mode,self.config.analyticsType&&(result.report.analyticsType=self.config.analyticsType),self.config.filters&&(result.filters=self.config.filters),self.config.sorting&&(result.sorting=self.config.sorting),self.config.applyReportDate?(self.config.dateFilter=result.dateRange=NewDateHelper/* default */.Z.getDatePickerObject(self.config.dateFilter.operatorId,result.report.dateValue),self.$nextTick((function(){self.$refs.newDatePicker.loadFromObject()}))):result.dateRange=self.config.dateFilter,self.reportObj&&!self.config.alarmId?(result.report.chartState=self.reportObj.options,result.report.tabularState=self.reportObj.params.tabularState):self.config.savedReport&&(result.report.chartState=self.config.savedReport.chartState,result.report.tabularState=self.config.savedReport.tabularState);var regressionConfig=result.report.reportState.regressionConfig;if(regressionConfig&&regressionConfig.length>0&&self.config.regressionType===FNewAnalyticsModelHelper/* default */.Z.regressionTypes().SINGLE){self.reportList={};var _step8,_iterator8=(0,createForOfIteratorHelper/* default */.Z)(regressionConfig);try{for(_iterator8.s();!(_step8=_iterator8.n()).done;){var config=_step8.value,tempResult=JSON.parse(JSON.stringify(result));if(tempResult["regression"]=!0,tempResult["regressionConfig"]=[config],tempResult["regressionType"]=self.config.regressionType,tempResult["filterRegression"]=!0,config.groupAlias&&self.reportList[config.groupAlias]){var chartState=self.reportList[config.groupAlias].options;tempResult.report.chartState=chartState}var reportObject=self.prepareReport(tempResult),groupAlias=config.groupAlias;groupAlias&&(self.reportList[groupAlias]=reportObject)}}catch(err){_iterator8.e(err)}finally{_iterator8.f()}}if(self.config.regressionType===FNewAnalyticsModelHelper/* default */.Z.regressionTypes().SINGLE){result["regression"]=!0,result["regressionType"]=FNewAnalyticsModelHelper/* default */.Z.regressionTypes().SINGLE,result["regressionConfig"]=result.report.reportState.regressionConfig;var firstKey=FNewAnalyticsModelHelper/* default */.Z.computeRegressionAlias(self.config.regressionConfig[0]);self.activeRegressionModel=firstKey}if(self.reportObj=self.prepareReport(result),self.config.regressionType===FNewAnalyticsModelHelper/* default */.Z.regressionTypes().MULTIPLE){result["regression"]=!0,result["regressionType"]=self.config.regressionType,result["regressionConfig"]=result.report.reportState.regressionConfig;var _step9,_iterator9=(0,createForOfIteratorHelper/* default */.Z)(self.config.regressionConfig);try{for(_iterator9.s();!(_step9=_iterator9.n()).done;){var conf=_step9.value,_groupAlias=FNewAnalyticsModelHelper/* default */.Z.computeRegressionAlias(conf);conf["groupAlias"]=_groupAlias}}catch(err){_iterator9.e(err)}finally{_iterator9.f()}}(self.config.isFromAlarmSummary||self.$route.query&&self.$route.query.isFromAlarmSummary&&!self.resultObj)&&self.reportObj.booleanData&&(self.reportObj.options.dataPoints=self.groupNonBooleanPoints(self.reportObj.options.dataPoints)),(self.$route.query&&self.$route.query.alarmId||self.config.alarmId)&&(self.reportObj.options.settings.alarm=!0),self.resultObj=result,self.reportObj.params=params,self.reportObj.alarms=self.prepareBooleanReport(result.reportData.aggr),self.config.alarmId&&(self.reportObj.alarms.barSize="medium"),self.reportObj.options.predictionTimings=self.config.predictionTimings,self.$emit("reportLoaded",self.reportObj,self.resultObj),self.loading=!1}})).catch((function(error){error&&(self.loading=!1,self.failed=!0)}))},onSettingsChange:function(changedOption){"alarm"===changedOption?this.reportObj.alarms&&this.reportObj.alarms.regions.length||!this.reportObj.options.settings.alarm||this.init():"safelimit"===changedOption&&!this.reportObj.options.safeLimit.length&&this.reportObj.options.settings.safelimit&&this.init()}}},components_FNewAnalyticRegressionvue_type_script_lang_js=FNewAnalyticRegressionvue_type_script_lang_js,FNewAnalyticRegression_component=(0,componentNormalizer/* default */.Z)(components_FNewAnalyticRegressionvue_type_script_lang_js,FNewAnalyticRegressionvue_type_template_id_eb0e6360_render,FNewAnalyticRegressionvue_type_template_id_eb0e6360_staticRenderFns,!1,null,null,null)
/* harmony default export */,FNewAnalyticRegression=FNewAnalyticRegression_component.exports,BuildingAnalysisvue_type_script_lang_js={props:["mobileConfig"],mixins:[AnalyticsMixin/* default */.Z],components:{FRegressionPointSelector:FRegressionPointSelector,Derivation:FDerivation/* default */.Z,FNewAnalyticReport:FNewAnalyticReport["default"],FChartCustomization:FChartCustomization/* default */.Z,FDataPointSelector:FDataPointSelector/* default */.Z,FReportOptions:FReportOptions/* default */.Z,FNewAnalyticRegression:FNewAnalyticRegression,FNewReport:FNewReport/* default */.Z},data:function(){return{showRegressionPointSelector:!0,repid:null,enableFloatimngIcon:!0,showDataPointSelector:!1,showChartCustomization:!1,showDerivation:!1,chartCustomizationActiveTab:"datapoints",selectedBaseLineId:"",baseLineList:null,baseLineCasecaderOptions:[],oldBaseLine:null,analyticsConfig:{name:"Building Analysis",key:"BUILDING_ANALYSIS",analyticsType:this.isSiteAnalysis?6:2,type:"reading",period:0,mode:1,baseLine:null,dateFilter:NewDateHelper/* default */.Z.getDatePickerObject(22),chartViewOption:0,dataPoints:[],defaultDate:!1,predictionTimings:[],transformWorkflow:null},reportObject:null,resultObject:null,selectedBuildings:[],selectedBuildingTitle:"",zones:null,dataPointSummaryList:null}},watch:{reportId:function(){this.reportId&&this.loadReport()},getAvailablePeriods:{handler:function(newData,oldData){var _this=this,avail=this.getAvailablePeriods,selected=avail.find((function(a){return a.value===_this.analyticsConfig.period&&a.enable}));if(!selected){var filterName=this.analyticsConfig.dateFilter.operationOn,defaultPeriod=avail.filter((function(a){return a.enable}))[0].value;"week"===filterName||"month"===filterName?defaultPeriod=12:"year"===filterName&&(defaultPeriod=10),this.analyticsConfig.period=defaultPeriod}},immediate:!0},showChartCustomization:function(newVal){var self=this;self.$nextTick((function(){self.$refs["newAnalyticReport"]&&self.$refs["newAnalyticReport"].resize&&self.$refs["newAnalyticReport"].resize()}))}},created:function(){this.$store.dispatch("loadBuildings")},mounted:function(){if(this.isSiteAnalysis&&(this.analyticsConfig.analyticsType=6),this.isRegression&&(this.analyticsConfig.dateFilter=NewDateHelper/* default */.Z.getDatePickerObject(28)),this.$route.query.filters){var filters=this.$route.query.filters,filtersJSON=JSON.parse(filters);this.analyticsConfig=filtersJSON}(this.reportId||this.alarmId||this.cardId)&&(this.$mobile?this.loadReport(this.mobileConfig):this.loadReport());var self=this;self.$http.get("/baseline/all").then((function(response){if(200===response.status){self.baseLineList=response.data?response.data:[],self.baseLineCasecaderOptions=[],self.baseLineCasecaderOptions.push({label:"None",value:-1});var _step,_iterator=(0,createForOfIteratorHelper/* default */.Z)(self.baseLineList);try{for(_iterator.s();!(_step=_iterator.n()).done;){var b=_step.value,children=null;"PREVIOUS_MONTH"===b.rangeTypeEnum||"ANY_MONTH"===b.rangeTypeEnum?children=[{label:"Same date",value:4},{label:"Same week",value:1}]:"PREVIOUS_YEAR"!==b.rangeTypeEnum&&"ANY_YEAR"!==b.rangeTypeEnum||(children=[{label:"Same date",value:3},{label:"Same week",value:1}]),"PREVIOUS"!==b.rangeTypeEnum&&self.baseLineCasecaderOptions.push({label:b.name,value:b.id,children:children})}}catch(err){_iterator.e(err)}finally{_iterator.f()}}})),self.loadZones()},computed:{computeReportOptions:function(){return this.analyticsConfig&&this.isRegression?[6,5]:[1,2,5]},isRegression:function(){return!!(this.$route.path.includes("regression")||this.analyticsConfig.regressionConfig&&0!==this.analyticsConfig.regressionConfig.length)},isSiteAnalysis:function(){return this.$route.meta&&"site"===this.$route.meta.analyticsType},isSameDataPoint:function(){if(this.analyticsConfig&&this.analyticsConfig.dataPoints.length){var _step2,dp={},_iterator2=(0,createForOfIteratorHelper/* default */.Z)(this.analyticsConfig.dataPoints);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var d=_step2.value;dp[d.yAxis.fieldId]=!0}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}if(1===Object.keys(dp).length)return!0}return!1},getAvailablePeriods:function(){var operationOnId=this.analyticsConfig.dateFilter.operationOnId,avail=[],isRangeEnabled=this.enableForRangeMode();return avail.push({name:"High-res",value:0,enable:6!==operationOnId?4!==operationOnId&&isRangeEnabled:isRangeEnabled}),avail.push({name:"Hourly",value:20,enable:6===operationOnId||4!==operationOnId}),avail.push({name:"Daily",value:12,enable:!0}),avail.push({name:"Weekly",value:11,enable:!0}),avail.push({name:"Monthly",value:10,enable:!0}),avail.push({name:"Quarterly",value:25,enable:4===operationOnId||5===operationOnId}),avail.push({name:"Yearly",value:8,enable:4===operationOnId}),avail.push({name:this.$t("common.header.hour_of_day"),
// 12, 1, 2, 3
value:19,enable:!0}),avail.push({name:this.$t("common.header.day_of_week"),
// sun, mon
value:17,enable:!0}),avail.push({name:this.$t("common.header.day_of_month"),
// 1,2,3
value:18,enable:!0}),avail}},methods:{resetState:function(){Object.assign(this.$data,this.$options.data.apply(this))},prepareOptionDataPoints:function(rConfig,regressionType){var yAxis=!1,dataPoints=[];if(0!==rConfig.length){var _step3,_iterator3=(0,createForOfIteratorHelper/* default */.Z)(rConfig);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var point=_step3.value;for(var key in point)if("yAxis"===key&&!1===yAxis||"xAxis"===key)if("yAxis"===key&&(yAxis=!0),"xAxis"===key){var _step4,_iterator4=(0,createForOfIteratorHelper/* default */.Z)(point[key]);try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var dp=_step4.value,temp={};temp["parentId"]="string"===typeof dp.parentId?parseInt(dp.parentId):dp.parentId,temp["prediction"]=!1,temp["aliases"]={},temp["yAxis"]={},temp.yAxis["fieldId"]=dp.readingId,temp.yAxis["aggr"]=dp.aggr,temp["isRegression"]=!0,dataPoints.push(temp)}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}}else{var _temp={};_temp["parentId"]="string"===typeof point[key].parentId?parseInt(point[key].parentId):point[key].parentId,_temp["prediction"]=!1,_temp["aliases"]={},_temp["yAxis"]={},_temp.yAxis["fieldId"]=point[key].readingId,_temp.yAxis["aggr"]=point[key].aggr,_temp["isRegression"]=!0,dataPoints.push(_temp)}}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}}return dataPoints},applyregression:function(dataPoints){if(this.checkRegressionPointStructure(dataPoints)){var regressionPoints=dataPoints.regressionPoints,config=JSON.parse(JSON.stringify(this.analyticsConfig));dataPoints.result.meta&&(this.selectedBuildings=dataPoints.result.meta.selectedBuildingIds,this.selectedBuildingTitle=dataPoints.result.meta.selectedBuildingTitle),0===dataPoints.regressionPoints.length?(this.reportObj=null,this.resultObj=null,this.analyticsConfig.regressionConfig=[],this.analyticsConfig.regressionType="",this.analyticsConfig.dataPoints=[]):(config["regressionType"]=dataPoints.regressionType,config["dataPoints"]=this.prepareOptionDataPoints(regressionPoints,dataPoints.regressionType),config["regressionConfig"]=dataPoints.regressionPoints,config["hidechartoptions"]=!0,this.analyticsConfig=config)}},checkRegressionPointStructure:function(dataPoints){var _step5,regressionPoints=dataPoints.regressionPoints,_iterator5=(0,createForOfIteratorHelper/* default */.Z)(regressionPoints);try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var rPoint=_step5.value;if(!rPoint.xAxis||!rPoint.yAxis)return!1}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}return!0},prepareDataPointSummary:function(){if(this.reportId&&this.resultObject){var _step6,summaryList=[],weatherModules={weather:"Live Weather",weatherDaily:"Daily Weather",psychrometric:"Psychrometric",cdd:"Degree Days",wdd:"Degree Days",hdd:"Degree Days"},_iterator6=(0,createForOfIteratorHelper/* default */.Z)(this.resultObject.report.dataPoints);try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var dataPoint=_step6.value;dataPoint.yAxis&&dataPoint.yAxis.module&&(Object.keys(weatherModules).includes(dataPoint.yAxis.module.name)?this.addToGroup(dataPoint,weatherModules[dataPoint.yAxis.module.name],summaryList):dataPoint.metaData.parentIds[0]===parseInt(this.selectedBuildings[0])&&"scheduled_formula"===dataPoint.yAxis.module.typeEnum.toLowerCase()?this.addToGroup(dataPoint,"Enpi",summaryList):dataPoint.metaData.parentIds[0]===parseInt(this.selectedBuildings[0])?this.addToGroup(dataPoint,"Space",summaryList):this.addToGroup(dataPoint,"Asset",summaryList))}}catch(err){_iterator6.e(err)}finally{_iterator6.f()}return summaryList}},addToGroup:function(dataPoint,label,summaryList){var _this2=this,reading={};if(reading["readingId"]=dataPoint.yAxis.fieldId,reading["readingLabel"]=dataPoint.yAxis.field.displayName,reading["resourceId"]="Asset"===label?parseInt(dataPoint.metaData.parentIds[0]):"Space"===label||"Enpi"===label?parseInt(this.selectedBuildings[0]):this.$store.state.buildings.filter((function(building){return building.id===parseInt(_this2.selectedBuildings[0])}))[0].siteId,reading["resourceLabel"]=dataPoint.resourceName,reading["marked"]=null,reading["location"]=this.selectedBuildingTitle,reading["categoryId"]=dataPoint.assetCategoryId,reading["buildingId"]=dataPoint.buildingId,summaryList&&0===summaryList.length){var temp={};temp["label"]=label,temp["readings"]=[],temp.readings.push(reading),summaryList.push(temp)}else if(summaryList&&summaryList.length>0){var readingGroup=summaryList.filter((function(group){return group.label===label}));if(0!==readingGroup.length)readingGroup[0].readings.push(reading);else{var _temp2={};_temp2["label"]=label,_temp2["readings"]=[],_temp2.readings.push(reading),summaryList.push(_temp2)}}},loadAlarmMeta:function(){var _this3=this;this.$http.post("/dashboard/getReportMetaForAlarms",{alarmId:this.$route.query.alarmId}).then((function(response){response.data&&response.data.reportMeta&&(_this3.analyticsConfig.dataPoints=response.data.reportMeta.dataPoints)}))},reportLoaded:function(report,result){this.reportObject=report,this.resultObject=result,this.analyticsConfig.savedReport&&(0===this.selectedBuildings.length&&report.options.common.buildingIds&&(this.selectedBuildings=report.options.common.buildingIds,this.selectedBuildingTitle=report.options.common.buildingName),this.dataPointSummaryList=this.prepareDataPointSummary()),report.options.common&&report.options.common.buildingIds&&(!report.options.common.buildingIds.length&&this.selectedBuildings?(this.reportObject.options.common.buildingIds=this.selectedBuildings,this.reportObject.options.common.buildingName=this.selectedBuildingTitle):this.resetDataPointSelector(report.options.common.buildingIds))},loadZones:function(){var self=this;self.$http.get("/zone").then((function(response){response.data&&response.data.records&&(self.zones=response.data.records)}))},resetDataPointSelector:function(buildingIds){this.analyticsConfig.regressionConfig||this.$refs["building-selector"].setInitialValues(this.analyticsConfig.dataPoints,buildingIds)},updateDataPoints:function(changedDataPoints){var _this4=this;if(this.analyticsConfig.dataPoints.length){var configIndexes=[],alreadyAddedIndexes=[],pointsToRemove=[],optionPoints=[];this.reportObject.options.dataPoints.forEach((function(dp){"group"===dp.type||"rangeGroup"===dp.type?optionPoints.push.apply(optionPoints,(0,toConsumableArray/* default */.Z)(dp.children)):optionPoints.push(dp)}));var isValid=optionPoints.filter((function(dp){return 2!==dp.pointType})).every((function(dp){var idx=changedDataPoints.findIndex((function(cdp){return cdp.parentId===dp.parentId&&cdp.yAxis.fieldId===dp.fieldId}));if(-1===idx){if(!_this4.checkAndDeletePointsRel(_this4.reportObject.options,dp.alias))return _this4.$message.error(dp.label+" has been used in derivation(s). Please delete the derivations before removing this point"),_this4.resetDataPointSelector(),!1;pointsToRemove.push(dp.alias)}if(-1!==idx){var configIdx=_this4.getConfigDataPointFromOptionDP(_this4.analyticsConfig,dp,!0);configIndexes.push(configIdx),alreadyAddedIndexes.push(idx)}return!0}));isValid&&(this.removeOptionPoints(this.reportObject.options,pointsToRemove),this.analyticsConfig.dataPoints=[].concat((0,toConsumableArray/* default */.Z)(this.analyticsConfig.dataPoints.filter((function(dp,idx){return 2===dp.type||configIndexes.includes(idx)}))),(0,toConsumableArray/* default */.Z)(changedDataPoints.filter((function(cdp,idx){return!alreadyAddedIndexes.includes(idx)})))))}else this.analyticsConfig.dataPoints=changedDataPoints;this.addPredictionFields(this.analyticsConfig),this.showDataPointSelector=!1},showChartCustomizationDialog:function(defaultTab){this.showChartCustomization=!0,defaultTab&&(this.chartCustomizationActiveTab=defaultTab)},hideChartCustomizationDialog:function(){this.showChartCustomization=!1},setSelectedBuildings:function(_ref){var name=_ref.name,ids=_ref.ids;this.selectedBuildingTitle=name,this.selectedBuildings=ids,this.reportObject&&this.reportObject.options&&this.reportObject.options.common&&(this.reportObject.options.common.buildingIds=this.selectedBuildings)},onPeriodChange:function(){this.analyticsConfig.dataPoints.length||(20===this.analyticsConfig.period?this.analyticsConfig.dateFilter=NewDateHelper/* default */.Z.getDatePickerObject(31):12===this.analyticsConfig.period?this.analyticsConfig.dateFilter=NewDateHelper/* default */.Z.getDatePickerObject(28):10===this.analyticsConfig.period?this.analyticsConfig.dateFilter=NewDateHelper/* default */.Z.getDatePickerObject(44):this.analyticsConfig.dateFilter=NewDateHelper/* default */.Z.getDatePickerObject(22))},onModeChange:function(){1!==this.analyticsConfig.mode&&(this.analyticsConfig.dataPoints=this.analyticsConfig.dataPoints.filter((function(dp){return 2!==dp.type})))},onBaseLineChange:function(newBaseLine){var _this5=this;if(!this.oldBaseLine||this.oldBaseLine[0]!==newBaseLine[0]){if(this.oldBaseLine&&-1!==this.oldBaseLine[0]){var oldBlName=this.baseLineList.find((function(bl){return bl.id===_this5.oldBaseLine[0]})).name,dp=this.reportObject.options.dataPoints.find((function(dp){return dp.baseLineName===oldBlName}));if(!this.checkAndDeletePointsRel(this.reportObject.options,dp.alias))return this.$message.error(dp.baseLineName+" has been used in derivation(s). Please delete the derivations before removing this baseline"),void this.$set(this.analyticsConfig,"baseLine",this.oldBaseLine)}this.oldBaseLine=(0,toConsumableArray/* default */.Z)(newBaseLine),this.$set(this.analyticsConfig,"baseLine",newBaseLine)}}}},newTools_BuildingAnalysisvue_type_script_lang_js=BuildingAnalysisvue_type_script_lang_js,BuildingAnalysis_component=(0,componentNormalizer/* default */.Z)(newTools_BuildingAnalysisvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,BuildingAnalysis=BuildingAnalysis_component.exports},
/***/587758:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"5ee9b0f49c6e73cc51f35d51be8bad36.svg";
/***/}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/93488.js.map