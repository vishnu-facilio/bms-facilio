(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[23472],{
/***/574752:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return Avatar}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/Avatar.vue?vue&type=template&id=7f0d5689
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.user||_vm.name?_c("div",{staticClass:"fc-avatar-inline"},[_vm.avatarUrl?_c("img",{staticClass:"fc-avatar",class:_vm.sizeClass,attrs:{src:_vm.avatarUrl,alt:"Profile Avatar"}}):_c("div",{staticClass:"fc-avatar",class:_vm.sizeClass,style:_vm.bgColor},[_vm._v(" "+_vm._s(_vm.trimmedName)+" ")])]):_vm._e()},staticRenderFns=[],objectSpread2=__webpack_require__(595082),vuex_esm=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(434284),__webpack_require__(564043),__webpack_require__(709873),__webpack_require__(228436),__webpack_require__(450886),__webpack_require__(677049),__webpack_require__(821694),__webpack_require__(420629)),Avatarvue_type_script_lang_js={props:{size:{type:String},user:{type:Object},avatarStyle:{type:Object},color:{type:String},name:{type:Boolean}},data:function(){return{sizeClass:"fc-avatar-"+this.size,fullName:"",trimmedName:null,avatarUrl:null,bgColor:"background-color: "+(this.color?this.color:this.getRandomBgColor())}},computed:(0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({users:function(state){return state.users}})),mounted:function(){var _this=this;if(this.user){var userName="";if(this.user.avatarUrl)this.avatarUrl=this.user.avatarUrl;else if(this.user.id){var userObj=this.users.find((function(user){return user.id===_this.user.id}));userObj&&userObj.avatarUrl&&(this.avatarUrl=userObj.avatarUrl),userObj&&userObj.name&&(userName=userObj.name)}userName=userName||this.user.name,userName&&(this.fullName=userName,this.trimmedName=this.getAvatarName(userName),this.bgColor="background-color: "+(this.color?this.color:this.getRandomBgColor()))}else this.name&&(this.trimmedName=this.getAvatarName(this.name),this.bgColor="background-color: "+(this.color?this.color:this.getRandomBgColor()))},watch:{user:function(){var _this2=this;if(this.user.avatarUrl)this.avatarUrl=this.user.avatarUrl;else if(this.user.id){var userObj=this.users.find((function(user){return user.id===_this2.user.id}));userObj&&userObj.avatarUrl?this.avatarUrl=userObj.avatarUrl:this.avatarUrl=null}else this.avatarUrl=null;this.user.name&&(this.fullName=this.user.name,this.trimmedName=this.getAvatarName(this.user.name),this.bgColor="background-color: "+(this.color?this.color:this.getRandomBgColor()))},"user.name":function(){this.user.name&&(this.fullName=this.user.name,this.trimmedName=this.getAvatarName(this.user.name),this.bgColor="background-color: "+(this.color?this.color:this.getRandomBgColor()))},"user.avatarUrl":function(){this.user.avatarUrl?this.avatarUrl=this.user.avatarUrl:this.avatarUrl=null},"user.id":function(){var _this3=this;if(this.user.id){var userObj=this.users.find((function(user){return user.id===_this3.user.id}));userObj&&userObj.avatarUrl?this.avatarUrl=userObj.avatarUrl:this.avatarUrl=null}else this.avatarUrl=null}},methods:{getAvatarName:function(name){for(var parts=name.split(/[ -]/),initials="",initialLen=2,count=0,i=0;i<parts.length;i++)if(""!==parts[i].trim()&&(initials+=parts[i].charAt(0),count++,count>=initialLen))break;initials.length<initialLen&&name.length>=initialLen&&(initials=name.trim().substring(0,initialLen));var avatarName=initials.toUpperCase();return avatarName},getRandomBgColor:function(){var colors=["#FFBA51","#34BFA3","#FF2F82","#29D9A7","#ECDC74","#927FED","#FF61A8","#fbf383","#ac4352","#6db1f4"],userKey=this.user.email?this.user.email:this.user.name,userUniqueNum=Array.from(userKey).map((function(letter){return letter.charCodeAt(0)})).reduce((function(current,previous){return previous+current})),colorIndex=userUniqueNum%colors.length,color=colors[colorIndex];return color}}},components_Avatarvue_type_script_lang_js=Avatarvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_Avatarvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,Avatar=component.exports},
/***/613071:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FSchedule2}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/FSchedule2.vue?vue&type=template&id=a6cf229e
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-row",{attrs:{gutter:80,align:"middle"}},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.simple?"Frequency":"Repetition")+" ")]),_c("el-select",{staticStyle:{width:"100%"},model:{value:_vm.schedule.frequencyType,callback:function($$v){_vm.$set(_vm.schedule,"frequencyType",$$v)},expression:"schedule.frequencyType"}},_vm._l(_vm.frequencyTypes,(function(ftype,index){return _c("el-option",{key:index,attrs:{label:ftype.label,value:ftype.value}})})),1)],1),-1===_vm.schedule.frequencyType?_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"fc-input-label-txt mT8"},[_vm._v("Frequency")]),_c("el-cascader",{staticClass:"fcascader mT10",staticStyle:{width:"100%"},attrs:{options:_vm.generateFrequencyList()},model:{value:_vm.schedule.frequency,callback:function($$v){_vm.$set(_vm.schedule,"frequency",$$v)},expression:"schedule.frequency"}}),"day"!==_vm.schedule.frequency[0]?_c("div",{staticClass:"fc-input-label-txt"},[_vm._v(" Choose reminder time ")]):_vm._e(),"week"===_vm.schedule.frequency[0]?_c("div",[_c("el-select",{attrs:{multiple:""},model:{value:_vm.schedule.executeOnDays,callback:function($$v){_vm.$set(_vm.schedule,"executeOnDays",$$v)},expression:"schedule.executeOnDays"}},_vm._l(_vm.days,(function(day){return _c("el-option",{key:day,attrs:{label:day,value:day}})})),1)],1):_vm._e(),"month"===_vm.schedule.frequency[0]?_c("div",[_c("el-select",{model:{value:_vm.schedule.executeOnType,callback:function($$v){_vm.$set(_vm.schedule,"executeOnType",$$v)},expression:"schedule.executeOnType"}},[_c("el-option",{attrs:{label:"Day",value:"day"}}),_c("el-option",{attrs:{label:"Week",value:"week"}})],1),"day"===_vm.schedule.executeOnType?_c("el-select",{attrs:{multiple:""},model:{value:_vm.schedule.executeOnDates,callback:function($$v){_vm.$set(_vm.schedule,"executeOnDates",$$v)},expression:"schedule.executeOnDates"}},_vm._l(_vm.getNumberRange(31),(function(date){return _c("el-option",{key:date.value,attrs:{label:date.label,value:date.value}})})),1):_vm._e(),"week"===_vm.schedule.executeOnType?_c("el-cascader",{attrs:{options:_vm.getWeekList()},model:{value:_vm.schedule.executeOnWeek,callback:function($$v){_vm.$set(_vm.schedule,"executeOnWeek",$$v)},expression:"schedule.executeOnWeek"}},[_vm._v(" > ")]):_vm._e()],1):"year"===_vm.schedule.frequency[0]?_c("div",[_c("el-select",{attrs:{multiple:""},model:{value:_vm.schedule.executeOnMonth,callback:function($$v){_vm.$set(_vm.schedule,"executeOnMonth",$$v)},expression:"schedule.executeOnMonth"}},_vm._l(_vm.months,(function(month){return _c("el-option",{key:month,attrs:{label:month,value:month}})})),1)],1):_vm._e()],1):_vm._e()],1)},staticRenderFns=[],createForOfIteratorHelper=__webpack_require__(566347),moment=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(670560),__webpack_require__(450886),__webpack_require__(76265),__webpack_require__(730381)),moment_default=__webpack_require__.n(moment),FSchedule2vue_type_script_lang_js={props:["from","value","initialSchedule","simple"],data:function(){return{frequencyTypes:[],scheduleInfo:{times:["23:59"],frequencyType:3,values:[13]},schedule:{frequencyType:0,frequency:["day",1],executeOnDays:[],executeOnType:"day",executeOnDates:[],executeOnWeek:[],executeOnMonth:[]},days:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],weeks:["First","Second","Third","Fourth","Last"],months:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}},computed:{startTime:function(){return this.from?this.from:new Date}},mounted:function(){var self=this;this.loadScheduleInfo(),this.setInitialValue(),this.$watch("schedule",(function(newVal){var _this=this;self.$emit("input",this.constructScheduleObj(this.schedule)),self.$emit("input2",this.frequencyTypes.find((function(rt){return rt.value===_this.schedule.frequencyType})))}),{deep:!0})},methods:{getDayIndex:function(dayName){if(!dayName){var date=moment_default()(this.startTime);dayName=date.format("ddd")}var dayIndex=this.days.indexOf(dayName);return dayIndex+1},getMonthIndex:function(monthName){if(!monthName){var date=moment_default()(this.startTime);monthName=date.format("MMM")}var monthIndex=this.months.indexOf(monthName);return monthIndex+1},getWeekName:function(weekIndex){if(!weekIndex){var date=moment_default()(this.startTime);weekIndex=Math.ceil(date.date()/7)}var weekName=this.weeks[weekIndex-1];return weekName||(weekName=this.weeks[this.weeks.length-1]),weekName},getWeekIndex:function(weekName){if(!weekName){var date=moment_default()(this.startTime);return Math.ceil(date.date()/7)}var weekIndex=this.weeks.indexOf(weekName);return weekIndex+1},loadScheduleInfo:function(){var date=moment_default()(this.startTime);this.frequencyTypes=[],this.simple?this.schedule.frequencyType=1:this.frequencyTypes.push({label:"Do not repeat",value:0}),this.frequencyTypes.push({label:"Daily",value:1});var dayName=date.format("dddd");this.frequencyTypes.push({label:"Weekly (every "+dayName+")",value:2}),this.frequencyTypes.push({label:"Monthly (on day "+date.format("DD")+")",value:3});var dayShortName=date.format("ddd"),weekOfMonthStr=this.getWeekName();this.simple||this.frequencyTypes.push({label:"Monthly (every "+weekOfMonthStr+" "+dayShortName+")",value:4}),this.frequencyTypes.push({label:"Yearly (on "+date.format("DD MMMM")+")",value:5}),this.simple||this.frequencyTypes.push({label:"Custom",value:-1}),this.schedule.executeOnDays.length||this.schedule.executeOnDays.push(dayShortName),this.schedule.executeOnDates.length||this.schedule.executeOnDates.push(parseInt(date.format("DD"))),this.schedule.executeOnWeek.length||(this.schedule.executeOnWeek.push(weekOfMonthStr),this.schedule.executeOnWeek.push("Whole_Week")),this.schedule.executeOnMonth.length||this.schedule.executeOnMonth.push(date.format("MMM"))},constructScheduleObj:function(scheduleObj){var date=moment_default()(this.startTime),newSchedule={frequencyType:0,frequency:1,values:[],times:[]};if(newSchedule.times.push(date.format("HH:mm")),scheduleObj.frequencyType>=0){if(newSchedule.frequencyType=scheduleObj.frequencyType,2===newSchedule.frequencyType){var dayIndex=this.getDayIndex();newSchedule.values.push(dayIndex)}else if(3===newSchedule.frequencyType){var dateNo=date.format("DD");newSchedule.values.push(parseInt(dateNo))}else if(4===newSchedule.frequencyType){var weekOfMonth=Math.ceil(date.date()/7);newSchedule.weekFrequency=weekOfMonth;var _dayIndex=this.getDayIndex();newSchedule.values.push(_dayIndex)}else if(5===newSchedule.frequencyType){var monthIndex=this.getMonthIndex();newSchedule.values.push(monthIndex)}}else{
// custom scheduling
if("day"===scheduleObj.frequency[0])newSchedule.frequencyType=1;else if("week"===scheduleObj.frequency[0]){newSchedule.frequencyType=2,newSchedule.values=[];var _step,_iterator=(0,createForOfIteratorHelper/* default */.Z)(scheduleObj.executeOnDays);try{for(_iterator.s();!(_step=_iterator.n()).done;){var dayName=_step.value;newSchedule.values.push(this.getDayIndex(dayName))}}catch(err){_iterator.e(err)}finally{_iterator.f()}}else if("month"===scheduleObj.frequency[0])if("day"===scheduleObj.executeOnType)newSchedule.frequencyType=3,newSchedule.values=scheduleObj.executeOnDates;else{newSchedule.frequencyType=4,newSchedule.weekFrequency=this.getWeekIndex(scheduleObj.executeOnWeek[0]),newSchedule.values=[];var weekValue=scheduleObj.executeOnWeek[1];if("Whole_Week"===weekValue)newSchedule.values=[1,2,3,4,5,6,7];else if("Mon_Fri"===weekValue)newSchedule.values=[1,2,3,4,5];else if("Weekend"===weekValue)newSchedule.values=[6,7];else{var _dayIndex2=this.getDayIndex(weekValue);_dayIndex2>0&&(newSchedule.values=[_dayIndex2])}}else if("year"===scheduleObj.frequency[0]){newSchedule.frequencyType=5,newSchedule.values=[];var _step2,_iterator2=(0,createForOfIteratorHelper/* default */.Z)(scheduleObj.executeOnMonth);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var monthName=_step2.value;newSchedule.values.push(this.getMonthIndex(monthName))}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}newSchedule.frequency=scheduleObj.frequency[1]}return newSchedule},generateFrequencyList:function(){var newObj=[{value:"day",label:"Day",children:this.generateFrequencyTimes("day",50)},{value:"week",label:"Week",children:this.generateFrequencyTimes("week",50)},{value:"month",label:"Month",children:this.generateFrequencyTimes("month",50)},{value:"year",label:"Year",children:this.generateFrequencyTimes("year",50)}];return newObj},generateFrequencyTimes:function(type,no){for(var list=[],i=0;i<no;i++)0===i?list.push({label:"Every "+type,value:1}):list.push({label:"Every "+(i+1)+" "+type+"s",value:i+1});return list},getWeekList:function(){var options=[{label:"First",value:"First",children:this.getWeekDays()},{label:"Second",value:"Second",children:this.getWeekDays()},{label:"Third",value:"Third",children:this.getWeekDays()},{label:"Fourth",value:"Fourth",children:this.getWeekDays()},{label:"Last",value:"Last",children:this.getWeekDays()}];return options},getNumberRange:function(no){for(var list=[],i=1;i<=no;i++)list.push({label:i+"",value:i});return list},getWeekDays:function(){var list=[{label:"Whole week",value:"Whole_Week"},{label:"Mon",value:"Mon"},{label:"Tue",value:"Tue"},{label:"Wed",value:"Wed"},{label:"Thu",value:"Thu"},{label:"Fri",value:"Fri"},{label:"Sat",value:"Sat"},{label:"Sun",value:"Sun"},{label:"Mon - Fri",value:"Mon_Fri"},{label:"Weekend",value:"Weekend"}];return list},setInitialValue:function(){var _this2=this;if(this.initialSchedule)if(this.initialSchedule.frequency>1){var val="day";if(2===this.initialSchedule.frequencyType)val="week",this.schedule.executeOnDays=this.initialSchedule.values.map((function(day){return _this2.days[day-1]}));else if(3===this.initialSchedule.frequencyType)this.schedule.executeOnType="day",this.schedule.executeOnDates=this.initialSchedule.values,val="month";else if(4===this.initialSchedule.frequencyType){var value;this.schedule.executeOnType="week",this.schedule.executeOnWeek[0]=this.getWeekName(this.initialSchedule.weekFrequency);var length=this.initialSchedule.values.length;value=7===length?"Whole_Week":5===length?"Mon_Fri":2===length?"Weekend":this.days[this.initialSchedule.values[0]-1],this.schedule.executeOnWeek[1]=value,val="month"}else 5===this.initialSchedule.frequencyType&&(this.schedule.executeOnMonth=this.initialSchedule.values.map((function(month){return _this2.months[month-1]})),val="year");this.schedule.frequency=[val,this.initialSchedule.frequency],this.schedule.frequencyType=-1}else this.schedule.frequencyType=this.initialSchedule.frequencyType;else this.$emit("input",this.constructScheduleObj(this.schedule)),this.$emit("input2",this.frequencyTypes.find((function(rt){return rt.value===_this2.schedule.frequencyType})))}},watch:{startTime:function(){var _this3=this;this.loadScheduleInfo(),this.$emit("input",this.constructScheduleObj(this.schedule)),this.$emit("input2",this.frequencyTypes.find((function(rt){return rt.value===_this3.schedule.frequencyType})))},initialSchedule:function(){this.setInitialValue()}}},components_FSchedule2vue_type_script_lang_js=FSchedule2vue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FSchedule2vue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FSchedule2=component.exports},
/***/426803:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return User}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/avatar/User.vue?vue&type=template&id=c662fbbc
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.userObj?_c("div",{staticClass:"inline"},[_c("div",{staticClass:"fc-avatar-element q-item-division relative-position"},[_c("div",{staticClass:"q-item-side-left q-item-section"},[_vm.showPopover&&-1!==_vm.userObj.id?_c("avatarPopover",{attrs:{user:_vm.userObj,moduleName:_vm.moduleName}},[_c("span",{attrs:{slot:"reference"},slot:"reference"},[_c("avatar",{attrs:{size:_vm.size,user:_vm.userObj,color:_vm.color}})],1)]):_c("span",[_c("avatar",{attrs:{size:_vm.size,user:_vm.userObj,color:_vm.color}})],1)],1),_vm.showLabel?[_vm.user&&_vm.user.id>0||_vm.group&&_vm.group.id>0?_c("div",{staticClass:"wo-team-txt"},[_c("div",{staticClass:"assignment-avatar-name",class:{"color-d":!_vm.user}},[_vm._v(" "+_vm._s(_vm.user&&_vm.user.id>0?_vm.user.name||(_vm.users.find((function(usr){return usr.id===_vm.user.id}))||{}).name:"---")+" ")]),_c("div",{staticClass:"assignment-group-name",class:{"color-d":!_vm.group}},[_vm._v(" "+_vm._s(_vm.group?_vm.group.name||(_vm.$store.getters.getGroup(_vm.group.id)||{}).name:"---")+" ")])]):_c("div",{staticClass:"wo-team-txt",staticStyle:{"padding-top":"7px","font-size":"14px",color:"#aaa","letter-spacing":"0.2px"}},[_vm._v(" ---/--- ")])]:0!=_vm.name?_c("div",[_c("div",[_c("span",{staticClass:"q-item-label d-flex flex-wrap"},[_vm._v(_vm._s(_vm.userObj.name))])])]):_vm._e()],2)]):_vm._e()},staticRenderFns=[],objectSpread2=__webpack_require__(595082),Avatar=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(574752)),AvatarPopovervue_type_template_id_8ef9b9ec_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"avatar-popover-container"},[_c("el-popover",{ref:"popover1",staticStyle:{display:"block",padding:"0"},attrs:{placement:"top-start",trigger:"hover",width:"383",clas:"avatar-popover","popper-class":"avatar-popover",height:_vm.defaultheight,"open-delay":600},model:{value:_vm.popoverShown,callback:function($$v){_vm.popoverShown=$$v},expression:"popoverShown"}},[_c("div",{staticClass:"popover-content-block"},[_c("div",{staticClass:"popover-avatar"},[_c("avatar",{attrs:{size:_vm.size,user:_vm.user,color:_vm.color,showPopover:!1}})],1),_c("div",{staticClass:"popover-avatar-det"},[_c("div",{staticClass:"avatar-name-txt"},[_vm._v(" "+_vm._s(_vm.user.name?_vm.user.name:"----")+" ")]),_c("div",{staticClass:"mail-block"},[_c("img",{staticClass:"envelope-icon",staticStyle:{height:"13px","vertical-align":"middle"},attrs:{src:__webpack_require__(702638)}}),_c("span",{staticClass:"mail-txt"},[_vm._v(_vm._s(_vm.user.email?_vm.user.email:"----")+" ")])]),_c("div",[_c("img",{staticClass:"envelope-icon",staticStyle:{height:"15px"},attrs:{src:__webpack_require__(47424)}}),_c("span",{staticClass:"popover-phone-number"},[_vm._v(" "+_vm._s(_vm.user.mobile?_vm.user.mobile:"----")+" ")])])]),"workorder"===_vm.moduleName?_c("div",{staticClass:"popover-footer"},[_c("ul",[_c("li",{staticClass:"popover-footer-list",on:{click:function($event){return _vm.getOpen("open")}}},[_c("div",{staticClass:"open-result-txt"},[_vm._v(" "+_vm._s(_vm.result.openWorkOrdersCount)+" ")]),_c("div",{staticClass:"result-txt-black"},[_vm._v("OPEN")])]),_c("li",{staticClass:"popover-footer-list border-RL",on:{click:function($event){return _vm.getOpen("overdue")}}},[_c("div",{staticClass:"overdue-result-txt"},[_vm._v(" "+_vm._s(_vm.result.overDueWorkOrdersCount)+" ")]),_c("div",{staticClass:"result-txt-black"},[_vm._v("OVERDUE")])]),_c("li",{staticClass:"popover-footer-list",on:{click:function($event){return _vm.getOpen("duetoday")}}},[_c("div",{staticClass:"dueday-result-txt"},[_vm._v(" "+_vm._s(_vm.result.dueTodayWorkOrdersCount)+" ")]),_c("div",{staticClass:"result-txt-black"},[_vm._v("DUE TODAY")])])])]):_vm._e()]),_c("template",{slot:"reference"},[_vm._t("reference")],2)],2)],1)},AvatarPopovervue_type_template_id_8ef9b9ec_staticRenderFns=[],AvatarPopovervue_type_script_lang_js=(__webpack_require__(670560),__webpack_require__(648324),{props:["size","user","color","name","moduleName"],data:function(){return{defaultheight:"230px",result:{},popoverShown:!1,viewname:""}},components:{Avatar:Avatar["default"]},mounted:function(){
// this.showPopover = this.showpopoverFooter
this.moduleName&&(this.defaultheight="160px")},watch:{popoverShown:function(val){val&&this.userOpenDatas()}},methods:{userOpenDatas:function(){var self=this;self.$http.post("/widget/getUserCardData",{ouid:this.user.id}).then((function(response){200===response.status&&(self.result=response.data.result)}))},getOpen:function(viewName){var filter={assignedTo:{operator:"is",value:[this.user.id+""]}};this.$router.push("/app/wo/orders/"+viewName+"?search="+encodeURIComponent(JSON.stringify(filter)))}}}),components_AvatarPopovervue_type_script_lang_js=AvatarPopovervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_AvatarPopovervue_type_script_lang_js,AvatarPopovervue_type_template_id_8ef9b9ec_render,AvatarPopovervue_type_template_id_8ef9b9ec_staticRenderFns,!1,null,null,null)
/* harmony default export */,AvatarPopover=component.exports,vuex_esm=__webpack_require__(420629),Uservue_type_script_lang_js={created:function(){this.$store.dispatch("loadGroups")},components:{Avatar:Avatar["default"],AvatarPopover:AvatarPopover},props:{size:{type:String},user:{type:Object},avatarStyle:{type:Object},name:{type:Boolean,default:function(){return!0}},showLabel:{type:Boolean},showPopover:{type:Boolean},moduleName:{type:String},group:{type:Object},hovercard:{type:Boolean}},data:function(){return{hoverCardId:"userHoverCardId-"+(this.user?this.user.id:"unkown"),loadHoverCardData:!1,labelStatus:this.hideLabel}},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({users:function(state){return state.users}})),{},{userObj:function(){var _this=this,hasUser=this.user&&this.user.id>0,user=hasUser?this.$getProperty(this.user,"name")?this.user:this.users.find((function(usr){return usr.id===_this.user.id})):null;return user||{id:-1,name:"Unknown"}},color:function(){return-1!==this.userObj.id?"":this.group?"#c3c3c3":"#e3e3e3"}}),methods:{loadHoverCard:function(){this.loadHoverCardData=!0},hideHoverCard:function(){this.loadHoverCardData=!1}}},avatar_Uservue_type_script_lang_js=Uservue_type_script_lang_js,User_component=(0,componentNormalizer/* default */.Z)(avatar_Uservue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,User=User_component.exports},
/***/343089:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return NewScheduleView}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/report/forms/NewScheduleView.vue?vue&type=template&id=ef17ce48
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{attrs:{id:"schedule-form",visible:!0,fullscreen:!0,"custom-class":"fc-dialog-form fc-dialog-right setup-dialog40 setup-dialog scheduled-view-container views-manager-container-v2",width:"40%","append-to-body":!0},on:{close:_vm.close}},[_c("div",{staticClass:"new-header-container"},[_c("div",{staticClass:"new-header-text"},[_c("div",{staticClass:"fc-setup-modal-title"},[_vm._v(" "+_vm._s(_vm.isEdit?"Edit Schedule View":"Schedule This View")+" ")])])]),_c("div",{staticClass:"new-body-modal"},[_vm.showViews?_c("div",{staticClass:"fc-modal-sub-title"},[_vm._v(" "+_vm._s(_vm.$t("viewsmanager.schedules.view"))+" ")]):_vm._e(),_c("el-form",{ref:"view-form",attrs:{rules:_vm.viewRules,model:_vm.selectedView}},[_c("el-form-item",{attrs:{prop:"id"}},[_vm.showViews?_c("el-select",{staticClass:"filter-form fc-tag pT15",staticStyle:{width:"280px",overflow:"scroll"},attrs:{filterable:"","default-first-option":"",loading:_vm.viewLoading},on:{change:_vm.setSelectedView},model:{value:_vm.selectedView.id,callback:function($$v){_vm.$set(_vm.selectedView,"id",$$v)},expression:"selectedView.id"}},_vm._l(_vm.views,(function(view){return _c("el-option",{key:view.id,attrs:{label:view.displayName,value:view.id}})})),1):_vm._e()],1)],1),_c("div",{staticClass:"fc-modal-sub-title pT15"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.schedule"))+" ")]),_c("el-date-picker",{staticClass:"form-item pT15 fc-input-full-border2 fc-date-picker-icon-align",staticStyle:{width:"56%"},attrs:{"popper-class":"views-manager-container-v2","float-label":"Start Date",type:"datetime"},model:{value:_vm.scheduleForm.startTime,callback:function($$v){_vm.$set(_vm.scheduleForm,"startTime",$$v)},expression:"scheduleForm.startTime"}}),_c("f-schedule",{staticClass:"pT15",staticStyle:{width:"71%","margin-bottom":"20px"},attrs:{from:_vm.scheduleForm.startTime,initialSchedule:_vm.initialSchedule,simple:"true"},on:{input2:_vm.getfreq},model:{value:_vm.scheduleForm.schedule,callback:function($$v){_vm.$set(_vm.scheduleForm,"schedule",$$v)},expression:"scheduleForm.schedule"}}),_c("div",{staticClass:"fc-input-label-txt"},[_vm._v(_vm._s(_vm.$t("common.wo_report.ends")))]),_c("div",[_c("div",[_c("el-radio",{staticClass:"fc-radio-btn pT15",attrs:{color:"secondary",label:"never"},model:{value:_vm.endType,callback:function($$v){_vm.endType=$$v},expression:"endType"}},[_vm._v(_vm._s(_vm.$t("common.wo_report.never")))])],1),_c("div",{staticClass:"row"},[_c("el-radio",{staticClass:"fc-radio-btn pT15",attrs:{color:"secondary",label:"after"},model:{value:_vm.endType,callback:function($$v){_vm.endType=$$v},expression:"endType"}},[_vm._v(_vm._s(_vm.$t("common.wo_report.after")))]),_c("div",{directives:[{name:"show",rawName:"v-show",value:"after"===_vm.endType,expression:"endType === 'after'"}]},[_c("el-input",{staticStyle:{width:"180px","margin-left":"20px"},attrs:{placeholder:"",type:"number",min:"1"},model:{value:_vm.maxCount,callback:function($$v){_vm.maxCount=$$v},expression:"maxCount"}}),_c("span",{staticStyle:{"margin-left":"10px"}},[_vm._v(_vm._s(_vm.$t("common.wo_report.times")))])],1)],1),_c("div",{staticClass:"row"},[_c("el-radio",{staticClass:"fc-radio-btn pT15 ",attrs:{color:"secondary",label:"on"},model:{value:_vm.endType,callback:function($$v){_vm.endType=$$v},expression:"endType"}},[_vm._v(_vm._s(_vm.$t("common.wo_report.on")))]),_c("div",{directives:[{name:"show",rawName:"v-show",value:"on"===_vm.endType,expression:"endType === 'on'"}],staticClass:"row"},[_c("el-date-picker",{staticStyle:{width:"180px","margin-left":"30px","vertical-align":"text-bottom"},attrs:{type:"datetime",placeholder:"dd/mm/yy"},model:{value:_vm.endTime,callback:function($$v){_vm.endTime=$$v},expression:"endTime"}})],1)],1)]),_c("div",{staticClass:"pT20 fc-modal-sub-title",staticStyle:{"padding-bottom":"15px"}},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.email_this_view"))+" ")]),_c("el-form",{ref:"schedule-form",attrs:{rules:_vm.mailJsonRule,model:_vm.mailJson}},[_c("el-form-item",{attrs:{label:_vm.$t("common.wo_report.to"),prop:"to"}},[_c("el-select",{staticClass:"filter-form fc-input-full-border-select2 width100 fc-tag widht100",staticStyle:{overflow:"scroll"},attrs:{multiple:"",filterable:"","default-first-option":"","popper-class":"views-manager-container-v2"},model:{value:_vm.mailJson.to,callback:function($$v){_vm.$set(_vm.mailJson,"to",$$v)},expression:"mailJson.to"}},_vm._l(_vm.users,(function(user){return _c("el-option",{key:user.id,attrs:{label:user.name,value:parseInt(user.id)}},[_vm._v(_vm._s(user.name+" ("+user.email+")"))])})),1)],1),_c("el-form-item",{attrs:{label:_vm.$t("common.wo_report.report_subject"),prop:"subject"}},[[_c("el-input",{attrs:{type:"text"},on:{change:function($event){_vm.messageChanged=!0}},model:{value:_vm.mailJson.subject,callback:function($$v){_vm.$set(_vm.mailJson,"subject",$$v)},expression:"mailJson.subject"}})]],2),_c("el-form-item",{attrs:{label:_vm.$t("common.wo_report.report_description")}},[[_c("el-input",{staticClass:"fc-input-full-border-select2 width100",attrs:{type:"textarea",autosize:{minRows:6,maxRows:6},resize:"none"},on:{change:function($event){_vm.messageChanged=!0}},model:{value:_vm.mailJson.message,callback:function($$v){_vm.$set(_vm.mailJson,"message",$$v)},expression:"mailJson.message"}})]],2)],1)],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("button",{staticClass:"modal-btn-cancel",attrs:{type:"button"},on:{click:_vm.close}},[_c("span",[_vm._v(_vm._s(_vm.$t("common._common.cancel")))])]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"button",disabled:_vm.disableSave,loading:_vm.disableSave},on:{click:_vm.save}},[_c("span",[_vm._v(_vm._s(_vm.$t("common.wo_report.schedule")))])])],1)])},staticRenderFns=[],objectSpread2=__webpack_require__(595082),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),FSchedule2=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(434284),__webpack_require__(613071)),api=__webpack_require__(32284),validation=__webpack_require__(990260),NewScheduleViewvue_type_script_lang_js={props:["viewName","viewId","report","isEdit","model","visibility","viewDisplayName","moduleName","showViews","exportFromView"],data:function(){return{users:[],scheduleForm:{startTime:new Date,schedule:null},initialSchedule:null,format:2,frequencyObj:null,mailJson:{to:[],subject:"",message:""},endType:"never",endTime:null,maxCount:null,messageChanged:!1,viewIds:"",viewLoading:!1,views:[],selectedView:{name:"",displayName:"",id:null},disableSave:!1,mailJsonRule:{to:[{required:!0,message:this.$t("viewsmanager.schedules.select_user"),trigger:"change"}],subject:[{required:!0,message:this.$t("viewsmanager.schedules.subject_empty"),trigger:"blur"}]},viewRules:{id:[{required:!0,message:this.$t("viewsmanager.schedules.select_view"),trigger:"change"}]}}},components:{FSchedule:FSchedule2/* default */.Z},created:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.next=2,_this.loadUsers();case 2:(_this.isEdit||_this.exportFromView)&&(_this.selectedView={name:_this.viewName,displayName:_this.viewDisplayName,id:_this.viewId});case 3:case"end":return _context.stop()}}),_callee)})))()},mounted:function(){var showViews=this.showViews;!(0,validation/* isEmpty */.xb)(showViews)&&showViews?this.loadViews():(this.init(),this.checkList())},computed:{currentModuleName:function(){var moduleName=this.moduleName;return(0,validation/* isEmpty */.xb)(moduleName)?this.route.meta.module:moduleName}},watch:{viewId:function(val){this.viewIds=val}},methods:{loadUsers:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var _yield$API$get,data,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,api/* API */.bl.get("/users");case 2:_yield$API$get=_context2.sent,data=_yield$API$get.data,error=_yield$API$get.error,error||(_this2.users=(null===data||void 0===data?void 0:data.users)||[]);case 6:case"end":return _context2.stop()}}),_callee2)})))()},setSelectedView:function(viewId){var views=this.views,viewObj=views.find((function(view){return view.id===viewId}));(0,validation/* isEmpty */.xb)(viewObj)||(this.selectedView=(0,objectSpread2/* default */.Z)({},viewObj),this.setInitialMessage(this.frequencyObj,!0))},loadViews:function(){var _this3=this;this.viewLoading=!0;var currentModuleName=this.currentModuleName;api/* API */.bl.get("/view?moduleName="+currentModuleName).then((function(_ref){var data=_ref.data,error=_ref.error;if(error)_this3.$message.error(error.message||"Error occured");else if(!(0,validation/* isEmpty */.xb)(data)){var _ref2=data||{},views=_ref2.views;_this3.views=views,_this3.init(),_this3.checkList()}})).finally((function(){_this3.viewLoading=!1}))},init:function(){this.isEdit&&this.model?(this.model.scheduleForm.schedule.timeObjects=null,this.scheduleForm.startTime=this.model.scheduleForm.startTime,this.scheduleForm.schedule=this.model.scheduleForm.schedule,this.initialSchedule=this.model.scheduleForm.schedule,this.format=this.model.format,this.mailJson=this.model.mailJson,this.mailJson.to=this.model.mailJson.to,this.model.endTime&&(this.endTime=this.model.endTime),this.model.maxCount&&(this.maxCount=this.model.maxCount),this.model.viewName&&(this.selectedView.name=this.model.viewName),this.maxCount>0?this.endType="after":this.endType=this.endTime>0?"on":"never"):(this.scheduleForm.startTime=new Date,this.setInitialMessage(this.frequencyObj,!1))},checkList:function(){var url,currentModuleName=this.currentModuleName;url="/view/woScheduleViewList",this.$http.post(url,{moduleName:currentModuleName})},setInitialMessage:function(data,messageChange){var _ref3=this||[],selectedView=_ref3.selectedView,_ref4=selectedView||{},displayName=_ref4.displayName;(!this.messageChanged&&this.report||messageChange)&&(this.mailJson.message="Here are the "+displayName+("workorder"===this.currentModuleName?" tasks and work orders scheduled for the day by ":"assets scheduled for the day by ")+this.$account.user.name+"\nView name : "+displayName+"\nFrequency: "+(data?data.label:"")+"\n\nYou could view the details here \n"+window.location.href+"\n\nRegards, \nTeam "+this.$getProperty(window.brandConfig,"name","Facilio"),this.mailJson.subject=displayName+this.$t("common.wo_report.view_schedule_at")+" "+this.$options.filters.formatDate(this.$helpers.getTimeInOrg(this.scheduleForm.startTime)))},getfreq:function(data){var _ref5=this||[],selectedView=_ref5.selectedView,_ref6=selectedView||{},displayName=_ref6.displayName,name=_ref6.name;return this.frequencyObj=data,this.mailJson.message="Here are the "+name+("workorder"===this.currentModuleName?" tasks and work orders scheduled for the day by ":" assets scheduled for the day by ")+this.$account.user.name+"\nView name : "+displayName+"\nFrequency: "+(data?data.label:"")+"\nYou could view the details here \n"+window.location.href+"\nRegards, \nTeam "+this.$getProperty(window.brandConfig,"name","Facilio"),this.mailJson.subject=displayName+this.$t("common.wo_report.view_schedule_at")+this.scheduleForm.startTime,data},validate:function(){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var showViews,viewValidation,scheduleValidation;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return showViews=_this4.showViews,viewValidation=!0,scheduleValidation=!0,_context3.prev=2,_context3.next=5,_this4.$refs["schedule-form"].validate();case 5:scheduleValidation=_context3.sent,_context3.next=11;break;case 8:_context3.prev=8,_context3.t0=_context3["catch"](2),scheduleValidation=!1;case 11:if(_context3.prev=11,(0,validation/* isEmpty */.xb)(showViews)||!showViews){_context3.next=16;break}return _context3.next=15,_this4.$refs["view-form"].validate();case 15:viewValidation=_context3.sent;case 16:_context3.next=21;break;case 18:_context3.prev=18,_context3.t1=_context3["catch"](11),viewValidation=!1;case 21:return _context3.abrupt("return",scheduleValidation&&viewValidation);case 22:case"end":return _context3.stop()}}),_callee3,null,[[2,8],[11,18]])})))()},save:function(){var _this5=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){var valid,selectedView,mailTemplate,data,url;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,_this5.validate();case 2:if(valid=_context4.sent,valid){_context4.next=5;break}return _context4.abrupt("return");case 5:if(_this5.disableSave=!0,selectedView=_this5.selectedView,mailTemplate=_this5.$helpers.cloneObject(_this5.mailJson),_this5.$common.setUserMailWorkflow(_this5.mailJson.to,mailTemplate),data={type:_this5.format,viewName:selectedView.name,moduleName:_this5.currentModuleName,viewId:selectedView.id,id:_this5.isEdit?_this5.model.id:-1,emailTemplate:mailTemplate,scheduleInfo:_this5.scheduleForm.schedule,startTime:_this5.$helpers.getTimeInOrg(_this5.scheduleForm.startTime)},"after"!==_this5.endType){_context4.next=18;break}if(!(_this5.maxCount>0)){_context4.next=15;break}data.maxCount=_this5.maxCount,_context4.next=16;break;case 15:return _context4.abrupt("return");case 16:_context4.next=27;break;case 18:if("on"!==_this5.endType){_context4.next=27;break}if(!_this5.endTime){_context4.next=26;break}if(data.endTime=_this5.$helpers.getTimeInOrg(_this5.endTime),!(data.endTime<data.startTime)){_context4.next=24;break}return _this5.$message({message:_this5.$t("common.wo_report.end_time_schedule"),type:"error"}),_context4.abrupt("return");case 24:_context4.next=27;break;case 26:return _context4.abrupt("return");case 27:_this5.isEdit?(url="/view/editWoScheduledView",data.id=_this5.model.id,data.moduleName=_this5.currentModuleName):url="/view/woScheduleView",api/* API */.bl.post(url,data).then((function(_ref7){var error=_ref7.error;error?_this5.$message.error(error.message||_this5.$t("common.wo_report.view_schedule_failed")):(_this5.$message({message:_this5.$t("common.wo_report.view_schedule_success"),type:"success"}),_this5.$emit("save")),_this5.close()})).finally((function(){_this5.disableSave=!1}));case 29:case"end":return _context4.stop()}}),_callee4)})))()},reset:function(){this.mailJson.to=[],this.mailJson.subject="",this.mailJson.message="",this.endTime=null,this.maxCount=null,this.endType="never"},close:function(){this.$emit("close")}}},forms_NewScheduleViewvue_type_script_lang_js=NewScheduleViewvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(forms_NewScheduleViewvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,NewScheduleView=component.exports},
/***/823472:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return woViewScheduleList}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/workorder/workorders/v1/woViewScheduleList.vue?vue&type=template&id=7eb80939
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"full-layout-white height100 scheduled-layout"},[_c("div",{staticClass:"header pB20"},[_vm._v("Views Schedule")]),_c("div",{staticClass:"row setting-Rlayout"},[_c("div",{staticClass:"col-lg-12 col-md-12"},[_c("table",{staticClass:"setting-list-view-table"},[_vm._m(0),_vm.loading?_c("tbody",[_c("tr",[_c("td",{staticClass:"text-center",attrs:{colspan:"100%"}},[_c("spinner",{attrs:{show:_vm.loading,size:"80"}})],1)])]):0===_vm.reports.length?_c("tbody",[_vm._m(1)]):_c("tbody",_vm._l(_vm.reports,(function(info){return _c("tr",{key:info.id,staticClass:"tablerow"},[_c("td",[_vm._v(_vm._s(_vm.getViewName(info.reportContext.data)))]),_c("td",[_vm._v(_vm._s(_vm.$constants.FILE_FORMAT[info.fileFormat]))]),_c("td",[_vm._v(" "+_vm._s(info.job&&info.job.schedule?_vm.frequencyType[info.job.schedule.frequencyType]:"---")+" ")]),_c("td",[_vm._v(" "+_vm._s(info.job&&info.job.active&&info.job.executionTime>-1?_vm.$options.filters.formatDate(1e3*info.job.executionTime,"DD-MM-YYYY"):"---")+" ")]),_c("td",[info.userIds.length?_vm._l(info.userIds,(function(id,index){return _c("user-avatar",{directives:[{name:"tippy",rawName:"v-tippy"}],key:index,attrs:{size:"sm",user:_vm.$store.getters.getUser(id),name:!1,title:_vm.$store.getters.getUser(id).name}})})):_vm._e()],2),_c("td",[_c("div",{staticClass:"text-left actions",staticStyle:{"margin-top":"-3px","margin-right":"15px","text-align":"center"}},[_c("i",{staticClass:"el-icon-edit pointer",on:{click:function($event){return _vm.editView(info)}}}),_c("i",{staticClass:"el-icon-delete pointer pL5",on:{click:function($event){return _vm.deleteView(info)}}})])])])})),0)])])]),_vm.showEditDialog?_c("NewScheduleReport",{attrs:{showScheduleDialog:_vm.showEditDialog,isEdit:"true",model:_vm.selectedModel},on:{"update:showScheduleDialog":function($event){_vm.showEditDialog=$event},"update:show-schedule-dialog":function($event){_vm.showEditDialog=$event},save:function($event){_vm.showEditDialog=!1,_vm.initData()}}}):_vm._e()],1)},staticRenderFns=[function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("thead",[_c("tr",[_c("th",{staticClass:"setting-table-th setting-th-text"},[_vm._v("VIEW NAME")]),_c("th",{staticClass:"setting-table-th setting-th-text"},[_vm._v("FILE FORMAT")]),_c("th",{staticClass:"setting-table-th setting-th-text"},[_vm._v("FREQUENCY")]),_c("th",{staticClass:"setting-table-th setting-th-text"},[_vm._v("NEXT EXECUTION")]),_c("th",{staticClass:"setting-table-th setting-th-text"}),_c("th",{staticClass:"setting-table-th setting-th-text"})])])},function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("tr",[_c("td",{staticClass:"text-center",attrs:{colspan:"100%"}},[_vm._v(" No View Schedules Available ")])])}],ReportHelper=(__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(670560),__webpack_require__(425728),__webpack_require__(538077),__webpack_require__(434284),__webpack_require__(507815)),NewScheduleView=__webpack_require__(343089),User=__webpack_require__(426803),woViewScheduleListvue_type_script_lang_js={mixins:[ReportHelper/* default */.Z],props:["modName"],components:{UserAvatar:User/* default */.Z,NewScheduleReport:NewScheduleView/* default */.Z},data:function(){return{loading:!1,v2loading:!1,moduleName:"",reports:[],woViews:[],frequencyType:{0:"Once",1:"Daily",2:"Weekly",3:"Monthly",4:"Monthly",5:"Yearly"},selectedModel:null,showEditDialog:!1}},computed:{currentModule:function(){return this.getCurrentModule()?this.getCurrentModule().module:""},users:function(){return this.$store.state.users}},mounted:function(){this.initData(),this.loadViews()},methods:{initData:function(){this.loading=!0;var url,self=this,data={moduleName:this.$route.meta.module};url="/view/woScheduleViewList",this.$http.post(url,data).then((function(response){self.loading=!1,response.data&&response.data.scheduledReports&&(self.reports=response.data.scheduledReports,self.setReportInfo(response.data.scheduledReports))}))},setReportInfo:function(reports){var _this=this;reports.forEach((function(report){if(report.userIds=[],report.emailTemplate&&report.emailTemplate.workflow&&report.emailTemplate.workflow.expressions&&report.emailTemplate.workflow.expressions.length>1)for(var i=1;i<report.emailTemplate.workflow.expressions.length;i++){var exp=report.emailTemplate.workflow.expressions[i],userId=exp.criteria.conditions[1].value;report.userIds.push(parseInt(userId))}else{var userMails=report.emailTemplate.originalTemplate.to.split();userMails.forEach((function(mail){var user=_this.users.find((function(user){return user.email===mail}));user&&report.userIds.push(parseInt(user.id))}))}}))},editView:function(reportinfo){var info=this.$helpers.cloneObject(reportinfo),view1=[];view1=this.woViews.filter((function(view){return view.id===info.reportContext.data.viewId})),info.emailTemplate.originalTemplate.to=info.userIds;var startTime=info.job.executionTime>0?1e3*info.job.executionTime:"";this.selectedModel={scheduleForm:{startTime:startTime||new Date,schedule:info.job.schedule},format:info.fileFormat,viewName:view1[0].name,mailJson:info.emailTemplate.originalTemplate,to:info.emailTemplate.originalTemplate.to,endTime:info.job.endExecutionTime>0?1e3*info.job.endExecutionTime:"",maxCount:info.job.maxExecution>0?info.job.maxExecution:"",id:info.id},this.showEditDialog=!0},deleteView:function(info){var url,_this2=this,params={id:null};this.$dialog.confirm({title:"Delete Schedule",message:"Are you sure you want to delete this schedule?",rbDanger:!0,rbLabel:"Delete"}).then((function(value){value&&(url="/view/deleteScheduledView",params.id=info.id,_this2.$http.post(url,params).then((function(response){200===response.status?(_this2.$message.success("Schedule deleted succesfully"),_this2.initData()):_this2.$message.error("Schedule deletion failed")})))}))},loadViews:function(){var self=this;this.$http.get("/view?moduleName="+this.$route.meta.module).then((function(response){response.data&&response.data.views&&(self.woViews=response.data.views)}))},getViewName:function(report){if(report&&report.viewId){var view1=[];if(view1=this.woViews.filter((function(view){return view.id===report.viewId})),view1&&view1[0]&&view1[0].displayName){var viewName=view1[0].displayName;return viewName}return"---"}return"---"}}},v1_woViewScheduleListvue_type_script_lang_js=woViewScheduleListvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(v1_woViewScheduleListvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,woViewScheduleList=component.exports},
/***/702638:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"763b584b7aa649bd99722d2be3c8036a.svg";
/***/},
/***/47424:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"400bdd76d58614975db74618a6f968ef.svg";
/***/}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/23472.js.map