(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[54002],{
/***/588:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return chartIcon}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/charts/components/chartIcon.vue?vue&type=template&id=23f433a8
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",["pie"===_vm.icon?_c("img",{staticClass:"chart-icon-new filter-theme-color",attrs:{src:__webpack_require__(928824)}}):"doughnut"===_vm.icon||"donut"===_vm.icon?_c("img",{staticClass:"chart-icon-new filter-theme-color",attrs:{src:__webpack_require__(629443)}}):"bar"===_vm.icon?_c("img",{staticClass:"chart-icon-new filter-theme-color",attrs:{src:__webpack_require__(341029)}}):"stackedbar"===_vm.icon?_c("img",{staticClass:"chart-icon-new filter-theme-color",attrs:{src:__webpack_require__(709333)}}):"histogram"===_vm.icon?_c("fc-icon",{staticClass:"chart-icon-new filter-theme-color",staticStyle:{border:"1.5px solid #ef508f","border-radius":"2px",display:"flex","justify-content":"center","align-items":"center"},attrs:{group:"chart-data",name:"histogram",color:"#ef508f",size:"17"}}):"groupedbar"===_vm.icon?_c("img",{staticClass:"chart-icon-new filter-theme-color",attrs:{src:__webpack_require__(717328)}}):"line"===_vm.icon?_c("img",{staticClass:"chart-icon-new filter-theme-color",attrs:{src:__webpack_require__(570678)}}):"area"===_vm.icon||"area-spline"===_vm.icon||"area-step"===_vm.icon?_c("img",{staticClass:"chart-icon-new filter-theme-color",attrs:{src:__webpack_require__(887025)}}):"progress"===_vm.icon?_c("img",{staticClass:"chart-icon-new filter-theme-color",attrs:{src:__webpack_require__(71761)}}):"heatMap"===_vm.icon?_c("img",{staticClass:"chart-icon-new filter-theme-color",attrs:{src:__webpack_require__(413273)}}):"cubsim"===_vm.icon?_c("img",{staticClass:"chart-icon-new filter-theme-color",attrs:{src:__webpack_require__(129816)}}):"tabular"===_vm.icon?_c("img",{staticClass:"chart-icon-new filter-theme-color",attrs:{src:__webpack_require__(407826)}}):"gauge"===_vm.icon?_c("img",{staticClass:"chart-icon-new filter-theme-color",attrs:{src:__webpack_require__(91677)}}):_c("img",{staticClass:"chart-icon-new filter-theme-color",attrs:{src:__webpack_require__(570678)}})],1)},staticRenderFns=[],chartIconvue_type_script_lang_js={props:["icon"]},components_chartIconvue_type_script_lang_js=chartIconvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_chartIconvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,chartIcon=component.exports},
/***/523163:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FAnalyticReport}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/energy/analytics/components/FAnalyticReport.vue?vue&type=template&id=f872325a
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"text-center"},[_c("div",{staticClass:"row"},[_c("div",{staticClass:"col-12"},[_c("date-picker",{staticClass:"filter-field date-filter-comp",attrs:{mills:_vm.config.dateFilter.actual_time?_vm.config.dateFilter.actual_time:_vm.config.dateFilter.time,filter:_vm.config.dateFilter.filter},on:{data:_vm.setDateFilter}}),this.config.chartType&&"heatMap"!==this.config.chartType||_vm.currentChartType?_c("div",{staticStyle:{float:"right","margin-top":"-28px","margin-right":"30px"}},[_vm.report&&_vm.report.data&&_vm.report.data[0].alarms&&_vm.report.data[0].alarms.length&&"heatMap"!==this.config.chartType?_c("span",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"fanalytics-alarm-toggle",class:{"fchart-alarm-toggle-on":!1===_vm.showAlarm},attrs:{title:"Toggle Alarms","data-arrow":"true"},on:{click:_vm.changeRenderAlarm}},[_c("i",{staticClass:"material-icons alarm-icon"},[_vm._v("alarm")])]):_vm._e(),"undefined"===typeof _vm.config.chartTypeChangable||_vm.config.chartTypeChangable?_c("span",[_c("span",{staticClass:"chart-icon",staticStyle:{display:"inline-block"}},[_c("chart-icon",{attrs:{icon:_vm.currentChartType?_vm.currentChartType.ct:null}})],1),_c("q-popover",{ref:"charttypepopover"},[_c("q-list",{staticClass:"scroll",staticStyle:{"min-width":"150px"},attrs:{link:""}},_vm._l(_vm.chartType.availableChartTypes,(function(ctype,index){return ctype.disabled?_vm._e():_c("q-item",{key:index,on:{click:function($event){_vm.changeChartType(ctype),_vm.$refs.charttypepopover.close()}}},[_c("span",{staticClass:"chart-icon",staticStyle:{"margin-right":"5px"}},[_c("chart-icon",{attrs:{icon:ctype.ct}})],1),_c("span",{staticClass:"chart-label"},[_vm._v(_vm._s(ctype.label))])])})),1)],1)],1):_vm._e(),_vm.report&&_vm.report.options.is_combo?_c("span",{directives:[{name:"tippy",rawName:"v-tippy"}],staticStyle:{display:"inline-block",color:"rgb(239, 80, 143)",cursor:"pointer",position:"relative",top:"-3px","margin-left":"14px"},attrs:{title:"Settings","data-arrow":"true"}},[_c("el-popover",{ref:"popover2",attrs:{"popper-class":"report-settings-popover",placement:"bottom",title:"Settings",width:"400",trigger:"click"},model:{value:_vm.reportSettingsPopover,callback:function($$v){_vm.reportSettingsPopover=$$v},expression:"reportSettingsPopover"}},[_c("div",{staticStyle:{padding:"12px"}},[_c("f-report-settings",{attrs:{report:_vm.report},on:{close:function($event){return _vm.closeSettingsPopover()},save:function($event){return _vm.saveSettingsPopover()}}})],1)]),_c("i",{directives:[{name:"popover",rawName:"v-popover:popover2",arg:"popover2"}],staticClass:"fa fa-cog"})],1):_vm._e(),_vm.config.regression?_c("span",{directives:[{name:"tippy",rawName:"v-tippy"}],staticStyle:{display:"inline-block",color:"rgb(239, 80, 143)",cursor:"pointer",position:"relative",top:"-3px","margin-left":"14px"},attrs:{title:"Options","data-arrow":"true"}},[_c("el-popover",{ref:"popover2",staticClass:"report-options-popover",attrs:{placement:"bottom",title:"Options",width:"200",trigger:"click"}},[_c("div",{staticStyle:{padding:"12px"}},[_c("el-checkbox",{on:{change:_vm.onExcludeWeekendChange},model:{value:_vm.excludeWeekends,callback:function($$v){_vm.excludeWeekends=$$v},expression:"excludeWeekends"}},[_vm._v("Exclude Weekends")])],1)]),_c("i",{directives:[{name:"popover",rawName:"v-popover:popover2",arg:"popover2"}],staticClass:"fa fa-cog"})],1):_vm._e()]):_vm._e()],1)]),_vm.loading?_c("spinner",{attrs:{show:_vm.loading,size:"80"}}):_vm.error?_c("div",{staticClass:"mT30"},[_vm._v(" "+_vm._s(_vm.$t("common._common.load_data_failed"))+" ")]):_vm.report&&_vm.report.data?_c("div",[_vm.chartUpdating?_c("div",{staticClass:"fchart-overlay"}):_vm._e(),"peak"===_vm.config.type?_c("div",[_c("f-peak",{attrs:{width:600,height:450,data:_vm.report.data,alarms:_vm.report.data[0].alarms,type:_vm.chartType.chartType.ct}})],1):_c("div",{class:{"analytics-alarm-toggle-on":!1===_vm.showAlarm}},["timeseries"===_vm.report.options.type?_c("f-timeseries",{ref:"fTimeseriesChart",attrs:{width:600,height:450,data:_vm.report.data,alarms:_vm.report.data[0].alarms,type:_vm.report.options.type}}):_c("f-chart",{ref:"fchart en-fchart",attrs:{type:_vm.report.options.type,data:_vm.report.data,options:_vm.report.options,alarms:_vm.report.data[0].alarms,width:600,height:_vm.getChartHeight(_vm.report.options.type)},on:{drilldown:_vm.handleDrillDown}})],1),_vm.showTabularData?_c("div",{staticClass:"reports-underlyingdata mT30 mB100"},[_c("f-tabular-data",{ref:"tabulardata",attrs:{data:_vm.actualReport?_vm.actualReport.data:_vm.report.data,options:_vm.actualReport?_vm.actualReport.options:_vm.report.options,multi:_vm.actualReport||"timeseries"===_vm.report.options.type||_vm.report.options.is_combo}})],1):_vm._e()]):_c("div",{staticClass:"mT30"},[_vm._v(" "+_vm._s(_vm.$t("common._common.no_data_available"))+" ")])],1)},staticRenderFns=[],createForOfIteratorHelper=__webpack_require__(566347),tooltip=(__webpack_require__(670560),__webpack_require__(260228),__webpack_require__(434284),__webpack_require__(425728),__webpack_require__(460895)),FChart=__webpack_require__(708237),FTimeseries=__webpack_require__(130325),FPeakvue_type_template_id_6921b545_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("div",{ref:"f-timeseries"})])},FPeakvue_type_template_id_6921b545_staticRenderFns=[],d3=(__webpack_require__(634338),__webpack_require__(348727)),basechart=__webpack_require__(51007),cubism=__webpack_require__(838197),FPeakvue_type_script_lang_js={mixins:[basechart/* default */.Z],props:["data","alarms","width","height","datefilter","type"],data:function(){return{}},mounted:function(){window.addEventListener("resize",this.rerender),this.render()},watch:{layout:{handler:function(newVal,oldVal){this.rerender()},deep:!0},data:{handler:function(newVal,oldVal){this.rerender()},deep:!0},type:{handler:function(newVal,oldVal){this.rerender()},deep:!0}},computed:{layout:function(){return this.width&&this.height?{width:this.width,height:this.height}:null}},methods:{rerender:function(){this.$refs["f-timeseries"]&&(this.$refs["f-timeseries"].innerHTML=""),this.render()},buildContainerGroups:function(chartContext){chartContext.container=chartContext.svg.append("g").classed("container-group",!0).attr("transform","translate(".concat(chartContext.getMargin().right,", ").concat(chartContext.getMargin().top,")")),chartContext.container.append("g").classed("grid-lines-group",!0),chartContext.container.append("g").attr("transform","translate(0, 0)").classed("y-axis-group axis",!0),chartContext.container.append("g").attr("transform","translate(".concat(chartContext.getWidth()-chartContext.getMargin().right-chartContext.getMargin().left,", 0)")).classed("y1-axis-group axis",!0),chartContext.container.append("g").classed("x-axis-group axis",!0),chartContext.container.append("g").classed("chart-group",!0).attr("width",400).attr("height",100),chartContext.container.append("g").classed("metadata-group",!0),chartContext.container.append("g").classed("brush-group",!0),chartContext.hover=!0},render:function(){var context=this;this.data&&(context.selector=this.$refs["f-timeseries"],context.data=this.data,this.svg=d3.select(context.selector).append("svg").classed("fchart",!0),this.buildContainerGroups(context),cubism/* default */.Z.drawAxis(context))}}},charts_FPeakvue_type_script_lang_js=FPeakvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(charts_FPeakvue_type_script_lang_js,FPeakvue_type_template_id_6921b545_render,FPeakvue_type_template_id_6921b545_staticRenderFns,!1,null,null,null)
/* harmony default export */,FPeak=component.exports,FTabularData=__webpack_require__(478542),colors=__webpack_require__(519898),DatePicker=__webpack_require__(106537),chartIcon=__webpack_require__(588),ReportUtil=__webpack_require__(86254),ChartType=__webpack_require__(28341),FReportSettings=__webpack_require__(674322),JumpToHelper=__webpack_require__(921466),quasar_esm=__webpack_require__(641358),FAnalyticReportvue_type_script_lang_js={mixins:[ReportUtil/* default */.Z,ChartType/* default */.Z,JumpToHelper/* default */.Z],props:["config"],components:{FChart:FChart/* default */.Z,FPeak:FPeak,FTimeseries:FTimeseries/* default */.Z,FTabularData:FTabularData/* default */.Z,DatePicker:DatePicker/* default */.Z,QPopover:quasar_esm/* QPopover */.oe,QList:quasar_esm/* QList */.tu,QItem:quasar_esm/* QItem */.ry,ChartIcon:chartIcon/* default */.Z,FReportSettings:FReportSettings/* default */.Z},data:function(){return{loading:!0,chartUpdating:!1,error:!1,showAlarm:!0,report:null,actualReport:null,consolidateDataPoints:null,chartType:null,excludeWeekends:!1,reportSettingsPopover:!1}},computed:{currentChartType:function(){return this.chartType?this.chartType.chartType:null},showTabularData:function(){return!("undefined"!==typeof this.config.tabulardata&&!this.config.tabulardata)}},watch:{config:{handler:function(newData,oldData){this.init(!1)},deep:!0},report:{handler:function(newData,oldData){this.$emit("report",this.report)},deep:!0}},mounted:function(){this.init(!0)},destroyed:function(){tooltip/* default */.Z.hideTooltip()},methods:{init:function(firstTime){this.cType=this.currentChartType,this.$emit("change",this.config);var self=this;if(this.config&&this.config.dataPoints&&this.config.dataPoints.length){firstTime?(self.loading=!0,self.chartUpdating=!1):self.chartUpdating=!0;var _step,index=0,dataList=[],colorMap={},dataPointsWithBaseLine=[],uniqueId=1,_iterator=(0,createForOfIteratorHelper/* default */.Z)(this.config.dataPoints);try{for(_iterator.s();!(_step=_iterator.n()).done;){var dataPoint=_step.value;if(dataPoint.id=dataPoint.id||uniqueId++,dataPointsWithBaseLine.push(dataPoint),this.config.baseLine){var dataPointClone=self.$helpers.cloneObject(dataPoint);dataPointClone.baseLine=this.config.baseLine,dataPointsWithBaseLine.push(dataPointClone)}}}catch(err){_iterator.e(err)}finally{_iterator.f()}if(this.config.chartViewOption&&1===this.config.chartViewOption){for(var consolidateDataPoints={},data=0;data<this.config.dataPoints.length;data++)consolidateDataPoints[this.config.dataPoints[data].parentId]=this.config.dataPoints[data].readingFieldId;this.loadConsolidationReadingData(dataPointsWithBaseLine,this.config.dateFilter,dataList,index,colorMap,consolidateDataPoints).then((function(response){var _step2,nodata=!0,_iterator2=(0,createForOfIteratorHelper/* default */.Z)(dataList);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var d=_step2.value;if(d.data.length){nodata=!1;break}}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}var reportObj={data:nodata?null:dataList,options:dataList[0].options,multi:!0};self.config.regression?self.actualReport=reportObj:self.actualReport=null,reportObj.options.is_highres_data&&(self.config.chartType=null),reportObj.options.type=self.config.chartType?self.config.chartType:self.chartType?self.chartType.chartType.ct:"timeseries",reportObj.options.is_combo="combo"===self.config.chartType,self.report=self.combineReportData(reportObj),self.chartType=self.getChartType(self.report),firstTime?self.loading=!1:self.chartUpdating=!1,self.setPointSettings()}))}else this.loadReadingData(dataPointsWithBaseLine,this.config.dateFilter,dataList,index,colorMap).then((function(response){var _step3,nodata=!0,_iterator3=(0,createForOfIteratorHelper/* default */.Z)(dataList);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var d=_step3.value;if(d.data.length){nodata=!1;break}}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}var reportObj={data:nodata?null:dataList,options:dataList[0].options,multi:!0};self.config.regression?self.actualReport=reportObj:self.actualReport=null,reportObj.options.is_highres_data&&(self.config.chartType=null),reportObj.options.type=self.config.chartType?self.config.chartType:self.chartType?self.chartType.chartType.ct:"timeseries",reportObj.options.is_combo="combo"===self.config.chartType,self.report=self.combineReportData(reportObj),self.chartType=self.getChartType(self.report),firstTime?self.loading=!1:self.chartUpdating=!1,self.setPointSettings()}))}},changeRenderAlarm:function(){this.showAlarm=!this.showAlarm},changeChartType:function(type){var oldType=this.report.options.type;this.chartType.chartType=type,this.report.options.type=type.ct,this.config.chartType=type.ct,("timeseries"===oldType||"timeseries"===type.ct||this.report.options.is_combo||"combo"===type.ct)&&this.init()},setDateFilter:function(dateFilter){this.config.dateFilter=dateFilter,this.$emit("update:config",this.config),this.init()},onExcludeWeekendChange:function(){this.config.excludeWeekends=this.excludeWeekends,this.$emit("update:config",this.config),this.init()},handleDrillDown:function(data){this.jumpReadingToAnalytics(this.config.dataPoints[0].parentId,this.config.dataPoints[0].readingFieldId,{operatorId:62,value:data.chartData.orgLabel+""},20,3)},getChartHeight:function(type){var self=this;return type&&"heatMap"===type?"Y"===self.config.dateFilter.filterName?2e3:"M"===self.config.dateFilter.filterName?400:"R"===self.config.dateFilter.filterName?1e3:"C"===self.config.dateFilter.filterName?600:"W"===self.config.dateFilter.filterName?400:"D"===self.config.dateFilter.filterName?200:1e3:450},loadConsolidationReadingData:function(dataPoints,dateFilter,dataList,index,colorMap,consolidateDataPoints){var _this=this,self=this,dataPoint=dataPoints[index];return new Promise((function(resolve,reject){0!==_this.config.period&&0===dataPoint.yAggr?
// setting sum
dataPoint.yAggr=3:0===_this.config.period&&0!==dataPoint.yAggr&&(
// setting actual
dataPoint.yAggr=0);var yAggr=dataPoint.yAggr,params={parentId:dataPoint.parentId,readingFieldId:dataPoint.readingFieldId,xAggr:_this.config.period,yAggr:yAggr};dataPoint.workflowId>0&&(params.derivation=dataPoint),dataPoint.baseLine&&(params.baseLineId=dataPoint.baseLine.id),dateFilter&&(params.dateFilter=dateFilter.time),self.excludeWeekends&&(params.excludeWeekends=self.excludeWeekends);var url="/dashboard/getReadingReportData";dataPoint.type&&"cost"===dataPoint.type&&(url+="?cost=true"),consolidateDataPoints&&(params.consolidateDataPoints=consolidateDataPoints),self.$http.post(url,params).then((function(response){var options=self.prepareReportOptions(response.data,self.config.dateFilter.time),alarms=self.prepareRelatedAlarms(response.data.readingAlarms,response.data.reportContext,options),data=[],data2=[];response.data&&response.data.booleanResultGrouping&&response.data.booleanResultGrouping.length?(data=self.prepareReportData(response.data.reportData,response.data.reportContext,options,"y1axis",response.data.baseLineComparisionDiff),options.booleanchart=!0,options.booleanKey=self.prepareBooleanKey(response.data.booleanResultOptions,response.data.reportContext,options,"y1axis",response.data.baseLineComparisionDiff),options.booleanKey1=response.data.booleanResultOptions,data2=self.prepareBooleanReportData(response.data.booleanResultGrouping,response.data.reportContext,options,"y1axis",response.data.baseLineComparisionDiff)):data=self.prepareReportData(response.data.reportData,response.data.reportContext,options,"y1axis",response.data.baseLineComparisionDiff),options.color=colors/* default.default */.Z["default"][index+1];var title=dataPoint.name;dataPoint.baseLine&&dataPoint.baseLine.name&&(title+=" ("+dataPoint.baseLine.name+")"),dataList.push({title:title,type:self.config.baseLine?params.baseLineId?"area":"line":"area",baseLineId:params.baseLineId,options:options,data:data,alarms:alarms,data2:data2,dataPointId:dataPoint.id}),resolve(response)})).catch((function(error){reject(error)}))}))},loadReadingData:function(dataPoints,dateFilter,dataList,index,colorMap){var _this2=this,self=this,dataPoint=dataPoints[index];return new Promise((function(resolve,reject){0!==_this2.config.period&&0===dataPoint.yAggr?"kWh"===dataPoint.readingField.unit||"totalEnergyConsumptionDelta"===dataPoint.readingField.name?
// setting sum
dataPoint.yAggr=3:
// setting avg
dataPoint.yAggr=2:0===_this2.config.period&&0!==dataPoint.yAggr&&(
// setting actual
dataPoint.yAggr=0);var yAggr=dataPoint.yAggr,params={parentId:dataPoint.parentId,readingFieldId:dataPoint.readingFieldId,xAggr:_this2.config.period,yAggr:yAggr};dataPoint.workflowId>0&&(params.derivation=dataPoint),dataPoint.baseLine&&(params.baseLineId=dataPoint.baseLine.id),dateFilter&&(params.dateFilter=dateFilter.time),self.excludeWeekends&&(params.excludeWeekends=self.excludeWeekends);var url="/dashboard/getReadingReportData";dataPoint.type&&"cost"===dataPoint.type&&(url+="?cost=true"),"heatMap"===_this2.config.chartType&&(params.isHeatMap=!0),
// if (this.consolidateDataPoints !== null) {
//   params = null
//   params.consolidateDataPoints = this.consolidateDataPoints
// }
self.$http.post(url,params).then((function(response){var options=self.prepareReportOptions(response.data,self.config.dateFilter.time),alarms=self.prepareRelatedAlarms(response.data.readingAlarms,response.data.reportContext,options),data=[],data2=[];response.data&&response.data.booleanResultGrouping&&response.data.booleanResultGrouping.length?(data=self.prepareReportData(response.data.reportData,response.data.reportContext,options,"y1axis",response.data.baseLineComparisionDiff),options.booleanchart=!0,options.booleanKey=self.prepareBooleanKey(response.data.booleanResultOptions,response.data.reportContext,options,"y1axis",response.data.baseLineComparisionDiff),options.booleanKey1=response.data.booleanResultOptions,data2=self.prepareBooleanReportData(response.data.booleanResultGrouping,response.data.reportContext,options,"y1axis",response.data.baseLineComparisionDiff)):data=self.prepareReportData(response.data.reportData,response.data.reportContext,options,"y1axis",response.data.baseLineComparisionDiff),
// if (params.baseLineId) {
//   options.baseLine = true
// }
// if (!colorMap[response.data.reportContext.id]) {
//   colorMap[response.data.reportContext.id] = colors.default[index + 1]
// }
// if (!colorMap[dataPoint.id]) {
//   colorMap[dataPoint.id] = colors.default[index + 1]
// }
// options.color = colorMap[dataPoint.id]
options.color=colors/* default.default */.Z["default"][index+1];var title=dataPoint.name;dataPoint.baseLine&&dataPoint.baseLine.name&&(title+=" ("+dataPoint.baseLine.name+")"),dataList.push({title:title,type:self.config.baseLine?params.baseLineId?"area":"line":"area",baseLineId:params.baseLineId,options:options,data:data,data2:data2,alarms:alarms,dataPointId:dataPoint.id}),index+1<dataPoints.length?self.loadReadingData(dataPoints,dateFilter,dataList,index+1,colorMap).then((function(response){resolve(response)})):resolve(response)})).catch((function(error){reject(error)}))}))},getFreportOptions:function(option){return option.chartname=this.config.dataPoints[0].name,option},closeSettingsPopover:function(){this.reportSettingsPopover=!1},saveSettingsPopover:function(){this.$refs["fchart en-fchart"]&&this.$refs["fchart en-fchart"].rerender(),this.reportSettingsPopover=!1,this.setPointSettings()},setPointSettings:function(){var _this3=this;if(this.report&&this.report.data&&this.report.options.is_combo){var _step4,_iterator4=(0,createForOfIteratorHelper/* default */.Z)(this.report.data);try{var _loop=function(){var d=_step4.value,conf=_this3.config.dataPoints.find((function(conf){return conf.id===d.dataPointId}));conf.settings={reportColor:d.options.color,chartType:d.options.type}};for(_iterator4.s();!(_step4=_iterator4.n()).done;)_loop()}catch(err){_iterator4.e(err)}finally{_iterator4.f()}}}}},components_FAnalyticReportvue_type_script_lang_js=FAnalyticReportvue_type_script_lang_js,FAnalyticReport_component=(0,componentNormalizer/* default */.Z)(components_FAnalyticReportvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FAnalyticReport=FAnalyticReport_component.exports},
/***/101699:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FSaveAsReport}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/report/components/FSaveAsReport.vue?vue&type=template&id=77f6c595
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"trend-dialog headernew",attrs:{visible:_vm.visibility,fullscreen:!0,"custom-class":"fc-dialog-right","before-close":_vm.close},on:{"update:visible":function($event){_vm.visibility=$event}}},[_c("div",[_c("div",{staticClass:"dialog-title title"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.save_as_report"))+" ")]),_vm.mainReport?_c("div",[_c("div",{staticClass:"heading pT15"},[_vm._v(_vm._s(_vm.$t("common.products.name")))]),_c("div",[_c("el-input",{model:{value:_vm.mainReport.name,callback:function($$v){_vm.$set(_vm.mainReport,"name",$$v)},expression:"mainReport.name"}})],1),_c("div",{staticClass:"heading pT15"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.report_description"))+" ")]),_c("div",[_c("el-input",{attrs:{type:"textarea",rows:5},model:{value:_vm.mainReport.description,callback:function($$v){_vm.$set(_vm.mainReport,"description",$$v)},expression:"mainReport.description"}})],1),_c("div",{staticClass:"heading pT15"},[_vm._v(_vm._s(_vm.$t("common._common.x_axislabel")))]),_c("div",[_c("el-input",{model:{value:_vm.mainReport.xAxisLabel,callback:function($$v){_vm.$set(_vm.mainReport,"xAxisLabel",$$v)},expression:"mainReport.xAxisLabel"}})],1),_c("div",{staticClass:"heading pT15"},[_vm._v(_vm._s(_vm.$t("common._common.y_axis_label")))]),_c("div",[_c("el-input",{model:{value:_vm.mainReport.y1AxisLabel,callback:function($$v){_vm.$set(_vm.mainReport,"y1AxisLabel",$$v)},expression:"mainReport.y1AxisLabel"}})],1),_c("div",{staticClass:"heading pT15"},[_vm._v(_vm._s(_vm.$t("common.products.folder")))]),_c("div",[_c("el-select",{staticClass:"report-dropDown",attrs:{placeholder:_vm.$t("common.products.folder")},model:{value:_vm.mainReport.parentFolderId,callback:function($$v){_vm.$set(_vm.mainReport,"parentFolderId",$$v)},expression:"mainReport.parentFolderId"}},_vm._l(_vm.reportFolders,(function(folder,index){return"Default"!==folder.label?_c("el-option",{key:index,attrs:{label:folder.label,value:folder.id}}):_vm._e()})),1)],1),_vm.isDerivationAvailable?[_c("div",{staticClass:"heading pT15"},[_vm._v(" "+_vm._s(_vm.$t("common.header.start_time_to_calculate"))+" ")]),_c("div",{staticClass:"dervn-starttime"},[_c("el-date-picker",{attrs:{placeholder:_vm.$t("common.wo_report.start_time"),"picker-options":_vm.dateOptions,type:"datetime","default-value":_vm._f("weekly")("day")},model:{value:_vm.startTime,callback:function($$v){_vm.startTime=$$v},expression:"startTime"}})],1)]:_vm._e(),_c("div",{staticClass:"heading pT15"}),_vm.config.dataPoints.length>1&&0!==_vm.config.dataPoints[0].period?_c("div",[_c("el-checkbox",{model:{value:_vm.saveAsTabularReport,callback:function($$v){_vm.saveAsTabularReport=$$v},expression:"saveAsTabularReport"}},[_vm._v(_vm._s(_vm.$t("common._common.save_as_tabular_report")))])],1):_vm._e()],2):_vm._e()]),_c("div",{staticClass:"modal-dialog-footer"},[_c("button",{staticClass:"modal-btn-cancel",attrs:{type:"button"},on:{click:_vm.close}},[_c("span",[_vm._v(_vm._s(_vm.$t("common._common.cancel")))])]),_c("button",{staticClass:"modal-btn-save",attrs:{type:"button"},on:{click:_vm.save}},[_c("span",[_vm._v(_vm._s(_vm.$t("common._common._save")))])])])])},staticRenderFns=[],createForOfIteratorHelper=__webpack_require__(566347),FSaveAsReportvue_type_script_lang_js=(__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(434284),__webpack_require__(670560),__webpack_require__(564043),__webpack_require__(857267),{props:["visibility","config"],data:function(){return{reportFolders:[],mainReport:null,subReportList:[],saveAsTabularReport:!1,startTime:null,
// For derivation
dateOptions:{disabledDate:function(time){var today=new Date;return today.setHours(23,59,0,0),time.getTime()>today.getTime()}}}},computed:{isDerivationAvailable:function(){return this.config&&this.config.dataPoints.filter((function(d){return"derivation"===d.type}))}},mounted:function(){this.loadReportFolders(),this.init()},watch:{visibility:function(){this.visibility&&this.init()}},methods:{close:function(){this.$emit("update:visibility",!1)},loadReportFolders:function(){var self=this;self.$http.get("/report/workorder/getAllWorkOrderReports?moduleName=energydata").then((function(response){response.data.allWorkOrderJsonReports&&(self.reportFolders=response.data.allWorkOrderJsonReports)}))},reset:function(){this.mainReport=null,this.subReportList=[],this.saveAsTabularReport=!1},init:function(){if(this.config){this.reset();for(var i=0;i<this.config.dataPoints.length;i++){var dataPoint=this.config.dataPoints[i],report={name:dataPoint.name,description:dataPoint.name+" Report",parentFolderId:"",chartTypeString:"combo"===this.config.chartType?dataPoint.settings.chartType:this.config.chartType,reportColor:dataPoint.settings?dataPoint.settings.reportColor:null,isCombinationReport:"combo"===this.config.chartType,xAxisLabel:"Timestamp",xAxisField:{moduleField:{name:"ttime"}},xAxisaggregateFunction:this.config.period,y1AxisaggregateFunction:dataPoint.yAggr,groupByField:{moduleFieldId:null},groupByFieldAggregateFunction:null,isHighResolutionReport:0===this.config.period&&0===dataPoint.yAggr,reportUserFilters:[],reportThresholds:[],dateFilter:{operatorId:this.config.dateFilter.operatorId?this.config.dateFilter.operatorId:31,value:this.config.dateFilter.value?this.config.dateFilter.value:null}};if("derivation"===dataPoint.type){var formula=this.$common.getFormulaFieldFromWorkflow();// TODO pass workflow
formula.name="Report_"+dataPoint.name;var dateRange=this.$helpers.getDateRange("day"),derivation={name:dataPoint.name,workflowId:dataPoint.workflowId,id:dataPoint.id,formulaField:formula,dateRange:{startTime:this.startTime?this.$helpers.getTimeInOrg(this.startTime):dateRange[0],endTime:dateRange[1]}};report.derivation=derivation,report.y1AxisLabel=dataPoint.name}else report.moduleId=dataPoint.readingField.module&&dataPoint.readingField.module.moduleId?dataPoint.readingField.module.moduleId:dataPoint.readingField.moduleId,report.criteria={pattern:"(1)",conditions:{1:{fieldName:"parentId",moduleName:dataPoint.readingField.module&&dataPoint.readingField.module.name?dataPoint.readingField.module.name:"energydata",operatorId:36,value:dataPoint.parentId+""}}},report.y1AxisLabel=dataPoint.readingField.displayName,report.y1AxisField={moduleFieldId:dataPoint.readingField.id},report.dateFilter.field={name:"ttime",module:{name:dataPoint.readingField.module&&dataPoint.readingField.module.name?dataPoint.readingField.module.name:"energydata"}};0===i?(this.mainReport=report,this.config.baseLine&&(this.mainReport.baseLineId=this.config.baseLine.id)):this.subReportList.push(report)}}},save:function(){var self=this;if(!this.mainReport||this.mainReport.parentFolderId){if(this.subReportList&&this.subReportList.length){var _step,_iterator=(0,createForOfIteratorHelper/* default */.Z)(this.subReportList);try{for(_iterator.s();!(_step=_iterator.n()).done;){var subReport=_step.value;subReport.parentFolderId=null}}catch(err){_iterator.e(err)}finally{_iterator.f()}}if(this.saveAsTabularReport){var reports=[];this.mainReport.chartType=14,this.mainReport.isComparisionReport=!0,reports.push(this.mainReport);var cloned=this.$helpers.cloneObject(this.mainReport);cloned.parentFolderId=null,reports.push(cloned);var _step2,_iterator2=(0,createForOfIteratorHelper/* default */.Z)(this.subReportList);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _subReport=_step2.value;reports.push(_subReport)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}self.$http.post("dashboard/addTabularReport?moduleName=energydata",{reports:reports}).then((function(response){if(response.data.reportContext){var notifyInstance=self.$notify({title:this.$t("common._common.report_saved_successfully"),message:this.$t("common._common.click_here_to_open_saved_record"),type:"success",duration:0,customClass:"report-save-success",onClick:function(){notifyInstance&&notifyInstance.close();var reportURL="/app/em/reports/view/"+response.data.reportContext.id;self.$router.replace({path:reportURL})}});self.close()}})).catch((function(error){error&&self.$message.error(this.$t("common._common.oops_this_is_a_error_saving"))}))}else this.mainReport.comparingReportContexts=this.subReportList,self.$http.post("dashboard/addReport?moduleName=energydata",{reportContext:this.mainReport}).then((function(response){if(response.data.reportContext){var notifyInstance=self.$notify({title:this.$t("common._common.report_saved_successfully"),message:this.$t("common._common.click_here_to_open_saved_record"),type:"success",duration:0,customClass:"report-save-success",onClick:function(){notifyInstance&&notifyInstance.close();var reportURL="/app/em/reports/view/"+response.data.reportContext.id;self.$router.replace({path:reportURL})}});self.close()}})).catch((function(error){error&&self.$message.error(this.$t("common._common.oops_this_is_a_error_saving"))}))}else this.$message.error(this.$t("common._common.please_select_report_folder"))},cancel:function(){this.$emit("cancel")}}}),components_FSaveAsReportvue_type_script_lang_js=FSaveAsReportvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FSaveAsReportvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FSaveAsReport=component.exports},
/***/150406:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return EmailReport}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/report/forms/EmailReport.vue?vue&type=template&id=74708e0b
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"trend-dialog headernew",attrs:{visible:_vm.visibility,fullscreen:!0,"custom-class":"fc-dialog-right","before-close":_vm.close},on:{"update:visible":function($event){_vm.visibility=$event}}},[_c("div",{attrs:{id:"emailReport"}},[_c("div",{staticClass:"dialog-title title"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.email_this_report"))+" ")]),_c("div",{staticClass:"heading pT15",staticStyle:{float:"right"}},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.format"))+" "),_c("div",[_c("el-select",{staticClass:"email-format",model:{value:_vm.format,callback:function($$v){_vm.format=$$v},expression:"format"}},_vm._l(_vm.$constants.FILE_FORMAT,(function(label,value){return"Image"!==label?_c("el-option",{key:value,attrs:{label:label,value:parseInt(value)}}):_vm._e()})),1)],1)]),_c("div",{staticClass:"heading pT15 "},[_vm._v("To")]),_c("div",[_c("el-select",{staticClass:"filter-form",staticStyle:{width:"300px",overflow:"scroll"},attrs:{multiple:"",filterable:"","default-first-option":""},model:{value:_vm.mailJson.to,callback:function($$v){_vm.$set(_vm.mailJson,"to",$$v)},expression:"mailJson.to"}},_vm._l(_vm.users,(function(user){return user.inviteAcceptStatus?_c("el-option",{key:user.id,attrs:{label:user.name,value:user.id}},[_vm._v(_vm._s(user.name+" ("+user.email+")"))]):_vm._e()})),1)],1),_c("div",{staticClass:"heading pT15",staticStyle:{clear:"both"}},[_vm._v(" "+_vm._s(_vm.$t("maintenance.wr_list.subject"))+" ")]),_c("div",[_c("el-input",{attrs:{type:"text"},model:{value:_vm.mailJson.subject,callback:function($$v){_vm.$set(_vm.mailJson,"subject",$$v)},expression:"mailJson.subject"}})],1),_c("div",{staticClass:"heading pT15"},[_vm._v(" "+_vm._s(_vm.$t("setup.approvalprocess.description"))+" ")]),_c("div",[_c("el-input",{attrs:{type:"textarea",rows:3},model:{value:_vm.mailJson.message,callback:function($$v){_vm.$set(_vm.mailJson,"message",$$v)},expression:"mailJson.message"}})],1)]),_c("div",{staticClass:"modal-dialog-footer"},[_c("button",{staticClass:"modal-btn-cancel",attrs:{type:"button"},on:{click:_vm.close}},[_c("span",[_vm._v(_vm._s(_vm.$t("setup.users_management.cancel")))])]),_c("button",{staticClass:"modal-btn-save",attrs:{type:"button"},on:{click:_vm.sendMail}},[_c("span",[_vm._v(_vm._s(_vm.$t("common.wo_report.send")))])])])])},staticRenderFns=[],esm_typeof=__webpack_require__(103336),AnalyticsMixin=(__webpack_require__(434284),__webpack_require__(659749),__webpack_require__(386544),__webpack_require__(244936)),EmailReportvue_type_script_lang_js={props:["visibility","report","analyticsConfig"],mixins:[AnalyticsMixin/* default */.Z],data:function(){return{format:1,mailJson:{to:[],subject:this.report.options.name+"Report",message:"The following Report from "+this.$getProperty(window.brandConfig,"name","Facilio")+" has been mailed to you by "+this.$account.user.name+"\nReport name : "+this.report.options.name+"\nDescription: "+this.report.options.description+"\nDetailed report is available in the here. \n"+window.location.href+"\nRegards, \nTeam "+this.$getProperty(window.brandConfig,"name","Facilio")}}},mounted:function(){this.report&&this.report.options&&this.report.options.name&&(this.mailJson.subject=this.report.options.name+" Report",this.mailJson.message="Hi,\nThe report on "+this.report.options.name+"has been sent to you from "+this.$getProperty(window.brandConfig,"name","Facilio")+". Please have a look at "+window.location.href)},computed:{users:function(){return this.$store.state.users}},methods:{close:function(){this.$emit("update:visibility",!1)},sendMail:function(type){var self=this;if(this.mailJson.to.length&&this.mailJson.subject){var mailTemplate=this.$helpers.cloneObject(this.mailJson);this.$common.setUserMailWorkflow(this.mailJson.to,mailTemplate);var data={type:this.format,emailTemplate:mailTemplate};this.report?data.reportId=this.report.options.id:this.$helpers.extend(data,this.getExportParam(this.analyticsConfig)),this.$message({message:"Sending email...",duration:0}),this.close(),this.$http.post("/dashboard/sendReportMail",data).then((function(response){self.$message.closeAll(),"object"===(0,esm_typeof/* default */.Z)(response.data)?(self.$message({message:"Email sent successfully!",type:"success"}),self.mailJson.to=[],self.mailJson.subject="",self.mailJson.message=""):self.$message({message:"Email sending failed!",type:"error"})}))}}}},forms_EmailReportvue_type_script_lang_js=EmailReportvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(forms_EmailReportvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,EmailReport=component.exports},
/***/410108:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"f1c32ac6a1501ce55d7f2300b27d5e44.svg";
/***/},
/***/887025:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"d48efac97df00618be2544d7f1f74f91.svg";
/***/},
/***/341029:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"de70c08c169675a03d6f6f01e3ac8485.svg";
/***/},
/***/129816:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"dfcbbadf4f8f09681ad8f2de015afb01.svg";
/***/},
/***/629443:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"85ea53fd2628a4ae14c73fee9cb609a6.svg";
/***/},
/***/2175:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"7e35747b18170acc69a34bfa74280639.svg";
/***/},
/***/153813:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"9c716467b9890487a1b01493444e23c1.svg";
/***/},
/***/91677:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"d03d12044be501e3bdbdc83d030da718.svg";
/***/},
/***/717328:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"274def972329432efd7d03727bb5999c.svg";
/***/},
/***/413273:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"1f25d1b30ac0891c72ce35e280c7bdd4.svg";
/***/},
/***/570678:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"2ac77e7e49ce3d548023f1938bf0c314.svg";
/***/},
/***/928824:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"6a1913f5986e24342d2477d78bebbe25.svg";
/***/},
/***/467511:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"cefca6b5f1c23bbab335218af2a93316.svg";
/***/},
/***/71761:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"1286a23c6f12683d5209b7f870725c4e.svg";
/***/},
/***/709333:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"4996a0a169dce81b1a1f65b7449a9834.svg";
/***/},
/***/407826:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"187c798f2c8a54e79cbaafc1005755e6.svg";
/***/}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/54002.js.map