(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[10242],{
/***/201117:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FLookupFieldWrapper}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/FLookupFieldWrapper.vue?vue&type=template&id=0b196d62
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"lookup-wrapper"},[_vm.fieldObj.field?_c("FLookupField",{class:{"handle-wizard-icon":_vm.handleWizardIcon},attrs:{model:_vm.modelObj,field:_vm.fieldObj,disabled:_vm.disabled,siteId:_vm.siteId,hideLookupIcon:_vm.hideWizard,hideDropDown:_vm.hideDropDown,preHookFilterConstruction:_vm.filterConstruction,fetchOptionsOnLoad:_vm.fetchOptionsOnLoad,fetchOptionsMethod:_vm.fetchOptionsMethod},on:{"update:model":function($event){_vm.modelObj=$event},showLookupWizard:_vm.showLookupWizard,recordSelected:_vm.onRecordSelected}}):_c("el-input"),!_vm.hideWizard&&_vm.canShowLookupWizard?_c("div",[_c("FLookupFieldWizard",{attrs:{canShowLookupWizard:_vm.canShowLookupWizard,selectedLookupField:_vm.fieldObj,siteId:_vm.siteId,withReadings:_vm.withReadings},on:{"update:canShowLookupWizard":function($event){_vm.canShowLookupWizard=$event},"update:can-show-lookup-wizard":function($event){_vm.canShowLookupWizard=$event},setLookupFieldValue:_vm.setLookupFieldValue,showMainFieldSearch:function($event){return _vm.onWizardShow(!1)}}})],1):_vm._e()],1)},staticRenderFns=[],slicedToArray=__webpack_require__(554621),FLookupField=(__webpack_require__(879288),__webpack_require__(260228),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(450886),__webpack_require__(947522),__webpack_require__(670560),__webpack_require__(425728),__webpack_require__(434284),__webpack_require__(634338),__webpack_require__(891719),__webpack_require__(855048)),validation=__webpack_require__(990260),FLookupFieldWrappervue_type_script_lang_js={name:"f-lookup-field-wrapper",props:{value:[Number,String,Array],label:String,
// Label of selected value if any
formField:Object,field:Object,
// Pass field object if form field not available and field avaialble
moduleName:String,
// Pass module name and field name if field object not avaialble
fieldName:String,disabled:{type:Boolean,default:!1},siteId:Number,hideWizard:{type:Boolean,default:!1},hideDropDown:{type:Boolean,default:!1},fetchOptionsOnLoad:{type:Boolean,default:!0},fetchOptionsMethod:{type:Function},withReadings:Boolean,handleWizardIcon:{
// To handle wizard icon css
type:Boolean,default:!0},filterConstruction:{type:Function,default:function(field){return field.filters}}},components:{FLookupField:FLookupField/* default */.Z,FLookupFieldWizard:function(){return Promise.all(/* import() */[__webpack_require__.e(93208),__webpack_require__.e(50232),__webpack_require__.e(93765),__webpack_require__.e(95953),__webpack_require__.e(35309),__webpack_require__.e(18778),__webpack_require__.e(12303),__webpack_require__.e(84290),__webpack_require__.e(31721),__webpack_require__.e(64418),__webpack_require__.e(5603),__webpack_require__.e(57432),__webpack_require__.e(435),__webpack_require__.e(72230),__webpack_require__.e(94255),__webpack_require__.e(67683),__webpack_require__.e(44178),__webpack_require__.e(91132),__webpack_require__.e(20280),__webpack_require__.e(78256),__webpack_require__.e(22200),__webpack_require__.e(49081),__webpack_require__.e(89472),__webpack_require__.e(12085),__webpack_require__.e(55754),__webpack_require__.e(86494),__webpack_require__.e(3037),__webpack_require__.e(49908),__webpack_require__.e(22061),__webpack_require__.e(31602),__webpack_require__.e(73609),__webpack_require__.e(99751),__webpack_require__.e(42054)]).then(__webpack_require__.bind(__webpack_require__,499751))}},data:function(){return{fieldObj:{isDataLoading:!1,options:[],lookupModuleName:"",field:null,filters:{},isDisabled:!1},canShowLookupWizard:!1}},computed:{modelObj:{get:function(){return(0,validation/* isEmpty */.xb)(this.value)?this.value:(0,validation/* isArray */.kJ)(this.value)?this.value.map((function(val){return parseInt(val)})):parseInt(this.value)},set:function(value){this.$emit("input",value)}}},created:function(){this.handleDefaultOption()},mounted:function(){var formField=this.formField,field=this.field;(0,validation/* isEmpty */.xb)(formField)?(0,validation/* isEmpty */.xb)(field)?this.fetchField():this.setField(field):this.fieldObj=formField},watch:{canShowLookupWizard:function(value){value||this.onWizardShow(value)}},methods:{showLookupWizard:function(field,canShow){this.fieldObj=field,this.canShowLookupWizard=canShow,this.onWizardShow(!0)},setLookupFieldValue:function(props){var _this=this,field=props.field,_ref=field||{},multiple=_ref.multiple,selectedItems=_ref.selectedItems;if(multiple){var valueArr=[];selectedItems.forEach((function(item){var value=item.value,label=item.label;_this.addOption(value,label),valueArr.push(value)})),this.modelObj=valueArr,this.onRecordSelected(selectedItems,valueArr)}else{var _ref2=selectedItems||[],_ref3=(0,slicedToArray/* default */.Z)(_ref2,1),selectedItem=_ref3[0],value=selectedItem.value,label=selectedItem.label;this.addOption(value,label),this.modelObj=value,this.onRecordSelected(selectedItem)}this.onWizardShow(!1)},onWizardShow:function(show){this.$emit("showingLookupWizard",show)},fetchField:function(){var _this2=this,moduleName=this.moduleName,fieldName=this.fieldName;this.$util.loadModuleMeta(moduleName).then((function(meta){var field=meta.fields.find((function(field){return field.name===fieldName}));_this2.setField(field)}))},onRecordSelected:function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];this.$emit.apply(this,["recordSelected"].concat(args))},handleDefaultOption:function(){var label=this.label,value=this.value;(0,validation/* isEmpty */.xb)(label)||(0,validation/* isEmpty */.xb)(value)||this.addOption(value,label)},setField:function(field){var fieldObj=this.fieldObj;fieldObj.field=field,fieldObj.multiple=field.multiple,fieldObj.lookupModuleName=field.lookupModule.name,(0,validation/* isArray */.kJ)(this.modelObj)?fieldObj.selectedItems=this.modelObj.map((function(id){return{value:id}})):fieldObj.selectedItems={value:this.modelObj}},addOption:function(id,label){var fieldObj=this.fieldObj,options=fieldObj.options,newOptionObj={label:label,value:id};(0,validation/* isEmpty */.xb)(options)?options.push(newOptionObj):options.some((function(option){return option.value===id}))||options.unshift(newOptionObj),this.$set(this.fieldObj,"options",options)}}},components_FLookupFieldWrappervue_type_script_lang_js=FLookupFieldWrappervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FLookupFieldWrappervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FLookupFieldWrapper=component.exports},
/***/507008:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FPopover}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/FPopover.vue?vue&type=template&id=878762a4
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-popover",{ref:_vm.getRef,attrs:{"popper-class":"f-popover",width:_vm.width||""===_vm.width?_vm.width:280,placement:_vm.placement,trigger:_vm.trigger||"click",hide:"hide"},on:{show:function(){return _vm.$emit("show")}},model:{value:_vm.showpopover,callback:function($$v){_vm.showpopover=$$v},expression:"showpopover"}},[_c("div",{staticClass:"fc-popover-content"},[_vm._t("header",(function(){return[_c("div",{staticClass:"title uppercase f12 bold",staticStyle:{"letter-spacing":"1.1px",color:"#000000"}},[_vm._v(" "+_vm._s(_vm.title)+" ")])]})),_c("div",[_vm._t("content")],2)],2),_c("div",{staticClass:"f-footer row",staticStyle:{height:"46px"}},[_vm._t("footer",(function(){return[_c("button",{staticClass:"footer-btn footer-btn-secondary col-6",attrs:{type:"button"},on:{click:_vm.cancel}},[_c("span",[_vm._v(_vm._s(_vm.$t("setup.users_management.cancel")))])]),_c("button",{staticClass:"footer-btn footer-btn-primary col-6",attrs:{type:"button"},on:{click:_vm.save}},[_c("span",[_vm._v(_vm._s(_vm.confirmTitle?_vm.confirmTitle:_vm.$t("common._common.ok")))])])]}))],2),_c("template",{slot:"reference"},[_vm._t("reference")],2)],2)},staticRenderFns=[],FPopovervue_type_script_lang_js={props:["popperClass","placement","value","popperRef","trigger","title","width","maxHeight","confirmTitle"],data:function(){return{showpopover:!1}},watch:{showpopover:function(val){null!=this.value&&this.$emit("input",val)},value:function(val){this.showpopover=val}},mounted:function(){var element=this.$refs[this.getRef].$el;if(this.popperClass&&element.firstElementChild.classList.add(this.popperClass),this.maxHeight){var content=element.querySelector(".fc-popover-content");content.classList.add("scrollable"),content.style["max-height"]=this.maxHeight+"px"}},computed:{getRef:function(){return this.popperRef?this.popperRef:"fpopup"}},methods:{save:function(){this.showpopover=!1,this.$emit("save")},cancel:function(){this.showpopover=!1,this.$emit("close")},hide:function(){this.$emit("hide")}}},components_FPopovervue_type_script_lang_js=FPopovervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FPopovervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FPopover=component.exports},
/***/604947:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return Spinner}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/Spinner.vue?vue&type=template&id=06a81286&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("transition",[_c("svg",{directives:[{name:"show",rawName:"v-show",value:_vm.show,expression:"show"}],staticClass:"spinner",class:{show:_vm.show},attrs:{width:_vm.spinnerSize,height:_vm.spinnerSize,viewBox:"0 0 44 44"}},[_c("circle",{staticClass:"path",style:{stroke:_vm.strokeColor},attrs:{fill:"none","stroke-width":"4","stroke-linecap":"round",cx:"22",cy:"22",r:"20"}})])])},staticRenderFns=[],Spinnervue_type_script_lang_js={name:"spinner",props:["show","size","colour"],computed:{spinnerSize:function(){return this.size?this.size+"px":"50px"},strokeColor:function(){return this.colour?this.colour:"#fd4b92"}}},components_Spinnervue_type_script_lang_js=Spinnervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_Spinnervue_type_script_lang_js,render,staticRenderFns,!1,null,"06a81286",null)
/* harmony default export */,Spinner=component.exports},
/***/855048:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FLookupField}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/forms/FLookupField.vue?vue&type=template&id=473d4b8e
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.isFieldLoading?_c("FieldLoader",{attrs:{isLoading:_vm.isFieldLoading}}):_c("div",{staticClass:"f-lookup-chooser f-lookup-chooser-container"},[_c("el-select",{ref:"selectBox",class:["fc-input-full-border-select2 width100",(!_vm.canHideLookupIcon||_vm.canShowQuickCreateIcon)&&"resource-search",_vm.isMultiple&&"fc-tag",_vm.hideDropDown&&!_vm.disabled&&"skip-disable"],attrs:{"collapse-tags":"",remote:_vm.isRemote,filterable:"",clearable:_vm.canHideLookupIcon,multiple:_vm.isMultiple,popperAppendToBody:_vm.popperAppendToBody,"remote-method":function(searchText){return _vm.remoteMethod(searchText)},loading:_vm.field.isDataLoading,"loading-text":_vm.$t("common._common.searching"),disabled:_vm.disabled||_vm.hideDropDown,placeholder:_vm.field.placeHolderText||"Select"},on:{change:_vm.recordSelected},model:{value:_vm.modelObj,callback:function($$v){_vm.modelObj=$$v},expression:"modelObj"}},[_c("div",{staticClass:"flRight d-flex",class:!_vm.disabled&&"pointer",attrs:{slot:"prefix"},slot:"prefix"},[_vm.canShowSystemClear?_c("div",{staticClass:"flookup-remove-icon-alignment flookup-remove-icon",on:{click:_vm.clearData}},[_c("i",{staticClass:"el-icon-circle-close pointer fc-lookup-icon f13"})]):_vm._e(),_vm.canHideLookupIcon?_vm._e():_c("div",{staticClass:"icon-class-alignment",on:{click:function($event){return $event.stopPropagation(),_vm.openLookupFieldWizard(_vm.field)}}},[_c("inline-svg",{attrs:{src:"lookup",iconClass:"icon icon-sm-md fc-lookup-icon"}})],1),_vm.canShowQuickCreateIcon?_c("div",{staticClass:"icon-class-alignment",on:{click:function($event){return $event.stopPropagation(),_vm.openQuickCreate()}}},[_c("el-tooltip",{attrs:{effect:"dark",content:"Add\n          "+_vm.moduleDisplayName,placement:"top"}},[_c("inline-svg",{attrs:{src:"add-pink",iconClass:"icon icon-sm-md fc-lookup-icon"}})],1)],1):_vm._e()]),_vm._l(_vm.field.options,(function(option,index){return _c("el-option",{key:option.value+" "+index,staticClass:"fc-input-full-border-select2 width100",attrs:{label:option.label,value:option.value}},[_c("span",{staticClass:"fL"},[_vm._v(_vm._s(option.label))]),_vm.$validation.isEmpty(option.secondaryLabel)?_vm._e():_c("span",{staticClass:"select-float-right-text13"},[_vm._v(_vm._s(option.secondaryLabel))]),_vm.getIsSiteDecommissioned(option)?_c("span",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"select-float-right-text13 pL10",attrs:{title:_vm.$t("setup.decommission.decommissioned")}},[_c("fc-icon",{staticClass:"fR pT10",attrs:{group:"alert",name:"decommissioning",size:"16"}})],1):_vm._e()])}))],2),_vm.showQuickCreateData?_c("QuickCreateData",{attrs:{canShowDialog:_vm.showQuickCreateData,quickCreateField:_vm.field,setAddedRecord:_vm.setAddedRecord},on:{"update:canShowDialog":function($event){_vm.showQuickCreateData=$event},"update:can-show-dialog":function($event){_vm.showQuickCreateData=$event}}}):_vm._e()],1)},staticRenderFns=[],objectSpread2=__webpack_require__(595082),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),toConsumableArray=__webpack_require__(488478),validation=(__webpack_require__(879288),__webpack_require__(260228),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(434284),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(450886),__webpack_require__(538077),__webpack_require__(425728),__webpack_require__(634338),__webpack_require__(990260)),constant=__webpack_require__(354754),picklist=__webpack_require__(961358),field_utils=__webpack_require__(455344),FieldLoader=__webpack_require__(62979),isEqual=__webpack_require__(618446),isEqual_default=__webpack_require__.n(isEqual),LOOKUP_FIELD_PLACEHOLDER_MAP={people:{value:"${LOGGED_PEOPLE}",label:"Current User"},users:{value:"${LOGGED_USER}",label:"Current User"}},FLookupFieldvue_type_script_lang_js={name:"f-lookup-field",props:{model:{},field:{type:Object},disabled:{type:Boolean},siteId:{type:[Number,String]},categoryId:{type:Number},hideLookupIcon:{type:Boolean,default:!1},popperAppendToBody:{required:!1,type:Boolean,default:!0},fetchOptionsOnLoad:{type:Boolean,default:!0},fetchOptionsMethod:{type:Function},preHookFilterConstruction:{type:Function,default:function(field){return field.filters}},hideDropDown:{type:Boolean,default:!1},skipLoading:{type:Boolean,default:!1},isClearable:{type:Boolean,default:!0},userfilmoduleEnum:{type:String},parentModuleId:{type:Number},selectedOptions:{type:Array}},components:{FieldLoader:FieldLoader/* default */.Z,QuickCreateData:function(){return Promise.all(/* import() */[__webpack_require__.e(93208),__webpack_require__.e(50232),__webpack_require__.e(93765),__webpack_require__.e(95953),__webpack_require__.e(35309),__webpack_require__.e(18778),__webpack_require__.e(12303),__webpack_require__.e(84290),__webpack_require__.e(31721),__webpack_require__.e(64418),__webpack_require__.e(5603),__webpack_require__.e(57432),__webpack_require__.e(435),__webpack_require__.e(72230),__webpack_require__.e(94255),__webpack_require__.e(67683),__webpack_require__.e(44178),__webpack_require__.e(91132),__webpack_require__.e(20280),__webpack_require__.e(78256),__webpack_require__.e(22200),__webpack_require__.e(49081),__webpack_require__.e(89472),__webpack_require__.e(12085),__webpack_require__.e(55754),__webpack_require__.e(86494),__webpack_require__.e(3037),__webpack_require__.e(49908),__webpack_require__.e(22061),__webpack_require__.e(31602),__webpack_require__.e(73609),__webpack_require__.e(41323),__webpack_require__.e(99751),__webpack_require__.e(11305),__webpack_require__.e(80390),__webpack_require__.e(89142),__webpack_require__.e(97770),__webpack_require__.e(76422),__webpack_require__.e(99813)]).then(__webpack_require__.bind(__webpack_require__,676433))}},data:function(){return{localSearch:!1,isLoadedOnce:!1,currentModelValue:!1,showQuickCreateData:!1}},computed:{customOptions:function(){var _ref=this||{},field=_ref.field,_ref2=field||{},lookupModule=_ref2.lookupModule;if((0,validation/* isEmpty */.xb)(lookupModule))return[];var _ref3=lookupModule||{},name=_ref3.name;return(0,validation/* isEmpty */.xb)(LOOKUP_FIELD_PLACEHOLDER_MAP[name])?[]:[LOOKUP_FIELD_PLACEHOLDER_MAP[name]]},modelObj:{get:function(){return this.model},set:function(value){this.currentModelValue=value,this.$emit("update:model",value)}},moduleDisplayName:function(){var field=this.field,_ref4=field.field||{},lookupModule=_ref4.lookupModule,_ref5=lookupModule||{},displayName=_ref5.displayName;return displayName},isFieldLoading:function(){var field=this.field,defaultIds=this.defaultIds,skipLoading=this.skipLoading,isLoadedOnce=this.isLoadedOnce;return!skipLoading&&!isLoadedOnce&&!(0,validation/* isEmpty */.xb)(defaultIds)&&field.isDataLoading},isPickListTypeModule:function(){var field=this.field,fieldObj=field.field,_ref6=fieldObj||field,lookupModule=_ref6.lookupModule,_ref7=lookupModule||{},type=_ref7.type;
// type 1 is for base entity modules
return!!type&&1!==type},isRemote:function(){var localSearch=this.localSearch;return!localSearch},canHideLookupIcon:function(){var hideLookupIcon=this.hideLookupIcon,isPickListTypeModule=this.isPickListTypeModule,hideDropDown=this.hideDropDown,field=this.field,userfilmoduleEnum=this.userfilmoduleEnum,_ref8=field||{},config=_ref8.config,canHide=!1;if(!(0,validation/* isEmpty */.xb)(config)){var canShowLookupWizard=this.$getProperty(config,"canShowLookupWizard",null);(0,validation/* isNull */.Ft)(canShowLookupWizard)||(canHide=!canShowLookupWizard)}return!hideDropDown&&("PICK_LIST"===userfilmoduleEnum||(canHide||hideLookupIcon||isPickListTypeModule))},canShowQuickCreateIcon:function(){var disabled=this.disabled,field=this.field,_ref9=field||{},config=_ref9.config,canShow=!1;return(0,validation/* isEmpty */.xb)(config)||(canShow=this.$getProperty(config,"canShowQuickCreate")),disabled&&(canShow=!1),canShow},isSiteEnabled:function(){var siteId=Number(this.$cookie.get("fc.currentSite")),currentSiteId=siteId>0?siteId:-1;return!(0,validation/* isEmpty */.xb)(currentSiteId)},isMultiple:function(){var field=this.field;return!!field.multiple},resourceModuleName:function(){var field=this.field,config=field.config,lookupModuleName=field.lookupModuleName,_ref10=config||{},isFiltersEnabled=_ref10.isFiltersEnabled,filterValue=_ref10.filterValue;if(isFiltersEnabled&&constant/* default */.Z.LOOKUP_FILTER_ENABLED_FIELDS.includes(lookupModuleName)){var moduleName=constant/* default */.Z.LOOKUP_FILTERS_MAP[filterValue];return moduleName}return null},isResourceField:function(){var field=this.field,name=field.name,isResourceField=(0,field_utils/* isChooserTypeField */.Rq)(field)||"resource"===name;return isResourceField},
// To prefill the existing values, we have to send default ids in picklist api
defaultIds:function(){var modelObj=this.modelObj,selectedOptions=this.selectedOptions,isPlaceHoldersEnabled=constant/* default */.Z.FIELD_PLACEHOLDERS.includes(modelObj)||!1,defaultIds=[],selectedOptionsArr=(selectedOptions||[]).map((function(option){return parseInt(option)}));return(0,validation/* isEmpty */.xb)(selectedOptions)?(0,validation/* isEmpty */.xb)(modelObj)||isPlaceHoldersEnabled||(defaultIds=(0,validation/* isArray */.kJ)(modelObj)?(0,toConsumableArray/* default */.Z)(modelObj):[modelObj]):defaultIds=(0,toConsumableArray/* default */.Z)(selectedOptionsArr),defaultIds=defaultIds.filter((function(val){return!constant/* default */.Z.FIELD_PLACEHOLDERS.includes(val)})),defaultIds},operatorLookupModule:function(){var field=this.field,_ref11=field||{},operatorLookupModule=_ref11.operatorLookupModule;return operatorLookupModule||{}},skipSiteFilter:function(){var field=this.field,_ref12=field||{},config=_ref12.config,_ref13=config||{},_ref13$skipSiteFilter=_ref13.skipSiteFilter,skipSiteFilter=void 0!==_ref13$skipSiteFilter&&_ref13$skipSiteFilter;return skipSiteFilter},canShowSystemClear:function(){var canHideLookupIcon=this.canHideLookupIcon,isClearable=this.isClearable,modelObj=this.modelObj,disabled=this.disabled;return!canHideLookupIcon&&!disabled&&(isClearable&&!(0,validation/* isEmpty */.xb)(modelObj))}},watch:{model:function(newVal){var _this=this,currentModelValue=this.currentModelValue,isRemote=this.isRemote;isEqual_default()(newVal,currentModelValue)||(isRemote&&this.getOptions({initialFetch:!0}).then((function(options){_this.$set(_this.field,"options",options)})),this.$set(this,"modelObj",newVal))},siteId:{handler:function(newVal,oldVal){var _this2=this,isSiteEnabled=this.isSiteEnabled,skipSiteFilter=this.skipSiteFilter;skipSiteFilter||isSiteEnabled||newVal===oldVal||this.getOptions({initialFetch:!0}).then((function(options){_this2.$set(_this2.field,"options",options)}))}},parentModuleId:{handler:function(newVal,oldVal){var _this3=this;newVal!==oldVal&&this.getOptions({initialFetch:!0}).then((function(options){_this3.$set(_this3.field,"options",options)}))}},operatorLookupModule:{handler:function(newVal,oldVal){var _this4=this;isEqual_default()(newVal,oldVal)||this.getOptions({initialFetch:!0}).then((function(options){_this4.$set(_this4.field,"options",options)}))}},"field.clientCriteria":{handler:function(newVal,oldVal){var _this5=this;isEqual_default()(newVal,oldVal)||this.getOptions({initialFetch:!0}).then((function(options){_this5.$set(_this5.field,"options",options)}))}},categoryId:{handler:function(newVal,oldVal){var _this6=this;isEqual_default()(newVal,oldVal)||this.getOptions({initialFetch:!0}).then((function(options){_this6.$set(_this6.field,"options",options)}))}},"field.options":{handler:function(value){var modelObj=this.modelObj;if(!(0,validation/* isEmpty */.xb)(value))if((0,validation/* isEmpty */.xb)(modelObj))this.field.selectedItems=[];else if((0,validation/* isArray */.kJ)(modelObj)){var selectedItems=value.filter((function(option){return modelObj.includes(option.value)}));this.field.selectedItems=selectedItems}else{var selectedItem=value.find((function(option){return option.value===modelObj}));this.field.selectedItems=[selectedItem]}},immediate:!0},isLoadedOnce:{handler:function(value){value&&this.$emit("optionsLoadedOnce")}}},created:function(){var _this7=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var fetchOptionsOnLoad,field,modelObj,customOptions,options;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:
// Have to skip fetching options initially, when module is 'resource' and filters is not enabled
if(fetchOptionsOnLoad=_this7.fetchOptionsOnLoad,field=_this7.field,modelObj=_this7.modelObj,customOptions=_this7.customOptions,_this7.currentModelValue=modelObj,_this7.getIsSiteDecommissioned=picklist/* getIsSiteDecommissioned */.Yx,!fetchOptionsOnLoad){_context2.next=12;break}return _context2.next=6,_this7.getOptions({initialFetch:!0});case 6:if(_context2.t0=_context2.sent,_context2.t0){_context2.next=9;break}_context2.t0=[];case 9:options=_context2.t0,_this7.$set(_this7.field,"options",[].concat((0,toConsumableArray/* default */.Z)(customOptions),(0,toConsumableArray/* default */.Z)(options))),_this7.$set(_this7,"isLoadedOnce",!0);case 12:_this7.remoteMethod=_this7.$helpers.debounce(function(){var _ref14=(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(searchText){var isDataLoading,_options;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(isDataLoading=field.isDataLoading,isDataLoading){_context.next=6;break}return _context.next=4,_this7.getOptions({searchText:searchText});case 4:_options=_context.sent,_this7.$set(_this7.field,"options",_options);case 6:case"end":return _context.stop()}}),_callee)})));return function(_x){return _ref14.apply(this,arguments)}}(),1e3);case 13:case"end":return _context2.stop()}}),_callee2)})))()},methods:{focus:function(){(0,validation/* isEmpty */.xb)(this.$refs["selectBox"])||this.$refs["selectBox"].focus()},getOptions:function(params){var _this8=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var searchText,initialFetch,fetchOptionsMethod,field,siteId,categoryId,isRemote,defaultIds,resourceModuleName,isResourceField,skipSiteFilter,selectedOptions,_field$filters,fieldFilters,options,filters,props,perPageCount,_yield$_this8$fetchOp,_yield$_this8$fetchOp2,optionsArr,error,_ref15,message,_yield$getFieldOption,_yield$getFieldOption2,_optionsArr,_error,meta,_ref16,_message,_meta$localSearch,localSearch;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:
/*
                Have to return empty options if field is of resourcetype, if filters havent be enabled
                and if no values selected already
              */
if(searchText=params.searchText,initialFetch=params.initialFetch,fetchOptionsMethod=_this8.fetchOptionsMethod,field=_this8.field,siteId=_this8.siteId,categoryId=_this8.categoryId,isRemote=_this8.isRemote,defaultIds=_this8.defaultIds,resourceModuleName=_this8.resourceModuleName,isResourceField=_this8.isResourceField,skipSiteFilter=_this8.skipSiteFilter,selectedOptions=_this8.selectedOptions,_field$filters=field.filters,fieldFilters=void 0===_field$filters?{}:_field$filters,options=[],(0,validation/* isEmpty */.xb)(resourceModuleName)||(field.resourceLookupModuleName=resourceModuleName),filters=_this8.preHookFilterConstruction(field),(0,validation/* isEmpty */.xb)(filters)||(field.filters=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},fieldFilters),filters)),(0,validation/* isEmpty */.xb)(categoryId)||(field.filters=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},field.filters),{},{category:{operator:"is",value:["".concat(categoryId)]}})),props={field:field,searchText:searchText},skipSiteFilter||(props=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},props),{},{siteId:siteId})),!(isResourceField&&(0,validation/* isEmpty */.xb)(resourceModuleName)&&(0,validation/* isEmpty */.xb)(defaultIds))){_context3.next=12;break}return _context3.abrupt("return",options);case 12:if(initialFetch&&isRemote&&(perPageCount=defaultIds.length>50?defaultIds.length:50,props=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},props),{},{page:1,perPage:perPageCount,defaultIds:defaultIds}),((0,validation/* isEmpty */.xb)(resourceModuleName)&&isResourceField||!(0,validation/* isEmpty */.xb)(selectedOptions))&&(
// Have to fetch only selected values, which is same as the number of defaultids
props=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},props),{},{perPage:defaultIds.length}))),_this8.$set(field,"isDataLoading",!0),(0,validation/* isEmpty */.xb)(fetchOptionsMethod)){_context3.next=25;break}return _context3.next=17,_this8.fetchOptionsMethod(props);case 17:_yield$_this8$fetchOp=_context3.sent,_yield$_this8$fetchOp2=_yield$_this8$fetchOp.options,optionsArr=void 0===_yield$_this8$fetchOp2?[]:_yield$_this8$fetchOp2,error=_yield$_this8$fetchOp.error,error&&(_ref15=error||{},message=_ref15.message,_this8.$message.error(message||"Error Occured")),options=optionsArr,_context3.next=35;break;case 25:return _context3.next=27,(0,picklist/* getFieldOptions */._K)(props);case 27:_yield$getFieldOption=_context3.sent,_yield$getFieldOption2=_yield$getFieldOption.options,_optionsArr=void 0===_yield$getFieldOption2?[]:_yield$getFieldOption2,_error=_yield$getFieldOption.error,meta=_yield$getFieldOption.meta,_error&&(_ref16=_error||{},_message=_ref16.message,_this8.$message.error(_message||"Error Occured")),meta&&(0,validation/* isEmpty */.xb)(searchText)&&(_meta$localSearch=meta.localSearch,localSearch=void 0!==_meta$localSearch&&_meta$localSearch,_this8.$set(_this8,"localSearch",localSearch)),options=_optionsArr;case 35:return _this8.$set(field,"isDataLoading",!1),_context3.abrupt("return",options);case 37:case"end":return _context3.stop()}}),_callee3)})))()},clearData:function(){this.$emit("update:model",""),this.recordSelected("")},recordSelected:function(value){var field=this.field,_this$field$options=this.field.options,options=void 0===_this$field$options?[]:_this$field$options,isMultiple=this.isMultiple,selectedValues=null;isMultiple?(selectedValues=options.filter((function(e){return(value||[]).includes(e.value)})),field.selectedItems=selectedValues):(selectedValues=options.find((function(e){return e.value==value}))||{},field.selectedItems=[],(0,validation/* isEmpty */.xb)(selectedValues)||(field.selectedItems=[selectedValues])),this.$emit("recordSelected",selectedValues,field)},openLookupFieldWizard:function(field){var disabled=this.disabled;disabled||this.$emit("showLookupWizard",field,!0)},openQuickCreate:function(){var disabled=this.disabled;disabled||(this.showQuickCreateData=!0)},setAddedRecord:function(props){var record=props.record,_ref17=record||{},id=_ref17.id,name=record.displayName||record.name||record.subject,field=this.field;field.selectedItems=[{value:id,label:name}],this.$emit("setLookupFieldValue",{field:(0,objectSpread2/* default */.Z)({},field)})}}},forms_FLookupFieldvue_type_script_lang_js=FLookupFieldvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(forms_FLookupFieldvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FLookupField=component.exports},
/***/62979:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FieldLoader}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/forms/FieldLoader.vue?vue&type=template&id=7252e23e
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.isLoading?_c("div",{staticClass:"field-loading loading-shimmer"}):_vm._e()},staticRenderFns=[],FieldLoadervue_type_script_lang_js={props:{isLoading:{type:Boolean,required:!0}}},forms_FieldLoadervue_type_script_lang_js=FieldLoadervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(forms_FieldLoadervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FieldLoader=component.exports},
/***/929593:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FPagination}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/list/FPagination.vue?vue&type=template&id=7641710c&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_vm.total>0?_c("div",{staticClass:"flex-center-row-space mT-5",class:{"fc-black-small-txt-12":!_vm.hideToggle}},[_c("el-popover",{attrs:{placement:"bottom",trigger:"click",disabled:_vm.disablePopup}},[_c("span",{staticClass:"p8 pointer",class:[!_vm.disablePopup&&"button-hover"],attrs:{slot:"reference"},slot:"reference"},[_vm.from!==_vm.to?_c("span",[_vm._v(_vm._s(_vm.from)+" - ")]):_vm._e(),_c("span",[_vm._v(_vm._s(_vm.to))]),_vm._v(" of "+_vm._s(_vm.total)+" ")]),_c("el-pagination",{attrs:{layout:"prev, pager, next",total:_vm.total,"pager-count":5,"page-size":_vm.perPage,"current-page":_vm.page},on:{"current-change":_vm.handleCurrentChange,"update:pageSize":function($event){_vm.perPage=$event},"update:page-size":function($event){_vm.perPage=$event},"update:currentPage":function($event){_vm.page=$event},"update:current-page":function($event){_vm.page=$event}}})],1),_vm.hideToggle?_vm._e():_c("span",[_c("span",{staticClass:"el-icon-arrow-left pagination-arrow fc-black-small-txt-12 f16 fw-bold pointer p5",class:{disable:_vm.from<=1},on:{click:function($event){_vm.from>1&&_vm.prev()}}}),_c("span",{staticClass:"el-icon-arrow-right pagination-arrow fc-black-small-txt-12 f16 fw-bold pointer p5",class:{disable:_vm.to===_vm.total},on:{click:function($event){_vm.to!==_vm.total&&_vm.next()}}})])],1):_vm._e()])},staticRenderFns=[],router=(__webpack_require__(879288),__webpack_require__(670560),__webpack_require__(329435)),FPaginationvue_type_script_lang_js={props:{total:[Number,String],perPage:Number,hideToggle:{type:Boolean,default:!1},pageNo:Number,hidePopover:{type:Boolean,default:!1}},data:function(){return{from:0,to:0,page:1}},created:function(){(0,router/* isWebTabsEnabled */.tj)()&&document.addEventListener("keydown",this.keyDownHandler)},mounted:function(){this.init()},beforeDestroy:function(){(0,router/* isWebTabsEnabled */.tj)()&&document.removeEventListener("keydown",this.keyDownHandler)},computed:{pageQuery:function(){var _ref=this.$route||{},query=_ref.query,_ref2=query||{},page=_ref2.page;return parseInt(page)||1},hasMorePage:function(){return this.total/this.perPage>1},disablePopup:function(){return this.hidePopover||!this.hasMorePage}},watch:{total:function(){this.init()},pageQuery:function(){this.init()}},methods:{init:function(){if(this.page=this.pageQuery,this.from=(this.page-1)*this.perPage+1,this.from>this.total&&this.from&&this.from>0&&this.total&&this.total>0)this.reset();else{var to=this.from+this.perPage-1;this.to=this.total>to?to:this.total}},handleCurrentChange:function(val){this.page=val,this.from=(this.page-1)*this.perPage+1,this.to=this.total>=this.from+this.perPage?this.from+this.perPage-1:this.total,this.setPage()},next:function(){this.from=this.to+1,this.to+=this.perPage,this.to>this.total&&(this.to=this.total),this.page++,this.setPage()},prev:function(){this.to=this.from-1,this.from-=this.perPage,this.from<=1?this.from=this.page=1:this.page--,this.setPage()},reset:function(){this.page=1,this.setPage(!0)},setPage:function(isReset){if(this.pageNo)this.$emit("onPageChanged",this.page);else{var query={};Object.assign(query,this.$route.query),query?query.page=this.page:query={page:this.page},this.$router.push({query:query}),isReset||this.$emit("onPageChanged",this.page)}},keyDownHandler:function(e){e.shiftKey&&("ArrowRight"===e.key&&this.to!==this.total?this.next():"ArrowLeft"===e.key&&this.from>1&&this.prev())}}},list_FPaginationvue_type_script_lang_js=FPaginationvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(list_FPaginationvue_type_script_lang_js,render,staticRenderFns,!1,null,"7641710c",null)
/* harmony default export */,FPagination=component.exports},
/***/283938:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FNewHeatMap}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/energy/analytics/components/FNewHeatMap.vue?vue&type=template&id=7e6f8403
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return 0!==_vm.heatMapStore.length?_c("div",{staticClass:"height100 heatmap"},[_vm.hidecharttypechanger?_vm._e():_c("f-chart-type",{staticClass:"charttypechanger fc-new-chart-type-single",attrs:{options:this.reportObject?this.reportObject.options:null},on:{getOptions:_vm.getOptionsFromTypeChart}}),_c("div",{ref:"heatmapDiv",staticClass:"height100"})],1):_vm._e()},staticRenderFns=[],createForOfIteratorHelper=__webpack_require__(566347),d3=(__webpack_require__(670560),__webpack_require__(450886),__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(865137),__webpack_require__(976801),__webpack_require__(348727)),FChartType=__webpack_require__(294309),ReportDataUtil=__webpack_require__(760396),ckmeans_min=__webpack_require__(196009),tooltip=(__webpack_require__(114769),__webpack_require__(460895)),moment_timezone=__webpack_require__(480008),moment_timezone_default=__webpack_require__.n(moment_timezone),vue_runtime_esm=__webpack_require__(720144),FNewHeatMapvue_type_script_lang_js={data:function(){return{constantMargins:{top:30,right:55,bottom:100,left:55},clientWidth:980,clientHeight:620,cellWidth:50,cellHeight:30,xformat:"hours",hidecharttypechanger:!0,gridSize:0,xAlias:null,yAliasList:[],updateTimeout:null,heatMapStore:[],selectedLabel:null,groupLabels:[],defaultColors:["#1d7f01","#6cb302","#e9f501","#fda504","#fb5905"]}},mixins:[ReportDataUtil/* default */.Z],components:{FChartType:FChartType/* default */.Z},mounted:function(){this.render()},props:["resultObject","reportObject","config","width","height"],computed:{chosenColors:function(){if(this.reportObject.options.heatMapOptions){var key=this.reportObject.options.heatMapOptions.chosenColors;return this.reportObject.options.heatMapOptions.Colors[key]}return this.defaultColors},heatMapMinValue:function(){return this.reportObject.options.heatMapOptions&&null!==this.reportObject.options.heatMapOptions.minValue&&""!==this.reportObject.options.heatMapOptions.minValue?this.reportObject.options.heatMapOptions.minValue:null},heatMapMaxValue:function(){return this.reportObject.options.heatMapOptions&&null!==this.reportObject.options.heatMapOptions.maxValue&&""!==this.reportObject.options.heatMapOptions.maxValue?this.reportObject.options.heatMapOptions.maxValue:null}},methods:{render:function(){var _this=this;this.reportObject&&(this.loadHeatMapStore(),this.$nextTick((function(){if(_this.resultObject){var _step,_iterator=(0,createForOfIteratorHelper/* default */.Z)(_this.resultObject.report.dataPoints);try{for(_iterator.s();!(_step=_iterator.n()).done;){var dataPoint=_step.value;_this.yAliasList.push(dataPoint.aliases.actual)}}catch(err){_iterator.e(err)}finally{_iterator.f()}_this.xAlias="x"}_this.drawHeatMap()})))},loadHeatMapStore:function(){this.heatMapStore=this.reportObject.options.dataPoints},resize:function(){this.rerender()},rerender:function(){var _this2=this;this.updateTimeout&&clearTimeout(this.updateTimeout),this.updateTimeout=setTimeout((function(){return _this2.render()}),500)},groupValues:function(minValue,maxValue,n){for(var deviation=(maxValue-minValue)/n,group=[],i=0;i<n;i++){var temp=minValue+i*deviation;group.push(temp)}return group},drawHeatMap:function(){var _this3=this;Date.now();this.$mobile&&(this.constantMargins.left=30,this.constantMargins.right=20,this.constantMargins.top=10);var _step2,width=(null!==this.width&&this.width>0?this.width:this.clientWidth)-(this.constantMargins.left+this.constantMargins.right),height=(null!==this.height&&this.height>0?this.height:this.clientHeight)-(this.constantMargins.top+this.constantMargins.bottom),dataPoints=this.resultObject.report.dataPoints,_iterator2=(0,createForOfIteratorHelper/* default */.Z)(dataPoints);try{var _loop=function(){var dp=_step2.value,unit=(dataPoints.indexOf(dp),null!==dp.yAxis.unitStr?dp.yAxis.unitStr:" "),isContinous=5===_this3.resultObject.report.dataPoints[0].xAxis.dataType||6===_this3.resultObject.report.dataPoints[0].xAxis.dataType,dataAlias=dp.aliases.actual,yMax=_this3.resultObject.reportData.aggr[dataAlias+".max"],yMin=_this3.resultObject.reportData.aggr[dataAlias+".min"];yMin=_this3.reportObject.options.heatMapOptions&&null!==_this3.reportObject.options.heatMapOptions.minValue&&""!==_this3.reportObject.options.heatMapOptions.minValue?_this3.reportObject.options.heatMapOptions.minValue:yMin,yMax=_this3.reportObject.options.heatMapOptions&&null!=_this3.reportObject.options.heatMapOptions.maxValue&&""!==_this3.reportObject.options.heatMapOptions.maxValue?_this3.reportObject.options.heatMapOptions.maxValue:yMax,2===_this3.resultObject.report.type?"hourly"===_this3.reportObject.dateRange.period?_this3.xformat="hours":"daily"===_this3.reportObject.dateRange.period?_this3.xformat="days":_this3.xformat="hours":_this3.xformat=_this3.resultObject&&_this3.resultObject.report&&_this3.resultObject.report.hmAggr&&null!==_this3.resultObject.report.hmAggr?_this3.resultObject.report.hmAggr:"hours";var dataWithAxis=_this3.transformDataForHeatMap(_this3.reportObject,_this3.resultObject.reportData.heatMapData,"X",dp.aliases.actual,isContinous,_this3.xformat),transformedData=dataWithAxis[0],xD=dataWithAxis[1],cellWidth=width/xD.length,x=d3.scaleBand().range([0,width]).domain(xD).padding(.005),clusterData=null;2===_this3.resultObject.report.type?(_this3.hidecharttypechanger=!1,clusterData=transformedData.filter((function(data){return null!==data.value})).map((function(data){return parseFloat(data.value)})),yMin=d3.min(clusterData),yMax=d3.max(clusterData),clusterData.sort()):clusterData=transformedData.filter((function(data){return null!==data.value&&data.value>=yMin&&data.value<=yMax})).map((function(data){return data.value}));var clusters=null;if(!(clusterData.length>5)||null!==_this3.heatMapMinValue&&""!==_this3.heatMapMinValue||null!==_this3.heatMapMaxValue&&""!==_this3.heatMapMaxValue)if(null!==_this3.heatMapMinValue&&""!==_this3.heatMapMinValue||null!==_this3.heatMapMaxValue&&""!==_this3.heatMapMaxValue){var minValue=null===_this3.heatMapMinValue||""===_this3.heatMapMinValue?d3.min(clusterData):_this3.heatMapMinValue,maxValue=null===_this3.heatMapMaxValue||""===_this3.heatMapMaxValue?d3.max(clusterData):_this3.heatMapMaxValue;clusters=_this3.groupValues(minValue,maxValue,5)}
// if (clusters && clusters[4] < yMax) {
//   clusters.push(yMax)
// }
else clusters=clusterData;else clusters=(0,ckmeans_min/* default */.Z)(clusterData,5);var yData=[];"hourly"===_this3.reportObject.dateRange.period&&(["month","year","quarter"].includes(_this3.reportObject.dateRange.operationOn)||"day"===_this3.reportObject.dateRange.operationOn&&_this3.reportObject.dateRange.offset>=32)?yData=dataWithAxis[2][0]:"weeks"===_this3.xformat&&["month","year","quarter"].includes(_this3.reportObject.dateRange.operationOn)?(yData=dataWithAxis[2][0],yData.sort()):yData=dataWithAxis[2];var cellHeight=height/yData.length;cellHeight>_this3.cellHeight&&(height=_this3.cellHeight*yData.length,cellHeight=_this3.cellHeight);var y=d3.scaleBand().range([0,height]).domain(yData).padding(.005),myColor=d3.scaleLinear().range(_this3.chosenColors).domain(clusters),border=1,bordercolor="#CCCCCC";_this3.$refs["heatmapDiv"].innerHTML="";var svg=d3.select(_this3.$refs["heatmapDiv"]).append("svg").attr("width",width+_this3.constantMargins.right+_this3.constantMargins.left).attr("height",height+_this3.constantMargins.top+_this3.constantMargins.bottom).attr("border",border).attr("class",_this3.$mobile?"":"widget-heatmap").append("g").attr("transform","translate("+_this3.constantMargins.left+","+_this3.constantMargins.top+")");svg.append("rect").attr("x",0).attr("y",0).attr("height",height).attr("width",width).style("stroke",bordercolor).style("fill","none").style("stroke-width",border);if("hours"===_this3.xformat){var xAxis=_this3.$mobile?["12a","4a","8a","12p","4p","8p","11p"]:["12a","1a","2a","3a","4a","5a","6a","7a","8a","9a","10a","11a","12p","1p","2p","3p","4p","5p","6p","7p","8p","9p","10p","11p"],x1=d3.scaleBand().range([0,width]).domain(xAxis).padding(.005);svg.append("g").attr("class",_this3.$mobile?"xaxis":"x axis").call(d3.axisTop(x1).tickSize([0])).append("text").attr("class","label").attr("text-anchor","start")}else if("days"===_this3.xformat&&_this3.$mobile){var _xAxis=["01","06","11","16","21","26","31"],_x=d3.scaleBand().range([0,width]).domain(_xAxis).padding(.005);svg.append("g").attr("class",_this3.$mobile?"xaxis":"x axis").call(d3.axisTop(_x).tickSize([0])).append("text").attr("class","label").attr("text-anchor","start")}else svg.append("g").attr("class",_this3.$mobile?"xaxis":"x axis").call(d3.axisTop(x).tickSize([0])).append("text").attr("class","label").attr("text-anchor","start");if("hourly"===_this3.reportObject.dateRange.period&&(["month","year","quarter"].includes(_this3.reportObject.dateRange.operationOn)||"day"===_this3.reportObject.dateRange.operationOn&&_this3.reportObject.dateRange.offset>=32)){var y1=cellHeight<20?d3.scaleBand().range([0,height]).domain(dataWithAxis[2][1]).padding(.01):d3.scaleBand().range([0,height]).domain(dataWithAxis[2][0]).padding(.01);svg.append("g").attr("class","y axis").call(d3.axisLeft(y1).tickSize([0])).append("text").attr("class","label").attr("text-anchor","end").attr("transform","translate(0,90)")}else if("weeks"===_this3.xformat&&["month","year","quarter"].includes(_this3.reportObject.dateRange.operationOn)){var _y=cellHeight<20?d3.scaleBand().range([0,height]).domain(dataWithAxis[2][1]).padding(.01):d3.scaleBand().range([0,height]).domain(dataWithAxis[2][0]).padding(.01);svg.append("g").attr("class","y axis").call(d3.axisLeft(_y).tickSize([0])).append("text").attr("class","label").attr("text-anchor","end").attr("transform","translate(0,90)")}else svg.append("g").attr("class","y axis").call(d3.axisLeft(y).tickSize([0])).append("text").attr("class","label").attr("text-anchor","end");var self=_this3;svg.selectAll().data(transformedData,(function(d){d["X"],d["Y"]})).enter().append("rect").attr("x",(function(d){return x(d["X"])})).attr("y",(function(d){return y(d["Y"])})).attr("width",x.bandwidth()>cellWidth?cellWidth:x.bandwidth()).attr("height",y.bandwidth()>cellHeight?cellHeight:y.bandwidth()).style("stroke","#CCCCCC").style("fill","none").style("stroke-width",.05).style("fill",(function(d){var c=null!==d.value?myColor(d.value):window.localStorage&&"black"===window.localStorage.theme?"#090f2e":"#FFFFFF";return null!==d.value&&d.value<yMin?c=myColor(clusters[0]):null!==d.value&&d.value>yMax&&(c=myColor(clusters[4])),c})).on("mouseover",(function(d){var tooltipData=[{label:d["xTitle"],value:moment_timezone_default()(d["originalValue"]).tz(vue_runtime_esm["default"].prototype.$timezone).format(self.getTooltipFormat())},{label:d["yTitle"],value:null!==d.value?d["value"]+" "+unit:null!==d.violated_value?d["violated_value"]+" "+unit+" (violated value)":"No data"}],tooltipConfig={position:{left:d3.event.pageX,top:d3.event.pageY},data:tooltipData,color:self.getTooltipColor(d.value,myColor,yMin,yMax,clusters)};tooltip/* default */.Z.showTooltip(tooltipConfig)})).on("mouseout",(function(d){tooltip/* default */.Z.hideTooltip()}));var svgDefs=svg.append("defs"),legendref="legendGradient"+Date.now(),mainGradient=svgDefs.append("linearGradient").attr("id",legendref);mainGradient.append("stop").style("stop-color",(function(d){return myColor(clusters[0])})).attr("offset","0%"),mainGradient.append("stop").style("stop-color",(function(d){return myColor(clusters[1])})).attr("offset","25%"),mainGradient.append("stop").style("stop-color",(function(d){return myColor(clusters[2])})).attr("offset","50%"),mainGradient.append("stop").style("stop-color",(function(d){return myColor(clusters[3])})).attr("offset","75%"),mainGradient.append("stop").style("stop-color",(function(d){return myColor(clusters[4])})).attr("offset","100%");var legendContainer=svg.append("g"),legend=legendContainer.selectAll(".heatLegend").data(clusters),legendSection=legend.enter().append("g").attr("class","heatLegend"),min=_this3.getRoundedNumber(yMin,"floor"),max=_this3.getRoundedNumber(yMax,"ceil");legendSection.append("rect").attr("x",(function(d,i){return self.$mobile?0:width/4})).attr("y",(function(d){return height+40})).attr("width",self.$mobile?width:width/2).attr("height",10).style("fill","url(#"+legendref+")"),legendSection.append("text").attr("class","legendLabel").attr("x",(function(d){return self.$mobile?0:width/4})).attr("y",(function(d){return height+70})).text((function(d){return min+" "+unit})),
// let textWidth = max.node().getComputedTextLength()
// console.log("textWidth",textWidth)
legendSection.append("text").text((function(d){return max+" "+unit})).attr("class","legendLabel").attr("x",(function(d){return self.$mobile?width-this.getComputedTextLength():width/4+width/2-this.getComputedTextLength()})).attr("y",(function(d){return height+70}))};for(_iterator2.s();!(_step2=_iterator2.n()).done;)_loop()}catch(err){_iterator2.e(err)}finally{_iterator2.f()}},getTooltipColor:function(value,myColor,yMin,yMax,clusters){var c=null!==value?myColor(value):"#FFFFFF";return null!==value&&value<yMin?c=myColor(clusters[0]):null!==value&&value>yMax&&(c=myColor(clusters[4])),c},getTooltipFormat:function(){switch(this.xformat){case"hours":return"dddd, MMM D, YYYY h a";case"days":return"dddd, MMM D, YYYY";case"weeks":return"dddd, MMM D, [W]ww gggg";default:return"LLLL"}},getOptionsFromTypeChart:function(options,ctype){
//to set the chart type based on the widget
this.config&&this.config.widget&&this.config.widget.dataOptions&&(this.config.widget.dataOptions.chartType=ctype.chartTypeInt,this.config.widget.dataOptions.chartTypeInt=ctype.chartTypeInt)}}},components_FNewHeatMapvue_type_script_lang_js=FNewHeatMapvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FNewHeatMapvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FNewHeatMap=component.exports},
/***/955220:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return ModularUserFilterRender}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/energy/analytics/components/ModularUserFilterRender.vue?vue&type=template&id=002b9ba5
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"report-userFilter"},[_vm.compactFilter?_c("div",[_c("el-popover",{attrs:{placement:"bottom-start",trigger:"click",width:"200"},model:{value:_vm.masterToggler,callback:function($$v){_vm.masterToggler=$$v},expression:"masterToggler"}},[_vm._l(_vm.filterConfiguration,(function(cFilter,cFilterIdx){return _c("el-popover",{key:cFilterIdx,attrs:{placement:"right",trigger:"click",width:"145","popper-class":"filter-priority-popover"},model:{value:_vm.fieldPopoverToggles[cFilter.fieldId],callback:function($$v){_vm.$set(_vm.fieldPopoverToggles,cFilter.fieldId,$$v)},expression:"fieldPopoverToggles[cFilter.fieldId]"}},[_vm._l(_vm.getDynamicFieldList(cFilter),(function(cOption,cOptionsIdx){return _c("div",{key:cOptionsIdx,staticClass:"pointer fc-black-12 text-left fw4 priority-filter-hover",on:{click:function($event){_vm.dataStructures[cFilter.fieldId]=cOption.name,_vm.fieldPopoverToggles[cFilter.fieldId]=!1,_vm.setFilter(cOption.name,cFilter.fieldId)}}},[_vm._v(" "+_vm._s(cOption.label)+" ")])})),_c("div",{staticClass:"pointer filter-select-txt",attrs:{slot:"reference"},slot:"reference"},[_vm._v(" "+_vm._s(cFilter.name)+" "),_c("i",{staticClass:"el-icon-arrow-right text-right fR f18",staticStyle:{color:"#d0d9e2","font-sizze":"14px"}})])],2)})),_c("div",{staticClass:"pT10 user-filter-txt clearboth flex-middle",attrs:{slot:"reference"},slot:"reference"},[_c("img",{staticClass:"mR10",attrs:{src:__webpack_require__(422618)}}),_vm._v("Filters"),_c("i",{staticClass:"el-icon-arrow-down pointer",on:{click:function($event){_vm.masterToggler=!0}}})])],2)],1):_c("div",_vm._l(_vm.filterConfiguration,(function(filter,filterIdx){return _c("div",{key:filterIdx,staticClass:"mL20 pT10",staticStyle:{display:"inline-block"}},[1===filter.component.componentType&&filter.lookupModuleName?_c("FLookupFieldWrapper",{staticClass:"fc-department-icon fc-department-input rm-arrow",attrs:{field:{lookupModule:{name:filter.lookupModuleName},multiple:!1,placeHolderText:"All"},fetchOptionsOnLoad:!0},on:{recordSelected:function($event){return _vm.setLookupFilter($event,filter.fieldId)},showingLookupWizard:function($event){_vm.showingLookupWizard=!0}},model:{value:_vm.currentFilterValue[filterIdx],callback:function($$v){_vm.$set(_vm.currentFilterValue,filterIdx,$$v)},expression:"currentFilterValue[filterIdx]"}}):_vm._e(),1!==filter.component.componentType||filter.lookupModuleName?_vm._e():_c("el-select",{staticClass:"fc-input-full-border-h35",attrs:{placeholder:filter.name,"popper-append-to-body":!1,filterable:""},on:{change:function($event){return _vm.setFilter($event,filter.fieldId)}},model:{value:_vm.dataStructures[filter.fieldId],callback:function($$v){_vm.$set(_vm.dataStructures,filter.fieldId,$$v)},expression:"dataStructures[filter.fieldId]"}},_vm._l(_vm.getDynamicFieldList(filter),(function(option,optionIdx){return _c("el-option",{key:optionIdx,attrs:{label:option.label,value:option.name}})})),1),2===filter.component.componentType?_c("el-select",{staticClass:"fc-input-full-border-h35",attrs:{placholder:filter.name,"popper-append-to-body":!1,"collapse-tags":!0,multiple:"",filterable:""},on:{change:function($event){return _vm.setFilter($event,filter.fieldId)}},model:{value:_vm.dataStructures[filter.fieldId],callback:function($$v){_vm.$set(_vm.dataStructures,filter.fieldId,$$v)},expression:"dataStructures[filter.fieldId]"}},_vm._l(_vm.getDynamicFieldList(filter),(function(option,optionIdx){return _c("el-option",{key:optionIdx,attrs:{label:option.label,value:option.name}})})),1):_vm._e()],1)})),0)])},staticRenderFns=[],createForOfIteratorHelper=__webpack_require__(566347),modularUserFilter=(__webpack_require__(670560),__webpack_require__(260228),__webpack_require__(76265),__webpack_require__(538077),__webpack_require__(169358),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(434284),__webpack_require__(162506),__webpack_require__(212826),__webpack_require__(884900)),FLookupFieldWrapper=__webpack_require__(201117),validation=__webpack_require__(990260),ModularUserFilterRendervue_type_script_lang_js={components:{FLookupFieldWrapper:FLookupFieldWrapper/* default */.Z},watch:{filterConfiguration:{handler:function(newValue,oldValue){newValue&&(this.initAll(),this.checkChangeinConfig(newValue,oldValue))},deep:!0}},props:["filterConfiguration","widgetConfig"],mixins:[modularUserFilter/* default */.Z],created:function(){this.initAll()},computed:{compactFilter:function(){return!!this.widgetConfig&&(this.widgetConfig.actualWidth<5.5||this.widgetConfig.widget.layout.width<40)}},methods:{getDynamicFieldList:function(filter){var fields=[];if(fields.push({label:"All",name:"all"}),filter.chooseValue.values&&filter.allValues){var _step,_iterator=(0,createForOfIteratorHelper/* default */.Z)(filter.chooseValue.values);try{var _loop=function(){var value=_step.value,labellist=filter.allValues.filter((function(val){return Object.keys(val)[0]===value}));
//TO Fix , Use find function rather than filter when searching for aa single item by id
labellist.length>0&&fields.push({label:labellist[0][value],name:value})};for(_iterator.s();!(_step=_iterator.n()).done;)_loop()}catch(err){_iterator.e(err)}finally{_iterator.f()}}return!0===filter.chooseValue.otherEnabled&&fields.push({label:"Others",name:"others"}),fields},setLookupFilter:function(val,fieldId){this.compactFilter&&(this.masterToggler=!1);var filterObj=this.filterConfiguration.filter((function(filter){return filter.fieldId===fieldId}))[0];1===filterObj.component.componentType&&(""===(null===val||void 0===val?void 0:val.value)?this.$set(this.dataStructures,fieldId,"all"):this.$set(this.dataStructures,fieldId,val)),this.showingLookupWizard=!1,this.emitLookupFilterChangeValue()},setFilter:function(val,fieldId){this.compactFilter&&(this.masterToggler=!1);var filterObj=this.filterConfiguration.filter((function(filter){return filter.fieldId===fieldId}))[0];if(2===filterObj.component.componentType)if(val.includes("all"))if(!1===this.allToggles[fieldId]){this.allToggles[fieldId]=!0;var _step2,values=[],_iterator2=(0,createForOfIteratorHelper/* default */.Z)(this.getDynamicFieldList(filterObj));try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var field=_step2.value;values.push(field.name)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}this.dataStructures[fieldId]=values}else{this.allToggles[fieldId]=!1;var indexofAll=val.indexOf("all");val.splice(indexofAll,1),this.dataStructures[fieldId]=val}else
//When all is unselected , if default value exists ,select it ,else select the first value, even when type=1(all) ,chooseValues will contain valueList but for all items
!0===this.allToggles[fieldId]?(0!==filterObj.defaultValues.length?this.dataStructures[fieldId]=filterObj.defaultValues:this.dataStructures[fieldId]=[filterObj.chooseValue.values[0]],this.allToggles[fieldId]=!1):
//TO DO no change in 'all' toggle,only one value is selected , don't allow to unselect it  ,
this.$set(this.dataStructures,fieldId,val);else 1===filterObj.component.componentType&&this.$set(this.dataStructures,fieldId,val);this.emitChangedValue()},isDisabled:function(filter){return 1===filter.chooseValue.type},checkChangeinConfig:function(newValue,oldValue){var _step3,_this=this,_iterator3=(0,createForOfIteratorHelper/* default */.Z)(newValue);
// this function checks for change in component types and initializes them
try{var _loop2=function(){var filter=_step3.value,oldComp=oldValue.filter((function(userFilter){return userFilter.fieldId===filter.fieldId}))[0];oldComp.component.componentType!==filter.component.componentType?_this.initSpecific(filter.fieldId,filter.component.componentType):(oldComp.chooseValue.values.length!==filter.chooseValue.values.length||oldComp.defaultValues[oldComp.defaultValues.length-1]!==filter.defaultValues[filter.defaultValues.length-1])&&_this.loadDefaultValues(filter.fieldId,filter.component.componentType)};for(_iterator3.s();!(_step3=_iterator3.n()).done;)_loop2()}catch(err){_iterator3.e(err)}finally{_iterator3.f()}},initSpecific:function(fieldId,componentType){this.$set(this.dataStructures,fieldId,this.dataStructureForComponent[componentType]),this.loadDefaultValues(fieldId,componentType)},initAll:function(){if("undefined"!==typeof this.filterConfiguration){this.initToggles();var _step4,_iterator4=(0,createForOfIteratorHelper/* default */.Z)(this.filterConfiguration);try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var filter=_step4.value;if(this.dataStructures[filter.fieldId])return;("singleselect"===this.componentType[filter.component.componentType].label||"multipleselect"===this.componentType[filter.component.componentType].label)&&(this.$set(this.dataStructures,filter.fieldId,this.dataStructureForComponent[filter.component.componentType]),this.loadDefaultValues(filter.fieldId,filter.component.componentType))}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}}},initToggles:function(){var _step5,_iterator5=(0,createForOfIteratorHelper/* default */.Z)(this.filterConfiguration);try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var config=_step5.value;this.allToggles.hasOwnProperty(config.fieldId)||(this.allToggles[config.fieldId]=!1),this.fieldPopoverToggles.hasOwnProperty(config.fieldId)||this.$set(this.fieldPopoverToggles,config.fieldId,!1)}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}},loadDefaultValues:function(fieldId,componentType){var _filterObject,filterObject=this.filterConfiguration.filter((function(filterObj){return filterObj.fieldId===fieldId}));if(filterObject&&0!==filterObject.length&&(filterObject=filterObject[0]),1===componentType)this.$set(this.dataStructures,fieldId,(null===(_filterObject=filterObject)||void 0===_filterObject||null===(_filterObject=_filterObject.defaultValues)||void 0===_filterObject?void 0:_filterObject.length)>0?filterObject.defaultValues[0]:"all"),this.allToggles[fieldId]="all"===this.dataStructures[fieldId];else if(2===componentType&&(this.$set(this.dataStructures,fieldId,filterObject.defaultValues.length>0?filterObject.defaultValues:"all"),this.allToggles[fieldId]=this.dataStructures[fieldId].includes("all"),!0===this.allToggles[fieldId])){this.dataStructures[fieldId]=[];var _step6,_iterator6=(0,createForOfIteratorHelper/* default */.Z)(this.getDynamicFieldList(filterObject));try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var id=_step6.value;this.dataStructures[fieldId].push(id.name)}}catch(err){_iterator6.e(err)}finally{_iterator6.f()}}},emitLookupFilterChangeValue:function(){this.filterConfiguration;var _step7,_iterator7=(0,createForOfIteratorHelper/* default */.Z)(this.filterConfiguration);try{for(_iterator7.s();!(_step7=_iterator7.n()).done;){var config=_step7.value,value=this.dataStructures[config.fieldId];Array.isArray(value)?value.includes("all")?config.values=["all"]:config.values=value:null!==value&&void 0!==value&&value.value?config.values=[value.value.toString()]:(0,validation/* isEmpty */.xb)(value)&&(config.values=["all"])}}catch(err){_iterator7.e(err)}finally{_iterator7.f()}this.$emit("emitChangedValue",this.filterConfiguration)},emitChangedValue:function(){this.filterConfiguration;var _step8,_iterator8=(0,createForOfIteratorHelper/* default */.Z)(this.filterConfiguration);try{for(_iterator8.s();!(_step8=_iterator8.n()).done;){var config=_step8.value,value=this.dataStructures[config.fieldId];Array.isArray(value)?value.includes("all")?config.values=["all"]:config.values=value:config.values=[value]}}catch(err){_iterator8.e(err)}finally{_iterator8.f()}this.$emit("emitChangedValue",this.filterConfiguration)}},data:function(){return{dataStructures:{},allToggles:{},masterToggler:!1,fieldPopoverToggles:{},showingLookupWizard:!1,currentFilterValue:[]}}},components_ModularUserFilterRendervue_type_script_lang_js=ModularUserFilterRendervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_ModularUserFilterRendervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,ModularUserFilterRender=component.exports},
/***/722784:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return UnderlyingWorkorders}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/report/UnderlyingWorkorders.vue?vue&type=template&id=1b6eed09
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("el-row",{staticClass:"mtb10 underlying-report-filters"},[_vm.loading||!1!==_vm.isXFieldCrossModule?_vm._e():_c("el-col",{staticClass:"text-left",attrs:{span:6}},[_c("el-select",{staticClass:"fc-input-full-border2 mB15 width250px",attrs:{filterable:"",placeholder:_vm.$t("home.dashboard.filter_by")+" "+_vm.resultObject.report.dataPoints[0].xAxis.label},on:{change:_vm.setDimensionFilter},model:{value:_vm.dimensionValues,callback:function($$v){_vm.dimensionValues=$$v},expression:"dimensionValues"}},_vm._l(_vm.computedDimensionValues,(function(dimension,dimensionIdx){return _c("el-option",{key:dimensionIdx,attrs:{value:dimension.id,label:dimension.label}})})),1)],1),_vm.loading||!1!==_vm.isGroupByCrossModule||!0!==_vm.reportObject.options.isSystemGroup?_vm._e():_c("el-col",{attrs:{span:8}},[_c("el-select",{staticClass:"fc-input-full-border2 mB15 width250px mL10",attrs:{filterable:"",placeholder:_vm.$t("home.dashboard.group_by")},on:{change:_vm.setGroupByFilter},model:{value:_vm.groupByValues,callback:function($$v){_vm.groupByValues=$$v},expression:"groupByValues"}},_vm._l(_vm.computedGroupByValues,(function(groupBy,groupByIdx){return _c("el-option",{key:groupByIdx,attrs:{value:groupBy.id,label:groupBy.label}})})),1)],1),_c("el-col",{staticClass:"text-right mT10 fR",attrs:{span:8}},[_c("f-pagination",{ref:"pagination",attrs:{total:_vm.totalCount,perPage:_vm.perPageCount}})],1)],1),_c("div",{staticClass:"underlying-scroll clearboth",class:{zoom95:_vm.isZoomLarge,zoom40:_vm.isZoomMedium,zoom35:_vm.isZoomSmall}},[_vm.loading?_c("spinner",{attrs:{show:_vm.loading,size:"80"}}):_vm._e(),_vm.loading||0!==_vm.recordData.length?_vm._e():_c("div",{staticClass:"text-center mT50 mB50"},[_c("img",{attrs:{src:__webpack_require__(15482),width:"100",height:"100"}}),_c("div",{staticClass:"mT20"},[_vm._v("No data available")])]),!_vm.loading&&_vm.recordData.length>0?_c("table",{staticClass:"setting-list-view-table"},[_c("thead",[_c("tr",[_c("th",{staticClass:"setting-table-th setting-th-text"},[_vm._v("NO")]),_vm._l(_vm.tableHeadings,(function(defaultModule,defaultModuleIdx){return _c("th",{key:defaultModuleIdx,staticClass:"setting-table-th setting-th-text"},[_vm._v(" "+_vm._s(defaultModule.field.displayName)+" ")])}))],2)]),_c("tbody",_vm._l(_vm.recordData,(function(row,rowIdx){return _c("tr",{key:rowIdx,staticClass:"tablerow",staticStyle:{cursor:"default !important"}},[_c("td",[_vm._v(_vm._s(rowIdx+1))]),_vm._l(Object.keys(row),(function(entry,entryIdx){return["id"!==entry||_vm.showId?_c("td",{key:entryIdx},[_c("div",{staticClass:"width200px underlying-worker-td",class:"subject"===entry?"width200px":"id"===entry?"width50px":"createdTime"===entry?"width180px":"modifiedTime"===entry||"actualWorkEnd"===entry?"width170px":"resource"===entry?"width150px":""},[_vm._v(" "+_vm._s(row[entry])+" "),"subject"===entry?_c("img",{staticClass:"chart-icon-report pointer",staticStyle:{"padding-top":"4px"},attrs:{src:__webpack_require__(396295)},on:{click:function($event){return _vm.openSummary(row.id)}}}):_vm._e()])]):_vm._e()]}))],2)})),0)]):_vm._e()],1)],1)},staticRenderFns=[],esm_typeof=__webpack_require__(103336),createForOfIteratorHelper=__webpack_require__(566347),toConsumableArray=__webpack_require__(488478),FPagination=(__webpack_require__(450886),__webpack_require__(434284),__webpack_require__(670560),__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(425728),__webpack_require__(169358),__webpack_require__(795765),__webpack_require__(879288),__webpack_require__(212826),__webpack_require__(947522),__webpack_require__(648324),__webpack_require__(76265),__webpack_require__(929593)),NewDataFormatHelper=__webpack_require__(804911),moment_timezone=__webpack_require__(480008),moment_timezone_default=__webpack_require__.n(moment_timezone),ModularAnalyticmixin=__webpack_require__(795e3),validation=__webpack_require__(990260),picklist=__webpack_require__(961358),Spinner=__webpack_require__(604947),http=__webpack_require__(218430),router=__webpack_require__(329435),UnderlyingWorkordersvue_type_script_lang_js={components:{FPagination:FPagination/* default */.Z,Spinner:Spinner/* default */.Z},mixins:[NewDataFormatHelper/* default */.Z,ModularAnalyticmixin/* default */.Z],data:function(){return{moduleName:null,moduleResourceField:null,dimensionValues:null,groupByValues:null,operatorId:36,
// Only IS operator
filters:{},defaultFilters:{},totalCount:0,perPageCount:30,viewName:"all",moduleDefaults:null,loading:!1,summaryPageMap:{},dataKey:{workorder:"workOrders",alarm:"alarms",asset:"assets"},isZoomSmall:!1,isZoomMedium:!1,isZoomLarge:!1,recordData:[],selectedFields:null,metaFields:[],lookupMap:{},tableHeadings:[]}},watch:{pageNumber:function(val){this.loadInitalFilters()},tableHeadings:{handler:function(val){if(this.handleTextSize(val),val){var shownFieldNames=val.map((function(field){return field.field.name})),fields=(0,toConsumableArray/* default */.Z)(val);this.moduleDefaults&&this.moduleDefaults.fields&&fields.push.apply(fields,(0,toConsumableArray/* default */.Z)(this.moduleDefaults.fields.filter((function(field){return field&&!shownFieldNames.includes(field.field.name)})))),this.$set(this.reportObject,"underlyingFields",fields.map((function(field){return{name:field.field.name,displayName:field.field.displayName,selected:shownFieldNames.includes(field.field.name)}})))}else this.$set(this.reportObject,"underlyingFields",[])}}},computed:{isPrinting:function(){return this.$route.query.print||this.$route.query.daterange;// daterange check temp
},isCustomModule:function(){return!!(this.resultObject&&this.resultObject.module&&this.resultObject.module.custom)},isGroupByCrossModule:function(){if(this.resultObject.report.dataPoints[0].groupByFields&&null!==this.resultObject.report.dataPoints[0].groupByFields){var groupField=this.resultObject.report.dataPoints[0].groupByFields[0];return!(groupField.field.module.name===this.resultObject.report.module.name||this.resultObject.report.module.extendModule&&groupField.field.module.name===this.resultObject.report.module.extendModule.name)}return!1},isXFieldCrossModule:function(){var xAxis=this.resultObject.report.dataPoints[0].xAxis;return!(xAxis.field.module.name===this.resultObject.report.module.name||this.resultObject.report.module.extendModule&&xAxis.field.module.name===this.resultObject.report.module.extendModule.name)},isGroupByFormulaField:function(){if(this.resultObject.report.dataPoints[0].groupByFields){var _step,_iterator=(0,createForOfIteratorHelper/* default */.Z)(this.resultObject.report.dataPoints[0].groupByFields);try{for(_iterator.s();!(_step=_iterator.n()).done;){var groupField=_step.value;if(-1===groupField.fieldId)return!0}}catch(err){_iterator.e(err)}finally{_iterator.f()}return!1}return!1},pageNumber:function(){return this.$route.query.page?this.$route.query.page:1},selectedFieldNames:function(){return this.$route.query.fields},showId:function(){return this.selectedFieldNames&&this.selectedFields.find((function(field){return"id"===field.field.name}))},computedDimensionValues:function(){var dimensions=[],xField=this.resultObject.report.dataPoints[0].xAxis;if(5===xField.dataType||6===xField.dataType){
// X axis has date and time
var _step2,periodObject=this.getDateFormat(this.reportObject.dateRange.period),momentFormat=periodObject.format,_iterator2=(0,createForOfIteratorHelper/* default */.Z)(this.reportObject.dateRange.range.domain);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var timeString=_step2.value,exactMillis=this.reverseIterate(timeString,periodObject),temp={};temp["id"]=this.reportObject.dateRange.range.domain.indexOf(timeString),temp["label"]=moment_timezone_default()(exactMillis).format(periodObject.tooltip);var millis=this.getMillis(timeString,momentFormat,this.reportObject.dateRange.period);temp["value"]=millis,dimensions.push(temp)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}else if("lookup"===xField.dataTypeEnum.toLowerCase()||"siteId"===xField.fieldName){
// let xFieldId = this.resultObject.report.dataPoints[0].xAxis.fieldId
// let labelMap = this.resultObject.reportData.labelMap[xFieldId]
var _step3,labelMap=this.resultObject.report.dataPoints[0].xAxis.lookupMap,xValues=[],xAlias=null!==this.resultObject.report.xAlias?this.resultObject.report.xAlias:"X",_iterator3=(0,createForOfIteratorHelper/* default */.Z)(this.resultObject.reportData.data);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var data=_step3.value,xId=data[xAlias];xValues.push(xId)}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}for(var _i=0,_Object$keys=Object.keys(labelMap);_i<_Object$keys.length;_i++){var key=_Object$keys[_i];if(xValues.includes(parseInt(key))){var _temp={};_temp["id"]=key,_temp["label"]=labelMap[key],_temp["value"]=null,dimensions.push(_temp)}}}else if("enum"===xField.dataTypeEnum.toLowerCase()||"boolean"===xField.dataTypeEnum.toLowerCase()){var _step4,enumMap=this.resultObject.report.dataPoints[0].xAxis.enumMap,_xValues=[],_xAlias=null!==this.resultObject.report.xAlias?this.resultObject.report.xAlias:"X",_iterator4=(0,createForOfIteratorHelper/* default */.Z)(this.resultObject.reportData.data);try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var _data=_step4.value,_xId=_data[_xAlias];_xValues.push(_xId)}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}for(var _i2=0,_Object$keys2=Object.keys(enumMap);_i2<_Object$keys2.length;_i2++){var _key=_Object$keys2[_i2];if(_xValues.includes(parseInt(_key))){var _temp2={};_temp2["id"]=_key,_temp2["label"]=enumMap[_key],_temp2["value"]=null,dimensions.push(_temp2)}}}else{var _step5,_xAlias2=null!==this.resultObject.report.xAlias?this.resultObject.report.xAlias:"X",_iterator5=(0,createForOfIteratorHelper/* default */.Z)(this.resultObject.reportData.data);try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var _data2=_step5.value,_temp3={};_temp3["id"]=this.resultObject.reportData.data.indexOf(_data2)+"",_temp3["label"]=_data2[_xAlias2],_temp3["value"]=_data2[_xAlias2],dimensions.push(_temp3)}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}}return dimensions},computedGroupByValues:function(){var groups=[],groupIds=[];if(!this.resultObject.report.dataPoints[0].groupByFields||0===this.resultObject.report.dataPoints[0].groupByFields.length||"lookup"!==this.resultObject.report.dataPoints[0].groupByFields[0].dataTypeEnum.toLowerCase()&&"siteId"!==this.resultObject.report.dataPoints[0].groupByFields[0].fieldName)for(var requiredGroups=this.requiredGroupValues(this.resultObject),_i4=0,_Object$keys4=Object.keys(requiredGroups);_i4<_Object$keys4.length;_i4++){var _key2=_Object$keys4[_i4],_temp4={};_temp4["id"]=parseInt(_key2),_temp4["label"]=requiredGroups[_key2],_temp4["value"]=requiredGroups[_key2],groups.push(_temp4)}else{
/*
        only for first level group by
        **** Additional context:
        Here, Group by is only applied as a filter for the data
        *****
        */
var _step6,_iterator6=(0,createForOfIteratorHelper/* default */.Z)(this.resultObject.reportData.data);try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var _step7,data=_step6.value,firstLevelGroupLabel=this.resultObject.report.dataPoints[0].groupByFields[0].field.name,yData=data[firstLevelGroupLabel],_iterator7=(0,createForOfIteratorHelper/* default */.Z)(yData);try{for(_iterator7.s();!(_step7=_iterator7.n()).done;){var record=_step7.value;Number.isInteger(parseInt(record[firstLevelGroupLabel]))&&groupIds.push(parseInt(record[firstLevelGroupLabel]))}}catch(err){_iterator7.e(err)}finally{_iterator7.f()}}}catch(err){_iterator6.e(err)}finally{_iterator6.f()}for(var groupLabelMap=this.resultObject.report.dataPoints[0].groupByFields[0].lookupMap,_i3=0,_Object$keys3=Object.keys(groupLabelMap);_i3<_Object$keys3.length;_i3++){var key=_Object$keys3[_i3];if(groupIds.includes(parseInt(key))){var temp={};temp["id"]=key,temp["label"]=groupLabelMap[key],temp["value"]=null,groups.push(temp)}}}return groups}},created:function(){var _this=this;
// load defaults Headers
this.loading=!0,this.module&&(this.moduleName=this.module["moduleName"],this.moduleResourceField=this.module["resourceField"]),"undefined"===typeof this.moduleName&&(this.moduleName="workorder"),this.loadMetaFields().then((function(){http/* default */.ZP.get("/view/all?moduleName="+_this.moduleName).then((function(response){if(_this.moduleDefaults=response.data,_this.computeTableHeadings(),_this.moduleDefaults&&_this.moduleDefaults.fields){var availableFields=_this.metaFields.map((function(field){return field.name}));_this.moduleDefaults.fields=_this.moduleDefaults.fields.filter((function(field){return field.field&&!["noOfTasks","noOfNotes","noOfAttachments"].includes(field.field.name)&&availableFields.includes(field.field.name)}))}_this.loadInitalFilters()}))}))},methods:{handleTextSize:function(val){val&&this.isPrinting&&(this.isZoomSmall=val.length>10,this.isZoomMedium=val.length>7&&val.length<=10,this.isZoomLarge=val.length<=7)},reverseIterate:function(timeString,periodObject){return moment_timezone_default()(timeString,periodObject.format).valueOf()},getMillis:function(timeString,momentFormat,period){var time=[],periodString=this.getMomentPeriod(period);return time.push(moment_timezone_default()(timeString,momentFormat).startOf(periodString).valueOf()),time.push(moment_timezone_default()(timeString,momentFormat).endOf(periodString).valueOf()),time},getMomentPeriod:function(period){return"hourly"===period?"hour":"daily"===period?"day":"weekly"===period?"week":"monthly"===period?"month":void 0},setDimensionFilter:function(val){this.dimensionValues=val,this.loadInitalFilters()},setGroupByFilter:function(val){this.groupByValues=val,this.loadInitalFilters()},getDefaultFilters:function(){var defaultFilter={};if(5===this.resultObject.report.dataPoints[0].xAxis.dataType||6===this.resultObject.report.dataPoints[0].xAxis.dataType||-1!==this.resultObject.report.dateOperator){
// x axis has time
var fieldName=5===this.resultObject.report.dataPoints[0].xAxis.dataType||6===this.resultObject.report.dataPoints[0].xAxis.dataType?this.resultObject.report.dataPoints[0].xAxis.fieldName:this.resultObject.report.dataPoints[0].dateField.fieldName,dateOperatorId=20,dateValues=this.resultObject.dateRange.value,temp={};temp["operatorId"]=dateOperatorId,temp["value"]=dateValues.map((function(element){return element+""})),defaultFilter[fieldName]=temp}
// if crietria is enabled
if(this.resultObject.report.dataPoints[0].criteria&&null!==this.resultObject.report.dataPoints[0].criteria)for(var conditionIdx in this.resultObject.report.dataPoints[0].criteria.conditions){var condition=this.resultObject.report.dataPoints[0].criteria.conditions[conditionIdx],_fieldName=condition.fieldName,fieldNameArray=(_fieldName||"").split(".");fieldNameArray.length>1&&(_fieldName=fieldNameArray[1]);var value=null;value=condition.value?condition.value.split(","):[];var _temp5={};_temp5["operatorId"]=condition.operatorId,_temp5["value"]=value,defaultFilter[_fieldName]=_temp5}
// applying user filters
if(this.resultObject.report.userFilters){
// user filters are only lookupField
var _step8,_iterator8=(0,createForOfIteratorHelper/* default */.Z)(this.resultObject.report.userFilters);try{for(_iterator8.s();!(_step8=_iterator8.n()).done;){var userFilterConfig=_step8.value;if(userFilterConfig.criteria)for(var conditions=userFilterConfig.criteria.conditions,_i5=0,_Object$keys5=Object.keys(conditions);_i5<_Object$keys5.length;_i5++){var _conditions$_conditio,_condition=_Object$keys5[_i5],_temp6={};_temp6["operatorId"]=conditions[_condition].operatorId,(null===(_conditions$_conditio=conditions[_condition].value)||void 0===_conditions$_conditio?void 0:_conditions$_conditio.split(",").length)>1?_temp6["value"]=conditions[_condition].value.split(","):_temp6["value"]=[conditions[_condition].value],defaultFilter[conditions[_condition].fieldName]=_temp6}}}catch(err){_iterator8.e(err)}finally{_iterator8.f()}}return defaultFilter},getFilters:function(){var _this2=this,filters=this.getDefaultFilters();
// apply xFilter
if(null!==this.dimensionValues){var xFieldName=this.resultObject.report.dataPoints[0].xAxis.fieldName,temp={};if(-1===this.resultObject.report.dataPoints[0].xAxis.fieldId&&"siteId"!==xFieldName){var dimensionName=this.computedDimensionValues.filter((function(element){return element.id===_this2.dimensionValues}))[0].value,condition=this.resultObject.report.dataPoints[0].xAxis.field.conditions[dimensionName],_temp7={};_temp7["operatorId"]=condition.operatorId,condition.value.split(",").length>1?_temp7["value"]=condition.value.split(","):_temp7["value"]=[condition.value],filters[condition.fieldName]=_temp7}else if(this.resultObject.report.dataPoints[0].xAxis.field.lookupModule&&("resource"===this.resultObject.report.dataPoints[0].xAxis.field.lookupModule.name&&[21,22,23,26].includes(this.resultObject.report.xAggr)||"basespace"===this.resultObject.report.dataPoints[0].xAxis.field.lookupModule.name))temp["operatorId"]=38,temp["value"]=[this.dimensionValues],filters[xFieldName]=temp;else if("lookup"===this.resultObject.report.dataPoints[0].xAxis.dataTypeEnum.toLowerCase())temp["operatorId"]=this.operatorId,temp["value"]=[this.dimensionValues],filters[xFieldName]=temp;else if("string"===this.resultObject.report.dataPoints[0].xAxis.dataTypeEnum.toLowerCase())temp["operatorId"]=this.operatorId,temp["value"]=[this.dimensionValues],filters[xFieldName]=temp;else if(temp["operatorId"]=5===this.resultObject.report.dataPoints[0].xAxis.dataType||6===this.resultObject.report.dataPoints[0].xAxis.dataType?20:this.operatorId,5===this.resultObject.report.dataPoints[0].xAxis.dataType||6===this.resultObject.report.dataPoints[0].xAxis.dataType){var objectById=this.computedDimensionValues.filter((function(element){return element.id===parseInt(_this2.dimensionValues)})),values=objectById[0].value.map((function(element){return element+""}));temp["value"]=values,filters[xFieldName]=temp}else
// for boolean and enum fields and siteId
temp["operatorId"]=this.operatorId,temp["value"]=[this.dimensionValues],filters[xFieldName]=temp}else if(!1===this.isXFieldCrossModule)if((0,validation/* isEmpty */.xb)(this.resultObject.report.dataPoints[0].xAxis.selectValuesOnly)){var _xField=this.resultObject.report.dataPoints[0].xAxis;-1!==_xField.fieldId&&(filters[_xField.fieldName]||(filters[_xField.fieldName]="MULTI_ENUM"===this.resultObject.report.dataPoints[0].xAxis.dataTypeEnum||"MULTI_LOOKUP"===this.resultObject.report.dataPoints[0].xAxis.dataTypeEnum?{operatorId:105}:{operatorId:2}))}else{var chooseValues=this.resultObject.report.dataPoints[0].xAxis.selectValuesOnly.map((function(val){return val.toString()})),_xFieldName=this.resultObject.report.dataPoints[0].xAxis.fieldName;if(!this.resultObject.report.dataPoints[0].xAxis.field.lookupModule||"resource"!==this.resultObject.report.dataPoints[0].xAxis.field.lookupModule.name&&"basespace"!==this.resultObject.report.dataPoints[0].xAxis.field.lookupModule.name)if("lookup"===this.resultObject.report.dataPoints[0].xAxis.dataTypeEnum.toLowerCase()){var _temp9={};_temp9["operatorId"]=this.operatorId,_temp9["value"]=chooseValues,filters[_xFieldName]||(filters[_xFieldName]=_temp9)}else{var xField=this.resultObject.report.dataPoints[0].xAxis;-1!==xField.fieldId&&(filters[xField.fieldName]||(filters[xField.fieldName]={operatorId:2}))}else{var _temp8={operatorId:38};_temp8["value"]=chooseValues,filters[_xFieldName]||(filters[_xFieldName]=_temp8)}}
// groupByFilters
if(null!==this.groupByValues){
// group by does not have time
var group=this.resultObject.report.dataPoints[0].groupByFields[0];if(-1===group.fieldId&&"siteId"!==group.fieldName){var groupName=this.computedGroupByValues.filter((function(element){return element.id===_this2.groupByValues}))[0].value,_condition2=group.field.conditions[groupName],_temp10={};_temp10["operatorId"]=_condition2.operatorId,_condition2.value.split(",").length>1?_temp10["value"]=_condition2.value.split(","):_temp10["value"]=[_condition2.value],filters[_condition2.fieldName]=_temp10}else if(!group.field.lookupModule||"resource"!==group.field.lookupModule.name&&"basespace"!==group.field.lookupModule.name){var _groupName2=group.field.name,_temp12={},_val=this.computedGroupByValues.filter((function(element){return element.id===_this2.groupByValues}))[0].id;_temp12["operatorId"]=this.operatorId,_temp12["value"]=[_val+""],filters[_groupName2]=_temp12}else{var _groupName=group.field.name,_temp11={},val=this.computedGroupByValues.filter((function(element){return element.id===_this2.groupByValues}))[0].id;_temp11["operatorId"]=38,_temp11["value"]=[val+""],filters[_groupName]=_temp11}}else if(!1===this.isGroupByCrossModule&&this.resultObject.report.dataPoints[0].groupByFields){var _group=this.resultObject.report.dataPoints[0].groupByFields[0];-1!==_group.fieldId&&(filters[_group.fieldName]||(filters[_group.fieldName]="MULTI_ENUM"===this.resultObject.report.dataPoints[0].groupByFields[0].dataTypeEnum||"MULTI_LOOKUP"===this.resultObject.report.dataPoints[0].groupByFields[0].dataTypeEnum?{operatorId:105}:{operatorId:2}))}return filters},openSummary:function(rowId){if((0,router/* isWebTabsEnabled */.tj)()){var moduleName=this.moduleName,viewMap={tenantcontact:"all-contacts",bmsalarm:"bmsAlarm"},_ref=(0,router/* findRouteForModule */.Jp)(moduleName,router/* pageTypes */.As.OVERVIEW)||{},name=_ref.name;if(name){var viewname=viewMap[moduleName]||"all",routerPath=this.$router.resolve({name:name,params:{viewname:viewname,id:rowId}}).href;window.open(routerPath)}}else{var summaryUrl=this.summaryPageMap[rowId];window.open(summaryUrl)}},getUrlBasedOnModule:function(){var url="";if("undefined"===typeof this.moduleName)url="/workorder/";else switch(this.moduleName){case"workorder":url="/workorder/";break;case"alarm":url="/alarm/";break;case"asset":url="/asset/";break;default:url="/workorder/";break}return url},loadMetaFields:function(){var _this3=this;
// this.loading = true
return http/* default */.ZP.get("/v2/modules/meta/".concat(this.moduleName)).then((function(response){_this3.metaFields=response.data.result.meta.fields||[];var fieldMap={};_this3.metaFields.forEach((function(field){fieldMap[field.name]=field})),_this3.selectedFieldNames&&(_this3.selectedFields=_this3.selectedFieldNames.split(",").map((function(name){return{columnDisplayName:null,fieldId:"id"===name?-1:fieldMap[name].fieldId,field:"id"===name?{name:"id",displayName:"ID",default:!0}:fieldMap[name]}})),_this3.loadInitalFilters())}))},rerender:function(){this.$refs["pagination"]&&this.$refs["pagination"].reset()},loadInitalFilters:function(){var _this4=this;this.loading=!0;var filter=this.getFilters();this.reportObject["filters"]={},this.reportObject.filters["underlyingDataFilters"]=filter;var filterString=encodeURIComponent(JSON.stringify(filter)),url="";if("undefined"===typeof this.moduleName)this.moduleName="workorder",url="workorder/workOrderCount?viewName=all&count=true";else if(this.isCustomModule)url="/v2/module/data/list?moduleName="+this.moduleName+"&viewName=all&fetchCount=true&includeParentFilter=true";else switch(this.moduleName){case"workorder":url="workorder/workOrderCount?viewName=all&count=true";break;case"alarm":url="v2/alarms/alarmCount?viewName=all&isCount=true";break;case"asset":url="asset/assetCount?viewName=all&count=true";break;default:url="/v2/module/data/list?moduleName="+this.moduleName+"&viewName=all&fetchCount=true&includeParentFilter=true";break}0!==Object.keys(filter).length&&(url=url+"&filters="+filterString),http/* default */.ZP.get(url).then((function(response){"workorder"===_this4.moduleName?_this4.totalCount=response.data.woCount:"asset"===_this4.moduleName?_this4.totalCount=response.data.assetCount:_this4.totalCount=response.data.result.count;var pageLimit=_this4.$route.query.pageLimit||(_this4.printQuery&&!0===_this4.printQuery.underlyingData&&_this4.printQuery.pageLimit?_this4.printQuery.pageLimit:null);pageLimit&&(_this4.perPageCount="all"===pageLimit?_this4.totalCount>2e3?2e3:_this4.totalCount:"number"===typeof pageLimit?Math.abs(pageLimit):Math.abs(parseInt(pageLimit)));var url=_this4.getUrlBasedOnModule();url=url+_this4.viewName+"?page="+_this4.pageNumber+"&perPage="+_this4.perPageCount,!_this4.isCustomModule&&["workorder","alarm","asset"].includes(_this4.moduleName)||(url="/v2/module/data/list?moduleName="+_this4.moduleName+"&page="+_this4.pageNumber+"&perPage="+_this4.perPageCount+"&viewName=all&includeParentFilter=true"),url=url+"&filters="+filterString,http/* default */.ZP.get(url).then((function(response){var key=_this4.dataKey[_this4.moduleName],dataResponse=[];dataResponse=_this4.isCustomModule||!["workorder","alarm","asset"].includes(_this4.moduleName)?response.data.result.moduleDatas:response.data[key],_this4.recordData=[];var _step9,_iterator9=(0,createForOfIteratorHelper/* default */.Z)(dataResponse);try{for(_iterator9.s();!(_step9=_iterator9.n()).done;){var record=_step9.value;_this4.summaryPageMap[record.id]=record.url;var row={};row["id"]=record.id;var _step10,_iterator10=(0,createForOfIteratorHelper/* default */.Z)(_this4.tableHeadings);try{for(_iterator10.s();!(_step10=_iterator10.n()).done;){var column=_step10.value;if(!column.field.default||2!==column.field.dataType&&3!==column.field.dataType)if("dueDate"===column.field.name||"createdTime"===column.field.name){var data=!column.field.default&&record.data?record.data:record;record[column.field.name+"String"]&&null!==record[column.field.name+"String"]?row[column.field.name]=record[column.field.name+"String"]:null!==record[column.field.name]&&-1!==record[column.field.name]?row[column.field.name]=record[column.field.name]:null!==data[column.field.name]&&-1!==data[column.field.name]?(row[column.field.name],record.data[column.field.name]):null!==record[column.field.module.name]&&-1!==record[column.field.module.name]&&"undefined"!==typeof record[column.field.module.name]&&null!==record[column.field.module.name][column.field.name]&&-1!==record[column.field.module.name][column.field.name]?(row[column.field.name],record[column.field.module.name][column.field.name]):row[column.field.name]="--"}else if(5===column.field.dataType||6===column.field.dataType){var _data3=!column.field.default&&record.data?record.data:record;if(-1===_data3[column.field.name]||null===_data3[column.field.name])row[column.field.name]="--";else{var date=null!==record[column.field.name]?record[column.field.name]:"undefined"!==typeof record[column.field.module.name]&&null!==record[column.field.module.name]&&null!==record[column.field.module.name][column.field.name]?record[column.field.module.name][column.field.name]:_data3[column.field.name];date?(_this4.reportObject.dateRange&&_this4.reportObject.dateRange.period,row[column.field.name]=_this4.$options.filters.formatDate(date,!1,!1)):row[column.field.name]="--"}}else if(7===column.field.dataType)null!==record[column.field.name]&&"undefined"!==typeof record[column.field.name]||null!==record.data?"sourceType"===column.field.name?row[column.field.name]=record[column.field.name]&&null!==record[column.field.name]?_this4.$constants.SourceType[[record[column.field.name]]]:record.data&&null!==record.data&&record.data[column.field.name]?_this4.$constants.SourceType[[record.data[column.field.name]]]:"--":"resource"===column.field.name||"assignmentGroup"===column.field.name||"assignedTo"===column.field.name||record[column.field.name]&&record[column.field.name]["name"]?row[column.field.name]=record[column.field.name]&&null!==record[column.field.name].name?record[column.field.name].name:record[column.field.name]&&null!==record[column.field.name].id&&_this4.lookupMap[column.field.name]?_this4.lookupMap[column.field.name][record[column.field.name].id]:record.data&&null!==record.data&&record.data[column.field.name]?null!==record.data[column.field.name].id&&_this4.lookupMap[column.field.name]?_this4.lookupMap[column.field.name][record.data[column.field.name].id]:record.data[column.field.name]:"--":row[column.field.name]=record[column.field.name]&&-1!==record[column.field.name]?null!==record[column.field.name]["displayName"]?record[column.field.name]["displayName"]:null!==record[column.field.name][column.field.name]&&"undefined"!==typeof record[column.field.name][column.field.name]?record[column.field.name][column.field.name]:null!==record[column.field.name]["primaryValue"]?record[column.field.name]["primaryValue"]:_this4.lookupMap[column.field.name]&&record[column.field.name].id&&_this4.lookupMap[column.field.name][record[column.field.name].id]?_this4.lookupMap[column.field.name][record[column.field.name].id]:"---":record.data&&null!==record.data&&record.data[column.field.name]?null!==record.data[column.field.name].id&&_this4.lookupMap[column.field.name]?_this4.lookupMap[column.field.name][record.data[column.field.name].id]:"object"!==(0,esm_typeof/* default */.Z)(record.data[column.field.name])||(0,validation/* isEmpty */.xb)(record.data[column.field.name].primaryValue)?"--":record.data[column.field.name].primaryValue:"--":row[column.field.name]="--";else if(8===column.field.dataType)null===column.field.enumMap?row[column.field.name]="--":record[column.field.name]&&null!==record[column.field.name]?row[column.field.name]=column.field.enumMap[record[column.field.name]]?column.field.enumMap[record[column.field.name]]:"---":!column.field.default&&record.data&&null!==record.data&&null!==record.data[column.field.name]?row[column.field.name]=column.field.enumMap[record.data[column.field.name]]?column.field.enumMap[record.data[column.field.name]]:"---":"undefined"!==typeof record[column.field.module.name]&&null!==record[column.field.module.name]&&null!==record[column.field.module.name][column.field.name]?row[column.field.name]=record[column.field.module.name][column.field.name]:row[column.field.name]="--";else{var _data4=!column.field.default&&record.data?record.data:record;if("undefined"!==typeof _data4[column.field.name]&&null!==_data4[column.field.name]&&-1!==_data4[column.field.name]){if(row[column.field.name]=_data4[column.field.name],2===column.field.dataType&&23===column.field.displayTypeInt)row[column.field.name]=_this4.$helpers.getFormattedDuration(row[column.field.name],"seconds");else if(14===column.field.dataType&&column.field.values){var multi_val_list=row[column.field.name],result_val=[];for(var val_id in multi_val_list)multi_val_list[val_id]&&column.field.enumMap[multi_val_list[val_id]]&&result_val.push(column.field.enumMap[multi_val_list[val_id]]);row[column.field.name]=result_val}else if(13===column.field.dataType&&column.field.lookupMap){var _multi_val_list=row[column.field.name],_result_val=[];for(var _val_id in _multi_val_list)_multi_val_list[_val_id].id&&_result_val.push(column.field.lookupMap[_multi_val_list[_val_id].id]);row[column.field.name]=_result_val}}else null!==record[column.field.module.name]&&-1!==record[column.field.module.name]&&"undefined"!==typeof record[column.field.module.name]&&null!==record[column.field.module.name][column.field.name]&&-1!==record[column.field.module.name][column.field.name]?(row[column.field.name]=record[column.field.module.name][column.field.name],2===column.field.dataType&&23===column.field.displayTypeInt&&(row[column.field.name]=_this4.$helpers.getFormattedDuration(row[column.field.name],"seconds"))):row[column.field.name]="---"}else!record[column.field.name]||null!==record[column.field.name]&&-1!==record[column.field.name]?row[column.field.name]=record[column.field.name]:!column.field.default&&record.data&&null!==record.data&&null!==record.data[column.field.name]&&-1!==record.data[column.field.name]?(row[column.field.name],record.data[column.field.name]):row[column.field.name]="--"}}catch(err){_iterator10.e(err)}finally{_iterator10.f()}_this4.recordData.push(row)}}catch(err){_iterator9.e(err)}finally{_iterator9.f()}_this4.loading=!1}))}))},computeTableHeadings:function(){var _this5=this;if(this.selectedFields)this.tableHeadings=this.selectedFields;else{var fields=[];if(this.moduleDefaults){var _step11,_iterator11=(0,createForOfIteratorHelper/* default */.Z)(this.moduleDefaults.fields);try{var _loop=function(){var field=_step11.value;if(field.field&&7===field.field.dataType){var moduleName=field.field.lookupModule.name;(0,picklist/* getFieldOptions */._K)({field:{lookupModuleName:moduleName,skipDeserialize:!0}}).then((function(_ref2){var error=_ref2.error,options=_ref2.options;error?_this5.$message.error(error.message||"Error Occured"):_this5.lookupMap[field.field.name]=options}))}if(0!==fields.length){var filteredFields=fields.filter((function(element){return element.fieldId===field.fieldId}));if(0!==filteredFields.length)return 1;// continue
field.field&&!["noOfAttachments","noOfTasks","noOfNotes"].includes(field.field.name)&&fields.push(field)}else field.field&&!["noOfAttachments","noOfTasks","noOfNotes"].includes(field.field.name)&&fields.push(field)};for(_iterator11.s();!(_step11=_iterator11.n()).done;)_loop()}catch(err){_iterator11.e(err)}finally{_iterator11.f()}}
// push xField
var xAxisField=this.resultObject.report.dataPoints[0].xAxis,temp=fields.filter((function(element){return element.fieldId===xAxisField.fieldId}));if(// TODO remove after formula fields are handled
xAxisField.displayName=xAxisField.label,xAxisField.name=xAxisField.fieldName,0===temp.length&&-1!==xAxisField.fieldId){if(7===xAxisField.dataType){var moduleName=xAxisField.field.lookupModule.name;(0,picklist/* getFieldOptions */._K)({field:{lookupModuleName:moduleName,skipDeserialize:!0}}).then((function(_ref3){var error=_ref3.error,options=_ref3.options;error?_this5.$message.error(error.message||"Error Occured"):_this5.lookupMap[xAxisField.field.name]=options}))}fields.push({columnDisplayName:null,fieldId:xAxisField.fieldId,field:xAxisField})}
// push group by field
if(this.resultObject.report.dataPoints[0].groupByFields&&0!==this.resultObject.report.dataPoints[0].groupByFields.length&&(temp=fields.filter((function(element){return element.fieldId===_this5.resultObject.report.dataPoints[0].groupByFields[0].fieldId})),0===temp.length&&!this.isGroupByFormulaField)){var groupByField=this.resultObject.report.dataPoints[0].groupByFields[0];if(7===groupByField.dataType||13===groupByField.dataType){var _moduleName=groupByField.field.lookupModule.name;13===groupByField.dataType&&(groupByField.field.lookupMap=groupByField.lookupMap),(0,picklist/* getFieldOptions */._K)({field:{lookupModuleName:_moduleName,skipDeserialize:!0}}).then((function(_ref4){var error=_ref4.error,options=_ref4.options;error?_this5.$message.error(error.message||"Error Occured"):_this5.lookupMap[groupByField.field.name]=options}))}fields.push({columnDisplayName:null,fieldId:groupByField.fieldId,field:groupByField.field})}this.tableHeadings=fields}}},props:["reportObject","resultObject","module"]},report_UnderlyingWorkordersvue_type_script_lang_js=UnderlyingWorkordersvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(report_UnderlyingWorkordersvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,UnderlyingWorkorders=component.exports},
/***/340737:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return ModularNewTabularReport}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/report/components/ModularNewTabularReport.vue?vue&type=template&id=254c930c
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.showTable?_c("div",{staticClass:"modular-new-report-page",style:{position:"relative","margin-bottom":_vm.widget?"30px":"150px"}},[_vm.reportObject&&_vm.isTabularReport?[_c("HotTable",{ref:"hotTable",style:_vm.styleCss,attrs:{root:_vm.root,settings:_vm.hotSettings}})]:_vm.reportObject?_c("div",{staticClass:"height100"},[_c("div",{staticClass:"pT0 height100 scrollable"},_vm._l(_vm.multiTables,(function(table,tindex){return _c("div",{key:tindex,ref:"fTableContainer_"+tindex,refInFor:!0,staticClass:"tablular-container dashboard-tablular-container row full-layout-white scrollbar-style tabular-data-border fc-modular-tabular-report",style:[{"overflow-x":(_vm.isOverflowing,"scroll"),display:"block","margin-bottom":"20px"}]},[_vm.hotSettings.data.length?_c("table",{ref:"fTable_"+tindex,refInFor:!0,staticClass:"wo-table workorder-table-list tabular-report-table fc-tabular-report-table-new",staticStyle:{width:"100%"}},[0===_vm.tableState.groupByColumns.length||_vm.isPrinting?_c("thead",[_c("tr",[0===_vm.tableState.groupByColumns.length||_vm.isPrinting?_c("th",[_vm._v(" "+_vm._s(_vm.$t("common.products.no"))+" ")]):_vm._e(),_vm._l(table.columns,(function(header,index){return _c("th",{key:index,staticClass:"text-left"},[_c("div",{staticClass:"inline",style:_vm.isPrinting?"":{width:"89%"},domProps:{innerHTML:_vm._s(header)}}),_vm.hotSettings.columns[_vm.getColIdx(index,tindex)].showOptions?_c("div",{staticClass:"flRight"},[_c("f-popover",{attrs:{placement:"right",trigger:"click",width:"370",confirmTitle:"Save"},on:{save:function($event){return _vm.saveOptions(index,tindex)},show:function($event){return _vm.initOptions(index,tindex)}},model:{value:_vm.hotSettings.columns[_vm.getColIdx(index,tindex)].popover,callback:function($$v){_vm.$set(_vm.hotSettings.columns[_vm.getColIdx(index,tindex)],"popover",$$v)},expression:"\n                      hotSettings.columns[getColIdx(index, tindex)].popover\n                    "}},[_vm.options.state&&_vm.options.state.enumMode?_c("div",{staticClass:"customize-input-block customize-radio-block"},[_c("p",{staticClass:"customize-label"},[_vm._v(" "+_vm._s(_vm.$t("common._common.mode"))+" ")]),_c("div",[_c("el-radio-group",{model:{value:_vm.options.state.enumMode,callback:function($$v){_vm.$set(_vm.options.state,"enumMode",$$v)},expression:"options.state.enumMode"}},[_c("el-radio-button",{attrs:{label:_vm.enumMode.DURATION}},[_vm._v(_vm._s(_vm.$t("common._common.duration")))]),_c("el-radio-button",{attrs:{label:_vm.enumMode.PERCENT}},[_vm._v(_vm._s(_vm.$t("common._common.percentage")))])],1)],1),_c("el-checkbox",{staticClass:"pT10",model:{value:_vm.options.applyAll,callback:function($$v){_vm.$set(_vm.options,"applyAll",$$v)},expression:"options.applyAll"}},[_vm._v(_vm._s(_vm.$t("common.dashboard.apply_to_all_similar_columns")))])],1):_vm._e(),_c("div",{staticClass:"pointer",attrs:{slot:"reference"},slot:"reference"},[_c("i",{staticClass:"el-icon-more rotate90deg"})])])],1):_vm._e()])})),table.showExtraColumn?_c("th",{staticClass:"extra-th"}):_vm._e()],2)]):_c("thead",[_vm.reportObject.report.dataPoints[0].groupByFields&&_vm.reportObject.report.dataPoints[0].groupByFields.length>1?_c("tr",[_c("th"),_vm._l(_vm.tableState.groupByColumns,(function(group,groupIdx){return _c("th",{key:groupIdx,attrs:{colspan:group.colspan}},[_vm._v(" "+_vm._s(group.label)+" ")])}))],2):_vm._e(),_c("tr",_vm._l(_vm.computeGroupByHeadings,(function(groupHeading,groupHeadingIdx){return _c("th",{key:groupHeadingIdx,attrs:{colspan:"1"}},[_vm._v(" "+_vm._s(groupHeading.label)+" ")])})),0)]),0===_vm.tableState.groupByColumns.length||_vm.isPrinting?_c("tbody",_vm._l(_vm.hotSettings.data,(function(data,idx){return _c("tr",{key:idx,staticClass:"tablerow"},[_c("td",{staticClass:"tabular-data-td",staticStyle:{"text-align":"center","min-width":"49px","max-width":"49px",color:"#879eb5 !important","font-size":"12px","font-weight":"500","letter-spacing":"1px","text-transform":"uppercase"},style:_vm.isPrinting?"":"min-width: 49px;"},[_vm._v(" "+_vm._s(idx+1)+" ")]),_vm._l(table.columns,(function(header,index){return _c("td",{key:index,class:["tabular-data-td","numeric"===_vm.hotSettings.columns[_vm.getColIdx(index,tindex)].type?"text-right":"text-left"],style:_vm.isPrinting?"":{"min-width":table.colWidth,"max-width":table.colWidth}},["html"===_vm.hotSettings.columns[_vm.getColIdx(index,tindex)].renderer?_c("div",{domProps:{innerHTML:_vm._s(data[_vm.getColIdx(index,tindex)])}}):_c("div",{staticClass:"pointer",on:{click:function($event){return _vm.drillDown(idx)}}},[_vm._v(" "+_vm._s(data[_vm.getColIdx(index,tindex)])+" ")])])})),table.showExtraColumn?_c("td",{staticClass:"extra-td"}):_vm._e()],2)})),0):_c("tbody",_vm._l(_vm.hotSettings.data,(function(data,dataIdx){return _c("tr",{key:dataIdx,staticClass:"tablerow"},[_c("td",{staticClass:"tabular-data-td",staticStyle:{"text-align":"center","min-width":"49px","max-width":"49px",color:"#879eb5 !important","font-size":"12px","font-weight":"500","letter-spacing":"1px","text-transform":"uppercase"},style:_vm.isPrinting?"":"min-width: 49px;"},[_vm._v(" "+_vm._s(dataIdx+1)+" ")]),_vm._l(data,(function(val,valIdx){return _c("td",{key:valIdx,staticClass:"pointer tabular-data-td",style:_vm.isPrinting?"":{"min-width":table.colWidth,"max-width":table.colWidth},attrs:{colspan:"1"}},[_c("div",{on:{click:function($event){return _vm.drillDown(dataIdx,valIdx+1)}}},[_vm._v(_vm._s(val))])])}))],2)})),0)]):_vm._e()])})),0)]):_vm._e()],2):_vm._e()},staticRenderFns=[],toConsumableArray=__webpack_require__(488478),createForOfIteratorHelper=__webpack_require__(566347),vue_handsontable=(__webpack_require__(434284),__webpack_require__(670560),__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(169358),__webpack_require__(689730),__webpack_require__(947522),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(450886),__webpack_require__(162506),__webpack_require__(634338),__webpack_require__(339772),__webpack_require__(891719),__webpack_require__(212826),__webpack_require__(795765),__webpack_require__(879288),__webpack_require__(865137),__webpack_require__(648324),__webpack_require__(425728),__webpack_require__(366258)),vue_handsontable_default=__webpack_require__.n(vue_handsontable),NewDataFormatHelper=__webpack_require__(804911),ModularAnalyticmixin=__webpack_require__(795e3),FPopover=__webpack_require__(507008),d3=__webpack_require__(348727),MAX_COLUMN=5,EnumMode={DURATION:1,PERCENT:2,GRAPH:3},ModularNewTabularReportvue_type_script_lang_js={components:{HotTable:vue_handsontable_default(),FPopover:FPopover/* default */.Z},mixins:[NewDataFormatHelper/* default */.Z,ModularAnalyticmixin/* default */.Z],props:["reportObject","reportConfig","widget","printReverse","moduleName"],data:function(){return{root:"tabular-report-hot",minWidth:225,maxWidth:335,hotSettings:{data:[],columns:[],colHeaders:!0,rowHeaders:!0,columnHeaderHeight:75,renderAllRows:!0,colWidths:"",readOnly:!0,columnSorting:!0,manualColumnResize:!0,manualColumnMove:!0,fixedColumnsLeft:1,stretchH:"none"},hotTable:null,autoRowSize:null,widgetSettings:{manualColumnResize:!1,manualColumnMove:!1,fixedColumnsLeft:0,stretchH:"all"},tableState:{
// table config to save
columns:[]},colspan:null,baselineMap:{},dataMap:{},initialRendered:!1,showExtraColumn:!1,isOverflowing:!1,multiTables:[],maxColumn:MAX_COLUMN,enumMode:EnumMode,options:{applyAll:!1,state:null}}},mounted:function(){this.init(),this.render()},updated:function(){this.isTabularReport||this.setHotColWidth()},computed:{isGroupByCrossModule:function(){if(null!==this.reportObject.report.dataPoints[0].groupByFields){var groupField=this.reportObject.report.dataPoints[0].groupByFields[0];return!(groupField.field.module.name===this.reportObject.report.module.name||this.reportObject.report.module.extendModule&&groupField.field.module.name===this.reportObject.report.module.extendModule.name)}return!1},isXFieldCrossModule:function(){var xAxis=this.reportObject.report.dataPoints[0].xAxis;return!(xAxis.field.module.name===this.reportObject.report.module.name||this.reportObject.report.module.extendModule&&xAxis.field.module.name===this.reportObject.report.module.extendModule.name)},computeGroupByHeadings:function(){var groupByHeadings=[];
// populate No and X column Heading
if("undefined"!==typeof this.printReverse&&!0===this.printReverse){var _heading={label:"No"};groupByHeadings.push(_heading);var _step,requiredGroups=this.requiredGroupValues(this.reportObject),_iterator=(0,createForOfIteratorHelper/* default */.Z)(this.prepareReverseColumnHeadings());try{var _loop=function(){var colHeading=_step.value;_heading={},_heading["label"]=colHeading,_heading["id"]=Object.keys(requiredGroups).filter((function(key){return requiredGroups[key]===colHeading}))[0],groupByHeadings.push(_heading)};for(_iterator.s();!(_step=_iterator.n()).done;)_loop()}catch(err){_iterator.e(err)}finally{_iterator.f()}}else{var _heading2={label:"No"};groupByHeadings.push(_heading2);var xHeading={};if(xHeading["label"]=this.reportConfig.options.axis.x.label.text,groupByHeadings.push(xHeading),this.reportObject.report.dataPoints[0].groupByFields&&1===this.reportObject.report.dataPoints[0].groupByFields.length)for(var groupMap=this.requiredGroupValues(this.reportObject),_i=0,_Object$keys=Object.keys(groupMap);_i<_Object$keys.length;_i++){var key=_Object$keys[_i],temp={label:groupMap[key],id:key};groupByHeadings.push(temp)}}var heading={label:"Total"};return groupByHeadings.push(heading),groupByHeadings},showTable:function(){return this.reportObject&&(!this.widget||!1===this.reportConfig.options.settings.chart)&&this.reportConfig.options.settings.table},isTabularReport:function(){return this.reportConfig&&"tabular"===this.reportConfig.options.type},isPrinting:function(){return this.$route.query.print||this.$route.query.daterange;// daterange check temp
},styleCss:function(){return"width: 100% !important;"}},watch:{reportObject:{handler:function(){this.render()},deep:!0},reportConfig:{handler:function(){this.render()},deep:!0}},methods:{getCorrespondingDomainIndex:function(rowIndex){for(var timeString=this.reportObject.reportData.data[rowIndex].X,period=this.reportConfig.dateRange.period,dateFormat=this.getDateFormat(period).format,formattedTime=this.getFormattedTime(timeString,dateFormat),index=0;index<this.reportConfig.dateRange.range.domain.length;index++)if(this.reportConfig.dateRange.range.domain[index]===formattedTime)return index},prepareValForDrillDown:function(rowIndex,colIndex){var val={},isTime=5===this.reportObject.report.dataPoints[0].xAxis.dataType||6===this.reportObject.report.dataPoints[0].xAxis.dataType;if(val["index"]=isTime?this.getCorrespondingDomainIndex(rowIndex):rowIndex,0!==this.tableState.groupByColumns.length){
// group by applied
if(0===colIndex||1===colIndex)val["id"]=null;else{var groupName=this.computeGroupByHeadings[colIndex].label;val["id"]=groupName}return val}return val},drillDown:function(rowIndex,colIndex){var appNameFromUrl=window.location.pathname.slice(1).split("/")[0];if(!this.isXFieldCrossModule&&!this.isGroupByCrossModule&&"operations"!==appNameFromUrl){var val=this.prepareValForDrillDown(rowIndex,colIndex);this.handleBasicDrillDown(val,this.reportObject,this.reportConfig)}},init:function(){var self=this;this.hotSettings.afterColumnMove=function(){self.saveCurrentState()},this.hotSettings.afterColumnResize=function(){self.saveCurrentState()},this.hotSettings.afterRender=function(){!self.hotTable&&self.$refs["hotTable"]&&(self.hotTable=self.$refs["hotTable"].table),self.initialRendered||(self.initialRendered=!0)}},resize:function(){this.setHotColWidth()},setHotColWidth:function(){var _this=this;if((!Array.isArray(this.hotSettings.colWidths)||!this.isTabularReport)&&this.showTable&&(this.$refs["hotTable"]||this.$refs["fTableContainer_0"]&&this.$refs["fTableContainer_0"][0])){var width=this.isTabularReport?this.$refs["hotTable"].$el.clientWidth-47:this.$refs["fTableContainer_0"][0].clientWidth-49;this.multiTables.length&&this.multiTables.forEach((function(table){var cols=table.columns.length,colWidth=width/cols;colWidth<_this.minWidth?colWidth=_this.minWidth:colWidth>_this.maxWidth&&(colWidth=_this.maxWidth),colWidth*cols<width&&(table.showExtraColumn=!1),table.colWidth=colWidth+"px",_this.hotSettings.colWidths=colWidth+"px"}))}},render:function(){this.showTable&&("undefined"!==typeof this.printReverse&&!0===this.printReverse?(this.setTableStateConfig(),this.prepareReverseHotConfig(),this.setTableData(),this.setMultipleTables()):(this.setTableStateConfig(),this.setHotConfig(),this.setTableData(),this.setMultipleTables()))},
/**
     * Setting columns in table state..If state already available, order of columns will be maintained
     */
prepareReverseColumnHeadings:function(){var colVals=[],xAlias=this.reportObject.report.xAlias?this.reportObject.report.xAlias:"X",xDataType=this.reportObject.report.dataPoints[0].xAxis.dataType,isTimeSeries=5===xDataType||6===xDataType,isXLookUp="lookup"===this.reportObject.report.dataPoints[0].xAxis.dataTypeEnum.toLowerCase()||"siteId"===this.reportObject.report.dataPoints[0].xAxis.fieldName,isXBooleanOrEnum="boolean"===this.reportObject.report.dataPoints[0].xAxis.dataTypeEnum.toLowerCase()||"enum"===this.reportObject.report.dataPoints[0].xAxis.dataTypeEnum.toLowerCase();this.reportObject.report.dataPoints[0].groupByFields?colVals.push(this.reportObject.report.dataPoints[0].groupByFields[0].field.displayName):colVals.push("Metric");var _step2,_iterator2=(0,createForOfIteratorHelper/* default */.Z)(this.reportObject.reportData.data);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var data=_step2.value,xValue=data[xAlias];if(isTimeSeries&&xValue&&""!=xValue){var period=this.reportConfig.dateRange.period;colVals.push(this.formatDate(new Date(parseInt(xValue)),period))}else if(isXLookUp&&xValue&&""!=xValue){var lookupMap=this.reportObject.report.dataPoints[0].xAxis.lookupMap;lookupMap[xValue]&&colVals.push(lookupMap[xValue])}else if(isXBooleanOrEnum&&xValue&&""!=xValue){var enumMap=this.reportObject.report.dataPoints[0].xAxis.enumMap;enumMap[xValue]&&colVals.push(enumMap[xValue])}else{if(!xValue||""===xValue)continue;colVals.push(xValue)}}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}return colVals.push("Total"),colVals},prepareReverseData:function(){var _this2=this,reversedData=[];if(0===this.tableState.groupByColumns.length){var _step3,_iterator3=(0,createForOfIteratorHelper/* default */.Z)(this.reportObject.report.dataPoints);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var dataPoint=_step3.value,dataPointAlias=dataPoint.aliases.actual,rowData=[];rowData.push(dataPoint.name+(dataPoint.yAxis&&dataPoint.yAxis.unitStr?" ("+dataPoint.yAxis.unitStr+")":""));var _step4,total=0,_iterator4=(0,createForOfIteratorHelper/* default */.Z)(this.reportObject.reportData.data);try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var data=_step4.value;if("lookup"===dataPoint.yAxis.dataTypeEnum.toLowerCase()||"enum"===dataPoint.yAxis.dataTypeEnum.toLowerCase()){var map="lookup"===dataPoint.yAxis.dataTypeEnum.toLowerCase()?dataPoint.yAxis.lookupMap:dataPoint.yAxis.enumMap;null!==data[dataPointAlias]?(total+=parseFloat(map[data[dataPointAlias]]),rowData.push(map[data[dataPointAlias]])):rowData.push(null)}else total+=parseFloat(data[dataPointAlias]),rowData.push(data[dataPointAlias])}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}rowData.push(total),reversedData.push(rowData)}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}}else{
// supported only for one level of group by
var _step5,requiredGroups=this.requiredGroupValues(this.reportObject),xAlias=this.reportObject.report.xAlias?this.reportObject.report.xAlias:"X",firstLevelGrouplabel=this.reportObject.report.dataPoints[0].groupByFields[0].fieldName,_iterator5=(0,createForOfIteratorHelper/* default */.Z)(this.reportObject.report.dataPoints);try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var _dataPoint=_step5.value,_loop2=function(key){var rowData=[];rowData.push(requiredGroups[key]);var _step6,total=0,_iterator6=(0,createForOfIteratorHelper/* default */.Z)(_this2.reportObject.reportData.data);try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var _data=_step6.value;if("lookup"===_dataPoint.xAxis.dataTypeEnum.toLowerCase()||"enum"===_dataPoint.xAxis.dataTypeEnum.toLowerCase()){var _map="lookup"===_dataPoint.xAxis.dataTypeEnum.toLowerCase()?_dataPoint.xAxis.lookupMap:_dataPoint.xAxis.enumMap,mapKeys=Object.keys(_map);if(!mapKeys.includes(_data[xAlias]+""))continue}var firstLevelGroupData=_data[firstLevelGrouplabel],groupData=firstLevelGroupData.filter((function(groupData){return groupData[firstLevelGrouplabel]===parseInt(key)||groupData[firstLevelGrouplabel]===requiredGroups[key]}));groupData&&groupData.length>0?(total+=parseFloat(groupData[0][_dataPoint.aliases.actual]),rowData.push(groupData[0][_dataPoint.aliases.actual])):rowData.push(0)}}catch(err){_iterator6.e(err)}finally{_iterator6.f()}rowData.push(total),reversedData.push(rowData)};for(var key in requiredGroups)_loop2(key)}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}}this.hotSettings.data=reversedData},prepareReverseHotConfig:function(){this.hotSettings.colHeaders=this.prepareReverseColumnHeadings(),this.hotSettings.columns=[],this.hotSettings.colWidths="335px";var _step7,_iterator7=(0,createForOfIteratorHelper/* default */.Z)(this.prepareReverseColumnHeadings());try{for(_iterator7.s();!(_step7=_iterator7.n()).done;){var column=_step7.value,temp={};temp["name"]=column,temp["type"]="text",this.hotSettings.columns.push(temp)}}catch(err){_iterator7.e(err)}finally{_iterator7.f()}},setTableStateConfig:function(){var _this3=this;this.tableState={columns:[],groupByColumns:[]};var dataPoints=[];if("undefined"!==typeof this.printReverse&&!0===this.printReverse)this.reportObject.report.dataPoints[0].groupByFields?this.tableState.groupByColumns=this.prepareReverseColumnHeadings():this.tableState.columns=this.prepareReverseColumnHeadings();else if(this.reportConfig.options.dataPoints.filter((function(element){return"systemgroup"===element.type})).length){
// only for first level group by
var sysGroup=this.reportConfig.options.dataPoints.filter((function(element){return"systemgroup"===element.type}))[0],firstGroupKey=sysGroup.groupBy[0].id,firstGroupByLabelValues=sysGroup.groupByLabelValues[firstGroupKey],definedColumns=0;for(var column in this.reportConfig.options.axis)this.reportConfig.options.axis[column]&&this.reportConfig.options.axis[column].label&&null!==this.reportConfig.options.axis[column].label.text&&""!==this.reportConfig.options.axis[column].label.text&&(definedColumns+=1);for(var groupId in definedColumns-=1,// remove X count
this.colspan=definedColumns,this.tableState.groupByColumns.push({renderer:"html",label:"",colspan:this.colspan}),firstGroupByLabelValues){var groupLabel=firstGroupByLabelValues[groupId],temp={renderer:"html"};temp["label"]=groupLabel,temp["colspan"]=this.colspan,this.tableState.groupByColumns.push(temp)}}this.reportConfig.options.dataPoints.forEach((function(dp){"group"===dp.type?dataPoints.push.apply(dataPoints,(0,toConsumableArray/* default */.Z)(dp.children)):dataPoints.push(dp)}));var aliases=[this.reportObject.report.xAlias];dataPoints.forEach((function(dp){_this3.dataMap[dp.alias]=dp,dp.isBaseLine&&2===dp.pointType||aliases.push(dp.alias)}));var setTableStateColumns=function(aliases,idx){var _this3$tableState$col,_this3$tableState$col2,columns=aliases.map((function(alias){return{alias:alias}}));idx>=0?(_this3$tableState$col=_this3.tableState.columns).splice.apply(_this3$tableState$col,[idx,0].concat((0,toConsumableArray/* default */.Z)(columns))):(_this3$tableState$col2=_this3.tableState.columns).push.apply(_this3$tableState$col2,(0,toConsumableArray/* default */.Z)(columns))};if(this.reportObject.report.tabularState&&"null"!==this.reportObject.report.tabularState&&(this.tableState="string"===typeof this.reportObject.report.tabularState?JSON.parse(this.reportObject.report.tabularState):this.$helpers.cloneObject(this.reportObject.report.tabularState),
// Temp
this.tableState.columns.length&&!this.tableState.columns[0].alias&&(this.tableState.columns=[])),"undefined"===typeof this.printReverse||!1===this.printReverse)if(this.tableState.columns.length){
// TODO verify
if(this.tableState.columns=this.tableState.columns.filter((function(column){return aliases.includes(column.alias)})),this.tableState.columns[0].alias!==aliases[0]){var xColIdx=this.tableState.columns.findIndex((function(col){return col.alias===aliases[0]}));if(-1!==xColIdx){var xCols=this.tableState.columns.splice(xColIdx,1);this.tableState.columns.unshift(xCols[0])}else setTableStateColumns([aliases[0]],0)}if(this.tableState.columns.length!==aliases.length){var existingHeaders=this.tableState.columns.map((function(column){return column.alias})),remainingHeaders=aliases.filter((function(header){return!existingHeaders.includes(header)}));setTableStateColumns(remainingHeaders)}}else setTableStateColumns(aliases)},
/**
     * Setting Hot table configuration and column header names
     */
setHotConfig:function(){var label,hotColHeaders=[],hotColWidths=[],hotColumns=[],getHotType=function(dataType){return 2===dataType||3===dataType||11===dataType?"numeric":"text"},type="text";if(6===this.reportObject.mode)label="Site";else if(7===this.reportObject.mode)label="Building";else if(8===this.reportObject.mode)label="Asset";else{var xAxis=this.reportObject.report.dataPoints[0].xAxis;label=xAxis.label,type=xAxis.lookupMap?"text":getHotType(xAxis.dataType)}hotColHeaders.push(label.toUpperCase());var noOfColumns,tableStateColumns,xColumn=this.tableState.columns[0];if(hotColumns.push({type:type,name:xColumn.alias}),xColumn.width&&hotColWidths.push(xColumn.width),this.reportConfig&&this.reportConfig.options&&this.reportConfig.options.isSystemGroup){tableStateColumns=this.computeGroupByHeadings.slice(2);for(var i=0;i<tableStateColumns.length;i++){var tableColumn=tableStateColumns[i];hotColHeaders.push(tableColumn.label.toString().toUpperCase());var column={type:"text",name:tableColumn.label};hotColumns.push(column),tableColumn.width&&hotColWidths.push(tableColumn.width)}}else{noOfColumns=this.tableState.columns.length,tableStateColumns=this.tableState.columns;for(var _i2=1;_i2<noOfColumns;_i2++){var _column=tableStateColumns[_i2],dataPoint=this.dataMap[_column.alias];if(_column.displayName)hotColHeaders.push(_column.displayName.toUpperCase());else{var name=dataPoint.label.toUpperCase()+(dataPoint.unitStr?" ("+dataPoint.unitStr+")":"");hotColHeaders.push(name)}var col={type:getHotType(dataPoint.dataTypeId),name:dataPoint.alias};4!==dataPoint.dataTypeId&&8!==dataPoint.dataTypeId||(col.renderer="html",this.reportObject.xAggr?(col.showOptions=!0,_column.enumMode?_column.enumMode===EnumMode.PERCENT&&(hotColHeaders[_i2]=hotColHeaders[_i2]+" (%)"):_column.enumMode=EnumMode.DURATION):_column.enumMode=null),hotColumns.push(col),_column.width&&hotColWidths.push(_column.width)}}hotColWidths.length===hotColumns.length&&(this.hotSettings.colWidths=hotColWidths),this.hotSettings.columns=hotColumns,this.hotSettings.colHeaders=hotColHeaders,this.widget&&Object.assign(this.hotSettings,this.widgetSettings)},getRequiredGroupMap:function(groupMap,requiredIds){var _step8,temp={},_iterator8=(0,createForOfIteratorHelper/* default */.Z)(requiredIds);try{for(_iterator8.s();!(_step8=_iterator8.n()).done;){var id=_step8.value,label=groupMap[parseInt(id)];temp[id]=label}}catch(err){_iterator8.e(err)}finally{_iterator8.f()}return temp},prepareGroupByData:function(){var _step9,_this4=this,data=[],isXLookup="lookup"===this.reportObject.report.dataPoints[0].xAxis.dataTypeEnum.toLowerCase()||"siteId"===this.reportObject.report.dataPoints[0].xAxis.fieldName||"multi_lookup"===this.reportObject.report.dataPoints[0].xAxis.dataTypeEnum.toLowerCase(),isXBooleanOrEnum="boolean"===this.reportObject.report.dataPoints[0].xAxis.dataTypeEnum.toLowerCase()||"enum"===this.reportObject.report.dataPoints[0].xAxis.dataTypeEnum.toLowerCase()||"multi_enum"===this.reportObject.report.dataPoints[0].xAxis.dataTypeEnum.toLowerCase()||"system_enum"===this.reportObject.report.dataPoints[0].xAxis.dataTypeEnum.toLowerCase(),xAlias=this.reportObject.report.xAlias?this.reportObject.report.xAlias:"X",columns=[],requiredGroupIds=[],_iterator9=(0,createForOfIteratorHelper/* default */.Z)(this.reportObject.reportData.data);try{for(_iterator9.s();!(_step9=_iterator9.n()).done;){var _step12,_data2=_step9.value,firstLevelGroupLabel=this.reportObject.groupIds[0].name,recordData=_data2[firstLevelGroupLabel],_iterator12=(0,createForOfIteratorHelper/* default */.Z)(recordData);try{for(_iterator12.s();!(_step12=_iterator12.n()).done;){var record=_step12.value;!requiredGroupIds.includes(parseInt(record[firstLevelGroupLabel]))&&Number.isInteger(parseInt(record[firstLevelGroupLabel]))&&requiredGroupIds.push(record[firstLevelGroupLabel])}}catch(err){_iterator12.e(err)}finally{_iterator12.f()}}}catch(err){_iterator9.e(err)}finally{_iterator9.f()}var _step10,_iterator10=(0,createForOfIteratorHelper/* default */.Z)(this.reportObject.report.dataPoints);try{for(_iterator10.s();!(_step10=_iterator10.n()).done;){var dataPoint=_step10.value,temp={};temp["alias"]=dataPoint.aliases.actual,temp["label"]=dataPoint.name,columns.push(temp)}}catch(err){_iterator10.e(err)}finally{_iterator10.f()}var _step11,_iterator11=(0,createForOfIteratorHelper/* default */.Z)(this.reportObject.reportData.data);try{var _loop3=function(){var record=_step11.value,rowData=[];if(isXLookup){var xId=record[xAlias],xLabel=_this4.reportObject.report.dataPoints[0].xAxis.lookupMap[xId];if(!xLabel)return 0;// continue
rowData.push(xLabel)}else if(isXBooleanOrEnum){var enumMap=_this4.reportObject.report.dataPoints[0].xAxis.enumMap,enumId=record[xAlias];if(!enumMap[enumId])return 0;// continue
var labelValue=enumMap[enumId];rowData.push(labelValue)}else if(5===_this4.reportObject.report.dataPoints[0].xAxis.dataType||6===_this4.reportObject.report.dataPoints[0].xAxis.dataType){var period=_this4.reportConfig.dateRange.period;if(!record[xAlias])return 0;// continue
rowData.push(_this4.formatDate(new Date(parseInt(record[xAlias])),period))}else{if(!record[xAlias])return 0;// continue
rowData.push(record[xAlias])}
// to get y values
var firstLevelGroupLabel=_this4.reportObject.groupIds[0].name,groupMap=_this4.reportObject.groupLabelValues[_this4.reportObject.groupIds[0].id];groupMap=_this4.requiredGroupValues(_this4.reportObject);var yData=record[firstLevelGroupLabel],dataOfGroup=null,total=0,_loop4=function(groupId){if(dataOfGroup=yData.filter((function(element){return element[firstLevelGroupLabel]===parseInt(groupId)||element[firstLevelGroupLabel]===groupMap[groupId]})),0===dataOfGroup.length)for(var j=0;j<columns.length;j++)rowData.push(0);else for(var _i3=0,_columns=columns;_i3<_columns.length;_i3++){var column=_columns[_i3];total+=parseFloat(dataOfGroup[0][column.alias]),rowData.push(dataOfGroup[0][column.alias])}};for(var groupId in groupMap)_loop4(groupId);rowData.push(total),data.push(rowData)};for(_iterator11.s();!(_step11=_iterator11.n()).done;)_loop3()}catch(err){_iterator11.e(err)}finally{_iterator11.f()}return data},setTableData:function(){var _this5=this,tableData=[],xColumn=this.tableState.columns[0],xDataType=this.reportObject.report.dataPoints[0].xAxis.dataType,isTimeSeries=5===xDataType||6===xDataType,isXLookUp="lookup"===this.reportObject.report.dataPoints[0].xAxis.dataTypeEnum.toLowerCase()||"siteId"===this.reportObject.report.dataPoints[0].xAxis.fieldName||"multi_lookup"===this.reportObject.report.dataPoints[0].xAxis.dataTypeEnum.toLowerCase(),isXBooleanOrEnum="boolean"===this.reportObject.report.dataPoints[0].xAxis.dataTypeEnum.toLowerCase()||"enum"===this.reportObject.report.dataPoints[0].xAxis.dataTypeEnum.toLowerCase()||"multi_enum"===this.reportObject.report.dataPoints[0].xAxis.dataTypeEnum.toLowerCase()||"system_enum"===this.reportObject.report.dataPoints[0].xAxis.dataTypeEnum.toLowerCase(),period=this.getTimePeriod(this.reportObject);"undefined"!=typeof this.printReverse&&!0===this.printReverse?this.prepareReverseData():this.reportConfig.options.isSystemGroup?this.hotSettings.data=this.prepareGroupByData():(this.reportObject.reportData.data.forEach((function(row){var newRow=[];if(isXLookUp){null!==xColumn.alias&&void 0!==xColumn.alias||(xColumn.alias="X");var lookupId=row[xColumn.alias];if(!_this5.reportObject.report.dataPoints[0].xAxis.lookupMap[lookupId])return;var labelValue=_this5.reportObject.report.dataPoints[0].xAxis.lookupMap[lookupId];newRow.push(labelValue)}else if(isXBooleanOrEnum){null!==xColumn.alias&&void 0!==xColumn.alias||(xColumn.alias="X");var enumMap=_this5.reportObject.report.dataPoints[0].xAxis.enumMap,enumId=row[xColumn.alias];if(!enumMap[enumId])return;var _labelValue=enumMap[enumId];newRow.push(_labelValue)}else{null!==xColumn.alias&&void 0!==xColumn.alias||(xColumn.alias="X");var xVal=row[xColumn.alias];if(xVal&&isTimeSeries)xVal=_this5.formatDate(xVal,period),newRow.push(xVal);else{if(!xVal)return;newRow.push(xVal)}}for(var _loop5=function(){var column=_this5.tableState.columns[i],value=row[column.alias];if(value){var dataPoint=_this5.dataMap[column.alias];if(2===dataPoint.dataTypeId||3===dataPoint.dataTypeId)value=d3.format(",")(value);else if(4===dataPoint.dataTypeId||8===dataPoint.dataTypeId){var enumVal=value;if(value=null,column.enumMode){if(column.enumMode===EnumMode.GRAPH);else if(column.enumMode===EnumMode.PERCENT){if(enumVal.duration){var total=Object.keys(enumVal.duration).reduce((function(previous,key){return previous+enumVal.duration[key]}),0),percent="";Object.keys(enumVal.duration).sort().forEach((function(key){value=enumVal.duration[key]/total*100,value=Math.round(100*value)/100,percent+=dataPoint.enumMap[key]+": "+value+"<br/>"})),value=percent}}else
// DURATION
if(enumVal.duration){var duration="";Object.keys(enumVal.duration).sort().forEach((function(key){duration+=dataPoint.enumMap[key]+": "+enumVal.duration[key]+"<br/>"})),value=duration}}else enumVal.timeline&&enumVal.timeline[0]&&(value=dataPoint.enumMap[enumVal.timeline[0].value])}}newRow.push(value)},i=1;i<_this5.tableState.columns.length;i++)_loop5();tableData.push(newRow)})),this.hotSettings.data=tableData)},
/**
     *   Splitting table for print view
     */
setMultipleTables:function(){var _this6=this;if(this.multiTables=[],this.maxColumn=this.hotSettings.colHeaders.length,this.isPrinting){this.maxColumn=MAX_COLUMN;var metricIndexes=[];this.hotSettings.colHeaders.forEach((function(header,idx){idx>0&&idx%_this6.maxColumn===0&&metricIndexes.push(idx)})),metricIndexes.forEach((function(idx){_this6.hotSettings.colHeaders.splice(idx,0,_this6.hotSettings.colHeaders[0]),_this6.hotSettings.columns.splice(idx,0,_this6.hotSettings.columns[0]),_this6.printReverse?_this6.hotSettings.data.forEach((function(data){data.splice(idx,0,data[0])})):_this6.hotSettings.data.splice(idx,0,_this6.hotSettings.data[0])}))}for(var i=0;i<this.hotSettings.colHeaders.length;i++){var tableNo=Math.floor(i/this.maxColumn),table=this.multiTables[tableNo];table||(table={columns:[],colWidth:"",showExtraColumn:!1},this.$set(this.multiTables,tableNo,table)),table.columns.push(this.hotSettings.colHeaders[i])}},saveCurrentState:function(){for(var _this7=this,stateColumns=[],_loop6=function(){var colWidth=_this7.hotTable.getColWidth(i),idx=_this7.hotTable.toPhysicalColumn(i),name=_this7.hotSettings.columns[idx].name,stateColumn=_this7.tableState.columns.find((function(col){return col.name===name}));stateColumn.width=colWidth,stateColumns.push(stateColumn)},i=0;i<this.hotTable.getColHeader().length;i++)_loop6();this.tableState.columns=stateColumns,this.reportConfig.params.tabularState=JSON.stringify(this.tableState)},formatDate:function(date,period){var dateFormat=this.getDateFormat(period);return this.$options.filters.toDateFormat(new Date(date),dateFormat.tooltip)},getColIdx:function(index,tindex){return index%this.maxColumn+(tindex>0?tindex*this.maxColumn:0)},initOptions:function(index,tindex){var idx=this.getColIdx(index,tindex);this.options.state=this.$helpers.cloneObject(this.tableState.columns[idx])},saveOptions:function(index,tindex){var _this8=this,setOption=function(colIdx){var column=_this8.tableState.columns[colIdx],dataPoint=_this8.dataMap[column.alias];!dataPoint||4!==dataPoint.dataTypeId&&8!==dataPoint.dataTypeId||_this8.$set(column,"enumMode",_this8.options.state.enumMode)};if(this.options.applyAll)this.tableState.columns.forEach((function(column,colIdx){setOption(colIdx)})),this.options.applyAll=!1;else{var idx=this.getColIdx(index,tindex);setOption(idx)}this.setHotConfig(),this.setTableData(),this.setMultipleTables(),this.reportConfig.params.tabularState=JSON.stringify(this.tableState)}}},components_ModularNewTabularReportvue_type_script_lang_js=ModularNewTabularReportvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_ModularNewTabularReportvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,ModularNewTabularReport=component.exports},
/***/422618:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"2442ea72f8cc979d507d155ee4398a3c.svg";
/***/},
/***/396295:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"f7effa954f08d947196ac09591f34694.svg";
/***/},
/***/754125:
/***/function(module,__unused_webpack_exports,__webpack_require__){var map={"./af":702525,"./af.js":702525,"./ar":689102,"./ar-dz":463778,"./ar-dz.js":463778,"./ar-kw":410960,"./ar-kw.js":410960,"./ar-ly":281490,"./ar-ly.js":281490,"./ar-ma":985507,"./ar-ma.js":985507,"./ar-sa":224042,"./ar-sa.js":224042,"./ar-tn":191523,"./ar-tn.js":191523,"./ar.js":689102,"./az":938365,"./az.js":938365,"./be":544860,"./be.js":544860,"./bg":709904,"./bg.js":709904,"./bm":660952,"./bm.js":660952,"./bn":709807,"./bn.js":709807,"./bo":858437,"./bo.js":858437,"./br":784557,"./br.js":784557,"./bs":979332,"./bs.js":979332,"./ca":493667,"./ca.js":493667,"./cs":276860,"./cs.js":276860,"./cv":515427,"./cv.js":515427,"./cy":158863,"./cy.js":158863,"./da":513520,"./da.js":513520,"./de":112111,"./de-at":30464,"./de-at.js":30464,"./de-ch":750701,"./de-ch.js":750701,"./de.js":112111,"./dv":494438,"./dv.js":494438,"./el":33121,"./el.js":33121,"./en-au":849197,"./en-au.js":849197,"./en-ca":753885,"./en-ca.js":753885,"./en-gb":551914,"./en-gb.js":551914,"./en-ie":880938,"./en-ie.js":880938,"./en-nz":619722,"./en-nz.js":619722,"./eo":742783,"./eo.js":742783,"./es":56820,"./es-do":559651,"./es-do.js":559651,"./es-us":146018,"./es-us.js":146018,"./es.js":56820,"./et":818686,"./et.js":818686,"./eu":831323,"./eu.js":831323,"./fa":261885,"./fa.js":261885,"./fi":263741,"./fi.js":263741,"./fo":219961,"./fo.js":219961,"./fr":802800,"./fr-ca":388121,"./fr-ca.js":388121,"./fr-ch":427979,"./fr-ch.js":427979,"./fr.js":802800,"./fy":428930,"./fy.js":428930,"./gd":695513,"./gd.js":695513,"./gl":224485,"./gl.js":224485,"./gom-latn":703878,"./gom-latn.js":703878,"./gu":25435,"./gu.js":25435,"./he":862825,"./he.js":862825,"./hi":727282,"./hi.js":727282,"./hr":402438,"./hr.js":402438,"./hu":591310,"./hu.js":591310,"./hy-am":614794,"./hy-am.js":614794,"./id":108761,"./id.js":108761,"./is":256593,"./is.js":256593,"./it":272196,"./it.js":272196,"./ja":812645,"./ja.js":812645,"./jv":471869,"./jv.js":471869,"./ka":174093,"./ka.js":174093,"./kk":919794,"./kk.js":919794,"./km":792637,"./km.js":792637,"./kn":828684,"./kn.js":828684,"./ko":94565,"./ko.js":94565,"./ky":465606,"./ky.js":465606,"./lb":472027,"./lb.js":472027,"./lo":280366,"./lo.js":280366,"./lt":327311,"./lt.js":327311,"./lv":531851,"./lv.js":531851,"./me":952700,"./me.js":952700,"./mi":673575,"./mi.js":673575,"./mk":195509,"./mk.js":195509,"./ml":429866,"./ml.js":429866,"./mr":713798,"./mr.js":713798,"./ms":526848,"./ms-my":701212,"./ms-my.js":701212,"./ms.js":526848,"./mt":863181,"./mt.js":863181,"./my":63977,"./my.js":63977,"./nb":47248,"./nb.js":47248,"./ne":891859,"./ne.js":891859,"./nl":127058,"./nl-be":66901,"./nl-be.js":66901,"./nl.js":127058,"./nn":561748,"./nn.js":561748,"./pa-in":634266,"./pa-in.js":634266,"./pl":79581,"./pl.js":79581,"./pt":687410,"./pt-br":906114,"./pt-br.js":906114,"./pt.js":687410,"./ro":138295,"./ro.js":138295,"./ru":539862,"./ru.js":539862,"./sd":59548,"./sd.js":59548,"./se":293236,"./se.js":293236,"./si":340289,"./si.js":340289,"./sk":658339,"./sk.js":658339,"./sl":574170,"./sl.js":574170,"./sq":615316,"./sq.js":615316,"./sr":668791,"./sr-cyrl":447630,"./sr-cyrl.js":447630,"./sr.js":668791,"./ss":65773,"./ss.js":65773,"./sv":731159,"./sv.js":731159,"./sw":422329,"./sw.js":422329,"./ta":267054,"./ta.js":267054,"./te":971280,"./te.js":971280,"./tet":154120,"./tet.js":154120,"./th":254679,"./th.js":254679,"./tl-ph":63270,"./tl-ph.js":63270,"./tlh":845386,"./tlh.js":845386,"./tr":664669,"./tr.js":664669,"./tzl":691434,"./tzl.js":691434,"./tzm":57217,"./tzm-latn":547665,"./tzm-latn.js":547665,"./tzm.js":57217,"./uk":969596,"./uk.js":969596,"./ur":985133,"./ur.js":985133,"./uz":349456,"./uz-latn":978737,"./uz-latn.js":978737,"./uz.js":349456,"./vi":905577,"./vi.js":905577,"./x-pseudo":464564,"./x-pseudo.js":464564,"./yo":68854,"./yo.js":68854,"./zh-cn":795817,"./zh-cn.js":795817,"./zh-hk":266634,"./zh-hk.js":266634,"./zh-tw":749292,"./zh-tw.js":749292};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=754125},
/***/15482:
/***/function(module,__unused_webpack_exports,__webpack_require__){"use strict";module.exports=__webpack_require__.p+"img/noData-light.3b5d6592.png"}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/10242.js.map