"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[67004],{
/***/767004:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return ConnectedAppViewWidget}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/connectedapps/ConnectedAppViewWidget.vue?vue&type=template&id=2a629fff
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.loading?_vm._e():_c("div",{staticClass:"height100 customize-scroll-hidden"},[_c("form",{ref:"formSubmit",attrs:{action:_vm.actionUrl,method:_vm.samlResponse?"POST":"GET",target:"iframeWidget-"+_vm.widgetId}},[_c("input",{attrs:{type:"hidden",name:"origin"},domProps:{value:_vm.origin}}),_c("input",{attrs:{type:"hidden",name:"capp_id"},domProps:{value:_vm.instanceUid}}),_vm.urlParams?_vm._l(_vm.urlParams,(function(param,index){return _c("input",{key:index,attrs:{type:"hidden",name:param.name},domProps:{value:param.value}})})):_vm._e(),_vm.samlResponse?_c("input",{attrs:{type:"hidden",name:"SAMLResponse"},domProps:{value:_vm.samlResponse}}):_vm._e(),_vm.relay?_c("input",{attrs:{type:"hidden",name:"RelayState"},domProps:{value:_vm.relay}}):_vm._e()],2),_c("iframe",{ref:"cappFrame",staticClass:"fc-connected-app-iframe",staticStyle:{width:"100%",height:"100%",border:"0px"},attrs:{name:"iframeWidget-"+_vm.widgetId,allow:"geolocation *; microphone *;  camera *;"}},[_vm._v(" The URL cannot be loaded in iframe. ")])])},staticRenderFns=[],slicedToArray=__webpack_require__(554621),createForOfIteratorHelper=__webpack_require__(566347),api=(__webpack_require__(260228),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(478730),__webpack_require__(779307),__webpack_require__(398858),__webpack_require__(461318),__webpack_require__(33228),__webpack_require__(670560),__webpack_require__(32284)),ConnectedAppViewWidgetvue_type_script_lang_js={props:["widgetId","recordId","context","handlers","exportMode"],data:function(){return{loading:!0,origin:null,instanceUid:null,urlParams:null,actionUrl:null,samlResponse:null,relay:null}},computed:{widgetKey:function(){var key=this.widgetId+"";return this.recordId&&(key=key+"_"+this.recordId),key}},mounted:function(){this.loadConnectedAppWidget()},watch:{widgetKey:function(){this.loadConnectedAppWidget()}},beforeDestroy:function(){this.destroyCurrentInstance()},methods:{getActions:function(){var _this=this;return{fullscreen:function(){return!!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled)&&(_this.$refs.cappFrame.requestFullscreen?_this.$refs.cappFrame.requestFullscreen():_this.$refs.cappFrame.webkitRequestFullscreen?_this.$refs.cappFrame.webkitRequestFullscreen():_this.$refs.cappFrame.mozRequestFullScreen?_this.$refs.cappFrame.mozRequestFullScreen():_this.$refs.cappFrame.msRequestFullscreen&&_this.$refs.cappFrame.msRequestFullscreen(),!0)},trigger:function(namespace,options){if(_this.handlers&&_this.handlers[namespace]&&"function"===typeof _this.handlers[namespace]){var returnValue=_this.handlers[namespace](options);return"undefined"===typeof returnValue||returnValue}return!1}}},getWidgetLinkName:function(key){if(key&&(key+="",key.indexOf("_")>0&&2===key.split("_").length)){var cappLink=key.split("_")[0],widgetLink=key.split("_")[1];if(cappLink.length&&widgetLink.length)return cappLink+"."+widgetLink}return null},loadConnectedAppWidget:function(){var _this2=this;this.destroyCurrentInstance(),this.loading=!0;var url="/v2/connectedApps/viewWidget?";this.getWidgetLinkName(this.widgetId)?url+="&widgetLinkName="+this.getWidgetLinkName(this.widgetId):url+="&widgetId="+this.widgetId,this.recordId&&(url+="&recordId="+this.recordId),api/* API */.bl.get(url).then((function(response){var data=response.data;if(_this2.loading=!1,data.viewUrl){_this2.samlResponse=data.samlResponse,_this2.relay=data.relay,_this2.actionUrl=_this2.samlResponse?data.acsURL:data.viewUrl;var connectedAppWidget=data.connectedAppWidget||{};_this2.$nextTick((function(){var frame=_this2.$refs.cappFrame.contentWindow,widgetOrigin=new URL(data.viewUrl).protocol+"//"+new URL(data.viewUrl).host;_this2.instanceUid=_this2.$connectedAppEventChannel.attachWidget(connectedAppWidget,_this2.context,{frame:frame,origin:widgetOrigin},_this2.getActions(),_this2.exportMode||!1),_this2.origin=_this2.$connectedAppEventChannel.getOrigin();var _step,urlParamsList=[],urlSearchParams=new URL(data.viewUrl).searchParams,_iterator=(0,createForOfIteratorHelper/* default */.Z)(urlSearchParams.entries());try{for(_iterator.s();!(_step=_iterator.n()).done;){var _step$value=(0,slicedToArray/* default */.Z)(_step.value,2),key=_step$value[0],value=_step$value[1];urlParamsList.push({name:key,value:value})}}catch(err){_iterator.e(err)}finally{_iterator.f()}_this2.urlParams=urlParamsList,_this2.$nextTick((function(){_this2.$refs.formSubmit.submit()}))}))}}))},destroyCurrentInstance:function(){this.instanceUid&&(this.$connectedAppEventChannel.deattachWidget(this.instanceUid),this.instanceUid=null)},sendEvent:function(key,data){this.instanceUid&&this.$connectedAppEventChannel.sendEventToInstance(this.instanceUid,key,data)}}},connectedapps_ConnectedAppViewWidgetvue_type_script_lang_js=ConnectedAppViewWidgetvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(connectedapps_ConnectedAppViewWidgetvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,ConnectedAppViewWidget=component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/67004.js.map