"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[20906],{
/***/920906:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return Pmsummary}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/workorder/multisitepreventive/v1/Pmsummary.vue?vue&type=template&id=2031637c
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"pm-summary"},[_c("div",{staticClass:"fc-pm-summary-header"},[_c("div",{staticClass:"fL"},[_c("div",{staticClass:"flex-middle"},[_c("i",{staticClass:"el-icon-back f18 pointer fc-black-color bold",on:{click:_vm.back}}),_c("span",{staticClass:"fc-id bold pL10"},[_vm._v("#"+_vm._s(_vm.pm&&_vm.pm.id?_vm.pm.id:""))]),_c("div",{staticClass:"fc-separator-lg mL20 mR20"}),_c("div",{staticClass:"heading-black22"},[_vm._v(" "+_vm._s(_vm.workorder?_vm.workorder.subject:"")+" ")])])]),_c("div",{staticClass:"fR show z-index9 position-relative"},[_c("div",{staticClass:"flex-middle"},[_c("div",{staticClass:"fc-summary-btn"},[_c("div",{staticClass:"pull-left row",staticStyle:{"padding-left":"30px"}},[_vm.$hasPermission("planned:UPDATE")||_vm.$hasPermission("planned:UPDATE_OWN")&&_vm.checkown()||_vm.$hasPermission("planned:UPDATE_TEAM")&&_vm.checkteam?_c("router-link",{attrs:{to:_vm.goToEdit(),replace:""}},[_c("div",{staticClass:"flLeft primarybtn",staticStyle:{"margin-right":"10px"}},[_c("q-btn",{staticClass:"fc-wo-border-btn",attrs:{small:""}},[_vm._v(_vm._s(_vm.$t("common._common.edit")))])],1)]):_vm._e(),_vm.showExecuteNow()?_c("el-button",{staticClass:"setup-el-btn edit-btn",attrs:{disabled:_vm.isExecuting,type:"primary"},on:{click:function($event){return _vm.preWoValidation()}}},[_vm._v(" "+_vm._s(_vm.isExecuting?_vm.$t("maintenance.pm_list.executing"):_vm.$t("maintenance.pm_list.execute_now"))+" ")]):_vm._e()],1)])]),"third"===_vm.activeName&&_vm.$route.query.pmreading?_c("div",{staticClass:"pm-reading-vs-task-switch"},[_vm.toggleReadingTable?!_vm.readingData.length&&_vm.toggleReadingTable?_c("span",{on:{click:function($event){_vm.toggleReadingTable=!1}}},[_vm._v(_vm._s(_vm.$t("maintenance.pm_list.switch_to_task")))]):_vm.readingData.length&&_vm.toggleReadingTable?_c("span",{on:{click:function($event){return _vm.updateReadingData()}}},[_vm._v(_vm._s(_vm.$t("maintenance.pm_list.save_data")))]):_vm._e():_c("span",{on:{click:function($event){_vm.toggleReadingTable=!0}}},[_vm._v(_vm._s(_vm.$t("maintenance.pm_list.switch_to_reading")))])]):_vm._e()]),_c("div",{staticClass:"clearboth mT50 fc-pm-summary-tab",class:[{"hide-overflow":"second"===_vm.activeName||"fourth"===_vm.activeName}]},[_vm.showExtendScheduleBanner?_c("div",{staticClass:"fc-notify-msg-blue flex-middle pm-trigger-notify justify-content-center"},[_c("InlineSvg",{attrs:{src:"svgs/info-2",iconClass:"icon icon-sm mR10"}}),_vm._v(" Maintenance jobs are planned only untill "+_vm._s(_vm._f("formatDate")(1e3*this.pm.woGeneratedUpto,!0))+". Would you like to schedule for later days ? "),_c("span",{staticClass:"fc-dark-blue4 f13 pointer pL5",on:{click:_vm.showExtension}},[_vm._v("Extend Now")])],1):_vm._e(),_vm.showRefreshBanner?_c("div",{staticClass:"fc-notify-msg-blue flex-middle pm-trigger-notify justify-content-center"},[_c("InlineSvg",{attrs:{src:"svgs/info-2",iconClass:"icon icon-sm mR10"}}),_vm._v("Schedule generation is underway. Would you like to refresh now ? "),_c("span",{staticClass:"fc-dark-blue4 f13 pointer pL5",on:{click:_vm.handleRefresh}},[_vm._v("Refresh")]),_vm.refreshButtonLoading?_c("i",{staticClass:"el-icon-loading mL5"}):_vm._e()],1):_vm._e(),_c("el-tabs",{staticClass:"pm-tabs",on:{"tab-click":_vm.handleClick},model:{value:_vm.activeName,callback:function($$v){_vm.activeName=$$v},expression:"activeName"}},[_c("el-tab-pane",{attrs:{label:_vm.$t("maintenance.pm_list.summary"),name:"first"}},[_c("div",{staticClass:"pm-summary-inner-container"},[_c("div",{staticClass:"fL pm-summary-inner-left-con mT20 pm-summary-tab-inner-left-con"},[_c("div",{staticClass:"p30 white-bg-block"},[_c("div",{staticClass:"heading-black18"},[_vm._v(" "+_vm._s(_vm.workorder?_vm.workorder.subject:"")+" ")]),_c("div",{staticClass:"space-preline pm-summary-tab-subject"},[_vm._v(" "+_vm._s(_vm.pmDescription)+" ")])]),_c("div",{staticClass:"pm-summary-card-container mT20"},[_c("div",{staticClass:"pm-summarycard-split-con mR20"},[_c("div",{staticClass:"summary-card"},[_c("p",{staticClass:"fc-black-11 fwBold text-uppercase"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm_list.next_scheduled"))+" ")]),_c("div",{staticClass:"summary-data-block pT10"},[_c("div",{staticClass:"date-block"},[_vm.pm.nextExecutionTime>0?_c("div",[_c("div",{staticClass:"fc-black2-18"},[_vm._v(" "+_vm._s(_vm._f("formatDate")(_vm.pm.nextExecutionTime,!0))+" ")]),_c("div",{staticClass:"fc-grey2 f13 pT5 text-center"},[_vm._v(" "+_vm._s(_vm._f("formatDate")(_vm.pm.nextExecutionTime,!1,!0))+" ")])]):_c("div",[_c("div",{staticClass:"fc-black3-16"},[_vm._v("---")])])])])]),_c("div",{staticClass:"summary-card"},[_c("p",{staticClass:"fc-black-11 fwBold text-uppercase"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm_list.last_triggered"))+" ")]),_c("div",{staticClass:"summary-data-block pT10"},[_c("div",{staticClass:"date-block"},[_vm.workordersArr&&_vm.workordersArr[0]?_c("div",[_c("div",{staticClass:"fc-black2-18"},[_vm._v(" "+_vm._s(_vm._f("formatDate")(_vm.workordersArr[0].createdTime,!0))+" ")]),_c("div",{staticClass:"fc-grey2 f13 text-center pT5"},[_vm._v(" "+_vm._s(_vm._f("formatDate")(_vm.workordersArr[0].createdTime,!1,!0))+" ")])]):_c("div",[_c("div",{staticClass:"fc-black3-16"},[_vm._v("---")])])])])])]),_c("div",{staticClass:"pm-summarycard-split-con"},[_c("div",{staticClass:"summary-card"},[1===_vm.pm.pmCreationType?_c("div",[_vm.workorder&&_vm.workorder.resource?_c("p",{staticClass:"fc-black-11 bold text-uppercase"},[_vm._v(" NO OF "+_vm._s(_vm.workorder.resource.resourceTypeEnum)+" ")]):_vm._e(),_c("div",{staticClass:"summary-data-block pT0"},[_c("div",{staticClass:"date-block"},[1===_vm.pm.pmCreationType?_c("div",[_vm.workorder&&_vm.workorder.resource?_c("div",[_c("div",{staticClass:"label-txt-black fw3",staticStyle:{"font-size":"40px"}},[_vm._v(" 1 ")]),_c("div",{staticClass:"fc-grey2 f13"},[_vm._v(" "+_vm._s(_vm.workorder.resource.name)+" ")])]):_vm._e()]):_vm._e()])])]):3===_vm.pm.pmCreationType&&4===_vm.pm.assignmentType?_c("div",[_c("p",{staticClass:"fc-black-11 fwBold text-uppercase"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm_list.associated_assets"))+" ")]),_c("div",{staticClass:"summary-data-block pT0"},[_c("div",{staticClass:"date-block"},[3===_vm.pm.pmCreationType&&4===_vm.pm.assignmentType?_c("div",[_vm.pm.pmIncludeExcludeResourceContexts&&_vm.pm.pmIncludeExcludeResourceContexts.length?_c("div",{staticClass:"label-txt-black",staticStyle:{"font-size":"40px"}},[_c("div",{staticClass:"label-txt-black fw3",staticStyle:{"font-size":"40px"}},[_vm._v(" "+_vm._s(""+_vm.pm.pmIncludeExcludeResourceContexts.length)+" ")]),_vm.assetcategory?_c("div",{staticClass:"fc-grey2 f13"},[_vm._v(" "+_vm._s(_vm.assetCategoryName)+" ")]):_vm._e()]):_vm.pm.assetCategoryId>-1?_c("div",[_c("div",{staticClass:"label-txt-black fw3",staticStyle:{"font-size":"40px"}},[_vm._v(" "+_vm._s(" "+_vm.resources.length)+" ")]),_vm.assetcategory?_c("div",{staticClass:"fc-grey2 f13"},[_vm._v(" "+_vm._s(""+_vm.assetcategory.find((function(i){return i.id===Number(_vm.pm.assetCategoryId)})).name)+" ")]):_vm._e()]):_vm._e()]):_c("div",[_c("div",{staticClass:"label-txt-black mT0"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm_list.no_associated_assets"))+" ")])])])])]):3===_vm.pm.pmCreationType&&7===_vm.pm.assignmentType?_c("div",[_c("p",{staticClass:"fc-black-11 fwBold text-uppercase"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm_list.associated_buildings"))+" ")]),_c("div",{staticClass:"summary-data-block pT0"},[_c("div",{staticClass:"date-block"},[3===_vm.pm.pmCreationType&&7===_vm.pm.assignmentType?_c("div",[_vm.pm.pmIncludeExcludeResourceContexts&&_vm.pm.pmIncludeExcludeResourceContexts.length?_c("div",{staticClass:"label-txt-black",staticStyle:{"font-size":"40px"}},[_c("div",{staticClass:"label-txt-black",staticStyle:{"font-size":"40px"}},[_vm._v(" "+_vm._s(""+_vm.pm.pmIncludeExcludeResourceContexts.length)+" ")])]):_vm.pm.pmIncludeExcludeCount>0?_c("div",{staticClass:"label-txt-black fw3",staticStyle:{"font-size":"40px"}},[_vm._v(" "+_vm._s(_vm.pm.pmIncludeExcludeCount)+" ")]):_c("div",[_c("div",{staticClass:"label-txt-black mT0"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm_list.no_associated_buildings"))+" ")])])]):_c("div",[_c("div",{staticClass:"label-txt-black mT0"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm_list.no_associated_buildings"))+" ")])])])])]):3===_vm.pm.pmCreationType&&3===_vm.pm.assignmentType?_c("div",[_c("p",{staticClass:"fc-black-11 fwBold text-uppercase"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm_list.associated_spaces"))+" ")]),_c("div",{staticClass:"summary-data-block pT0"},[_c("div",{staticClass:"date-block"},[3===_vm.pm.pmCreationType&&3===_vm.pm.assignmentType?_c("div",[_vm.pm.pmIncludeExcludeResourceContexts&&_vm.pm.pmIncludeExcludeResourceContexts.length?_c("div",{staticClass:"label-txt-black",staticStyle:{"font-size":"40px"}},[_c("div",{staticClass:"label-txt-black",staticStyle:{"font-size":"40px"}},[_vm._v(" "+_vm._s(""+_vm.pm.pmIncludeExcludeResourceContexts.length)+" ")]),_vm.spacecategory?_c("div",{staticClass:"fc-grey2 f13"},[_vm._v(" "+_vm._s(_vm.spacecategory[Number(_vm.pm.spaceCategoryId)])+" ")]):_vm._e()]):_vm.pm.spaceCategoryId>-1?_c("div",[_c("div",{staticClass:"label-txt-black",staticStyle:{"font-size":"40px"}},[_vm._v(" "+_vm._s(" "+_vm.resources.length)+" ")]),_c("div",{staticClass:"fc-grey2 f13"},[_vm._v(" "+_vm._s(""+_vm.spacecategory[_vm.pm.spaceCategoryId])+" ")])]):_vm._e()]):_c("div",[_c("div",{staticClass:"label-txt-black mT0"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm_list.no_associated_spaces"))+" ")])])])])]):3===_vm.pm.pmCreationType&&1===_vm.pm.assignmentType?_c("div",[_c("p",{staticClass:"fc-black-11 fwBold text-uppercase"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm_list.associated_spaces"))+" ")]),_c("div",{staticClass:"summary-data-block pT0"},[_c("div",{staticClass:"date-block"},[3===_vm.pm.pmCreationType&&1===_vm.pm.assignmentType?_c("div",[_vm.pm.pmIncludeExcludeResourceContexts&&_vm.pm.pmIncludeExcludeResourceContexts.length?_c("div",{staticClass:"label-txt-black",staticStyle:{"font-size":"40px"}},[_c("div",{staticClass:"label-txt-black",staticStyle:{"font-size":"40px"}},[_vm._v(" "+_vm._s(""+_vm.pm.pmIncludeExcludeResourceContexts.length)+" ")]),_c("div",{staticClass:"fc-grey2 f13"},[_vm._v(" "+_vm._s(_vm.$t("space.sites.floors"))+" ")])]):_vm.pm.spaceCategoryId>-1?_c("div",[_c("div",{staticClass:"label-txt-black",staticStyle:{"font-size":"40px"}},[_vm._v(" "+_vm._s(" "+_vm.resources.length)+" ")]),_c("div",{staticClass:"fc-grey2 f13"},[_vm._v(" "+_vm._s(_vm.$t("space.sites.floors"))+" ")])]):_vm._e()]):_c("div")])])]):3===_vm.pm.pmCreationType&&8===_vm.pm.assignmentType?_c("div",[_c("p",{staticClass:"fc-black-11 fwBold text-uppercase"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm_list.associated_sites"))+" ")]),_c("div",{staticClass:"summary-data-block pT0"},[_c("div",{staticClass:"date-block"},[3===_vm.pm.pmCreationType&&8===_vm.pm.assignmentType?_c("div",[_vm.pm.pmIncludeExcludeResourceContexts&&_vm.pm.pmIncludeExcludeResourceContexts.length?_c("div",{staticClass:"label-txt-black",staticStyle:{"font-size":"40px"}},[_c("div",{staticClass:"label-txt-black fw3",staticStyle:{"font-size":"40px"}},[_vm._v(" "+_vm._s(""+_vm.pm.pmIncludeExcludeResourceContexts.length)+" ")])]):_vm.pm.pmIncludeExcludeCount>0?_c("div",{staticClass:"label-txt-black fw3",staticStyle:{"font-size":"40px"}},[_vm._v(" "+_vm._s(_vm.pm.pmIncludeExcludeCount)+" ")]):_c("div",[_c("div",{staticClass:"label-txt-black mT0"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm_list.no_associated_sites"))+" ")])])]):_c("div",[_c("div",{staticClass:"label-txt-black mT0"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm_list.no_associated_sites"))+" ")])])])])]):_c("div",[_c("p",{staticClass:"fc-black-11 fwBold text-uppercase"},[_vm._v(" "+_vm._s("---")+" ")])])]),_c("div",{staticClass:"summary-card"},[_c("p",{staticClass:"fc-black-11 fwBold text-uppercase"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm_list.freq_assignedto"))+" ")]),_c("div",{staticClass:"summary-data-block pT10"},[_vm.freqAssignUser?_c("div",{},[_c("user-avatar",{attrs:{size:"md",user:_vm.freqAssignUser,name:!1}}),_c("div",{staticClass:"fc-black-14 pT5 bold",staticStyle:{"padding-right":"0"}},[_vm._v(" "+_vm._s(_vm.freqAssignUser.name)+" ")])],1):_vm.workflowResult.woFreqAssign.loading?_c("div",[_c("spinner",{attrs:{show:_vm.workflowResult.woFreqAssign.loading,size:"60"}})],1):_c("div",[_c("avatar",{attrs:{size:"xlg",user:{name:"---"}}}),_c("div",{staticClass:"fc-black-15 mT10"})],1)])])])]),_c("div",{staticClass:"pm-summary-single-card-con mT20"},[_c("div",{staticClass:"summary-card pm-summary-single-card"},[_c("p",{staticClass:"fc-black-11 fwBold text-uppercase"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm_list.on_time_completion"))+" ")]),_c("div",{staticClass:"summary-data-block"},[_c("div",[_vm.workflowResult.woOnTime.loading?_c("div",{staticClass:"flex-middle justify-content-center"},[_c("spinner",{attrs:{show:_vm.workflowResult.woOnTime.loading,size:"60"}})],1):_c("div",{staticClass:"pm-sum-pie-chart"},[_c("pie",{attrs:{percent:_vm.workflowResult.woOnTime.result?Math.round(_vm.workflowResult.woOnTime.result):0,width:"73"}}),_vm.previousMonthworkflowResult.woOnTime.result?_c("div",{staticClass:"fc-black-12",staticStyle:{"padding-top":"13px"}},[_c("span",{staticClass:"fc-red2-16"},[_vm._v(" "+_vm._s(_vm.previousMonthworkflowResult.woOnTime.result?Math.round(_vm.previousMonthworkflowResult.woOnTime.result):0)+"% ")]),_vm._v(" till "+_vm._s(_vm.endDate)+" ")]):_vm.endDate>0?_c("div",{staticClass:"fc-black-12",staticStyle:{"padding-top":"13px"}},[_c("span",{staticClass:"fc-red2-16"},[_vm._v("0%")]),_vm._v(" till "+_vm._s(_vm.endDate)+" ")]):_vm._e()],1)])])]),_c("div",{staticClass:"summary-card pm-summary-single-card"},[_c("p",{staticClass:"fc-black-11 fwBold text-uppercase"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm_list.average_work_duration"))+" ")]),null!==_vm.averageDuration||null!==_vm.lastMonthAverageDuration?[_c("div",{staticClass:"flex-middle justify-center flex-col mT40"},[_vm.averageDuration&&_vm.averageDuration.days>0?_c("div",[_c("div",{staticClass:"flex-middle"},[_c("div",{},[_vm.averageDuration&&_vm.lastMonthAverageDuration?[_vm.averageDuration.days>_vm.lastMonthAverageDuration.days?_c("i",{staticClass:"el-icon-top fc-black-15 vertical-middle fwBold width0 pR20",staticStyle:{color:"#2cb988"}}):_vm.averageDuration.days<_vm.lastMonthAverageDuration.days?_c("i",{staticClass:"el-icon-bottom fc-black-15 vertical-middle fwBold width0 pR20",staticStyle:{color:"#e87171"}}):_vm._e(),_c("i",{staticClass:"el-icon-top fc-black-15 vertical-middle fwBold width0 pR20",staticStyle:{color:"#2cb988"}})]:_vm._e()],2),_c("div",{staticClass:"fc-black-com f36 fw3 pR20"},[_vm._v(" "+_vm._s(_vm.averageDuration.days)+" ")])]),_c("div",{staticClass:"fc-grey2 f13 pR10"},[_vm._v(" "+_vm._s(_vm.averageDuration.days>1?_vm.$t("maintenance.pm_list.days"):"day")+" ")])]):_vm.averageDuration&&_vm.averageDuration.hours?_c("div",[_c("div",{staticClass:"flex-middle align-center"},[_c("div",[null!==_vm.lastMonthAverageDuration&&_vm.averageDuration.hours>_vm.lastMonthAverageDuration.hours?_c("i",{staticClass:"el-icon-top fc-black-15 vertical-middle fwBold width0 pR20",staticStyle:{color:"#2cb988"}}):null!==_vm.lastMonthAverageDuration&&_vm.averageDuration.hours<_vm.lastMonthAverageDuration.hours?_c("i",{staticClass:"el-icon-bottom fc-black-15 vertical-middle fwBold width0 pR20",staticStyle:{color:"#e87171"}}):_c("i",{staticClass:"el-icon-top fc-black-15 vertical-middle fwBold width0 pR20",staticStyle:{color:"#2cb988"}})]),_c("div",{staticClass:"fc-black-com f36 fw3 pR20"},[_vm._v(" "+_vm._s(_vm.averageDuration.hours)+" ")])]),_c("div",{staticClass:"fc-grey2 f13 pR10"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm_list.hours"))+" ")])]):_c("div",{staticClass:"fc-black-com f36 fw3 mT40"},[_c("i",{staticClass:"el-icon-top fc-black-15 vertical-middle fwBold"}),_vm._v(" 00.00 ")]),null!==_vm.lastMonthAverageDuration?_c("div",{staticClass:"fc-black-12 mT40"},[_c("span",{},[_vm._v(" "+_vm._s(0!==_vm.lastMonthAverageDuration.days?_vm.lastMonthAverageDuration.days+(_vm.lastMonthAverageDuration.days>1?" days ":" day "):"")+" "+_vm._s(0!==_vm.lastMonthAverageDuration.hours?_vm.lastMonthAverageDuration.hours+(_vm.lastMonthAverageDuration.hours>1?" hours ":" hour "):"")+" ")]),_vm._v(" till "+_vm._s(_vm.endDate)+" ")]):_c("div",{staticClass:"fc-black-12",staticStyle:{"padding-top":"13px"}},[_c("span",{staticClass:"fc-red2-16"},[_vm._v("0")]),_vm._v(" till "+_vm._s(_vm.endDate)+" ")])])]:_vm.workflowResult.woAvgRes.loading?_c("div",{staticClass:"flex-middle justify-content-center"},[_c("spinner",{attrs:{show:_vm.workflowResult.woAvgRes.loading,size:"60"}})],1):[_c("div",{staticClass:"flex-middle justify-center flex-col mT30"},[_c("div",{staticClass:"fc-black-com f36 fw3"},[_c("InlineSvg",{staticClass:"vertical-middle",attrs:{src:"svgs/work-duration-empty",iconClass:"icon icon-xxxlg"}})],1),_c("div",{staticClass:"fc-black-12 mT40"})])]],2),_c("div",{staticClass:"summary-card pm-summary-single-card",staticStyle:{"border-right":"transparent !important"}},[_c("p",{staticClass:"fc-black-11 fwBold text-uppercase"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm_list.average_response_time"))+" ")]),_c("div",{staticClass:"flex-middle justify-center flex-col pT0"},[_vm.averageRes>0||_vm.previousMonthAverageRes>0?[_c("div",[_vm.averageResponseTime.timedays&&_vm.averageResponseTime.timedays>0?_c("div",{staticClass:"flex-middle justify-center flex-col mT40"},[_c("div",{staticClass:"flex-middle justify-center"},[_c("div",[_vm.previousMonthAverageResponseTime.timedays&&_vm.averageResponseTime.timedays>_vm.previousMonthAverageResponseTime.timedays?_c("i",{staticClass:"el-icon-top fc-black-15 vertical-middle fwBold width0 pR20",staticStyle:{color:"#2cb988"}}):_vm.previousMonthAverageResponseTime.timedays&&_vm.averageResponseTime.timedays<_vm.previousMonthAverageResponseTime.timedays?_c("i",{staticClass:"el-icon-bottom fc-black-15 vertical-middle fwBold width0 pR20",staticStyle:{color:"#e87171"}}):_c("i",{staticClass:"el-icon-top fc-black-15 vertical-middle fwBold width0 pR20",staticStyle:{color:"#2cb988"}})]),_c("div",{staticClass:"fc-black-com f36 fw3 pR20"},[_vm._v(" "+_vm._s(_vm.averageResponseTime.timedays)+" ")])]),_c("div",{staticClass:"fc-grey2 f13"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm_list.days"))+" ")])]):_vm.averageResponseTime.timehours&&_vm.averageResponseTime.timehours>0?_c("div",{staticClass:"flex-middle justify-center flex-col mT40"},[_c("div",{staticClass:"flex-middle justify-center"},[_vm.previousMonthAverageResponseTime.timehours&&_vm.averageResponseTime.timehours>_vm.previousMonthAverageResponseTime.timehours?_c("i",{staticClass:"el-icon-top fc-black-15 vertical-middle fwBold width0 pR20",staticStyle:{color:"#2cb988"}}):_vm.previousMonthAverageResponseTime.timehours&&_vm.averageResponseTime.timehours<_vm.previousMonthAverageResponseTime.timehours?_c("i",{staticClass:"el-icon-bottom fc-black-15 vertical-middle fwBold width0 pR20",staticStyle:{color:"#e87171"}}):_c("i",{staticClass:"el-icon-top fc-black-15 vertical-middle fwBold width0 pR20",staticStyle:{color:"#2cb988"}}),_c("div",{staticClass:"fc-black-com f36 fw3 pR20"},[_vm._v(" "+_vm._s(_vm.averageResponseTime.timehours)+" ")])]),_c("div",{staticClass:"fc-grey2 f13"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm_list.hours"))+" ")])]):_vm.averageResponseTime.timemins>0?_c("div",{staticClass:"flex-middle justify-center flex-col mT40"},[_c("div",{staticClass:"flex-middle justify-center"},[_c("div",[_vm.previousMonthAverageResponseTime.timemins&&_vm.averageResponseTime.timemins>_vm.previousMonthAverageResponseTime.timemins?_c("i",{staticClass:"el-icon-top fc-black-15 vertical-middle fwBold width0 pR20",staticStyle:{color:"#2cb988"}}):_vm.previousMonthAverageResponseTime.timemins&&_vm.averageResponseTime.timemins<_vm.previousMonthAverageResponseTime.timemins?_c("i",{staticClass:"el-icon-bottom fc-black-15 vertical-middle fwBold width0 pR20",staticStyle:{color:"#e87171"}}):_c("i",{staticClass:"el-icon-top fc-black-15 vertical-middle fwBold width0 pR20",staticStyle:{color:"#2cb988"}}),_c("div",{staticClass:"fc-black-com f36 fw3 pR20"},[_vm._v(" "+_vm._s(_vm.averageResponseTime.timemins)+" ")])])]),_c("div",{staticClass:"fc-grey2 f13"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm_list.minutes"))+" ")])]):_c("div",{staticClass:"fc-black-com f36 fw3 mT40"},[_c("i",{staticClass:"el-icon-top fc-black-15 vertical-middle fwBold"}),_vm._v(" 00.00 ")]),_vm.previousMonthAverageResponseTime.timedays>0||_vm.previousMonthAverageResponseTime.timehours>0||_vm.previousMonthAverageResponseTime.timemins>0?_c("div",{staticClass:"fc-black-12 mT40"},[_c("span",{},[_vm._v(" "+_vm._s(_vm.previousMonthAverageResponseTime.timedays?_vm.previousMonthAverageResponseTime.timedays+" days till "+_vm.endDate:_vm.previousMonthAverageResponseTime.timehours?_vm.previousMonthAverageResponseTime.timehours+" hours till "+_vm.endDate:_vm.previousMonthAverageResponseTime.timemins?_vm.previousMonthAverageResponseTime.timemins+" minutes till "+_vm.endDate:"")+" ")])]):_c("div",{staticClass:"fc-black-12",staticStyle:{"padding-top":"13px"}},[_c("span",{staticClass:"fc-red2-16"},[_vm._v("0")]),_vm._v(" till "+_vm._s(_vm.endDate)+" ")])])]:_vm.avgResponseLoading?_c("div",{staticClass:"flex-middle justify-content-center"},[_c("spinner",{attrs:{show:_vm.avgResponseLoading,size:"60"}})],1):[_c("div",{staticClass:"flex-middle justify-center flex-col",staticStyle:{"margin-top":"30px"}},[_c("div",{staticClass:"fc-black-com f36 fw3"},[_c("InlineSvg",{staticClass:"vertical-middle",attrs:{src:"svgs/work-duration-empty",iconClass:"icon icon-xxxlg"}})],1)])]],2)])]),_c("div",{staticClass:"white-bg-block mT20 width100"},[_c("div",{staticClass:"fc-black3-16 border-bottom9 pT20 pB20 pL30 pR30 height60px"},[_c("div",{staticClass:"fL"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.wr_list.attachments"))+" ")])]),_vm.workorder.attachments&&_vm.workorder.attachments.length?_c("div",{staticClass:"pm-summary-attachement mT10 pB20"},_vm._l(_vm.workorder.attachments,(function(attachment){return _c("div",{key:attachment.fileName,staticClass:"fc-attachment-row pL10 pR10 mR30 mL30 border-bottom7"},[_c("el-row",{staticClass:"pT10 pB10 flex-middle"},[_c("el-col",{attrs:{span:1}},[_c("img",{staticClass:"mT5",attrs:{src:__webpack_require__(250620),width:"20px"}})]),_c("el-col",{attrs:{span:20}},[_c("a",{staticClass:"attachment-label text-left fc-black-13 show max-width300px textoverflow-ellipsis",attrs:{href:attachment.previewUrl,target:"_blank"}},[_vm._v(_vm._s(attachment.fileName))])]),_c("el-col",{attrs:{span:2}},[_c("div",{staticClass:"attachment-sublabel"},[_c("span",{staticClass:"comment-file"},[_vm._v(_vm._s(_vm._f("prettyBytes")(attachment.fileSize)))]),1===attachment.status?_c("span",{staticClass:"comment-file"},[_vm._v(" , "+_vm._s(_vm.$t("maintenance.pm_list.updateding"))+"... ")]):2===attachment.status?_c("span",{staticClass:"comment-file"},[_vm._v(", "+_vm._s(_vm.$t("maintenance.pm_list.success")))]):_c("span",{staticClass:"comment-file"},[_vm._v(" "+_vm._s(attachment.error)+" ")])])])],1)],1)})),0):_c("div",{staticClass:"text-center height200 nowo-label flex-middle justify-content-center flex-direction-column"},[_c("inline-svg",{attrs:{src:"svgs/emptystate/attachements",iconClass:"icon text-center icon-80"}}),_c("div",{staticClass:"f14 nowo-label"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm_list.no_attachments"))+" ")])],1)]),_vm.showChart?_c("div",{staticClass:"white-bg-block mT20 position-relative"},[_c("div",{staticClass:"pL30 pR20 pB15 pT20 fc-black3-16 border-bottom11"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm_list.average_work_duration"))+" ")]),_c("f-new-analytic-modular-report",{ref:"analyticReport",staticClass:"fc-pm-summary-chart-block",attrs:{module:_vm.computedModule,reportid:null,hideTabs:!0,showDatePicker:!0,serverConfig:_vm.serverConfig},on:{"update:serverConfig":function($event){_vm.serverConfig=$event},"update:server-config":function($event){_vm.serverConfig=$event}}})],1):_vm._e()])])]),_vm.pm.triggers&&_vm.pm.triggers.length?_c("el-tab-pane",{staticClass:"position-relative",attrs:{label:_vm.$t("maintenance.pm_list.trigger"),name:"second",lazy:""}},[_vm.showExtendScheduleBanner?_c("div",{staticClass:"width100",staticStyle:{height:"38px",background:"transparent"}}):_vm._e(),_c("div",{staticClass:"pm-summary-inner-container mT20"},[_c("div",{staticClass:"white-bg-block"},[_c("el-tabs",{staticClass:"trigger-tab",on:{"tab-click":_vm.handleClick},model:{value:_vm.triggertab,callback:function($$v){_vm.triggertab=$$v},expression:"triggertab"}},[_c("el-tab-pane",{attrs:{label:"overview",name:"overview"}},["second"===_vm.activeName?_c("pm-triggers",{attrs:{pm:_vm.pm,resources:_vm.resources,pmObject:_vm.pmObject}}):_vm._e()],1),_c("el-tab-pane",{attrs:{label:"Asset Planner",name:"asset",lazy:""}},[_c("pm-summary-resource-planner",{ref:"assetplanner",attrs:{pm:_vm.pm},on:{viewChanged:_vm.handleViewChange}})],1),_c("el-tab-pane",{attrs:{label:"Staff Planner",name:"staff",lazy:""}},[_c("pm-summary-resource-planner",{ref:"staffplanner",attrs:{pm:_vm.pm,isStaffPlanner:""},on:{viewChanged:_vm.handleViewChange}})],1)],1)],1)])]):_vm._e(),_vm.newViewPreRequests&&_vm.newViewPreRequests.length>0||_vm.preRequests.length>0?_c("el-tab-pane",{attrs:{label:"PREREQUISITES",name:"fifth"}},[_c("div",{staticClass:"pm-summary-inner-container"},[_c("div",{staticClass:"fL pm-summary-inner-left-con mT20 white-bg-block",staticStyle:{width:"70.5% !important","padding-bottom":"100px",height:"100vh","overflow-y":"scroll"}},[_c("div",{staticClass:"pL30 pR30 pT20"},[_c("div",{staticClass:"label-txt-black"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm_list.validation"))+" ")]),_c("el-checkbox",{staticClass:"pT20",attrs:{disabled:""},model:{value:_vm.photoMandatory,callback:function($$v){_vm.photoMandatory=$$v},expression:"photoMandatory"}},[_vm._v(_vm._s(_vm.$t("maintenance._workorder.photo")))]),_vm._e(),3===_vm.allowNegativePreRequisite?_c("div",[_c("el-form",{attrs:{disabled:"",model:_vm.workorder,"label-position":"top"}},[_c("div",{staticClass:"fc-input-label-txt pT20"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm_list.approver_title"))+" ")]),_c("el-form-item",{staticClass:"mB10",staticStyle:{"margin-left":"-10px"},attrs:{prop:"approvers"}},_vm._l(_vm.approvers,(function(approver,key){return _c("el-row",{key:key,staticClass:"criteria-condition-block max-width650px"},[_c("el-col",{attrs:{span:6}},[_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{placeholder:"Select"},model:{value:approver.sharingType,callback:function($$v){_vm.$set(approver,"sharingType",$$v)},expression:"approver.sharingType"}},_vm._l(_vm.approvalTypes,(function(field,index){return _c("el-option",{key:index,attrs:{label:field.name,value:field.id}})})),1)],1),_c("el-col",{staticClass:"mL20",attrs:{span:6}},[_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{placeholder:"Select"},model:{value:approver.approversId,callback:function($$v){_vm.$set(approver,"approversId",$$v)},expression:"approver.approversId"}},_vm._l(approver.approvesDataType,(function(objList,index){return _c("el-option",{key:index,attrs:{label:objList.name,value:objList.id}})})),1)],1)],1)})),1)],1)],1):_vm._e()],1),_vm.isNewViewTempPreRequest?_c("div",{staticClass:"pL30 pR30 pB40"},[_c("div",{staticClass:"task-tab-block mT0"},[_vm._l(_vm.newViewPreRequests,(function(data,index){return _c("div",{key:index},["default"!==data.sectionName?_c("div",{staticStyle:{"margin-top":"20px","padding-top":"10px","font-size":"13px","font-weight":"bold","letter-spacing":"0.6px",color:"#333333","padding-bottom":"10px","padding-left":"8px"},style:{"border-bottom":"default"!==data.sectionName?"1px solid #eceef1":"0"}},[_vm._v(" "+_vm._s(data.sectionName)+" ")]):_vm._e(),_vm._l(data.preRequests,(function(task,idx){return _c("div",{key:idx,staticClass:"task-container",on:{click:function($event){return _vm.showDetailsPreRequest(task)}}},[_c("div",{staticClass:"pL10",class:["task-list",{"selected-task":_vm.selectedPreRequest===task}]},[_c("div",{staticClass:"task-content"},[_c("i",{staticClass:"fa fa-circle",staticStyle:{color:"#39b2c2","font-size":"10px","padding-right":"5px",position:"relative",width:"20px",float:"left"},attrs:{"aria-hidden":"true"}}),_c("div",{staticStyle:{width:"75%"}},[_vm._v(" "+_vm._s(task.subject?task.subject:"")+" ")]),_c("div",{staticClass:"flex-middle mR10 justify-content-end"},[_c("div",{staticClass:"flex-middle"},[_c("div",{staticClass:"dot-green-postivite"}),_c("div",{staticClass:"pL5 label-txt-black"},[_vm._v(" "+_vm._s(task.truevalue)+" ")])]),_c("div",{staticClass:"flex-middle pL30"},[_c("div",{staticClass:"dot-red-negative"}),_c("div",{staticClass:"pL5 label-txt-black"},[_vm._v(" "+_vm._s(task.falsevalue)+" ")])])])])])])}))],2)})),_vm._l(_vm.tasks,(function(section,sectionname,index){return _vm.isNewViewTempPreRequest?_vm._e():_c("div",{key:index},["default"!==sectionname?_c("div",{staticStyle:{"padding-top":"35px","font-size":"13px","font-weight":"bold","letter-spacing":"0.6px",color:"#333333","padding-bottom":"10px","padding-left":"8px"},style:{"border-bottom":"default"!==sectionname?"solid 1px #d9f4f7":"0"}},[_vm._v(" "+_vm._s(sectionname)+" ")]):_vm._e(),_vm._l(section,(function(task,idx){return _c("div",{key:idx,staticClass:"task-container",on:{click:function($event){return _vm.showDetailsPreRequest(task)}}},[_c("div",{staticClass:"fc-list-hover-task",class:["task-list",{"selected-task":_vm.selectedPreRequest===task}]},[_c("div",{staticClass:"task-content"},[_c("i",{staticClass:"fa fa-circle",staticStyle:{color:"#b8e5eb","font-size":"10px","padding-right":"5px",position:"relative",width:"20px",float:"left"},attrs:{"aria-hidden":"true"}}),_c("div",{staticClass:"task-content-item"},[_vm._v(" "+_vm._s(task.subject?task.subject:"")+" ")])])])])}))],2)}))],2)]):_vm._e()]),_vm.toggleReadingTable?_vm._e():_c("div",{staticClass:"fR pm-summary-inner-right-con fc-v1-wo-sum-right width28"},[_c("div",{staticClass:"fc-scrollbar-wrap pT10"},[_vm.selectedPreRequest?_c("div",{staticClass:"p20 white-bg-block pm-summary-right-bg height100vh"},[_c("div",{staticClass:"pB70"},[_c("div",{staticClass:"task-details-header position-relative"},[_c("div",{staticClass:"tdetail-title-block fc-tdetail-title-block fR"},[_c("i",{directives:[{name:"tippy",rawName:"v-tippy",value:{arrow:!0,animation:"shift-away",placement:"top"},expression:"{\n                            arrow: true,\n                            animation: 'shift-away',\n                            placement: 'top',\n                          }"}],staticClass:"el-icon-close tclose-icon text-left wo__close__icon",attrs:{title:"Close"},on:{click:_vm.closedisplay}})]),_c("div",{staticClass:"task-details-list clearboth"},[_c("div",{staticClass:"task-detail-content"},[_c("div",{staticClass:"task-list-item label-txt-black bold"},[_vm._v(" "+_vm._s(_vm.selectedPreRequest.subject)+" ")])])])]),_c("div",[_c("div",[_vm.selectedPreRequest.description?_c("div",[_c("div",{staticClass:"fc-blue-label"},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.description"))+" ")]),_c("el-input",{staticClass:"form-item mT10",attrs:{disabled:"",type:"textarea"},model:{value:_vm.selectedPreRequest.description,callback:function($$v){_vm.$set(_vm.selectedPreRequest,"description",$$v)},expression:"selectedPreRequest.description"}})],1):_vm.selectedPreRequest.description?_vm._e():_c("div")]),"6"===_vm.selectedPreRequest.inputType?_c("div",[_c("div",{staticClass:"pT10 label-txt-black clearboth"},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.options"))+" ")]),_c("div",{staticClass:"taskoption pT20"},[_c("div",[_c("el-input",{staticClass:"woidth100 fc-input-full-border2",attrs:{disabled:"",type:"text",placeholder:""},model:{value:_vm.selectedPreRequest.truevalue,callback:function($$v){_vm.$set(_vm.selectedPreRequest,"truevalue",$$v)},expression:"selectedPreRequest.truevalue"}})],1),_c("div",{staticClass:"pT20"},[_c("el-input",{staticClass:"width100 fc-input-full-border2",attrs:{disabled:"",type:"text",placeholder:""},model:{value:_vm.selectedPreRequest.falsevalue,callback:function($$v){_vm.$set(_vm.selectedPreRequest,"falsevalue",$$v)},expression:"selectedPreRequest.falsevalue"}})],1)])]):_vm._e()])])]):_vm._e()])])])]):_vm._e(),_c("el-tab-pane",{attrs:{label:_vm.$t("maintenance._workorder.tasks"),name:"third"}},[_c("div",{staticClass:"pm-summary-inner-container"},[_c("div",{staticClass:"fL pm-summary-inner-left-con mT20",class:{"pm-layout-full-wdith":_vm.toggleReadingTable,"pm-layout-half-wdith":!_vm.toggleReadingTable},staticStyle:{"padding-bottom":"100px",height:"100vh","overflow-y":"scroll"}},[_vm.isNewViewTemp&&!_vm.toggleReadingTable?_c("div",{staticClass:"pL30 pR30 pT10 pB40 white-bg-block height100 over overflow-y-scroll"},[_c("div",{staticClass:"task-tab-block mT0"},[_vm._l(_vm.newViewTasks,(function(data,index){return _c("div",{key:index},["default"!==data.sectionName?_c("div",{staticStyle:{"margin-top":"20px","padding-top":"10px","font-size":"13px","font-weight":"bold","letter-spacing":"0.6px",color:"#333333","padding-bottom":"10px","padding-left":"8px"},style:{"border-bottom":"default"!==data.sectionName?"1px solid #eceef1":"0"}},[_vm._v(" "+_vm._s(data.sectionName)+" "),_c("div",{staticClass:"fR mR15"},[_vm._v(_vm._s(data.resourceLabel))])]):_vm._e(),_vm._l(data.tasks,(function(task,idx){return _c("div",{key:idx,staticClass:"task-container",on:{click:function($event){return _vm.showDetails(task)}}},[_c("div",{staticClass:"pL10",class:["task-list",{"selected-task":_vm.selectedTask===task}]},[_c("div",{staticClass:"task-content"},[_c("div",{staticClass:"task-content-item"},[_c("span",{staticClass:"fc-id"},[_vm._v("#"+_vm._s(task.uniqueId))]),_vm._v(" "+_vm._s(task.subject?task.subject:"")+" ")]),task.resource&&-1!==task.resource.id?_c("div",{staticClass:"task-list-icon"},[_c("span",{staticClass:"task-resource-name"},[_vm._v(_vm._s(task.resource.name))]),1===task.resource.resourceType?_c("img",{staticStyle:{height:"12px",width:"14px"},attrs:{src:__webpack_require__(572902)}}):_c("img",{staticStyle:{height:"11px",width:"14px"},attrs:{src:__webpack_require__(30684)}})]):_vm._e(),task.resourceLabel?_c("div",{staticClass:"task-list-icon"},[_c("span",{staticClass:"task-resource-name"},[_vm._v(_vm._s(task.resourceLabel))])]):_vm._e()])])])}))],2)})),_vm._l(_vm.tasks,(function(section,sectionname,index){return _vm.isNewViewTemp?_vm._e():_c("div",{key:index},["default"!==sectionname?_c("div",{staticStyle:{"padding-top":"35px","font-size":"13px","font-weight":"bold","letter-spacing":"0.6px",color:"#333333","padding-bottom":"10px","padding-left":"8px"},style:{"border-bottom":"default"!==sectionname?"solid 1px #d9f4f7":"0"}},[_vm._v(" "+_vm._s(sectionname)+" ")]):_vm._e(),_vm._l(section,(function(task,idx){return _c("div",{key:idx,staticClass:"task-container",on:{click:function($event){return _vm.showDetails(task)}}},[_c("div",{staticClass:"fc-list-hover-task",class:["task-list",{"selected-task":_vm.selectedTask===task}]},[_c("div",{staticClass:"task-content"},[_c("i",{staticClass:"fa fa-circle",staticStyle:{color:"#b8e5eb","font-size":"10px","padding-right":"5px",position:"relative",width:"20px",float:"left"},attrs:{"aria-hidden":"true"}}),_c("div",{staticClass:"task-content-item"},[_vm._v(" "+_vm._s(task.subject?task.subject:"")+" ")]),task.resource&&-1!==task.resource.id?_c("div",{staticClass:"task-list-icon"},[_c("span",{staticClass:"task-resource-name"},[_vm._v(_vm._s(task.resource.name))]),1===task.resource.resourceType?_c("img",{staticStyle:{height:"12px",width:"14px"},attrs:{src:__webpack_require__(572902)}}):_c("img",{staticStyle:{height:"11px",width:"14px"},attrs:{src:__webpack_require__(30684)}})]):_vm._e()])])])}))],2)}))],2)]):_vm._e(),_vm.isNewViewTemp&&_vm.toggleReadingTable?_c("div",{staticClass:"over overflow-y-scroll"},[_c("div",{staticClass:"task-tab-block mT0"},[_c("f-pm-readingtable",{attrs:{pmObject:_vm.pmObject,pm:_vm.pm,workorder:_vm.workorder},on:{readingData:_vm.getReadingData}})],1)]):_vm._e()]),_vm.toggleReadingTable?_vm._e():_c("div",{staticClass:"fR pm-summary-inner-right-con fc-v1-wo-sum-right width28"},[_c("div",{staticClass:"fc-scrollbar-wrap pT10"},[_vm.selectedTask?_c("div",{staticClass:"p20 white-bg-block pm-summary-right-bg height100vh"},[_c("div",{staticClass:"pB70"},[_c("div",{staticClass:"task-details-header position-relative"},[_c("div",{staticClass:"tdetail-title-block fc-tdetail-title-block fR"},[_c("i",{directives:[{name:"tippy",rawName:"v-tippy",value:{arrow:!0,placement:"top"},expression:"{\n                            arrow: true,\n                            placement: 'top',\n                          }"}],staticClass:"el-icon-close tclose-icon text-left wo__close__icon",attrs:{title:"Close"},on:{click:_vm.closedisplay}})]),_c("div",{staticClass:"task-details-list clearboth"},[_c("div",{staticClass:"task-detail-content"},[_c("div",{staticClass:"task-list-item mB20",staticStyle:{"font-weight":"600","font-size":"14px","margin-bottom":"25px",color:"#324056"}},[_vm._v(" "+_vm._s(_vm.selectedTask.subject?_vm.selectedTask.subject:"")+" "),_vm.selectedTask.resource&&-1!==_vm.selectedTask.resource.id?_c("div",{staticClass:"task-content-item"},[_c("span",{staticClass:"task-resource-name"},[_vm._v(_vm._s(_vm.selectedTask.resource.name))]),1===_vm.selectedTask.resource.resourceType?_c("img",{staticStyle:{height:"12px",width:"14px"},attrs:{src:__webpack_require__(572902)}}):_c("img",{staticStyle:{height:"11px",width:"14px"},attrs:{src:__webpack_require__(30684)}})]):_vm._e()])])])]),_c("div",[_c("div",[_vm.selectedTask.description?_c("div",[_c("div",{staticClass:"fc-blue-label"},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.description"))+" ")]),_c("el-input",{staticClass:"form-item mT10",attrs:{disabled:"",type:"textarea"},model:{value:_vm.selectedTask.description,callback:function($$v){_vm.$set(_vm.selectedTask,"description",$$v)},expression:"selectedTask.description"}})],1):_vm.selectedTask.description?_vm._e():_c("div")]),_c("div",{staticClass:"enableInput pmremoved-checkbox",staticStyle:{"padding-top":"20px"}},[_c("el-checkbox",{attrs:{disabled:""},model:{value:_vm.selectedTask.enableInput,callback:function($$v){_vm.$set(_vm.selectedTask,"enableInput",$$v)},expression:"selectedTask.enableInput"}},[_vm._v(_vm._s(_vm.$t("maintenance._workorder.enable_input")))])],1),_vm.selectedTask.enableInput?_c("div",[_c("div",{staticClass:"pT30 fc-blue-label"},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.task_type"))+" ")]),_c("el-radio",{staticClass:"fc-radio-btn pT15",attrs:{disabled:"",color:"secondary",label:"2"},model:{value:_vm.selectedTask.inputType,callback:function($$v){_vm.$set(_vm.selectedTask,"inputType",$$v)},expression:"selectedTask.inputType"}},[_vm._v(_vm._s(_vm.$t("maintenance._workorder.reading")))]),_c("div",[_c("el-radio",{staticClass:"fc-radio-btn pT15",attrs:{disabled:"",color:"secondary",label:"3"},model:{value:_vm.selectedTask.inputType,callback:function($$v){_vm.$set(_vm.selectedTask,"inputType",$$v)},expression:"selectedTask.inputType"}},[_vm._v(_vm._s(_vm.$t("maintenance._workorder.text")))])],1),_c("el-radio",{staticClass:"fc-radio-btn pT15",attrs:{disabled:"",color:"secondary",label:"4"},model:{value:_vm.selectedTask.inputType,callback:function($$v){_vm.$set(_vm.selectedTask,"inputType",$$v)},expression:"selectedTask.inputType"}},[_vm._v(_vm._s(_vm.$t("maintenance._workorder.number")))]),_c("div",[_c("el-radio",{staticClass:"fc-radio-btn pT15",attrs:{disabled:"",color:"secondary",label:"5"},model:{value:_vm.selectedTask.inputType,callback:function($$v){_vm.$set(_vm.selectedTask,"inputType",$$v)},expression:"selectedTask.inputType"}},[_vm._v(_vm._s(_vm.$t("maintenance._workorder.option")))])],1),_c("div",[_c("el-radio",{staticClass:"fc-radio-btn pT15",attrs:{disabled:"",color:"secondary",label:"6"},model:{value:_vm.selectedTask.inputType,callback:function($$v){_vm.$set(_vm.selectedTask,"inputType",$$v)},expression:"selectedTask.inputType"}},[_vm._v(_vm._s(_vm.$t("maintenance._workorder.boolean")))])],1)],1):_vm._e(),"2"===_vm.selectedTask.inputType?_c("div",[_c("div",{staticClass:"textcolor"},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.reading_field"))+" ")]),_c("div",[_c("el-select",{staticClass:"form-item",staticStyle:{width:"100%"},attrs:{disabled:"",placeholder:" "},model:{value:_vm.selectedTask.readingFieldId,callback:function($$v){_vm.$set(_vm.selectedTask,"readingFieldId",$$v)},expression:"selectedTask.readingFieldId"}},[_vm.selectedTask.readingField?_c("el-option",{key:_vm.selectedTask.readingField.id,attrs:{label:_vm.selectedTask.readingField.displayName,value:_vm.selectedTask.readingField.id}}):_vm._e()],1)],1)]):_vm._e(),"4"===_vm.selectedTask.inputType?_c("div",{staticStyle:{display:"none"}},[_c("div",{staticClass:"textcolor"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm_list.validation"))+" ")]),_c("el-select",{staticClass:"form-item",staticStyle:{width:"100%"},attrs:{disabled:"",placeholder:" "},model:{value:_vm.selectedTask.validation,callback:function($$v){_vm.$set(_vm.selectedTask,"validation",$$v)},expression:"selectedTask.validation"}},[_c("el-option",{key:"none",attrs:{label:"None",value:"none"}}),_c("el-option",{key:"incremental",attrs:{label:"Incremental",value:"incremental"}}),_c("el-option",{key:"decremental",attrs:{label:"Decremental",value:"decremental"}}),_c("el-option",{key:"safeLimit",attrs:{label:"Safe Limit",value:"safeLimit"}})],1),"safeLimit"===_vm.selectedTask.validation?_c("div",[_c("div",{staticClass:"textcolor"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm_list.minimum_value"))+" ")]),_c("el-input",{attrs:{disabled:"",type:"number"},model:{value:_vm.selectedTask.minSafeLimit,callback:function($$v){_vm.$set(_vm.selectedTask,"minSafeLimit",$$v)},expression:"selectedTask.minSafeLimit"}}),_c("div",{staticClass:"textcolor"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm_list.max_value"))+" ")]),_c("el-input",{attrs:{disabled:"",type:"number"},model:{value:_vm.selectedTask.maxSafeLimit,callback:function($$v){_vm.$set(_vm.selectedTask,"maxSafeLimit",$$v)},expression:"selectedTask.maxSafeLimit"}})],1):_vm._e()],1):_vm._e(),"5"===_vm.selectedTask.inputType||"6"===_vm.selectedTask.inputType?_c("div",[_c("div",{staticClass:"pT30 fc-blue-label pB10"},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.options"))+" ")]),_vm._l(_vm.selectedTask.options,(function(option,index){return _c("div",{key:index,staticClass:"taskoption",staticStyle:{"padding-bottom":"10px"}},[_c("div",{staticClass:"flLeft",staticStyle:{"padding-left":"3px",width:"200px"}},[_c("el-input",{staticStyle:{width:"100%"},attrs:{disabled:"",type:"text",placeholder:""},model:{value:option.name,callback:function($$v){_vm.$set(option,"name",$$v)},expression:"option.name"}})],1),_c("div",{staticClass:"clearboth"})])}))],2):_vm._e(),_c("div",{staticClass:"pT30 fc-blue-label"},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.validations"))+" ")]),_c("div",{staticClass:"enableInput pmremoved-checkbox",staticStyle:{"padding-top":"25px"}},[_c("el-checkbox",{attrs:{disabled:""},model:{value:_vm.selectedTask.attachmentRequired,callback:function($$v){_vm.$set(_vm.selectedTask,"attachmentRequired",$$v)},expression:"selectedTask.attachmentRequired"}},[_vm._v(_vm._s(_vm.$t("maintenance._workorder.photo_required")))])],1),_c("div",{staticClass:"enableInput pmremoved-checkbox",staticStyle:{"padding-top":"25px"}},[_c("el-checkbox",{attrs:{disabled:""},model:{value:_vm.selectedTask.remarksRequired,callback:function($$v){_vm.$set(_vm.selectedTask,"remarksRequired",$$v)},expression:"selectedTask.remarksRequired"}},[_vm._v(_vm._s(_vm.$t("maintenance._workorder.remarks_required")))])],1)])])]):_vm._e()])])])]),_c("el-tab-pane",{attrs:{label:_vm.$t("maintenance.pm_list.history"),name:"fourth"}},["fourth"===_vm.activeName?_c("pm-history",{attrs:{pm:_vm.pmObject,workorder:_vm.workorder,resourceType:_vm.resourceTypeEnum,resources:_vm.resources,pmWorkorders:_vm.workordersArr}}):_vm._e()],1),"first"===_vm.activeName||_vm.pmDetailsview&&!_vm.toggleReadingTable&&("third"===_vm.activeName||"fifth"===_vm.activeName)?_c("div",{staticClass:"fR pm-summary-inner-right-con fc-v1-wo-sum-right width28"},[_c("div",{staticClass:"fc-scrollbar-wrap pT10"},[_c("div",{staticClass:"p30 white-bg-block pm-summary-right-bg"},[_c("el-row",{staticClass:"wo__details__res pB20"},[_c("el-col",{attrs:{span:11}},[_c("div",{staticClass:"fc-blue-label"},[_vm._v("SITE")])]),_c("el-col",{attrs:{span:13}},[_c("div",{staticClass:"label-txt-black"},[_vm._v(" "+_vm._s(_vm.getSiteName(_vm.pm))+" ")])])],1),_c("div",[3===_vm.pm.pmCreationType&&7!==_vm.pm.assignmentType&&null!==_vm.pm.baseSpaceId?_c("el-row",{staticClass:"wo__details__res pB20"},[_c("el-col",{attrs:{span:11}},[_c("div",{staticClass:"fc-blue-label line-height18"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm_list.building"))+" ")])]),_c("el-col",{attrs:{span:13}},[_vm.buildingList[Number(_vm.pm.baseSpaceId)]?_c("div",{staticClass:"label-txt-black"},[_vm._v(" "+_vm._s(_vm.buildingList[Number(_vm.pm.baseSpaceId)])+" ")]):_c("div",{staticClass:"building-resulttxt"},[_vm._v("---")])])],1):_vm._e()],1),3===_vm.pm.pmCreationType&&1===_vm.pm.assignmentType?_c("div",[_c("el-row",{staticClass:"wo__details__res pB20"},[_c("el-col",{attrs:{span:11}},[_c("div",{staticClass:"fc-blue-label line-height18"},[_vm._v("Floors")])]),_c("el-col",{attrs:{span:13}},[_vm.pm.pmIncludeExcludeResourceContexts&&_vm.pm.pmIncludeExcludeResourceContexts.length?_c("div",{staticClass:"label-txt-black"},[_vm._v(" "+_vm._s(_vm.pm.pmIncludeExcludeResourceContexts.length+" Floors")+" ")]):_c("div",{staticClass:"label-txt-black"},[_vm._v(" "+_vm._s("All Floors")+" ")])])],1)],1):_vm._e(),3===_vm.pm.pmCreationType&&3===_vm.pm.assignmentType?_c("div",[_c("el-row",{staticClass:"wo__details__res pB20"},[_c("el-col",{attrs:{span:11}},[_c("div",{staticClass:"fc-blue-label line-height18"},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.space"))+" ")])]),_c("el-col",{attrs:{span:13}},[_vm.pm.pmIncludeExcludeResourceContexts&&_vm.pm.pmIncludeExcludeResourceContexts.length?_c("div",{staticClass:"label-txt-black"},[_vm._v(" "+_vm._s(_vm.pm.pmIncludeExcludeResourceContexts.length+" "+_vm.spacecategory[_vm.pm.spaceCategoryId])+" ")]):_c("div",{staticClass:"label-txt-black"},[_vm._v(" "+_vm._s("All "+_vm.spacecategory[_vm.pm.spaceCategoryId])+" ")])])],1)],1):_vm._e(),3===_vm.pm.pmCreationType&&4===_vm.pm.assignmentType?_c("div",[_c("el-row",{staticClass:"wo__details__res pB20"},[_c("el-col",{attrs:{span:11}},[_c("div",{staticClass:"fc-blue-label line-height18"},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.asset"))+" ")])]),_c("el-col",{attrs:{span:13}},[_vm.assetcategory&&_vm.pm.pmIncludeExcludeResourceContexts&&_vm.pm.pmIncludeExcludeResourceContexts.length?_c("div",{staticClass:"label-txt-black"},[_vm._v(" "+_vm._s(_vm.pm.pmIncludeExcludeResourceContexts.length+" "+_vm.assetCategoryName)+" ")]):_vm.assetcategory&&_vm.pm.assetCategoryId>-1?_c("div",{staticClass:"label-txt-black"},[_vm._v(" "+_vm._s("All "+_vm.assetCategoryName)+" ")]):_vm._e()])],1)],1):_vm._e(),_c("el-row",{staticClass:"wo__details__res pB20"},[_c("el-col",{attrs:{span:11}},[_c("div",{staticClass:"fc-blue-label line-height18"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.wr_list.priority"))+" ")])]),_c("el-col",{attrs:{span:13}},[_vm.workorder.priority?_c("div",{staticClass:"label-txt-black",staticStyle:{cursor:"pointer"}},[_c("i",{staticClass:"fa fa-circle prioritytag",style:{color:_vm.getTicketPriority(_vm.workorder.priority.id).colour},attrs:{"aria-hidden":"true"}}),_vm._v(" "+_vm._s(_vm.workorder.priority&&_vm.workorder.priority.id>0?_vm.getTicketPriority(_vm.workorder.priority.id).displayName:"---")+" ")]):_c("div",{staticClass:"building-resulttxt"},[_vm._v("---")])])],1),_c("el-row",{staticClass:"wo__details__res pB20"},[_c("el-col",{attrs:{span:11}},[_c("div",{staticClass:"fc-blue-label line-height18"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.wr_list.category"))+" ")])]),_c("el-col",{attrs:{span:13}},[_vm.workorder.category?_c("div",{staticClass:"label-txt-black",staticStyle:{cursor:"pointer"}},[_vm._v(" "+_vm._s(_vm.workorder.category&&_vm.workorder.category.id>0?_vm.getTicketCategory(_vm.workorder.category.id).displayName:"---")+" ")]):_c("div",{staticClass:"building-resulttxt"},[_vm._v("---")])])],1),1===_vm.pm.pmCreationType?_c("div",[_vm.workorder.resource&&2===_vm.workorder.resource.resourceType?[_c("el-row",{staticClass:"wo__details__res pB20"},[_c("el-col",{attrs:{span:11}},[_c("div",{staticClass:"fc-blue-label pT25"},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.asset"))+" ")])]),_c("el-col",{staticClass:"flex-middle pm-summary-space-ico",attrs:{span:13}},[_c("div",{staticClass:"building-asset-img",staticStyle:{width:"10%"},on:{click:function($event){return _vm.openAsset(_vm.workorder.resource.id)}}},[_c("asset-avatar",{attrs:{size:"mobile-xlg",name:"false",asset:_vm.workorder.resource}})],1),_c("div",{staticClass:"building-resulttxt",on:{click:function($event){return _vm.openAsset(_vm.workorder.resource.id)}}},[_c("div",{staticClass:"label-txt-black",staticStyle:{cursor:"pointer","word-break":"break-all"}},[_vm._v(" "+_vm._s(_vm.workorder.resource.name)+" ")]),_c("span",{staticClass:"label-txt-black"},[_vm._v(" "+_vm._s(_vm.workorder.resource.space&&_vm.workorder.resource.space.id>0?_vm.workorder.resource.space.name:"---")+" ")])])])],1)]:_vm.workorder.resource&&1===_vm.workorder.resource.resourceType?[_c("el-row",{staticClass:"wo__details__res pB20"},[_c("el-col",{attrs:{span:11}},[_c("div",{staticClass:"fc-blue-label pT10",staticStyle:{"text-transform":"uppercase"}},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.space"))+" ")])]),_c("el-col",{staticClass:"pm-summary-space-ico",attrs:{span:13}},[_c("div",{staticClass:"building-resulttxt flex-middle"},[_c("space-avatar",{staticClass:"asset-space-img fL mR10",attrs:{name:!1,size:"md",space:_vm.workorder.resource}}),_c("div",{staticClass:"label-txt-black",staticStyle:{"padding-left":"9px",cursor:"pointer",position:"relative"},on:{click:_vm.redirect}},[_vm._v(" "+_vm._s(_vm.workorder.resource.name)+" ")])],1)])],1)]:[_c("el-row",{staticClass:"wo__details__res pB20"},[_c("el-col",{attrs:{span:11}},[_c("div",{staticClass:"fc-blue-label line-height18"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.wr_list.space_asset"))+" ")])]),_c("el-col",{attrs:{span:13}},[_c("div",{staticClass:"label-txt-black"},[_vm._v("---")])])],1)]],2):_vm._e(),_vm.workorder.safetyPlan&&this.$helpers.isLicenseEnabled("SAFETY_PLAN")?_c("div",[_c("el-row",{staticClass:"wo__details__res pB20"},[_c("el-col",{attrs:{span:11}},[_c("div",{staticClass:"fc-blue-label line-height18"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.wr_list.safetyPlan"))+" ")])]),_c("el-col",{attrs:{span:13}},[_c("div",{staticClass:"label-txt-black"},[_c("span",[_vm._v(" "+_vm._s(_vm.workorder.safetyPlan&&_vm.workorder.safetyPlan.name?_vm.workorder.safetyPlan.name:"---")+" ")])])])],1)],1):_vm._e(),_c("el-row",{staticClass:"wo__details__res pB20"},[_c("el-col",{attrs:{span:11}},[_c("div",{staticClass:"fc-blue-label line-height18"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm_list.maintenance_type"))+" ")])]),_c("el-col",{attrs:{span:13}},[_c("div",{staticStyle:{cursor:"pointer"}},[_c("span",[_vm._v(" "+_vm._s(_vm.workorder.type&&_vm.workorder.type.id>0?_vm.pmTypes[_vm.workorder.type.id]:"---")+" ")])])])],1),_c("el-row",{staticClass:"wo__details__res pB20 flex-middle"},[_c("el-col",{attrs:{span:11}},[_c("div",{staticClass:"fc-blue-label",staticStyle:{"text-transform":"uppercase"}},[_vm._v(" "+_vm._s(_vm.$t("maintenance.wr_list.assignedto"))+" ")])]),_c("el-col",{attrs:{span:13}},[_vm.workorder.assignedTo&&_vm.workorder.assignedTo.id>0||_vm.workorder.assignmentGroup&&_vm.workorder.assignmentGroup.id>0?_c("div",[_c("user-avatar",{attrs:{size:"md",user:_vm.workorder.assignedTo,group:_vm.workorder.assignmentGroup,showPopover:!0,showLabel:!0,moduleName:"workorder"}})],1):_c("div",[_vm._v("--- / ---")])])],1),_c("el-row",{staticClass:"wo__details__res pB20"},[_c("el-col",{attrs:{span:11}},[_c("div",{staticClass:"fc-blue-label line-height18"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.wr_list.vendor"))+" ")])]),_c("el-col",{attrs:{span:13}},[_c("div",{staticStyle:{cursor:"pointer"}},[_c("span",[_vm._v(" "+_vm._s(_vm.workorder.vendor&&_vm.workorder.vendor.id>0?_vm.workorder.vendor.name:"---")+" ")])])])],1),_vm._l(_vm.customFields,(function(cf,ix){return _c("el-row",{key:ix,staticClass:"wo__details__res pB20"},[_c("el-col",{attrs:{span:11}},[_c("div",{staticClass:"fc-blue-label line-height18"},[_vm._v(" "+_vm._s(cf.displayName)+" ")])]),_c("el-col",{attrs:{span:13}},[_c("div",{staticStyle:{cursor:"pointer"}},["LOOKUP"===cf.field.dataTypeEnum?_c("span",[_vm._v(" "+_vm._s(_vm.workorder.data&&_vm.workorder.data[cf.field.name]&&_vm.workorder.data[cf.field.name].primaryValue?_vm.workorder.data[cf.field.name].primaryValue:"---")+" ")]):"ENUM"===cf.field.dataTypeEnum?_c("span",[_vm._v(" "+_vm._s(_vm.workorder.data&&_vm.workorder.data[cf.field.name]?cf.field.enumMap[_vm.workorder.data[cf.field.name]+""]:"---")+" ")]):"BOOLEAN"===cf.field.dataTypeEnum?_c("span",[_vm._v(" "+_vm._s(_vm.workorder.data&&cf.field.name in _vm.workorder.data?_vm.workorder.data[cf.field.name]?_vm.$t("maintenance.pm_list.true"):_vm.$t("maintenance.pm_list.false"):"---")+" ")]):_vm.isFieldDisplayTypeDuration(cf)?_c("span",[_vm._v(" "+_vm._s(_vm.getFormattedDuration(_vm.workorder.data,cf)||"---")+" ")]):_c("span",[_vm._v(" "+_vm._s(_vm.workorder.data&&_vm.workorder.data[cf.field.name]?_vm.workorder.data[cf.field.name]:"---")+" ")])])])],1)}))],2),_c("div",{staticClass:"p20 white-bg-block mT20"},[_c("div",{staticClass:"fc-blue-label border-bottom4 pB20"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm_list.notification"))+" ")]),_c("div",{staticClass:"notifications-container"},[1===_vm.pm.pmCreationType&&_vm.reminders&&_vm.reminders.length?_vm._l(_vm.reminders,(function(reminder){return _c("div",{key:reminder.id,staticClass:"notfications-block",staticStyle:{"border-bottom":"1px solid #d9f4f7"}},[_vm.workorder.assignedTo&&_vm.workorder.assignedTo.id>0?_c("div",{staticClass:"notification-profile-icon"},[_c("user-avatar",{directives:[{name:"tippy",rawName:"v-tippy"}],attrs:{size:"sm",user:_vm.workorder.assignedTo,name:!1,title:_vm.workorder.assignedTo.name}})],1):_vm._e(),_c("div",{staticClass:"notification-resulttxt"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm_list.will_be_notified"))+" "),_c("b",[_vm._v(" "+_vm._s(_vm.reminderDurations[reminder.duration])+" "+_vm._s(_vm.reminderType[reminder.type])+" ")])])])})):3===_vm.pm.pmCreationType&&_vm.reminders&&_vm.reminders.length?_vm._l(_vm.reminders,(function(reminder,key){return _c("el-row",{key:key,staticClass:"pm-form-notifications-row visibility-visible-actions notfications-block",staticStyle:{"border-bottom":"1px solid #d9f4f7"}},[_c("el-col",{staticClass:"pT5 pB5",attrs:{span:9}},[_vm._v(" "+_vm._s(reminder.name)+" ")]),_c("el-col",{staticClass:"pT5 pB5",attrs:{span:6}},[_vm._v(" "+_vm._s(_vm.reminderDurations[reminder.duration])+" "+_vm._s(_vm.reminderType[reminder.type])+" ")]),_c("el-col",{staticClass:"fc-tag",attrs:{span:6}},[reminder.isEmail?_c("el-tag",[_vm._v("Email")]):_vm._e(),reminder.isMobile?_c("el-tag",[_vm._v("Mobile")]):_vm._e(),reminder.isSms?_c("el-tag",[_vm._v("SMS")]):_vm._e()],1)],1)})):_c("div",[_c("div",{staticClass:"notification-resulttxt text-center mT30 mB30"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm_list.no_notification"))+" ")])])],2)])])]):_vm._e()],1)],1),_vm.showNotification?_c("div",[_c("PmNotification",{attrs:{showConfigureNotification:_vm.showNotification,reminders:_vm.reminders},on:{"update:showConfigureNotification":function($event){_vm.showNotification=$event},"update:show-configure-notification":function($event){_vm.showNotification=$event}}})],1):_vm._e()]),_c("el-dialog",{staticClass:"fc-dialog-center-container resource-dialog",attrs:{visible:_vm.showExecutionConfig,"append-to-body":!0,width:"30%",title:"SELECT SPACE/ASSETS","before-close":_vm.beforeConfigClose},on:{"update:visible":function($event){_vm.showExecutionConfig=$event}}},[_c("div",{staticClass:"mT20"},[_c("el-input",{staticClass:"fc-input-full-border2 text-input-icon-align input-padding width100",attrs:{placeholder:"search",type:"search","prefix-icon":"el-icon-search"},on:{change:_vm.forceUpdate},model:{value:_vm.searchQuery,callback:function($$v){_vm.searchQuery=$$v},expression:"searchQuery"}})],1),_c("table",{staticClass:"fc-pm-form-table"},[_c("thead",[_c("tr",{staticClass:"pm-trigger-head-tr"},[_c("th",{staticClass:"pT10 pB10"},[_c("el-checkbox",{staticClass:"pR20",on:{change:_vm.selected},model:{value:_vm.selectAllResources,callback:function($$v){_vm.selectAllResources=$$v},expression:"selectAllResources"}}),_vm._v("SELECT ALL ")],1)])]),_c("tbody",{staticClass:"mT10"},_vm._l(_vm.resources,(function(resource,key){return _c("tr",{directives:[{name:"show",rawName:"v-show",value:!_vm.searchQuery.trim()||resource.name.trim().toLowerCase().startsWith(_vm.searchQuery.trim().toLowerCase()),expression:"\n            !searchQuery.trim() ||\n              resource.name\n                .trim()\n                .toLowerCase()\n                .startsWith(searchQuery.trim().toLowerCase())\n          "}],key:key,staticClass:"mB10"},[_c("td",{staticClass:"pT15 pB15"},[_c("el-checkbox",{staticClass:"pR20",on:{change:_vm.forceUpdate},model:{value:_vm.resources[key].selected,callback:function($$v){_vm.$set(_vm.resources[key],"selected",$$v)},expression:"resources[key].selected"}}),_vm._v(" "+_vm._s(resource.name)+" ")],1)])})),0)]),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.cancelExecutionConfig}},[_vm._v("CANCEL")]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.disableExecuteNowButton},on:{click:_vm.executeMultiPM}},[_vm._v("EXECUTE")])],1)]),_vm.showExtendScheduleDialog?_c("el-dialog",{staticClass:"fc-dialog-center-container",attrs:{visible:_vm.showExtendScheduleDialog,width:"25%","append-to-body":!0,title:"Extend Schedule"},on:{"update:visible":function($event){_vm.showExtendScheduleDialog=$event}}},[_c("div",[_c("div",{staticClass:"height150"},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v("Extend Upto")]),_c("el-date-picker",{staticClass:"fc-input-full-border2 width100",attrs:{type:"date","value-format":"timestamp",placeholder:"Pick a day"},model:{value:_vm.extendUpto,callback:function($$v){_vm.extendUpto=$$v},expression:"extendUpto"}})],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-save",on:{click:_vm.handleExtend}},[_vm._v("Extend")]),_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){_vm.showExtendScheduleDialog=!1}}},[_vm._v("Cancel")])],1)])]):_vm._e()],1)},staticRenderFns=[],toConsumableArray=__webpack_require__(488478),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),createForOfIteratorHelper=__webpack_require__(566347),objectSpread2=__webpack_require__(595082),Avatar=(__webpack_require__(670560),__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(434284),__webpack_require__(897389),__webpack_require__(879288),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(947522),__webpack_require__(506203),__webpack_require__(634338),__webpack_require__(538077),__webpack_require__(76265),__webpack_require__(212826),__webpack_require__(450886),__webpack_require__(891719),__webpack_require__(228436),__webpack_require__(300268),__webpack_require__(865137),__webpack_require__(574752)),validation=__webpack_require__(990260),quasar_esm=__webpack_require__(641358),modularUserFilter=__webpack_require__(884900),PmHistoryvue_type_template_id_5c19f5bd_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("div",{staticClass:"pm-summary-inner-container mT20"},[1===_vm.pm.preventivemaintenance.pmCreationType&&_vm.resourceList.length>0||3===_vm.pm.preventivemaintenance.pmCreationType&&_vm.resourceList.length>0?_c("div",{staticClass:"white-bg-block width100"},[_c("div",{staticClass:"flex-middle width100 justify-content-space p30 pB0"},[1===_vm.pm.preventivemaintenance.pmCreationType&&_vm.resourceList.length>0?_c("div",[_c("div",{staticClass:"fc-black-com f14 bold"},[_vm._v(" "+_vm._s(_vm.pm.workorder.resource.name)+" ")])]):_vm._e(),_c("el-dropdown",{staticClass:"fc-dropdown-menu-border",class:{disable:0==_vm.resources.length},attrs:{trigger:"click"}},[_c("el-button",{staticClass:"fc-btn-group-white",attrs:{type:"primary"}},[3===_vm.pm.preventivemaintenance.pmCreationType&&4===_vm.pm.preventivemaintenance.assignmentType&&_vm.pm.preventivemaintenance.assetCategoryId>-1?_c("div",[_vm._v(" "+_vm._s(null!==_vm.resourceName?_vm.resourceName:"All "+_vm.assetcategory.find((function(i){return i.id===Number(_vm.pm.preventivemaintenance.assetCategoryId)})).name)),_c("i",{staticClass:"el-icon-arrow-down"})]):3===_vm.pm.preventivemaintenance.pmCreationType&&3===_vm.pm.preventivemaintenance.assignmentType&&_vm.pm.preventivemaintenance.spaceCategoryId>-1?_c("div",[_vm._v(" "+_vm._s(null!==_vm.resourceName?_vm.resourceName:"All "+_vm.spacecategory[_vm.pm.preventivemaintenance.spaceCategoryId])),_c("i",{staticClass:"el-icon-arrow-down"})]):3===_vm.pm.preventivemaintenance.pmCreationType&&1===_vm.pm.preventivemaintenance.assignmentType?_c("div",[_vm._v(" "+_vm._s(null!==_vm.resourceName?_vm.resourceName:"All FLOORS")),_c("i",{staticClass:"el-icon-arrow-down"})]):_c("div",[_vm._v(" "+_vm._s(null!==_vm.resourceName?_vm.resourceName:"All "+_vm.resourceType)),_c("i",{staticClass:"el-icon-arrow-down"})])]),_c("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[_c("el-dropdown-item",[3===_vm.pm.preventivemaintenance.pmCreationType&&4===_vm.pm.preventivemaintenance.assignmentType&&_vm.pm.preventivemaintenance.assetCategoryId>-1?_c("div",{staticClass:"pointer",on:{click:function($event){return _vm.getResourceBasedWo(null)}}},[_vm._v(" All "+_vm._s(""+_vm.assetcategory.find((function(i){return i.id===Number(_vm.pm.preventivemaintenance.assetCategoryId)})).name)+" ")]):3===_vm.pm.preventivemaintenance.pmCreationType&&3===_vm.pm.preventivemaintenance.assignmentType&&_vm.pm.preventivemaintenance.spaceCategoryId>-1?_c("div",{staticClass:"pointer",on:{click:function($event){return _vm.getResourceBasedWo(null)}}},[_vm._v(" All "+_vm._s(""+_vm.spacecategory[_vm.pm.preventivemaintenance.spaceCategoryId])+" ")]):3===_vm.pm.preventivemaintenance.pmCreationType&&1===_vm.pm.preventivemaintenance.assignmentType?_c("div",{staticClass:"pointer",on:{click:function($event){return _vm.getResourceBasedWo(null)}}},[_vm._v(" All FLOORS ")]):_c("div",{staticClass:"pointer",on:{click:function($event){return _vm.getResourceBasedWo(null)}}},[_vm._v(" All "+_vm._s(_vm.resourceType)+" ")])]),_vm._l(_vm.resources,(function(resource,index){return _c("el-dropdown-item",{key:index,attrs:{command:resource}},[_c("div",{on:{click:function($event){return _vm.getResourceBasedWo(resource)}}},[_vm._v(" "+_vm._s(resource.name)+" ")])])}))],2)],1),_vm.workordersList.length?_c("div",{},[_c("div",{staticClass:"flex-middle"},[_c("div",[_vm.from!==_vm.to?_c("span",{staticClass:"fc-black-small-txt-12"},[_vm._v(_vm._s(_vm.from)+" - ")]):_vm._e(),_c("span",{staticClass:"fc-black-small-txt-12"},[_vm._v(_vm._s(_vm.to))]),[_vm._v(" of "+_vm._s(_vm.workordersList.length)+" "),_c("span",{staticClass:"el-icon-arrow-left fc-black-small-txt-12 fw-bold f16 pointer mL10 mR5",class:{disable:_vm.from<=1},on:{click:function($event){_vm.from>1&&_vm.prev()}}}),_c("span",{staticClass:"el-icon-arrow-right fc-black-small-txt-12 f16 pointer mR10 fw-bold",class:{disable:_vm.to===_vm.workordersList.length},on:{click:function($event){_vm.hasMorePage&&_vm.next()}}})]],2)])]):_vm._e()],1),_c("div",{staticClass:"fc-pm-history-table-con fc-list-view pT0 mT10 fc-list-table-container height100vh fc-table-td-height fc-table-td-pm fc-table-viewchooser pB100 mT20 clearboth"},[_c("el-table",{staticClass:"fc-pm-history-table",staticStyle:{width:"100%"},attrs:{data:_vm.resourceList,index:_vm.indexMethod,height:"auto",fit:!0}},[_c("template",{slot:"empty"},[_c("img",{attrs:{src:__webpack_require__(15482),width:"100",height:"100"}}),_c("div",{staticClass:"mT10 label-txt-black f14"},[_vm._v("No History available")])]),_c("el-table-column",{attrs:{label:"Created time",width:"180"},scopedSlots:_vm._u([{key:"default",fn:function(resourceList){return[resourceList.row&&-1!==resourceList.row.createdTime?_c("div",[_vm._v(" "+_vm._s(_vm._f("formatDate")(resourceList.row.createdTime))+" ")]):_c("div",[_vm._v("---")])]}}],null,!1,1441095585)}),null===_vm.resourceName&&_vm.resources.length?_c("el-table-column",{attrs:{label:_vm.resourceType,width:"180"},scopedSlots:_vm._u([{key:"default",fn:function(resourceList){return[_c("div",[_vm._v(_vm._s(_vm.resourceMap[resourceList.row.resource.id]))])]}}],null,!1,1580267784)}):_vm._e(),_c("el-table-column",{attrs:{label:"Workorder",width:"180"},scopedSlots:_vm._u([{key:"default",fn:function(resourceList){return[_c("div",{staticClass:"fc-id",on:{click:function($event){return _vm.redirectToWo(resourceList.row.id)}}},[_vm._v(" "+_vm._s("#"+resourceList.row.serialNumber)+" ")])]}}],null,!1,1297881452)}),_c("el-table-column",{attrs:{label:"Assigned to",width:"180"},scopedSlots:_vm._u([{key:"default",fn:function(resourceList){return[resourceList&&resourceList.row&&resourceList.row.assignedTo&&resourceList.row.assignedTo.id?_c("div",[_vm._v(" "+_vm._s(_vm.getUser(resourceList.row.assignedTo.id).name)+" ")]):_c("div",[_vm._v("---")])]}}],null,!1,4042323174)}),_c("el-table-column",{attrs:{label:"Resolved",width:"180"},scopedSlots:_vm._u([{key:"default",fn:function(resourceList){return[resourceList.row&&-1!==resourceList.row.actualWorkEnd?_c("div",[_vm._v(" "+_vm._s(_vm._f("formatDate")(resourceList.row.actualWorkEnd))+" ")]):_c("div",[_vm._v("---")])]}}],null,!1,242199041)}),_c("el-table-column",{attrs:{label:"Overdue Status",width:"180"},scopedSlots:_vm._u([{key:"default",fn:function(resourceList){return[_c("div",{class:[{"work-progress-txt":-1!==resourceList.row.actualWorkStart&&-1===resourceList.row.actualWorkEnd},{"wo-error-status":-1!==resourceList.row.dueDate&&-1!==resourceList.row.actualWorkEnd}]},[_vm._v(" "+_vm._s(_vm.toCalculateDue(resourceList.row))+" ")])]}}],null,!1,55385860)})],2)],1),!_vm.resourceList.length>0&&this.pm.preventivemaintenance&&this.workordersList.length>0?_c("div",[_c("template",{slot:"empty"},[_c("img",{attrs:{src:__webpack_require__(15482),width:"100",height:"100"}}),_c("div",{staticClass:"mT10 label-txt-black f14"},[_vm._v(" No Workorders available For This Resources ")])])],2):_vm._e()]):_c("div",[_c("div",{staticClass:"flex-middle width100 height80vh justify-center white-bg-block flex-direction-column"},[_c("inline-svg",{attrs:{src:"svgs/emptystate/history",iconClass:"icon text-center icon-xxxxlg"}}),_c("div",{staticClass:"nowo-label"},[_vm._v(" No History Available ")])],1)])])])},PmHistoryvue_type_template_id_5c19f5bd_staticRenderFns=[],InlineSvg=__webpack_require__(586166),vuex_esm=__webpack_require__(420629),router=__webpack_require__(329435),PmHistoryvue_type_script_lang_js={components:{InlineSvg:InlineSvg/* default */.Z},props:["pm","resources","resourceType","workorder","pmWorkorders"],data:function(){return{value:"",resourceList:[],resourceName:null,resourceMap:{},perPage:30,page:1,from:0,to:0,hasMorePage:!1}},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({users:function(state){return state.users},assetcategory:function(state){return state.assetCategory}})),(0,vuex_esm/* mapGetters */.Se)(["getSpaceCategoryPickList","getBuildingsPickList","getUser"])),{},{spacecategory:function(){return this.getSpaceCategoryPickList()},buildingList:function(){return this.getBuildingsPickList()},workordersList:{get:function(){return this.pmWorkorders||[]},set:function(value){this.$emit("update:pmWorkorders",value)}}}),created:function(){this.$store.dispatch("loadAssetCategory"),this.$store.dispatch("loadSpaceCategory"),this.$store.dispatch("loadBuildings")},watch:{page:function(){this.from=(this.page-1)*this.perPage+1,this.to=this.from+this.perPage-1,this.to>=this.workordersList.length&&(this.to=this.workordersList.length,this.hasMorePage=!0);for(var a=[],i=0;i<this.workordersList.length;i++)i>=this.from-1&&i<this.to&&a.push(this.workordersList[i]);a.length&&(this.resourceList=a)},workordersList:{handler:function(newVal,oldVal){this.workordersList.length&&(this.from=1,this.perPage>=this.workordersList.length?(this.to=this.workordersList.length,this.hasMorePage=!1):(this.to=this.perPage,this.hasMorePage=!0))},
// deep: true,
immediate:!0}},mounted:function(){this.initData()},
// computed: {
//   resourceList () {
//   return this.workordersList
// }
// },
methods:{prev:function(){this.page=this.page-1},next:function(){this.page=this.page+1},initData:function(){var _this=this;null===this.resourceName&&(this.resourceList=this.workordersList),this.resources&&this.resources.length&&this.resources.forEach((function(d){_this.resourceMap[d.id]=d.name}));var a=[];if(this.workordersList.length>this.perPage){for(var i=0;i<this.workordersList.length;i++)this.perPage>i&&a.push(this.workordersList[i]);a.length&&(this.resourceList=a)}},indexMethod:function(index){return 2*index},getResourceBasedWo:function(resource){if(resource&&resource.name?this.resourceName=resource.name:this.resourceName=null,null===resource)this.resourceList=this.workordersList;else{
// let value = []
// resource.forEach(d => {
// value.push(d.id)
// })
var filters={resource:[{operatorId:36,value:[""+resource.id]}],pm:[{operatorId:36,value:[""+this.pm.preventivemaintenance.id]}]},self=this,queryObj={viewname:"all",page:1,filters:filters,orderBy:"createdTime",orderType:"desc",criteriaIds:this.$route.query?this.$route.query.criteriaIds:null,includeParentFilter:!0,isNew:!0};self.$store.dispatch("workorder/fetchWorkOrders",queryObj).then((function(){self.resourceList=self.$store.state.workorder.workorders})).catch((function(){}))}},redirectToWo:function(id){if((0,router/* isWebTabsEnabled */.tj)()){var _ref=(0,router/* findRouteForModule */.Jp)("workorder",router/* pageTypes */.As.OVERVIEW)||{},name=_ref.name;name&&this.$router.push({name:name,params:{viewname:"all",id:id}})}else this.$router.push({path:"/app/wo/orders/summary/"+id})},toCalculateDue:function(res){var status=this.$store.getters.getTicketStatusByLabel("Skipped","workorder");if(null!=status&&status.id==res.moduleState.id)return"Skipped";if(-1!==res.actualWorkStart&&-1===res.actualWorkEnd)return"Work in progress";if(-1!==res.dueDate&&-1!==res.actualWorkEnd){if(-1!==res.actualWorkStart&&-1!==res.actualWorkEnd)return res.actualWorkEnd<res.dueDate?"On time":res.actualWorkEnd>res.dueDate&&-1!==res.dueDate?"Over due":"---"}else{if(-1!==res.actualWorkStart&&-1!==res.actualWorkEnd)return"---";if(-1===res.actualWorkStart&&-1===res.actualWorkEnd)return"Not Yet Started"}}}},v1_PmHistoryvue_type_script_lang_js=PmHistoryvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(v1_PmHistoryvue_type_script_lang_js,PmHistoryvue_type_template_id_5c19f5bd_render,PmHistoryvue_type_template_id_5c19f5bd_staticRenderFns,!1,null,null,null)
/* harmony default export */,PmHistory=component.exports,PmTriggers=__webpack_require__(359975),User=__webpack_require__(426803),Asset=__webpack_require__(751201),Space=__webpack_require__(826127),Spinner=__webpack_require__(604947),donutProgress=__webpack_require__(318637),FNewAnalyticModularReport=__webpack_require__(247942),NewDateHelper=__webpack_require__(105534),pmNotification=__webpack_require__(377905),PmSummaryPlannerViewvue_type_template_id_e44452b0_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"pm-resource-planner pm-summary-planner"},[_c("facilio-resource-planner",{ref:"resourcePlanner",attrs:{plannerType:"ASSET_PLANNER",views:_vm.isStaffPlanner?_vm.staffViews:_vm.assetViews,defaultView:_vm.isStaffPlanner?"WEEK":"YEAR",isPMAssetPlanner:"asset"==this.resourceKey||"space"==this.resourceKey,isRowDragRestrict:"asset"==this.resourceKey||"space"==this.resourceKey,saving:_vm.requestPending,allowDownload:!0,noDataText:"No workorders"},on:{ready:function($event){_vm.loaded=!0},viewChanged:_vm.handleViewChange,dropped:_vm.handleDrop},scopedSlots:_vm._u([_vm.loaded?{key:"card",fn:function(slotProps){return[_c("div",{staticClass:"pm-wo-card"},[_c("div",{staticClass:"pm-wo-card-header"},[_c("div",{},[_c("span",{staticClass:"fc-black-12 pR10 white-color"},[_vm._v(" "+_vm._s(_vm.$helpers.formatDateFull(slotProps.event.start))+" ")]),_c("span",{staticClass:"separator white-color"},[_vm._v("|")]),_c("span",{staticClass:"fc-black-11 white-color"},[_vm._v(_vm._s(_vm.$helpers.formatTimeFull(slotProps.event.start)))])]),_c("div",{staticClass:"pm-wo-card-header-close",on:{click:_vm.$refs["resourcePlanner"].handleCardClose}},[_c("i",{staticClass:"el-icon-close fc-black3-16 fwBold white-color"})]),_c("div",{staticClass:"fc-black3-16 pT10 white-color"},[_vm._v(" "+_vm._s(slotProps.event.subject)+" ")])]),_c("div",{staticClass:"pm-wo-card-body"},[_c("el-row",{staticClass:"pB30"},[_c("el-col",{attrs:{span:10}},[_c("div",{staticClass:"fc-black-13 fwBold text-left pT15"},[_vm._v("Assigned To")])]),_c("el-col",{attrs:{span:14}},[_c("div",{staticClass:"fc-black-13 text-left"},[_c("el-select",{staticClass:"fc-input-full-border2 width100",attrs:{disabled:slotProps.col.past},on:{change:function($event){return _vm.handleStaffChange(slotProps.event,$event)}},model:{value:slotProps.event.staff,callback:function($$v){_vm.$set(slotProps.event,"staff",$$v)},expression:"slotProps.event.staff"}},_vm._l(_vm.resources.staff,(function(staff){return _c("el-option",{key:staff.id,attrs:{label:staff.title,value:staff.id}})})),1)],1)])],1),_c("el-row",{},[_c("el-col",{attrs:{span:10}},[_c("div",{staticClass:"fc-black-13 fwBold text-left"},[_vm._v("Asset/Space")])]),_c("el-col",{attrs:{span:14}},[_c("div",{staticClass:"fc-black-13 text-left"},[_vm._v(" "+_vm._s(_vm.getResourceDetails(slotProps.event.id))+" ")])])],1)],1),_c("div",{staticClass:"pm-wo-card-footer display-flex-between-space flex-middle p30 pT10 pB20"},[_c("div",{staticClass:"text-left"},[_c("router-link",{staticClass:"fc-dark-blue3-12 pointer",attrs:{to:_vm.redirectToWO(slotProps.event.id)}},[_vm._v(" View Details ")])],1),_c("div",{staticClass:"text-right"},[slotProps.col.past?_vm._e():_c("el-button",{staticClass:"fc-btn-icon-delete pointer",on:{click:function($event){return _vm.handleDelete(slotProps.event.id)}}},[_c("i",{staticClass:"el-icon-delete pR10"}),_vm._v(" Delete")])],1)])])]}}:null,{key:"taskContent",fn:function(eventProps){return[_c("div",{staticClass:"rp-task-text ellipsis"},[_vm._v(" "+_vm._s(eventProps.event[eventProps.displayType])+" ")])]}}],null,!0)},[_c("template",{slot:"resourceSelection"},[_c("div",{staticClass:"width200 fc-input-full-border2 mR10 fc-input-border-remove fc-input-full-border2-bold mL8"},[_vm._v(" "+_vm._s(_vm.resourceMeta[_vm.resourceKey].name)+" ")])]),_c("template",{slot:"plannerLeftTop"},[_c("el-select",{staticClass:"width200 fc-input-full-border2 mR10",attrs:{trigger:"click"},on:{change:_vm.triggerChanged},model:{value:_vm.selectedTrigger,callback:function($$v){_vm.selectedTrigger=$$v},expression:"selectedTrigger"}},_vm._l(_vm.triggerOptions,(function(trigger,index){return _c("el-option",{key:index,attrs:{label:trigger.name,value:trigger.id}})})),1)],1)],2)],1)},PmSummaryPlannerViewvue_type_template_id_e44452b0_staticRenderFns=[],PlannerAPICalls=(__webpack_require__(564043),__webpack_require__(857267),__webpack_require__(648324),__webpack_require__(186466),__webpack_require__(910036)),FacilioResourcePlanner=__webpack_require__(511982),PmSummaryPlannerViewvue_type_script_lang_js={components:{"facilio-resource-planner":FacilioResourcePlanner/* default */.Z},props:{pm:{type:Object},isStaffPlanner:{type:Boolean}},data:function(){return{loaded:!1,assetViews:["WEEK","MONTH","YEAR"],staffViews:["DAY","WEEK","MONTH"],isJobApi:!0,workorders:[],resourceKey:"staff",resourceType:null,selectedTrigger:null,triggerOptions:[],resources:{
// asset: [],
// space: [],
staff:this.getStaffList()},resourceMeta:{staff:{name:"Staff"}},requestPending:!1}},mounted:function(){this.getTriggerOptions()},created:function(){this.$store.dispatch("loadUsers")},computed:(0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({users:function(state){return state.users}})),methods:{redirectToWO:function(id){if(!(0,router/* isWebTabsEnabled */.tj)())return{path:"/app/wo/orders/summary/".concat(id)};var _ref=(0,router/* findRouteForModule */.Jp)("workorder",router/* pageTypes */.As.OVERVIEW)||{},name=_ref.name;return name?{name:name,params:{viewname:"all",id:id}}:void 0},setQueryParams:function(){this.$router.replace({query:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},this.$route.query),{},{triggerId:this.selectedTrigger,pmId:this.pm.id,pmSubject:encodeURIComponent(this.pm.name),triggerName:encodeURIComponent(this.getTriggerName(this.selectedTrigger)),assetFilters:JSON.stringify({siteId:this.pm.siteId,assetCategoryId:this.pm.assetCategoryId,buildingId:null})})})},handleDelete:function(workorderID){var _this=this;PlannerAPICalls/* default */.Z.deleteWorkOrder(workorderID).then((function(e){_this.$refs["resourcePlanner"].deleteEvent(workorderID)}))},refresh:function(){this.$refs["resourcePlanner"].refreshGrid()},getFilteredEventList:function(){var _this2=this;return"ALL"==this.selectedTrigger?this.workorders:this.workorders.filter((function(e){return e.triggerID==_this2.selectedTrigger}))},getTriggerOptions:function(){
//clone trigger options from PM object and use for select box
this.triggerOptions=this.$helpers.cloneObject(this.pm.triggers).filter((function(e){return 1==e.triggerExecutionSource})).map((function(e){return{id:e.id,name:e.name,frequency:e.frequencyEnum}})),this.triggerOptions.length>1&&this.triggerOptions.unshift({id:-1,name:"All Triggers",frequency:null}),this.$route.query.triggerId?
//if trigger id present in query param persist
this.selectedTrigger=this.$route.query.triggerId:(
//set default trigger , select 1st trigger id , if more than 1 trigger select all as default
this.selectedTrigger=this.triggerOptions[0].id,this.triggerOptions.length>1&&(this.selectedTrigger=-1),this.setQueryParams())},getTriggerName:function(triggerId){return-1==triggerId?"All Triggers":this.triggerOptions.find((function(t){return t.id==triggerId})).name},triggerChanged:function(){this.setQueryParams(),this.$refs["resourcePlanner"].refreshGrid()},handleDrop:function(e){var _this3=this;this.requestPending=!0;var url="/v2/pmplanner/jobs/update",newAssignTo=e.destinationCell.rowId,reqJson={workorder:{id:e.event.id,scheduledStart:e.event.start}};
//for staff view alone we can drag drop across rows
// Same comp used for staff and asset planner ,if staff plan ,reassign the assignedTo Id to row Id(staffId=>rowID here)
"staff"==this.resourceKey&&(reqJson.workorder.assignedTo={id:newAssignTo}),this.$http.post(url,reqJson).then((function(resp){_this3.requestPending=!1}))},handleStaffChange:function(event,newAssignToID){var _this4=this;
//staff reassigned from outside planner component .
//need to make api call here and sync the planner view when in staff mode
this.requestPending=!0;var url="/v2/pmplanner/jobs/update",reqJson={workorder:{id:event.id,scheduledStart:event.start,assignedTo:{id:newAssignToID}}};this.$http.post(url,reqJson).then((function(resp){"staff"==_this4.resourceKey&&_this4.$refs["resourcePlanner"].reAssignResource(event.id,newAssignToID),_this4.requestPending=!1}))},resourceChanged:function(){var _this5=this;
//call handler aysnchronously , as select box close hangs due to long task
setTimeout((function(){_this5.$refs["resourcePlanner"].changeResource(_this5.resources[_this5.resourceKey],_this5.resourceKey,"asset"==_this5.resourceKey||"space"==_this5.resourceKey)}),0)},handleViewChange:function(e){this.currentRange=e,this.$emit("viewChanged",e),this.fetchData(e)},getStaffList:function(){
//need to show all staff ,
/*computed property isnt available when this runs,so accessing this.users fails
        TO DO , fix the data model to not have stafflist like this
       */
var staffList=[{id:-99,title:"Unassigned"}].concat((0,toConsumableArray/* default */.Z)(this.$store.state.users.map((function(user){return{id:user.id,title:user.name}}))));return this.sortResources(staffList,"id"),staffList},fetchData:function(range){var _this6=this,url="/v2/workorders/newcalendar/list/all",params={
// page: 1,
perPage:-1,filters:{pm:{operatorId:36,value:[this.pm.id+""]},scheduledStart:{operatorId:20,value:[range.start.toString(),range.end.toString()]}},orderBy:"scheduledStart",orderType:"desc",includeParentFilter:!0};
//fetch all workorders for a PM for given duration
url+="?perPage="+params.perPage+"&filters="+encodeURI(JSON.stringify(params.filters))+"&orderBy="+params.orderBy+"&orderType="+params.orderType+"&includeParentFilter="+params.includeParentFilter,this.$http.get(url).then((function(resp){_this6.setData(resp)}))},setData:function(response){var _this7=this,workorders=[],assets={},spaces={};
//asset and spaces for the set of workorders
response.data.result.workorders.forEach((function(e){
// console.log(e.trigger.id)
//skip workorders without a trigger (created via execute now)
if(e.trigger&&(
//TO DO , move filter to server
-1==_this7.selectedTrigger||e.trigger.id==_this7.selectedTrigger)){var wo={start:e.scheduledStart,subject:e.subject,staff:e.assignedTo?e.assignedTo.id:-99,
//assigned staff id
id:e.id,triggerID:e.trigger.id,frequency:_this7.getFrequency(e.trigger.id)},mappedResource=e.resource;
//mapped resource can be a site or space
1==mappedResource.resourceType?(
//space
spaces[mappedResource.id]={id:mappedResource.id,title:mappedResource.name},wo.space=mappedResource.id):2==mappedResource.resourceType&&(
//asset
wo.asset=mappedResource.id,assets[mappedResource.id]={id:mappedResource.id,title:mappedResource.name}),workorders.push(wo)}})),
//redundant client sorting
workorders.sort((function(e1,e2){return e1.start-e2.start})),this.workorders=workorders,
// this.eventList=this.getFilteredEventList()
//Pm is mapped either to asset or space,only push valid option inside select box
this.$helpers.isEmpty(assets)||(this.$set(this.resources,"asset",Object.values(assets)),this.sortResources(this.resources["asset"],"id"),this.$set(this.resourceMeta,"asset",{name:"Assets"}),this.resourceType="asset",this.isStaffPlanner||(this.resourceKey="asset")),this.$helpers.isEmpty(spaces)||(this.$set(this.resources,"space",Object.values(spaces)),this.sortResources(this.resources["space"],"id"),this.$set(this.resourceMeta,"space",{name:"Spaces"}),this.resourceType="space",this.isStaffPlanner||(this.resourceKey="space")),this.refreshPlanner()},sortResources:function(resourceList,key){resourceList.sort((function(e1,e2){return e1[key]-e2[key]}))},refreshPlanner:function(){
//prevent unneeded reactivity overhead by cloning object
this.$refs["resourcePlanner"].renderPlanner(this.workorders,0==this.workorders.length?[]:this.resources[this.resourceKey],
//planner uses no data state only when resources and tasks are empty
this.resourceKey)},getFrequency:function(triggerID){var trigger=this.pm.triggers.find((function(e){return e.id==triggerID}));return trigger.frequencyEnum.substring(0,1)},
//find workorder from wo list , get staff/asset id from wo and get full details from resourceList
findWorkOrder:function(id){return this.workorders.find((function(e){return e.id==id}))},getStaffTitle:function(staffID){var staff=this.resources.staff.find((function(e){return e.id==staffID}));return staff.title},getResourceDetails:function(workorderID){var _this8=this;if(null!=workorderID){var workorder=this.findWorkOrder(workorderID),resource=this.resources[this.resourceType].find((function(e){return e.id==workorder[_this8.resourceType]}));return resource.title}}}},v1_PmSummaryPlannerViewvue_type_script_lang_js=PmSummaryPlannerViewvue_type_script_lang_js,PmSummaryPlannerView_component=(0,componentNormalizer/* default */.Z)(v1_PmSummaryPlannerViewvue_type_script_lang_js,PmSummaryPlannerViewvue_type_template_id_e44452b0_render,PmSummaryPlannerViewvue_type_template_id_e44452b0_staticRenderFns,!1,null,null,null)
/* harmony default export */,PmSummaryPlannerView=PmSummaryPlannerView_component.exports,moment_timezone=__webpack_require__(480008),moment_timezone_default=__webpack_require__.n(moment_timezone),PmReadingsable=__webpack_require__(131792),api=__webpack_require__(32284),picklist=__webpack_require__(961358),Pmsummaryvue_type_script_lang_js={components:{PmSummaryResourcePlanner:PmSummaryPlannerView,Avatar:Avatar["default"],QBtn:quasar_esm/* QBtn */.OV,UserAvatar:User/* default */.Z,AssetAvatar:Asset["default"],SpaceAvatar:Space/* default */.Z,Spinner:Spinner/* default */.Z,pie:donutProgress/* default */.Z,PmHistory:PmHistory,PmTriggers:PmTriggers/* default */.Z,FNewAnalyticModularReport:FNewAnalyticModularReport/* default */.Z,PmNotification:pmNotification/* default */.Z,InlineSvg:InlineSvg/* default */.Z,FPmReadingtable:PmReadingsable/* default */.Z},mixins:[modularUserFilter/* default */.Z],data:function(){return{pmFormData:{},disableExecuteNowButton:!1,workordersArr:[],toggleReadingTable:!1,openPopOver:!1,workorderObj:{},extendUpto:null,plannerView:null,readingData:[],showExtendScheduleDialog:!1,refreshButtonLoading:!1,selectAllResources:!1,endDate:"",resType:"",resName:"",fields:[],resourceTypeEnum:"",showExecutionConfig:!1,showNotification:!1,frequencyMap:{DAILY:12,WEEKLY:11,MONTHLY:10,QUARTERTLY:25,HALF_YEARLY:5,ANNUALLY:8},pmObject:{},model:{},moduleMeta:{},pmModuleMeta:{},days:"",hours:"",mins:"",secs:"",activeName:"first",triggertab:"overview",searchQuery:"",serverConfig:{},tabPosition:"top",showChart:!1,workorder:null,loading:!1,pm:null,sites:null,isExecuting:!1,averageRes:0,previousMonthAverageRes:"",previousMonthAverageResponseTime:{},averageResponseTime:{},avgResponseLoading:!1,tasks:{},preRequests:{},photoMandatory:!1,allowNegative:!1,allowNegativePreRequisite:2,approvers:[{sharingType:null,approversId:null}],approvalTypes:[{id:1,name:"User"},{id:2,name:"Role"},{id:3,name:"Group"}],newViewPreRequests:[],newViewTasks:[],isNewViewTemp:!1,isNewViewTempPreRequest:!1,reminders:[],readingFields:[],taskReadingFields:{},reminderType:{1:"before execution",2:"after execution",3:"before due",4:"after due"},workflowResult:{woOnTime:{result:null,loading:!1},woAvgRes:{result:null,loading:!1},woFreqAssign:{result:null,loading:!1}},previousMonthworkflowResult:{woOnTime:{result:null},woAvgRes:{result:null}},showTaskDetails:!1,selectedTask:null,showPreRequestDetails:!1,selectedPreRequest:null,resources:[],resourceSearchQuery:"",pmDetailsview:!0,assetPlannerView:null,staffPlannerView:null,assetExtendUpto:null,staffExtendUpto:null,execResources:[]}},created:function(){var _this=this;this.$store.dispatch("loadTicketCategory"),this.$store.dispatch("loadTicketType"),this.$store.dispatch("loadTicketPriority"),this.$store.dispatch("loadAssetCategory"),this.$store.dispatch("loadSpaceCategory"),this.$store.dispatch("loadRoles"),this.$store.dispatch("loadGroups"),this.$store.dispatch("loadBuildings").then((function(){_this.loadResourcePlanner(_this.$route.params.id).then((function(response){var resourcePlanners=response.data.resourcePlanners;_this.loadPreventiveSummary(resourcePlanners)}))})),this.loadFormData()},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({users:function(state){return state.users},teams:function(state){return state.groups},roles:function(state){return state.roles},assetcategory:function(state){return state.assetCategory}})),(0,vuex_esm/* mapGetters */.Se)(["getTicketTypePickList","getSpaceCategoryPickList","getBuildingsPickList","getUser","getTicketPriority","getTicketCategory","getCurrentUser"])),{},{customFields:function(){var _step,customFields=[],_iterator=(0,createForOfIteratorHelper/* default */.Z)(this.pmFormData.fields);try{for(_iterator.s();!(_step=_iterator.n()).done;){var formField=_step.value;formField&&formField.field&&!formField.field.default&&customFields.push(formField)}}catch(err){_iterator.e(err)}finally{_iterator.f()}return customFields},buildingList:function(){return this.getBuildingsPickList()},tickettype:function(){return this.getTicketTypePickList()},spacecategory:function(){return this.getSpaceCategoryPickList()},checkteam:function(){var _this2=this;if(this.workorder.assignmentGroup&&"null"!=this.workorder.assignmentGroup){for(var i in this.$store.state.groups)if(this.$store.state.groups[i].groupId===this.workorder.assignmentGroup.id&&this.$store.state.groups[i].members.find((function(mem){return mem.id===_this2.$account.user.id})))return 1;return 0}return 0},showRefreshBanner:function(){return this.pm&&this.pm.woGenerationStatus&&("asset"===this.triggertab&&this.assetPlannerView||"staff"===this.triggertab&&this.staffPlannerView)},showExtendScheduleBanner:function(){if(this.assetPlannerView||this.staffPlannerView){if(!this.pm.woGeneratedUpto||this.pm.woGeneratedUpto<0)return!1;var show=!0,generatedUpto=1e3*this.pm.woGeneratedUpto,now=Date.now();return show=show&&!this.pm.woGenerationStatus,show=show&&"second"==this.activeName&&("asset"===this.triggertab||"staff"===this.triggertab),"asset"===this.triggertab?(show=show&&this.assetPlannerView.start<=now+31536e6,//show within a year from now
show=show&&now<=this.assetPlannerView.end,// show after now
show=show&&(generatedUpto<0||generatedUpto<=this.assetPlannerView.end)):"staff"===this.triggertab&&(show=show&&this.staffPlannerView.start<=now+31536e6,//show within a year from now
show=show&&now<=this.staffPlannerView.end,// show after now
show=show&&(generatedUpto<0||generatedUpto<=this.staffPlannerView.end)),show}return!1},computedModule:function(){return this.moduleMeta?{moduleName:this.moduleMeta.name,moduleId:this.moduleMeta.module.moduleId,meta:{fieldMeta:{xField:this.moduleMeta.module.moduleId}}}:{}},reminderDurations:function(){for(var options={1800:"30 Min"},i=1;i<24;i++)options[3600*i]=i+(1===i?"hr":"hrs"),options[24*i*3600]=i+(1===i?"day":"days");for(var _i=24;_i<32;_i++)options[24*_i*3600]=_i+"days";return options},pmTypes:function(){return this.tickettype},lastMonthAverageDuration:function(){if(this.previousMonthworkflowResult.woAvgRes.result){var duration=this.previousMonthworkflowResult.woAvgRes.result,days=Math.floor(duration/86400);duration-=86400*days;var hours=(duration/3600).toFixed(2);return{days:days,hours:hours}}return null},averageDuration:function(){if(this.workflowResult.woAvgRes.result){var duration=this.workflowResult.woAvgRes.result,days=Math.floor(duration/86400);duration-=86400*days;var hours=(duration/3600).toFixed(2);return{days:days,hours:hours}}return null},freqAssignUser:function(){return this.workflowResult.woFreqAssign.result&&this.workflowResult.woFreqAssign.result[0]&&this.workflowResult.woFreqAssign.result[0].id?this.getUser(this.workflowResult.woFreqAssign.result[0].id):null},assetCategoryName:function(){var _this3=this,category=this.assetcategory.find((function(i){return i.id===Number(_this3.pm.assetCategoryId)}));return category?category.name:""},pmDescription:function(){return this.$getProperty(this,"workorder.description","---")}}),methods:{loadFormData:function(){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var formObj,formUrl,_yield$API$get,data,error,message,form;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return formObj={},formUrl="/v2/forms/workorder?formName=multi_web_pm&fetchFormRuleFields=true",_context.next=4,api/* API */.bl.get(formUrl);case 4:_yield$API$get=_context.sent,data=_yield$API$get.data,error=_yield$API$get.error,error?(message=error.message,_this4.$message.error(message)):(form=data.form,(0,validation/* isEmpty */.xb)(form)||(formObj=form,formObj.secondaryBtnLabel=_this4.$t("common._common.cancel"),formObj.primaryBtnLabel=_this4.$t("common._common._save"))),_this4.pmFormData=formObj;case 9:case"end":return _context.stop()}}),_callee)})))()},loadWorkorders:function(){var _this5=this,$route=this.$route,_ref=$route||{},params=_ref.params,id=params.id;id=parseInt(id);var data={pmId:id},url="/v2/workorders/fetchRelatedWorkorders";api/* API */.bl.get(url,data).then((function(_ref2){var data=_ref2.data,error=_ref2.error;if(error)_this5.$message.error(error.message||"Error Occured");else{var _ref3=data||[],workorders=_ref3.workorders;_this5.workordersArr=workorders}}))},loadSite:function(){var _this6=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var pm,_ref4,_ref4$siteIds,siteIds,defaultIds,params;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if(pm=_this6.pm,_ref4=pm||{},_ref4$siteIds=_ref4.siteIds,siteIds=void 0===_ref4$siteIds?[]:_ref4$siteIds,!(0,validation/* isEmpty */.xb)(siteIds)){_context2.next=4;break}return _context2.abrupt("return");case 4:return defaultIds=[siteIds],params={field:{lookupModuleName:"site"},defaultIds:defaultIds},_context2.next=8,(0,picklist/* getFieldOptions */._K)(params).then((function(_ref5){var error=_ref5.error,options=_ref5.options;error||(_this6.sites=options)}));case 8:case"end":return _context2.stop()}}),_callee2)})))()},goToEdit:function(){var id=this.$route.params.id,pmCreationType=this.$getProperty(this.pm,"pmCreationTypeEnum");if((0,router/* isWebTabsEnabled */.tj)()){var _ref6=(0,router/* findRouteForModule */.Jp)("preventivemaintenance",router/* pageTypes */.As.EDIT)||{},name=_ref6.name;if(name)return{name:name,params:{id:id,pmCreationType:pmCreationType}}}else{if(["SINGLE","MULTIPLE"].includes(pmCreationType))return"/app/wo/planned/new?edit=".concat(id);if("MULTI_SITE"===pmCreationType)return"/app/wo/multiplanned/new?edit=".concat(id)}},getMultiResources:function(){this.isExecuting=!0},showExecuteNow:function(){return this.pm&&this.pm.status&&this.pm.isAllowedToExecute},isAllowedToExecute:function(){for(var sharingContext=[],i=0;i<this.pm.triggers.length;i++)4===this.pm.triggers[i].type&&sharingContext.push.apply(sharingContext,(0,toConsumableArray/* default */.Z)(this.pm.triggers[i].sharingContext));for(var currentUser=this.getCurrentUser(),k=0;k<sharingContext.length;k++)if(1===sharingContext[k].type){if(currentUser.ouid===sharingContext[k].userId)return!0}else if(2===sharingContext[k].type){if(currentUser.roleId===sharingContext[k].roleId)return!0}else if(3===sharingContext[k].type&&currentUser.groups&&currentUser.groups.includes(sharingContext[k].groupId))return!0},getReadingData:function(data){this.readingData=data},updateReadingData:function(){var self=this,params={taskContextList:[]};this.readingData.forEach((function(rt){params.taskContextList.push({id:rt.id,inputValue:rt.inputValue,inputValues:null,remarks:null,readingFieldId:rt.readingFieldId,inputTime:rt.createdTime})}));var url="task/correctPMReadings";self.$http.post(url,params).then((function(response){self.toggleReadingTable=!1,self.readingData=[]}))},handleRefresh:function(){var _this7=this;this.refreshButtonLoading=!0,this.$http.get("v2/workorders/pmDetail?id="+parseInt(this.$route.params.id)).then((function(resp){_this7.loadWorkorders(),resp.data.preventivemaintenance.woGenerationStatus||(_this7.pm.woGenerationStatus=resp.data.preventivemaintenance.woGenerationStatus,_this7.pm.woGeneratedUpto=resp.data.preventivemaintenance.woGeneratedUpto,"asset"===_this7.triggertab?_this7.$refs["assetplanner"].refresh():"staff"===_this7.triggertab&&_this7.$refs["staffplanner"].refresh()),_this7.refreshButtonLoading=!1})).catch((function(){_this7.refreshButtonLoading=!1}))},showExtension:function(){this.showExtendScheduleDialog=!0,this.extendUpto=this.assetExtendUpto},handleExtend:function(){var _this8=this;this.showExtendScheduleDialog=!1,this.pm.woGenerationStatus=!0,this.$http.post("/workorder/generateSchedule",{pmId:this.pm.id,endTime:Math.floor(this.extendUpto/1e3)}).catch((function(_){_this8.$message({message:"Failed to generated schedule",type:"failure"}),_this8.$set(_this8.pm,"woGenerationStatus",!1)}))},handleViewChange:function(e){"asset"===this.triggertab?(this.assetPlannerView=e,this.assetExtendUpto=e.end):"staff"===this.triggertab&&(this.staffPlannerView=e,this.staffExtendUpto=e.end)},getTriggersFrequencyLists:function(triggers){var a=[];return triggers.forEach((function(d){a.includes(d.scheduleMsg)||a.push(d.scheduleMsg)})),a.join(", ")},handleClick:function(tab,event){var tabContainer=document.querySelector(".fc-pm-summary-tab .el-tabs__content");tabContainer.scrollTop=0},showNotificationForm:function(){this.showNotification=!0},getSiteName:function(pm){var _this9=this,sites=this.sites,_ref7=pm||{},siteIds=_ref7.siteIds,siteLabel="---";return(0,validation/* isEmpty */.xb)(sites)||(0,validation/* isEmpty */.xb)(siteIds)||(siteLabel="",siteIds.forEach((function(siteId,index){var seperator=siteIds.length>0&&index!==siteIds.length-1?",":"",site=sites.find((function(site){return site.value===siteId}))||{},siteName=_this9.$getProperty(site,"label","---");siteLabel+="".concat(siteName).concat(seperator)}))),siteLabel},loadModuleInfo:function(pm){var self=this;self.$http.get("/module/meta?moduleName=workorder").then((function(response){response&&(self.moduleMeta=response.data.meta,self.fields=self.moduleMeta.fields,self.buildCriteria(pm))}))},loadPmmetaInfo:function(){var self=this;self.$http.get("/module/meta?moduleName=preventivemaintenance").then((function(response){response&&(self.pmModuleMeta=response.data.meta)}))},forceUpdate:function(){this.$forceUpdate()},buildCriteria:function(pm){var obj=[],obj1=[];obj=this.moduleMeta.fields.filter((function(lf){return"createdTime"===lf.name})),obj1=this.moduleMeta.fields.filter((function(lf){return"actualWorkDuration"===lf.name}));var element={},xField={},yField={},dateField={};if(element["sortFields"]=null,element["sortOrder"]=null,element["limit"]=null,element["moduleType"]=null,element["moduleName"]=this.moduleMeta.name,element["groupBy"]=null,this.pm.triggers&&this.pm.triggers.length>1){var a=[];this.pm.triggers.forEach((function(d){a.push(d.frequencyEnum)})),a.includes("DAILY")?xField["aggr"]=12:a.includes("WEEKLY")?xField["aggr"]=11:a.includes("MONTHLY")?xField["aggr"]=10:a.includes("QUARTERTLY")?xField["aggr"]=25:a.includes("HALF_YEARLY")?xField["aggr"]=5:a.includes("ANNUALLY")&&(xField["aggr"]=8)}else this.pm.triggers&&1===this.pm.triggers.length&&this.frequencyMap[this.pm.triggers[0].frequencyEnum]?xField["aggr"]=this.frequencyMap[this.pm.triggers[0].frequencyEnum]:xField["aggr"]=12;dateField["field_id"]=obj[0].id,dateField["module_id"]=this.computedModule.moduleId,12===xField["aggr"]?dateField["operator"]=31:11===xField["aggr"]?dateField["operator"]=28:dateField["operator"]=44;var dateObject=NewDateHelper/* default */.Z.getDatePickerObject(dateField["operator"]);dateField["date_value"]=dateObject.value[0]+"",xField["field_id"]=obj[0].id,xField["module_id"]=this.computedModule.moduleId,element["xField"]=xField;var yFieldArray=[];yField["field_id"]=obj1[0].id,yField["module_id"]=this.computedModule.moduleId,yField["aggr"]=2,yFieldArray[0]=yField,yFieldArray[1]=null,element["yField"]=yFieldArray,element["dateField"]=dateField;var criteria={pattern:"(1)",conditions:{1:{fieldName:"pm",value:this.pm.id,columnName:"WorkOrders.PM_ID",operatorId:9,isResourceOperator:!1,parseLabel:null,operatorLabel:"equals",active:!0,isSpacePicker:!1}},resourceOperator:!1};if(element["dateFilter"]=NewDateHelper/* default */.Z.getDatePickerObject(dateField.operator,dateField.date_value?dateField.date_value:null),element["criteria"]=criteria,element["isTime"]=!0,element["isCustomDateField"]=!1,this.resources&&this.resources.length>1){var _a=[this.defaultSettings["LOOKUP"]],b=this.moduleMeta.fields.filter((function(i){return"resource"===i.name}));_a[0].fieldId=b[0].id,_a[0].name="Space / Asset";var c=[];this.resources&&this.resources.length&&this.resources.forEach((function(d){var e={};e[d.id]=d.name,c.push(e),_a[0].chooseValue.values.push(d.id.toString())})),_a[0].allValues=c,_a[0].chooseValue.otherEnabled=!1,_a[0].chooseValue.type=1,element["userFilters"]=_a,element["hideDataPoints"]=[]}this.serverConfig=element,this.showChart=!0},executeMultiPM:function(){var _this10=this;if(!this.disableExecuteNowButton){var data={};data.pmId=this.pm.id,data.pmIncludeExcludeResourceContexts=this.resources.filter((function(i){return i.selected})).map((function(k){return{resourceId:k.id,pmId:_this10.pm.id,isInclude:!0}})),this.disableExecuteNowButton=!0,this.$http.post("/workorder/executePreventiveMaintenance",data).then((function(response){var wo=response.data.workorder;wo&&(_this10.workordersArr.unshift(wo),_this10.$message({message:"Preventive Maintenance has been successfully executed",type:"success"})),_this10.isExecuting=!1,_this10.showExecutionConfig=!1,_this10.disableExecuteNowButton=!1,_this10.beforeConfigClose()}))}},cancelExecutionConfig:function(){this.showExecutionConfig=!1,this.beforeConfigClose()},selected:function(val){for(var i=0;i<this.resources.length;i++)this.searchQuery.trim()&&!this.resources.name.trim().toLowerCase().startsWith(this.searchQuery.trim().toLowerCase())||(this.resources[i].selected=val);this.$forceUpdate()},resourceLabel:function(_ref8){var pmCreationType=_ref8.pmCreationType,assignmentType=_ref8.assignmentType,categoryId=_ref8.categoryId,resourceCount=_ref8.resourceCount,parentAssingmentType=_ref8.parentAssingmentType,parentCategoryId=_ref8.parentCategoryId,parentResourceCount=_ref8.parentResourceCount,pmResourceLabel=_ref8.pmResourceLabel;if(5===assignmentType){if(1===parentAssingmentType)return resourceCount?"".concat(resourceCount," Floors"):parentResourceCount?"".concat(parentResourceCount," Floors"):"All Floors";if(3===parentAssingmentType){if(parentCategoryId&&parentCategoryId>0)return resourceCount?"".concat(resourceCount," ").concat(this.spacecategory[Number(parentCategoryId)]):parentResourceCount?"".concat(parentResourceCount," ").concat(this.spacecategory[Number(parentCategoryId)]):"All ".concat(this.spacecategory[Number(parentCategoryId)])}else if(4===parentAssingmentType){if(parentCategoryId&&parentCategoryId>0&&this.assetcategory)return resourceCount?"".concat(resourceCount," ").concat(this.assetcategory.find((function(i){return i.id===Number(parentCategoryId)})).name):parentResourceCount?"".concat(parentResourceCount," ").concat(this.assetcategory.find((function(i){return i.id===Number(parentCategoryId)})).name):"All ".concat(this.assetcategory.find((function(i){return i.id===Number(parentCategoryId)})).name)}else if(1===pmCreationType)return pmResourceLabel}else if(4===assignmentType){if(categoryId&&categoryId>0&&this.assetcategory)return resourceCount?"".concat(resourceCount," ").concat(this.assetcategory.find((function(i){return i.id===Number(categoryId)})).name):"All ".concat(this.assetcategory.find((function(i){return i.id===Number(categoryId)})).name)}else if(3===assignmentType&&categoryId&&categoryId>0)return resourceCount?"".concat(resourceCount," ").concat(this.spacecategory[Number(categoryId)]):"All ".concat(this.spacecategory[Number(categoryId)]);return""},currentView:function(){return this.viewName?this.viewName:this.$route.params.viewname?this.$route.params.viewname:"active"},back:function(){this.$router.go(-1)},sort:function(arr){for(var len=arr.length,i=len-1;i>=0;i--)for(var j=1;j<=i;j++)if(arr[j-1].sequence>arr[j].sequence){var temp=arr[j-1];arr[j-1]=arr[j],arr[j]=temp}return arr},findRoute:function(){if((0,router/* isWebTabsEnabled */.tj)()){var tabType=router/* tabTypes */.VF.CUSTOM,config={type:"portfolio"},route=(0,router/* findRouteForTab */.OD)(tabType,{config:config})||{};return(0,validation/* isEmpty */.xb)(route)?null:this.$router.resolve({name:route.name}).href}return"/app/home/portfolio"},redirect:function(){if(this.workorder.resource.siteId){var parentPath=this.findRoute();if(parentPath){var url="".concat(parentPath,"/site/").concat(this.workorder.resource.siteId);1===this.workorder.resource.spaceType?url+="/overview":2===this.workorder.resource.spaceType?url+="/building/"+this.workorder.resource.spaceId:3===this.workorder.resource.spaceType?url+="/floor/"+this.workorder.resource.spaceId:4===this.workorder.resource.spaceType&&(url+="/space/"+this.workorder.resource.spaceId),this.$router.push({path:url})}}},userObj:function(userId){var userObj=null;return userId&&userId>0&&this.users&&(userObj=this.users.find((function(i){return i.ouid===userId}))),userObj},getAverageWoResponseWorkflow:function(){var self=this,d=new Date,m=(d.getTime(),this.$options.filters.formatDate(new Date,!0,!1));this.endDate=moment_timezone_default()(new Date).subtract(1,"months").endOf("month").format("MMM YYYY");moment_timezone_default()(m).subtract(1,"months").endOf("month").format("YYYY-MM-DD");var a=[];a.push(parseInt(self.$route.params.id));var url="/v2/workflow/getDefaultWorkflowResult",params="defaultWorkflowId=1&paramList="+a;url=url+"?"+params;return self.avgResponseLoading=!0,self.$http.get(url).then((function(response){if(response.data.result&&response.data.result.workflow&&response.data.result.workflow.returnValue&&(self.averageRes=response.data.result.workflow.returnValue.responseTime,self.previousMonthAverageRes=response.data.result.workflow.returnValue.previousMonthresponseTime),self.averageRes>0){var date,dateObj=self.averageRes;date=dateObj/1e3,date<0&&date>-2&&(date=0);var _d=Math.floor(date/86400),h=Math.floor(date%86400/3600),_m=Math.floor(date%3600/60),s=Math.floor(date%3600%60);self.averageResponseTime.days=_d>=0?_d:0,self.averageResponseTime.hours=h>=0?h:0,self.averageResponseTime.mins=_m>=0?_m:0,self.averageResponseTime.secs=s>=0?s:0,self.averageResponseTime.days>0?self.averageResponseTime.timedays=self.averageResponseTime.days:self.averageResponseTime.hours>0?self.averageResponseTime.timehours=self.averageResponseTime.hours+"."+self.averageResponseTime.mins:self.averageResponseTime.mins>0&&(self.averageResponseTime.timemins=self.averageResponseTime.mins)}if(self.previousMonthAverageRes>0){var _date,_dateObj=self.previousMonthAverageRes;_date=_dateObj/1e3,_date<0&&_date>-2&&(_date=0);var _d2=Math.floor(_date/86400),_h=Math.floor(_date%86400/3600),_m2=Math.floor(_date%3600/60);Math.floor(_date%3600%60);self.previousMonthAverageResponseTime.days=_d2>=0?_d2:0,self.previousMonthAverageResponseTime.hours=_h>=0?_h:0,self.previousMonthAverageResponseTime.mins=_m2>=0?_m2:0,self.previousMonthAverageResponseTime.days>0?self.previousMonthAverageResponseTime.timedays=self.previousMonthAverageResponseTime.days:self.previousMonthAverageResponseTime.hours>0?self.previousMonthAverageResponseTime.timehours=self.previousMonthAverageResponseTime.hours+"."+self.previousMonthAverageResponseTime.mins:self.previousMonthAverageResponseTime.mins>0&&(self.previousMonthAverageResponseTime.timemins=self.previousMonthAverageResponseTime.mins)}self.avgResponseLoading=!1}))},getFieldDrop:function(approver){approver.approversId=null,approver.approvesDataType=[],1===approver.sharingType?approver.approvesDataType=this.users:2===approver.sharingType?approver.approvesDataType=this.roles:3===approver.sharingType&&(approver.approvesDataType=this.teams)},loadResourcePlanner:function(id){return this.$http.get("v2/workorders/pmResourcePlanner?id=".concat(id))},loadPreventiveSummary:function(resourcePlanners){var _this11=this;if(this.loading=!0,this.$route.params.id)return this.$http.get("v2/workorders/pmDetail?hidePMResourcePlanner=true&id="+parseInt(this.$route.params.id)).then((function(response){if(_this11.loadWorkorders(),_this11.workorder=response.data.workorder,_this11.photoMandatory=_this11.workorder.photoMandatory,_this11.allowNegativePreRequisite=_this11.workorder.allowNegativePreRequisite,_this11.allowNegative=3===_this11.workorder.allowNegativePreRequisite,_this11.approvers=response.data.prerequisiteApproverTemplates,response.data.prerequisiteApproverTemplates&&response.data.prerequisiteApproverTemplates.length>0&&(response.data.prerequisiteApproverTemplates.forEach((function(approver){_this11.getFieldDrop(approver),1===approver.sharingType?approver.approversId=approver.userId:2===approver.sharingType?approver.approversId=parseInt(approver.roleId):3===approver.tysharingTypepe&&(approver.approversId=parseInt(approver.groupId))})),_this11.approvers=response.data.prerequisiteApproverTemplates),_this11.pmObject=response.data,_this11.pm=response.data.preventivemaintenance,_this11.loadModuleInfo(response.data.preventivemaintenance),_this11.loadPmmetaInfo(),_this11.pm.pmCreationType&&resourcePlanners&&resourcePlanners.forEach((function(r){_this11.resources.push({id:r.resourceId,name:r.resourceName})})),_this11.pm&&(3===_this11.pm.pmCreationType?(_this11.resType="Building",_this11.resName=_this11.buildingList[Number(_this11.pm.baseSpaceId)]):3===_this11.pm.pmCreationType&&1===_this11.pm.assignmentType&&(_this11.resType="Floors",_this11.resName=_this11.buildingList[Number(_this11.pm.baseSpaceId)])),_this11.pm.triggers&&_this11.pm.triggers.length&&_this11.resources.sort((function(a,b){var nameA=a.name.toUpperCase(),nameB=b.name.toUpperCase();return nameA<nameB?-1:nameA>nameB?1:0})),response.data.listOfTasks&&-1!==response.data.listOfTasks[0].sequence){_this11.sectionList=response.data.sectionTemplates?response.data.sectionTemplates:[];var sorted=_this11.sort(response.data.listOfTasks);_this11.taskList=sorted.map((function(task){return task.options&&(task.options=task.options.map((function(option){return{name:option}}))),task.enableInput=task.inputType>1,task.inputType+="",task.validation="none",task.inputValidationRuleId=-1,task.readingRules&&task.readingRules.forEach((function(rule){if(task.inputValidationRuleId=rule.id,"(b!=-1)&&(a<b)"===rule.workflow.resultEvaluator)task.validation="incremental";else if("(b!=-1)&&(a>b)"===rule.workflow.resultEvaluator)task.validation="decremental";else if("(b!=-1&&a<b)||(c!=-1&&a>c)"===rule.workflow.resultEvaluator&&rule.workflow.expressions){task.validation="safeLimit";var min=rule.workflow.expressions.find((function(val){return"b"===val.name})).constant;task.minSafeLimit="-1"===min?null:min;var max=rule.workflow.expressions.find((function(val){return"c"===val.name})).constant;task.maxSafeLimit="-1"===max?null:max}})),task}));var currentSectionId=-1,currentSectionTasks=[],newTasjList=[],pmResourceLabel="";1===_this11.pm.pmCreationType&&_this11.workorder&&_this11.workorder.resource&&(pmResourceLabel=_this11.workorder.resource.name),_this11.taskList.forEach((function(ele,index){if(ele.sectionId===currentSectionId){var sec=_this11.sectionList?_this11.sectionList.find((function(section){return section.id===currentSectionId})):null,assignmentType=sec?sec.assignmentType:null,categoryId=3===assignmentType?sec.spaceCategoryId:4===assignmentType?sec.assetCategoryId:null,resourceCount=sec?sec.pmIncludeExcludeCount:null,parentAssingmentType=_this11.pm.assignmentType,parentCategoryId=3===parentAssingmentType?_this11.pm.spaceCategoryId:4===parentAssingmentType?_this11.pm.assetCategoryId:null,parentResourceCount=_this11.pm.pmIncludeExcludeCount,taskTemplate=sec&&sec.taskTemplates?sec.taskTemplates.find((function(t){return t.sequence===ele.sequence})):null;if(taskTemplate){var sectionAssignmentType=sec?sec.assignmentType:null,sectionResourceCount=sec?sec.pmIncludeExcludeCount:null,sectionCategoryId=3===assignmentType?sec.spaceCategoryId:4===assignmentType?sec.assetCategoryId:null;5===sectionAssignmentType&&(sectionAssignmentType=parentAssingmentType,sectionResourceCount=_this11.pm.pmIncludeExcludeCount,sectionCategoryId=parentCategoryId);var taskAssignmentType=taskTemplate.assignmentType,taskCategoryId=3===taskAssignmentType?taskTemplate.spaceCategoryId:4===taskAssignmentType?taskTemplate.assetCategoryId:null,taskResourceCount=taskTemplate.pmIncludeExcludeCount;ele.resourceLabel=_this11.resourceLabel({pmCreationType:_this11.pm.pmCreationType,assignmentType:taskAssignmentType,categoryId:taskCategoryId,resourceCount:taskResourceCount,parentAssingmentType:sectionAssignmentType,parentCategoryId:sectionCategoryId,parentResourceCount:sectionResourceCount,pmResourceLabel:pmResourceLabel}),taskTemplate.additionInfo&&taskTemplate.additionInfo.options&&(ele.options=taskTemplate.additionInfo.options.map((function(option){return{name:option}})))}currentSectionTasks.push(ele),index===_this11.taskList.length-1&&(-1===ele.sectionId?newTasjList.push({sectionId:-1,sectionName:"default",tasks:currentSectionTasks,resourceLabel:_this11.resourceLabel({pmCreationType:_this11.pm.pmCreationType,assignmentType:assignmentType,categoryId:categoryId,resourceCount:resourceCount,parentAssingmentType:parentAssingmentType,parentCategoryId:parentCategoryId,parentResourceCount:parentResourceCount,pmResourceLabel:pmResourceLabel})}):newTasjList.push({sectionId:sec.id,sectionName:sec.name,tasks:currentSectionTasks,resourceLabel:_this11.resourceLabel({pmCreationType:_this11.pm.pmCreationType,assignmentType:assignmentType,categoryId:categoryId,resourceCount:resourceCount,parentAssingmentType:parentAssingmentType,parentCategoryId:parentCategoryId,parentResourceCount:parentResourceCount,pmResourceLabel:pmResourceLabel})}))}else{var _sec=_this11.sectionList?_this11.sectionList.find((function(section){return section.id===currentSectionId})):null,_assignmentType=_sec?_sec.assignmentType:null,_categoryId=3===_assignmentType?_sec.spaceCategoryId:4===_assignmentType?_sec.assetCategoryId:null,_resourceCount=_sec?_sec.pmIncludeExcludeCount:null,_parentAssingmentType=_this11.pm.assignmentType,_parentCategoryId=3===_parentAssingmentType?_this11.pm.spaceCategoryId:4===_parentAssingmentType?_this11.pm.assetCategoryId:null,_parentResourceCount=_this11.pm.pmIncludeExcludeCount;if(_sec?newTasjList.push({sectionId:_sec.id,sectionName:_sec.name,tasks:currentSectionTasks,resourceLabel:_this11.resourceLabel({pmCreationType:_this11.pm.pmCreationType,assignmentType:_assignmentType,categoryId:_categoryId,resourceCount:_resourceCount,parentAssingmentType:_parentAssingmentType,parentCategoryId:_parentCategoryId,parentResourceCount:_parentResourceCount,pmResourceLabel:pmResourceLabel})}):-1===currentSectionId&&newTasjList.push({sectionId:-1,sectionName:"default",tasks:currentSectionTasks}),currentSectionTasks=[ele],currentSectionId=ele.sectionId,_sec=_this11.sectionList?_this11.sectionList.find((function(section){return section.id===currentSectionId})):null,_assignmentType=_sec?_sec.assignmentType:null,_resourceCount=_sec?_sec.pmIncludeExcludeCount:null,_categoryId=3===_assignmentType?_sec.spaceCategoryId:4===_assignmentType?_sec.assetCategoryId:null,_sec){var _taskTemplate=_sec.taskTemplates?_sec.taskTemplates.find((function(t){return t.sequence===ele.sequence})):null;if(_taskTemplate){var _sectionCategoryId,_sectionAssignmentType=_assignmentType,_sectionResourceCount=_resourceCount;_sectionCategoryId=5===_sectionAssignmentType?_parentCategoryId:3===_assignmentType?_sec.spaceCategoryId:4===_assignmentType?_sec.assetCategoryId:null,5===_assignmentType&&(_sectionAssignmentType=_parentAssingmentType,_sectionResourceCount=_this11.pm.pmIncludeExcludeCount);var _taskAssignmentType=_taskTemplate.assignmentType,_taskCategoryId=3===_taskAssignmentType?_taskTemplate.spaceCategoryId:4===_taskAssignmentType?_taskTemplate.assetCategoryId:null,_taskResourceCount=_taskTemplate.pmIncludeExcludeCount;ele.resourceLabel=_this11.resourceLabel({pmCreationType:_this11.pm.pmCreationType,assignmentType:_taskAssignmentType,categoryId:_taskCategoryId,resourceCount:_taskResourceCount,parentAssingmentType:_sectionAssignmentType,parentCategoryId:_sectionCategoryId,parentResourceCount:_sectionResourceCount,pmResourceLabel:pmResourceLabel}),_taskTemplate.additionInfo&&_taskTemplate.additionInfo.options&&(ele.options=_taskTemplate.additionInfo.options.map((function(option){return{name:option}})))}}index===_this11.taskList.length-1&&newTasjList.push({sectionId:_sec.id,sectionName:_sec.name,tasks:currentSectionTasks,resourceLabel:_this11.resourceLabel({pmCreationType:_this11.pm.pmCreationType,assignmentType:_assignmentType,categoryId:_categoryId,resourceCount:_resourceCount,parentAssingmentType:_parentAssingmentType,parentCategoryId:_parentCategoryId,parentResourceCount:_parentResourceCount,pmResourceLabel:pmResourceLabel})})}})),_this11.newViewTasks=newTasjList,_this11.isNewViewTemp=!0}else _this11.tasks=response.data.taskList,_this11.isNewViewTemp=!1,_this11.setTasksList();if((0,validation/* isEmpty */.xb)(response.data.listOfPreRequests)||-1===response.data.listOfPreRequests[0].sequence)_this11.preRequests=response.data.preRequestList,_this11.isNewViewTempPreRequest=!1,_this11.setPreRequestsList();else{_this11.sectionList=response.data.preRequestSectionTemplates?response.data.preRequestSectionTemplates:[];var _sorted=_this11.sort(response.data.listOfPreRequests);_this11.taskList=_sorted.map((function(task){return task.options&&(task.options=task.options.map((function(option){return{name:option}}))),task.enableInput=task.inputType>1,task.inputType+="",task.validation="none",task.inputValidationRuleId=-1,task}));var _currentSectionId=-1,_currentSectionTasks=[],_newTasjList=[],_pmResourceLabel="";1===_this11.pm.pmCreationType&&_this11.workorder&&_this11.workorder.resource&&(_pmResourceLabel=_this11.workorder.resource.name),_this11.taskList.forEach((function(ele,index){if(ele.sectionId===_currentSectionId){var sec=_this11.sectionList.find((function(section){return section.id===_currentSectionId})),assignmentType=sec?sec.assignmentType:null,categoryId=3===assignmentType?sec.spaceCategoryId:4===assignmentType?sec.assetCategoryId:null,resourceCount=sec?sec.pmIncludeExcludeCount:null,parentAssingmentType=_this11.pm.assignmentType,parentCategoryId=3===parentAssingmentType?_this11.pm.spaceCategoryId:4===parentAssingmentType?_this11.pm.assetCategoryId:null,parentResourceCount=_this11.pm.pmIncludeExcludeCount,taskTemplate=sec&&sec.taskTemplates?sec.taskTemplates.find((function(t){return t.sequence===ele.sequence})):null;if(taskTemplate){var sectionAssignmentType=sec?sec.assignmentType:null,sectionResourceCount=sec?sec.pmIncludeExcludeCount:null,sectionCategoryId=3===assignmentType?sec.spaceCategoryId:4===assignmentType?sec.assetCategoryId:null;5===sectionAssignmentType&&(sectionAssignmentType=parentAssingmentType,sectionResourceCount=_this11.pm.pmIncludeExcludeCount,sectionCategoryId=parentCategoryId);var taskAssignmentType=taskTemplate.assignmentType,taskCategoryId=3===taskAssignmentType?taskTemplate.spaceCategoryId:4===taskAssignmentType?taskTemplate.assetCategoryId:null,taskResourceCount=taskTemplate.pmIncludeExcludeCount;ele.resourceLabel=_this11.resourceLabel({pmCreationType:_this11.pm.pmCreationType,assignmentType:taskAssignmentType,categoryId:taskCategoryId,resourceCount:taskResourceCount,parentAssingmentType:sectionAssignmentType,parentCategoryId:sectionCategoryId,parentResourceCount:sectionResourceCount,pmResourceLabel:_pmResourceLabel}),taskTemplate.additionInfo&&taskTemplate.additionInfo.options&&(ele.options=taskTemplate.additionInfo.options.map((function(option){return{name:option}}))),taskTemplate.additionInfo&&taskTemplate.additionInfo.truevalue&&(ele.truevalue=taskTemplate.additionInfo.truevalue),taskTemplate.additionInfo&&taskTemplate.additionInfo.falsevalue&&(ele.falsevalue=taskTemplate.additionInfo.falsevalue)}_currentSectionTasks.push(ele),index===_this11.taskList.length-1&&(-1===ele.sectionId?_newTasjList.push({sectionId:-1,sectionName:"default",preRequests:_currentSectionTasks,resourceLabel:_this11.resourceLabel({pmCreationType:_this11.pm.pmCreationType,assignmentType:assignmentType,categoryId:categoryId,resourceCount:resourceCount,parentAssingmentType:parentAssingmentType,parentCategoryId:parentCategoryId,parentResourceCount:parentResourceCount,pmResourceLabel:_pmResourceLabel})}):_newTasjList.push({sectionId:sec.id,sectionName:sec.name,preRequests:_currentSectionTasks,resourceLabel:_this11.resourceLabel({pmCreationType:_this11.pm.pmCreationType,assignmentType:assignmentType,categoryId:categoryId,resourceCount:resourceCount,parentAssingmentType:parentAssingmentType,parentCategoryId:parentCategoryId,parentResourceCount:parentResourceCount,pmResourceLabel:_pmResourceLabel})}))}else{var _sec2=_this11.sectionList.find((function(section){return section.id===_currentSectionId})),_assignmentType2=_sec2?_sec2.assignmentType:null,_categoryId2=3===_assignmentType2?_sec2.spaceCategoryId:4===_assignmentType2?_sec2.assetCategoryId:null,_resourceCount2=_sec2?_sec2.pmIncludeExcludeCount:null,_parentAssingmentType2=_this11.pm.assignmentType,_parentCategoryId2=3===_parentAssingmentType2?_this11.pm.spaceCategoryId:4===_parentAssingmentType2?_this11.pm.assetCategoryId:null,_parentResourceCount2=_this11.pm.pmIncludeExcludeCount;if(_sec2?_newTasjList.push({sectionId:_sec2.id,sectionName:_sec2.name,preRequests:_currentSectionTasks,resourceLabel:_this11.resourceLabel({pmCreationType:_this11.pm.pmCreationType,assignmentType:_assignmentType2,categoryId:_categoryId2,resourceCount:_resourceCount2,parentAssingmentType:_parentAssingmentType2,parentCategoryId:_parentCategoryId2,parentResourceCount:_parentResourceCount2,pmResourceLabel:_pmResourceLabel})}):-1===_currentSectionId&&_newTasjList.push({sectionId:-1,sectionName:"default",preRequests:_currentSectionTasks}),_currentSectionTasks=[ele],_currentSectionId=ele.sectionId,_sec2=_this11.sectionList.find((function(section){return section.id===_currentSectionId})),_assignmentType2=_sec2?_sec2.assignmentType:null,_resourceCount2=_sec2?_sec2.pmIncludeExcludeCount:null,_categoryId2=3===_assignmentType2?_sec2.spaceCategoryId:4===_assignmentType2?_sec2.assetCategoryId:null,_sec2){var _taskTemplate2=_sec2.taskTemplates.find((function(t){return t.sequence===ele.sequence}));if(_taskTemplate2){var _sectionCategoryId2,_sectionAssignmentType2=_assignmentType2,_sectionResourceCount2=_resourceCount2;_sectionCategoryId2=5===_sectionAssignmentType2?_parentCategoryId2:3===_assignmentType2?_sec2.spaceCategoryId:4===_assignmentType2?_sec2.assetCategoryId:null,5===_assignmentType2&&(_sectionAssignmentType2=_parentAssingmentType2,_sectionResourceCount2=_this11.pm.pmIncludeExcludeCount);var _taskAssignmentType2=_taskTemplate2.assignmentType,_taskCategoryId2=3===_taskAssignmentType2?_taskTemplate2.spaceCategoryId:4===_taskAssignmentType2?_taskTemplate2.assetCategoryId:null,_taskResourceCount2=_taskTemplate2.pmIncludeExcludeCount;ele.resourceLabel=_this11.resourceLabel({pmCreationType:_this11.pm.pmCreationType,assignmentType:_taskAssignmentType2,categoryId:_taskCategoryId2,resourceCount:_taskResourceCount2,parentAssingmentType:_sectionAssignmentType2,parentCategoryId:_sectionCategoryId2,parentResourceCount:_sectionResourceCount2,pmResourceLabel:_pmResourceLabel}),_taskTemplate2.additionInfo&&_taskTemplate2.additionInfo.options&&(ele.options=_taskTemplate2.additionInfo.options.map((function(option){return{name:option}}))),_taskTemplate2.additionInfo&&_taskTemplate2.additionInfo.truevalue&&(ele.truevalue=_taskTemplate2.additionInfo.truevalue),_taskTemplate2.additionInfo&&_taskTemplate2.additionInfo.falsevalue&&(ele.falsevalue=_taskTemplate2.additionInfo.falsevalue)}}index===_this11.taskList.length-1&&_newTasjList.push({sectionId:_sec2.id,sectionName:_sec2.name,preRequests:_currentSectionTasks,resourceLabel:_this11.resourceLabel({pmCreationType:_this11.pm.pmCreationType,assignmentType:_assignmentType2,categoryId:_categoryId2,resourceCount:_resourceCount2,parentAssingmentType:_parentAssingmentType2,parentCategoryId:_parentCategoryId2,parentResourceCount:_parentResourceCount2,pmResourceLabel:_pmResourceLabel})})}})),_this11.newViewPreRequests=_newTasjList,_this11.isNewViewTempPreRequest=!0}_this11.reminders=response.data.reminders,_this11.model["emitForm"]=!1,_this11.model["isEdit"]=!0,_this11.model["isLoading"]=!1,_this11.model["isEdit"]=!0,_this11.model["taskData"]={taskSections:[_this11.newViewTasks]},_this11.model["triggerData"]={reminders:[_this11.reminders]},_this11.loading=!1,resourcePlanners&&resourcePlanners.length&&resourcePlanners[0].resource&&(_this11.resourceTypeEnum=resourcePlanners[0].resource.resourceTypeEnum?resourcePlanners[0].resource.resourceTypeEnum:null),_this11.loadSite()})).then((function(){_this11.$util.loadReadingFields(_this11.workorder.resource).then((function(response){_this11.readingFields=response,_this11.setReadingFieldsForTriggers()})),_this11.getAverageWoResponseWorkflow(),_this11.fetchCard("woOnTime"),_this11.fetchPreviousMonthCard("woOnTime"),_this11.fetchPreviousMonthCard("woAvgRes"),_this11.fetchCard("woFreqAssign"),_this11.fetchCard("woAvgRes")}))},getPMType:function(type){return this.tickettype[type]},openWorkOrder:function(id){if((0,router/* isWebTabsEnabled */.tj)()){var _ref9=(0,router/* findRouteForModule */.Jp)("workorder",router/* pageTypes */.As.OVERVIEW)||{},name=_ref9.name;name&&this.$router.push({name:name,params:{viewname:"all",id:id}})}else this.$router.push({path:"/app/wo/orders/summary/"+id})},preWoValidation:function(){var _this12=this;this.pm.markIgnoredWo?this.$dialog.confirm({title:"Skip Ignored Workorder",message:"Do you want to skip workorders if not started till next due ?",rbClass:"pm-sum-btn-green",className:"pmsummary-wo-create-dialog",rbLabel:"Execute PM"}).then((function(confirmExecute){confirmExecute&&_this12.executePM()})):this.executePM()},executePM:function(){var _this13=this;if(this.pm)if(this.isExecuting=!0,3!==this.pm.pmCreationType){var data={};data.pmId=this.pm.id,this.$http.post("/workorder/executePreventiveMaintenance",data).then((function(response){var wo=response.data.workorder;wo&&(_this13.workorderObj=wo,_this13.workordersArr.unshift(wo),_this13.$dialog.confirm({title:"Pm Executed",message:_this13.workorder.subject+" has been successfully created.",rbClass:"pm-sum-btn-green",className:"pmsummary-wo-create-dialog",rbLabel:"Go to workorder"}).then((function(confirmDelete){confirmDelete&&_this13.openWorkOrder(wo.id)})),_this13.isExecuting=!1,_this13.openPopOver=!0)}))}else this.showExecutionConfig=!0},beforeConfigClose:function(done){this.resources.forEach((function(i){i.selected=!1})),this.selectAllResources=!1,this.isExecuting=!1,done&&done()},openAsset:function(id){if((0,router/* isWebTabsEnabled */.tj)()){var _ref10=(0,router/* findRouteForModule */.Jp)("asset",router/* pageTypes */.As.OVERVIEW)||{},name=_ref10.name;name&&this.$router.push({name:name,params:{viewname:"all",id:id}})}else this.$router.push({path:"/app/at/assets/all/"+id+"/overview"})},showDetails:function(task){this.showPreRequestDetails=!1,this.selectedPreRequest=null,this.showTaskDetails=!0,this.selectedTask=task,this.pmDetailsview=!1},showDetailsPreRequest:function(preRequest){this.showTaskDetails=!1,this.selectedTask=null,this.showPreRequestDetails=!0,this.selectedPreRequest=preRequest,this.pmDetailsview=!1},setTasksList:function(){for(var section in this.tasks)this.tasks.hasOwnProperty(section)&&(this.tasks[section]=this.tasks[section].map((function(task){return task.options&&(task.options=task.options.map((function(option){return{name:option}}))),task.enableInput=task.inputType>1,task.inputType+="",task})))},setPreRequestsList:function(){for(var section in this.preRequests)this.preRequests.hasOwnProperty(section)&&(this.preRequests[section]=this.preRequests[section].map((function(task){return task.options&&(task.options=task.options.map((function(option){return{name:option}}))),task.enableInput=task.inputType>1,task.inputType+="",task})))},setReadingFieldsForTriggers:function(){var _this14=this;this.pm.triggers&&(this.pm.triggers=this.pm.triggers.map((function(trigger){return!trigger.schedule&&_this14.readingFields&&(trigger.readingField=_this14.readingFields.find((function(field){return field.id===trigger.readingFieldId}))),trigger})))},fetchPreviousMonthCard:function(type){var workflow,_this15=this;if(this.$helpers.isLicenseEnabled("SCHEDULED_WO")?"woOnTime"===type?workflow=this.getNewPreviousMonthWoOnTimeWorkflow():"woAvgRes"===type&&(workflow=this.getNewPreviousMonthWoAvgResWorkflow()):"woOnTime"===type?workflow=this.getPreviousMonthWoOnTimeWorkflow():"woAvgRes"===type&&(workflow=this.getPreviousMonthWoAvgResWorkflow()),workflow)return this.workflowResult[type].loading=!0,new Promise((function(resolve,reject){_this15.$http.post("/v2/executeworkflow",{workflow:workflow}).then((function(response){0===response.data.responseCode&&(_this15.previousMonthworkflowResult[type].result=response.data.result.workflowResult,resolve(response.data.result))}))}))},fetchCard:function(type){var workflow,_this16=this;if(this.$helpers.isLicenseEnabled("SCHEDULED_WO")?"woOnTime"===type?workflow=this.getNewWoOnTimeWorkflow():"woAvgRes"===type?workflow=this.getNewWoAvgResWorkflow():"woFreqAssign"===type&&(workflow=this.getNewWoFreqAssignWorkflow()):"woOnTime"===type?workflow=this.getWoOnTimeWorkflow():"woAvgRes"===type?workflow=this.getWoAvgResWorkflow():"woFreqAssign"===type&&(workflow=this.getWoFreqAssignWorkflow()),workflow)return this.workflowResult[type].loading=!0,new Promise((function(resolve,reject){_this16.$http.post("/v2/executeworkflow",{workflow:workflow}).then((function(response){_this16.workflowResult[type].loading=!1,0===response.data.responseCode&&(_this16.workflowResult[type].result=response.data.result.workflowResult,resolve(response.data.result))}))}))},getNewWoAvgResWorkflow:function(){if(!this.pm||!this.workordersArr)return 0;var expressions=[{name:"a",fieldName:"actualWorkDuration",aggregateString:"avg",moduleName:"workorder",criteria:{pattern:"(1 and 2 and 3)",conditions:{1:{fieldName:"pm",operatorId:36,sequence:"1",value:this.pm.id},2:{fieldName:"jobStatus",operatorId:9,sequence:"2",value:3},3:{fieldName:"createdTime",operatorId:44,sequence:"3"}}}}];return{expressions:expressions}},getNewWoFreqAssignWorkflow:function(){if(!this.pm||!this.workordersArr)return 0;var expressions=[{name:"a",fieldName:"assignedTo",moduleName:"workorder",criteria:{pattern:"(1 and 2)",conditions:{1:{fieldName:"pm",operatorId:36,sequence:"1",value:this.pm.id},2:{fieldName:"jobStatus",operatorId:9,sequence:"2",value:3}}},groupBy:"assignedTo",orderByFieldName:"count(*)",sortBy:"desc",limit:1}];return{expressions:expressions}},getNewWoOnTimeWorkflow:function(){if(!this.pm||!this.workordersArr||!this.workordersArr[0])return 0;var expressions=[{name:"a",fieldName:"dueDate",aggregateString:"count",moduleName:"workorder",criteria:{pattern:"(1 and 2 and 3 and 4)",conditions:{1:{fieldName:"pm",operatorId:36,sequence:"1",value:this.pm.id},2:{fieldName:"actualWorkEnd",operatorId:18,sequence:"2",value:"DUE_DATE"},3:{fieldName:"jobStatus",operatorId:9,sequence:"3",value:3},4:{fieldName:"createdTime",operatorId:44,sequence:"4"}}}},{name:"b",fieldName:"id",aggregateString:"count",moduleName:"workorder",criteria:{pattern:"(1 and 2)",conditions:{1:{fieldName:"pm",operatorId:36,sequence:"1",value:this.pm.id},2:{fieldName:"jobStatus",operatorId:9,sequence:"2",value:3}}}}];return{expressions:expressions,resultEvaluator:"(a/b)*100"}},getWoOnTimeWorkflow:function(){if(!this.pm||!this.workordersArr||!this.workordersArr[0])return 0;var expressions=[{name:"a",fieldName:"dueDate",aggregateString:"count",moduleName:"workorder",criteria:{pattern:"(1 and 2 and 3)",conditions:{1:{fieldName:"pm",operatorId:36,sequence:"1",value:this.pm.id},2:{fieldName:"actualWorkEnd",operatorId:18,sequence:"2",value:"DUE_DATE"},3:{fieldName:"createdTime",operatorId:44,sequence:"3"}}}},{name:"b",fieldName:"id",aggregateString:"count",moduleName:"workorder",criteria:{pattern:"(1)",conditions:{1:{fieldName:"pm",operatorId:36,sequence:"1",value:this.pm.id}}}}];return{expressions:expressions,resultEvaluator:"(a/b)*100"}},getNewPreviousMonthWoOnTimeWorkflow:function(){if(!this.pm||!this.workordersArr||!this.workordersArr[0])return 0;var m=moment_timezone_default()(new Date).format("DD MMM YYYY"),dateFrom=moment_timezone_default()(m).subtract(1,"months").endOf("month").format("YYYY-MM-DD"),lastMonth=moment_timezone_default()(dateFrom,"YYYY/MM/DD").valueOf();if(this.pm.createdTime<lastMonth){var expressions=[{name:"a",fieldName:"dueDate",aggregateString:"count",moduleName:"workorder",criteria:{pattern:"(1 and 2 and 3 and 4)",conditions:{1:{fieldName:"pm",operatorId:36,sequence:"1",value:this.pm.id},2:{fieldName:"actualWorkEnd",operatorId:18,sequence:"2",value:"DUE_DATE"},3:{fieldName:"createdTime",operatorId:20,sequence:"3",value:this.pm.createdTime+","+lastMonth},4:{fieldName:"jobStatus",operatorId:9,sequence:"4",value:3}}}},{name:"b",fieldName:"id",aggregateString:"count",moduleName:"workorder",criteria:{pattern:"(1)",conditions:{1:{fieldName:"pm",operatorId:36,sequence:"1",value:this.pm.id}}}}];return{expressions:expressions,resultEvaluator:"(a/b)*100"}}return 0},getPreviousMonthWoOnTimeWorkflow:function(){if(!this.pm||!this.workordersArr||!this.workordersArr[0])return 0;var m=moment_timezone_default()(new Date).format("DD MMM YYYY"),dateFrom=moment_timezone_default()(m).subtract(1,"months").endOf("month").format("YYYY-MM-DD"),lastMonth=moment_timezone_default()(dateFrom,"YYYY/MM/DD").valueOf();if(this.pm.createdTime<lastMonth){var expressions=[{name:"a",fieldName:"dueDate",aggregateString:"count",moduleName:"workorder",criteria:{pattern:"(1 and 2 and 3)",conditions:{1:{fieldName:"pm",operatorId:36,sequence:"1",value:this.pm.id},2:{fieldName:"actualWorkEnd",operatorId:18,sequence:"2",value:"DUE_DATE"},3:{fieldName:"createdTime",operatorId:20,sequence:"3",value:this.pm.createdTime+","+lastMonth}}}},{name:"b",fieldName:"id",aggregateString:"count",moduleName:"workorder",criteria:{pattern:"(1)",conditions:{1:{fieldName:"pm",operatorId:36,sequence:"1",value:this.pm.id}}}}];return{expressions:expressions,resultEvaluator:"(a/b)*100"}}return 0},getNewPreviousMonthWoAvgResWorkflow:function(){if(!this.pm||!this.workordersArr)return 0;var m=moment_timezone_default()(new Date).format("DD MMM YYYY"),dateFrom=moment_timezone_default()(m).subtract(1,"months").endOf("month").format("YYYY-MM-DD"),lastMonth=moment_timezone_default()(dateFrom,"YYYY/MM/DD").valueOf();if(this.pm.createdTime<lastMonth){var expressions=[{name:"a",fieldName:"actualWorkDuration",aggregateString:"avg",moduleName:"workorder",criteria:{pattern:"(1 and 2 and 3)",conditions:{1:{fieldName:"pm",operatorId:36,sequence:"1",value:this.pm.id},2:{fieldName:"createdTime",operatorId:20,sequence:"2",value:this.pm.createdTime+","+lastMonth},3:{fieldName:"jobStatus",operatorId:9,sequence:"3",value:3}}}}];return{expressions:expressions}}return 0},getPreviousMonthWoAvgResWorkflow:function(){if(!this.pm||!this.workordersArr)return 0;var m=moment_timezone_default()(new Date).format("DD MMM YYYY"),dateFrom=moment_timezone_default()(m).subtract(1,"months").endOf("month").format("YYYY-MM-DD"),lastMonth=moment_timezone_default()(dateFrom,"YYYY/MM/DD").valueOf();if(this.pm.createdTime<lastMonth){var expressions=[{name:"a",fieldName:"actualWorkDuration",aggregateString:"avg",moduleName:"workorder",criteria:{pattern:"(1 and 2)",conditions:{1:{fieldName:"pm",operatorId:36,sequence:"1",value:this.pm.id},2:{fieldName:"createdTime",operatorId:20,sequence:"2",value:this.pm.createdTime+","+lastMonth}}}}];return{expressions:expressions}}return 0},getWoAvgResWorkflow:function(){if(!this.pm||!this.workordersArr)return 0;var expressions=[{name:"a",fieldName:"actualWorkDuration",aggregateString:"avg",moduleName:"workorder",criteria:{pattern:"(1 and 2)",conditions:{1:{fieldName:"pm",operatorId:36,sequence:"1",value:this.pm.id},2:{fieldName:"createdTime",operatorId:44,sequence:"2"}}}}];return{expressions:expressions}},checkown:function(){return this.$account.user.id===this.workorder.assignedTo.id},getWoFreqAssignWorkflow:function(){if(!this.pm||!this.workordersArr)return 0;var expressions=[{name:"a",fieldName:"assignedTo",moduleName:"workorder",criteria:{pattern:"(1)",conditions:{1:{fieldName:"pm",operatorId:36,sequence:"1",value:this.pm.id}}},groupBy:"assignedTo",orderByFieldName:"count(*)",sortBy:"desc",limit:1}];return{expressions:expressions}},handlePreview:function(){},handleRemove:function(){},closedisplay:function(){this.selectedTask=null,this.selectedPreRequest=null,this.pmDetailsview=!0},getFormattedDuration:function(workorderData,fieldObj){var fieldName=this.$getProperty(fieldObj,"field.name","---"),$helpers=this.$helpers,_ref11=$helpers||{},getFormattedDuration=_ref11.getFormattedDuration;return workorderData&&workorderData[fieldName]?getFormattedDuration(workorderData[fieldName],"seconds"):"---"},isFieldDisplayTypeDuration:function(customField){var displayType=this.$getProperty(customField,"field.displayType","");return"DURATION"===displayType}}},v1_Pmsummaryvue_type_script_lang_js=Pmsummaryvue_type_script_lang_js,Pmsummary_component=(0,componentNormalizer/* default */.Z)(v1_Pmsummaryvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,Pmsummary=Pmsummary_component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/20906.js.map