"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[2287],{
/***/856778:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FColorPalettes}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/newcharts/components/FColorPalettes.vue?vue&type=template&id=253b7996
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_vm._m(0),_c("div",{staticClass:"flex-middle"},[_c("div",{staticClass:"colorPalette-main",on:{click:_vm.openDialog}},_vm._l(_vm.Colors[_vm.chosenColors],(function(color,idx){return _c("div",{key:idx,staticClass:"colorBlock",style:{background:color}})})),0),_c("div",{staticClass:"flex-middle mL30 pB10 pointer",on:{click:_vm.openDialog}},[_c("div",{staticClass:"fc-link2 f11"},[_vm._v("Change")]),_c("InlineSvg",{staticClass:"vertical-middle pointer color-pallete",staticStyle:{top:"2px"},attrs:{src:"svgs/painter-palette",iconClass:"icon icon-xs mL5"}})],1)]),_c("el-dialog",{staticClass:"fc-dialog-center-container color-pallete-lock",attrs:{title:"Colour palettes",width:"35%",visible:_vm.showColorPalette,"append-to-body":!0,"lock-scroll":!0},on:{"update:visible":function($event){_vm.showColorPalette=$event}}},[_c("div",{staticStyle:{height:"580px"}},[_c("el-row",{attrs:{gutter:20}},_vm._l(_vm.Colors,(function(colors,index){return _c("el-col",{key:index,staticClass:"dialogcolorpalette mB10",attrs:{span:12}},[_vm.loading?_c("div",{staticClass:"color-palette-loading-con mB10"},[_c("div",{staticClass:"fc-animated-background width100px height20"}),_c("div",{staticClass:"width100 height20 mT10 fc-animated-background"})]):_c("div",[_c("div",{staticClass:"fc-input-label-txt f13 flex-middle position-relative"},[_vm._v(" "+_vm._s(_vm.formaterIndex(index))+" "),_vm.chosenColors===index?_c("div",{staticClass:"selected-icon-color position-absolute"},[_c("InlineSvg",{staticClass:"vertical-middle",attrs:{src:"svgs/check-icon",iconClass:"icon icon-xs mL10"}})],1):_vm._e()]),_c("div",{staticClass:"colorPalette position-relative",on:{click:function($event){return _vm.changeColor(index)}}},_vm._l(colors,(function(color,idx){return _c("div",{key:idx,staticClass:"colorBlock",style:{background:color}})})),0)])])})),1)],1)])],1)},staticRenderFns=[function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"flex-middle"},[_c("p",{staticClass:"label-txt-black pT20 line-height20 mB10"},[_vm._v("Color Palette")])])}],InlineSvg=__webpack_require__(586166),FColorPalettesvue_type_script_lang_js={props:["colorIndex"],data:function(){return{Colors:{1:["#1d7f01","#6cb302","#e9f501","#fda504","#fb5905"],2:["#93d5ed","#45a5f5","#4285f4","#2f5ec4","#073a93"],3:["#04b9bd","#007e80","#004852","#f63700","#fb6900"],4:["#ffaf00","#ff7300","#ff0057","#500083","#0b0411"],5:["#b0f400","#74c700","#00696d","#002e5b","#2e004d"],6:["#00fff1","#00c0d0","#4c60a6","#4d177c","#4a0052"],7:["#00effc","#00b9e7","#357ac9","#793fad","#980084"],8:["#c5ff00","#fef800","#00daff","#0050ff","#1700ff"],9:["#39678a","#27916e","#becd70","#d7e1b2","#9db4a4"],10:["#eeebff","#c0b8dd","#9184ba","#635198","#341e75"],11:["#e1f6de","#a9d0b2","#71a986","#38835a","#005c2e"],12:["#ffed95","#f0b277","#e0775a","#d13b3c","#c1001e"],13:["#eaf9a8","#b1c5a0","#779299","#3d5e91","#042a89"],14:["#ffc300","#eead09","#de9812","#cd821b","#bc6c24"],15:["#c5dcfb","#6fe8f2","#ecf365","#f89c3e","#f82422"]},chosenColors:1,showColorPalette:!1,loading:!0,updateTimeout:null}},mounted:function(){this.Colors[this.colorIndex]&&(this.chosenColors=this.colorIndex)},watch:{colorIndex:{handler:function(){this.chosenColors!==this.colorIndex&&(this.chosenColors=this.colorIndex,this.$emit("colorSelected",this.chosenColors,this.Colors[this.chosenColors]))}}},components:{InlineSvg:InlineSvg/* default */.Z},methods:{openDialog:function(){var _this=this;this.showColorPalette=!0,this.loading=!0,this.updateTimeout&&clearTimeout(this.updateTimeout),this.updateTimeout=setTimeout((function(){_this.loading=!1}),500)},changeColor:function(index){this.chosenColors=index,this.showColorPalette=!1,this.$emit("colorSelected",this.chosenColors,this.Colors[this.chosenColors])},formaterIndex:function(index){return"1"===index?"Default":"Palette "+index}}},components_FColorPalettesvue_type_script_lang_js=FColorPalettesvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FColorPalettesvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FColorPalettes=component.exports},
/***/766325:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return ScatterAnalytics}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/energy/analytics/newTools/ScatterAnalytics.vue?vue&type=template&id=6acc5f56
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{key:_vm.$route.path,staticClass:"fc-energy-building-analysis"},[_c("div",{staticClass:"report-scatter-main-con"},[_c("div",{},[_c("f-report-options",{staticClass:"analytics-page-options-building-analysis fc-v1-portfolio-anlaysis",attrs:{isActionsDisabled:_vm.isActionsDisabled,optionClass:"analytics-page-options",optionsToEnable:[5,1,2],reportObject:_vm.reportObject,resultObject:_vm.resultObject,params:_vm.reportObject?_vm.reportObject.params:null,savedReport:_vm.analyticsConfig.savedReport,pdf:!1},on:{"update:savedReport":function($event){return _vm.$set(_vm.analyticsConfig,"savedReport",$event)},"update:saved-report":function($event){return _vm.$set(_vm.analyticsConfig,"savedReport",$event)}}})],1),_c("div",{staticClass:"report-sidebar-con"},[_vm.hideSideBar||_vm.showChartCustomization?_vm._e():_c("div",{class:{"new-report-sidebar fc-new-report-sidebar col-3 pT0":!_vm.hideSideBar&&!_vm.showChartCustomization}},[_c("div",{staticClass:"report-sidebar-inner"},[_c("div",{staticClass:"analytics-body p20 clearboth"},[_c("el-row",{staticClass:"pT20"},[_c("div",{staticClass:"label-txt-grey pB5"},[_vm._v(" "+_vm._s(_vm.$t("common._common.mode"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border2 width100",on:{change:_vm.onTypeChange},model:{value:_vm.scatterType,callback:function($$v){_vm.scatterType=$$v},expression:"scatterType"}},[_c("el-option",{key:1,attrs:{label:"Category",value:1}}),_c("el-option",{key:2,attrs:{label:"Single",value:2}}),_c("el-option",{key:3,attrs:{label:"Multiple",value:3}})],1)],1),_c("div",{directives:[{name:"show",rawName:"v-show",value:1===_vm.scatterType,expression:"scatterType === 1"}]},[_c("el-row",{staticClass:"pT20"},[_c("div",{staticClass:"label-txt-grey pB5"},[_vm._v(" "+_vm._s(_vm.$t("common._common.category"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border2 width100",attrs:{filterable:"",loading:_vm.categoriesLoading},on:{change:function($event){_vm.flushAssetDetails(),_vm.loadReadings()}},model:{value:_vm.selectedAssetCategory,callback:function($$v){_vm.selectedAssetCategory=$$v},expression:"selectedAssetCategory"}},_vm._l(_vm.assetCategoryList,(function(category,idx){return _c("el-option",{key:idx,attrs:{label:category.displayName,value:category.id}})})),1)],1),_c("el-row",{staticClass:"pT20"},[_c("div",{staticClass:"label-txt-grey pB5"},[_vm._v(" "+_vm._s(_vm.$t("common._common.x_axis"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border2 width100",attrs:{filterable:"",loading:_vm.readingsLoading},on:{change:function($event){return _vm.populateDataPoints()}},model:{value:_vm.selectedxField,callback:function($$v){_vm.selectedxField=$$v},expression:"selectedxField"}},_vm._l(_vm.readings,(function(reading,idx){return _c("el-option",{key:idx,attrs:{label:reading.displayName,value:reading.fieldId}})})),1)],1),_c("el-row",{staticClass:"pT20"},[_c("div",{staticClass:"label-txt-grey pB5"},[_vm._v(" "+_vm._s(_vm.$t("common._common.y_axis"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border2 width100",attrs:{filterable:"",loading:_vm.readingsLoading},on:{change:function($event){return _vm.populateDataPoints()}},model:{value:_vm.selectedyField,callback:function($$v){_vm.selectedyField=$$v},expression:"selectedyField"}},_vm._l(_vm.readings,(function(reading,idx){return _c("el-option",{key:idx,attrs:{label:reading.displayName,value:reading.fieldId}})})),1)],1),_c("el-row",{staticClass:"pT20"},[_c("div",{staticClass:"label-txt-grey pB5"},[_vm._v(" "+_vm._s(_vm.$t("common.products.assets"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width100 fc-tag",attrs:{disabled:!(_vm.selectedxField&&_vm.selectedyField),filterable:"",multiple:"",loading:_vm.assetsLoading},on:{change:function($event){return _vm.populateDataPoints()}},model:{value:_vm.selectedAsset,callback:function($$v){_vm.selectedAsset=$$v},expression:"selectedAsset"}},_vm._l(_vm.selectedAssets,(function(asset,idx){return _c("el-option",{key:idx,attrs:{label:asset.name,value:asset.id}})})),1)],1)],1),_c("div",{directives:[{name:"show",rawName:"v-show",value:2===_vm.scatterType,expression:"scatterType === 2"}]}),_c("div",{directives:[{name:"show",rawName:"v-show",value:3===_vm.scatterType,expression:"scatterType === 3"}]},[_c("FScatterPointSelector",{attrs:{visibility:"true",enableFloatimngIcon:_vm.enableFloatimngIcon,analyticsConfig:_vm.analyticsConfig},on:{resetState:_vm.resetState,"update:enableFloatimngIcon":function($event){_vm.enableFloatimngIcon=$event},"update:enable-floatimng-icon":function($event){_vm.enableFloatimngIcon=$event},updateDataPoints:_vm.applyscatter,"update:analyticsConfig":function($event){_vm.analyticsConfig=$event},"update:analytics-config":function($event){_vm.analyticsConfig=$event}}})],1)],1)])]),_vm.hideSideBar||_vm.showChartCustomization?_vm._e():_c("div",{staticClass:"scatter-options-block"},[_c("div",{},[_c("div",{staticClass:"text-center scatter-report-icon-bg",on:{click:function($event){return _vm.toggleSideBar()}}},[_c("InlineSvg",{attrs:{src:"arrow-pointing-to-left2",iconClass:"icon icon-sm vertical-middle"}})],1)])]),_vm.hideSideBar&&!_vm.showChartCustomization?_c("div",{staticClass:"scatter-options-block",style:{left:_vm.cssLeft}},[_c("div",{},[_c("div",{staticClass:"text-center scatter-report-icon-bg",on:{click:function($event){return _vm.toggleSideBar()}}},[_c("InlineSvg",{staticStyle:{transform:"rotate(180deg)",top:"2px"},attrs:{src:"arrow-pointing-to-left2",iconClass:"icon icon-sm vertical-middle"}})],1)])]):_vm._e(),_c("div",{staticClass:"report-graph-con position-relative",class:{"new-report-graph-con":!_vm.hideSideBar||_vm.showChartCustomization,"new-report-graph-con-stretch":_vm.hideSideBar&&!_vm.showChartCustomization,"scatter-graph-con":!_vm.hideSideBar||_vm.showChartCustomization,"scatter-graph-con-stretch":_vm.hideSideBar&&!_vm.showChartCustomization},staticStyle:{height:"calc(100vh - 100px)","overflow-y":"scroll","padding-bottom":"100px"}},[_c("div",{ref:"chartSection",class:["self-center fchart-section building-graph-container",{"prediction-timings-container":_vm.analyticsConfig.predictionTimings&&_vm.analyticsConfig.predictionTimings.length>1}]},[_vm.analyticsConfig.dataPoints.length?_c("div",[_c("scatter-analytics-report",{ref:"newAnalyticReport",attrs:{config:_vm.analyticsConfig,scatterType:_vm.scatterType,showFilterBar:!1,baseLines:_vm.baseLineList,showTimePeriod:1===_vm.analyticsConfig.mode,showChartMode:!0},on:{"update:config":function($event){_vm.analyticsConfig=$event},reportLoaded:_vm.reportLoaded},scopedSlots:_vm._u([{key:"chartCustomization",fn:function(){return[_c("div",{on:{click:function($event){_vm.showChartCustomization=!_vm.showChartCustomization}}},[_c("InlineSvg",{staticClass:"vertical-middle fc-icon-border mL10 mR10 pointer",attrs:{src:"svgs/chart-options",iconClass:"icon icon-sm-md"}})],1)]},proxy:!0},{key:"Algorithm",fn:function(){return[_c("el-button",{staticClass:"fc-btn-grey-border mR10 f12",on:{click:function($event){return _vm.enableTrendline()}}},[_vm._v(" "+_vm._s(_vm.$t("common.products.algorithm"))+" ")])]},proxy:!0}])})],1):_c("div",{staticClass:"text-center"},[(_vm.reportId||_vm.alarmId||_vm.cardId)&&_vm.spinnerToggle?_c("div",{staticClass:"p15"},[_c("spinner",{attrs:{show:_vm.spinnerToggle}})],1):_c("div",{staticClass:"p15 flex-middle height80vh justify-content-center flex-direction-column"},[_c("div",[_c("inline-svg",{attrs:{src:"svgs/emptystate/reportlist",iconClass:"icon text-center icon-xxxxlg"}})],1),_c("div",{staticClass:"nowo-label"},[_vm._v(" "+_vm._s(_vm.$t("common._common.please_select_data_points_analyze"))+" ")])])])])]),_c("div",{directives:[{name:"show",rawName:"v-show",value:_vm.showChartCustomization,expression:"showChartCustomization"}],class:{"new-chart-custom fc-new-portfolio-chart-custom":_vm.showChartCustomization}},[_vm.reportObject?_c("div",{directives:[{name:"show",rawName:"v-show",value:_vm.showChartCustomization,expression:"showChartCustomization"}],staticClass:"scatter-customize-container building-customize-container col-3 fc-new-portfolio-cus",staticStyle:{top:"0px"}},[_c("div",{staticClass:"customize-body fc-customize-body"},[_vm.reportObject?_c("f-chart-customization",{directives:[{name:"show",rawName:"v-show",value:_vm.showChartCustomization,expression:"showChartCustomization"}],attrs:{report:_vm.reportObject,resultDataPoints:_vm.resultObject?_vm.resultObject.report.dataPoints:[],config:_vm.analyticsConfig,optionsToEnable:[2,3,4,6],hideFooter:!0}}):_vm._e()],1)]):_vm._e()])])]),_vm.showTrendLine?_c("trend-line",{attrs:{visibility:_vm.showTrendLine,report:_vm.reportObject},on:{"update:visibility":function($event){_vm.showTrendLine=$event},onTrendLineChange:_vm.onTrendLineChange}}):_vm._e()],1)},staticRenderFns=[],toConsumableArray=__webpack_require__(488478),objectSpread2=__webpack_require__(595082),createForOfIteratorHelper=__webpack_require__(566347),AnalyticsMixin=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(538077),__webpack_require__(169358),__webpack_require__(670560),__webpack_require__(434284),__webpack_require__(976801),__webpack_require__(648324),__webpack_require__(450886),__webpack_require__(634338),__webpack_require__(843843),__webpack_require__(947522),__webpack_require__(339772),__webpack_require__(244936)),ScatterAnalyticsReportvue_type_template_id_4ff290d1_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("div",{staticClass:"white-bg-block mB10 width100 height550 fc-scatter-con"},[_c("div",{staticClass:"analytics-section mT20 mR20"},[_c("div",{staticClass:"fc-report-widget-header p0 pT10"},[_c("div",{staticClass:"new-analytics-filter-section flex-middle",style:_vm.config.scatterConfig?"height:50px;width: -webkit-fill-available;":"text-align: center;"},[_vm.config.hidedatepicker?_vm._e():_c("new-date-picker",{key:_vm.componentkey,ref:"newDatePicker",staticClass:"filter-field date-filter-comp inline fc-scatter-date-picker",style:_vm.config&&2===_vm.config.analyticsType?_vm.config.scatterConfig?"left:0;float:left;":"margin-left:120px;":"",attrs:{zone:_vm.$timezone,dateObj:_vm.config.dateFilter,isDateFixed:_vm.config.applyReportDate},on:{"update:dateObj":function($event){return _vm.$set(_vm.config,"dateFilter",$event)},"update:date-obj":function($event){return _vm.$set(_vm.config,"dateFilter",$event)},date:_vm.setDateFilter}}),this.reportObj&&this.reportObj.options&&!0===this.reportObj.options.settings.timeperiod&&[1,4].includes(_vm.config.mode)?_c("div",{staticClass:"chart-icon pointer flRight pB8 el-popover__reference",style:_vm.config.scatterConfig?"float:left;":"margin-right: 120px;"},[_c("el-select",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"period-select fc-input-full-border2 ",class:{width20:!_vm.config.scatterConfig},attrs:{placeholder:"Period",title:"Time period","data-arrow":"true"},on:{change:_vm.onPeriodChange},model:{value:_vm.config.period,callback:function($$v){_vm.$set(_vm.config,"period",$$v)},expression:"config.period"}},_vm._l(_vm.getAvailablePeriods,(function(period,index){return _c("el-option",{key:index,attrs:{label:period.name,value:period.value,disabled:!period.enable}})})),1)],1):_vm._e(),_vm.resultObj&&_vm.resultObj.report&&0!==_vm.resultObj.report.dataPoints.length&&!_vm.isRegression?_c("span"):_vm._e()],1),_c("div",{staticClass:"flex-middle"},[_c("div",[_vm._t("Algorithm")],2),_vm.config&&0===_vm.config.period?_c("div",{on:{click:_vm.openReportFilterDialog}},[_c("InlineSvg",{staticClass:"vertical-middle fc-icon-border pointer",attrs:{src:"svgs/filter",iconClass:"icon icon-sm-md"}})],1):_vm._e(),_c("div",{on:{click:_vm.openChartOptions}},[_c("InlineSvg",{staticClass:"vertical-middle fc-icon-border mL10 pointer",attrs:{src:"svgs/chart-options",iconClass:"icon icon-sm-md"}})],1),_c("div",[_vm._t("chartCustomization")],2)])]),!_vm.$mobile&&_vm.predictive&&_vm.config.predictionTimings&&_vm.config.predictionTimings.length?_c("prediction-timings-bar",{staticClass:" prediction-timing-bar",attrs:{reportObj:_vm.reportObj,config:_vm.config}}):_vm._e(),_vm.loading?_c("spinner",{staticClass:"analytics-spinner",attrs:{show:_vm.loading,size:"80"}}):_vm.failed?_c("div",{staticStyle:{"margin-top":"30px",opacity:"0.7","font-size":"13px",padding:"50px","line-height":"25px","text-align":"center"}},[_c("div",[_vm._v(_vm._s(_vm.$t("home.dashboard.data_loading_failed")))])]):_vm.reportObj.data?_c("div",[_vm.config.hidechart?_vm._e():_c("div",[_vm.$route.meta&&_vm.$route.meta.layout&&"mobile"===_vm.$route.meta.layout&&"multi"===_vm.reportObj.options.settings.chartMode?_c("f-mobile-multi-chart",{ref:"multiChart",attrs:{isWidget:!!_vm.config,width:_vm.config&&_vm.config.width?_vm.config.width:null,resultObj:_vm.resultObj,height:_vm.config&&_vm.config.height?_vm.config.height:null,data:_vm.reportObj.data,options:_vm.reportObj.options,alarms:_vm.reportObj.alarms,dateRange:_vm.reportObj.dateRange,hidecharttypechanger:_vm.config&&_vm.config.widget,booleanData:_vm.reportObj.booleanData}}):_vm._e(),_vm.$route.meta&&_vm.$route.meta.layout&&"mobile"===_vm.$route.meta.layout&&"multi"===_vm.reportObj.options.settings.chartMode?_c("div",{staticClass:"empty-multi-chart"},[_vm._v(" Currently this chart not supported in the mobile ")]):_c("div",[_vm.$route.meta&&_vm.$route.meta.layout&&"mobile"===_vm.$route.meta.layout?_c("f-mobile-chart",{ref:"newChart",staticClass:"mobile-chart fc-scatter-analytics-legends",attrs:{data:_vm.reportObj.data,options:_vm.reportObj.options,dateRange:_vm.reportObj.dateRange,resultObj:_vm.resultObj}}):_vm._e()],1),3!==_vm.scatterType||_vm.$route.meta&&_vm.$route.meta.layout&&"mobile"===_vm.$route.meta.layout?_vm._e():_c("f-multi-chart",{ref:"multiChart",attrs:{reportObj:_vm.reportObj,data:_vm.reportObj.data,options:_vm.reportObj?_vm.reportObj.options:null,alarms:_vm.reportObj.alarms,booleanData:_vm.reportObj.booleanData,dateRange:_vm.reportObj.dateRange,resultObj:_vm.resultObj,hidecharttypechanger:_vm.config.hidecharttypechanger||_vm.isRegression,config:_vm.config}}),_vm.isHeatMap||_vm.isTreeMap||3===_vm.scatterType?_vm._e():_c("f-new-chart",{ref:"newChart",attrs:{hidecharttypechanger:_vm.config.hidecharttypechanger||_vm.isRegression,resultObj:_vm.resultObj,reportObj:_vm.reportObj,options:_vm.reportObj?_vm.reportObj.options:null,fixedChartHeight:_vm.config.fixedChartHeight,config:_vm.config},on:{chartgenerate:_vm.chartgenerate}}),_vm.isHeatMap?_c("FNewHeatMap",{ref:"heatmap",attrs:{config:_vm.config,width:_vm.chartDimensions&&_vm.chartDimensions.width?_vm.chartDimensions.width:null,height:_vm.chartDimensions&&_vm.chartDimensions.height?_vm.chartDimensions.height:null,resultObject:_vm.resultObj,reportObject:_vm.reportObj}}):_vm._e(),_vm.isTreeMap?_c("FTreeMap",{ref:"treemap",attrs:{config:_vm.config,width:_vm.chartDimensions&&_vm.chartDimensions.width?_vm.chartDimensions.width:null,height:_vm.chartDimensions&&_vm.chartDimensions.height?_vm.chartDimensions.height:null,resultObject:_vm.resultObj,reportObject:_vm.reportObj}}):_vm._e()],1)]):_c("div",{staticStyle:{"margin-top":"30px","font-size":"13px",padding:"50px","line-height":"25px","text-align":"center"}},[_c("inline-svg",{attrs:{src:"svgs/emptystate/reportlist",iconClass:"icon text-center icon-100"}}),_c("div",{staticClass:"nowo-label f13"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.empty_data"))+" "),_vm.resultObj&&_vm.resultObj.dateRange?_c("span",{staticClass:"bold"},[_vm._v(_vm._s(_vm._f("formatPeriod")(_vm.resultObj.dateRange.value,"MMM DD, YYYY")))]):_vm._e()])],1)],1)]),_c("div",{staticClass:"white-bg-block mL20 mR20 mB10 width100"},[_c("div",{staticClass:"analytics-section mT20 mR20 fc-scatter-collapse"},[_c("el-collapse",{staticClass:"fc-pushing-data-collapse fc-collapse-arrow-bg fc-analytics-collapse fc-scatter-collapse"},[_c("el-collapse-item",{attrs:{title:"Reading Trends",name:"1"}},[_c("div",[_vm.loading?_c("spinner",{staticClass:"analytics-spinner",attrs:{show:_vm.loading,size:"80"}}):_vm.failed?_c("div",{staticStyle:{"margin-top":"30px",opacity:"0.7","font-size":"13px",padding:"50px","line-height":"25px","text-align":"center"}},[_c("div",[_vm._v(_vm._s(_vm.$t("home.dashboard.data_loading_failed")))])]):_vm.reportObj.data?_c("div",[_vm.config.hidechart?_vm._e():_c("div",[_vm.trendreportObj&&_vm.config.scatterConfig?_c("f-multi-chart",{ref:"multiChart",attrs:{reportObj:_vm.trendreportObj,data:_vm.trendreportObj.data,options:_vm.trendreportObj?_vm.trendreportObj.options:null,alarms:_vm.trendreportObj.alarms,booleanData:_vm.trendreportObj.booleanData,dateRange:_vm.trendreportObj.dateRange,resultObj:_vm.trendresultObj,config:_vm.config}}):_vm._e()],1)]):_c("div",{staticStyle:{"margin-top":"30px","font-size":"13px",padding:"50px","line-height":"25px","text-align":"center"}},[_c("inline-svg",{attrs:{src:"svgs/emptystate/reportlist",iconClass:"icon text-center icon-100"}}),_c("div",{staticClass:"nowo-label f13"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.empty_data"))+" "),_vm.resultObj&&_vm.resultObj.dateRange?_c("span",{staticClass:"bold"},[_vm._v(_vm._s(_vm._f("formatPeriod")(_vm.resultObj.dateRange.value,"MMM DD, YYYY")))]):_vm._e()])],1)],1)])],1)],1)]),_c("div",{staticClass:"white-bg-block mL20 mR20 mB10 width100"},[_c("div",{staticClass:"analytics-section mT20 mR20"},[_c("el-collapse",{staticClass:"fc-pushing-data-collapse fc-collapse-arrow-bg fc-analytics-collapse fc-scatter-collapse"},[_c("el-collapse-item",{attrs:{title:"Undelying Data",name:"1"}},[_vm.loading?_vm._e():_c("div",[_vm.config.hidetabular?_vm._e():_c("f-tabular-report",{ref:"newTable",staticClass:"new-analytics-table mL30 mR30 fc-scatter-con-tabular",class:{"regression-table-fit":_vm.isRegression},attrs:{reportObject:_vm.resultObj,reportConfig:_vm.reportObj,widget:!0,showWidgetTable:!0}})],1)])],1)],1)]),_vm.showReportFilter?_c("report-filter",{attrs:{visibility:_vm.showReportFilter,config:_vm.config.reportFilter,existingOptions:_vm.existingOptions},on:{"update:visibility":function($event){_vm.showReportFilter=$event},reportFilter:_vm.setReportFilter}}):_vm._e(),_vm.showScatterChartOptions?_c("scatter-chart-options",{attrs:{visibility:_vm.showScatterChartOptions,report:_vm.reportObj},on:{"update:visibility":function($event){_vm.showScatterChartOptions=$event},"update:report":function($event){_vm.reportObj=$event}}}):_vm._e()],1)},ScatterAnalyticsReportvue_type_template_id_4ff290d1_staticRenderFns=[],NewDatePicker=(__webpack_require__(228436),__webpack_require__(506203),__webpack_require__(689730),__webpack_require__(162506),__webpack_require__(903650),__webpack_require__(900773)),FNewChartOptimize=__webpack_require__(678873),FMobileChart=__webpack_require__(242208),FMultiChart=__webpack_require__(649206),NewDataFormatHelper=__webpack_require__(804911),FTabularReportNew=__webpack_require__(979),FMobileMultiChart=__webpack_require__(696593),PredictionTimingsBar=__webpack_require__(107387),NewDateHelper=__webpack_require__(105534),FNewHeatMap=__webpack_require__(283938),FTreeMap=__webpack_require__(650976),NewReportSummaryHelper=__webpack_require__(601458),ReportFilter=__webpack_require__(587365),deepmerge=__webpack_require__(708634),ScatterChartOptions=__webpack_require__(248138),ScatterAnalyticsReportvue_type_script_lang_js={props:["config","baseLines","readings","showChartMode","showTimePeriod","showFilterBar","noChartState","heatMapOptions","chartDimensions","scatterType"],mixins:[NewDataFormatHelper/* default */.Z,AnalyticsMixin/* default */.Z,NewDateHelper/* default */.Z,NewReportSummaryHelper/* default */.Z],components:{NewDatePicker:NewDatePicker/* default */.Z,FNewChart:FNewChartOptimize/* default */.Z,FMultiChart:FMultiChart/* default */.Z,FTabularReport:FTabularReportNew/* default */.Z,FMobileChart:FMobileChart/* default */.Z,FMobileMultiChart:FMobileMultiChart/* default */.Z,PredictionTimingsBar:PredictionTimingsBar/* default */.Z,FNewHeatMap:FNewHeatMap/* default */.Z,FTreeMap:FTreeMap/* default */.Z,ReportFilter:ReportFilter/* default */.Z,ScatterChartOptions:ScatterChartOptions/* default */.Z},data:function(){return{loading:!0,predictive:!0,failed:!1,reportObj:null,resultObj:null,showRangeChartDialog:!1,chartgenerated:!1,showTemplateFilter:!1,componentkey:0,FirstDateFromPicker:!1,appliedDateFilter:null,trendLineDataPoints:null,showReportFilter:!1,hasReportFilter:!1,existingOptions:[],trendresultObj:null,trendreportObj:null,showScatterChartOptions:!1}},mounted:function(){this.init()},computed:{isHeatMap:function(){return!(!this.$route||!this.$route.meta||"heatmap"!==this.$route.meta.analyticsType)},isTreeMap:function(){return!(!this.$route||!this.$route.meta||"treemap"!==this.$route.meta.analyticsType)},getAvailablePeriods:function(){var operationOnId=this.config.dateFilter.operationOnId,avail=[];return avail.push({name:"High-res",value:0,enable:6===operationOnId||4!==operationOnId}),avail.push({name:"Hourly",value:20,enable:6===operationOnId||4!==operationOnId}),avail.push({name:"Daily",value:12,enable:!0}),avail.push({name:"Weekly",value:11,enable:!0}),avail.push({name:"Monthly",value:10,enable:!0}),avail.push({name:"Quarterly",value:25,enable:4===operationOnId||5===operationOnId}),avail.push({name:"Yearly",value:8,enable:4===operationOnId}),avail.push({name:"Hour of day",
// 12, 1, 2, 3
value:19,enable:!0}),avail.push({name:"Day of week",
// sun, mon
value:17,enable:!0}),avail.push({name:"Day of month",
// 1,2,3
value:18,enable:!0}),avail},isRegression:function(){return!!this.$route.path.includes("regression")}},created:function(){this.$store.dispatch("loadAssetCategory"),this.$store.dispatch("loadAlarmSeverity")},watch:{config:{handler:function(newData,oldData){this.config.applyReportDate||(!this.config.mode||"reading"!==this.config.mode&&11!==this.config.mode||null!==this.config.dimensionDataPoint)&&this.init(!1)},deep:!0},heatMapOptions:{handler:function(newData,oldData){this.$refs["heatmap"]&&this.$refs["heatmap"].rerender(),this.$refs["treemap"]&&this.$refs["treemap"].rerender()},deep:!0},chartDimensions:{handler:function(newData,oldData){this.$refs["heatmap"]&&this.$refs["heatmap"].resize(),this.$refs["treemap"]&&this.$refs["treemap"].resize()},deep:!0},getAvailablePeriods:{handler:function(newData,oldData){var _this=this;if(3!==this.config.analyticsType){var avail=this.getAvailablePeriods,selected=avail.find((function(a){return a.value===_this.config.period&&a.enable}));if(!selected){var filterName=this.config.dateFilter.operationOn,defaultPeriod=avail.filter((function(a){return a.enable}))[0].value;"week"===filterName||"month"===filterName?defaultPeriod=12:"year"===filterName&&(defaultPeriod=10),this.config.period=defaultPeriod}}},immediate:!0}},methods:{forceRerender:function(){this.$refs["newDatePicker"]&&!this.FirstDateFromPicker?this.componentkey=this.componentkey+1:this.setDateFilter(this.appliedDateFilter)},changeParentForTemplate:function(){this.config.template&&(this.config.template.parentId=this.resultObj.report.currentTemplate.parentId)},onPeriodChange:function(){if(!this.config.dataPoints.length){var filter="D";20===this.config.period?filter="W":12===this.config.period?filter="M":10===this.config.period&&(filter="Y"),this.config.dateFilter=this.getDefaultDateFilter(filter)}},chartgenerate:function(value){var _this2=this;setTimeout((function(){return _this2.chartgenerated=value}),10)},addRangePoints:function(val,remainingDataPoints){var _step,ranges=["min","max","avg"],dataPoints=[],_iterator=(0,createForOfIteratorHelper/* default */.Z)(val);try{for(_iterator.s();!(_step=_iterator.n()).done;){var rangeConfig=_step.value;for(var key in rangeConfig){var config={};ranges.includes(key)&&(config["parentId"]=rangeConfig[key].parentId,config["prediction"]=!1,config["aliases"]={actual:rangeConfig[key].alias},config["yAxis"]={aggr:rangeConfig[key].aggr,fieldId:rangeConfig[key].fieldId},dataPoints.push(config))}}}catch(err){_iterator.e(err)}finally{_iterator.f()}var _step2,_iterator2=(0,createForOfIteratorHelper/* default */.Z)(remainingDataPoints);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var dataPoint=_step2.value,_config={};_config["parentId"]=dataPoint.metaData.parentIds[0],_config["prediction"]=!1,_config["aliases"]={actual:dataPoint.aliases.actual},_config["yAxis"]={aggr:dataPoint.yAxis.aggr,fieldId:dataPoint.yAxis.fieldId},dataPoints.push(_config)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}var analyticConfig=this.$helpers.cloneObject(this.config);analyticConfig.dataPoints=dataPoints,analyticConfig.period="undefined"!==typeof this.config.period&&null!==this.config.period?0===this.config.period?this.getXAggr():this.config.period:0,this.$emit("update:config",analyticConfig)},setDateFilter:function(dateFilter){this.FirstDateFromPicker=!0,this.appliedDateFilter=dateFilter,this.$set(this.config,"dateFilter",dateFilter)},init:function(){this.$store.dispatch("loadAlarmSeverity"),this.config.dataPoints.length>0&&this.initChart()},resize:function(){this.$refs["newChart"]&&3!==this.scatterType&&this.$refs["newChart"].resize(),this.$refs["multiChart"]&&this.$refs["multiChart"].resize(),this.$refs["heatmap"]&&this.$refs["heatmap"].resize(),this.$refs["treemap"]&&this.$refs["treemap"].resize(),this.$refs["newTable"]&&this.$refs["newTable"].resize()},getReportParams:function(){var baselines,baselineNames,_this3=this;if(this.config.baseLine&&Array.isArray(this.config.baseLine)&&this.config.baseLine.length){if(this.config.baseLine[0]>0){var bl={};bl.baseLineId=this.config.baseLine[0],this.config.baseLine.length>1&&(bl.adjustType=this.config.baseLine[1]);var blList=[];blList.push(bl),baselines=blList}}else this.config.baseLine&&this.config.baseLine>0&&(baselines=[{baseLineId:this.config.baseLine}]);baselines&&this.baseLines&&(baselineNames=[],baselines.forEach((function(baseline){var baseLineName=_this3.baseLines.find((function(bl){return bl.id===baseline.baseLineId})).name;baselineNames.push(baseLineName)})));var fields=[];if(3===this.config.mode){var _step3,parentId=[],fieldId=null,yAggr=3,_iterator3=(0,createForOfIteratorHelper/* default */.Z)(this.config.dataPoints);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var dp=_step3.value;parentId.push(dp.parentId),fieldId=dp.yAxis.fieldId,yAggr=this.getYAggr(dp)}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}fields.push({parentId:parentId,yAxis:{fieldId:fieldId,aggr:0!==this.config.period&&0===yAggr?3:yAggr},type:1,aliases:{actual:"A"}}),this.setAlias(fields,baselineNames)}else{this.setAlias(this.config.dataPoints,baselineNames);var _step4,_iterator4=(0,createForOfIteratorHelper/* default */.Z)(this.config.dataPoints);try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var _dp=_step4.value,metaData={};_dp.categoryId&&(metaData.categoryId=_dp.categoryId),_dp.yAxis.aggr=this.getYAggr(_dp);var _params={};if(_params=this.config.template?{parentId:_dp.parentId?Array.isArray(_dp.parentId)?_dp.parentId:[_dp.parentId]:null,buildingId:_dp.buildingId?_dp.buildingId:-1,moduleName:_dp.moduleName,metaData:metaData,yAxis:{fieldId:_dp.yAxis.fieldId,aggr:_dp.yAxis.aggr},aliases:_dp.aliases,type:_dp.type>0?_dp.type:1,predictedTime:_dp.predictedTime,duplicateDataPoint:_dp.duplicateDataPoint}:{parentId:_dp.parentId?Array.isArray(_dp.parentId)?_dp.parentId:[_dp.parentId]:null,name:_dp.name,buildingId:_dp.buildingId?_dp.buildingId:-1,moduleName:_dp.moduleName,metaData:metaData,yAxis:_dp.yAxis,aliases:_dp.aliases,type:_dp.type>0?_dp.type:1,predictedTime:_dp.predictedTime,duplicateDataPoint:_dp.duplicateDataPoint},null!==this.config.dimensionDataPoint&&11!==this.config.mode){var xdp=this.config.dataPoints[this.config.dimensionDataPoint];xdp&&xdp.yAxis.fieldId&&xdp.parentId?_dp.yAxis.fieldId===xdp.yAxis.fieldId&&xdp.parentId===_dp.parentId&&xdp.aliases.actual===_dp.aliases.actual&&(_params["xDataPoint"]=!0):xdp&&2===xdp.type&&xdp.aliases.actual===_dp.aliases.actual&&(_params["xDataPoint"]=!0)}_dp.xDataPoint&&(_params["xDataPoint"]=!0),fields.push(_params)}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}}if(this.config.sorting&&[6,7,8,9,10,"mv"].includes(this.config.mode)&&(this.config.sorting.orderByFunc||this.config.sorting.limit)){var sortByField=this.config.sorting.sortByField;if(sortByField){var _field=fields.find((function(f){return f.yAxis.fieldId===sortByField}));_field||(sortByField=null)}sortByField||(sortByField=fields[0].yAxis.fieldId,this.config.sorting.sortByField=fields[0].yAxis.fieldId);var field=null;sortByField?field=fields.find((function(f){return f.yAxis.fieldId===sortByField})):this.config.dataPoints.length<=1&&(field=fields[0]),field&&(field.defaultSortPoint=!0,this.config.sorting.orderByFunc&&(field.orderByFunc=this.config.sorting.orderByFunc),this.config.sorting.limit&&(field.limit=this.config.sorting.limit))}var trendLine=null;this.config.savedReport&&this.config.savedReport.chartState&&(trendLine=JSON.stringify(JSON.parse(this.config.savedReport.chartState).trendLine));var params={mode:"reading"===this.config.mode?1:["mv"].includes(this.config.mode)?8:this.config.mode,startTime:this.config.dateFilter.value[0],endTime:this.config.dateFilter.value[1],groupByTimeAggr:this.config.groupByTimeAggr,fields:JSON.stringify(fields),transformWorkflow:this.config.transformWorkflow,trendLine:trendLine};if(1==this.config.mode&&0==this.config.period&&("undefined"!==typeof this.config.reportFilter&&this.config.reportFilter.hasOwnProperty("timeFilter")&&(params.timeFilter=JSON.stringify(this.config.reportFilter.timeFilter)),"undefined"!==typeof this.config.reportFilter&&this.config.reportFilter.hasOwnProperty("dataFilter"))){var dConfig=this.config.reportFilter.dataFilter;for(var key in dConfig.conditions){var condition=dConfig.conditions[key];condition.currentAsset=this.$parent.filterToggle&&condition.parentId==this.config.dataPoints[0]["parentId"]}params.dataFilter=JSON.stringify(this.config.reportFilter.dataFilter)}if([6,7,9,10].includes(this.config.mode)||(params.xAggr=1===this.config.mode||3===this.config.mode||4===this.config.mode||5===this.config.mode?this.config.period:0),this.reportObj&&this.reportObj.options&&this.reportObj.options.settings?(params.showAlarms=this.reportObj.options.settings.alarm,params.showSafeLimit=this.reportObj.options.settings.safelimit):this.config.savedReport?(params.showAlarms=this.config.savedReport.showAlarms,params.showSafeLimit=this.config.savedReport.showSafeLimit):params.showSafeLimit=!0,baselines&&(params.baseLines=JSON.stringify(baselines)),this.config.filters&&![1,11,"reading"].includes(this.config.mode))if(this.config.filters.xCriteriaMode&&(["mv"].includes(this.config.mode)||this.config.mvPoints&&this.config.mvPoints.length>0))params.xCriteriaMode=5;else if(this.config.filters.xCriteriaMode)if(params.xCriteriaMode=this.config.filters.xCriteriaMode,this.config.filters.parentId&&this.config.filters.parentId.length)params.parentId=this.config.filters.parentId;else{var categoryId=this.config.filters.assetCategory;if(!categoryId||!categoryId.length){categoryId=[];var _step5,_iterator5=(0,createForOfIteratorHelper/* default */.Z)(this.config.dataPoints);try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var _dp2=_step5.value;-1===categoryId.indexOf(_dp2.categoryId)&&null!==_dp2.categoryId&&categoryId.push(_dp2.categoryId)}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}}categoryId.length&&(params.assetCategory=categoryId),this.config.filters.spaceId&&this.config.filters.spaceId.length&&(params.spaceId=this.config.filters.spaceId)}return this.$route.query&&this.$route.query.alarmId&&(params.alarmId=parseInt(this.$route.query.alarmId),params.showAlarms=!0),params},initChart:function(){var self=this;self.loading=!0,self.failed=!1;var Config=Object.assign({},this.config),apiURL=Config.api?Config.api:"/v2/report/readingReport",params=null;this.chartgenerated=!1,Config.alarmId&&(apiURL="/v2/report/fetchReadingsFromAlarm",params={alarmId:Config.alarmId,mode:1,xAggr:0,startTime:Config.dateFilter.value[0],endTime:Config.dateFilter.value[1],showAlarms:!0}),Config.readingRuleId&&(params.readingRuleId=Config.readingRuleId),Config.isWithPrerequsite&&(params.isWithPrerequsite=Config.isWithPrerequsite),params||(params=self.getReportParams()),Config.template&&Config.template.show&&(Config.template.parentId=null===Config.template.parentId?Config.dataPoints[0].parentId:Config.template.parentId,params.template=Config.template),Config.analyticsType?params.analyticsType=Config.analyticsType:params.analyticsType=-1,Config&&Config.format&&(params.hmAggr=Config.format),params.newFormat=!0,params.defaultDate=Config.defaultDate,this.reportObj&&this.reportObj.options&&this.reportObj.options.trendLine.enable&&this.reportObject.options.trendLine.selectedPoints.length&&(params.trendLine=JSON.stringify(this.reportObj.options.trendLine)),self.$http.post(apiURL,params).then((function(response){var result=response.data.result,reportObj=JSON.parse(JSON.stringify(self.reportObj));
// To remove object observer from reportObj
result.xAggr=params.xAggr?params.xAggr:null,result.mode=params.mode,self.config.defaultDate&&(self.config.defaultDate=!1,Config.dateFilter.operatorId=result.report.dateOperator,self.config.dateFilter=result.dateRange=NewDateHelper/* default */.Z.getDatePickerObject(Config.dateFilter.operatorId,result.report.dateValue),self.$nextTick((function(){self.$refs.newDatePicker.loadFromObject()}))),Config.analyticsType&&(result.report.analyticsType=Config.analyticsType),Config.filters&&(result.filters=Config.filters),Config.sorting&&(result.sorting=Config.sorting),Config.applyReportDate?(Config.dateFilter=result.dateRange=NewDateHelper/* default */.Z.getDatePickerObject(Config.dateFilter.operatorId,result.report.dateValue),self.$nextTick((function(){self.$refs.newDatePicker.loadFromObject()}))):result.dateRange=Config.dateFilter,self.trendresultObj=deepmerge/* default */.Z.objectAssignDeep({},result),reportObj&&!Config.alarmId?("undefined"!==typeof self.noChartState?!1===self.noChartState&&(result.report.chartState=reportObj.options):result.report.chartState=reportObj.options,result.report.tabularState=reportObj.params.tabularState):Config.savedReport&&("undefined"!==typeof self.noChartState?!1===self.noChartState&&(result.report.chartState=Config.savedReport.chartState):result.report.chartState=Config.savedReport.chartState,result.report.tabularState=Config.savedReport.tabularState),self.existingOptions=[];var _step6,_iterator6=(0,createForOfIteratorHelper/* default */.Z)(result.report.dataPoints);try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var dp=_step6.value;if(5!=dp.type&&2==Config.analyticsType){var existingOptionIds=self.existingOptions.map((function(option){return option.value})),assetId=dp.metaData&&dp.metaData.parentIds?dp.metaData.parentIds[0]:null;null==assetId||existingOptionIds.includes(assetId)||self.existingOptions.push({value:assetId,label:self.$parent.filterToggle?"Current Asset":dp.name.split(" (")[0]})}if(!0===dp.xDataPoint){result["Readingdp"]=dp;break}}}catch(err){_iterator6.e(err)}finally{_iterator6.f()}if(result.report.trendLineDataPoints&&(self.getTrendLineEquation(result),result.report.dataPoints=result.report.dataPoints.concat(result.report.trendLineDataPoints)),11===params.mode){var x=result.report.dataPoints[0].yAxis,y=result.report.dataPoints[0].xAxis;result.report.dataPoints[0].yAxis=y,result.report.dataPoints[0].xAxis=x}if(Config.scatterConfig&&(result.scatterConfig=Config.scatterConfig,self.prepareTrendReportObj(self.trendresultObj,params)),3===self.scatterType&&(result.scatterType="multi"),reportObj=self.prepareReport(result),2===Config.analyticsType&&1===Config.mode&&0===Config.period&&(self.hasReportFilter=Object.keys(self.config.reportFilter.timeFilter.conditions).length>0,self.hasReportFilter=Object.keys(self.config.reportFilter.dataFilter.conditions).length>0||self.hasReportFilter),Config.scatterConfig&&reportObj&&reportObj.options&&(reportObj.options.settings.timeperiod=!0),(self.isHeatMap||self.isTreeMap)&&(reportObj.options.heatMapOptions=self.heatMapOptions),Config.template){var currentTemplate=JSON.parse(JSON.stringify(Config.template)),filters=self.getFiltersFromCriteria(currentTemplate);self.loadReportTemplateValues(currentTemplate,filters).then((function(){currentTemplate.parentId=null===currentTemplate.parentId?currentTemplate.defaultValue:currentTemplate.parentId,self.$set(self.resultObj.report,"currentTemplate",currentTemplate),self.showTemplateFilter=!0}))}(Config.isFromAlarmSummary||self.$route.query&&self.$route.query.isFromAlarmSummary&&!self.resultObj)&&reportObj.booleanData&&(reportObj.options.dataPoints=self.groupNonBooleanPoints(reportObj.options.dataPoints)),(self.$route.query&&self.$route.query.alarmId||Config.alarmId)&&(reportObj.options.settings.alarm=!0),self.resultObj=result,reportObj.params=params,reportObj.alarms=self.prepareBooleanReport(result.reportData.aggr),(Config.alarmId||self.alarmId)&&(reportObj.alarms.barSize="medium"),Config.regionConfig&&(reportObj.options.regionConfig=Config.regionConfig),Config.hideDataPoints&&(reportObj.options.hideDataPoints=Config.hideDataPoints),Config.chartType&&(reportObj.options.chartType=Config.chartType),Config.diffChartConfig&&(reportObj.options.diffChartConfig=Config.diffChartConfig),Config.point&&(reportObj.options.point=Config.point),Config.zoom&&(reportObj.options.zoom=Config.zoom),Config.axes&&(reportObj.options.axes=Config.axes),reportObj.options.xFormat="MM-DD-YYYY",Config.xFormat&&(reportObj.options.xFormat=Config.xFormat),Config.axis&&Object.keys(Config.axis).forEach((function(rt){reportObj.options.axis[rt].label&&(reportObj.options.axis[rt].label.text=Config.axis[rt].label)})),reportObj.options.predictionTimings=Config.predictionTimings,"single"!==reportObj.options.settings.chartMode||3===self.scatterType||self.isHeatMap||self.isTreeMap||self.$route.meta&&self.$route.meta.layout&&"mobile"===self.$route.meta.layout||self.$nextTick((function(){self.$refs["newChart"]&&self.$refs["newChart"].render(reportObj)})),self.reportObj=reportObj,self.$emit("reportLoaded",reportObj,result),self.loading=!1})).catch((function(error){error&&(self.loading=!1,self.failed=!0)}))},onSettingsChange:function(changedOption){"alarm"===changedOption?this.reportObj.alarms&&this.reportObj.alarms.regions.length||!this.reportObj.options.settings.alarm||this.init():"safelimit"===changedOption?!this.reportObj.options.safeLimit.length&&this.reportObj.options.settings.safelimit&&this.init():"filter"===changedOption&&this.reportObj.options.settings.hasOwnProperty("filterBar")&&this.init()},getYAggr:function(dp){return dp.yAxis&&dp.yAxis.aggr&&[2,3,4,5].includes(dp.yAxis.aggr)?6===dp.yAxis.aggr?3:dp.yAxis.aggr:dp.yAxis&&dp.yAxis.unitStr&&["currency","kwh","co2","kg","mwh"].includes(dp.yAxis.unitStr.trim().toLowerCase())?3:2},getTrendLineEquation:function(result){var self=this,trendLineProp=result.reportData.trendLineProp,trendLineObj={};trendLineObj=this.config.savedReport&&this.config.savedReport.chartState?JSON.parse(this.config.savedReport.chartState).trendLine:self.reportObj.options.trendLine;var decimalCount=trendLineObj.decimal,_loop=function(alias){var coef=trendLineProp[alias].coef;coef.forEach((function(data,index){coef[index]=self.showDecimal(data,decimalCount)+(0!==index?"x^"+index:"")})),coef.reverse(),coef=coef.join(" + ");var dataPoint=result.report.trendLineDataPoints.filter((function(dataPoint){return dataPoint.aliases.actual===alias}));dataPoint[0].name=coef,trendLineObj.showr2&&(dataPoint[0].name="R^2 = "+self.showDecimal(trendLineProp[dataPoint[0].aliases.actual].rSquare,decimalCount)+"; "+dataPoint[0].name)};for(var alias in trendLineProp)_loop(alias)},showDecimal:function(data,decimalCount){var splitData=data.split(".");return splitData[1]?splitData[0]+"."+splitData[1].slice(0,decimalCount):data},showRSquareValue:function(){var trendPoints=this.$helpers.getDataPoints(this.reportObj.options.dataPoints,[3],!1),trendLineProp=this.resultObj.reportData.trendLineProp;this.reportObj.options.trendLine.showr2?trendPoints.filter((function(point){point.label="R^2 = "+trendLineProp[point.alias].rSquare+";"+point.label})):trendPoints.filter((function(point){point.label=point.label.split("; ").splice(1)[0]})),self.$refs["newChart"].render(this.reportObj)},openReportFilterDialog:function(){this.showReportFilter=!0},openChartOptions:function(){this.showScatterChartOptions=!0},setReportFilter:function(reportFilter){this.hasReportFilter=Object.keys(reportFilter.timeFilter.conditions).length>0,this.hasReportFilter=Object.keys(reportFilter.dataFilter.conditions).length>0||this.hasReportFilter,this.reportObj.options.settings.hasOwnProperty("filterBar")&&(this.reportObj.options.settings.filterBar=this.hasReportFilter&&!this.config.scatterConfig),this.$set(this.config,"reportFilter",reportFilter)},prepareTrendReportObj:function(result,params){var self=this,Config=JSON.parse(JSON.stringify(this.config)),reportObj=self.prepareReport(result);if(2===Config.analyticsType&&1===Config.mode&&0===Config.period&&(self.hasReportFilter=Object.keys(self.config.reportFilter.timeFilter.conditions).length>0,self.hasReportFilter=Object.keys(self.config.reportFilter.dataFilter.conditions).length>0||self.hasReportFilter),(self.isHeatMap||self.isTreeMap)&&(reportObj.options.heatMapOptions=self.heatMapOptions),Config.template){var currentTemplate=JSON.parse(JSON.stringify(Config.template)),filters=self.getFiltersFromCriteria(currentTemplate);self.loadReportTemplateValues(currentTemplate,filters).then((function(){currentTemplate.parentId=null===currentTemplate.parentId?currentTemplate.defaultValue:currentTemplate.parentId,self.$set(self.trendresultObj.report,"currentTemplate",currentTemplate),self.showTemplateFilter=!0}))}(Config.isFromAlarmSummary||self.$route.query&&self.$route.query.isFromAlarmSummary&&!self.trendresultObj)&&reportObj.booleanData&&(reportObj.options.dataPoints=self.groupNonBooleanPoints(reportObj.options.dataPoints)),(self.$route.query&&self.$route.query.alarmId||Config.alarmId)&&(reportObj.options.settings.alarm=!0),reportObj.params=params,reportObj.alarms=self.prepareBooleanReport(result.reportData.aggr),(Config.alarmId||self.alarmId)&&(reportObj.alarms.barSize="medium"),Config.regionConfig&&(reportObj.options.regionConfig=Config.regionConfig),Config.hideDataPoints&&(reportObj.options.hideDataPoints=Config.hideDataPoints),Config.chartType&&(reportObj.options.chartType=Config.chartType),Config.diffChartConfig&&(reportObj.options.diffChartConfig=Config.diffChartConfig),Config.point&&(reportObj.options.point=Config.point),Config.zoom&&(reportObj.options.zoom=Config.zoom),Config.axes&&(reportObj.options.axes=Config.axes),reportObj.options.xFormat="MM-DD-YYYY",Config.xFormat&&(reportObj.options.xFormat=Config.xFormat),Config.axis&&Object.keys(Config.axis).forEach((function(rt){reportObj.options.axis[rt].label&&(reportObj.options.axis[rt].label.text=Config.axis[rt].label)})),reportObj.options.predictionTimings=Config.predictionTimings,self.trendreportObj=reportObj}}},v1_ScatterAnalyticsReportvue_type_script_lang_js=ScatterAnalyticsReportvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(v1_ScatterAnalyticsReportvue_type_script_lang_js,ScatterAnalyticsReportvue_type_template_id_4ff290d1_render,ScatterAnalyticsReportvue_type_template_id_4ff290d1_staticRenderFns,!1,null,null,null)
/* harmony default export */,ScatterAnalyticsReport=component.exports,FScatterPointSelector=__webpack_require__(608998),NewFChartCustomization=__webpack_require__(280843),FReportOptions=__webpack_require__(791514),InlineSvg=__webpack_require__(586166),cloneDeep=__webpack_require__(150361),cloneDeep_default=__webpack_require__.n(cloneDeep),vuex_esm=__webpack_require__(420629),TrendLine=__webpack_require__(839662),api=__webpack_require__(32284),ScatterAnalyticsvue_type_script_lang_js={props:["mobileConfig"],mixins:[AnalyticsMixin/* default */.Z,NewReportSummaryHelper/* default */.Z],components:{FChartCustomization:NewFChartCustomization/* default */.Z,FScatterPointSelector:FScatterPointSelector/* default */.Z,FReportOptions:FReportOptions/* default */.Z,InlineSvg:InlineSvg/* default */.Z,TrendLine:TrendLine/* default */.Z,ScatterAnalyticsReport:ScatterAnalyticsReport},data:function(){return{scatterType:1,selectedAssetCategory:null,selectedxField:null,selectedyField:null,selectedAssets:[],selectedAsset:[],enableFloatimngIcon:!0,templateCriteria:null,showFilter:!1,hideSideBar:!1,showDataPointSelector:!1,showBuildingPointSelector:!1,showHeatMapPointSelector:!1,showChartCustomization:!1,showDerivation:!1,chartCustomizationActiveTab:"datapoints",selectedBaseLineId:"",baseLineList:null,baseLineCasecaderOptions:[],oldBaseLine:null,spinnerToggle:!0,assetCategoryMap:null,spacefiltersPopover:!1,analyticsConfig:{name:"Building Analysis",key:"BUILDING_ANALYSIS",analyticsType:this.isSiteAnalysis?6:2,type:"reading",period:0,groupByTimeAggr:null,mode:1,baseLine:null,dateFilter:NewDateHelper/* default */.Z.getDatePickerObject(22),chartViewOption:0,dataPoints:[],dimensionDataPoint:null,defaultDate:!1,predictionTimings:[],transformWorkflow:null,trendLineChange:0,filters:{xCriteriaMode:2},sorting:{sortByField:null,orderByFunc:3,limit:10},reportFilter:{timeFilter:{conditions:{}},dataFilter:{conditions:{}}},hidecharttypechanger:!0},reportFilterForm:{floorFilter:[],SpaceFilter:[],categoryFilter:[],assetFilter:[],liveFilterField:"none",liveFilterType:"single"},selectedCategory:{categoryId:[],assetList:null,allAsset:null,categoryList:null,FloorList:[],spaceList:[],allBuildings:this.$store.state.buildings?cloneDeep_default()(this.$store.state.buildings):null},assetsMap:null,analyticsMode:1,setfilter:0,noChartState:!1,reportObject:null,resultObject:null,selectedBuildings:[],selectedBuildingTitle:"",zones:null,dataPointSummaryList:null,dPSummaryList:null,filterToggle:!1,showTrendLine:!1,assetCategoryName:"",filterTitle:"Assets",enableReadingSelection:!1,savedPoints:[],reportFilterEnable:!1,showReportFilter:!1,readings:null,assetCategoryList:[],categoriesLoading:!1,assetsLoading:!1,readingsLoading:!1}},watch:{reportId:function(){this.reportId&&this.loadReport()},filterToggle:{handler:function(newData,oldData){this.toggleFilter(newData)}},getAvailablePeriods:{handler:function(newData,oldData){var _this=this,avail=this.getAvailablePeriods,selected=avail.find((function(a){return a.value===_this.analyticsConfig.period&&a.enable}));if(!selected){var filterName=this.analyticsConfig.dateFilter.operationOn,defaultPeriod=avail.filter((function(a){return a.enable}))[0].value;"week"===filterName||"month"===filterName?defaultPeriod=12:"year"===filterName&&(defaultPeriod=10),this.analyticsConfig.period=defaultPeriod}},immediate:!0}},created:function(){var _this2=this;this.$store.dispatch("loadBuildings"),this.$store.dispatch("loadAlarmSeverity"),this.$store.dispatch("loadAssetCategory").then((function(){return _this2.loadAssetCategories()}))},mounted:function(){if(this.isSiteAnalysis&&(this.analyticsConfig.analyticsType=6),this.$route.query.filters){var filters=this.$route.query.filters,filtersJSON=JSON.parse(filters);this.analyticsConfig=deepmerge/* default */.Z.objectAssignDeep(this.analyticsConfig,filtersJSON)}(this.reportId||this.alarmId||this.cardId)&&(this.$mobile?this.loadReport(this.mobileConfig):this.loadReport());var self=this;self.$http.get("/baseline/all").then((function(response){if(200===response.status){self.baseLineList=response.data?response.data:[],self.baseLineCasecaderOptions=[],self.baseLineCasecaderOptions.push({label:"None",value:-1});var _step,_iterator=(0,createForOfIteratorHelper/* default */.Z)(self.baseLineList);try{for(_iterator.s();!(_step=_iterator.n()).done;){var b=_step.value,children=null;"PREVIOUS_MONTH"===b.rangeTypeEnum||"ANY_MONTH"===b.rangeTypeEnum?children=[{label:"Same date",value:4},{label:"Same week",value:1}]:"PREVIOUS_YEAR"!==b.rangeTypeEnum&&"ANY_YEAR"!==b.rangeTypeEnum||(children=[{label:"Same date",value:3},{label:"Same week",value:1}]),"PREVIOUS"!==b.rangeTypeEnum&&self.baseLineCasecaderOptions.push({label:b.name,value:b.id,children:children})}}catch(err){_iterator.e(err)}finally{_iterator.f()}}})),self.loadZones()},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({assetCategory:function(state){return state.assetCategory}})),{},{isFilterActive:function(){var self=this;if(this.reportObject){var isFilterActive=self.checkFilterFeasibility(self.reportObject);return isFilterActive&&(self.filterTitle=self.analyticsConfig.template&&self.analyticsConfig.template.criteria?"Specific "+self.assetCategoryName+" Selected":"All "+self.assetCategoryName),isFilterActive}return!1},cssLeft:function(){return"0px !important"},isOptimize:function(){return!0},show:function(){return!(this.resultObject&&this.resultObject.report.dataPoints.length>1)||!!this.analyticsConfig.sorting.sortByField},isSiteAnalysis:function(){return this.$route.meta&&"site"===this.$route.meta.analyticsType},isSameDataPoint:function(){if(this.analyticsConfig&&this.analyticsConfig.dataPoints.length){var _step2,dp={},_iterator2=(0,createForOfIteratorHelper/* default */.Z)(this.analyticsConfig.dataPoints);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var d=_step2.value;dp[d.yAxis.fieldId]=!0}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}if(1===Object.keys(dp).length)return!0}return!1},isSameCategoryDataPoint:function(){if(this.analyticsConfig&&this.analyticsConfig.dataPoints.length>1){var _step3,dp={},_iterator3=(0,createForOfIteratorHelper/* default */.Z)(this.analyticsConfig.dataPoints);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var d=_step3.value;dp[d.categoryId]=!0}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}if(1===Object.keys(dp).length)return!1}return!0},getAvailableGroupAggr:function(){var avail=[];return avail.push({name:this.$t("common.wo_report.none"),value:null,enable:!0}),avail.push({name:this.$t("common._common.daily"),value:12,enable:19===this.analyticsConfig.period}),avail.push({name:this.$t("common._common.monthly"),value:10,enable:[17,18,19].includes(this.analyticsConfig.period)}),avail.push({name:this.$t("common.header.hour_of_day"),
// 12, 1, 2, 3
value:19,enable:[12,11,10,8,25,17,18].includes(this.analyticsConfig.period)}),avail.push({name:this.$t("common.header.day_of_week"),
// sun, mon
value:17,enable:[11,10,8,25].includes(this.analyticsConfig.period)}),avail.push({name:this.$t("common.header.day_of_month"),
// 1,2,3
value:18,enable:[10,8,25].includes(this.analyticsConfig.period)}),avail},getAvailablePeriods:function(){var operationOnId=this.analyticsConfig.dateFilter.operationOnId,avail=[];
// avail.push({
//   name:'Week of year', // W1, W2
//   value: 16,
//   enable: true
// })
// avail.push({
//   name:'Month of year', // Jan, Feb , march
//   value: 15,
//   enable: true
// })
return avail.push({name:this.$t("common.wo_report.high_res"),value:0,enable:6===operationOnId||4!==operationOnId}),avail.push({name:this.$t("common.wo_report.hourly"),value:20,enable:6===operationOnId||4!==operationOnId}),avail.push({name:this.$t("common._common.daily"),value:12,enable:!0}),avail.push({name:this.$t("common._common.weekly"),value:11,enable:!0}),avail.push({name:this.$t("common._common.monthly"),value:10,enable:!0}),avail.push({name:this.$t("common.products.quarterly"),value:25,enable:4===operationOnId||5===operationOnId}),avail.push({name:this.$t("common._common.yearly"),value:8,enable:4===operationOnId}),avail.push({name:this.$t("common.header.hour_of_day"),
// 12, 1, 2, 3
value:19,enable:!0}),avail.push({name:this.$t("common.header.day_of_week"),
// sun, mon
value:17,enable:!0}),avail.push({name:this.$t("common.header.day_of_month"),
// 1,2,3
value:18,enable:!0}),avail},hasBooleanEnumPoints:function(){if(this.analyticsConfig.dataPoints.length){var highResPoints=this.analyticsConfig.dataPoints.filter((function(dp){return[4,8].includes(dp.yAxis.dataType)}));if(highResPoints.length)return!0}return!1}}),methods:{resetState:function(){Object.assign(this.$data,this.$options.data.apply(this))},prepareOptionDataPoints:function(rConfig){var dataPoints=[];if(0!==rConfig.length){var _step4,_iterator4=(0,createForOfIteratorHelper/* default */.Z)(rConfig);try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var point=_step4.value,yAxis=!1;for(var key in point)if("yAxis"===key&&!1===yAxis||"xAxis"===key)if("yAxis"===key&&(yAxis=!0),"xAxis"===key){var _step5,_iterator5=(0,createForOfIteratorHelper/* default */.Z)(point[key]);try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var dp=_step5.value,temp={};temp["parentId"]="string"===typeof dp.parentId?parseInt(dp.parentId):dp.parentId,temp["prediction"]=!1,temp["aliases"]=dp.aliases,temp["yAxis"]={},dp.name&&(temp["name"]=dp.name),temp.yAxis["fieldId"]=dp.readingId,temp.yAxis["aggr"]=dp.aggr,dataPoints.push(temp)}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}}else{var _temp={};_temp["parentId"]="string"===typeof point[key].parentId?parseInt(point[key].parentId):point[key].parentId,_temp["prediction"]=!1,_temp["aliases"]=point[key].aliases,_temp["yAxis"]={},point[key].name&&(_temp["name"]=point[key].name),_temp.yAxis["fieldId"]=point[key].readingId,_temp.yAxis["aggr"]=point[key].aggr,_temp["xDataPoint"]=!0,dataPoints.push(_temp)}}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}}return dataPoints},applyscatter:function(dataPoints){if(this.checkPointStructure(dataPoints)){var scatterPoints=dataPoints.scatterPoints,config=JSON.parse(JSON.stringify(this.analyticsConfig));dataPoints.result.meta&&(this.selectedBuildings=dataPoints.result.meta.selectedBuildingIds,this.selectedBuildingTitle=dataPoints.result.meta.selectedBuildingTitle),0===dataPoints.scatterPoints.length?(this.reportObj=null,this.resultObj=null,this.analyticsConfig.scatterConfig=[],this.analyticsConfig.dataPoints=[]):(config["dataPoints"]=this.prepareOptionDataPoints(scatterPoints),config["scatterConfig"]=dataPoints.scatterPoints,
// config['hidechartoptions'] = true
config["hidecharttypechanger"]=!0,this.analyticsConfig=config)}},checkPointStructure:function(dataPoints){var _step6,scatterPoints=dataPoints.scatterPoints,_iterator6=(0,createForOfIteratorHelper/* default */.Z)(scatterPoints);try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var rPoint=_step6.value;if(!rPoint.xAxis||!rPoint.yAxis)return!1}}catch(err){_iterator6.e(err)}finally{_iterator6.f()}return!0},toggleFilter:function(val){var _this3=this;if(this.analyticsConfig&&this.analyticsConfig.template)this.$set(this.analyticsConfig.template,"show",val);else{
// create a new template
var config=JSON.parse(JSON.stringify(this.analyticsConfig)),duplicateCase=this.getDuplicateCase(this.reportObject);this.prepareReportTemplate(this.resultObject,duplicateCase.case).then((function(newTemplate){newTemplate.show=val,config.template=newTemplate,_this3.analyticsConfig=config}))}},toggleTemplateFilter:function(val){var _this4=this;this.analyticsConfig&&this.analyticsConfig.template&&this.$nextTick((function(){_this4.analyticsConfig.template.show=val}))},setTemplateFilterCriteria:function(val){this.templateCriteria=val},PointSelector:function(){1===this.analyticsConfig.mode||11===this.analyticsConfig.mode||"reading"===this.analyticsConfig.mode?this.showDataPointSelector=!0:this.showBuildingPointSelector=!0},addFilterCriteria:function(){var _this5=this,config=JSON.parse(JSON.stringify(this.analyticsConfig));if(this.showFilter=!1,config.parentId=null,config.template)config.template.criteria=this.templateCriteria,this.analyticsConfig=config;else{var duplicateCase=this.getDuplicateCase(this.reportObject);this.prepareReportTemplate(this.resultObject,duplicateCase.case).then((function(newTemplate){newTemplate.criteria=_this5.templateCriteria,config.template=newTemplate,_this5.analyticsConfig=config}))}},openFilter:function(){this.isFilterActive?this.showFilter=!0:this.showFilter=!1},toggleSideBar:function(){this.hideSideBar?(this.hideSideBar=!1,this.$refs["newAnalyticReport"]&&this.$refs["newAnalyticReport"].resize()):(this.hideSideBar=!0,this.$refs["newAnalyticReport"]&&this.$refs["newAnalyticReport"].resize())},loadSpaceList:function(){var self=this;if(self.selectedBuildings)for(var buildingId in self.selectedCategory.FloorList=[],self.selectedCategory.spaceList=[],self.loading=!0,self.selectedBuildings)self.$http.get("/floor?buildingId="+self.selectedBuildings[buildingId]).then((function(response){self.selectedCategory.FloorList=response.data.records})),self.$util.loadSpacesContext(4,null,[{key:"building",operator:"is",value:self.selectedBuildings[buildingId]},{key:"floor",operator:"is empty"}]).then((function(response){self.selectedCategory.spaceList=response.records}))},loadReadings:function(){var _this6=this;this.readingsLoading=!0,this.$util.loadAssetReadingFields(null,this.selectedAssetCategory).then((function(response){_this6.readings=response,_this6.readingsLoading=!1})),this.loadAssets()},loadAssets:function(){var _this7=this;this.assetsLoading=!0,this.$util.loadAsset({categoryId:this.selectedAssetCategory,selectFields:["name"]}).then((function(response){_this7.selectedAssets=(response.assets||[]).map((function(asset){return{name:asset.name,id:asset.id}})),_this7.assetsLoading=!1}))},populateDataPoints:function(){var _this8=this;if(this.selectedAsset.length&&this.selectedxField&&this.selectedyField){var _step7,changedDataPoints=[],tempConfig=[],_iterator7=(0,createForOfIteratorHelper/* default */.Z)(this.selectedAsset);try{var _loop=function(){var assetId=_step7.value,assetDetails=_this8.selectedAssets.find((function(asset){return assetId===asset.id})),yPoint={parentId:assetId,prediction:!1,aliases:{},yAxis:{fieldId:_this8.selectedyField,aggr:3}};assetDetails&&(yPoint["name"]=assetDetails.name),changedDataPoints.push(yPoint);var xPoint={parentId:assetId,prediction:!1,aliases:{},yAxis:{fieldId:_this8.selectedxField,aggr:3},xDataPoint:!0};changedDataPoints.push(xPoint),tempConfig.push({xAxis:[yPoint],yAxis:xPoint})};for(_iterator7.s();!(_step7=_iterator7.n()).done;)_loop()}catch(err){_iterator7.e(err)}finally{_iterator7.f()}this.analyticsConfig.dataPoints=changedDataPoints,this.analyticsConfig["scatterConfig"]=tempConfig}},loadAssetCategories:function(){var _this9=this;this.categoriesLoading=!0,api/* API */.bl.get("/asset/getAssetCategoryWithReadings").then((function(_ref){var error=_ref.error,data=_ref.data;if(error){var message=error.message;_this9.$message.error(message),_this9.categoriesLoading=!1}else{var categoryIds=data?Object.keys(data):[-1];_this9.assetCategoryList=_this9.assetCategory.filter((function(ele){for(var index=0;index<categoryIds.length;index++){var element=categoryIds[index];if(parseInt(element)===ele.id)return ele.toggle=!1,ele}})),_this9.categoriesLoading=!1}}))},updateFilterdata:function(root){if("category"===root){this.selectedCategory.assetList=[];for(var i=0;i<this.reportFilterForm.categoryFilter.length;i++)this.selectedCategory.assetList=[].concat((0,toConsumableArray/* default */.Z)(this.selectedCategory.assetList),(0,toConsumableArray/* default */.Z)(Object.keys(this.assetCategoryMap[this.reportFilterForm.categoryFilter[i]])))}},filterAssetsFromCategory:function(readings){var self=this;self.assetCategoryMap=readings.categoryWithAssets,this.selectedCategory.assetList=[];for(var i=0;i<this.reportFilterForm.categoryFilter.length;i++)this.selectedCategory.assetList=[].concat((0,toConsumableArray/* default */.Z)(this.selectedCategory.assetList),(0,toConsumableArray/* default */.Z)(Object.keys(this.assetCategoryMap[this.reportFilterForm.categoryFilter[i]])));this.selectedCategory.allAsset=self.selectedCategory.assetList,self.assetsMap=readings.assets},resetspaceFilter:function(){this.reportFilterForm={floorFilter:[],SpaceFilter:[],categoryFilter:[],assetFilter:[],liveFilterField:"none",liveFilterType:"single"},this.applyFilter(null)},applyFilter:function(){if(this.reportFilterForm.categoryFilter.length||this.reportFilterForm.assetFilter.length||"none"!==this.reportFilterForm.liveFilterField||"single"!==this.reportFilterForm.liveFilterType)if(this.setfilter=1,this.reportFilterForm.categoryFilter.length||this.reportFilterForm.assetFilter.length)if(this.reportFilterForm.assetFilter.length)this.analyticsConfig.filters={xCriteriaMode:3,parentId:this.reportFilterForm.assetFilter,filterState:this.$helpers.cloneObject(this.reportFilterForm)};else{var spaceFilter=this.selectedBuildings;this.analyticsConfig.filters={xCriteriaMode:4,assetCategory:this.reportFilterForm.categoryFilter,spaceId:spaceFilter,filterState:this.$helpers.cloneObject(this.reportFilterForm)}}else this.analyticsConfig.filters={xCriteriaMode:2,filterState:this.$helpers.cloneObject(this.reportFilterForm)};else this.setfilter=0;this.spacefiltersPopover=!1},prepareDataPointSummary:function(){var _this10=this;if(this.resultObject){var _step8,summaryList=[],weatherModules={weather:"Live Weather",weatherDaily:"Daily Weather",psychrometric:"Psychrometric",cdd:"Degree Days",wdd:"Degree Days",hdd:"Degree Days"},_iterator8=(0,createForOfIteratorHelper/* default */.Z)(this.resultObject.report.dataPoints);try{var _loop2=function(){var dataPoint=_step8.value;if(2!==dataPoint.type&&!dataPoint.duplicateDataPoint&&5!==dataPoint.type)if(Object.keys(weatherModules).includes(dataPoint.yAxis.module.name))_this10.addToGroup(dataPoint,weatherModules[dataPoint.yAxis.module.name],summaryList);else if("MV_Readings"===dataPoint.yAxis.module.tableName)_this10.addToGroup(dataPoint,"M&Vs",summaryList);else{var self=_this10;self.$http.post("v2/resource/getResourcesDetails",{resourceId:dataPoint.metaData.parentIds}).then((function(response){response.data.result.resource[0]&&"SPACE"===response.data.result.resource[0].resourceTypeEnum?"scheduled_formula"===dataPoint.yAxis.module.typeEnum.toLowerCase()?_this10.addToGroup(dataPoint,"Enpi",summaryList):_this10.addToGroup(dataPoint,"Space",summaryList):_this10.addToGroup(dataPoint,"Asset",summaryList)}))}};for(_iterator8.s();!(_step8=_iterator8.n()).done;)_loop2()}catch(err){_iterator8.e(err)}finally{_iterator8.f()}return summaryList}},addToGroup:function(dataPoint,label,summaryList){var reading={};if(reading["readingId"]=dataPoint.yAxis.fieldId,reading["readingLabel"]=dataPoint.yAxis.field.displayName,reading["resourceId"]=parseInt(dataPoint.metaData.parentIds[0]),reading["resourceLabel"]=dataPoint.resourceName,reading["marked"]=null,reading["location"]="Space"===label||"Enpi"===label?dataPoint.resourceName:this.selectedBuildingTitle,reading["categoryId"]=dataPoint.assetCategoryId,reading["buildingId"]="Space"===label||"Enpi"===label?dataPoint.metaData.parentIds[0]:dataPoint.buildingId,summaryList&&0===summaryList.length){var temp={};temp["label"]=label,temp["readings"]=[],temp.readings.push(reading),summaryList.push(temp)}else if(summaryList&&summaryList.length>0){var readingGroup=summaryList.filter((function(group){return group.label===label}));if(0!==readingGroup.length)readingGroup[0].readings.push(reading);else{var _temp2={};_temp2["label"]=label,_temp2["readings"]=[],_temp2.readings.push(reading),summaryList.push(_temp2)}}},loadAlarmMeta:function(){var _this11=this;this.$http.post("/dashboard/getReportMetaForAlarms",{alarmId:this.$route.query.alarmId}).then((function(response){response.data&&response.data.reportMeta&&(_this11.analyticsConfig.dataPoints=response.data.reportMeta.dataPoints)}))},reportLoaded:function(report,result){!0===this.noChartState&&(this.noChartState=!1),this.reportObject=report,this.$route.query.reportId&&(this.filterToggle=4===report.reportType),this.resultObject=result,(this.analyticsConfig.savedReport||this.$route.query.filters||this.analyticsConfig.template)&&([8,9,10,"mv"].includes(this.analyticsConfig.mode)||(this.dataPointSummaryList=this.prepareDataPointSummary())),4===this.reportObject.reportType&&this.reportObject.options.reportTemplate.buildingId?(report.options.common.buildingIds.push(this.reportObject.options.reportTemplate.buildingId),this.resetDataPointSelector(report.options.common.buildingIds)):report.options.common&&report.options.common.buildingIds&&(!report.options.common.buildingIds.length&&this.selectedBuildings?this.$route.query.filters||this.$route.query.alarmId||this.$route.query.cardId?(this.analyticsConfig.buildingId?this.reportObject.options.common.buildingIds.push(this.analyticsConfig.buildingId):this.$route.query.buildingId?this.reportObject.options.common.buildingIds.push(this.$route.query.buildingId):this.reportObject.options.common.buildingIds=this.selectedBuildings,this.resetDataPointSelector(this.reportObject.options.common.buildingIds)):this.reportObject.options.common.buildingIds=this.selectedBuildings:
// this.selectedBuildings = report.options.common.buildingIds
this.resetDataPointSelector(report.options.common.buildingIds))},loadZones:function(){var self=this;self.$http.get("/zone").then((function(response){response.data&&response.data.records&&(self.zones=response.data.records)}))},resetDataPointSelector:function(buildingIds){if(1===this.analyticsConfig.mode||"reading"===this.analyticsConfig.mode||11===this.analyticsConfig.mode)if("reading"===this.analyticsMode){var filteredPoints=this.analyticsConfig.dataPoints.filter((function(dp){return!(dp.xDataPoint&&!0===dp.xDataPoint)}));this.$refs["building-selector"].setInitialValues(filteredPoints,buildingIds)}else this.$refs["building-selector"].setInitialValues(this.analyticsConfig.dataPoints,buildingIds);else[8,9,10,"mv"].includes(this.analyticsConfig.mode)&&this.$refs["portfolio-building-selector"].setInitialValues(this.analyticsConfig.dataPoints,buildingIds)},updateDataPoints:function(changedDataPoints){var _this12=this;if([8,9,10].includes(this.analyticsConfig.mode))this.analyticsConfig.filters={xCriteriaMode:4,spaceId:this.selectedBuildings};else if("mv"===this.analyticsConfig.mode){var siteId=this.$store.state.buildings.filter((function(building){return building.id===parseInt(_this12.selectedBuildings[0])}))[0].siteId;this.analyticsConfig.filters={xCriteriaMode:4,spaceId:[siteId+""]}}else this.analyticsConfig.filters={xCriteriaMode:2};var pointToAdd=null;if(this.analyticsConfig.dataPoints.length){var configIndexes=[],alreadyAddedIndexes=[],pointsToRemove=[];this.enableReadingSelection=changedDataPoints.length>1,"reading"===this.analyticsMode&&null!==this.analyticsConfig.dimensionDataPoint&&(pointToAdd=this.analyticsConfig.dataPoints[this.analyticsConfig.dimensionDataPoint]);var optionPoints=[];this.reportObject.options.dataPoints.forEach((function(dp){"group"===dp.type?optionPoints.push.apply(optionPoints,(0,toConsumableArray/* default */.Z)(dp.children)):optionPoints.push(dp)}));var isValid=optionPoints.filter((function(dp){return 2!==dp.pointType&&!dp.duplicateDataPoint})).every((function(dp){var idx=changedDataPoints.findIndex((function(cdp){return cdp.parentId===dp.parentId&&cdp.yAxis.fieldId===dp.fieldId}));if(-1===idx){if(!_this12.checkAndDeletePointsRel(_this12.reportObject.options,dp.alias))return _this12.$message.error(dp.label+_this12.$t("common.header.has_been_used_derivation_removing_point")),_this12.resetDataPointSelector(),!1;pointsToRemove.push(dp.alias)}if(-1!==idx){var configIdx=_this12.getConfigDataPointFromOptionDP(_this12.analyticsConfig,dp,!0);configIndexes.push(configIdx),alreadyAddedIndexes.push(idx)}return!0}));isValid&&(this.removeOptionPoints(this.reportObject.options,pointsToRemove),this.analyticsConfig.dataPoints=[].concat((0,toConsumableArray/* default */.Z)(this.analyticsConfig.dataPoints.filter((function(dp,idx){return 2===dp.type||dp.duplicateDataPoint||configIndexes.includes(idx)}))),(0,toConsumableArray/* default */.Z)(changedDataPoints.filter((function(cdp,idx){return!alreadyAddedIndexes.includes(idx)})))))}else this.analyticsConfig.dataPoints=changedDataPoints;
// if(this.analyticsMode === 11 && this.analyticsConfig.dimensionDataPoint >= this.analyticsConfig.dataPoints.length){
//   this.analyticsConfig.dimensionDataPoint = 0
//   this.$refs['single-point-selector'].setInitialValues([],this.selectedBuildings)
// }
if(null!==pointToAdd){var idx=this.analyticsConfig.dataPoints.findIndex((function(adp){return adp.parentId===pointToAdd.parentId&&adp.yAxis.fieldId===pointToAdd.yAxis.fieldId}));-1===idx&&(this.analyticsConfig.dataPoints.push(pointToAdd),this.analyticsConfig.dimensionDataPoint=this.analyticsConfig.dataPoints.length-1)}this.hasBooleanEnumPoints&&this.analyticsConfig.groupByTimeAggr&&(this.analyticsConfig.groupByTimeAggr=null),this.addPredictionFields(this.analyticsConfig),this.showDataPointSelector=!1,this.showBuildingPointSelector=!1},updateDimensionDataPoints:function(changedDataPoints){
// if (this.analyticsConfig.dimensionDataPoint!==null) {
var index=this.analyticsConfig.dataPoints.findIndex((function(dp){return dp.parentId===changedDataPoints[0].parentId&&dp.yAxis.fieldId===changedDataPoints[0].yAxis.fieldId}));if(-1===index){var idx=this.analyticsConfig.dataPoints.findIndex((function(dp){return!0===dp.xDataPoint}));changedDataPoints[0]["xDataPoint"]=!0,-1===idx?(idx=0,this.analyticsConfig.dataPoints.push(changedDataPoints[0]),this.analyticsConfig.dimensionDataPoint=this.analyticsConfig.dataPoints.length-1):(this.analyticsConfig.dataPoints[idx]=changedDataPoints[0],this.analyticsConfig.dimensionDataPoint=idx)}else this.analyticsConfig.dimensionDataPoint=index;
// }
// else {
//   changedDataPoints[0]['xDataPoint']=true
//   this.analyticsConfig.dataPoints.push(changedDataPoints[0])
//   this.analyticsConfig.dimensionDataPoint=this.analyticsConfig.dataPoints.length-1
// }
this.addPredictionFields(this.analyticsConfig),this.showHeatMapPointSelector=!1},setSelectedBuildings:function(_ref2){var name=_ref2.name,ids=_ref2.ids;this.selectedBuildingTitle=name,this.selectedBuildings=ids,this.reportObject&&this.reportObject.options&&this.reportObject.options.common&&(this.reportObject.options.common.buildingIds=this.selectedBuildings)},onPeriodChange:function(){if([8,10,11,12,17,18,19,25].includes(this.analyticsConfig.period)||(this.analyticsConfig.groupByTimeAggr=null),this.analyticsConfig.groupByTimeAggr&&([17,18].includes(this.analyticsConfig.period)&&![10,19].includes(this.analyticsConfig.groupByTimeAggr)||12===this.analyticsConfig.period&&19!==this.analyticsConfig.groupByTimeAggr?this.analyticsConfig.groupByTimeAggr=19:11!==this.analyticsConfig.period||[19,17].includes(this.analyticsConfig.groupByTimeAggr)?19!==this.analyticsConfig.period||[12,10].includes(this.analyticsConfig.groupByTimeAggr)||(this.analyticsConfig.groupByTimeAggr=12):this.analyticsConfig.groupByTimeAggr=17),!this.analyticsConfig.dataPoints.length){var filter=22;20===this.analyticsConfig.period?filter=31:12===this.analyticsConfig.period?filter=28:10===this.analyticsConfig.period&&(filter=44),this.analyticsConfig.dateFilter=NewDateHelper/* default */.Z.getDatePickerObject(filter)}},onTypeChange:function(){this.selectedAssetCategory=null,this.flushAssetDetails()},flushAssetDetails:function(){this.noChartState=!0,this.reportObj=null,this.resultObj=null,this.analyticsConfig.dataPoints=[],this.analyticsConfig.scatterConfig=[],this.selectedxField=null,this.selectedyField=null,this.selectedAsset=[],this.assetsLoading=!1,this.readingsLoading=!1},onModeChange:function(){(this.reportId||this.alarmId||this.cardId)&&(this.spinnerToggle=!1),this.noChartState=!0,![8,9,10].includes(this.analyticsConfig.mode)&&[8,9,10].includes(this.analyticsMode)||"mv"===this.analyticsMode?(
//Asset,Floor,Space,M&V
this.analyticsConfig.dataPoints=[],this.resetDataPointSelector(this.selectedBuildings),this.analyticsConfig.dimensionDataPoint=null):1===this.analyticsConfig.mode||"reading"===this.analyticsConfig.mode||[8,9,10].includes(this.analyticsMode)?8===this.analyticsMode&&this.isSameCategoryDataPoint&&(this.$message({message:this.$t("common.header.please_choose_single_asset_category_point"),type:"warning"}),this.analyticsConfig.dataPoints=[],this.resetDataPointSelector(this.selectedBuildings),this.analyticsConfig.dimensionDataPoint=null):(
//Reading,Time,TimeDuration
this.analyticsConfig.dataPoints=[],this.resetDataPointSelector(this.selectedBuildings)),"reading"!==this.analyticsMode&&(this.analyticsConfig.dimensionDataPoint=null),this.analyticsConfig.mode=this.analyticsMode,this.enableReadingSelection=this.analyticsConfig.dataPoints.length>1},OnXdatapointChange:function(){if("reading"===this.analyticsConfig.mode&&null!==this.analyticsConfig.dimensionDataPoint){var point=this.analyticsConfig.dataPoints[this.analyticsConfig.dimensionDataPoint];point.xDataPoint&&!0===point.xDataPoint||(this.analyticsConfig.dataPoints=this.analyticsConfig.dataPoints.filter((function(dp){return!(dp.xDataPoint&&!0===dp.xDataPoint)})))}11===this.analyticsConfig.mode&&null!==this.analyticsConfig.dimensionDataPoint&&(this.analyticsConfig.dataPoints=[this.analyticsConfig.dataPoints[this.analyticsConfig.dimensionDataPoint]]),this.$refs["single-point-selector"].setInitialValues([],this.selectedBuildings)},onBaseLineChange:function(newBaseLine){var _this13=this;if(!this.oldBaseLine||this.oldBaseLine[0]!==newBaseLine[0]){if(this.oldBaseLine&&-1!==this.oldBaseLine[0]){var oldBlName=this.baseLineList.find((function(bl){return bl.id===_this13.oldBaseLine[0]})).name,dp=this.reportObject.options.dataPoints.find((function(dp){return dp.baseLineName===oldBlName}));if(!this.checkAndDeletePointsRel(this.reportObject.options,dp.alias))return this.$message.error(dp.baseLineName+this.$t("common.header.has_been_derivation_please_delete_derivation")),void this.$set(this.analyticsConfig,"baseLine",this.oldBaseLine)}this.oldBaseLine=(0,toConsumableArray/* default */.Z)(newBaseLine),this.$set(this.analyticsConfig,"baseLine",newBaseLine)}},onSettingsChange:function(changedOption){"alarm"===changedOption&&(this.reportObj.alarms&&this.reportObj.alarms.regions.length||!this.reportObj.options.settings.alarm||this.initChart())},enableTrendline:function(){this.reportObject&&(this.reportObject.options.trendLine.enable=!0),this.openTrendLineDialog()},openTrendLineDialog:function(){this.reportObject.options.trendLine.enable?this.showTrendLine=!0:this.analyticsConfig.trendLineChange++},onTrendLineChange:function(trendLineObj){this.reportObject.options.trendLine=trendLineObj,this.analyticsConfig.trendLineChange++}}},newTools_ScatterAnalyticsvue_type_script_lang_js=ScatterAnalyticsvue_type_script_lang_js,ScatterAnalytics_component=(0,componentNormalizer/* default */.Z)(newTools_ScatterAnalyticsvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,ScatterAnalytics=ScatterAnalytics_component.exports},
/***/248138:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return ScatterChartOptions}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/energy/analytics/scatterAnalytics/ScatterChartOptions.vue?vue&type=template&id=eadb8a38
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"fc-dialog-center-container fc-dialog-center-body-p0",attrs:{title:"CHART OPTIONS",visible:_vm.visibility,width:"40%","append-to-body":!0,"show-close":!1,"before-close":_vm.close,"close-on-click-modal":!1},on:{"update:visible":function($event){_vm.visibility=$event}}},[_c("div",{staticClass:"height380 overflow-y-scroll pB80"},[_c("div",{staticClass:"customize-input-block pR20 pL20 pT20"},[_c("el-row",[_c("el-col",{attrs:{span:16}},[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25"},[_vm._v("Shape")]),_c("el-select",{staticClass:"fc-input-full-border2 width100",attrs:{placeholder:"Select"},on:{change:function($event){return _vm.OnShapeChange()}},model:{value:_vm.report.options.scatter.shape,callback:function($$v){_vm.$set(_vm.report.options.scatter,"shape",$$v)},expression:"report.options.scatter.shape"}},[_c("el-option",{attrs:{label:"Circle",value:"circle"}}),_c("el-option",{attrs:{label:"Rectangle",value:"rectangle"}}),_c("el-option",{attrs:{label:"Triangle",value:"triangle"}}),_c("el-option",{attrs:{label:"Diamond",value:"diamond"}}),_c("el-option",{attrs:{label:"Varies based on asset",value:"predefined"}})],1)],1)],1)],1),_c("el-row",{staticClass:"pR20 pL20 pT20",attrs:{gutter:20}},[_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"customize-input-block"},[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25"},[_vm._v(" Color ")]),_c("el-row",[_c("el-col",{attrs:{span:20}},[_c("el-select",{staticClass:"fc-input-full-border2 width100",attrs:{placeholder:"Select"},model:{value:_vm.report.options.scatter.color.mode,callback:function($$v){_vm.$set(_vm.report.options.scatter.color,"mode",$$v)},expression:"report.options.scatter.color.mode"}},[_c("el-option",{attrs:{label:"None",value:null}}),_c("el-option",{attrs:{label:"Monochrome",value:"monochrome"}}),_vm.metricPoints.length<2?_c("el-option",{attrs:{label:"Color palette",value:"palette"}}):_vm._e()],1)],1)],1)],1)]),_vm.report.options.scatter.color.mode?_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"customize-input-block"},[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25"},[_vm._v(" Color based on ")]),_c("el-row",[_c("el-col",{attrs:{span:20}},[_c("el-select",{staticClass:"fc-input-full-border2 width100",attrs:{placeholder:"Select",filterable:"",loading:_vm.loading,remote:"","remote-method":_vm.remoteMethod},on:{change:function($event){return _vm.constructDataPoint("color")}},model:{value:_vm.colorBasedOn,callback:function($$v){_vm.colorBasedOn=$$v},expression:"colorBasedOn"}},_vm._l(_vm.readings,(function(reading,idx){return _c("el-option",{key:idx,attrs:{label:reading.displayName,value:reading.fieldId}})})),1)],1)],1)],1)]):_vm._e()],1),_c("el-row",{staticClass:"pR20 pL20 pT20"},["palette"===_vm.report.options.scatter.color.mode?_c("el-col",{attrs:{span:24}},[_c("f-color-palettes",{attrs:{colorIndex:_vm.report.options.scatter.color.pallete},on:{colorSelected:_vm.onColorChange}})],1):_vm._e()],1),_vm.sizeEnabled?_c("el-row",{staticClass:"pR20 pL20 pT20",attrs:{gutter:20}},[_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"customize-input-block"},[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25"},[_vm._v(" Size ")]),_c("el-row",[_c("el-col",{attrs:{span:20}},[_c("el-select",{staticClass:"fc-input-full-border2 width100",attrs:{placeholder:"Select"},model:{value:_vm.report.options.scatter.size.mode,callback:function($$v){_vm.$set(_vm.report.options.scatter.size,"mode",$$v)},expression:"report.options.scatter.size.mode"}},[_c("el-option",{attrs:{label:"None",value:null}}),_c("el-option",{attrs:{label:"Varies based on Readings",value:"reading"}})],1)],1)],1)],1)]),_vm.report.options.scatter.size.mode?_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"customize-input-block"},[_c("div",{staticClass:"fc-grey7-12 f14 text-left line-height25"},[_vm._v(" Size based on ")]),_c("el-row",[_c("el-col",{attrs:{span:20}},[_c("el-select",{staticClass:"fc-input-full-border2 width100",attrs:{placeholder:"Select",filterable:"",loading:_vm.loading,remote:"","remote-method":_vm.remoteMethod},on:{change:function($event){return _vm.constructDataPoint("size")}},model:{value:_vm.sizeBasedOn,callback:function($$v){_vm.sizeBasedOn=$$v},expression:"sizeBasedOn"}},_vm._l(_vm.readings,(function(reading,idx){return _c("el-option",{key:idx,attrs:{label:reading.displayName,value:reading.fieldId}})})),1)],1)],1)],1)]):_vm._e()],1):_vm._e()],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.close}},[_vm._v("CANCEL")]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:_vm.save}},[_vm._v("DONE")])],1)])},staticRenderFns=[],createForOfIteratorHelper=__webpack_require__(566347),toConsumableArray=__webpack_require__(488478),FColorPalettes=(__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(670560),__webpack_require__(538077),__webpack_require__(186466),__webpack_require__(976801),__webpack_require__(564043),__webpack_require__(689730),__webpack_require__(425728),__webpack_require__(339772),__webpack_require__(634338),__webpack_require__(856778)),AnalyticsMixin=__webpack_require__(244936),api=__webpack_require__(32284),validation=__webpack_require__(990260),ScatterChartOptionsvue_type_script_lang_js={components:{FColorPalettes:FColorPalettes/* default */.Z},props:["visibility","report","config"],mixins:[AnalyticsMixin/* default */.Z],data:function(){return{activeScatterChartItem:null,colorBasedOn:null,sizeBasedOn:null,readings:[],loading:!1,sizeEnabled:!0}},computed:{dataPointObject:function(){return this.report?this.$helpers.getDataPoints(this.report.options.dataPoints,[1,2,4],!0):[]},allPoints:function(){var points=[];return this.dataPointObject&&this.dataPointObject.forEach((function(dp){"group"===dp.type?points.push.apply(points,(0,toConsumableArray/* default */.Z)(dp.children)):points.push(dp)})),points.filter((function(dp){return"x"!==dp.axes&&!dp.isBaseLine&&dp.pointCustomization}))},metricPoints:function(){var points=[];return this.dataPointObject&&this.dataPointObject.forEach((function(dp){"group"===dp.type?points.push.apply(points,(0,toConsumableArray/* default */.Z)(dp.children)):points.push(dp)})),points.filter((function(dp){return"x"!==dp.axes&&!dp.isBaseLine&&dp.pointCustomization&&dp.visible}))},xDataPoints:function(){var points=[];return this.dataPointObject&&this.dataPointObject.forEach((function(dp){"group"===dp.type?points.push.apply(points,(0,toConsumableArray/* default */.Z)(dp.children)):points.push(dp)})),points.filter((function(dp){return"x"===dp.axes}))}},mounted:function(){var _this=this;this.report&&(this.report.options.scatter.color.reading&&(this.colorBasedOn=this.report.options.scatter.color.reading),this.report.options.scatter.size.reading&&(this.sizeBasedOn=this.report.options.scatter.size.reading)),this.loading=!0;var url="asset/getAssetsWithReadings",params={fetchOnlyReadings:!0,page:1,perPage:50};this.config&&this.config.selectedAssetCategory&&(params.categoryIds=[this.config.selectedAssetCategory]),api/* API */.bl.post(url,params).then((function(_ref){var data=_ref.data,error=_ref.error;error||(_this.readings=Object.values(data.fields||{}),_this.loading=!1)}))},methods:{save:function(){this.close()},close:function(){this.$emit("update:visibility",!1)},prefix:function(point){if(point.duplicateDataPoint&&(0!==this.report.params.xAggr||this.report&&![1,4,"reading"].includes(this.report.options.common.mode)))switch(point.aggr){case 2:return"Avg of ";case 3:return"Sum of ";case 4:return"Min of ";case 5:return"Max of ";default:return""}return""},onColorChange:function(idx,colorArr){this.report&&this.report.options.scatter.color&&(this.report.options.scatter.color.pallete=idx,this.report.options.scatter.color.colors=colorArr)},OnShapeChange:function(){if(this.report&&this.report.options.scatter.shape){var val=this.report.options.scatter.shape;if("circle"!==val&&(this.sizeEnabled=!1,this.report.options.scatter.size.mode=null),"predefined"!==val)this.allPoints.forEach((function(dp){return dp.pointCustomization.shape=val}));else{var shapeArr=["circle","rectangle","triangle","diamond"];this.allPoints.forEach((function(dp,idx){return dp.pointCustomization.shape=shapeArr[idx%4]}))}}},remoteMethod:function(query){var _this2=this;if(""!=query){this.loading=!0;var url="asset/getAssetsWithReadings",params={fetchOnlyReadings:!0,page:1,perPage:50};this.config&&this.config.selectedAssetCategory&&(params.categoryIds=[this.config.selectedAssetCategory]),(0,validation/* isEmpty */.xb)(query)||(params.search=query),api/* API */.bl.post(url,params).then((function(_ref2){var data=_ref2.data,error=_ref2.error;error||(_this2.readings=Object.values(data.fields||{}),_this2.loading=!1)}))}},constructDataPoint:function(mode){var _step,_this3=this,colorBasedOn=this.colorBasedOn,sizeBasedOn=this.sizeBasedOn,allPoints=this.allPoints,xDataPoints=this.xDataPoints,changePoint=!1,changedDataPoints=this.config.dataPoints.slice().filter((function(dp){return 6!==dp.type})),_iterator=(0,createForOfIteratorHelper/* default */.Z)(allPoints);try{var _loop=function(){var dp=_step.value;if("color"===mode)if(_this3.report.options.scatter.color.reading=colorBasedOn,parseInt(dp.fieldId)===parseInt(colorBasedOn))dp.pointCustomization.color.basedOn="".concat(dp.key);else{var match=allPoints.find((function(dataPoint){return parseInt(dp.parentId)===parseInt(dataPoint.parentId)&&parseInt(dp.fieldId)===parseInt(colorBasedOn)}));if(match)dp.pointCustomization.color.basedOn="".concat(match.key);else{var _match=xDataPoints.find((function(dataPoint){return parseInt(dp.parentId)===parseInt(dataPoint.parentId)&&parseInt(dataPoint.fieldId)===parseInt(colorBasedOn)}));if(_match)dp.pointCustomization.color.basedOn="".concat(_match.key);else{var aliases={actual:"".concat(dp.key,"_colorscatter")},point={parentId:dp.parentId,prediction:!1,aliases:aliases,yAxis:{fieldId:colorBasedOn,aggr:3},type:6};dp.pointCustomization.color.basedOn="".concat(dp.key,"_colorscatter"),changedDataPoints=changedDataPoints.filter((function(point){return point.aliases.actual!=="".concat(dp.key,"_colorscatter")})),changedDataPoints.push(point),changePoint=!0}}}else if("size"===mode)if(_this3.report.options.scatter.size.reading=sizeBasedOn,parseInt(dp.fieldId)===parseInt(sizeBasedOn))dp.pointCustomization.size.basedOn="".concat(dp.key);else{var _match2=allPoints.find((function(dataPoint){return parseInt(dp.parentId)===parseInt(dataPoint.parentId)&&parseInt(dp.fieldId)===parseInt(sizeBasedOn)}));if(_match2)dp.pointCustomization.size.basedOn="".concat(_match2.key);else{var _match3=xDataPoints.find((function(dataPoint){return parseInt(dp.parentId)===parseInt(dataPoint.parentId)&&parseInt(dataPoint.fieldId)===parseInt(sizeBasedOn)}));if(_match3)dp.pointCustomization.size.basedOn="".concat(_match3.key);else{var _aliases={actual:"".concat(dp.key,"_sizescatter")},_point={parentId:dp.parentId,prediction:!1,aliases:_aliases,yAxis:{fieldId:sizeBasedOn,aggr:3},type:6};dp.pointCustomization.size.basedOn="".concat(dp.key,"_sizescatter"),changedDataPoints=changedDataPoints.filter((function(point){return point.aliases.actual!=="".concat(dp.key,"_sizescatter")})),changedDataPoints.push(_point),changePoint=!0}}}};for(_iterator.s();!(_step=_iterator.n()).done;)_loop()}catch(err){_iterator.e(err)}finally{_iterator.f()}changePoint&&this.updateDataPoints(changedDataPoints)},updateDataPoints:function(changedDataPoints){var _this4=this;if(this.config.dataPoints.length){var configIndexes=[],alreadyAddedIndexes=[],pointsToRemove=[];this.enableReadingSelection=changedDataPoints.length>1;var isValid=this.allPoints.filter((function(dp){return 2!==dp.pointType&&!dp.duplicateDataPoint})).every((function(dp){var idx=changedDataPoints.findIndex((function(cdp){return parseInt(cdp.parentId)===parseInt(dp.parentId)&&parseInt(cdp.yAxis.fieldId)===parseInt(dp.fieldId)}));if(-1===idx&&pointsToRemove.push(dp.alias),-1!==idx){var configIdx=_this4.getConfigDataPointFromOptionDP(_this4.config,dp,!0);configIndexes.push(configIdx),alreadyAddedIndexes.push(idx)}return!0}));isValid&&(pointsToRemove.length&&this.removeOptionPoints(this.report.options,pointsToRemove),this.config.dataPoints=[].concat((0,toConsumableArray/* default */.Z)(this.config.dataPoints.filter((function(dp,idx){return 2===dp.type||dp.duplicateDataPoint||configIndexes.includes(idx)}))),(0,toConsumableArray/* default */.Z)(changedDataPoints.filter((function(cdp,idx){return!alreadyAddedIndexes.includes(idx)})))))}else this.config.dataPoints=changedDataPoints}}},scatterAnalytics_ScatterChartOptionsvue_type_script_lang_js=ScatterChartOptionsvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(scatterAnalytics_ScatterChartOptionsvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,ScatterChartOptions=component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/2287.js.map