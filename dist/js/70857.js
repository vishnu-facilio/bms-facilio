"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[70857],{
/***/32415:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return ModuleNewReportSummary}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/report/ModuleNewReportSummary.vue?vue&type=template&id=18b7f97e
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"reports-summary new-reports-summary workorder-report-page",staticStyle:{width:"100%",height:"100%"}},[_vm.exportDownloadUrl?_c("iframe",{staticStyle:{display:"none"},attrs:{src:_vm.exportDownloadUrl}}):_vm._e(),_vm.resultObj?_c("div",{staticClass:"report-header-and-summary header-bar-background",staticStyle:{"border-left":"none"}},[_vm.resultObj?_c("div",{staticClass:"report-name-section",class:"breadcrumb-view",staticStyle:{"padding-left":"50px"}},[_c("el-breadcrumb",{staticClass:"pdf-report",attrs:{separator:""}},[_vm.resultObj?_c("el-breadcrumb-item",{staticClass:"pivot-crumb description",staticStyle:{"font-weight":"500 !important"},model:{value:_vm.reportObj.report,callback:function($$v){_vm.$set(_vm.reportObj,"report",$$v)},expression:"reportObj.report"}},[_vm.resultObj?_c("div",{staticClass:"breadcrumb-text-folder"},[_vm._v(" "+_vm._s(null!=_vm.resultObj.report.description?_vm.resultObj.report.description:"No Description")+" ")]):_vm._e()]):_vm._e(),_vm.reportObj?_c("el-breadcrumb-item",{staticClass:"pivot-crumb report-name",staticStyle:{"font-weight":"500 !important","font-size":"16px !important"}},[_vm._v(" "+_vm._s(_vm.resultObj.report.name))]):_vm._e()],1),_c("div",{staticClass:"module-report-options"},[_c("f-report-options",{staticClass:"pull-right analytics-page-options-building-analysis newreport-page-options",attrs:{moduleName:_vm.moduleName,pdf:!0,optionClass:"analytics-page-options",optionsToEnable:[1,2,4],reportObject:_vm.reportObj,resultObject:_vm.resultObj,params:_vm.reportObj?_vm.reportObj.params:null,newflow:!0,optionSettings:_vm.reportObj&&_vm.reportObj.options?_vm.reportObj.options.settings:null},on:{editReport:_vm.editReport,deleteReport:_vm.deleteReport,duplicateReport:_vm.duplicateReport}})],1),_vm.showPrintDetails&&_vm.$org.logoUrl?_c("div",{staticClass:"fc-logo-report"},[_c("img",{staticClass:"logo-pdf",attrs:{src:_vm.$org.logoUrl}})]):_vm.showPrintDetails?_c("div",{staticClass:"fc-logo-report"},[_vm.showLogo?_c("img",{attrs:{src:_vm.getFacilioLogoURL}}):_vm._e()]):_vm._e()],1):_vm._e()]):_vm._e(),_vm.showPrintDetails?_c("div",{staticClass:"fc-report-author-sec",class:[_vm.$helpers.isPortalUser()?"fc-report-pdf-height":""]},[_c("div",{staticClass:"fc-report-author-txt"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.generated_on"))+" "),_c("span",{staticClass:"fw6"},[_vm._v(" "+_vm._s(_vm._f("formatDate")(_vm._f("now")("")))+" ")])]),_c("div",{staticClass:"fc-report-author-txt"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.generated_by"))+" "),_c("span",{staticClass:"fw6"},[_vm._v(" "+_vm._s(_vm.$account.user.name)+" ")])]),_c("div",{staticClass:"fc-report-author-txt flex-middle"},[_c("div",{staticClass:"f9 fw6"},[_c("span",{staticClass:"fc-report-author-txt"},[_vm._v(_vm._s(""!==_vm.getDateRangeString.dateFieldLabel?_vm.getDateRangeString.dateFieldLabel.concat(":"):""))]),_vm._v(" "+_vm._s(_vm.getDateRangeString.label)+" ")])])]):_vm._e(),_vm.reportId?_vm._m(0):_vm._e(),_vm.resultObj?_c("MoveReportToDashBoard",{attrs:{moduleName:_vm.moduleName,enableMoveDialog:_vm.sendToDashBoard,reportObj:_vm.resultObj},on:{"update:enableMoveDialog":function($event){_vm.sendToDashBoard=$event},"update:enable-move-dialog":function($event){_vm.sendToDashBoard=$event}}}):_vm._e()],1)},staticRenderFns=[function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"scrollable height100 chart-table-layout p20",staticStyle:{"max-height":"calc(100vh - 100px)"}},[_c("module-new-report",{staticClass:"fc-report-pdf-chart",class:[_vm.showOnlyImage?"fc-report-image-chart":"",_vm.$helpers.isPortalUser()?"fc-report-pdf-portal":""],attrs:{id:_vm.reportId},on:{reportLoaded:_vm.reportLoaded}})],1)}],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),moment_timezone=(__webpack_require__(976801),__webpack_require__(434284),__webpack_require__(670560),__webpack_require__(480008)),moment_timezone_default=__webpack_require__.n(moment_timezone),ModuleNewReport=__webpack_require__(518999),FReportOptions=__webpack_require__(791514),ReportHelper=__webpack_require__(507815),NewReportSummaryHelper=__webpack_require__(601458),NewDataFormatHelper=__webpack_require__(804911),MoveReportToDashBoard=__webpack_require__(967850),ModularAnalyticmixin=__webpack_require__(795e3),api=__webpack_require__(32284),validation=__webpack_require__(990260),router=__webpack_require__(329435),vue_runtime_esm=__webpack_require__(720144),ModuleNewReportSummaryvue_type_script_lang_js={mixins:[ReportHelper/* default */.Z,NewReportSummaryHelper/* default */.Z,NewDataFormatHelper/* default */.Z,ModularAnalyticmixin/* default */.Z],components:{FReportOptions:FReportOptions/* default */.Z,MoveReportToDashBoard:MoveReportToDashBoard/* default */.Z,ModuleNewReport:ModuleNewReport/* default */.Z},data:function(){return{reportObj:null,resultObj:null,exportDownloadUrl:null,schedule:!1,email:!1,duplicateReportToggle:!1,currentDateFilter:null,renameDialogVisibility:!1,sendToDashBoard:!1,moduleName:null,isCustomModule:!1,underlyingFields:[]}},computed:{getFacilioLogoURL:function(){var brandConfig=this.brandConfig,logo=this.$getProperty(brandConfig,"logo",null);return logo},showLogo:function(){var brandConfig=this.brandConfig,showLogoInPDF=this.$getProperty(brandConfig,"showLogoInPDF",!0);return showLogoInPDF},brandConfig:function(){return window.brandConfig},reportId:function(){var reportId=this.$attrs.reportid||this.$route.params.reportid;return parseInt(reportId)},reportParams:function(){var params={reportId:this.reportId};return this.resultObj&&(params.mode=this.resultObj.mode,this.reportObj.dateRange&&(params.startTime=this.reportObj.dateRange.time[0],params.endTime=this.reportObj.dateRange.time[1],params.dateOperator=this.reportObj.dateRange.operatorId,params.dateOperatorValue=this.reportObj.dateRange.value),params.chartType=this.reportObj.options.type),params},getDateRangeString:function(){var temp={dateFieldLabel:"",label:""};if(this.resultObj){var dateField=this.resultObj.report.dataPoints[0].dateField,xField=this.resultObj.report.dataPoints[0].xAxis,dateFieldString="";if(xField&&(xField&&dateField&&xField.fieldId!==dateField.fieldId&&(temp["dateFieldLabel"]=dateField.label),dateField)){var a=moment_timezone_default()(this.resultObj.report.dateRange.startTime).tz(vue_runtime_esm["default"].prototype.$timezone);return dateFieldString=a.format("DD/MM/YYYY")+" to ",a=moment_timezone_default()(this.resultObj.report.dateRange.endTime).tz(vue_runtime_esm["default"].prototype.$timezone),dateFieldString=dateFieldString+a.format("DD/MM/YYYY")+" ",temp["label"]=dateFieldString,temp}return temp}return temp}},methods:{duplicateReport:function(reportId){this.duplicateReportToggle=!0,this.editReport(reportId)},openReportInView:function(reportId){reportId?window.location.href=this.getNewReportLink(reportId):(this.duplicateDialog=!1,window.location.href=this.getNewReportLink(this.duplicatedReport.id))},moduleRolePermission:function(){var currentModule=this.getCurrentModule(),moduleName=currentModule.module;return"energydata"===currentModule.module&&(moduleName="energy"),!["workorder","alarm","energy"].includes(moduleName)||this.$hasPermission(moduleName+":CREATE_EDIT_REPORTS")},reportLoaded:function(reportObj,resultObj){this.moduleName=resultObj.module.name,this.isCustomModule=resultObj.module.custom,this.reportObj=reportObj,this.resultObj=resultObj},getNewReportLink:function(reportId){return this.getCurrentModule().rootPath+"/newview/"+reportId},editReport:function(id){var path=this.getModularReportEditURL(this.moduleName);if(this.$helpers.isEtisalat()?path="/app/em/modulereports/new":this.isCustomModule&&(path="/app/ca/reports/new"),(0,router/* isWebTabsEnabled */.tj)()){var _ref=(0,router/* findRouteForReport */.Mq)("module_reports",router/* pageTypes */.As.REPORT_FORM,{moduleName:this.moduleName})||{},name=_ref.name,query={reportId:id,module:this.moduleName?this.moduleName:null};if(!0===this.duplicateReportToggle&&(query.duplicate=!0),name)this.$router.push({name:name,query:query});else if((0,validation/* isEmpty */.xb)(name)){var parentModule=ReportHelper/* default */.Z.findModuleFromSubmodule(this.moduleName),_ref2=(0,router/* findRouteForReport */.Mq)("module_reports",router/* pageTypes */.As.REPORT_FORM,{moduleName:parentModule})||{},_name=_ref2.name;_name&&this.$router.push({name:_name,query:query})}}else this.duplicateReportToggle?this.$router.push({path:path,query:{reportId:id,duplicate:!0,module:this.moduleName?this.moduleName:null}}):this.$router.push({path:path,query:{reportId:id,module:this.moduleName?this.moduleName:null}})},deleteReport:function(id){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var promptObj,deleteConfirmation,_yield$API$delete,data,error,confirmObj,widgetDeleteConfirm,resp;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return promptObj={title:"Delete Report",message:"Are you sure you want to delete this Report?",rbDanger:!0,rbLabel:"Delete"},_context.next=3,_this.$dialog.confirm(promptObj);case 3:if(deleteConfirmation=_context.sent,!deleteConfirmation){_context.next=28;break}return _context.next=7,api/* API */.bl.delete("/v3/report/delete",{reportId:id});case 7:if(_yield$API$delete=_context.sent,data=_yield$API$delete.data,error=_yield$API$delete.error,!error){_context.next=14;break}_this.$message.error("Failed to delete report, please try again.",error),_context.next=28;break;case 14:if(!data||!data.errorString){_context.next=26;break}return confirmObj={title:"Delete Report",message:"This report is associated to a dashboard widget. Deleting this report will remove the widget from the dashboard. Are you sure you want to continue?",rbLabel:"Yes, delete",lbLabel:"No, cancel"},_context.next=18,_this.$dialog.confirm(confirmObj);case 18:if(widgetDeleteConfirm=_context.sent,!widgetDeleteConfirm){_context.next=24;break}return _context.next=22,api/* API */.bl.delete("/v3/report/delete",{reportId:id,deleteWithWidget:!0});case 22:resp=_context.sent,resp.error?_this.$message.error("Failed to delete report, please try again.",error):(_this.$emit("reportDeleted",{type:"new",reportId:id}),_this.$message.success("Report deleted successfully"));case 24:_context.next=28;break;case 26:_this.$emit("reportDeleted",{type:"new",reportId:id}),_this.$message.success("Report deleted successfully");case 28:case"end":return _context.stop()}}),_callee)})))()}}},report_ModuleNewReportSummaryvue_type_script_lang_js=ModuleNewReportSummaryvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(report_ModuleNewReportSummaryvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,ModuleNewReportSummary=component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/70857.js.map