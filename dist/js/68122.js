"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[68122],{
/***/574752:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return Avatar}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/Avatar.vue?vue&type=template&id=7f0d5689
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.user||_vm.name?_c("div",{staticClass:"fc-avatar-inline"},[_vm.avatarUrl?_c("img",{staticClass:"fc-avatar",class:_vm.sizeClass,attrs:{src:_vm.avatarUrl,alt:"Profile Avatar"}}):_c("div",{staticClass:"fc-avatar",class:_vm.sizeClass,style:_vm.bgColor},[_vm._v(" "+_vm._s(_vm.trimmedName)+" ")])]):_vm._e()},staticRenderFns=[],objectSpread2=__webpack_require__(595082),vuex_esm=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(434284),__webpack_require__(564043),__webpack_require__(709873),__webpack_require__(228436),__webpack_require__(450886),__webpack_require__(677049),__webpack_require__(821694),__webpack_require__(420629)),Avatarvue_type_script_lang_js={props:{size:{type:String},user:{type:Object},avatarStyle:{type:Object},color:{type:String},name:{type:Boolean}},data:function(){return{sizeClass:"fc-avatar-"+this.size,fullName:"",trimmedName:null,avatarUrl:null,bgColor:"background-color: "+(this.color?this.color:this.getRandomBgColor())}},computed:(0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({users:function(state){return state.users}})),mounted:function(){var _this=this;if(this.user){var userName="";if(this.user.avatarUrl)this.avatarUrl=this.user.avatarUrl;else if(this.user.id){var userObj=this.users.find((function(user){return user.id===_this.user.id}));userObj&&userObj.avatarUrl&&(this.avatarUrl=userObj.avatarUrl),userObj&&userObj.name&&(userName=userObj.name)}userName=userName||this.user.name,userName&&(this.fullName=userName,this.trimmedName=this.getAvatarName(userName),this.bgColor="background-color: "+(this.color?this.color:this.getRandomBgColor()))}else this.name&&(this.trimmedName=this.getAvatarName(this.name),this.bgColor="background-color: "+(this.color?this.color:this.getRandomBgColor()))},watch:{user:function(){var _this2=this;if(this.user.avatarUrl)this.avatarUrl=this.user.avatarUrl;else if(this.user.id){var userObj=this.users.find((function(user){return user.id===_this2.user.id}));userObj&&userObj.avatarUrl?this.avatarUrl=userObj.avatarUrl:this.avatarUrl=null}else this.avatarUrl=null;this.user.name&&(this.fullName=this.user.name,this.trimmedName=this.getAvatarName(this.user.name),this.bgColor="background-color: "+(this.color?this.color:this.getRandomBgColor()))},"user.name":function(){this.user.name&&(this.fullName=this.user.name,this.trimmedName=this.getAvatarName(this.user.name),this.bgColor="background-color: "+(this.color?this.color:this.getRandomBgColor()))},"user.avatarUrl":function(){this.user.avatarUrl?this.avatarUrl=this.user.avatarUrl:this.avatarUrl=null},"user.id":function(){var _this3=this;if(this.user.id){var userObj=this.users.find((function(user){return user.id===_this3.user.id}));userObj&&userObj.avatarUrl?this.avatarUrl=userObj.avatarUrl:this.avatarUrl=null}else this.avatarUrl=null}},methods:{getAvatarName:function(name){for(var parts=name.split(/[ -]/),initials="",initialLen=2,count=0,i=0;i<parts.length;i++)if(""!==parts[i].trim()&&(initials+=parts[i].charAt(0),count++,count>=initialLen))break;initials.length<initialLen&&name.length>=initialLen&&(initials=name.trim().substring(0,initialLen));var avatarName=initials.toUpperCase();return avatarName},getRandomBgColor:function(){var colors=["#FFBA51","#34BFA3","#FF2F82","#29D9A7","#ECDC74","#927FED","#FF61A8","#fbf383","#ac4352","#6db1f4"],userKey=this.user.email?this.user.email:this.user.name,userUniqueNum=Array.from(userKey).map((function(letter){return letter.charCodeAt(0)})).reduce((function(current,previous){return previous+current})),colorIndex=userUniqueNum%colors.length,color=colors[colorIndex];return color}}},components_Avatarvue_type_script_lang_js=Avatarvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_Avatarvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,Avatar=component.exports},
/***/268122:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return ActivityWidget}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/page/widget/common/ActivityWidget.vue?vue&type=template&id=163cbee3
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{ref:"activities-container"},[_c("div",{staticClass:"flex-middle justify-content-space"},[_c("div",{staticClass:"pL30 pT30"},[_c("div",{staticClass:"fc-black-com f14 bold pL10"},[_vm._v(" "+_vm._s(_vm.$t("asset.history.history"))+" ")])]),_vm.$helpers.isLicenseEnabled("COMMISSIONING")?_c("div",{staticClass:"pT20 pR30"},[_c("el-dropdown",{staticClass:"fc-dropdown-menu-border",attrs:{trigger:"click"}},[_c("el-button",{staticClass:"fc-btn-group-white",attrs:{type:"primary"}},[_c("div",[_vm._v(" "+_vm._s(_vm.fixedFilter)+" "),_c("i",{staticClass:"el-icon-arrow-down"})])]),_c("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[_c("el-dropdown-item",[_c("div",{on:{click:function($event){return _vm.setActualActivity()}}},[_vm._v(" "+_vm._s(_vm.$t("setup.decommission.actual_log"))+" ")])]),_c("el-dropdown-item",[_c("div",{on:{click:function($event){return _vm.setLogActivity()}}},[_vm._v(" "+_vm._s(_vm.$t("setup.decommission.commissioning_log"))+" ")])])],1)],1)],1):_vm._e()]),_vm.isActualActivity?_c("activities",{ref:"activitiesDiv",attrs:{record:_vm.details,module:_vm.moduleName,activityModule:_vm.activityModule},on:{autoResizeWidget:_vm.autoResize}}):_c("LogActivities",{attrs:{recordId:_vm.recordId,selectedModule:_vm.moduleName,details:_vm.details},on:{autoResizeWidget:_vm.autoResize}})],1)},staticRenderFns=[],Activitiesvue_type_template_id_6b9869a0_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"block mL30 mT20"},[_vm.loading?_c("spinner",{attrs:{size:80,show:_vm.loading}}):_c("el-timeline",{staticClass:"wo-activity"},[_vm.$validation.isEmpty(_vm.activities)?_c("div",[_c("div",{staticClass:"flex-middle width100  justify-center shadow-none white-bg-block flex-direction-column"},[_c("InlineSvg",{attrs:{src:"svgs/emptystate/history",iconClass:"icon icon-xxxxlg mR10"}}),_c("div",{staticClass:"nowo-label text-center pT10"},[_vm._v(" "+_vm._s(_vm.$t("asset.history.no_history_available"))+" ")])],1)]):_vm._l(_vm.activities,(function(activity,index){return[null!==_vm.getMessage(activity).message?_c("el-timeline-item",{key:index,attrs:{type:"primary",color:activity.color,timestamp:_vm._f("formatDate")(activity.ttime)}},[[83,3].includes(activity.type)&&null!==_vm.getMessage(activity).message&&activity.info.assigned?_c("div",[_c("avatar",{attrs:{size:"sm",user:{name:activity.doneBy.name}}}),_vm._v(" "+_vm._s(activity.doneBy.name)+" "),activity.info.assigned.assignedTo?[activity.info.assigned.assignedTo>0?[_c("span",{domProps:{innerHTML:_vm._s(_vm.getMessage(activity).message)}}),_vm._v(" "+_vm._s(" ")+" "),_c("avatar",{attrs:{size:"sm",user:{name:_vm.getUserName(activity.info.assigned.assignedTo,activity)}}}),_vm._v(" "+_vm._s(" ")+" "),_c("i",[_vm._v(_vm._s(_vm.getUserName(activity.info.assigned.assignedTo,activity)))])]:[_c("b",[_vm._v("removed the staff")])]]:[activity.info.assigned.assignmentGroup>0?[_c("span",{domProps:{innerHTML:_vm._s(_vm.getMessage(activity).message)}}),_vm._v(" team "),_c("i",[_vm._v(_vm._s(_vm.getGroup(activity.info.assigned.assignmentGroup,activity).name))])]:[_c("b",[_vm._v("removed the team")])]]],2):24===activity.type&&null!==_vm.getMessage(activity).message?_c("div",[_c("avatar",{attrs:{size:"sm",user:{name:activity.doneBy.name}}}),_vm._v(" "+_vm._s(activity.doneBy.name)+" "),_c("span",{domProps:{innerHTML:_vm._s(_vm.getMessage(activity).message)}}),_c("i",[_c("span",{staticClass:"fc-id pointer",on:{click:function($event){return _vm.openPm(activity.info.addPMWO[0].pmid)}}},[_vm._v("# "+_vm._s(activity.info.addPMWO[0].pmid))])])],1):68===activity.type&&null!==_vm.getMessage(activity).message?_c("div",[_c("avatar",{attrs:{size:"sm",user:{name:activity.doneBy.name}}}),_vm._v(" "+_vm._s(activity.doneBy.name)+" "),_c("span",{domProps:{innerHTML:_vm._s(_vm.getMessage(activity).message)}}),_c("span",{staticClass:"f12 fc-dark-blue3-13 bold pointer mL10",on:{click:function($event){return _vm.openQuotationPreview(activity.info.quotationId)}}},[_c("i",{staticClass:"el-icon-view mR3 f13"}),_vm._v(" Preview")])],1):null!==_vm.getMessage(activity).message?_c("div",[_c("avatar",{attrs:{size:"sm",user:{name:activity.doneBy.name}}}),_vm._v(" "+_vm._s(activity.doneBy.name)+" "),_c("span",{domProps:{innerHTML:_vm._s(_vm.getMessage(activity).message)}})],1):_vm._e()]):_vm._e()]}))],2)],1)},Activitiesvue_type_template_id_6b9869a0_staticRenderFns=[],toConsumableArray=__webpack_require__(488478),objectSpread2=__webpack_require__(595082),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),vuex_esm=(__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(434284),__webpack_require__(564043),__webpack_require__(857267),__webpack_require__(670560),__webpack_require__(919649),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(634338),__webpack_require__(648324),__webpack_require__(450886),__webpack_require__(420629)),Avatar=__webpack_require__(574752),ActivitiesMixin=__webpack_require__(832568),api=__webpack_require__(32284),validation=__webpack_require__(990260),Activitiesvue_type_script_lang_js={props:["record","serviceportal","module","activityModule"],mixins:[ActivitiesMixin/* default */.Z],components:{Avatar:Avatar["default"]},created:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _this.$store.dispatch("loadUsers"),
// this.$store.dispatch('loadTicketType')
// this.$store.dispatch('loadTicketPriority')
// this.$store.dispatch('loadSite')
_this.$store.dispatch("loadGroups"),_context.next=4,_this.loadActivities();case 4:return _this.$store.dispatch("view/loadModuleMeta",_this.module),_context.next=7,_this.loadusers();case 7:_this.$nextTick((function(){_this.$emit("autoResizeWidget")}));case 8:case"end":return _context.stop()}}),_callee)})))()},data:function(){return{activities:[],loading:!0,portalUserList:[]}},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({
// users: state => state.users,
// sites: state => state.site,
metaInfo:function(state){return state.view.metaInfo}})),(0,vuex_esm/* mapGetters */.Se)([
// 'getUser',
"getGroup"])),{},{fieldsMap:function(){var _this2=this,metaInfo=this.metaInfo,map={};if(!(0,validation/* isEmpty */.xb)(metaInfo)){var fields=this.$getProperty(metaInfo,"fields",[]);fields.forEach((function(field){_this2.$setProperty(map,"".concat(field.name),field)}))}return map}}),watch:{record:function(){var _record=(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var _this3=this;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,this.loadActivities();case 2:return _context2.next=4,this.loadusers();case 4:this.$nextTick((function(){_this3.$emit("autoResizeWidget")}));case 5:case"end":return _context2.stop()}}),_callee2,this)})));function record(){return _record.apply(this,arguments)}return record}()},methods:{openPm:function(id){this.$router.replace({path:"/app/wo/planned/summary/"+id})},loadusers:function(){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var activities,assignedToIds,userIds,params,_yield$API$get,error,data;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:if(_this4.loading=!0,activities=_this4.activities,// let ouids = [],
assignedToIds=[],activities.forEach((function(activity){var $getProperty=_this4.$getProperty,assignedToId=$getProperty(activity,"info.assigned.assignedTo",null);
// let ouid = $getProperty(activity, 'doneBy.ouid', null)
// !isEmpty(ouid) && ouids.push(`${ouid}`)
(0,validation/* isEmpty */.xb)(assignedToId)||-99===assignedToId||assignedToIds.push("".concat(assignedToId))})),userIds=(0,toConsumableArray/* default */.Z)(new Set([].concat(assignedToIds))),(0,validation/* isEmpty */.xb)(userIds)){_context3.next=13;break}return params={includeParentFilter:!0,filters:JSON.stringify({ouid:{operatorId:36,value:userIds}})},_context3.next=9,api/* API */.bl.get("/setup/portalUsersList",params);case 9:_yield$API$get=_context3.sent,error=_yield$API$get.error,data=_yield$API$get.data,error||(_this4.portalUserList=data.users||[]);case 13:_this4.loading=!1;case 14:case"end":return _context3.stop()}}),_callee3)})))()},loadActivities:function(){var _this5=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){var params,_yield$API$post,error,data,activityList;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:if(!_this5.activityModule){_context4.next=10;break}return params={},"newreadingalarm"===_this5.module?params.occurrenceId=_this5.record.occurrence.id:params["parentId"]=_this5.record.id,_this5.loading=!0,_context4.next=6,api/* API */.bl.post("/v2/activity/"+_this5.activityModule,params);case 6:_yield$API$post=_context4.sent,error=_yield$API$post.error,data=_yield$API$post.data,error?_this5.$message.error(error.message):(activityList=(null===data||void 0===data?void 0:data.activity)||[],"newreadingalarm"===_this5.module&&(activityList=activityList.map((function(activity){return activity.data}))),_this5.activities=activityList);case 10:_this5.loading=!1;case 11:case"end":return _context4.stop()}}),_callee4)})))()},
// compare(str1, str2) {
//   return !str1.localeCompare(str2)
// },
// getSiteName(siteId) {
//   let site = this.sites.find(site => site.id === siteId)
//   return site ? site.name : ''
// },
openQuotationPreview:function(id){window.open("".concat(window.location.protocol,"//").concat(window.location.host,"/app/pdf/quotationpdf?quotationId=").concat(id))}}},widget_Activitiesvue_type_script_lang_js=Activitiesvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(widget_Activitiesvue_type_script_lang_js,Activitiesvue_type_template_id_6b9869a0_render,Activitiesvue_type_template_id_6b9869a0_staticRenderFns,!1,null,null,null)
/* harmony default export */,Activities=component.exports,LogActivities=__webpack_require__(137725),ActivityWidgetvue_type_script_lang_js={props:["details","layoutParams","hideTitleSection","groupKey","activeTab","moduleName","resizeWidget","widget"],components:{Activities:Activities,LogActivities:LogActivities/* default */.Z},data:function(){return{record:{},fixedFilter:"All History",isActualActivity:!0}},mounted:function(){this.setDefaultData(),this.autoResize()},computed:{activityModule:function(){return this.getActivityModuleName()},recordId:function(){return this.$getProperty(this,"details.id",null)}},methods:{setDefaultData:function(){"newreadingalarm"===this.moduleName&&(this.record.id=this.details.alarm.id,this.record.occurrencId=this.details.occurrence.id)},setActualActivity:function(){this.isActualActivity=!0,this.fixedFilter=this.$t("setup.decommission.actual_log")},setLogActivity:function(){this.isActualActivity=!1,this.fixedFilter=this.$t("setup.decommission.commissioning_log")},getActivityModuleName:function(){return"newreadingalarm"===this.moduleName?"alarmActivity":this.$getProperty(this,"widget.widgetParams.activityModuleName")},autoResize:function(){var _this=this;this.$nextTick((function(){var height=_this.$refs["activities-container"].scrollHeight+50,width=_this.$refs["activities-container"].scrollWidth;_this.resizeWidget&&_this.resizeWidget({height:height,width:width})}))}}},common_ActivityWidgetvue_type_script_lang_js=ActivityWidgetvue_type_script_lang_js,ActivityWidget_component=(0,componentNormalizer/* default */.Z)(common_ActivityWidgetvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,ActivityWidget=ActivityWidget_component.exports},
/***/832568:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return ActivitiesMixin}});
// EXTERNAL MODULE: ./node_modules/core-js/modules/es.array.find.js
__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(434284),__webpack_require__(976801),__webpack_require__(538077),__webpack_require__(634338),__webpack_require__(879288),__webpack_require__(450886),__webpack_require__(506203),__webpack_require__(689730);
// EXTERNAL MODULE: ./node_modules/core-js/modules/es.object.to-string.js
var render,staticRenderFns,validation=__webpack_require__(990260),field_utils=__webpack_require__(455344),isEqual=__webpack_require__(618446),isEqual_default=__webpack_require__.n(isEqual),ActivitiesMixinvue_type_script_lang_js={methods:{getUserName:function(id){if(id){var user=null;return user=(this.users||[]).find((function(us){return us.ouid===id})),user?user.name:(0,validation/* isEmpty */.xb)(this.portalUserList)?"---2":(user=(this.portalUserList||[]).find((function(u){return u.ouid===id})),user?user.name:"---1")}return"---3"},getAttachmentsString:function(obj){for(var str="",item=0;item<(obj||[]).length;item++)0!==item&&(item===obj.length-1?str+=" and ":str+=", "),str+=obj[item];return str},getAssignedBy:function(updatedFields){var user=(updatedFields||[]).find((function(el){return"assignedTo"===el.fieldName}));return user.newValue?this.getUser(user.newValue.id).name:user.oldValue?this.getUser(user.oldValue.id).name:void 0},getLocation:function(value){return this.$helpers.parseLocation(value)},getMessage:function(activity){var _this=this,_ref=activity||{},info=_ref.info,module=this.module,fieldsMap=this.fieldsMap;if("newreadingalarm"===module)return this.processAlarmActivity(activity);if([63,64,70,71].includes(activity.type))return this.formatQuotationActivity(activity);if(75===activity.type&&!(0,validation/* isEmpty */.xb)(info.changeSet)){var filteredArr=info.changeSet.filter((function(a){var _ref2=a||{},fieldName=_ref2.field,newValue=_ref2.newValue,oldValue=_ref2.oldValue,field=fieldsMap[fieldName]||{},isMultiLookupChanged=!0;return(0,field_utils/* isMultiLookupField */.Xn)(field)&&(isMultiLookupChanged=(newValue||[]).length!==(oldValue||[]).length),isMultiLookupChanged&&"modifiedTime"!==a.field&&-99!==a.newValue&&!((0,validation/* isEmpty */.xb)(a.oldValue)&&(0,validation/* isEmpty */.xb)(a.newValue))&&!isEqual_default()(a.oldValue,a.newValue)&&"moduleState"!==a.field&&"sysModifiedTime"!==a.field}));return(0,validation/* isEmpty */.xb)(filteredArr)?{message:null}:{message:"<b>updated </b>"+filteredArr.reduce((function(accStr,activity){return(0,validation/* isEmpty */.xb)(accStr)?_this.getValue(activity):"".concat(accStr,", ").concat(_this.getValue(activity))}),"")}}
// 64,66,69,71,72 Common Activities for Comment, Attachments, Status Update, Approval, Approval Entry respectively
// use same for other modules
if(65===activity.type)return{message:"<b> added the Comment </b><i>("+this.$getProperty(activity,"info.Comment","")+")</i>"};if(66===(activity||{}).type)return{message:"<b>attached </b><i>"+this.$getProperty(activity,["info","attachment",0,"Filename"],"")+"</i>"};if(69===(activity||{}).type)return{message:"<b>updated status </b>from <i>"+this.$getProperty(activity,"info.oldValue","")+" to "+this.$getProperty(activity,"info.newValue","")+"</i>"};if(72===(activity||{}).type){
// Approval Activity Message
var metaInfo=this.metaInfo,_ref3=metaInfo||{},_module=_ref3.module,_ref4=_module||{},displayName=_ref4.displayName;(0,validation/* isEmpty */.xb)(displayName)&&(displayName=_module);var approvalMessage="",approvalStatus=this.$getProperty(activity,"info.status",""),moduleSingularDisplayName=this.$constants.moduleSingularDisplayNameMap[_module]?this.$constants.moduleSingularDisplayNameMap[_module]:displayName;return"Approved"===approvalStatus?approvalMessage="<b> approved the ".concat(moduleSingularDisplayName,"</b>"):"Rejected"===approvalStatus?approvalMessage="<b> rejected the ".concat(moduleSingularDisplayName,"</b>"):"Requested"===approvalStatus&&(approvalMessage="<b> resent for Approval.</b>"),{message:approvalMessage}}if(73===(activity||{}).type)return{message:"<b> initiated Approval process</b>"};if(109===(activity||{}).type){var employee=((null===info||void 0===info?void 0:info.changeSet)||[]).find((function(a){return"employee"===a.field&&a.newValue>0&&a.oldValue!==a.newValue}));return employee?{message:"<b> assigned <i>".concat(info.empName,"</i> to desk <i>").concat(info.deskName,"</i> </b>")}:{message:null}}if(110===(activity||{}).type){var _employee=((null===info||void 0===info?void 0:info.changeSet)||[]).find((function(a){return"employee"===a.field&&a.oldValue>0&&a.oldValue!==a.newValue}));return _employee?{message:"<b> unassigned <i>".concat(info.empName,"</i> from desk <i>").concat(info.deskName,"</i> </b>")}:{message:null}}return{message:"<b>"+activity.message+"</b>"}},getValue:function(info){var fieldsMap=this.fieldsMap,_ref5=info||{},fieldName=_ref5.field,newValue=_ref5.newValue,oldValue=_ref5.oldValue,field=fieldsMap[fieldName]||{},displayValue=newValue,displayOldValue=oldValue;if(!(0,validation/* isEmpty */.xb)(field)&&((0,validation/* isArray */.kJ)(displayValue)||Number(displayValue)&&(displayValue=Number(displayValue)),displayValue=this.$fieldUtils.getDisplayValue(field,displayValue),(0,validation/* isArray */.kJ)(displayOldValue)||Number(displayOldValue)&&(displayOldValue=Number(displayOldValue)),!(0,validation/* isEmpty */.xb)(displayOldValue)))if((0,field_utils/* isMultiLookupField */.Xn)(field)){var lookupRecordNames=(displayOldValue||[]).map((function(currRecord){return currRecord.displayName||currRecord.name||currRecord.subject}));displayOldValue=lookupRecordNames.length>5?"".concat(lookupRecordNames.slice(0,5).join(", ")," +").concat(Math.abs(lookupRecordNames.length-5)):(0,validation/* isEmpty */.xb)(lookupRecordNames)?"---":"".concat(lookupRecordNames.join(", "))}else displayOldValue=this.$fieldUtils.getDisplayValue(field,displayOldValue);return(0,validation/* isEmpty */.xb)(displayOldValue)||"---"===displayOldValue?"<b>"+info.displayName+"</b> as <i>"+displayValue+"</i>":"<b>"+info.displayName+"</b> from <i>"+displayOldValue+"</i> to <i>"+displayValue+"</i>"},processAlarmActivity:function(activity){return 50===activity.type?{message:"<b>created alarm occurrence </b>"}:51===activity.type?{message:"<b> created workorder </b>"}:53===activity.type?{message:"<b> Acknowledged Alarm </b>"}:54===activity.type?{message:"<b> added the Comment </b><i>("+activity.infoJsonStr.Comment+")</i>"}:56===activity.type?{message:"<b> alarm occurrence cleared </b>"}:57===activity.type?{message:"<b> Auto Cleared </b>"}:"Activity"},formatQuotationActivity:function(activity){var amount,message="",val=this.$getProperty(activity,"info.totalCost",null);return val&&(val=this.$d3.format(",.2f")(val),amount="$"===this.$currency||"â‚¹"===this.$currency?this.$currency+val:val+" "+this.$currency),63===activity.type?message="<b> Created the Quote for </b>"+(amount?"<i>".concat(amount,"</i>"):""):64===activity.type?message="<b> Updated the Quote.</b>"+(amount?"<b> Amount changed to</b> <i>".concat(amount,"</i>"):""):70===activity.type?message="<b> Associated Term(s)</b> <i>".concat(this.$getProperty(activity,"info.termsName"),"</i>"):71===activity.type&&(message="<b> Disassociated Term(s) </b> <i>".concat(this.$getProperty(activity,"info.termsName"),"</i>")),{message:message}}}},widget_ActivitiesMixinvue_type_script_lang_js=ActivitiesMixinvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(widget_ActivitiesMixinvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,ActivitiesMixin=component.exports},
/***/137725:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return LogActivities}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/widget/decommission/LogActivities.vue?vue&type=template&id=2a85bcb5
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"block mL30 mT20"},[_c("el-timeline",{staticClass:"decommission-activity"},[_vm.loading?_c("spinner",{attrs:{size:80,show:_vm.loading}}):_vm.isLogsEmpty?_c("div",[_c("div",{staticClass:"flex-middle width100 height80vh justify-center shadow-none white-bg-block flex-direction-column"},[_c("InlineSvg",{attrs:{src:"svgs/emptystate/history",iconClass:"icon icon-xxxxlg mR10"}}),_c("div",{staticClass:"nowo-label text-center pT10"},[_vm._v(" "+_vm._s(_vm.$t("setup.decommission.no_logs"))+" ")])],1)]):_vm._l(_vm.activities,(function(activity,index){return[_vm.$validation.isEmpty(_vm.getMessage(activity))?_vm._e():_c("el-timeline-item",{key:index,attrs:{type:"primary",color:activity.color,timestamp:_vm._f("formatDate")(activity.commissionedTime)}},[_c("div",{staticClass:"pT4"},[_c("avatar",{attrs:{size:"sm",user:{name:_vm.getUserName(activity)}}}),_vm._v(" "+_vm._s(_vm.getUserName(activity))+" "),_c("span",{domProps:{innerHTML:_vm._s(_vm.getMessage(activity))}}),_c("span",{staticClass:"tag-style pL25 pointer f14",attrs:{type:"text"},on:{click:function($event){return _vm.viewLogDialog(activity)}}},[_vm._v(" "+_vm._s(_vm.$t("setup.decommission.log"))+" ")])],1)])]}))],2),_vm.showLogDialog?_c("DecommissionLogDialog",{attrs:{centerDialogVisible:_vm.showLogDialog,rowData:_vm.logResourceData,moduleName:_vm.selectedModule},on:{handleClose:_vm.handleClose}}):_vm._e()],1)},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),api=(__webpack_require__(634338),__webpack_require__(434284),__webpack_require__(648324),__webpack_require__(32284)),DecommissionLogsDialogvue_type_template_id_356200be_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"fc-dialog-center-container dialog-padding-bottom decommission-log-dialog",attrs:{visible:_vm.centerDialogVisible,title:_vm.title,width:"50%","append-to-body":!0,"before-close":_vm.handleClose}},[_c("div",{staticClass:"decommission-container"},[_vm.loading?_c("div",{staticClass:"flex-middle"},[_c("spinner",{attrs:{show:_vm.loading,size:"60"}})],1):_vm.exceptionLogCheck?_vm._e():_c("div",{staticClass:"dialog-style"},[_c("div",{staticClass:"mL30 mT10 f14 time-msg-color"},[_c("span",{staticClass:"text-capitalize bold"},[_vm._v(_vm._s(_vm.getCommisionedUser))]),_c("span",[_vm._v(_vm._s(_vm.getCommissioningTimeMessage))])]),_c("div",{staticClass:"mL30 mR40 seperator mT20"},[_c("div",{staticClass:"width100 height40"},[_c("span",{staticClass:"width100 text-left pB5 dialog-header-color text-fc-black f16 fL"},[_vm._v(_vm._s(_vm.$t("setup.decommission.portfolio")))]),_c("span",{staticClass:"width100 pT5 f12 fc-text-grey"},[_vm._v(" "+_vm._s(_vm.getPortfolioDescription)+" ")])]),_c("div",{staticClass:"mB25"},[_c("div",{staticClass:"width100 pT20 flex-direction-row"},[_c("div",{staticClass:"width100 fw6 text-capitalize flex-direction-row fL bold f14"},[_vm._v(" "+_vm._s(_vm.$t("setup.decommission.resource_name"))+" ")]),_c("div",{staticClass:"width100 flex-direction-row pT8 fL f14"},[_vm._v(" "+_vm._s(_vm.resourceName)+" ")])]),_vm.isLogsEmpty?_vm._e():_c("div",{staticClass:"width100 flex-direction-row "},_vm._l(_vm.portfolioDependency,(function(key,value,index){return _c("div",{key:index,staticClass:"width25 pT20 inline-block"},[_c("div",{staticClass:"width100 fw6 text-capitalize flex-direction-row"},[_vm._v(" "+_vm._s(value)+" ")]),_c("div",{staticClass:"width100 flex-direction-row pT8"},[_vm._v(_vm._s(key))])])})),0)])]),_vm.isModuleDependencyEmpty||_vm.isLogsEmpty?_vm._e():_c("div",{staticClass:"mL30 mR40 seperator mT20"},[_c("div",{staticClass:"width100 height30"},[_c("div",{staticClass:"width100 pB5 text-left dialog-header-color text-fc-black f16 fL"},[_vm._v(" "+_vm._s(_vm.$t("setup.setupLabel.modules"))+" ")]),_c("div",{staticClass:"width100 f12 fc-text-grey"},[_vm._v(" "+_vm._s(_vm.$t("setup.decommission.module_log_description"))+" ")])]),_c("div",{staticClass:"mB25"},[_c("div",{staticClass:"width100 flex-direction-row mT20 width100"},_vm._l(_vm.moduleDependency,(function(item){return _c("div",{key:item,staticClass:"width30 pT10 inline-block"},[_c("div",{staticClass:"width100 fw6 text-capitalize flex-direction-row font-bold"},[_vm._v(" "+_vm._s(_vm.$t("setup.decommission."+_vm.getModuleName(item)))+" ")]),_c("div",{staticClass:"width100 flex-direction-row pT8"},[_vm._v(" "+_vm._s(item.count)+" ")])])})),0)])]),_vm.isRemarksAvailable?_c("div",{staticClass:"mL30 mR40 mT20"},[_c("div",{staticClass:"width100 height40"},[_c("div",{staticClass:"width100 text-left dialog-header-color text-fc-black f16 fL"},[_vm._v(" "+_vm._s(_vm.getRemarkHeader)+" ")])]),_c("div",[_vm._v(_vm._s(_vm.getRemarks))])]):_vm._e()])])])},DecommissionLogsDialogvue_type_template_id_356200be_scoped_true_staticRenderFns=[],validation=(__webpack_require__(169358),__webpack_require__(990260)),filters=__webpack_require__(273861),DecommissionLogsDialogvue_type_script_lang_js={name:"DecommissionLogDialog",props:["centerDialogVisible","rowData","moduleName"],data:function(){return{decommissionLogs:[],loading:!1}},computed:{title:function(){var isDecommissioned=this.isDecommissioned;return"".concat(isDecommissioned?this.$t("setup.decommission.decommissioned"):this.$t("setup.decommission.recommissioned")," log")},getRemarkHeader:function(){var isDecommissioned=this.isDecommissioned;return"".concat(this.$t("setup.decommission.remark")," ").concat(isDecommissioned?"decommissioning":"recommissioning")},exceptionLogCheck:function(){var decommissionLogs=this.decommissionLogs;return(0,validation/* isEmpty */.xb)(decommissionLogs)},commissionedTime:function(){var decommissionLogs=this.decommissionLogs;return this.$getProperty(decommissionLogs,"0.commissionedTime",null)},resourceName:function(){var rowData=this.rowData;return this.$getProperty(rowData,"name",null)},logId:function(){var rowData=this.rowData;return this.$getProperty(rowData,"id",null)},getPortfolioDescription:function(){var moduleName=this.moduleName;return"".concat(this.$t("setup.decommission.portfolio_description")," ").concat(moduleName," .")},portfolioDependency:function(){var decommissionLogs=this.decommissionLogs,logValue=JSON.parse(this.$getProperty(decommissionLogs,"0.logValue",null)),_ref=logValue||{},resource=_ref.resource;return resource},moduleDependency:function(){var decommissionLogs=this.decommissionLogs,logValue=JSON.parse(this.$getProperty(decommissionLogs,"0.logValue",null)),_ref2=logValue||{},modules=_ref2.modules;return modules},isModuleDependencyEmpty:function(){var moduleDependency=this.moduleDependency;return(0,validation/* isEmpty */.xb)(moduleDependency)},isLogsEmpty:function(){var portfolioDependency=this.portfolioDependency,moduleDependency=this.moduleDependency;return(0,validation/* isEmpty */.xb)(portfolioDependency)&&(0,validation/* isEmpty */.xb)(moduleDependency)},isDecommissioned:function(){var decommissionLogs=this.decommissionLogs;return this.$getProperty(decommissionLogs,"0.decommission",null)},getCommissioningTimeMessage:function(){var isDecommissioned=this.isDecommissioned,commissionedTime=this.commissionedTime,moduleName=this.moduleName,type=isDecommissioned?"decommissioned":"recommissioned",time=this.getDecommissionedTime(commissionedTime);return" ".concat(type," this ").concat(moduleName," on ").concat(time)},isRemarksAvailable:function(){var getRemarks=this.getRemarks;return!(0,validation/* isEmpty */.xb)(getRemarks)},getRemarks:function(){var decommissionLogs=this.decommissionLogs;return this.$getProperty(decommissionLogs,"0.remarks",null)},getCommisionedUser:function(){return this.$getProperty(this,"decommissionLogs.0.commissionedBy.name","---")}},created:function(){this.loadDecommissionLogs()},methods:{getDecommissionedTime:function(time){return(0,validation/* isEmpty */.xb)(time)?"---":(0,filters.formatDate)(time)},loadDecommissionLogs:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var logId,filters,params,_yield$API$fetchAll,error,list;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _this.loading=!0,logId=_this.logId,filters={id:{operatorId:9,value:["".concat(logId)]}},params={filters:JSON.stringify(filters),force:!0},_context.next=6,api/* API */.bl.fetchAll("decommissionLog",params);case 6:_yield$API$fetchAll=_context.sent,error=_yield$API$fetchAll.error,list=_yield$API$fetchAll.list,error?_this.$message.error(error.message):(_this.decommissionLogs=list,_this.loading=!1);case 10:case"end":return _context.stop()}}),_callee)})))()},handleClose:function(){this.$emit("handleClose")},getModuleName:function(data){var _ref3=data||{},moduleName=_ref3.moduleName;return null===moduleName||void 0===moduleName?void 0:moduleName.toLowerCase()}}},decommission_DecommissionLogsDialogvue_type_script_lang_js=DecommissionLogsDialogvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(decommission_DecommissionLogsDialogvue_type_script_lang_js,DecommissionLogsDialogvue_type_template_id_356200be_scoped_true_render,DecommissionLogsDialogvue_type_template_id_356200be_scoped_true_staticRenderFns,!1,null,"356200be",null)
/* harmony default export */,DecommissionLogsDialog=component.exports,Avatar=__webpack_require__(574752),LogActivitiesvue_type_script_lang_js={props:["recordId","selectedModule","details"],data:function(){return{activities:[],loading:!1,showLogDialog:!1,logResourceData:{}}},created:function(){this.loadLogs()},computed:{isLogsEmpty:function(){var activities=this.activities;return(0,validation/* isEmpty */.xb)(activities)}},components:{DecommissionLogDialog:DecommissionLogsDialog,Avatar:Avatar["default"]},methods:{getMessage:function(act){var selectedModule=this.selectedModule,_ref=act||{},decommission=_ref.decommission;return"".concat(decommission?"Decommissioned":"Recommissioned",' the  <b class="text-capitalize"> ').concat(selectedModule," </b>.")},viewLogDialog:function(data){this.showLogDialog=!0;var _ref2=data||{},commissionedTime=_ref2.commissionedTime,id=_ref2.id;this.logResourceData={commissionedTime:commissionedTime,name:this.details.name,id:id}},handleClose:function(){this.showLogDialog=!1},getUserName:function(data){var _ref3=data||{},commissionedBy=_ref3.commissionedBy,_ref4=commissionedBy||{},name=_ref4.name;return(0,validation/* isEmpty */.xb)(name)?"Invalid User":name},loadLogs:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var recordId,filters,params,_yield$API$fetchAll,error,list;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _this.loading=!0,recordId=_this.recordId,filters={resourceId:{operatorId:9,value:["".concat(recordId)]}},params={filters:JSON.stringify(filters),force:!0},_context.next=6,api/* API */.bl.fetchAll("decommissionLog",params);case 6:_yield$API$fetchAll=_context.sent,error=_yield$API$fetchAll.error,list=_yield$API$fetchAll.list,error?_this.$message.error((0,validation/* isEmpty */.xb)(error.message)?"Error Occured":error.message):(_this.activities=list,_this.loading=!1,_this.$emit("autoResizeWidget"));case 10:case"end":return _context.stop()}}),_callee)})))()}}},decommission_LogActivitiesvue_type_script_lang_js=LogActivitiesvue_type_script_lang_js,LogActivities_component=(0,componentNormalizer/* default */.Z)(decommission_LogActivitiesvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,LogActivities=LogActivities_component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/68122.js.map