"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[72231],{
/***/855048:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FLookupField}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/forms/FLookupField.vue?vue&type=template&id=473d4b8e
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.isFieldLoading?_c("FieldLoader",{attrs:{isLoading:_vm.isFieldLoading}}):_c("div",{staticClass:"f-lookup-chooser f-lookup-chooser-container"},[_c("el-select",{ref:"selectBox",class:["fc-input-full-border-select2 width100",(!_vm.canHideLookupIcon||_vm.canShowQuickCreateIcon)&&"resource-search",_vm.isMultiple&&"fc-tag",_vm.hideDropDown&&!_vm.disabled&&"skip-disable"],attrs:{"collapse-tags":"",remote:_vm.isRemote,filterable:"",clearable:_vm.canHideLookupIcon,multiple:_vm.isMultiple,popperAppendToBody:_vm.popperAppendToBody,"remote-method":function(searchText){return _vm.remoteMethod(searchText)},loading:_vm.field.isDataLoading,"loading-text":_vm.$t("common._common.searching"),disabled:_vm.disabled||_vm.hideDropDown,placeholder:_vm.field.placeHolderText||"Select"},on:{change:_vm.recordSelected},model:{value:_vm.modelObj,callback:function($$v){_vm.modelObj=$$v},expression:"modelObj"}},[_c("div",{staticClass:"flRight d-flex",class:!_vm.disabled&&"pointer",attrs:{slot:"prefix"},slot:"prefix"},[_vm.canShowSystemClear?_c("div",{staticClass:"flookup-remove-icon-alignment flookup-remove-icon",on:{click:_vm.clearData}},[_c("i",{staticClass:"el-icon-circle-close pointer fc-lookup-icon f13"})]):_vm._e(),_vm.canHideLookupIcon?_vm._e():_c("div",{staticClass:"icon-class-alignment",on:{click:function($event){return $event.stopPropagation(),_vm.openLookupFieldWizard(_vm.field)}}},[_c("inline-svg",{attrs:{src:"lookup",iconClass:"icon icon-sm-md fc-lookup-icon"}})],1),_vm.canShowQuickCreateIcon?_c("div",{staticClass:"icon-class-alignment",on:{click:function($event){return $event.stopPropagation(),_vm.openQuickCreate()}}},[_c("el-tooltip",{attrs:{effect:"dark",content:"Add\n          "+_vm.moduleDisplayName,placement:"top"}},[_c("inline-svg",{attrs:{src:"add-pink",iconClass:"icon icon-sm-md fc-lookup-icon"}})],1)],1):_vm._e()]),_vm._l(_vm.field.options,(function(option,index){return _c("el-option",{key:option.value+" "+index,staticClass:"fc-input-full-border-select2 width100",attrs:{label:option.label,value:option.value}},[_c("span",{staticClass:"fL"},[_vm._v(_vm._s(option.label))]),_vm.$validation.isEmpty(option.secondaryLabel)?_vm._e():_c("span",{staticClass:"select-float-right-text13"},[_vm._v(_vm._s(option.secondaryLabel))]),_vm.getIsSiteDecommissioned(option)?_c("span",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"select-float-right-text13 pL10",attrs:{title:_vm.$t("setup.decommission.decommissioned")}},[_c("fc-icon",{staticClass:"fR pT10",attrs:{group:"alert",name:"decommissioning",size:"16"}})],1):_vm._e()])}))],2),_vm.showQuickCreateData?_c("QuickCreateData",{attrs:{canShowDialog:_vm.showQuickCreateData,quickCreateField:_vm.field,setAddedRecord:_vm.setAddedRecord},on:{"update:canShowDialog":function($event){_vm.showQuickCreateData=$event},"update:can-show-dialog":function($event){_vm.showQuickCreateData=$event}}}):_vm._e()],1)},staticRenderFns=[],objectSpread2=__webpack_require__(595082),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),toConsumableArray=__webpack_require__(488478),validation=(__webpack_require__(879288),__webpack_require__(260228),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(434284),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(450886),__webpack_require__(538077),__webpack_require__(425728),__webpack_require__(634338),__webpack_require__(990260)),constant=__webpack_require__(354754),picklist=__webpack_require__(961358),field_utils=__webpack_require__(455344),FieldLoader=__webpack_require__(62979),isEqual=__webpack_require__(618446),isEqual_default=__webpack_require__.n(isEqual),LOOKUP_FIELD_PLACEHOLDER_MAP={people:{value:"${LOGGED_PEOPLE}",label:"Current User"},users:{value:"${LOGGED_USER}",label:"Current User"}},FLookupFieldvue_type_script_lang_js={name:"f-lookup-field",props:{model:{},field:{type:Object},disabled:{type:Boolean},siteId:{type:[Number,String]},categoryId:{type:Number},hideLookupIcon:{type:Boolean,default:!1},popperAppendToBody:{required:!1,type:Boolean,default:!0},fetchOptionsOnLoad:{type:Boolean,default:!0},fetchOptionsMethod:{type:Function},preHookFilterConstruction:{type:Function,default:function(field){return field.filters}},hideDropDown:{type:Boolean,default:!1},skipLoading:{type:Boolean,default:!1},isClearable:{type:Boolean,default:!0},userfilmoduleEnum:{type:String},parentModuleId:{type:Number},selectedOptions:{type:Array}},components:{FieldLoader:FieldLoader/* default */.Z,QuickCreateData:function(){return Promise.all(/* import() */[__webpack_require__.e(93208),__webpack_require__.e(50232),__webpack_require__.e(93765),__webpack_require__.e(95953),__webpack_require__.e(35309),__webpack_require__.e(18778),__webpack_require__.e(12303),__webpack_require__.e(84290),__webpack_require__.e(31721),__webpack_require__.e(64418),__webpack_require__.e(5603),__webpack_require__.e(57432),__webpack_require__.e(435),__webpack_require__.e(72230),__webpack_require__.e(94255),__webpack_require__.e(67683),__webpack_require__.e(44178),__webpack_require__.e(91132),__webpack_require__.e(20280),__webpack_require__.e(78256),__webpack_require__.e(22200),__webpack_require__.e(49081),__webpack_require__.e(89472),__webpack_require__.e(12085),__webpack_require__.e(55754),__webpack_require__.e(86494),__webpack_require__.e(3037),__webpack_require__.e(49908),__webpack_require__.e(22061),__webpack_require__.e(31602),__webpack_require__.e(73609),__webpack_require__.e(41323),__webpack_require__.e(99751),__webpack_require__.e(11305),__webpack_require__.e(80390),__webpack_require__.e(89142),__webpack_require__.e(97770),__webpack_require__.e(76422),__webpack_require__.e(99813)]).then(__webpack_require__.bind(__webpack_require__,676433))}},data:function(){return{localSearch:!1,isLoadedOnce:!1,currentModelValue:!1,showQuickCreateData:!1}},computed:{customOptions:function(){var _ref=this||{},field=_ref.field,_ref2=field||{},lookupModule=_ref2.lookupModule;if((0,validation/* isEmpty */.xb)(lookupModule))return[];var _ref3=lookupModule||{},name=_ref3.name;return(0,validation/* isEmpty */.xb)(LOOKUP_FIELD_PLACEHOLDER_MAP[name])?[]:[LOOKUP_FIELD_PLACEHOLDER_MAP[name]]},modelObj:{get:function(){return this.model},set:function(value){this.currentModelValue=value,this.$emit("update:model",value)}},moduleDisplayName:function(){var field=this.field,_ref4=field.field||{},lookupModule=_ref4.lookupModule,_ref5=lookupModule||{},displayName=_ref5.displayName;return displayName},isFieldLoading:function(){var field=this.field,defaultIds=this.defaultIds,skipLoading=this.skipLoading,isLoadedOnce=this.isLoadedOnce;return!skipLoading&&!isLoadedOnce&&!(0,validation/* isEmpty */.xb)(defaultIds)&&field.isDataLoading},isPickListTypeModule:function(){var field=this.field,fieldObj=field.field,_ref6=fieldObj||field,lookupModule=_ref6.lookupModule,_ref7=lookupModule||{},type=_ref7.type;
// type 1 is for base entity modules
return!!type&&1!==type},isRemote:function(){var localSearch=this.localSearch;return!localSearch},canHideLookupIcon:function(){var hideLookupIcon=this.hideLookupIcon,isPickListTypeModule=this.isPickListTypeModule,hideDropDown=this.hideDropDown,field=this.field,userfilmoduleEnum=this.userfilmoduleEnum,_ref8=field||{},config=_ref8.config,canHide=!1;if(!(0,validation/* isEmpty */.xb)(config)){var canShowLookupWizard=this.$getProperty(config,"canShowLookupWizard",null);(0,validation/* isNull */.Ft)(canShowLookupWizard)||(canHide=!canShowLookupWizard)}return!hideDropDown&&("PICK_LIST"===userfilmoduleEnum||(canHide||hideLookupIcon||isPickListTypeModule))},canShowQuickCreateIcon:function(){var disabled=this.disabled,field=this.field,_ref9=field||{},config=_ref9.config,canShow=!1;return(0,validation/* isEmpty */.xb)(config)||(canShow=this.$getProperty(config,"canShowQuickCreate")),disabled&&(canShow=!1),canShow},isSiteEnabled:function(){var siteId=Number(this.$cookie.get("fc.currentSite")),currentSiteId=siteId>0?siteId:-1;return!(0,validation/* isEmpty */.xb)(currentSiteId)},isMultiple:function(){var field=this.field;return!!field.multiple},resourceModuleName:function(){var field=this.field,config=field.config,lookupModuleName=field.lookupModuleName,_ref10=config||{},isFiltersEnabled=_ref10.isFiltersEnabled,filterValue=_ref10.filterValue;if(isFiltersEnabled&&constant/* default */.Z.LOOKUP_FILTER_ENABLED_FIELDS.includes(lookupModuleName)){var moduleName=constant/* default */.Z.LOOKUP_FILTERS_MAP[filterValue];return moduleName}return null},isResourceField:function(){var field=this.field,name=field.name,isResourceField=(0,field_utils/* isChooserTypeField */.Rq)(field)||"resource"===name;return isResourceField},
// To prefill the existing values, we have to send default ids in picklist api
defaultIds:function(){var modelObj=this.modelObj,selectedOptions=this.selectedOptions,isPlaceHoldersEnabled=constant/* default */.Z.FIELD_PLACEHOLDERS.includes(modelObj)||!1,defaultIds=[],selectedOptionsArr=(selectedOptions||[]).map((function(option){return parseInt(option)}));return(0,validation/* isEmpty */.xb)(selectedOptions)?(0,validation/* isEmpty */.xb)(modelObj)||isPlaceHoldersEnabled||(defaultIds=(0,validation/* isArray */.kJ)(modelObj)?(0,toConsumableArray/* default */.Z)(modelObj):[modelObj]):defaultIds=(0,toConsumableArray/* default */.Z)(selectedOptionsArr),defaultIds=defaultIds.filter((function(val){return!constant/* default */.Z.FIELD_PLACEHOLDERS.includes(val)})),defaultIds},operatorLookupModule:function(){var field=this.field,_ref11=field||{},operatorLookupModule=_ref11.operatorLookupModule;return operatorLookupModule||{}},skipSiteFilter:function(){var field=this.field,_ref12=field||{},config=_ref12.config,_ref13=config||{},_ref13$skipSiteFilter=_ref13.skipSiteFilter,skipSiteFilter=void 0!==_ref13$skipSiteFilter&&_ref13$skipSiteFilter;return skipSiteFilter},canShowSystemClear:function(){var canHideLookupIcon=this.canHideLookupIcon,isClearable=this.isClearable,modelObj=this.modelObj,disabled=this.disabled;return!canHideLookupIcon&&!disabled&&(isClearable&&!(0,validation/* isEmpty */.xb)(modelObj))}},watch:{model:function(newVal){var _this=this,currentModelValue=this.currentModelValue,isRemote=this.isRemote;isEqual_default()(newVal,currentModelValue)||(isRemote&&this.getOptions({initialFetch:!0}).then((function(options){_this.$set(_this.field,"options",options)})),this.$set(this,"modelObj",newVal))},siteId:{handler:function(newVal,oldVal){var _this2=this,isSiteEnabled=this.isSiteEnabled,skipSiteFilter=this.skipSiteFilter;skipSiteFilter||isSiteEnabled||newVal===oldVal||this.getOptions({initialFetch:!0}).then((function(options){_this2.$set(_this2.field,"options",options)}))}},parentModuleId:{handler:function(newVal,oldVal){var _this3=this;newVal!==oldVal&&this.getOptions({initialFetch:!0}).then((function(options){_this3.$set(_this3.field,"options",options)}))}},operatorLookupModule:{handler:function(newVal,oldVal){var _this4=this;isEqual_default()(newVal,oldVal)||this.getOptions({initialFetch:!0}).then((function(options){_this4.$set(_this4.field,"options",options)}))}},"field.clientCriteria":{handler:function(newVal,oldVal){var _this5=this;isEqual_default()(newVal,oldVal)||this.getOptions({initialFetch:!0}).then((function(options){_this5.$set(_this5.field,"options",options)}))}},categoryId:{handler:function(newVal,oldVal){var _this6=this;isEqual_default()(newVal,oldVal)||this.getOptions({initialFetch:!0}).then((function(options){_this6.$set(_this6.field,"options",options)}))}},"field.options":{handler:function(value){var modelObj=this.modelObj;if(!(0,validation/* isEmpty */.xb)(value))if((0,validation/* isEmpty */.xb)(modelObj))this.field.selectedItems=[];else if((0,validation/* isArray */.kJ)(modelObj)){var selectedItems=value.filter((function(option){return modelObj.includes(option.value)}));this.field.selectedItems=selectedItems}else{var selectedItem=value.find((function(option){return option.value===modelObj}));this.field.selectedItems=[selectedItem]}},immediate:!0},isLoadedOnce:{handler:function(value){value&&this.$emit("optionsLoadedOnce")}}},created:function(){var _this7=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var fetchOptionsOnLoad,field,modelObj,customOptions,options;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:
// Have to skip fetching options initially, when module is 'resource' and filters is not enabled
if(fetchOptionsOnLoad=_this7.fetchOptionsOnLoad,field=_this7.field,modelObj=_this7.modelObj,customOptions=_this7.customOptions,_this7.currentModelValue=modelObj,_this7.getIsSiteDecommissioned=picklist/* getIsSiteDecommissioned */.Yx,!fetchOptionsOnLoad){_context2.next=12;break}return _context2.next=6,_this7.getOptions({initialFetch:!0});case 6:if(_context2.t0=_context2.sent,_context2.t0){_context2.next=9;break}_context2.t0=[];case 9:options=_context2.t0,_this7.$set(_this7.field,"options",[].concat((0,toConsumableArray/* default */.Z)(customOptions),(0,toConsumableArray/* default */.Z)(options))),_this7.$set(_this7,"isLoadedOnce",!0);case 12:_this7.remoteMethod=_this7.$helpers.debounce(function(){var _ref14=(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(searchText){var isDataLoading,_options;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(isDataLoading=field.isDataLoading,isDataLoading){_context.next=6;break}return _context.next=4,_this7.getOptions({searchText:searchText});case 4:_options=_context.sent,_this7.$set(_this7.field,"options",_options);case 6:case"end":return _context.stop()}}),_callee)})));return function(_x){return _ref14.apply(this,arguments)}}(),1e3);case 13:case"end":return _context2.stop()}}),_callee2)})))()},methods:{focus:function(){(0,validation/* isEmpty */.xb)(this.$refs["selectBox"])||this.$refs["selectBox"].focus()},getOptions:function(params){var _this8=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var searchText,initialFetch,fetchOptionsMethod,field,siteId,categoryId,isRemote,defaultIds,resourceModuleName,isResourceField,skipSiteFilter,selectedOptions,_field$filters,fieldFilters,options,filters,props,perPageCount,_yield$_this8$fetchOp,_yield$_this8$fetchOp2,optionsArr,error,_ref15,message,_yield$getFieldOption,_yield$getFieldOption2,_optionsArr,_error,meta,_ref16,_message,_meta$localSearch,localSearch;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:
/*
                Have to return empty options if field is of resourcetype, if filters havent be enabled
                and if no values selected already
              */
if(searchText=params.searchText,initialFetch=params.initialFetch,fetchOptionsMethod=_this8.fetchOptionsMethod,field=_this8.field,siteId=_this8.siteId,categoryId=_this8.categoryId,isRemote=_this8.isRemote,defaultIds=_this8.defaultIds,resourceModuleName=_this8.resourceModuleName,isResourceField=_this8.isResourceField,skipSiteFilter=_this8.skipSiteFilter,selectedOptions=_this8.selectedOptions,_field$filters=field.filters,fieldFilters=void 0===_field$filters?{}:_field$filters,options=[],(0,validation/* isEmpty */.xb)(resourceModuleName)||(field.resourceLookupModuleName=resourceModuleName),filters=_this8.preHookFilterConstruction(field),(0,validation/* isEmpty */.xb)(filters)||(field.filters=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},fieldFilters),filters)),(0,validation/* isEmpty */.xb)(categoryId)||(field.filters=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},field.filters),{},{category:{operator:"is",value:["".concat(categoryId)]}})),props={field:field,searchText:searchText},skipSiteFilter||(props=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},props),{},{siteId:siteId})),!(isResourceField&&(0,validation/* isEmpty */.xb)(resourceModuleName)&&(0,validation/* isEmpty */.xb)(defaultIds))){_context3.next=12;break}return _context3.abrupt("return",options);case 12:if(initialFetch&&isRemote&&(perPageCount=defaultIds.length>50?defaultIds.length:50,props=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},props),{},{page:1,perPage:perPageCount,defaultIds:defaultIds}),((0,validation/* isEmpty */.xb)(resourceModuleName)&&isResourceField||!(0,validation/* isEmpty */.xb)(selectedOptions))&&(
// Have to fetch only selected values, which is same as the number of defaultids
props=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},props),{},{perPage:defaultIds.length}))),_this8.$set(field,"isDataLoading",!0),(0,validation/* isEmpty */.xb)(fetchOptionsMethod)){_context3.next=25;break}return _context3.next=17,_this8.fetchOptionsMethod(props);case 17:_yield$_this8$fetchOp=_context3.sent,_yield$_this8$fetchOp2=_yield$_this8$fetchOp.options,optionsArr=void 0===_yield$_this8$fetchOp2?[]:_yield$_this8$fetchOp2,error=_yield$_this8$fetchOp.error,error&&(_ref15=error||{},message=_ref15.message,_this8.$message.error(message||"Error Occured")),options=optionsArr,_context3.next=35;break;case 25:return _context3.next=27,(0,picklist/* getFieldOptions */._K)(props);case 27:_yield$getFieldOption=_context3.sent,_yield$getFieldOption2=_yield$getFieldOption.options,_optionsArr=void 0===_yield$getFieldOption2?[]:_yield$getFieldOption2,_error=_yield$getFieldOption.error,meta=_yield$getFieldOption.meta,_error&&(_ref16=_error||{},_message=_ref16.message,_this8.$message.error(_message||"Error Occured")),meta&&(0,validation/* isEmpty */.xb)(searchText)&&(_meta$localSearch=meta.localSearch,localSearch=void 0!==_meta$localSearch&&_meta$localSearch,_this8.$set(_this8,"localSearch",localSearch)),options=_optionsArr;case 35:return _this8.$set(field,"isDataLoading",!1),_context3.abrupt("return",options);case 37:case"end":return _context3.stop()}}),_callee3)})))()},clearData:function(){this.$emit("update:model",""),this.recordSelected("")},recordSelected:function(value){var field=this.field,_this$field$options=this.field.options,options=void 0===_this$field$options?[]:_this$field$options,isMultiple=this.isMultiple,selectedValues=null;isMultiple?(selectedValues=options.filter((function(e){return(value||[]).includes(e.value)})),field.selectedItems=selectedValues):(selectedValues=options.find((function(e){return e.value==value}))||{},field.selectedItems=[],(0,validation/* isEmpty */.xb)(selectedValues)||(field.selectedItems=[selectedValues])),this.$emit("recordSelected",selectedValues,field)},openLookupFieldWizard:function(field){var disabled=this.disabled;disabled||this.$emit("showLookupWizard",field,!0)},openQuickCreate:function(){var disabled=this.disabled;disabled||(this.showQuickCreateData=!0)},setAddedRecord:function(props){var record=props.record,_ref17=record||{},id=_ref17.id,name=record.displayName||record.name||record.subject,field=this.field;field.selectedItems=[{value:id,label:name}],this.$emit("setLookupFieldValue",{field:(0,objectSpread2/* default */.Z)({},field)})}}},forms_FLookupFieldvue_type_script_lang_js=FLookupFieldvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(forms_FLookupFieldvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FLookupField=component.exports},
/***/62979:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FieldLoader}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/forms/FieldLoader.vue?vue&type=template&id=7252e23e
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.isLoading?_c("div",{staticClass:"field-loading loading-shimmer"}):_vm._e()},staticRenderFns=[],FieldLoadervue_type_script_lang_js={props:{isLoading:{type:Boolean,required:!0}}},forms_FieldLoadervue_type_script_lang_js=FieldLoadervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(forms_FieldLoadervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FieldLoader=component.exports},
/***/806339:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return WidgetPagination}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/page/widget/utils/WidgetPagination.vue?vue&type=template&id=6b10cd5b
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"fc-widget-pagination"},[_vm.total>0?_c("div",{class:{"fc-black-small-txt-12":!_vm.hideToggle}},[_vm.from!==_vm.to?_c("span",[_vm._v(_vm._s(_vm.from)+" -")]):_vm._e(),_c("span",[_vm._v(_vm._s(_vm.to))]),_vm.hideToggle?_vm._e():[_vm._v(" of "+_vm._s(_vm.total)+" "),_c("span",{staticClass:"el-icon-arrow-left fc-black-small-txt-12 fw-bold f16 pointer mL10 mR5",class:{disable:_vm.from<=1},on:{click:function($event){_vm.from>1&&_vm.prev()}}}),_c("span",{staticClass:"el-icon-arrow-right fc-black-small-txt-12 f16 pointer mR10 fw-bold",class:{disable:_vm.to===_vm.total},on:{click:function($event){_vm.to!==_vm.total&&_vm.next()}}})]],2):_vm._e()])},staticRenderFns=[],WidgetPaginationvue_type_script_lang_js={props:["currentPage","perPage","total","hideToggle"],data:function(){return{from:0,to:0,page:1}},mounted:function(){this.init()},watch:{total:function(){this.init()},currentPage:function(val){val!==this.page&&this.init()}},methods:{init:function(){this.page=this.currentPage||1,this.from=(this.page-1)*this.perPage+1;var to=this.from+this.perPage-1;this.to=this.total>to?to:this.total},next:function(){this.from=this.to+1,this.to+=this.perPage,this.to>this.total&&(this.to=this.total),this.page++,this.updateCurrentPage()},prev:function(){this.to=this.from-1,this.from-=this.perPage,this.from<=1?this.from=this.page=1:this.page--,this.updateCurrentPage()},updateCurrentPage:function(){
// Update currentPage value
this.$emit("update:currentPage",this.page),this.$emit("onChange")}}},utils_WidgetPaginationvue_type_script_lang_js=WidgetPaginationvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(utils_WidgetPaginationvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,WidgetPagination=component.exports},
/***/270387:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return PlannerOverview}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/shiftPlanner/PlannerOverview.vue?vue&type=template&id=d2b45760
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("ShiftPlanTopBar",{on:{timelineRangeUpdate:_vm.updateTimelineRange,viewModeUpdate:_vm.updateViewMode}}),_vm.isCalendarViewSelected?_c("CalendarView",{attrs:{timelineRange:_vm.timelineRange}}):_c("ListView",{attrs:{timelineRange:_vm.timelineRange}})],1)},staticRenderFns=[],ShiftPlanTopBarvue_type_template_id_aae70580_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"d-flex shift-plan-top-bar"},[_c("div",{staticClass:"d-flex shift-plan-top-bar-left-child"},[_c("el-radio-group",{attrs:{size:"small"},on:{change:_vm.updateViewMode},model:{value:_vm.viewMode,callback:function($$v){_vm.viewMode=$$v},expression:"viewMode"}},[_c("el-radio-button",{attrs:{label:"Calendar View"}}),_c("el-radio-button",{attrs:{label:"List View"}})],1),_c("new-date-picker",{staticClass:"picker",attrs:{zone:_vm.$timezone,dateObj:_vm.dateFilter,tabs:_vm.dateRange.enabledTabs},on:{date:_vm.setDateFilter}})],1),_c("div",[_c("div",{staticClass:"d-flex"},[_vm.hasExportPermission?_c("el-dropdown",{attrs:{trigger:"click",placement:"bottom"},on:{command:_vm.exportPlanner}},[_c("fc-icon",{staticClass:"export-button",attrs:{group:"default",name:"download",size:"20"}}),_c("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[_c("el-dropdown-item",{attrs:{command:"xlsx"}},[_vm._v(_vm._s(_vm.$t("common.shift_planner.export_excel")))]),_c("el-dropdown-item",{attrs:{command:"csv"}},[_vm._v(_vm._s(_vm.$t("common.shift_planner.export_csv")))])],1)],1):_vm._e(),_vm.hasUpdatePermission?_c("button",{staticClass:"fc-create-btn create-btn mL20",on:{click:_vm.toggleCTA}},[_vm._v(" "+_vm._s(_vm.$t("common.shift_planner.associate_employee"))+" ")]):_vm._e(),_vm.showCTADialog?_c("el-dialog",{attrs:{title:_vm.$t("common.shift_planner.associate_employee"),visible:_vm.showCTADialog,"append-to-body":!0,width:"40%"},on:{"update:visible":function($event){_vm.showCTADialog=$event},close:_vm.closeCTA}},[_c("div",{staticClass:"d-flex justify-content-space"},[_c("div",[_c("div",{staticClass:"label"},[_vm._v(" "+_vm._s(_vm.$t("common.shift_planner.startDate"))+" ")]),_c("el-date-picker",{staticClass:"p5",attrs:{type:"date",format:_vm.dateFormat,placeholder:"Select Start Date","picker-options":{disabledDate:_vm.disablePast}},model:{value:_vm.cta.startDate,callback:function($$v){_vm.$set(_vm.cta,"startDate",$$v)},expression:"cta.startDate"}})],1),_c("div",[_c("div",{staticClass:"label"},[_vm._v(_vm._s(_vm.$t("common.shift_planner.endDate")))]),_c("el-date-picker",{staticClass:"p5",attrs:{type:"date",format:_vm.dateFormat,placeholder:"Select End Date","picker-options":{disabledDate:_vm.disablePast}},model:{value:_vm.cta.endDate,callback:function($$v){_vm.$set(_vm.cta,"endDate",$$v)},expression:"cta.endDate"}})],1)]),_c("div",[_c("div",{staticClass:"label"},[_vm._v(_vm._s(_vm.$t("common.shift_planner.employee")))]),_c("FLookupField",{staticClass:"p5",attrs:{model:_vm.cta.employee,field:_vm.cta.employeeField,hideLookupIcon:!0},on:{"update:model":function($event){return _vm.$set(_vm.cta,"employee",$event)}}})],1),_c("div",[_c("div",{staticClass:"label"},[_vm._v(_vm._s(_vm.$t("common.shift_planner.shift")))]),_c("FLookupField",{staticClass:"p5",attrs:{model:_vm.cta.shift,field:_vm.cta.shiftField,hideLookupIcon:!0},on:{"update:model":function($event){return _vm.$set(_vm.cta,"shift",$event)}}})],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.closeCTA}},[_vm._v(_vm._s(_vm.$t("common.shift_planner.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.cta.updatingShift,disabled:_vm.disableButton},on:{click:function($event){return _vm.updateShift()}}},[_vm._v(_vm._s(_vm.$t("common.shift_planner.update")))])],1)]):_vm._e()],1)])])},ShiftPlanTopBarvue_type_template_id_aae70580_scoped_true_staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),objectSpread2=__webpack_require__(595082),FLookupField=(__webpack_require__(564043),__webpack_require__(857267),__webpack_require__(756532),__webpack_require__(855048)),NewDateHelper=__webpack_require__(105534),NewDatePicker=__webpack_require__(900773),api=__webpack_require__(32284),vuex_esm=__webpack_require__(420629),peopleMixin=__webpack_require__(849561);// CONCATENATED MODULE: ./node_modules/thread-loader/dist/cjs.js!./node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/shiftPlanner/ShiftPlanTopBar.vue?vue&type=script&lang=js
function computeDefaultRange(){var date=new Date,firstDay=new Date(date.getFullYear(),date.getMonth(),1),lastDay=new Date(date.getFullYear(),date.getMonth()+1,0);return[firstDay,lastDay]}
/* harmony default export */var ShiftPlanTopBarvue_type_script_lang_js={components:{FLookupField:FLookupField/* default */.Z,NewDatePicker:NewDatePicker/* default */.Z},mixins:[peopleMixin/* default */.Z],created:function(){var _this=this;this.$root.$on("edit-day-record",(function(rec){_this.togglePrefilledCTA(rec)}))},data:function(){return{disablePast:function(date){return date<(new Date).setHours(0,0,0,0).valueOf()},dateRange:{enabledTabs:{enabledTabs:["W","M"]}},dateFilter:NewDateHelper/* default */.Z.getDatePickerObject(64,
// month
computeDefaultRange()),showCTADialog:!1,timelineRange:null,viewMode:"Calendar View",cta:{shiftField:{isDataLoading:!1,lookupModuleName:"shift",field:{lookupModule:{name:"shift",displayName:"Shift"}},filters:{isActive:{operatorId:15,value:["true"]}},multiple:!1},updatingShift:!1,startDate:null,endDate:null,employeeField:{isDataLoading:!1,lookupModuleName:"employee",field:{lookupModule:{name:"employee",displayName:"Employee"}},filters:{},multiple:!0},employee:null,shift:null}}},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({currentTab:function(state){return state.webtabs.selectedTab}})),(0,vuex_esm/* mapGetters */.Se)("webtabs",["tabHasPermission"])),{},{hasUpdatePermission:function(){var currentTab=this.currentTab,tabHasPermission=this.tabHasPermission;return tabHasPermission("UPDATE",currentTab)},hasExportPermission:function(){var currentTab=this.currentTab,tabHasPermission=this.tabHasPermission;return tabHasPermission("EXPORT",currentTab)},dateFormat:function(){var $dateformat=this.$dateformat,dateformat=($dateformat||"").replaceAll("Y","y");return dateformat=(dateformat||"").replaceAll("D","d"),dateformat||"dd/MMM/yyyy"},disableButton:function(){var _this$cta=this.cta,shift=_this$cta.shift,startDate=_this$cta.startDate,endDate=_this$cta.endDate,employee=_this$cta.employee;return!(null!=shift&&null!=startDate&&null!=endDate&&null!=employee&&employee.length>0&&startDate<=endDate)}}),methods:{updateViewMode:function(){this.$emit("viewModeUpdate",this.viewMode)},setTimelineRange:function(from,to){this.timelineRange={from:from,to:to},this.$emit("timelineRangeUpdate",this.timelineRange)},toggleCTA:function(){this.showCTADialog=!this.showCTADialog},closeCTA:function(){this.cta.startDate=null,this.cta.endDate=null,this.cta.employee=null,this.cta.shift=null,this.showCTADialog=!1},togglePrefilledCTA:function(details){var _details$employee,_details$shift,employeeID=null===details||void 0===details||null===(_details$employee=details.employee)||void 0===_details$employee?void 0:_details$employee.id;employeeID&&(this.cta.employee=[employeeID]);var shiftID=null===details||void 0===details||null===(_details$shift=details.shift)||void 0===_details$shift?void 0:_details$shift.id;shiftID&&(this.cta.shift=shiftID);var startDate=null===details||void 0===details?void 0:details.startDate;startDate&&(this.cta.startDate=new Date(startDate).setHours(0,0,0,0));var today=this.getTodayDate();startDate<today&&(this.cta.startDate=today);var endDate=null===details||void 0===details?void 0:details.endDate;endDate&&(this.cta.endDate=new Date(endDate).setHours(0,0,0,0)),this.toggleCTA()},setDateFilter:function(data){var range=null===data||void 0===data?void 0:data.value;if(range){var from=range[0],to=range[1];this.setTimelineRange(from,to),this.dateFilter=data}},updateShift:function(){var _this$cta2,_this$cta3,_this$cta4,_this$cta5;this.cta.updatingShift=!0;var SHIFT_ID=(null===(_this$cta2=this.cta)||void 0===_this$cta2?void 0:_this$cta2.shift)||null,EMPLOYEE_ID=(null===(_this$cta3=this.cta)||void 0===_this$cta3?void 0:_this$cta3.employee)||null,SHIFT_START=(null===(_this$cta4=this.cta)||void 0===_this$cta4||null===(_this$cta4=_this$cta4.startDate)||void 0===_this$cta4?void 0:_this$cta4.valueOf())||null,SHIFT_END=(null===(_this$cta5=this.cta)||void 0===_this$cta5||null===(_this$cta5=_this$cta5.endDate)||void 0===_this$cta5?void 0:_this$cta5.valueOf())||null;SHIFT_ID&&EMPLOYEE_ID&&SHIFT_START&&SHIFT_END&&(SHIFT_END<SHIFT_START||(this.updateUserShift(SHIFT_ID,EMPLOYEE_ID,SHIFT_START,SHIFT_END),this.cta.updatingShift=!1))},updateUserShift:function(shiftID,employees,shiftStart,shiftEnd){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var route,payload,_yield$API$post,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return route="/v3/shiftplanner/update",payload={shiftID:shiftID,employees:employees,shiftStart:shiftStart,shiftEnd:shiftEnd},_context.next=4,api/* API */.bl.post(route,payload);case 4:_yield$API$post=_context.sent,error=_yield$API$post.error,error?_this2.$message.error("shift update failed"):(_this2.$message.success("Shift update success"),_this2.$root.$emit("reload-employee-shift")),_this2.resetCTAForm(),_this2.toggleCTA();case 9:case"end":return _context.stop()}}),_callee)})))()},resetCTAForm:function(){this.cta.startDate=null,this.cta.endDate=null,this.cta.shift=null,this.cta.employee=null},exportPlanner:function(cmd){"Calendar View"===this.viewMode?this.$root.$emit("export-shift-planner-cal-"+cmd):this.$root.$emit("export-shift-planner-list-"+cmd)}}},shiftPlanner_ShiftPlanTopBarvue_type_script_lang_js=ShiftPlanTopBarvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(shiftPlanner_ShiftPlanTopBarvue_type_script_lang_js,ShiftPlanTopBarvue_type_template_id_aae70580_scoped_true_render,ShiftPlanTopBarvue_type_template_id_aae70580_scoped_true_staticRenderFns,!1,null,"aae70580",null)
/* harmony default export */,ShiftPlanTopBar=component.exports,ListViewvue_type_template_id_e6ccf4d4_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.shift.isLoading||_vm.employee.isLoading?_c("spinner",{attrs:{show:_vm.shift.isLoading||_vm.employee.isLoading,size:"100"}}):_c("div",{staticClass:"list-view-container"},[_c("div",{staticClass:"employee-list-container"},[_vm.showSearchBar?_c("div",{staticClass:"p5",staticStyle:{"margin-top":"3px"}},[_c("FLookupField",{attrs:{model:_vm.employeesToFilter,field:_vm.employeeField,hideLookupIcon:!0},on:{"update:model":[function($event){_vm.employeesToFilter=$event},_vm.updateEmployeeFilter]}})],1):_c("div",{staticClass:"employee-list-head"},[_c("div",[_vm._v(_vm._s(_vm.$t("common.shift_planner.employees")))]),_c("div",[_c("fc-icon",{staticClass:"search-icon",attrs:{group:"default",name:"search"},on:{click:_vm.toggleSearchBar}}),_c("fc-icon",{staticClass:"sort-icon",attrs:{group:"default",name:"sort"},on:{click:_vm.toggleSortOrderAndFetchEmployees}})],1)]),_c("div",{staticClass:"employee-list-body"},_vm._l(_vm.employee.list,(function(p){return _c("div",{key:p.id,staticClass:"employee-list-item",class:{active:_vm.isEmployeeSelected(p)},on:{click:function($event){return _vm.setCurrentEmployee(p)}}},[_vm._v(" "+_vm._s(p.name)+" ")])})),0),_c("div",{staticClass:"employee-list-foot"},[_c("Pagination",{attrs:{currentPage:_vm.pagination.current,total:_vm.employee.count,perPage:_vm.pagination.perPage},on:{"update:currentPage":[function($event){return _vm.$set(_vm.pagination,"current",$event)},_vm.handleCurrentPageChange],"update:current-page":function($event){return _vm.$set(_vm.pagination,"current",$event)}}})],1)]),_c("div",{staticClass:"shift-list-container"},[_c("div",{staticClass:"shift-list-head"},[_c("div",[_vm._v(_vm._s(_vm.currentEmployeeName))])]),_c("div",{staticClass:"shift-list-body"},[_c("el-table",{staticStyle:{width:"100%"},attrs:{id:"shift-list-table",data:_vm.shift.list,"max-height":"560","cell-style":{padding:"10px"},"header-cell-style":{padding:"10px"}}},[_c("el-table-column",{attrs:{label:"Date"},scopedSlots:_vm._u([{key:"default",fn:function(data){return[_vm._v(" "+_vm._s(_vm.formatDateWithoutTime(data.row.epoch))+" ")]}}])}),_c("el-table-column",{attrs:{prop:"name",label:"Shift"}}),_c("el-table-column",{attrs:{label:"Start Time"},scopedSlots:_vm._u([{key:"default",fn:function(data){return[_vm._v(" "+_vm._s(_vm.readableTime(data.row.startTime))+" ")]}}])}),_c("el-table-column",{attrs:{label:"End Time"},scopedSlots:_vm._u([{key:"default",fn:function(data){return[_vm._v(" "+_vm._s(_vm.readableTime(data.row.endTime))+" ")]}}])}),_vm.hasUpdatePermission?_c("el-table-column",{attrs:{width:"100"},scopedSlots:_vm._u([{key:"default",fn:function(data){return[_c("div",{staticClass:"visibility-visible-actions"},[_vm.allowShiftUpdate(data.row.epoch)?_c("el-button",{attrs:{type:"text",size:"small"},on:{click:function($event){return _vm.editDayRecord(data.row)}}},[_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-edit pointer edit-icon-color visibility-hide-actions",attrs:{"data-arrow":"true",title:_vm.$t("common._common.edit")}})]):_vm._e()],1)]}}],null,!1,1052760988)}):_vm._e()],1)],1)])])},ListViewvue_type_template_id_e6ccf4d4_scoped_true_staticRenderFns=[],validation=(__webpack_require__(434284),__webpack_require__(634338),__webpack_require__(450886),__webpack_require__(648324),__webpack_require__(990260)),WidgetPagination=__webpack_require__(806339),ListViewvue_type_script_lang_js={name:"ListView",components:{Pagination:WidgetPagination/* default */.Z,FLookupField:FLookupField/* default */.Z},mixins:[peopleMixin/* default */.Z],props:{timelineRange:{required:!0,datatype:Object}},created:function(){var _this=this;this.fetchCurrentPageEmployee(),this.$root.$on("reload-employee-shift",(function(){_this.fetchCurrentEmployeeShift()})),this.$root.$on("export-shift-planner-list-csv",(function(){_this.exportShiftPlanner("csv")})),this.$root.$on("export-shift-planner-list-xlsx",(function(){_this.exportShiftPlanner("xlsx")}))},watch:{timelineRange:{handler:function(){this.fetchCurrentEmployeeShift()},deep:!0}},data:function(){return{pagination:{current:1,perPage:10},showSearchBar:!1,employeesToFilter:[],employee:{current:null,list:[],sortType:"asc",count:0,isLoading:!0},shift:{list:[],isLoading:!0},employeeField:{isDataLoading:!1,lookupModuleName:"employee",field:{lookupModule:{name:"employee",displayName:"Employee"}},filters:{},multiple:!0}}},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({currentTab:function(state){return state.webtabs.selectedTab}})),(0,vuex_esm/* mapGetters */.Se)("webtabs",["tabHasPermission"])),{},{hasUpdatePermission:function(){var currentTab=this.currentTab,tabHasPermission=this.tabHasPermission;return tabHasPermission("UPDATE",currentTab)},currentEmployeeName:function(){var current=this.employee.current;return current?current.name:"---"}}),methods:{allowShiftUpdate:function(epoch){var today=this.getTodayDate();return!(epoch<=today)&&this.hasUpdatePermission},updateEmployeeFilter:function(employees){this.employeesToFilter=employees,this.fetchCurrentPageEmployee()},toggleSortOrderAndFetchEmployees:function(){this.toggleSortOrder(),this.fetchCurrentPageEmployee()},toggleSearchBar:function(){this.showSearchBar=!this.showSearchBar},toggleSortOrder:function(){"asc"===this.employee.sortType?this.employee.sortType="desc":this.employee.sortType="asc"},editDayRecord:function(row){var employee=this.employee.current,startDate=new Date(row.epoch),endDate=new Date(row.epoch),payload={employee:employee,startDate:startDate,endDate:endDate};this.$root.$emit("edit-day-record",payload)},isEmployeeSelected:function(p){var _this$employee,selectedEmployeeID=null===(_this$employee=this.employee)||void 0===_this$employee||null===(_this$employee=_this$employee.current)||void 0===_this$employee?void 0:_this$employee.id;return selectedEmployeeID&&p.id===selectedEmployeeID},fetchEmployees:function(currentPage,perPage,sortType){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var route,filter,_yield$API$get,error,data,meta,_meta$pagination;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(currentPage||perPage||sortType){_context.next=2;break}return _context.abrupt("return");case 2:return _this2.employee.isLoading=!0,route="/v3/modules/data/list?moduleName=employee&withCount=true&orderBy=name&orderType=".concat(sortType,"&page=").concat(currentPage,"&perPage=").concat(perPage),(0,validation/* isEmpty */.xb)(_this2.employeesToFilter)?_this2.showSearchBar=!1:(filter={id:{operatorId:36,value:_this2.employeesToFilter.map((function(e){return String(e)}))}},route+="&filters=".concat(encodeURIComponent(JSON.stringify(filter)))),_context.next=7,api/* API */.bl.get(route);case 7:_yield$API$get=_context.sent,error=_yield$API$get.error,data=_yield$API$get.data,meta=_yield$API$get.meta,error?error.message||_this2.$t("common._common.error_occured"):(_this2.employee.list=data.employee,_this2.employee.count=(null===meta||void 0===meta||null===(_meta$pagination=meta.pagination)||void 0===_meta$pagination?void 0:_meta$pagination.totalCount)||0,_this2.employee.list.length>0&&(_this2.employee.current=_this2.employee.list[0],_this2.fetchCurrentEmployeeShift())),_this2.employee.isLoading=!1;case 13:case"end":return _context.stop()}}),_callee)})))()},fetchCurrentPageEmployee:function(){this.fetchEmployees(this.pagination.current,this.pagination.perPage,this.employee.sortType)},fetchShift:function(rangeFrom,rangeTo,employeeID){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var route,_yield$API$get2,error,data;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if(rangeFrom||rangeTo||employeeID){_context2.next=3;break}return _context2.abrupt("return");case 3:return _this3.shift.isLoading=!0,route="/v3/shiftplanner/view?rangeFrom=".concat(rangeFrom,"&rangeTo=").concat(rangeTo,"&employeeID=").concat(employeeID),_context2.next=7,api/* API */.bl.get(route);case 7:_yield$API$get2=_context2.sent,error=_yield$API$get2.error,data=_yield$API$get2.data,error?error.message||_this3.$t("common._common.error_occured"):_this3.shift.list=data.shifts,_this3.shift.isLoading=!1;case 12:case"end":return _context2.stop()}}),_callee2)})))()},exportShiftPlanner:function(format){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var _this4$timelineRange,from,to,current,employeeID,sortType,route,_yield$API$get3,error,data;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:if(_this4$timelineRange=_this4.timelineRange,from=_this4$timelineRange.from,to=_this4$timelineRange.to,current=_this4.employee.current,employeeID=null===current||void 0===current?void 0:current.id,sortType=_this4.employee.sortType,from||to||employeeID||format){_context3.next=7;break}return _context3.abrupt("return");case 7:return route="/v3/shiftplanner/export?rangeFrom=".concat(from,"&rangeTo=").concat(to,"&employeeID=").concat(employeeID,"&format=").concat(format,"&orderBy=name&orderType=").concat(sortType),_context3.next=10,api/* API */.bl.get(route);case 10:_yield$API$get3=_context3.sent,error=_yield$API$get3.error,data=_yield$API$get3.data,error?error.message||_this4.$t("common._common.error_occured"):window.open(data.url,"_blank");case 14:case"end":return _context3.stop()}}),_callee3)})))()},fetchCurrentEmployeeShift:function(){var _this$employee2,employeeID=null===(_this$employee2=this.employee)||void 0===_this$employee2||null===(_this$employee2=_this$employee2.current)||void 0===_this$employee2?void 0:_this$employee2.id;this.fetchShift(this.timelineRange.from,this.timelineRange.to,employeeID)},setCurrentEmployee:function(employee){this.employee.current=employee,this.fetchCurrentEmployeeShift()},handleCurrentPageChange:function(){this.fetchCurrentPageEmployee()}}},shiftPlanner_ListViewvue_type_script_lang_js=ListViewvue_type_script_lang_js,ListView_component=(0,componentNormalizer/* default */.Z)(shiftPlanner_ListViewvue_type_script_lang_js,ListViewvue_type_template_id_e6ccf4d4_scoped_true_render,ListViewvue_type_template_id_e6ccf4d4_scoped_true_staticRenderFns,!1,null,"e6ccf4d4",null)
/* harmony default export */,ListView=ListView_component.exports,CalendarViewvue_type_template_id_0b8d9030_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_vm.isLoading?_c("spinner",{attrs:{show:_vm.isLoading,size:"80"}}):_c("div",[_c("div",{staticClass:"calendar-view-wr"},[_c("table",[_c("tr",{staticClass:"header"},[_c("th",[_vm.showSearchBar?_c("div",{staticClass:"top-left-cell"},[_c("FLookupField",{staticStyle:{width:"100%"},attrs:{model:_vm.employeesToFilter,field:_vm.employeeField,hideLookupIcon:!0},on:{"update:model":[function($event){_vm.employeesToFilter=$event},_vm.updateEmployeeFilter]}})],1):_c("div",{staticClass:"top-left-cell"},[_c("div",[_vm._v(_vm._s(_vm.$t("common.header.employee")))]),_c("div",[_c("fc-icon",{staticClass:"search-icon",attrs:{group:"default",name:"search"},on:{click:_vm.toggleSearchBar}}),_c("fc-icon",{staticClass:"sort-icon",attrs:{group:"default",name:"sort"},on:{click:function($event){return _vm.toggleSortOrderAndFetchEmployees()}}})],1)])]),_vm._l(_vm.range,(function(day){return _c("th",{key:day,staticClass:"day-card"},[_c("div",{staticClass:"day-card-day"},[_vm._v(_vm._s(_vm.getDay(day)))]),_c("div",{staticClass:"day-card-date"},[_vm._v(_vm._s(_vm.getDate(day)))])])}))],2),_vm._l(_vm.employees,(function(employee){return _c("tr",{key:employee.id},[_c("td",{staticStyle:{overflow:"clip"}},[_vm._v(" "+_vm._s(employee.name)+" ")]),_vm._l(_vm.shifts[employee.id],(function(shift,ix){return _c("td",{key:employee.id+ix+"",class:"shift-card "+(_vm.allowShiftUpdate(shift)&&"shift-card-display"),style:_vm.shiftCardStyle(shift),attrs:{colspan:shift.span}},[_c("div",{staticClass:"shift-card-wr"},[shift.isWeeklyOff?_vm._e():_c("div",{staticClass:"shift-time"},[_c("fc-icon",{attrs:{group:"dsm",name:"clock",size:"8",color:"#324056"}}),_vm._v(" "+_vm._s(_vm.readableTime(shift.startTime))+" - "+_vm._s(_vm.readableTime(shift.endTime))+" ")],1),_c("div",{staticClass:"shift-name"},[_vm._v(" "+_vm._s(shift.isWeeklyOff?"Weekly Off":shift.name)+" ")])]),_vm.allowShiftUpdate(shift)?_c("div",{staticClass:"shift-card-hover-wr",on:{click:function($event){return _vm.editEmployeeShift(employee,shift)}}},[_c("div",{staticClass:"shift-card-hover-edit"},[_c("span",{staticClass:"icon-bg"},[_c("fc-icon",{attrs:{group:"default",name:"edit",size:"20",color:"#324056"}})],1)]),_c("div",{staticStyle:{filter:"blur(1px)"}},[_c("div",{staticClass:"shift-time"},[_c("fc-icon",{attrs:{group:"dsm",name:"clock",size:"8",color:"#324056"}}),_vm._v(" "+_vm._s(_vm.readableTime(shift.startTime))+" - "+_vm._s(_vm.readableTime(shift.endTime))+" ")],1),_c("div",{staticClass:"shift-name"},[_vm._v(_vm._s(shift.name))])])]):_vm._e()])}))],2)}))],2)]),_c("div",{staticClass:"pagination-view-footer d-flex"},[_c("div",{staticClass:"pagination-wr d-flex justify-content-center"},[_c("Pagination",{attrs:{currentPage:_vm.pagination.page,total:_vm.pagination.count,perPage:_vm.pagination.perPage},on:{"update:currentPage":[function($event){return _vm.$set(_vm.pagination,"page",$event)},_vm.fetchCurrentPageEmployees],"update:current-page":function($event){return _vm.$set(_vm.pagination,"page",$event)}}})],1),_c("div")])])],1)},CalendarViewvue_type_template_id_0b8d9030_scoped_true_staticRenderFns=[],CalendarViewvue_type_script_lang_js=(__webpack_require__(108472),{name:"CalendarView",components:{FLookupField:FLookupField/* default */.Z,Pagination:WidgetPagination/* default */.Z},props:{timelineRange:{required:!0,datatype:Object}},mixins:[peopleMixin/* default */.Z],created:function(){var _this=this;this.fetchCurrentPageEmployees(),this.$root.$on("reload-employee-shift",(function(){_this.fetchCurrentPageEmployees()})),this.$root.$on("export-shift-planner-cal-csv",(function(){_this.exportShiftPlanner("csv")})),this.$root.$on("export-shift-planner-cal-xlsx",(function(){_this.exportShiftPlanner("xlsx")}))},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({currentTab:function(state){return state.webtabs.selectedTab}})),(0,vuex_esm/* mapGetters */.Se)("webtabs",["tabHasPermission"])),{},{hasUpdatePermission:function(){var currentTab=this.currentTab,tabHasPermission=this.tabHasPermission;return tabHasPermission("UPDATE",currentTab)}}),watch:{timelineRange:{handler:function(){this.fetchCurrentPageEmployees()},deep:!0}},data:function(){return{isLoading:!0,employees:null,showSearchBar:!1,employeesToFilter:[],range:null,shifts:null,sortType:"asc",pagination:{page:1,perPage:10,count:0},employeeField:{isDataLoading:!1,lookupModuleName:"employee",field:{lookupModule:{name:"employee",displayName:"Employee"}},filters:{},multiple:!0}}},methods:{allowShiftUpdate:function(slot){var epoch=slot.epoch,span=slot.span;if(epoch&&span){var endDay=this.computeSlotEndDay(epoch,span),today=this.getTodayDate();if(endDay<today)return!1;if(epoch<=today&&endDay>=today)return this.hasUpdatePermission}return this.hasUpdatePermission},updateEmployeeFilter:function(employees){this.employeesToFilter=employees,this.fetchCurrentPageEmployees()},toggleSearchBar:function(){this.showSearchBar=!this.showSearchBar},toggleSortOrderAndFetchEmployees:function(){this.toggleSortOrder(),this.fetchCurrentPageEmployees()},toggleSortOrder:function(){"asc"===this.sortType?this.sortType="desc":this.sortType="asc"},shiftCardStyle:function(shift){return shift.isWeeklyOff?{"background-image":"repeating-linear-gradient( -45deg, transparent 0 20px, "+shift.colorCode+" 20px 25px )"}:{"background-color":shift.colorCode}},toggleShiftCardHover:function(){this.shiftCardHover=!this.shiftCardHover},getDate:function(d){return"".concat(new Date(d).getDate()).padStart(2,"0")},getDay:function(d){var weekday=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];return weekday[new Date(d).getDay()]},editEmployeeShift:function(employee,shift){var span=shift.span,epoch=shift.epoch,startDate=epoch,endDate=this.computeSlotEndDay(epoch,span),shiftObj={id:shift.shiftId},empObj={id:employee.id},record={employee:empObj,shift:shiftObj,startDate:startDate,endDate:endDate};this.$root.$emit("edit-day-record",record)},fetchCurrentPageEmployees:function(){this.fetchSchedule(this.pagination.page,this.pagination.perPage,this.sortType)},exportShiftPlanner:function(format){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var _this2$timelineRange,from,to,_this2$pagination,page,perPage,sortType,route,filter,_yield$API$get,error,data;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(_this2$timelineRange=_this2.timelineRange,from=_this2$timelineRange.from,to=_this2$timelineRange.to,_this2$pagination=_this2.pagination,page=_this2$pagination.page,perPage=_this2$pagination.perPage,sortType=_this2.sortType,from||to||format||perPage||page||sortType){_context.next=6;break}return _context.abrupt("return");case 6:return route="/v3/shiftplanner/export?rangeFrom=".concat(from,"&rangeTo=").concat(to,"&format=").concat(format,"&perPage=").concat(perPage,"&page=").concat(page,"&orderBy=name&orderType=").concat(sortType),(0,validation/* isEmpty */.xb)(_this2.employeesToFilter)||(filter={id:{operatorId:36,value:_this2.employeesToFilter.map((function(e){return String(e)}))}},route+="&filters=".concat(encodeURIComponent(JSON.stringify(filter)))),_context.next=10,api/* API */.bl.get(route);case 10:_yield$API$get=_context.sent,error=_yield$API$get.error,data=_yield$API$get.data,error?error.message||_this2.$t("common._common.error_occured"):window.open(data.url,"_blank");case 14:case"end":return _context.stop()}}),_callee)})))()},fetchSchedule:function(page,perPage,sortType){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var _this3$timelineRange,from,to,route,filter,_yield$API$get2,error,data;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if(page||perPage||sortType){_context2.next=2;break}return _context2.abrupt("return");case 2:return _this3.isLoading=!0,_this3$timelineRange=_this3.timelineRange,from=_this3$timelineRange.from,to=_this3$timelineRange.to,route="/v3/shiftplanner/calendar?withCount=true&rangeFrom=".concat(from,"&rangeTo=").concat(to,"&perPage=").concat(perPage,"&page=").concat(page,"&orderBy=name&orderType=").concat(sortType),(0,validation/* isEmpty */.xb)(_this3.employeesToFilter)?_this3.showSearchBar=!1:(filter={id:{operatorId:36,value:_this3.employeesToFilter.map((function(e){return String(e)}))}},route+="&filters=".concat(encodeURIComponent(JSON.stringify(filter)))),_context2.next=8,api/* API */.bl.get(route);case 8:_yield$API$get2=_context2.sent,error=_yield$API$get2.error,data=_yield$API$get2.data,error?error.message||_this3.$t("common._common.error_occured"):(_this3.employees=data.employees,_this3.shifts=data.shifts,_this3.range=data.range,_this3.pagination.count=data.count),_this3.isLoading=!1;case 13:case"end":return _context2.stop()}}),_callee2)})))()}}}),shiftPlanner_CalendarViewvue_type_script_lang_js=CalendarViewvue_type_script_lang_js,CalendarView_component=(0,componentNormalizer/* default */.Z)(shiftPlanner_CalendarViewvue_type_script_lang_js,CalendarViewvue_type_template_id_0b8d9030_scoped_true_render,CalendarViewvue_type_template_id_0b8d9030_scoped_true_staticRenderFns,!1,null,"0b8d9030",null)
/* harmony default export */,CalendarView=CalendarView_component.exports,PlannerOverviewvue_type_script_lang_js={name:"PlannerOverview",components:{ShiftPlanTopBar:ShiftPlanTopBar,ListView:ListView,CalendarView:CalendarView},created:function(){this.initDefaults()},data:function(){return{timelineRange:null,viewMode:null}},computed:{isCalendarViewSelected:function(){return this.viewMode&&"Calendar View"===this.viewMode}},methods:{initDefaults:function(){this.viewMode="Calendar View";var date=new Date,from=new Date(date.getFullYear(),date.getMonth(),1).valueOf(),to=new Date(date.getFullYear(),date.getMonth()+1,0).valueOf();this.timelineRange={from:from,to:to}},updateTimelineRange:function(value){this.timelineRange=value},updateViewMode:function(value){this.viewMode=value}}},shiftPlanner_PlannerOverviewvue_type_script_lang_js=PlannerOverviewvue_type_script_lang_js,PlannerOverview_component=(0,componentNormalizer/* default */.Z)(shiftPlanner_PlannerOverviewvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,PlannerOverview=PlannerOverview_component.exports},
/***/849561:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return peopleMixin}});
// EXTERNAL MODULE: ./node_modules/core-js/modules/es.string.pad-start.js
__webpack_require__(108472),__webpack_require__(260228),__webpack_require__(212826),__webpack_require__(634338);
// EXTERNAL MODULE: ./node_modules/core-js/modules/es.object.to-string.js
var render,staticRenderFns,moment_timezone=__webpack_require__(480008),moment_timezone_default=__webpack_require__.n(moment_timezone),peopleMixinvue_type_script_lang_js={methods:{getTodayDate:function(){return(new Date).setHours(0,0,0,0).valueOf()},computeSlotEndDay:function(epoch,span){return moment_timezone_default()(epoch).add(span-1,"days").valueOf()},readableTime:function(secondsOfDay){secondsOfDay||(secondsOfDay=0);var millisecondsOfDay=1e3*secondsOfDay;return this.formatDateWithOnlyTime((new Date).setHours(0,0,0,0)+millisecondsOfDay)},prettifyEmpty:function(value){return value||"---"},formatTime:function(t){return t.toString().padStart(2,"0")},secondsToHoursAndMinutes:function(seconds){if(!seconds)return"---";var h=Math.floor(seconds/3600),m=Math.floor(seconds%3600/60);return"".concat(h,"h : ").concat(m,"m")},msToHoursAndMinutes:function(ms){return ms?this.secondsToHoursAndMinutes(ms/1e3):"---"},formatDate:function(date,exclTime,onlyTime){return date?this.$options.filters.formatDate(date,exclTime,onlyTime):"---"},formatDateWithoutTime:function(date){return this.formatDate(date,!0,!1)},formatDateWithOnlyTime:function(date){return this.formatDate(date,!1,!0)},getDisplayNameForTransition:function(name){switch(name){case"CHECK_IN":return"Check-In";case"CHECK_OUT":return"Check-Out";case"RESUME_WORK":return"Resume Work";case"BREAK":return"Break";default:return"---"}},getDisplayNameForStatus:function(name){switch(name){case"ABSENT":return"Absent";case"PRESENT":return"Present";case"WEEKLY_OFF":return"Weekly Off";case"LEAVE":return"Leave";default:return"---"}}}},peopleV2_peopleMixinvue_type_script_lang_js=peopleMixinvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(peopleV2_peopleMixinvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,peopleMixin=component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/72231.js.map