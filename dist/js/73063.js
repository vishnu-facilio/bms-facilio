(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[73063],{
/***/106170:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FStepper}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/FStepper.vue?vue&type=template&id=b90451ae
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"stepper-container"},[_c("div",{staticClass:"stepper-title"},[_vm._t("title")],2),_c("div",{staticClass:"stepper-tabs"},[_c("div",{staticClass:"stepper-tabs-list"},_vm._l(_vm.steps,(function(step,index){return _c("ul",{key:step.title},[_c("li",{class:["tab-item f13 letter-spacing0_5",_vm.isEdit&&!_vm.disableGoto&&"pointer"],on:{click:function($event){return _vm.goToStep(index)}}},[_c("div",{class:["form-dot-align",_vm.isActiveStep(step)?"dot-active-pink":"dot-inactive-grey"]}),_vm._v(" "+_vm._s(step.title)+" ")])])})),0),_c("div",{staticClass:"stepper-tabs-content"},[_vm.keepAliveData?_c("keep-alive",[_c(_vm.activeStep.component,{tag:"component",attrs:{sharedData:_vm.sharedData},on:{nextStep:_vm.nextStep,goToPreviousStep:_vm.goToPreviousStep,generateFinalSharedData:_vm.generateFinalSharedData}})],1):_c(_vm.activeStep.component,{tag:"component",attrs:{sharedData:_vm.sharedData},on:{nextStep:_vm.nextStep,goToPreviousStep:_vm.goToPreviousStep,generateFinalSharedData:_vm.generateFinalSharedData}})],1)])])},staticRenderFns=[],validation=(__webpack_require__(339772),__webpack_require__(990260)),FSteppervue_type_script_lang_js={props:{steps:{type:Array,required:!0},initialStep:{type:Object,required:!0},keepAliveData:{type:Boolean},isEdit:{type:Boolean},disableGoto:{type:Boolean}},data:function(){return{activeStep:this.initialStep,previousStep:null,sharedData:{}}},computed:{activeStepIndex:function(){var steps=this.steps,activeStep=this.activeStep;return steps.findIndex((function(step){return step.title===activeStep.title}))}},methods:{isActiveStep:function(step){var activeStep=this.activeStep;return activeStep.title===step.title},nextStep:function(formModel){var steps=this.steps,sharedData=this.sharedData,activeStepIndex=this.activeStepIndex;this.previousStep=activeStepIndex>0?steps[activeStepIndex-1]:null,this.activeStep=steps[activeStepIndex+1],this.sharedData=Object.assign(sharedData,formModel)},goToPreviousStep:function(formModel){var steps=this.steps,activeStepIndex=this.activeStepIndex,sharedData=this.sharedData;this.activeStep=steps[activeStepIndex-1],this.previousStep=activeStepIndex>0?steps[activeStepIndex-1]:null,this.sharedData=Object.assign(sharedData,formModel)},goToStep:function(index){var isEdit=this.isEdit,activeStepIndex=this.activeStepIndex,steps=this.steps,disableGoto=this.disableGoto;isEdit&&!disableGoto&&(activeStepIndex=index,this.activeStep=steps[activeStepIndex])},generateFinalSharedData:function(formModel){var sharedData=this.sharedData,saveGoalType=formModel.saveGoalType;this.sharedData=Object.assign(sharedData,formModel),
// TODO: Have to remove this once rules feature is done
(0,validation/* isEmpty */.xb)(saveGoalType)||(0===saveGoalType?delete sharedData.saveGoal:delete sharedData.saveGoalFormulaField,delete sharedData.saveGoalType),this.$emit("finalStep",sharedData)}}},components_FSteppervue_type_script_lang_js=FSteppervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FSteppervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FStepper=component.exports},
/***/222484:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return RuleConfiguration}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/alarm/rule/RuleConfiguration.vue?vue&type=template&id=a0523874
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"mv-container"},[_c("FStepper",{attrs:{steps:_vm.steps,initialStep:_vm.steps[0],keepAliveData:!0},on:{finalStep:_vm.saveRecord}},[_c("div",{staticClass:"rule-title-container d-flex flex-direction-column justify-content-end",attrs:{slot:"title"},slot:"title"},[_c("div",{staticClass:"rule-title"},[_vm._v(" "+_vm._s(_vm.$t("rule.create.new_custom_alarm_rule"))+" ")]),_c("div",{staticClass:"mT5 f20 fw3 letter-spacing0_5"},[_c("portal-target",{attrs:{name:"rule-title"}})],1)])])],1)},staticRenderFns=[],FStepper=(__webpack_require__(434284),__webpack_require__(670560),__webpack_require__(506203),__webpack_require__(450886),__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(976801),__webpack_require__(106170)),BasicInfoFormvue_type_template_id_559e75f9_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"rule-basic-info-container d-flex flex-direction-column"},[_c("div",{staticClass:"header f12 bold mT50 mL70 mR30 d-flex"},[_c("div",[_c("div",{staticClass:"text-uppercase"},[_vm._v(_vm._s(_vm.$t("rule.create.new_alarm_rule")))]),_c("div",{staticClass:"fc-heading-border-width43 mT15"})])]),_vm.isLoading?_c("div",{staticClass:"loading-container d-flex"},[_c("Spinner",{attrs:{show:_vm.isLoading}})],1):_vm._e(),_c("div",{staticClass:"position-relative"},[_c("div",{staticClass:"rule-basic-info-content"},[_c("div",{staticClass:"rule-info-form"},[_c("el-form",{ref:"ruleInfoForm",attrs:{model:_vm.alarmRule,"label-position":"left","label-width":"100px"}},[_c("div",{staticClass:"section-container flex-container"},[_c("div",{staticClass:"form-one-column fc-label-required"},[_c("el-form-item",{attrs:{rules:[{required:!0,message:this.$t("common.header.please_enter_rule_name")}],label:_vm.$t("common.header.alarm_rule_name"),"label-width":"150px",prop:"preRequsite.name"}},[_c("el-input",{staticClass:"fc-input-full-border2 width575px",attrs:{placeholder:_vm.$t("common.header.alarm_rule_name"),autofocus:!0},model:{value:_vm.alarmRule.preRequsite.name,callback:function($$v){_vm.$set(_vm.alarmRule.preRequsite,"name",$$v)},expression:"alarmRule.preRequsite.name"}})],1)],1),_c("div",{staticClass:"form-one-column"},[_c("el-form-item",{attrs:{label:_vm.$t("common.wo_report.report_description"),"label-width":"150px"}},[_c("el-input",{staticClass:"fc-input-full-border-textarea width575px",attrs:{type:"textarea",resize:"none",autosize:{minRows:6,maxRows:4},placeholder:_vm.$t("common._common.enter_desc")},model:{value:_vm.alarmRule.preRequsite.description,callback:function($$v){_vm.$set(_vm.alarmRule.preRequsite,"description",$$v)},expression:"alarmRule.preRequsite.description"}})],1)],1),_c("div",{staticClass:"form-one-column"},[_c("el-form-item",{attrs:{label:_vm.$t("common.header.alarm_type"),"label-width":"150px"}},[_c("el-radio-group",{model:{value:_vm.resourceType,callback:function($$v){_vm.resourceType=$$v},expression:"resourceType"}},[_c("el-radio",{staticClass:"fc-radio-btn",attrs:{label:"asset"}},[_vm._v(_vm._s(_vm.$t("common._common.asset")))]),_c("el-radio",{staticClass:"fc-radio-btn",attrs:{label:"space"}},[_vm._v(_vm._s(_vm.$t("common.space_asset_chooser.space")))])],1)],1)],1),_c("el-row",[_c("el-col",{attrs:{span:12}},["asset"===_vm.resourceType?_c("div",{staticClass:"form-two-column"},[_c("el-form-item",{staticClass:"section-items",attrs:{label:_vm.$t("common._common.asset_category"),"label-width":"150px"}},[_c("el-select",{staticClass:"fc-input-full-border-select2 width213px",attrs:{disabled:_vm.isEdit,filterable:"",placeholder:_vm.$t("common._common.select")},on:{change:function($event){return _vm.loadThresholdFields(!0,_vm.alarmRule.preRequsite.assetCategoryId)}},model:{value:_vm.alarmRule.preRequsite.assetCategoryId,callback:function($$v){_vm.$set(_vm.alarmRule.preRequsite,"assetCategoryId",$$v)},expression:"alarmRule.preRequsite.assetCategoryId"}},_vm._l(_vm.assetCategory,(function(category,index){return _c("el-option",{key:index,attrs:{label:category.displayName,value:parseInt(category.id)}})})),1)],1)],1):_vm._e()]),_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"form-two-column"},[_c("el-form-item",{staticClass:"section-items asset-or-space-label",class:{labelPL0:"space"===_vm.resourceType},attrs:{label:"asset"===_vm.resourceType?"Assets":"Space","label-width":"150px"}},[_c("el-input",{staticClass:"fc-border-select fc-input-full-border-select2 width213px",attrs:{disabled:""},model:{value:_vm.resourceLabel,callback:function($$v){_vm.resourceLabel=$$v},expression:"resourceLabel"}},[_c("i",{staticClass:"el-input__icon el-icon-search",staticStyle:{"line-height":"0px !important","font-size":"16px !important",cursor:"pointer"},attrs:{slot:"suffix"},on:{click:function($event){_vm.chooserVisibility=!0}},slot:"suffix"})])],1)],1)])],1),_c("div",{staticClass:"form-one-column fc-label-required"},[_c("el-form-item",{attrs:{rules:[{required:!0,message:this.$t("common.header.please_select_a_field")}],required:!0,label:_vm.$t("common.header.trigger_metric"),prop:"preRequsite.readingFieldId","label-width":"150px"}},[_c("el-select",{staticClass:"fc-input-full-border-select2 width575px",attrs:{disabled:_vm.isEdit,filterable:"",placeholder:_vm.$t("common._common.select")},on:{change:function($event){return _vm.setMetricModule(_vm.alarmRule.preRequsite.readingFieldId,_vm.alarmRule.preRequsite)}},model:{value:_vm.alarmRule.preRequsite.readingFieldId,callback:function($$v){_vm.$set(_vm.alarmRule.preRequsite,"readingFieldId",$$v)},expression:"alarmRule.preRequsite.readingFieldId"}},_vm._l(_vm.thresholdFields,(function(field){return _c("el-option",{key:field.name+field.id,attrs:{label:field.displayName,value:field.id}})})),1)],1)],1),_c("div",{staticClass:"form-one-column fc-label-required"},[_c("el-form-item",{attrs:{label:_vm.$t("common.header.alarm_message"),rules:[{required:!0,message:this.$t("common.header.please_enter_alarm_message")}],prop:"action.message","label-width":"150px",required:!0}},[_c("el-input",{staticClass:"fc-input-full-border-textarea width575px",attrs:{type:"textarea",resize:"none",autosize:{minRows:6,maxRows:4},placeholder:_vm.$t("common._common.type_your_alarm_message")},model:{value:_vm.alarmRule.action.message,callback:function($$v){_vm.$set(_vm.alarmRule.action,"message",$$v)},expression:"alarmRule.action.message"}})],1)],1),_c("div",{staticClass:"form-one-column visibility-visible-actions fc-label-required"},[_c("el-form-item",{attrs:{label:_vm.$t("common._common.severity"),"label-width":"150px",rules:[{required:!0,message:this.$t("common.header.please_select_severity")}],prop:"action.severity",required:!0}},[_c("el-select",{staticClass:"fc-input-full-border-select2 width575px",attrs:{"collapse-tags":""},model:{value:_vm.alarmRule.action.severity,callback:function($$v){_vm.$set(_vm.alarmRule.action,"severity",$$v)},expression:"alarmRule.action.severity"}},_vm._l(_vm.alarmseverity,(function(label){return _c("el-option",{key:label.id,attrs:{label:label.displayName,value:label.severity}})})),1)],1)],1),_c("div",{staticClass:"form-one-column visibility-visible-actions"},[_c("el-form-item",{attrs:{label:_vm.$t("common._common.fault_type"),"label-width":"150px"}},[_c("el-select",{staticClass:"fc-input-full-border-select2 width575px",model:{value:_vm.alarmRule.faultType,callback:function($$v){_vm.$set(_vm.alarmRule,"faultType",$$v)},expression:"alarmRule.faultType"}},_vm._l(_vm.faultTypes,(function(faultTypeData,key){return _c("el-option",{key:key,attrs:{label:faultTypeData,value:parseInt(key)}})})),1)],1)],1),_vm.alarmRule.action?_c("div",{staticClass:"form-one-column visibility-visible-actions"},[_c("el-form-item",{attrs:{label:_vm.$t("common._common.problem"),"label-width":"150px"}},[_c("el-input",{staticClass:"fc-input-full-border2 mT10 width575px",model:{value:_vm.alarmRule.action.problem,callback:function($$v){_vm.$set(_vm.alarmRule.action,"problem",$$v)},expression:"alarmRule.action.problem"}})],1)],1):_vm._e(),_vm.alarmRule.action?_c("div",{staticClass:"form-one-column visibility-visible-actions"},[_c("el-form-item",{attrs:{label:_vm.$t("common._common.possible_causes"),"label-width":"150px"}},[_c("f-multi-text-box",{staticClass:"width575px",attrs:{model:_vm.alarmRule.action.possibleCauses,name:"possibleCauses"},on:{"update:model":function($event){return _vm.$set(_vm.alarmRule.action,"possibleCauses",$event)}}})],1)],1):_vm._e(),_vm.alarmRule.action?_c("div",{staticClass:"form-one-column visibility-visible-actions"},[_c("el-form-item",{attrs:{label:_vm.$t("common._common.recommendation"),"label-width":"150px"}},[_c("f-multi-text-box",{staticClass:"width575px",attrs:{model:_vm.alarmRule.action.recommendation,name:"recommendation"},on:{"update:model":function($event){return _vm.$set(_vm.alarmRule.action,"recommendation",$event)}}})],1)],1):_vm._e(),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-save width100",attrs:{type:"button"},on:{click:_vm.moveToNext}},[_vm._v(" "+_vm._s(_vm.$t("common.header.proceed_to_next"))+" "),_c("img",{staticClass:"fR",attrs:{src:__webpack_require__(936658),width:"17px"}})])],1)],1)])],1)]),"space"===_vm.resourceType?_c("space-asset-chooser",{attrs:{visibility:_vm.chooserVisibility,initialValues:{},query:_vm.resourceQuery,showAsset:!1,picktype:"space"},on:{associate:_vm.associateResource,"update:visibility":function($event){_vm.chooserVisibility=$event}}}):_c("space-asset-multi-chooser",{attrs:{visibility:_vm.chooserVisibility,initialValues:_vm.resourceData,query:_vm.resourceQuery,showAsset:!0,disable:!0},on:{associate:_vm.associateResource,"update:visibility":function($event){_vm.chooserVisibility=$event}}})],1)])},BasicInfoFormvue_type_template_id_559e75f9_staticRenderFns=[],esm_typeof=__webpack_require__(103336),objectSpread2=__webpack_require__(595082),vuex_esm=(__webpack_require__(538077),__webpack_require__(425728),__webpack_require__(420629)),RuleMixin=__webpack_require__(977347),Spinner=__webpack_require__(604947),SpaceAssetChooser=__webpack_require__(372587),SpaceAssetMultiChooser=__webpack_require__(673362),FMultiTextBoxvue_type_template_id_b3931720_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"fc-v1-rule-form-first-page"},[_c("div",_vm._l(_vm.model,(function(prob,index){return _c("div",{key:index,staticClass:"width100 flex-middle position-relative multibox-hover pB10"},[_c("div",{staticClass:"visibility-visible-actions width100 flex-middle "},[_c("div",[_c("el-input",{staticClass:"fc-input-full-border2 fc-v1-rule-form-label-width575",model:{value:_vm.model[index],callback:function($$v){_vm.$set(_vm.model,index,$$v)},expression:"model[index]"}})],1),_c("div",{staticClass:"creteria-delete-icon flex-middle multibox-hover-icon visibility-hide-actions mL15 mT10"},[_c("div",[_c("img",{staticClass:"pointer",staticStyle:{height:"18px",width:"18px"},attrs:{src:__webpack_require__(353654)},on:{click:_vm.addTextBox}})]),_c("div",[_vm.model.length>1?_c("img",{staticClass:"pointer mL10",staticStyle:{height:"18px",width:"18px"},attrs:{src:__webpack_require__(385769)},on:{click:function($event){return _vm.removeTextBox(index)}}}):_vm._e()])])])])})),0)])},FMultiTextBoxvue_type_template_id_b3931720_staticRenderFns=[],FMultiTextBoxvue_type_script_lang_js={props:{model:{type:Array}},data:function(){return{multiTextValue:[]}},watch:{model:function(){this.model.length>0||(this.$set(this.model,0,""),this.model=this.$helpers.cloneObject(this.model))}},created:function(){this.model.length>0||(this.$set(this.model,0,""),this.model=this.$helpers.cloneObject(this.model))},methods:{addTextBox:function(){this.$set(this.model,this.model.length,""),this.model=this.$helpers.cloneObject(this.model)},removeTextBox:function(index){this.$delete(this.model,index)}}},components_FMultiTextBoxvue_type_script_lang_js=FMultiTextBoxvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FMultiTextBoxvue_type_script_lang_js,FMultiTextBoxvue_type_template_id_b3931720_render,FMultiTextBoxvue_type_template_id_b3931720_staticRenderFns,!1,null,null,null)
/* harmony default export */,FMultiTextBox=component.exports,validation=__webpack_require__(990260),BasicInfoFormvue_type_script_lang_js={mixins:[RuleMixin/* default */.Z],components:{Spinner:Spinner/* default */.Z,FMultiTextBox:FMultiTextBox,SpaceAssetChooser:SpaceAssetChooser/* default */.Z,SpaceAssetMultiChooser:SpaceAssetMultiChooser/* default */.Z},props:{sharedData:{type:Object}},created:function(){this.$store.dispatch("loadAssetCategory"),this.$store.dispatch("loadAlarmSeverity"),this.$store.dispatch("view/loadModuleMeta","readingrule")},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({isEdit:function(){return"rule-creation-edit"===this.$route.name},customFields:function(){return this.alarmFields},faultTypes:function(){var enumMap=null;if(this.metaInfo&&null!=this.metaInfo.fields){var faultFields=this.metaInfo.fields.filter((function(d){return"faultType"===d.displayName}));enumMap=faultFields[0].enumMap}return enumMap;
//  else {
//   return null
// }
}},(0,vuex_esm/* mapState */.rn)({assetCategory:function(state){return state.assetCategory},alarmseverity:function(state){return state.alarmSeverity},metaInfo:function(state){return state.view.metaInfo}})),{},{isAsset:function(){return"asset"===this.resourceType},isMultiResource:function(){return this.isAsset&&(!this.alarmRule.preRequsite||this.alarmRule.preRequsite.assetCategoryId>0)},resourceData:function(){
// if (isEmpty(this.alarmRule.selectedResourceList)) {
//   return null
// }
return{assetCategory:this.alarmRule.preRequsite.assetCategoryId,isIncludeResource:this.alarmRule.isIncludeResource,selectedResources:Array.isArray(this.alarmRule.selectedResourceList)?this.alarmRule.selectedResourceList.map((function(resource){return{id:resource&&"object"===(0,esm_typeof/* default */.Z)(resource)?resource.id:resource}})):this.alarmRule.selectedResourceList.id}},resourceLabel:function(){var _this=this;if(this.alarmRule.preRequsite.assetCategoryId>0){var message,category=this.assetCategory.filter((function(d){return d.id===_this.alarmRule.preRequsite.assetCategoryId})),selectedCount=this.alarmRule.selectedResourceList.length;if(selectedCount){var includeMsg=this.alarmRule.isIncludeResource?"included":"excluded";
// if (selectedCount === 1) {
//   return this.alarmRule.alarmTriggerRule.selectedResourceList[0].name
// }
message=selectedCount+" "+category[0].name+(selectedCount>1?"s":"")+" "+includeMsg}else message="All "+category[0].name+"s selected";return message}return this.alarmRule.selectedResourceList.id>0?this.alarmRule.selectedResourceList.name:null}}),data:function(){return{dataFromTemplate:null,metricFieldName:null,templateId:this.$route.params.templateid,ruleId:this.$route.params.id,modelData:{},resourceQuery:null,resourceType:"asset",faultTypeData:null,alarmRule:{preRequsite:{name:null,description:null,assetCategoryId:null,thresholdType:1,event:{moduleId:37,activityType:1}},action:{problem:null,possibleCauses:[],recommendation:[],severity:null,message:null},
// alarmTriggerRule: {
//   faultType: null,
// },
faultType:null,module:"readingRule",isIncludeResource:!1,alarmFields:[],selectedResourceList:[]},thresholdFields:[],isLoading:!1,isSaving:!1,chooserVisibility:!1,temp:null}},mounted:function(){this.fetchRules()},methods:{moveToNext:function(){var _this2=this;this.$refs["ruleInfoForm"].validate((function(valid){valid&&(_this2.alarmRule.action&&_this2.alarmRule.action.severity&&(_this2.alarmRule.preRequsite.alarmSeverityId=_this2.alarmseverity.find((function(d){return _this2.alarmRule.action.severity===d.displayName})).id),_this2.$emit("nextStep",_this2.alarmRule))}))},fetchRules:function(){var _this3=this,self=this;this.templateId?(this.dataFromTemplate=this.$helpers.cloneObject(this.$store.state.ruleTemplate.ruleContext),this.fetchRuleNew(this.dataFromTemplate)):this.ruleId&&self.$util.fetchRules("alarm",this.ruleId).then((function(data){_this3.fetchRuleNew(data)}))},fetchRuleNew:function(data){var _this4=this;this.isLoading=!1;var ruleObj=this.$helpers.cloneObject(data.alarmRule);if(Object.assign(this.alarmRule,ruleObj),this.alarmRule.preRequsite.action={problem:[],possibleCauses:[],recommendation:[],message:null,severity:null},this.alarmRule.preRequsite.assetCategoryId>0?(this.resourceType="asset",this.alarmRule.preRequsite.includedResources&&this.alarmRule.preRequsite.includedResources.length?(this.alarmRule.isIncludeResource=!0,this.alarmRule.selectedResourceList=this.alarmRule.preRequsite.includedResources.map((function(id){return{id:id}}))):this.alarmRule.preRequsite.excludedResources&&(this.alarmRule.selectedResourceList=this.alarmRule.preRequsite.excludedResources.map((function(id){return{id:id}}))),this.loadThresholdFields(!0,this.alarmRule.preRequsite.assetCategoryId)):(this.resourceType="space",this.alarmRule.selectedResourceList=this.alarmRule.preRequsite.matchedResources[this.alarmRule.preRequsite.resourceId],this.loadThresholdFields(!1,-1,this.alarmRule.selectedResourceList)),this.alarmRule.preRequsite.workflow&&(this.alarmRule.isPrerequest=!0),
// this.parseCondition(this.alarmRule.alarmTriggerRule)
this.alarmRule.faultType=(0,validation/* isEmpty */.xb)(this.alarmRule.alarmTriggerRule.faultType)?null:this.alarmRule.alarmTriggerRule.faultType,this.alarmRule.alarmTriggerRule.actions.length>0&&this.alarmRule.alarmTriggerRule.actions[0])if(this.alarmRule.alarmTriggerRule.actions[0].template){var template=this.alarmRule.alarmTriggerRule.actions[0].template.originalTemplate;this.$set(this.alarmRule.action,"message",template.message),this.$set(this.alarmRule.action,"problem",template.problem),this.alarmRule.action.possibleCauses=template.possibleCauses?template.possibleCauses.split(" \n "):[],this.alarmRule.action.recommendation=template.recommendation?template.recommendation.split(" \n "):[],this.alarmRule.action.severity=template.severity,template.impact&&(this.alarmRule.impactsContext={},this.alarmRule.impactsContext.id=template.impact.cost[0],
// template.impact.cost = [ruleObject.impactsContext.id]
this.alarmRule.enableimpacts=!0)}else this.alarmRule.alarmTriggerRule.actions[0].templateJson.fieldMatcher.forEach((function(context){_this4.$set(_this4.alarmRule.action,context.field,context.value?context.value.split("\n"):[])})),this.alarmRule.action.severity=this.alarmRule.alarmTriggerRule.actions[0].templateJson.fieldMatcher[3].value;this.alarmRule.alarmRCARules.length>0&&(this.alarmRule.alarmRCARules=this.alarmRule.alarmRCARules),this.alarmRule.readingAlarmRuleContexts&&this.alarmRule.readingAlarmRuleContexts.forEach((function(context){if(!(0,validation/* isEmpty */.xb)(context.actions)){var actions=context.actions;actions.forEach((function(d){22===d.actionType&&(_this4.alarmRule.reportBreakdown=!0)}))}}))},loadAssets:function(){var self=this,url="/asset/all";this.$http.get(url).then((function(response){response.data&&(
// self.assetList = response.data.assets
self.isnew&&!self.isDependant||(self.isMultiResource?self.alarmRule.preRequsite.selectedResourceList=response.data.assets.filter((function(asset){return self.alarmRule.preRequsite.selectedResourceList.some((function(resource){return resource.id===asset.id}))})):self.alarmRule.preRequsite.selectedResource=response.data.assets.find((function(asset){return asset.id===self.selectedResource.id})),self.loadThresholdFields(self.isMultiResource)))}))},ruleCondition:function(){this.ruleId&&(this.parseCondition(this.alarmRule.preRequsite),this.parseCondition(this.alarmRule.alarmTriggerRule))},associateResource:function(selectedObj){"asset"===this.resourceType?selectedObj.resourceList&&selectedObj.resourceList.length&&(this.alarmRule.selectedResourceList=selectedObj.resourceList,this.alarmRule.isIncludeResource=selectedObj.isInclude,
// this.parseLabel = this.resourceLabel(this.alarmRule.selectedResourceList)
this.loadThresholdFields(this.isMultiResource,this.alarmRule.preRequsite.assetCategoryId)):("space"===this.resourceType&&(this.alarmRule.isIncludeResource=!0),this.alarmRule.selectedResourceList=selectedObj,this.loadThresholdFields(!1,null,selectedObj)),this.chooserVisibility=!1,this.resourceQuery=null}}},rule_BasicInfoFormvue_type_script_lang_js=BasicInfoFormvue_type_script_lang_js,BasicInfoForm_component=(0,componentNormalizer/* default */.Z)(rule_BasicInfoFormvue_type_script_lang_js,BasicInfoFormvue_type_template_id_559e75f9_render,BasicInfoFormvue_type_template_id_559e75f9_staticRenderFns,!1,null,null,null)
/* harmony default export */,BasicInfoForm=BasicInfoForm_component.exports,RuleConditionFormvue_type_template_id_0d7f2bce_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"rule-condition-from-container rule-basic-info-container d-flex flex-direction-column"},[_vm.isLoading?_c("div",{staticClass:"loading-container d-flex"},[_c("Spinner",{attrs:{show:_vm.isLoading}})],1):_vm._e(),_c("div",{staticClass:"rule-condition-from-content rule-basic-info-content"},[_c("div",{staticClass:"rule-info-form"},[_c("div",{staticClass:"position-relative"},[_c("div",{staticClass:"header f12 bold mT30 mR30 d-flex"},[_c("div",[_c("div",{staticClass:"text-uppercase"},[_vm._v(" "+_vm._s(_vm.$t("rule.create.prerequisite_condition"))+" ")]),_c("div",{staticClass:"fc-heading-border-width43 mT15"}),_c("div",{staticClass:"fc-grey2 f13 pT10"},[_vm._v(" "+_vm._s(_vm.$t("common.header.create_single_multiple"))+" ")])])]),_c("el-form",[_c("div",{staticClass:"pT10"},[_c("el-checkbox",{model:{value:_vm.rule.isPrerequest,callback:function($$v){_vm.$set(_vm.rule,"isPrerequest",$$v)},expression:"rule.isPrerequest"}},[_vm._v(_vm._s(_vm.$t("common.header.enable_pre_requisite")))])],1),_vm.rule.isPrerequest?_c("div",[_c("div",{staticClass:"rule-condition-from"},[_c("f-threshold-condition",{staticClass:"position-relative mT30 rule-condition",attrs:{modelData:_vm.rule.preRequsite,title:"Prerequiste",isSeverity:!0,thresholdFields:_vm.thresholdFields,metricFields:_vm.selectedMetricFields,assetCategoryId:_vm.rule.preRequsite.assetCategoryId},on:{"update:modelData":function($event){return _vm.$set(_vm.rule,"preRequsite",$event)},"update:model-data":function($event){return _vm.$set(_vm.rule,"preRequsite",$event)}}})],1)]):_vm._e(),_c("div",{staticClass:"header f12 bold mT30 d-flex"},[_c("div",[_c("div",{staticClass:"text-uppercase"},[_vm._v(" "+_vm._s(_vm.$t("rule.create.alarm_condition"))+" ")]),_c("div",{staticClass:"fc-heading-border-width43 mT15"}),_c("div",{staticClass:"fc-grey2 f13 pT10"},[_vm._v(" "+_vm._s(_vm.$t("common.header.create_single_multiple"))+" ")])])]),_c("div",{staticClass:"pT20"},[_c("div",{staticClass:"rule-condition-from"},[_c("f-threshold-condition",{staticClass:"rule-condition",attrs:{title:_vm.$t("common.header.alarm_condition"),isSeverity:!0,modelData:_vm.rule.alarmTriggerRule,thresholdMetric:_vm.rule.preRequsite.selectedMetric,metricFields:_vm.selectedMetricFields,assetCategoryId:_vm.rule.preRequsite.assetCategoryId,thresholdFields:_vm.thresholdFields},on:{"update:modelData":function($event){return _vm.$set(_vm.rule,"alarmTriggerRule",$event)},"update:model-data":function($event){return _vm.$set(_vm.rule,"alarmTriggerRule",$event)}}})],1)]),_c("div",{staticClass:"pT20"},[_c("el-checkbox",{model:{value:_vm.rule.reportBreakdown,callback:function($$v){_vm.$set(_vm.rule,"reportBreakdown",$$v)},expression:"rule.reportBreakdown"}},[_vm._v(_vm._s(_vm.$t("rule.create.report_for_downtime")))])],1),_c("div",{staticClass:"header f12 bold mT30 d-flex"},[_c("div",[_c("div",{staticClass:"text-uppercase"},[_vm._v(" "+_vm._s(_vm.$t("rule.create.alarm_clear_condition"))+" ")]),_c("div",{staticClass:"fc-heading-border-width43 mT15"}),_c("div",{staticClass:"fc-grey2 f13 pT10"},[_vm._v(" "+_vm._s(_vm.$t("common.header.create_single_multiple"))+" ")])])]),_c("div",{staticClass:"mT20"},[_c("el-form-item",[_c("el-radio",{staticClass:"fc-radio-btn",attrs:{label:!0,value:!0},model:{value:_vm.rule.autoClear,callback:function($$v){_vm.$set(_vm.rule,"autoClear",$$v)},expression:"rule.autoClear"}},[_vm._v(_vm._s(_vm.$t("common._common.auto_clear")))]),_c("el-radio",{staticClass:"fc-radio-btn",attrs:{label:!1,value:!1},model:{value:_vm.rule.autoClear,callback:function($$v){_vm.$set(_vm.rule,"autoClear",$$v)},expression:"rule.autoClear"}},[_vm._v(" "+_vm._s(_vm.$t("common.header.clear_based_condition"))+" ")])],1),_c("div",{staticClass:"rule-condition-from"},[_c("f-threshold-condition",{directives:[{name:"show",rawName:"v-show",value:!_vm.rule.autoClear,expression:"!rule.autoClear"}],staticClass:"position-relative rule-condition",attrs:{title:_vm.$t("common.header.clear"),modelData:_vm.rule.alarmClearRule,thresholdFields:_vm.thresholdFields},on:{"update:modelData":function($event){return _vm.$set(_vm.rule,"alarmClearRule",$event)},"update:model-data":function($event){return _vm.$set(_vm.rule,"alarmClearRule",$event)}}})],1)],1)])],1)])]),_c("div",{staticClass:"modal-dialog-footer",staticStyle:{position:"relative"}},[_c("el-button",{staticClass:"modal-btn-cancel",attrs:{type:"button"},on:{click:_vm.goToPrevious}},[_vm._v(_vm._s(_vm.$t("common._common.previous")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"button"},on:{click:_vm.moveToNext}},[_vm._v(" "+_vm._s(_vm.$t("common.header.proceed_to_next"))+" "),_c("img",{staticClass:"fR",attrs:{src:__webpack_require__(936658),width:"17px"}})])],1)])},RuleConditionFormvue_type_template_id_0d7f2bce_staticRenderFns=[],FThresholdConditionvue_type_template_id_af0756f8_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.modelData?_c("div",[_c("el-row",{staticClass:"mT10"},[_vm.isSeverity?_vm._e():_c("el-col",{staticClass:"pR10",attrs:{span:8}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.title)+" "+_vm._s(_vm.$t("common.tabs.metric"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{filterable:"",placeholder:_vm.$t("common._common.select")},on:{change:function($event){return _vm.setMetricModule(_vm.modelData.readingFieldId,_vm.modelData)}},model:{value:_vm.modelData.readingFieldId,callback:function($$v){_vm.$set(_vm.modelData,"readingFieldId",$$v)},expression:"modelData.readingFieldId"}},_vm._l(_vm.categoryFields,(function(field){return _c("el-option",{key:field.id,attrs:{label:field.displayName,value:field.id}})})),1)],1),_c("el-col",{attrs:{span:8}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.$t("common._common.condition_type"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width100 pR10",attrs:{"collapse-tags":""},on:{change:_vm.loadType},model:{value:_vm.modelData.thresholdType,callback:function($$v){_vm.$set(_vm.modelData,"thresholdType",$$v)},expression:"modelData.thresholdType"}},_vm._l(_vm.$constants.CONDITION_TYPE,(function(label,value){return _c("el-option",{key:value,attrs:{label:label,value:parseInt(value)}})})),1)],1)],1),_c("el-row",[2===_vm.modelData.thresholdType||3===_vm.modelData.thresholdType?_c("el-col",[3===_vm.modelData.thresholdType?_c("el-row",{staticClass:"mT20",attrs:{align:"middle",gutter:20}},[_c("el-col",{attrs:{span:8}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.$t("common.header.baseline"))+" ")]),_c("div",{staticClass:"add"},[_c("el-select",{staticClass:"form-item fc-input-full-border-select2 width100",attrs:{placeholder:_vm.$t("common.products.choose_baseline")},model:{value:_vm.modelData.baselineId,callback:function($$v){_vm.$set(_vm.modelData,"baselineId",$$v)},expression:"modelData.baselineId"}},_vm._l(_vm.baselines,(function(baseline){return _c("el-option",{key:baseline.id,attrs:{label:baseline.name,value:baseline.id}})})),1)],1)])],1):_vm._e(),_c("el-row",{staticClass:"position-relative pT20 pB20",attrs:{align:"middle",gutter:20}},[_c("el-col",{attrs:{span:8}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.$t("common._common.aggregation"))+" ")]),_c("div",{staticClass:"add"},[_c("el-select",{staticClass:"form-item fc-input-full-border-select2 width100",attrs:{placeholder:_vm.$t("common.products.choose_aggregation")},model:{value:_vm.modelData.aggregation,callback:function($$v){_vm.$set(_vm.modelData,"aggregation",$$v)},expression:"modelData.aggregation"}},[_c("el-option",{key:"sum",attrs:{label:_vm.$t("common._common.sum"),value:"sum"}}),_c("el-option",{key:"avg",attrs:{label:_vm.$t("common._common.average"),value:"avg"}}),_c("el-option",{key:"min",attrs:{label:_vm.$t("common.wo_report.minimum"),value:"min"}}),_c("el-option",{key:"max",attrs:{label:_vm.$t("common.wo_report.maximum"),value:"max"}})],1)],1)]),_c("el-col",{attrs:{span:12}},[_c("duration",{attrs:{label:_vm.$t("common.date_picker.date_range"),labelClass:"fc-input-label-txt",format:"h",size:"l",minHour:!0},model:{value:_vm.modelData.dateRange,callback:function($$v){_vm.$set(_vm.modelData,"dateRange",$$v)},expression:"modelData.dateRange"}},[_c("el-col",{staticClass:"pT10",attrs:{slot:"prefix",span:3},slot:"prefix"},[_c("span",{staticClass:"textcolor vertical-sub"},[_vm._v(_vm._s(_vm.$t("common.products.last")))])])],1)],1),_c("el-col",{staticClass:"mT20",attrs:{span:8}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.Operator"))+" ")]),_c("div",{staticClass:"add"},[_c("el-select",{staticClass:"form-item fc-input-full-border-select2 width100",attrs:{placeholder:_vm.$t("common.products.choose_operator")},model:{value:_vm.modelData.operatorId,callback:function($$v){_vm.$set(_vm.modelData,"operatorId",$$v)},expression:"modelData.operatorId"}},[_c("el-option",{key:9,attrs:{label:_vm.$t("common.products.equals"),value:9}}),_c("el-option",{key:10,attrs:{label:_vm.$t("common._common.not_equals"),value:10}}),_c("el-option",{key:13,attrs:{label:_vm.$t("common._common.greater_than"),value:13}}),_c("el-option",{key:14,attrs:{label:_vm.$t("common._common.greater_than_equals"),value:14}}),_c("el-option",{key:11,attrs:{label:_vm.$t("common._common.less_then"),value:11}}),_c("el-option",{key:12,attrs:{label:_vm.$t("common._common.less_than_equals"),value:12}})],1)],1)]),3===_vm.modelData.thresholdType?_c("el-col",{staticClass:"mT20 pL10",attrs:{span:8}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.$t("common._common.percentage"))+" ")]),_c("div",{staticClass:"add"},[_c("el-input",{staticClass:"fc-input-select fc-input-full-border2 width100",attrs:{type:"number",placeholder:"0%"},model:{value:_vm.modelData.percentage,callback:function($$v){_vm.$set(_vm.modelData,"percentage",$$v)},expression:"modelData.percentage"}})],1)]):_vm._e(),2===_vm.modelData.thresholdType?_c("el-col",{staticClass:"mT20 pL10",attrs:{span:8}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.$t("common.header.value"))+" ")]),_c("div",{staticClass:"add"},[_c("el-input",{staticClass:"fc-input-full-border2 width100",attrs:{placeholder:_vm.$t("common.placeholders.enter_value")},model:{value:_vm.modelData.percentage,callback:function($$v){_vm.$set(_vm.modelData,"percentage",$$v)},expression:"modelData.percentage"}})],1)]):_vm._e()],1)],1):4===_vm.modelData.thresholdType?_c("el-col",[_vm.isBooleanMetric?_vm._e():_c("el-row",{staticClass:"mT20",attrs:{align:"middle",gutter:20}},[_c("el-col",{attrs:{span:8}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.$t("common._common.lower_trigger"))+" ")]),_c("div",{staticClass:"add"},[_c("el-input",{staticClass:"fc-input-full-border2 width100",attrs:{placeholder:_vm.$t("common.placeholders.lower_trigger_value")},model:{value:_vm.modelData.minFlapValue,callback:function($$v){_vm.$set(_vm.modelData,"minFlapValue",$$v)},expression:"modelData.minFlapValue"}})],1)]),_c("el-col",{attrs:{span:8}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.$t("common._common.upper_trigger"))+" ")]),_c("div",{staticClass:"add"},[_c("el-input",{staticClass:"fc-input-full-border2 width100",attrs:{placeholder:_vm.$t("common.placeholders.upper_trigger_value")},model:{value:_vm.modelData.maxFlapValue,callback:function($$v){_vm.$set(_vm.modelData,"maxFlapValue",$$v)},expression:"modelData.maxFlapValue"}})],1)])],1),_c("el-row",{staticClass:"mT20 mB20",attrs:{align:"middle",gutter:20}},[_c("el-col",{attrs:{span:8}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.$t("common.dialog.flapping_frequency_n_times"))+" ")]),_c("div",{staticClass:"add"},[_c("el-input",{staticClass:"fc-input-full-border2 width100",attrs:{placeholder:_vm.$t("common.placeholders.enter_flapping_frequency")},model:{value:_vm.modelData.flapFrequency,callback:function($$v){_vm.$set(_vm.modelData,"flapFrequency",$$v)},expression:"modelData.flapFrequency"}})],1)]),_c("el-col",{attrs:{span:8}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.$t("common.dialog.flapping_interval_period_in_minutes"))+" ")]),_c("div",{staticClass:"add"},[_c("el-input",{staticClass:"fc-input-full-border2 width100",attrs:{placeholder:_vm.$t("common.placeholders.enter_flapping_interval")},model:{value:_vm.modelData.flapInterval,callback:function($$v){_vm.$set(_vm.modelData,"flapInterval",$$v)},expression:"modelData.flapInterval"}})],1)])],1)],1):1===_vm.modelData.thresholdType?_c("el-col",[_c("el-row",{staticClass:"mT20 mB20",attrs:{align:"middle"}},[_c("el-col",{attrs:{span:8}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.Operator"))+" ")]),_c("div",{staticClass:"add"},[_c("el-select",{staticClass:"form-item fc-input-full-border2 width100 pR10",attrs:{placeholder:_vm.$t("common.products.choose_operator")},model:{value:_vm.modelData.operatorId,callback:function($$v){_vm.$set(_vm.modelData,"operatorId",$$v)},expression:"modelData.operatorId"}},_vm._l(_vm.operators,(function(operator){return _c("el-option",{key:operator.operator,attrs:{label:operator.label,value:operator.operator}})})),1)],1)]),_c("el-col",{attrs:{span:8}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.$t("common.header.value"))+" ")]),_c("div",{staticClass:"add"},[_vm.isBooleanMetric?_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{placeholder:_vm.$t("common._common.select")},model:{value:_vm.modelData.percentage,callback:function($$v){_vm.$set(_vm.modelData,"percentage",$$v)},expression:"modelData.percentage"}},[_c("el-option",{attrs:{label:_vm.selectedMetric.trueVal||"True",value:"TRUE"}}),_c("el-option",{attrs:{label:_vm.selectedMetric.falseVal||"False",value:"FALSE"}})],1):_c("el-input",{staticClass:"fc-input-full-border2",attrs:{placeholder:_vm.$t("common.placeholders.enter_value")},model:{value:_vm.modelData.percentage,callback:function($$v){_vm.$set(_vm.modelData,"percentage",$$v)},expression:"modelData.percentage"}})],1)]),_c("el-col",{staticClass:"pL10",attrs:{span:8}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.$t("common._common.occurrences"))+" ")]),_c("div",{staticClass:"add"},[_c("el-input",{staticClass:"fc-input-select fc-input-full-border2",attrs:{type:"number",placeholder:_vm.$t("common.placeholders.enter_occurrences")},model:{value:_vm.modelData.occurences,callback:function($$v){_vm.$set(_vm.modelData,"occurences",$$v)},expression:"modelData.occurences"}})],1)])],1),_vm.modelData.occurences>0?_c("el-row",{staticStyle:{margin:"0px"},attrs:{align:"middle",gutter:20}},[_c("el-col",{staticStyle:{"padding-left":"0px"},attrs:{span:24}},[_c("div",{staticClass:"textcolor pT0"},[_c("el-radio-group",{on:{change:function($event){return _vm.changeOccurence()}},model:{value:_vm.modelData.consecutiveoroverperiod,callback:function($$v){_vm.$set(_vm.modelData,"consecutiveoroverperiod",$$v)},expression:"modelData.consecutiveoroverperiod"}},[_c("el-radio",{staticClass:"fc-radio-btn",attrs:{label:1}},[_vm._v(_vm._s(_vm.$t("common.header.over_period")))]),_c("el-radio",{staticClass:"fc-radio-btn",attrs:{label:2}},[_vm._v(_vm._s(_vm.$t("common.products.consecutive")))])],1)],1)])],1):_vm._e(),_vm.modelData.occurences>0&&1===_vm.modelData.consecutiveoroverperiod?_c("el-row",{staticClass:"mT20",attrs:{align:"middle"}},[_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.period"))+" ")]),_c("div",{staticClass:"add"},[_c("el-select",{staticClass:"width100 fc-input-full-border-select2",attrs:{placeholder:_vm.$t("common.placeholders.choose_period")},on:{change:function($event){return _vm.changeOccurence()}},model:{value:_vm.modelData.overPeriod,callback:function($$v){_vm.$set(_vm.modelData,"overPeriod",$$v)},expression:"modelData.overPeriod"}},[_c("el-option",{key:1,attrs:{label:_vm.$t("common.header.last_1_hour"),value:1}}),_c("el-option",{key:3,attrs:{label:_vm.$t("common.header.last_3_hour"),value:3}}),_c("el-option",{key:6,attrs:{label:_vm.$t("common.header.last_6_hour"),value:6}}),_c("el-option",{key:12,attrs:{label:_vm.$t("common.header.last_12_hour"),value:12}})],1)],1)])],1):_vm._e()],1):5===_vm.modelData.thresholdType?_c("el-col",{staticClass:"mB20 rule-condition-formula"},[_c("f-formula-builder",{staticStyle:{"padding-top":"20px"},attrs:{title:"",module:"thresholdrule",metric:_vm.selectedMetric,restrictInit:!0,assetCategory:{id:_vm.assetCategoryId?_vm.assetCategoryId:_vm.modelData.assetCategoryId}},model:{value:_vm.modelData.workflow,callback:function($$v){_vm.$set(_vm.modelData,"workflow",$$v)},expression:"modelData.workflow"}})],1):6===_vm.modelData.thresholdType?_c("el-col",{staticClass:"mB20",attrs:{span:16}},[_c("function",{attrs:{metric:_vm.metricFields,resource:_vm.selectedResource},model:{value:_vm.modelData.workflow,callback:function($$v){_vm.$set(_vm.modelData,"workflow",$$v)},expression:"modelData.workflow"}})],1):_vm._e()],1)],1):_vm._e()},FThresholdConditionvue_type_template_id_af0756f8_staticRenderFns=[],FFormulaBuilder=__webpack_require__(902294),FDuration=__webpack_require__(611097),FFormulaFunction=__webpack_require__(72875),FThresholdConditionvue_type_script_lang_js={mixins:[RuleMixin/* default */.Z],props:["modelData","thresholdMetric","isSeverity","thresholdFields","title","assetCategoryId","metricFields"],components:{FFormulaBuilder:FFormulaBuilder/* default */.Z,Duration:FDuration/* default */.Z,Function:FFormulaFunction/* default */.Z},watch:{modelData:function(newVal,oldVal){newVal!==oldVal&&(
// this.modelData = this.$helpers.cloneObject(newVal)
this.modelData&&3===this.modelData.thresholdType?this.loadBaselines():this.modelData&&1===this.modelData.thresholdType&&this.parseconsecutiveoroverperiod(this.modelData))},thresholdMetric:function(val){this.selectedMetric=val}},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({alarmseverity:function(state){return state.alarmSeverity}})),{},{categoryFields:function(){return this.thresholdFields},isBooleanMetric:function(){return this.selectedMetric&&("BOOLEAN"===this.selectedMetric.dataTypeEnum||"BOOLEAN"===this.selectedMetric.dataTypeEnum._name)},isNumberMetric:function(){return this.selectedMetric&&(["NUMBER","DECIMAL"].includes(this.selectedMetric.dataTypeEnum)||["NUMBER","DECIMAL"].includes(this.selectedMetric.dataTypeEnum._name))},operators:function(){return this.isNumberMetric?this.numberOperators:this.isBooleanMetric?this.booleanOperators:null}}),data:function(){return{thresholdType:1,showPrevPopover:!1,metricFieldName:null,baselines:[],model:{alarmSeverity:null,consecutiveoroverperiod:1,overPeriod:null,occurences:null,workflow:null,readingRule:{module:"",name:"",description:"",executionOrder:0,resourceId:-1,readingFieldId:-1,assetCategoryId:null,event:{moduleId:null,activityType:1},criteria:null,baselineId:null,aggregation:null,overPeriod:null,dateRange:1,operatorId:null,percentage:null,onSuccess:!1,parentRuleId:null}}}},mounted:function(){3===this.modelData.thresholdType?this.loadBaselines():1===this.modelData.thresholdType&&this.parseconsecutiveoroverperiod(this.modelData),this.modelData.readingFieldId>0&&(this.setMetricModule(this.modelData.readingFieldId,this.modelData),this.selectedMetric=this.modelData.selectedMetric)},created:function(){this.$store.dispatch("loadAssetCategory"),this.$store.dispatch("loadAlarmSeverity")},methods:{setPrevValue:function(){this.model.readingRule.percentage="${previousValue}",this.showPrevPopover=!1},parseconsecutiveoroverperiod:function(rule){rule.workflow&&rule.occurences&&(
// rule.occurences = rule.percentage < 0 ? null : rule.percentage
rule.percentage=rule.workflow.expressions[0].aggregateCondition&&rule.workflow.expressions[0].aggregateCondition[0]?rule.workflow.expressions[0].aggregateCondition[0].value:null,rule.workflow.expressions[0].criteria.conditions["2"]?(rule.consecutiveoroverperiod=1,rule.overperiod=parseInt(rule.workflow.expressions[0].criteria.conditions["2"].value)):rule.consecutiveoroverperiod=2)},changeOccurence:function(){this.$forceUpdate()},loadType:function(){3===this.modelData.thresholdType&&this.loadBaselines()},loadBaselines:function(){var self=this;self.$http.get("/baseline/all").then((function(response){200===response.status&&(self.baselines=response.data)}))}}},component_FThresholdConditionvue_type_script_lang_js=FThresholdConditionvue_type_script_lang_js,FThresholdCondition_component=(0,componentNormalizer/* default */.Z)(component_FThresholdConditionvue_type_script_lang_js,FThresholdConditionvue_type_template_id_af0756f8_render,FThresholdConditionvue_type_template_id_af0756f8_staticRenderFns,!1,null,null,null)
/* harmony default export */,FThresholdCondition=FThresholdCondition_component.exports,RuleConditionFormvue_type_script_lang_js={components:{Spinner:Spinner/* default */.Z,FThresholdCondition:FThresholdCondition},props:{sharedData:{type:Object}},computed:{thresholdFields:function(){return this.$store.getters["formulabuilder/getAssetReadings"](this.rule.preRequsite.assetCategoryId,!0)}},watch:{"rule.autoClear":function(newVal){newVal||this.rule.alarmClearRule||(this.rule.alarmClearRule={consecutiveoroverperiod:1,dateRange:1,operatorId:null,percentage:null,overperiod:1,occurences:null,name:"alarmClear",thresholdType:1,workflow:null,criteria:null})},"rule.alarmTriggerRule":function(){this.rule.alarmTriggerRule.isChanged||(this.rule.alarmTriggerRule.isChanged=!0)},sharedData:{handler:function(){this.$forceUpdate()},deep:!0}},created:function(){},data:function(){return{selectedMetricFields:null,rule:{isPrerequest:!1,enableRootCause:!1,enableimpacts:!1,isCondition:!1,autoClear:!0,reportBreakdown:!1,preRequsite:{},alarmTriggerRule:{isChanged:!0,consecutiveoroverperiod:null,dateRange:1,operatorId:null,percentage:null,overperiod:null,occurences:null,name:"alarmTriggerRule",actions:[],thresholdType:1,workflow:null,criteria:null},readingAlarmRuleContexts:[],alarmRCARules:[],deletedAlarmRCARules:[],alarmClearRule:{consecutiveoroverperiod:null,dateRange:1,operatorId:null,percentage:null,overperiod:null,occurences:null,name:"alarmClear",thresholdType:1,workflow:null,criteria:null}},modelData:null,module:"readingRule",isSaving:!1,isLoading:!1}},mounted:function(){Object.assign(this.rule,this.sharedData),(0,validation/* isEmpty */.xb)(this.rule.alarmClearRule)&&(this.rule.autoClear=!0)},methods:{moveToNext:function(){this.$emit("nextStep",this.rule)},goToPrevious:function(){this.$emit("goToPreviousStep",null)}}},rule_RuleConditionFormvue_type_script_lang_js=RuleConditionFormvue_type_script_lang_js,RuleConditionForm_component=(0,componentNormalizer/* default */.Z)(rule_RuleConditionFormvue_type_script_lang_js,RuleConditionFormvue_type_template_id_0d7f2bce_render,RuleConditionFormvue_type_template_id_0d7f2bce_staticRenderFns,!1,null,null,null)
/* harmony default export */,RuleConditionForm=RuleConditionForm_component.exports,RootCauseNImpactFormvue_type_template_id_a44f6c3e_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"rule-basic-info-container rule-basic-info-container d-flex flex-direction-column"},[_c("div",{staticClass:"position-relative"},[_c("div",{staticClass:"header f12 bold mT30 mL70 mR30 d-flex"},[_c("div",[_c("div",{staticClass:"text-uppercase"},[_vm._v(_vm._s(_vm.$t("rule.create.root_cause")))]),_c("div",{staticClass:"fc-heading-border-width43 mT15"})])]),_c("div",{staticClass:"rule-condition-from-content rule-basic-info-content"},[_c("div",{staticClass:"rule-info-form"},[_vm.rcaSelectObj.length>0?_c("div",{staticClass:"rca-rule-table"},[_c("div",{staticClass:"flex-middle justify-content-space"},[_c("div",{staticClass:"fc-text-pink text-uppercase"},[_vm._v(" "+_vm._s(_vm.$t("common.header.root_cause_list"))+" ")]),_c("div",{staticClass:"pointer",on:{click:function($event){_vm.showRuleDialog=!0}}},[_c("inline-svg",{staticClass:"vertical-middle",attrs:{src:"svgs/add-circled",iconClass:"icon icon-sm icon-add mR5"}}),_c("span",{staticClass:"btn-text f12 bold green-txt-13 text-uppercase"},[_vm._v(_vm._s(_vm.$t("common.header.add_root_cause")))])],1)]),_c("el-table",{staticClass:"impact-form-table",staticStyle:{width:"100%"},attrs:{data:_vm.rcaSelectObj,fit:!0,height:"500"}},[_c("el-table-column",{attrs:{prop:"label",width:"700"},scopedSlots:_vm._u([{key:"default",fn:function(rule){return[_c("div",{staticClass:"label-txt-black"},[_vm._v(_vm._s(rule.row.label))])]}}],null,!1,3880063208)}),_c("el-table-column",{staticClass:"visibility-visible-actions",attrs:{prop:"label",label:"",width:"100"},scopedSlots:_vm._u([{key:"default",fn:function(rule){return[_c("div",{staticClass:"text-right visibility-visible-actions",on:{click:function($event){return _vm.deleteRca(rule.row.value)}}},[_c("img",{staticClass:"mT10 visibility-hide-actions",attrs:{src:__webpack_require__(984329),width:"15",height:"15"}})])]}}],null,!1,3635794761)})],1)],1):_c("div",{staticClass:"rule-basic-info-content"},[_c("div",{staticClass:"d-flex flex-direction-column text-center"},[_c("inline-svg",{attrs:{src:"svgs/emptystate/data-empty",iconClass:"icon text-center icon-xxxxlg"}}),_c("div",{staticClass:"mT10 empty-text f15 bold"},[_vm._v(" "+_vm._s(_vm.$t("common.header.no_root_cause_available_here"))+" ")]),_c("div",{staticClass:"mT5 empty-text-desc f13"},[_vm._v(" "+_vm._s(_vm.$t("common.header.no_root_cause_available_here"))+" ")]),_c("div",{staticClass:"inline-block mT20"},[_c("el-button",{staticClass:"pT10 pB10 small-border-btn text-uppercase pL15 pR15",on:{click:function($event){_vm.showRuleDialog=!0}}},[_vm._v(_vm._s(_vm.$t("common.header.add_root_cause")))])],1)],1)]),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",attrs:{type:"button"},on:{click:_vm.goToPrevious}},[_vm._v(_vm._s(_vm.$t("common._common.previous")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"button",loading:_vm.isSaving},on:{click:_vm.moveToNext}},[_vm._v(" "+_vm._s(_vm.$t("common.header.proceed_to_next"))+" "),_c("img",{staticClass:"fR",attrs:{src:__webpack_require__(936658),width:"17px"}})])],1),_c("rca-rule-cnf-dialog",{attrs:{visibility:_vm.showRuleDialog,ruleObj:_vm.ruleIds,rcaRuleList:_vm.ruleList,categoryId:_vm.categoryId,sharedData:_vm.sharedData},on:{"update:visibility":function($event){_vm.showRuleDialog=$event},addRcaRule:_vm.associateRcaRule}})],1)])])])},RootCauseNImpactFormvue_type_template_id_a44f6c3e_staticRenderFns=[],RcaRuleCnfDialogvue_type_template_id_0b5cd38c_render=(__webpack_require__(162506),function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticStyle:{"z-index":"999999"},attrs:{visible:_vm.visibility,"append-to-body":!0,title:"Add Root Cause","custom-class":"setup-dialog40 fc-dialog-center-container fc-dialog-center-body-p0","before-close":_vm.closeDialog},on:{"update:visible":function($event){_vm.visibility=$event}}},[_c("div",{staticClass:"rca-rule-dialog-tab"},[_c("el-tabs",{model:{value:_vm.activeTab,callback:function($$v){_vm.activeTab=$$v},expression:"activeTab"}},_vm._l(_vm.tabs,(function(tab,index){return _c("el-tab-pane",{key:tab.name+index,attrs:{name:tab.name,label:tab.displayName,lazy:""}},[_c("div",{staticClass:"height350 overflow-y-scroll pB50"},[_c("el-checkbox-group",{model:{value:_vm.ruleObjs,callback:function($$v){_vm.ruleObjs=$$v},expression:"ruleObjs"}},_vm._l(_vm.ruleList,(function(rule,label){return _c("el-checkbox",{key:label,staticClass:"label-txt-black flex-middle p10 bold visibility-visible-actions",attrs:{label:label}},[_vm._v(_vm._s(rule))])})),1)],1)])})),1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){return _vm.closeDialog()}}},[_vm._v("Cancel")]),_c("el-button",{staticClass:"modal-btn-save",on:{click:function($event){return _vm.addRCARule()}}},[_vm._v("Save")])],1)],1)])}),RcaRuleCnfDialogvue_type_template_id_0b5cd38c_staticRenderFns=[],RcaRuleCnfDialogvue_type_script_lang_js={props:["visibility","ruleObj","categoryId","rcaRuleList","sharedData"],data:function(){return{ruleObjs:this.ruleObj?this.ruleObj:[],activeTab:"configuredAlarm",ruleList:null}},computed:{tabs:function(){var activeTab=this.activeTab;return[{type:"configuredAlarm",name:"configuredAlarm",displayName:"Configured Alarms",isActive:"configuredAlarm"===activeTab}]}},mounted:function(){this.loadCategoryRules()},methods:{loadCategoryRules:function(){var _this=this,params={categoryId:this.categoryId,ruleId:this.sharedData.preRequsite?this.sharedData.preRequsite.id:-1};this.$http.post("/v2/alarm/rules/rcaRules",params).then((function(response){_this.ruleList=response.data.result.rules}))},closeDialog:function(){this.$emit("update:visibility",!1)},addRCARule:function(){this.$emit("addRcaRule",this.ruleObjs),this.$emit("update:visibility",!1)}}},component_RcaRuleCnfDialogvue_type_script_lang_js=RcaRuleCnfDialogvue_type_script_lang_js,RcaRuleCnfDialog_component=(0,componentNormalizer/* default */.Z)(component_RcaRuleCnfDialogvue_type_script_lang_js,RcaRuleCnfDialogvue_type_template_id_0b5cd38c_render,RcaRuleCnfDialogvue_type_template_id_0b5cd38c_staticRenderFns,!1,null,null,null)
/* harmony default export */,RcaRuleCnfDialog=RcaRuleCnfDialog_component.exports,RootCauseNImpactFormvue_type_script_lang_js={components:{RcaRuleCnfDialog:RcaRuleCnfDialog},props:{sharedData:{type:Object}},computed:{isEdit:function(){return"rule-creation-edit"===this.$route.name},categoryId:function(){return this.sharedData.preRequsite?this.sharedData.preRequsite.assetCategoryId:null},ruleIds:function(){return this.sharedData.alarmRCARules}},created:function(){},data:function(){return{ruleList:null,category:{},selectedMetric:null,rcaSelectObj:[],showRuleDialog:!1,module:"readingRule",isSaving:!1,isLoading:!1,rcaRuleID:null}},mounted:function(){this.loadCategoryRules()},methods:{moveToNext:function(){this.sharedData.rcaSelectObj=this.rcaSelectObj,this.$emit("nextStep",this.sharedData)},goToPrevious:function(){this.$emit("goToPreviousStep",null)},associateRcaRule:function(selectedObj){var _this=this;this.rcaSelectObj=[],
// selectedObj.forEach(id => {
//   this.rcaSelectObj.push(this.ruleList.filter(d => d.value === id))
// })
selectedObj.forEach((function(id){_this.rcaSelectObj.push({label:_this.ruleList[id],value:id})})),this.rcaRuleID=selectedObj,this.showRuleDialog=!1},deleteRca:function(id){var deteleIndex;this.rcaSelectObj.forEach((function(d,i){d.value===id&&(deteleIndex=i)})),this.rcaSelectObj.splice(deteleIndex,1)},loadCategoryRules:function(){var _this2=this,params={categoryId:this.categoryId};this.$http.post("/v2/alarm/rules/rcaRules",params).then((function(response){_this2.ruleList=response.data.result.rules,_this2.sharedData.alarmRCARules.length>0&&_this2.sharedData.alarmRCARules.forEach((function(id){_this2.rcaSelectObj.push({label:_this2.ruleList[id],value:id});
// this.rcaSelectObj.push(this.ruleList.filter(d => d.value === dds))
}))}))}}},rule_RootCauseNImpactFormvue_type_script_lang_js=RootCauseNImpactFormvue_type_script_lang_js,RootCauseNImpactForm_component=(0,componentNormalizer/* default */.Z)(rule_RootCauseNImpactFormvue_type_script_lang_js,RootCauseNImpactFormvue_type_template_id_a44f6c3e_render,RootCauseNImpactFormvue_type_template_id_a44f6c3e_staticRenderFns,!1,null,null,null)
/* harmony default export */,RootCauseNImpactForm=RootCauseNImpactForm_component.exports,ImpactFormvue_type_template_id_ba3fd808_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"rule-basic-info-container rule-basic-info-container d-flex flex-direction-column"},[_c("div",{staticClass:"position-relative"},[_c("div",{staticClass:"header f12 bold mT30 mL70 mR30 d-flex"},[_c("div",[_c("div",{staticClass:"text-uppercase"},[_vm._v(_vm._s(_vm.$t("rule.create.impact")))]),_c("div",{staticClass:"fc-heading-border-width43 mT15"})])]),_c("div",{staticClass:"rule-condition-from-content rule-basic-info-content"},[_c("div",{staticClass:"rule-info-form"},[_vm.enableimpacts?_c("div",{staticClass:"rca-rule-table"},[_c("div",{staticClass:"row"},[_c("div",{staticClass:"fc-text-pink text-uppercase"},[_vm._v(" "+_vm._s(_vm.$t("common._common.cost_impact"))+" ")]),_c("div",{staticClass:"close-icon-fbuilder"},[_c("i",{staticClass:"el-dialog__close el-icon el-icon-close",on:{click:function($event){_vm.enableimpacts=!1}}})])]),_c("div",{staticClass:"flex-middle"},[_c("f-formula-builder",{staticClass:"pB20 rule-alarm-trigger width80",staticStyle:{"padding-top":"20px"},attrs:{title:"",module:"impact",assetCategory:{id:_vm.categoryId}},model:{value:_vm.workflow,callback:function($$v){_vm.workflow=$$v},expression:"workflow"}})],1)]):_c("div",{staticClass:"rule-basic-info-content"},[_c("div",{staticClass:"d-flex flex-direction-column text-center"},[_c("inline-svg",{attrs:{src:"svgs/emptystate/data-empty",iconClass:"icon text-center icon-xxxxlg"}}),_c("div",{staticClass:"mT10 empty-text f15 bold"},[_vm._v(" "+_vm._s(_vm.$t("common.products.no_cost_impact_available_here"))+" ")]),_c("div",{staticClass:"mT5 empty-text-desc f13"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.you_havent_created_cost_impact_yet"))+" ")]),_c("div",{staticClass:"inline-block mT20"},[_c("el-button",{staticClass:"pT10 pB10 small-border-btn text-uppercase pL15 pR15",on:{click:function($event){_vm.enableimpacts=!0}}},[_vm._v(_vm._s(_vm.$t("common.header.enable_cost_impact")))])],1)],1)]),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",attrs:{type:"button"},on:{click:_vm.goToPrevious}},[_vm._v(_vm._s(_vm.$t("common._common.previous")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"button",loading:_vm.isSaving},on:{click:_vm.addImpact}},[_vm._v(" "+_vm._s(_vm.isEdit?_vm.$t("common.header.update_rule"):_vm.$t("common.header.proceed_to_next"))+" "),_vm.isEdit?_vm._e():_c("img",{staticClass:"fR",attrs:{src:__webpack_require__(936658),width:"17px"}})])],1)])])])])},ImpactFormvue_type_template_id_ba3fd808_staticRenderFns=[],ImpactFormvue_type_script_lang_js={components:{FFormulaBuilder:FFormulaBuilder/* default */.Z},props:{sharedData:{type:Object}},created:function(){},data:function(){return{enableimpacts:!1,isSaving:!1,workflow:null,trigger:{name:"Cost Impact",ruleType:8,activityType:3,actions:[{actionType:28,templateJson:{metaJson:{resultWorkflowContext:null,fields:"cost"}}}]}}},computed:{isEdit:function(){return"rule-creation-edit"===this.$route.name},categoryId:function(){return this.sharedData.preRequsite?this.sharedData.preRequsite.assetCategoryId:null}},mounted:function(){this.sharedData.enableimpacts&&(this.enableimpacts=this.sharedData.enableimpacts,this.sharedData.impactsContext&&this.sharedData.impactsContext.id>0&&this.loadWorflowRule(this.sharedData.impactsContext.id))},methods:{loadWorflowRule:function(id){var _this=this;this.$http.get("/v2/setup/asset/rules/".concat(id)).then((function(response){_this.workflow=response.data.result.rule.actions[0].template.originalTemplate.workflowContext}))},addImpact:function(){var _this2=this;if(this.sharedData.preRequsite&&this.sharedData.preRequsite.event.moduleId&&(this.trigger.moduleId=this.sharedData.preRequsite.event.moduleId),this.enableimpacts){this.trigger.actions[0].templateJson.resultWorkflowContext=this.workflow,this.sharedData.enableimpacts=this.enableimpacts,this.sharedData.impactsContext&&this.sharedData.impactsContext.id&&(this.trigger.id=this.sharedData.impactsContext.id),this.sharedData.impactsContext=this.trigger;var data={workflowRule:this.sharedData.impactsContext},url="/v2/modules/rules/";this.sharedData.impactsContext.id>0?url+="update":url+="add",this.$http.post(url,data).then((function(response){0===response.data.responseCode?response.data.result.workflowRule.id&&(_this2.sharedData.impactsContext.id=response.data.result.workflowRule.id,_this2.moveToNext()):1===response.data.responseCode&&_this2.$message({message:response.data.message,type:"error"})}))}else this.moveToNext()},moveToNext:function(){"rule-creation-edit"===this.$route.name?(this.isSaving=!0,this.$emit("generateFinalSharedData",this.sharedData)):this.$emit("nextStep",this.sharedData.impactsContext)},goToPrevious:function(){this.$emit("goToPreviousStep",null)}}},rule_ImpactFormvue_type_script_lang_js=ImpactFormvue_type_script_lang_js,ImpactForm_component=(0,componentNormalizer/* default */.Z)(rule_ImpactFormvue_type_script_lang_js,ImpactFormvue_type_template_id_ba3fd808_render,ImpactFormvue_type_template_id_ba3fd808_staticRenderFns,!1,null,null,null)
/* harmony default export */,ImpactForm=ImpactForm_component.exports,ActionsFormvue_type_template_id_6994642e_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"rule-basic-info-container rule-basic-info-container d-flex flex-direction-column"},[_c("div",{staticClass:"header f12 bold mT30 mL70 d-flex"},[_c("div",[_c("div",{staticClass:"text-uppercase"},[_vm._v(_vm._s(_vm.$t("rule.create.actions")))]),_c("div",{staticClass:"fc-heading-border-width43 mT15"})])]),_c("div",{staticClass:"position-relative"},[_c("div",{staticClass:"rule-info-form"},[_vm.actions.length>0?_c("div",{staticClass:"rca-rule-table"},[_c("div",{staticClass:"flex-middle justify-content-space pT20"},[_c("div",{staticClass:"fc-text-pink text-uppercase letter-spacing1"},[_vm._v(" "+_vm._s(_vm.$t("common.header.alaram_notification_list"))+" ")]),_c("div",{staticClass:"pointer pT10",on:{click:function($event){_vm.toggle=!0}}},[_c("inline-svg",{staticClass:"vertical-middle",attrs:{src:"svgs/add-circled",iconClass:"icon icon-sm icon-add mR5"}}),_c("span",{staticClass:"btn-text f12 bold green-txt-13 text-uppercase"},[_vm._v(_vm._s(_vm.$t("common.header.add_actions")))])],1)]),_c("el-table",{staticClass:"impact-form-table rule-actions-form-table pT10",staticStyle:{width:"100%"},attrs:{data:_vm.actions,fit:!0}},[_c("el-table-column",{attrs:{label:_vm.$t("common._common._rule_name")},scopedSlots:_vm._u([{key:"default",fn:function(action){return[_c("div",{staticClass:"line-height20"},[_vm._v(_vm._s(action.row.name))])]}}],null,!1,3096505486)}),_c("el-table-column",{attrs:{label:_vm.$t("common._common.execute_on")},scopedSlots:_vm._u([{key:"default",fn:function(action){return[_c("div",{staticClass:"line-height20"},[_vm._v(" "+_vm._s(_vm.checkActivityType(action.row.event.activityType))+" ")])]}}],null,!1,712646860)}),_c("el-table-column",{attrs:{label:_vm.$t("common.products._actions"),width:"250"},scopedSlots:_vm._u([{key:"default",fn:function(action){return[action.row.actions?_c("div",{staticStyle:{display:"flex",position:"relative"}},_vm._l(_vm.$helpers.setActionText(action.row.actions),(function(actionText,idx){return _c("div",{key:idx,staticClass:"fc-tag mR10"},[_c("el-tag",[_vm._v(_vm._s(actionText))])],1)})),0):_c("div",[_vm._v("---")])]}}],null,!1,1798445591)}),_c("el-table-column",[[_c("div",{staticClass:"text-right"},[_c("span",[_c("inline-svg",{staticClass:"edit-icon-color visibility-hide-actions",attrs:{src:"svgs/edit",iconClass:"icon icon-sm mR5 icon-edit"}})],1),_c("span",[_c("inline-svg",{staticClass:"pointer edit-icon-color visibility-hide-actions mL10",attrs:{src:"svgs/delete",iconClass:"icon icon-sm icon-remove fill-red"}})],1)])]],2)],1)],1):_c("div",{staticClass:"rule-basic-info-content"},[_c("div",{staticClass:"d-flex flex-direction-column text-center"},[_c("inline-svg",{attrs:{src:"svgs/emptystate/data-empty",iconClass:"icon text-center icon-xxxxlg"}}),_c("div",{staticClass:"mT10 empty-text f15 bold"},[_vm._v(" "+_vm._s(_vm.$t("common.products.no_actions_available_here"))+" ")]),_c("div",{staticClass:"mT5 empty-text-desc f13"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.you_havent_configured_action_yet"))+" ")])],1)]),_c("div",{staticClass:"inline-block mT20 text-center"},[_c("el-popover",{attrs:{placement:"bottom",width:"250","popper-class":"popover-height asset-popover ",trigger:"click","visible-arrow":"true"},model:{value:_vm.toggle,callback:function($$v){_vm.toggle=$$v},expression:"toggle"}},[_c("ul",[_c("li",{on:{click:function($event){return _vm.openActionForm("severityAction","Severity Change")}}},[_vm._v(" "+_vm._s(_vm.$t("common._common.severity_change"))+" ")]),_c("li",{on:{click:function($event){return _vm.openActionForm("notification","Notification")}}},[_vm._v(" "+_vm._s(_vm.$t("common.header.notification"))+" ")])]),_c("el-button",{staticClass:"pT10 pB10 small-border-btn text-uppercase pL15 pR15",attrs:{slot:"reference"},slot:"reference"},[_c("span",{staticClass:"btn-label mL5 f12 bold"},[_vm._v(_vm._s(_vm.$t("common.header.add_actions")))])])],1)],1),_c("div",{staticClass:"header f12 bold mT30 d-flex"},[_c("div",[_c("div",{staticClass:"text-uppercase"},[_vm._v(" "+_vm._s(_vm.$t("common.header.alarm_settings"))+" ")]),_c("div",{staticClass:"fc-heading-border-width43 mT15"})])]),_c("div",{staticClass:"mT30"},[_c("el-checkbox",{model:{value:_vm.sharedData.createWo,callback:function($$v){_vm.$set(_vm.sharedData,"createWo",$$v)},expression:"sharedData.createWo"}},[_vm._v(_vm._s(_vm.$t("rule.create.create_wo_alarm_creation")))]),_vm.sharedData.createWo?_c("el-checkbox",{model:{value:_vm.sharedData.autoCloseWo,callback:function($$v){_vm.$set(_vm.sharedData,"autoCloseWo",$$v)},expression:"sharedData.autoCloseWo"}},[_vm._v(_vm._s(_vm.$t("common.header.auto_close_wo_alarm")))]):_vm._e()],1),_vm.showControlPoints?_c("div",[_vm.pointsList.length>0?_c("div",{staticClass:"rca-rule-table"},[_c("el-row",{staticClass:"pT40"},[_c("el-col",{attrs:{span:20}},[_c("div",{staticClass:"label-txt-black"},[_vm._v(" "+_vm._s(_vm.$t("common.header.control_points"))+" ")])]),_c("el-col",{attrs:{span:4}},[_c("div",{staticClass:"text-right pointer",on:{click:function($event){_vm.showCnfPntsDialog=!0}}},[_c("inline-svg",{staticClass:"vertical-middle",attrs:{src:"svgs/add-circled",iconClass:"icon icon-sm icon-add mR5"}}),_c("span",{staticClass:"btn-text f12 bold green-txt-13 text-uppercase"},[_vm._v(_vm._s(_vm.$t("home.dashboard.add_points")))])],1)])],1),_c("el-table",{staticClass:"impact-form-table rule-actions-form-table pT30",staticStyle:{width:"100%"},attrs:{data:_vm.pointsList,fit:!0}},[_c("el-table-column",{attrs:{label:"ASSET NAME",width:"700"},scopedSlots:_vm._u([{key:"default",fn:function(point){return[_c("div",{staticClass:"line-height20"},[_vm._v(_vm._s(point.row.asset.name))])]}}],null,!1,2049153040)}),_c("el-table-column",[[_c("div",{staticClass:"text-center"},[_c("span",[_c("inline-svg",{staticClass:"edit-icon-color visibility-hide-actions",attrs:{src:"svgs/edit",iconClass:"icon icon-sm mR5 icon-edit"}})],1),_c("span",[_c("inline-svg",{staticClass:"pointer edit-icon-color visibility-hide-actions mL10",attrs:{src:"svgs/delete",iconClass:"icon icon-sm icon-remove fill-red"}})],1)])]],2)],1)],1):_c("div",{staticClass:"rule-basic-info-content"},[_c("div",{staticClass:"d-flex flex-direction-column text-center"},[_c("inline-svg",{attrs:{src:"svgs/emptystate/data-empty",iconClass:"icon text-center icon-xxxxlg"}}),_c("div",{staticClass:"mT10 empty-text f15 bold"},[_vm._v(" "+_vm._s(_vm.$t("common.products.no_control_point_configured_yet"))+" ")]),_c("div",{staticClass:"mT5 empty-text-desc f13"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.you_havent_configured_point_yet"))+" ")]),_c("div",{staticClass:"inline-block mT20"},[_c("el-button",{staticClass:"pT10 pB10 small-border-btn text-uppercase pL20 pR20",on:{click:function($event){_vm.showCnfPntsDialog=!0}}},[_vm._v(_vm._s(_vm.$t("common.header.add_point")))])],1)],1)])]):_vm._e()])]),_vm.showActionForm?_c("action-form-dialog",{attrs:{isNew:"true",title:_vm.dialogTitle,module:"newreadingalarm",actionType:_vm.actionType,visibilityshow:_vm.showActionForm},on:{"update:visibilityshow":function($event){_vm.showActionForm=$event},actionSaved:_vm.actionOnSave}}):_vm._e(),_c("CnfPntDialog",{attrs:{visibility:_vm.showCnfPntsDialog},on:{"update:visibility":function($event){_vm.showCnfPntsDialog=$event},points:_vm.addPoints}}),_c("div",{staticClass:"modal-dialog-footer",staticStyle:{position:"relative"}},[_c("el-button",{staticClass:"modal-btn-cancel",attrs:{type:"button"},on:{click:_vm.goToPrevious}},[_vm._v(_vm._s(_vm.$t("common._common.previous")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"button",loading:_vm.isSaving},on:{click:_vm.saveRule}},[_vm._v(" "+_vm._s(_vm.$t("common._common.save_rule"))+" ")])],1)],1)},ActionsFormvue_type_template_id_6994642e_staticRenderFns=[],ActionFormDialog=__webpack_require__(379e3),CnfPntDialogvue_type_template_id_88c4b1fc_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{attrs:{title:"Add Control Points","append-to-body":!0,"custom-class":"control-command-card-dialog fc-dialog-center-container",visible:_vm.visibility,width:"30%","before-close":_vm.cancel},on:{"update:visible":function($event){_vm.visibility=$event}}},[_c("div",{staticClass:"height350"},[_c("div",[_c("div",{staticClass:"reading-card-header fc-input-label-txt"},[_vm._v(" Select Asset Category ")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{filterable:"",placeholder:"Select"},on:{change:function($event){return _vm.loadThresholdFields(!0,_vm.assetCategoryId)}},model:{value:_vm.points.assetCategoryId,callback:function($$v){_vm.$set(_vm.points,"assetCategoryId",$$v)},expression:"points.assetCategoryId"}},_vm._l(_vm.assetCategory,(function(category,index){return _c("el-option",{key:index,attrs:{label:category.displayName,value:parseInt(category.id)}})})),1)],1),_c("div",[_c("div",{staticClass:"reading-card-header fc-input-label-txt pT20"},[_vm._v(" Select Asset ")]),_c("el-input",{staticClass:"fc-border-select fc-input-full-border-select2 width100",attrs:{disabled:""},model:{value:_vm.resourceLabel,callback:function($$v){_vm.resourceLabel=$$v},expression:"resourceLabel"}},[_c("i",{staticClass:"el-input__icon el-icon-search",staticStyle:{"line-height":"0px !important","font-size":"16px !important",cursor:"pointer"},attrs:{slot:"suffix"},on:{click:function($event){_vm.chooserVisibility=!0}},slot:"suffix"})])],1),_c("div",[_c("div",{staticClass:"reading-card-header fc-input-label-txt pT20"},[_vm._v(" Select Reading ")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{filterable:"",placeholder:"Select"},model:{value:_vm.points.readingId,callback:function($$v){_vm.$set(_vm.points,"readingId",$$v)},expression:"points.readingId"}},_vm._l(_vm.thresholdFields,(function(field){return _c("el-option",{key:field.name+field.id,attrs:{label:field.displayName,value:field.name}})})),1),_c("space-asset-chooser",{attrs:{visibility:_vm.chooserVisibility,initialValues:{},query:_vm.resourceQuery,showAsset:!1,picktype:"asset"},on:{associate:_vm.associateResource,"update:visibility":function($event){_vm.chooserVisibility=$event}}})],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.cancel}},[_vm._v("Cancel")]),_c("el-button",{staticClass:"modal-btn-save",on:{click:function($event){return _vm.addPoints()}}},[_vm._v("Save")])],1)])])},CnfPntDialogvue_type_template_id_88c4b1fc_staticRenderFns=[],CnfPntDialogvue_type_script_lang_js={components:{SpaceAssetChooser:SpaceAssetChooser/* default */.Z},mixins:[RuleMixin/* default */.Z],computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({assetCategory:function(state){return state.assetCategory}})),{},{resourceLabel:function(){return this.asset&&this.asset.id>0?this.asset.name:null}}),props:["modelData","visibility"],data:function(){return{points:{assetCategoryId:null,asset:null,readingId:null},resourceQuery:null,assetCategoryId:null,asset:null,readingId:null,controlCommand:{},chooserVisibility:!1,thresholdFields:[],assetReadings:null,controlableAssets:null}},watch:{},methods:{associateResource:function(selectedObj){selectedObj&&(this.points.asset=selectedObj,this.asset=selectedObj),this.chooserVisibility=!1,this.resourceQuery=null},cancel:function(){this.$emit("update:visibility",!1),this.$emit("close",!1)},addPoints:function(){this.$emit("points",this.points),this.$emit("update:visibility",!1)}},mounted:function(){
// this.getControlableAssets()
}},component_CnfPntDialogvue_type_script_lang_js=CnfPntDialogvue_type_script_lang_js,CnfPntDialog_component=(0,componentNormalizer/* default */.Z)(component_CnfPntDialogvue_type_script_lang_js,CnfPntDialogvue_type_template_id_88c4b1fc_render,CnfPntDialogvue_type_template_id_88c4b1fc_staticRenderFns,!1,null,null,null)
/* harmony default export */,CnfPntDialog=CnfPntDialog_component.exports,ActionsFormvue_type_script_lang_js={components:{CnfPntDialog:CnfPntDialog,ActionFormDialog:ActionFormDialog/* default */.Z},props:{sharedData:{type:Object}},created:function(){},data:function(){return{controlPoints:[],showCnfPntsDialog:!1,showControlPoints:!1,activityTypes:[{label:this.$t("common.products.create"),value:1},{label:this.$t("common._common.severity_change"),value:1024},{label:this.$t("common.header.create_and_severity_change"),value:1025},{label:this.$t("common.header.clear"),value:2048},{label:this.$t("common.header.on_date"),value:524288},{label:this.$t("common.wo_report.field_change"),value:1048576},{label:this.$t("common._common.delete"),value:4}],actionType:null,dialogTitle:null,showActionForm:!1,createWo:!1,module:"readingRule",isSaving:!1,isLoading:!1,pointsList:[],actions:[],autoCloseWo:!1}},methods:{checkActivityType:function(value){var activityTypes=this.activityTypes;return activityTypes.find((function(type){return type.value===value})).label},saveRule:function(){this.actions.length>0&&(this.sharedData.actions=this.actions),this.isSaving=!0,this.$emit("generateFinalSharedData",this.sharedData)},goToPrevious:function(){this.$emit("goToPreviousStep",null)},actionOnSave:function(action){this.actions.push(action)},openActionForm:function(type,title){this.showActionForm=!0,this.dialogTitle=title,this.actionType=type},addPoints:function(points){this.pointsList.push(points)}}},rule_ActionsFormvue_type_script_lang_js=ActionsFormvue_type_script_lang_js,ActionsForm_component=(0,componentNormalizer/* default */.Z)(rule_ActionsFormvue_type_script_lang_js,ActionsFormvue_type_template_id_6994642e_render,ActionsFormvue_type_template_id_6994642e_staticRenderFns,!1,null,null,null)
/* harmony default export */,ActionsForm=ActionsForm_component.exports,FormMixin=__webpack_require__(674811),router=__webpack_require__(329435),RuleConfigurationvue_type_script_lang_js={mixins:[RuleMixin/* default */.Z,FormMixin/* default */.Z],components:{FStepper:FStepper/* default */.Z},data:function(){return{isMultiResource:!1,thresholdFields:null,selectedResourceList:null}},computed:{steps:function(){var step=[{title:"".concat(this.$t("rule.create.new_alarm_rule")),component:BasicInfoForm},{title:"".concat(this.$t("rule.create.alarm_condition")),component:RuleConditionForm},{title:"".concat(this.$t("rule.create.root_cause")),component:RootCauseNImpactForm},{title:"".concat(this.$t("rule.create.impact")),component:ImpactForm}];return"rule-creation-edit"!==this.$route.name&&step.push({title:"".concat(this.$t("rule.create.actions")),component:ActionsForm}),step},moduleName:function(){return"readingrule"}},methods:{getthresholdFields:function(assetCategoryId){return this.$store.getters["formulabuilder/getAssetReadings"](assetCategoryId,!0)},parseThersholdType:function(readingRule,metricFieldObject){(0,validation/* isEmpty */.xb)(metricFieldObject)&&(this.setMetricModule(readingRule.readingFieldId,readingRule),metricFieldObject=readingRule.selectedMetric),(0,validation/* isEmpty */.xb)(metricFieldObject)||(1===readingRule.thresholdType?this.simpleConditionParse(readingRule,metricFieldObject):2===readingRule.thresholdType?this.aggregationParse(readingRule,metricFieldObject):3===readingRule.thresholdType?this.baseLineParse(readingRule,metricFieldObject):4===readingRule.thresholdType?readingRule.flapInterval=6e4*readingRule.flapInterval:5!==readingRule.thresholdType&&6!==readingRule.thresholdType||readingRule.workflow&&readingRule.workflow.occurences&&Object.assign(readingRule,readingRule.workflow.occurences))},constructActionObj:function(action,ruleObject){var template={};return(0,validation/* isEmpty */.xb)(action)||(action.hasOwnProperty("message")&&(template["message"]=action.message),action.hasOwnProperty("problem")&&(template["problem"]=action.problem),action.hasOwnProperty("possibleCauses")&&(template["possibleCauses"]=action.possibleCauses.join(" \n ")),action.hasOwnProperty("recommendation")&&(template["recommendation"]=action.recommendation.join(" \n ")),action.hasOwnProperty("severity")&&(template["severity"]=action.severity),ruleObject.enableimpacts&&(template["impact"]={},template.impact.cost=[ruleObject.impactsContext.id])),template},saveRecord:function(rule){var _this=this;this.isFormSaved=!0;var ruleObject=this.$helpers.cloneObject(rule);if(ruleObject.preRequsite.matchedResources=null,ruleObject.alarmTriggerRule.matchedResources=null,ruleObject.alarmTriggerRule.faultType=ruleObject.faultType,ruleObject.preRequsite.assetCategoryId>0?(this.selectedResourceList=ruleObject.selectedResourceList,this.isMultiResource=!0):(ruleObject.preRequsite.assetCategoryId=-1,ruleObject.preRequsite.resourceId=ruleObject.selectedResourceList.id),(0,validation/* isEmpty */.xb)(this.thresholdFields)&&(this.thresholdFields=this.getthresholdFields(ruleObject.preRequsite.assetCategoryId)),1===ruleObject.preRequsite.thresholdType&&((0,validation/* isEmpty */.xb)(ruleObject.preRequsite.operatorId)||ruleObject.preRequsite.operatorId<1)||this.parseThersholdType(ruleObject.preRequsite,ruleObject.preRequsite.selectedMetric),ruleObject.isPrerequest||(ruleObject.preRequsite.workflow=null,ruleObject.preRequsite.workflowId=-99,ruleObject.preRequsite.operatorId=-99,ruleObject.preRequsite.percentage=""),ruleObject.selectedResourceList){var fieldName=ruleObject.isIncludeResource?"includedResources":"excludedResources",emptyFields="includedResources"===fieldName?"excludedResources":"includedResources";ruleObject.preRequsite[fieldName]=Array.isArray(ruleObject.selectedResourceList)?ruleObject.selectedResourceList.map((function(resource){return resource.id})):null,ruleObject.preRequsite[emptyFields]=null}if(ruleObject.autoClear?(ruleObject.autoClear=!0,ruleObject.isAutoClear=!0,ruleObject.alarmClearRule=null):(ruleObject.autoClear=!1,ruleObject.isAutoClear=!1,this.parseThersholdType(ruleObject.alarmClearRule,ruleObject.preRequsite.selectedMetric)),ruleObject.alarmTriggerRule&&(ruleObject.alarmTriggerRule.isChanged||ruleObject.alarmTriggerRule.actions[0].isChanged)){ruleObject.alarmTriggerRule.readingFieldId=ruleObject.preRequsite.readingFieldId,this.parseThersholdType(ruleObject.alarmTriggerRule,ruleObject.preRequsite.selectedMetric);var actions=this.parseAction(this.constructActionObj(ruleObject.action,ruleObject));ruleObject.alarmTriggerRule.actions=[],ruleObject.alarmTriggerRule.actions.push(actions)}else ruleObject.alarmTriggerRule=null;if(ruleObject.rcaSelectObj.length>0&&(ruleObject.alarmRCARules=ruleObject.rcaSelectObj.map((function(_ref){var value=_ref.value;return value}))),ruleObject.reportBreakdown){var reportDowntime={actions:[{actionType:22,templateJson:{}}],name:"Report Downtime",event:{moduleName:"newreadingalarm",activityType:1}};ruleObject.readingAlarmRuleContexts?ruleObject.readingAlarmRuleContexts.forEach((function(d){d.actions=reportDowntime.actions})):ruleObject.readingAlarmRuleContexts=[reportDowntime]}else ruleObject.readingAlarmRuleContexts=null;ruleObject.createWo&&(ruleObject.workflowRulesForAlarms||(ruleObject.workflowRulesForAlarms=[]),ruleObject.workflowRulesForAlarms.push({name:"Create Wo",event:{moduleName:"newreadingalarm",activityType:1},actions:[{actionType:11,templateJson:{}}]}),ruleObject.autoCloseWo&&ruleObject.workflowRulesForAlarms.push({name:"Close Wo",event:{moduleName:"newreadingalarm",activityType:1},actions:[{actionType:12,templateJson:{}}]})),delete ruleObject.actions,this.$util.newAddRule("alarm",{alarmRule:ruleObject},["rule-creation-edit","rule-edit"].includes(this.$route.name)).then((function(){if((0,router/* isWebTabsEnabled */.tj)()){_this.moduleName;var _ref2=(0,router/* findRouteForTab */.OD)(router/* pageTypes */.As.RULES_LIST)||{},name=_ref2.name;name&&_this.$router.push({name:name,params:{viewname:"all"},query:_this.$route.query})}else _this.$router.push({path:"/app/fa/rules/all"})})).catch((function(){}))}}},rule_RuleConfigurationvue_type_script_lang_js=RuleConfigurationvue_type_script_lang_js,RuleConfiguration_component=(0,componentNormalizer/* default */.Z)(rule_RuleConfigurationvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,RuleConfiguration=RuleConfiguration_component.exports},
/***/379e3:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return ActionFormDialog}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/alarm/rule/component/ActionFormDialog.vue?vue&type=template&id=6d99cc8e
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("el-dialog",{staticStyle:{"z-index":"1999"},attrs:{visible:_vm.visibilityshow,fullscreen:!0,"append-to-body":!0,"before-close":_vm.closeDialog,"custom-class":"fc-dialog-form fc-dialog-right custom-rule-dialog setup-dialog50 setup-dialog"},on:{"update:visible":function($event){_vm.visibilityshow=$event}}},[_c("div",{attrs:{id:"new-custom-rule"}},[_c("error-banner",{attrs:{error:_vm.error,errorMessage:_vm.errorMessage}}),_c("el-form",{ref:"newCustomRule",attrs:{model:_vm.data,"label-position":"top"}},[_c("div",{staticClass:"new-header-container"},[_c("div",{staticClass:"new-header-modal"},[_c("div",{staticClass:"new-header-text"},[_c("div",{staticClass:"setup-modal-title"},[_vm._v(" "+_vm._s((_vm.isNew?"New ":"Edit ")+_vm.title)+" ")])])])]),_c("div",{staticClass:"new-body-modal"},[_c("el-row",{attrs:{gutter:20}},[_c("el-col",{attrs:{span:12}},[_c("el-form-item",{attrs:{prop:"name"}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v("Name")]),_c("el-input",{staticClass:"fc-input-full-border-select2",attrs:{autofocus:!0,placeholder:_vm.$t("setup.setupLabel.action_name")},model:{value:_vm.data.rule.name,callback:function($$v){_vm.$set(_vm.data.rule,"name",$$v)},expression:"data.rule.name"}})],1)],1),_c("el-col",{attrs:{span:12}},[_c("el-form-item",{attrs:{prop:"siteId"}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v("Site")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{placeholder:"Select Site"},model:{value:_vm.data.rule.siteId,callback:function($$v){_vm.$set(_vm.data.rule,"siteId",$$v)},expression:"data.rule.siteId"}},_vm._l(_vm.sites,(function(site){return _c("el-option",{key:site.id,attrs:{label:site.name,value:site.id}})})),1)],1)],1)],1),_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"description"}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.$t("space.sites.site_description"))+" ")]),_c("el-input",{staticClass:"fc-input-full-border-select2",attrs:{"min-rows":1,type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:_vm.$t("common._common.enter_desc"),reseize:"none"},model:{value:_vm.data.rule.description,callback:function($$v){_vm.$set(_vm.data.rule,"description",$$v)},expression:"data.rule.description"}})],1)],1)],1),_c("el-row",{attrs:{gutter:20}},[_c("el-col",{staticClass:"utility-block",attrs:{span:12}},[_c("p",{staticClass:"subHeading-pink-txt"},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.execute_on"))+" ")]),_c("p",{staticClass:"small-description-txt mB10"},[_vm._v(" "+_vm._s(_vm.$t("setup.setupLabel.notify_rule_executed"))+" ")]),_c("el-form-item",{attrs:{prop:"activityType"}},[_c("el-select",{staticClass:"width100 fc-input-full-border-select2",attrs:{placeholder:"Select",disabled:_vm.isActivityDisabled},model:{value:_vm.data.rule.event.activityType,callback:function($$v){_vm.$set(_vm.data.rule.event,"activityType",$$v)},expression:"data.rule.event.activityType"}},_vm._l(_vm.activityTypes,(function(type,index){return _c("el-option",{key:index,attrs:{label:type.label,value:type.value}})})),1)],1)],1)],1),524288===_vm.data.rule.event.activityType||1048576===_vm.data.rule.event.activityType?_c("div",{staticClass:"fc-div-bg-border mB20"},[524288===_vm.data.rule.event.activityType?_c("div",[_c("el-row",[_c("el-col",{attrs:{span:12}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v("Date Field")]),_c("el-select",{staticClass:"width300px",attrs:{placeholder:"Select"},model:{value:_vm.data.rule.dateFieldId,callback:function($$v){_vm.$set(_vm.data.rule,"dateFieldId",$$v)},expression:"data.rule.dateFieldId"}},_vm._l(_vm.dateFields,(function(fld,index){return _c("el-option",{key:index,attrs:{label:fld.displayName,value:fld.id}})})),1)],1),_c("el-col",{staticClass:"pL40",attrs:{span:12}},[_c("p",{staticClass:"fc-input-label-txt mB10"},[_vm._v(" "+_vm._s(_vm.$t("setup.setupLabel.scheduled_type"))+" ")]),_c("el-radio-group",{staticClass:"criteria-radio-label",model:{value:_vm.data.rule.scheduleType,callback:function($$v){_vm.$set(_vm.data.rule,"scheduleType",$$v)},expression:"data.rule.scheduleType"}},["26"===_vm.ruleType?_c("el-radio",{key:1,staticClass:"fc-radio-btn",attrs:{label:1}},[_vm._v("Before")]):_vm._e(),_c("el-radio",{key:2,staticClass:"fc-radio-btn",attrs:{label:2}},[_vm._v("On")]),_c("el-radio",{key:3,staticClass:"fc-radio-btn",attrs:{label:3}},[_vm._v("After")])],1)],1)],1),[1,3].includes(parseInt(_vm.data.rule.scheduleType))?_c("el-row",{staticClass:"mT30"},[_c("el-col",{attrs:{span:8}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v("Days")]),_c("el-select",{staticClass:"fc-input-full-border-select2",attrs:{clearable:"",placeholder:"Select"},model:{value:_vm.dateObject.days,callback:function($$v){_vm.$set(_vm.dateObject,"days",$$v)},expression:"dateObject.days"}},_vm._l(10,(function(index){return _c("el-option",{key:index+1,attrs:{label:index,value:index}})})),1)],1),_vm.checkDateTimeField?_c("el-col",{attrs:{span:8}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v("Hours")]),_c("el-select",{staticClass:"fc-input-full-border-select2",attrs:{clearable:""},model:{value:_vm.dateObject.hours,callback:function($$v){_vm.$set(_vm.dateObject,"hours",$$v)},expression:"dateObject.hours"}},_vm._l(_vm.$constants.HOURS,(function(index){return _c("el-option",{key:index+1,attrs:{label:index,value:index}})})),1)],1):_vm._e(),_vm.checkDateTimeField?_c("el-col",{attrs:{span:8}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v("Mins")]),_c("el-select",{staticClass:"fc-input-full-border-select2",attrs:{placeholder:"Select"},model:{value:_vm.dateObject.minute,callback:function($$v){_vm.$set(_vm.dateObject,"minute",$$v)},expression:"dateObject.minute"}},_vm._l(_vm.$constants.MINUTES,(function(index){return _c("el-option",{key:index+1,attrs:{label:index,value:index}})})),1)],1):_c("el-col",{attrs:{span:8}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v("Time")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width100 fc-tag",attrs:{"collapse-tags":""},model:{value:_vm.data.rule.time,callback:function($$v){_vm.$set(_vm.data.rule,"time",$$v)},expression:"data.rule.time"}},_vm._l(_vm.timesOption,(function(time){return _c("el-option",{key:time,attrs:{label:time,value:time}})})),1)],1)],1):_vm._e()],1):1048576===_vm.data.rule.event.activityType?_c("div",[_c("el-row",[1048576===_vm.data.rule.event.activityType?_c("div",{staticClass:"approve-form-item"},[_c("el-form-item",{staticClass:"fc-tag p0 pL10 pR10",attrs:{prop:"activityType"}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v(" Field "+_vm._s(_vm.selectedFieldObject.length>0?"("+_vm.selectedFieldObject.length+")":"")+" ")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width50",attrs:{"multiple-limit":3,multiple:"",placeholder:"Select"},model:{value:_vm.selectedFieldObject,callback:function($$v){_vm.selectedFieldObject=$$v},expression:"selectedFieldObject"}},_vm._l(_vm.moduleFields,(function(fld,index){return _c("el-option",{key:index,attrs:{label:fld.displayName,value:fld.id}})})),1),_vm.selectedFieldObject.length<3?_c("el-button",{staticClass:"all-rule-btn",attrs:{slot:"reference"},slot:"reference"},[_c("img",{staticClass:"mL10",attrs:{src:__webpack_require__(353654)}})]):_vm._e()],1)],1):_vm._e()])],1):_vm._e()]):_vm._e(),_c("new-criteria-builder",{ref:"criteriaBuilder",attrs:{showSiteField:_vm.showSiteField,showFormIDField:_vm.showFormIDField,exrule:_vm.data.rule.criteria,module:_vm.module,isRendering:_vm.criteriaRendered,title:"Specify rules for "+_vm.module+" action"},on:{condition:_vm.somefnt,"update:isRendering":function($event){_vm.criteriaRendered=$event},"update:is-rendering":function($event){_vm.criteriaRendered=$event}},model:{value:_vm.data.rule.criteria,callback:function($$v){_vm.$set(_vm.data.rule,"criteria",$$v)},expression:"data.rule.criteria"}}),_c("div",{staticClass:"form-input"}),"notification"===_vm.actionType?_c("event-dialog-helper",{ref:"eventDialog",attrs:{ruleType:_vm.ruleType,rule:_vm.data,module:_vm.module,moduleFields:_vm.moduleFields,actions:_vm.actions},on:{actions:function($event){return _vm.addAction()}}}):_vm._e(),"severityAction"===_vm.actionType?_c("div",[_c("el-row",[_c("el-col",{staticClass:"utility-block",attrs:{span:20}},[_c("div",{staticClass:"fc-text-pink text-uppercase mT20"},[_vm._v(" Severity Change ")])])],1),_c("el-row",{attrs:{gutter:20}},[_c("el-col",{attrs:{span:12}},[_c("el-input",{staticClass:"fc-input-full-border2 width100",attrs:{disabled:""},model:{value:_vm.severity,callback:function($$v){_vm.severity=$$v},expression:"severity"}})],1),_c("el-col",{attrs:{span:12}},[_c("el-form-item",[_vm.fieldMatchers&&_vm.fieldMatchers[0]&&_vm.fieldMatchers[0].templateJson?_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{"collapse-tags":""},model:{value:_vm.fieldMatchers[0].templateJson.resultWorkflowContext.expressions[0].constant,callback:function($$v){_vm.$set(_vm.fieldMatchers[0].templateJson.resultWorkflowContext.expressions[0],"constant",$$v)},expression:"\n                      fieldMatchers[0].templateJson.resultWorkflowContext\n                        .expressions[0].constant\n                    "}},_vm._l(_vm.alarmseverity,(function(label){return _c("el-option",{key:label.id,attrs:{label:label.displayName,value:String(label.id)}})})),1):_vm._e()],1)],1)],1)],1):_vm._e(),"controlLogic"===_vm.actionType?_c("div",[_c("control-logic",{attrs:{name:"dfd"}})],1):_vm._e()],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){return _vm.closeDialog()}}},[_vm._v("CANCEL")]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.saving},on:{click:_vm.save}},[_vm._v(" "+_vm._s(_vm.saving?"Saving...":"SAVE"))])],1)])],1)])],1)},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),objectSpread2=__webpack_require__(595082),vuex_esm=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(976801),__webpack_require__(538077),__webpack_require__(670560),__webpack_require__(434284),__webpack_require__(659749),__webpack_require__(386544),__webpack_require__(947522),__webpack_require__(339772),__webpack_require__(162506),__webpack_require__(169358),__webpack_require__(420629)),ControlLogicvue_type_template_id_181ab1d6_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("div",{staticClass:"fc-text-pink text-uppercase mT20"},[_vm._v("Command Action")]),_c("el-collapse",{staticClass:"new-rule-collapse position-relative controllogic-collapse",attrs:{accordion:!0},model:{value:_vm.activeNames,callback:function($$v){_vm.activeNames=$$v},expression:"activeNames"}},_vm._l(_vm.controlaction,(function(action,cindex){return _c("el-collapse-item",{key:cindex,staticClass:"rule-border-blue mT20 position-relative",staticStyle:{"border-left":"1px solid rgb(228, 235, 241)"},attrs:{name:action.name}},[_c("template",{slot:"title"},[_vm._v(" "+_vm._s(action.name)+" ")]),_c("div",{},[_c("el-radio-group",{model:{value:action.templateJson.actionType,callback:function($$v){_vm.$set(action.templateJson,"actionType",$$v)},expression:"action.templateJson.actionType"}},[_c("el-radio",{staticClass:"fc-radio-btn",attrs:{label:1}},[_vm._v("Point")]),_c("el-radio",{staticClass:"fc-radio-btn",attrs:{label:2}},[_vm._v("Group")])],1)],1),_c("div",{directives:[{name:"show",rawName:"v-show",value:1===action.templateJson.actionType,expression:"action.templateJson.actionType === 1"}],staticClass:"pT20"},[_c("el-row",[_c("el-col",{attrs:{span:4}},[_c("div",{staticClass:"label-txt-black"},[_vm._v("Asset")])]),_c("el-col",{attrs:{span:15}},[_c("el-form-item",[_c("el-select",{staticClass:"fc-input-full-border2 width100",attrs:{placeholder:"Select asset"},on:{change:_vm.fetchFields},model:{value:action.templateJson.resource,callback:function($$v){_vm.$set(action.templateJson,"resource",$$v)},expression:"action.templateJson.resource"}},_vm._l(_vm.assets,(function(asset,index){return _c("el-option",{key:index,attrs:{label:asset.name,value:asset.id}})})),1)],1)],1)],1),_c("el-row",{},[_c("el-col",{attrs:{span:4}},[_c("div",{staticClass:"label-txt-black"},[_vm._v("Field")])]),_c("el-col",{attrs:{span:15}},[_c("el-form-item",[_c("el-select",{staticClass:"fc-input-full-border2 width100",attrs:{placeholder:"Select fields"},model:{value:action.templateJson.metric,callback:function($$v){_vm.$set(action.templateJson,"metric",$$v)},expression:"action.templateJson.metric"}},_vm._l(_vm.assetFields[action.templateJson.resource],(function(field,index){return _c("el-option",{key:index,attrs:{label:field.displayName,value:field.id}})})),1)],1)],1)],1),_c("el-row",{},[_c("el-col",{attrs:{span:4}},[_c("div",{staticClass:"label-txt-black"},[_vm._v("Value")])]),_c("el-col",{attrs:{span:15}},[_c("el-form-item",[_c("el-input",{staticClass:"fc-input-full-border2",attrs:{autofocus:"",placeholder:"Enter the value",type:"number"},model:{value:action.templateJson.val,callback:function($$v){_vm.$set(action.templateJson,"val",$$v)},expression:"action.templateJson.val"}})],1)],1)],1),_c("img",{staticClass:"delete-icon pointer",staticStyle:{height:"18px",width:"18px","margin-right":"3px"},attrs:{src:__webpack_require__(385769)},on:{click:function($event){return _vm.deleteaction(cindex)}}})],1),_c("div",{directives:[{name:"show",rawName:"v-show",value:2===action.templateJson.actionType,expression:"action.templateJson.actionType === 2"}],staticClass:"pT20"},[_c("el-row",{},[_c("el-col",{attrs:{span:4}},[_c("div",{staticClass:"label-txt-black"},[_vm._v("Actions Group")])]),_c("el-col",{attrs:{span:15}},[_c("el-form-item",[_c("el-select",{staticClass:"width100 fc-input-full-border2",attrs:{filterable:""},model:{value:action.templateJson.controlActionGroupId,callback:function($$v){_vm.$set(action.templateJson,"controlActionGroupId",$$v)},expression:"action.templateJson.controlActionGroupId"}},_vm._l(_vm.rcagrouplist,(function(grouprule,index){return _c("el-option",{key:index,attrs:{label:grouprule.name,value:grouprule.id}})})),1)],1)],1)],1),_c("el-row",{},[_c("el-col",{attrs:{span:4}},[_c("div",{staticClass:"label-txt-black"},[_vm._v("Value")])]),_c("el-col",{attrs:{span:15}},[_c("el-form-item",[_c("el-input",{staticClass:"fc-input-full-border2",attrs:{autofocus:"",placeholder:"Enter the value",type:"number"},model:{value:action.templateJson.val,callback:function($$v){_vm.$set(action.templateJson,"val",$$v)},expression:"action.templateJson.val"}})],1)],1)],1),_c("img",{staticClass:"delete-icon pointer",staticStyle:{height:"18px",width:"18px","margin-right":"3px"},attrs:{src:__webpack_require__(385769)},on:{click:function($event){return _vm.deleteaction(cindex)}}})],1)],2)})),1)],1)},ControlLogicvue_type_template_id_181ab1d6_scoped_true_staticRenderFns=[],ControlLogicvue_type_script_lang_js={data:function(){return{activeNames:["actionName0"],controlaction:[],assetFields:{},logicaction:{},assets:[],rcarules:[],rcagrouplist:[]}},mounted:function(){this.addaction()},methods:{addaction:function(){this.controlaction.push({actionType:18,templateJson:{val:"",resource:null,metric:null,actionType:1,controlActionGroupId:null},name:"Command Action"+(this.controlaction.length+1)})},fetchFields:function(resourceId){if(!this.assetFields[resourceId]){var self=this;self.loading=!0;var url="/v2/controlAction/getControllableFields?resourceId="+resourceId;this.$http.get(url).then((function(response){200===response.status&&(response.data.result.controllableFields&&self.$set(self.assetFields,resourceId,response.data.result.controllableFields),self.loading=!1)}))}},deleteaction:function(key){this.controlaction.splice(key,1)}}},component_ControlLogicvue_type_script_lang_js=ControlLogicvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(component_ControlLogicvue_type_script_lang_js,ControlLogicvue_type_template_id_181ab1d6_scoped_true_render,ControlLogicvue_type_template_id_181ab1d6_scoped_true_staticRenderFns,!1,null,"181ab1d6",null)
/* harmony default export */,ControlLogic=component.exports,EventDialogHelper=__webpack_require__(494177),ErrorBanner=__webpack_require__(297157),NotificationHelper=__webpack_require__(683038),NewCriteriaBuilder=__webpack_require__(859850),utils_field=__webpack_require__(815872),validation=__webpack_require__(990260),api=__webpack_require__(32284),ActionFormDialogvue_type_script_lang_js={props:["isNew","isSummary","visibilityshow","mailWidth","ruleType","parentRuleId","title","ruleActions","actionType","details"],mixins:[NotificationHelper/* default */.Z],data:function(){return{severity:"Severity",fieldMatchers:[],activityTypes:[{label:"Create",value:1},{label:"Severity Change",value:1024},{label:"Create and Severity Change",value:1025},{label:"Clear",value:2048},{label:"On Date",value:524288},{label:"Field Change",value:1048576},{label:"Delete",value:4}],timesOption:[],actions:["email","sms","mobile"],error:!1,isUpdate:!1,errorMessage:"",selectedFieldObject:[],dateFields:[],criteriaRendered:!1,moduleMeta:null,saving:!1,data:{rule:{name:"",scheduleType:3,description:"",ruleType:null,event:{moduleName:"newreadingalarm",activityType:1},dateFieldId:null,time:null,fields:[],criteria:null},siteId:"",actions:[]},dateObject:{days:null,minute:0,hours:0,minu:null},closeWo:{actionType:12},ruleDialog:!0}},components:{ErrorBanner:ErrorBanner/* default */.Z,EventDialogHelper:EventDialogHelper/* default */.Z,ControlLogic:ControlLogic,NewCriteriaBuilder:NewCriteriaBuilder/* default */.Z},created:function(){this.$store.dispatch("loadAlarmSeverity"),this.$store.dispatch("loadSite")},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({alarmseverity:function(state){return state.alarmSeverity},sites:function(state){return state.site}})),{},{moduleFields:function(){if(!this.criteriaRendered)return this.$refs.criteriaBuilder&&this.$refs.criteriaBuilder.moduleMetaObject&&this.$refs.criteriaBuilder.moduleMetaObject.fields?this.$refs.criteriaBuilder.moduleMetaObject.fields:null},showSiteField:function(){var workFlowActionHash=this.$constants.WorkFlowAction.module[this.module];return workFlowActionHash&&workFlowActionHash.showSiteField},showFormIDField:function(){var workFlowActionHash=this.$constants.WorkFlowAction.module[this.module];return workFlowActionHash&&workFlowActionHash.showFormIDField},checkDateTimeField:function(){var dateFields=this.dateFields,data=this.data,_ref=data||{},rule=_ref.rule,_ref2=rule||{},dateFieldId=_ref2.dateFieldId,field=(dateFields||[]).find((function(fld){return fld.fieldId===dateFieldId}))||{};return!(0,validation/* isEmpty */.xb)(field)&&(0,utils_field/* isDateTimeField */.K)(field)},isActivityDisabled:function(){var _ref3=this||{},data=_ref3.data,_ref4=data||{},actions=_ref4.actions,firstActionType=this.$getProperty(actions,"0.actionType",null);return!(0,validation/* isEmpty */.xb)(actions.length)&&[11,12].includes(firstActionType)}}),watch:{moduleFields:function(newVal){if(null!=newVal){var dateFld=[];newVal.filter((function(d){"DATE"!==d.dataTypeEnum._name&&"DATE_TIME"!==d.dataTypeEnum._name||dateFld.push(d)})),this.dateFields=dateFld}}},mounted:function(){for(var _this=this,i=0;i<=23;i++){var time=(i<10?"0"+i:i)+":";this.timesOption.push(time+"00"),this.timesOption.push(time+"30")}if(this.fieldMatchers.push({actionType:17,fieldName:"severity",templateJson:{resultWorkflowContext:{expressions:[{name:"severity",constant:null}]},metaJson:{fields:[]}}}),!this.isNew){if(this.rule=this.ruleActions,this.data.rule.actions=this.rule.actions?this.rule.actions:[],this.rule.actions=this.ruleActions?this.ruleActions.actions:[],this.data={rule:{name:this.rule.name,siteId:this.rule.siteId,description:this.rule.description,ruleType:this.rule.ruleType,interval:this.rule.interval,event:{activityType:parseInt(this.rule.event.activityType),moduleName:this.rule.event.moduleName},id:this.rule.id,scheduleType:this.rule.scheduleType,dateFieldId:this.rule.dateFieldId,time:this.rule.time,criteria:this.rule.criteria},actions:this.rule.actions?this.rule.actions:[]},this.rule.fields&&(this.selectedFieldObject=[],this.rule.fields.forEach((function(d){_this.selectedFieldObject.push(parseInt(d.fieldId))}))),this.rule.interval&&(this.dateObject=this.$helpers.secTodaysHoursMinu(this.rule.interval)),"severityAction"===this.actionType&&this.rule.actions){var severitytemplate=this.rule.actions[0].template.originalTemplate.workflowContext.expressions[0];this.fieldMatchers[0].templateJson.resultWorkflowContext.expressions[0].constant=severitytemplate.constant}this.$forceUpdate()}},methods:{closeDialog:function(){this.$emit("update:visibilityshow",!1)},addAction:function(action){this.data.rule.actions=action},somefnt:function(newVal){this.data.rule.criteria=newVal},save:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var self,actions,woActionIdx,closeWoIdx,data,apiaction,newAction,details,_ref5,module,workflowRule,url,params,_yield$API$post,error,actionData;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(self=_this2,actions=_this2.data.actions,woActionIdx=actions.findIndex((function(action){return 11===action.actionType})),closeWoIdx=actions.findIndex((function(action){return 12===action.actionType})),2048===parseInt(_this2.data.rule.event.activityType)?(-1!==woActionIdx&&actions.splice(woActionIdx,1),-1!==closeWoIdx&&delete actions[closeWoIdx].id):(-1!==woActionIdx&&_this2.handleWoAction(actions[woActionIdx]),-1!==closeWoIdx&&actions.splice(closeWoIdx,1)),Object.keys(self.data.rule.criteria.conditions).forEach((function(kessy){self.data.rule.criteria.conditions[kessy].hasOwnProperty("fieldName")?self.data.rule.criteria&&(self.data.rule.criteria.conditions[kessy].fieldName?(delete self.data.rule.criteria.conditions[kessy].valueArray,delete self.data.rule.criteria.conditions[kessy].operatorsDataType,delete self.data.rule.criteria.conditions[kessy].operatorLabel):self.data.rule.criteria=null):self.data.rule.criteria=null})),self.selectedFieldObject.length>0?(self.data.rule.fields=[],self.selectedFieldObject.forEach((function(d){self.data.rule.fields.push({fieldId:d})}))):delete self.data.rule.fields,524288===parseInt(_this2.data.rule.event.activityType)&&(_this2.data.rule.interval=null,_this2.dateObject&&(_this2.data.rule.dateFieldId&&(_this2.checkDateTimeField||(_this2.dateObject.hours=0,_this2.dateObject.minute=0)),_this2.data.rule.interval=_this2.$helpers.daysHoursMinuToSec(_this2.dateObject))),_this2.data.rule.dateFieldId||delete _this2.data.rule.dateFieldId,_this2.data.rule.dateFieldId&&_this2.checkDateTimeField&&(_this2.data.rule.time=null),data=_this2.$helpers.cloneObject(_this2.data),data.rule.actions=actions,_this2.validateForm(data)){_context.next=14;break}return _context.abrupt("return",!1);case 14:if(_this2.saving=!0,"severityAction"===self.actionType&&(data.actions=[],data.actions[0]=Object.assign(_this2.fieldMatchers[0]),data.rule.actions[0]=Object.assign(_this2.fieldMatchers[0])),self.isSummary){_context.next=21;break}self.$emit("actionSaved",(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},data.rule),{},{type:_this2.actionType})),self.closeDialog(),_context.next=39;break;case 21:if(_this2.isNew?apiaction="addcustom":(apiaction="updatecustom","severityAction"!==_this2.actionType&&(newAction=_this2.$refs.eventDialog.updateAction(data.actions),data.actions=Object.assign(newAction))),data.rule.ruleId=_this2.parentRuleId,data.rule.ruleType=41,details=_this2.details,_ref5=details||{},module=_ref5.module,"newreadingrule"!==module){_context.next=38;break}return workflowRule=data.rule,url="v3/readingrule/actions/add",params={workflowRule:workflowRule,moduleName:"newreadingalarm"},_context.next=32,api/* API */.bl.post(url,params);case 32:_yield$API$post=_context.sent,error=_yield$API$post.error,actionData=_yield$API$post.data,error?_this2.$message.error("Error Occurred"):(_this2.saving=!1,_this2.$emit("actionSaved",actionData),_this2.closeDialog()),_context.next=39;break;case 38:_this2.$util.addOrUpdateRuleAction("newreadingalarm",data,!_this2.isNew,apiaction).then((function(){_this2.saving=!1,self.$emit("actionSaved",data.rule),_this2.closeDialog()})).catch((function(){self.saving=!1}));case 39:case"end":return _context.stop()}}),_callee)})))()},handleWoAction:function(action){11===action.actionType&&(action.templateJson=action.template.originalTemplate,delete action.template,delete action.id,delete action.templateId)},validateForm:function(ruleData){if(this.error=!1,!ruleData.rule.name)return this.error=!0,this.errorMessage="Enter Name ",!1;if(524288===ruleData.rule.event.activityType){if(!ruleData.rule.dateFieldId)return this.error=!0,this.errorMessage="Please select field for on date activity",!1;if(3===ruleData.rule.scheduleType&&!ruleData.rule.interval)return this.error=!0,this.errorMessage="Please select duration",!1}else if(1048576===ruleData.rule.event.activityType&&(!ruleData.rule.fields||!ruleData.rule.fields.length>0))return this.error=!0,this.errorMessage="Please select atleast on field for field change activity",!1;return!0}}},component_ActionFormDialogvue_type_script_lang_js=ActionFormDialogvue_type_script_lang_js,ActionFormDialog_component=(0,componentNormalizer/* default */.Z)(component_ActionFormDialogvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,ActionFormDialog=ActionFormDialog_component.exports},
/***/358551:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FDatePicker}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/assets/overview/FDatePicker.vue?vue&type=template&id=fd3cfbc4
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-date-picker",{ref:"date-picker",attrs:{appendToBody:_vm.appendToBody,clearable:!_vm.hideClear,type:_vm.type,"value-format":_vm.valueFormat,format:_vm.pickerFormat,placeholder:_vm.placeholder,disabled:_vm.disabled,editable:_vm.editable,"default-value":_vm.defaultValue,"picker-options":_vm.pickerOptions,"prefix-icon":_vm.prefixIcon,"clear-icon":_vm.clearIcon,"start-placeholder":_vm.startPlaceholder,"end-placeholder":_vm.endPlaceholder,"time-arrow-control":_vm.arrowControl,"default-time":_vm.defaultTime},on:{change:_vm.pickerChange},model:{value:_vm.ttime,callback:function($$v){_vm.ttime=$$v},expression:"ttime"}})},staticRenderFns=[],validation=(__webpack_require__(976801),__webpack_require__(564043),__webpack_require__(857267),__webpack_require__(756532),__webpack_require__(634338),__webpack_require__(450886),__webpack_require__(843843),__webpack_require__(990260)),constant=__webpack_require__(354754),moment_timezone=__webpack_require__(480008),moment_timezone_default=__webpack_require__.n(moment_timezone),FDatePickervue_type_script_lang_js={props:["appendToBody","value","value-format","format","default-value","placeholder","disabled","editable","picker-options","type","prefix-icon","clear-icon","start-placeholder","end-placeholder","hideClear","arrowControl","default-time"],mounted:function(){this.init()},data:function(){return{timeinorg:[]}},computed:{isRangeType:function(){var _ref=this||{},type=_ref.type;return["daterange","datetimerange"].includes(type)},defaultFormats:function(){var $timeformat=this.$timeformat,$dateformat=this.$dateformat,dateformat=($dateformat||"").replaceAll("Y","y");return dateformat=(dateformat||"").replaceAll("D","d"),{date:dateformat,month:"yyyy-MM",datetime:"".concat(dateformat," ").concat($timeformat),time:"".concat($timeformat),week:"yyyywWW",timerange:"".concat($timeformat),daterange:"".concat(dateformat),monthrange:"yyyy-MM",datetimerange:"".concat(dateformat," ").concat($timeformat),year:"yyyy"}},pickerFormat:function(){var _ref2=this||{},defaultFormats=_ref2.defaultFormats,type=_ref2.type,format=_ref2.format;return(0,validation/* isEmpty */.xb)(format)&&!(0,validation/* isEmpty */.xb)(defaultFormats[type])?defaultFormats[type]:format},ttime:{get:function(){var _this=this,_ref3=this||{},value=_ref3.value,isRangeType=_ref3.isRangeType;return(0,validation/* isEmpty */.xb)(value)?isRangeType?[]:"":isRangeType?value.map((function(val){return _this.getTimeInSystemZone(val)})):this.getTimeInSystemZone(value)},set:function(value){var isRangeType=this.isRangeType;if(isRangeType){if((0,validation/* isEmpty */.xb)(value))this.timeinorg=[];else for(var time in value)this.timeinorg[time]=this.$helpers.getTimeInOrg(value[time]);this.$emit("input",this.timeinorg),this.$emit("change",this.timeinorg)}else{var modifiedTimeFormat=this.$helpers.getTimeInOrg(value);this.$emit("input",modifiedTimeFormat),this.$emit("change",modifiedTimeFormat)}}}},methods:{pickerChange:function(){var isRangeType=this.isRangeType,value=this.value;if(isRangeType){if((0,validation/* isEmpty */.xb)(value))this.timeinorg=[];else for(var time in value)this.timeinorg[time]=this.$helpers.getTimeInOrg(value[time]);this.$emit("pickerChange",this.timeinorg)}else{var modifiedTimeFormat=this.$helpers.getTimeInOrg(value);this.$emit("pickerChange",modifiedTimeFormat)}},init:function(){var isRangeType=this.isRangeType,value=this.value;if(isRangeType){if((0,validation/* isEmpty */.xb)(value))this.timeinorg=[];else for(var time in value){var timeVal=parseInt(value[time]);this.timeinorg[time]=timeVal}this.$emit("input",this.timeinorg)}else if(!(0,validation/* isEmpty */.xb)(value)){var isPlaceHoldersEnabled=constant/* default */.Z.FIELD_PLACEHOLDERS.includes(value)||!1;isPlaceHoldersEnabled||this.$emit("input",value)}this.$emit("initialized")},focus:function(){this.$refs["date-picker"].focus()},getTimeInSystemZone:function(value){return new Date(moment_timezone_default().tz(value,this.$timezone).format("YYYY-MM-DD HH:mm:ss"))}}},overview_FDatePickervue_type_script_lang_js=FDatePickervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(overview_FDatePickervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FDatePicker=component.exports},
/***/936658:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"13650e19cb248768ac10b3fdfeb535d1.svg";
/***/},
/***/984329:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"78e9b94d763d88d92daab6faadbef8f9.svg";
/***/}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/73063.js.map