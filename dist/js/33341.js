(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[33341,32686,80865,26737,53021],{
/***/303514:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return AsyncButton}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/AsyncButton.vue?vue&type=template&id=16ca9ad1
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-button",_vm._b({class:_vm.buttonClass,attrs:{loading:_vm.showLoading,type:_vm.buttonType,size:_vm.size,disabled:_vm.disabled},on:{click:function($event){return _vm.save()}}},"el-button",_vm.$attrs,!1),[_vm._t("default")],2)},staticRenderFns=[],toConsumableArray=__webpack_require__(488478),AsyncButtonvue_type_script_lang_js=(__webpack_require__(260228),__webpack_require__(821694),__webpack_require__(76265),{props:["clickAction","actionParams","buttonType","buttonClass","size","disabled","loading"],data:function(){return{isLoading:!1}},computed:{showLoading:function(){return this.loading||this.isLoading}},methods:{save:function(){var _this=this;if(this.clickAction&&"function"===typeof this.clickAction){this.isLoading=!0;var returnPromise=this.actionParams?this.clickAction.apply(this,(0,toConsumableArray/* default */.Z)(this.actionParams)):this.clickAction(),minimumTimeout=this.$helpers.delay(1e3);returnPromise?Promise.all([returnPromise,minimumTimeout]).finally((function(){_this.isLoading=!1})):this.$helpers.delay(1e3).then((function(){return _this.isLoading=!1}))}}}}),components_AsyncButtonvue_type_script_lang_js=AsyncButtonvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_AsyncButtonvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,AsyncButton=component.exports},
/***/574752:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return Avatar}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/Avatar.vue?vue&type=template&id=7f0d5689
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.user||_vm.name?_c("div",{staticClass:"fc-avatar-inline"},[_vm.avatarUrl?_c("img",{staticClass:"fc-avatar",class:_vm.sizeClass,attrs:{src:_vm.avatarUrl,alt:"Profile Avatar"}}):_c("div",{staticClass:"fc-avatar",class:_vm.sizeClass,style:_vm.bgColor},[_vm._v(" "+_vm._s(_vm.trimmedName)+" ")])]):_vm._e()},staticRenderFns=[],objectSpread2=__webpack_require__(595082),vuex_esm=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(434284),__webpack_require__(564043),__webpack_require__(709873),__webpack_require__(228436),__webpack_require__(450886),__webpack_require__(677049),__webpack_require__(821694),__webpack_require__(420629)),Avatarvue_type_script_lang_js={props:{size:{type:String},user:{type:Object},avatarStyle:{type:Object},color:{type:String},name:{type:Boolean}},data:function(){return{sizeClass:"fc-avatar-"+this.size,fullName:"",trimmedName:null,avatarUrl:null,bgColor:"background-color: "+(this.color?this.color:this.getRandomBgColor())}},computed:(0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({users:function(state){return state.users}})),mounted:function(){var _this=this;if(this.user){var userName="";if(this.user.avatarUrl)this.avatarUrl=this.user.avatarUrl;else if(this.user.id){var userObj=this.users.find((function(user){return user.id===_this.user.id}));userObj&&userObj.avatarUrl&&(this.avatarUrl=userObj.avatarUrl),userObj&&userObj.name&&(userName=userObj.name)}userName=userName||this.user.name,userName&&(this.fullName=userName,this.trimmedName=this.getAvatarName(userName),this.bgColor="background-color: "+(this.color?this.color:this.getRandomBgColor()))}else this.name&&(this.trimmedName=this.getAvatarName(this.name),this.bgColor="background-color: "+(this.color?this.color:this.getRandomBgColor()))},watch:{user:function(){var _this2=this;if(this.user.avatarUrl)this.avatarUrl=this.user.avatarUrl;else if(this.user.id){var userObj=this.users.find((function(user){return user.id===_this2.user.id}));userObj&&userObj.avatarUrl?this.avatarUrl=userObj.avatarUrl:this.avatarUrl=null}else this.avatarUrl=null;this.user.name&&(this.fullName=this.user.name,this.trimmedName=this.getAvatarName(this.user.name),this.bgColor="background-color: "+(this.color?this.color:this.getRandomBgColor()))},"user.name":function(){this.user.name&&(this.fullName=this.user.name,this.trimmedName=this.getAvatarName(this.user.name),this.bgColor="background-color: "+(this.color?this.color:this.getRandomBgColor()))},"user.avatarUrl":function(){this.user.avatarUrl?this.avatarUrl=this.user.avatarUrl:this.avatarUrl=null},"user.id":function(){var _this3=this;if(this.user.id){var userObj=this.users.find((function(user){return user.id===_this3.user.id}));userObj&&userObj.avatarUrl?this.avatarUrl=userObj.avatarUrl:this.avatarUrl=null}else this.avatarUrl=null}},methods:{getAvatarName:function(name){for(var parts=name.split(/[ -]/),initials="",initialLen=2,count=0,i=0;i<parts.length;i++)if(""!==parts[i].trim()&&(initials+=parts[i].charAt(0),count++,count>=initialLen))break;initials.length<initialLen&&name.length>=initialLen&&(initials=name.trim().substring(0,initialLen));var avatarName=initials.toUpperCase();return avatarName},getRandomBgColor:function(){var colors=["#FFBA51","#34BFA3","#FF2F82","#29D9A7","#ECDC74","#927FED","#FF61A8","#fbf383","#ac4352","#6db1f4"],userKey=this.user.email?this.user.email:this.user.name,userUniqueNum=Array.from(userKey).map((function(letter){return letter.charCodeAt(0)})).reduce((function(current,previous){return previous+current})),colorIndex=userUniqueNum%colors.length,color=colors[colorIndex];return color}}},components_Avatarvue_type_script_lang_js=Avatarvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_Avatarvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,Avatar=component.exports},
/***/42525:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return ApprovalBar}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/approval/ApprovalBar.vue?vue&type=template&id=4fea8923&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("div",{class:["sidebar-loader",(_vm.loading||_vm.isSaving)&&"on"]}),_vm.loading?_c("div",{staticClass:"d-flex approval-bar"},[_vm._v(" "+_vm._s(_vm.$t("panel.loading_load"))+" ")]):_c("div",{staticClass:"d-flex approval-bar"},[_c("div",{staticClass:"approval-desc mR30 f14"},[_vm.isRejected?[_c("span",{staticClass:"bold"},[_vm._v(_vm._s(_vm.policyName))]),_vm._v(" "+_vm._s(_vm.$t("panel.was"))+" "),_c("span",{staticClass:"bold",staticStyle:{color:"#dd7171"}},[_vm._v(_vm._s(_vm.$t("panel.rejected")))]),_vm._v(" for this "+_vm._s(_vm.moduleDisplayName||_vm.moduleName)+". "),_vm.resendApproval?[_c("span",[_vm._v("You can")]),_vm.canShowEdit?[_c("span",{staticClass:"mL5"},[_vm._v("either")]),_c("span",{class:[_vm.isSaving&&"cursor-not-allowed"]},[_c("a",{class:["mL5 bold",_vm.isSaving&&"pointer-events-none"],on:{click:function($event){return _vm.$emit("onEdit")}}},[_vm._v(" edit ")])]),_c("span",{staticClass:"mL5"},[_vm._v("or")])]:_vm._e(),_c("span",{class:[_vm.isSaving&&"cursor-not-allowed"]},[_c("a",{class:["mL5 bold",_vm.isSaving&&"pointer-events-none"],on:{click:function($event){return _vm.requestToSave(_vm.resendApproval)}}},[_vm._v(" resend ")])]),_c("span",{staticClass:"mL5"},[_vm._v("for approval.")])]:_vm._e()]:_vm.hasApprovalList&&!_vm.hideApprovers?[_c("span",{staticClass:"bold"},[_vm._v(_vm._s(_vm.policyName))]),_vm._v(" is pending from "),_c("span",{staticClass:"bold"},[_vm._v(_vm._s(_vm.approvers[0].name))]),_vm.approvers.length>1?_c("el-popover",{attrs:{placement:"bottom",width:"200",trigger:"hover"}},[_vm._t("default",(function(){return[_c("div",{staticClass:"mL5 approvers-more-icon"},[_vm._v(" +"+_vm._s(_vm.approvers.length-1)+" ")])]}),{slot:"reference"}),_c("div",_vm._l(_vm.approvers.slice(1),(function(approver){return _c("div",{key:approver.name,staticClass:"mB10"},[_c("ApproverTypeAvatar",{attrs:{size:"md",user:approver,userType:_vm.getApproverType(approver),moduleName:_vm.moduleName,approvalMeta:_vm.approvalMeta}})],1)})),0)],2):_vm._e()]:(_vm.$validation.isEmpty(_vm.transitions),[_c("span",{staticClass:"bold"},[_vm._v(_vm._s(_vm.policyName))]),_vm._v(" is pending ")])],2),_vm.$validation.isEmpty(_vm.transitions)?_vm._e():_c("div",{staticClass:"approval-links text-uppercase f12 bold"},[_c("div",{class:[_vm.isSaving&&"cursor-not-allowed"]},[_vm.approveTransition?_c("a",{class:["link-approve mR15",_vm.isSaving&&"pointer-events-none"],on:{click:function($event){return _vm.requestToSave(_vm.approveTransition)}}},[_c("inline-svg",{attrs:{src:"tick-sign",iconClass:"icon icon-xs"}}),_vm._v(" "+_vm._s(_vm.approveTransition.name)+" ")],1):_vm._e(),_vm.rejectTransition?_c("a",{class:["link-reject",_vm.isSaving&&"pointer-events-none"],on:{click:function($event){return _vm.requestToSave(_vm.rejectTransition)}}},[_c("inline-svg",{attrs:{src:"svgs/close",iconClass:"icon icon-xxs"}}),_vm._v(" "+_vm._s(_vm.rejectTransition.name)+" ")],1):_vm._e()])])]),_vm.canShowForm?[_c("TransitionForm",{attrs:{moduleName:_vm.selectedTransition.moduleName,recordId:_vm.record.recordId,formId:_vm.selectedTransition.formId,record:_vm.record,transition:_vm.selectedTransition,approvalRule:_vm.approvalRule,saveAction:_vm.saveAction,closeAction:_vm.closeStateFlowForm,isV3:_vm.isV3}})]:_vm._e()],2)},staticRenderFns=[],toConsumableArray=__webpack_require__(488478),objectSpread2=__webpack_require__(595082),ApprovalButtons=(__webpack_require__(689730),__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(670560),__webpack_require__(425728),__webpack_require__(434284),__webpack_require__(976801),__webpack_require__(634338),__webpack_require__(840889)),ApprovalForm=__webpack_require__(548127),ApprovalUserAvatar=__webpack_require__(400438),validation=__webpack_require__(990260),vuex_esm=__webpack_require__(420629),ApprovalBarvue_type_script_lang_js={extends:ApprovalButtons/* default */.Z,props:["hideApprovers","canShowEdit","canHideMsg"],components:{TransitionForm:ApprovalForm/* default */.Z,ApproverTypeAvatar:ApprovalUserAvatar/* default */.Z},data:function(){return{isSaving:!1}},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({metaInfo:function(state){return state.view.metaInfo}})),{},{transitions:function(){return(0,validation/* isEmpty */.xb)(this.stateTransitions)?[]:(0,toConsumableArray/* default */.Z)(this.stateTransitions).slice(0,2)},policyName:function(){return(0,validation/* isEmpty */.xb)(this.approvalRule)?"Approval":this.$getProperty(this.approvalRule,"name")},shouldCurrentUserApprove:function(){return!(0,validation/* isEmpty */.xb)(this.transitions)},hasApprovalList:function(){return!(0,validation/* isEmpty */.xb)(this.approvers)},approvalMeta:function(){return{approvalList:this.pendingApprovalList}},approvers:function(){var approvers=[];return this.pendingApprovalList.forEach((function(approver){var value=approver.value,type=approver.type;(0,validation/* isEmpty */.xb)(value)?"TENANT"===type?approvers.push({name:"Tenant",type:"TENANT"}):"VENDOR"===type&&approvers.push({name:"Vendor",type:"VENDOR"}):(0,validation/* isArray */.kJ)(value)?approvers.push.apply(approvers,(0,toConsumableArray/* default */.Z)(value)):approvers.push(value)})),approvers},isRejected:function(){return"Rejected"===this.$getProperty(this.currentState,"status")},shouldCreateModuleRecord:function(){return!1},shouldCreateNotes:function(){return!1},approveTransition:function(){return this.transitions.find((function(t){return"Approve"===t.name}))},rejectTransition:function(){return this.transitions.find((function(t){return"Reject"===t.name}))},resendApproval:function(){return this.transitions.find((function(t){return!["Approve","Reject"].includes(t.name)}))},moduleDisplayName:function(){var _this$metaInfo;return null===(_this$metaInfo=this.metaInfo)||void 0===_this$metaInfo?void 0:_this$metaInfo.displayName}}),methods:{showMessage:function(transition){
/* override */
var name=transition.name,action="";["Approve","Reject"].includes(name)?"Approve"===name?action="approved":"Reject"===name&&(action="rejected"):action="resent for approval",this.$message.success("".concat(this.moduleDisplayName||this.moduleName," was ").concat(action))},requestToSave:function(transition){var _this=this;this.isSaving=!0,this.startTransition(transition).finally((function(){return _this.isSaving=!1}))},saveAction:function(formData){return this.transitionToState(formData)},getApproverType:function(approver){return approver.id?{type:"USER",value:approver}:approver},defaultResponseHandler:function(_ref,transition){var error=_ref.error,canShowForm=this.canShowForm;error?(!this.canHideMsg&&this.$message.error(error.message),this.$emit("onFailure",{error:error,transition:transition})):(canShowForm&&this.closeStateFlowForm(),this.fetchAvailableStates(),this.$emit("onSuccess",{error:error,transition:transition}),!this.canHideMsg&&this.showMessage(transition))}}},approval_ApprovalBarvue_type_script_lang_js=ApprovalBarvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(approval_ApprovalBarvue_type_script_lang_js,render,staticRenderFns,!1,null,"4fea8923",null)
/* harmony default export */,ApprovalBar=component.exports},
/***/426803:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return User}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/avatar/User.vue?vue&type=template&id=c662fbbc
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.userObj?_c("div",{staticClass:"inline"},[_c("div",{staticClass:"fc-avatar-element q-item-division relative-position"},[_c("div",{staticClass:"q-item-side-left q-item-section"},[_vm.showPopover&&-1!==_vm.userObj.id?_c("avatarPopover",{attrs:{user:_vm.userObj,moduleName:_vm.moduleName}},[_c("span",{attrs:{slot:"reference"},slot:"reference"},[_c("avatar",{attrs:{size:_vm.size,user:_vm.userObj,color:_vm.color}})],1)]):_c("span",[_c("avatar",{attrs:{size:_vm.size,user:_vm.userObj,color:_vm.color}})],1)],1),_vm.showLabel?[_vm.user&&_vm.user.id>0||_vm.group&&_vm.group.id>0?_c("div",{staticClass:"wo-team-txt"},[_c("div",{staticClass:"assignment-avatar-name",class:{"color-d":!_vm.user}},[_vm._v(" "+_vm._s(_vm.user&&_vm.user.id>0?_vm.user.name||(_vm.users.find((function(usr){return usr.id===_vm.user.id}))||{}).name:"---")+" ")]),_c("div",{staticClass:"assignment-group-name",class:{"color-d":!_vm.group}},[_vm._v(" "+_vm._s(_vm.group?_vm.group.name||(_vm.$store.getters.getGroup(_vm.group.id)||{}).name:"---")+" ")])]):_c("div",{staticClass:"wo-team-txt",staticStyle:{"padding-top":"7px","font-size":"14px",color:"#aaa","letter-spacing":"0.2px"}},[_vm._v(" ---/--- ")])]:0!=_vm.name?_c("div",[_c("div",[_c("span",{staticClass:"q-item-label d-flex flex-wrap"},[_vm._v(_vm._s(_vm.userObj.name))])])]):_vm._e()],2)]):_vm._e()},staticRenderFns=[],objectSpread2=__webpack_require__(595082),Avatar=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(574752)),AvatarPopovervue_type_template_id_8ef9b9ec_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"avatar-popover-container"},[_c("el-popover",{ref:"popover1",staticStyle:{display:"block",padding:"0"},attrs:{placement:"top-start",trigger:"hover",width:"383",clas:"avatar-popover","popper-class":"avatar-popover",height:_vm.defaultheight,"open-delay":600},model:{value:_vm.popoverShown,callback:function($$v){_vm.popoverShown=$$v},expression:"popoverShown"}},[_c("div",{staticClass:"popover-content-block"},[_c("div",{staticClass:"popover-avatar"},[_c("avatar",{attrs:{size:_vm.size,user:_vm.user,color:_vm.color,showPopover:!1}})],1),_c("div",{staticClass:"popover-avatar-det"},[_c("div",{staticClass:"avatar-name-txt"},[_vm._v(" "+_vm._s(_vm.user.name?_vm.user.name:"----")+" ")]),_c("div",{staticClass:"mail-block"},[_c("img",{staticClass:"envelope-icon",staticStyle:{height:"13px","vertical-align":"middle"},attrs:{src:__webpack_require__(702638)}}),_c("span",{staticClass:"mail-txt"},[_vm._v(_vm._s(_vm.user.email?_vm.user.email:"----")+" ")])]),_c("div",[_c("img",{staticClass:"envelope-icon",staticStyle:{height:"15px"},attrs:{src:__webpack_require__(47424)}}),_c("span",{staticClass:"popover-phone-number"},[_vm._v(" "+_vm._s(_vm.user.mobile?_vm.user.mobile:"----")+" ")])])]),"workorder"===_vm.moduleName?_c("div",{staticClass:"popover-footer"},[_c("ul",[_c("li",{staticClass:"popover-footer-list",on:{click:function($event){return _vm.getOpen("open")}}},[_c("div",{staticClass:"open-result-txt"},[_vm._v(" "+_vm._s(_vm.result.openWorkOrdersCount)+" ")]),_c("div",{staticClass:"result-txt-black"},[_vm._v("OPEN")])]),_c("li",{staticClass:"popover-footer-list border-RL",on:{click:function($event){return _vm.getOpen("overdue")}}},[_c("div",{staticClass:"overdue-result-txt"},[_vm._v(" "+_vm._s(_vm.result.overDueWorkOrdersCount)+" ")]),_c("div",{staticClass:"result-txt-black"},[_vm._v("OVERDUE")])]),_c("li",{staticClass:"popover-footer-list",on:{click:function($event){return _vm.getOpen("duetoday")}}},[_c("div",{staticClass:"dueday-result-txt"},[_vm._v(" "+_vm._s(_vm.result.dueTodayWorkOrdersCount)+" ")]),_c("div",{staticClass:"result-txt-black"},[_vm._v("DUE TODAY")])])])]):_vm._e()]),_c("template",{slot:"reference"},[_vm._t("reference")],2)],2)],1)},AvatarPopovervue_type_template_id_8ef9b9ec_staticRenderFns=[],AvatarPopovervue_type_script_lang_js=(__webpack_require__(670560),__webpack_require__(648324),{props:["size","user","color","name","moduleName"],data:function(){return{defaultheight:"230px",result:{},popoverShown:!1,viewname:""}},components:{Avatar:Avatar["default"]},mounted:function(){
// this.showPopover = this.showpopoverFooter
this.moduleName&&(this.defaultheight="160px")},watch:{popoverShown:function(val){val&&this.userOpenDatas()}},methods:{userOpenDatas:function(){var self=this;self.$http.post("/widget/getUserCardData",{ouid:this.user.id}).then((function(response){200===response.status&&(self.result=response.data.result)}))},getOpen:function(viewName){var filter={assignedTo:{operator:"is",value:[this.user.id+""]}};this.$router.push("/app/wo/orders/"+viewName+"?search="+encodeURIComponent(JSON.stringify(filter)))}}}),components_AvatarPopovervue_type_script_lang_js=AvatarPopovervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_AvatarPopovervue_type_script_lang_js,AvatarPopovervue_type_template_id_8ef9b9ec_render,AvatarPopovervue_type_template_id_8ef9b9ec_staticRenderFns,!1,null,null,null)
/* harmony default export */,AvatarPopover=component.exports,vuex_esm=__webpack_require__(420629),Uservue_type_script_lang_js={created:function(){this.$store.dispatch("loadGroups")},components:{Avatar:Avatar["default"],AvatarPopover:AvatarPopover},props:{size:{type:String},user:{type:Object},avatarStyle:{type:Object},name:{type:Boolean,default:function(){return!0}},showLabel:{type:Boolean},showPopover:{type:Boolean},moduleName:{type:String},group:{type:Object},hovercard:{type:Boolean}},data:function(){return{hoverCardId:"userHoverCardId-"+(this.user?this.user.id:"unkown"),loadHoverCardData:!1,labelStatus:this.hideLabel}},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({users:function(state){return state.users}})),{},{userObj:function(){var _this=this,hasUser=this.user&&this.user.id>0,user=hasUser?this.$getProperty(this.user,"name")?this.user:this.users.find((function(usr){return usr.id===_this.user.id})):null;return user||{id:-1,name:"Unknown"}},color:function(){return-1!==this.userObj.id?"":this.group?"#c3c3c3":"#e3e3e3"}}),methods:{loadHoverCard:function(){this.loadHoverCardData=!0},hideHoverCard:function(){this.loadHoverCardData=!1}}},avatar_Uservue_type_script_lang_js=Uservue_type_script_lang_js,User_component=(0,componentNormalizer/* default */.Z)(avatar_Uservue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,User=User_component.exports},
/***/874249:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return RichTextArea}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/forms/RichTextArea.vue?vue&type=template&id=7711575b
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.isRichText?_c("div",{staticClass:"richtext-area"},[_c("RichText",{style:{minHeight:_vm.minHeight,maxHeight:_vm.maxHeight,overflow:_vm.overflow},attrs:{readOnly:_vm.disabled,placeholder:_vm.placeholder,hideImgTool:_vm.hideImgTool,hideUnorderedList:_vm.hideUnorderedList,hideOrderedList:_vm.hideOrderedList,secondaryToolbar:_vm.secondaryToolbar,istoolbarPositionBottom:_vm.istoolbarPositionBottom,isMoreOption:_vm.isMoreOption,customToolOrder:_vm.customToolOrder,iconColor:_vm.iconColor},scopedSlots:_vm._u([_vm.canShowModeToggle?{key:"editorMode",fn:function(){return[_c("div",{staticClass:"self-center marginL-auto mR15 cursor-pointer mode-btn",on:{click:function($event){return _vm.changeMode()}}},[_vm._v(" "+_vm._s(_vm.$t("forms.builder.plain_text_mode"))+" ")])]},proxy:!0}:null],null,!0),model:{value:_vm.content,callback:function($$v){_vm.content=$$v},expression:"content"}})],1):_c("div",{staticClass:"richtext-area plain-text-mode"},[_c("div",{staticClass:"richtext-editor"},[_c("div",{staticClass:"richtext-toolbar"},[_c("div",{staticClass:"toolbar-button marginL-auto cursor-pointer mode-btn",on:{click:function($event){return _vm.changeMode()}}},[_vm._v(" "+_vm._s(_vm.$t("forms.builder.switch_to_richtext"))+" ")])]),_c("el-input",{key:"plain-text",staticClass:"richtext-content",attrs:{type:"textarea",resize:"none",placeholder:_vm.placeholder},model:{value:_vm.content,callback:function($$v){_vm.content=$$v},expression:"content"}})],1)])},staticRenderFns=[],ui_forms=(__webpack_require__(879288),__webpack_require__(141323)),filters=__webpack_require__(638203),RichTextAreavue_type_script_lang_js={props:{value:{type:String},field:{type:Object},rows:{type:Number,default:10},maxRows:{type:Number,default:12},disabled:{type:Boolean,default:!1},placeholder:{type:String,default:"Enter text here"},isEdit:{type:Boolean,default:!1},hideImgTool:{type:Boolean,default:!1},hideOrderedList:{type:Boolean,default:!1},hideUnorderedList:{type:Boolean,default:!1},isRichTextMode:{type:Boolean,default:!0},canShowModeToggle:{type:Boolean,default:!1},istoolbarPositionBottom:{type:Boolean},customToolOrder:{type:Array},isMoreOption:{type:Boolean},secondaryToolbar:{type:Boolean},iconColor:{type:String}},components:{RichText:ui_forms/* RichText */.Ho},computed:{content:{get:function(){return this.value},set:function(value){this.$emit("input",value)}},isRichText:{get:function(){return this.isRichTextMode},set:function(value){this.$emit("update:isRichTextMode",value)}},
// Assuming a <p></p> tag inside editor
// has fonts-size 1rem and margin-bottom 1rem
minHeight:function(){return"".concat(2*this.rows,"rem")},maxHeight:function(){return"".concat(2*this.maxRows,"rem")},overflow:function(){return"hidden"}},methods:{changeMode:function(){var isRichText=this.isRichText,value=this.value;if(isRichText)this.showConfirmModeSwitch();else{var htmlContent="<p>".concat(value,"</p>");this.content=htmlContent,this.proceedChangingModes()}},showConfirmModeSwitch:function(){var _this=this,dialogObj={htmlMessage:"".concat(this.$t("forms.builder.switch_alert")),rbDanger:!0,rbLabel:"Confirm"};this.$dialog.confirm(dialogObj).then((function(canProceed){if(canProceed){var value=_this.value,textContent=(0,filters/* htmlToText */.s9)(value);_this.content=textContent,_this.proceedChangingModes()}}))},proceedChangingModes:function(){var isRichText=this.isRichText;this.isRichText=!isRichText}}},forms_RichTextAreavue_type_script_lang_js=RichTextAreavue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(forms_RichTextAreavue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,RichTextArea=component.exports},
/***/786113:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return WorkOrderSpecialFieldsList}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/list/WorkOrderSpecialFieldsList.vue?vue&type=template&id=c5129894
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",["resource"===_vm.field.name?_c("div",{staticClass:"q-item-division relative-position",staticStyle:{"min-width":"170px"}},[_vm.$validation.isEmpty(_vm.moduleData.resource)||_vm.$validation.isEmpty(_vm.moduleData.resource.id)?_c("div",[_c("span",{staticClass:"q-item-label secondary-color color-d"},[_vm._v("--- "+_vm._s(_vm.$t("maintenance.wr_list.space_asset"))+" ---")])]):_c("div",[_c("div",{staticClass:"flLeft mR7"},[1===_vm.moduleData.resource.resourceType?_c("img",{staticStyle:{height:"12px",width:"14px"},attrs:{src:__webpack_require__(572902)}}):_c("img",{staticStyle:{height:"11px",width:"14px"},attrs:{src:__webpack_require__(30684)}})]),_c("span",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"flLeft q-item-label ellipsis max-width140px",attrs:{small:"","data-position":"bottom",title:_vm.moduleData.resource.name}},[_vm._v(_vm._s(_vm.moduleData.resource.name))])])]):"assignedTo"===_vm.field.name?_c("div",{staticClass:"q-item-division relative-position wo_assignedto_avatarblock"},[_c("div",{staticClass:"wo-assigned-avatar fL"},[_c("user-avatar",{attrs:{size:"md",user:_vm.moduleData.assignedTo,group:_vm.moduleData.assignmentGroup,showLabel:!0,moduleName:"lookupModuleName"}})],1)]):"noOfNotes"===_vm.field.name?_c("div",[_vm._m(0),_c("span",{staticClass:"width5px q-item-sublabel comment-counnt-txt"},[_vm._v(_vm._s(_vm.notesLabel))])]):"noOfTasks"===_vm.field.name?_c("div",[_vm.canShowTaskIcon?_c("inline-svg",{staticClass:"vertical-middle cursor-pointer",attrs:{src:"svgs/task-list",iconClass:"icon icon-sm mT5 mR5 task-icon"}}):_vm._e(),_c("span",{staticClass:"q-item-sublabel pL5"},[_vm._v(_vm._s(_vm.taskLabel))])],1):"noOfAttachments"===_vm.field.name?_c("div",{staticStyle:{float:"left"}},[_vm._m(1),_c("span",{staticClass:"width5px q-item-sublabel comment-counnt-txt"},[_vm._v(_vm._s(_vm.attachmentLabel))])]):_vm._e()])},staticRenderFns=[function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("span",[_c("img",{staticStyle:{width:"14px",height:"12.8px"},attrs:{src:__webpack_require__(293656)}})])},function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("span",[_c("img",{staticStyle:{width:"14px",height:"12.8px"},attrs:{src:__webpack_require__(345265)}})])}],User=(__webpack_require__(634338),__webpack_require__(426803)),validation=__webpack_require__(990260),WorkOrderSpecialFieldsListvue_type_script_lang_js={components:{UserAvatar:User/* default */.Z},props:["field","moduleData"],computed:{canShowTaskIcon:function(){var moduleData=this.moduleData;return!(0,validation/* isEmpty */.xb)(moduleData.noOfTasks)&&0!==moduleData.noOfNotes},taskLabel:function(){var moduleData=this.moduleData,noOfTasks=moduleData.noOfTasks,noOfNotes=moduleData.noOfNotes,noOfClosedTasks=moduleData.noOfClosedTasks,taskLabel="---";return(0,validation/* isEmpty */.xb)(noOfTasks)||0===noOfNotes?taskLabel:(0,validation/* isEmpty */.xb)(noOfClosedTasks)?"0":"".concat(noOfClosedTasks,"/").concat(noOfTasks)},notesLabel:function(){var moduleData=this.moduleData,noOfNotes=moduleData.noOfNotes;return(0,validation/* isEmpty */.xb)(noOfNotes)||0===noOfNotes?"0":moduleData.noOfNotes},attachmentLabel:function(){var moduleData=this.moduleData,_ref=moduleData||{},noOfAttachments=_ref.noOfAttachments;return(0,validation/* isEmpty */.xb)(noOfAttachments)||0===noOfAttachments?"0":noOfAttachments}}},list_WorkOrderSpecialFieldsListvue_type_script_lang_js=WorkOrderSpecialFieldsListvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(list_WorkOrderSpecialFieldsListvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,WorkOrderSpecialFieldsList=component.exports},
/***/806339:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return WidgetPagination}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/page/widget/utils/WidgetPagination.vue?vue&type=template&id=6b10cd5b
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"fc-widget-pagination"},[_vm.total>0?_c("div",{class:{"fc-black-small-txt-12":!_vm.hideToggle}},[_vm.from!==_vm.to?_c("span",[_vm._v(_vm._s(_vm.from)+" -")]):_vm._e(),_c("span",[_vm._v(_vm._s(_vm.to))]),_vm.hideToggle?_vm._e():[_vm._v(" of "+_vm._s(_vm.total)+" "),_c("span",{staticClass:"el-icon-arrow-left fc-black-small-txt-12 fw-bold f16 pointer mL10 mR5",class:{disable:_vm.from<=1},on:{click:function($event){_vm.from>1&&_vm.prev()}}}),_c("span",{staticClass:"el-icon-arrow-right fc-black-small-txt-12 f16 pointer mR10 fw-bold",class:{disable:_vm.to===_vm.total},on:{click:function($event){_vm.to!==_vm.total&&_vm.next()}}})]],2):_vm._e()])},staticRenderFns=[],WidgetPaginationvue_type_script_lang_js={props:["currentPage","perPage","total","hideToggle"],data:function(){return{from:0,to:0,page:1}},mounted:function(){this.init()},watch:{total:function(){this.init()},currentPage:function(val){val!==this.page&&this.init()}},methods:{init:function(){this.page=this.currentPage||1,this.from=(this.page-1)*this.perPage+1;var to=this.from+this.perPage-1;this.to=this.total>to?to:this.total},next:function(){this.from=this.to+1,this.to+=this.perPage,this.to>this.total&&(this.to=this.total),this.page++,this.updateCurrentPage()},prev:function(){this.to=this.from-1,this.from-=this.perPage,this.from<=1?this.from=this.page=1:this.page--,this.updateCurrentPage()},updateCurrentPage:function(){
// Update currentPage value
this.$emit("update:currentPage",this.page),this.$emit("onChange")}}},utils_WidgetPaginationvue_type_script_lang_js=WidgetPaginationvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(utils_WidgetPaginationvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,WidgetPagination=component.exports},
/***/323796:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return TransitionForm}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/stateflow/TransitionForm.vue?vue&type=template&id=406a8f2a
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"fc-dialog-header-hide wo-state-transition-dialog-center",staticStyle:{"z-index":"999999"},attrs:{"append-to-body":!0,visible:!0,"custom-class":"wo-web-form",width:_vm.hasMultiColumnElements?"70%":"35%"}},[_vm.isLoading||_vm.isFormDataLoading?_c("Spinner",{attrs:{size:"80",show:!0}}):[_c("div",{staticClass:"header pL30 pB20 pT10 d-flex bold"},[_c("div",{staticClass:"title mT10"},[_vm._v(_vm._s(_vm.formObj.displayName))])]),_c("f-webform",{attrs:{form:_vm.formObj,module:_vm.moduleName,isSaving:_vm.isSaving,isV3Api:_vm.isV3Api,canShowNotifyRequester:_vm.canShowNotifyRequester,canShowPrimaryBtn:!0,canShowSecondaryBtn:!0,isEdit:!0,isEditForm:!0,moduleData:_vm.moduleData,moduleDataId:_vm.moduleDataId,modifyFieldPropsHook:_vm.modifyFieldPropsHook,formLabelPosition:"top"},on:{"update:form":function($event){_vm.formObj=$event},save:_vm.submitForm,cancel:_vm.closeAction}})]],2)},staticRenderFns=[],objectSpread2=__webpack_require__(595082),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),FormCreation=(__webpack_require__(434284),__webpack_require__(634338),__webpack_require__(260228),__webpack_require__(373729)),FWebform=__webpack_require__(434500),validation=__webpack_require__(990260),api=__webpack_require__(32284),CustomButtonUtil=__webpack_require__(746095),TransitionFormvue_type_script_lang_js={extends:FormCreation/* default */.Z,components:{FWebform:FWebform/* default */.Z},props:["moduleName","recordId","transition","record","formId","closeAction","saveAction","isExternalModule","isV3","actionType","isFormOfCustomButton"],data:function(){return{isSaving:!1,selectedForm:{id:this.formId},isFormDataLoading:!1,hasMultiColumnElements:!1,isLoading:!0}},created:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(!_this.formId){_context.next=5;break}return _context.next=3,_this.loadModuleData();case 3:return _context.next=5,_this.loadFormData();case 5:case"end":return _context.stop()}}),_callee)})))()},computed:{moduleDataId:function(){return this.recordId},canShowNotifyRequester:function(){var moduleName=this.moduleName,record=this.record;return"workorder"===moduleName&&!(0,validation/* isEmpty */.xb)((record||{}).requester)},isV3Api:function(){return this.isV3}},methods:{init:function(){
// override to prevent default code in formcreation
},loadFormData:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var selectedForm,moduleName,moduleData,transition,formModuleName,id,name,formObj,_moduleName,formUrl,_yield$API$get,error,data,form,sections;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return selectedForm=_this2.selectedForm,moduleName=_this2.moduleName,moduleData=_this2.moduleData,transition=_this2.transition,formModuleName=transition.formModuleName,id=selectedForm.id,name=selectedForm.name,formObj={},_moduleName=_this2.isExternalModule?formModuleName:moduleName,formUrl=-1===id?"/v2/forms/".concat(_moduleName,"?formName=").concat(name,"&fetchFormRuleFields=true"):"/v2/forms/".concat(_moduleName,"?formId=").concat(id,"&fetchFormRuleFields=true"),_this2.isLoading=!0,_context2.next=9,api/* API */.bl.get(formUrl);case 9:return _yield$API$get=_context2.sent,error=_yield$API$get.error,data=_yield$API$get.data,error?_this2.$message.error(error.message):(form=data.form,(0,validation/* isEmpty */.xb)(form)||(formObj=form,_this2.$set(_this2,"formObj",formObj),_this2.setFormLabels(),form.sections&&(
// Check if there are any subforms
// TODO: Also handle for cases where fields with
// span !== 1..ie multiple fields in the same row
sections=form.sections,_this2.hasMultiColumnElements=sections.some((function(section){return section.subFormId>0}))),_this2.isExternalModule||(0,validation/* isEmpty */.xb)(moduleData)||_this2.deserializeData(moduleData))),_this2.isLoading=!1,_context2.abrupt("return",formObj);case 15:case"end":return _context2.stop()}}),_callee2)})))()},setFormLabels:function(){this.formObj.primaryBtnLabel=this.$t("common.roles.save"),this.formObj.secondaryBtnLabel=this.$t("common._common.cancel")},loadModuleData:function(){var _this3=this;
// Keeping this async in case we need to load data from api here
return(0,validation/* isEmpty */.xb)(this.record)?Promise.resolve():new Promise((function(resolve){_this3.$set(_this3,"moduleData",_this3.record),resolve()}))},modifyFieldPropsHook:function(field){var moduleName=this.moduleName,recordId=this.recordId,isFormOfCustomButton=this.isFormOfCustomButton,actionType=this.actionType,isExternalModule=this.isExternalModule,_ref=field||{},displayTypeEnum=_ref.displayTypeEnum,lookupModuleName=_ref.lookupModuleName,isRelatedModuleField="LOOKUP_SIMPLE"===displayTypeEnum&&lookupModuleName===moduleName,isDisabled=isFormOfCustomButton?actionType===CustomButtonUtil/* ACTION_TYPES */.aI.CREATE_RECORD:isExternalModule;if(isRelatedModuleField)return(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},field),{},{isDisabled:isDisabled,value:recordId})},submitForm:function(data){var _this4=this;this.isSaving=!0;var formObj=this.formObj,formId=this.formId,_data=data,subFormFiles=_data.subFormFiles;data=this.serializedData(formObj,data),subFormFiles&&(data=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},data),{},{subFormFiles:subFormFiles})),this.saveAction(data,formId).catch((function(){_this4.closeAction()})).finally((function(){_this4.isSaving=!1}))}}},stateflow_TransitionFormvue_type_script_lang_js=TransitionFormvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(stateflow_TransitionFormvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,TransitionForm=component.exports},
/***/400438:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return ApprovalUserAvatar}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/approvals/components/ApprovalUserAvatar.vue?vue&type=template&id=443099a5&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"inline"},[_c("div",{staticClass:"fc-avatar-element q-item-division relative-position"},[_c("div",{staticClass:"q-item-side-left q-item-section"},[_vm.hasUser?_c("avatarPopover",{attrs:{user:_vm.userObj,moduleName:_vm.moduleName}},[_c("span",{attrs:{slot:"reference"},slot:"reference"},[_c("avatar",{attrs:{size:_vm.size,user:_vm.userObj,color:_vm.color}})],1)]):_vm.fieldType?_c("avatarPopover",{attrs:{user:_vm.fieldTypeUserValue,moduleName:_vm.moduleName}},[_c("span",{attrs:{slot:"reference"},slot:"reference"},[_c("avatar",{attrs:{size:_vm.size,user:_vm.fieldTypeUserValue,color:_vm.color}})],1)]):_c("div",{class:["icon-border",_vm.userTypeIcon[_vm.userType.type].background]},[_c("inline-svg",{class:["mT2",_vm.userTypeIcon[_vm.userType.type].marginLeft],attrs:{src:_vm.userTypeIcon[_vm.userType.type].icon,iconClass:"icon text-center fc-fill-path fill-path-white "+_vm.userTypeIcon[_vm.userType.type].iconSize}})],1)],1),_c("div",{staticClass:"flex-middle"},[_vm.$validation.isObject(_vm.typeLabel)?_c("span",{staticClass:"q-item-label d-flex flex-wrap"},[_vm._v(" "+_vm._s(_vm.typeLabel.value)+"Â  "),_vm.typeLabel.type?_c("span",{staticClass:"text-fc-grey mL5"},[_vm._v(" ("+_vm._s(_vm.typeLabel.type)+") ")]):_vm._e()]):_c("span",{staticClass:"q-item-label d-flex flex-wrap user-type"},[_vm._v(" "+_vm._s(_vm.typeLabel)+" ")]),_vm.approvers.length>1?_c("el-popover",{attrs:{placement:"bottom",width:"200",trigger:"hover"}},[_vm._t("default",(function(){return[_c("div",{staticClass:"approvers-more-icon"},[_vm._v("+"+_vm._s(_vm.approvers.length-1))])]}),{slot:"reference"}),_c("div",_vm._l(_vm.approvers.slice(1),(function(approver){return _c("div",{key:approver.name,staticClass:"mB10"},[_c("ApprovalUserAvatar",{attrs:{size:"md",user:approver,userType:_vm.getApproverType(approver),moduleName:_vm.moduleName,approvalMeta:_vm.approvalMeta}})],1)})),0)],2):_vm._e()],1)])])},staticRenderFns=[],validation=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(434284),__webpack_require__(990260)),User=__webpack_require__(426803),ApprovalUserAvatarvue_type_script_lang_js={name:"ApprovalUserAvatar",extends:User/* default */.Z,props:["userType","approvalMeta","approverObj"],computed:{hasUser:function(){var id=this.$getProperty(this.userObj,"id");return!(0,validation/* isEmpty */.xb)(id)},fieldType:function(){var _this$userType=this.userType,type=_this$userType.type,value=_this$userType.value;return"FIELD"===type&&!(0,validation/* isEmpty */.xb)(value)},fieldTypeUserValue:function(){var fieldType=this.fieldType,userType=this.userType,value=userType.value;return fieldType?(0,validation/* isArray */.kJ)(value)&&!(0,validation/* isEmpty */.xb)(value)?value[0]:value:null},fieldName:function(){var approverObj=this.approverObj,approvalMeta=this.approvalMeta,_ref=approvalMeta||{},_ref$approvalList=_ref.approvalList,approvalList=void 0===_ref$approvalList?[]:_ref$approvalList;if(!(0,validation/* isEmpty */.xb)(approvalList)){var displayName=approvalList.find((function(list){return list.approverGroup===approverObj.approverGroup})).field.displayName;return displayName}return null},color:function(){return-1!==this.userObj.id||this.fieldType?"":this.group?"#c3c3c3":"#e3e3e3"},userTypeIcon:function(){var userIcon={TENANT:{icon:"svgs/tenant",background:"green",iconSize:"icon-lg",marginLeft:"mL4"},VENDOR:{icon:"svgs/apps/vendor",background:"orange",iconSize:"icon-lg",marginLeft:"mL4"},ROLE:{icon:"svgs/role",background:"yellow",iconSize:"icon-xl",marginLeft:"mL3"},GROUP:{icon:"svgs/team",background:"blue",iconSize:"icon-xl",marginLeft:"mL3"},FIELD:{icon:"user",background:"brown",iconSize:"icon-lg",marginLeft:"mL4"}};return userIcon},typeLabel:function(){var _this$userType2=this.userType,type=_this$userType2.type,value=_this$userType2.value;if("USER"===type)return{value:this.userObj.name,type:null};if("TENANT"===type)return value?{value:value.name,type:"Tenant"}:"Tenant";if("VENDOR"===type)return value?{value:value.name,type:"Vendor"}:"Vendor";if("FIELD"===type){var _ref2=this.fieldTypeUserValue||{},name=_ref2.name;return{value:name||this.fieldName,type:"Field"}}return value.name},approvers:function(){var _this$userType3=this.userType,type=_this$userType3.type,value=_this$userType3.value;return"USER"===type?[this.userObj]:(0,validation/* isArray */.kJ)(value)?value:[value]}},methods:{getApproverType:function(approver){return approver.id?{type:"USER",value:approver}:approver}}},components_ApprovalUserAvatarvue_type_script_lang_js=ApprovalUserAvatarvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_ApprovalUserAvatarvue_type_script_lang_js,render,staticRenderFns,!1,null,"443099a5",null)
/* harmony default export */,ApprovalUserAvatar=component.exports},
/***/706881:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return CurrencyPopOver}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/setup/organizationSetting/currency/CurrencyPopOver.vue?vue&type=template&id=434b446a&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_vm.showCurrencyField?_c("div",{staticClass:"d-flex"},[_vm.showInfo?_c("span",[_vm._v(_vm._s(_vm.getMultiCurrencyFieldValue||"---"))]):_vm._e(),_vm.showMultiCurrencyInfo?_c("el-popover",{attrs:{placement:"right",title:_vm.$t("setup.currency.rate"),width:"230",trigger:"hover",content:_vm.currencyContent,"open-delay":5,disabled:_vm.isEmpty(_vm.baseValue)}},[_vm.showInfo?_vm._e():_c("div",{class:[_vm.baseValue&&"pointer"],attrs:{slot:"reference"},slot:"reference"},[_c("div",[_vm._v(_vm._s(""+_vm.getMultiCurrencyFieldValue))]),_c("div",{staticClass:"f12"},[_vm._v(_vm._s(_vm.baseValue))])]),_vm.isBaseCode||!_vm.showInfo||_vm.hideInfoBtn?_vm._e():_c("fc-icon",{staticClass:"pointer info-position mL2",attrs:{slot:"reference",group:"dsm",name:"info",size:"13"},slot:"reference"})],1):_c("span",[_vm._v(_vm._s(_vm.getMultiCurrencyFieldValue||"---"))])],1):_c("span",[_vm._v("---")])])},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),objectSpread2=__webpack_require__(595082),validation=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(634338),__webpack_require__(434284),__webpack_require__(990260)),CurrencyUtil=__webpack_require__(15426),vuex_esm=__webpack_require__(420629),CurrencyPopOvervue_type_script_lang_js={props:["field","details","showInfo","hideInfoBtn"],data:function(){return{baseValue:"",isEmpty:validation/* isEmpty */.xb}},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({account:function(state){return state.account},currencyList:function(state){return state.activeCurrencies}})),{},{showMultiCurrencyInfo:function(){var _ref=this.multiCurrency||{},multiCurrencyEnabled=_ref.multiCurrencyEnabled;return multiCurrencyEnabled},isBaseCode:function(){var _ref2=this.multiCurrency||{},baseCode=_ref2.currencyCode,_ref3=this.details||{},currencyCode=_ref3.currencyCode;return baseCode===currencyCode},showCurrencyField:function(){var currencyValue=this.currencyValue;return!(0,validation/* isEmpty */.xb)(currencyValue)&&"---"!=currencyValue},multiCurrency:function(){var _ref4=this.$getProperty(this.account,"data.currencyInfo")||{},displaySymbol=_ref4.displaySymbol,currencyCode=_ref4.currencyCode,multiCurrencyEnabled=_ref4.multiCurrencyEnabled;return{displaySymbol:displaySymbol,currencyCode:currencyCode,multiCurrencyEnabled:multiCurrencyEnabled}},currencyContent:function(){var details=this.details,currencyValue=this.currencyValue,baseSymbol=this.multiCurrency.displaySymbol;if(!(0,validation/* isEmpty */.xb)(currencyValue)){var _ref5=details||{},exchangeRate=_ref5.exchangeRate,currencyCode=_ref5.currencyCode,currency=(this.currencyList||[]).find((function(currency){return currencyCode===currency.currencyCode}));if((0,validation/* isEmpty */.xb)(currency)||currency.displaySymbol===baseSymbol)return null;var _ref6=currency||{},displaySymbol=_ref6.displaySymbol,content="".concat(baseSymbol," 1 = ").concat(displaySymbol," ").concat(exchangeRate);return content}return"---"},currencyValue:function(){var details=this.details,field=this.field,_ref7=details||{},data=_ref7.data;return field.displayValue||details[field.name]||(null===data||void 0===data?void 0:data[field.name])},getMultiCurrencyFieldValue:function(){var currencyValue=this.currencyValue,showInfo=this.showInfo,_this$multiCurrency=this.multiCurrency,baseSymbol=_this$multiCurrency.displaySymbol,baseCode=_this$multiCurrency.currencyCode,multiCurrencyEnabled=_this$multiCurrency.multiCurrencyEnabled,_ref8=this.details||{},currencyCode=_ref8.currencyCode,exchangeRate=_ref8.exchangeRate,currency=(this.currencyList||[]).find((function(currency){return currencyCode===currency.currencyCode})),baseCurrency=(this.currencyList||[]).find((function(currency){return baseCode===currency.currencyCode}));if((0,validation/* isEmpty */.xb)(currency)&&!(0,validation/* isEmpty */.xb)(currencyValue))return"".concat(baseSymbol," ").concat(currencyValue);var _ref9=currency||{},displaySymbol=_ref9.displaySymbol;displaySymbol=(0,validation/* isEmpty */.xb)(displaySymbol)?baseSymbol:displaySymbol;var baseValue="";if(multiCurrencyEnabled&&baseCode!==currencyCode){var value=(0,CurrencyUtil/* getCurrencyInDecimalValue */.Jg)(currencyValue/exchangeRate,baseCurrency);baseValue="( ".concat(baseSymbol," ").concat(value," )")}return currencyValue=(0,CurrencyUtil/* getCurrencyInDecimalValue */.Jg)(currencyValue,currency),this.setBaseValue(baseValue),showInfo?"".concat(displaySymbol," ").concat(currencyValue," ").concat(baseValue):"".concat(displaySymbol," ").concat(currencyValue)}}),created:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.next=2,_this.$store.dispatch("getActiveCurrencyList");case 2:case"end":return _context.stop()}}),_callee)})))()},methods:{setBaseValue:function(value){this.baseValue=value}}},currency_CurrencyPopOvervue_type_script_lang_js=CurrencyPopOvervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(currency_CurrencyPopOvervue_type_script_lang_js,render,staticRenderFns,!1,null,"434b446a",null)
/* harmony default export */,CurrencyPopOver=component.exports},
/***/849452:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return Quotation}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/workorder/workorders/v3/widgets/Quotation.vue?vue&type=template&id=6eec332e
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_vm.isLoading?_c("div",{staticClass:"mT20 position-relative"},[_c("spinner",{attrs:{show:!0,size:80}})],1):_c("div",{staticClass:"overflow-y-scroll",class:[_vm.workorder.isQuotationNeeded?"mT10":"mT30","position-relative"]},[_c("div",[_vm.showMaintenanceCost?_vm._e():_c("div",{staticClass:"p20 pT10"},[_c("div",{staticClass:"fc-id11 text-uppercase"},[_vm._v(" MAINTENANCE COST ")]),_vm.showMaintenanceCost?_vm._e():_c("currency",{staticClass:"pT10 fc-black2-20",attrs:{value:_vm.$validation.isEmpty(_vm.workorder.totalCost)?0:_vm.workorder.totalCost}})],1),_vm.showMaintenanceCost?_c("WOMaintenanceCostCard",{attrs:{workorder:_vm.workorder,plannedMaintenance:_vm.plannedMaintenance,actualMaintenance:_vm.actualMaintenance,isLoading:_vm.isLoading},on:{updateActualGrossTotal:_vm.updateActualGrossTotal}}):_vm._e(),_vm.$validation.isEmpty(_vm.quotationList)&&_vm.workorder.isQuotationNeeded?_c("div",{staticClass:"fc-wo-create-quotation-link no-border-top-quote-btn mT5"},[_c("div",{staticClass:"fc-dark-blue3-13 bold",on:{click:_vm.redirectToQuotationForm}},[_c("i",{staticClass:"el-icon-plus pR5 fwBold"}),_vm._v(" "+_vm._s(_vm.$t("maintenance.wr_list.create_quote"))+" ")])]):_vm._e()],1),_vm.downloadUrl?_c("iframe",{staticClass:"hide",attrs:{src:_vm.downloadUrl}}):_vm._e(),_c("el-dialog",{staticClass:"fc-dialog-header-hide",attrs:{visible:_vm.dialogVisible,width:"80%"},on:{"update:visible":function($event){_vm.dialogVisible=$event}}},[_c("div",{staticClass:"fc-quotation-wo-action "},[_c("div",{staticClass:"bold fc-white-14 pR20 pointer",on:{click:function($event){return _vm.openQuotationSummary(_vm.quotationSummaryDetails)}}},[_c("i",{staticClass:"fa fa-external-link pR5",attrs:{"aria-hidden":"true"}}),_vm._v(" Go To Summary ")]),_c("div",{staticClass:"bold fc-white-14 pR20 pointer",on:{click:function($event){return _vm.downloadQuotation(_vm.quotationSummaryDetails)}}},[_c("inline-svg",{attrs:{src:"svgs/download2",iconClass:"icon vertical-text-top icon-xs fc-fill-path fill-path-white mR5"}}),_vm._v(" Download ")],1),_c("div",{staticClass:"fc-white-14 f20 pointer",on:{click:function($event){_vm.dialogVisible=!1}}},[_c("i",{staticClass:"el-icon-close"})])]),_vm.summaryLoading?_c("div",[_c("spinner",{attrs:{show:_vm.summaryLoading,size:80}})],1):_c("div",[_c("QuotationPreview",{attrs:{details:_vm.quotationSummaryDetails}})],1)]),_vm.$validation.isEmpty(_vm.quotationList)?_vm._e():_c("div",{staticClass:"mT20 position-relative"},[_c("div",{staticClass:"p20"},[_c("div",{staticClass:"fc-id11 text-uppercase pB10"},[_vm._v(" "+_vm._s(_vm.quoteTitle)+" ")]),_vm._l(_vm.quotationList,(function(record,index){return _c("div",{key:index,staticClass:"fc-wo-quote-card visibility-visible-actions pointer"},[_vm.isApprovalEnabled(record)?_c("div",{staticClass:"mT20 mB10 wo-quotation-approval-bar"},[_c("ApprovalBar",{key:record.id+"approval-bar",staticClass:"approval-bar-shadow",attrs:{moduleName:"quote",record:record,hideApprovers:!0},on:{onSuccess:function($event){return _vm.loadWorkorderQuotations(!0)},onFailure:function(){}}})],1):_vm._e(),record.customerType&&!_vm.isPortalApp?_c("div",{staticClass:"pT15"},[_c("el-tag",{staticClass:"fc-tag-status quote-type-tag",attrs:{size:"mini"}},[_vm._v(_vm._s(_vm.quoteTypes[record.customerType]))])],1):_vm._e(),_c("div",{staticClass:"items-baseline flex  justify-content-space"},[_c("div",{staticClass:"items-baseline flex width70"},[_c("div",{staticClass:"fc-black2-14 bold pR10 pB5"},[_vm._v(" "+_vm._s(record.subject)+" ")]),_c("el-tag",{staticClass:"fc-tag-status text-uppercase",class:_vm.getTicketStatusColor(record)},[_vm._v(_vm._s(_vm.getTicketStatusDetails(record).displayName))])],1),_c("div",{staticClass:"flex justify-content-end wo-quote-round-btn visibility-hide-actions width30"},[_c("el-button",{attrs:{round:"",icon:"el-icon-view",size:"small"},on:{click:function($event){return _vm.openQuotationPreview(record)}}}),_c("el-button",{attrs:{round:"",icon:"el-icon-download",size:"small"},on:{click:function($event){return _vm.downloadQuotation(record)}}}),_c("el-button",{attrs:{round:"",size:"small"},on:{click:function($event){return _vm.openQuotationSummary(record)}}},[_c("i",{staticClass:"fa fa-external-link",attrs:{"aria-hidden":"true"}})])],1)]),_c("div",{staticClass:"flex-middle justify-content-space pT10"},[_c("div",{staticClass:"fc-blue-label"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.wr_list.total_amount"))+" ")]),_c("div",[_c("currency",{staticClass:"fc-black-14 bold",attrs:{value:record.totalCost}})],1)]),_c("div",{staticClass:"flex-middle justify-content-space pT10"},[_c("div",{staticClass:"fc-blue-label"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.wr_list.bill_date"))+" ")]),_vm.$validation.isEmpty(record.billDate)?_vm._e():_c("div",{staticClass:"fc-black-14 bold"},[_vm._v(" "+_vm._s(_vm._f("formatDate")(record.billDate,!0))+" ")])])])}))],2),_vm.workorder.isQuotationNeeded?_c("div",{staticClass:"fc-wo-create-quotation-link"},[_c("div",{staticClass:"fc-dark-blue3-13 bold",on:{click:_vm.redirectToQuotationForm}},[_c("i",{staticClass:"el-icon-plus pR5 fwBold"}),_vm._v(" "+_vm._s(_vm.$t("maintenance.wr_list.create_quote"))+" ")])]):_vm._e()])],1),_vm.showMarkupDialog?_c("el-dialog",{staticClass:"agents-dialog fc-dialog-center-container fc-dialog-center-container-2",staticStyle:{"z-index":"9999999999"},attrs:{title:"Download Preferences",visible:_vm.showMarkupDialog,width:"40%","append-to-body":!0,"before-close":_vm.closemarkupDialog},on:{"update:visible":function($event){_vm.showMarkupDialog=$event}}},[_c("div",{staticClass:"label-txt-black line-height24"},[_c("el-checkbox",{model:{value:_vm.withMarkup,callback:function($$v){_vm.withMarkup=$$v},expression:"withMarkup"}},[_vm._v("Download With Markup Value")]),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-save f13 w100",on:{click:function($event){return _vm.downloadQuote(_vm.selectedRecord)}}},[_vm._v(_vm._s("Download"))])],1)],1)]):_vm._e()],1)},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),objectSpread2=__webpack_require__(595082),api=(__webpack_require__(976801),__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(434284),__webpack_require__(634338),__webpack_require__(659749),__webpack_require__(386544),__webpack_require__(648324),__webpack_require__(670560),__webpack_require__(538077),__webpack_require__(947522),__webpack_require__(879288),__webpack_require__(32284)),validation=__webpack_require__(990260),vuex_esm=__webpack_require__(420629),ApprovalBar=__webpack_require__(42525),QuotationPreviewParent=__webpack_require__(678958),FetchViewsMixin=__webpack_require__(646716),router=__webpack_require__(329435),relatedFieldUtil=__webpack_require__(850558),WOMaintenanceCostCardvue_type_template_id_b2fae1c4_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"wo-maintenance-cost"},[_c("div",{staticClass:"actuals-cost cost-detail"},[_c("div",{staticClass:"cost-header"},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.actuals_cost"))+" ")]),_c("div",{staticClass:"cost-info"},[_vm.checkForMultiCurrency("cost",_vm.metaFieldTypeMap)?_c("CurrencyPopOver",{attrs:{field:{displayValue:_vm.$getProperty(_vm.actualMaintenanceObj,"grossAmount",0)},details:_vm.workorder,showInfo:!0}}):_c("div",{staticClass:"cost"},[_vm._v(_vm._s(_vm.actualsGrossTotal))]),_c("div",{staticClass:"view-info",on:{click:function($event){return _vm.openInfo("actuals")}}},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.view_detail"))+" ")])],1)]),_c("div",{staticClass:"mT10 plans-cost cost-detail"},[_c("div",{staticClass:"cost-header plans"},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.plans_cost"))+" ")]),_c("div",{staticClass:"cost-info"},[_vm.checkForMultiCurrency("cost",_vm.metaFieldTypeMap)?_c("CurrencyPopOver",{attrs:{field:{displayValue:_vm.$getProperty(_vm.plannedMaintenance,"grossAmount",0)},details:_vm.workorder,showInfo:!0}}):_c("div",{staticClass:"cost plans"},[_vm._v(_vm._s(_vm.plansGrossTotal))]),_c("div",{staticClass:"view-info",on:{click:function($event){return _vm.openInfo("plans")}}},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.view_detail"))+" ")])],1)]),_vm.showDetails?_c("CostInfo",{attrs:{details:_vm.workorder,costType:_vm.costType,costDetails:_vm.costDetails,showDetails:_vm.showDetails,isLoading:_vm.isLoading},on:{updateAdditionalCost:_vm.updateAdditionalCost,closeInfo:_vm.closeInfo}}):_vm._e()],1)},WOMaintenanceCostCardvue_type_template_id_b2fae1c4_scoped_true_staticRenderFns=[],toConsumableArray=__webpack_require__(488478),WOCostDetailsCardvue_type_template_id_0ca729c3_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"fc-dialog-center wo-maintenance-cost-info",attrs:{visible:_vm.showDetails,title:_vm.dialogTitle,width:"35%","before-close":_vm.closeInfo}},[_c("div",{staticClass:"cost-info-dialog"},[_vm.isLoading?_c("div",{staticClass:"mT20 position-relative"},[_c("spinner",{attrs:{show:!0,size:80}})],1):_c("div",[_vm._l(_vm.fixedCostInfo,(function(key,label){return _c("div",{key:label,staticClass:"wo-planned-cost display-flex-between-space"},[_c("div",{staticClass:"cost-name pL20 pB10 pT15"},[_vm._v(_vm._s(label))]),_c("div",{staticClass:"cost-value pR20  pB10 pT15 d-flex mR20"},[_c("span",{staticClass:"pR16"},[_vm._v(" "+_vm._s(_vm.getCostWithCurrency(key))+" ")])])])})),_vm.actualCost?[_vm.$validation.isEmpty(_vm.customCostInfo)?_vm._e():_c("div",{staticClass:"cost-seperator-line"}),_vm._l(_vm.customCostInfo,(function(cost,index){return _c("div",{key:"cost-"+index,staticClass:"custom-wo-cost display-flex-between-space"},[_c("div",{staticClass:"cost-name pL20 pB10 pT15"},[_vm._v(" "+_vm._s(_vm.$getProperty(cost,"name","---"))+" ")]),_c("div",{staticClass:"cost-value pR20  pB10 pT15 d-flex visibility-visible-actions"},[_c("span",[_vm._v(" "+_vm._s(_vm.getCostWithCurrency(_vm.$getProperty(cost,"cost",0)))+" ")]),_c("fc-icon",{staticClass:"mL5 visibility-hide-actions pointer",attrs:{group:"action",name:"delete",size:"16"},on:{click:function($event){return _vm.deleteCustomCost(cost,index)}}})],1)])})),_c("div",{staticClass:"cost-seperator-line"})]:_c("div",{staticClass:"cost-seperator-line"}),_c("div",{staticClass:"custom-wo-cost total-cost  display-flex-between-space"},[_c("div",{staticClass:"cost-name pL20 pB10 pT15 bold f14"},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.total_cost"))+" ")]),_c("div",{staticClass:"cost-value pR20  pB10 pT15 bold f14 mR20"},[_vm._v(" "+_vm._s(_vm.totalCost)+" ")])])],2),_c("div",{staticClass:"modal-dialog-footer wo-maintenance-cost-info-footer",class:_vm.footerClassName},[_vm.actualCost?_c("div",{staticClass:"pL20 pB20 pT15 add-addnl-cost",on:{click:function($event){return _vm.addAdditionalCost()}}},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.add_addn_cost"))+" ")]):_vm._e(),_c("div",{staticClass:"pR20 pB20 pT5"},[_c("el-button",{staticClass:"wo-maintenance-cost-info-done",attrs:{type:"primary"},on:{click:_vm.closeInfo}},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.close")))])],1)]),_c("AddAdditionalCost",{attrs:{additionalCostDialogVisibility:_vm.additionalCostDialogVisibility,details:_vm.details},on:{saveAdditionalCost:_vm.saveAdditionalCost,closeAdditionalCost:_vm.closeAdditionalCost}})],1)])},WOCostDetailsCardvue_type_template_id_0ca729c3_scoped_true_staticRenderFns=[],AddAdditionalCostvue_type_template_id_24fa5506_scoped_true_render=(__webpack_require__(162506),function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{attrs:{visible:_vm.additionalCostDialogVisibility,width:"40%",fullscreen:!1,"append-to-body":!0,"before-close":_vm.closeDialog}},[_c("template",{slot:"title"},[_c("div",{staticClass:"label-txt-black fw-bold text-uppercase fL"},[_vm._v(" "+_vm._s(_vm.$t("common.workorder_actuals.additional_cost"))+" ")])]),_c("div",[_c("div",{staticClass:"headers"},[_c("div",{staticClass:"cost-name"},[_vm._v(" "+_vm._s(_vm.$t("common.workorder_actuals.cost_name"))+" "),_c("span",{staticClass:"mandatory"},[_vm._v(" * ")])]),_c("div",{staticClass:"pL142"},[_vm._v(" "+_vm._s(_vm.$t("common.workorder_actuals.cost"))+" "),_c("span",{staticClass:"mandatory"},[_vm._v(" * ")])])]),_c("div",{staticClass:"overflow-y-scroll max-height-275 pL15"},_vm._l(_vm.additionalCosts,(function(additionalCost,index){return _c("div",{key:index,staticClass:"flex"},[_c("div",{staticClass:"cost-common-wrap"},[_c("div",{staticClass:"cost-name-wrap"},[_c("div",[_c("el-input",{staticClass:"fc-input-full-border2 width200px",attrs:{placeholder:_vm.$t("common.workorder_actuals.enter_name")},model:{value:additionalCost.name,callback:function($$v){_vm.$set(additionalCost,"name",$$v)},expression:"additionalCost.name"}})],1)]),_c("div",{staticClass:"cost-name-wrap"},[_c("div",{staticStyle:{display:"flex"}},[_c("div",{staticClass:"currency"},[_vm._v(" "+_vm._s(""+(_vm.recordCurrency||_vm.$currency))+" ")]),_c("div",[_c("el-input",{staticClass:"fc-input-full-border2 width200px",attrs:{type:"number",placeholder:_vm.$t("common.workorder_actuals.enter_price")},model:{value:additionalCost.cost,callback:function($$v){_vm.$set(additionalCost,"cost",$$v)},expression:"additionalCost.cost"}})],1)])])]),_c("div",{staticClass:"remove-icon"},[_vm.additionalCosts.length>1?_c("i",{staticClass:"el-icon-remove-outline fc-row-delete-icon f15 bold",on:{click:function($event){return _vm.removeAdditionalCost(index)}}}):_vm._e()])])})),0),_c("div",{staticClass:"pT20 pL15"},[_c("el-button",{staticClass:"line-item-list-footer-add-btn",attrs:{type:"primary"},on:{click:function($event){return _vm.newAdditionalCost()}}},[_c("i",{staticClass:"el-icon-plus plus-icon"}),_vm._v(" "+_vm._s(_vm.$t("common.workorder_actuals.add"))+" ")])],1)]),_c("div",{staticClass:"footer-btns"},[_c("el-button",{staticClass:"save-btn",attrs:{type:"primary"},on:{click:function($event){return _vm.saveRecords()}}},[_vm._v(" "+_vm._s(_vm.$t("common.workorder_actuals.save")))]),_c("el-button",{staticClass:"cancel-btn",attrs:{type:"primary"},on:{click:function($event){return _vm.closeDialog()}}},[_vm._v(" "+_vm._s(_vm.$t("common.workorder_actuals.cancel")))])],1)],2)}),AddAdditionalCostvue_type_template_id_24fa5506_scoped_true_staticRenderFns=[],cloneDeep=(__webpack_require__(450886),__webpack_require__(150361)),cloneDeep_default=__webpack_require__.n(cloneDeep),CurrencyUtil=__webpack_require__(15426),AddAdditionalCostvue_type_script_lang_js={name:"AdditionalCost",props:["additionalCostDialogVisibility","details"],data:function(){return{additionalCosts:[{name:null,cost:null}]}},computed:{recordCurrency:function(){var _ref=this.details||{},currencyCode=_ref.currencyCode,recordCurrency=(0,CurrencyUtil/* getCurrencyForCurrencyCode */.Dg)(currencyCode);return recordCurrency}},methods:{newAdditionalCost:function(){var additionalCosts=this.additionalCosts,additionalCost={name:null,cost:null};additionalCosts.push(cloneDeep_default()(additionalCost)),this.additionalCosts=additionalCosts},removeAdditionalCost:function(index){var additionalCosts=this.additionalCosts;additionalCosts.splice(index,1)},saveRecords:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var _ref2,additionalCosts,details,_ref3,id,currencyCode,exchangeRate,workorderCost,url,params,_yield$API$post,error,data,_ref6,_workorderCost;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(_ref2=_this||{},additionalCosts=_ref2.additionalCosts,details=_ref2.details,_ref3=details||{},id=_ref3.id,currencyCode=_ref3.currencyCode,exchangeRate=_ref3.exchangeRate,additionalCosts=additionalCosts.filter((function(element){var _ref4=element||{},name=_ref4.name,cost=_ref4.cost;return!(0,validation/* isEmpty */.xb)(name)&&!(0,validation/* isEmpty */.xb)(cost)})),(0,validation/* isEmpty */.xb)(additionalCosts)){_context.next=15;break}return workorderCost=additionalCosts.map((function(element){var _ref5=element||{},name=_ref5.name,cost=_ref5.cost;return{name:name,cost:cost,parentId:{id:id},costType:5,currencyCode:currencyCode,exchangeRate:exchangeRate}})),url="v3/modules/bulkCreate/workorderCost",params={data:{workorderCost:workorderCost},moduleName:"workorderCost"},_context.next=9,api/* API */.bl.post(url,params);case 9:_yield$API$post=_context.sent,error=_yield$API$post.error,data=_yield$API$post.data,error?_this.$message.error(error.message||_this.$t("common._common.error_occured")):(_this.$message.success(_this.$t("common.workorder_actuals.add_cost_added_success")),_this.resetAdditionalCosts(),_ref6=data||{},_workorderCost=_ref6.workorderCost,_this.$emit("saveAdditionalCost",_workorderCost)),_context.next=16;break;case 15:_this.$message.error(_this.$t("common.workorder_actuals.please_add_additional_cost"));case 16:case"end":return _context.stop()}}),_callee)})))()},closeDialog:function(){this.$emit("closeAdditionalCost")},resetAdditionalCosts:function(){var resetAdditionalCosts=[{name:null,cost:null}];this.$set(this,"additionalCosts",resetAdditionalCosts)}}},widgets_AddAdditionalCostvue_type_script_lang_js=AddAdditionalCostvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(widgets_AddAdditionalCostvue_type_script_lang_js,AddAdditionalCostvue_type_template_id_24fa5506_scoped_true_render,AddAdditionalCostvue_type_template_id_24fa5506_scoped_true_staticRenderFns,!1,null,"24fa5506",null)
/* harmony default export */,AddAdditionalCost=component.exports,WOCostDetailsCardvue_type_script_lang_js={name:"WOCostDetailsCard",props:["details","showDetails","costType","costDetails","isLoading"],components:{AddAdditionalCost:AddAdditionalCost},data:function(){return{additionalCostDialogVisibility:!1}},computed:{dialogTitle:function(){var costType=this.costType;return"plans"===costType?this.$t("maintenance._workorder.plans_cost"):this.$t("maintenance._workorder.actuals_cost")},actualCost:function(){var costType=this.costType;return"actuals"===costType},footerClassName:function(){var actualCost=this.actualCost;return actualCost?"justify-content-space":"justify-content-end"},fixedCostInfo:function(){var costDetails=this.costDetails,_ref=costDetails||{},Labour=_ref.Labour,Items=_ref.Items,Tools=_ref.Tools,Services=_ref.Services;return{Labour:Labour,Items:Items,Tools:Tools,Services:Services}},customCostInfo:function(){var costDetails=this.costDetails,_ref2=costDetails||{},customCostList=_ref2.customCostList;return customCostList},totalCost:function(){var costDetails=this.costDetails,$currency=this.$currency,workorderCurrency=this.workorderCurrency,_ref3=costDetails||{},grossAmount=_ref3.grossAmount;return"".concat(workorderCurrency||$currency," ").concat(grossAmount)},workorderCurrency:function(){var _ref4=this.details||{},currencyCode=_ref4.currencyCode,woCurrency=(0,CurrencyUtil/* getCurrencyForCurrencyCode */.Dg)(currencyCode);return woCurrency}},methods:{getCostWithCurrency:function(cost){var $currency=this.$currency,workorderCurrency=this.workorderCurrency;return"".concat(workorderCurrency||$currency," ").concat(cost)},closeInfo:function(){this.$emit("closeInfo")},addAdditionalCost:function(){this.additionalCostDialogVisibility=!0},saveAdditionalCost:function(costList){this.additionalCosts=costList,this.$emit("updateAdditionalCost",{costList:costList,skipOldValues:!1}),this.additionalCostDialogVisibility=!1},deleteCustomCost:function(cost,index){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var _ref5,id,moduleName,_yield$API$deleteReco,error,customCostInfo;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _ref5=cost||{},id=_ref5.id,moduleName="workorderCost",_context.next=4,api/* API */.bl.deleteRecord(moduleName,id);case 4:_yield$API$deleteReco=_context.sent,error=_yield$API$deleteReco.error,error?_this.$message.error(error.message||_this.$t("common._common.error_occured")):(_this.$message.success(_this.$t("common.workorder_actuals.add_cost_deleted_success")),customCostInfo=_this.customCostInfo,customCostInfo.splice(index,1),_this.$emit("updateAdditionalCost",{costList:customCostInfo,skipOldValues:!0}));case 7:case"end":return _context.stop()}}),_callee)})))()},closeAdditionalCost:function(){this.additionalCosts=[{name:null,cost:null}],this.additionalCostDialogVisibility=!1}}},widgets_WOCostDetailsCardvue_type_script_lang_js=WOCostDetailsCardvue_type_script_lang_js,WOCostDetailsCard_component=(0,componentNormalizer/* default */.Z)(widgets_WOCostDetailsCardvue_type_script_lang_js,WOCostDetailsCardvue_type_template_id_0ca729c3_scoped_true_render,WOCostDetailsCardvue_type_template_id_0ca729c3_scoped_true_staticRenderFns,!1,null,"0ca729c3",null)
/* harmony default export */,WOCostDetailsCard=WOCostDetailsCard_component.exports,CurrencyPopOver=__webpack_require__(706881),WOMaintenanceCostCardvue_type_script_lang_js={name:"WOMaintenanceCostCard",props:["workorder","plannedMaintenance","actualMaintenance","isLoading"],data:function(){return{showDetails:!1,costType:null,costDetails:{},actualMaintenanceObj:{itemCost:null,toolCost:null,serviceCost:null,grossAmount:null},metaFieldTypeMap:{},checkForMultiCurrency:CurrencyUtil/* checkForMultiCurrency */.eu}},components:{CostInfo:WOCostDetailsCard,CurrencyPopOver:CurrencyPopOver/* default */.Z},computed:{plansGrossTotal:function(){var $currency=this.$currency,plannedMaintenance=this.plannedMaintenance,workorderCurrency=this.workorderCurrency,grossAmount=this.$getProperty(plannedMaintenance,"grossAmount",0);return"".concat(workorderCurrency||$currency," ").concat(grossAmount)},actualsGrossTotal:function(){var $currency=this.$currency,actualMaintenanceObj=this.actualMaintenanceObj,workorderCurrency=this.workorderCurrency,grossAmount=this.$getProperty(actualMaintenanceObj,"grossAmount",0);return"".concat(workorderCurrency||$currency," ").concat(grossAmount)},workorderCurrency:function(){var _ref=this.workorder||{},currencyCode=_ref.currencyCode;return(0,CurrencyUtil/* getCurrencyForCurrencyCode */.Dg)(currencyCode)}},created:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _this.init(),_context.next=3,(0,CurrencyUtil/* getMetaFieldMapForModules */.en)("workorderCost");case 3:_this.metaFieldTypeMap=_context.sent;case 4:case"end":return _context.stop()}}),_callee)})))()},watch:{actualMaintenance:{handler:function(newVal){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var costType;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:costType=_this2.costType,_this2.actualMaintenanceObj=newVal||{},"actuals"===costType&&(_this2.costDetails=newVal||{});case 3:case"end":return _context2.stop()}}),_callee2)})))()},deep:!0}},methods:{init:function(){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var actualMaintenance;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:actualMaintenance=_this3.actualMaintenance,_this3.actualMaintenanceObj=actualMaintenance||{};case 2:case"end":return _context3.stop()}}),_callee3)})))()},openInfo:function(type){var plannedMaintenance=this.plannedMaintenance,actualMaintenanceObj=this.actualMaintenanceObj;this.costType=type,this.costDetails="plans"===type?plannedMaintenance:actualMaintenanceObj,this.showDetails=!0},updateAdditionalCost:function(_ref2){var costList=_ref2.costList,skipOldValues=_ref2.skipOldValues,actualMaintenanceObj=this.actualMaintenanceObj,_ref3=actualMaintenanceObj||{},customCostList=_ref3.customCostList;customCostList=skipOldValues?costList:[].concat((0,toConsumableArray/* default */.Z)(customCostList),(0,toConsumableArray/* default */.Z)(costList));var _actualMaintenanceObj=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},actualMaintenanceObj),{},{customCostList:customCostList});this.actualMaintenanceObj=_actualMaintenanceObj,this.costDetails=_actualMaintenanceObj,this.$emit("updateActualGrossTotal",_actualMaintenanceObj)},closeInfo:function(){this.showDetails=!1,this.costType=null,this.costDetails=null}}},v3_WOMaintenanceCostCardvue_type_script_lang_js=WOMaintenanceCostCardvue_type_script_lang_js,WOMaintenanceCostCard_component=(0,componentNormalizer/* default */.Z)(v3_WOMaintenanceCostCardvue_type_script_lang_js,WOMaintenanceCostCardvue_type_template_id_b2fae1c4_scoped_true_render,WOMaintenanceCostCardvue_type_template_id_b2fae1c4_scoped_true_staticRenderFns,!1,null,"b2fae1c4",null)
/* harmony default export */,WOMaintenanceCostCard=WOMaintenanceCostCard_component.exports,Quotationvue_type_script_lang_js={name:"Quotation",components:{ApprovalBar:ApprovalBar/* default */.Z,QuotationPreview:QuotationPreviewParent["default"],WOMaintenanceCostCard:WOMaintenanceCostCard},mixins:[FetchViewsMixin/* default */.Z],props:["moduleName","details"],data:function(){return{vendor:null,quoteFormsList:[],quotationList:{},downloadUrl:null,isLoading:!1,summaryLoading:!0,dialogVisible:!1,quotationSummaryDetails:{},plannedMaintenance:{plannedToolsCost:null,plannedItemsCost:null,plannedServicesCost:null,plannedLabourCost:null,grossAmount:null},actualMaintenance:{itemCost:null,toolCost:null,serviceCost:null,grossAmount:null},quoteTypes:{1:"Tenant Quote",2:"Client Quote",3:"Other Quote",4:"Vendor Quote"},withMarkup:!0,showMarkupDialog:!1,selectedRecord:null}},created:function(){this.init(),this.$store.dispatch("loadTicketStatus","quote")},mounted:function(){this.loadQuoteDependencies()},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({isPortalApp:function(){return["tenant","occupant","client","vendor"].includes((0,router/* getApp */.wx)().linkName||null)},getCustomerTypeByApp:function(){return"tenant"===(0,router/* getApp */.wx)().linkName?"1":"client"===(0,router/* getApp */.wx)().linkName?"2":"vendor"===(0,router/* getApp */.wx)().linkName?"4":"occupant"===(0,router/* getApp */.wx)().linkName?"3":null},isVendorWorkorder:function(){var _this$details,isVendorQuoteForm=!1,vendorForm=this.quoteFormsList.find((function(rt){return"vendorquoteform"===rt.name?rt:null}));return isVendorQuoteForm=!(null===vendorForm||void 0===vendorForm||!vendorForm.id),!(null===(_this$details=this.details)||void 0===_this$details||null===(_this$details=_this$details.workorder)||void 0===_this$details||null===(_this$details=_this$details.vendor)||void 0===_this$details||!_this$details.id||!isVendorQuoteForm)},getRedirectFormId:function(){var _workorder$vendor,_this$details$workord=this.details.workorder,workorder=void 0===_this$details$workord?null:_this$details$workord;if(null!==workorder&&void 0!==workorder&&null!==(_workorder$vendor=workorder.vendor)&&void 0!==_workorder$vendor&&_workorder$vendor.id){if(this.quoteFormsList&&this.quoteFormsList.length){var vendorForm=this.quoteFormsList.find((function(rt){return"vendorquoteform"===rt.name?rt:null}));if(null!==vendorForm&&void 0!==vendorForm&&vendorForm.id)return vendorForm.id}}else if(this.quoteFormsList.length&&this.quoteFormsList[0]&&this.quoteFormsList[0].id)return this.quoteFormsList[0].id;return null}},(0,vuex_esm/* mapGetters */.Se)(["getTicketStatus"])),{},{currModuleName:function(){return"workorder"},widgetTitle:function(){return"Quotation"},workorder:function(){return this.details.workorder},showMaintenanceCost:function(){var $helpers=this.$helpers,_ref=$helpers||{},isLicenseEnabled=_ref.isLicenseEnabled;return isLicenseEnabled("PLANNED_INVENTORY")&&isLicenseEnabled("INVENTORY")},showQuote:function(){var $helpers=this.$helpers,_ref2=$helpers||{},isLicenseEnabled=_ref2.isLicenseEnabled;return isLicenseEnabled("QUOTATION")},quoteTitle:function(){var quotationList=this.quotationList;return(quotationList||[]).length>1?this.$t("maintenance.wr_list.quotes"):this.$t("maintenance.wr_list.quote")}}),methods:{canShowMarkup:function(record){return(null===record||void 0===record?void 0:record.showMarkupValue)||!1},loadQuoteDependencies:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.next=2,_this.loadQuoteForms();case 2:if(!_this.isVendorWorkorder){_context.next=5;break}return _context.next=5,_this.loadVendorData();case 5:case"end":return _context.stop()}}),_callee)})))()},loadVendorData:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var param,_yield$API$get,data;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return param={moduleName:"vendors",id:_this2.details.workorder.vendor.id},_context2.next=3,api/* API */.bl.get("/v3/modules/data/summary",param);case 3:_yield$API$get=_context2.sent,data=_yield$API$get.data,null!==data&&void 0!==data&&data.vendors&&(_this2.vendor=data.vendors);case 6:case"end":return _context2.stop()}}),_callee2)})))()},loadQuoteForms:function(){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var url,_yield$API$get2,data,error,message,_ref3,_ref3$forms,forms;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return url="/v2/forms?moduleName=".concat("quote"),_context3.next=3,api/* API */.bl.get(url);case 3:_yield$API$get2=_context3.sent,data=_yield$API$get2.data,error=_yield$API$get2.error,error?(message=error.message,_this3.$message.error(message)):(_ref3=data||{},_ref3$forms=_ref3.forms,forms=void 0===_ref3$forms?[]:_ref3$forms,_this3.quoteFormsList=forms);case 7:case"end":return _context3.stop()}}),_callee3)})))()},init:function(){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){var showMaintenanceCost,showQuote;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:if(_this4.isLoading=!0,showMaintenanceCost=_this4.showMaintenanceCost,showQuote=_this4.showQuote,!showQuote){_context4.next=5;break}return _context4.next=5,_this4.loadWorkorderQuotations();case 5:if(!showMaintenanceCost){_context4.next=10;break}return _context4.next=8,_this4.loadPlansCost();case 8:return _context4.next=10,_this4.loadActualsCost();case 10:_this4.isLoading=!1;case 11:case"end":return _context4.stop()}}),_callee4)})))()},pdfUrl:function(record){var appName=(0,router/* getApp */.wx)().linkName;return this.canShowMarkup(record)&&this.withMarkup?"".concat(window.location.protocol,"//").concat(window.location.host,"/").concat(appName,"/pdf/quotationpdf?quotationId=").concat(record.id,"&withmarkup=true"):this.canShowMarkup(record)&&!this.withMarkup?"".concat(window.location.protocol,"//").concat(window.location.host,"/").concat(appName,"/pdf/quotationpdf?quotationId=").concat(record.id,"&withmarkup=false"):"".concat(window.location.protocol,"//").concat(window.location.host,"/").concat(appName,"/pdf/quotationpdf?quotationId=").concat(record.id)},isApprovalEnabled:function(record){var _ref4=record||{},approvalFlowId=_ref4.approvalFlowId,approvalStatus=_ref4.approvalStatus;return!(0,validation/* isEmpty */.xb)(approvalFlowId)&&!(0,validation/* isEmpty */.xb)(approvalStatus)},updateWorkorder:function(val){var _this5=this,updateObj={id:[this.workorder.id],fields:{isQuotationNeeded:val}};this.isLoading=!0,this.$store.dispatch("workorder/updateWorkOrder",updateObj).then((function(){_this5.$message.success(_this5.$t("maintenance._workorder.wo_update_success")),_this5.isLoading=!1})).catch((function(){_this5.$message.error(_this5.$t("maintenance._workorder.wo_update_failed"))}))},getTicketStatusDetails:function(record){return this.getTicketStatus(this.$getProperty(record,"moduleState.id",-1),"quote")||{}},loadWorkorderQuotations:function(){var _arguments=arguments,_this6=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee5(){var force,workorder,_ref5,id,relatedFieldName,relatedConfig,_yield$API$fetchAllRe,error,list;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context5){while(1)switch(_context5.prev=_context5.next){case 0:return force=_arguments.length>0&&void 0!==_arguments[0]&&_arguments[0],workorder=_this6.workorder,_ref5=workorder||{},id=_ref5.id,relatedFieldName=(0,relatedFieldUtil/* getRelatedFieldName */.C9)("workorder","quote"),relatedConfig={moduleName:"workorder",id:id,relatedModuleName:"quote",relatedFieldName:relatedFieldName},_context5.next=7,api/* API */.bl.fetchAllRelatedList(relatedConfig,{},{force:force});case 7:_yield$API$fetchAllRe=_context5.sent,error=_yield$API$fetchAllRe.error,list=_yield$API$fetchAllRe.list,error?_this6.$error.message(error.message||"Error Occured"):(0,validation/* isEmpty */.xb)(list)||(_this6.quotationList=list);case 11:case"end":return _context5.stop()}}),_callee5)})))()},copyAddressValueTo:function(address){var billToAddress={};address=this.$helpers.cloneObject(address);var loactionKeys=["street","city","state","zip","lat","lng","country"];return loactionKeys.forEach((function(key){billToAddress[key]=address[key];
// this.$set(billToAddress, key, address[key])
})),billToAddress},redirectToQuotationForm:function(){var _this$vendor,url="/app/tm/quotation/new",query={workorder:this.workorder.id,workorderLabel:this.workorder.subject};((0,validation/* isEmpty */.xb)(this.$getProperty(this.workorder,"tenant.id",-1))||(query["customerType"]=1,query["tenant"]=this.workorder.tenant.id,query["tenantLabel"]=this.workorder.tenant.name),(0,validation/* isEmpty */.xb)(this.$getProperty(this.workorder,"client.id",-1))||(query["customerType"]=2,query["client"]=this.workorder.client.id,query["clientLabel"]=this.workorder.client.name),(0,validation/* isEmpty */.xb)(this.workorder.siteId)||(query["siteId"]=this.workorder.siteId),320===this.$account.org.id?((0,validation/* isEmpty */.xb)(this.workorder.data)||(0,validation/* isEmpty */.xb)(this.workorder.data.unit)||(query["unit"]=this.workorder.data.unit.id,query["unitLabel"]=this.workorder.data.unit.name),(0,validation/* isEmpty */.xb)(this.workorder.resource)||(0,validation/* isEmpty */.xb)(this.workorder.resource.building)||(query["building"]=this.workorder.resource.building.id,query["buildingLabel"]=this.workorder.resource.name)):(query["subject"]=this.workorder.subject,query["description"]=this.workorder.description),this.isVendorWorkorder)&&(query["vendor"]=this.workorder.vendor.id,null!==(_this$vendor=this.vendor)&&void 0!==_this$vendor&&_this$vendor.address&&(query["billToAddress"]=JSON.stringify(this.copyAddressValueTo(this.vendor.address))),query["customerType"]=4);if((0,router/* isWebTabsEnabled */.tj)()){this.getRedirectFormId&&(query["formId"]=this.getRedirectFormId);var _ref6=(0,router/* findRouteForModule */.Jp)("quote",router/* pageTypes */.As.CREATE)||{},name=_ref6.name;name&&this.$router.push({name:name,query:query})}else this.$router.push({path:url,query:query})},openQuotationPreview:function(record){var _this7=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee6(){var _yield$API$fetchRecor,quote,error,_error$message,message;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context6){while(1)switch(_context6.prev=_context6.next){case 0:return _this7.dialogVisible=!0,_this7.summaryLoading=!0,_context6.next=4,api/* API */.bl.fetchRecord("quote",{id:(record||{}).id});case 4:_yield$API$fetchRecor=_context6.sent,quote=_yield$API$fetchRecor.quote,error=_yield$API$fetchRecor.error,(0,validation/* isEmpty */.xb)(error)?_this7.quotationSummaryDetails=quote:(_error$message=error.message,message=void 0===_error$message?"Error Occured while fetching Quote":_error$message,_this7.$message.error(message)),_this7.summaryLoading=!1;case 9:case"end":return _context6.stop()}}),_callee6)})))()},downloadQuotation:function(record){this.selectedRecord=null,this.showMarkupDialog=!1,this.canShowMarkup(record)?(this.selectedRecord=record,this.showMarkupDialog=!0):this.downloadQuote(record)},closemarkupDialog:function(){this.showMarkupDialog=!1,this.selectedRecord=!1},downloadQuote:function(record){var _this8=this;this.closemarkupDialog(),this.downloadUrl=null,this.$message({message:"Downloading...",showClose:!0,duration:0}),api/* API */.bl.post("/v2/integ/pdf/create",{url:this.pdfUrl(record)}).then((function(_ref7){var data=_ref7.data,error=_ref7.error;if(_this8.$message.closeAll(),error){var _error$message2=error.message,message=void 0===_error$message2?"Unable to fetch quote download link":_error$message2;_this8.$message.error(message)}else{var _ref8=data||{},fileUrl=_ref8.fileUrl;_this8.downloadUrl=fileUrl||null}_this8.withMarkup=!0}))},openQuotationSummary:function(_ref9){var _this9=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee7(){var id,routerPath,viewname,_ref10,name,_ref11,href;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context7){while(1)switch(_context7.prev=_context7.next){case 0:if(id=_ref9.id,routerPath="",!(0,router/* isWebTabsEnabled */.tj)()){_context7.next=10;break}return _context7.next=5,_this9.fetchView("quote");case 5:viewname=_context7.sent,_ref10=(0,router/* findRouteForModule */.Jp)("quote",router/* pageTypes */.As.OVERVIEW)||{},name=_ref10.name,name&&(_ref11=_this9.$router.resolve({name:name,params:{viewname:viewname,id:id}})||{},href=_ref11.href,routerPath=href),_context7.next=11;break;case 10:routerPath=_this9.$router.resolve({path:"/app/tm/quotation/all/".concat(id,"/overview")}).href;case 11:window.open(routerPath,"_blank");case 12:case"end":return _context7.stop()}}),_callee7)})))()},loadPlansCost:function(){var _this10=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee8(){var workorder,_ref12,id,url,params,_yield$API$get3,data,error,message,_ref13,plannedToolsCost,plannedItemsCost,plannedServicesCost,plannedLabourCost,grossAmount;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context8){while(1)switch(_context8.prev=_context8.next){case 0:return workorder=_this10.workorder,_ref12=workorder||{},id=_ref12.id,url="/v3/workOrderPlansCost/cost",params={workOrderId:id},_context8.next=6,api/* API */.bl.get(url,params);case 6:_yield$API$get3=_context8.sent,data=_yield$API$get3.data,error=_yield$API$get3.error,error?(message=error.message,_this10.$message.error(message||_this10.$t("common._common.error_cost"))):(_ref13=data||{},plannedToolsCost=_ref13.plannedToolsCost,plannedItemsCost=_ref13.plannedItemsCost,plannedServicesCost=_ref13.plannedServicesCost,plannedLabourCost=_ref13.plannedLabourCost,grossAmount=plannedItemsCost+plannedToolsCost+plannedServicesCost+plannedLabourCost,_this10.plannedMaintenance={Labour:plannedLabourCost,Items:plannedItemsCost,Tools:plannedToolsCost,Services:plannedServicesCost,grossAmount:grossAmount});case 10:case"end":return _context8.stop()}}),_callee8)})))()},loadActualsCost:function(force){var _this11=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee9(){var workorder,_ref14,id,relatedFieldName,relatedConfig,_yield$API$fetchAllRe2,error,list,customCostList,laboursCostObj,itemsCostObj,toolsCostObj,servicesCostObj,labourCost,itemCost,toolCost,serviceCost,actualMaintenance;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context9){while(1)switch(_context9.prev=_context9.next){case 0:return workorder=_this11.workorder,_ref14=workorder||{},id=_ref14.id,relatedFieldName=(0,relatedFieldUtil/* getRelatedFieldName */.C9)("workorder","workorderCost"),relatedConfig={moduleName:"workorder",id:id,relatedModuleName:"workorderCost",relatedFieldName:relatedFieldName},_context9.next=6,api/* API */.bl.fetchAllRelatedList(relatedConfig,{},{force:force});case 6:_yield$API$fetchAllRe2=_context9.sent,error=_yield$API$fetchAllRe2.error,list=_yield$API$fetchAllRe2.list,(0,validation/* isEmpty */.xb)(error)?(customCostList=list.filter((function(element){return"custom"===element.costTypeEnum})),laboursCostObj=list.find((function(element){return"Labour"===element.costName})),itemsCostObj=list.find((function(element){return"Items"===element.costName})),toolsCostObj=list.find((function(element){return"Tools"===element.costName})),servicesCostObj=list.find((function(element){return"Service"===element.costName})),labourCost=_this11.$getProperty(laboursCostObj,"cost",0),itemCost=_this11.$getProperty(itemsCostObj,"cost",0),toolCost=_this11.$getProperty(toolsCostObj,"cost",0),serviceCost=_this11.$getProperty(servicesCostObj,"cost",0),actualMaintenance={Labour:labourCost,Items:itemCost,Tools:toolCost,Services:serviceCost,customCostList:customCostList},_this11.updateActualGrossTotal(actualMaintenance)):_this11.$message.error(error.message||_this11.$t("common._common.error_occured"));case 10:case"end":return _context9.stop()}}),_callee9)})))()},updateActualGrossTotal:function(actualObj){var _ref15=actualObj||{},customCostList=_ref15.customCostList,Labour=_ref15.Labour,Items=_ref15.Items,Tools=_ref15.Tools,Services=_ref15.Services,grossAmount=Labour+Items+Tools+Services,totalCostOfCustomCost=0;(0,validation/* isEmpty */.xb)(customCostList)||(customCostList.forEach((function(element){var _ref16=element||{},cost=_ref16.cost;totalCostOfCustomCost+=Number(cost)})),grossAmount+=totalCostOfCustomCost),actualObj=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},actualObj),{},{grossAmount:grossAmount}),this.actualMaintenance=actualObj},getTicketStatusColor:function(record){var statusObj=this.getTicketStatusDetails(record)||{},_ref17=statusObj||{},status=_ref17.status;return"Sent"===status?"fc-tag-status-bg-green":"fc-tag-status-bg-grey"}}},widgets_Quotationvue_type_script_lang_js=Quotationvue_type_script_lang_js,Quotation_component=(0,componentNormalizer/* default */.Z)(widgets_Quotationvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,Quotation=Quotation_component.exports},
/***/345265:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"35079cf978684c9b6a17e182df923ff5.svg";
/***/},
/***/293656:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"e179f34e6169d9164845bf6c1d403c8e.svg";
/***/},
/***/702638:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"763b584b7aa649bd99722d2be3c8036a.svg";
/***/},
/***/47424:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"400bdd76d58614975db74618a6f968ef.svg";
/***/},
/***/30684:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"52c2ff301190417db7febd08d4cd5153.svg";
/***/},
/***/572902:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"db5324b7cf9058a0aa45899e55bf6444.svg";
/***/}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/33341.js.map