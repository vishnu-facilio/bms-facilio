"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[24192],{
/***/633684:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return CompanyListslider}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/CompanyListslider.vue?vue&type=template&id=4a4de2df
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.loading?_vm._e():_c("div",{staticClass:"db-company-list-slider",class:{singlecard:1===_vm.items.length}},[_c("el-carousel",{attrs:{trigger:"click",autoplay:!1}},_vm._l(_vm.items,(function(list,inx){return _c("el-carousel-item",{key:inx},[_c("div",{staticClass:"row sm-gutter"},_vm._l(list,(function(item,index){return _c("div",{key:index,staticClass:"col-3"},[_c("div",{staticClass:" fc-b-card"},[_c("div",{staticClass:"row pT10 pB10"},[_c("div",{staticClass:"col-5 p10 text-center"},[_c("img",{staticClass:"fc-avatar",staticStyle:{width:"100px",height:"100px"},attrs:{src:item.avatar}})]),_c("div",{staticClass:"col-7 self-center pL20",on:{click:function($event){return _vm.openDashBoard(item.space)}}},[_c("div",{staticClass:"row pB10 en"},[_c("div",{staticClass:"f18 bold"},[_vm._v(_vm._s(item.name))])]),_c("div",{staticClass:"f13 bold sb-secondary-color"},[_vm._v(" "+_vm._s(_vm.$t("common.date_picker.this_month"))+" ")]),item.hasOwnProperty("thisMonthMwh")?_c("div",{staticClass:"row item"},[_c("span",{staticClass:"f20 bold en",staticStyle:{"padding-top":"1px"}},[_vm._v(_vm._s(item.thisMonthMwh||"-"))]),_c("div",{staticClass:"f14 secondary-color",staticStyle:{"padding-top":"5px"}},[_vm._v("   "+_vm._s(item.thisMonthMwh?"MWh":"")+" ")])]):item.hasOwnProperty("thisMonthKwh")?_c("div",{staticClass:"row item"},[_c("span",{staticClass:"f20 bold en",staticStyle:{"padding-top":"1px"}},[_vm._v(_vm._s(item.thisMonthKwh||"-"))]),_c("div",{staticClass:"f14 secondary-color",staticStyle:{"padding-top":"5px"}},[_vm._v("   "+_vm._s(item.thisMonthKwh?"KWh":"")+" ")])]):_vm._e(),item.hasOwnProperty("variance")?_c("div",{staticClass:"row en-color-1"},[item.variance<0?_c("div",{staticClass:"f15 bold row",staticStyle:{"padding-top":"5px"}},[_c("img",{staticStyle:{"background-color":"transparent",height:"14px"},attrs:{src:__webpack_require__(595127)}}),_c("div",{staticClass:"f17 bold",style:{color:"#75bd2b"}},[_vm._v("   "+_vm._s(item.variance+"%"||0)+" ")])]):_c("div",{staticClass:"f15 bold row",staticStyle:{"padding-top":"5px"}},[_c("img",{staticStyle:{"background-color":"transparent",height:"14px"},attrs:{src:__webpack_require__(488038)}}),_c("div",{staticClass:"f17 bold",style:{color:"##\f56c6c"}},[_vm._v("   "+_vm._s(item.variance+"%"||0)+" ")])])]):_vm._e()])])])])})),0)])})),1)],1)},staticRenderFns=[],CompanyListslidervue_type_script_lang_js=(__webpack_require__(670560),__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(897389),__webpack_require__(879288),__webpack_require__(689730),{props:["rawData","dashboardLink"],data:function(){return{arrow:{color:"red",direction:"fa fa-arrow-down"},upHere:!1,items:null,isNewDashboard:!1,loading:!0}},computed:{linkName:function(){return this.dashboardLink?this.dashboardLink:this.$route.params.dashboardlink}},methods:{openDashBoard:function(id){"alarmportfolio"!==this.linkName&&(this.isNewDashboard?"residential"===this.linkName||"commercial"===this.linkName?this.$router.push({path:this.linkName+"buildingdashboard/"+id}):this.$router.push({path:"buildingdashboard/"+id}):this.$router.push({path:"default/"+id}))},emitData:function(rawData){rawData&&(this.items=rawData)},loadEnergySource:function(){var self=this,params={};this.linkName&&("residential"!==this.linkName&&"commercial"!==this.linkName||(params.dashboardKey=this.linkName)),this.loading=!0,self.$http.post("/report/energy/portfolio/getAllBuildingsWithRootMeterMeta",params).then((function(response){var reportData=response.data.reportData;reportData&&reportData.buildingsWithRootMeterMeta&&(1214016===self.$account.user.id&&(reportData.buildingsWithRootMeterMeta=reportData.buildingsWithRootMeterMeta.filter((function(rt){if(1109686===rt.building||1109785===rt.building||1109784===rt.building)return rt}))),reportData.buildingsWithRootMeterMeta.forEach((function(element){element.hasOwnProperty("thisMonthKwh")&&element.thisMonthKwh&&(element.thisMonthMwh=(Number(element.thisMonthKwh)/1e3).toFixed(2))})),self.items=self.prepareitem(reportData.buildingsWithRootMeterMeta)),self.isNewDashboard=!0,self.loading=!1})).catch((function(error){self.loading=!1}))},prepareitem:function(item){var i,groups=[],chunkSize=4;for(i=0;i<item.length;i+=chunkSize)groups.push(item.slice(i,i+chunkSize));return groups}},mounted:function(){this.rawData?this.emitData():this.loadEnergySource()},watch:{rawData:function(_rawData){this.emitData(_rawData)}}}),components_CompanyListslidervue_type_script_lang_js=CompanyListslidervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_CompanyListslidervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,CompanyListslider=component.exports},
/***/111322:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return CompanySlider}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/CompanySlider.vue?vue&type=template&id=8a80a1a8
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.loading?_vm._e():_c("div",{staticClass:"db-company-list",class:{singlecard:1===_vm.items.length}},[_c("el-carousel",{attrs:{trigger:"click",autoplay:!1}},_vm._l(_vm.items,(function(list,inx){return _c("el-carousel-item",{key:inx},[_c("div",{staticClass:"row sm-gutter"},_vm._l(list,(function(item,index){return _c("div",{key:index,staticClass:"col-3"},[_c("div",{staticClass:"fc-b-card"},[_c("div",{staticClass:"row pT10 pB10"},[_c("div",{staticClass:"col-5 p10 text-center"},[_c("img",{staticClass:"fc-avatar",staticStyle:{width:"100px",height:"100px"},attrs:{src:item.avatarUrl}})]),_c("div",{staticClass:"col-7 self-center"},[_c("div",{staticClass:"row en"},[_c("div",{staticClass:"f18 bold"},[_vm._v(_vm._s(item.displayName))])]),item.city?_c("div",{staticClass:"f12 pB10 en-secondary-color",staticStyle:{"padding-top":"3px"}},[_vm._v(" "+_vm._s(item.city)+" ")]):_vm._e(),_c("div",{staticClass:"row"},[_c("div",{staticClass:"f14  bold sb-secondary-color"},[_vm._v(" "+_vm._s(item.headerText)+" : ")]),_c("div",{staticClass:"f14  bold"},[_vm._v(_vm._s(item.consumpation))])]),_c("div",{staticClass:"row en-color-1"},[item.arrow?_c("div",{staticClass:"f15 bold"},[_c("i",{staticClass:"fa fa-arrow-down",class:item.arrow.direction,style:{color:item.arrow.color},attrs:{"aria-hidden":"true"}}),_c("div",{staticClass:"f17 bold",style:{color:item.arrow.color}},[_vm._v("   "+_vm._s(item.variance||0)+" % ")])]):_vm._e()])])])])])})),0)])})),1)],1)},staticRenderFns=[],CompanySlidervue_type_script_lang_js=(__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(434284),__webpack_require__(670560),__webpack_require__(689730),{props:["rawData"],data:function(){return{arrow:{color:"red",direction:"fa fa-arrow-down"},upHere:!1,loading:!1,items:[{drop:22,consumption:"23,000",site:"Dar Al Rokham",label:"Facilio HQ",image:""},{drop:12,consumption:"29,000",site:"Al Meydan",label:"Zinc University",image:""},{drop:13,consumption:"18,000",site:"Al Safa",label:"PaperTower Hotel",image:""},{drop:15,consumption:" 7,000",site:"Al Barsha",label:"Rawana Building",image:""}],isNewDashboard:!1}},methods:{loadBuildingDetails:function(){var self=this,formData=new FormData;this.loading=!0,self.$http.post("/report/alarms/getAllBuildings",formData).then((function(response){var reportData=response.data;if(null!=reportData&&0!==reportData.length){var companyLists=[];reportData.filter((function(row){if(row){var activeAlarm,totalAlarms;activeAlarm=row.activeCount||0,totalAlarms=row.totalCount||0;var thisx={avatarUrl:row.avatar,displayName:row.name,city:row.city,consumpation:activeAlarm,total:totalAlarms,id:row.id,subHeader:"Total Alarms",headerText:"Active Alarms"};companyLists.push(thisx)}})),self.items=self.prepareitem(companyLists),self.isNewDashboard=!0,self.loading=!1}})).catch((function(){}))},emitData:function(rawData){rawData&&(this.items=rawData)},prepareitem:function(item){var i,groups=[],chunkSize=4;for(i=0;i<item.length;i+=chunkSize)groups.push(item.slice(i,i+chunkSize));return groups}},mounted:function(){this.rawData?this.emitData(this.rawData):this.loadBuildingDetails()},watch:{rawData:function(_rawData){this.emitData(_rawData)}}}),components_CompanySlidervue_type_script_lang_js=CompanySlidervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_CompanySlidervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,CompanySlider=component.exports},
/***/965875:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FLookupFieldWithDefaultList}});
// EXTERNAL MODULE: ./src/components/forms/FLookupField.vue + 5 modules
var render,staticRenderFns,FLookupField=__webpack_require__(855048),FLookupFieldWithDefaultListvue_type_script_lang_js={extends:FLookupField/* default */.Z},forms_FLookupFieldWithDefaultListvue_type_script_lang_js=FLookupFieldWithDefaultListvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(forms_FLookupFieldWithDefaultListvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FLookupFieldWithDefaultList=component.exports},
/***/188095:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return DashboardFilterContainer}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/dashboard/dashboard-filters/DashboardFilterContainer.vue?vue&type=template&id=42275427
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"db-filter-container",class:[{"edit-background":_vm.isEditBackground}]},[_vm.isUserFilterEmptyState?_c("div",{staticClass:"db-filter-empty-state"},[_c("div",{staticClass:"empty-state-button",on:{click:_vm.openUserFilterManager}},[_vm._v(" Create filters ")]),_c("div",{staticClass:"empty-state-button",on:{click:_vm.openTimeLineFilterManager}},[_vm._v(" Timeline filter ")])]):_vm.isEditMode&&_vm.editStateUserFilters?_c("div",{staticClass:"lookup-filter-section"},_vm._l(_vm.editStateUserFilters,(function(filter,index){return _c("dashboard-lookup-filter",{key:filter.id,attrs:{isEditMode:!0,userFilterObj:filter},on:{edit:function($event){return _vm.customizeFilter(index)},delete:function($event){return _vm.deleteFilter(index)}}})})),1):!_vm.isEditMode&&_vm.dashboardUserFilters?_c("div",{staticClass:"lookup-filter-section"},_vm._l(_vm.dashboardUserFilters,(function(filter){return _c("dashboard-lookup-filter",{key:filter.id,attrs:{isEditMode:!1,userFilterObj:filter,cascadingFilterJson:_vm.cascadingFilterModel[filter.id]},on:{valueChanged:_vm.handleValueChange},model:{value:_vm.lookupFilterModel[filter.id],callback:function($$v){_vm.$set(_vm.lookupFilterModel,filter.id,$$v)},expression:"lookupFilterModel[filter.id]"}})})),1):_vm._e(),_vm.isEditMode?_c("div",{staticClass:"edit-mode-bar"},[_c("div",{staticClass:"blue-btn",on:{click:_vm.openUserFilterManager}},[_vm._v(" Add/Edit filters ")]),_c("div",{staticClass:"seperator"}),_c("div",{staticClass:"blue-btn",on:{click:_vm.openTimeLineFilterManager}},[_vm._v(" Timeline filter ")]),_c("div",{staticClass:"seperator"}),_c("div",{staticClass:"cancel-btn",on:{click:_vm.cancelClicked}},[_vm._v(" Cancel ")]),_c("div",{staticClass:"seperator"}),_c("div",{staticClass:"blue-btn",on:{click:_vm.saveContainer}},[_vm._v(" Save ")])]):_vm._e(),_vm.showUserFilterManager?_c("user-filter-manager",{attrs:{visibility:_vm.showUserFilterManager,userFilterFields:_vm.userFilterFields,userFilterModules:_vm.userFilterModules,dashboardId:_vm.dashboardId,dashboardTabId:_vm.dashboardTabId},on:{"update:visibility":function($event){_vm.showUserFilterManager=$event},filterConfigChanged:_vm.manageUserFilterSave}}):_vm._e(),_vm.showTimelineFilterManager?_c("timeline-filter-manager",{attrs:{visibility:_vm.showTimelineFilterManager,timelineFilterState:_vm.editStateTimelineFilter},on:{"update:visibility":function($event){_vm.showTimelineFilterManager=$event},"update:timelineFilterState":function($event){_vm.editStateTimelineFilter=$event},"update:timeline-filter-state":function($event){_vm.editStateTimelineFilter=$event},timelineFilterConfigSave:_vm.handleTimelineFilterConfigSave}}):_vm._e(),_vm.showUserFilterCustomization?_c("UserFilterCustomization",{attrs:{userFilter:_vm.filterToCustomize,visibility:_vm.showUserFilterCustomization},on:{"update:visibility":function($event){_vm.showUserFilterCustomization=$event},filterPropertiesChanged:_vm.saveFilterCustomization}}):_vm._e()],1)},staticRenderFns=[],objectSpread2=__webpack_require__(595082),utility_methods=(__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(162506),__webpack_require__(425728),__webpack_require__(434284),__webpack_require__(648324),__webpack_require__(450886),__webpack_require__(947522),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(670560),__webpack_require__(773258)),DashboardLookupFilter=__webpack_require__(699464),UserFilterManagervue_type_template_id_83ff6f78_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"db-user-filter-manager"},[_c("el-dialog",{staticClass:"db-user-filter-manager-dialog",attrs:{visible:_vm.visibility,"show-close":!1,"append-to-body":!0,title:"Dashboard Filters",width:"60%"}},[_c("div",{staticClass:"body"},[_vm.loading?_c("spinner",{attrs:{show:_vm.loading,size:80}}):0==_vm.filterGroups.length?_c("div",{staticClass:"user-filter-module-empty"},[_c("div",{staticClass:"col-12 flex-middle justify-content-center flex-direction-column height60vh pT30"},[_c("inline-svg",{attrs:{src:"svgs/empty-dashboard",iconClass:"text-center icon-xxxlg"}}),_c("div",{staticClass:"fc-black-24 pT20"},[_vm._v(" There are no filter supported widgets in dashboard ")]),_c("div",{staticClass:"fc-grayish f18 pT10"},[_vm._v(" Add supported widgets to configure dashboard filters here ")])],1)]):_c("div",{staticClass:"filter-config-container"},[_c("div",{staticClass:"filter-config-left"},[_c("div",{staticClass:"filter-config-accordian"},_vm._l(_vm.filterGroups,(function(module,moduleIndex){return _c("div",{key:moduleIndex,staticClass:"accordian-item"},[_c("div",{staticClass:"accordian-item-header pointer",on:{click:function($event){return _vm.accordianClick(moduleIndex)}}},[_vm._v(" "+_vm._s(module.displayName)+" "),_c("i",{staticClass:"accordian-arrow",class:[{expanded:module.isExpanded}]})]),module.isExpanded?_c("div",{staticClass:"accordian-item-body"},[_c("div",{staticClass:"module-fields-container"},_vm._l(module.fields,(function(field,fieldIndex){return _c("div",{key:fieldIndex,staticClass:"module-field"},[_c("el-checkbox",{staticStyle:{border:"none"},attrs:{label:field.displayName},on:{change:function($event){return _vm.toggleOptionSelection(moduleIndex,fieldIndex,$event)}},model:{value:field.isSelected,callback:function($$v){_vm.$set(field,"isSelected",$$v)},expression:"field.isSelected"}})],1)})),0)]):_vm._e()])})),0)]),_c("div",{staticClass:"filter-config-right"},[_c("div",{staticClass:"selcted-filters-title"},[_vm._v(" SELECTED FILTERS ")]),_c("draggable",_vm._b({attrs:{list:_vm.selectedOptions}},"draggable",_vm.fieldSectionDragOptions,!1),_vm._l(_vm.selectedOptions,(function(selectedOption,index){return _c("div",{key:index,staticClass:"mB10 mT15"},[_c("div",{staticClass:"field-row"},[_c("div",{staticClass:"task-handle mR10 pointer"},[_c("img",{attrs:{src:__webpack_require__(271791)}})]),_c("div",{staticClass:"mT-auto mB-auto"},[_vm._v(" "+_vm._s(selectedOption.displayName||"")+" ")]),_c("div",{staticClass:"mL-auto mT-auto mB-auto"},[_c("div",{staticClass:"mR10 inline"},[_c("i",{staticClass:"el-icon-delete pointer trash-icon",on:{click:function($event){return _vm.removeSelectedOption(selectedOption,index)}}})])])]),_c("div",{staticClass:"applies-to-container"},[_c("div",{staticClass:"applies-to-title"},[_vm._v("Applies to")]),_vm._l(selectedOption.appliesToModules,(function(applicableModule,moduleIndex){return _vm._l(applicableModule.appliesToFields,(function(applicableField,fieldIndex){return _c("div",{key:moduleIndex+"-"+fieldIndex,staticClass:"applies-to-field"},[_c("span",{staticClass:"applies-to-field-field-name"},[_vm._v(" "+_vm._s(applicableField.displayName))]),_c("span",{staticClass:"applies-to-field-in"},[_vm._v("IN")]),_c("span",{staticClass:"applies-to-field-module-name"},[_vm._v(_vm._s(applicableModule.displayName))])])}))}))],2)])})),0)],1)])],1),_vm.loading||0!=_vm.filterGroups.length?_c("div",{staticClass:"dialog-save-cancel"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.closeDialog}},[_vm._v(" Cancel")]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:_vm.saveFilterConfig}},[_vm._v("Done")])],1):_c("div",{staticClass:"dialog-save-cancel"},[_c("el-button",{staticClass:"modal-btn-save width100",attrs:{type:"primary"},on:{click:_vm.saveFilterConfig}},[_vm._v("Done")])],1)])],1)},UserFilterManagervue_type_template_id_83ff6f78_staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),toConsumableArray=__webpack_require__(488478),asyncToGenerator=__webpack_require__(548534),api=(__webpack_require__(677049),__webpack_require__(821694),__webpack_require__(919649),__webpack_require__(76265),__webpack_require__(339772),__webpack_require__(891719),__webpack_require__(865137),__webpack_require__(32284)),vuedraggable_umd=__webpack_require__(909980),vuedraggable_umd_default=__webpack_require__.n(vuedraggable_umd),removeDuplicatesFromArrayOfObj=function(sourceArray,fieldToCompare){var uniqueArray=Array.from(new Set(sourceArray.map((function(e){return e[fieldToCompare]})))).map((function(valueToCompare){return sourceArray.find((function(e){return e[fieldToCompare]===valueToCompare}))}));return uniqueArray},UserFilterManagervue_type_script_lang_js={components:{draggable:vuedraggable_umd_default()},props:["userFilterFields","userFilterModules","visibility","dashboardId","dashboardTabId"],created:function(){var _this=this;this.getDbModules().then((function(){
//for edit case , initialize the selection of fields
_this.loading=!1}))},data:function(){return{loading:!0,filterGroups:[],selectedOptions:[],
//list holding selected options[option ->Field object or module object]
fieldSectionDragOptions:{animation:150,easing:"cubic-bezier(1, 0, 0, 1)",group:"tasksection",sort:!0}}},methods:{closeDialog:function(){this.$emit("update:visibility",!1)},saveFilterConfig:function(){
//remove applies to mods from object, causing circular ref when cloning elsewhere
this.selectedOptions.forEach((function(e){e.appliesToModules=[]})),this.$emit("filterConfigChanged",this.selectedOptions)},
// remove from selected Option list
removeSelectedOption:function(option,selectedOptionIndex){this.filterGroups.forEach((function(module){module.fields.forEach((function(e){
//if selectd option is module ,check name eqiuality, if a field check fieldID equality
("FIELD"==option.filterType&&e.fieldId==option.fieldId||"MODULE"==option.filterType&&e.name==option.name)&&(e.isSelected=!1)}))})),this.selectedOptions.splice(selectedOptionIndex,1)},
// add or remove from left pane checkbox
toggleOptionSelection:function(optionGroupIndex,optionIndex,value){var selectedOption=this.filterGroups[optionGroupIndex].fields[optionIndex];if(value)this.selectedOptions.push(selectedOption);else{var _optionIndex=this.selectedOptions.findIndex((function(e){return"FIELD"==selectedOption.filterType?e.fieldId==selectedOption.fieldId:"MODULE"==selectedOption.filterType?e.name==selectedOption.name:void 0}));this.selectedOptions.splice(_optionIndex,1)}},accordianClick:function(index){this.filterGroups[index].isExpanded?this.filterGroups[index].isExpanded=!1:(this.filterGroups.forEach((function(module){module.isExpanded=!1})),this.filterGroups[index].isExpanded=!0)},getDbModules:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var params,_yield$API$get,_yield$API$get$data$m,moduleNames,promises,resps,moduleResps,allCommonFilterModules,uniqueCommonFilterModules,resourceModuleIndex,basespaceModuleIndex,buildingModule,floorModule,spaceModule,assetModule,commonFilterGroup;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return params={},_this2.dashboardTabId&&-1!=_this2.dashboardTabId?params.dashboardTabId=_this2.dashboardTabId:params.dashboardId=_this2.dashboardId,_context.next=4,api/* API */.bl.get("/v2/dashboardFilter/getModules",params);case 4:return _yield$API$get=_context.sent,_yield$API$get$data$m=_yield$API$get.data.modules,moduleNames=void 0===_yield$API$get$data$m?[]:_yield$API$get$data$m,_yield$API$get.error,promises=[],moduleNames.forEach((function(moduleName){promises.push(api/* API */.bl.get("v2/modules/meta/".concat(moduleName)))})),_context.next=12,Promise.all(promises);case 12:return resps=_context.sent,moduleResps=resps.map((function(resp){return resp.data.meta})),//collect lookup fields seperately as common module
//collect enum fields in their own modules
_this2.filterGroups=[],
// Collect  lookedup modules of  lookupfields FROM all module into an array
allCommonFilterModules=moduleResps.reduce((function(accumulator,currentModule){var lookupFields=currentModule.fields.filter((function(field){return"LOOKUP"==field.dataTypeEnum})),lookupModules=lookupFields.map((function(lookupField){return lookupField.lookupModule}));return accumulator.push.apply(accumulator,(0,toConsumableArray/* default */.Z)(lookupModules)),accumulator}),[]),//remove duplicates. Vendor may have been looked up by Workorder.Vendor and Asset.Vendor
uniqueCommonFilterModules=removeDuplicatesFromArrayOfObj(allCommonFilterModules,"name"),//remove Resource and Basespace  modules from the  list  and replace them with  'Asset and building 'for resource and 'building' for basespace
resourceModuleIndex=-1,basespaceModuleIndex=-1,_context.next=21,_this2.getModuleMeta("building");case 21:return buildingModule=_context.sent,_context.next=24,_this2.getModuleMeta("floor");case 24:return floorModule=_context.sent,_context.next=27,_this2.getModuleMeta("space");case 27:return spaceModule=_context.sent,_context.next=30,_this2.getModuleMeta("asset");case 30:assetModule=_context.sent,
/* DONT change order of finding index and splicing */
resourceModuleIndex=uniqueCommonFilterModules.findIndex((function(module){return"resource"==module.name})),-1!=resourceModuleIndex&&uniqueCommonFilterModules.splice(resourceModuleIndex,1,buildingModule,floorModule,spaceModule,assetModule),basespaceModuleIndex=uniqueCommonFilterModules.findIndex((function(module){return"basespace"==module.name})),-1!=basespaceModuleIndex&&uniqueCommonFilterModules.splice(basespaceModuleIndex,1,buildingModule),
//again remove duplicates introduced by replacing resource and basespace
uniqueCommonFilterModules=removeDuplicatesFromArrayOfObj(uniqueCommonFilterModules,"name"),uniqueCommonFilterModules.forEach((function(module){
//Add filterType and  sync selection State (previouly saved filter)
module.isSelected=!1,module.filterType="MODULE",_this2.userFilterModules&&_this2.userFilterModules.find((function(e){return e.name==module.name}))&&(module.isSelected=!0,_this2.selectedOptions.push(module))})),
// iterate the unique lookup modules and set ->appliesToModules:[modules]->{applicableFields:[fieldList]} into the unique module objects
uniqueCommonFilterModules.forEach((function(filterModule){filterModule.appliesToModules=[],moduleResps.forEach((function(module){var allLookupFields=module.fields.filter((function(field){return"LOOKUP"==field.dataTypeEnum})),applicableFields=allLookupFields.filter((function(field){return field.lookupModule.name==filterModule.name}));if(applicableFields.length>0)filterModule.appliesToModules.push((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},module),{},{appliesToFields:applicableFields}));else if(-1!=filterModule.moduleId){
//special type modules cannot extend or be extended
//no applicable fields found , find parent field -> building Filter -> no building lookup field in WOrkorder module, so see if any lookup is parent of building module
var applicableParentFields=allLookupFields.filter((function(field){return filterModule.extendedModuleIds.includes(field.lookupModule.moduleId)}));applicableParentFields.length>0&&filterModule.appliesToModules.push((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},module),{},{appliesToFields:applicableParentFields}))}}))})),commonFilterGroup={displayName:"Common",isExpanded:!1,fields:uniqueCommonFilterModules},// first tab in accordian , add to front after adding other tabs
_this2.filterGroups=moduleResps.map((function(moduleMeta){var meta={};return meta.displayName=moduleMeta.displayName,meta.isExpanded=!1,meta.fields=moduleMeta.fields.filter((function(field){return"ENUM"==field.dataTypeEnum||"DATE_TIME"===field.dataTypeEnum})).map((function(field){
//even for enum type filters -> hold a reference to the module->[FieldItself again]
return(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},field),{},{isSelected:!1,filterType:"FIELD",appliesToModules:[(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},moduleMeta),{},{appliesToFields:[field]})]})})),//add a isSelected Property to all enum fields
meta.fields.forEach((function(field){_this2.userFilterFields&&_this2.userFilterFields.find((function(e){return e.fieldId==field.fieldId}))&&(field.isSelected=!0,_this2.selectedOptions.push(field))})),meta})),_this2.filterGroups.unshift(commonFilterGroup),
// add common filter group of options as first accordian tab
// filter out tabs without options
_this2.filterGroups=_this2.filterGroups.filter((function(filterGroup){return filterGroup.fields.length>0})),_this2.filterGroups.length>0&&(_this2.filterGroups[0].isExpanded=!0),_this2.selectedOptions.sort((function(selectedOption1,selectedOption2){return selectedOption1.filterOrder-selectedOption2.filterOrder}));
// let { data, error } = await API.get('v2/modules/meta/${moduleName}')
case 44:case"end":return _context.stop()}}),_callee)})))()},getModuleMeta:function(moduleName){return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var _yield$API$get2,data;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,api/* API */.bl.get("/v2/modules/meta/".concat(moduleName));case 2:return _yield$API$get2=_context2.sent,data=_yield$API$get2.data,_yield$API$get2.error,_context2.abrupt("return",data.meta.module);case 6:case"end":return _context2.stop()}}),_callee2)})))()}}},dashboard_filters_UserFilterManagervue_type_script_lang_js=UserFilterManagervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(dashboard_filters_UserFilterManagervue_type_script_lang_js,UserFilterManagervue_type_template_id_83ff6f78_render,UserFilterManagervue_type_template_id_83ff6f78_staticRenderFns,!1,null,null,null)
/* harmony default export */,UserFilterManager=component.exports,TimelineFilterManagervue_type_template_id_584bc0a0_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"db-time-filter-manager"},[_c("el-dialog",{staticClass:"db-timeline-filter-manager-dialog",attrs:{visible:_vm.visibility,"show-close":!1,"append-to-body":!0,title:"Dashboard Filters",width:"35%"}},[_c("div",{staticClass:"body"},[_c("el-checkbox",{staticClass:"mB20",staticStyle:{border:"none"},attrs:{label:"Enable Timeline Filter"},model:{value:_vm.checkBoxModel,callback:function($$v){_vm.checkBoxModel=$$v},expression:"checkBoxModel"}}),_c("div",{staticClass:"mB10 default-time-range-txt"},[_vm._v(" Default Time Range ")]),_c("el-select",{staticClass:"fc-input-full-border-h35",attrs:{disabled:!_vm.checkBoxModel,"value-key":"dateOperator"},model:{value:_vm.selectModel,callback:function($$v){_vm.selectModel=$$v},expression:"selectModel"}},_vm._l(_vm.dateOperators,(function(option){return _c("el-option",{key:option.enumValue,attrs:{label:option.value,value:option.enumValue}})})),1),_c("div",{staticClass:"margin"},[_c("el-checkbox",{staticClass:"mB20",staticStyle:{border:"none"},attrs:{disabled:!_vm.checkBoxModel,label:"Hide Timeline Filters In Widgets"},model:{value:_vm.FilterModel,callback:function($$v){_vm.FilterModel=$$v},expression:"FilterModel"}})],1)],1),_c("div",{staticClass:"dialog-save-cancel"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.closeDialog}},[_vm._v(" Cancel")]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:_vm.saveFilterConfig}},[_vm._v("Done")])],1)])],1)},TimelineFilterManagervue_type_template_id_584bc0a0_staticRenderFns=[],card_constants=__webpack_require__(806186),TimelineFilterManagervue_type_script_lang_js={props:["visibility","timelineFilterState"],created:function(){var _this$timelineFilterS=this.timelineFilterState,checkBoxModel=_this$timelineFilterS.isTimelineFilterEnabled,FilterModel=_this$timelineFilterS.hideFilterInsideWidgets,selectModel=_this$timelineFilterS.dateOperator;this.checkBoxModel=checkBoxModel,this.FilterModel=FilterModel,this.selectModel=selectModel},data:function(){return{checkBoxModel:null,FilterModel:null,selectModel:null,dateOperators:card_constants/* dateOperators */._M}},methods:{closeDialog:function(){this.$emit("update:visibility",!1)},saveFilterConfig:function(){var _this=this;this.$emit("timelineFilterConfigSave",{isTimelineFilterEnabled:this.checkBoxModel,hideFilterInsideWidgets:this.FilterModel,dateOperator:this.selectModel,dateLabel:this.dateOperators.find((function(e){return e.enumValue==_this.selectModel})).value})}}},dashboard_filters_TimelineFilterManagervue_type_script_lang_js=TimelineFilterManagervue_type_script_lang_js,TimelineFilterManager_component=(0,componentNormalizer/* default */.Z)(dashboard_filters_TimelineFilterManagervue_type_script_lang_js,TimelineFilterManagervue_type_template_id_584bc0a0_render,TimelineFilterManagervue_type_template_id_584bc0a0_staticRenderFns,!1,null,null,null)
/* harmony default export */,TimelineFilterManager=TimelineFilterManager_component.exports,UserFilterCustomizationvue_type_template_id_3794b9fc_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"db-user-filter-customization"},[_vm.userFilterConfig.module||_vm.userFilterConfig.field&&"DATE_TIME"!==_vm.userFilterConfig.field.dataTypeEnum?_c("el-dialog",{staticClass:"db-user-filter-customization-dialog",attrs:{visible:_vm.visibility,"show-close":!1,"append-to-body":!0,title:_vm.userFilterConfig.field&&_vm.userFilterConfig.field.displayName||(_vm.userFilterConfig.module&&_vm.userFilterConfig.module.displayName)+"- FILTER CUSTOMIZATION",width:"50%"}},[_c("div",{staticClass:"body p25"},[_c("div",{staticClass:"filter-customization-container"},[_c("div",{staticClass:"filter-label title mB10"},[_vm._v(" Filter label ")]),_c("el-input",{staticClass:"fc-input-full-border2 mB20 width60",model:{value:_vm.userFilterConfig.label,callback:function($$v){_vm.$set(_vm.userFilterConfig,"label",$$v)},expression:"userFilterConfig.label"}}),_c("div",{staticClass:"filter-option-type title mB10"},[_vm._v(" Selection type ")]),_c("el-select",{staticClass:"fc-input-full-border-h35 mB20 width60",model:{value:_vm.userFilterConfig.componentType,callback:function($$v){_vm.$set(_vm.userFilterConfig,"componentType",$$v)},expression:"userFilterConfig.componentType"}},[_c("el-option",{attrs:{value:1,label:"Single select"}}),_c("el-option",{attrs:{value:2,label:"Multi select"}})],1),"ticketstatus"===_vm.userFilterConfig.moduleName?_c("div",[_c("div",{staticClass:"filter-option-type title mB10"},[_vm._v(" Select Parent Module ")]),_c("el-select",{staticClass:"fc-input-full-border-h35 mB20 width60",attrs:{filterable:""},on:{change:_vm.parentModuleSelected},model:{value:_vm.userFilterConfig.module.parentModule,callback:function($$v){_vm.$set(_vm.userFilterConfig.module,"parentModule",$$v)},expression:"userFilterConfig.module.parentModule"}},_vm._l(_vm.moduleList,(function(modules,index){return _c("el-option",{key:index,attrs:{label:modules.displayName,value:modules.name}})})),1)],1):_vm._e(),_c("div",{staticClass:"filter-option-type title mB10"},[_vm._v(" Default option ")]),_c("el-select",{staticClass:"fc-input-full-border-h35 mB20 width60",attrs:{placeholder:"Type to search",loading:_vm.remoteOptionsLoading,"loading-text":"loading ... ",multiple:2==_vm.userFilterConfig.componentType,"collapse-tags":"",filterable:"",remote:_vm.isLazyLoad,"remote-method":_vm.handleRemoteSearch},model:{value:_vm.elSelectModel,callback:function($$v){_vm.elSelectModel=$$v},expression:"elSelectModel"}},_vm._l(_vm.elSelectOptions,(function(option){return _c("el-option",{key:option.value,attrs:{label:option.label,value:option.value}})})),1),_c("div",{staticClass:"mB15"},[_c("el-checkbox",{staticStyle:{border:"none"},attrs:{"true-label":2,"false-label":1},on:{change:_vm.checkBoxChanged},model:{value:_vm.userFilterConfig.optionType,callback:function($$v){_vm.$set(_vm.userFilterConfig,"optionType",$$v)},expression:"userFilterConfig.optionType"}},[_vm._v(" Limit options ")])],1),2!=_vm.userFilterConfig.optionType||_vm.loading?_vm._e():[_c("div",{staticClass:"mB10 mT10"}),_vm.showCheckboxList?_c("div",{staticClass:"checkbox-list "},[_c("el-checkbox-group",{staticClass:"flex flex-wrap overflow-y-scroll flex-align-start content-start",model:{value:_vm.userFilterConfig.selectedOptions,callback:function($$v){_vm.$set(_vm.userFilterConfig,"selectedOptions",$$v)},expression:"userFilterConfig.selectedOptions"}},_vm._l(_vm.checkboxList,(function(option,index){return _c("el-checkbox",{key:index,staticClass:"p5",attrs:{label:option.value}},[_vm._v(_vm._s(option.label))])})),1)],1):_vm.showCriteriaBuilder?_c("div",{staticClass:"option-criteria"},[_c("new-criteria-builder",{ref:"criteriaBuilder",staticClass:"stateflow-criteria",attrs:{title:"Show options that match",exrule:_vm.userFilterConfig.criteria,module:_vm.userFilterConfig.module.name},on:{condition:_vm.updateCriteria},model:{value:_vm.userFilterConfig.criteria,callback:function($$v){_vm.$set(_vm.userFilterConfig,"criteria",$$v)},expression:"userFilterConfig.criteria"}})],1):_vm._e()]],2)]),_c("div",{staticClass:"dialog-save-cancel"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.closeDialog}},[_vm._v(" Cancel")]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:_vm.saveFilterDialog}},[_vm._v("Done")])],1)]):_vm._e(),_vm.userFilterConfig.field&&"DATE_TIME"===_vm.userFilterConfig.field.dataTypeEnum?_c("div",[_c("DashboardDateTimeFilter",{attrs:{userDTFilterConfig:_vm.userFilterConfig,visibility:_vm.visibility},on:{updatevisibility:_vm.closeDialog,filterPropertiesChanged:_vm.saveFilterConfig}})],1):_vm._e()],1)},UserFilterCustomizationvue_type_template_id_3794b9fc_staticRenderFns=[],NewCriteriaBuilder=(__webpack_require__(795765),__webpack_require__(879288),__webpack_require__(821552),__webpack_require__(634338),__webpack_require__(564043),__webpack_require__(169358),__webpack_require__(61514),__webpack_require__(859850)),utils_utility_methods=__webpack_require__(555005),validation=__webpack_require__(990260),DashboardDateTimeFiltervue_type_template_id_ef7f669a_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"db-user-filter-customization"},[_c("el-dialog",{staticClass:"db-user-filter-customization-dialog",attrs:{visible:_vm.visibility,"show-close":!1,"append-to-body":!0,title:_vm.userDTFilterConfig.field&&_vm.userDTFilterConfig.field.displayName||(_vm.userDTFilterConfig.module&&_vm.userDTFilterConfig.module.displayName)+"- FILTER CUSTOMIZATION",width:"50%"}},[_c("div",{staticClass:"body p25"},[_c("div",{staticClass:"filter-customization-container"},[_c("div",{staticClass:"filter-label title mB10"},[_vm._v(" "+_vm._s(_vm.$t("dashboardfilters.filter_label"))+" ")]),_c("el-input",{staticClass:"fc-input-full-border2 mB20 width60",model:{value:_vm.userDTFilterConfig.label,callback:function($$v){_vm.$set(_vm.userDTFilterConfig,"label",$$v)},expression:"userDTFilterConfig.label"}}),_c("div",{staticClass:"filter-option-type title mB10"},[_vm._v(" "+_vm._s(_vm.$t("dashboardfilters.select_operator"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border-h35 mB20 width60",attrs:{filterable:""},on:{change:_vm.typeChange},model:{value:_vm.elSelectModel,callback:function($$v){_vm.elSelectModel=$$v},expression:"elSelectModel"}},_vm._l(_vm.selectedOptions,(function(value,key){return _c("el-option",{key:key,attrs:{label:value.label,value:value.value}})})),1),_c("div",{staticClass:"filter-option-type title mB10"},[_vm._v(" "+_vm._s(_vm.$t("dashboardfilters.display_type_label"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border-h35 mB20 width60",model:{value:_vm.userDTFilterConfig.filterDisplayType,callback:function($$v){_vm.$set(_vm.userDTFilterConfig,"filterDisplayType",$$v)},expression:"userDTFilterConfig.filterDisplayType"}},[_c("el-option",{attrs:{value:1,label:"Slider"}}),_c("el-option",{attrs:{value:2,label:"Selectbox"}})],1),2==_vm.userDTFilterConfig.filterDisplayType?_c("div",[_c("div",{staticClass:"filter-option-type title mB10"},[_vm._v(" "+_vm._s(_vm.$t("dashboardfilters.selection_type_label"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border-h35 mB20 width60",model:{value:_vm.userDTFilterConfig.componentType,callback:function($$v){_vm.$set(_vm.userDTFilterConfig,"componentType",$$v)},expression:"userDTFilterConfig.componentType"}},[_c("el-option",{attrs:{value:1,label:"Single select"}}),_c("el-option",{attrs:{value:2,label:"Multi select"}})],1)],1):_vm._e(),""!=this.operator_value?_c("div",[_c("div",{staticClass:"mB15 mT20"},[_c("div",{staticClass:"block"},[1==_vm.userDTFilterConfig.filterDisplayType?_c("el-slider",{attrs:{range:"","show-stops":"",min:_vm.min_slider_range,max:_vm.max_slider_range},model:{value:_vm.slider_range,callback:function($$v){_vm.slider_range=$$v},expression:"slider_range"}}):_vm._e()],1)]),2===_vm.userDTFilterConfig.filterDisplayType?_c("div",[_vm.showDayOfWeek?_c("el-select",{staticClass:"fc-input-full-border-h35 mB20 width60",attrs:{multiple:2===_vm.userDTFilterConfig.componentType,filterable:"","collapse-tags":2===_vm.userDTFilterConfig.componentType},model:{value:_vm.computeSelectdValue,callback:function($$v){_vm.computeSelectdValue=$$v},expression:"computeSelectdValue"}},_vm._l(_vm.daysOfWeek,(function(weeks){return _c("el-option",{key:weeks.value,attrs:{label:weeks.label,value:weeks.value}})})),1):_vm._e(),_vm.showDayOfMonth?_c("el-select",{staticClass:"fc-input-full-border-h35 mB20 width60",attrs:{multiple:2===_vm.userDTFilterConfig.componentType,filterable:"","collapse-tags":2===_vm.userDTFilterConfig.componentType},model:{value:_vm.computeSelectdValue,callback:function($$v){_vm.computeSelectdValue=$$v},expression:"computeSelectdValue"}},_vm._l(_vm.daysOfMonth,(function(monthday){return _c("el-option",{key:monthday,attrs:{label:parseInt(monthday),value:monthday}})})),1):_vm._e(),_vm.showHourOfDay?_c("el-select",{staticClass:"fc-input-full-border-h35 mB20 width60",attrs:{multiple:2===_vm.userDTFilterConfig.componentType,filterable:"","collapse-tags":2===_vm.userDTFilterConfig.componentType},model:{value:_vm.computeSelectdValue,callback:function($$v){_vm.computeSelectdValue=$$v},expression:"computeSelectdValue"}},_vm._l(_vm.hourOfDay,(function(hourDay){return _c("el-option",{key:hourDay,attrs:{label:parseInt(hourDay),value:hourDay}})})),1):_vm._e()],1):_vm._e()]):_vm._e()],1)]),_c("div",{staticClass:"dialog-save-cancel"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.closeDialog}},[_vm._v(" "+_vm._s(_vm.$t("dashboardfilters.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:_vm.saveFilterConfig}},[_vm._v(" "+_vm._s(_vm.$t("dashboardfilters.done")))])],1)])],1)},DashboardDateTimeFiltervue_type_template_id_ef7f669a_staticRenderFns=[],DashboardDateTimeFiltervue_type_script_lang_js=(__webpack_require__(212826),{components:{NewCriteriaBuilder:NewCriteriaBuilder/* default */.Z},props:["userDTFilterConfig","visibility"],data:function(){return{
// userDTFilterConfig:null,
loading:!1,defaultOptions:[],operator_value:"",daysOfWeek:[{value:"1",label:"Mon"},{value:"2",label:"Tue"},{value:"3",label:"Wed"},{value:"4",label:"Thu"},{value:"5",label:"Fri"},{value:"6",label:"Sat"},{value:"7",label:"Sun"}],daysOfMonth:["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31"],hourOfDay:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23"],showHourOfDay:!1,showDayOfWeek:!1,showDayOfMonth:!1,slider_range:[0,31],max_slider_range:31,min_slider_range:0,selectedOptions:[{label:"Hours of day",value:"103"},{label:"Day of week",value:"85"},{label:"Day of month",value:"101"}],selectedDayOrHourValues:[],enable_operator_validation:!1}},created:function(){this.init()},computed:{elSelectModel:{get:function(){var _this$userDTFilterCon;
//single select
//v -model passed to datetime filter component is always single select return value as a single element
return(null===this||void 0===this||null===(_this$userDTFilterCon=this.userDTFilterConfig)||void 0===_this$userDTFilterCon||null===(_this$userDTFilterCon=_this$userDTFilterCon.defaultValues)||void 0===_this$userDTFilterCon?void 0:_this$userDTFilterCon.length)<=0&&(this.userDTFilterConfig.defaultValues[0]="103",this.operator_value="103"),this.userDTFilterConfig.defaultValues[0]},set:function(value){this.userDTFilterConfig.defaultValues=[value]}},computeSelectdValue:{get:function(){return 1===this.userDTFilterConfig.componentType?this.selectedDayOrHourValues[0]:this.selectedDayOrHourValues},set:function(value){1===this.userDTFilterConfig.componentType?this.selectedDayOrHourValues=[value]:this.selectedDayOrHourValues=value}}},methods:{setDefaultSliderRange:function(operator_type,range,min,max){this.operator_value=operator_type,"103"==operator_type?(this.slider_range=range&&range.length>0?range:[0,23],this.min_slider_range=min||0,this.max_slider_range=max||23,this.showHourOfDay=!0):"101"==operator_type?(this.slider_range=range&&range.length>0?range:[1,31],this.min_slider_range=min||1,this.max_slider_range=max||31,this.showDayOfMonth=!0):"85"==operator_type&&(this.slider_range=range&&range.length>0?range:[1,7],this.min_slider_range=min||1,this.max_slider_range=max||7,this.showDayOfWeek=!0)},init:function(){var _this$userDTFilterCon2,_this$userDTFilterCon3,_this$userDTFilterCon5,_this$userDTFilterCon6,_this$userDTFilterCon7,_this$userDTFilterCon8,_this$userDTFilterCon4;((null===(_this$userDTFilterCon2=this.userDTFilterConfig)||void 0===_this$userDTFilterCon2||null===(_this$userDTFilterCon2=_this$userDTFilterCon2.defaultValues)||void 0===_this$userDTFilterCon2?void 0:_this$userDTFilterCon2.length)>0||(this.userDTFilterConfig.defaultValues=["103"]),(null===(_this$userDTFilterCon3=this.userDTFilterConfig)||void 0===_this$userDTFilterCon3||null===(_this$userDTFilterCon3=_this$userDTFilterCon3.defaultValues)||void 0===_this$userDTFilterCon3?void 0:_this$userDTFilterCon3.length)>0)&&this.setDefaultSliderRange(null===(_this$userDTFilterCon4=this.userDTFilterConfig)||void 0===_this$userDTFilterCon4?void 0:_this$userDTFilterCon4.defaultValues[0]);if(null!==(_this$userDTFilterCon5=this.userDTFilterConfig)&&void 0!==_this$userDTFilterCon5&&_this$userDTFilterCon5.defaultValues&&(null===(_this$userDTFilterCon6=this.userDTFilterConfig)||void 0===_this$userDTFilterCon6||null===(_this$userDTFilterCon6=_this$userDTFilterCon6.selectedSliderRangeValues)||void 0===_this$userDTFilterCon6?void 0:_this$userDTFilterCon6.length)>0)this.slider_range=this.userDTFilterConfig.selectedSliderRangeValues,this.operator_value=this.userDTFilterConfig.defaultValues[0];else if(null!==(_this$userDTFilterCon7=this.userDTFilterConfig)&&void 0!==_this$userDTFilterCon7&&_this$userDTFilterCon7.defaultValues&&(null===(_this$userDTFilterCon8=this.userDTFilterConfig)||void 0===_this$userDTFilterCon8||null===(_this$userDTFilterCon8=_this$userDTFilterCon8.selectedDayOrHourValues)||void 0===_this$userDTFilterCon8?void 0:_this$userDTFilterCon8.length)>0){var _this$userDTFilterCon9;this.operator_value=this.userDTFilterConfig.defaultValues[0],"103"==this.operator_value?this.showHourOfDay=!0:"101"==this.operator_value?this.showDayOfMonth=!0:"85"==this.operator_value&&(this.showDayOfWeek=!0),this.selectedDayOrHourValues=null===(_this$userDTFilterCon9=this.userDTFilterConfig)||void 0===_this$userDTFilterCon9?void 0:_this$userDTFilterCon9.selectedDayOrHourValues}},typeChange:function(operator_value){this.operator_value=operator_value,this.selectedDayOrHourValues=[],85==operator_value?(this.showDayOfWeek=!0,this.showDayOfMonth=!1,this.showHourOfDay=!1,this.slider_range=[1,7],this.max_slider_range=7,this.min_slider_range=1):101==operator_value?(this.showDayOfMonth=!0,this.showDayOfWeek=!1,this.showHourOfDay=!1,this.slider_range=[1,31],this.max_slider_range=31,this.min_slider_range=1):103==operator_value&&(this.showHourOfDay=!0,this.showDayOfMonth=!1,this.showDayOfWeek=!1,this.slider_range=[0,23],this.max_slider_range=23,this.min_slider_range=0)},closeDialog:function(){this.$emit("updatevisibility",!1)},saveFilterConfig:function(){if(this.userDTFilterConfig.defaultValues=[this.operator_value.toString()],""!==this.operator_value){var filterDisplayType=this.userDTFilterConfig.filterDisplayType;if(1===filterDisplayType)this.userDTFilterConfig.selectedSliderRangeValues=this.slider_range,this.selectedDayOrHourValues=[],this.userDTFilterConfig.selectedDayOrHourValues=[];else{var selectedDaysorHours=[];for(var days in this.selectedDayOrHourValues)selectedDaysorHours.push(this.selectedDayOrHourValues[days].toString());this.userDTFilterConfig.selectedDayOrHourValues=selectedDaysorHours,this.userDTFilterConfig.selectedSliderRangeValues=[]}this.$emit("filterPropertiesChanged",this.userDTFilterConfig)}},loadOptionLimitConfig:function(){var _this$userDTFilterCon10;"DATE_TIME"==(null===(_this$userDTFilterCon10=this.userDTFilterConfig)||void 0===_this$userDTFilterCon10||null===(_this$userDTFilterCon10=_this$userDTFilterCon10.field)||void 0===_this$userDTFilterCon10?void 0:_this$userDTFilterCon10.dataTypeEnum)&&(this.defaultOptions=this.selectedOptions)}}}),dashboard_filters_DashboardDateTimeFiltervue_type_script_lang_js=DashboardDateTimeFiltervue_type_script_lang_js,DashboardDateTimeFilter_component=(0,componentNormalizer/* default */.Z)(dashboard_filters_DashboardDateTimeFiltervue_type_script_lang_js,DashboardDateTimeFiltervue_type_template_id_ef7f669a_render,DashboardDateTimeFiltervue_type_template_id_ef7f669a_staticRenderFns,!1,null,null,null)
/* harmony default export */,DashboardDateTimeFilter=DashboardDateTimeFilter_component.exports,UserFilterCustomizationvue_type_script_lang_js={components:{NewCriteriaBuilder:NewCriteriaBuilder/* default */.Z,DashboardDateTimeFilter:DashboardDateTimeFilter},props:["userFilter","visibility"],created:function(){var _this=this;this.userFilterConfig=(0,utility_methods/* deepCloneObject */.kh)(this.userFilter),this.getModuleList().then((function(){_this.loadOptionLimitConfig()}))},data:function(){return{userFilterConfig:null,loading:!1,defaultOptions:[],showCheckboxList:!1,showCriteriaBuilder:!1,checkboxList:[],remoteOptionsLoading:!1,moduleList:[]}},computed:{
// these properties are required for default value chooser
isLazyLoad:function(){
//for non picklist lookup module ,need to lazy load the options
return this.userFilterConfig.module&&"PICK_LIST"!=this.userFilterConfig.module.typeEnum},elSelectModel:{get:function(){return 1==this.userFilterConfig.componentType?this.userFilterConfig.defaultValues[0]:2==this.userFilterConfig.componentType?this.userFilterConfig.defaultValues:null},set:function(value){
//add toggle logic for all,
1==this.userFilterConfig.componentType?this.userFilterConfig.defaultValues=[value]:2==this.userFilterConfig.componentType&&(this.userFilterConfig.defaultValues=value)}},elSelectOptions:function(){var _this2=this,options=(0,utility_methods/* deepCloneObject */.kh)(this.defaultOptions);
//for enum and lookup with module=picklist filter options if only certain options are selected
return 2!=this.userFilterConfig.optionType||this.isLazyLoad||(options=options.filter((function(e){return _this2.userFilterConfig.selectedOptions.includes(e.value)}))),this.userFilterConfig.isAllOptionEnabled&&options.unshift({label:"All",value:"all"}),2==this.userFilterConfig.optionType&&this.userFilterConfig.isOthersOptionEnabled&&options.push({label:"Others",value:"others"}),options}},watch:{"userFilterConfig.module.parentModule":{handler:function(newVal,oldVal){var _this3=this;newVal&&this.getModuleList().then((function(){_this3.loadOptionLimitConfig()}))}}},methods:{checkBoxChanged:function(){1==this.userFilterConfig.optionType&&(this.userFilterConfig.criteria=null,this.userFilterConfig.selectedOptions=[])},handleRemoteSearch:function(search){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(!_this4.remoteOptionsLoading){_context.next=2;break}return _context.abrupt("return");case 2:return _this4.remoteOptionsLoading=!0,_context.next=6,_this4.getOptions(search);case 6:_this4.defaultOptions=_context.sent,_this4.remoteOptionsLoading=!1;case 8:case"end":return _context.stop()}}),_callee)})))()},updateCriteria:function(newValue){var _this5=this;this.userFilterConfig.criteria=newValue,this.isValidCriteria(newValue)&&this.getOptions(null,!0).then((function(options){_this5.defaultOptions=options}))},isValidCriteria:function(criteria){if(!criteria.conditions)return!1;var conditions=criteria.conditions;for(var key in conditions)if(Number.isInteger(Number.parseInt(key))){var condition=conditions[key];if((0,validation/* isEmpty */.xb)(condition)||(0,validation/* isEmpty */.xb)(condition.operatorLabel))return!1}return!0},closeDialog:function(){this.$emit("update:visibility",!1)},parentModuleSelected:function(){this.userFilterConfig.defaultValues=[]},saveFilterDialog:function(){var userFilterConfig=this.userFilterConfig,_ref=userFilterConfig||{},module=_ref.module,_ref2=module||{},parentModule=_ref2.parentModule,name=_ref2.name;"ticketstatus"===name&&(0,validation/* isEmpty */.xb)(parentModule)?this.$message.error(this.$t("common.products.please_select_parentmodule_in_ticket_status")):this.saveFilterConfig()},saveFilterConfig:function(){if(2==this.userFilterConfig.optionType&&this.showCriteriaBuilder){if(!this.isValidCriteria(this.userFilterConfig.criteria))return void this.$message.error("Please enter valid criteria");this.$emit("filterPropertiesChanged",this.userFilterConfig)}this.$emit("filterPropertiesChanged",this.userFilterConfig)},getModuleList:function(){var _this6=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var _yield$API$get,data,error,customModules,systemModules;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,api/* API */.bl.get("v3/modules/list/all");case 2:_yield$API$get=_context2.sent,data=_yield$API$get.data,error=_yield$API$get.error,error||(customModules=data.customModules,systemModules=data.systemModules,_this6.moduleList=[].concat((0,toConsumableArray/* default */.Z)(customModules),(0,toConsumableArray/* default */.Z)(systemModules)));case 6:case"end":return _context2.stop()}}),_callee2)})))()},loadOptionLimitConfig:function(){var _this$userFilterConfi,_this7=this;this.userFilterConfig.field&&"DATE_TIME"!==(null===(_this$userFilterConfi=this.userFilterConfig)||void 0===_this$userFilterConfi||null===(_this$userFilterConfi=_this$userFilterConfi.field)||void 0===_this$userFilterConfi?void 0:_this$userFilterConfi.dataTypeEnum)?(
//field obj filled indicates ->FILTER TYPE=ENUM
this.showCheckboxList=!0,this.checkboxList=(0,utils_utility_methods/* constructFieldOptions */.aE)(this.userFilterConfig.field.enumMap).map((function(e){return{value:String(e.value),label:e.label}})),this.defaultOptions=this.checkboxList):this.userFilterConfig.module&&(
//MODULE ibject field -> Filter TYPE= Lookup filter
"PICK_LIST"==this.userFilterConfig.module.typeEnum?(
//PICK_LIST is a special type lookup with limited values,hence load options upfront
this.loading=!0,this.getOptions().then((function(options){_this7.checkboxList=options,_this7.loading=!1,_this7.showCheckboxList=!0,_this7.defaultOptions=_this7.checkboxList}))):(
//BASE_ENTITY Module
// this.loading = true
this.showCriteriaBuilder=!0,this.getOptions(null,!0).then((function(options){_this7.defaultOptions=options}))))},getOptions:function(search,isInitialFetch){var _this8=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var params,currentySelectedOptions,criteria,conditionId,userFilterConfig,_ref3,moduleName,moduleObj,_ref4,parentModule,modules,parentModuleId,_yield$API$post,data,error,options,pickList,basespaces;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:if(
//,called for PICKLIST where data_type=lookup
//for baseentity module type lookup , lazy load done,remote search ,
// for picklist module lookup load all values upfront,this method called only on init
params={},!_this8.isLazyLoad){_context3.next=10;break}if(isInitialFetch||!(0,validation/* isEmpty */.xb)(search)){_context3.next=4;break}return _context3.abrupt("return");case 4:if(params.search=search,params.page=1,params.perPage=10,
//make sure currently selected lookup record always resolves  its  id ->label,
currentySelectedOptions=_this8.userFilterConfig.defaultValues.filter((function(e){return"all"!=e&&"others"!=e})),currentySelectedOptions=currentySelectedOptions.map((function(e){return Number(e)})),2==_this8.userFilterConfig.optionType){if(criteria=_this8.userFilterConfig.criteria,criteria&&criteria.conditions)
//dont send operator as there is no enum setter for operator,causes struts error,operatorId is sent which will suffice
for(conditionId in criteria.conditions)delete criteria.conditions[conditionId].operator;params.criteria=criteria}case 10:return userFilterConfig=_this8.userFilterConfig,_ref3=userFilterConfig||{},moduleName=_ref3.moduleName,moduleObj=_ref3.module,_ref4=moduleObj||{},parentModule=_ref4.parentModule,"ticketstatus"===moduleName&&((0,validation/* isEmpty */.xb)(parentModule)||(modules=_this8.moduleList.find((function(m){return m.name===parentModule})),parentModuleId=modules?modules.moduleId:null,parentModuleId&&(params.filters=JSON.stringify({parentModuleId:{operatorId:9,value:["".concat(parentModuleId)]}})))),
//else for picklist type lookups can load all records as there will be few in number, no params
// let isBaseSpaceModule =
//   this.userFilterConfig.field.lookupModule.name == 'basespace'
//basespace response returing an array instead of map , must fix api
_context3.next=16,api/* API */.bl.post("v2/picklist/".concat(_this8.userFilterConfig.module.name),params);case 16:if(_yield$API$post=_context3.sent,data=_yield$API$post.data,error=_yield$API$post.error,!error){_context3.next=23;break}_this8.$message.error(error.message),_context3.next=27;break;case 23:return options=[],pickList=data.pickList,basespaces=data.basespaces,pickList?Object.keys(pickList).forEach((function(key){options.push({label:pickList[key],value:String(key)})})):basespaces&&null!=basespaces&&(options=basespaces.map((function(e){return{value:String(e.id),label:e.name}}))),_context3.abrupt("return",options);case 27:case"end":return _context3.stop()}}),_callee3)})))()}}},dashboard_filters_UserFilterCustomizationvue_type_script_lang_js=UserFilterCustomizationvue_type_script_lang_js,UserFilterCustomization_component=(0,componentNormalizer/* default */.Z)(dashboard_filters_UserFilterCustomizationvue_type_script_lang_js,UserFilterCustomizationvue_type_template_id_3794b9fc_render,UserFilterCustomizationvue_type_template_id_3794b9fc_staticRenderFns,!1,null,null,null)
/* harmony default export */,UserFilterCustomization=UserFilterCustomization_component.exports,DashboardFilterHelper=__webpack_require__(981452),DashboardFilterContainervue_type_script_lang_js={props:["dashboardFilterObj","dbTimelineFilter","dashboardId","dashboardTabId"],components:{DashboardLookupFilter:DashboardLookupFilter/* default */.Z,UserFilterManager:UserFilterManager,TimelineFilterManager:TimelineFilterManager,UserFilterCustomization:UserFilterCustomization},computed:{
//while in empty state check the editState filter config.
//while live dashboard check if filters present ,before showing 'no data' buttons'
//applies for both types
isUserFilterEmptyState:function(){return this.isEditMode?!(this.editStateUserFilters&&this.editStateUserFilters.length>0):!(this.dashboardFilterObj&&this.dashboardUserFilters&&this.dashboardUserFilters.length>0)},isEditBackground:function(){return!(!this.isUserFilterEmptyState&&!this.isEditMode)}},data:function(){return{lookupFilterModel:{},
//filter:value
cascadingFilterModel:{},
//filterId :FilterJson
isEditMode:!1,showUserFilterManager:!1,showUserFilterCustomization:!1,filterToCustomize:null,showTimelineFilterManager:!1,editStateUserFilters:null,dashboardUserFilters:null,
/* user filter list contains userFilterObj->Field OR Module +Other properties
      for add/edit filter wizard ,send only fields or modules from selected user filters
      */
userFilterFields:null,userFilterModules:null,

editStateTimelineFilter:null}},created:function(){if(this.dashboardUserFilters=this.$getProperty(this,"dashboardFilterObj.dashboardUserFilters"),this.dashboardUserFilters){this.lookupFilterModel=(0,DashboardFilterHelper/* getUserFilterModel */.jb)(this.dashboardUserFilters);try{this.cascadingFilterModel=(0,DashboardFilterHelper/* getCascadingFilterModel */.yZ)(this.dashboardUserFilters,this.lookupFilterModel)}catch(e){}}this.dashboardUserFilters&&this.dashboardUserFilters.filter((function(filter){var _ref=filter||{},parentModuleName=_ref.parentModuleName;parentModuleName&&(filter.module.parentModule=parentModuleName)}))},mounted:function(){},methods:{deleteFilter:function(index){this.editStateUserFilters.splice(index,1)},customizeFilter:function(index){this.filterToCustomizeIndex=index,this.filterToCustomize=this.editStateUserFilters[this.filterToCustomizeIndex],this.showUserFilterCustomization=!0},saveFilterCustomization:function(changedFilter){this.editStateUserFilters.splice(this.filterToCustomizeIndex,1,changedFilter),this.showUserFilterCustomization=!1},handleTimelineFilterConfigSave:function(timelineFilterConfig){this.showTimelineFilterManager=!1,this.editStateTimelineFilter=timelineFilterConfig,this.isEditMode=!0,this.$emit("update:filterEditMode",this.isEditMode),this.$emit("update:hideFilterInsideWidgets",timelineFilterConfig.isHideTimeLineFilterEnabled)},enterEditMode:function(){this.dashboardUserFilters&&(this.editStateUserFilters=(0,utility_methods/* deepCloneObject */.kh)(this.dashboardUserFilters)),this.isEditMode=!0,this.$emit("update:filterEditMode",this.isEditMode)},cancelClicked:function(){this.isEditMode=!1,this.$emit("update:filterEditMode",this.isEditMode),this.editStateUserFilters=null,this.editStateTimelineFilter=null},createTimelineEditState:function(){this.editStateTimelineFilter||(this.editStateTimelineFilter={isTimelineFilterEnabled:this.$getProperty(this.dashboardFilterObj,"isTimelineFilterEnabled",!1),dateOperator:this.$getProperty(this.dashboardFilterObj,"dateOperator",22),dateLabel:this.$getProperty(this.dashboardFilterObj,"dateLabel","Today"),hideFilterInsideWidgets:this.$getProperty(this.dashboardFilterObj,"hideFilterInsideWidgets",!1)})},saveContainer:function(){var availableFilter=this.editStateUserFilters?this.editStateUserFilters.find((function(filter){var _filter$module;return"ticketstatus"===(null===filter||void 0===filter||null===(_filter$module=filter.module)||void 0===_filter$module?void 0:_filter$module.name)})):null;if((0,validation/* isEmpty */.xb)(availableFilter))this.saveClicked();else{var _ref2=availableFilter||{},module=_ref2.module,_ref3=module||{},parentModule=_ref3.parentModule,name=_ref3.name;"ticketstatus"===name&&((0,validation/* isEmpty */.xb)(parentModule)?this.$message.error(this.$t("common.products.please_select_parentmodule_in_ticket_status")):this.saveClicked())}},saveClicked:function(){this.createTimelineEditState();var reqJson={dashboardFilter:{dashboardUserFilters:this.editStateUserFilters?(0,DashboardFilterHelper/* serializeUserFilters */.CO)(this.editStateUserFilters):null,isTimelineFilterEnabled:this.editStateTimelineFilter.isTimelineFilterEnabled,dateOperator:this.editStateTimelineFilter.dateOperator,dateLabel:this.editStateTimelineFilter.dateLabel,hideFilterInsideWidgets:this.editStateTimelineFilter.hideFilterInsideWidgets}};this.dashboardTabId&&-1!=this.dashboardTabId?reqJson.dashboardFilter.dashboardTabId=this.dashboardTabId:reqJson.dashboardFilter.dashboardId=this.dashboardId,
//update existing filter
this.dashboardFilterObj&&this.dashboardFilterObj.id&&(reqJson.dashboardFilter.id=this.dashboardFilterObj.id),
// this.editStateUserFilters = null
this.$emit("dbFilterConfigSaved",reqJson)},handleValueChange:function(){var widgetFilterJson=(0,DashboardFilterHelper/* generateFilterJSON */.Me)(this.lookupFilterModel,this.dashboardFilterObj.dashboardUserFilters,this.dashboardFilterObj.widgetUserFiltersMap);try{this.cascadingFilterModel=(0,DashboardFilterHelper/* getCascadingFilterModel */.yZ)(this.dashboardUserFilters,this.lookupFilterModel)}catch(e){}this.$emit("dbUserFilters",{filterJson:widgetFilterJson,filterModel:this.lookupFilterModel})},openTimeLineFilterManager:function(){this.createTimelineEditState(),this.showTimelineFilterManager=!0},openUserFilterManager:function(){this.editStateUserFilters?(
//intermediate saved state, Edit/add filters clicked , saved ,then  Edit/add filters clicked again
this.userFilterFields=this.editStateUserFilters.filter((function(e){return e.field})).map((function(e){return(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},e.field),{},{filterOrder:e.filterOrder})})),this.userFilterModules=this.editStateUserFilters.filter((function(e){return e.module})).map((function(e){return(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},e.module),{},{filterOrder:e.filterOrder})}))):this.dashboardUserFilters&&(
//first time edit mode openened
this.userFilterFields=this.dashboardUserFilters.filter((function(e){return e.field})).map((function(e){return e.field})),this.userFilterModules=this.dashboardUserFilters.filter((function(e){return e.module})).map((function(e){return e.module}))),this.showUserFilterManager=!0},manageUserFilterSave:function(selectedOptions){var _this=this,userFilters=[],previousFilterFieldIds=[],previousFilterModuleNames=[];
// saved fields here are of two types
// contains moduleObj for a module filter and fieldObject for a ENUM filter
this.userFilterFields&&(previousFilterFieldIds=this.userFilterFields.map((function(e){return e.fieldId}))),this.userFilterModules&&(previousFilterModuleNames=this.userFilterModules.map((function(e){return e.name}))),selectedOptions.forEach((function(option,index){var userFilter=null;
//field already present as a user filter , send the same user filter  obj
userFilter="FIELD"==option.filterType&&previousFilterFieldIds.includes(option.fieldId)?_this.editStateUserFilters.find((function(e){return e.fieldId==option.fieldId})):"MODULE"==option.filterType&&previousFilterModuleNames.includes(option.name)?_this.editStateUserFilters.find((function(e){return e.moduleName==option.name})):(0,DashboardFilterHelper/* getUserFilterObj */.rj)(option),userFilter.filterOrder=index+1,userFilter.selectedOptions=[],userFilters.push(userFilter)})),this.editStateUserFilters=userFilters,
//if manage user filter dialog was opened from EMPTY STATE, and saved with a non empty value enter edit mode . ,else do nothing
this.editStateUserFilters&&this.editStateUserFilters.length>0&&(this.isEditMode=!0,this.$emit("update:filterEditMode",this.isEditMode)),this.showUserFilterManager=!1}// handleTimelineFilterChanged(timelineObj) {
//   console.log('timeline filter changed in dbfiltercontainer', timelineObj)
//   this.$emit('update:dbTimelineFilter', timelineObj)
// },
}},dashboard_filters_DashboardFilterContainervue_type_script_lang_js=DashboardFilterContainervue_type_script_lang_js,DashboardFilterContainer_component=(0,componentNormalizer/* default */.Z)(dashboard_filters_DashboardFilterContainervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,DashboardFilterContainer=DashboardFilterContainer_component.exports},
/***/699464:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return DashboardLookupFilter}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/dashboard/dashboard-filters/DashboardLookupFilter.vue?vue&type=template&id=373f54b9
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"dashboard-lookup-filter",class:_vm.enable_slider?"sliderWidth":""},[_c("div",{staticClass:"filter-label"},[_c("p",{staticClass:"filter-label-text mB0  textoverflow-ellipsis width100"},[_vm._v(" "+_vm._s(_vm.userFilterObj.label)+" ")]),_vm.isEditMode?_c("inline-svg",{staticClass:"pointer opacity-0 filter-hover-icon mR10",attrs:{src:"svgs/pencil",iconClass:"icon icon-sm",iconStyle:"color:#ee518f"},nativeOn:{click:function($event){return _vm.$emit("edit")}}}):_vm._e(),_vm.isEditMode?_c("inline-svg",{staticClass:"pointer opacity-0 filter-hover-icon",attrs:{src:"svgs/delete",iconClass:"icon icon-sm",iconStyle:"color:#e77070"},nativeOn:{click:function($event){return _vm.$emit("delete")}}}):_vm._e()],1),_vm.initialOptionsLoading&&!_vm.isEditMode?_c("el-select",{staticClass:"fc-input-full-border-h35",attrs:{placeholder:"loading ...",value:{}}}):_vm._e(),_vm.initialOptionsLoading||_vm.isEditMode?_vm.isEditMode?_c("el-select",{staticClass:"fc-input-full-border-h35",attrs:{disabled:!0,placeholder:"Select",filterable:""},model:{value:_vm.elSelectModel,callback:function($$v){_vm.elSelectModel=$$v},expression:"elSelectModel"}},[_c("el-option",{attrs:{label:"select",value:"dummy"}})],1):_vm._e():[_vm.userFilterObj.module?_c("FLookupFieldWithDefaultListWrapper",{staticClass:"rm-arrow",attrs:{label:_vm.userFilterObj.module.displayName,defaultList:_vm.defaultList,criteria:_vm.criteria,userfilmoduleEnum:_vm.userFilterObj.module.typeEnum,filterConstruction:_vm.filterConstruction,field:{lookupModule:{name:_vm.userFilterObj.module.name},multiple:_vm.isMultiple},parentModuleId:_vm.parentModuleId,selectedOptions:_vm.selectedOptions},on:{recordSelected:function(value){return _vm.setValue(value)}},model:{value:_vm.elSelectModel,callback:function($$v){_vm.elSelectModel=$$v},expression:"elSelectModel"}}):_vm.userFilterObj&&_vm.userFilterObj.field&&"DATE_TIME"===_vm.userFilterObj.field.dataTypeEnum?_c("div",[_vm._e(),_c("div",{staticClass:"block",staticStyle:{padding:"0px 3px"}},[_vm.enable_slider?_c("el-slider",{attrs:{range:"","show-stops":"",min:_vm.min_slider_range,max:_vm.max_slider_range,marks:_vm.marks,"format-tooltip":_vm.formatSliderTipVal},on:{change:_vm.setChangedSliderValue},model:{value:_vm.slider_range,callback:function($$v){_vm.slider_range=$$v},expression:"slider_range"}}):_vm._e(),_vm.enable_time_dropdown?_c("DashboardDateTimeFilterView",{attrs:{dayOrHourValues:_vm.selectedDayOrHourValues,isMultiple:_vm.isMultiple,selectedOperator:_vm.userFilterObj.defaultValues[0],userFilterObj:_vm.userFilterObj},on:{valueChanged:_vm.valueChanged}}):_vm._e()],1)],1):_c("el-select",{staticClass:" fc-input-full-border-select2 width100 resource-search",attrs:{placeholder:"Type to search",loading:_vm.initialOptionsLoading||_vm.remoteOptionsLoading,"loading-text":"loading ... ",multiple:2==_vm.userFilterObj.componentType,"collapse-tags":"",filterable:"",remote:!1,"remote-method":_vm.handleRemoteSearch},on:{change:_vm.valueChanged,"visible-change":_vm.dropDownVisibiltyChanged},model:{value:_vm.elSelectModel,callback:function($$v){_vm.elSelectModel=$$v},expression:"elSelectModel"}},_vm._l(_vm.elSelectOptions,(function(option){return _c("el-option",{key:option.value,attrs:{label:option.label,value:option.value}})})),1)]],2)},staticRenderFns=[],toConsumableArray=__webpack_require__(488478),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),utility_methods=(__webpack_require__(670560),__webpack_require__(260228),__webpack_require__(212826),__webpack_require__(450886),__webpack_require__(634338),__webpack_require__(564043),__webpack_require__(538077),__webpack_require__(879288),__webpack_require__(648324),__webpack_require__(434284),__webpack_require__(947522),__webpack_require__(169358),__webpack_require__(61514),__webpack_require__(425728),__webpack_require__(891719),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(555005)),validation=__webpack_require__(990260),debounce=__webpack_require__(23279),debounce_default=__webpack_require__.n(debounce),api=__webpack_require__(32284),FLookupFieldWithDefaultListWrappervue_type_template_id_668a716e_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"lookup-wrapper"},[_vm.fieldObj.field?_c("FLookupField",{class:{"handle-wizard-icon":_vm.handleWizardIcon},attrs:{model:_vm.modelObj,field:_vm.fieldObj,disabled:_vm.disabled,siteId:_vm.siteId,hideLookupIcon:_vm.hideWizard,hideDropDown:_vm.hideDropDown,userfilmoduleEnum:_vm.userfilmoduleEnum,preHookFilterConstruction:_vm.filterConstruction,parentModuleId:_vm.parentModuleId,selectedOptions:_vm.selectedOptions,fetchOptionsOnLoad:_vm.fetchOptionsOnLoad,fetchOptionsMethod:_vm.fetchOptionsMethod},on:{"update:model":function($event){_vm.modelObj=$event},showLookupWizard:_vm.showLookupWizard,recordSelected:_vm.onRecordSelected}}):_c("el-input"),!_vm.hideWizard&&_vm.canShowLookupWizard?_c("div",[_c("FLookupFieldWizard",{attrs:{canShowLookupWizard:_vm.canShowLookupWizard,selectedLookupField:_vm.fieldObj,siteId:_vm.siteId,withReadings:_vm.withReadings},on:{"update:canShowLookupWizard":function($event){_vm.canShowLookupWizard=$event},"update:can-show-lookup-wizard":function($event){_vm.canShowLookupWizard=$event},setLookupFieldValue:_vm.setLookupFieldValue,showMainFieldSearch:function($event){return _vm.onWizardShow(!1)}}})],1):_vm._e()],1)},FLookupFieldWithDefaultListWrappervue_type_template_id_668a716e_staticRenderFns=[],FLookupFieldWrapper=__webpack_require__(201117),FLookupFieldWithDefaultList=__webpack_require__(965875),FLookupFieldWithDefaultListWrappervue_type_script_lang_js={props:{defaultList:{type:Array,default:function(){return[]}},criteria:{type:Object},userfilmoduleEnum:{type:String},parentModuleId:{type:Number},selectedOptions:{type:Array}},extends:FLookupFieldWrapper/* default */.Z,components:{FLookupField:FLookupFieldWithDefaultList/* default */.Z},computed:{
// hideWizard(){
//   if(this.userfilmoduleEnum == 'PICK_LIST'){
//     return true
//   }
//   return false
// },
modelObj:{
// default list value handled
get:function(){var _this=this;return(0,validation/* isEmpty */.xb)(this.value)?this.value:(0,validation/* isArray */.kJ)(this.value)?this.value.map((function(val){return _this.defaultListValues.includes(val)?val:parseInt(val)})):this.defaultListValues.includes(this.value)?this.value:parseInt(this.value)},set:function(value){this.$emit("input",value)}},defaultListValues:function(){return this.defaultList.map((function(rt){return rt.value}))}},methods:{setField:function(field){var _this2=this,fieldObj=this.fieldObj;fieldObj.field=field,fieldObj.multiple=field.multiple,fieldObj.lookupModuleName=field.lookupModule.name,fieldObj.clientCriteria=this.criteria,(0,validation/* isArray */.kJ)(this.modelObj)?fieldObj.selectedItems=this.modelObj.map((function(id){if(!_this2.defaultListValues.includes(id))return{value:id}})):this.defaultListValues.includes(this.modelObj)||(fieldObj.selectedItems={value:this.modelObj})}}},components_FLookupFieldWithDefaultListWrappervue_type_script_lang_js=FLookupFieldWithDefaultListWrappervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FLookupFieldWithDefaultListWrappervue_type_script_lang_js,FLookupFieldWithDefaultListWrappervue_type_template_id_668a716e_render,FLookupFieldWithDefaultListWrappervue_type_template_id_668a716e_staticRenderFns,!1,null,null,null)
/* harmony default export */,FLookupFieldWithDefaultListWrapper=component.exports,util_utility_methods=__webpack_require__(773258),DashboardDateTimeFilterViewvue_type_template_id_175e85f4_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_vm.showDayOfWeek?_c("el-select",{staticClass:"fc-input-full-border-select2 width100 resource-search",attrs:{multiple:_vm.isMultiple,filterable:"","collapse-tags":_vm.isMultiple},on:{change:_vm.valueChanged},model:{value:_vm.computeSelectdValue,callback:function($$v){_vm.computeSelectdValue=$$v},expression:"computeSelectdValue"}},_vm._l(_vm.daysOfWeek,(function(weeks){return _c("el-option",{key:weeks.value,attrs:{label:weeks.label,value:weeks.value}})})),1):_vm._e(),_vm.showDayOfMonth?_c("el-select",{staticClass:"fc-input-full-border-select2 width100 resource-search",attrs:{multiple:_vm.isMultiple,filterable:"","collapse-tags":_vm.isMultiple},on:{change:_vm.valueChanged},model:{value:_vm.computeSelectdValue,callback:function($$v){_vm.computeSelectdValue=$$v},expression:"computeSelectdValue"}},_vm._l(_vm.daysOfMonth,(function(monthday){return _c("el-option",{key:monthday,attrs:{label:parseInt(monthday),value:monthday}})})),1):_vm._e(),_vm.showHourOfDay?_c("el-select",{staticClass:"fc-input-full-border-select2 width100 resource-search",attrs:{multiple:_vm.isMultiple,filterable:"","collapse-tags":_vm.isMultiple},on:{change:_vm.valueChanged},model:{value:_vm.computeSelectdValue,callback:function($$v){_vm.computeSelectdValue=$$v},expression:"computeSelectdValue"}},_vm._l(_vm.hourOfDay,(function(hourDay){return _c("el-option",{key:hourDay,attrs:{label:parseInt(hourDay),value:hourDay}})})),1):_vm._e()],1)},DashboardDateTimeFilterViewvue_type_template_id_175e85f4_staticRenderFns=[],DashboardDateTimeFilterViewvue_type_script_lang_js={props:["dayOrHourValues","isMultiple","selectedOperator","userFilterObj"],data:function(){return{dynamicTags:[],inputVisible:!1,inputValue:"",daysOfWeek:[{value:"1",label:"Mon"},{value:"2",label:"Tue"},{value:"3",label:"Wed"},{value:"4",label:"Thu"},{value:"5",label:"Fri"},{value:"6",label:"Sat"},{value:"7",label:"Sun"}],daysOfMonth:["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31"],hourOfDay:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23"],showHourOfDay:!1,showDayOfWeek:!1,showDayOfMonth:!1,selectedDayOrHourValues:[]}},created:function(){this.init()},computed:{computeSelectdValue:{get:function(){return null!==this&&void 0!==this&&this.isMultiple?this.selectedDayOrHourValues:this.selectedDayOrHourValues[0]},set:function(value){null!==this&&void 0!==this&&this.isMultiple?this.selectedDayOrHourValues=value:this.selectedDayOrHourValues=[value]}}},methods:{init:function(){this.selectedDayOrHourValues=this.dayOrHourValues,"103"==this.selectedOperator?this.showHourOfDay=!0:"101"==this.selectedOperator?this.showDayOfMonth=!0:"85"==this.selectedOperator&&(this.showDayOfWeek=!0)},valueChanged:function(){this.userFilterObj.selectedDayOrHourValues=this.selectedDayOrHourValues,this.$emit("valueChanged")}}},dashboard_filters_DashboardDateTimeFilterViewvue_type_script_lang_js=DashboardDateTimeFilterViewvue_type_script_lang_js,DashboardDateTimeFilterView_component=(0,componentNormalizer/* default */.Z)(dashboard_filters_DashboardDateTimeFilterViewvue_type_script_lang_js,DashboardDateTimeFilterViewvue_type_template_id_175e85f4_render,DashboardDateTimeFilterViewvue_type_template_id_175e85f4_staticRenderFns,!1,null,null,null)
/* harmony default export */,DashboardDateTimeFilterView=DashboardDateTimeFilterView_component.exports,DashboardLookupFiltervue_type_script_lang_js={props:["isEditMode","value","userFilterObj","cascadingFilterJson"],data:function(){return{lookupOptions:[],moduleList:[],remoteOptionsLoading:!1,initialOptionsLoading:!0,dateFieldOptions:[{label:"Hours of day",value:"103"},{label:"Day of week",value:"85"},{label:"Day of month",value:"101"}],enable_slider:!1,slider_range:[],max_slider_range:31,min_slider_range:0,enable_time_dropdown:!1,selectedDayOrHourValues:[],marks:{},hour12Format:"hh:mm A",daysOfWeek:{1:"Mon",2:"Tue",3:"Wed",4:"Thu",5:"Fri",6:"Sat",7:"Sun"},hourOfDaysMarks:{0:"12 AM",1:"1 AM",2:"2 AM",3:"3 AM",4:"4 AM",5:"5 AM",6:"6 AM",7:"7 AM",8:"8 AM",9:"9 AM",10:"10 AM",11:"11 AM",12:"12 PM",13:"1 PM",14:"2 PM",15:"3 PM",16:"4 PM",17:"5 PM",18:"6 PM",19:"7 PM",20:"8 PM",21:"9 PM",22:"10 PM",23:"11 PM"}}},components:{FLookupFieldWithDefaultListWrapper:FLookupFieldWithDefaultListWrapper,DashboardDateTimeFilterView:DashboardDateTimeFilterView},created:function(){this.getModuleList(),this.isEditMode||this.init()},methods:{formatSliderTipVal:function(val){var _this$userFilterObj,_this$userFilterObj2,selected_operator=(null===(_this$userFilterObj=this.userFilterObj)||void 0===_this$userFilterObj||null===(_this$userFilterObj=_this$userFilterObj.defaultValues)||void 0===_this$userFilterObj?void 0:_this$userFilterObj.length)>0?null===(_this$userFilterObj2=this.userFilterObj)||void 0===_this$userFilterObj2?void 0:_this$userFilterObj2.defaultValues[0]:"";return"103"===selected_operator&&this.$timeformat===this.hour12Format?this.hourOfDaysMarks[val]:"85"===selected_operator?this.daysOfWeek[val]:val},setChangedSliderValue:function(){var _this$userFilterObj3;if("DATE_TIME"==(null===(_this$userFilterObj3=this.userFilterObj)||void 0===_this$userFilterObj3||null===(_this$userFilterObj3=_this$userFilterObj3.field)||void 0===_this$userFilterObj3?void 0:_this$userFilterObj3.dataTypeEnum)&&this.slider_range&&2==this.slider_range.length){var _this$userFilterObj4,start=this.slider_range[0],end=this.slider_range[1];this.setMarks(null===this||void 0===this||null===(_this$userFilterObj4=this.userFilterObj)||void 0===_this$userFilterObj4?void 0:_this$userFilterObj4.defaultValues[0],start,end);var dateTimeValues=[];for(start;start<=end;start++)dateTimeValues.push(start.toString());this.userFilterObj.dateTimeValues=dateTimeValues,this.valueChanged()}},setMarks:function(operator_value,start,end){this.marks={},operator_value&&"85"===operator_value?(this.marks[start]=this.daysOfWeek[start],this.marks[end]=this.daysOfWeek[end]):operator_value&&"103"===operator_value&&(null===this||void 0===this?void 0:this.$timeformat)===this.hour12Format?(this.marks[start]=this.hourOfDaysMarks[start],this.marks[end]=this.hourOfDaysMarks[end]):(this.marks[start]=start+"",this.marks[end]=end+"")},setSliderRange:function(value){85==value?(this.slider_range=[1,7],this.max_slider_range=7,this.min_slider_range=1,this.enable_slider=!0,this.marks={1:"Mon",7:"Sun"}):101==value?(this.slider_range=[1,31],this.max_slider_range=31,this.min_slider_range=1,this.marks={1:"1",31:"31"},this.enable_slider=!0):103==value&&(this.slider_range=[0,23],this.max_slider_range=23,this.min_slider_range=0,this.$timeformat===this.hour12Format?this.marks={0:this.hourOfDaysMarks[0],23:this.hourOfDaysMarks[23]}:this.marks={0:"0",23:"23"},this.enable_slider=!0),this.valueChanged()},setValue:function(value){this.valueChanged()},dropDownVisibiltyChanged:function(visibility){
//reload options on close
!visibility&&this.isLazyLoad&&
//lookup type , for PICKLIST_LOOKUP fetch all at once, for non picklist lookup like space ,asset , lazy load
this.handleRemoteSearch()},init:function(){var _this=this;if(this.userFilterObj.field&&"ENUM"==this.userFilterObj.field.dataTypeEnum)
//for type=ENUM  ,options present inside field object itself
this.lookupOptions=(0,utility_methods/* constructFieldOptions */.aE)(this.userFilterObj.field.enumMap).map((function(e){return{value:String(e.value),label:e.label}})),this.initialOptionsLoading=!1;else if(this.userFilterObj.field&&"DATE_TIME"===this.userFilterObj.field.dataTypeEnum){var _this$userFilterObj5,_this$userFilterObj6,_this$userFilterObj7,_this$slider_range,operator_value=null;if((null===(_this$userFilterObj5=this.userFilterObj)||void 0===_this$userFilterObj5||null===(_this$userFilterObj5=_this$userFilterObj5.defaultValues)||void 0===_this$userFilterObj5?void 0:_this$userFilterObj5.length)>0&&(operator_value=this.userFilterObj.defaultValues[0],"103"==operator_value?(this.max_slider_range=23,this.min_slider_range=0,(null===this||void 0===this?void 0:this.$timeformat)===this.hour12Format?this.marks={0:this.hourOfDaysMarks[0],23:this.hourOfDaysMarks[23]}:this.marks={0:"0",23:"23"},this.lookupOptions=[this.dateFieldOptions[0]]):"101"==operator_value?(this.max_slider_range=31,this.min_slider_range=1,this.marks={1:"1",31:"31"},this.lookupOptions=[this.dateFieldOptions[2]]):"85"==operator_value&&(this.max_slider_range=7,this.min_slider_range=1,this.marks={1:"Mon",7:"Sun"},this.lookupOptions=[this.dateFieldOptions[1]])),
// this.lookupOptions = this.dateFieldOptions
this.initialOptionsLoading=!1,(null===(_this$userFilterObj6=this.userFilterObj)||void 0===_this$userFilterObj6||null===(_this$userFilterObj6=_this$userFilterObj6.selectedSliderRangeValues)||void 0===_this$userFilterObj6?void 0:_this$userFilterObj6.length)>0)this.enable_slider=!0,this.slider_range=this.userFilterObj.selectedSliderRangeValues,2==(null===(_this$slider_range=this.slider_range)||void 0===_this$slider_range?void 0:_this$slider_range.length)&&(this.marks={},"85"===operator_value?(this.marks[this.slider_range[0]]=this.daysOfWeek[this.slider_range[0]],this.marks[this.slider_range[1]]=this.daysOfWeek[this.slider_range[1]]):"103"===operator_value&&this.$timeformat===this.hour12Format?(this.marks[this.slider_range[0]]=this.hourOfDaysMarks[this.slider_range[0]],this.marks[this.slider_range[1]]=this.hourOfDaysMarks[this.slider_range[1]]):(this.marks[this.slider_range[0]]=this.slider_range[0]+"",this.marks[this.slider_range[1]]=this.slider_range[1]+""));else(null===(_this$userFilterObj7=this.userFilterObj)||void 0===_this$userFilterObj7||null===(_this$userFilterObj7=_this$userFilterObj7.selectedDayOrHourValues)||void 0===_this$userFilterObj7?void 0:_this$userFilterObj7.length)>0&&(this.enable_slider=!1,this.enable_time_dropdown=!0,this.selectedDayOrHourValues=this.userFilterObj.selectedDayOrHourValues)}else this.userFilterObj.module&&
//lookup type , for PICKLIST_LOOKUP fetch all at once, for non picklist lookup like space ,asset , lazy load
this.getOptions(null,!0).then((function(options){_this.lookupOptions=options,_this.initialOptionsLoading=!1}))},valueChanged:function(){this.$emit("valueChanged")},handleRemoteSearch:debounce_default()(function(){var _ref=(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(search){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return this.remoteOptionsLoading=!0,_context.next=4,this.getOptions(search);case 4:this.lookupOptions=_context.sent,this.remoteOptionsLoading=!1;case 6:case"end":return _context.stop()}}),_callee,this)})));return function(_x){return _ref.apply(this,arguments)}}(),1e3),getModuleList:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var _yield$API$get,data,error,customModules,systemModules;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,api/* API */.bl.get("v3/modules/list/all");case 2:_yield$API$get=_context2.sent,data=_yield$API$get.data,error=_yield$API$get.error,error||(customModules=data.customModules,systemModules=data.systemModules,_this2.moduleList=[].concat((0,toConsumableArray/* default */.Z)(customModules),(0,toConsumableArray/* default */.Z)(systemModules)));case 6:case"end":return _context2.stop()}}),_callee2)})))()},filterConstruction:function(){var parentModuleId=this.parentModuleId,filters={};return parentModuleId&&(filters={parentModuleId:{operatorId:9,value:["".concat(parentModuleId)]}}),filters},getOptions:function(search,isInitialFetch){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var params,currentySelectedOptions,criteria,conditionId,userFilterObj,_ref2,module,_ref3,name,_yield$API$post,data,error,options,pickList,basespaces;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:if(
//,called for PICKLIST where data_type=lookup
//for baseentity module type lookup , lazy load done,remote search ,
// for picklist module lookup load all values upfront,this method called only on init
params={},_this3.isLazyLoad&&(params.search=search,(0,validation/* isEmpty */.xb)(params.search)&&(
//set "" to null ,when user delete search param ,must load first 10 options not options for "" which is empty
params.search=null),params.page=1,params.perPage=10,
//make sure currently selected lookup record always resolves  its  id ->label,
currentySelectedOptions=_this3.value.filter((function(e){return"all"!=e&&"others"!=e})),currentySelectedOptions=currentySelectedOptions.map((function(e){return Number(e)})),2==_this3.userFilterObj.optionType)){if(criteria=_this3.userFilterObj.criteria,criteria&&criteria.conditions)
//dont send operator as there is no enum setter for operator,causes struts error,operatorId is sent which will suffice
for(conditionId in criteria.conditions)delete criteria.conditions[conditionId].operator;params.criteria=criteria}if(_this3.cascadingFilterJson&&(params.filters=JSON.stringify(_this3.cascadingFilterJson)),
//else for picklist type lookups can load all records as there will be few in number, no params
//basespace response returing an array instead of map , must fix api
userFilterObj=_this3.userFilterObj,_ref2=userFilterObj||{},module=_ref2.module,_ref3=module||{},name=_ref3.name,"ticketstatus"===name){_context3.next=21;break}return _context3.next=9,api/* API */.bl.post("v2/picklist/".concat(name),params);case 9:if(_yield$API$post=_context3.sent,data=_yield$API$post.data,error=_yield$API$post.error,!error){_context3.next=16;break}_this3.$message.error(error.message),_context3.next=21;break;case 16:return options=[],pickList=data.pickList,basespaces=data.basespaces,pickList?Object.keys(pickList).forEach((function(key){options.push({label:pickList[key],value:String(key)})})):basespaces&&((0,validation/* isEmpty */.xb)(basespaces)||(options=basespaces.map((function(e){return{value:String(e.id),label:e.name}})))),_this3.$forceUpdate(),_context3.abrupt("return",options);case 21:case"end":return _context3.stop()}}),_callee3)})))()}},computed:{criteria:function(){return 2==this.userFilterObj.optionType?this.userFilterObj.criteria:null},parentModuleId:function(){var userFilterObj=this.userFilterObj,_ref4=userFilterObj||{},parentModuleName=_ref4.parentModuleName;if(parentModuleName){var modules=this.moduleList.find((function(m){return m.name===parentModuleName}));if(!(0,validation/* isEmpty */.xb)(modules))return modules.moduleId}return null},selectedOptions:function(){var userFilterObj=this.userFilterObj,_ref5=userFilterObj||{},selectedOptions=_ref5.selectedOptions;return selectedOptions||[]},isMultiple:function(){var _this$userFilterObj8;return!(null===(_this$userFilterObj8=this.userFilterObj)||void 0===_this$userFilterObj8||!_this$userFilterObj8.componentType||2!==this.userFilterObj.componentType)},defaultList:function(){var options=[];return this.userFilterObj.isAllOptionEnabled&&options.unshift({label:"All",value:"all"}),2==this.userFilterObj.optionType&&this.userFilterObj.isOthersOptionEnabled&&options.push({label:"Others",value:"others"}),options},isLazyLoad:function(){if(!this.isEditMode)
//for non picklist lookup module ,need to lazy load the options
return this.userFilterObj.module&&"PICK_LIST"!=this.userFilterObj.module.typeEnum},elSelectModel:{get:function(){if(!this.isEditMode)return 1==this.userFilterObj.componentType?this.value[0]:2==this.userFilterObj.componentType?this.value:null},set:function(value){
//add toggle logic for all,
if(1==this.userFilterObj.componentType)this.$emit("input",[String(value)]);else if(2==this.userFilterObj.componentType){var val=[];value.forEach((function(rt){val.push(String(rt))})),this.$emit("input",val)}}},elSelectOptions:function(){var _this$userFilterObj9,_this4=this;if(!this.isEditMode){var options=(0,util_utility_methods/* deepCloneObject */.kh)(this.lookupOptions);
//for enum and lookup with module=picklist filter options if only certain options are selected
return 2!=this.userFilterObj.optionType||this.isLazyLoad||(options=options.filter((function(e){return _this4.userFilterObj.selectedOptions.includes(e.value)}))),"DATE_TIME"!==(null===(_this$userFilterObj9=this.userFilterObj)||void 0===_this$userFilterObj9||null===(_this$userFilterObj9=_this$userFilterObj9.field)||void 0===_this$userFilterObj9?void 0:_this$userFilterObj9.dataTypeEnum)&&this.userFilterObj.isAllOptionEnabled&&options.unshift({label:"All",value:"all"}),2==this.userFilterObj.optionType&&this.userFilterObj.isOthersOptionEnabled&&options.push({label:"Others",value:"others"}),options}}}},dashboard_filters_DashboardLookupFiltervue_type_script_lang_js=DashboardLookupFiltervue_type_script_lang_js,DashboardLookupFilter_component=(0,componentNormalizer/* default */.Z)(dashboard_filters_DashboardLookupFiltervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,DashboardLookupFilter=DashboardLookupFilter_component.exports},
/***/143838:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return MobileWidget}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/dashboard/widget/WidgetLayouts/MobileWidget.vue?vue&type=template&id=35a70e90
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{directives:[{name:"observe-visibility",rawName:"v-observe-visibility",value:!!_vm.isLazyDashboard&&_vm.handleViewportVisibilityChange,expression:"\n    isLazyDashboard ? handleViewportVisibilityChange : false\n  "}],staticClass:"fc-widget f-mobile-widget",class:_vm.widget.header.title,staticStyle:{width:"100%",height:"100%"},style:!_vm.widget.type||"static"!==_vm.widget.type||"profilecard"!==_vm.widget.dataOptions.staticKey&&"weathercard"!==_vm.widget.dataOptions.staticKey&&"energycard"!==_vm.widget.dataOptions.staticKey&&"energycostaltayer"!==_vm.widget.dataOptions.staticKey&&"weathercardaltayer"!==_vm.widget.dataOptions.staticKey&&"cumulativesavings"!==_vm.widget.dataOptions.staticKey&&"weathermini"!==_vm.widget.dataOptions.staticKey&&"profilemini"!==_vm.widget.dataOptions.staticKey&&"carbonmini"!==_vm.widget.dataOptions.staticKey&&"energycostmini"!==_vm.widget.dataOptions.staticKey&&"readingcard"!==_vm.widget.dataOptions.staticKey?"border:solid 1px #eae8e8":"border:0px",attrs:{id:_vm.widget.id?_vm.widget.id:-1}},[_vm.viewHeader(_vm.widget.header)?_c("div",{staticClass:"row fc-widget-header",on:{click:function($event){return _vm.sendDataToMobile()}}},[_c("div",{staticClass:"col-8",staticStyle:{overflow:"hidden"}},[_vm.mode&&_vm.changeheader?_c("el-input",{staticClass:"create-dashboard-input-title f18 fc-widget-label ellipsis",attrs:{autofocus:!0,placeholder:""},on:{blur:function($event){return _vm.blurevent()}},model:{value:_vm.widget.header.title,callback:function($$v){_vm.$set(_vm.widget.header,"title",$$v)},expression:"widget.header.title"}}):(_vm.moduleName,_c("div",{staticClass:"f18 fc-widget-label",on:{dblclick:function($event){return _vm.editheader("edit")}}},[_vm._v(" "+_vm._s(_vm.widget.header.title)+" ")])),_vm.widget.header.subtitle?_c("div",{staticClass:"fc-widget-sublabel"},[_vm._v(" "+_vm._s(_vm.setSubTitle||_vm.emptyTitle)+" ")]):_c("div",{staticClass:"fc-widget-sublabel"},[_vm._v(_vm._s(_vm.emptyTitle))])],1),"static"==_vm.widget.type||_vm.isReadOnly?_vm._e():_c("div",{staticClass:"col-4"},[_c("div",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"pull-right externalLink",attrs:{title:_vm.$t("home.dashboard.open_full_view")}},[_c("img",{staticClass:"chart-icon-report",attrs:{src:__webpack_require__(396295)},on:{click:function($event){return _vm.openReport(_vm.widget.dataOptions.reportId,_vm.widget)}}})]),_c("div",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"pull-right chart-delete-icon",attrs:{title:"Delete widget"}},[_c("i",{staticClass:"el-icon-delete f18",on:{click:function($event){return _vm.deleteChart(_vm.widget,_vm.dashboard)}}})]),_c("div",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"pull-right chart-icon-hide",attrs:{title:"Hide widget"}},[_c("i",{staticClass:"el-icon-view f18",on:{click:function($event){return _vm.hideWidget(_vm.widget,_vm.dashboard)}}})])])]):_vm._e(),_c("div",{staticClass:"en-divider",style:!_vm.widget.type||"static"!==_vm.widget.type||"profilecard"!==_vm.widget.dataOptions.staticKey&&"weathercard"!==_vm.widget.dataOptions.staticKey&&"energycard"!==_vm.widget.dataOptions.staticKey&&"energycostaltayer"!==_vm.widget.dataOptions.staticKey&&"weathercardaltayer"!==_vm.widget.dataOptions.staticKey&&"cumulativesavings"!==_vm.widget.dataOptions.staticKey&&"weathermini"!==_vm.widget.dataOptions.staticKey&&"profilemini"!==_vm.widget.dataOptions.staticKey&&"carbonmini"!==_vm.widget.dataOptions.staticKey&&"energycostmini"!==_vm.widget.dataOptions.staticKey&&"readingcard"!==_vm.widget.dataOptions.staticKey&&"fahuStatusCard"!==_vm.widget.dataOptions.staticKey&&"fahuStatusCard1"!==_vm.widget.dataOptions.staticKey?"display:block;":"display:none;"}),_c("spinner",{attrs:{show:_vm.loading,size:"80"}}),_c("div",{staticClass:"self-center",class:{"fc-widget-body":null!==_vm.widget.header.title,"fc-widget-dragable-body":null===_vm.widget.header.title}},[!_vm.loading&&_vm.failed?_c("div",[_vm._v(" "+_vm._s(_vm.$t("common._common.load_data_failed"))+" ")]):_vm._e(),_c("div",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"pull-right chart-delete-icon",attrs:{title:"Delete widget"}},[_c("i",{staticClass:"el-icon-delete f18",on:{click:function($event){return _vm.deleteChart(_vm.widget,_vm.dashboard)}}})]),_vm._l(_vm.tooltipdata,(function(toolTip,index){return _c("div",{key:index,staticClass:"tooltip-data"},[_vm._v(" "+_vm._s(_vm.tooltipdata.value)+" ")])})),_c(_vm.widgetType,{directives:[{name:"show",rawName:"v-show",value:_vm.showTabularReport,expression:"showTabularReport"}],ref:"widgetComponent",tag:"component",class:{"fc-secondChart":_vm.multiChartMapping[_vm.widget.id]},attrs:{config:{widget:_vm.widget,currentDashboard:_vm.currentDashboard,intervalUpdate:_vm.intervalUpdate,id:_vm.widget.dataOptions.reportId,width:Math.round(_vm.widgetSize.width),height:Math.round(_vm.widgetSize.height),isReportUpdateFromDashboard:!0},reportId:_vm.$getProperty(_vm.widget,"dataOptions.newReportId"),isMobileDashboard:!0,mode1:_vm.mode,getReportUtil:_vm.sendUtil,dbFilterJson:_vm.dbFilterJson,dbTimelineFilter:_vm.dbTimelineFilter,isLazyDashboard:_vm.isLazyDashboard,isVisibleInViewport:_vm.isVisibleInViewport},on:{tooltipdata:_vm.getTooltipData,onload:_vm.reportLoaded,dateFilterUpdated:_vm.dateFilterUpdated,reportUtil:_vm.getReportutil,reportLoaded:_vm.getNewReportObj}}),_vm.report&&"tabular"===_vm.report.options.type?_c("f-tabular-report",{attrs:{reportObject:_vm.reportObject}}):_vm._e()],2)],1)},staticRenderFns=[],createForOfIteratorHelper=__webpack_require__(566347),FReport=(__webpack_require__(976801),__webpack_require__(879288),__webpack_require__(434284),__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(670560),__webpack_require__(648324),__webpack_require__(712744)),FNewReport=__webpack_require__(862423),FListWidget=__webpack_require__(293708),FCountWidget=__webpack_require__(528727),FMapWidget=__webpack_require__(307765),FStaticWidget=__webpack_require__(776906),Fcards=__webpack_require__(972258),FWebWidget=__webpack_require__(486829),FTabularReport=__webpack_require__(329744),moment=__webpack_require__(730381),moment_default=__webpack_require__.n(moment),MobileModuleNewReportvue_type_template_id_2926518d_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"height100 mobile-report"},[_c("div",{staticClass:"datefilter-hide-overlay"}),_vm.showDatePicker?_c("div",{staticStyle:{"text-align":"center"}},[_c("new-date-picker",{staticClass:"filter-field date-filter-comp-new-report",attrs:{zone:_vm.$timezone,dateObj:_vm.dateFilter},on:{date:_vm.setDateFilter}})],1):_vm._e(),_vm.loading?_c("spinner",{attrs:{show:_vm.loading,size:"80"}}):_vm.failed?_c("div",{staticStyle:{"margin-top":"30px",opacity:"0.7","font-size":"13px",padding:"50px","line-height":"25px","text-align":"center"}},[_c("div",[_vm._v(_vm._s(_vm.$t("home.dashboard.data_loading_failed")))])]):_vm.noData?_c("div",{staticStyle:{"font-size":"13px",padding:"80px 50px 50px 50px","line-height":"25px","text-align":"center"}},[_c("inline-svg",{attrs:{src:"svgs/emptystate/reportlist",iconClass:"icon text-center icon-100"}}),_c("div",{staticClass:"nowo-label f13"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.empty_data"))+" "),_vm.resultObj&&_vm.resultObj.dateRange?_c("span",{staticClass:"bold"},[_vm._v(_vm._s(_vm._f("formatPeriod")(_vm.resultObj.dateRange.value,"MMM DD, YYYY")))]):_vm._e()])],1):_c("div",{staticClass:"height100"},[_c("div",{class:{height100:_vm.config}},[_c("f-mobile-chart",{ref:"newChart",attrs:{showWidgetLegends:!1,width:_vm.config&&_vm.config.width?_vm.config.width:null,resultObj:_vm.resultObj,height:_vm.config&&_vm.config.height?_vm.config.height:null,data:_vm.reportObj.data,options:_vm.reportObj.options,dateRange:_vm.reportObj.dateRange,reportType:_vm.reportObj.reportType,isWidget:!!_vm.config,hidecharttypechanger:_vm.config&&_vm.config.widget},on:{mobiledrilldown:_vm.drilldown}})],1),_vm.reportObj?_c("div",[!1===_vm.failed&&!1===_vm.loading&&!1===_vm.reportObj.options.settings.chart?_c("modular-new-tabular-report",{ref:"newTable",staticClass:"new-analytics-table",attrs:{reportObject:_vm.resultObj,reportConfig:_vm.reportObj}}):_vm._e()],1):_vm._e()])],1)},MobileModuleNewReportvue_type_template_id_2926518d_staticRenderFns=[],NewDatePicker=(__webpack_require__(169358),__webpack_require__(900773)),FMobileChart=__webpack_require__(242208),NewDataFormatHelper=__webpack_require__(804911),ModularNewTabularReport=__webpack_require__(340737),NewDateHelper=__webpack_require__(105534),ModularAnalyticmixin=__webpack_require__(795e3),lodash=__webpack_require__(496486),MobileModuleNewReportvue_type_script_lang_js={props:["id","config","tabular","dbFilterJson","dbTimelineFilter"],mixins:[NewDataFormatHelper/* default */.Z,ModularAnalyticmixin/* default */.Z],components:{NewDatePicker:NewDatePicker/* default */.Z,ModularNewTabularReport:ModularNewTabularReport/* default */.Z,FMobileChart:FMobileChart/* default */.Z},data:function(){return{activeReportTab:"tabular",loading:!0,failed:!1,noData:!1,reportObj:null,resultObj:null,showReportOptions:!1,dateFilter:null,userFilterApplied:null,moduleName:null,showDatePicker:!1}},created:function(){
//on report load , db date filter overrides report date filter . on further change of either ,the change is applied
if(this.dbTimelineFilter){var pickerObj=NewDateHelper/* default */.Z.getDatePickerObject(this.dbTimelineFilter.operatorId,this.dbTimelineFilter.dateValueString);this.setDateFilter(pickerObj)}},mounted:function(){this.init()},computed:{reportId:function(){return this.id?this.id:this.config?this.config.widget.dataOptions.newReportId:null},appliedDateRange:function(){if(this.$route.query.daterange)return JSON.parse(this.$route.query.daterange)},appliedChartType:function(){
// Temp...will be changed for pdf once temp report support is implemented
return this.$route.query.charttype}},watch:{reportId:{handler:function(newData,oldData){this.dateFilter=null,this.init(!1)}},dbFilterJson:function(newValue,oldValue){(0,lodash.isEqual)(newValue,oldValue)||this.init()},dbTimelineFilter:function(newValue,oldValue){if(!(0,lodash.isEqual)(newValue,oldValue)){var pickerObj=NewDateHelper/* default */.Z.getDatePickerObject(newValue.operatorId,newValue.dateValueString);this.setDateFilter(pickerObj),this.datePickerCompKey++}},config:{handler:function(newData,oldData){newData&&oldData?newData.id!==oldData.id?this.init(!1):this.$emit("reportLoaded",this.reportObj,this.resultObj):this.init(!1)},deep:!0}},methods:{drilldown:function(val){this.isXFieldCrossModule||this.isGroupByCrossModule||this.handleBasicDrillDown(val,this.resultObj,this.reportObj,this.filters)},setDateFilter:function(dateFilter){this.dateFilter=dateFilter,this.userFilterApplied?this.applyFilter(this.userFilterApplied):this.initchart()},init:function(){this.initchart()},resize:function(){this.$refs["newChart"]&&this.$refs["newChart"].resize(),this.$refs["multiChart"]&&this.$refs["multiChart"].resize(),this.$refs["newTable"]&&this.$refs["newTable"].resize()},initchart:function(){var _this=this;this.loading=!0,this.failed=!1,this.noData=!1;
// this.reportObj = null
// let query = {}
// query['reportId'] = this.reportId
// if (this.showDatePicker && this.dateFilter !== null) {
//   query['startTime'] = this.dateFilter.value[0]
//   query['endTime'] = this.dateFilter.value[1]
// }
var params={reportId:this.reportId};this.dateFilter&&(params.startTime=this.dateFilter.value[0],params.endTime=this.dateFilter.value[1]),this.filters&&(params["filters"]=this.filters),this.dbFilterJson&&(params["filters"]=JSON.stringify(this.dbFilterJson)),this.$http.post("/v2/report/executeReport",params).then((function(response){var result=_this.specialHandler(response.data.result),self=_this;if(0===result.reportData.data.length){if(self.noData=!0,self.loading=!1,self.moduleName=result.module.name,-1!==result.report.dateOperator)if(null===_this.dateFilter){var datePickerObject=NewDateHelper/* default */.Z.getDatePickerObject(result.report.dateOperator,result.report.dateValue);result["dateRange"]=datePickerObject,self.dateFilter=datePickerObject,self.showDatePicker=!0}else result["dateRange"]=self.dateFilter;result.xAggr=result.report.xAggr,
// this.reportObj = this.prepareReport(result)
self.resultObj=result,self.$emit("reportLoaded",null,response.data.result)}else{if(_this.moduleName=result.module.name,-1!==result.report.dateOperator)if(null===_this.dateFilter){var _datePickerObject=NewDateHelper/* default */.Z.getDatePickerObject(result.report.dateOperator,result.report.dateValue);result["dateRange"]=_datePickerObject,self.dateFilter=_datePickerObject,self.showDatePicker=!0}else result["dateRange"]=self.dateFilter;else result["dateRange"]=self.dateFilter;result.xAggr=result.report.xAggr,self.reportObj=_this.prepareReport(result),
//do not persist any options from old resultObj or from chartState while drilling down
self.handleAxisChartState(self.reportObj,self.resultObj,result),self.resultObj=result,self.appliedChartType&&(self.reportObj.options.data.type=_this.appliedChartType),self.$emit("reportLoaded",self.reportObj,self.resultObj),self.loading=!1}}))}}},report_MobileModuleNewReportvue_type_script_lang_js=MobileModuleNewReportvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(report_MobileModuleNewReportvue_type_script_lang_js,MobileModuleNewReportvue_type_template_id_2926518d_render,MobileModuleNewReportvue_type_template_id_2926518d_staticRenderFns,!1,null,null,null)
/* harmony default export */,MobileModuleNewReport=component.exports,FGraphicsWidget=__webpack_require__(263099),PivotTableWrapper=__webpack_require__(302347),types=["chart","newchart","view","map","count","static","web","cards","moduleName"],MobileWidgetvue_type_script_lang_js={props:{isLazyDashboard:{type:Boolean,default:!1},type:{type:String,required:!0,validator:function(val){return types.includes(val)}},widget:{type:Object,required:!0,default:function(){return{}}},currentDashboard:{type:Object},demoData:{type:Object},grid:{type:Object},rowHeight:{type:Number},dashboard:{type:Number},mode:{type:Boolean},moduleName:{type:String},dbFilterJson:{type:Object},dbTimelineFilter:{type:Object}},components:{"f-chart-widget":FReport/* default */.Z,"f-newchart-widget":FNewReport/* default */.Z,"f-view-widget":FListWidget/* default */.Z,"f-count-widget":FCountWidget/* default */.Z,"f-map-widget":FMapWidget/* default */.Z,"f-static-widget":FStaticWidget/* default */.Z,"f-cards-widget":Fcards/* default */.Z,"f-web-widget":FWebWidget["default"],"f-tabular-report":FTabularReport/* default */.Z,"f-modular-report-widget":MobileModuleNewReport,"f-graphics-widget":FGraphicsWidget/* default */.Z,"f-pivot-table-wrapper-widget":PivotTableWrapper/* default */.Z},data:function(){return{loading:!1,failed:!1,changeheader:!1,tooltipdata:null,newReportObj:null,sendUtil:null,data:null,report:null,reportObject:null,selectedPeriod:null,refreshInterval:null,setSubTitle:"",emptyTitle:"Today",ChartType:null,multiChartMapping:{},isVisibleInViewport:!1}},mounted:function(){},destroyed:function(){this.cleanupRefreshInterval()},computed:{isReadOnly:function(){return!(!this.currentDashboard||!this.currentDashboard.readOnly)},widgetSize:function(){var w=null,h=null;return this.grid?(w=this.grid.w,h=this.grid.h):(w=this.widget.layout.width,h=this.widget.layout.height),this.$el?this.newReportObj?{width:w*(this.rowHeight?this.rowHeight:100),height:this.$el.offsetHeight-(this.newReportObj&&this.newReportObj.options&&this.newReportObj.options.widgetLegend&&this.newReportObj.options&&this.newReportObj.options.widgetLegend.show?160:60)}:{width:w*(this.rowHeight?this.rowHeight:100),height:this.$el.offsetHeight-(this.report&&this.report.options.showWidgetLegends?120:60)}:{width:w*(this.rowHeight?this.rowHeight:100),height:h*(this.rowHeight?this.rowHeight:100)+120}},widgetType:function(){var _this$widget;return this.widget.dataOptions.newReportId?this.widget.dataOptions.newReport&&2===this.widget.dataOptions.newReport.type||2===this.widget.dataOptions.reportType?"f-modular-report-widget":5===(null===(_this$widget=this.widget)||void 0===_this$widget||null===(_this$widget=_this$widget.dataOptions)||void 0===_this$widget?void 0:_this$widget.reportType)?"f-pivot-table-wrapper-widget":"f-newchart-widget":"f-"+this.widget.type+"-widget"},classObject:function(){if(this.widget.layout.width){var className="col-"+3*this.widget.layout.width;return className}return"col-1"},showTabularReport:function(){return!this.report||this.report&&"matrix"!==this.report.options.type&&"tabular"!==this.report.options.type}},methods:{handleViewportVisibilityChange:function(isVisible,entry){
//one set state from false to true, DONT reset it to false when widget goes out of view again , no need to trigger refresh again. see watcher for isVisibleInViewport inside report comp
isVisible&&(this.isVisibleInViewport=isVisible)},getNewReportObj:function(report,result){report&&result&&(this.newReportObj=report,this.$emit("reportLoaded",report,result))},getWidget:function(widget){if(widget)
// if (widget.dataOptions && widget.dataOptions.chartType) {
//   widget.dataOptions.chartType = 'boolean'
// }
return widget},cleanupRefreshInterval:function(){this.refreshInterval&&(clearInterval(this.refreshInterval),this.refreshInterval=null)},initData:function(){var self=this;self.loading=!0,!this.selectedPeriod&&this.widget.header&&this.widget.header.periods&&(this.selectedPeriod=this.widget.header.periods[0].value,this.widget.header.subtitle=this.selectedPeriod);var url=this.widget.dataOptions.dataurl;this.selectedPeriod&&(url=url.indexOf("?")>0?url+"&period="+this.selectedPeriod:url+"?period="+this.selectedPeriod),self.$http.get(url).then((function(response){if(self.loading=!1,response.data.reportData){self.data={xAxis:{},yAxis:{},name:self.widget.dataOptions.name};var reportData=response.data.reportData.filter((function(item){return!!item.label||!(!item.value||item.label)&&(item.label="unknown",!0)}));self.data=reportData}else self.widget.dataKey&&response.data[self.widget.dataKey]?self.data=response.data[self.widget.dataKey]:self.widget.dataKey&&response.data.length?self.data=response.data:self.demoData?self.data=self.demoData:self.failed=!0})).catch((function(error){error&&(self.loading=!1,self.failed=!0)}))},intervalUpdate:function(interval){this.widget.dataOptions.refresh_interval=interval,this.cleanupRefreshInterval()},reportLoaded:function(report,reportObject){var self=this;this.report=report,this.reportObject=reportObject,null!==self.report&&null!==self.report.options.timeObject.time&&(
// console.log('********** reportLoaded loop', moment(self.report.options.timeObject.time[0]).calendar(), moment(self.report.options.timeObject.time[1]).calendar())
// self.setSubTitle = moment(self.report.options.timeObject.time[0]).calendar().split(' at')[0]
self.setSubTitle=self.timeForm(self.report.options.timeObject.time,self.report.options.timeObject.field))},dateFilterUpdated:function(fulldate){this.$refs["widgetChildComponent"]&&this.$refs["widgetChildComponent"].setDateFilter(fulldate)},timeForm:function(time,option){
// console.log('********* option', option)
return"D"===option?moment_default()(time[0]).calendar().split(" at")[0]:"W"===option||"M"===option||"Y"===option?moment_default()(time[0]).tz(this.$timezone).format("MMM DD, YYYY")+" - "+moment_default()(time[1]).tz(this.$timezone).format("MMM DD, YYYY"):""},getThisperiod:function(option){return"D"===option?"Today":"W"===option?"This Week":"M"===option?"This Month":"Y"===option?"This Year":""},selectPeriod:function(period){this.selectedPeriod=period.value,this.widget.header.subtitle=period.value},getPeriod:function(period){switch(period=period.toLowerCase(),period){case"current week":var firstDay=moment_default()().startOf("week"),endDay=moment_default()().endOf("week");return moment_default()(firstDay).format("DD")+" - "+moment_default()(endDay).format("DD MMM YYYY");case"last week":var lastWeekStart=moment_default()().subtract(1,"weeks").startOf("week"),lastWeekEnd=moment_default()().subtract(1,"weeks").endOf("week");return moment_default()(lastWeekStart).format("DD")+" - "+moment_default()(lastWeekEnd).format("DD MMM YYYY");case"today":return moment_default()(new Date).format("DD MMM YYYY")}return period},openReport:function(id,widget){var currentModule=this.getCurrentModule();if("view"===widget.type){var modulePath="";"workorder"===widget.dataOptions.moduleName?modulePath="/app/wo/orders/"+widget.dataOptions.viewName:"alarm"===widget.dataOptions.moduleName&&(modulePath="/app/fa/faults/"+widget.dataOptions.viewName),this.$router.push(modulePath)}else{var _modulePath="/app/wo";if(_modulePath="alarm"===currentModule.module?"/app/fa":"energydata"===currentModule.module?"/app/em":"/app/wo",widget.dataOptions.newReportId){var url=_modulePath+"/reports/newview/"+widget.dataOptions.newReportId;this.$router.push(url)}else if(id){var _url=_modulePath+"/reports/view/"+id;if(this.$route.params&&"buildingdashboard"===this.$route.params.dashboardlink&&this.$route.params.buildingid){var data={buildingid:parseInt(this.$route.params.buildingid)};this.$router.push({path:_url,query:{reportSpaceFilterContext:JSON.stringify(data)}})}else if(this.$route.params&&("chillerplant"===this.$route.params.dashboardlink||"chillers"===this.$route.params.dashboardlink)&&this.$route.params.buildingid){var _data={chillerId:parseInt(this.$route.params.buildingid)};this.$router.push({path:_url,query:{reportSpaceFilterContext:JSON.stringify(_data)}})}else this.$router.push(_url)}}},getCurrentModule:function(){var routeObj=this.$route,module=null,rootPath=null;if(routeObj.meta.module)module=routeObj.meta.module,rootPath=routeObj.path;else if(routeObj.matched){var _step,_iterator=(0,createForOfIteratorHelper/* default */.Z)(routeObj.matched);try{for(_iterator.s();!(_step=_iterator.n()).done;){var matchedRoute=_step.value;if(matchedRoute.meta.module){module=matchedRoute.meta.module,rootPath=matchedRoute.path;break}}}catch(err){_iterator.e(err)}finally{_iterator.f()}}return{module:module,rootPath:rootPath}},deleteChart:function(widget,dashboard){var data={widgetId:widget.id,dashboardId:dashboard,widget:widget};this.$emit("deletechart",data)},hideWidget:function(widget,dashboard){var data={widgetId:widget.id,dashboardId:dashboard,widget:widget};this.$emit("hidewidget",data)},editheader:function(){this.changeheader=!0},blurevent:function(){""===this.widget.header.title?this.changeheader=!0:this.changeheader=!1,this.$emit("widget",this.widget)},addwidgetHedaer:function(){this.changeheader=!0},viewHeader:function(header){return!(!header||!header.title)||!!this.changeheader},getReportutil:function(data){this.ChartType=data.ChartType?data.ChartType:"line"},sendReportUtil:function(data){this.sendUtil=data},getTooltipData:function(data){this.tooltipdata=data},getdateFilter:function(report){var dateFilter={};return report.dateOperator&&this.$set(dateFilter,"operatorId",report.dateOperator),report.dateRange&&this.$set(dateFilter,"value",report.dateRange),dateFilter},sendDataToMobile:function(){if(!this.widget.dataOptions.dateFilter&&this.widget.dataOptions.newReport&&(this.widget.dataOptions.dateFilter=this.getdateFilter(this.widget.dataOptions.newReport)),this.getMobileRedirectUrl(this.widget),window.JSReceiver&&this.widget&&this.widget.dataOptions&&this.widget.dataOptions.newReportId)!this.widget.dataOptions.dateFilter&&this.widget.dataOptions.newReport&&(this.widget.dataOptions.dateFilter=this.getdateFilter(this.widget.dataOptions.newReport)),window.JSReceiver.sendData(JSON.stringify(this.getMobileRedirectUrl(this.widget)),JSON.stringify(this.widget));else if(this.$route.query&&this.$route.query.media&&"ios"===this.$route.query.media&&this.widget&&this.widget.dataOptions&&this.widget.dataOptions.newReportId){!this.widget.dataOptions.dateFilter&&this.widget.dataOptions.newReport&&(this.widget.dataOptions.dateFilter=this.getdateFilter(this.widget.dataOptions.newReport));var data={url:this.getMobileRedirectUrl(this.widget)};document.location.href="dashboard_reports://"+JSON.stringify(data)}},getAsPositiveNumber:function(value){return parseInt(value)>0?parseInt(value):parseInt(value)<0?-1*parseInt(value):null},getMobileRedirectUrl:function(widget){if(widget&&widget.dataOptions&&widget.dataOptions.newReportId&&this.newReportObj){var url={};if(this.$timezone&&(url.timezone=this.$timezone),this.$currency&&(url.currency=this.$currency),this.newReportObj&&this.newReportObj.dateRange){var dateFilter={operatorId:this.newReportObj.dateRange.operatorId,value:this.getAsPositiveNumber(this.newReportObj.dateRange.value)>0?this.getAsPositiveNumber(this.newReportObj.dateRange.value)+"":this.newReportObj.dateRange.time};(62===this.newReportObj.dateRange.operatorId||63===this.newReportObj.dateRange.operatorId||64===this.newReportObj.dateRange.operatorId||65===this.newReportObj.dateRange.operatorId||66===this.newReportObj.dateRange.operatorId||67===this.newReportObj.dateRange.operatorId||20===this.newReportObj.dateRange.operatorId)&&(dateFilter.value=this.newReportObj.dateRange.time),url.dateFilter=dateFilter}else if(this.widget&&this.widget.dataOptions&&this.widget.dataOptions.dateFilter){var _dateFilter=this.widget.dataOptions.dateFilter;url.dateFilter=NewDateHelper/* default */.Z.getDatePickerObject(_dateFilter.operatorId)}return this.newReportObj&&this.newReportObj.options&&(this.newReportObj.options.dataPoints&&this.newReportObj.options.dataPoints.length?url.period=this.newReportObj.options.dataPoints[0].aggr:url.period=0),this.widget&&this.widget.dataOptions&&this.widget.dataOptions.newReportId&&(url.reportId=this.widget.dataOptions.newReportId),url.title="",this.widget&&this.widget.header&&this.widget.header.title&&(url.title=this.widget.header.title),url}}}},WidgetLayouts_MobileWidgetvue_type_script_lang_js=MobileWidgetvue_type_script_lang_js,MobileWidget_component=(0,componentNormalizer/* default */.Z)(WidgetLayouts_MobileWidgetvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,MobileWidget=MobileWidget_component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/24192.js.map