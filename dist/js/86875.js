(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[86875,10321,32686,80865,53021],{
/***/42525:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return ApprovalBar}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/approval/ApprovalBar.vue?vue&type=template&id=4fea8923&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("div",{class:["sidebar-loader",(_vm.loading||_vm.isSaving)&&"on"]}),_vm.loading?_c("div",{staticClass:"d-flex approval-bar"},[_vm._v(" "+_vm._s(_vm.$t("panel.loading_load"))+" ")]):_c("div",{staticClass:"d-flex approval-bar"},[_c("div",{staticClass:"approval-desc mR30 f14"},[_vm.isRejected?[_c("span",{staticClass:"bold"},[_vm._v(_vm._s(_vm.policyName))]),_vm._v(" "+_vm._s(_vm.$t("panel.was"))+" "),_c("span",{staticClass:"bold",staticStyle:{color:"#dd7171"}},[_vm._v(_vm._s(_vm.$t("panel.rejected")))]),_vm._v(" for this "+_vm._s(_vm.moduleDisplayName||_vm.moduleName)+". "),_vm.resendApproval?[_c("span",[_vm._v("You can")]),_vm.canShowEdit?[_c("span",{staticClass:"mL5"},[_vm._v("either")]),_c("span",{class:[_vm.isSaving&&"cursor-not-allowed"]},[_c("a",{class:["mL5 bold",_vm.isSaving&&"pointer-events-none"],on:{click:function($event){return _vm.$emit("onEdit")}}},[_vm._v(" edit ")])]),_c("span",{staticClass:"mL5"},[_vm._v("or")])]:_vm._e(),_c("span",{class:[_vm.isSaving&&"cursor-not-allowed"]},[_c("a",{class:["mL5 bold",_vm.isSaving&&"pointer-events-none"],on:{click:function($event){return _vm.requestToSave(_vm.resendApproval)}}},[_vm._v(" resend ")])]),_c("span",{staticClass:"mL5"},[_vm._v("for approval.")])]:_vm._e()]:_vm.hasApprovalList&&!_vm.hideApprovers?[_c("span",{staticClass:"bold"},[_vm._v(_vm._s(_vm.policyName))]),_vm._v(" is pending from "),_c("span",{staticClass:"bold"},[_vm._v(_vm._s(_vm.approvers[0].name))]),_vm.approvers.length>1?_c("el-popover",{attrs:{placement:"bottom",width:"200",trigger:"hover"}},[_vm._t("default",(function(){return[_c("div",{staticClass:"mL5 approvers-more-icon"},[_vm._v(" +"+_vm._s(_vm.approvers.length-1)+" ")])]}),{slot:"reference"}),_c("div",_vm._l(_vm.approvers.slice(1),(function(approver){return _c("div",{key:approver.name,staticClass:"mB10"},[_c("ApproverTypeAvatar",{attrs:{size:"md",user:approver,userType:_vm.getApproverType(approver),moduleName:_vm.moduleName,approvalMeta:_vm.approvalMeta}})],1)})),0)],2):_vm._e()]:(_vm.$validation.isEmpty(_vm.transitions),[_c("span",{staticClass:"bold"},[_vm._v(_vm._s(_vm.policyName))]),_vm._v(" is pending ")])],2),_vm.$validation.isEmpty(_vm.transitions)?_vm._e():_c("div",{staticClass:"approval-links text-uppercase f12 bold"},[_c("div",{class:[_vm.isSaving&&"cursor-not-allowed"]},[_vm.approveTransition?_c("a",{class:["link-approve mR15",_vm.isSaving&&"pointer-events-none"],on:{click:function($event){return _vm.requestToSave(_vm.approveTransition)}}},[_c("inline-svg",{attrs:{src:"tick-sign",iconClass:"icon icon-xs"}}),_vm._v(" "+_vm._s(_vm.approveTransition.name)+" ")],1):_vm._e(),_vm.rejectTransition?_c("a",{class:["link-reject",_vm.isSaving&&"pointer-events-none"],on:{click:function($event){return _vm.requestToSave(_vm.rejectTransition)}}},[_c("inline-svg",{attrs:{src:"svgs/close",iconClass:"icon icon-xxs"}}),_vm._v(" "+_vm._s(_vm.rejectTransition.name)+" ")],1):_vm._e()])])]),_vm.canShowForm?[_c("TransitionForm",{attrs:{moduleName:_vm.selectedTransition.moduleName,recordId:_vm.record.recordId,formId:_vm.selectedTransition.formId,record:_vm.record,transition:_vm.selectedTransition,approvalRule:_vm.approvalRule,saveAction:_vm.saveAction,closeAction:_vm.closeStateFlowForm,isV3:_vm.isV3}})]:_vm._e()],2)},staticRenderFns=[],toConsumableArray=__webpack_require__(488478),objectSpread2=__webpack_require__(595082),ApprovalButtons=(__webpack_require__(689730),__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(670560),__webpack_require__(425728),__webpack_require__(434284),__webpack_require__(976801),__webpack_require__(634338),__webpack_require__(840889)),ApprovalForm=__webpack_require__(548127),ApprovalUserAvatar=__webpack_require__(400438),validation=__webpack_require__(990260),vuex_esm=__webpack_require__(420629),ApprovalBarvue_type_script_lang_js={extends:ApprovalButtons/* default */.Z,props:["hideApprovers","canShowEdit","canHideMsg"],components:{TransitionForm:ApprovalForm/* default */.Z,ApproverTypeAvatar:ApprovalUserAvatar/* default */.Z},data:function(){return{isSaving:!1}},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({metaInfo:function(state){return state.view.metaInfo}})),{},{transitions:function(){return(0,validation/* isEmpty */.xb)(this.stateTransitions)?[]:(0,toConsumableArray/* default */.Z)(this.stateTransitions).slice(0,2)},policyName:function(){return(0,validation/* isEmpty */.xb)(this.approvalRule)?"Approval":this.$getProperty(this.approvalRule,"name")},shouldCurrentUserApprove:function(){return!(0,validation/* isEmpty */.xb)(this.transitions)},hasApprovalList:function(){return!(0,validation/* isEmpty */.xb)(this.approvers)},approvalMeta:function(){return{approvalList:this.pendingApprovalList}},approvers:function(){var approvers=[];return this.pendingApprovalList.forEach((function(approver){var value=approver.value,type=approver.type;(0,validation/* isEmpty */.xb)(value)?"TENANT"===type?approvers.push({name:"Tenant",type:"TENANT"}):"VENDOR"===type&&approvers.push({name:"Vendor",type:"VENDOR"}):(0,validation/* isArray */.kJ)(value)?approvers.push.apply(approvers,(0,toConsumableArray/* default */.Z)(value)):approvers.push(value)})),approvers},isRejected:function(){return"Rejected"===this.$getProperty(this.currentState,"status")},shouldCreateModuleRecord:function(){return!1},shouldCreateNotes:function(){return!1},approveTransition:function(){return this.transitions.find((function(t){return"Approve"===t.name}))},rejectTransition:function(){return this.transitions.find((function(t){return"Reject"===t.name}))},resendApproval:function(){return this.transitions.find((function(t){return!["Approve","Reject"].includes(t.name)}))},moduleDisplayName:function(){var _this$metaInfo;return null===(_this$metaInfo=this.metaInfo)||void 0===_this$metaInfo?void 0:_this$metaInfo.displayName}}),methods:{showMessage:function(transition){
/* override */
var name=transition.name,action="";["Approve","Reject"].includes(name)?"Approve"===name?action="approved":"Reject"===name&&(action="rejected"):action="resent for approval",this.$message.success("".concat(this.moduleDisplayName||this.moduleName," was ").concat(action))},requestToSave:function(transition){var _this=this;this.isSaving=!0,this.startTransition(transition).finally((function(){return _this.isSaving=!1}))},saveAction:function(formData){return this.transitionToState(formData)},getApproverType:function(approver){return approver.id?{type:"USER",value:approver}:approver},defaultResponseHandler:function(_ref,transition){var error=_ref.error,canShowForm=this.canShowForm;error?(!this.canHideMsg&&this.$message.error(error.message),this.$emit("onFailure",{error:error,transition:transition})):(canShowForm&&this.closeStateFlowForm(),this.fetchAvailableStates(),this.$emit("onSuccess",{error:error,transition:transition}),!this.canHideMsg&&this.showMessage(transition))}}},approval_ApprovalBarvue_type_script_lang_js=ApprovalBarvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(approval_ApprovalBarvue_type_script_lang_js,render,staticRenderFns,!1,null,"4fea8923",null)
/* harmony default export */,ApprovalBar=component.exports},
/***/760218:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return PageBuilder}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/page/PageBuilder.vue?vue&type=template&id=0dd0982f
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.showPage&&_vm.pagebuilderComponent?_c(_vm.pagebuilderComponent,_vm._b({tag:"component",attrs:{module:_vm.module},on:{forceOldPage:function($event){_vm.forceOld=!0}}},"component",_vm.$attrs,!1)):_vm._e()},staticRenderFns=[],objectSpread2=__webpack_require__(595082),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),vuex_esm=(__webpack_require__(260228),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(420629)),PageBuildervue_type_script_lang_js={props:["module"],data:function(){return{forceOld:!1,showPage:!1}},components:{NewPageBuilder:function(){return Promise.all(/* import() */[__webpack_require__.e(93208),__webpack_require__.e(50232),__webpack_require__.e(93765),__webpack_require__.e(95953),__webpack_require__.e(35309),__webpack_require__.e(18778),__webpack_require__.e(12303),__webpack_require__.e(84290),__webpack_require__.e(31721),__webpack_require__.e(64418),__webpack_require__.e(5603),__webpack_require__.e(57432),__webpack_require__.e(435),__webpack_require__.e(72230),__webpack_require__.e(94255),__webpack_require__.e(67683),__webpack_require__.e(44178),__webpack_require__.e(91132),__webpack_require__.e(20280),__webpack_require__.e(78256),__webpack_require__.e(22200),__webpack_require__.e(49081),__webpack_require__.e(89472),__webpack_require__.e(12085),__webpack_require__.e(55754),__webpack_require__.e(86494),__webpack_require__.e(3037),__webpack_require__.e(49908),__webpack_require__.e(22061),__webpack_require__.e(31602),__webpack_require__.e(73609),__webpack_require__.e(44119),__webpack_require__.e(88262),__webpack_require__.e(82080),__webpack_require__.e(88506)]).then(__webpack_require__.bind(__webpack_require__,110570))},OldPageBuilder:function(){return Promise.all(/* import() */[__webpack_require__.e(93208),__webpack_require__.e(50232),__webpack_require__.e(93765),__webpack_require__.e(95953),__webpack_require__.e(35309),__webpack_require__.e(18778),__webpack_require__.e(12303),__webpack_require__.e(84290),__webpack_require__.e(31721),__webpack_require__.e(64418),__webpack_require__.e(5603),__webpack_require__.e(57432),__webpack_require__.e(435),__webpack_require__.e(72230),__webpack_require__.e(94255),__webpack_require__.e(67683),__webpack_require__.e(44178),__webpack_require__.e(91132),__webpack_require__.e(20280),__webpack_require__.e(78256),__webpack_require__.e(22200),__webpack_require__.e(49081),__webpack_require__.e(89472),__webpack_require__.e(12085),__webpack_require__.e(55754),__webpack_require__.e(86494),__webpack_require__.e(3037),__webpack_require__.e(49908),__webpack_require__.e(22061),__webpack_require__.e(31602),__webpack_require__.e(73609),__webpack_require__.e(23803),__webpack_require__.e(55246)]).then(__webpack_require__.bind(__webpack_require__,223803))}},created:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(_context.prev=0,!_this.$helpers.isLicenseEnabled("PAGE_BUILDER")){_context.next=4;break}return _context.next=4,_this.$store.dispatch("pagebuilder/loadNewPageEnabledModules");case 4:_context.next=8;break;case 6:_context.prev=6,_context.t0=_context["catch"](0);case 8:_this.$nextTick((function(){_this.showPage=!0}));case 9:case"end":return _context.stop()}}),_callee,null,[[0,6]])})))()},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({newPageEnabledModules:function(state){return state.pagebuilder.newPageEnabledModules}})),{},{pagebuilderComponent:function(){var newPageEnabledModules=this.newPageEnabledModules,module=this.module,forceOld=this.forceOld,isNew=(newPageEnabledModules||[]).includes(module),showNew=!forceOld&&(this.showNewPageBuilder||isNew);return showNew?"NewPageBuilder":"OldPageBuilder"},showNewPageBuilder:function(){var query=this.$route.query,_query$showNewPageBui=query.showNewPageBuilder,showNewPageBuilder=void 0!==_query$showNewPageBui&&_query$showNewPageBui;return!0===showNewPageBuilder||"true"===showNewPageBuilder}})},page_PageBuildervue_type_script_lang_js=PageBuildervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(page_PageBuildervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,PageBuilder=component.exports},
/***/385402:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return StoreroomSummary}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/Inventory/Storerooms/StoreroomSummary.vue?vue&type=template&id=f8955ec0
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"custom-module-overview",class:_vm.$validation.isEmpty(_vm.customClass)?"":_vm.customClass},[_vm.isLoading?_c("div",{staticClass:"flex-middle fc-empty-white"},[_c("spinner",{attrs:{show:_vm.isLoading,size:"80"}})],1):_vm.$validation.isEmpty(_vm.record)?_vm._e():[_c("div",{staticClass:"header p20"},[_c("div",{staticClass:"custom-module-details"},[_c("div",{staticClass:"d-flex flex-middle align-center"},[_c("div",{staticClass:"mL5"},[_c("div",{staticClass:"custom-module-id"},[_vm._v("#"+_vm._s(_vm.record&&_vm.record.id))]),_c("div",{staticClass:"custom-module-name d-flex max-width300px"},[_c("el-tooltip",{attrs:{placement:"bottom",effect:"dark",content:_vm.record[_vm.mainFieldKey]}},[_c("span",{staticClass:"whitespace-pre-wrap custom-header"},[_vm._v(_vm._s(_vm.record[_vm.mainFieldKey]))])])],1)])])]),_c("div",{staticClass:"marginL-auto flex-middle"},[_c("div",{staticClass:"fc__layout__align"},[_vm.$hasPermission("inventory:UPDATE,UPDATE_OWN")?_c("el-button",{staticClass:"fc-wo-border-btn mL20 pL15 pR15 self-center",attrs:{type:"button"},on:{click:_vm.editRecord}},[_c("i",{staticClass:"el-icon-edit"})]):_vm._e(),_c("el-dropdown",{staticClass:"mL15 fc-btn-ico-lg pT5 pB5 pL8 pR8 pointer",on:{command:_vm.handleCommand}},[_c("span",{staticClass:"el-dropdown-link"},[_c("img",{attrs:{src:__webpack_require__(935010),height:"18",width:"18"}})]),_c("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[_c("el-dropdown-item",{attrs:{command:"genNotifyPref"}},[_vm._v(_vm._s(_vm.$t("common.header.notification_preferences")))])],1)],1)],1)])]),_c("Page",{key:_vm.record.id,attrs:{module:_vm.moduleName,id:_vm.record.id,details:_vm.record,primaryFields:_vm.primaryFields,notesModuleName:_vm.notesModuleName,isV3Api:!0,attachmentsModuleName:_vm.attachmentsModuleName,showEdit:!1,showDescriptionTitle:!0}})],_vm.showItemIssueReturn?[_c("item-issue-return",{attrs:{storeRoom:_vm.record,showItemIssueReturn:_vm.showItemIssueReturn,type:_vm.issueReturnType},on:{"update:showItemIssueReturn":function($event){_vm.showItemIssueReturn=$event},"update:show-item-issue-return":function($event){_vm.showItemIssueReturn=$event},refreshInventory:_vm.refreshData}})]:_vm._e(),_vm.showToolIssueReturn?[_c("tool-issue-return",{attrs:{storeRoom:_vm.record,type:_vm.issueReturnType,showToolIssueReturn:_vm.showToolIssueReturn},on:{"update:showToolIssueReturn":function($event){_vm.showToolIssueReturn=$event},"update:show-tool-issue-return":function($event){_vm.showToolIssueReturn=$event},refreshInventory:_vm.refreshData}})]:_vm._e(),_vm.showStoreIssueDialog?[_c("inventory-store-issue",{attrs:{storeRoom:_vm.record,visibility:_vm.showStoreIssueDialog,itemList:_vm.items,toolList:_vm.tools},on:{"update:visibility":function($event){_vm.showStoreIssueDialog=$event},refreshInventory:_vm.refreshData}})]:_vm._e(),_vm.notificationSettingsVisibility?[_c("store-room-notification-preference",{attrs:{storeRoom:_vm.record,visibility:_vm.notificationSettingsVisibility},on:{"update:visibility":function($event){_vm.notificationSettingsVisibility=$event}}})]:_vm._e(),_vm.preferenceVisibility?[_c("el-dialog",{key:"1",attrs:{visible:_vm.preferenceVisibility,title:_vm.$t("common.header.notification_preference"),fullscreen:!1,"before-close":_vm.genNotficationPreferencesToggle,"append-to-body":!0,"custom-class":"fc-animated slideInRight fc-dialog-form contract-notification-form-heading fc-dialog-right width50"},on:{"update:visible":function($event){_vm.preferenceVisibility=$event}}},[_c("notification-preference",{attrs:{moduleName:"storeRoom",recordId:_vm.record.id,visibility:_vm.preferenceVisibility},on:{"update:visibility":function($event){_vm.preferenceVisibility=$event}}})],1)]:_vm._e()],2)},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),objectSpread2=__webpack_require__(595082),CustomModuleSummary=(__webpack_require__(434284),__webpack_require__(670560),__webpack_require__(848277)),ItemStoreIssueReturn=__webpack_require__(620814),ToolStoreIssueReturn=__webpack_require__(396859),InventoryStoreIssue=__webpack_require__(508427),StoreRoomNotificationPreferencevue_type_template_id_91173ed0_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_vm.visibility?_c("div",[_c("el-dialog",{key:_vm.storeRoom.id,attrs:{visible:_vm.visibility,title:"NOTIFICATION PREFRENCES","before-close":_vm.cancelForm,"custom-class":"fc-dialog-center-container"},on:{"update:visible":function($event){_vm.visibility=$event}}},[_vm.loading?_c("div",{staticClass:"height300"},[_c("spinner",{staticClass:"mT20",attrs:{show:_vm.loading,size:"80"}})],1):_c("div",{staticClass:"height300"},[_c("el-row",{staticClass:"mB20",attrs:{gutter:20}},[_c("el-col",{attrs:{span:24}},[_c("el-checkbox",{on:{change:_vm.outOfStockCheckboxActions},model:{value:_vm.formData.outOfStockNotification,callback:function($$v){_vm.$set(_vm.formData,"outOfStockNotification",$$v)},expression:"formData.outOfStockNotification"}},[_vm._v("Notify me when item is out of stock")])],1)],1),_vm.formData.outOfStockNotification?_c("el-row",{staticClass:"mB20",attrs:{gutter:20}},[_c("el-col",{staticClass:"el-select-block",attrs:{span:12}},[_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{multiple:"",filterable:"","collapse-tags":""},model:{value:_vm.formData.outOfStockNotificationList,callback:function($$v){_vm.$set(_vm.formData,"outOfStockNotificationList",$$v)},expression:"formData.outOfStockNotificationList"}},_vm._l(_vm.users,(function(user){return _c("el-option",{key:user.name,staticClass:"subject",attrs:{label:user.name,value:user.id}})})),1)],1)],1):_vm._e(),_c("el-row",{staticClass:"mB20",attrs:{gutter:20}},[_c("el-col",{attrs:{span:24}},[_c("el-checkbox",{on:{change:_vm.minCheckboxActions},model:{value:_vm.formData.minQuantityNotification,callback:function($$v){_vm.$set(_vm.formData,"minQuantityNotification",$$v)},expression:"formData.minQuantityNotification"}},[_vm._v("Notify me when Item nears Minimum Limit")])],1)],1),_vm.formData.minQuantityNotification?_c("el-row",{staticClass:"mB20",attrs:{gutter:20}},[_c("el-col",{staticClass:"el-select-block",attrs:{span:12}},[_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{multiple:"",filterable:"","collapse-tags":""},model:{value:_vm.formData.minQuantityNotificationList,callback:function($$v){_vm.$set(_vm.formData,"minQuantityNotificationList",$$v)},expression:"formData.minQuantityNotificationList"}},_vm._l(_vm.users,(function(user){return _c("el-option",{key:user.id,staticClass:"subject",attrs:{label:user.name,value:user.id}})})),1)],1)],1):_vm._e()],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){return _vm.cancelForm()}}},[_vm._v("CANCEL")]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.saving},on:{click:function($event){return _vm.saveNotificationPrefrences()}}},[_vm._v(_vm._s(_vm.saving?"Submitting...":"SAVE"))])],1)])],1):_vm._e()])},StoreRoomNotificationPreferencevue_type_template_id_91173ed0_staticRenderFns=[],createForOfIteratorHelper=__webpack_require__(566347),vuex_esm=(__webpack_require__(260228),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(420629)),StoreRoomNotificationPreferencevue_type_script_lang_js={props:["visibility","storeRoom"],data:function(){return{saving:!1,loading:!1,formData:{outOfStockNotification:!1,outOfStockNotificationList:[],minQuantityNotificationList:[],minQuantityNotification:!1},paramData:[],editData:null,rulesForUpdate:{minimum:{hasValue:!1,list:{item:null,tool:null}},outOfStock:{hasValue:!1,list:{item:null,tool:null}}}}},computed:(0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({users:function(state){return state.users}})),mounted:function(){this.loadDetails()},methods:{loadDetails:function(){var _this=this,param={storeRoomId:this.storeRoom.id};this.loading=!0,this.$http.post("v2/storeroom/rules/fetchRule",param).then((function(response){0==response.data.responseCode?(_this.editData=response.data.result.workflowRuleList,_this.mapEditData(),_this.loading=!1):(_this.$message.error(response.data.message),_this.loading=!1)})).catch((function(){_this.loading=!1}))},mapEditData:function(){var _step,_iterator=(0,createForOfIteratorHelper/* default */.Z)(this.editData);try{for(_iterator.s();!(_step=_iterator.n()).done;){var data=_step.value;33===data.ruleType&&(this.formData.minQuantityNotification=!0,0===this.formData.minQuantityNotificationList.length&&(this.formData.minQuantityNotificationList=this.$common.getUsersFromTemplate(data.actions[0].template)),this.rulesForUpdate.minimum.hasValue=!0,"item"===data.event.moduleName&&(this.rulesForUpdate.minimum.list.item=data.id),"tool"===data.event.moduleName&&(this.rulesForUpdate.minimum.list.tool=data.id)),32===data.ruleType&&(this.formData.outOfStockNotification=!0,0===this.formData.outOfStockNotificationList.length&&(this.formData.outOfStockNotificationList=this.$common.getUsersFromTemplate(data.actions[0].template)),this.rulesForUpdate.outOfStock.hasValue=!0,"item"===data.event.moduleName&&(this.rulesForUpdate.outOfStock.list.item=data.id),"tool"===data.event.moduleName&&(this.rulesForUpdate.outOfStock.list.tool=data.id))}}catch(err){_iterator.e(err)}finally{_iterator.f()}},cancelForm:function(){this.$emit("update:visibility",!1)},saveNotificationPrefrences:function(){this.validateData()},validateData:function(){this.formData.outOfStockNotification&&0===this.formData.outOfStockNotificationList.length||this.formData.minQuantityNotification&&0===this.formData.minQuantityNotificationList.length?this.$message.error("Enter Atleast One User to send Notification"):this.dataFormatConstruct()},dataFormatConstruct:function(){var _this2=this,paramItemMin={rule:{name:"item reaching minimum quantity",scheduleType:3,description:"testing",ruleType:33,event:{moduleName:"item",activityType:1048576},criteria:{pattern:"(1 and 2)",conditions:{1:{fieldName:"quantity",value:"item.minimumQuantity",columnName:"Item.QUANTITY",operatorId:77,isResourceOperator:!1,parseLabel:null,active:!0,isSpacePicker:!1},2:{fieldName:"storeRoom",isResourceOperator:!1,parseLabel:null,value:this.storeRoom.id,active:!0,isSpacePicker:!1,operatorId:36,columnName:"Item.STORE_ROOM_ID"}},resourceOperator:!1},siteId:this.storeRoom.site?this.storeRoom.site.id:null},actions:[{actionType:3,templateJson:{type:1,message:"Hi,\nThis is to notify you that #${item.id} ${item.itemType.name} in ${item.storeRoom.name} is nearing lowest inventory limit.\nPlease click the link https://app.facilio.com/app/purchase/po/new to initiate new stock request. \nRegards,\nFacilio",name:"Storeroom Notification Template",workflow:{parameters:[{name:"org.domain",typeString:"String"},{name:"item.quantity",typeString:"String"},{name:"item.itemType.name",typeString:"String"},{name:"item.storeRoom.name",typeString:"String"},{name:"item.id",typeString:"String"}],expressions:[{name:"org.domain",constant:"${org.domain}"},{name:"item.quantity",constant:"${item.quantity}"},{name:"item.itemType.name",constant:"${item.itemType.name}"},{name:"item.storeRoom.name",constant:"${item.storeRoom.name}"},{name:"item.id",constant:"${item.id}"}],workflowString:null},ftl:!1,to:"",subject:"Alert: ${item.itemType.name} - About to Reach Out of Stock"}}]},paramItemOos={rule:{name:"item Out of Stock quantity",scheduleType:3,description:"testing",ruleType:32,event:{moduleName:"item",activityType:1048576},criteria:{pattern:"(1 and 2)",conditions:{1:{fieldName:"quantity",value:"0",columnName:"Item.QUANTITY",operatorId:12,isResourceOperator:!1,parseLabel:null,active:!0,isSpacePicker:!1},2:{fieldName:"storeRoom",isResourceOperator:!1,parseLabel:null,value:this.storeRoom.id,active:!0,isSpacePicker:!1,operatorId:36,columnName:"Item.STORE_ROOM_ID"}},resourceOperator:!1},siteId:this.storeRoom.site?this.storeRoom.site.id:null},actions:[{actionType:3,templateJson:{type:1,message:"Hi,\nThis is to Notify you that #{item.id} ${item.itemType.name} in ${item.storeRoom.name} is currently Out of Stock.\nPlease click the link https://app.facilio.com/app/purchase/po/new to initiate new stock request.\nRegards,\n "+this.$getProperty(window.brandConfig,"name","Facilio"),name:"Storeroom Notification Template",workflow:{parameters:[{name:"org.domain",typeString:"String"},{name:"item.quantity",typeString:"String"},{name:"item.itemType.name",typeString:"String"},{name:"item.storeRoom.name",typeString:"String"},{name:"item.id",typeString:"String"}],expressions:[{name:"org.domain",constant:"${org.domain}"},{name:"item.quantity",constant:"${item.quantity}"},{name:"item.itemType.name",constant:"${item.itemType.name}"},{name:"item.storeRoom.name",constant:"${item.storeRoom.name}"},{name:"item.id",constant:"${item.id}"}],workflowString:null},ftl:!1,to:"",subject:"Alert: ${item.itemType.name} - Out of Stock"}}]},paramToolMin={rule:{name:"tool reaching minimum quantity",scheduleType:3,description:"testing",ruleType:33,event:{moduleName:"tool",activityType:1048576},criteria:{pattern:"(1 and 2)",conditions:{1:{fieldName:"currentQuantity",value:"tool.minimumQuantity",columnName:"Tool.CURRENT_QUANTITY",operatorId:77,isResourceOperator:!1,parseLabel:null,active:!0,isSpacePicker:!1},2:{fieldName:"storeRoom",isResourceOperator:!1,parseLabel:null,value:this.storeRoom.id,active:!0,isSpacePicker:!1,operatorId:36,columnName:"Tool.STORE_ROOM_ID"}},resourceOperator:!1},siteId:this.storeRoom.site?this.storeRoom.site.id:null},actions:[{actionType:3,templateJson:{type:1,message:"Hi,\nThis is to notify you that #${tool.id} ${tool.toolType.name} in ${tool.storeRoom.name} is nearing lowest inventory limit.\nPlease click the link https://app.facilio.com/app/purchase/po/new to initiate new stock request.\n Regards,\nFacilio",name:"Storeroom Notification Template",workflow:{parameters:[{name:"org.domain",typeString:"String"},{name:"tool.currentQuantity",typeString:"String"},{name:"tool.toolType.name",typeString:"String"},{name:"tool.storeRoom.name",typeString:"String"},{name:"tool.id",typeString:"String"}],expressions:[{name:"org.domain",constant:"${org.domain}"},{name:"tool.currentQuantity",constant:"${tool.currentQuantity}"},{name:"tool.toolType.name",constant:"${tool.toolType.name}"},{name:"tool.storeRoom.name",constant:"${tool.storeRoom.name}"},{name:"tool.id",constant:"${tool.id}"}],workflowString:null},ftl:!1,to:"",subject:"Alert:${tool.toolType.name} - About to Reach Out of Stock"}}]},paramToolOos={rule:{name:"tool out of stock quantity",scheduleType:3,description:"testing",ruleType:32,event:{moduleName:"tool",activityType:1048576},criteria:{pattern:"(1 and 2)",conditions:{1:{fieldName:"currentQuantity",value:"0",columnName:"Tool.CURRENT_QUANTITY",operatorId:12,isResourceOperator:!1,parseLabel:null,active:!0,isSpacePicker:!1},2:{fieldName:"storeRoom",isResourceOperator:!1,parseLabel:null,value:this.storeRoom.id,active:!0,isSpacePicker:!1,operatorId:36,columnName:"Tool.STORE_ROOM_ID"}},resourceOperator:!1},siteId:this.storeRoom.site?this.storeRoom.site.id:null},actions:[{actionType:3,templateJson:{type:1,message:"Hi,\nThis is to notify you that #${tool.id} ${tool.toolType.name} in ${tool.storeRoom.name} is currently out of stock.\nPlease click the link https://app.facilio.com/app/purchase/po/new to initiate new stock request.\nRegards,\nFacilio",name:"Storeroom Notification Template",workflow:{parameters:[{name:"org.domain",typeString:"String"},{name:"tool.currentQuantity",typeString:"String"},{name:"tool.toolType.name",typeString:"String"},{name:"tool.storeRoom.name",typeString:"String"},{name:"tool.id",typeString:"String"}],expressions:[{name:"org.domain",constant:"${org.domain}"},{name:"tool.currentQuantity",constant:"${tool.currentQuantity}"},{name:"tool.toolType.name",constant:"${tool.toolType.name}"},{name:"tool.storeRoom.name",constant:"${tool.storeRoom.name}"},{name:"tool.id",constant:"${tool.id}"}],workflowString:null},ftl:!1,to:"",subject:"Alert: ${tool.toolType.name} - Out of Stock"}}]};for(var _i in this.formData.outOfStockNotificationList){paramItemOos.actions[0].templateJson.workflow.expressions.push({name:"user_email1",fieldName:"email",moduleName:"users",aggregateString:"[0]",criteria:{pattern:1,conditions:{1:{fieldName:"ouid",operatorId:9,sequence:1,value:this.formData.outOfStockNotificationList[_i]}}}}),paramToolOos.actions[0].templateJson.workflow.expressions.push({name:"user_email1",fieldName:"email",moduleName:"users",aggregateString:"[0]",criteria:{pattern:1,conditions:{1:{fieldName:"ouid",operatorId:9,sequence:1,value:this.formData.outOfStockNotificationList[_i]}}}});var l=parseInt(_i)+1;parseInt(_i)===this.formData.outOfStockNotificationList.length-1?(paramItemOos.actions[0].templateJson.to=paramItemOos.actions[0].templateJson.to+"${user_email"+l+":-}",paramToolOos.actions[0].templateJson.to=paramToolOos.actions[0].templateJson.to+"${user_email"+l+":-}"):(paramItemOos.actions[0].templateJson.to=paramItemOos.actions[0].templateJson.to+"${user_email"+l+":-}, ",paramToolOos.actions[0].templateJson.to=paramToolOos.actions[0].templateJson.to+"${user_email"+l+":-}, ")}for(var j in this.formData.minQuantityNotificationList){paramItemMin.actions[0].templateJson.workflow.expressions.push({name:"user_email1",fieldName:"email",moduleName:"users",aggregateString:"[0]",criteria:{pattern:1,conditions:{1:{fieldName:"ouid",operatorId:9,sequence:1,value:this.formData.minQuantityNotificationList[j]}}}}),paramToolMin.actions[0].templateJson.workflow.expressions.push({name:"user_email1",fieldName:"email",moduleName:"users",aggregateString:"[0]",criteria:{pattern:1,conditions:{1:{fieldName:"ouid",operatorId:9,sequence:1,value:this.formData.minQuantityNotificationList[i]}}}});var k=parseInt(j)+1;parseInt(j)===parseInt(this.formData.minQuantityNotificationList.length-1)?(paramItemMin.actions[0].templateJson.to=paramItemMin.actions[0].templateJson.to+"${user_email"+k+":-}",paramToolMin.actions[0].templateJson.to=paramToolMin.actions[0].templateJson.to+"${user_email"+k+":-}"):(paramItemMin.actions[0].templateJson.to=paramItemMin.actions[0].templateJson.to+"${user_email"+k+":-}, ",paramToolMin.actions[0].templateJson.to=paramToolMin.actions[0].templateJson.to+"${user_email"+k+":-}, ")}var deleteIdsList=[];this.rulesForUpdate.minimum.hasValue&&!this.formData.minQuantityNotification?(deleteIdsList.push(this.rulesForUpdate.minimum.list.item),deleteIdsList.push(this.rulesForUpdate.minimum.list.tool)):this.rulesForUpdate.minimum.hasValue&&this.formData.minQuantityNotification&&(paramItemMin.rule["id"]=this.rulesForUpdate.minimum.list.item,paramToolMin.rule["id"]=this.rulesForUpdate.minimum.list.tool),this.rulesForUpdate.outOfStock.hasValue&&!this.formData.outOfStockNotification?(deleteIdsList.push(this.rulesForUpdate.outOfStock.list.item),deleteIdsList.push(this.rulesForUpdate.outOfStock.list.tool)):this.rulesForUpdate.outOfStock.hasValue&&this.formData.outOfStockNotification&&(paramItemOos.rule["id"]=this.rulesForUpdate.outOfStock.list.item,paramToolOos.rule["id"]=this.rulesForUpdate.outOfStock.list.tool),this.paramData=[],this.formData.minQuantityNotification&&(this.paramData.push(paramItemMin),this.paramData.push(paramToolMin)),this.formData.outOfStockNotification&&(this.paramData.push(paramItemOos),this.paramData.push(paramToolOos));var promises=[];deleteIdsList.length>0&&promises.push(this.$http.post("v2/storeroom/rules/deleteRule",{ruleIds:deleteIdsList})),this.paramData.length>0&&promises.push(this.$http.post("v2/storeroom/rules/addOrUpdateRule",{storeRoomId:this.storeRoom.id,rules:this.paramData})),promises.length>0&&Promise.all(promises).then((function(response){1===promises.length?0===response[0].data.responseCode?(_this2.$message.success("Rules Configured"),_this2.$emit("update:visibility",!1)):_this2.$message.error(response.data.message):2===promises.length&&(0===response[0].data.responseCode&&0===response[1].data.responseCode?(_this2.$message.success("Rules Configured"),_this2.$emit("update:visibility",!1)):_this2.$message.error(response.data.message))}))},deleteApiCall:function(ids){var _this3=this,param={ruleIds:ids};this.$http.post("v2/storeroom/rules/deleteRule",param).then((function(response){0===response.data.responseCode?_this3.$message.success("Rules Configured"):_this3.$message.error(response.data.message)}))},apiCallMethod:function(){var _this4=this,param={storeRoomId:this.storeRoom.id,rules:this.paramData};this.$http.post("v2/storeroom/rules/addOrUpdateRule",param).then((function(response){0==response.data.responseCode?(_this4.$message.success("Rules Configured"),_this4.$emit("update:visibility",!1)):_this4.$message.error(response.data.message)})).catch((function(){}))},outOfStockCheckboxActions:function(val){val||(this.formData.outOfStockNotificationList=[])},minCheckboxActions:function(val){val||(this.formData.minQuantityNotificationList=[])}}},component_StoreRoomNotificationPreferencevue_type_script_lang_js=StoreRoomNotificationPreferencevue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(component_StoreRoomNotificationPreferencevue_type_script_lang_js,StoreRoomNotificationPreferencevue_type_template_id_91173ed0_render,StoreRoomNotificationPreferencevue_type_template_id_91173ed0_staticRenderFns,!1,null,null,null)
/* harmony default export */,StoreRoomNotificationPreference=component.exports,NotificationPreference=__webpack_require__(785595),api=__webpack_require__(32284),eventBus=__webpack_require__(398011),router=__webpack_require__(329435),InventoryUtil=__webpack_require__(976195),StoreroomSummaryvue_type_script_lang_js={extends:CustomModuleSummary["default"],props:["viewname"],components:{ItemIssueReturn:ItemStoreIssueReturn/* default */.Z,ToolIssueReturn:ToolStoreIssueReturn/* default */.Z,InventoryStoreIssue:InventoryStoreIssue/* default */.Z,StoreRoomNotificationPreference:StoreRoomNotificationPreference,NotificationPreference:NotificationPreference/* default */.Z},data:function(){return{notesModuleName:"storeroomnotes",attachmentsModuleName:"storeroomattachments",primaryFields:["description","lastPurchasedDate","location","noOfItemTypes","noOfToolTypes","owner","servingsites"],showItemIssueReturn:!1,showToolIssueReturn:!1,issueReturnType:null,showStoreIssueDialog:!1,notificationSettingsVisibility:!1,preferenceVisibility:!1,storeRoomEditObj:null,storeRoomEditFormVisibility:!1,emitForm:!1,saving:!1,resetForm:!1,itemTypeFormChooser:!1,toolTypeFormChooser:!1,items:[],tools:[]}},computed:{currentStoreRoomId:function(){return parseInt(this.$route.params.id)},mainFieldKey:function(){return"name"},moduleName:function(){return"storeRoom"},showEdit:function(){var canShowEdit=this.$hasPermission("inventory:UPDATE,UPDATE_OWN"),isNotLocked=!this.isStateFlowEnabled||!this.isRecordLocked&&!this.isRequestedState;return canShowEdit&&isNotLocked&&!this.record.isStaged}},title:function(){},mounted:function(){eventBus/* eventBus */.Y.$on("refresh",this.refreshData),this.refreshItemAndTool()},methods:{saveForm:function(){this.emitForm=!0},cancelForm:function(){this.resetForm=!0,this.storeRoomEditFormVisibility=!1,this.newAddItemFormVisibility=!1,this.newAddToolFormVisibility=!1,this.itemTypeFormChooser=!1,this.toolTypeFormChooser=!1},editRecord:function(){var id=this.id;if((0,router/* isWebTabsEnabled */.tj)()){var _ref=(0,router/* findRouteForModule */.Jp)(this.moduleName,router/* pageTypes */.As.EDIT)||{},name=_ref.name;name&&this.$router.push({name:name,params:{id:id}})}else id&&this.$router.push({name:"edit-storeroom",params:{id:id}})},openItemReturnDialog:function(){this.showItemIssueReturn=!0,this.issueReturnType="return"},openToolReturnDialog:function(){this.showToolIssueReturn=!0,this.issueReturnType="return"},openStoreIssueDialog:function(){this.showStoreIssueDialog=!0},notficationPreferencesToggle:function(){this.notificationSettingsVisibility=!this.notificationSettingsVisibility},genNotficationPreferencesToggle:function(){this.preferenceVisibility=!this.preferenceVisibility},editStoreRoomForm:function(){this.storeRoomEditObj=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},this.record),{},{customTitle:this.$t("common.header.edit_storeroom")}),this.storeRoomEditFormVisibility=!0},handleCommand:function(command){"edit"===command?this.editStoreRoomForm():"notifypref"===command?this.notficationPreferencesToggle():"genNotifyPref"===command&&this.genNotficationPreferencesToggle()},loadItemforStoreRoom:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var filters;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return filters={storeRoom:{operatorId:36,value:[_this.currentStoreRoomId+""]}},_context.next=3,(0,InventoryUtil/* getFilteredItemList */.Oh)(filters);case 3:_this.items=_context.sent;case 4:case"end":return _context.stop()}}),_callee)})))()},loadToolforStoreRoom:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var filters;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return filters={storeRoom:{operatorId:36,value:[_this2.currentStoreRoomId+""]}},_context2.next=3,(0,InventoryUtil/* getFilteredToolList */.FI)(filters);case 3:_this2.tools=_context2.sent;case 4:case"end":return _context2.stop()}}),_callee2)})))()},refreshItemAndTool:function(){this.loadItemforStoreRoom(),this.loadToolforStoreRoom()},submitForm:function(data){var self=this;if(this.storeRoomEditFormVisibility){var param;this.storeRoomEditFormVisibility=!1,param={data:_data},param["id"]=this.currentStoreRoomId,param["moduleName"]=this.moduleName;var _param=param,_data=_param.data,_ref2=_data||{},location=_ref2.location,_ref3=location||{},id=_ref3.id;id<0&&(param.data.location=null);var url="/v3/modules/data/patch",_API$post=api/* API */.bl.post(url,param),response=_API$post.response,error=_API$post.error;error?self.$message.error(error.message):response&&self.$message.success(this.$t("common.wo_report.edit_successfull"),this.refreshData()),self.cancelForm()}else if(this.newAddItemFormVisibility){var _param2;this.newAddItemFormVisibility=!1,_param2={storeRoom:data.storeRoom.id,item:data};var _url="/v2/item/add",_API$post2=api/* API */.bl.post(_url,_param2),_error=_API$post2.error;_error?self.$message.error(_error.message):(self.$message.success(this.$t("common._common.added_successfully")),self.refreshItemStoreRoom=!0,this.refreshData()),self.cancelForm()}else if(this.newAddToolFormVisibility){var _param3;this.newAddToolFormVisibility=!1,_param3={storeRoom:data.storeRoom.id,tool:data};var _url2="/v2/tool/add",_API$post3=api/* API */.bl.post(_url2,_param3),_error2=_API$post3.error;_error2?self.$message.error(_error2.message):(self.$message.success(this.$t("common._common.added_successfully")),self.refreshToolStoreRoom=!0,this.refreshData()),self.cancelForm()}self.emitForm=!1}}},Storerooms_StoreroomSummaryvue_type_script_lang_js=StoreroomSummaryvue_type_script_lang_js,StoreroomSummary_component=(0,componentNormalizer/* default */.Z)(Storerooms_StoreroomSummaryvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,StoreroomSummary=StoreroomSummary_component.exports},
/***/400438:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return ApprovalUserAvatar}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/approvals/components/ApprovalUserAvatar.vue?vue&type=template&id=443099a5&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"inline"},[_c("div",{staticClass:"fc-avatar-element q-item-division relative-position"},[_c("div",{staticClass:"q-item-side-left q-item-section"},[_vm.hasUser?_c("avatarPopover",{attrs:{user:_vm.userObj,moduleName:_vm.moduleName}},[_c("span",{attrs:{slot:"reference"},slot:"reference"},[_c("avatar",{attrs:{size:_vm.size,user:_vm.userObj,color:_vm.color}})],1)]):_vm.fieldType?_c("avatarPopover",{attrs:{user:_vm.fieldTypeUserValue,moduleName:_vm.moduleName}},[_c("span",{attrs:{slot:"reference"},slot:"reference"},[_c("avatar",{attrs:{size:_vm.size,user:_vm.fieldTypeUserValue,color:_vm.color}})],1)]):_c("div",{class:["icon-border",_vm.userTypeIcon[_vm.userType.type].background]},[_c("inline-svg",{class:["mT2",_vm.userTypeIcon[_vm.userType.type].marginLeft],attrs:{src:_vm.userTypeIcon[_vm.userType.type].icon,iconClass:"icon text-center fc-fill-path fill-path-white "+_vm.userTypeIcon[_vm.userType.type].iconSize}})],1)],1),_c("div",{staticClass:"flex-middle"},[_vm.$validation.isObject(_vm.typeLabel)?_c("span",{staticClass:"q-item-label d-flex flex-wrap"},[_vm._v(" "+_vm._s(_vm.typeLabel.value)+"  "),_vm.typeLabel.type?_c("span",{staticClass:"text-fc-grey mL5"},[_vm._v(" ("+_vm._s(_vm.typeLabel.type)+") ")]):_vm._e()]):_c("span",{staticClass:"q-item-label d-flex flex-wrap user-type"},[_vm._v(" "+_vm._s(_vm.typeLabel)+" ")]),_vm.approvers.length>1?_c("el-popover",{attrs:{placement:"bottom",width:"200",trigger:"hover"}},[_vm._t("default",(function(){return[_c("div",{staticClass:"approvers-more-icon"},[_vm._v("+"+_vm._s(_vm.approvers.length-1))])]}),{slot:"reference"}),_c("div",_vm._l(_vm.approvers.slice(1),(function(approver){return _c("div",{key:approver.name,staticClass:"mB10"},[_c("ApprovalUserAvatar",{attrs:{size:"md",user:approver,userType:_vm.getApproverType(approver),moduleName:_vm.moduleName,approvalMeta:_vm.approvalMeta}})],1)})),0)],2):_vm._e()],1)])])},staticRenderFns=[],validation=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(434284),__webpack_require__(990260)),User=__webpack_require__(426803),ApprovalUserAvatarvue_type_script_lang_js={name:"ApprovalUserAvatar",extends:User/* default */.Z,props:["userType","approvalMeta","approverObj"],computed:{hasUser:function(){var id=this.$getProperty(this.userObj,"id");return!(0,validation/* isEmpty */.xb)(id)},fieldType:function(){var _this$userType=this.userType,type=_this$userType.type,value=_this$userType.value;return"FIELD"===type&&!(0,validation/* isEmpty */.xb)(value)},fieldTypeUserValue:function(){var fieldType=this.fieldType,userType=this.userType,value=userType.value;return fieldType?(0,validation/* isArray */.kJ)(value)&&!(0,validation/* isEmpty */.xb)(value)?value[0]:value:null},fieldName:function(){var approverObj=this.approverObj,approvalMeta=this.approvalMeta,_ref=approvalMeta||{},_ref$approvalList=_ref.approvalList,approvalList=void 0===_ref$approvalList?[]:_ref$approvalList;if(!(0,validation/* isEmpty */.xb)(approvalList)){var displayName=approvalList.find((function(list){return list.approverGroup===approverObj.approverGroup})).field.displayName;return displayName}return null},color:function(){return-1!==this.userObj.id||this.fieldType?"":this.group?"#c3c3c3":"#e3e3e3"},userTypeIcon:function(){var userIcon={TENANT:{icon:"svgs/tenant",background:"green",iconSize:"icon-lg",marginLeft:"mL4"},VENDOR:{icon:"svgs/apps/vendor",background:"orange",iconSize:"icon-lg",marginLeft:"mL4"},ROLE:{icon:"svgs/role",background:"yellow",iconSize:"icon-xl",marginLeft:"mL3"},GROUP:{icon:"svgs/team",background:"blue",iconSize:"icon-xl",marginLeft:"mL3"},FIELD:{icon:"user",background:"brown",iconSize:"icon-lg",marginLeft:"mL4"}};return userIcon},typeLabel:function(){var _this$userType2=this.userType,type=_this$userType2.type,value=_this$userType2.value;if("USER"===type)return{value:this.userObj.name,type:null};if("TENANT"===type)return value?{value:value.name,type:"Tenant"}:"Tenant";if("VENDOR"===type)return value?{value:value.name,type:"Vendor"}:"Vendor";if("FIELD"===type){var _ref2=this.fieldTypeUserValue||{},name=_ref2.name;return{value:name||this.fieldName,type:"Field"}}return value.name},approvers:function(){var _this$userType3=this.userType,type=_this$userType3.type,value=_this$userType3.value;return"USER"===type?[this.userObj]:(0,validation/* isArray */.kJ)(value)?value:[value]}},methods:{getApproverType:function(approver){return approver.id?{type:"USER",value:approver}:approver}}},components_ApprovalUserAvatarvue_type_script_lang_js=ApprovalUserAvatarvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_ApprovalUserAvatarvue_type_script_lang_js,render,staticRenderFns,!1,null,"443099a5",null)
/* harmony default export */,ApprovalUserAvatar=component.exports},
/***/785595:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return NotificationPreference}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/contract/components/NotificationPreference.vue?vue&type=template&id=064c653f&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_vm.loading?_c("div",{staticClass:"mT50 fc-webform-loading"},[_c("spinner",{attrs:{show:_vm.loading,size:"80"}})],1):_c("div",{staticClass:"new-body-modal"},[_vm.preferenceList&&0!==_vm.preferenceList.length?_vm._e():_c("div",[_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"attendance-transaction-no-data"},[_c("img",{attrs:{src:__webpack_require__(15482),width:"100",height:"100"}}),_c("div",{staticClass:"mT10 label-txt-black f14"},[_vm._v(" No Notification Preferences Available ")])])])],1)],1),_vm._l(_vm.preferenceList,(function(preference,index){return _c("div",{key:index,staticClass:"pB20"},[_c("el-row",{attrs:{span:24}},[_c("el-col",{staticClass:"preference-col",attrs:{span:24}},[_c("el-checkbox",{on:{change:function($event){return _vm.preferenceCheckboxChangeActions(preference)}},model:{value:preference.isEnabled,callback:function($$v){_vm.$set(preference,"isEnabled",$$v)},expression:"preference.isEnabled"}},[_vm._v(_vm._s(preference.displayName))]),_c("span",{staticClass:"pL20"},[preference.isEnabled?_c("el-button",{staticClass:"small-border-btn-save",attrs:{type:"button"},on:{click:function($event){preference&&preference.id>0?preference.showForm?_vm.addPreference(preference):_vm.toggleShowForm(preference):_vm.addPreference(preference)}}},[_vm._v(_vm._s(preference&&preference.id>0?preference.showForm?"Save":"Edit":"Save"))]):_vm._e()],1),_c("span",{staticClass:"pL20"},[preference.isEnabled&&preference.showForm?_c("el-button",{staticClass:"small-border-btn",attrs:{type:"button"},on:{click:function($event){preference&&preference.id>0||(preference.isEnabled=!1),_vm.toggleShowForm(preference)}}},[_vm._v("Close")]):_vm._e()],1)],1)],1),preference.showForm?_c("el-row",{staticClass:"pT30 pL50"},[_c("facilio-web-form",{staticClass:"facilio-notification-preference-web-form-body",attrs:{editObj:preference.editData,formFields:preference.form,emitForm:preference.emitForm,reset:preference.resetForm},on:{failed:function($event){preference.saving=!1,preference.emitForm=!1},validated:function(data){return _vm.submitForm(data,preference)},"update:reset":function($event){return _vm.$set(preference,"resetForm",$event)}}})],1):_vm._e()],1)}))],2),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel width100",on:{click:function($event){return _vm.closeDialog()}}},[_vm._v("CANCEL")])],1)])},staticRenderFns=[],FacilioWebForm=(__webpack_require__(434284),__webpack_require__(169358),__webpack_require__(670560),__webpack_require__(260228),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(947522),__webpack_require__(111801)),moment_timezone=__webpack_require__(480008),moment_timezone_default=__webpack_require__.n(moment_timezone),NotificationPreferencevue_type_script_lang_js={props:["moduleName","recordId","visibility"],components:{FacilioWebForm:FacilioWebForm/* default */.Z},data:function(){return{loading:!1,saveLoading:!1,preferenceList:null,enabledPreferenceList:null}},mounted:function(){this.loadAllPreferenceData()},computed:{},methods:{closeDialog:function(){this.$emit("update:visibility",!1)},submitForm:function(data,preference){var _this=this,tempData=this.$helpers.cloneObject(data);
// Special Handlings For Data Formatting is done here
this.moduleName.indexOf("contract")>0&&(tempData.time=this.convertSecondsToTimeHHMM(tempData.time),tempData["days"]=parseInt(tempData.days));var param={moduleName:this.moduleName,name:preference.name,value:tempData};preference.id>0&&(param["preferenceId"]=preference.id),this.recordId>0&&(param["recordId"]=this.recordId),preference.saving=!0,this.$http.post("v2/preference/enable",param).then((function(response){if(0===response.data.responseCode){_this.$message.success("Preference Configured Successfully");var resultPref=response.data.result.preferences,tempSetObj=_this.specialDataFormating(resultPref);_this.$set(preference,"editData",tempSetObj),_this.$set(preference,"id",resultPref.id),preference.isEnabled=!0,preference.showForm=!1}else _this.$message.error(response.data.message);preference.saving=!1,preference.emitForm=!1})).catch((function(error){_this.$message.error(error),preference.saving=!1,preference.emitForm=!1}))},specialDataFormating:function(resultPref){var tempSetObj=JSON.parse(resultPref.formData);return this.moduleName.indexOf("contracts")>0&&(tempSetObj.time=moment_timezone_default()(tempSetObj.time,"HH:mm").valueOf()),tempSetObj},loadAllPreferenceData:function(){var _this2=this;this.loading=!0;var promises=[],allPrefParam={};allPrefParam["moduleName"]=this.moduleName,this.recordId>0&&(allPrefParam["isModuleSpecific"]=!1);var allPrefList=this.$http.post("/v2/preference/getAllPrefslist",allPrefParam),prefParam={};prefParam["moduleName"]=this.moduleName,this.recordId>0&&(prefParam["recordId"]=this.recordId);var enabledPrefList=this.$http.post("/v2/preference/getEnabledPrefsList",prefParam);promises.push(allPrefList),promises.push(enabledPrefList),Promise.all(promises).then((function(response){0===response[0].data.responseCode?(_this2.preferenceList=response[0].data.result.preferenceList,_this2.preferenceList&&_this2.preferenceList.forEach((function(i){_this2.$set(i,"isEnabled",!1),_this2.$set(i,"showForm",!1),_this2.$set(i,"emitForm",!1),_this2.$set(i,"resetForm",!1),_this2.$set(i,"saving",!1)}))):_this2.$message.error(response[0].data.message),0===response[1].data.responseCode?(_this2.enabledPreferenceList=response[1].data.result.preferenceList,_this2.enabledPreferenceList&&_this2.preferenceList&&_this2.enabledPreferenceList.forEach((function(i){_this2.preferenceList.forEach((function(j){if(j.name===i.preferenceName){var temp=_this2.specialDataFormating(i);_this2.$set(j,"editData",temp),_this2.$set(j,"id",i.id),j.isEnabled=!0}}))}))):_this2.$message.error(response[1].data.message),_this2.loading=!1})).catch((function(error){_this2.$message.error(error)}))},addPreference:function(preference){preference.emitForm=!0},convertSecondsToTimeHHMM:function(val){return moment_timezone_default()(val).format("HH:mm")},preferenceCheckboxChangeActions:function(preference){var _this3=this;!preference.isEnabled&&preference.id>0?this.$http.post("/v2/preference/disable",{preferenceId:preference.id}).then((function(response){0===response.data.responseCode?(_this3.$message.success("Preference Disabled Successfully"),_this3.loadAllPreferenceData()):_this3.$message.error(response.data.message)})).catch((function(error){_this3.$message.error(error)})):preference.isEnabled?preference.isEnabled&&(preference.showForm=!0):preference.showForm=!1},toggleShowForm:function(preference){preference.showForm=!preference.showForm}}},components_NotificationPreferencevue_type_script_lang_js=NotificationPreferencevue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_NotificationPreferencevue_type_script_lang_js,render,staticRenderFns,!1,null,"064c653f",null)
/* harmony default export */,NotificationPreference=component.exports},
/***/848277:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return CustomModuleSummary}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/custom-module/CustomModuleSummary.vue?vue&type=template&id=2c44e6b2&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"custom-module-overview",class:_vm.customClass},[_vm.isLoading?_c("div",{staticClass:"flex-middle fc-empty-white"},[_c("spinner",{attrs:{show:_vm.isLoading,size:"80"}})],1):_vm.$validation.isEmpty(_vm.record)?_vm._e():[_c("div",{staticClass:"header p20"},[_c("div",{staticClass:"custom-module-details"},[_c("div",{staticClass:"d-flex flex-middle align-center"},[_vm.showPhotoField?_c("div",{staticClass:"mR5"},[_vm.record[_vm.photoFieldName]?_c("div",[_vm.$helpers.isLicenseEnabled("THROW_403_WEBTAB")?_c("img",{staticClass:"img-container",attrs:{src:_vm.record.getImageUrl("photoUrl")}}):_c("img",{staticClass:"img-container",attrs:{src:_vm.record.getImage(_vm.photoFieldName)}})]):_vm.showAvatar?_c("div",[_c("avatar",{attrs:{size:"lg",user:{name:_vm.record.name}}})],1):_vm._e()]):_vm._e(),_c("div",{staticClass:"mL5"},[_c("div",{staticClass:"custom-module-id"},[_vm.$account.portalInfo?_c("i",{directives:[{name:"tippy",rawName:"v-tippy",value:{animateFill:!1,animation:"shift-toward"},expression:"{ animateFill: false, animation: 'shift-toward' }"}],staticClass:"el-icon-back fc-grey3-text14 fw6 pR10 pointer",attrs:{content:"back",arrow:""},on:{click:_vm.back}}):_vm._e(),_vm._v(" #"+_vm._s(_vm.record&&_vm.record.id)+" ")]),_c("div",{staticClass:"custom-module-name "},[_c("div",{staticClass:"d-flex max-width300px"},[_c("el-tooltip",{attrs:{placement:"bottom",effect:"dark",content:_vm.record[_vm.mainFieldKey]}},[_c("span",{staticClass:"whitespace-pre-wrap custom-header"},[_vm._v(_vm._s(_vm.record[_vm.mainFieldKey]))])])],1),_vm.record.isStateFlowEnabled()&&_vm.record.currentModuleState()?_c("div",{staticClass:"fc-badge text-uppercase inline vertical-middle mL15"},[_vm._v(" "+_vm._s(_vm.record.currentModuleState())+" ")]):_vm._e()])])])]),_c("div",{staticClass:"marginL-auto flex-middle"},[_c("CustomButton",{staticClass:"pR10",attrs:{record:_vm.record,moduleName:_vm.moduleName,position:_vm.POSITION.SUMMARY},on:{refresh:function($event){return _vm.refreshData()},onError:function(){}}}),_vm.record.isStateFlowEnabled()?[_c("TransitionButtons",{key:_vm.record.id+"transitions",staticClass:"mR10",attrs:{moduleName:_vm.moduleName,record:_vm.record,disabled:_vm.record.isApprovalEnabled(),buttonClass:"asset-el-btn"},on:{currentState:function(){},transitionSuccess:function($event){return _vm.refreshData()},transitionFailure:function(){}}})]:_vm._e(),_vm.record.isApprovalEnabled()?_c("portal",{attrs:{to:"pagebuilder-sticky-top"}},[_c("ApprovalBar",{key:_vm.record.id+"approval-bar",staticClass:"approval-bar-shadow",attrs:{moduleName:_vm.moduleName,record:_vm.record,hideApprovers:_vm.shouldHideApprovers},on:{onSuccess:function($event){return _vm.refreshData()},onFailure:function(){}}})],1):_vm._e(),_vm.showEdit?_c("el-button",{staticClass:"fc-wo-border-btn pL15 pR15 self-center",attrs:{type:"button"},on:{click:_vm.editRecord}},[_c("i",{staticClass:"el-icon-edit"})]):_vm._e()],2)]),_c("Page",{key:_vm.record.id,attrs:{module:_vm.moduleName,id:_vm.record.id,details:_vm.record,primaryFields:_vm.primaryFields,notesModuleName:_vm.notesModuleName,isV3Api:!0,attachmentsModuleName:_vm.attachmentsModuleName}})]],2)},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),PageBuilder=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(434284),__webpack_require__(670560),__webpack_require__(760218)),api=__webpack_require__(32284),router=__webpack_require__(329435),CustomButton=__webpack_require__(623857),CustomButtonUtil=__webpack_require__(746095),TransitionButtons=__webpack_require__(987612),ApprovalBar=__webpack_require__(42525),constant=__webpack_require__(354754),CustomModuleData=__webpack_require__(689565),eventBus=__webpack_require__(398011),CustomModuleSummaryvue_type_script_lang_js={name:"CustomModuleSummary",components:{Page:PageBuilder/* default */.Z,CustomButton:CustomButton/* default */.Z,TransitionButtons:TransitionButtons/* default */.Z,ApprovalBar:ApprovalBar/* default */.Z},data:function(){return{isLoading:!1,record:null,primaryFields:[],notesModuleName:"cmdnotes",attachmentsModuleName:"cmdattachments",formFields:null,POSITION:CustomButtonUtil/* POSITION_TYPE */.Rz,customClass:""}},created:function(){this.$store.dispatch("loadApprovalStatus")},mounted:function(){eventBus/* eventBus */.Y.$on("refresh-overview",this.refreshData)},beforeDestroy:function(){eventBus/* eventBus */.Y.$off("refresh-overview",this.refreshData)},computed:{moduleName:function(){return this.$route.params.moduleName?this.$route.params.moduleName:this.$attrs.moduleName||""},id:function(){var paramId=this.$attrs.id||this.$route.params.id;return paramId&&"null"!==paramId?parseInt(this.$route.params.id):""},showEdit:function(){var $org=this.$org,$hasPermission=this.$hasPermission,record=this.record,orgIdsToCheck=constant/* default */.Z.isCustomModulePermissionsEnabled,canShowEdit=!orgIdsToCheck($org.id)&&!(0,router/* isWebTabsEnabled */.tj)()||$hasPermission("".concat(this.moduleName,":UPDATE"));return canShowEdit&&record.canEdit()},mainFieldKey:function(){return"name"},photoFieldName:function(){return"photoId"},showPhotoField:function(){var formFields=this.formFields;if(formFields){var photoField=formFields.find((function(field){return"photo"===field.name}));return!!photoField&&!photoField.hideField}return!1},showAvatar:function(){return!1},shouldHideApprovers:function(){return!1},modelDataClass:function(){return CustomModuleData/* CustomModuleData */.u}},watch:{id:{handler:function(){this.loadRecord(!0)},immediate:!0},moduleName:function(){this.loadRecord(!0)}},methods:{refreshData:function(){this.loadRecord(!0)},loadRecord:function(){var _arguments=arguments,_this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var force,moduleName,id;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return force=_arguments.length>0&&void 0!==_arguments[0]&&_arguments[0],_context.prev=1,moduleName=_this.moduleName,id=_this.id,_this.isLoading=!0,_context.next=6,_this.modelDataClass.fetch({moduleName:moduleName,id:id,force:force});case 6:return _this.record=_context.sent,_context.next=9,_this.getFormMeta();case 9:_context.next=14;break;case 11:_context.prev=11,_context.t0=_context["catch"](1),_this.$message.error((null===_context.t0||void 0===_context.t0?void 0:_context.t0.message)||_this.$t("custommodules.summary.record_summary_error"));case 14:_this.isLoading=!1;case 15:case"end":return _context.stop()}}),_callee,null,[[1,11]])})))()},editRecord:function(){var moduleName=this.moduleName,id=this.id;if((0,router/* isWebTabsEnabled */.tj)()){var _ref=(0,router/* findRouteForModule */.Jp)(moduleName,router/* pageTypes */.As.EDIT)||{},name=_ref.name;name&&this.$router.push({name:name,params:{id:id}})}else{var creationName="custommodules-edit";this.$router.push({name:creationName,params:{moduleName:moduleName,id:id}})}},getFormMeta:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var _this2$record,_this2$record2,formId,moduleName,url,_yield$API$get,data,error,formFields;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _this2$record=_this2.record,_this2$record2=void 0===_this2$record?{}:_this2$record,formId=_this2$record2.formId,moduleName=_this2.moduleName,url="/v2/forms/".concat(moduleName),_context2.next=4,api/* API */.bl.get(url,{formId:formId||-1});case 4:_yield$API$get=_context2.sent,data=_yield$API$get.data,error=_yield$API$get.error,error||(formFields=(data.form||{}).fields,_this2.formFields=formFields);case 8:case"end":return _context2.stop()}}),_callee2)})))()},back:function(){this.$router.go(-1)}}},custom_module_CustomModuleSummaryvue_type_script_lang_js=CustomModuleSummaryvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(custom_module_CustomModuleSummaryvue_type_script_lang_js,render,staticRenderFns,!1,null,"2c44e6b2",null)
/* harmony default export */,CustomModuleSummary=component.exports},
/***/935010:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"765af973ce02f8f593ec7a4e85d08efb.svg";
/***/}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/86875.js.map