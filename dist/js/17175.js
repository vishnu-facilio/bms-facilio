"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[17175],{
/***/673362:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return SpaceAssetMultiChooser}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/SpaceAssetMultiChooser.vue?vue&type=template&id=0ccc2fed
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{attrs:{visible:_vm.visibility,fullscreen:!1,open:"top",width:"60%","custom-class":" fc-dialog-up spaceassetchooser setup-dialog60","before-close":_vm.handleclose,"append-to-body":!0},on:{"update:visible":function($event){_vm.visibility=$event}}},[_c("div",{staticClass:"multi f-element",attrs:{id:"spaceassetchooser"}},[_vm.hideBanner?_vm._e():_c("banner",{attrs:{message:_vm.message,hideIcon:!_vm.selectedList.count}}),_c("div",{staticStyle:{height:"600px","overflow-y":"hidden"}},[_c("div",{staticStyle:{"background-color":"#ffffff",height:"100%",width:"100%",display:"inline-block"}},[_c("div",{staticClass:"flex-middle justify-content-space pT20 pL20 pR20"},[_vm.isAsset?_c("el-select",{staticClass:"inline asset-category fc-input-full-border2",attrs:{filterable:"",placeholder:_vm.assetCategory.placeHolder,disabled:!_vm.isAsset||_vm.disable},on:{change:_vm.onCategoryChange},model:{value:_vm.assetCategory.value,callback:function($$v){_vm.$set(_vm.assetCategory,"value",$$v)},expression:"assetCategory.value"}},_vm._l(_vm.assetCategory.options,(function(label,value){return _c("el-option",{key:value,attrs:{label:label,value:parseInt(value)}})})),1):_c("el-select",{staticClass:"inline asset-category fc-input-full-border2",attrs:{filterable:"",clearable:"",placeholder:_vm.spaceCategory.placeHolder},on:{change:_vm.onSpaceCategoryChange},model:{value:_vm.spaceCategory.value,callback:function($$v){_vm.$set(_vm.spaceCategory,"value",$$v)},expression:"spaceCategory.value"}},_vm._l(_vm.spaceCategory.options,(function(label,value){return _c("el-option",{key:value,attrs:{label:label,value:value}})})),1),_vm.hideBanner?_vm._e():_c("div",{staticClass:"pull-right"},[_c("el-radio-group",{on:{change:_vm.onIncludeTypeChange},model:{value:_vm.includeType,callback:function($$v){_vm.includeType=$$v},expression:"includeType"}},[_c("el-radio",{staticClass:"fc-radio",attrs:{label:"all"}},[_vm._v("All")]),_c("el-radio",{staticClass:"fc-radio",attrs:{label:"include"}},[_vm._v("Include")]),_c("el-radio",{staticClass:"fc-radio",attrs:{label:"exclude"}},[_vm._v("Exclude")])],1)],1)],1),_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"pT10 pB10",staticStyle:{"padding-left":"20px","padding-right":"20px","border-bottom":"1px solid #e6ecf3 !important"}},[_vm.showQuickSearch?_c("div",{staticStyle:{display:"inline-block",width:"100%"}},[_c("div",{staticClass:"col-6 fc-list-search"},[_c("div",{staticClass:"fc-list-search-wrapper relative chooser-search"},[_c("svg",{staticClass:"search-icon",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32"}},[_c("title",[_vm._v("search")]),_c("path",{attrs:{d:"M21.487 22.927l7.037 7.037c.473.473 1.238.475 1.71.003s.47-1.237-.003-1.71l-7.037-7.037c3.96-4.82 3.675-11.967-.846-16.487C17.539-.076 9.757-.092 4.966 4.699S.191 17.272 5 22.081c4.52 4.52 11.667 4.805 16.487.846zM6.679 6.413c3.848-3.848 10.099-3.836 13.962.027s3.875 10.114.027 13.962c-3.848 3.848-10.099 3.836-13.962-.027S2.831 10.261 6.679 6.413z"}})]),_c("input",{directives:[{name:"model",rawName:"v-model",value:_vm.quickSearchQuery,expression:"quickSearchQuery"}],ref:"quickSearchQuery",staticClass:"quick-search-input",attrs:{autofocus:"",type:"text",placeholder:"Search"},domProps:{value:_vm.quickSearchQuery},on:{keyup:function($event){return!$event.type.indexOf("key")&&_vm._k($event.keyCode,"enter",13,$event.key,"Enter")?null:_vm.setResourceData.apply(null,arguments)},input:function($event){$event.target.composing||(_vm.quickSearchQuery=$event.target.value)}}}),_c("svg",{staticClass:"close-icon",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32","aria-hidden":"true"},on:{click:_vm.toggleQuickSearch}},[_c("title",[_vm._v("close")]),_c("path",{attrs:{d:"M17.992 16l8.796-8.796a1.409 1.409 0 0 0-1.992-1.992L16 14.008 7.204 5.212a1.409 1.409 0 0 0-1.992 1.992L14.008 16l-8.796 8.796a1.409 1.409 0 0 0 1.992 1.992L16 17.992l8.796 8.796a1.409 1.409 0 0 0 1.992-1.992L17.992 16z"}})])])])]):_c("div",{staticClass:"asset-chooser-select-block"},[_vm._l(_vm.resourceConfig,(function(field){return _c("div",{key:field.spaceType,staticClass:"inline"},[!_vm.resourceType||_vm.resourceType.includes(field.spaceType+1)?_c("el-select",{attrs:{multiple:"","collapse-tags":"",filterable:"",clearable:"",placeholder:field.placeHolder,disabled:4===field.spaceType&&!_vm.isAsset||field.disabled},on:{change:function($event){return _vm.onLocationChange(field)}},model:{value:field.value,callback:function($$v){_vm.$set(field,"value",$$v)},expression:"field.value"}},_vm._l(field.options,(function(option){return _c("el-option",{key:option.id,attrs:{label:option.name,value:option.id}})})),1):_vm._e()],1)})),_c("span",{staticClass:"searchicon pull-right pointer"},[_c("span",{on:{click:_vm.toggleQuickSearch}},[_c("i",{staticClass:"el-icon-search"})])])],2)])])],1),_c("div",{staticClass:"scroll-multichooser"},[_c("el-row",[_c("el-col",{staticClass:"table-scroll-chooser",attrs:{span:_vm.hideBanner?16:24}},[_c("v-infinite-scroll",{staticStyle:{"max-height":"500px","overflow-y":"scroll","padding-bottom":"50px"},attrs:{loading:_vm.loading,offset:20},on:{bottom:_vm.nextPage}},[_c("table",{staticClass:" pT15 fc-list-view-table border-right-table"},[_c("thead",[_c("tr",{staticClass:"tablerow pT30",staticStyle:{"background-color":"#ffffff",padding:"15px"}},[_c("td",{staticClass:"headerrow "},[_c("el-checkbox",{attrs:{disabled:"exclude"===_vm.includeType&&!_vm.hideBanner},on:{change:_vm.onSelectAllChange},model:{value:_vm.selectall,callback:function($$v){_vm.selectall=$$v},expression:"selectall"}})],1),_c("td",{staticClass:"headerrow width30"},[_vm._v("#ID")]),_c("td",{staticClass:"headerrow width30"},[_vm._v("NAME")]),_c("td",{staticClass:"headerrow width30"},[_vm._v("CATEGORY")])])]),_c("tbody",[_vm._l(_vm.spaceList,(function(space){return _vm.isAsset?_vm._e():_c("tr",{key:space.id,staticClass:"tablerow",class:{selectedrow:space.selected}},[_c("td",{staticClass:"contentrow"},[_c("el-checkbox",{on:{change:function($event){return _vm.toggleSelect(space,!0)}},model:{value:space.selected,callback:function($$v){_vm.$set(space,"selected",$$v)},expression:"space.selected"}})],1),_c("td",{staticClass:"contentrow width30",on:{click:function($event){return $event.stopPropagation(),_vm.toggleSelect(space)}}},[_vm._v(" #"+_vm._s(1==space.spaceType?"SI"+space.id:2==space.spaceType?"BU"+space.id:3==space.spaceType?"FL"+space.id:4==space.spaceType?"SP"+space.id:space.id)+" ")]),_c("td",{staticClass:"contentrow width30",on:{click:function($event){return $event.stopPropagation(),_vm.toggleSelect(space)}}},[_vm._v(" "+_vm._s(space.name)+" ")]),_c("td",{staticClass:"contentrow width30"},[_vm._v(" "+_vm._s(space.spaceTypeVal)+" ")])])})),_vm._l(_vm.assetList,(function(asset){return _vm.isAsset?_c("tr",{key:asset.id,staticClass:"tablerow",class:{selectedrow:asset.selected}},[_c("td",{staticClass:"contentrow"},[_c("el-checkbox",{on:{change:function($event){return _vm.toggleSelect(asset,!0)}},model:{value:asset.selected,callback:function($$v){_vm.$set(asset,"selected",$$v)},expression:"asset.selected"}})],1),_c("td",{staticClass:"contentrow width30",on:{click:function($event){return $event.stopPropagation(),_vm.toggleSelect(asset)}}},[_vm._v(" #"+_vm._s(asset.id)+" ")]),_c("td",{staticClass:"contentrow width30",on:{click:function($event){return $event.stopPropagation(),_vm.toggleSelect(asset)}}},[_vm._v(" "+_vm._s(asset.name)+" ")]),_c("td",{staticClass:"contentrow width30"},[_vm._v(" "+_vm._s(asset.category?_vm.getAssetCategory(asset.category.id).displayName:"---")+" ")])]):_vm._e()})),_vm.spaceList&&_vm.spaceList.length<1&&_vm.assetList&&_vm.assetList.length<1?_c("tr",{staticStyle:{background:"none",border:"none","margin-top":"20px"}},[_c("td",{staticClass:"text-center label-txt-black",staticStyle:{"border-bottom":"none","font-size":"14px","padding-top":"40px",cursor:"auto"},attrs:{colspan:"100%"}},[_vm._v(" No "+_vm._s(_vm.isAsset?"Asset":"Space")+" to display! ")])]):_vm._e()],2)])])],1),_vm.hideBanner?_c("el-col",{staticClass:"chooser-selected-container",attrs:{span:8}},[_c("div",{staticClass:"chooser-scroll-block"},[_vm.selectedList&&_vm.selectedList.length?_c("div",{staticClass:"count-message"},[_vm._v(" "+_vm._s(_vm.message)+" ")]):_vm._e(),_vm._l(_vm.selectedList,(function(resource,value){return _c("div",{key:value,staticClass:"selected-field"},[_vm._v(" "+_vm._s(resource.name)+" "),_c("i",{staticClass:"el-icon-close remove",on:{click:function($event){return _vm.deSelect(resource)}}})])}))],2)]):_vm._e()],1)],1),_c("div",{staticClass:"f-footer row"},[_c("button",{staticClass:"footer-btn footer-btn-secondary col-6",attrs:{type:"button"},on:{click:_vm.handleclose}},[_c("span",[_vm._v("Cancel")])]),_c("button",{staticClass:"footer-btn footer-btn-primary col-6",attrs:{type:"button"},on:{click:_vm.associate}},[_c("span",[_vm._v("Ok")])])])],1)]),_c("div",{staticStyle:{position:"absolute",top:"45%",left:"45%","z-index":"5"}},[_c("spinner",{attrs:{show:_vm.resourceLoading,size:"70"}})],1)],1)])},staticRenderFns=[],objectSpread2=__webpack_require__(595082),v_infinite_scroll=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(670560),__webpack_require__(450886),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(339772),__webpack_require__(162506),__webpack_require__(561364)),v_infinite_scroll_default=__webpack_require__.n(v_infinite_scroll),ResourceMixin=__webpack_require__(22637),FBannervue_type_template_id_85b57242_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_vm.message?_c("div",{staticClass:"banner-block",style:{"background-color":_vm.bannerColor}},[_c("div",{staticClass:"banner-content"},[_c("i",{directives:[{name:"show",rawName:"v-show",value:!_vm.hideIcon,expression:"!hideIcon"}],class:["banner-icon flLeft",_vm.bannerIcon],style:{color:_vm.bannerTextColor},attrs:{"aria-hidden":"true"}}),_c("p",{staticClass:"banner-txt flLeft",style:{color:_vm.bannerTextColor}},[_vm._v(" "+_vm._s(_vm.message)+" ")])])]):_vm._e()])},FBannervue_type_template_id_85b57242_staticRenderFns=[],FBannervue_type_script_lang_js={props:["message","icon","color","textColor","hideIcon"],computed:{bannerColor:function(){var color;return this.color?color=this.color:this.isError||(color="#ecf3da"),color},bannerTextColor:function(){var color;return this.textColor?color=this.textColor:this.isError||(color="#67933a"),color},bannerIcon:function(){var icon;return this.icon?icon=this.icon:this.isError||(icon="el-icon-circle-check-outline"),icon}}},components_FBannervue_type_script_lang_js=FBannervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FBannervue_type_script_lang_js,FBannervue_type_template_id_85b57242_render,FBannervue_type_template_id_85b57242_staticRenderFns,!1,null,null,null)
/* harmony default export */,FBanner=component.exports,vuex_esm=__webpack_require__(420629),SpaceAssetMultiChooservue_type_script_lang_js={mixins:[ResourceMixin/* default */.Z],props:["visibility","disable","hideBanner"],components:{Banner:FBanner,VInfiniteScroll:v_infinite_scroll_default()},data:function(){return{selectall:!1,showQuickSearch:!1,includeType:"all",selectedList:[]}},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapGetters */.Se)(["getAssetCategory"])),{},{message:function(){var message,selectedCount=this.selectedList.length;if("all"===this.includeType&&this.categoryName)message="All "+this.categoryName+"s have been selected";else if("all"!==this.includeType&&selectedCount){var includeMsg;includeMsg=this.hideBanner?" Selected":"include"===this.includeType?" Included":" Excluded";var resource=(this.categoryName?this.categoryName:"")+(this.showAsset?" Asset":" Space");message=selectedCount+" "+resource+(selectedCount>1?"s":"")+includeMsg}else message=this.resourceType?"No Space Selected":"No Asset Selected";return message},categoryName:function(){return!this.assetCategory||this.assetCategory.value<=0?"":this.assetCategory.options[this.assetCategory.value]}}),created:function(){var _this=this;this.$store.dispatch("loadSpaceCategory"),this.$store.dispatch("loadAssetCategory").then((function(){_this.initResourceData()}))},watch:{visibility:function(val){val?this.reInit():val||!this.query||this.selectedList&&this.selectedList.length||this.$emit("associate",{})},query:function(val){this.quickSearchQuery=val,val&&(this.showQuickSearch=!0,this.setResourceData())},initialResourcesFecthed:function(val){val&&this.setInitialData()}},methods:{reInit:function(){this.showQuickSearch=!1,this.quickSearchQuery=null,this.checkAndInitResourceData()},deSelect:function(object){var resource=this.resourceList.find((function(resource){return resource.id===object.id}));resource?resource.selected=!1:resource=object,this.setSelectedResource(resource),this.setIncludeTypeOnChange()},handleclose:function(){this.$emit("update:visibility",!1),this.$emit("update:siteId",null)},openSpace:function(){this.isAsset=!1,this.loadSpace()},openAsset:function(){this.isAsset=!0,this.loadAsset()},associate:function(){var obj={};"all"!==this.includeType&&(obj.resourceList=this.selectedList,obj.isInclude="include"===this.includeType),this.$emit("associate",obj)},toggleQuickSearch:function(){var _this2=this;this.showQuickSearch=!this.showQuickSearch,this.showQuickSearch?this.$nextTick((function(){_this2.$refs.quickSearchQuery.focus()})):(this.quickSearchQuery=null,this.setResourceData())},onCategoryChange:function(){this.assetCategory.value?this.includeType="all":this.setIncludeTypeOnChange(),this.onCategorySelected(),this.selectedList=[]},onSpaceCategoryChange:function(){this.spaceCategory;this.onSpaceCategorySelected(),this.selectedList=[]},onSelectAllChange:function(){var _this3=this;this.selectedList=[],this.resourceList.forEach((function(resource){_this3.$set(resource,"selected",_this3.selectall),_this3.setSelectedResource(resource)})),this.setIncludeTypeOnChange()},toggleSelect:function(resource,alreadyChanged){alreadyChanged||this.$set(resource,"selected",!resource.selected),this.setSelectedResource(resource),this.selectall=this.selectedList.length===this.resourceList.length,this.setIncludeTypeOnChange()},setInitialData:function(){var _this4=this;if(this.initialData){var selectedResources=this.initialData.selectedResources;this.includeType=selectedResources&&selectedResources.length?this.initialData.isIncludeResource?"include":"exclude":"all";var idArray=[];selectedResources&&(this.selectedList=[],this.resourceList.forEach((function(resource){var resourceSelectedObj=_this4.initialData.selectedResources.some((function(selctedResource){return selctedResource.id===resource.id}));_this4.$set(resource,"selected",resourceSelectedObj),_this4.setSelectedResource(resource)}))),this.selectedList&&selectedResources&&this.selectedList.length<selectedResources.length&&(this.selectedList=[],this.initialData.selectedResources.forEach((function(d){idArray.push(d.id)})),this.$util.loadResource(idArray).then((function(fields){_this4.selectedList=fields})))}},setIncludeTypeOnChange:function(){"all"===this.includeType?this.includeType="include":this.selectedList.length||(this.includeType="all")},onIncludeTypeChange:function(){var _this5=this;"all"===this.includeType&&(this.resourceList.forEach((function(resource){_this5.$set(resource,"selected",!1)})),this.selectedList=[],this.selectall=!1)},isSelected:function(resourceId){return this.selectedList.find((function(resource){return resource.id===resourceId}))},onLocationChange:function(field){var _this6=this;this.onLocationSelected(field).then((function(){_this6.setListSelected()})),this.setIncludeTypeOnChange()},setResourceData:function(){var _this7=this;this.loadResourceData().then((function(){_this7.setListSelected()}))},setListSelected:function(){var _this8=this,selectedIds=this.selectedList.map((function(resource){return resource.id}));this.isAsset?this.assetList.map((function(asset){return selectedIds.includes(asset.id)&&_this8.$set(asset,"selected",!0),asset})):this.spaceList.map((function(space){return selectedIds.includes(space.id)&&_this8.$set(space,"selected",!0),space}))},setSelectedResource:function(resource){if(resource.selected)this.selectedList.push(this.$helpers.cloneObject(resource));else{var idx=this.selectedList.findIndex((function(sr){return sr.id===resource.id}));-1!==idx&&this.selectedList.splice(idx,1)}}}},components_SpaceAssetMultiChooservue_type_script_lang_js=SpaceAssetMultiChooservue_type_script_lang_js,SpaceAssetMultiChooser_component=(0,componentNormalizer/* default */.Z)(components_SpaceAssetMultiChooservue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,SpaceAssetMultiChooser=SpaceAssetMultiChooser_component.exports},
/***/604947:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return Spinner}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/Spinner.vue?vue&type=template&id=06a81286&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("transition",[_c("svg",{directives:[{name:"show",rawName:"v-show",value:_vm.show,expression:"show"}],staticClass:"spinner",class:{show:_vm.show},attrs:{width:_vm.spinnerSize,height:_vm.spinnerSize,viewBox:"0 0 44 44"}},[_c("circle",{staticClass:"path",style:{stroke:_vm.strokeColor},attrs:{fill:"none","stroke-width":"4","stroke-linecap":"round",cx:"22",cy:"22",r:"20"}})])])},staticRenderFns=[],Spinnervue_type_script_lang_js={name:"spinner",props:["show","size","colour"],computed:{spinnerSize:function(){return this.size?this.size+"px":"50px"},strokeColor:function(){return this.colour?this.colour:"#fd4b92"}}},components_Spinnervue_type_script_lang_js=Spinnervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_Spinnervue_type_script_lang_js,render,staticRenderFns,!1,null,"06a81286",null)
/* harmony default export */,Spinner=component.exports},
/***/147762:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return RuleActionWidget}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/page/widget/rule/RuleActionWidget.vue?vue&type=template&id=512bdc0e
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("div",[_c("portal",{attrs:{to:_vm.tab.name+"-title-section"}},[_c("div",{staticClass:"widget-header d-flex flex-direction-row mB15 mT5"},[_c("div",{staticClass:"flex-middle justify-end width100"},["newreadingrules"!==_vm.moduleName?_c("el-popover",{attrs:{placement:"bottom",width:"250","popper-class":"popover-height asset-popover ",trigger:"click","visible-arrow":"true"},model:{value:_vm.toggle,callback:function($$v){_vm.toggle=$$v},expression:"toggle"}},[_c("ul",[_c("li",{on:{click:function($event){return _vm.opennewActionForm("severityAction","Severity Change")}}},[_vm._v(" "+_vm._s(_vm.$t("common._common.severity_change"))+" ")]),_c("li",{on:{click:function($event){return _vm.opennewActionForm("notification","Notification")}}},[_vm._v(" "+_vm._s(_vm.$t("common.header.notification"))+" ")]),_vm.isWoCreated?_vm._e():_c("li",{on:{click:function($event){return _vm.enableWo(11,"Create Wo")}}},[_vm._v(" "+_vm._s(_vm.$t("common.header.enable_create_workOrder"))+" ")]),!_vm.isAutoCloseWoCreated&&_vm.isWoCreated?_c("li",{on:{click:function($event){return _vm.enableWo(12,"Auto Close Wo")}}},[_vm._v(" "+_vm._s(_vm.$t("common.header.enable_auto_close_workorder"))+" ")]):_vm._e()]),_c("div",{staticClass:"label-txt-blue bold pointer",attrs:{slot:"reference"},slot:"reference"},[_c("i",{staticClass:"el-icon-plus pR5 fwBold"}),_vm._v(" "+_vm._s(_vm.$t("common.header.add_action"))+" ")])]):_vm._e()],1)])])],1),_vm.isLoading?[_c("spinner",{attrs:{show:_vm.isLoading,size:"80"}})]:_vm._e(),_vm.$validation.isEmpty(_vm.actions)||"newreadingrules"===_vm.moduleName?_c("div",{staticClass:"block"},[_c("div",{staticClass:"mT40 mB40 text-center p30imp"},[_c("InlineSvg",{attrs:{src:"svgs/emptystate/alarmEmpty",iconClass:"icon text-center icon-xxxxlg emptystate-icon-size"}}),_c("div",{staticClass:"fc-black-dark f18 bold"},[_vm._v(" "+_vm._s(_vm.$t("common.products.no_action"))+"! ")])],1)]):_c("div",[_c("el-table",{staticClass:"impact-form-table rule-actions-form-table",staticStyle:{width:"100%"},attrs:{data:_vm.actions,fit:!0}},[_c("el-table-column",{attrs:{width:"20"}}),_c("el-table-column",{attrs:{label:_vm.$t("common._common._rule_name")},scopedSlots:_vm._u([{key:"default",fn:function(action){return[_c("div",{staticClass:"line-height20"},[_vm._v(_vm._s(action.row.name))])]}}],null,!1,3096505486)}),_c("el-table-column",{attrs:{label:_vm.$t("common._common.execute_on")},scopedSlots:_vm._u([{key:"default",fn:function(action){return[_c("div",{staticClass:"line-height20"},[_vm._v(" "+_vm._s(_vm.checkActivityType(action.row.event.activityType))+" ")])]}}],null,!1,712646860)}),_c("el-table-column",{attrs:{label:_vm.$t("common.products._actions"),width:"250"},scopedSlots:_vm._u([{key:"default",fn:function(action){return[action.row.actions?_c("div",{staticStyle:{display:"flex",position:"relative"}},_vm._l(_vm.$helpers.setActionText(action.row.actions),(function(actionText,idx){return _c("div",{key:idx,staticClass:"fc-tag mR10"},[_c("el-tag",[_vm._v(_vm._s(actionText))])],1)})),0):_c("div",[_vm._v("---")])]}}],null,!1,1985743895)}),_c("el-table-column",{scopedSlots:_vm._u([{key:"default",fn:function(action){return[_c("div",{staticClass:"text-right"},[action.row.isEdit?_c("span",{on:{click:function($event){return _vm.openActionForm(action.row)}}},[_c("inline-svg",{staticClass:"edit-icon-color visibility-hide-actions",attrs:{src:"svgs/edit",iconClass:"icon icon-sm mR5 icon-edit"}})],1):_vm._e(),_c("span",{on:{click:function($event){return _vm.deleteRule(action.row.id)}}},[_c("inline-svg",{staticClass:"pointer edit-icon-color visibility-hide-actions mL10",attrs:{src:"svgs/delete",iconClass:"icon icon-sm icon-remove fill-red"}})],1)])]}}],null,!1,3515007168)}),_c("el-table-column",{attrs:{width:"80"}})],1)],1),_vm.showActionForm?_c("action-form-dialog",{attrs:{isNew:_vm.isNew,isSummary:!0,title:_vm.dialogTitle,module:"newreadingalarm",actionType:_vm.actionType,ruleActions:_vm.selectedRule,parentRuleId:_vm.ruleId,details:_vm.details,visibilityshow:_vm.showActionForm},on:{"update:visibilityshow":function($event){_vm.showActionForm=$event},actionSaved:_vm.updateActionOnSave}}):_vm._e()],2)},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),ActionFormDialog=(__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(425728),__webpack_require__(976801),__webpack_require__(379e3)),api=__webpack_require__(32284),validation=__webpack_require__(990260),Spinner=__webpack_require__(604947),RuleActionWidgetvue_type_script_lang_js={props:["widget","groupKey","moduleName","details","fields","primaryFields","layoutParams","resizeWidget","hideTitleSection","activeTab","tab","sectionKey"],components:{ActionFormDialog:ActionFormDialog/* default */.Z,Spinner:Spinner/* default */.Z},data:function(){return{isNew:!0,toggle:!1,showActionForm:!1,isLoading:!1,isAutoCloseWoCreated:!1,isWoCreated:!1,actions:[],selectedRule:null,activityTypes:this.$constants.WorkFlowAction.module["alarm"].activityTypes}},mounted:function(){this.getActions()},computed:{ruleId:function(){var details=this.details,_ref=details||{},moduleName=_ref.moduleName,alarmRule=_ref.alarmRule,ruleId=null;return ruleId="newreadingrules"===moduleName?this.$getProperty(details,"id",null):this.$getProperty(alarmRule,"preRequsite.id",null),ruleId}},methods:{updateActionOnSave:function(){this.getActions()},getActions:function(){var _arguments=arguments,_this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var force,ruleId,details,_ref2,moduleName,url,params,_yield$API$get,error,data,_ref3,workflowRuleList;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return force=_arguments.length>0&&void 0!==_arguments[0]&&_arguments[0],_this.isLoading=!0,ruleId=_this.ruleId,details=_this.details,_ref2=details||{},moduleName=_ref2.moduleName,url="",url="newreadingrules"===moduleName?"v3/readingrule/actions/fetch":"/v2/alarm/rules/fetchRuleActions",params={ruleId:ruleId,force:force},_context.next=9,api/* API */.bl.get(url,params);case 9:_yield$API$get=_context.sent,error=_yield$API$get.error,data=_yield$API$get.data,error?_this.$message.error("Error Occured"):(_ref3=data||[],workflowRuleList=_ref3.workflowRuleList,_this.actions=workflowRuleList,_this.actions&&_this.actions.forEach((function(d){d.actions&&d.actions.forEach((function(action){11===action.actionType?(_this.isWoCreated=!0,d.isEdit=!1):12===action.actionType?(_this.isAutoCloseWoCreated=!0,d.isEdit=!1):d.isEdit=!0}))}))),_this.isLoading=!1;case 14:case"end":return _context.stop()}}),_callee)})))()},checkActivityType:function(value){var activityTypes=this.activityTypes;return activityTypes.find((function(type){return type.value===value})).label},opennewActionForm:function(type,title){this.showActionForm=!0,this.dialogTitle=title,this.isNew=!0,this.actionType=type},deleteRule:function(id){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var details,_ref4,moduleName,url,params,_yield$API$post,error,data;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return details=_this2.details,_ref4=details||{},moduleName=_ref4.moduleName,"newreadingrules"===moduleName?url="v3/readingrule/actions/delete":(url="v2/setup/alarm/rules/delete",params={id:[id]}),_context2.next=5,api/* API */.bl.post(url,params);case 5:if(_yield$API$post=_context2.sent,error=_yield$API$post.error,data=_yield$API$post.data,!error){_context2.next=12;break}_this2.$message.error("Error Occured"),_context2.next=15;break;case 12:if((0,validation/* isEmpty */.xb)(data)){_context2.next=15;break}return _context2.next=15,_this2.getActions();case 15:case"end":return _context2.stop()}}),_callee2)})))()},openActionForm:function(data){this.showActionForm=!0,this.isNew=!1,this.selectedRule=data,17===data.actions[0].actionType?(this.dialogTitle="Severity Change",this.actionType="severityAction"):[3,4,7].includes(data.actions[0].actionType)?(this.dialogTitle="Notification",this.actionType="notification"):this.dialogTitle="Action"},enableWo:function(tye,name){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var data,details,_ref5,moduleName,workflowRule,url,params,_yield$API$post2,error,actionData;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:if(data={ruleId:_this3.ruleId,ruleType:41,name:name,event:{moduleName:"newreadingalarm",activityType:11===tye?1:2048}},details=_this3.details,_ref5=details||{},moduleName=_ref5.moduleName,"newreadingrules"!==moduleName){_context3.next=15;break}return workflowRule=data,url="v3/readingrule/actions/add",params={workflowRule:workflowRule,moduleName:"newreadingalarm"},_context3.next=9,api/* API */.bl.post(url,params);case 9:_yield$API$post2=_context3.sent,error=_yield$API$post2.error,actionData=_yield$API$post2.data,error?_this3.$message.error("Error Occurred"):(0,validation/* isEmpty */.xb)(actionData)||(_this3.saving=!1,_this3.getActions()),_context3.next=17;break;case 15:return _context3.next=17,_this3.$util.addOrUpdateRuleAction("newreadingalarm",{rule:data,actions:[{actionType:tye,templateJson:{}}]},!1,"addcustom").then((function(){_this3.saving=!1,_this3.getActions(!0)})).catch((function(){_this3.saving=!1}));case 17:case"end":return _context3.stop()}}),_callee3)})))()}}},rule_RuleActionWidgetvue_type_script_lang_js=RuleActionWidgetvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(rule_RuleActionWidgetvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,RuleActionWidget=component.exports},
/***/379e3:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return ActionFormDialog}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/alarm/rule/component/ActionFormDialog.vue?vue&type=template&id=6d99cc8e
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("el-dialog",{staticStyle:{"z-index":"1999"},attrs:{visible:_vm.visibilityshow,fullscreen:!0,"append-to-body":!0,"before-close":_vm.closeDialog,"custom-class":"fc-dialog-form fc-dialog-right custom-rule-dialog setup-dialog50 setup-dialog"},on:{"update:visible":function($event){_vm.visibilityshow=$event}}},[_c("div",{attrs:{id:"new-custom-rule"}},[_c("error-banner",{attrs:{error:_vm.error,errorMessage:_vm.errorMessage}}),_c("el-form",{ref:"newCustomRule",attrs:{model:_vm.data,"label-position":"top"}},[_c("div",{staticClass:"new-header-container"},[_c("div",{staticClass:"new-header-modal"},[_c("div",{staticClass:"new-header-text"},[_c("div",{staticClass:"setup-modal-title"},[_vm._v(" "+_vm._s((_vm.isNew?"New ":"Edit ")+_vm.title)+" ")])])])]),_c("div",{staticClass:"new-body-modal"},[_c("el-row",{attrs:{gutter:20}},[_c("el-col",{attrs:{span:12}},[_c("el-form-item",{attrs:{prop:"name"}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v("Name")]),_c("el-input",{staticClass:"fc-input-full-border-select2",attrs:{autofocus:!0,placeholder:_vm.$t("setup.setupLabel.action_name")},model:{value:_vm.data.rule.name,callback:function($$v){_vm.$set(_vm.data.rule,"name",$$v)},expression:"data.rule.name"}})],1)],1),_c("el-col",{attrs:{span:12}},[_c("el-form-item",{attrs:{prop:"siteId"}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v("Site")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{placeholder:"Select Site"},model:{value:_vm.data.rule.siteId,callback:function($$v){_vm.$set(_vm.data.rule,"siteId",$$v)},expression:"data.rule.siteId"}},_vm._l(_vm.sites,(function(site){return _c("el-option",{key:site.id,attrs:{label:site.name,value:site.id}})})),1)],1)],1)],1),_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"description"}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.$t("space.sites.site_description"))+" ")]),_c("el-input",{staticClass:"fc-input-full-border-select2",attrs:{"min-rows":1,type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:_vm.$t("common._common.enter_desc"),reseize:"none"},model:{value:_vm.data.rule.description,callback:function($$v){_vm.$set(_vm.data.rule,"description",$$v)},expression:"data.rule.description"}})],1)],1)],1),_c("el-row",{attrs:{gutter:20}},[_c("el-col",{staticClass:"utility-block",attrs:{span:12}},[_c("p",{staticClass:"subHeading-pink-txt"},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.execute_on"))+" ")]),_c("p",{staticClass:"small-description-txt mB10"},[_vm._v(" "+_vm._s(_vm.$t("setup.setupLabel.notify_rule_executed"))+" ")]),_c("el-form-item",{attrs:{prop:"activityType"}},[_c("el-select",{staticClass:"width100 fc-input-full-border-select2",attrs:{placeholder:"Select",disabled:_vm.isActivityDisabled},model:{value:_vm.data.rule.event.activityType,callback:function($$v){_vm.$set(_vm.data.rule.event,"activityType",$$v)},expression:"data.rule.event.activityType"}},_vm._l(_vm.activityTypes,(function(type,index){return _c("el-option",{key:index,attrs:{label:type.label,value:type.value}})})),1)],1)],1)],1),524288===_vm.data.rule.event.activityType||1048576===_vm.data.rule.event.activityType?_c("div",{staticClass:"fc-div-bg-border mB20"},[524288===_vm.data.rule.event.activityType?_c("div",[_c("el-row",[_c("el-col",{attrs:{span:12}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v("Date Field")]),_c("el-select",{staticClass:"width300px",attrs:{placeholder:"Select"},model:{value:_vm.data.rule.dateFieldId,callback:function($$v){_vm.$set(_vm.data.rule,"dateFieldId",$$v)},expression:"data.rule.dateFieldId"}},_vm._l(_vm.dateFields,(function(fld,index){return _c("el-option",{key:index,attrs:{label:fld.displayName,value:fld.id}})})),1)],1),_c("el-col",{staticClass:"pL40",attrs:{span:12}},[_c("p",{staticClass:"fc-input-label-txt mB10"},[_vm._v(" "+_vm._s(_vm.$t("setup.setupLabel.scheduled_type"))+" ")]),_c("el-radio-group",{staticClass:"criteria-radio-label",model:{value:_vm.data.rule.scheduleType,callback:function($$v){_vm.$set(_vm.data.rule,"scheduleType",$$v)},expression:"data.rule.scheduleType"}},["26"===_vm.ruleType?_c("el-radio",{key:1,staticClass:"fc-radio-btn",attrs:{label:1}},[_vm._v("Before")]):_vm._e(),_c("el-radio",{key:2,staticClass:"fc-radio-btn",attrs:{label:2}},[_vm._v("On")]),_c("el-radio",{key:3,staticClass:"fc-radio-btn",attrs:{label:3}},[_vm._v("After")])],1)],1)],1),[1,3].includes(parseInt(_vm.data.rule.scheduleType))?_c("el-row",{staticClass:"mT30"},[_c("el-col",{attrs:{span:8}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v("Days")]),_c("el-select",{staticClass:"fc-input-full-border-select2",attrs:{clearable:"",placeholder:"Select"},model:{value:_vm.dateObject.days,callback:function($$v){_vm.$set(_vm.dateObject,"days",$$v)},expression:"dateObject.days"}},_vm._l(10,(function(index){return _c("el-option",{key:index+1,attrs:{label:index,value:index}})})),1)],1),_vm.checkDateTimeField?_c("el-col",{attrs:{span:8}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v("Hours")]),_c("el-select",{staticClass:"fc-input-full-border-select2",attrs:{clearable:""},model:{value:_vm.dateObject.hours,callback:function($$v){_vm.$set(_vm.dateObject,"hours",$$v)},expression:"dateObject.hours"}},_vm._l(_vm.$constants.HOURS,(function(index){return _c("el-option",{key:index+1,attrs:{label:index,value:index}})})),1)],1):_vm._e(),_vm.checkDateTimeField?_c("el-col",{attrs:{span:8}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v("Mins")]),_c("el-select",{staticClass:"fc-input-full-border-select2",attrs:{placeholder:"Select"},model:{value:_vm.dateObject.minute,callback:function($$v){_vm.$set(_vm.dateObject,"minute",$$v)},expression:"dateObject.minute"}},_vm._l(_vm.$constants.MINUTES,(function(index){return _c("el-option",{key:index+1,attrs:{label:index,value:index}})})),1)],1):_c("el-col",{attrs:{span:8}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v("Time")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width100 fc-tag",attrs:{"collapse-tags":""},model:{value:_vm.data.rule.time,callback:function($$v){_vm.$set(_vm.data.rule,"time",$$v)},expression:"data.rule.time"}},_vm._l(_vm.timesOption,(function(time){return _c("el-option",{key:time,attrs:{label:time,value:time}})})),1)],1)],1):_vm._e()],1):1048576===_vm.data.rule.event.activityType?_c("div",[_c("el-row",[1048576===_vm.data.rule.event.activityType?_c("div",{staticClass:"approve-form-item"},[_c("el-form-item",{staticClass:"fc-tag p0 pL10 pR10",attrs:{prop:"activityType"}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v(" Field "+_vm._s(_vm.selectedFieldObject.length>0?"("+_vm.selectedFieldObject.length+")":"")+" ")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width50",attrs:{"multiple-limit":3,multiple:"",placeholder:"Select"},model:{value:_vm.selectedFieldObject,callback:function($$v){_vm.selectedFieldObject=$$v},expression:"selectedFieldObject"}},_vm._l(_vm.moduleFields,(function(fld,index){return _c("el-option",{key:index,attrs:{label:fld.displayName,value:fld.id}})})),1),_vm.selectedFieldObject.length<3?_c("el-button",{staticClass:"all-rule-btn",attrs:{slot:"reference"},slot:"reference"},[_c("img",{staticClass:"mL10",attrs:{src:__webpack_require__(353654)}})]):_vm._e()],1)],1):_vm._e()])],1):_vm._e()]):_vm._e(),_c("new-criteria-builder",{ref:"criteriaBuilder",attrs:{showSiteField:_vm.showSiteField,showFormIDField:_vm.showFormIDField,exrule:_vm.data.rule.criteria,module:_vm.module,isRendering:_vm.criteriaRendered,title:"Specify rules for "+_vm.module+" action"},on:{condition:_vm.somefnt,"update:isRendering":function($event){_vm.criteriaRendered=$event},"update:is-rendering":function($event){_vm.criteriaRendered=$event}},model:{value:_vm.data.rule.criteria,callback:function($$v){_vm.$set(_vm.data.rule,"criteria",$$v)},expression:"data.rule.criteria"}}),_c("div",{staticClass:"form-input"}),"notification"===_vm.actionType?_c("event-dialog-helper",{ref:"eventDialog",attrs:{ruleType:_vm.ruleType,rule:_vm.data,module:_vm.module,moduleFields:_vm.moduleFields,actions:_vm.actions},on:{actions:function($event){return _vm.addAction()}}}):_vm._e(),"severityAction"===_vm.actionType?_c("div",[_c("el-row",[_c("el-col",{staticClass:"utility-block",attrs:{span:20}},[_c("div",{staticClass:"fc-text-pink text-uppercase mT20"},[_vm._v(" Severity Change ")])])],1),_c("el-row",{attrs:{gutter:20}},[_c("el-col",{attrs:{span:12}},[_c("el-input",{staticClass:"fc-input-full-border2 width100",attrs:{disabled:""},model:{value:_vm.severity,callback:function($$v){_vm.severity=$$v},expression:"severity"}})],1),_c("el-col",{attrs:{span:12}},[_c("el-form-item",[_vm.fieldMatchers&&_vm.fieldMatchers[0]&&_vm.fieldMatchers[0].templateJson?_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{"collapse-tags":""},model:{value:_vm.fieldMatchers[0].templateJson.resultWorkflowContext.expressions[0].constant,callback:function($$v){_vm.$set(_vm.fieldMatchers[0].templateJson.resultWorkflowContext.expressions[0],"constant",$$v)},expression:"\n                      fieldMatchers[0].templateJson.resultWorkflowContext\n                        .expressions[0].constant\n                    "}},_vm._l(_vm.alarmseverity,(function(label){return _c("el-option",{key:label.id,attrs:{label:label.displayName,value:String(label.id)}})})),1):_vm._e()],1)],1)],1)],1):_vm._e(),"controlLogic"===_vm.actionType?_c("div",[_c("control-logic",{attrs:{name:"dfd"}})],1):_vm._e()],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){return _vm.closeDialog()}}},[_vm._v("CANCEL")]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.saving},on:{click:_vm.save}},[_vm._v(" "+_vm._s(_vm.saving?"Saving...":"SAVE"))])],1)])],1)])],1)},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),objectSpread2=__webpack_require__(595082),vuex_esm=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(976801),__webpack_require__(538077),__webpack_require__(670560),__webpack_require__(434284),__webpack_require__(659749),__webpack_require__(386544),__webpack_require__(947522),__webpack_require__(339772),__webpack_require__(162506),__webpack_require__(169358),__webpack_require__(420629)),ControlLogicvue_type_template_id_181ab1d6_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("div",{staticClass:"fc-text-pink text-uppercase mT20"},[_vm._v("Command Action")]),_c("el-collapse",{staticClass:"new-rule-collapse position-relative controllogic-collapse",attrs:{accordion:!0},model:{value:_vm.activeNames,callback:function($$v){_vm.activeNames=$$v},expression:"activeNames"}},_vm._l(_vm.controlaction,(function(action,cindex){return _c("el-collapse-item",{key:cindex,staticClass:"rule-border-blue mT20 position-relative",staticStyle:{"border-left":"1px solid rgb(228, 235, 241)"},attrs:{name:action.name}},[_c("template",{slot:"title"},[_vm._v(" "+_vm._s(action.name)+" ")]),_c("div",{},[_c("el-radio-group",{model:{value:action.templateJson.actionType,callback:function($$v){_vm.$set(action.templateJson,"actionType",$$v)},expression:"action.templateJson.actionType"}},[_c("el-radio",{staticClass:"fc-radio-btn",attrs:{label:1}},[_vm._v("Point")]),_c("el-radio",{staticClass:"fc-radio-btn",attrs:{label:2}},[_vm._v("Group")])],1)],1),_c("div",{directives:[{name:"show",rawName:"v-show",value:1===action.templateJson.actionType,expression:"action.templateJson.actionType === 1"}],staticClass:"pT20"},[_c("el-row",[_c("el-col",{attrs:{span:4}},[_c("div",{staticClass:"label-txt-black"},[_vm._v("Asset")])]),_c("el-col",{attrs:{span:15}},[_c("el-form-item",[_c("el-select",{staticClass:"fc-input-full-border2 width100",attrs:{placeholder:"Select asset"},on:{change:_vm.fetchFields},model:{value:action.templateJson.resource,callback:function($$v){_vm.$set(action.templateJson,"resource",$$v)},expression:"action.templateJson.resource"}},_vm._l(_vm.assets,(function(asset,index){return _c("el-option",{key:index,attrs:{label:asset.name,value:asset.id}})})),1)],1)],1)],1),_c("el-row",{},[_c("el-col",{attrs:{span:4}},[_c("div",{staticClass:"label-txt-black"},[_vm._v("Field")])]),_c("el-col",{attrs:{span:15}},[_c("el-form-item",[_c("el-select",{staticClass:"fc-input-full-border2 width100",attrs:{placeholder:"Select fields"},model:{value:action.templateJson.metric,callback:function($$v){_vm.$set(action.templateJson,"metric",$$v)},expression:"action.templateJson.metric"}},_vm._l(_vm.assetFields[action.templateJson.resource],(function(field,index){return _c("el-option",{key:index,attrs:{label:field.displayName,value:field.id}})})),1)],1)],1)],1),_c("el-row",{},[_c("el-col",{attrs:{span:4}},[_c("div",{staticClass:"label-txt-black"},[_vm._v("Value")])]),_c("el-col",{attrs:{span:15}},[_c("el-form-item",[_c("el-input",{staticClass:"fc-input-full-border2",attrs:{autofocus:"",placeholder:"Enter the value",type:"number"},model:{value:action.templateJson.val,callback:function($$v){_vm.$set(action.templateJson,"val",$$v)},expression:"action.templateJson.val"}})],1)],1)],1),_c("img",{staticClass:"delete-icon pointer",staticStyle:{height:"18px",width:"18px","margin-right":"3px"},attrs:{src:__webpack_require__(385769)},on:{click:function($event){return _vm.deleteaction(cindex)}}})],1),_c("div",{directives:[{name:"show",rawName:"v-show",value:2===action.templateJson.actionType,expression:"action.templateJson.actionType === 2"}],staticClass:"pT20"},[_c("el-row",{},[_c("el-col",{attrs:{span:4}},[_c("div",{staticClass:"label-txt-black"},[_vm._v("Actions Group")])]),_c("el-col",{attrs:{span:15}},[_c("el-form-item",[_c("el-select",{staticClass:"width100 fc-input-full-border2",attrs:{filterable:""},model:{value:action.templateJson.controlActionGroupId,callback:function($$v){_vm.$set(action.templateJson,"controlActionGroupId",$$v)},expression:"action.templateJson.controlActionGroupId"}},_vm._l(_vm.rcagrouplist,(function(grouprule,index){return _c("el-option",{key:index,attrs:{label:grouprule.name,value:grouprule.id}})})),1)],1)],1)],1),_c("el-row",{},[_c("el-col",{attrs:{span:4}},[_c("div",{staticClass:"label-txt-black"},[_vm._v("Value")])]),_c("el-col",{attrs:{span:15}},[_c("el-form-item",[_c("el-input",{staticClass:"fc-input-full-border2",attrs:{autofocus:"",placeholder:"Enter the value",type:"number"},model:{value:action.templateJson.val,callback:function($$v){_vm.$set(action.templateJson,"val",$$v)},expression:"action.templateJson.val"}})],1)],1)],1),_c("img",{staticClass:"delete-icon pointer",staticStyle:{height:"18px",width:"18px","margin-right":"3px"},attrs:{src:__webpack_require__(385769)},on:{click:function($event){return _vm.deleteaction(cindex)}}})],1)],2)})),1)],1)},ControlLogicvue_type_template_id_181ab1d6_scoped_true_staticRenderFns=[],ControlLogicvue_type_script_lang_js={data:function(){return{activeNames:["actionName0"],controlaction:[],assetFields:{},logicaction:{},assets:[],rcarules:[],rcagrouplist:[]}},mounted:function(){this.addaction()},methods:{addaction:function(){this.controlaction.push({actionType:18,templateJson:{val:"",resource:null,metric:null,actionType:1,controlActionGroupId:null},name:"Command Action"+(this.controlaction.length+1)})},fetchFields:function(resourceId){if(!this.assetFields[resourceId]){var self=this;self.loading=!0;var url="/v2/controlAction/getControllableFields?resourceId="+resourceId;this.$http.get(url).then((function(response){200===response.status&&(response.data.result.controllableFields&&self.$set(self.assetFields,resourceId,response.data.result.controllableFields),self.loading=!1)}))}},deleteaction:function(key){this.controlaction.splice(key,1)}}},component_ControlLogicvue_type_script_lang_js=ControlLogicvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(component_ControlLogicvue_type_script_lang_js,ControlLogicvue_type_template_id_181ab1d6_scoped_true_render,ControlLogicvue_type_template_id_181ab1d6_scoped_true_staticRenderFns,!1,null,"181ab1d6",null)
/* harmony default export */,ControlLogic=component.exports,EventDialogHelper=__webpack_require__(494177),ErrorBanner=__webpack_require__(297157),NotificationHelper=__webpack_require__(683038),NewCriteriaBuilder=__webpack_require__(859850),utils_field=__webpack_require__(815872),validation=__webpack_require__(990260),api=__webpack_require__(32284),ActionFormDialogvue_type_script_lang_js={props:["isNew","isSummary","visibilityshow","mailWidth","ruleType","parentRuleId","title","ruleActions","actionType","details"],mixins:[NotificationHelper/* default */.Z],data:function(){return{severity:"Severity",fieldMatchers:[],activityTypes:[{label:"Create",value:1},{label:"Severity Change",value:1024},{label:"Create and Severity Change",value:1025},{label:"Clear",value:2048},{label:"On Date",value:524288},{label:"Field Change",value:1048576},{label:"Delete",value:4}],timesOption:[],actions:["email","sms","mobile"],error:!1,isUpdate:!1,errorMessage:"",selectedFieldObject:[],dateFields:[],criteriaRendered:!1,moduleMeta:null,saving:!1,data:{rule:{name:"",scheduleType:3,description:"",ruleType:null,event:{moduleName:"newreadingalarm",activityType:1},dateFieldId:null,time:null,fields:[],criteria:null},siteId:"",actions:[]},dateObject:{days:null,minute:0,hours:0,minu:null},closeWo:{actionType:12},ruleDialog:!0}},components:{ErrorBanner:ErrorBanner/* default */.Z,EventDialogHelper:EventDialogHelper/* default */.Z,ControlLogic:ControlLogic,NewCriteriaBuilder:NewCriteriaBuilder/* default */.Z},created:function(){this.$store.dispatch("loadAlarmSeverity"),this.$store.dispatch("loadSite")},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({alarmseverity:function(state){return state.alarmSeverity},sites:function(state){return state.site}})),{},{moduleFields:function(){if(!this.criteriaRendered)return this.$refs.criteriaBuilder&&this.$refs.criteriaBuilder.moduleMetaObject&&this.$refs.criteriaBuilder.moduleMetaObject.fields?this.$refs.criteriaBuilder.moduleMetaObject.fields:null},showSiteField:function(){var workFlowActionHash=this.$constants.WorkFlowAction.module[this.module];return workFlowActionHash&&workFlowActionHash.showSiteField},showFormIDField:function(){var workFlowActionHash=this.$constants.WorkFlowAction.module[this.module];return workFlowActionHash&&workFlowActionHash.showFormIDField},checkDateTimeField:function(){var dateFields=this.dateFields,data=this.data,_ref=data||{},rule=_ref.rule,_ref2=rule||{},dateFieldId=_ref2.dateFieldId,field=(dateFields||[]).find((function(fld){return fld.fieldId===dateFieldId}))||{};return!(0,validation/* isEmpty */.xb)(field)&&(0,utils_field/* isDateTimeField */.K)(field)},isActivityDisabled:function(){var _ref3=this||{},data=_ref3.data,_ref4=data||{},actions=_ref4.actions,firstActionType=this.$getProperty(actions,"0.actionType",null);return!(0,validation/* isEmpty */.xb)(actions.length)&&[11,12].includes(firstActionType)}}),watch:{moduleFields:function(newVal){if(null!=newVal){var dateFld=[];newVal.filter((function(d){"DATE"!==d.dataTypeEnum._name&&"DATE_TIME"!==d.dataTypeEnum._name||dateFld.push(d)})),this.dateFields=dateFld}}},mounted:function(){for(var _this=this,i=0;i<=23;i++){var time=(i<10?"0"+i:i)+":";this.timesOption.push(time+"00"),this.timesOption.push(time+"30")}if(this.fieldMatchers.push({actionType:17,fieldName:"severity",templateJson:{resultWorkflowContext:{expressions:[{name:"severity",constant:null}]},metaJson:{fields:[]}}}),!this.isNew){if(this.rule=this.ruleActions,this.data.rule.actions=this.rule.actions?this.rule.actions:[],this.rule.actions=this.ruleActions?this.ruleActions.actions:[],this.data={rule:{name:this.rule.name,siteId:this.rule.siteId,description:this.rule.description,ruleType:this.rule.ruleType,interval:this.rule.interval,event:{activityType:parseInt(this.rule.event.activityType),moduleName:this.rule.event.moduleName},id:this.rule.id,scheduleType:this.rule.scheduleType,dateFieldId:this.rule.dateFieldId,time:this.rule.time,criteria:this.rule.criteria},actions:this.rule.actions?this.rule.actions:[]},this.rule.fields&&(this.selectedFieldObject=[],this.rule.fields.forEach((function(d){_this.selectedFieldObject.push(parseInt(d.fieldId))}))),this.rule.interval&&(this.dateObject=this.$helpers.secTodaysHoursMinu(this.rule.interval)),"severityAction"===this.actionType&&this.rule.actions){var severitytemplate=this.rule.actions[0].template.originalTemplate.workflowContext.expressions[0];this.fieldMatchers[0].templateJson.resultWorkflowContext.expressions[0].constant=severitytemplate.constant}this.$forceUpdate()}},methods:{closeDialog:function(){this.$emit("update:visibilityshow",!1)},addAction:function(action){this.data.rule.actions=action},somefnt:function(newVal){this.data.rule.criteria=newVal},save:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var self,actions,woActionIdx,closeWoIdx,data,apiaction,newAction,details,_ref5,module,workflowRule,url,params,_yield$API$post,error,actionData;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(self=_this2,actions=_this2.data.actions,woActionIdx=actions.findIndex((function(action){return 11===action.actionType})),closeWoIdx=actions.findIndex((function(action){return 12===action.actionType})),2048===parseInt(_this2.data.rule.event.activityType)?(-1!==woActionIdx&&actions.splice(woActionIdx,1),-1!==closeWoIdx&&delete actions[closeWoIdx].id):(-1!==woActionIdx&&_this2.handleWoAction(actions[woActionIdx]),-1!==closeWoIdx&&actions.splice(closeWoIdx,1)),Object.keys(self.data.rule.criteria.conditions).forEach((function(kessy){self.data.rule.criteria.conditions[kessy].hasOwnProperty("fieldName")?self.data.rule.criteria&&(self.data.rule.criteria.conditions[kessy].fieldName?(delete self.data.rule.criteria.conditions[kessy].valueArray,delete self.data.rule.criteria.conditions[kessy].operatorsDataType,delete self.data.rule.criteria.conditions[kessy].operatorLabel):self.data.rule.criteria=null):self.data.rule.criteria=null})),self.selectedFieldObject.length>0?(self.data.rule.fields=[],self.selectedFieldObject.forEach((function(d){self.data.rule.fields.push({fieldId:d})}))):delete self.data.rule.fields,524288===parseInt(_this2.data.rule.event.activityType)&&(_this2.data.rule.interval=null,_this2.dateObject&&(_this2.data.rule.dateFieldId&&(_this2.checkDateTimeField||(_this2.dateObject.hours=0,_this2.dateObject.minute=0)),_this2.data.rule.interval=_this2.$helpers.daysHoursMinuToSec(_this2.dateObject))),_this2.data.rule.dateFieldId||delete _this2.data.rule.dateFieldId,_this2.data.rule.dateFieldId&&_this2.checkDateTimeField&&(_this2.data.rule.time=null),data=_this2.$helpers.cloneObject(_this2.data),data.rule.actions=actions,_this2.validateForm(data)){_context.next=14;break}return _context.abrupt("return",!1);case 14:if(_this2.saving=!0,"severityAction"===self.actionType&&(data.actions=[],data.actions[0]=Object.assign(_this2.fieldMatchers[0]),data.rule.actions[0]=Object.assign(_this2.fieldMatchers[0])),self.isSummary){_context.next=21;break}self.$emit("actionSaved",(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},data.rule),{},{type:_this2.actionType})),self.closeDialog(),_context.next=39;break;case 21:if(_this2.isNew?apiaction="addcustom":(apiaction="updatecustom","severityAction"!==_this2.actionType&&(newAction=_this2.$refs.eventDialog.updateAction(data.actions),data.actions=Object.assign(newAction))),data.rule.ruleId=_this2.parentRuleId,data.rule.ruleType=41,details=_this2.details,_ref5=details||{},module=_ref5.module,"newreadingrule"!==module){_context.next=38;break}return workflowRule=data.rule,url="v3/readingrule/actions/add",params={workflowRule:workflowRule,moduleName:"newreadingalarm"},_context.next=32,api/* API */.bl.post(url,params);case 32:_yield$API$post=_context.sent,error=_yield$API$post.error,actionData=_yield$API$post.data,error?_this2.$message.error("Error Occurred"):(_this2.saving=!1,_this2.$emit("actionSaved",actionData),_this2.closeDialog()),_context.next=39;break;case 38:_this2.$util.addOrUpdateRuleAction("newreadingalarm",data,!_this2.isNew,apiaction).then((function(){_this2.saving=!1,self.$emit("actionSaved",data.rule),_this2.closeDialog()})).catch((function(){self.saving=!1}));case 39:case"end":return _context.stop()}}),_callee)})))()},handleWoAction:function(action){11===action.actionType&&(action.templateJson=action.template.originalTemplate,delete action.template,delete action.id,delete action.templateId)},validateForm:function(ruleData){if(this.error=!1,!ruleData.rule.name)return this.error=!0,this.errorMessage="Enter Name ",!1;if(524288===ruleData.rule.event.activityType){if(!ruleData.rule.dateFieldId)return this.error=!0,this.errorMessage="Please select field for on date activity",!1;if(3===ruleData.rule.scheduleType&&!ruleData.rule.interval)return this.error=!0,this.errorMessage="Please select duration",!1}else if(1048576===ruleData.rule.event.activityType&&(!ruleData.rule.fields||!ruleData.rule.fields.length>0))return this.error=!0,this.errorMessage="Please select atleast on field for field change activity",!1;return!0}}},component_ActionFormDialogvue_type_script_lang_js=ActionFormDialogvue_type_script_lang_js,ActionFormDialog_component=(0,componentNormalizer/* default */.Z)(component_ActionFormDialogvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,ActionFormDialog=ActionFormDialog_component.exports},
/***/358551:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FDatePicker}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/assets/overview/FDatePicker.vue?vue&type=template&id=fd3cfbc4
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-date-picker",{ref:"date-picker",attrs:{appendToBody:_vm.appendToBody,clearable:!_vm.hideClear,type:_vm.type,"value-format":_vm.valueFormat,format:_vm.pickerFormat,placeholder:_vm.placeholder,disabled:_vm.disabled,editable:_vm.editable,"default-value":_vm.defaultValue,"picker-options":_vm.pickerOptions,"prefix-icon":_vm.prefixIcon,"clear-icon":_vm.clearIcon,"start-placeholder":_vm.startPlaceholder,"end-placeholder":_vm.endPlaceholder,"time-arrow-control":_vm.arrowControl,"default-time":_vm.defaultTime},on:{change:_vm.pickerChange},model:{value:_vm.ttime,callback:function($$v){_vm.ttime=$$v},expression:"ttime"}})},staticRenderFns=[],validation=(__webpack_require__(976801),__webpack_require__(564043),__webpack_require__(857267),__webpack_require__(756532),__webpack_require__(634338),__webpack_require__(450886),__webpack_require__(843843),__webpack_require__(990260)),constant=__webpack_require__(354754),moment_timezone=__webpack_require__(480008),moment_timezone_default=__webpack_require__.n(moment_timezone),FDatePickervue_type_script_lang_js={props:["appendToBody","value","value-format","format","default-value","placeholder","disabled","editable","picker-options","type","prefix-icon","clear-icon","start-placeholder","end-placeholder","hideClear","arrowControl","default-time"],mounted:function(){this.init()},data:function(){return{timeinorg:[]}},computed:{isRangeType:function(){var _ref=this||{},type=_ref.type;return["daterange","datetimerange"].includes(type)},defaultFormats:function(){var $timeformat=this.$timeformat,$dateformat=this.$dateformat,dateformat=($dateformat||"").replaceAll("Y","y");return dateformat=(dateformat||"").replaceAll("D","d"),{date:dateformat,month:"yyyy-MM",datetime:"".concat(dateformat," ").concat($timeformat),time:"".concat($timeformat),week:"yyyywWW",timerange:"".concat($timeformat),daterange:"".concat(dateformat),monthrange:"yyyy-MM",datetimerange:"".concat(dateformat," ").concat($timeformat),year:"yyyy"}},pickerFormat:function(){var _ref2=this||{},defaultFormats=_ref2.defaultFormats,type=_ref2.type,format=_ref2.format;return(0,validation/* isEmpty */.xb)(format)&&!(0,validation/* isEmpty */.xb)(defaultFormats[type])?defaultFormats[type]:format},ttime:{get:function(){var _this=this,_ref3=this||{},value=_ref3.value,isRangeType=_ref3.isRangeType;return(0,validation/* isEmpty */.xb)(value)?isRangeType?[]:"":isRangeType?value.map((function(val){return _this.getTimeInSystemZone(val)})):this.getTimeInSystemZone(value)},set:function(value){var isRangeType=this.isRangeType;if(isRangeType){if((0,validation/* isEmpty */.xb)(value))this.timeinorg=[];else for(var time in value)this.timeinorg[time]=this.$helpers.getTimeInOrg(value[time]);this.$emit("input",this.timeinorg),this.$emit("change",this.timeinorg)}else{var modifiedTimeFormat=this.$helpers.getTimeInOrg(value);this.$emit("input",modifiedTimeFormat),this.$emit("change",modifiedTimeFormat)}}}},methods:{pickerChange:function(){var isRangeType=this.isRangeType,value=this.value;if(isRangeType){if((0,validation/* isEmpty */.xb)(value))this.timeinorg=[];else for(var time in value)this.timeinorg[time]=this.$helpers.getTimeInOrg(value[time]);this.$emit("pickerChange",this.timeinorg)}else{var modifiedTimeFormat=this.$helpers.getTimeInOrg(value);this.$emit("pickerChange",modifiedTimeFormat)}},init:function(){var isRangeType=this.isRangeType,value=this.value;if(isRangeType){if((0,validation/* isEmpty */.xb)(value))this.timeinorg=[];else for(var time in value){var timeVal=parseInt(value[time]);this.timeinorg[time]=timeVal}this.$emit("input",this.timeinorg)}else if(!(0,validation/* isEmpty */.xb)(value)){var isPlaceHoldersEnabled=constant/* default */.Z.FIELD_PLACEHOLDERS.includes(value)||!1;isPlaceHoldersEnabled||this.$emit("input",value)}this.$emit("initialized")},focus:function(){this.$refs["date-picker"].focus()},getTimeInSystemZone:function(value){return new Date(moment_timezone_default().tz(value,this.$timezone).format("YYYY-MM-DD HH:mm:ss"))}}},overview_FDatePickervue_type_script_lang_js=FDatePickervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(overview_FDatePickervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FDatePicker=component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/17175.js.map