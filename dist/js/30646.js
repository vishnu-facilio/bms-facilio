"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[30646],{
/***/430646:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return SmartTable}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/dashboard/widget/cards/v2/SmartTable.vue?vue&type=template&id=8a0f54b2
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:" height100 fc-smart-table-page"},[_vm.mode?_c("div",{staticClass:"fc-widget-header p10"}):_vm._e(),_vm.loading?_c("shimmer-loading",{staticClass:"map-shimmer"}):_c("div",{staticClass:"height100 smart-table-wrapper"},[_vm.tablererender?_vm._e():[_c("el-table",{staticClass:"smart-table",attrs:{id:"smart-table"+(_vm.widget&&_vm.widget.id?"-"+_vm.widget.id:"-1"),border:"",data:_vm.elTableResult,fit:!1,"span-method":_vm.objectSpanMethod,height:_vm.height},on:{"header-dragend":_vm.setColWidth}},[_vm._l(_vm.data.columns,(function(config,index){return[_c("el-table-column",{key:index,attrs:{prop:config.key,label:config.label,width:config.width},scopedSlots:_vm._u([{key:"header",fn:function(){return[_c("div",{staticClass:"smart-table-header-th row p0 inline width100 align-center relative visibility-visible-actions position-relative"},[_c("div",{staticClass:"width100 p0 flex-middle line-height-normal"},[_c("div",{staticClass:"headerlabel width100"},[_vm._v(_vm._s(config.label))])]),_c("div",{staticClass:"smart-table-actions pointer",on:{click:function($event){_vm.visibility=!0,_vm.selectcolumn=config}}},[!_vm.mode||"TEXT"!==config.datatype&&"NUMBER"!==config.datatype?_vm._e():_c("i",{staticClass:"el-icon-caret-bottom fR condition-icon visibility-hide-actions"})])])]},proxy:!0},{key:"default",fn:function(scope){return[_c("conditional-value",{staticClass:"smart-td-cell",style:_vm.getStyleObj(_vm.formatLabel(scope.row[config.key],config),config.conditionalFormatting,config),attrs:{value:_vm.formatLabel(scope.row[config.key],config),conditionalFormatting:config.conditionalFormatting||[]}})]}}],null,!0)})]}))],2)],_vm.visibility?_c("el-dialog",{attrs:{"custom-class":"f-kfi-card-builder fc-dialog-center-container kpi-map-setup-dilaog","append-to-body":!0,visible:_vm.visibility,width:"50%",title:"KPI CARD","before-close":_vm.closedialog},on:{"update:visible":function($event){_vm.visibility=$event}}},[_c("span",{staticClass:"dialog-footer",attrs:{slot:"title"},slot:"title"},[_c("span",{staticClass:"kpi-card-header"},[_vm._v("SMART TABLE SETTINGS")])]),_c("div",{staticStyle:{height:"500px"}},[_c("smart-table-settings",{attrs:{data:_vm.data,column:_vm.selectcolumn}})],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.closedialog}},[_vm._v("Close")]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:function($event){return _vm.save()}}},[_vm._v("OK")])],1)]):_vm._e()],2)],1)},staticRenderFns=[],ShimmerLoading=(__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(425728),__webpack_require__(186466),__webpack_require__(725906),__webpack_require__(339772),__webpack_require__(879288),__webpack_require__(538077),__webpack_require__(670560),__webpack_require__(648324),__webpack_require__(169358),__webpack_require__(516400)),SmartTableSettings=__webpack_require__(100385),NewConditionalValue=__webpack_require__(152073),criteriaHelper=__webpack_require__(292296),SmartTablevue_type_script_lang_js={props:["widget","config"],mixins:[criteriaHelper/* default */.Z],data:function(){return{tablererender:!1,visibility:!1,selectcolumn:null,height:"",loading:!0,result:null,elTableResult:[],data:null,tableConfig:{}}},watch:{"config.height":{handler:function(newData,oldData){this.getClientProps()}}},computed:{mode:function(){return!(!this.$route.query||!this.$route.query.create||"edit"!==this.$route.query.create)||!(!this.$route.query||!this.$route.query.create||"new"!==this.$route.query.create)}},mounted:function(){this.getClientProps(),this.getParams(),this.loadCardData()},components:{shimmerLoading:ShimmerLoading/* default */.Z,SmartTableSettings:SmartTableSettings/* default */.Z,ConditionalValue:NewConditionalValue/* default */.Z},methods:{getStyleObj:function(value,conditionalFormatting,config){var _this=this,self=this;if(conditionalFormatting&&conditionalFormatting.length){var style={};return conditionalFormatting.forEach((function(rt){var operator=null;operator=Object.values(self.$constants.OPERATORS[config.datatype]).find((function(rl){return rl.operatorId===rt.critera.operatorId})),operator&&_this.criteriaValidate(value,rt.critera.value,operator._name,config.datatype)&&(style={color:rt.style.color,"background-color":rt.style.bgcolor},rt.action.blink&&(style.animation="blinker 1s linear infinite"))})),style}return{}},save:function(){var _this2=this;this.setParams(),this.closedialog(),this.tablererender=!0,setTimeout((function(){_this2.tablererender=!1}),150)},closedialog:function(){this.visibility=!1,this.selectcolumn=null},getClientProps:function(){var _this3=this;this.$nextTick((function(){_this3.$el?_this3.height=_this3.$el.clientHeight-(_this3.mode?28:0):_this3.height=""}))},setColWidth:function(currentWidth,preWidth,celldata){if(celldata&&celldata.label){var index=this.data.columns.findIndex((function(rt){return rt.label===celldata.label}));this.data.columns[index].width=currentWidth}this.setParams()},refresh:function(){this.getParams(),this.loadCardData()},formatLabel:function(label,config){if(config&&"DATE"===config.datatype){var sec=Number(label);return this.toHHMMSS(sec)}return label},toHHMMSS:function(sec){var sec_num=parseInt(sec,10),hours=Math.floor(sec_num/3600),minutes=Math.floor((sec_num-3600*hours)/60),seconds=sec_num-3600*hours-60*minutes;// don't forget the second param
return hours<10&&(hours="0"+hours),minutes<10&&(minutes="0"+minutes),seconds<10&&(seconds="0"+seconds),hours>1?"00"!==minutes?hours+" hrs "+minutes+" mins":hours+" hrs ":"00"!==seconds?minutes+" mins"+seconds+" secs":minutes+" mins"},objectSpanMethod:function(_ref){_ref.row,_ref.column;var rowIndex=_ref.rowIndex,columnIndex=_ref.columnIndex;return this.tableConfig[columnIndex][rowIndex]},perpareElTableResult:function(result){return result.data?result.data:[]},getData:function(result){this.result=result.result,this.elTableResult=this.perpareElTableResult(result.result),this.getTableOptions(this.elTableResult),this.elTableResult=this.tempFormatingData(this.elTableResult,this.tableConfig)},tempFormatingData:function(result,config){return config[4],result},getTableOptions:function(result){var config={},res=result,mergeRuleList={};this.data.columns.forEach((function(rt,index){config[index]={};var list=[];rt.merge?(rt.mergeKey&&mergeRuleList[rt.mergeKey]?list=mergeRuleList[rt.mergeKey]:result.forEach((function(rl,idx){var cou={};cou["key"]=rl[rt.key],cou["value"]=res.filter((function(rx){return rx[rt.key]===rl[rt.key]})).length,list.findIndex((function(r){return r.key===cou.key}))>-1?list.push({key:rl[rt.key],value:0}):list.push(cou)})),result.forEach((function(rl,idx){var d={rowspan:list[idx].value,colspan:1};config[index][idx]=d}))):result.forEach((function(rl,idx){var d={rowspan:1,colspan:1};config[index][idx]=d})),mergeRuleList[rt.key]=list})),this.tableConfig=config},getParams:function(){this.widget.dataOptions.data?(this.widget.dataOptions.metaJson=JSON.stringify(this.widget.dataOptions.data),this.data=this.widget.dataOptions.data,this.setParams()):this.widget.id>-1&&this.widget.dataOptions.metaJson&&(this.data=JSON.parse(this.widget.dataOptions.metaJson),this.setParams())},setParams:function(){this.data&&!this.data.style?this.data.style={color:this.color,bgcolor:this.bgcolor}:this.style=this.data.style,this.widget.dataOptions.metaJson=JSON.stringify(this.data)},loadCardData:function(){var self=this,params=null;params={workflow:{isV2Script:!0,workflowV2String:this.data.workflowV2String},staticKey:"kpiCard"},this.loading=!0,self.$http.post("dashboard/getCardData",params).then((function(response){self.getData(response.data.cardResult),self.loading=!1})).catch((function(error){self.loading=!1}))}}},v2_SmartTablevue_type_script_lang_js=SmartTablevue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(v2_SmartTablevue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,SmartTable=component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/30646.js.map