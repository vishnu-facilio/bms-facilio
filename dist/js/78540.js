(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[78540],{
/***/573076:
/***/function(module){"use strict";function compileSearch(funcName,predicate,reversed,extraArgs,useNdarray,earlyOut){var code=["function ",funcName,"(a,l,h,",extraArgs.join(","),"){",earlyOut?"":"var i=",reversed?"l-1":"h+1",";while(l<=h){var m=(l+h)>>>1,x=a",useNdarray?".get(m)":"[m]"];return earlyOut?predicate.indexOf("c")<0?code.push(";if(x===y){return m}else if(x<=y){"):code.push(";var p=c(x,y);if(p===0){return m}else if(p<=0){"):code.push(";if(",predicate,"){i=m;"),reversed?code.push("l=m+1}else{h=m-1}"):code.push("h=m-1}else{l=m+1}"),code.push("}"),earlyOut?code.push("return -1};"):code.push("return i};"),code.join("")}function compileBoundsSearch(predicate,reversed,suffix,earlyOut){var result=new Function([compileSearch("A","x"+predicate+"y",reversed,["y"],!1,earlyOut),compileSearch("B","x"+predicate+"y",reversed,["y"],!0,earlyOut),compileSearch("P","c(x,y)"+predicate+"0",reversed,["y","c"],!1,earlyOut),compileSearch("Q","c(x,y)"+predicate+"0",reversed,["y","c"],!0,earlyOut),"function dispatchBsearch",suffix,"(a,y,c,l,h){if(a.shape){if(typeof(c)==='function'){return Q(a,(l===undefined)?0:l|0,(h===undefined)?a.shape[0]-1:h|0,y,c)}else{return B(a,(c===undefined)?0:c|0,(l===undefined)?a.shape[0]-1:l|0,y)}}else{if(typeof(c)==='function'){return P(a,(l===undefined)?0:l|0,(h===undefined)?a.length-1:h|0,y,c)}else{return A(a,(c===undefined)?0:c|0,(l===undefined)?a.length-1:l|0,y)}}}return dispatchBsearch",suffix].join(""));return result()}module.exports={ge:compileBoundsSearch(">=",!1,"GE"),gt:compileBoundsSearch(">",!1,"GT"),lt:compileBoundsSearch("<",!0,"LT"),le:compileBoundsSearch("<=",!0,"LE"),eq:compileBoundsSearch("-",!0,"EQ",!0)}
/***/},
/***/243170:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return NewState}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/setup/stateflow/NewState.vue?vue&type=template&id=ac21c150&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("el-form",{ref:"new-stateflow-form",attrs:{model:_vm.state,rules:_vm.rules,"label-position":"top"},nativeOn:{submit:function($event){$event.preventDefault()}}},[_c("error-banner",{attrs:{error:_vm.error,errorMessage:_vm.errorMessage},on:{"update:error":function($event){_vm.error=$event}}}),_c("div",{staticClass:"new-header-container pL20 pR30 state-transition-header"},[_c("div",{staticClass:"d-flex"},[_c("span",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"mR10 pointer",attrs:{title:"Go Back"},on:{click:_vm.cancel}},[_c("inline-svg",{attrs:{src:"left-arrow",iconClass:"icon vertical-middle"}})],1),_c("div",{staticClass:"stateflow-setup-title"},[_vm._v(" "+_vm._s(_vm.isNew?"New State":"Edit State")+" ")])]),_vm.canShowDelete?_c("div",{directives:[{name:"tippy",rawName:"v-tippy"}],attrs:{title:_vm.$t("common._common.remove_state")},on:{click:function($event){return _vm.remove(_vm.state)}}},[_c("InlineSvg",{staticClass:"pointer pT3",attrs:{src:"remove-icon",iconClass:"icon icon-md mR5"}})],1):_vm._e()]),_vm.showProgressBar?_c("div",{class:["sidebar-loader",_vm.saving&&"on"]}):_vm._e(),_c("div",{staticClass:"new-body-modal new-stateflow-modal"},[_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"displayName"}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v(_vm._s(_vm.$t("setup.stateflow.name")))]),_c("el-input",{staticClass:"pR20",attrs:{placeholder:_vm.$t("setup.stateflow.name_placeholder"),autofocus:!0},on:{change:function($event){return _vm.autoSave()}},model:{value:_vm.state.displayName,callback:function($$v){_vm.$set(_vm.state,"displayName",$$v)},expression:"state.displayName"}})],1)],1)],1),_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"typeCode"}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.wr_list.type"))+" ")]),_c("el-radio-group",{on:{change:function($event){return _vm.autoSave()}},model:{value:_vm.state.typeCode,callback:function($$v){_vm.$set(_vm.state,"typeCode",$$v)},expression:"state.typeCode"}},[_c("el-radio",{staticClass:"fc-radio-btn",attrs:{label:1}},[_vm._v(" "+_vm._s(_vm.typeHash["1"])+" ")]),_c("el-radio",{staticClass:"fc-radio-btn",attrs:{label:2}},[_vm._v(" "+_vm._s(_vm.typeHash["2"])+" ")]),_c("el-radio",{staticClass:"fc-radio-btn",attrs:{label:6}},[_vm._v(" "+_vm._s(_vm.typeHash["6"])+" ")])],1)],1)],1)],1),_c("el-row",{staticClass:"mT20"},[_c("el-col",{attrs:{span:22}},[_c("div",{staticClass:"d-flex justify-content-space"},[_c("p",{staticClass:"fc-input-label-txt inline"},[_vm._v(" "+_vm._s(_vm.$t("setup.setupLabel.locked"))+" ")]),_c("el-switch",{staticClass:"Notification-toggle",attrs:{"active-color":"rgba(57, 178, 194, 0.8)","inactive-color":"#e5e5e5"},on:{change:function($event){return _vm.autoSave()}},model:{value:_vm.state.recordLocked,callback:function($$v){_vm.$set(_vm.state,"recordLocked",$$v)},expression:"state.recordLocked"}})],1)])],1),_c("hr",{staticClass:"separator-line mR20"}),_c("el-row",[_c("el-col",{attrs:{span:22}},[_c("div",{staticClass:"d-flex justify-content-space"},[_c("p",{staticClass:"fc-input-label-txt inline"},[_vm._v(" "+_vm._s(_vm.$t("setup.setupLabel.timer_enabled"))+" ")]),_c("el-switch",{staticClass:"Notification-toggle",attrs:{"active-color":"rgba(57, 178, 194, 0.8)","inactive-color":"#e5e5e5"},on:{change:function($event){return _vm.autoSave()}},model:{value:_vm.state.timerEnabled,callback:function($$v){_vm.$set(_vm.state,"timerEnabled",$$v)},expression:"state.timerEnabled"}})],1)])],1)],1),_vm.isAutoSaveNeeded?_vm._e():_c("div",{staticClass:"dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.cancel}},[_vm._v("Cancel")]),_c("el-button",{staticClass:"modal-btn-save shadow-none",attrs:{type:"primary",loading:_vm.saving},on:{click:_vm.save}},[_vm._v(" "+_vm._s(_vm.saving?_vm.$t("common._common._saving"):_vm.$t("common._common._save"))+" ")])],1)],1)],1)},staticRenderFns=[],objectSpread2=__webpack_require__(595082),ErrorBanner=(__webpack_require__(260228),__webpack_require__(821057),__webpack_require__(297157)),debounce=__webpack_require__(23279),debounce_default=__webpack_require__.n(debounce),NewStatevue_type_script_lang_js={props:["isNew","stateObj","module","canShowDelete","isAutoSaveNeeded","showProgressBar"],components:{ErrorBanner:ErrorBanner/* default */.Z},created:function(){this.state=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},this.state),this.stateObj)},computed:{ticketStatus:function(){return this.$store.state.ticketStatus[this.module]}},data:function(){return{showDeleteDialog:!1,saving:!1,error:!1,errorMessage:"",state:{displayName:null,typeCode:1,recordLocked:!1,requestedState:!1,timerEnabled:!1},typeHash:{1:"Open",2:"Closed",6:"Skipped"},rules:{display:[{required:!0,message:"Please enter a name for this state",trigger:"blur"}],typeCode:[{required:!0,message:"Please select a state type",trigger:"blur"}]}}},methods:{save:function(){var _this=this,data={};data["facilioStatus"]=(0,objectSpread2/* default */.Z)({},this.state),data["parentModuleName"]=this.module;var form=this.$refs["new-stateflow-form"];form&&form.validate().then((function(isValid){if(isValid){_this.saving=!0,_this.$emit("onSaving");var url="/v2/state/".concat(_this.isNew?"add":"update");_this.$http.post(url,data).then((function(_ref){var data=_ref.data;if(0!==data.responseCode)throw new Error(data.message);_this.$store.dispatch("loadTicketStatus",{moduleName:_this.module,forceUpdate:!0}),_this.isNew?_this.$emit("onStateCreate",data.result.status):_this.$emit("onStateUpdate",data.result.status,data.result.message)})).catch((function(error){_this.$emit("onError",error)})).finally((function(){return _this.saving=!1}))}}))},remove:function(state){
// TODO: Implement delete functionality
this.$emit("onDelete",state.id)},cancel:function(){this.$emit("onClose")},autoSave:debounce_default()((function(){this.isAutoSaveNeeded&&this.save()}),2e3)}},stateflow_NewStatevue_type_script_lang_js=NewStatevue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(stateflow_NewStatevue_type_script_lang_js,render,staticRenderFns,!1,null,"ac21c150",null)
/* harmony default export */,NewState=component.exports},
/***/279613:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return StateFlowBuilder}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/stateflows/StateFlowBuilder.vue?vue&type=template&id=1cf27aae&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"formbuilder-fullscreen-popup stateflow-fullscreen-popup",class:_vm.isLoading||_vm.hasError?"noselect":""},[_c("div",{staticClass:"setting-header2 position-relative"},[_c("div",{staticClass:"setting-title-block"},[_c("div",{staticClass:"setting-form-title mT10 mL15"},[_c("img",{staticClass:"fc-rebrand-logo",attrs:{src:_vm.brandConfig.logoLight}})])])]),_c("div",{staticClass:"d-flex height100 pB50"},[_c("div",{staticClass:"editor-container"},[_c("Toolbar",{attrs:{autoLayout:_vm.beautifyLayout,adjustZoom:_vm.adjustZoom,undo:_vm.undo,redo:_vm.redo,canShowUndo:_vm.canShowUndo,canShowRedo:_vm.canShowRedo,fitToScreen:_vm.fitToScreen,addState:_vm.addState,addTransition:_vm.addTransition,goBack:_vm.redirectToStateFlowList}}),_c("div",{ref:"stateflowContainer",staticClass:"d-flex flex-direction-column stateflow-canvas-container"},[_vm.$refs["stateflowCanvas"]?_vm._e():_c("spinner",{staticClass:"flex-middle",attrs:{show:!_vm.$refs["stateflowCanvas"],size:"80"}}),_c("canvas",{ref:"stateflowCanvas",attrs:{id:"stateflow-canvas"}}),_c("notification",{ref:"notification",staticClass:"notification"})],1)],1),_c("div",{staticClass:"sidebar-container"},[_vm.canShowStatePopup||_vm.canShowTransitionPopup?_vm._e():_c("sidebar",{attrs:{stateFlow:_vm.stateFlow,usedStates:_vm.usedStates,unusedStates:_vm.unusedStates,selectedState:_vm.selectedUnusedState,editAction:_vm.editState,addState:_vm.addState},on:{"update:selectedState":function($event){_vm.selectedUnusedState=$event},"update:selected-state":function($event){_vm.selectedUnusedState=$event}}}),_vm.canShowStatePopup?_c("new-state",{key:_vm.activeStateObj.id,ref:"state-editor",attrs:{stateObj:_vm.activeStateObj,stateFlowId:_vm.stateFlowId,stateFlowObj:_vm.stateFlow,isNew:_vm.isNew,module:_vm.moduleName,canShowDelete:!0,isAutoSaveNeeded:!0,showProgressBar:!0},on:{onClose:_vm.resetSelection,onSaving:_vm.onSaving,onStateUpdate:_vm.onStateUpdate,onStateCreate:_vm.onStateCreate,onDelete:_vm.removeState,onError:_vm.onError}}):_vm._e(),_vm.canShowTransitionPopup?_c("new-state-transition",{key:_vm.activeTransitionObj.id,ref:"transition-editor",attrs:{transitionObj:_vm.activeTransitionObj,stateFlowId:_vm.stateFlowId,stateFlowObj:_vm.stateFlow,isNew:_vm.isNew,module:_vm.moduleName,isAutoSaveNeeded:!0,showProgressBar:!0},on:{onClose:_vm.resetSelection,onSaving:_vm.onSaving,onTransitionUpdate:_vm.onTransitionUpdate,onTransitionCreate:_vm.onTransitionUpdate,onDelete:_vm.onTransitionDelete,onError:_vm.onError}}):_vm._e()],1),_c("warning-dialog",{ref:"warning"})],1)])},staticRenderFns=[],slicedToArray=__webpack_require__(554621),toConsumableArray=__webpack_require__(488478),fabric=(__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(634338),__webpack_require__(450886),__webpack_require__(670560),__webpack_require__(947522),__webpack_require__(425728),__webpack_require__(232777)),rafThrottle=__webpack_require__(474737),rafThrottle_default=__webpack_require__.n(rafThrottle),validation=__webpack_require__(990260),utils_Math=__webpack_require__(308530);// CONCATENATED MODULE: ./node_modules/@facilio/utils/page-visibility.js
/**
 * Util to refresh page when window has been inactive for a certain time period. Consumer must
 * implement a 'refresh' method that handles logic for reloading page
 * @param {InstanceType} context `this(vue instance)` in the component where refresh event will be triggered
 * @param {Number} delay The delay in ms after which window should be considered as inactive
 * @returns {InstanceType} context
 */
const visibilityChange=(context,delay)=>{let startTime=0,currentTime=0;return document.addEventListener("visibilitychange",(()=>{document["hidden"]?startTime=Date.now():(currentTime=Date.now()-startTime,currentTime>=delay&&context.$emit("refresh"))}),!1),context};
// EXTERNAL MODULE: ./src/pages/stateflows/utils/Common.js
var StateFlowDataMixin_render,StateFlowDataMixin_staticRenderFns,StateFlowAddEditMixin_render,StateFlowAddEditMixin_staticRenderFns,CanvasDragDropMixin_render,CanvasDragDropMixin_staticRenderFns,CanvasDrawMixin_render,CanvasDrawMixin_staticRenderFns,CanvasHistoryMixin_render,CanvasHistoryMixin_staticRenderFns,Common=__webpack_require__(126577),BuilderToolbarvue_type_template_id_b9d34f52_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"stateflow-builder-toolbar d-flex justify-content-end"},[_c("el-button-group",{staticClass:"d-flex",staticStyle:{"margin-right":"auto"}},[_c("el-button",{attrs:{type:"plain"},on:{click:_vm.goBack}},[_c("inline-svg",{attrs:{src:"left-arrow",iconClass:"icon vertical-bottom mR10"}}),_vm._v(" "+_vm._s(_vm.$t("setup.setupLabel.go_back"))+" ")],1)],1),_c("el-button-group",{staticClass:"d-flex"},[_c("el-button",{attrs:{type:"plain",icon:"fa fa-arrow-circle-o-right mR10"},on:{click:_vm.addTransition}},[_vm._v(" Add Transition ")])],1),_vm.canShowAutoAlign?_c("el-button-group",[_c("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Auto-Align",placement:"bottom",transition:"el-zoom-in-top"}},[_c("el-button",{attrs:{type:"plain",icon:"fa fa-magic"},on:{click:_vm.autoLayout}})],1)],1):_vm._e(),_c("el-button-group",[_c("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Undo",placement:"bottom",transition:"el-zoom-in-top"}},[_c("el-button",{attrs:{disabled:!_vm.canShowUndo,type:"plain",icon:"fa fa-undo"},on:{click:_vm.undo}})],1),_c("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Redo",placement:"bottom",transition:"el-zoom-in-top"}},[_c("el-button",{attrs:{disabled:!_vm.canShowRedo,type:"plain",icon:"fa fa-repeat"},on:{click:_vm.redo}})],1)],1),_c("el-button-group",[_c("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Fit To Screen",placement:"bottom",transition:"el-zoom-in-top"}},[_c("el-button",{attrs:{type:"plain",icon:"fa fa-compress"},on:{click:_vm.fitToScreen}})],1),_c("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Zoom In",placement:"bottom",transition:"el-zoom-in-top"}},[_c("el-button",{attrs:{type:"plain",icon:"fa fa-search-plus"},on:{click:function($event){return _vm.adjustZoom(!0)}}})],1),_c("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Zoom Out",placement:"bottom",transition:"el-zoom-in-top"}},[_c("el-button",{attrs:{type:"plain",icon:"fa fa-search-minus"},on:{click:function($event){return _vm.adjustZoom(!1)}}})],1)],1)],1)},BuilderToolbarvue_type_template_id_b9d34f52_scoped_true_staticRenderFns=[],BuilderToolbarvue_type_script_lang_js={props:["autoLayout","adjustZoom","undo","redo","canShowUndo","canShowRedo","fitToScreen","addState","addTransition","goBack"],computed:{canShowAutoAlign:function(){var _ref=this.$route.query||{},_ref$align=_ref.align,align=void 0!==_ref$align&&_ref$align;return align}}},components_BuilderToolbarvue_type_script_lang_js=BuilderToolbarvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_BuilderToolbarvue_type_script_lang_js,BuilderToolbarvue_type_template_id_b9d34f52_scoped_true_render,BuilderToolbarvue_type_template_id_b9d34f52_scoped_true_staticRenderFns,!1,null,"b9d34f52",null)
/* harmony default export */,BuilderToolbar=component.exports,BuilderSidebarvue_type_template_id_cfe52d94_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"height100 p30 pT20 sidebar-contents"},[_c("p",{staticClass:"f18 line-height20 flex-grow mB0"},[_vm._v(_vm._s(_vm.stateFlow.name))]),_c("hr",{staticClass:"separator-line mT20 mB20"}),_c("div",{staticClass:"mT20"},[_c("p",{staticClass:"f12 fc-text-pink fw6 flex-grow sidebar-empty-txt uppercase mb5"},[_vm._v(" Available States ")]),_c("p",{staticClass:"f13 line-height20 empty-greyH-bold flex-grow sidebar-empty-txt",attrs:{"data-v-df13d97a":""}},[_vm._v(" Drag and drop exisiting states into the stateflow or create a new state ")]),_c("div",{staticClass:"mR30 mB30 mT20"},[_c("el-input",{staticClass:"fc-input-full-border-select2",attrs:{autofocus:!0,"suffix-icon":"el-icon-search",placeholder:"Search available states"},model:{value:_vm.searchText,callback:function($$v){_vm.searchText=$$v},expression:"searchText"}})],1),_c("div",{staticClass:"available-state-container d-flex mT10"},[_c("div",{staticClass:"state-obj new-state",on:{click:_vm.addState}},[_vm._v("+ Add State")])]),_c("div",{class:["available-state-container d-flex flex-wrap needs-scroll",_vm.$validation.isEmpty(_vm.searchText)?"":"has-search"]},_vm._l(_vm.sortedStates,(function(state){return _c("div",{key:state.id,class:["state-obj",state.hasMatch&&"has-match"],attrs:{draggable:"true"},on:{dragstart:function($event){return _vm.setDraggedState(state)},dblclick:function($event){return _vm.editAction(state)}}},[_vm._v(" "+_vm._s(state.displayName)+" ")])})),0)])])},BuilderSidebarvue_type_template_id_cfe52d94_scoped_true_staticRenderFns=[],sortBy=(__webpack_require__(300268),__webpack_require__(189734)),sortBy_default=__webpack_require__.n(sortBy),BuilderSidebarvue_type_script_lang_js={props:["usedStates","unusedStates","selectedState","editAction","stateFlow","addState"],data:function(){return{searchText:""}},computed:{sortedStates:function(){var searchText=this.searchText,states=(0,toConsumableArray/* default */.Z)(this.unusedStates);return states=sortBy_default()(states,(function(s){return s.displayName.toLowerCase()})),states=states.map((function(s){return s.hasMatch=!(0,validation/* isEmpty */.xb)(searchText)&&s.displayName.toLowerCase().startsWith(searchText.toLowerCase()),s})),states}},methods:{setDraggedState:function(state){this.$emit("update:selectedState",state)}}},components_BuilderSidebarvue_type_script_lang_js=BuilderSidebarvue_type_script_lang_js,BuilderSidebar_component=(0,componentNormalizer/* default */.Z)(components_BuilderSidebarvue_type_script_lang_js,BuilderSidebarvue_type_template_id_cfe52d94_scoped_true_render,BuilderSidebarvue_type_template_id_cfe52d94_scoped_true_staticRenderFns,!1,null,"cfe52d94",null)
/* harmony default export */,BuilderSidebar=BuilderSidebar_component.exports,debounce=(__webpack_require__(85415),__webpack_require__(434284),__webpack_require__(919649),__webpack_require__(648324),__webpack_require__(169358),__webpack_require__(339772),__webpack_require__(23279)),debounce_default=__webpack_require__.n(debounce),api=__webpack_require__(32284),cloneDeep=__webpack_require__(150361),cloneDeep_default=__webpack_require__.n(cloneDeep),StateFlowDataMixinvue_type_script_lang_js={data:function(){return{stateFlow:{},availableStates:[],stateTransitions:[],isNew:!1,activeStateObj:null,canShowStatePopup:!1,deferAutoSave:!1}},computed:{transitionStateMap:function(){var transitions=this.stateTransitions,entries=transitions.map((function(t){return[String(t.id),
//key
[t.fromStateId,t.toStateId]]}));return Object.fromEntries(entries)}},methods:{logStatesAndTransitions:function(){if(this.isDebugMode){var _console=console,log=_console.log,states=this.availableStates,transitions=this.stateTransitions;log("\nStates\n"),states.forEach((function(s){return log("".concat(s.id," - ").concat(s.displayName))})),log("\nState Transitions\n"),transitions.forEach((function(t){return log("".concat(t.name," (").concat(t.id,"): ").concat(t.fromStateId," - ").concat(t.toStateId))})),log("\n\n")}},fetchStateFlow:function(){var _this=this;return api/* API */.bl.get("/v2/stateflow/view",{stateFlowId:this.stateFlowId}).then((function(_ref){var error=_ref.error,data=_ref.data;error||(_this.stateFlow=data.stateFlow)}))},fetchStates:function(){var _this2=this;return api/* API */.bl.get("/v2/state/list",{parentModuleName:this.moduleName}).then((function(_ref2){var error=_ref2.error,data=_ref2.data;error||(_this2.availableStates=data.status)}))},fetchTransitions:function(){var _this3=this;return api/* API */.bl.get("/v2/statetransition/list",{moduleName:this.module,stateFlowId:this.stateFlowId}).then((function(_ref3){var error=_ref3.error,data=_ref3.data;error||(_this3.stateTransitions=data.stateTransitionList||[])}))},serializeStateObj:function(obj){var stateId=obj.id,stateHash=this.transitionStateMap,visitedTransitionIds=new Set,anchors=obj.anchors.map((function(t){var states=stateHash[t]||[];if(visitedTransitionIds.has(t)){var isCycle=states[0]===stateId&&states[1]===stateId;return isCycle?t:null}return states.includes(stateId)?t:null})),state={stateId:stateId,x:obj.left,y:obj.top,anchors:anchors};return state},serializeCanvas:function(){var canvas=this.canvas,serializeStateObj=this.serializeStateObj,canvasJson=JSON.stringify(canvas),visitedStates=new Set,data={states:[],zoom:canvas.getZoom(),version:"0"};return JSON.parse(canvasJson).objects.filter((function(obj){return"group"===obj.type&&"state"===obj.objType})).forEach((function(obj){visitedStates.has(obj.id)||(visitedStates.add(obj.id),data.states.push(serializeStateObj(obj)))})),data},saveDiagram:function(){var _this4=this;this.onSaving();var data=this.serializeCanvas();return api/* API */.bl.post("/v2/stateflow/updateDiagram",{id:this.stateFlow.id,stateFlowDiagram:data}).then((function(_ref4){var error=_ref4.error,data=_ref4.data;error?_this4.onError():(_this4.updateDiagram(data),_this4.onSaved())}))},autoSave:debounce_default()((function(){var _this5=this;this.deferAutoSave?(this.deferAutoSave=!1,this.$helpers.delay(3e3).then((function(){return _this5.autoSave}))):this.saveDiagram()}),2500),editState:function(state){this.activeStateObj=cloneDeep_default()(state),this.canShowTransitionPopup=!1,this.isNew=!1,this.canShowStatePopup=!0},addState:function(){this.resetEditObjects(),this.isNew=!0,this.activeStateObj={},this.canShowStatePopup=!0},onStateUpdate:function(state){var message=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,index=this.availableStates.findIndex((function(s){return String(s.id)===String(state.id)}));(0,validation/* isEmpty */.xb)(index)||this.$set(this.availableStates,index,state),this.onSaved(message),this.drawStateFlow()},onStateCreate:function(state){this.availableStates.push(state),this.editState(state),this.onSaved(),
// force update ticketstatus so that state is available during
// transition creation
this.$store.dispatch("loadTicketStatus",{moduleName:this.module,forceUpdate:!0})},onSaving:function(){this.$refs["notification"].showSaving("Saving")},onSaved:function(){var message=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.$refs["notification"].showSuccess(message||"Saved")},onError:function(){this.$refs["notification"].showError("Error Occured")},resetEditObjects:function(){this.isNew=!1,this.selectedStateObj=null,this.activeTransitionObj=null,this.canShowStatePopup=!1,this.canShowTransitionPopup=!1,this.activeObj=null}}},mixins_StateFlowDataMixinvue_type_script_lang_js=StateFlowDataMixinvue_type_script_lang_js,StateFlowDataMixin_component=(0,componentNormalizer/* default */.Z)(mixins_StateFlowDataMixinvue_type_script_lang_js,StateFlowDataMixin_render,StateFlowDataMixin_staticRenderFns,!1,null,null,null)
/* harmony default export */,StateFlowDataMixin=StateFlowDataMixin_component.exports,StateFlowAddEditMixinvue_type_script_lang_js=(__webpack_require__(162506),{data:function(){return{activeTransitionObj:null,canShowTransitionPopup:!1,tempTransitionList:[]}},methods:{editTransition:function(transition){this.activeTransitionObj=cloneDeep_default()(transition),this.canShowStatePopup=!1,this.isNew=transition.isPartial,this.canShowTransitionPopup=!0},addTransition:function(){this.resetSelection(),this.resetEditObjects(),this.isNew=!0,this.activeTransitionObj={},this.canShowTransitionPopup=!0,this.enableTransitionMode()},updateTransitionParents:function(transition){var _this=this,data={stateFlowId:this.stateFlowId,stateTransition:{id:transition.id,fromStateId:transition.fromStateId,toStateId:transition.toStateId}};return new Promise((function(resolve,reject){_this.onSaving(),api/* API */.bl.post("/v2/statetransition/updateState",data).then((function(_ref){var error=_ref.error;error?(_this.onError(error),reject()):(_this.onTransitionUpdate(transition),resolve())}))}))},onTransitionUpdate:function(transition,tempTransitionId){var _this2=this,transitionId=transition.id,index=this.stateTransitions.findIndex((function(t){return String(t.id)===String(transitionId)}));(0,validation/* isEmpty */.xb)(index)?this.stateTransitions.push(transition):this.$set(this.stateTransitions,index,transition),tempTransitionId&&this.swapTempTransition(transition,tempTransitionId),this.updateDiagram(),this.updateTransitionChange(transition).then((function(){_this2.drawMissingStates(transition),_this2.$nextTick((function(){_this2.initTransitions([String(transitionId)]),_this2.resetDragProps()}))})).catch((function(error){_this2.$nextTick((function(){_this2.drawStateFlow(),_this2.resetDragProps()}))})),this.editTransition(transition),this.$refs["notification"].showSuccess("Saved")},onTransitionDelete:function(transitionId,options){var _ref2=options||{},_ref2$isPartial=_ref2.isPartial,isPartial=void 0!==_ref2$isPartial&&_ref2$isPartial,canvas=this.canvas,stateTransitions=this.stateTransitions,tempTransitionList=this.tempTransitionList,index=(isPartial?tempTransitionList:stateTransitions).findIndex((function(t){return t.id===transitionId})),transition=(isPartial?tempTransitionList:stateTransitions)[index];if(!(0,validation/* isEmpty */.xb)(transition)){var fromStateObj=(0,Common/* getObjById */.cU)(canvas,transition.fromStateId),newStateObj=(0,Common/* getObjById */.cU)(canvas,transition.toStateId);this.clearAnchor(fromStateObj,transitionId),this.clearAnchor(newStateObj,transitionId),isPartial?tempTransitionList.splice(index,1):stateTransitions.splice(index,1),canvas.remove((0,Common/* getObjById */.cU)(canvas,String(transitionId))),canvas.requestRenderAll(),this.autoSave(),this.resetSelection()}},updateTransitionChange:function(transition){if(String(transition.id)===String(this.modifiedTransitionId)){var prevStateObj=(0,Common/* getObjById */.cU)(this.canvas,this.modifiedStates.prev),nextStateObj=(0,Common/* getObjById */.cU)(this.canvas,this.modifiedStates.current),anchorId=(this.draggedConnectorProps||{}).freeAnchorId,preferredAnchor=anchorId?{id:anchorId}:{};this.clearAnchor(prevStateObj,transition.id),this.assignAnchor(nextStateObj,transition.id,preferredAnchor),this.resetModifiedProps()}else this.updateDiagram();return this.saveDiagram()},handleTransitionEdit:function(transition,stateId){var _this3=this,isFromState=arguments.length>2&&void 0!==arguments[2]&&arguments[2],transitionId=transition&&transition.id;if(transition.isPartial){var oldState=null,newState=(0,Common/* getObjById */.cU)(this.canvas,stateId);isFromState?(oldState=(0,Common/* getObjById */.cU)(this.canvas,transition.fromStateId),transition.fromStateId=stateId):(oldState=(0,Common/* getObjById */.cU)(this.canvas,transition.toStateId),transition.toStateId=stateId);var anchorId=(this.draggedConnectorProps||{}).freeAnchorId,preferredAnchor=anchorId?{id:anchorId}:{};return this.clearAnchor(oldState,transition.id),this.assignAnchor(newState,transition.id,preferredAnchor),this.initTransitions([String(transition.id)]),this.$nextTick((function(){return _this3.resetDragProps()})),Promise.resolve()}return new Promise((function(resolve,reject){if(!transitionId)return reject();var transition=cloneDeep_default()(_this3.stateTransitions.find((function(_ref3){var id=_ref3.id;return id===transitionId})));isFromState?transition.fromStateId=stateId:transition.toStateId=stateId,_this3.$nextTick((function(){_this3.updateTransitionParents(transition).then(resolve).catch(reject)}))}))},setNewTransitionProps:function(transition){this.$refs["transition-editor"].setProps({fromStateId:transition.fromStateId,toStateId:transition.toStateId,isPartialTransition:!0,tempTransitionId:transition.id})},addTempConnector:function(transition){var _this4=this,id=transition.id,fromStateId=transition.fromStateId,fromStateAnchor=transition.fromStateAnchor,toStateId=transition.toStateId,toStateAnchor=transition.toStateAnchor;this.tempTransitionList.push({id:id,fromStateId:fromStateId,toStateId:toStateId,isPartial:!0}),this.setAnchor(fromStateId,fromStateAnchor,id),this.setAnchor(toStateId,toStateAnchor,id),this.updateAnchorMap(fromStateId,fromStateAnchor,id),this.updateAnchorMap(toStateId,toStateAnchor,id),this.initTransitions([id]),this.disableTransitionMode(),this.$nextTick((function(){var target=(0,Common/* getObjById */.cU)(_this4.canvas,id);!(0,validation/* isEmpty */.xb)(target)&&_this4.setActiveObject(target)}))}}}),mixins_StateFlowAddEditMixinvue_type_script_lang_js=StateFlowAddEditMixinvue_type_script_lang_js,StateFlowAddEditMixin_component=(0,componentNormalizer/* default */.Z)(mixins_StateFlowAddEditMixinvue_type_script_lang_js,StateFlowAddEditMixin_render,StateFlowAddEditMixin_staticRenderFns,!1,null,null,null)
/* harmony default export */,StateFlowAddEditMixin=StateFlowAddEditMixin_component.exports,CanvasActionsMixin=__webpack_require__(238936),CanvasPanZoomMixin=__webpack_require__(289612),objectSpread2=__webpack_require__(595082),uuid=(__webpack_require__(879288),__webpack_require__(455877)),CanvasDragDropMixinvue_type_script_lang_js={data:function(){return{
// Props for transition edit
draggedConnector:null,draggedConnectorProps:null,modifiedTransitionId:null,modifiedStates:{prev:null,current:null},
// Props for transition creation
isNewConnectionMode:!1,newConnector:null,newConnectorProps:null,
// Props for unused states
selectedUnusedState:null,draggedStateMap:[]}},methods:{
/*
     * State Drag & Drop
     */
addStateToCanvas:function(_ref){var _this=this,e=_ref.e,pos=this.canvas.getPointer(e),activeStateObj=(0,objectSpread2/* default */.Z)({},this.selectedUnusedState);pos&&!(0,validation/* isEmpty */.xb)(activeStateObj)&&(this.drawState(activeStateObj,pos),this.draggedStateMap.push(activeStateObj.id),this.selectedUnusedState=null,this.addToDiagram(activeStateObj.id,pos),this.$nextTick((function(){_this.addToHistory(!0),_this.autoSave(),_this.reinitRouter()})))},
/*
     * Existing Connector Drag & Drop
     */
onConnectorMouseDown:function(event){event.target.isDragMode=!0;var mouseCoord=this.canvas.getPointer(event.e),pathPoints=event.target.pathPoints;this.draggedConnector=event.target,(0,validation/* isEmpty */.xb)(event.target.pathPoints)||(this.draggedConnectorProps={src:event.target.pathPoints[0],dest:event.target.pathPoints[event.target.pathPoints.length-1],isCloserToSrc:(0,utils_Math/* findClosestPathEnd */.ws)(pathPoints,mouseCoord)})},onConnectorMouseUp:function(event){var _this2=this,canvas=this.canvas,mouseCoords=this.canvas.getPointer(event.e),isCloserToSrc=this.draggedConnectorProps.isCloserToSrc,transition=this.draggedConnector.transition;(0,validation/* isEmpty */.xb)(transition)||this.canvas.getObjects().filter((function(obj){return"state"===obj.objType})).forEach((function(obj){obj.onHoverEnd();var existingStateId=isCloserToSrc?transition["fromStateId"]:transition["toStateId"],isCycle=obj.id===(isCloserToSrc?transition["toStateId"]:transition["fromStateId"]),hasStateChanged=obj.id!==existingStateId&&!isCycle;if((0,Common/* isObjIntesecting */.gc)(obj,mouseCoords)&&hasStateChanged){var stateId=obj.id,freeAnchorId=obj.focusClosestAnchor(mouseCoords);_this2.modifiedTransitionId=transition.id,_this2.modifiedStates={current:stateId,prev:isCloserToSrc?transition.fromStateId:transition.toStateId},_this2.draggedConnectorProps=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},_this2.draggedConnectorProps),{},{freeAnchorId:freeAnchorId}),_this2.handleTransitionEdit(transition,stateId,isCloserToSrc).catch((function(){_this2.$nextTick((function(){return _this2.resetDragProps()}),_this2.removePseudoConnector())}))}else if((0,Common/* isObjIntesecting */.gc)(obj,mouseCoords)&&!isCycle){var newAnchorId=obj.focusClosestAnchor(mouseCoords),_this2$findAnchor=_this2.findAnchor(obj,transition.id),_this2$findAnchor2=(0,slicedToArray/* default */.Z)(_this2$findAnchor,2),existingAnchorId=_this2$findAnchor2[1];newAnchorId!==existingAnchorId&&(_this2.clearAnchor(obj,transition.id),_this2.assignAnchor(obj,transition.id,{id:newAnchorId}),_this2.$nextTick((function(){_this2.autoSave(),_this2.initTransitions([String(transition.id)])}))),_this2.$nextTick((function(){return _this2.setActiveObject(event.target)}))}})),event.target.isDragMode=!1,this.removePseudoConnector(),canvas.requestRenderAll()},
/*
     * New Connector Drag & Drop
     */
onNewConnectionMouseDown:function(event){var state=event.target,mouseCoords=this.canvas.getPointer(event.e),freeAnchorId=state.focusClosestAnchor(mouseCoords),groupCoords=(0,Common/* getCenterCoords */.us)(state),anchorCoords=(0,Common/* getCenterCoords */.us)(state.anchors[freeAnchorId])||{x:0,y:0};this.newConnectorProps={fromStateId:Number(state.id),fromStateAnchor:freeAnchorId,src:(0,utils_Math/* getAbsoluteCoords */.up)(groupCoords,anchorCoords)},this.newConnector={transition:{isPartial:!0}}},onNewConnectionMouseUp:function(event){var _this3=this,mouseCoords=this.canvas.getPointer(event.e);this.canvas.getObjects().filter((function(obj){return"state"===obj.objType})).forEach((function(obj){var isCycle=String(_this3.newConnectorProps.fromStateId)===String(obj.id);if((0,Common/* isObjIntesecting */.gc)(obj,mouseCoords)&&!isCycle){var freeAnchorId=obj.focusClosestAnchor(mouseCoords),groupCoords=(0,Common/* getCenterCoords */.us)(obj),anchorCoords=(0,Common/* getCenterCoords */.us)(obj.anchors[freeAnchorId])||{x:0,y:0};_this3.newConnectorProps=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},_this3.newConnectorProps),{},{toStateId:obj.id,toStateAnchor:freeAnchorId,dest:(0,utils_Math/* getAbsoluteCoords */.up)(groupCoords,anchorCoords)});var tempId="temp".concat((0,uuid.v4)());_this3.setNewTransitionProps((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},_this3.newConnectorProps),{},{id:tempId})),_this3.addTempConnector((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},_this3.newConnectorProps),{},{id:tempId}))}obj.resetAnchors(),obj.onHoverEnd()})),this.removePseudoConnector(),this.canvas.requestRenderAll(),this.$nextTick((function(){_this3.resetNewConnectorProps()}))},
/*
     * Pesudo Connector Handling
     */
dragConnector:rafThrottle_default()((function(event){var mouseCoords=this.canvas.getPointer(event.e),isExisitingTransition=!this.isNewConnectionMode;this.drawPseudoConnector(mouseCoords,isExisitingTransition),this.canvas.getObjects().forEach((function(obj){"state"===obj.objType&&((0,Common/* isObjIntesecting */.gc)(obj,mouseCoords)?(obj.focusClosestAnchor(mouseCoords),obj.onHoverStart()):(obj.resetAnchors(),obj.onHoverEnd()))}))})),
/*
     * Reset fns
     */
resetDragProps:function(){this.draggedConnector=null,this.draggedConnectorProps=null},resetModifiedProps:function(){this.modifiedTransitionId=null,this.modifiedStates={prev:null,current:null}},resetNewConnectorProps:function(){this.newConnector=null,this.newConnectorProps=null},
/*
     * Reset at edge and overlapping
     */
handleBounds:function(stateObj){var _stateObj$aCoords=stateObj.aCoords,tl=_stateObj$aCoords.tl,br=_stateObj$aCoords.br,allowedCanvasPanSize=this.allowedCanvasPanSize,offSet=50;if(tl.x<2){var _stateObj$getBounding=stateObj.getBoundingRect(),width=_stateObj$getBounding.width;stateObj.left=width/2+offSet}else if(allowedCanvasPanSize<=br.x){var xDiffWidth=br.x-allowedCanvasPanSize;stateObj.left-=xDiffWidth+offSet}if(tl.y<2){var _stateObj$getBounding2=stateObj.getBoundingRect(),height=_stateObj$getBounding2.height;stateObj.top=height/2+offSet}else if(allowedCanvasPanSize<=br.y){var yDiffHeight=br.y-allowedCanvasPanSize;stateObj.top-=yDiffHeight+offSet}return stateObj},handleIntersections:function(stateObj){var hasIntersection=this.canvas.getObjects().filter((function(obj){return"state"===obj.objType&&String(obj.id)!==String(stateObj.id)})).some((function(state){return stateObj.intersectsWithObject(state,!0,!0)}));if(hasIntersection){this.skipHistoryPush=!0;var json=this.canvasStates[this.currentCanvasState],_JSON$parse=JSON.parse(json),states=_JSON$parse.states,_states$find=states.find((function(state){return String(state.stateId)===String(stateObj.id)})),x=_states$find.x,y=_states$find.y;stateObj.left=x,stateObj.top=y}}}},mixins_CanvasDragDropMixinvue_type_script_lang_js=CanvasDragDropMixinvue_type_script_lang_js,CanvasDragDropMixin_component=(0,componentNormalizer/* default */.Z)(mixins_CanvasDragDropMixinvue_type_script_lang_js,CanvasDragDropMixin_render,CanvasDragDropMixin_staticRenderFns,!1,null,null,null)
/* harmony default export */,CanvasDragDropMixin=CanvasDragDropMixin_component.exports,elements_Common=__webpack_require__(144945),getTransitionColors=(__webpack_require__(689730),function(type){return 3===Number(type)?{bg:elements_Common/* colors */.O9.transition.condition,text:elements_Common/* colors */.O9.transition.text,line:elements_Common/* colors */.O9.line}:[2,4].includes(Number(type))?{bg:elements_Common/* colors */.O9.transition.time,text:elements_Common/* colors */.O9.transition.text,line:elements_Common/* colors */.O9.line}:{bg:elements_Common/* colors */.O9.transition.bg,text:elements_Common/* colors */.O9.transition.text,line:elements_Common/* colors */.O9.line}}),getTransitionIcon=function(type){var paths=[],color=elements_Common/* colors */.O9.transition.text.default;if(3===Number(type))paths=["M307.6 21.2l182.2 182.2a73.6 73.6 0 0 1 0 104.2L307.6 489.8a73.6 73.6 0 0 1-104.2 0L21.2 307.6a73.6 73.6 0 0 1 0-104.2L203.4 21.2a73.6 73.6 0 0 1 104.2 0zm-26 26a36.8 36.8 0 0 0-52.1 0L47.2 229.5a36.8 36.8 0 0 0 0 52l182.3 182.3a36.8 36.8 0 0 0 52 0l182.3-182.3a36.8 36.8 0 0 0 0-52L281.5 47.2z"];else{if(![2,4].includes(Number(type)))return null;paths=["M256 511a255.5 255.5 0 0 0 255.4-255.4A255.5 255.5 0 0 0 256 .2 255.5 255.5 0 0 0 .6 255.6 255.5 255.5 0 0 0 256 510.9zm0-475a219.7 219.7 0 1 1 0 439.2A219.7 219.7 0 0 1 256 36z","M244 285.5h85.2c10.2 0 18-7.9 18-18 0-10.2-7.8-18.1-18-18.1h-67v-105c0-10.1-8-18-18.1-18-10.2 0-18 7.9-18 18v123c0 10.2 7.8 18.1 18 18.1z"]}return paths=paths.map((function(path){return new fabric.fabric.Path(path,(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},elements_Common/* commonObjProps */.Lp),{},{fill:"",strokeWidth:35,stroke:color,objectCaching:!1}))})),new fabric.fabric.Group(paths,(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},elements_Common/* commonObjProps */.Lp),{},{objType:"icon",originX:"right",originY:"bottom"})).scaleToHeight(11)},arrowDirectionHash=["bottom","bottom","bottom","right","top","top","top","left"],makeConnector=function(transition,coords,canvas,anchors){if(!(0,validation/* isEmpty */.xb)(coords)){var id=transition.id,_getTransitionColors=getTransitionColors(transition.type||1),textColor=_getTransitionColors.text.default,bgColor=_getTransitionColors.bg.default,lineColor=_getTransitionColors.line.default,linePath=coords.reduce((function(acc,c){return acc+=" ".concat(c.x," ").concat(c.y),acc}),"M"),line=new fabric.fabric.Path(linePath,(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},elements_Common/* commonObjProps */.Lp),{},{objType:"line",fill:"",stroke:lineColor,objectCaching:!1})),centre=coords[0],circle=new fabric.fabric.Circle((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},elements_Common/* commonObjProps */.Lp),{},{objType:"dot",originX:"center",originY:"center",top:centre.y,left:centre.x,radius:2.5,fill:elements_Common/* colors */.O9.line.default,stroke:elements_Common/* colors */.O9.line.default,objectCaching:!1})),arrowCoords=(0,elements_Common/* getArrowCoords */._W)(coords[coords.length-1],arrowDirectionHash[anchors[1]]),arrowPath=arrowCoords.reduce((function(acc,c){return acc+=" ".concat(c.x," ").concat(c.y),acc}),"M"),arrow=new fabric.fabric.Path("".concat(arrowPath," Z"),{objType:"arrow",fill:lineColor,stroke:lineColor,objectCaching:!1,hoverCursor:"pointer"}),elementArray=[line,arrow,circle],pathMidPt=(0,utils_Math/* getPathMidPt */.mV)(coords)||{x:0,y:0};if(transition.isPartial){var plusSign=(0,elements_Common/* makePlusSign */.PZ)({bgColor:lineColor});plusSign.left=pathMidPt.x,plusSign.top=pathMidPt.y,elementArray.push(plusSign)}else{var rect=new fabric.fabric.Rect((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},elements_Common/* commonObjProps */.Lp),{},{objType:"rect",left:pathMidPt.x,top:pathMidPt.y,originX:"center",originY:"center",width:110,height:26,rx:12.5,ry:12.5,stroke:bgColor,strokeWidth:1,fill:bgColor}));elementArray.push(rect);var name=transition.name,type=transition.type,icon=getTransitionIcon(type),allowedNameLength=icon?14:16,trimmedName=name.length>allowedNameLength?"".concat(name.slice(0,allowedNameLength-4),"..."):name,textEl=new fabric.fabric.Text(trimmedName,(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},elements_Common/* commonObjProps */.Lp),{},{objType:"text",originX:"center",originY:"center",fontFamily:'"Aktiv-Grotesk", Helvetica, Arial, sans-serif',fill:textColor,fontSize:"13"}));if(icon){
// http://fabricjs.com/test/misc/origin.html
icon.set({left:0,top:-3}),textEl.set({originX:"left",originY:"bottom",left:5,top:0});var iconText=new fabric.fabric.Group([icon,textEl]);iconText.set({originX:"center",originY:"center",left:pathMidPt.x,top:pathMidPt.y}),elementArray.push(iconText)}else textEl.set({left:pathMidPt.x,top:pathMidPt.y}),elementArray.push(textEl)}var group=new fabric.fabric.Group(elementArray,(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},elements_Common/* commonObjProps */.Lp),{},{id:id,objType:"connector",pathPoints:coords,transition:transition,lockMovementX:!0,lockMovementY:!0,hoverCursor:"pointer"}));return group.on("mouseover",(function(event){event.target&&event.target.onHoverStart(),canvas.requestRenderAll()})),group.on("mouseout",(function(event){event.target&&event.target.onHoverEnd(),canvas.requestRenderAll()})),group.toggleActiveState=function(isActive){var propName=isActive?"active":"default",objects=this.getObjects(),_getTransitionColors2=getTransitionColors(this.transition.type||1),textColors=_getTransitionColors2.text,bgColors=_getTransitionColors2.bg,lineColors=_getTransitionColors2.line;objects.forEach((function(obj){["line","dot","arrow"].includes(obj.objType)&&obj.set("stroke",lineColors[propName]),"line"!==obj.objType&&obj.set("fill",lineColors[propName]),"text"===obj.objType&&obj.set("fill",textColors[propName]),"rect"===obj.objType&&obj.set("fill",bgColors[propName]),"rect"===obj.objType&&obj.set("stroke",bgColors[propName]),"plus"===obj.objType&&(isActive?obj.onHoverStart():obj.onHoverEnd())}))}.bind(group),group.onHoverStart=function(){this.toggleActiveState(!0)}.bind(group),group.onHoverEnd=function(){this.isActive||this.toggleActiveState(!1)}.bind(group),group.makeActive=function(){this.isActive=!0,this.onHoverStart()},group.makeInActive=function(){this.isActive=!1,this.onHoverEnd()},group}},vec_module=__webpack_require__(114932),getAdjustedEndPt=function(coords){var direction="bottom",end=coords[coords.length-1];end={x:Math.round(end.x),y:Math.round(end.y)};var startIndex=2,start=coords[coords.length-startIndex];start={x:Math.round(start.x),y:Math.round(start.y)};
// Pick two points on the line that are atleast 20px away from each other to get the direction
// the arrow is moving in. Should prob switch to angle based computation like in pathfinding.js
while((0,vec_module/* vDist */.cl)([start.x,start.y],[end.x,end.y])<20&&coords.length-1>startIndex)end=start,startIndex+=1,start=coords[coords.length-startIndex],start={x:Math.round(start.x),y:Math.round(start.y)};direction=start.y<end.y?"bottom":start.y>end.y?"top":start.x<end.x?"left":"right";var endPt=coords[coords.length-1];return{endPt:{x:Math.round(endPt.x),y:Math.round(endPt.y)},direction:direction}},makePseudoConnector=function(id,transition,coords){if(!(0,validation/* isEmpty */.xb)(coords)){var elementArray=[],_getTransitionColors=getTransitionColors(transition.type||1),textColor=_getTransitionColors.text.active,bgColor=_getTransitionColors.bg.active,lineColor=_getTransitionColors.line.active,linePath=coords.reduce((function(acc,c){return acc+=" ".concat(c.x," ").concat(c.y),acc}),"M"),line=new fabric.fabric.Path(linePath,(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},elements_Common/* commonObjProps */.Lp),{},{objType:"line",fill:"",stroke:lineColor,objectCaching:!1}));elementArray.push(line);
// Draw arrow on line end point
var _getAdjustedEndPt=getAdjustedEndPt(coords),endPt=_getAdjustedEndPt.endPt,direction=_getAdjustedEndPt.direction,arrowPath=(0,elements_Common/* getArrowCoords */._W)(endPt,direction,!1).reduce((function(acc,c){return acc+=" ".concat(c.x," ").concat(c.y),acc}),"M"),arrow=new fabric.fabric.Path("".concat(arrowPath," Z"),{objType:"arrow",fill:lineColor,stroke:lineColor,objectCaching:!1});elementArray.push(arrow);
//  Draw circle on line start point
var centre=coords[0],circle=new fabric.fabric.Circle((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},elements_Common/* commonObjProps */.Lp),{},{objType:"dot",originX:"center",originY:"center",top:centre.y,left:centre.x,radius:2.5,fill:elements_Common/* colors */.O9.line.active,stroke:elements_Common/* colors */.O9.line.active,objectCaching:!1}));elementArray.push(circle);
// Draw transition box
var pathMidPt=(0,utils_Math/* getPathMidPt */.mV)(coords)||{x:0,y:0};if(transition.isPartial){var plusSign=(0,elements_Common/* makePlusSign */.PZ)();plusSign.left=pathMidPt.x,plusSign.top=pathMidPt.y,elementArray.push(plusSign)}else{var rect=new fabric.fabric.Rect((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},elements_Common/* commonObjProps */.Lp),{},{objType:"rect",left:pathMidPt.x,top:pathMidPt.y,originX:"center",originY:"center",width:110,height:26,rx:12.5,ry:12.5,stroke:bgColor,strokeWidth:1,fill:bgColor}));elementArray.push(rect);var textEl=new fabric.fabric.Text(transition.name,(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},elements_Common/* commonObjProps */.Lp),{},{objType:"text",left:pathMidPt.x,top:pathMidPt.y,originX:"center",originY:"center",fontFamily:'"Aktiv-Grotesk", Helvetica, Arial, sans-serif',fill:textColor,fontSize:"13"}));elementArray.push(textEl)}var group=new fabric.fabric.Group(elementArray,(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},elements_Common/* commonObjProps */.Lp),{},{id:id,objType:"pesudo-connector",lockMovementX:!0,lockMovementY:!0,hoverCursor:"pointer",opacity:.6}));return group}},trimmedName=function(name){return name.length>18?name.slice(0,15)+"...":name},makeState=function(_ref,canvas){var id=_ref.id,displayName=_ref.displayName,_ref$isDefaultState=_ref.isDefaultState,isDefaultState=void 0!==_ref$isDefaultState&&_ref$isDefaultState,coords=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,anchorList=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],cellSize=arguments.length>4&&void 0!==arguments[4]?arguments[4]:10,textColor=elements_Common/* colors */.O9.state.text.default,bgColor=elements_Common/* colors */.O9.state.bg.default,rectWidth=135,rectHeight=30,anchorColor=elements_Common/* colors */.O9.line.default,strokeColor=isDefaultState?"#60a9a6":textColor,rect=new fabric.fabric.Rect((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},elements_Common/* commonObjProps */.Lp),{},{objType:"rect",originX:"center",originY:"center",top:15,left:67,width:rectWidth,height:rectHeight,rx:3,ry:3,strokeWidth:1,fill:bgColor,hoverCursor:"move",stroke:strokeColor})),textEl=new fabric.fabric.Text(trimmedName(displayName),(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},elements_Common/* commonObjProps */.Lp),{},{objType:"textEl",originX:"center",originY:"center",top:15,left:67,fontFamily:'"Aktiv-Grotesk", Helvetica, Arial, sans-serif',fill:textColor,fontSize:"13"})),connectorPoints=[].concat((0,toConsumableArray/* default */.Z)((0,utils_Math/* getPointsOnLine */.xU)({x:0,y:0},{x:rectWidth,y:0},3)),(0,toConsumableArray/* default */.Z)((0,utils_Math/* getPointsOnLine */.xU)({x:rectWidth,y:0},{x:rectWidth,y:rectHeight},1)),(0,toConsumableArray/* default */.Z)((0,utils_Math/* getPointsOnLine */.xU)({x:rectWidth,y:rectHeight},{x:0,y:rectHeight},3)),(0,toConsumableArray/* default */.Z)((0,utils_Math/* getPointsOnLine */.xU)({x:0,y:0},{x:0,y:rectHeight},1))),anchors=[];connectorPoints.forEach((function(_ref2,index){var x=_ref2.x,y=_ref2.y,circle=new fabric.fabric.Circle((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},elements_Common/* commonObjProps */.Lp),{},{objType:"anchor",originX:"center",originY:"center",top:y,left:x,radius:3,fill:anchorColor,stroke:anchorColor,objectCaching:!1,opacity:0,anchorId:index,transitionId:anchorList[index]||null,hoverCursor:"pointer"}));anchors.push(circle)}));var group=new fabric.fabric.Group([rect,textEl].concat(anchors),(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},elements_Common/* commonObjProps */.Lp),{},{id:id,objType:"state",originX:"center",originY:"center",left:coords?coords.x:100,top:coords?coords.y:100,anchors:anchors,excludeFromExport:!1,subTargetCheck:!0,cellSize:cellSize}));return group.showAnchors=function(){var objects=this.getObjects()||[],rect=objects.find((function(obj){return"rect"===obj.objType}));rect&&rect.set("hoverCursor","default"),objects.filter((function(obj){return"anchor"===obj.objType})).forEach((function(obj){obj.animate("opacity",1,{onChange:function(){canvas.requestRenderAll()}.bind(canvas),duration:200,easing:fabric.fabric.util.ease.easeOutSine})}))}.bind(group),group.hideAnchors=function(){var objects=this.getObjects()||[],rect=objects.find((function(obj){return"rect"===obj.objType}));rect&&rect.set("hoverCursor","move"),objects.filter((function(obj){return"anchor"===obj.objType})).forEach((function(obj){obj.animate("opacity",0,{onChange:function(){canvas.requestRenderAll()}.bind(canvas),duration:200,easing:fabric.fabric.util.ease.easeOutSine})}))}.bind(group),group.setAnchor=function(anchorId,transitionId){var anchor=this.getObjects().filter((function(_ref3){var objType=_ref3.objType;return"anchor"===objType})).find((function(a){return String(a.anchorId)===String(anchorId)}));anchor.transitionId=transitionId}.bind(group),group.focusClosestAnchor=function(mouse){var closestAnchorDist=1/0,closestFreeAnchor=null,getCoords=function(child){return(0,utils_Math/* getAbsoluteCoords */.up)((0,Common/* getCenterCoords */.us)(group),(0,Common/* getCenterCoords */.us)(child))},render=function(){return canvas.requestRenderAll()},anchors=this.getObjects().filter((function(_ref4){var objType=_ref4.objType;return"anchor"===objType}));if(anchors.forEach((function(anchor){var coord=getCoords(anchor),dist=(0,vec_module/* vDist */.cl)([mouse.x,mouse.y],[coord.x,coord.y]);anchor.set("fill",anchorColor),anchor.set("stroke",anchorColor),dist<closestAnchorDist&&(0,validation/* isEmpty */.xb)(anchor.transitionId)&&(closestAnchorDist=dist,closestFreeAnchor=anchor)})),!(0,validation/* isEmpty */.xb)(closestFreeAnchor))return closestFreeAnchor.set("fill",elements_Common/* colors */.O9.line.active),closestFreeAnchor.set("stroke",elements_Common/* colors */.O9.line.active),render(),closestFreeAnchor.anchorId}.bind(group),group.resetAnchors=function(){var render=function(){return canvas.requestRenderAll()},anchors=this.getObjects().filter((function(_ref5){var objType=_ref5.objType;return"anchor"===objType}));anchors.forEach((function(anchor){anchor.set("fill",anchorColor),anchor.set("stroke",anchorColor),render()}))}.bind(group),group.onHoverStart=function(){var rect=this.getObjects().find((function(_ref6){var objType=_ref6.objType;return"rect"===objType}));rect&&rect.set("stroke",elements_Common/* colors */.O9.line.active);var text=this.getObjects().find((function(_ref7){var objType=_ref7.objType;return"textEl"===objType}));text&&text.set("fill",elements_Common/* colors */.O9.line.active)}.bind(group),group.onHoverEnd=function(){var rect=this.getObjects().find((function(_ref8){var objType=_ref8.objType;return"rect"===objType})),text=this.getObjects().find((function(_ref9){var objType=_ref9.objType;return"textEl"===objType}));this.isActive||(rect&&rect.set("stroke",strokeColor),text&&text.set("fill",textColor))}.bind(group),group.makeActive=function(){this.isActive=!0,this.onHoverStart()},group.makeInActive=function(){this.isActive=!1,this.onHoverEnd()},group.snapToGrid=function(){this.left=(0,utils_Math/* snapToGrid */.xn)(this.left,this.cellSize),this.top=(0,utils_Math/* snapToGrid */.xn)(this.top,this.cellSize),this.setCoords()}.bind(group),group.updateProps=function(state){var textEl=this.getObjects().find((function(_ref10){var objType=_ref10.objType;return"textEl"===objType}));textEl.set("text",trimmedName(state.displayName))}.bind(group),group.setPrevCoords=function(){this.prevCoords={left:this.left,top:this.top}},group.hasPositionChanged=function(){var _this$prevCoords=this.prevCoords,left=_this$prevCoords.left,top=_this$prevCoords.top;return this.left!==left||this.top!==top},group.reInit=function(state,coords){(0,validation/* isEmpty */.xb)(coords)||this.set({left:coords.x,top:coords.y}),this.updateProps(state),this.snapToGrid()},group.toObject=function(toObject){return function(){return fabric.fabric.util.object.extend(toObject.call(this),{id:this.id,objType:this.objType,anchors:this.anchors.map((function(anchor){return String(anchor.transitionId).includes("temp")?null:anchor.transitionId}))})}}(group.toObject),group},CanvasDrawMixinvue_type_script_lang_js={methods:{drawPseudoConnector:function(mouseCoords,isExisitingTransition){this.removePseudoConnector();var src,dest,isCloserToSrc,transition,canvas=this.canvas,srcAnchor=-1,destAnchor=-1;if(isExisitingTransition){if((0,validation/* isEmpty */.xb)(this.draggedConnector))return;src=this.draggedConnectorProps.src,dest=this.draggedConnectorProps.dest,isCloserToSrc=this.draggedConnectorProps.isCloserToSrc;var freeAnchorId=this.draggedConnectorProps.freeAnchorId;isCloserToSrc?srcAnchor=(0,Common/* isValidAnchor */.c)(freeAnchorId)?freeAnchorId:-1:destAnchor=(0,Common/* isValidAnchor */.c)(freeAnchorId)?freeAnchorId:-1,transition=this.draggedConnector.transition}else{if((0,validation/* isEmpty */.xb)(this.newConnectorProps))return;var fromStateAnchor=this.newConnectorProps.fromStateAnchor;src=this.newConnectorProps.src,srcAnchor=(0,Common/* isValidAnchor */.c)(fromStateAnchor)?fromStateAnchor:-1,dest=null,isCloserToSrc=!1,transition=this.newConnector.transition}if(isCloserToSrc?src=mouseCoords:dest=mouseCoords,!(0,validation/* isEmpty */.xb)(src)&&!(0,validation/* isEmpty */.xb)(dest)){var path=this.getPathCoords(null,{point:src,anchor:srcAnchor},{point:dest,anchor:destAnchor},{isDragging:!0}),connector=makePseudoConnector("pseudo-connector",transition,path);canvas.add(connector)}canvas.requestRenderAll()},removePseudoConnector:function(){var canvas=this.canvas,existingConnector=(0,Common/* getObjById */.cU)(canvas,"pseudo-connector");canvas.remove(existingConnector),canvas.requestRenderAll()},createState:function(state,coords,anchors){var canvas=this.canvas,stateObj=makeState(state,canvas,coords,anchors);return stateObj.snapToGrid(),stateObj.setPrevCoords(),canvas.add(stateObj),stateObj},drawState:function(state,coords,anchors){var _this=this,canvas=this.canvas,createState=this.createState,moveConnectors=this.moveConnectors,handleStateMove=this.handleStateMove,handleIntersections=this.handleIntersections,handleBounds=this.handleBounds,stateObj=(0,Common/* getObjById */.cU)(canvas,state.id);stateObj?(stateObj.reInit(state,coords),canvas.requestRenderAll(),stateObj.hasPositionChanged()&&(moveConnectors(stateObj),stateObj.setPrevCoords())):(stateObj=createState(state,coords,anchors),stateObj.on("mouseover",(function(event){var target=event.target,mouseCoords=canvas.getPointer(event.e);target&&(_this.isNewConnectionMode?target.focusClosestAnchor(mouseCoords):target.onHoverStart(),canvas.requestRenderAll())})),stateObj.on("mouseout",(function(_ref){var target=_ref.target;target&&(_this.isNewConnectionMode&&target.resetAnchors(),target.onHoverEnd(),canvas.requestRenderAll())})),stateObj.on("mousedown",(function(event){var target=event.target;if(_this.isNewConnectionMode)target.isDragMode=!0,_this.onNewConnectionMouseDown(event);else{target.oldCoords=target.calcCoords();var _state=_this.availableStates.find((function(state){return state.id===target.id}));_this.setActiveObject(target),target.makeActive(),_this.editState(_state)}})),stateObj.on("mouseup",(function(event){_this.isNewConnectionMode&&(event.target.isDragMode=!1,event.target.resetAnchors(),_this.onNewConnectionMouseUp(event))})),stateObj.on("moving",(function(_ref2){var target=_ref2.target;target.snapToGrid(),target.hasPositionChanged()&&(moveConnectors(target),target.setPrevCoords())})),stateObj.on("moved",(function(_ref3){var target=_ref3.target;target.snapToGrid(),handleBounds(target),handleIntersections(target),_this.$nextTick((function(){return handleStateMove(target)}))})))},removeState:function(id){var stateObj=(0,Common/* getObjById */.cU)(this.canvas,String(id)),isInDiagram=!(0,validation/* isEmpty */.xb)(stateObj),isUsed=!(0,validation/* isEmpty */.xb)(this.usedStates.find((function(s){return String(s.id)===String(id)})));if(isInDiagram)if(isUsed)this.$refs["warning"].show();else{this.canvas.remove(stateObj);var index=this.draggedStateMap.findIndex((function(stateId){return String(id)===String(stateId)}));this.draggedStateMap.splice(index,1),this.resetEditObjects(),this.canvas.requestRenderAll()}},drawMissingStates:function(transition){var _this2=this,canvas=this.canvas,fromStateId=transition.fromStateId,toStateId=transition.toStateId,missingStates=[fromStateId,toStateId].reduce((function(acc,id){var obj=(0,Common/* getObjById */.cU)(canvas,String(id));if((0,validation/* isEmpty */.xb)(obj)){var state=_this2.availableStates.find((function(s){return String(s.id)===String(id)}));state&&acc.push()}}),[]);!(0,validation/* isEmpty */.xb)(missingStates)&&this.initStates(missingStates)},drawConnector:function(transition,coords,anchors){var _this3=this,canvas=this.canvas,editTransition=this.editTransition,onConnectorMouseDown=this.onConnectorMouseDown,onConnectorMouseUp=this.onConnectorMouseUp,showAllAnchors=this.showAllAnchors,hideAllAnchors=this.hideAllAnchors,existingConnector=(0,Common/* getObjById */.cU)(canvas,transition.id);canvas.remove(existingConnector);var connector=makeConnector(transition,coords,canvas,anchors);(0,validation/* isEmpty */.xb)(connector)||(canvas.add(connector),canvas.sendToBack(connector),canvas.requestRenderAll(),connector.on("mousedown",(function(event){event.target&&(_this3.isConnectorDragging=!0,_this3.setActiveObject(event.target),event.target.makeActive(),onConnectorMouseDown(event),editTransition(event.target.transition),showAllAnchors())})),connector.on("mouseup",(function(event){event.target&&(_this3.isConnectorDragging=!1,event.target.isDragMode&&(onConnectorMouseUp(event),hideAllAnchors()),canvas.requestRenderAll())})))}}},mixins_CanvasDrawMixinvue_type_script_lang_js=CanvasDrawMixinvue_type_script_lang_js,CanvasDrawMixin_component=(0,componentNormalizer/* default */.Z)(mixins_CanvasDrawMixinvue_type_script_lang_js,CanvasDrawMixin_render,CanvasDrawMixin_staticRenderFns,!1,null,null,null)
/* harmony default export */,CanvasDrawMixin=CanvasDrawMixin_component.exports,CanvasHistoryMixinvue_type_script_lang_js={data:function(){return{canvasStates:[],currentCanvasState:-1,skipHistoryPush:!1}},computed:{canShowUndo:function(){return this.currentCanvasState>=1},canShowRedo:function(){return this.currentCanvasState<this.canvasStates.length-1}},methods:{resetHistory:function(){this.canvasStates=[],this.currentCanvasState=-1},addToHistory:function(appendToCurrent){if(this.skipHistoryPush)this.skipHistoryPush=!1;else{var data=JSON.stringify(this.serializeCanvas());appendToCurrent||(this.currentCanvasState=this.currentCanvasState+1);var canvasStates=this.canvasStates;if(canvasStates[this.currentCanvasState]=data,canvasStates.length-1>this.currentCanvasState){var validStates=canvasStates.slice(0,this.currentCanvasState+1);this.canvasStates=validStates}}},undo:function(){this.currentCanvasState=this.currentCanvasState-1;var json=this.canvasStates[this.currentCanvasState];this.stateFlow.diagramJson=json,this.skipHistoryPush=!0,this.drawStateFlow(),this.autoSave()},redo:function(){this.currentCanvasState=this.currentCanvasState+1;var json=this.canvasStates[this.currentCanvasState];this.stateFlow.diagramJson=json,this.skipHistoryPush=!0,this.drawStateFlow(),this.autoSave()},updateDiagram:function(){var data=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,json=(0,validation/* isEmpty */.xb)(data)?JSON.stringify(this.serializeCanvas()):JSON.stringify(data);this.stateFlow.diagramJson=json}}},mixins_CanvasHistoryMixinvue_type_script_lang_js=CanvasHistoryMixinvue_type_script_lang_js,CanvasHistoryMixin_component=(0,componentNormalizer/* default */.Z)(mixins_CanvasHistoryMixinvue_type_script_lang_js,CanvasHistoryMixin_render,CanvasHistoryMixin_staticRenderFns,!1,null,null,null)
/* harmony default export */,CanvasHistoryMixin=CanvasHistoryMixin_component.exports,planner=(__webpack_require__(899211),__webpack_require__(329068),__webpack_require__(995194),__webpack_require__(36664),__webpack_require__(455980),__webpack_require__(279943),__webpack_require__(396089),__webpack_require__(718539),__webpack_require__(948690),__webpack_require__(520522),__webpack_require__(200082),__webpack_require__(345385),__webpack_require__(785552),__webpack_require__(131803),__webpack_require__(991565),__webpack_require__(367987),__webpack_require__(549365),__webpack_require__(480677),__webpack_require__(518118),__webpack_require__(41165),__webpack_require__(271522),__webpack_require__(379976),__webpack_require__(304797),__webpack_require__(207300),__webpack_require__(593356),__webpack_require__(862533),__webpack_require__(699724),__webpack_require__(724224),__webpack_require__(761121),__webpack_require__(899901),__webpack_require__(637133),__webpack_require__(241830),__webpack_require__(790343),__webpack_require__(564043),__webpack_require__(61514),__webpack_require__(732095)),planner_default=__webpack_require__.n(planner),ndarray=__webpack_require__(62861),ndarray_default=__webpack_require__.n(ndarray),chunk=(__webpack_require__(891719),__webpack_require__(8400)),chunk_default=__webpack_require__.n(chunk),sortedIndexBy=__webpack_require__(920556),sortedIndexBy_default=__webpack_require__.n(sortedIndexBy);// CONCATENATED MODULE: ./src/pages/stateflows/utils/SortedSet.js
// Sorted Set
// Set of items sorted by given value.
function SortedSet(){this.items=[],this.hash={},this.values={},this.OPEN=1,this.CLOSE=2}SortedSet.prototype.add=function(item,value){this.hash[item]?this.items.splice(this.items.indexOf(item),1):this.hash[item]=this.OPEN,this.values[item]=value;var index=sortedIndexBy_default()(this.items,item,function(i){return this.values[i]}.bind(this));this.items.splice(index,0,item)},SortedSet.prototype.remove=function(item){this.hash[item]=this.CLOSE},SortedSet.prototype.isOpen=function(item){return this.hash[item]===this.OPEN},SortedSet.prototype.isClose=function(item){return this.hash[item]===this.CLOSE},SortedSet.prototype.isEmpty=function(){return 0===this.items.length},SortedSet.prototype.pop=function(){var item=this.items.shift();return this.remove(item),item};
/* harmony default export */var utils_SortedSet=SortedSet,floor=Math.floor,ceil=Math.ceil;
/* Map of obstacles
 * Helper structure to identify whether a point lies inside an obstacle.
 *
 * Points are first scaled down by a factor of `gridUnit` and then added to
 * the hashmap during build()
 */
function ObstacleMap(opt){this.map={},this.options=opt,this.options.gridUnit=opt.gridUnit||10,
// Id of object that the user is moving around. The points of this object are not treated as obstacles
this.movingObject=null}
/* Builds a map of all elements for quicker obstacle queries.
 *
 * The canvas is divided into smaller cells, where each holds information about which
 * elements are on it. When we query whether a point lies inside an obstacle we
 * don't need to go through all obstacles, we check the cell directly.
 */ObstacleMap.prototype.build=function(canvas){var opt=this.options,gridUnit=opt.gridUnit,padding=opt.padding||10,validObjects=canvas.getObjects().filter((function(_ref){var objType=_ref.objType;return!opt.excludeTypes.includes(objType)}));return validObjects.reduce((function(map,obj){var _obj$aCoords=obj.aCoords,tl=_obj$aCoords.tl,br=_obj$aCoords.br,origin={x:floor(tl.x),y:floor(tl.y)},corner={x:floor(br.x),y:floor(br.y)};
// Round points to lower whole number
// Snap to grid but towards the lower grid point
origin={x:floor(origin.x/gridUnit)*gridUnit,y:floor(origin.y/gridUnit)*gridUnit},corner={x:ceil(corner.x/gridUnit)*gridUnit,y:ceil(corner.y/gridUnit)*gridUnit};for(
// Add a padding to ensure lines arent close to obj
var x1=origin.x-padding,x2=corner.x+padding,y1=origin.y-padding,y2=corner.y+padding,x=x1;x<=x2;x+=gridUnit)for(var y=y1;y<=y2;y+=gridUnit){var gridKey=x+"@"+y;map[gridKey]=map[gridKey]||[],map[gridKey].push(obj)}return map}),this.map),this},ObstacleMap.prototype.isPointAccessible=function(_ref2){var x=_ref2.x,y=_ref2.y,movingObject=this.movingObject,gridKey=x+"@"+y,canvasObj=this.map[gridKey],isPointMappedToMovingObject=!(0,validation/* isEmpty */.xb)(canvasObj)&&!(0,validation/* isEmpty */.xb)(movingObject)&&String(movingObject.id)===String(canvasObj.id),isPointInMovingObject=!(0,validation/* isEmpty */.xb)(movingObject)&&(0,Common/* isObjIntesecting */.gc)(movingObject,{x:x,y:y});
/* If an obj is being moved, treat it's points as empty/accessible and instead include a check
   * to find if point is inside moving object
   */
return!isPointInMovingObject&&(!!isPointMappedToMovingObject||(0,validation/* isEmpty */.xb)(canvasObj))};
/* harmony default export */var utils_ObstacleMap=ObstacleMap,config={
// size of the step to find a route (the grid of the pathfinder)
step:10,
// the number of route finding loops that cause the router to abort
// returns fallback route instead
maximumLoops:1e4,
// the number of decimal places to round floating point coordinates
precision:1,
// maximum change of direction
maxAllowedDirectionChange:90,
// should certain types of elements not be considered as obstacles?
excludeTypes:["connector"],
// possible starting directions from an element
startDirections:["top","right","bottom","left"],
// possible ending directions to an element
endDirections:["top","right","bottom","left"],
// specify the directions used above and what they mean
directionMap:{top:{x:0,y:-1},right:{x:1,y:0},bottom:{x:0,y:1},left:{x:-1,y:0}},
// cost of an orthogonal step
cost:function(){return this.step},
// an array of directions to find next points on the route
// different from start/end directions
directions:function(){var step=this.step,cost=this.cost();return[{offsetX:step,offsetY:0,cost:cost},{offsetX:0,offsetY:step,cost:cost},{offsetX:-step,offsetY:0,cost:cost},{offsetX:0,offsetY:-step,cost:cost}]},
// a penalty received for direction change
penalties:function(){return{0:0,45:this.step/2,90:this.step/2}}};
/* Calculate the minimum cost from a point to a set of endpoints
 * using manhattan distance as the hueristic
 */
function estimateCost(from,endPoints){for(var min=1/0,i=0,len=endPoints.length;i<len;i++){var cost=(0,utils_Math/* manhattanDistance */.nk)(from,endPoints[i]);cost<min&&(min=cost)}return min}function getKey(point){return point.x+"@"+point.y}
/* Helper function for getDirectionAngle()
 * corrects for grid deformation (if a point is one grid steps away from another in both dimensions,
 * it is considered to be 45 degrees away, even if the real angle is different)
 */function fixAngleEnd(start,end,opt){var step=opt.step,diffX=end.x-start.x,diffY=end.y-start.y,gridStepsX=diffX/opt.gridUnit,gridStepsY=diffY/opt.gridUnit,distanceX=gridStepsX*step,distanceY=gridStepsY*step;return{x:start.x+distanceX,y:start.y+distanceY}}
/* Returns a direction index from start point to end point
 * corrects for grid deformation between start and end
 */function getDirectionAngle(start,end,numDirections,opt){var quadrant=360/numDirections,angleTheta=(0,utils_Math/* theta */.q0)(start,fixAngleEnd(start,end,opt)),normalizedAngle=(0,utils_Math/* normalizeAngle */.LW)(angleTheta+quadrant/2);return quadrant*Math.floor(normalizedAngle/quadrant)}function reconstructRoute(parents,points,tailPoint,from,to){var point,route=[],prevDiff=(0,utils_Math/* normalizePoint */.j0)((0,utils_Math/* difference */.e5)(to,tailPoint)),currentKey=getKey(tailPoint),parent=parents[currentKey];while(parent){point=points[currentKey];var diff=(0,utils_Math/* normalizePoint */.j0)((0,utils_Math/* difference */.e5)(point,parent));(0,utils_Math/* isEqual */.Xy)(diff,prevDiff)||(route.unshift(point),prevDiff=diff),currentKey=getKey(parent),parent=parents[currentKey]}
// leadPoint is assumed to be aligned already
var leadPoint=points[currentKey],fromDiff=(0,utils_Math/* normalizePoint */.j0)((0,utils_Math/* difference */.e5)(leadPoint,from));return(0,utils_Math/* isEqual */.Xy)(fromDiff,prevDiff)||route.unshift(leadPoint),route}function findRoute(from,to){var start,end,endPoints,isDragging=arguments.length>2&&void 0!==arguments[2]&&arguments[2],opt=this.options,map=this.map,gridUnit=opt.gridUnit,maxAllowedDirectionChange=opt.maxAllowedDirectionChange,openSet=new utils_SortedSet,points={},parents={},costs={};
// set of points we start pathfinding from
start=(0,utils_Math/* snapPointToGrid */.cu)(from,gridUnit),end=to,endPoints=[end];var startPointKey=getKey(start);openSet.add(startPointKey,estimateCost(start,[end])),points[startPointKey]=start,costs[startPointKey]=0;
// We can assume path to be found if the path reaches any neighbor point of the actual
// end point. We find all neighbors of end point along all directions and add it to list of
// points
for(var direction,directionChange,previousRouteDirectionAngle=opt.previousDirectionAngle,isPathBeginning=void 0===previousRouteDirectionAngle,directions=opt.directions,numDirections=directions.length,loopsRemaining=isDragging?opt.maximumLoops/2:opt.maximumLoops,i=0// undefined for first route
;i<numDirections;i++){var _direction=directions[i],offsetedEndPoint=(0,utils_Math/* offsetPoint */.jj)((0,utils_Math/* snapPointToGrid */.cu)(end,gridUnit),_direction.offsetX,_direction.offsetY);map.isPointAccessible(offsetedEndPoint)&&endPoints.push(offsetedEndPoint)}var endPointsKeys=endPoints.map(getKey);
// main route finding loop
while(!openSet.isEmpty()&&loopsRemaining>0){
// remove current from the open list
var currentKey=openSet.pop(),currentPoint=points[currentKey],currentParent=parents[currentKey],currentCost=costs[currentKey],isRouteBeginning=void 0===currentParent,isStart=(0,utils_Math/* isEqual */.Xy)(currentPoint,start),previousDirectionAngle=void 0;
// beginning of path, source anchor or `from` point
previousDirectionAngle=isRouteBeginning?isPathBeginning?isStart?null:getDirectionAngle(start,currentPoint,numDirections,opt):previousRouteDirectionAngle:getDirectionAngle(currentParent,currentPoint,numDirections,opt);
// check if we reached any endpoint
var samePoint=(0,utils_Math/* isEqual */.Xy)(start,end),skipEndCheck=isRouteBeginning&&samePoint;if(!skipEndCheck&&endPointsKeys.includes(currentKey))return opt.previousDirectionAngle=previousDirectionAngle,reconstructRoute(parents,points,currentPoint,start,end);
// go over all possible directions and find neighbors
for(var _i=0;_i<numDirections;_i++){direction=directions[_i];var directionAngle=direction.angle;directionChange=(0,utils_Math/* getDirectionChange */._l)(previousDirectionAngle,directionAngle);
// if the direction changed rapidly, don't use this point
// any direction is allowed for starting points
var isRouteStart=!(isPathBeginning&&isStart),isDirectionChangeAllowed=directionChange<=maxAllowedDirectionChange;if(!isRouteStart||isDirectionChangeAllowed){var directionOffsetedPt=(0,utils_Math/* offsetPoint */.jj)(currentPoint,direction.offsetX,direction.offsetY),neighborPoint=(0,utils_Math/* snapPointToGrid */.cu)(directionOffsetedPt,gridUnit),neighborKey=getKey(neighborPoint),canSkipPoint=!endPointsKeys.includes(neighborKey)&&(openSet.isClose(neighborKey)||!map.isPointAccessible(neighborPoint));if(!canSkipPoint){if(endPointsKeys.includes(neighborKey)){
// If neighbor is an end point it can be entered in any direction
// If not we have to check if direction change is safe
var isNeighborEnd=(0,utils_Math/* isEqual */.Xy)(neighborPoint,end);if(!isNeighborEnd){var endDirectionAngle=getDirectionAngle(neighborPoint,end,numDirections,opt),endDirectionChange=(0,utils_Math/* getDirectionChange */._l)(directionAngle,endDirectionAngle);if(endDirectionChange>maxAllowedDirectionChange)continue}}var neighborCost=direction.cost,neighborPenalty=isStart?0:opt.penalties[directionChange],costFromStart=currentCost+neighborCost+neighborPenalty;(!openSet.isOpen(neighborKey)||costFromStart<costs[neighborKey])&&(
// If neighbor point has not been processed yet or the cost of the path
// from start is lower than previously calculated neighbor needs to be explored
points[neighborKey]=neighborPoint,parents[neighborKey]=currentPoint,costs[neighborKey]=costFromStart,openSet.add(neighborKey,costFromStart+estimateCost(neighborPoint,endPoints)))}}}loopsRemaining--}}function findBackupRoute(from,to,opt){var gridUnit=opt.gridUnit,path=[],su=function(value){return(0,utils_Math/* scaleUp */.wK)(value,gridUnit)},sd=function(value){return(0,utils_Math/* scaleDown */.uh)(value,gridUnit)},sFrom={x:sd(from.x),y:sd(from.y)},sTo={x:sd(to.x),y:sd(to.y)};return this.l1PathFinder.search(sFrom.x,sFrom.y,sTo.x,sTo.y,path),path=chunk_default()(path,2).map((function(_ref){var _ref2=(0,slicedToArray/* default */.Z)(_ref,2),x=_ref2[0],y=_ref2[1];return{x:su(x),y:su(y)}})).map((function(point,index){
// Swap starting and ending points from path with stub coords
return 0===index?from:index===path.length-1?to:point})),path}function resolveOptions(opt){return opt.directions=opt.directions(),opt.penalties=opt.penalties(),opt.directions.forEach((function(direction){var point1={x:0,y:0},point2={x:direction.offsetX,y:direction.offsetY};direction.angle=(0,utils_Math/* normalizeAngle */.LW)((0,utils_Math/* theta */.q0)(point1,point2))})),opt}function Router(canvas,opt,l1PathFinder){this.options=resolveOptions(Object.assign({},config,opt)),this.map=new utils_ObstacleMap(opt).build(canvas),this.l1PathFinder=l1PathFinder,this.findRoute=findRoute.bind(this),this.findBackupRoute=findBackupRoute.bind(this),this.search=function(from,to,_ref3){var _ref3$isDragging=_ref3.isDragging,isDragging=void 0!==_ref3$isDragging&&_ref3$isDragging,_ref3$draggedObject=_ref3.draggedObject,draggedObject=void 0===_ref3$draggedObject?null:_ref3$draggedObject;isDragging&&!(0,validation/* isEmpty */.xb)(draggedObject)&&(this.map.movingObject=draggedObject);var fromPt=from.fromPt,fromAnchor=from.fromAnchor,toPt=to.toPt,toAnchor=to.toAnchor,sourceAnchor=(0,Common/* getStubCoords */.xG)(fromPt,fromAnchor),targetAnchor=(0,Common/* getStubCoords */.xG)(toPt,toAnchor),path=this.findRoute(sourceAnchor,targetAnchor,isDragging);return this.map.movingObject=null,
// no route found (targetAnchor wasn't accessible or finding a route took too much calculation)
(0,validation/* isEmpty */.xb)(path)&&(path=this.findBackupRoute(sourceAnchor,targetAnchor,opt)),(0,Common/* smoothenPath */.I7)([fromPt].concat((0,toConsumableArray/* default */.Z)(path),[toPt]))}.bind(this)}
/* harmony default export */var PathHelperMixin_render,PathHelperMixin_staticRenderFns,AnchorMap_render,AnchorMap_staticRenderFns,PathFinding=Router,PathHelperMixinvue_type_script_lang_js={created:function(){this.maze=null,this.l1PathFinder=null,this.router=null},methods:{constructMaze:function(){var allowedCanvasPanSize=this.allowedCanvasPanSize,cellSize=this.gridUnit,h=Math.ceil(allowedCanvasPanSize/cellSize),w=Math.ceil(allowedCanvasPanSize/cellSize),maze=ndarray_default()([new Float32Array(h*w)],[h,w]);return maze},initRouter:function(){var maze=this.constructMaze();this.l1PathFinder=Object.freeze(planner_default()(maze)),this.router=new PathFinding(this.canvas,{allowedCanvasPanSize:this.allowedCanvasPanSize,gridUnit:this.gridUnit,excludeTypes:["connector"]},this.l1PathFinder)},reinitRouter:function(){this.router=new PathFinding(this.canvas,{allowedCanvasPanSize:this.allowedCanvasPanSize,gridUnit:this.gridUnit,excludeTypes:["connector"]},this.l1PathFinder)},getPathCoords:function(transition,src,dest,options){var isCycle=transition&&transition.fromStateId===transition.toStateId,_ref=options||{},_ref$isDragging=_ref.isDragging,isDragging=void 0!==_ref$isDragging&&_ref$isDragging,_ref$draggedObject=_ref.draggedObject,draggedObject=void 0===_ref$draggedObject?null:_ref$draggedObject,sourceProps={fromPt:src.point,fromAnchor:(0,Common/* isValidAnchor */.c)(src.anchor)?src.anchor:-1,fromObject:src.element||null},destProps={toPt:dest.point,toAnchor:(0,Common/* isValidAnchor */.c)(dest.anchor)?dest.anchor:-1,toObject:dest.element||null};return this.router.search(sourceProps,destProps,{isDragging:isDragging,draggedObject:draggedObject,isCycle:isCycle})}}},mixins_PathHelperMixinvue_type_script_lang_js=PathHelperMixinvue_type_script_lang_js,PathHelperMixin_component=(0,componentNormalizer/* default */.Z)(mixins_PathHelperMixinvue_type_script_lang_js,PathHelperMixin_render,PathHelperMixin_staticRenderFns,!1,null,null,null)
/* harmony default export */,PathHelperMixin=PathHelperMixin_component.exports,isString=__webpack_require__(747037),isString_default=__webpack_require__.n(isString),isInteger=__webpack_require__(593754),isInteger_default=__webpack_require__.n(isInteger),startAnchorDirectionHash={top:[7,3,4,6,5],bottom:[5,6,4,7,3],left:[7,6,0,5,1],right:[3,4,2,5,1],bottomright:[3,4,5,2],bottomleft:[7,6,5,0],topleft:[7,6,5,0],topright:[3,4,5,2]},endAnchorDirectionHash={top:[1,0,2,7,3],bottom:[7,3,5,6,4],left:[7,0,6,5,1],right:[3,2,4,1,5],bottomright:[3,4,5,2,1],bottomleft:[7,6,5,0,1],topleft:[7,0,5,6,1],topright:[3,2,4,5]},AnchorMapvue_type_script_lang_js={computed:{anchorMap:function(){var diagramJson=this.diagramJson,usedStates=this.usedStates;return(0,validation/* isEmpty */.xb)(diagramJson)?usedStates.reduce((function(anchorMap,state){return anchorMap[state.id]=[null,null,null,null,null,null,null,null],anchorMap}),{}):diagramJson.states.reduce((function(anchorMap,state){return anchorMap[state.stateId]=state.anchors,anchorMap}),{})}},methods:{isAnchorFree:function(stateId,anchorId){return(0,validation/* isEmpty */.xb)(this.anchorMap[stateId][anchorId])},setAnchor:function(state,anchorId,transitionId){var isValidAnchorId=anchorId>=0&&anchorId<8;(isString_default()(state)||isInteger_default()(state))&&(state=this.canvas.getObjects().find((function(obj){return"state"===obj.objType&&String(obj.id)===String(state)}))),!(0,validation/* isEmpty */.xb)(state)&&isValidAnchorId&&state.setAnchor(anchorId,transitionId)},updateAnchorMap:function(stateId,anchorId){var transitionId=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,diagramJson=cloneDeep_default()(this.diagramJson||{}),state=null;diagramJson.states&&(state=diagramJson.states.find((function(state){return state.stateId===stateId}))),(0,validation/* isEmpty */.xb)(state)&&(state={stateId:stateId,anchors:null},diagramJson.states=diagramJson.states||[],diagramJson.states.push(state)),state.anchors=(0,validation/* isEmpty */.xb)(state.anchors)?[null,null,null,null,null,null,null,null]:state.anchors,state.anchors[anchorId]=transitionId||null,this.diagramJson=diagramJson},clearAnchor:function(stateObj,transitionId){var anchorId=stateObj.anchors.findIndex((function(anchor){return String(anchor.transitionId)===String(transitionId)}));anchorId>=0&&anchorId<8&&(this.setAnchor(stateObj,anchorId,null),this.updateAnchorMap(stateObj.id,anchorId))},getPreferredAnchor:function(stateId,_ref){var _this=this,id=_ref.id,direction=_ref.direction,isStartAnchor=_ref.isStartAnchor;if(id&&this.isAnchorFree(stateId,id))
// If a preferred anchor is specified, check if it is empty and return it
return id;if(direction){
// Pick an anchor along the direction ie.. if 'top' is preferred we can choose either 0, 1 or 2
// if available. If not try for the anchors on sides and then fallback to whatever is empty
var anchorHash=isStartAnchor?startAnchorDirectionHash:endAnchorDirectionHash,preferredAnchors=anchorHash[direction]||[];return preferredAnchors.find((function(id){return _this.isAnchorFree(stateId,id)}))}},assignAnchor:function(stateObj,transitionId){var preferredAnchor=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},groupCoords=(0,Common/* getCenterCoords */.us)(stateObj),freeAnchorId=this.getPreferredAnchor(stateObj.id,preferredAnchor);
// Preferred anchors were not free or preference was not specified, pick whatever is available
if(!(0,Common/* isValidAnchor */.c)(freeAnchorId)){var anchorMap=this.anchorMap[stateObj.id]||[];freeAnchorId=(0,validation/* isEmpty */.xb)(anchorMap)?0:anchorMap.findIndex((function(id){return(0,validation/* isEmpty */.xb)(id)}))}
// In case anchor is not found use center pt of state obj
var anchorCoords={x:0,y:0};
// Update anchor details in map and stateObj
return(0,Common/* isValidAnchor */.c)(freeAnchorId)&&(this.setAnchor(stateObj,freeAnchorId,transitionId),this.updateAnchorMap(stateObj.id,freeAnchorId,transitionId),anchorCoords=(0,Common/* getCenterCoords */.us)(stateObj.anchors[freeAnchorId])),[(0,utils_Math/* getAbsoluteCoords */.up)(groupCoords,anchorCoords),freeAnchorId]},findAnchor:function(stateObj,transitionId){var isCyclicTransition=arguments.length>2&&void 0!==arguments[2]&&arguments[2],groupCoords=(0,Common/* getCenterCoords */.us)(stateObj),anchorCoords={x:0,y:0},anchorMap=(0,toConsumableArray/* default */.Z)(this.anchorMap[stateObj.id]||[]),anchorId=anchorMap.findIndex((function(id){return String(id)===String(transitionId)}));if(isCyclicTransition){
// To find the second anchor index since if cyclic this anchor has already been
// found during the first run
var offset=anchorMap.slice(anchorId+1).findIndex((function(id){return String(id)===String(transitionId)}));anchorId+=offset+1}return anchorId>=0&&anchorId<8&&(anchorCoords=(0,Common/* getCenterCoords */.us)(stateObj.anchors[anchorId])),[(0,utils_Math/* getAbsoluteCoords */.up)(groupCoords,anchorCoords),(0,validation/* isEmpty */.xb)(anchorId)?null:anchorId]}}},mixins_AnchorMapvue_type_script_lang_js=AnchorMapvue_type_script_lang_js,AnchorMap_component=(0,componentNormalizer/* default */.Z)(mixins_AnchorMapvue_type_script_lang_js,AnchorMap_render,AnchorMap_staticRenderFns,!1,null,null,null)
/* harmony default export */,AnchorMap=AnchorMap_component.exports,NewStateTransition=__webpack_require__(888776),NewState=__webpack_require__(243170),BuilderNotificationvue_type_template_id_7b34cd06_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.$validation.isEmpty(_vm.message)?_vm._e():_c("div",[_c("div",{staticClass:"pB10 pT10 pR15 pL5 message d-flex"},[_vm.type!==_vm.types.SAVING?_c("span",{staticClass:"pL12 pR12 pT7"},[_c("inline-svg",{attrs:{src:_vm.icon[_vm.type],iconClass:"icon icon-sm-md fill-white"}})],1):_c("span",{staticClass:"spinner pL5 pR5"},[_c("spinner",{attrs:{show:"true",size:"30",colour:"#ffffff"}})],1),_c("span",{staticClass:"mR-auto lh30"},[_vm._v(_vm._s(_vm.message))]),_c("span",{staticClass:"lh30 pL15",on:{click:function($event){return _vm.hide()}}},[_c("inline-svg",{staticClass:"pointer pL10",attrs:{src:"svgs/close",iconClass:"icon fill-white icon-xxxs"}})],1)])])},BuilderNotificationvue_type_template_id_7b34cd06_scoped_true_staticRenderFns=[],types={SUCCESS:0,ERROR:1,SAVING:2},BuilderNotificationvue_type_script_lang_js={data:function(){return{message:"",type:null,icon:["done","svgs/cancel"],types:types}},methods:{showSaving:function(data){this.message=data||"Saving",this.type=this.types.SAVING},showSuccess:function(data){var _this=this;this.message=data||"Saved",this.type=this.types.SUCCESS,setTimeout((function(){_this.hide()}),3500)},showError:function(data){var _this2=this;this.message=data||"Error Occured",this.type=this.types.ERROR,setTimeout((function(){_this2.hide()}),3500)},hide:function(){this.message="",this.type=null}}},components_BuilderNotificationvue_type_script_lang_js=BuilderNotificationvue_type_script_lang_js,BuilderNotification_component=(0,componentNormalizer/* default */.Z)(components_BuilderNotificationvue_type_script_lang_js,BuilderNotificationvue_type_template_id_7b34cd06_scoped_true_render,BuilderNotificationvue_type_template_id_7b34cd06_scoped_true_staticRenderFns,!1,null,"7b34cd06",null)
/* harmony default export */,BuilderNotification=BuilderNotification_component.exports,RemoveStateWarningvue_type_template_id_a3f2772e_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("el-dialog",{staticClass:"fieldchange-Dialog pB15 fc-dialog-center-container",attrs:{visible:_vm.canShowDialog,width:"30%",title:"Warning","custom-class":"dialog-header-padding","append-to-body":!0,"before-close":function(){_vm.canShowDialog=!1}}},[_c("div",{staticClass:"overflow-y-scroll pB40 pT10",staticStyle:{"word-break":"break-word"}},[_vm._v(" There are transitions associated to this state. "),_c("br"),_c("br"),_vm._v("Please remove all associated transitions before removing the state from the stateflow ")])])],1)},RemoveStateWarningvue_type_template_id_a3f2772e_scoped_true_staticRenderFns=[],RemoveStateWarningvue_type_script_lang_js={data:function(){return{canShowDialog:!1}},methods:{show:function(){this.canShowDialog=!0}}},components_RemoveStateWarningvue_type_script_lang_js=RemoveStateWarningvue_type_script_lang_js,RemoveStateWarning_component=(0,componentNormalizer/* default */.Z)(components_RemoveStateWarningvue_type_script_lang_js,RemoveStateWarningvue_type_template_id_a3f2772e_scoped_true_render,RemoveStateWarningvue_type_template_id_a3f2772e_scoped_true_staticRenderFns,!1,null,"a3f2772e",null)
/* harmony default export */,RemoveStateWarning=RemoveStateWarning_component.exports,StateFlowBuildervue_type_script_lang_js={name:"StateflowBuilder",title:function(){return"Edit Stateflow"},mixins:[StateFlowDataMixin,StateFlowAddEditMixin,CanvasActionsMixin/* default */.Z,CanvasPanZoomMixin/* default */.Z,CanvasDragDropMixin,CanvasHistoryMixin,PathHelperMixin,AnchorMap,CanvasDrawMixin],components:{Toolbar:BuilderToolbar,Sidebar:BuilderSidebar,NewStateTransition:NewStateTransition/* default */.Z,NewState:NewState/* default */.Z,Notification:BuilderNotification,WarningDialog:RemoveStateWarning},props:["moduleName","stateFlowId","isCustomModule"],data:function(){return{isLoading:!1,hasError:!1,isDebugMode:!1,activeObj:null}},created:function(){this.initData(),this.gridUnit=10},mounted:function(){visibilityChange(this,6e5).$on("refresh",this.initData)},beforeDestroy:function(){this.removeNativeEvents()},computed:{usedStates:function(){var states=this.availableStates,transitions=this.stateTransitions;return(0,Common/* getUsedStates */.X8)(states,transitions,this.stateFlow.defaultStateId)},unusedStates:function(){var states=this.availableStates,transitions=this.stateTransitions,detachedStatesOnCanvas=this.draggedStateMap||[],unusedStates=(0,Common/* getUnusedStates */.bg)(states,transitions,this.stateFlow.defaultStateId);return unusedStates.filter((function(state){return!detachedStatesOnCanvas.includes(state.id)}))},detachedStates:function(){var detachedStatesOnCanvas=this.draggedStateMap||[];return this.availableStates.filter((function(state){return detachedStatesOnCanvas.includes(state.id)}))},brandConfig:function(){return window.brandConfig}},methods:{initData:function(){var _this=this;this.$store.dispatch("loadTicketStatus",this.module),Promise.all([this.fetchStateFlow(),this.fetchStates(),this.fetchTransitions()]).then((function(){return _this.initCanvas()}))},initCanvas:function(){var _this2=this;this.isDebugMode&&this.logStatesAndTransitions(),// DEBUGGING ONLY
this.canvas=new fabric.fabric.Canvas(this.$refs["stateflowCanvas"],{selection:!1,defaultCursor:"grab"}),this.setInitialZoom(),this.$nextTick((function(){_this2.setupEditor(),_this2.$nextTick((function(){return _this2.registerNativeEvents()}))}))},setupEditor:function(){var _this3=this;this.setDimensions("stateflowContainer"),this.setBg().then((function(){_this3.drawStateFlow(),_this3.$nextTick((function(){_this3.resetHistory(),_this3.addToHistory(),_this3.registerEvents()}))}))},drawStateFlow:function(){var _this4=this;this.initStates([].concat((0,toConsumableArray/* default */.Z)(this.usedStates),(0,toConsumableArray/* default */.Z)(this.detachedStates))),this.initRouter(),this.$nextTick((function(){_this4.initTransitions()}))},initStates:function(){var _this5=this,states=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.isDebugMode&&(window.fabric=fabric.fabric);var diagramJson=this.diagramJson;if((0,validation/* isEmpty */.xb)(diagramJson))this.autoLayout(states);else{var anchorMap=this.anchorMap,coords=diagramJson.states.reduce((function(acc,state){return acc[state.stateId]={x:state.x,y:state.y},acc}),{});states.map((function(state){var coord=coords[state.id],anchorList=anchorMap[state.id];_this5.drawState(state,coord,anchorList)}))}},handleStateMove:function(target){this.reinitRouter();var associatedTransitions=target.anchors.reduce((function(acc,anchor){return(0,validation/* isEmpty */.xb)(anchor.transitionId)||acc.push(String(anchor.transitionId)),acc}),[]);this.initTransitions(associatedTransitions)},initTransitions:function(){var _this6=this,selectedTransitions=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],canvas=this.canvas,draw=this.drawConnector,stateTransitions=[].concat((0,toConsumableArray/* default */.Z)(this.stateTransitions),(0,toConsumableArray/* default */.Z)(this.tempTransitionList));(0,validation/* isEmpty */.xb)(selectedTransitions)||(stateTransitions=(0,toConsumableArray/* default */.Z)(stateTransitions).filter((function(t){return selectedTransitions.includes(String(t.id))}))),stateTransitions.forEach((function(transition){var isCycle=transition.fromStateId===transition.toStateId,fromStateObj=(0,Common/* getObjById */.cU)(canvas,transition.fromStateId),toStateObj=(0,Common/* getObjById */.cU)(canvas,transition.toStateId),_this6$findAnchor=_this6.findAnchor(fromStateObj,transition.id),_this6$findAnchor2=(0,slicedToArray/* default */.Z)(_this6$findAnchor,2),src=_this6$findAnchor2[0],srcAnchor=_this6$findAnchor2[1],_this6$findAnchor3=_this6.findAnchor(toStateObj,transition.id,isCycle),_this6$findAnchor4=(0,slicedToArray/* default */.Z)(_this6$findAnchor3,2),dest=_this6$findAnchor4[0],destAnchor=_this6$findAnchor4[1];if((0,validation/* isEmpty */.xb)(srcAnchor)){var _this6$assignAnchor=_this6.assignAnchor(fromStateObj,transition.id),_this6$assignAnchor2=(0,slicedToArray/* default */.Z)(_this6$assignAnchor,2),coord=_this6$assignAnchor2[0],anchorId=_this6$assignAnchor2[1];src=coord,srcAnchor=anchorId}if((0,validation/* isEmpty */.xb)(destAnchor)){var _this6$assignAnchor3=_this6.assignAnchor(toStateObj,transition.id),_this6$assignAnchor4=(0,slicedToArray/* default */.Z)(_this6$assignAnchor3,2),_coord=_this6$assignAnchor4[0],_anchorId=_this6$assignAnchor4[1];dest=_coord,destAnchor=_anchorId}var path=_this6.getPathCoords(transition,{point:src,anchor:srcAnchor,element:fromStateObj},{point:dest,anchor:destAnchor,element:toStateObj});draw(transition,path,[srcAnchor,destAnchor])}))},moveConnectors:rafThrottle_default()((function(element){var _this7=this,canvas=this.canvas,draw=this.drawConnector,transitions=this.stateTransitions,tempTransitionList=this.tempTransitionList,findAnchor=this.findAnchor,stateObjCoords=(0,Common/* getCenterCoords */.us)(element),visitedTransitions=[];element.anchors.forEach((function(anchor,index){var transitionId=anchor.transitionId;if(transitionId){if(visitedTransitions.includes(transitionId))return;// this is a cyclic transition and is already drawn
var transition,src,dest,srcAnchor,destAnchor,srcElement,destElement;visitedTransitions.push(transitionId);var connector=(0,Common/* getObjById */.cU)(canvas,transitionId);if(connector?transition=connector.transition:(transition=transitions.find((function(t){return t.id===transitionId})),(0,validation/* isEmpty */.xb)(transition)&&(transition=tempTransitionList.find((function(t){return t.id===transitionId})))),(0,validation/* isEmpty */.xb)(transition))
// Clear anchor because transition does not exist in transition list
return void _this7.$nextTick((function(){return _this7.clearAnchor(element,transitionId)}));var isCycle=transition.fromStateId===transition.toStateId;if(String(transition.fromStateId)===String(element.id)){src=(0,utils_Math/* getAbsoluteCoords */.up)(stateObjCoords,(0,Common/* getCenterCoords */.us)(anchor)),srcAnchor=index,srcElement=element;var targetEl=(0,Common/* getObjById */.cU)(canvas,transition.toStateId),_findAnchor=findAnchor(targetEl,transitionId,isCycle),_findAnchor2=(0,slicedToArray/* default */.Z)(_findAnchor,2),coord=_findAnchor2[0],anchorId=_findAnchor2[1];dest=coord,destAnchor=anchorId,destElement=element}else if(String(transition.toStateId)===String(element.id)){dest=(0,utils_Math/* getAbsoluteCoords */.up)(stateObjCoords,(0,Common/* getCenterCoords */.us)(anchor)),destAnchor=index,destElement=element;var _targetEl=(0,Common/* getObjById */.cU)(canvas,transition.fromStateId),_findAnchor3=findAnchor(_targetEl,transitionId,isCycle),_findAnchor4=(0,slicedToArray/* default */.Z)(_findAnchor3,2),_coord2=_findAnchor4[0],_anchorId2=_findAnchor4[1];src=_coord2,srcAnchor=_anchorId2,srcElement=element}if(!(0,validation/* isEmpty */.xb)(src)&&!(0,validation/* isEmpty */.xb)(dest)&&!(0,validation/* isEmpty */.xb)(srcAnchor)&&!(0,validation/* isEmpty */.xb)(destAnchor)){var path=_this7.getPathCoords(transition,{point:src,anchor:srcAnchor,element:srcElement},{point:dest,anchor:destAnchor,element:destElement},{isDragging:!0,draggedObject:element});draw(transition,path,[srcAnchor,destAnchor])}}}))})),registerEvents:function(){var _this8=this,canvas=this.canvas;canvas.on("mouse:move",(function(event){var target=event.target;if(target&&target.isDragMode)"connector"!==target.objType||_this8.isNewConnectionMode?"state"===target.objType&&_this8.isNewConnectionMode&&_this8.dragConnector(event):_this8.dragConnector(event);else if(target&&"state"===target.objType){var mouseCoords=_this8.canvas.getPointer(event.e);target.focusClosestAnchor(mouseCoords)}else(0,validation/* isEmpty */.xb)(event.target)&&_this8.isCanvasPanning&&_this8.onCanvasPan(event)})),canvas.on("mouse:down",(function(event){(0,validation/* isEmpty */.xb)(event.target)&&_this8.onCanvasPanStart(event)})),canvas.on("mouse:up",(function(event){_this8.onCanvasPanEnd(event),_this8.isConnectorDragging=!1,(0,validation/* isEmpty */.xb)(event.target)&&(_this8.removePseudoConnector(),_this8.resetSelection(),_this8.disableTransitionMode())})),canvas.on("drop",(function(event){_this8.addStateToCanvas(event)})),canvas.on("object:moving",(function(){_this8.deferAutoSave=!0})),
// Whenever any state is moved, push that to history for undo/redo
canvas.on("object:moved",(function(){_this8.deferAutoSave=!1,_this8.$nextTick((function(){_this8.addToHistory(),_this8.autoSave()}))}))},registerNativeEvents:function(){window.addEventListener("keydown",this.onKeyPress,{passive:!0}),window.addEventListener("resize",this.onWindowResize,{passive:!0}),!this.isDebugMode&&this.$refs["stateflowContainer"].addEventListener("contextmenu",(function(e){2==e.button&&e.preventDefault()}))},removeNativeEvents:function(){window.removeEventListener("keydown",this.onKeyPress),window.removeEventListener("resize",this.onWindowResize)},redirectToStateFlowList:function(){var moduleName=this.moduleName;this.$router.push({name:"stateflow.list",params:{moduleName:moduleName}})}}},stateflows_StateFlowBuildervue_type_script_lang_js=StateFlowBuildervue_type_script_lang_js,StateFlowBuilder_component=(0,componentNormalizer/* default */.Z)(stateflows_StateFlowBuildervue_type_script_lang_js,render,staticRenderFns,!1,null,"1cf27aae",null)
/* harmony default export */,StateFlowBuilder=StateFlowBuilder_component.exports},
/***/238936:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return CanvasActionsMixin}});
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js + 2 modules
var render,staticRenderFns,toConsumableArray=__webpack_require__(488478),AutoLayout=(__webpack_require__(169358),__webpack_require__(648324),__webpack_require__(450886),__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(538077),__webpack_require__(634338),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(339772),__webpack_require__(162506),__webpack_require__(670560),__webpack_require__(32996)),Common=__webpack_require__(126577),utils_Math=__webpack_require__(308530),elements_Common=__webpack_require__(144945),debounce=__webpack_require__(23279),debounce_default=__webpack_require__.n(debounce),cloneDeep=__webpack_require__(150361),cloneDeep_default=__webpack_require__.n(cloneDeep),validation=__webpack_require__(990260),CanvasActionsMixinvue_type_script_lang_js={computed:{diagramJson:{get:function(){var diagramJson=this.stateFlow.diagramJson;return diagramJson?JSON.parse(diagramJson):null},set:function(json){this.stateFlow.diagramJson=JSON.stringify(json)}}},methods:{autoLayout:function(){var _this=this,stateTransitions=this.stateTransitions,usedStates=this.usedStates,defaultStateId=this.stateFlow.defaultStateId,coords=(0,AutoLayout/* getLayout */.G)(usedStates,stateTransitions,defaultStateId);usedStates.map((function(state){return _this.drawState(state,coords[state.id])}))},beautifyAnchors:function(){var _this2=this,diagramJson=cloneDeep_default()(this.diagramJson);
// Clear existing anchors
diagramJson.states.forEach((function(s){return s.anchors=[null,null,null,null,null,null,null,null]})),this.diagramJson=diagramJson,this.$nextTick((function(){
// Assign new anchors to all transitions based on direction
var canvas=_this2.canvas,stateTransitions=[].concat((0,toConsumableArray/* default */.Z)(_this2.stateTransitions),(0,toConsumableArray/* default */.Z)(_this2.tempTransitionList)).filter((function(t){return!(0,validation/* isEmpty */.xb)(t.id)}));stateTransitions.forEach((function(transition){var fromStateObj=(0,Common/* getObjById */.cU)(canvas,transition.fromStateId),toStateObj=(0,Common/* getObjById */.cU)(canvas,transition.toStateId),fromCoords=(0,Common/* getCenterCoords */.us)(fromStateObj),toCoords=(0,Common/* getCenterCoords */.us)(toStateObj),dirForFromState=(0,utils_Math/* getCombinedDirection */._f)((0,utils_Math/* getDirectionBetweenPoints */.Dm)(fromCoords,toCoords)),anchorForFromState=_this2.getPreferredAnchor(transition.fromStateId,{direction:dirForFromState,isStartAnchor:!0});_this2.assignAnchor(fromStateObj,transition.id,{id:anchorForFromState});var dirForToState=(0,utils_Math/* getCombinedDirection */._f)((0,utils_Math/* getDirectionBetweenPoints */.Dm)(toCoords,fromCoords)),anchorForToState=_this2.getPreferredAnchor(transition.toStateId,{direction:dirForToState});_this2.assignAnchor(toStateObj,transition.id,{id:anchorForToState})}))}))},beautifyLayout:function(){var _this3=this;this.autoLayout(),this.beautifyAnchors(),this.$nextTick((function(){_this3.initTransitions(),_this3.$nextTick((function(){return _this3.addToHistory()}))}))},setBg:function(){var _this4=this;return(0,elements_Common/* makeBg */.A2)().then((function(bg){return _this4.canvas.backgroundColor=bg,_this4.canvas.renderAll()}))},setActiveObject:function(activeObject){this.activeObj&&this.activeObj.makeInActive(),this.activeObj=activeObject,this.canvas.requestRenderAll()},resetSelection:function(){var canvas=this.canvas;this.activeObj&&this.activeObj.makeInActive(),this.resetEditObjects(),canvas.discardActiveObject(),canvas.defaultCursor="grab",canvas.requestRenderAll()},showAllAnchors:function(){var _this5=this;this.canvas.getObjects().filter((function(obj){return["state"].includes(obj.objType)})).forEach((function(obj){obj.lockMovementY=!0,obj.lockMovementX=!0,obj.resetAnchors(),obj.showAnchors(),_this5.canvas.requestRenderAll()}))},hideAllAnchors:function(){var _this6=this;this.canvas.getObjects().filter((function(obj){return["state"].includes(obj.objType)})).forEach((function(obj){obj.lockMovementY=!1,obj.lockMovementX=!1,obj.resetAnchors(),obj.hideAnchors(),_this6.canvas.requestRenderAll()}))},enableTransitionMode:function(){this.isNewConnectionMode=!0,this.showAllAnchors()},disableTransitionMode:function(){this.isNewConnectionMode=!1,this.hideAllAnchors()},clearDragDrop:function(){var obj=this.canvas.getActiveObject();"connector"===obj.objType&&(obj.isDragMode=!1),this.canvas.discardActiveObject(),this.isConnectorDragging=!1,this.disableTransitionMode(),this.removePseudoConnector(),this.resetDragProps(),this.resetModifiedProps(),this.resetNewConnectorProps()},onKeyPress:function(_ref){var keyCode=_ref.keyCode,isEsc=27==keyCode;isEsc&&(this.isConnectorDragging||this.isNewConnectionMode)&&this.clearDragDrop()},onWindowResize:debounce_default()((function(){this.updateDiagram(),this.setupEditor()}),2e3),addToDiagram:function(stateId,_ref2){var x=_ref2.x,y=_ref2.y,stateObj={stateId:stateId,x:x,y:y,anchors:[null,null,null,null,null,null,null,null]},diagramJson=cloneDeep_default()(this.diagramJson||{});diagramJson.states=diagramJson.states||[];var stateMap=diagramJson.states.map((function(state){return state.stateId}));if(stateMap.includes(stateId)){var index=stateMap.findIndex((function(key){return String(key)===String(stateId)}));diagramJson.states.splice(index,1,stateObj)}else diagramJson.states.push(stateObj);this.$set(this,"diagramJson",diagramJson)},removeTempTransition:function(transitionId){var index=this.tempTransitionList.findIndex((function(t){return t===transitionId}));this.tempTransitionList.splice(index,1);var connector=(0,Common/* getObjById */.cU)(this.canvas,String(transitionId));this.canvas.remove(connector),this.canvas.requestRenderAll()},swapTempTransition:function(transition,tempTransitionId){var anchorMap=this.anchorMap,fromAnchor=(anchorMap[transition.fromStateId]||[]).findIndex((function(id){return String(id)===String(tempTransitionId)})),toAnchor=(anchorMap[transition.toStateId]||[]).findIndex((function(id){return String(id)===String(tempTransitionId)}));this.setAnchor(transition.fromStateId,fromAnchor,transition.id),this.setAnchor(transition.toStateId,toAnchor,transition.id),this.updateAnchorMap(transition.fromStateId,fromAnchor,transition.id),this.updateAnchorMap(transition.toStateId,toAnchor,transition.id),this.removeTempTransition(tempTransitionId)}}},mixins_CanvasActionsMixinvue_type_script_lang_js=CanvasActionsMixinvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(mixins_CanvasActionsMixinvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,CanvasActionsMixin=component.exports;
// EXTERNAL MODULE: ./node_modules/core-js/modules/es.object.keys.js
},
/***/289612:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return CanvasPanZoomMixin}});
// EXTERNAL MODULE: ./node_modules/core-js/modules/es.object.to-string.js
__webpack_require__(260228),__webpack_require__(947522);
// EXTERNAL MODULE: ./node_modules/core-js/modules/web.dom-collections.for-each.js
var render,staticRenderFns,validation=__webpack_require__(990260),fabric=__webpack_require__(232777),rafThrottle=__webpack_require__(474737),rafThrottle_default=__webpack_require__.n(rafThrottle),CanvasPanZoomMixinvue_type_script_lang_js={data:function(){return{currentZoomLevel:1,isCanvasPanning:!1,allowedCanvasPanSize:1800}},created:function(){this.lastPosX=null,this.lastPosY=null},computed:{formattedZoomLevel:function(){return Math.round(100*this.currentZoomLevel)}},methods:{setDimensions:function(refElement){var container=this.$refs[refElement];(0,validation/* isEmpty */.xb)(container)||(this.canvas.setHeight(container.offsetHeight),this.canvas.setWidth(container.offsetWidth),this.canvas.renderAll())},setInitialZoom:function(){var zoom=(0,validation/* isEmpty */.xb)(this.diagramJson&&this.diagramJson.zoom)?.75:this.diagramJson.zoom;this.canvas.setZoom(zoom),this.currentZoomLevel=zoom},adjustZoom:function(){var _this=this,zoomIn=arguments.length>0&&void 0!==arguments[0]&&arguments[0],delta=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.125,zoom=this.canvas.getZoom();zoomIn?zoom+=delta:zoom-=delta,zoom>1.75&&(zoom=1.75),zoom<.5&&(zoom=.5),this.canvas.setZoom(zoom),this.currentZoomLevel=zoom,this.$nextTick((function(){return _this.autoSave()}))},fitToScreen:function(){var delta=0,edgeBuffer=100,canvas=this.canvas,zoom=canvas.getZoom(),canvasH=canvas.getHeight()-edgeBuffer,canvasW=canvas.getWidth()-edgeBuffer,objs=canvas.getObjects(),g=new fabric.fabric.Group(objs),_g$getBoundingRect=g.getBoundingRect(),width=_g$getBoundingRect.width,height=_g$getBoundingRect.height;g.ungroupOnCanvas(),width*=zoom,height*=zoom;var shouldScaleDown=width>canvasW||height>canvasH,shouldScaleUp=width<canvasW&&height<canvasH;if(shouldScaleDown||shouldScaleUp){var Wx=canvasW/width,Hx=canvasH/height;delta=Wx<Hx?Wx:Hx,zoom>1.75&&(zoom=1.75),zoom<.5&&(zoom=.5),canvas.setZoom(zoom*delta),this.currentZoomLevel=zoom*delta}},onCanvasPanStart:function(_ref){var e=_ref.e;this.isCanvasPanning=!0,this.lastPosX=e.clientX,this.lastPosY=e.clientY,this.canvas.defaultCursor="grabbing",this.canvas.renderAll()},onCanvasPan:rafThrottle_default()((function(_ref2){var e=_ref2.e;
// https://stackoverflow.com/a/52504899
if(this.isCanvasPanning){var canvas=this.canvas,xOffset=e.clientX-this.lastPosX,yOffset=e.clientY-this.lastPosY,xDiffWidth=this.allowedCanvasPanSize-canvas.getWidth(),yDiffHeight=this.allowedCanvasPanSize-canvas.getHeight(),transformArray=canvas.viewportTransform,isXWithinBounds=transformArray[4]+xOffset>=-xDiffWidth&&transformArray[4]+xOffset<=0,isYWithinBounds=transformArray[5]+yOffset>=-yDiffHeight&&transformArray[5]+yOffset<=0;isXWithinBounds?(transformArray[4]+=xOffset,this.lastPosX=e.clientX,canvas.requestRenderAll()):transformArray[4]+xOffset>=-xDiffWidth&&(transformArray[4]=0,this.lastPosX=e.clientX,canvas.requestRenderAll()),isYWithinBounds?(transformArray[5]+=yOffset,this.lastPosY=e.clientY,canvas.requestRenderAll()):transformArray[5]+yOffset>=-yDiffHeight&&(transformArray[5]=0,this.lastPosY=e.clientY,canvas.requestRenderAll())}})),onCanvasPanEnd:function(){var _this2=this;this.isCanvasPanning=!1,this.canvas.getObjects().forEach((function(obj){return obj.setCoords()})),this.canvas.defaultCursor="grab",this.$nextTick((function(){return _this2.canvas.renderAll()}))}}},mixins_CanvasPanZoomMixinvue_type_script_lang_js=CanvasPanZoomMixinvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(mixins_CanvasPanZoomMixinvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,CanvasPanZoomMixin=component.exports},
/***/458095:
/***/function(module){"use strict";function Segment(start,end,direction,height){this.start=start,this.end=end,this.direction=direction,this.height=height,this.visited=!1,this.next=null,this.prev=null}function Vertex(x,y,segment,orientation){this.x=x,this.y=y,this.segment=segment,this.orientation=orientation}function getParallelCountours(array,direction){var n=array.shape[0],m=array.shape[1],contours=[],a=!1,b=!1,c=!1,d=!1,x0=0,i=0,j=0;for(j=0;j<m;++j)b=!!array.get(0,j),b!==a&&(a&&contours.push(new Segment(x0,j,direction,0)),b&&(x0=j),a=b);
//Scan center
for(a&&contours.push(new Segment(x0,j,direction,0)),i=1;i<n;++i){for(a=!1,b=!1,x0=0,j=0;j<m;++j)c=!!array.get(i-1,j),d=!!array.get(i,j),c===a&&d===b||(a!==b&&(a?contours.push(new Segment(j,x0,direction,i)):contours.push(new Segment(x0,j,direction,i))),c!==d&&(x0=j),a=c,b=d);a!==b&&(a?contours.push(new Segment(j,x0,direction,i)):contours.push(new Segment(x0,j,direction,i)))}
//Scan bottom row
for(a=!1,x0=0,j=0;j<m;++j)b=!!array.get(n-1,j),b!==a&&(a&&contours.push(new Segment(j,x0,direction,n)),b&&(x0=j),a=b);return a&&contours.push(new Segment(j,x0,direction,n)),contours}function getVertices(contours){for(var vertices=new Array(2*contours.length),i=0;i<contours.length;++i){var h=contours[i];0===h.direction?(vertices[2*i]=new Vertex(h.start,h.height,h,0),vertices[2*i+1]=new Vertex(h.end,h.height,h,1)):(vertices[2*i]=new Vertex(h.height,h.start,h,0),vertices[2*i+1]=new Vertex(h.height,h.end,h,1))}return vertices}function walk(v,clockwise){var result=[];while(!v.visited)v.visited=!0,v.direction?result.push([v.height,v.end]):result.push([v.start,v.height]),v=clockwise?v.next:v.prev;return result}function compareVertex(a,b){var d=a.x-b.x;return d||(d=a.y-b.y,d||a.orientation-b.orientation)}function getContours(array,clockwise){clockwise=!!clockwise;
//First extract horizontal contours and vertices
var hcontours=getParallelCountours(array,0),hvertices=getVertices(hcontours);hvertices.sort(compareVertex);
//Extract vertical contours and vertices
var vcontours=getParallelCountours(array.transpose(1,0),1),vvertices=getVertices(vcontours);vvertices.sort(compareVertex);
//Glue horizontal and vertical vertices together
for(var nv=hvertices.length,i=0;i<nv;++i){var h=hvertices[i],v=vvertices[i];h.orientation?(h.segment.next=v.segment,v.segment.prev=h.segment):(h.segment.prev=v.segment,v.segment.next=h.segment)}
//Unwrap loops
var loops=[];for(i=0;i<hcontours.length;++i){h=hcontours[i];h.visited||loops.push(walk(h,clockwise))}
//Return
return loops}
/***/module.exports=getContours},
/***/786239:
/***/function(module,__unused_webpack_exports,__webpack_require__){"use strict";var createThunk=__webpack_require__(865081);function Procedure(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.arrayBlockIndices=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}function compileCwise(user_args){
//Create procedure
var proc=new Procedure;
//Parse blocks
proc.pre=user_args.pre,proc.body=user_args.body,proc.post=user_args.post;
//Parse arguments
var proc_args=user_args.args.slice(0);proc.argTypes=proc_args;for(var i=0;i<proc_args.length;++i){var arg_type=proc_args[i];if("array"===arg_type||"object"===typeof arg_type&&arg_type.blockIndices){if(proc.argTypes[i]="array",proc.arrayArgs.push(i),proc.arrayBlockIndices.push(arg_type.blockIndices?arg_type.blockIndices:0),proc.shimArgs.push("array"+i),i<proc.pre.args.length&&proc.pre.args[i].count>0)throw new Error("cwise: pre() block may not reference array args");if(i<proc.post.args.length&&proc.post.args[i].count>0)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===arg_type)proc.scalarArgs.push(i),proc.shimArgs.push("scalar"+i);else if("index"===arg_type){if(proc.indexArgs.push(i),i<proc.pre.args.length&&proc.pre.args[i].count>0)throw new Error("cwise: pre() block may not reference array index");if(i<proc.body.args.length&&proc.body.args[i].lvalue)throw new Error("cwise: body() block may not write to array index");if(i<proc.post.args.length&&proc.post.args[i].count>0)throw new Error("cwise: post() block may not reference array index")}else if("shape"===arg_type){if(proc.shapeArgs.push(i),i<proc.pre.args.length&&proc.pre.args[i].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(i<proc.body.args.length&&proc.body.args[i].lvalue)throw new Error("cwise: body() block may not write to array shape");if(i<proc.post.args.length&&proc.post.args[i].lvalue)throw new Error("cwise: post() block may not write to array shape")}else{if("object"!==typeof arg_type||!arg_type.offset)throw new Error("cwise: Unknown argument type "+proc_args[i]);proc.argTypes[i]="offset",proc.offsetArgs.push({array:arg_type.array,offset:arg_type.offset}),proc.offsetArgIndex.push(i)}}
//Make sure at least one array argument was specified
if(proc.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");
//Make sure arguments are correct
if(proc.pre.args.length>proc_args.length)throw new Error("cwise: Too many arguments in pre() block");if(proc.body.args.length>proc_args.length)throw new Error("cwise: Too many arguments in body() block");if(proc.post.args.length>proc_args.length)throw new Error("cwise: Too many arguments in post() block");
//Check debug flag
return proc.debug=!!user_args.printCode||!!user_args.debug,
//Retrieve name
proc.funcName=user_args.funcName||"cwise",
//Read in block size
proc.blockSize=user_args.blockSize||64,createThunk(proc)}module.exports=compileCwise
/***/},
/***/201984:
/***/function(module,__unused_webpack_exports,__webpack_require__){"use strict";var uniq=__webpack_require__(38706);
// This function generates very simple loops analogous to how you typically traverse arrays (the outermost loop corresponds to the slowest changing index, the innermost loop to the fastest changing index)
// TODO: If two arrays have the same strides (and offsets) there is potential for decreasing the number of "pointers" and related variables. The drawback is that the type signature would become more specific and that there would thus be less potential for caching, but it might still be worth it, especially when dealing with large numbers of arguments.
function innerFill(order,proc,body){var i,j,dimension=order.length,nargs=proc.arrayArgs.length,has_index=proc.indexArgs.length>0,code=[],vars=[],idx=0,pidx=0;for(i=0;i<dimension;++i)// Iteration variables
vars.push(["i",i,"=0"].join(""));
//Compute scan deltas
for(j=0;j<nargs;++j)for(i=0;i<dimension;++i)pidx=idx,idx=order[i],0===i?// The innermost/fastest dimension's delta is simply its stride
vars.push(["d",j,"s",i,"=t",j,"p",idx].join("")):// For other dimensions the delta is basically the stride minus something which essentially "rewinds" the previous (more inner) dimension
vars.push(["d",j,"s",i,"=(t",j,"p",idx,"-s",pidx,"*t",j,"p",pidx,")"].join(""));
//Scan loop
for(vars.length>0&&code.push("var "+vars.join(",")),i=dimension-1;i>=0;--i)// Start at largest stride and work your way inwards
idx=order[i],code.push(["for(i",i,"=0;i",i,"<s",idx,";++i",i,"){"].join(""));
//Push body of inner loop
//Advance scan pointers
for(code.push(body),i=0;i<dimension;++i){for(pidx=idx,idx=order[i],j=0;j<nargs;++j)code.push(["p",j,"+=d",j,"s",i].join(""));has_index&&(i>0&&code.push(["index[",pidx,"]-=s",pidx].join("")),code.push(["++index[",idx,"]"].join(""))),code.push("}")}return code.join("\n")}
// Generate "outer" loops that loop over blocks of data, applying "inner" loops to the blocks by manipulating the local variables in such a way that the inner loop only "sees" the current block.
// TODO: If this is used, then the previous declaration (done by generateCwiseOp) of s* is essentially unnecessary.
//       I believe the s* are not used elsewhere (in particular, I don't think they're used in the pre/post parts and "shape" is defined independently), so it would be possible to make defining the s* dependent on what loop method is being used.
function outerFill(matched,order,proc,body){for(var dimension=order.length,nargs=proc.arrayArgs.length,blockSize=proc.blockSize,has_index=proc.indexArgs.length>0,code=[],i=0;i<nargs;++i)code.push(["var offset",i,"=p",i].join(""));
//Generate loops for unmatched dimensions
// The order in which these dimensions are traversed is fairly arbitrary (from small stride to large stride, for the first argument)
// TODO: It would be nice if the order in which these loops are placed would also be somehow "optimal" (at the very least we should check that it really doesn't hurt us if they're not).
for(i=matched;i<dimension;++i)code.push(["for(var j"+i+"=SS[",order[i],"]|0;j",i,">0;){"].join("")),// Iterate back to front
code.push(["if(j",i,"<",blockSize,"){"].join("")),// Either decrease j by blockSize (s = blockSize), or set it to zero (after setting s = j).
code.push(["s",order[i],"=j",i].join("")),code.push(["j",i,"=0"].join("")),code.push(["}else{s",order[i],"=",blockSize].join("")),code.push(["j",i,"-=",blockSize,"}"].join("")),has_index&&code.push(["index[",order[i],"]=j",i].join(""));for(i=0;i<nargs;++i){for(var indexStr=["offset"+i],j=matched;j<dimension;++j)indexStr.push(["j",j,"*t",i,"p",order[j]].join(""));code.push(["p",i,"=(",indexStr.join("+"),")"].join(""))}code.push(innerFill(order,proc,body));for(i=matched;i<dimension;++i)code.push("}");return code.join("\n")}
//Count the number of compatible inner orders
// This is the length of the longest common prefix of the arrays in orders.
// Each array in orders lists the dimensions of the correspond ndarray in order of increasing stride.
// This is thus the maximum number of dimensions that can be efficiently traversed by simple nested loops for all arrays.
function countMatches(orders){var matched=0,dimension=orders[0].length;while(matched<dimension){for(var j=1;j<orders.length;++j)if(orders[j][matched]!==orders[0][matched])return matched;++matched}return matched}
//Processes a block according to the given data types
// Replaces variable names by different ones, either "local" ones (that are then ferried in and out of the given array) or ones matching the arguments that the function performing the ultimate loop will accept.
function processBlock(block,proc,dtypes){for(var code=block.body,pre=[],post=[],i=0;i<block.args.length;++i){var carg=block.args[i];if(!(carg.count<=0)){var re=new RegExp(carg.name,"g"),ptrStr="",arrNum=proc.arrayArgs.indexOf(i);switch(proc.argTypes[i]){case"offset":var offArgIndex=proc.offsetArgIndex.indexOf(i),offArg=proc.offsetArgs[offArgIndex];arrNum=offArg.array,ptrStr="+q"+offArgIndex;// Adds offset to the "pointer" in the array
case"array":ptrStr="p"+arrNum+ptrStr;var localStr="l"+i,arrStr="a"+arrNum;if(0===proc.arrayBlockIndices[arrNum])// Argument to body is just a single value from this array
1===carg.count?// Argument/array used only once(?)
"generic"===dtypes[arrNum]?carg.lvalue?(pre.push(["var ",localStr,"=",arrStr,".get(",ptrStr,")"].join("")),// Is this necessary if the argument is ONLY used as an lvalue? (keep in mind that we can have a += something, so we would actually need to check carg.rvalue)
code=code.replace(re,localStr),post.push([arrStr,".set(",ptrStr,",",localStr,")"].join(""))):code=code.replace(re,[arrStr,".get(",ptrStr,")"].join("")):code=code.replace(re,[arrStr,"[",ptrStr,"]"].join("")):"generic"===dtypes[arrNum]?(pre.push(["var ",localStr,"=",arrStr,".get(",ptrStr,")"].join("")),// TODO: Could we optimize by checking for carg.rvalue?
code=code.replace(re,localStr),carg.lvalue&&post.push([arrStr,".set(",ptrStr,",",localStr,")"].join(""))):(pre.push(["var ",localStr,"=",arrStr,"[",ptrStr,"]"].join("")),// TODO: Could we optimize by checking for carg.rvalue?
code=code.replace(re,localStr),carg.lvalue&&post.push([arrStr,"[",ptrStr,"]=",localStr].join("")));else{for(// Argument to body is a "block"
var reStrArr=[carg.name],ptrStrArr=[ptrStr],j=0;j<Math.abs(proc.arrayBlockIndices[arrNum]);j++)reStrArr.push("\\s*\\[([^\\]]+)\\]"),ptrStrArr.push("$"+(j+1)+"*t"+arrNum+"b"+j);if(re=new RegExp(reStrArr.join(""),"g"),ptrStr=ptrStrArr.join("+"),"generic"===dtypes[arrNum])
/*if(carg.lvalue) {
              pre.push(["var ", localStr, "=", arrStr, ".get(", ptrStr, ")"].join("")) // Is this necessary if the argument is ONLY used as an lvalue? (keep in mind that we can have a += something, so we would actually need to check carg.rvalue)
              code = code.replace(re, localStr)
              post.push([arrStr, ".set(", ptrStr, ",", localStr,")"].join(""))
            } else {
              code = code.replace(re, [arrStr, ".get(", ptrStr, ")"].join(""))
            }*/
throw new Error("cwise: Generic arrays not supported in combination with blocks!");
// This does not produce any local variables, even if variables are used multiple times. It would be possible to do so, but it would complicate things quite a bit.
code=code.replace(re,[arrStr,"[",ptrStr,"]"].join(""))}break;case"scalar":code=code.replace(re,"Y"+proc.scalarArgs.indexOf(i));break;case"index":code=code.replace(re,"index");break;case"shape":code=code.replace(re,"shape");break}}}return[pre.join("\n"),code,post.join("\n")].join("\n").trim()}function typeSummary(dtypes){for(var summary=new Array(dtypes.length),allEqual=!0,i=0;i<dtypes.length;++i){var t=dtypes[i],digits=t.match(/\d+/);digits=digits?digits[0]:"",0===t.charAt(0)?summary[i]="u"+t.charAt(1)+digits:summary[i]=t.charAt(0)+digits,i>0&&(allEqual=allEqual&&summary[i]===summary[i-1])}return allEqual?summary[0]:summary.join("")}
//Generates a cwise operator
function generateCWiseOp(proc,typesig){for(
//Compute dimension
// Arrays get put first in typesig, and there are two entries per array (dtype and order), so this gets the number of dimensions in the first array arg.
var dimension=typesig[1].length-Math.abs(proc.arrayBlockIndices[0])|0,orders=new Array(proc.arrayArgs.length),dtypes=new Array(proc.arrayArgs.length),i=0;i<proc.arrayArgs.length;++i)dtypes[i]=typesig[2*i],orders[i]=typesig[2*i+1];
//Determine where block and loop indices start and end
var blockBegin=[],blockEnd=[],loopBegin=[],loopEnd=[],loopOrders=[];// These indices are exposed as blocks
// orders restricted to the loop indices
for(i=0;i<proc.arrayArgs.length;++i){proc.arrayBlockIndices[i]<0?(loopBegin.push(0),loopEnd.push(dimension),blockBegin.push(dimension),blockEnd.push(dimension+proc.arrayBlockIndices[i])):(loopBegin.push(proc.arrayBlockIndices[i]),// Non-negative
loopEnd.push(proc.arrayBlockIndices[i]+dimension),blockBegin.push(0),blockEnd.push(proc.arrayBlockIndices[i]));for(var newOrder=[],j=0;j<orders[i].length;j++)loopBegin[i]<=orders[i][j]&&orders[i][j]<loopEnd[i]&&newOrder.push(orders[i][j]-loopBegin[i]);loopOrders.push(newOrder)}
//First create arguments for procedure
var arglist=["SS"],code=["'use strict'"],vars=[];// SS is the overall shape over which we iterate
for(j=0;j<dimension;++j)vars.push(["s",j,"=SS[",j,"]"].join(""));// The limits for each dimension.
for(i=0;i<proc.arrayArgs.length;++i){arglist.push("a"+i),// Actual data array
arglist.push("t"+i),// Strides
arglist.push("p"+i);// Offset in the array at which the data starts (also used for iterating over the data)
for(j=0;j<dimension;++j)// Unpack the strides into vars for looping
vars.push(["t",i,"p",j,"=t",i,"[",loopBegin[i]+j,"]"].join(""));for(j=0;j<Math.abs(proc.arrayBlockIndices[i]);++j)// Unpack the strides into vars for block iteration
vars.push(["t",i,"b",j,"=t",i,"[",blockBegin[i]+j,"]"].join(""))}for(i=0;i<proc.scalarArgs.length;++i)arglist.push("Y"+i);if(proc.shapeArgs.length>0&&vars.push("shape=SS.slice(0)"),proc.indexArgs.length>0){
// Prepare an array to keep track of the (logical) indices, initialized to dimension zeroes.
var zeros=new Array(dimension);for(i=0;i<dimension;++i)zeros[i]="0";vars.push(["index=[",zeros.join(","),"]"].join(""))}for(i=0;i<proc.offsetArgs.length;++i){// Offset arguments used for stencil operations
var off_arg=proc.offsetArgs[i],init_string=[];for(j=0;j<off_arg.offset.length;++j)0!==off_arg.offset[j]&&(1===off_arg.offset[j]?init_string.push(["t",off_arg.array,"p",j].join("")):init_string.push([off_arg.offset[j],"*t",off_arg.array,"p",j].join("")));0===init_string.length?vars.push("q"+i+"=0"):vars.push(["q",i,"=",init_string.join("+")].join(""))}
//Prepare this variables
var thisVars=uniq([].concat(proc.pre.thisVars).concat(proc.body.thisVars).concat(proc.post.thisVars));vars=vars.concat(thisVars),vars.length>0&&code.push("var "+vars.join(","));for(i=0;i<proc.arrayArgs.length;++i)code.push("p"+i+"|=0");
//Inline prelude
proc.pre.body.length>3&&code.push(processBlock(proc.pre,proc,dtypes));
//Process body
var body=processBlock(proc.body,proc,dtypes),matched=countMatches(loopOrders);matched<dimension?code.push(outerFill(matched,loopOrders[0],proc,body)):code.push(innerFill(loopOrders[0],proc,body)),
//Inline epilog
proc.post.body.length>3&&code.push(processBlock(proc.post,proc,dtypes)),proc.debug;var loopName=[proc.funcName||"unnamed","_cwise_loop_",orders[0].join("s"),"m",matched,typeSummary(dtypes)].join(""),f=new Function(["function ",loopName,"(",arglist.join(","),"){",code.join("\n"),"} return ",loopName].join(""));return f()}module.exports=generateCWiseOp
/***/},
/***/865081:
/***/function(module,__unused_webpack_exports,__webpack_require__){"use strict";
// The function below is called when constructing a cwise function object, and does the following:
// A function object is constructed which accepts as argument a compilation function and returns another function.
// It is this other function that is eventually returned by createThunk, and this function is the one that actually
// checks whether a certain pattern of arguments has already been used before and compiles new loops as needed.
// The compilation passed to the first function object is used for compiling new functions.
// Once this function object is created, it is called with compile as argument, where the first argument of compile
// is bound to "proc" (essentially containing a preprocessed version of the user arguments to cwise).
// So createThunk roughly works like this:
// function createThunk(proc) {
//   var thunk = function(compileBound) {
//     var CACHED = {}
//     return function(arrays and scalars) {
//       if (dtype and order of arrays in CACHED) {
//         var func = CACHED[dtype and order of arrays]
//       } else {
//         var func = CACHED[dtype and order of arrays] = compileBound(dtype and order of arrays)
//       }
//       return func(arrays and scalars)
//     }
//   }
//   return thunk(compile.bind1(proc))
// }
var compile=__webpack_require__(201984);function createThunk(proc){var code=["'use strict'","var CACHED={}"],vars=[],thunkName=proc.funcName+"_cwise_thunk";
//Build thunk
code.push(["return function ",thunkName,"(",proc.shimArgs.join(","),"){"].join(""));
// Process array arguments
for(var typesig=[],string_typesig=[],proc_args=[["array",proc.arrayArgs[0],".shape.slice(",// Slice shape so that we only retain the shape over which we iterate (which gets passed to the cwise operator as SS).
Math.max(0,proc.arrayBlockIndices[0]),proc.arrayBlockIndices[0]<0?","+proc.arrayBlockIndices[0]+")":")"].join("")],shapeLengthConditions=[],shapeConditions=[],i=0;i<proc.arrayArgs.length;++i){var j=proc.arrayArgs[i];vars.push(["t",j,"=array",j,".dtype,","r",j,"=array",j,".order"].join("")),typesig.push("t"+j),typesig.push("r"+j),string_typesig.push("t"+j),string_typesig.push("r"+j+".join()"),proc_args.push("array"+j+".data"),proc_args.push("array"+j+".stride"),proc_args.push("array"+j+".offset|0"),i>0&&(// Gather conditions to check for shape equality (ignoring block indices)
shapeLengthConditions.push("array"+proc.arrayArgs[0]+".shape.length===array"+j+".shape.length+"+(Math.abs(proc.arrayBlockIndices[0])-Math.abs(proc.arrayBlockIndices[i]))),shapeConditions.push("array"+proc.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,proc.arrayBlockIndices[0])+"]===array"+j+".shape[shapeIndex+"+Math.max(0,proc.arrayBlockIndices[i])+"]"))}
// Check for shape equality
proc.arrayArgs.length>1&&(code.push("if (!("+shapeLengthConditions.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),code.push("for(var shapeIndex=array"+proc.arrayArgs[0]+".shape.length-"+Math.abs(proc.arrayBlockIndices[0])+"; shapeIndex--\x3e0;) {"),code.push("if (!("+shapeConditions.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),code.push("}"));
// Process scalar arguments
for(i=0;i<proc.scalarArgs.length;++i)proc_args.push("scalar"+proc.scalarArgs[i]);
// Check for cached function (and if not present, generate it)
vars.push(["type=[",string_typesig.join(","),"].join()"].join("")),vars.push("proc=CACHED[type]"),code.push("var "+vars.join(",")),code.push(["if(!proc){","CACHED[type]=proc=compile([",typesig.join(","),"])}","return proc(",proc_args.join(","),")}"].join("")),proc.debug;
//Compile thunk
var thunk=new Function("compile",code.join("\n"));return thunk(compile.bind(void 0,proc))}module.exports=createThunk
/***/},
/***/716907:
/***/function(module){"use strict";function iota(n){for(var result=new Array(n),i=0;i<n;++i)result[i]=i;return result}module.exports=iota
/***/},
/***/848738:
/***/function(module){function isBuffer(obj){return!!obj.constructor&&"function"===typeof obj.constructor.isBuffer&&obj.constructor.isBuffer(obj)}
// For Node v0.10 support. Remove this eventually.
function isSlowBuffer(obj){return"function"===typeof obj.readFloatLE&&"function"===typeof obj.slice&&isBuffer(obj.slice(0,0))}
/***/
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
// The _isBuffer check is for Safari 5-7 support, because it's missing
// Object.prototype.constructor. Remove this eventually
module.exports=function(obj){return null!=obj&&(isBuffer(obj)||isSlowBuffer(obj)||!!obj._isBuffer)}},
/***/156973:
/***/function(module,__unused_webpack_exports,__webpack_require__){"use strict";var ndarray=__webpack_require__(62861),uniq=__webpack_require__(38706),ops=__webpack_require__(238897),prefixSum=__webpack_require__(334644),getContour=__webpack_require__(458095),orient=__webpack_require__(450146)[3];function Geometry(corners,grid){this.corners=corners,this.grid=grid}module.exports=createGeometry;var proto=Geometry.prototype;function comparePair(a,b){var d=a[0]-b[0];return d||a[1]-b[1]}function createGeometry(grid){for(var loops=getContour(grid.transpose(1,0)),corners=[],k=0
//Extract corners
;k<loops.length;++k)for(var polygon=loops[k],i=0;i<polygon.length;++i){var a=polygon[(i+polygon.length-1)%polygon.length],b=polygon[i],c=polygon[(i+1)%polygon.length];if(orient(a,b,c)>0){for(var offset=[0,0],j=0;j<2;++j)b[j]-a[j]?offset[j]=b[j]-a[j]:offset[j]=b[j]-c[j],offset[j]=b[j]+Math.min(0|Math.round(offset[j]/Math.abs(offset[j])),0);offset[0]>=0&&offset[0]<grid.shape[0]&&offset[1]>=0&&offset[1]<grid.shape[1]&&0===grid.get(offset[0],offset[1])&&corners.push(offset)}}
//Remove duplicate corners
uniq(corners,comparePair);
//Create integral image
var img=ndarray(new Int32Array(grid.shape[0]*grid.shape[1]),grid.shape);
//Return resulting geometry
return ops.gts(img,grid,0),prefixSum(img),new Geometry(corners,img)}
/***/proto.stabRay=function(vx,vy,x){return this.stabBox(vx,vy,x,vy)},proto.stabTile=function(x,y){return this.stabBox(x,y,x,y)},proto.integrate=function(x,y){return x<0||y<0?0:this.grid.get(0|Math.min(x,this.grid.shape[0]-1),0|Math.min(y,this.grid.shape[1]-1))},proto.stabBox=function(ax,ay,bx,by){var lox=Math.min(ax,bx),loy=Math.min(ay,by),hix=Math.max(ax,bx),hiy=Math.max(ay,by),s=this.integrate(lox-1,loy-1)-this.integrate(lox-1,hiy)-this.integrate(hix,loy-1)+this.integrate(hix,hiy);return s>0}},
/***/825446:
/***/function(module,__unused_webpack_exports,__webpack_require__){"use strict";module.exports=Graph;var vtx=__webpack_require__(893037),NIL=vtx.NIL,NUM_LANDMARKS=vtx.NUM_LANDMARKS,LANDMARK_DIST=vtx.LANDMARK_DIST;function heuristic(tdist,tx,ty,node){for(var nx=+node.x,ny=+node.y,pi=Math.abs(nx-tx)+Math.abs(ny-ty),ndist=node.landmark,i=0;i<NUM_LANDMARKS;++i)pi=Math.max(pi,tdist[i]-ndist[i]);return 1.0000009536743164*pi}function Graph(){this.target=vtx.create(0,0),this.verts=[],this.freeList=this.target,this.toVisit=NIL,this.lastS=null,this.lastT=null,this.srcX=0,this.srcY=0,this.dstX=0,this.dstY=0,this.landmarks=[],this.landmarkDist=LANDMARK_DIST.slice()}var proto=Graph.prototype;
//Find all landmarks
function compareVert(a,b){var d=a.x-b.x;return d||a.y-b.y}
//For each connected component compute a set of landmarks
proto.vertex=function(x,y){var v=vtx.create(x,y);return this.verts.push(v),v},proto.link=function(u,v){vtx.link(u,v)},proto.setSourceAndTarget=function(sx,sy,tx,ty){this.srcX=0|sx,this.srcY=0|sy,this.dstX=0|tx,this.dstY=0|ty}
//Mark vertex connected to source
,proto.addS=function(v){0===(2&v.state)&&(v.heuristic=heuristic(this.landmarkDist,this.dstX,this.dstY,v),v.weight=Math.abs(this.srcX-v.x)+Math.abs(this.srcY-v.y)+v.heuristic,v.state|=2,v.pred=null,this.toVisit=vtx.push(this.toVisit,v),this.freeList=vtx.insert(this.freeList,v),this.lastS=v)}
//Mark vertex connected to target
,proto.addT=function(v){if(0===(1&v.state)){v.state|=1,this.freeList=vtx.insert(this.freeList,v),this.lastT=v;for(
//Update heuristic
var d=Math.abs(v.x-this.dstX)+Math.abs(v.y-this.dstY),vdist=v.landmark,tdist=this.landmarkDist,i=0;i<NUM_LANDMARKS;++i)tdist[i]=Math.min(tdist[i],vdist[i]+d)}}
//Retrieves the path from dst->src
,proto.getPath=function(out){var prevX=this.dstX,prevY=this.dstY;out.push(prevX,prevY);var head=this.target.pred;while(head)prevX!==head.x&&prevY!==head.y&&out.push(head.x,prevY),prevX===head.x&&prevY===head.y||out.push(head.x,head.y),prevX=head.x,prevY=head.y,head=head.pred;return prevX!==this.srcX&&prevY!==this.srcY&&out.push(this.srcX,prevY),prevX===this.srcX&&prevY===this.srcY||out.push(this.srcX,this.srcY),out},proto.findComponents=function(){for(var verts=this.verts,n=verts.length,i=0;i<n;++i)verts[i].component=-1;var components=[];for(i=0;i<n;++i){var root=verts[i];if(!(root.component>=0)){var label=components.length;root.component=label;var toVisit=[root],ptr=0;while(ptr<toVisit.length)for(var v=toVisit[ptr++],adj=v.edges,j=0;j<adj.length;++j){var u=adj[j];u.component>=0||(u.component=label,toVisit.push(u))}components.push(toVisit)}}return components},proto.findLandmarks=function(component){component.sort(compareVert);for(var v=component[component.length>>>1],k=0;k<NUM_LANDMARKS;++k){v.weight=0,this.landmarks.push(v);for(var toVisit=v;toVisit!==NIL;){v=toVisit,v.state=2,toVisit=vtx.pop(toVisit);for(var w=v.weight,adj=v.edges,i=0;i<adj.length;++i){var u=adj[i];if(2!==u.state){var d=w+Math.abs(v.x-u.x)+Math.abs(v.y-u.y);0===u.state?(u.state=1,u.weight=d,toVisit=vtx.push(toVisit,u)):d<u.weight&&(u.weight=d,toVisit=vtx.decreaseKey(toVisit,u))}}}var farthestD=0;for(i=0;i<component.length;++i){u=component[i];u.state=0,u.landmark[k]=u.weight;for(var s=1/0,j=0;j<=k;++j)s=Math.min(s,u.landmark[j]);s>farthestD&&(v=u,farthestD=s)}}},proto.init=function(){for(var components=this.findComponents(),i=0;i<components.length;++i)this.findLandmarks(components[i])}
//Runs a* on the graph
,proto.search=function(){var target=this.target,freeList=this.freeList,tdist=this.landmarkDist,dist=1/0;
//Test for case where S and T are disconnected
if(this.lastS&&this.lastT&&this.lastS.component===this.lastT.component){this.srcX,this.srcY;for(var tx=+this.dstX,ty=+this.dstY,toVisit=this.toVisit;toVisit!==NIL;){var node=toVisit,nx=+node.x,ny=+node.y,d=Math.floor(node.weight-node.heuristic);if(3===node.state){
//If node is connected to target, exit
dist=d+Math.abs(tx-nx)+Math.abs(ty-ny),target.pred=node;break}
//Mark node closed
node.state=4,
//Pop node from toVisit queue
toVisit=vtx.pop(toVisit);for(var adj=node.edges,n=adj.length,i=0;i<n;++i){var v=adj[i],state=v.state;if(4!==state){var vd=d+Math.abs(nx-v.x)+Math.abs(ny-v.y);if(state<2){var vh=heuristic(tdist,tx,ty,v);v.state|=2,v.heuristic=vh,v.weight=vh+vd,v.pred=node,toVisit=vtx.push(toVisit,v),freeList=vtx.insert(freeList,v)}else{var vw=vd+v.heuristic;vw<v.weight&&(v.weight=vw,v.pred=node,toVisit=vtx.decreaseKey(toVisit,v))}}}}}
//Clear the free list & priority queue
vtx.clear(freeList),
//Reset pointers
this.freeList=target,this.toVisit=NIL,this.lastS=this.lastT=null;
//Reset landmark distance
for(i=0;i<NUM_LANDMARKS;++i)tdist[i]=1/0;
//Return target distance
return dist}
/***/},
/***/732095:
/***/function(module,__unused_webpack_exports,__webpack_require__){"use strict";var bsearch=__webpack_require__(573076),createGeometry=__webpack_require__(156973),Graph=__webpack_require__(825446),LEAF_CUTOFF=64,BUCKET_SIZE=32;function Leaf(verts){this.verts=verts,this.leaf=!0}function Bucket(y0,y1,top,bottom,left,right,on){this.y0=y0,this.y1=y1,this.top=top,this.bottom=bottom,this.left=left,this.right=right,this.on=on}function Node(x,buckets,left,right){this.x=x,this.buckets=buckets,this.left=left,this.right=right}function L1PathPlanner(geometry,graph,root){this.geometry=geometry,this.graph=graph,this.root=root}module.exports=createPlanner;var proto=L1PathPlanner.prototype;function compareBucket(bucket,y){return bucket.y0-y}function connectList(nodes,geom,graph,target,x,y){for(var i=0;i<nodes.length;++i){var v=nodes[i];geom.stabBox(v.x,v.y,x,y)||(target?graph.addT(v):graph.addS(v))}}function connectNodes(geom,graph,node,target,x,y){
//Mark target nodes
while(node){
//Check leaf case
if(node.leaf){for(var vv=node.verts,nn=vv.length,i=0;i<nn;++i){var v=vv[i];geom.stabBox(v.x,v.y,x,y)||(target?graph.addT(v):graph.addS(v))}break}
//Otherwise, glue into buckets
var buckets=node.buckets,idx=bsearch.lt(buckets,y,compareBucket);if(idx>=0){var bb=buckets[idx];if(y<bb.y1)
//Common case:
node.x>=x&&
//Connect right
connectList(bb.right,geom,graph,target,x,y),node.x<=x&&
//Connect left
connectList(bb.left,geom,graph,target,x,y),
//Connect on
connectList(bb.on,geom,graph,target,x,y);else{
//Connect to bottom of bucket above
v=buckets[idx].bottom;
//Connect to top of bucket below
if(v&&!geom.stabBox(v.x,v.y,x,y)&&(target?graph.addT(v):graph.addS(v)),idx+1<buckets.length){v=buckets[idx+1].top;v&&!geom.stabBox(v.x,v.y,x,y)&&(target?graph.addT(v):graph.addS(v))}}}else{
//Connect to top of box
v=buckets[0].top;v&&!geom.stabBox(v.x,v.y,x,y)&&(target?graph.addT(v):graph.addS(v))}if(node.x>x)node=node.left;else{if(!(node.x<x))break;node=node.right}}}function comparePair(a,b){var d=a[1]-b[1];return d||a[0]-b[0]}function makePartition(x,corners,geom,edges){
//Intersect rays along x horizontal line
for(var left=[],right=[],on=[],i=0;i<corners.length;++i){var c=corners[i];geom.stabRay(c[0],c[1],x)||on.push(c),c[0]<x?left.push(c):c[0]>x&&right.push(c)}
//Sort on events by y then x
on.sort(comparePair);
//Construct vertices and horizontal edges
var vis=[],rem=[];for(i=0;i<on.length;){var l=x,r=x,v=on[i],y=v[1];while(i<on.length&&on[i][1]===y&&on[i][0]<x)l=on[i++][0];l<x&&vis.push([l,y]);while(i<on.length&&on[i][1]===y&&on[i][0]===x)rem.push(on[i]),vis.push(on[i]),++i;if(i<on.length&&on[i][1]===y){r=on[i++][0];while(i<on.length&&on[i][1]===y)++i}r>x&&vis.push([r,y])}return{x:x,left:left,right:right,on:rem,vis:vis}}function createPlanner(grid){var geom=createGeometry(grid),graph=new Graph,verts={},edges=[];function makeVertex(pair){if(!pair)return null;var res=verts[pair];return res||(verts[pair]=graph.vertex(pair[0],pair[1]))}function makeLeaf(corners,x0,x1){for(var localVerts=[],i=0;i<corners.length;++i){var u=corners[i],ux=graph.vertex(u[0],u[1]);localVerts.push(ux),verts[u]=ux;for(var j=0;j<i;++j){var v=corners[j];geom.stabBox(u[0],u[1],v[0],v[1])||edges.push([u,v])}}return new Leaf(localVerts)}function makeBucket(corners,x){for(
//Split visible corners into 3 cases
var left=[],right=[],on=[],i=0;i<corners.length;++i)corners[i][0]<x?left.push(corners[i]):corners[i][0]>x?right.push(corners[i]):on.push(corners[i]);
//Add Steiner vertices if needed
function addSteiner(y,first){if(!geom.stabTile(x,y)){for(var i=0;i<on.length;++i)if(on[i][0]===x&&on[i][1]===y)return on[i];var pair=[x,y];return first?on.unshift(pair):on.push(pair),verts[pair]||(verts[pair]=graph.vertex(x,y)),pair}return null}var y0=corners[0][1],y1=corners[corners.length-1][1],loSteiner=addSteiner(y0,!0),hiSteiner=addSteiner(y1,!1);function bipartite(a,b){for(var i=0;i<a.length;++i)for(var u=a[i],j=0;j<b.length;++j){var v=b[j];geom.stabBox(u[0],u[1],v[0],v[1])||edges.push([u,v])}}bipartite(left,right),bipartite(on,left),bipartite(on,right);
//Connect vertical edges
for(i=1;i<on.length;++i){var u=on[i-1],v=on[i];geom.stabBox(u[0],u[1],v[0],v[1])||edges.push([u,v])}return{left:left,right:right,on:on,steiner0:loSteiner,steiner1:hiSteiner,y0:y0,y1:y1}}
//Make tree
function makeTree(corners,x0,x1){if(0===corners.length)return null;if(corners.length<LEAF_CUTOFF)return makeLeaf(corners,x0,x1);
//Construct vertices
for(var x=corners[corners.length>>>1][0],partition=makePartition(x,corners,geom,edges),left=makeTree(partition.left,x0,x),right=makeTree(partition.right,x,x1),i=0;i<partition.on.length;++i)verts[partition.on[i]]=graph.vertex(partition.on[i][0],partition.on[i][1]);
//Build buckets
var vis=partition.vis,buckets=[],lastSteiner=null;for(i=0;i<vis.length;){var v0=i,v1=Math.min(i+BUCKET_SIZE-1,vis.length-1);while(++v1<vis.length&&vis[v1-1][1]===vis[v1][1]);i=v1;var bb=makeBucket(vis.slice(v0,v1),x);lastSteiner&&bb.steiner0&&!geom.stabBox(lastSteiner[0],lastSteiner[1],bb.steiner0[0],bb.steiner0[1])&&edges.push([lastSteiner,bb.steiner0]),lastSteiner=bb.steiner1,buckets.push(new Bucket(bb.y0,bb.y1,makeVertex(bb.steiner0),makeVertex(bb.steiner1),bb.left.map(makeVertex),bb.right.map(makeVertex),bb.on.map(makeVertex)))}return new Node(x,buckets,left,right)}
//Link edges
for(var root=makeTree(geom.corners,-1/0,1/0),i=0;i<edges.length;++i)graph.link(verts[edges[i][0]],verts[edges[i][1]]);
//Initialized graph
//Return resulting tree
return graph.init(),new L1PathPlanner(geom,graph,root)}
/***/proto.search=function(tx,ty,sx,sy,out){var geom=this.geometry;
//Degenerate case:  s and t are equal
if(tx===sx&&ty===sy)return geom.stabBox(tx,ty,sx,sy)?1/0:(out&&out.push(sx,sy),0);
//Check easy case - s and t directly connected
if(!geom.stabBox(tx,ty,sx,sy))return out&&(sx!==tx&&sy!==ty?out.push(tx,ty,sx,ty,sx,sy):out.push(tx,ty,sx,sy)),Math.abs(tx-sx)+Math.abs(ty-sy);
//Prepare graph
var graph=this.graph;graph.setSourceAndTarget(sx,sy,tx,ty),
//Mark target
connectNodes(geom,graph,this.root,!0,tx,ty),
//Mark source
connectNodes(geom,graph,this.root,!1,sx,sy);
//Run A*
var dist=graph.search();
//Recover path
return out&&dist<1/0&&graph.getPath(out),dist}},
/***/893037:
/***/function(__unused_webpack_module,exports){"use strict";var NUM_LANDMARKS=16,LANDMARK_DIST=function(){for(var res=new Array(NUM_LANDMARKS),count=0;count<NUM_LANDMARKS;++count)res[count]=1/0;return res}();
//Vertices have to do multiple things
//  1.  They store the topology of the graph which is gonna get searched
//  2.  They implement the pairing heap data sturcture (intrusively)
//  3.  They implement a linked list for tracking clean up
//  4.  Track search information (keep track of predecessors, distances, open state)
function Vertex(x,y){
//User data
this.x=x,this.y=y,
//Priority queue info
this.heuristic=.25,this.weight=.25,this.left=null,this.right=null,this.parent=null,
//Visit tags
this.state=0,this.pred=null,
//Free list
this.nextFree=null,
//Adjacency info
this.edges=[],
//Landmark data
this.landmark=LANDMARK_DIST.slice(),
//Connected component label
this.component=0}
//Sentinel node
var NIL=new Vertex(1/0,1/0);
//Heap insertion
function link(a,b){var al=a.left;return b.right=al,al.parent=b,b.parent=a,a.left=b,a.right=NIL,a}function merge(a,b){return a===NIL?b:b===NIL?a:a.weight<b.weight?link(a,b):link(b,a)}function heapPush(root,node){if(root===NIL)return node;if(root.weight<node.weight){var l=root.left;return node.right=l,l.parent=node,node.parent=root,root.left=node,root}l=node.left;return root.right=l,l.parent=root,root.parent=node,node.left=root,node}function takeMin(root){var p=root.left;root.left=NIL,root=p;while(1){var q=root.right;if(q===NIL)break;p=root;var r=q.right,s=merge(p,q);root=s;while(1){if(p=r,q=r.right,q===NIL)break;r=q.right,s=s.right=merge(p,q)}s.right=NIL,p!==NIL&&(p.right=root,root=p)}return root.parent=NIL,root}function decreaseKey(root,p){var q=p.parent;if(q.weight<p.weight)return root;var r=p.right;if(r.parent=q,q.left===p?q.left=r:q.right=r,root.weight<=p.weight){var l=root.left;return l.parent=p,p.right=l,root.left=p,p.parent=root,root}l=p.left;return root.right=l,l.parent=root,p.left=root,root.parent=p,p.right=p.parent=NIL,p}
//Topology
function createVertex(x,y){var result=new Vertex(x,y);return result.left=result.right=result.parent=NIL,result}function addEdge(u,v){u.edges.push(v),v.edges.push(u)}
//Free list functions
function pushList(list,node){return node.nextFree?list:(node.nextFree=list,node)}function clearList(v){while(v){var next=v.nextFree;v.state=0,v.left=v.right=v.parent=NIL,v.nextFree=null,v=next}}
//Graph topology
NIL.weight=-1/0,NIL.left=NIL.right=NIL.parent=NIL,exports.create=createVertex,exports.link=addEdge,
//Free list management
exports.insert=pushList,exports.clear=clearList,
//Heap operations
exports.NIL=NIL,exports.push=heapPush,exports.pop=takeMin,exports.decreaseKey=decreaseKey,
//Landmark info
exports.NUM_LANDMARKS=NUM_LANDMARKS,exports.LANDMARK_DIST=LANDMARK_DIST
/***/},
/***/287226:
/***/function(module,__unused_webpack_exports,__webpack_require__){var isSymbol=__webpack_require__(733448),MAX_ARRAY_LENGTH=4294967295,MAX_ARRAY_INDEX=MAX_ARRAY_LENGTH-1,nativeFloor=Math.floor,nativeMin=Math.min;
/** Used as references for the maximum length and index of an array. */
/**
 * The base implementation of `_.sortedIndexBy` and `_.sortedLastIndexBy`
 * which invokes `iteratee` for `value` and each element of `array` to compute
 * their sort ranking. The iteratee is invoked with one argument; (value).
 *
 * @private
 * @param {Array} array The sorted array to inspect.
 * @param {*} value The value to evaluate.
 * @param {Function} iteratee The iteratee invoked per element.
 * @param {boolean} [retHighest] Specify returning the highest qualified index.
 * @returns {number} Returns the index at which `value` should be inserted
 *  into `array`.
 */
function baseSortedIndexBy(array,value,iteratee,retHighest){var low=0,high=null==array?0:array.length;if(0===high)return 0;value=iteratee(value);var valIsNaN=value!==value,valIsNull=null===value,valIsSymbol=isSymbol(value),valIsUndefined=void 0===value;while(low<high){var mid=nativeFloor((low+high)/2),computed=iteratee(array[mid]),othIsDefined=void 0!==computed,othIsNull=null===computed,othIsReflexive=computed===computed,othIsSymbol=isSymbol(computed);if(valIsNaN)var setLow=retHighest||othIsReflexive;else setLow=valIsUndefined?othIsReflexive&&(retHighest||othIsDefined):valIsNull?othIsReflexive&&othIsDefined&&(retHighest||!othIsNull):valIsSymbol?othIsReflexive&&othIsDefined&&!othIsNull&&(retHighest||!othIsSymbol):!othIsNull&&!othIsSymbol&&(retHighest?computed<=value:computed<value);setLow?low=mid+1:high=mid}return nativeMin(high,MAX_ARRAY_INDEX)}module.exports=baseSortedIndexBy},
/***/8400:
/***/function(module,__unused_webpack_exports,__webpack_require__){var baseSlice=__webpack_require__(314259),isIterateeCall=__webpack_require__(816612),toInteger=__webpack_require__(640554),nativeCeil=Math.ceil,nativeMax=Math.max;
/* Built-in method references for those with the same name as other `lodash` methods. */
/**
 * Creates an array of elements split into groups the length of `size`.
 * If `array` can't be split evenly, the final chunk will be the remaining
 * elements.
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category Array
 * @param {Array} array The array to process.
 * @param {number} [size=1] The length of each chunk
 * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.
 * @returns {Array} Returns the new array of chunks.
 * @example
 *
 * _.chunk(['a', 'b', 'c', 'd'], 2);
 * // => [['a', 'b'], ['c', 'd']]
 *
 * _.chunk(['a', 'b', 'c', 'd'], 3);
 * // => [['a', 'b', 'c'], ['d']]
 */
function chunk(array,size,guard){size=(guard?isIterateeCall(array,size,guard):void 0===size)?1:nativeMax(toInteger(size),0);var length=null==array?0:array.length;if(!length||size<1)return[];var index=0,resIndex=0,result=Array(nativeCeil(length/size));while(index<length)result[resIndex++]=baseSlice(array,index,index+=size);return result}module.exports=chunk},
/***/593754:
/***/function(module,__unused_webpack_exports,__webpack_require__){var toInteger=__webpack_require__(640554);
/**
 * Checks if `value` is an integer.
 *
 * **Note:** This method is based on
 * [`Number.isInteger`](https://mdn.io/Number/isInteger).
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an integer, else `false`.
 * @example
 *
 * _.isInteger(3);
 * // => true
 *
 * _.isInteger(Number.MIN_VALUE);
 * // => false
 *
 * _.isInteger(Infinity);
 * // => false
 *
 * _.isInteger('3');
 * // => false
 */function isInteger(value){return"number"==typeof value&&value==toInteger(value)}module.exports=isInteger},
/***/920556:
/***/function(module,__unused_webpack_exports,__webpack_require__){var baseIteratee=__webpack_require__(267206),baseSortedIndexBy=__webpack_require__(287226);
/**
 * This method is like `_.sortedIndex` except that it accepts `iteratee`
 * which is invoked for `value` and each element of `array` to compute their
 * sort ranking. The iteratee is invoked with one argument: (value).
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Array
 * @param {Array} array The sorted array to inspect.
 * @param {*} value The value to evaluate.
 * @param {Function} [iteratee=_.identity] The iteratee invoked per element.
 * @returns {number} Returns the index at which `value` should be inserted
 *  into `array`.
 * @example
 *
 * var objects = [{ 'x': 4 }, { 'x': 5 }];
 *
 * _.sortedIndexBy(objects, { 'x': 4 }, function(o) { return o.x; });
 * // => 0
 *
 * // The `_.property` iteratee shorthand.
 * _.sortedIndexBy(objects, { 'x': 4 }, 'x');
 * // => 0
 */function sortedIndexBy(array,value,iteratee){return baseSortedIndexBy(array,value,baseIteratee(iteratee,2))}module.exports=sortedIndexBy},
/***/238897:
/***/function(__unused_webpack_module,exports,__webpack_require__){"use strict";var compile=__webpack_require__(786239),EmptyProc={body:"",args:[],thisVars:[],localVars:[]};function fixup(x){if(!x)return EmptyProc;for(var i=0;i<x.args.length;++i){var a=x.args[i];x.args[i]=0===i?{name:a,lvalue:!0,rvalue:!!x.rvalue,count:x.count||1}:{name:a,lvalue:!1,rvalue:!0,count:1}}return x.thisVars||(x.thisVars=[]),x.localVars||(x.localVars=[]),x}function pcompile(user_args){return compile({args:user_args.args,pre:fixup(user_args.pre),body:fixup(user_args.body),post:fixup(user_args.proc),funcName:user_args.funcName})}function makeOp(user_args){for(var args=[],i=0;i<user_args.args.length;++i)args.push("a"+i);var wrapper=new Function("P",["return function ",user_args.funcName,"_ndarrayops(",args.join(","),") {P(",args.join(","),");return a0}"].join(""));return wrapper(pcompile(user_args))}var assign_ops={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};(function(){for(var id in assign_ops){var op=assign_ops[id];exports[id]=makeOp({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+op+"c"},funcName:id}),exports[id+"eq"]=makeOp({args:["array","array"],body:{args:["a","b"],body:"a"+op+"=b"},rvalue:!0,funcName:id+"eq"}),exports[id+"s"]=makeOp({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+op+"s"},funcName:id+"s"}),exports[id+"seq"]=makeOp({args:["array","scalar"],body:{args:["a","s"],body:"a"+op+"=s"},rvalue:!0,funcName:id+"seq"})}})();var unary_ops={not:"!",bnot:"~",neg:"-",recip:"1.0/"};(function(){for(var id in unary_ops){var op=unary_ops[id];exports[id]=makeOp({args:["array","array"],body:{args:["a","b"],body:"a="+op+"b"},funcName:id}),exports[id+"eq"]=makeOp({args:["array"],body:{args:["a"],body:"a="+op+"a"},rvalue:!0,count:2,funcName:id+"eq"})}})();var binary_ops={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};(function(){for(var id in binary_ops){var op=binary_ops[id];exports[id]=makeOp({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+op+"c"},funcName:id}),exports[id+"s"]=makeOp({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+op+"s"},funcName:id+"s"}),exports[id+"eq"]=makeOp({args:["array","array"],body:{args:["a","b"],body:"a=a"+op+"b"},rvalue:!0,count:2,funcName:id+"eq"}),exports[id+"seq"]=makeOp({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+op+"s"},rvalue:!0,count:2,funcName:id+"seq"})}})();var math_unary=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];(function(){for(var i=0;i<math_unary.length;++i){var f=math_unary[i];exports[f]=makeOp({args:["array","array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:f}),exports[f+"eq"]=makeOp({args:["array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:f+"eq"})}})();var math_comm=["max","min","atan2","pow"];(function(){for(var i=0;i<math_comm.length;++i){var f=math_comm[i];exports[f]=makeOp({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:f}),exports[f+"s"]=makeOp({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:f+"s"}),exports[f+"eq"]=makeOp({args:["array","array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:f+"eq"}),exports[f+"seq"]=makeOp({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:f+"seq"})}})();var math_noncomm=["atan2","pow"];(function(){for(var i=0;i<math_noncomm.length;++i){var f=math_noncomm[i];exports[f+"op"]=makeOp({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:f+"op"}),exports[f+"ops"]=makeOp({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:f+"ops"}),exports[f+"opeq"]=makeOp({args:["array","array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:f+"opeq"}),exports[f+"opseq"]=makeOp({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:f+"opseq"})}})(),exports.any=compile({args:["array"],pre:EmptyProc,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"}),exports.all=compile({args:["array"],pre:EmptyProc,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"}),exports.sum=compile({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"}),exports.prod=compile({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"}),exports.norm2squared=compile({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"}),exports.norm2=compile({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"}),exports.norminf=compile({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"}),exports.norm1=compile({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"}),exports.sup=compile({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),exports.inf=compile({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),exports.argmin=compile({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),exports.argmax=compile({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),exports.random=makeOp({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"}),exports.assign=makeOp({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"}),exports.assigns=makeOp({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"}),exports.equals=compile({args:["array","array"],pre:EmptyProc,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})
/***/},
/***/334644:
/***/function(module){"use strict";var SHAPE="n",DATA="d",STRIDE="s",STEP="p",OFFSET="o",INDEX="i";function generateScan(type,boundaries,n){if(0===n){for(var neighbors=[[]],i=0;i<boundaries.length;++i)if(!boundaries[i])for(var nn=neighbors.length,j=0;j<nn;++j){var v=neighbors[j].slice();v.push(STRIDE+i),neighbors.push(v)}if(1===neighbors.length)return"";var result=[];"generic"===type?result.push(DATA,".set(",OFFSET,",",DATA,".get(",OFFSET,")+"):result.push(DATA,"[",OFFSET,"]+=");for(i=1;i<neighbors.length;++i){v=neighbors[i];var negative=(v.length+1)%2;i>1&&!negative?result.push("+"):negative&&result.push("-"),"generic"===type?result.push(DATA,".get("):result.push(DATA,"["),result.push(OFFSET,"-",v.join("-")),"generic"===type?result.push(")"):result.push("]")}return"generic"===type?result.push(");"):result.push(";"),result.join("")}boundaries[n-1]=!0;var code=[generateScan(type,boundaries,n-1),OFFSET,"+=",STEP,n-1,";for(",INDEX,n-1,"=1;",INDEX,n-1,"<",SHAPE,n-1,";++",INDEX,n-1,"){"];return boundaries[n-1]=!1,code.push(generateScan(type,boundaries,n-1),OFFSET,"+=",STEP,n-1,";}"),code.join("")}function generatePrefixSumCode(type,order){for(
//Initialize local variables
var funcName=["prefixSum",order.length,"d",type,"s",order.join("s")].join(""),code=["function ",funcName,"(arr){var ",DATA,"=arr.data,",SHAPE,"=arr.shape,",STRIDE,"=arr.stride,",OFFSET,"=arr.offset,"],n=order.length,i=0;i<n;++i)code.push(SHAPE,i,"=",SHAPE,"[",order[i],"],");for(i=0;i<n;++i)code.push(STRIDE,i,"=",STRIDE,"[",order[i],"],");for(i=0;i<n;++i)code.push(INDEX,i,"=0,");for(i=n-1;i>0;--i)code.push(STEP,i,"=",STRIDE,i,"-",SHAPE,i-1,"*",STRIDE,i-1,",");code.push(STEP,"0=",STRIDE,0,";");
//Generate scan code recursively
var boundaries=new Array(n);for(i=0;i<n;++i)boundaries[i]=!0;code.push(generateScan(type,boundaries,n),"}return ",funcName);
//Allocate subroutine and return
var proc=new Function(code.join(""));return proc()}module.exports=computePrefixSum;var CACHE={};function computePrefixSum(array){var key=array.dtype+array.order.join(),proc=CACHE[key];return proc||(proc=CACHE[key]=generatePrefixSumCode(array.dtype,array.order)),proc(array),array}
/***/},
/***/62861:
/***/function(module,__unused_webpack_exports,__webpack_require__){var iota=__webpack_require__(716907),isBuffer=__webpack_require__(848738),hasTypedArrays="undefined"!==typeof Float64Array;function compare1st(a,b){return a[0]-b[0]}function order(){var i,stride=this.stride,terms=new Array(stride.length);for(i=0;i<terms.length;++i)terms[i]=[Math.abs(stride[i]),i];terms.sort(compare1st);var result=new Array(terms.length);for(i=0;i<result.length;++i)result[i]=terms[i][1];return result}function compileConstructor(dtype,dimension){var className=["View",dimension,"d",dtype].join("");dimension<0&&(className="View_Nil"+dtype);var useGetters="generic"===dtype;if(-1===dimension){
//Special case for trivial arrays
var code="function "+className+"(a){this.data=a;};var proto="+className+".prototype;proto.dtype='"+dtype+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+className+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+className+"(a){return new "+className+"(a);}",procedure=new Function(code);return procedure()}if(0===dimension){
//Special case for 0d arrays
code="function "+className+"(a,d) {this.data = a;this.offset = d};var proto="+className+".prototype;proto.dtype='"+dtype+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+className+"_copy() {return new "+className+"(this.data,this.offset)};proto.pick=function "+className+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+className+"_get(){return "+(useGetters?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+className+"_set(v){return "+(useGetters?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+className+"(a,b,c,d){return new "+className+"(a,d)}",procedure=new Function("TrivialArray",code);return procedure(CACHED_CONSTRUCTORS[dtype][0])}code=["'use strict'"];
//Create constructor for view
var indices=iota(dimension),args=indices.map((function(i){return"i"+i})),index_str="this.offset+"+indices.map((function(i){return"this.stride["+i+"]*i"+i})).join("+"),shapeArg=indices.map((function(i){return"b"+i})).join(","),strideArg=indices.map((function(i){return"c"+i})).join(",");code.push("function "+className+"(a,"+shapeArg+","+strideArg+",d){this.data=a","this.shape=["+shapeArg+"]","this.stride=["+strideArg+"]","this.offset=d|0}","var proto="+className+".prototype","proto.dtype='"+dtype+"'","proto.dimension="+dimension),
//view.size:
code.push("Object.defineProperty(proto,'size',{get:function "+className+"_size(){return "+indices.map((function(i){return"this.shape["+i+"]"})).join("*"),"}})"),
//view.order:
1===dimension?code.push("proto.order=[0]"):(code.push("Object.defineProperty(proto,'order',{get:"),dimension<4?(code.push("function "+className+"_order(){"),2===dimension?code.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===dimension&&code.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):code.push("ORDER})")),
//view.set(i0, ..., v):
code.push("proto.set=function "+className+"_set("+args.join(",")+",v){"),useGetters?code.push("return this.data.set("+index_str+",v)}"):code.push("return this.data["+index_str+"]=v}"),
//view.get(i0, ...):
code.push("proto.get=function "+className+"_get("+args.join(",")+"){"),useGetters?code.push("return this.data.get("+index_str+")}"):code.push("return this.data["+index_str+"]}"),
//view.index:
code.push("proto.index=function "+className+"_index(",args.join(),"){return "+index_str+"}"),
//view.hi():
code.push("proto.hi=function "+className+"_hi("+args.join(",")+"){return new "+className+"(this.data,"+indices.map((function(i){return["(typeof i",i,"!=='number'||i",i,"<0)?this.shape[",i,"]:i",i,"|0"].join("")})).join(",")+","+indices.map((function(i){return"this.stride["+i+"]"})).join(",")+",this.offset)}");
//view.lo():
var a_vars=indices.map((function(i){return"a"+i+"=this.shape["+i+"]"})),c_vars=indices.map((function(i){return"c"+i+"=this.stride["+i+"]"}));code.push("proto.lo=function "+className+"_lo("+args.join(",")+"){var b=this.offset,d=0,"+a_vars.join(",")+","+c_vars.join(","));for(var i=0;i<dimension;++i)code.push("if(typeof i"+i+"==='number'&&i"+i+">=0){d=i"+i+"|0;b+=c"+i+"*d;a"+i+"-=d}");code.push("return new "+className+"(this.data,"+indices.map((function(i){return"a"+i})).join(",")+","+indices.map((function(i){return"c"+i})).join(",")+",b)}"),
//view.step():
code.push("proto.step=function "+className+"_step("+args.join(",")+"){var "+indices.map((function(i){return"a"+i+"=this.shape["+i+"]"})).join(",")+","+indices.map((function(i){return"b"+i+"=this.stride["+i+"]"})).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(i=0;i<dimension;++i)code.push("if(typeof i"+i+"==='number'){d=i"+i+"|0;if(d<0){c+=b"+i+"*(a"+i+"-1);a"+i+"=ceil(-a"+i+"/d)}else{a"+i+"=ceil(a"+i+"/d)}b"+i+"*=d}");code.push("return new "+className+"(this.data,"+indices.map((function(i){return"a"+i})).join(",")+","+indices.map((function(i){return"b"+i})).join(",")+",c)}");
//view.transpose():
var tShape=new Array(dimension),tStride=new Array(dimension);for(i=0;i<dimension;++i)tShape[i]="a[i"+i+"]",tStride[i]="b[i"+i+"]";code.push("proto.transpose=function "+className+"_transpose("+args+"){"+args.map((function(n,idx){return n+"=("+n+"===undefined?"+idx+":"+n+"|0)"})).join(";"),"var a=this.shape,b=this.stride;return new "+className+"(this.data,"+tShape.join(",")+","+tStride.join(",")+",this.offset)}"),
//view.pick():
code.push("proto.pick=function "+className+"_pick("+args+"){var a=[],b=[],c=this.offset");for(i=0;i<dimension;++i)code.push("if(typeof i"+i+"==='number'&&i"+i+">=0){c=(c+this.stride["+i+"]*i"+i+")|0}else{a.push(this.shape["+i+"]);b.push(this.stride["+i+"])}");code.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),
//Add return statement
code.push("return function construct_"+className+"(data,shape,stride,offset){return new "+className+"(data,"+indices.map((function(i){return"shape["+i+"]"})).join(",")+","+indices.map((function(i){return"stride["+i+"]"})).join(",")+",offset)}");
//Compile procedure
procedure=new Function("CTOR_LIST","ORDER",code.join("\n"));return procedure(CACHED_CONSTRUCTORS[dtype],order)}function arrayDType(data){if(isBuffer(data))return"buffer";if(hasTypedArrays)switch(Object.prototype.toString.call(data)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(data)?"array":"generic"}var CACHED_CONSTRUCTORS={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],bigint64:[],biguint64:[],buffer:[],generic:[]};function wrappedNDArrayCtor(data,shape,stride,offset){if(void 0===data){var ctor=CACHED_CONSTRUCTORS.array[0];return ctor([])}"number"===typeof data&&(data=[data]),void 0===shape&&(shape=[data.length]);var d=shape.length;if(void 0===stride){stride=new Array(d);for(var i=d-1,sz=1;i>=0;--i)stride[i]=sz,sz*=shape[i]}if(void 0===offset){offset=0;for(i=0;i<d;++i)stride[i]<0&&(offset-=(shape[i]-1)*stride[i])}var dtype=arrayDType(data),ctor_list=CACHED_CONSTRUCTORS[dtype];while(ctor_list.length<=d+1)ctor_list.push(compileConstructor(dtype,ctor_list.length-1));ctor=ctor_list[d+1];return ctor(data,shape,stride,offset)}module.exports=wrappedNDArrayCtor
/***/},
/***/450146:
/***/function(module,__unused_webpack_exports,__webpack_require__){"use strict";var twoProduct=__webpack_require__(768005),robustSum=__webpack_require__(456740),robustScale=__webpack_require__(635442),robustSubtract=__webpack_require__(917972),NUM_EXPAND=5,EPSILON=11102230246251565e-32,ERRBOUND3=(3+16*EPSILON)*EPSILON,ERRBOUND4=(7+56*EPSILON)*EPSILON;function orientation_3(sum,prod,scale,sub){return function(m0,m1,m2){var p=sum(sum(prod(m1[1],m2[0]),prod(-m2[1],m1[0])),sum(prod(m0[1],m1[0]),prod(-m1[1],m0[0]))),n=sum(prod(m0[1],m2[0]),prod(-m2[1],m0[0])),d=sub(p,n);return d[d.length-1]}}function orientation_4(sum,prod,scale,sub){return function(m0,m1,m2,m3){var p=sum(sum(scale(sum(prod(m2[1],m3[0]),prod(-m3[1],m2[0])),m1[2]),sum(scale(sum(prod(m1[1],m3[0]),prod(-m3[1],m1[0])),-m2[2]),scale(sum(prod(m1[1],m2[0]),prod(-m2[1],m1[0])),m3[2]))),sum(scale(sum(prod(m1[1],m3[0]),prod(-m3[1],m1[0])),m0[2]),sum(scale(sum(prod(m0[1],m3[0]),prod(-m3[1],m0[0])),-m1[2]),scale(sum(prod(m0[1],m1[0]),prod(-m1[1],m0[0])),m3[2])))),n=sum(sum(scale(sum(prod(m2[1],m3[0]),prod(-m3[1],m2[0])),m0[2]),sum(scale(sum(prod(m0[1],m3[0]),prod(-m3[1],m0[0])),-m2[2]),scale(sum(prod(m0[1],m2[0]),prod(-m2[1],m0[0])),m3[2]))),sum(scale(sum(prod(m1[1],m2[0]),prod(-m2[1],m1[0])),m0[2]),sum(scale(sum(prod(m0[1],m2[0]),prod(-m2[1],m0[0])),-m1[2]),scale(sum(prod(m0[1],m1[0]),prod(-m1[1],m0[0])),m2[2])))),d=sub(p,n);return d[d.length-1]}}function orientation_5(sum,prod,scale,sub){return function(m0,m1,m2,m3,m4){var p=sum(sum(sum(scale(sum(scale(sum(prod(m3[1],m4[0]),prod(-m4[1],m3[0])),m2[2]),sum(scale(sum(prod(m2[1],m4[0]),prod(-m4[1],m2[0])),-m3[2]),scale(sum(prod(m2[1],m3[0]),prod(-m3[1],m2[0])),m4[2]))),m1[3]),sum(scale(sum(scale(sum(prod(m3[1],m4[0]),prod(-m4[1],m3[0])),m1[2]),sum(scale(sum(prod(m1[1],m4[0]),prod(-m4[1],m1[0])),-m3[2]),scale(sum(prod(m1[1],m3[0]),prod(-m3[1],m1[0])),m4[2]))),-m2[3]),scale(sum(scale(sum(prod(m2[1],m4[0]),prod(-m4[1],m2[0])),m1[2]),sum(scale(sum(prod(m1[1],m4[0]),prod(-m4[1],m1[0])),-m2[2]),scale(sum(prod(m1[1],m2[0]),prod(-m2[1],m1[0])),m4[2]))),m3[3]))),sum(scale(sum(scale(sum(prod(m2[1],m3[0]),prod(-m3[1],m2[0])),m1[2]),sum(scale(sum(prod(m1[1],m3[0]),prod(-m3[1],m1[0])),-m2[2]),scale(sum(prod(m1[1],m2[0]),prod(-m2[1],m1[0])),m3[2]))),-m4[3]),sum(scale(sum(scale(sum(prod(m3[1],m4[0]),prod(-m4[1],m3[0])),m1[2]),sum(scale(sum(prod(m1[1],m4[0]),prod(-m4[1],m1[0])),-m3[2]),scale(sum(prod(m1[1],m3[0]),prod(-m3[1],m1[0])),m4[2]))),m0[3]),scale(sum(scale(sum(prod(m3[1],m4[0]),prod(-m4[1],m3[0])),m0[2]),sum(scale(sum(prod(m0[1],m4[0]),prod(-m4[1],m0[0])),-m3[2]),scale(sum(prod(m0[1],m3[0]),prod(-m3[1],m0[0])),m4[2]))),-m1[3])))),sum(sum(scale(sum(scale(sum(prod(m1[1],m4[0]),prod(-m4[1],m1[0])),m0[2]),sum(scale(sum(prod(m0[1],m4[0]),prod(-m4[1],m0[0])),-m1[2]),scale(sum(prod(m0[1],m1[0]),prod(-m1[1],m0[0])),m4[2]))),m3[3]),sum(scale(sum(scale(sum(prod(m1[1],m3[0]),prod(-m3[1],m1[0])),m0[2]),sum(scale(sum(prod(m0[1],m3[0]),prod(-m3[1],m0[0])),-m1[2]),scale(sum(prod(m0[1],m1[0]),prod(-m1[1],m0[0])),m3[2]))),-m4[3]),scale(sum(scale(sum(prod(m2[1],m3[0]),prod(-m3[1],m2[0])),m1[2]),sum(scale(sum(prod(m1[1],m3[0]),prod(-m3[1],m1[0])),-m2[2]),scale(sum(prod(m1[1],m2[0]),prod(-m2[1],m1[0])),m3[2]))),m0[3]))),sum(scale(sum(scale(sum(prod(m2[1],m3[0]),prod(-m3[1],m2[0])),m0[2]),sum(scale(sum(prod(m0[1],m3[0]),prod(-m3[1],m0[0])),-m2[2]),scale(sum(prod(m0[1],m2[0]),prod(-m2[1],m0[0])),m3[2]))),-m1[3]),sum(scale(sum(scale(sum(prod(m1[1],m3[0]),prod(-m3[1],m1[0])),m0[2]),sum(scale(sum(prod(m0[1],m3[0]),prod(-m3[1],m0[0])),-m1[2]),scale(sum(prod(m0[1],m1[0]),prod(-m1[1],m0[0])),m3[2]))),m2[3]),scale(sum(scale(sum(prod(m1[1],m2[0]),prod(-m2[1],m1[0])),m0[2]),sum(scale(sum(prod(m0[1],m2[0]),prod(-m2[1],m0[0])),-m1[2]),scale(sum(prod(m0[1],m1[0]),prod(-m1[1],m0[0])),m2[2]))),-m3[3]))))),n=sum(sum(sum(scale(sum(scale(sum(prod(m3[1],m4[0]),prod(-m4[1],m3[0])),m2[2]),sum(scale(sum(prod(m2[1],m4[0]),prod(-m4[1],m2[0])),-m3[2]),scale(sum(prod(m2[1],m3[0]),prod(-m3[1],m2[0])),m4[2]))),m0[3]),scale(sum(scale(sum(prod(m3[1],m4[0]),prod(-m4[1],m3[0])),m0[2]),sum(scale(sum(prod(m0[1],m4[0]),prod(-m4[1],m0[0])),-m3[2]),scale(sum(prod(m0[1],m3[0]),prod(-m3[1],m0[0])),m4[2]))),-m2[3])),sum(scale(sum(scale(sum(prod(m2[1],m4[0]),prod(-m4[1],m2[0])),m0[2]),sum(scale(sum(prod(m0[1],m4[0]),prod(-m4[1],m0[0])),-m2[2]),scale(sum(prod(m0[1],m2[0]),prod(-m2[1],m0[0])),m4[2]))),m3[3]),scale(sum(scale(sum(prod(m2[1],m3[0]),prod(-m3[1],m2[0])),m0[2]),sum(scale(sum(prod(m0[1],m3[0]),prod(-m3[1],m0[0])),-m2[2]),scale(sum(prod(m0[1],m2[0]),prod(-m2[1],m0[0])),m3[2]))),-m4[3]))),sum(sum(scale(sum(scale(sum(prod(m2[1],m4[0]),prod(-m4[1],m2[0])),m1[2]),sum(scale(sum(prod(m1[1],m4[0]),prod(-m4[1],m1[0])),-m2[2]),scale(sum(prod(m1[1],m2[0]),prod(-m2[1],m1[0])),m4[2]))),m0[3]),scale(sum(scale(sum(prod(m2[1],m4[0]),prod(-m4[1],m2[0])),m0[2]),sum(scale(sum(prod(m0[1],m4[0]),prod(-m4[1],m0[0])),-m2[2]),scale(sum(prod(m0[1],m2[0]),prod(-m2[1],m0[0])),m4[2]))),-m1[3])),sum(scale(sum(scale(sum(prod(m1[1],m4[0]),prod(-m4[1],m1[0])),m0[2]),sum(scale(sum(prod(m0[1],m4[0]),prod(-m4[1],m0[0])),-m1[2]),scale(sum(prod(m0[1],m1[0]),prod(-m1[1],m0[0])),m4[2]))),m2[3]),scale(sum(scale(sum(prod(m1[1],m2[0]),prod(-m2[1],m1[0])),m0[2]),sum(scale(sum(prod(m0[1],m2[0]),prod(-m2[1],m0[0])),-m1[2]),scale(sum(prod(m0[1],m1[0]),prod(-m1[1],m0[0])),m2[2]))),-m4[3])))),d=sub(p,n);return d[d.length-1]}}function orientation(n){var fn=3===n?orientation_3:4===n?orientation_4:orientation_5;return fn(robustSum,twoProduct,robustScale,robustSubtract)}var orientation3Exact=orientation(3),orientation4Exact=orientation(4),CACHED=[function(){return 0},function(){return 0},function(a,b){return b[0]-a[0]},function(a,b,c){var s,l=(a[1]-c[1])*(b[0]-c[0]),r=(a[0]-c[0])*(b[1]-c[1]),det=l-r;if(l>0){if(r<=0)return det;s=l+r}else{if(!(l<0))return det;if(r>=0)return det;s=-(l+r)}var tol=ERRBOUND3*s;return det>=tol||det<=-tol?det:orientation3Exact(a,b,c)},function(a,b,c,d){var adx=a[0]-d[0],bdx=b[0]-d[0],cdx=c[0]-d[0],ady=a[1]-d[1],bdy=b[1]-d[1],cdy=c[1]-d[1],adz=a[2]-d[2],bdz=b[2]-d[2],cdz=c[2]-d[2],bdxcdy=bdx*cdy,cdxbdy=cdx*bdy,cdxady=cdx*ady,adxcdy=adx*cdy,adxbdy=adx*bdy,bdxady=bdx*ady,det=adz*(bdxcdy-cdxbdy)+bdz*(cdxady-adxcdy)+cdz*(adxbdy-bdxady),permanent=(Math.abs(bdxcdy)+Math.abs(cdxbdy))*Math.abs(adz)+(Math.abs(cdxady)+Math.abs(adxcdy))*Math.abs(bdz)+(Math.abs(adxbdy)+Math.abs(bdxady))*Math.abs(cdz),tol=ERRBOUND4*permanent;return det>tol||-det>tol?det:orientation4Exact(a,b,c,d)}];function slowOrient(args){var proc=CACHED[args.length];return proc||(proc=CACHED[args.length]=orientation(args.length)),proc.apply(void 0,args)}function proc(slow,o0,o1,o2,o3,o4,o5){return function(a0,a1,a2,a3,a4){switch(arguments.length){case 0:case 1:return 0;case 2:return o2(a0,a1);case 3:return o3(a0,a1,a2);case 4:return o4(a0,a1,a2,a3);case 5:return o5(a0,a1,a2,a3,a4)}for(var s=new Array(arguments.length),i=0;i<arguments.length;++i)s[i]=arguments[i];return slow(s)}}function generateOrientationProc(){while(CACHED.length<=NUM_EXPAND)CACHED.push(orientation(CACHED.length));module.exports=proc.apply(void 0,[slowOrient].concat(CACHED));for(var i=0;i<=NUM_EXPAND;++i)module.exports[i]=CACHED[i]}generateOrientationProc()
/***/},
/***/635442:
/***/function(module,__unused_webpack_exports,__webpack_require__){"use strict";var twoProduct=__webpack_require__(768005),twoSum=__webpack_require__(536359);function scaleLinearExpansion(e,scale){var n=e.length;if(1===n){var ts=twoProduct(e[0],scale);return ts[0]?ts:[ts[1]]}var g=new Array(2*n),q=[.1,.1],t=[.1,.1],count=0;twoProduct(e[0],scale,q),q[0]&&(g[count++]=q[0]);for(var i=1;i<n;++i){twoProduct(e[i],scale,t);var pq=q[1];twoSum(pq,t[0],q),q[0]&&(g[count++]=q[0]);var a=t[1],b=q[1],x=a+b,bv=x-a,y=b-bv;q[1]=x,y&&(g[count++]=y)}return q[1]&&(g[count++]=q[1]),0===count&&(g[count++]=0),g.length=count,g}
/***/module.exports=scaleLinearExpansion},
/***/917972:
/***/function(module){"use strict";
//Easy case: Add two scalars
function scalarScalar(a,b){var x=a+b,bv=x-a,av=x-bv,br=b-bv,ar=a-av,y=ar+br;return y?[y,x]:[x]}function robustSubtract(e,f){var ne=0|e.length,nf=0|f.length;if(1===ne&&1===nf)return scalarScalar(e[0],-f[0]);var a,b,n=ne+nf,g=new Array(n),count=0,eptr=0,fptr=0,abs=Math.abs,ei=e[eptr],ea=abs(ei),fi=-f[fptr],fa=abs(fi);ea<fa?(b=ei,eptr+=1,eptr<ne&&(ei=e[eptr],ea=abs(ei))):(b=fi,fptr+=1,fptr<nf&&(fi=-f[fptr],fa=abs(fi))),eptr<ne&&ea<fa||fptr>=nf?(a=ei,eptr+=1,eptr<ne&&(ei=e[eptr],ea=abs(ei))):(a=fi,fptr+=1,fptr<nf&&(fi=-f[fptr],fa=abs(fi)));var _x,_bv,_av,_br,_ar,x=a+b,bv=x-a,y=b-bv,q0=y,q1=x;while(eptr<ne&&fptr<nf)ea<fa?(a=ei,eptr+=1,eptr<ne&&(ei=e[eptr],ea=abs(ei))):(a=fi,fptr+=1,fptr<nf&&(fi=-f[fptr],fa=abs(fi))),b=q0,x=a+b,bv=x-a,y=b-bv,y&&(g[count++]=y),_x=q1+x,_bv=_x-q1,_av=_x-_bv,_br=x-_bv,_ar=q1-_av,q0=_ar+_br,q1=_x;while(eptr<ne)a=ei,b=q0,x=a+b,bv=x-a,y=b-bv,y&&(g[count++]=y),_x=q1+x,_bv=_x-q1,_av=_x-_bv,_br=x-_bv,_ar=q1-_av,q0=_ar+_br,q1=_x,eptr+=1,eptr<ne&&(ei=e[eptr]);while(fptr<nf)a=fi,b=q0,x=a+b,bv=x-a,y=b-bv,y&&(g[count++]=y),_x=q1+x,_bv=_x-q1,_av=_x-_bv,_br=x-_bv,_ar=q1-_av,q0=_ar+_br,q1=_x,fptr+=1,fptr<nf&&(fi=-f[fptr]);return q0&&(g[count++]=q0),q1&&(g[count++]=q1),count||(g[count++]=0),g.length=count,g}
/***/module.exports=robustSubtract},
/***/456740:
/***/function(module){"use strict";
//Easy case: Add two scalars
function scalarScalar(a,b){var x=a+b,bv=x-a,av=x-bv,br=b-bv,ar=a-av,y=ar+br;return y?[y,x]:[x]}function linearExpansionSum(e,f){var ne=0|e.length,nf=0|f.length;if(1===ne&&1===nf)return scalarScalar(e[0],f[0]);var a,b,n=ne+nf,g=new Array(n),count=0,eptr=0,fptr=0,abs=Math.abs,ei=e[eptr],ea=abs(ei),fi=f[fptr],fa=abs(fi);ea<fa?(b=ei,eptr+=1,eptr<ne&&(ei=e[eptr],ea=abs(ei))):(b=fi,fptr+=1,fptr<nf&&(fi=f[fptr],fa=abs(fi))),eptr<ne&&ea<fa||fptr>=nf?(a=ei,eptr+=1,eptr<ne&&(ei=e[eptr],ea=abs(ei))):(a=fi,fptr+=1,fptr<nf&&(fi=f[fptr],fa=abs(fi)));var _x,_bv,_av,_br,_ar,x=a+b,bv=x-a,y=b-bv,q0=y,q1=x;while(eptr<ne&&fptr<nf)ea<fa?(a=ei,eptr+=1,eptr<ne&&(ei=e[eptr],ea=abs(ei))):(a=fi,fptr+=1,fptr<nf&&(fi=f[fptr],fa=abs(fi))),b=q0,x=a+b,bv=x-a,y=b-bv,y&&(g[count++]=y),_x=q1+x,_bv=_x-q1,_av=_x-_bv,_br=x-_bv,_ar=q1-_av,q0=_ar+_br,q1=_x;while(eptr<ne)a=ei,b=q0,x=a+b,bv=x-a,y=b-bv,y&&(g[count++]=y),_x=q1+x,_bv=_x-q1,_av=_x-_bv,_br=x-_bv,_ar=q1-_av,q0=_ar+_br,q1=_x,eptr+=1,eptr<ne&&(ei=e[eptr]);while(fptr<nf)a=fi,b=q0,x=a+b,bv=x-a,y=b-bv,y&&(g[count++]=y),_x=q1+x,_bv=_x-q1,_av=_x-_bv,_br=x-_bv,_ar=q1-_av,q0=_ar+_br,q1=_x,fptr+=1,fptr<nf&&(fi=f[fptr]);return q0&&(g[count++]=q0),q1&&(g[count++]=q1),count||(g[count++]=0),g.length=count,g}
/***/module.exports=linearExpansionSum},
/***/768005:
/***/function(module){"use strict";module.exports=twoProduct;var SPLITTER=+(Math.pow(2,27)+1);function twoProduct(a,b,result){var x=a*b,c=SPLITTER*a,abig=c-a,ahi=c-abig,alo=a-ahi,d=SPLITTER*b,bbig=d-b,bhi=d-bbig,blo=b-bhi,err1=x-ahi*bhi,err2=err1-alo*bhi,err3=err2-ahi*blo,y=alo*blo-err3;return result?(result[0]=y,result[1]=x,result):[y,x]}
/***/},
/***/536359:
/***/function(module){"use strict";function fastTwoSum(a,b,result){var x=a+b,bv=x-a,av=x-bv,br=b-bv,ar=a-av;return result?(result[0]=ar+br,result[1]=x,result):[ar+br,x]}
/***/module.exports=fastTwoSum},
/***/38706:
/***/function(module){"use strict";function unique_pred(list,compare){for(var ptr=1,len=list.length,a=list[0],b=list[0],i=1;i<len;++i)if(b=a,a=list[i],compare(a,b)){if(i===ptr){ptr++;continue}list[ptr++]=a}return list.length=ptr,list}function unique_eq(list){for(var ptr=1,len=list.length,a=list[0],b=list[0],i=1;i<len;++i,b=a)if(b=a,a=list[i],a!==b){if(i===ptr){ptr++;continue}list[ptr++]=a}return list.length=ptr,list}function unique(list,compare,sorted){return 0===list.length?list:compare?(sorted||list.sort(compare),unique_pred(list,compare)):(sorted||list.sort(),unique_eq(list))}module.exports=unique
/***/},
/***/324960:
/***/function(){
/* (ignored) */
/***/},
/***/326759:
/***/function(){
/* (ignored) */
/***/},
/***/56272:
/***/function(){
/* (ignored) */
/***/},
/***/790343:
/***/function(__unused_webpack_module,__unused_webpack_exports,__webpack_require__){"use strict";var $=__webpack_require__(79989),createHTML=__webpack_require__(171568),forcedStringHTMLMethod=__webpack_require__(474580);
// `String.prototype.anchor` method
// https://tc39.es/ecma262/#sec-string.prototype.anchor
$({target:"String",proto:!0,forced:forcedStringHTMLMethod("anchor")},{anchor:function(name){return createHTML(this,"a","name",name)}})},
/***/329068:
/***/function(__unused_webpack_module,__unused_webpack_exports,__webpack_require__){"use strict";var createTypedArrayConstructor=__webpack_require__(731158);
// `Float32Array` constructor
// https://tc39.es/ecma262/#sec-typedarray-objects
createTypedArrayConstructor("Float32",(function(init){return function(data,byteOffset,length){return init(this,data,byteOffset,length)}}))}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/78540.js.map