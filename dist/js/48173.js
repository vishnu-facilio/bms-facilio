"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[48173],{
/***/749563:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return AssetBreakdown}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/AssetBreakdown.vue?vue&type=template&id=118ba6c6&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticStyle:{"z-index":"999999"},attrs:{visible:_vm.visibility,"append-to-body":!0,"custom-class":"setup-dialog40 setup-dialog asset-breakdown-popup","before-close":_vm.closeDialog},on:{"update:visible":function($event){_vm.visibility=$event}}},[_c("error-banner",{attrs:{error:_vm.error,errorMessage:_vm.errorText},on:{"update:error":function($event){_vm.error=$event},"update:errorMessage":function($event){_vm.errorText=$event},"update:error-message":function($event){_vm.errorText=$event}}}),_c("div",{staticClass:"content-section"},[_c("div",{staticClass:"new-header-container"},[_c("div",{staticClass:"new-header-text"},[_c("div",{staticClass:"fc-setup-modal-title"},[_vm._v(_vm._s("Report Asset Downtime"))])])]),_c("div",{staticClass:"new-body-modal"},[_c("el-row",{attrs:{gutter:20}},[_c("el-col",{attrs:{span:24}},[_c("p",{staticClass:"fc-input-label-txt pB10"},[_vm._v(" "+_vm._s(_vm.$t("common._common.message"))+" ")]),_c("el-input",{staticClass:"fc-input-full-border-select2",attrs:{placeholder:"Enter the Condition"},model:{value:_vm.breakdown.condition,callback:function($$v){_vm.$set(_vm.breakdown,"condition",$$v)},expression:"breakdown.condition"}})],1)],1),_c("el-row",{staticClass:"mT20",attrs:{align:"middle"}},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.time"))+" ")]),_c("div",{staticClass:"form-input"},[_c("f-date-picker",{staticClass:"fc-input-full-border-select2 form-date-picker",attrs:{type:"datetimerange","start-placeholder":"Start Date","end-placeholder":"End Date"},on:{change:_vm.pickerChange},model:{value:_vm.time,callback:function($$v){_vm.time=$$v},expression:"time"}})],1)])],1)],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){return _vm.closeDialog()}}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.isSaving},on:{click:_vm.saveAssetBreakdown}},[_vm._v(_vm._s(_vm.isSaving?"Saving...":_vm.$t("common._common._save")))])],1)])],1)},staticRenderFns=[],objectSpread2=__webpack_require__(595082),ErrorBanner=(__webpack_require__(450886),__webpack_require__(297157)),utils_validation=__webpack_require__(990260),FDatePicker=__webpack_require__(358551),moment_timezone=__webpack_require__(480008),moment_timezone_default=__webpack_require__.n(moment_timezone),AssetBreakdownvue_type_script_lang_js={props:["assetBDSourceDetails","visibility"],components:{ErrorBanner:ErrorBanner/* default */.Z,FDatePicker:FDatePicker/* default */.Z},data:function(){return{breakdown:{sourceId:null,condition:null,assetid:null,sourceType:null},time:[],fromtime:null,totime:null,error:!1,errorText:"",isSaving:!1}},mounted:function(){this.initAssetBreakDown()},methods:{initAssetBreakDown:function(){this.breakdown=(0,objectSpread2/* default */.Z)({},this.assetBDSourceDetails)},pickerChange:function(value){var _this=this;!(0,utils_validation/* isEmpty */.xb)(value)&&(0,utils_validation/* isArray */.kJ)(value)?(this.fromtime=value[0],this.totime=value[1],this.time=value.map((function(val){return _this.getTimeInSystemZone(val)}))):this.time=[]},validation:function(){(0,utils_validation/* isEmpty */.xb)(this.breakdown.condition)?(this.errorText=this.$t("common.placeholders.please_enter_condition"),this.error=!0):2!=this.time.length?(this.errorText=this.$t("common.placeholders.please_choose_time"),this.error=!0):(this.errorText="",this.error=!1)},saveAssetBreakdown:function(){var _this2=this;if(this.validation(),!this.error){var assetBDSourceDetails=(0,objectSpread2/* default */.Z)({},this.breakdown),fromtime=this.fromtime,totime=this.totime;assetBDSourceDetails.fromtime=fromtime,assetBDSourceDetails.totime=totime,this.isSaving=!0,this.$http.post("/v2/assetbreakdown/addNew",{assetBDSourceDetails:assetBDSourceDetails}).then((function(response){0===response.data.responseCode?(_this2.$message.success(_this2.$t("common._common.Asset_breakdown_saved_successfully")),_this2.$emit("onSave"),_this2.closeDialog()):_this2.$message.error(response.data.message),_this2.isSaving=!1})).catch((function(){_this2.$message.error(_this2.$t('common._common."Failed_to_record_breakdown')),_this2.closeDialog(),_this2.isSaving=!1}))}},getTimeInSystemZone:function(value){return moment_timezone_default().tz(value,this.$timezone).format("YYYY-MM-DD HH:mm:ss")},closeDialog:function(){this.$emit("update:visibility",!1)}}},components_AssetBreakdownvue_type_script_lang_js=AssetBreakdownvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_AssetBreakdownvue_type_script_lang_js,render,staticRenderFns,!1,null,"118ba6c6",null)
/* harmony default export */,AssetBreakdown=component.exports},
/***/297157:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return ErrorBanner}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/ErrorBanner.vue?vue&type=template&id=3d9e5288
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_vm.hasError?_c("div",{staticClass:"error-block",attrs:{id:"error"}},[_c("p",{staticClass:"error-txt"},[_c("i",{staticClass:"fa fa-info-circle",attrs:{"aria-hidden":"true"}}),_vm._v(" "+_vm._s(_vm.errorMessage?_vm.errorMessage:"Please fill all mandatory fields.")+" ")]),_c("i",{staticClass:"el-icon-close error-close-icon",on:{click:_vm.closeBanner}})]):_vm._e()])},staticRenderFns=[],ErrorBannervue_type_script_lang_js={props:["error","errorMessage"],computed:{hasError:{get:function(){return this.error},set:function(value){this.$emit("update:error",value)}}},methods:{closeBanner:function(){this.hasError=!1,this.$emit("update:errorMessage","")}}},components_ErrorBannervue_type_script_lang_js=ErrorBannervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_ErrorBannervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,ErrorBanner=component.exports},
/***/448173:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return OverallDownTime}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/page/widget/performance/OverallDownTime.vue?vue&type=template&id=135d6764
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"p30 pT35 pB10 d-flex"},[_vm.$validation.isEmpty(_vm.totalCount)?_c("div",{staticClass:"f16 bold fc-black-dark"},[_vm._v(" "+_vm._s(_vm.$t("asset.performance.no_downtimes_reported"))+" ")]):_c("div",{staticClass:"f16 bold"},[_vm._v(" "+_vm._s(_vm.totalCount)+" "+_vm._s(_vm.$t("asset.performance.reported_downtime_ytd"))+" ")]),_c("div",{staticClass:"mT35 d-flex flex-direction-row items-center"},[_c("div",{staticClass:"d-flex flex-direction-column"},[_c("span",{staticClass:"f22"},[_vm._v(" "+_vm._s(_vm.currentMonthDuration||"00:00 Hrs")+" ")]),_c("span",{staticClass:"f12 text-fc-grey mT5"},[_vm._v(_vm._s(_vm.$t("common.reports.rangeCategory.THIS_YEAR")))])]),_vm.lastMonthDuration?_c("div",{staticClass:"mL40"},[_c("span",{staticClass:"bold mR5"},[_vm._v(_vm._s(_vm.lastMonthDuration))]),_c("span",[_vm._v(_vm._s(_vm.$t("asset.performance.till_last_month")))])]):_vm._e()]),_c("portal",{attrs:{to:_vm.widget.key+"-title-section"}},[_c("div",{staticClass:"widget-header d-flex flex-direction-row justify-content-space mB15 mT5"},[_c("div",{staticClass:"widget-header-name"},[_vm._v(" "+_vm._s(_vm.$t("asset.performance.overall_downtime"))+" ")]),_vm.decommission?_vm._e():_c("a",{staticClass:"f13",on:{click:function($event){_vm.showAssetBreakdown=!0}}},[_vm._v(_vm._s(_vm.$t("asset.performance.report_downtime")))])])]),_vm.showAssetBreakdown?_c("asset-breakdown",{attrs:{visibility:_vm.showAssetBreakdown,assetBDSourceDetails:_vm.breakdownDetails},on:{"update:visibility":function($event){_vm.showAssetBreakdown=$event},onSave:_vm.updateBreakdownStats}}):_vm._e()],1)},staticRenderFns=[],validation=__webpack_require__(990260),AssetBreakdown=__webpack_require__(749563),OverallDownTimevue_type_script_lang_js={props:["details","layoutParams","resizeWidget","hideTitleSection","groupKey","activeTab","widget","eventBus"],components:{AssetBreakdown:AssetBreakdown/* default */.Z},data:function(){return{totalCount:null,currentMonthDuration:null,lastMonthDuration:null,showAssetBreakdown:!1,breakdownDetails:{}}},computed:{decommission:function(){return this.$getProperty(this,"details.decommission",!1)}},created:function(){this.resetBreakdownDetails()},mounted:function(){this.loadCount(),this.loadDurationTillLastMonth(),this.loadTotalDurationForCurrentYear()},methods:{resetBreakdownDetails:function(){this.breakdownDetails={condition:"",assetid:this.details.id,sourceId:this.details.id,sourceType:3}},executeWorkflow:function(params){return this.$http.post("/v2/executeworkflow",params).then((function(response){return 0===response.data.responseCode?response.data.result.workflowResult:null}))},loadCount:function(){var _this=this,params={workflow:{expressions:[{name:"Number Of Downtimes",fieldName:"duration",moduleName:"assetbreakdown",aggregateString:"count",criteria:{pattern:"(1 and 2)",conditions:{1:{fieldName:"asset",operatorId:36,sequence:"1",value:this.details.id},2:{fieldName:"fromTime",operatorId:44,sequence:"2"}}}}]}};this.executeWorkflow(params).then((function(result){_this.totalCount=(0,validation/* isEmpty */.xb)(result)||0===result?null:result})).catch((function(){return _this.totalCount=null}))},loadDurationTillLastMonth:function(){var _this2=this,params={workflow:{expressions:[{name:"Duration Till Last Month",fieldName:"duration",moduleName:"assetbreakdown",aggregateString:"sum",criteria:{pattern:"(1 and 2)",conditions:{1:{fieldName:"asset",operatorId:36,sequence:"1",value:this.details.id},2:{fieldName:"fromTime",operatorId:80,sequence:"2"}}}}]}};this.executeWorkflow(params).then((function(result){_this2.lastMonthDuration=(0,validation/* isEmpty */.xb)(result)?null:_this2.$helpers.getFormattedDuration(result,"seconds")})).catch((function(){return _this2.lastMonthDuration=null}))},loadTotalDurationForCurrentYear:function(){var _this3=this,params={workflow:{expressions:[{name:"Total Duration For Current Year",fieldName:"duration",moduleName:"assetbreakdown",aggregateString:"sum",criteria:{pattern:"(1 and 2)",conditions:{1:{fieldName:"asset",operatorId:36,sequence:"1",value:this.details.id},2:{fieldName:"fromTime",operatorId:44,sequence:"2"}}}}]}};this.executeWorkflow(params).then((function(result){_this3.currentMonthDuration=(0,validation/* isEmpty */.xb)(result)?null:_this3.$helpers.getFormattedDuration(result,"seconds")})).catch((function(){return _this3.currentMonthDuration=null}))},updateBreakdownStats:function(){this.eventBus.$emit("asset-downtime-reported"),this.loadCount(),this.loadDurationTillLastMonth(),this.loadTotalDurationForCurrentYear()}}},performance_OverallDownTimevue_type_script_lang_js=OverallDownTimevue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(performance_OverallDownTimevue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,OverallDownTime=component.exports},
/***/358551:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FDatePicker}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/assets/overview/FDatePicker.vue?vue&type=template&id=fd3cfbc4
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-date-picker",{ref:"date-picker",attrs:{appendToBody:_vm.appendToBody,clearable:!_vm.hideClear,type:_vm.type,"value-format":_vm.valueFormat,format:_vm.pickerFormat,placeholder:_vm.placeholder,disabled:_vm.disabled,editable:_vm.editable,"default-value":_vm.defaultValue,"picker-options":_vm.pickerOptions,"prefix-icon":_vm.prefixIcon,"clear-icon":_vm.clearIcon,"start-placeholder":_vm.startPlaceholder,"end-placeholder":_vm.endPlaceholder,"time-arrow-control":_vm.arrowControl,"default-time":_vm.defaultTime},on:{change:_vm.pickerChange},model:{value:_vm.ttime,callback:function($$v){_vm.ttime=$$v},expression:"ttime"}})},staticRenderFns=[],validation=(__webpack_require__(976801),__webpack_require__(564043),__webpack_require__(857267),__webpack_require__(756532),__webpack_require__(634338),__webpack_require__(450886),__webpack_require__(843843),__webpack_require__(990260)),constant=__webpack_require__(354754),moment_timezone=__webpack_require__(480008),moment_timezone_default=__webpack_require__.n(moment_timezone),FDatePickervue_type_script_lang_js={props:["appendToBody","value","value-format","format","default-value","placeholder","disabled","editable","picker-options","type","prefix-icon","clear-icon","start-placeholder","end-placeholder","hideClear","arrowControl","default-time"],mounted:function(){this.init()},data:function(){return{timeinorg:[]}},computed:{isRangeType:function(){var _ref=this||{},type=_ref.type;return["daterange","datetimerange"].includes(type)},defaultFormats:function(){var $timeformat=this.$timeformat,$dateformat=this.$dateformat,dateformat=($dateformat||"").replaceAll("Y","y");return dateformat=(dateformat||"").replaceAll("D","d"),{date:dateformat,month:"yyyy-MM",datetime:"".concat(dateformat," ").concat($timeformat),time:"".concat($timeformat),week:"yyyywWW",timerange:"".concat($timeformat),daterange:"".concat(dateformat),monthrange:"yyyy-MM",datetimerange:"".concat(dateformat," ").concat($timeformat),year:"yyyy"}},pickerFormat:function(){var _ref2=this||{},defaultFormats=_ref2.defaultFormats,type=_ref2.type,format=_ref2.format;return(0,validation/* isEmpty */.xb)(format)&&!(0,validation/* isEmpty */.xb)(defaultFormats[type])?defaultFormats[type]:format},ttime:{get:function(){var _this=this,_ref3=this||{},value=_ref3.value,isRangeType=_ref3.isRangeType;return(0,validation/* isEmpty */.xb)(value)?isRangeType?[]:"":isRangeType?value.map((function(val){return _this.getTimeInSystemZone(val)})):this.getTimeInSystemZone(value)},set:function(value){var isRangeType=this.isRangeType;if(isRangeType){if((0,validation/* isEmpty */.xb)(value))this.timeinorg=[];else for(var time in value)this.timeinorg[time]=this.$helpers.getTimeInOrg(value[time]);this.$emit("input",this.timeinorg),this.$emit("change",this.timeinorg)}else{var modifiedTimeFormat=this.$helpers.getTimeInOrg(value);this.$emit("input",modifiedTimeFormat),this.$emit("change",modifiedTimeFormat)}}}},methods:{pickerChange:function(){var isRangeType=this.isRangeType,value=this.value;if(isRangeType){if((0,validation/* isEmpty */.xb)(value))this.timeinorg=[];else for(var time in value)this.timeinorg[time]=this.$helpers.getTimeInOrg(value[time]);this.$emit("pickerChange",this.timeinorg)}else{var modifiedTimeFormat=this.$helpers.getTimeInOrg(value);this.$emit("pickerChange",modifiedTimeFormat)}},init:function(){var isRangeType=this.isRangeType,value=this.value;if(isRangeType){if((0,validation/* isEmpty */.xb)(value))this.timeinorg=[];else for(var time in value){var timeVal=parseInt(value[time]);this.timeinorg[time]=timeVal}this.$emit("input",this.timeinorg)}else if(!(0,validation/* isEmpty */.xb)(value)){var isPlaceHoldersEnabled=constant/* default */.Z.FIELD_PLACEHOLDERS.includes(value)||!1;isPlaceHoldersEnabled||this.$emit("input",value)}this.$emit("initialized")},focus:function(){this.$refs["date-picker"].focus()},getTimeInSystemZone:function(value){return new Date(moment_timezone_default().tz(value,this.$timezone).format("YYYY-MM-DD HH:mm:ss"))}}},overview_FDatePickervue_type_script_lang_js=FDatePickervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(overview_FDatePickervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FDatePicker=component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/48173.js.map