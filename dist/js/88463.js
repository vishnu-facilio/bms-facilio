(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[88463,20470],{
/***/487565:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return Comments2}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/relatedlist/Comments2.vue?vue&type=template&id=baa28728
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"fc-new-comments fc-comments row"},[_c("div",{staticClass:"col-12 scroll-new"},[_c("notes",{staticClass:"assetsnotes new-summary-block fc-visibility-gicon-visible flex-grow overflow-y-scroll",attrs:{module:"ticketnotes",parentModule:"workorder",record:_vm.record,notify:!0,layoutParams:500,resizeWidget:this.resizeWidget,isActive:!1,forWO:!0,listViewComments:!0}})],1)])},staticRenderFns=[],Notes=(__webpack_require__(228436),__webpack_require__(120470)),Comments2vue_type_script_lang_js={extends:Notes["default"],props:["record","moduleName","details","layoutParams","widget","resizeWidget"],components:{Notes:Notes["default"]},data:function(){return{markdownshow:!1}},methods:{markdownhelplist:function(){this.markdownshow=!0},focusCommentBox:function(){this.commentFocus=!0},blurCommentBox:function(){!this.newComment.body||this.newComment.body.trim()}}},relatedlist_Comments2vue_type_script_lang_js=Comments2vue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(relatedlist_Comments2vue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,Comments2=component.exports},
/***/526971:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return SummaryAttachment}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/relatedlist/SummaryAttachment.vue?vue&type=template&id=3eb46d89
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"fc-attachments p0"},[_vm.exportDownloadUrl?_c("iframe",{staticStyle:{display:"none"},attrs:{src:_vm.exportDownloadUrl}}):_vm._e(),_vm.loading?_c("div",{staticClass:"text-center"},[_c("spinner",{attrs:{show:_vm.loading}})],1):_c("div",[_c("div",{staticClass:"row fc-summary-attchment",staticStyle:{"padding-top":"20px","margin-left":"15px","margin-right":"15px","margin-bottom":"20px","padding-left":"0px"}},_vm._l(_vm.attachments,(function(attachment){return _c("el-row",{key:attachment.attachmentId,staticStyle:{"border-bottom":"1px solid #ededed",width:"100%","padding-top":"10px","padding-bottom":"10px"}},[_c("el-col",{attrs:{span:22}},[_c("el-col",{staticClass:"mT5",attrs:{span:2}},[_c("img",{staticClass:"svg-icon",staticStyle:{width:"20px"},attrs:{src:__webpack_require__(250620)}})]),_c("el-col",{attrs:{span:18}},[_c("div",[attachment.previewUrl?_c("a",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"top",animation:"shift-away",arrow:!0},expression:"{\n                  placement: 'top',\n                  animation: 'shift-away',\n                  arrow: true,\n                }"}],staticClass:"self-center show text-left fc-black-13 textoverflow-ellipsis max-width300px",staticStyle:{border:"none"},attrs:{title:attachment.fileName},on:{click:function($event){return _vm.selectedFile(attachment)}}},[_vm._v(_vm._s(attachment.fileName))]):_c("a",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"top",animation:"shift-away",arrow:!0},expression:"{\n                  placement: 'top',\n                  animation: 'shift-away',\n                  arrow: true,\n                }"}],staticClass:"self-center show text-left fc-black-13 textoverflow-ellipsis max-width300px",staticStyle:{border:"none"},attrs:{title:attachment.fileName}},[_vm._v(_vm._s(attachment.fileName))]),_vm.getUser(attachment)>0?_c("div",{staticClass:"col-4 comment-file mT2",staticStyle:{border:"none"}},[_vm._v(" "+_vm._s(_vm.getUser(attachment))+" "),attachment.createdTime?_c("span",[_vm._v("| "+_vm._s(_vm._f("formatDate")(attachment.createdTime,"DD-MM_YYYY")))]):_vm._e()]):_c("div",{staticClass:"col-4 comment-file mT2",staticStyle:{border:"none"}},[_vm._v(" "+_vm._s(_vm._f("formatDate")(attachment.createdTime,"DD-MM_YYYY"))+" ")])])])],1),_c("el-col",{staticClass:"mT5 pointer",attrs:{span:2}},[_c("img",{attrs:{src:__webpack_require__(365565),width:"16",height:"16"},on:{click:function($event){return _vm.downloadAttachment(attachment.downloadUrl)}}})])],1)})),1),_vm.diasbleAttachment?_vm._e():_c("form",{staticStyle:{"margin-left":"15px","margin-right":"15px"},attrs:{enctype:"multipart/form-data",novalidate:""}},[_c("div",{staticClass:"dropbox"},[_c("input",{staticClass:"input-file",attrs:{type:"file",multiple:""},on:{change:function($event){return _vm.filesChange($event.target.files)}}}),_c("img",{staticClass:"upload-img mT10 opacity-05",attrs:{src:__webpack_require__(581121),height:"20",width:"20"}}),_c("p",[_vm._v(" "+_vm._s(_vm.$t("common.attachment_form.drag_and_drop_files"))),_c("br"),_vm._v(" "+_vm._s(_vm.$t("common.attachment_form.click_to_browse"))+" ")])])])]),_vm.visibility&&_vm.selectedAttachedFile?_c("preview-file",{attrs:{visibility:_vm.visibility,previewFile:_vm.selectedAttachedFile,files:_vm.attachments},on:{"update:visibility":function($event){_vm.visibility=$event}}}):_vm._e()],1)},staticRenderFns=[],objectSpread2=__webpack_require__(595082),PreviewFile=(__webpack_require__(677049),__webpack_require__(821694),__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(434284),__webpack_require__(891719),__webpack_require__(339772),__webpack_require__(720096)),validation=__webpack_require__(990260),SummaryAttachmentvue_type_script_lang_js={props:["module","record","diasbleAttachment"],data:function(){return{loading:!0,status:{UPLOADING:1,SUCCESS:2,FAILED:3},attachments:[],formFieldName:"attachment",exportDownloadUrl:null,selectedAttachedFile:null,visibility:!1}},components:{PreviewFile:PreviewFile/* default */.Z},mounted:function(){this.loadAttachments()},watch:{record:function(recordObj){this.loadAttachments()}},methods:{selectedFile:function(inList){this.selectedAttachedFile=inList,this.visibility=!0},loadAttachments:function(){var self=this;return self.loading=!0,this.$http.get("/attachment?module="+this.module+"&recordId="+this.record.id).then((function(response){self.loading=!1,self.attachments=response.data.attachments?response.data.attachments:[]})).catch((function(error){error&&(self.loading=!1,self.attachments=null)}))},filesChange:function(files){var _this=this,fileList=Array.from(files);if(fileList.length){
// append the files to FormData
var formData=new FormData;formData.append("module",this.module),formData.append("recordId",this.record.id);var _this$status=this.status,UPLOADING=_this$status.UPLOADING,SUCCESS=_this$status.SUCCESS,FAILED=_this$status.FAILED;fileList.forEach((function(file){var _ref=file||{},name=_ref.name,size=_ref.size,type=_ref.type,fileEntry={fileId:-1,fileName:name,fileSize:size,contentType:type,status:UPLOADING,error:null,previewUrl:null,uploadedBy:_this.$account.user.id};formData.append(_this.formFieldName,file,name),_this.attachments.unshift(fileEntry)})),this.$http.post("/attachment/add",formData).then((function(_ref2){var data=_ref2.data;data.attachments.forEach((function(attachment){var fileId=attachment.fileId,fileName=attachment.fileName,fileSize=attachment.fileSize,attachmentIdx=_this.attachments.findIndex((function(a){return a.fileName===fileName&&a.fileSize===fileSize}));if(!(0,validation/* isEmpty */.xb)(attachmentIdx)){var attachmentFile=_this.attachments[attachmentIdx];attachmentFile=fileId?(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},attachmentFile),attachment),{},{status:SUCCESS}):(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},attachmentFile),{},{status:FAILED,error:"Upload failed."}),_this.$set(_this.attachments,attachmentIdx,attachmentFile)}}))})).catch((function(){fileList.forEach((function(file){var _ref3=file||{},name=_ref3.name,size=_ref3.size,attachmentIdx=_this.attachments.findIndex((function(a){return a.fileName===name&&a.fileSize===size}));if(!(0,validation/* isEmpty */.xb)(attachmentIdx)){var attachmentFile=_this.attachments[attachmentIdx];attachmentFile=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},attachmentFile),{},{status:FAILED,error:"Upload failed."}),_this.$set(_this.attachments,attachmentIdx,attachmentFile)}}))}))}},getUser:function(assign){if(null!==assign&&assign.id){var assignto=this.$store.getters.getUser(assign.id);return assignto?assignto.name:"---"}return"---"},downloadAttachment:function(url){this.exportDownloadUrl=url},icon:function(file){return file&&"image/png"===file?"statics/icons/png.svg":"statics/icons/pdf.svg"}}},relatedlist_SummaryAttachmentvue_type_script_lang_js=SummaryAttachmentvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(relatedlist_SummaryAttachmentvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,SummaryAttachment=component.exports},
/***/120470:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return Notes}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/widget/Notes.vue?vue&type=template&id=3c8171f0
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_vm.componentName?_c(_vm.componentName,_vm._b({key:_vm.recordId,tag:"component"},"component",_vm.$attrs,!1)):_vm._e()],1)},staticRenderFns=[],Notesvue_type_script_lang_js=(__webpack_require__(260228),__webpack_require__(821694),__webpack_require__(76265),{components:{NewNotes:function(){return Promise.all(/* import() */[__webpack_require__.e(93208),__webpack_require__.e(50232),__webpack_require__.e(93765),__webpack_require__.e(95953),__webpack_require__.e(35309),__webpack_require__.e(18778),__webpack_require__.e(12303),__webpack_require__.e(84290),__webpack_require__.e(31721),__webpack_require__.e(64418),__webpack_require__.e(5603),__webpack_require__.e(57432),__webpack_require__.e(435),__webpack_require__.e(72230),__webpack_require__.e(94255),__webpack_require__.e(67683),__webpack_require__.e(44178),__webpack_require__.e(91132),__webpack_require__.e(20280),__webpack_require__.e(78256),__webpack_require__.e(22200),__webpack_require__.e(49081),__webpack_require__.e(89472),__webpack_require__.e(12085),__webpack_require__.e(55754),__webpack_require__.e(86494),__webpack_require__.e(3037),__webpack_require__.e(49908),__webpack_require__.e(22061),__webpack_require__.e(31602),__webpack_require__.e(73609),__webpack_require__.e(89142),__webpack_require__.e(19347)]).then(__webpack_require__.bind(__webpack_require__,116920))},OldNotes:function(){return Promise.all(/* import() */[__webpack_require__.e(93208),__webpack_require__.e(50232),__webpack_require__.e(93765),__webpack_require__.e(95953),__webpack_require__.e(35309),__webpack_require__.e(18778),__webpack_require__.e(12303),__webpack_require__.e(84290),__webpack_require__.e(31721),__webpack_require__.e(64418),__webpack_require__.e(5603),__webpack_require__.e(57432),__webpack_require__.e(435),__webpack_require__.e(72230),__webpack_require__.e(94255),__webpack_require__.e(67683),__webpack_require__.e(44178),__webpack_require__.e(91132),__webpack_require__.e(20280),__webpack_require__.e(78256),__webpack_require__.e(22200),__webpack_require__.e(49081),__webpack_require__.e(89472),__webpack_require__.e(12085),__webpack_require__.e(55754),__webpack_require__.e(86494),__webpack_require__.e(3037),__webpack_require__.e(49908),__webpack_require__.e(22061),__webpack_require__.e(31602),__webpack_require__.e(73609),__webpack_require__.e(19037)]).then(__webpack_require__.bind(__webpack_require__,919037))}},computed:{componentName:function(){return this.$helpers.isLicenseEnabled("NEW_COMMENTS")?"NewNotes":"OldNotes"},recordId:function(){return this.$getProperty(this.$attrs,"record.id")}}}),widget_Notesvue_type_script_lang_js=Notesvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(widget_Notesvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,Notes=component.exports},
/***/455360:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return WorkOrderSummaryPdfOptions}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/workorder/workorders/v1/WorkOrderSummaryPdfOptions.vue?vue&type=template&id=0c2591ac&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_vm.visibility?_c("el-dialog",{attrs:{"append-to-body":!0,title:_vm.title,visible:_vm.visibility,width:"28%","before-close":_vm.closeDialog,"custom-class":"fc-dialog-center-container scale-up-center"},on:{"update:visible":function($event){_vm.visibility=$event}}},[_c("div",{staticClass:"height300"},[_c("el-checkbox",{model:{value:_vm.checked,callback:function($$v){_vm.checked=$$v},expression:"checked"}},[_vm._v(_vm._s(_vm.$t("common.wo_report.show_photo")))]),_c("el-checkbox",{staticClass:"pT20",model:{value:_vm.showAttachement,callback:function($$v){_vm.showAttachement=$$v},expression:"showAttachement"}},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.show_attachement"))+" "),_c("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:_vm.$t("common.wo_report.prints_image_type"),placement:"bottom"}},[_c("i",{staticClass:"el-icon-info capp-linkname"})])],1),_c("el-checkbox",{staticClass:"pT20",model:{value:_vm.showComments,callback:function($$v){_vm.showComments=$$v},expression:"showComments"}},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.show_comments"))+" ")]),_c("el-checkbox",{staticClass:"pT20 mR100",model:{value:_vm.showHistory,callback:function($$v){_vm.showHistory=$$v},expression:"showHistory"}},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.show_history"))+" ")]),_c("el-checkbox",{staticClass:"pT20",model:{value:_vm.useSiteLogo,callback:function($$v){_vm.useSiteLogo=$$v},expression:"useSiteLogo"}},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.use_site_logo"))+" ")]),_c("el-checkbox",{staticClass:"pT20",model:{value:_vm.showSignature,callback:function($$v){_vm.showSignature=$$v},expression:"showSignature"}},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.show_signature"))+" ")])],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){return _vm.closeDialog()}}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.disableDownloadButton},on:{click:function($event){_vm.isDownloadOption?_vm.downloadWorkOrder():_vm.printWorkOrder()}}},[_vm._v(_vm._s(_vm.confirmButtonText)+" ")])],1)]):_vm._e()],1)},staticRenderFns=[],objectSpread2=__webpack_require__(595082),router=(__webpack_require__(260228),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(779307),__webpack_require__(398858),__webpack_require__(461318),__webpack_require__(33228),__webpack_require__(634338),__webpack_require__(212826),__webpack_require__(329435)),vuex_esm=__webpack_require__(420629),WorkOrderSummaryPdfOptionsvue_type_script_lang_js={
//props: ['visibility', 'workorders', 'viewName', 'isDownloadOption', 'pdfUrl'],
props:{visibility:{type:Boolean,default:!1},workorders:{type:Array,default:function(){return[]}},viewName:{type:String,default:""},isDownloadOption:{type:Boolean,default:!1},pdfUrl:{type:String,default:""},isPdfDownload:{type:Boolean,default:!1}},data:function(){return{checked:!1,showAttachement:!1,showComments:!1,showHistory:!1,useSiteLogo:!1,showSignature:!0}},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({currentTab:function(state){return state.webtabs.selectedTab},currentGroup:function(state){return state.webtabs.selectedTabGroup}})),{},{selected:function(){return this.data.checked},title:function(){var isDownloadOption=this.isDownloadOption;return isDownloadOption?this.$t("common.wo_report.download_options"):this.$t("common.wo_report.print_options")},confirmButtonText:function(){var isDownloadOption=this.isDownloadOption;return isDownloadOption?this.$t("common.wo_report.download"):this.$t("common.wo_report.print")},disableDownloadButton:function(){var isDownloadOption=this.isDownloadOption,isPdfDownload=this.isPdfDownload;return isDownloadOption&&isPdfDownload}}),methods:{closeDialog:function(){this.$emit("update:visibility",!1)},getFileUrl:function(){var workorders=this.workorders,checked=this.checked,showAttachement=this.showAttachement,showComments=this.showComments,showHistory=this.showHistory,useSiteLogo=this.useSiteLogo,showSignature=this.showSignature,viewName=this.viewName,_getApp=(0,router/* getApp */.wx)(),linkName=_getApp.linkName,appName="newapp"===linkName?"app":linkName,query=new URLSearchParams;if(query.append("workorderId",workorders),query.append("showImage",checked),query.append("showAttachements",showAttachement),query.append("showComments",showComments),query.append("showHistory",showHistory),query.append("useSiteLogo",useSiteLogo),query.append("showSignature",showSignature),query.append("viewName",viewName),(0,router/* isWebTabsEnabled */.tj)()){var currentTab=this.currentTab,currentGroup=this.currentGroup;query.append("currentTabId",currentTab.id),query.append("currentGroupId",currentGroup.id)}var url="".concat(window.location.origin,"/").concat(appName,"/pdf/summarydownloadreport?").concat(query.toString());return url},printWorkOrder:function(){var getFileUrl=this.getFileUrl,url=getFileUrl();window.open(url)},downloadWorkOrder:function(){var getFileUrl=this.getFileUrl,url=getFileUrl();this.$emit("update:pdfUrl",url)}}},v1_WorkOrderSummaryPdfOptionsvue_type_script_lang_js=WorkOrderSummaryPdfOptionsvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(v1_WorkOrderSummaryPdfOptionsvue_type_script_lang_js,render,staticRenderFns,!1,null,"0c2591ac",null)
/* harmony default export */,WorkOrderSummaryPdfOptions=component.exports},
/***/385678:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return WorkOrderList}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/workorder/workorders/v3/WorkOrderList.vue?vue&type=template&id=9ac07962&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("CommonListLayout",{key:_vm.moduleName+"-list-layout",staticClass:"custom-module-list-layout",attrs:{moduleName:_vm.moduleName,showViewRearrange:!0,showViewEdit:!0,visibleViewCount:3,getPageTitle:function(){return _vm.moduleDisplayName},pathPrefix:"/app/wo/orders",hideSubHeader:_vm.canHideSubHeader,recordCount:_vm.recordCount,recordLoading:_vm.showLoading},scopedSlots:_vm._u([{key:"header",fn:function(){return[_vm.canHideFilter?_vm._e():_c("AdvancedSearchWrapper",{key:"ftags-list-"+_vm.moduleName,attrs:{filters:_vm.filters,moduleName:_vm.moduleName,moduleDisplayName:_vm.moduleDisplayName}}),_vm.canShowVisualSwitch?_c("visual-type",{on:{onSwitchVisualize:function(val){return _vm.canShowListView=val}}}):_vm._e(),_c("CustomButton",{attrs:{moduleName:_vm.moduleName,position:_vm.POSITION.LIST_TOP,transformFn:_vm.transformFormData,updateUrl:_vm.updateUrlString},on:{onSuccess:_vm.onCustomButtonSuccess,onError:function(){}}}),_vm.hasCreatePermission?_c("button",{staticClass:"fc-create-btn",on:{click:function($event){return _vm.openWOCreate()}}},[_vm._v(" "+_vm._s(_vm.$t("common.products.new_workorder"))+" ")]):_vm._e()]},proxy:!0},_vm.canShowCalendarHeader?{key:"sub-header",fn:function(){return[_vm.showListView?_vm._e():_c("CalendarDateWrapper")]},proxy:!0}:null,{key:"sub-header-actions",fn:function(){return[!_vm.isEmpty(_vm.records)&&_vm.showListView?[_c("pagination",{staticClass:"pL15 fc-black-small-txt-12",attrs:{total:_vm.recordCount,currentPageCount:_vm.currentPageCount,perPage:_vm.perPage,skipTotalCount:!0}}),_vm.recordCount?_c("span",{staticClass:"separator pL0"},[_vm._v("| ")]):_vm._e(),_c("el-tooltip",{attrs:{effect:"dark",content:_vm.$t("common._common.sort"),"open-delay":500,placement:"top"}},[_c("Sort",{key:_vm.moduleName+"-sort",attrs:{moduleName:_vm.moduleName},on:{onSortChange:_vm.updateSort}})],1),_c("span",{staticClass:"separator pL10"},[_vm._v(" |")]),_c("el-tooltip",{attrs:{effect:"dark",content:_vm.$t("common._common.export"),"open-delay":500,placement:"top"}},[_c("FExportSettings",{attrs:{module:_vm.moduleName,viewDetail:_vm.viewDetail,showViewScheduler:!0,showMail:!0,filters:_vm.filters}})],1)]:_vm._e()]},proxy:!0},_vm.showBulkActionBar()&&this.$helpers.isLicenseEnabled("BULK_UPDATE")?{key:"sub-header-selectedall",fn:function(){return[_c("div",{staticClass:"bulk-update-bar"},[_c("NewBulkActionBar",{ref:"bulk-action-bar",attrs:{visible:"true",totalCount:_vm.recordCount,perPage:_vm.perPage,isAllSelected:_vm.isAllSelected,moduleName:_vm.moduleName,selectedItem:_vm.selectedListItemsObj.length,limit:_vm.bulkActionAcount},on:{"update:isAllSelected":function($event){_vm.isAllSelected=$event},"update:is-all-selected":function($event){_vm.isAllSelected=$event},change:_vm.validateTotalCount}})],1)]},proxy:!0}:null,{key:"content",fn:function(){return[_vm.showLoading?_c("Spinner",{staticClass:"mT40",attrs:{show:_vm.showLoading}}):_c("div",{staticClass:"height100 pB10"},[_vm.showListView?_c("div",{staticClass:"fc-card-popup-list-view"},[_c("div",{staticClass:"\n          fc-list-view\n          fc-list-table-container\n          fc-table-td-height fc-table-viewchooser\n          pB100\n        "},[_vm.$validation.isEmpty(_vm.records)&&!_vm.showLoading?_c("div",{staticClass:"\n            fc-list-empty-state-container m10 mT0\n          "},[_c("inline-svg",{attrs:{src:"svgs/emptystate/workorder",iconClass:"icon text-center icon-xxxxlg"}}),_c("div",{staticClass:"nowo-label"},[_vm._v(" "+_vm._s(_vm.$t("common.products.no_workorders_available"))+" ")])],1):_vm._e(),_vm.showLoading||_vm.$validation.isEmpty(_vm.records)?_vm._e():_c("div",{staticClass:"m10 mT0"},[_c("div",{staticClass:"column-customization-icon",attrs:{disabled:!_vm.isColumnCustomizable},on:{click:_vm.toShowColumnSettings}},[_c("el-tooltip",{attrs:{disabled:_vm.isColumnCustomizable,placement:"top",content:_vm.$t("common._common.you_dont_have_permission")}},[_c("inline-svg",{staticClass:"text-center position-absolute icon",attrs:{src:"column-setting"}})],1)],1),_vm.$validation.isEmpty(_vm.selectedListItemsObj)?_vm._e():_c("div",{staticClass:"pull-left table-header-actions"},[_vm.hasChangeOwnershipPermission&&_vm.showBulkAssign?_c("span",[_c("el-popover",{attrs:{placement:"right",width:"auto",trigger:"click","popper-class":"fcPopover"}},[_c("div",{staticClass:"max-height400 overflo-auto"},[_vm._l(_vm.users,(function(u){return _c("ul",{key:u.email,staticClass:"text item"},[_c("li",{staticClass:"el-dropdown-menu__item",class:{disabled:_vm.isLoading},attrs:{slot:"reference"},on:{click:function($event){return _vm.assignWOToUser(_vm.selectedListItemsIds,u)}},slot:"reference"},[_vm._v(" "+_vm._s(u.name+" | "+u.email)+" ")])])})),_vm._l(_vm.groups,(function(g){return _c("ul",{key:g.id,staticClass:"text item"},[_c("li",{staticClass:"el-dropdown-menu__item",class:{disabled:_vm.isLoading},attrs:{slot:"reference"},on:{click:function($event){return _vm.assignWOToGroup(_vm.selectedListItemsIds,g)}},slot:"reference"},[_vm._v(" "+_vm._s(g.name)+" ")])])}))],2),_c("button",{staticClass:"btn btn--tertiary wo-table-btn-spacing",class:{disabled:_vm.isLoading},attrs:{slot:"reference",disabled:_vm.isDisable},slot:"reference"},[_c("inline-svg",{attrs:{src:"svgs/user2",iconClass:"icon vertical-middle icon-sm fill-grey2"}}),_vm._v(" "+_vm._s(_vm.$t("common._common.assign"))+" ")],1)])],1):_vm._e(),_vm.hasWorkOrderClosePermission&&_vm.showBulkClose?_c("button",{staticClass:"btn btn--tertiary wo-table-btn-spacing",class:{disabled:_vm.isLoading},attrs:{disabled:_vm.isDisable},on:{click:function($event){return _vm.closeWO(_vm.selectedListItemsIds)}}},[_c("inline-svg",{attrs:{src:"done",iconClass:"icon vertical-middle icon-sm fill-grey2"}}),_vm._v(" "+_vm._s(_vm.$t("common._common.close"))+" ")],1):_vm._e(),_vm.hasUpdatePermission?_c("button",{staticClass:"btn btn--tertiary wo-table-btn-spacing",class:{disabled:_vm.isLoading},on:{click:function($event){return _vm.OpenBulkUpdate()}}},[_c("inline-svg",{attrs:{src:"svgs/edit",iconClass:"icon vertical-middle icon-sm fill-grey2"}}),_vm._v(" "+_vm._s(_vm.$t("common._common.bulk_update"))+" ")],1):_vm._e(),_vm.hasDeletePermission?_c("span",[_c("button",{staticClass:"btn btn--tertiary wo-table-btn-spacing",class:{disabled:_vm.isLoading},attrs:{disabled:_vm.isDisable},on:{click:function($event){return _vm.deleteRecords(_vm.selectedListItemsIds)}}},[_c("inline-svg",{attrs:{src:"svgs/delete",iconClass:"icon vertical-middle icon-sm fill-grey2"}}),_vm._v(" "+_vm._s(_vm.$t("common._common.delete"))+" ")],1)]):_vm._e(),_c("button",{staticClass:"btn btn--tertiary wo-table-btn-spacing",attrs:{disabled:_vm.isDisable},on:{click:function($event){_vm.openPrintOptions=!0}}},[_c("inline-svg",{attrs:{src:"svgs/print2",iconClass:"icon vertical-middle icon-sm fill-grey2"}}),_vm._v(" "+_vm._s(_vm.$t("common._common.print"))+" ")],1),_vm.isDisable?_vm._e():_c("CustomButton",{key:_vm.moduleName+"_"+_vm.viewname+"_"+_vm.POSITION.LIST_BAR,staticClass:"custom-button mL10 inline-block",attrs:{modelDataClass:_vm.modelDataClass,moduleName:_vm.moduleName,position:_vm.POSITION.LIST_BAR,selectedRecords:_vm.selectedListItemsObj},on:{onSuccess:_vm.onCustomButtonSuccess,onError:function(){}}}),_vm.openPrintOptions?_c("workorder-options",{attrs:{workorders:_vm.selectedListItemsIds,visibility:_vm.openPrintOptions,viewName:_vm.viewname},on:{"update:visibility":function($event){_vm.openPrintOptions=$event}}}):_vm._e(),_vm.enableNewBulkUpdate()?[_vm.bulkAction?_c("new-bulk-update-viewer",{ref:"bulk-update-dialog",attrs:{module:"workorder",fieldlist:_vm.filteredBulkActionFieldList,recordCount:_vm.recordCount,"content-css":{padding:"0px",background:"#f7f8fa",Width:"10vw",Height:"30vh"}},on:{submit:_vm.newbulkActionHandler,closed:_vm.handleBulkActiondialogClose}}):_vm._e()]:[_vm.bulkAction?_c("bulk-update-viewer",{attrs:{module:"workorder",fieldlist:_vm.filteredBulkActionFieldList,"content-css":{padding:"0px",background:"#f7f8fa",Width:"10vw",Height:"30vh"}},on:{submit:_vm.bulkActionHandler,closed:_vm.closeBulkActionDialog}}):_vm._e()]],2),_c("CommonList",{attrs:{moduleName:_vm.moduleName,viewDetail:_vm.filteredViewDetail,records:_vm.records,slotList:_vm.slotList,redirectToOverview:_vm.redirectToOverview,refreshList:_vm.onCustomButtonSuccess},on:{"selection-change":_vm.selectItems},scopedSlots:_vm._u([{key:_vm.slotList[0].name,fn:function(ref){var record=ref.record;return[_c("div",{staticClass:"fc-id"},[_vm._v(" "+_vm._s("#"+_vm.$getProperty(record,"localId","---"))+" ")])]}},{key:_vm.slotList[1].criteria,fn:function(ref){var record=ref.record;return[_c("div",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"flex-middle",attrs:{small:"",title:_vm.$getProperty(record,"subject","---")}},[_c("router-link",{staticClass:"fw5 label-txt-black ellipsis subject-underline",attrs:{to:_vm.openWorkorderOverview(record.id)}},[_vm._v(" "+_vm._s(_vm.$getProperty(record,"subject","---"))+" ")])],1)]}},{key:_vm.slotList[2].criteria,fn:function(ref){var record=ref.record;return[_c("div",{staticClass:"d-flex",on:{click:function($event){return _vm.showComments(record)}}},[_c("inline-svg",{staticClass:"vertical-middle flex-middle",attrs:{src:"comment",iconClass:"icon icon-xs text-center"}}),_c("div",{staticClass:"mL5"},[_vm._v(" "+_vm._s(_vm.$getProperty(record,"noOfNotes","0"))+" ")])],1)]}},{key:_vm.slotList[3].criteria,fn:function(ref){var record=ref.record;return[_c("div",{staticClass:"d-flex"},[_vm.$getProperty(record,"noOfTasks",0)?_c("inline-svg",{staticClass:"mR5",attrs:{src:"done",iconClass:"icon vertical-middle icon-xs fill-grey2"}}):_vm._e(),_c("div",[_vm._v(_vm._s(_vm.formatTaskCompletionStatus(record)))])],1)]}},{key:_vm.slotList[4].criteria,fn:function(ref){var record=ref.record;return[_c("div",[_c("span",{on:{click:function($event){return _vm.showAttachments(record)}}},[_vm.$getProperty(record,"noOfAttachments",0)?_c("inline-svg",{attrs:{src:"svgs/attachment-icon",iconClass:"icon vertical-middle icon-sm fill-grey2"}}):_vm._e(),_vm._v(" "+_vm._s(_vm.$getProperty(record,"noOfAttachments","---"))+" ")],1)])]}},{key:_vm.slotList[5].name,fn:function(ref){var record=ref.record;return[_c("div",{staticClass:"text-center"},[_vm.canDeleteRecord(record)?_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-delete pointer edit-icon-color visibility-hide-actions mL10",attrs:{"data-arrow":"true",title:_vm.$t("common.header.delete_workorder")},on:{click:function($event){return _vm.deleteRecords([record.id])}}}):_vm._e()])]}},{key:_vm.slotList[6].criteria,fn:function(ref){var record=ref.record;return[_vm.canEditRecord(record)?_c("el-popover",{attrs:{placement:"bottom",width:"200","popper-class":"fcPopover"}},[_c("div",{staticClass:"max-height400 overflo-auto"},[_c("ul",_vm._l(_vm.ticketType,(function(value,key){return _c("li",{key:key,staticClass:"el-dropdown-menu__item",on:{click:function($event){return _vm.updateRecordType(record,value)}}},[_vm._v(" "+_vm._s(value.name)+" ")])})),0)]),_c("span",{attrs:{slot:"reference"},slot:"reference"},[_vm._v(" "+_vm._s(_vm.getTicketTypeName(record))+" "),_vm.canEditRecord(record)?_c("i",{staticClass:"\n                      fa fa-sort-desc\n                      wl-icon-downarrow\n                      picklist-downarrow\n                    ",attrs:{"aria-hidden":"true"}}):_vm._e()])]):_c("div",[_vm._v(" "+_vm._s(_vm.getTicketTypeName(record))+" ")])]}},{key:_vm.slotList[7].criteria,fn:function(ref){var record=ref.record;return[_vm.canEditRecord(record)?_c("el-popover",{attrs:{placement:"bottom",width:"200",trigger:"click","popper-class":"fcPopover"}},[_c("div",{staticClass:"max-height400 overflo-auto"},[_c("ul",_vm._l(_vm.ticketPriority,(function(value,key){return _c("li",{key:key,staticClass:"el-dropdown-menu__item",on:{click:function($event){return _vm.updateRecordPriority(record,value)}}},[_vm._v(" "+_vm._s(value.displayName)+" ")])})),0)]),_c("div",{attrs:{slot:"reference"},slot:"reference"},[_vm.$getProperty(record,"priority","---")?_c("i",{staticClass:"fa fa-circle prioritytag",style:{color:_vm.$getProperty(record,"priority.colour","---")},attrs:{"aria-hidden":"true"}}):_vm._e(),_vm._v(" "+_vm._s(_vm.getWorkorderPriority(record))+" "),_c("i",{staticClass:"\n                      fa fa-sort-desc\n                      wl-icon-downarrow\n                      picklist-downarrow\n                    ",attrs:{"aria-hidden":"true"}})])]):_c("div",[_vm.$getProperty(record,"priority","---")?_c("i",{staticClass:"fa fa-circle prioritytag",style:{color:_vm.$getProperty(record,"priority.colour","---")},attrs:{"aria-hidden":"true"}}):_vm._e(),_vm._v(" "+_vm._s(_vm.getWorkorderPriority(record))+" ")])]}},{key:_vm.slotList[8].criteria,fn:function(ref){var record=ref.record;return[_vm.canEditRecord(record)?_c("el-popover",{attrs:{placement:"bottom",width:"200",trigger:"click","popper-class":"fcPopover"}},[_c("div",{staticClass:"max-height400 overflo-auto"},[_c("ul",_vm._l(_vm.ticketcategory,(function(value,key){return _c("li",{key:key,staticClass:"el-dropdown-menu__item",on:{click:function($event){return _vm.updateRecordCategory(record,value)}}},[_vm._v(" "+_vm._s(value.displayName)+" ")])})),0)]),_c("div",{attrs:{slot:"reference"},slot:"reference"},[_vm._v(" "+_vm._s(_vm.getLookUpDisplayName("category",record)||"---")+" "),_c("i",{staticClass:"\n                      fa fa-sort-desc\n                      wl-icon-downarrow\n                      picklist-downarrow\n                    ",attrs:{"aria-hidden":"true"}})])]):_c("div",[_vm._v(" "+_vm._s(_vm.getLookUpDisplayName("category",record)||"---")+" ")])]}},{key:_vm.slotList[9].criteria,fn:function(ref){var record=ref.record;return[_c("div",{on:{click:function($event){return _vm.canShowSpaceAssetChooser(record)}}},[_vm.isResourceAvailable(record)?_c("div",{staticClass:"d-flex"},[_c("div",{staticClass:"pR5"},[_vm.getResourceType(record)?_c("img",{staticStyle:{height:"12px",width:"14px"},attrs:{src:__webpack_require__(572902)}}):_c("img",{staticStyle:{height:"11px",width:"14px"},attrs:{src:__webpack_require__(30684)}})]),_c("div",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"q-item-label ellipsis max-width140px",attrs:{small:"","data-position":"bottom",title:_vm.$getProperty(record,"resource.name","---")}},[_vm._v(" "+_vm._s(_vm.$getProperty(record,"resource.name","---"))+" ")])]):_c("div",[_c("span",{staticClass:"q-item-label secondary-color color-d"},[_vm._v(" ---"+_vm._s(_vm.$t("maintenance.wr_list.space_asset"))+"--- ")])])])]}},{key:_vm.slotList[10].criteria,fn:function(ref){var record=ref.record;return[_c("div",{staticClass:"wo-assigned-avatar fL"},[_c("user-avatar",{attrs:{size:"md",user:_vm.$getProperty(record,"assignedTo",{}),group:_vm.$getProperty(record,"assignmentGroup",{}),showPopover:!0,showLabel:!0,moduleName:"workorder"}})],1),_vm.canShowTeamStaffChooser(record)?_c("f-assignment",{attrs:{viewtype:"view",record:record,siteId:_vm.$getProperty(record,"siteId",null)},on:{assignactivity:_vm.onAssignWo}}):_vm._e()]}},{key:_vm.slotList[11].name,fn:function(ref){var record=ref.record;return[_c("CustomButton",{staticClass:"custom-button",attrs:{moduleName:_vm.moduleName,record:record,position:_vm.POSITION.LIST_ITEM,transformFn:_vm.transformFormData,updateUrl:_vm.updateUrlString},on:{onSuccess:_vm.onCustomButtonSuccess,onError:function(){}}})]}}],null,!0)})],1)])]):_vm.showListView?_vm._e():_c("CalendarView",{ref:"calendar",attrs:{moduleName:_vm.moduleName,record:_vm.records,viewDetail:_vm.viewDetail,viewname:_vm.viewname,filters:_vm.filters}})],1),_c("outside-click",{staticClass:"comment-dialog",staticStyle:{top:"50px",position:"fixed"},style:_vm.commentDailogWidth,attrs:{visibility:_vm.showCommentsWindow}},[_c("div",[_c("div",{staticClass:"comment-dialog-header"},[_c("h3",{staticClass:"comment-dialog-heading",staticStyle:{"text-transform":"uppercase"}},[_vm._v(" "+_vm._s(_vm.$t("maintenance.wr_list.comments"))+" "),_c("span",[_vm._v(" "+_vm._s(_vm.selectedWorkorder.noOfNotes>0?"("+_vm.selectedWorkorder.noOfNotes+")":"")+" ")])]),_c("div",{staticClass:"comment-close"},[_c("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Close",placement:"bottom"}},[_c("i",{staticClass:"el-icon-close",attrs:{"aria-hidden":"true"},on:{click:function($event){_vm.showCommentsWindow=!1}}})])],1)]),_c("div",{staticClass:"comment-dialog-body"},[_c("comments",{attrs:{module:"ticketnotes",parentModule:"workorder",record:_vm.selectedWorkorder,setNoOfNotesLength:_vm.setNoOfNotesLength}})],1)])]),_c("outside-click",{staticClass:"comment-dialog",attrs:{visibility:_vm.showAttachmentsWindow}},[_c("div",[_c("div",{staticClass:"comment-dialog-header"},[_c("h3",{staticClass:"comment-dialog-heading",staticStyle:{"text-transform":"uppercase"}},[_vm._v(" "+_vm._s(_vm.$t("maintenance.wr_list.attachments"))+" "),_c("span",[_vm._v(" "+_vm._s(_vm.selectedWorkorder.noOfAttachments>0?"("+_vm.selectedWorkorder.noOfAttachments+")":"")+" ")])]),_c("div",{staticClass:"comment-close"},[_c("i",{staticClass:"el-icon-close",attrs:{"aria-hidden":"true"},on:{click:function($event){_vm.showAttachmentsWindow=!1}}})])]),_c("div",{staticClass:"comment-dialog-body"},[_c("attachments",{attrs:{module:"ticketattachments",record:_vm.selectedWorkorder,diasbleAttachment:!0}})],1)])]),_c("column-customization",{attrs:{visible:_vm.showColumnSettings,moduleName:"workorder",viewName:_vm.viewname},on:{"update:visible":function($event){_vm.showColumnSettings=$event}}}),_vm.showSpaceAssetDialog?_c("space-asset-chooser",{attrs:{visibility:_vm.showSpaceAssetDialog,filter:_vm.filter()},on:{associate:_vm.associateSpaceAsset,"update:visibility":function($event){_vm.showSpaceAssetDialog=$event}}}):_vm._e(),_vm.showPreview&&_vm.selectedFile?_c("preview-file",{attrs:{visibility:_vm.showPreview,previewFile:_vm.selectedFile,files:[_vm.selectedFile]},on:{"update:visibility":function($event){_vm.showPreview=$event}}}):_vm._e(),_c("portal",{attrs:{to:"view-manager-link"}},[_c("router-link",{staticClass:"view-manager-btn",attrs:{tag:"div",to:"/app/wo/"+_vm.moduleName+"/viewmanager"}},[_c("inline-svg",{staticClass:"d-flex",attrs:{src:"svgs/hamburger-menu",iconClass:"icon icon-sm"}}),_c("span",{staticClass:"label mL10 text-uppercase"},[_vm._v(" "+_vm._s(_vm.$t("viewsmanager.list.views_manager"))+" ")])],1)],1)]},proxy:!0}],null,!0)})},staticRenderFns=[],createForOfIteratorHelper=__webpack_require__(566347),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),objectSpread2=__webpack_require__(595082),ViewMixin=(__webpack_require__(634338),__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(434284),__webpack_require__(648324),__webpack_require__(425728),__webpack_require__(670560),__webpack_require__(947522),__webpack_require__(339772),__webpack_require__(162506),__webpack_require__(879288),__webpack_require__(453877)),workorderHelper=__webpack_require__(865764),validation=__webpack_require__(586529),api=__webpack_require__(32284),vuex_esm=__webpack_require__(420629),NewBulkUpdateViewer=__webpack_require__(962223),PreviewFile=__webpack_require__(720096),WorkOrderSummaryPdfOptions=__webpack_require__(455360),Comments2=__webpack_require__(487565),SummaryAttachment=__webpack_require__(526971),OutsideClick=__webpack_require__(21864),SpaceAssetChooser=__webpack_require__(372587),User=__webpack_require__(426803),FAssignment=__webpack_require__(383274),BulkUpdateViewer=__webpack_require__(574655),router=__webpack_require__(329435),moment_timezone=__webpack_require__(480008),moment_timezone_default=__webpack_require__.n(moment_timezone),columnConfigUtil=__webpack_require__(486613),OtherMixin=__webpack_require__(964967),NewBulkActionBar=__webpack_require__(844611),CommonModuleList=__webpack_require__(347446),WorkOrderListvue_type_script_lang_js={mixins:[ViewMixin/* default */.Z,workorderHelper/* default */.Z,OtherMixin/* default */.Z],extends:CommonModuleList["default"],name:"WorkorderList",components:{PreviewFile:PreviewFile/* default */.Z,NewBulkUpdateViewer:NewBulkUpdateViewer/* default */.Z,workorderOptions:WorkOrderSummaryPdfOptions/* default */.Z,Comments:Comments2/* default */.Z,OutsideClick:OutsideClick/* default */.Z,Attachments:SummaryAttachment/* default */.Z,SpaceAssetChooser:SpaceAssetChooser/* default */.Z,UserAvatar:User/* default */.Z,FAssignment:FAssignment/* default */.Z,NewBulkActionBar:NewBulkActionBar/* default */.Z,BulkUpdateViewer:BulkUpdateViewer/* default */.Z},created:function(){this.$store.dispatch("loadTicketStatus",this.moduleName),this.$store.dispatch("view/loadModuleMeta",this.moduleName),this.$store.dispatch("loadTicketType"),this.$store.dispatch("loadTicketPriority"),this.$store.dispatch("loadTicketCategory")},data:function(){return{bulkAction:!1,bulkActionAcount:0,bulkActionFieldList:["requester","assignedTo","category","dueDate","priority","type","resource","vendor"],openPrintOptions:!1,actions:{assignLoading:!1,closeLoading:!1,deleteLoading:!1},selectedFile:null,showPreview:!1,showCommentsWindow:!1,showAttachmentsWindow:!1,selectedWorkorder:{},showSpaceAssetDialog:!1,perPage:20,isAllSelected:!1,isDisable:!1,isBulkUpdateVisible:!1,updateBulkRecord:!0}},mounted:function(){this.updateLimit()},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapGetters */.Se)(["getTicketStatus","isStatusLocked","getTicketType","getApprovalStatus","getTicketPriority","getTicketCategory"])),(0,vuex_esm/* mapState */.rn)({users:function(state){return state.users},groups:function(state){return state.groups},ticketType:function(state){return state.ticketType},ticketcategory:function(state){return state.ticketCategory},ticketPriority:function(state){return state.ticketPriority}})),{},{showBulkBar:function(){var _ref=this||{};_ref.totalCount,_ref.pePage;return recordCount},moduleDisplayName:function(){return"Workorder"},isWoStateTransitionLicenseEnabled:function(){return this.$helpers.isLicenseEnabled("WO_STATE_TRANSITION_V3")},updateUrlString:function(){return this.isWoStateTransitionLicenseEnabled?null:"v2/workorders/update"},showBulkClose:function(){
// hiding bulk close for Aster
var ASTER=583;return this.$org.id!==ASTER},showBulkAssign:function(){
// hiding bulk assign for Aster
var ASTER=583;return this.$org.id!==ASTER},filteredViewColumns:function(){var viewColumns=this.viewColumns,_getColumnConfig=(0,columnConfigUtil/* getColumnConfig */.U)(this.moduleName),fixedColumns=_getColumnConfig.fixedColumns,fixedSelectableColumns=_getColumnConfig.fixedSelectableColumns,finalFixedColumns=fixedColumns.concat(fixedSelectableColumns);return(0,validation/* isEmpty */.xb)(viewColumns)?[]:viewColumns.filter((function(column){return!finalFixedColumns.includes(column.name)}))},slotList:function(){return[{name:"id",isHardcodedColumn:!0,columnAttrs:{"min-width":150,fixed:"left",label:"ID"}},{criteria:JSON.stringify({name:"subject"})},{criteria:JSON.stringify({name:"noOfNotes"})},{criteria:JSON.stringify({name:"noOfTasks"})},{criteria:JSON.stringify({name:"noOfAttachments"})},{name:"editColumn",isActionColumn:!0,columnAttrs:{width:130,class:"visibility-visible-actions",fixed:"right",align:"right"}},{criteria:JSON.stringify({name:"type"})},{criteria:JSON.stringify({name:"priority"})},{criteria:JSON.stringify({name:"category"})},{criteria:JSON.stringify({name:"resource"})},{criteria:JSON.stringify({name:"assignedTo"})},{name:"customButton",isActionColumn:!0,columnAttrs:{width:200,class:"visibility-visible-actions"}}]},
/* filteredViewDetail filters and keeps the comments, tasks, attachement
      columns at the end and removes the column-header of it.
    */
filteredViewDetail:function(){var viewDetail=this.viewDetail,_ref2=viewDetail||{},fields=_ref2.fields,defaultModuleFields=_ref2.defaultModuleFields;if(!(0,validation/* isEmpty */.xb)(fields)){var notes=fields.find((function(column){return"noOfNotes"===column.name})),tasks=fields.find((function(column){return"noOfTasks"===column.name})),attachments=fields.find((function(column){return"noOfAttachments"===column.name})),columnAttrs={"min-width":80};fields=fields.filter((function(column){return!["noOfNotes","noOfTasks","noOfAttachments"].includes(column.name)})),(0,validation/* isEmpty */.xb)(tasks)||(tasks=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},tasks),{},{columnDisplayName:"",field:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},tasks.field),{},{displayName:""}),columnAttrs:columnAttrs}),fields.push(tasks)),(0,validation/* isEmpty */.xb)(notes)||(notes=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},notes),{},{columnDisplayName:"",field:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},notes.field),{},{displayName:""}),columnAttrs:columnAttrs}),fields.push(notes)),(0,validation/* isEmpty */.xb)(attachments)||(attachments=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},attachments),{},{columnDisplayName:"",field:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},attachments.field),{},{displayName:""}),columnAttrs:columnAttrs}),fields.push(attachments));var customizeDisplayNames={},_ref3=defaultModuleFields||{},noOfTasks=_ref3.noOfTasks,noOfNotes=_ref3.noOfNotes;(0,validation/* isEmpty */.xb)(noOfTasks)||(customizeDisplayNames=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},customizeDisplayNames),{},{noOfTasks:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},noOfTasks),{},{columnDisplayName:""})})),(0,validation/* isEmpty */.xb)(noOfNotes)||(customizeDisplayNames=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},customizeDisplayNames),{},{noOfNotes:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},noOfNotes),{},{columnDisplayName:""})})),viewDetail=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},viewDetail),{},{fields:fields,defaultModuleFields:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},defaultModuleFields),customizeDisplayNames)})}return viewDetail},hasChangeOwnershipPermission:function(){return(0,router/* isWebTabsEnabled */.tj)()?this.$hasPermission("".concat(this.moduleName,":UPDATE_CHANGE_OWNERSHIP")):this.$hasPermission("".concat(this.moduleName,":CHANGE_OWNERSHIP"))},hasDeletePermission:function(){return this.$hasPermission("".concat(this.moduleName,":DELETE"))},hasCreatePermission:function(){return this.$hasPermission("".concat(this.moduleName,":CREATE"))},hasUpdatePermission:function(){return this.$hasPermission("".concat(this.moduleName,":UPDATE"))},hasWorkOrderClosePermission:function(){return(0,router/* isWebTabsEnabled */.tj)()?this.$hasPermission("".concat(this.moduleName,":UPDATE_CLOSE_WORKORDER")):this.$hasPermission("".concat(this.moduleName,":CLOSE_WORK_ORDER"))},filteredBulkActionFieldList:function(){var _this=this,fieldList=this.bulkActionFieldList;return fieldList=fieldList.filter((function(item){
// show Team/Staff only if the user has CHANGE_OWNERSHIP permission.
return"assignedTo"!==item||_this.hasChangeOwnershipPermission?item:void 0})),fieldList},commentDailogWidth:function(){return this.$helpers.isLicenseEnabled("NEW_COMMENTS")?"width: 41%":null}}),methods:{updateLimit:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var actionName,params,_yield$API$get,data;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return actionName="workorderbulkupdate",params={actionName:actionName},_context.next=4,api/* API */.bl.get("v3/bulkaction/limit/fetch",params);case 4:_yield$API$get=_context.sent,data=_yield$API$get.data,_yield$API$get.error,data&&(_this2.bulkActionAcount=data.limit);case 8:case"end":return _context.stop()}}),_callee)})))()},showBulkActionBar:function(){return(0,validation/* isEmpty */.xb)(this.selectedListItemsObj)?(this.isAllSelected=!0,!1):(this.isAllSelected=!1,this.isDisable=!1,this.isBulkUpdateVisible=!1,!0)},setNoOfNotesLength:function(length){this.$set(this.selectedWorkorder,"noOfNotes",length)},formatTaskCompletionStatus:function(wo){return wo&&wo.noOfTasks?wo.noOfClosedTasks?wo.noOfClosedTasks+"/"+wo.noOfTasks:"0/"+wo.noOfTasks:""},openAttachment:function(field,record){this.selectedFile={contentType:record["".concat(field.name,"ContentType")],fileName:record["".concat(field.name,"FileName")],downloadUrl:record["".concat(field.name,"DownloadUrl")],previewUrl:record["".concat(field.name,"Url")]},this.showPreview=!0},openWOCreate:function(){if((0,router/* isWebTabsEnabled */.tj)()){var moduleName=this.moduleName,_ref4=(0,router/* findRouteForModule */.Jp)(moduleName,router/* pageTypes */.As.CREATE)||{},name=_ref4.name;name&&this.$router.push({name:name})}else this.$router.push({path:"/app/wo/create"})},getWorkorderPriority:function(record){var _ref5=record||{},priority=_ref5.priority;if(!priority||!priority.priority||!this.ticketPriority)return"---";var prio=this.ticketPriority.filter((function(tp){return tp.id===priority.id}));return 1!==prio.length?"---":prio[0].displayName},showComments:function(workorder){this.selectedWorkorder=workorder,this.showCommentsWindow=!0},showAttachments:function(workorder){this.selectedWorkorder=workorder,this.showAttachmentsWindow=!0},deleteRecords:function(idList){var _this3=this;this.$dialog.confirm({title:this.$t("maintenance._workorder.delete_wo"),message:this.$t("maintenance._workorder.delete_wo_body"),rbDanger:!0,rbLabel:this.$t("common._common.delete")}).then((function(value){value&&(_this3.actions.deleteLoading=!0,_this3.workOrderDeleteV3(idList))}))},closeWO:function(idList){var _this4=this;this.checkAndShowWorkDuration(idList,"Closed",(function(idList){return _this4.doCloseWO(idList)})),this.showWorkDurationDialog||(this.doCloseWO(idList),this.selectedListItemsIds=[])},doCloseWO:function(idList,actualDuration){var _this5=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var paramObj,_ref6,duration,workTimings,url,_yield$API$post,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return paramObj={ids:idList},actualDuration&&(_ref6=actualDuration||{},duration=_ref6.duration,workTimings=_ref6.workTimings,-1!==duration&&(paramObj.actualWorkDuration=duration),paramObj.actualTimings=workTimings),_this5.actions.closeLoading=!0,url="v3/workorders/close",_context2.next=6,api/* API */.bl.post(url,paramObj);case 6:_yield$API$post=_context2.sent,error=_yield$API$post.error,error?(_this5.$message.error(error),_this5.resetSelectAll(),_this5.loadRecords()):(_this5.$message.success("Work orders closed successfully"),_this5.resetSelectAll(),_this5.loadRecords());case 9:case"end":return _context2.stop()}}),_callee2)})))()},checkAndShowWorkDuration:function(idList,status,cbk){var _this6=this,showDuration=idList.some((function(id){var workorder=_this6.records.find((function(wo){return wo.id===id})),_ref7=workorder||{},isWorkDurationChangeAllowed=_ref7.isWorkDurationChangeAllowed,woStatus=_ref7.woStatus,_ref8=woStatus||{},woStatusId=_ref8.id,getTicketStatusObj=woStatusId&&_this6.getTicketStatus(woStatusId,"workorder")||{},closedOrResolvedState="Closed"===status&&"Resolved"!==getTicketStatusObj.status;return isWorkDurationChangeAllowed&&("Resolved"===status||closedOrResolvedState)}));showDuration&&(this.$refs.statuspopover&&this.$refs.statuspopover.forEach((function(popover){return popover.close()})),this.workorderSelected=1===idList.length?idList[0]:-1,this.workDurationCallBack=cbk,this.showWorkDurationDialog=!0)},assignWOToGroup:function(idList,assignmentGroup){var workorder={};assignmentGroup&&(workorder={assignmentGroup:assignmentGroup});var assignment={ids:idList,workOrder:workorder};this.assignWO(assignment)},assignWOToUser:function(idList,assignedTo){var workorder={};assignedTo&&(workorder={assignedTo:assignedTo});var payload={ids:idList,workOrder:workorder};this.assignWO(payload)},assignWO:function(payload){var _this7=this;this.actions.assignLoading=!0,api/* API */.bl.post("/v3/workorders/assign",payload).then((function(_ref9){var error=_ref9.error;error?_this7.$message.error(_this7.$t(error.message||"maintenance._workorder.wo_update_failed")):(_this7.loadRecords(!0),_this7.onAssignWo(payload),_this7.$dialog.notify(_this7.$t("maintenance._workorder.wo_assigned_success")),_this7.resetSelectAll())})).finally((function(){_this7.actions.assignLoading=!1,_this7.resetSelectAll()}))},onAssignWo:function(assignToObj){var _this8=this;if(assignToObj){var woIds=this.$getProperty(assignToObj,"id",[]);woIds.forEach((function(woId){var workOrder=_this8.records.find((function(wo){return wo.id===woId}));if(!(0,validation/* isEmpty */.xb)(workOrder)){var assignedTo=assignToObj.assignedTo,assignmentGroup=assignToObj.assignmentGroup,status=assignToObj.status,_ref10=workOrder.status||{},wOStatus=_ref10.status,index=_this8.records.findIndex((function(wo){return wo.id===woId}));if(workOrder.id===woId){if(!(0,validation/* isEmpty */.xb)(assignedTo)){var id=assignedTo.id;workOrder.assignedTo=-1!==id?assignedTo:null}if(!(0,validation/* isEmpty */.xb)(assignmentGroup)){var _id=assignmentGroup.id;workOrder.assignmentGroup=-1!==_id?assignmentGroup:null}"Submitted"===wOStatus&&status&&(workOrder.status=status)}_this8.records.splice(index,1,workOrder)}}))}},newbulkActionHandler:function(actions){var _this9=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:
//await this.getRecordCount()
_this9.isDisable?_this9.executeBulkAction(actions):_this9.bulkActionHandler(actions);case 1:case"end":return _context3.stop()}}),_callee3)})))()},getRecordCount:function(){var _this10=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){var moduleName,viewname,filters,recordCount,params;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:return moduleName=_this10.moduleName,viewname=_this10.viewname,filters=_this10.filters,recordCount=null,_context4.prev=2,params={moduleName:moduleName,viewname:viewname,filters:filters},_context4.next=6,_this10.modelDataClass.fetchRecordsCount(params);case 6:recordCount=_context4.sent,_context4.next=12;break;case 9:_context4.prev=9,_context4.t0=_context4["catch"](2),_this10.showErrorToastMessage(_context4.t0,_this10.$t("custommodules.list.unable_to_fetch_count"));case 12:return _context4.abrupt("return",recordCount);case 13:case"end":return _context4.stop()}}),_callee4,null,[[2,9]])})))()},executeBulkAction:function(actions){var _this11=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee5(){var fields,data,datas,_iterator,_step,woID,_yield$_this11$bulkUp,error,message;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context5){while(1)switch(_context5.prev=_context5.next){case 0:
// each action represents a field update
fields={},actions.forEach((function(action){var _ref11=action||{},field=_ref11.field,valueArray=_ref11.valueArray,value=_ref11.value,parseLabel=_ref11.parseLabel,fieldObj=_ref11.fieldObj;if("category"===field){var _this11$getTicketCate=_this11.getTicketCategory(parseInt(valueArray)),displayName=_this11$getTicketCate.displayName;fields[field]={id:valueArray,name:displayName}}else if("priority"===field)fields[field]={id:parseInt(valueArray)};else if("requester"===field||"vendor"===field)fields[field]={id:parseInt(valueArray)};else if("type"===field)fields[field]={id:valueArray,name:_this11.getTicketType(parseInt(valueArray)).name};else if("assignedTo"===field)(0,validation/* isEmpty */.xb)(value)||(fields[field]={id:parseInt(value)}),(0,validation/* isEmpty */.xb)(valueArray)||(fields.assignmentGroup={id:parseInt(valueArray)});else if("resource"===field)fields[field]={id:parseInt(parseLabel.id)};else if("dueDate"===field)fields[field]=Date.parse(value);else if((0,validation/* isEmpty */.xb)(fieldObj))fields[field]=action.value;else{var fieldObject=fieldObj[0];
// lookup handling
if(_this11.isLookup(fieldObject)&&!(0,validation/* isEmpty */.xb)(action.value.id))action.value.id=parseInt(action.value.id),fields[field]=action.value;else if(_this11.isPicklist(fieldObject)&&!(0,validation/* isEmpty */.xb)(action.value))fields[field]=+action.value;else if(!_this11.isDate(fieldObject)&&!_this11.isDateTime(fieldObject)||(0,validation/* isEmpty */.xb)(action.value))if(_this11.isMultiLookUp(fieldObject)&&!(0,validation/* isEmpty */.xb)(action.value)){var actionObject=[];valueArray.forEach((function(index){var valueArrayItems={};valueArrayItems["id"]=index,actionObject.push(valueArrayItems)})),fields[field]=actionObject}else
// other
fields[field]=action.value;else fields[field]=moment_timezone_default()(action.value).valueOf()}})),data=[],datas=[],datas.push(fields),_iterator=(0,createForOfIteratorHelper/* default */.Z)(_this11.selectedListItemsIds);try{for(_iterator.s();!(_step=_iterator.n()).done;)woID=_step.value,data.push((0,objectSpread2/* default */.Z)({id:woID},fields))}catch(err){_iterator.e(err)}finally{_iterator.f()}if(_this11.updateBulkRecord){_context5.next=14;break}return _context5.next=10,_this11.bulkUpdateWithV3(datas);case 10:_yield$_this11$bulkUp=_context5.sent,error=_yield$_this11$bulkUp.error,_this11.showLoading=!1,_this11.$refs["bulk-update-dialog"]&&(error?(message=null!==error&&void 0!==error&&error.message?error.message:"",_this11.$refs["bulk-update-dialog"].updateAPICallback({message:message,error:!0})):_this11.$refs["bulk-update-dialog"].updateAPICallback({message:"Records updated successfully."}));
//this.resetSelectAll()
//  this.closeBulkActionDialog()
//  this.loadRecords()
case 14:case"end":return _context5.stop()}}),_callee5)})))()},bulkActionHandler:function(actions){var _this12=this,fields={};
// each action represents a field update
actions.forEach((function(action){var _ref12=action||{},field=_ref12.field,valueArray=_ref12.valueArray,value=_ref12.value,parseLabel=_ref12.parseLabel,fieldObj=_ref12.fieldObj;if("category"===field){var _this12$getTicketCate=_this12.getTicketCategory(parseInt(valueArray)),displayName=_this12$getTicketCate.displayName;fields[field]={id:valueArray,name:displayName}}else if("priority"===field)fields[field]={id:parseInt(valueArray)};else if("requester"===field)fields[field]={id:parseInt(valueArray)};else if("type"===field)fields[field]={id:valueArray,name:_this12.getTicketType(parseInt(valueArray)).name};else if("assignedTo"===field)(0,validation/* isEmpty */.xb)(value)||(fields[field]={id:parseInt(value)}),(0,validation/* isEmpty */.xb)(valueArray)||(fields.assignmentGroup={id:parseInt(valueArray)});else if("resource"===field)fields[field]={id:parseInt(parseLabel.id)};else if("dueDate"===field)fields[field]=Date.parse(value);else if((0,validation/* isEmpty */.xb)(fieldObj))fields[field]=action.value;else{var fieldObject=fieldObj[0];
// lookup handling
if(_this12.isLookup(fieldObject)&&!(0,validation/* isEmpty */.xb)(action.value.id))action.value.id=parseInt(action.value.id),fields[field]=action.value;else if(_this12.isPicklist(fieldObject)&&!(0,validation/* isEmpty */.xb)(action.value))fields[field]=+action.value;else if(!_this12.isDate(fieldObject)&&!_this12.isDateTime(fieldObject)||(0,validation/* isEmpty */.xb)(action.value))if(_this12.isMultiLookUp(fieldObject)&&!(0,validation/* isEmpty */.xb)(action.value)){var actionObject=[];valueArray.forEach((function(index){var valueArrayItems={};valueArrayItems["id"]=index,actionObject.push(valueArrayItems)})),fields[field]=actionObject}else
// other
fields[field]=action.value;else fields[field]=moment_timezone_default()(action.value).valueOf()}}));var _step2,data=[],_iterator2=(0,createForOfIteratorHelper/* default */.Z)(this.selectedListItemsIds);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var woID=_step2.value;data.push((0,objectSpread2/* default */.Z)({id:woID},fields))}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}this.bulkUpdate(data),this.closeBulkActionDialog(),this.resetSelectAll()},bulkUpdate:function(data){var _this13=this,moduleName=this.moduleName,body={workorder:data};return api/* API */.bl.post("v3/modules/bulkPatch/".concat(moduleName),{data:body,moduleName:moduleName}).then((function(_ref13){var error=_ref13.error;error?_this13.$message.error(_this13.$t(error.message)):_this13.$message.success(_this13.$t("maintenance._workorder.wo_update_success"))})).then((function(){_this13.resetSelectAll(),_this13.closeBulkActionDialog(),_this13.loadRecords()})).catch((function(){_this13.$message.error(_this13.$t("maintenance._workorder.wo_update_failed"))}))},isLookup:function(field){var LOOKUP_DATATYPE=7;return(null===field||void 0===field?void 0:field.dataType)&&field.dataType===LOOKUP_DATATYPE},isPicklist:function(field){var PICKLIST_DATATYPE=8;return(null===field||void 0===field?void 0:field.dataType)&&field.dataType===PICKLIST_DATATYPE},isDate:function(field){var DATE_DATATYPE=5;return(null===field||void 0===field?void 0:field.dataType)&&field.dataType===DATE_DATATYPE},isDateTime:function(field){var DATETIME_DATATYPE=6;return(null===field||void 0===field?void 0:field.dataType)&&field.dataType===DATETIME_DATATYPE},isMultiLookUp:function(field){var MULTI_LOOKUP_DATATYPE=13;return(null===field||void 0===field?void 0:field.dataType)&&field.dataType===MULTI_LOOKUP_DATATYPE},openWorkorderOverview:function(id){var viewname=this.viewname,moduleName=this.moduleName;if(!(void 0===id||id<=0)){if(!(0,router/* isWebTabsEnabled */.tj)())return{name:"wosummarynew",params:{viewname:viewname,id:id}};var _ref14=(0,router/* findRouteForModule */.Jp)(moduleName,router/* pageTypes */.As.OVERVIEW)||{},name=_ref14.name;return name?{name:name,params:{viewname:viewname,id:id}}:void 0}},openList:function(){if((0,router/* isWebTabsEnabled */.tj)()){var viewname=this.viewname,_ref15=(0,router/* findRouteForModule */.Jp)(this.moduleName,router/* pageTypes */.As.LIST)||{},name=_ref15.name;name&&this.$router.push({name:name,params:{viewname:viewname},query:this.$route.query})}else this.$router.push({name:"workorder",params:{viewname:this.viewname},query:this.$route.query})},getTicketStatusDisplayName:function(record){return(this.getTicketStatus(this.$getProperty(record,"moduleState.id",-1),this.moduleName)||{}).displayName},
// quick edit methods
canShowSpaceAssetChooser:function(workorder){this.canEditRecord(workorder)&&(this.showSpaceAssetDialog=!0,this.workOrder=workorder,this.workorderSelected=workorder.id)},associateSpaceAsset:function(resource){this.showSpaceAssetDialog=!1,this.updateRecordResource(this.workOrder,resource),this.workOrder=-1},isRequestedState:function(workorder){var _ref16=workorder||{},approvalStatus=_ref16.approvalStatus;if((0,validation/* isEmpty */.xb)(approvalStatus))return!1;var statusObj=this.getApprovalStatus(approvalStatus.id);return this.$getProperty(statusObj,"requestedState",!1)},isRecordLocked:function(workorder){var moduleState=this.$getProperty(workorder,"moduleState.id",null);return moduleState&&this.isStatusLocked(moduleState.id,"workorder")},canEditRecord:function(workorder){var isLocked=this.isRecordLocked(workorder),isRequestedState=this.isRequestedState(workorder);return!isLocked&&!isRequestedState},canShowTeamStaffChooser:function(workorder){return!(0,validation/* isEmpty */.xb)(workorder)&&this.hasChangeOwnershipPermission&&this.canEditRecord(workorder)},
// misc methods
closeBulkActionDialog:function(){this.bulkAction=!1},handleBulkActiondialogClose:function(){this.bulkAction=!1,this.resetSelectAll(),this.loadRecords()},filter:function(){var filter={},_ref17=this.workOrder||{},siteId=_ref17.siteId;return(0,validation/* isEmpty */.xb)(siteId)||(filter.site=Number(siteId)),filter},redirectToOverview:function(id){var moduleName=this.moduleName,viewname=this.viewname;if((0,router/* isWebTabsEnabled */.tj)()){var _ref18=(0,router/* findRouteForModule */.Jp)(moduleName,router/* pageTypes */.As.OVERVIEW)||{},name=_ref18.name,route={name:name,params:{viewname:viewname,id:id},query:this.$route.query};return name&&route}return{name:"wo-summary",params:{moduleName:moduleName,viewname:viewname,id:id},query:this.$route.query}},getLookUpDisplayName:function(fieldName,data){var _ref19=data[fieldName]||{},primaryValue=_ref19.primaryValue,name=_ref19.name,displayName=_ref19.displayName,subject=_ref19.subject,value=displayName||name||subject;return(0,validation/* isEmpty */.xb)(primaryValue)?value:primaryValue},resetSelectAll:function(){this.selectedListItemsIds=[],this.selectedListItemsObj=[]},
//  V3 Updates
updateRecordType:function(wo,value){this.updateRecordWithV3(wo,{type:value})},updateRecordCategory:function(wo,value){this.updateRecordWithV3(wo,{category:value})},updateRecordPriority:function(wo,value){this.updateRecordWithV3(wo,{priority:value})},updateRecordResource:function(wo,value){this.updateRecordWithV3(wo,{resource:value})},updateRecordWithV3:function(wo,data){var _this14=this;api/* API */.bl.updateRecord(this.moduleName,{id:+wo.id,data:data}).then((function(){_this14.$message.success(_this14.$t("maintenance._workorder.wo_update_success"))})).then((function(){_this14.resetSelectAll(),_this14.closeBulkActionDialog(),_this14.loadRecords()})).catch((function(){_this14.$message.error(_this14.$t("maintenance._workorder.wo_update_failed"))}))},bulkUpdateWithV3:function(fields){var _this15=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee6(){var moduleName,viewname,filters,viewName,body;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context6){while(1)switch(_context6.prev=_context6.next){case 0:return _this15.isSaving=!0,moduleName=_this15.moduleName,viewname=_this15.viewname,filters=_this15.filters,_this15.currentPageCount=null,{moduleName:moduleName,viewname:viewname,filters:filters,count:_this15.recordCount},viewName=viewname,body={workorder:fields},_this15.showLoading=!0,_context6.next=9,api/* API */.bl.post("v3/bulkupdate/workorder/update  ",{data:body,moduleName:moduleName,viewName:viewName,filters:JSON.stringify(filters),count:_this15.recordCount}).catch((function(){_this15.$message.error(_this15.$t("maintenance._workorder.wo_update_failed"))}));case 9:return _context6.abrupt("return",_context6.sent);case 10:case"end":return _context6.stop()}}),_callee6)})))()},workOrderDeleteV3:function(idList){var _this16=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee7(){var moduleName,_yield$API$deleteReco,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context7){while(1)switch(_context7.prev=_context7.next){case 0:return moduleName=_this16.moduleName,_context7.next=3,api/* API */.bl.deleteRecord(moduleName,idList);case 3:_yield$API$deleteReco=_context7.sent,error=_yield$API$deleteReco.error,error?_this16.$message.error(_this16.$t(error.message)):(_this16.$message.success("".concat(_this16.$t("maintenance._workorder.wo_delete_success"))),_this16.refreshRecordDetails(!0),_this16.resetSelectAll());case 6:case"end":return _context7.stop()}}),_callee7)})))()},canDeleteRecord:function(record){var hasDeletePermission=this.hasDeletePermission,_ref20=record||{},moduleState=_ref20.moduleState,_ref21=moduleState||{},typeCode=_ref21.typeCode,canDelete=((0,validation/* isEmpty */.xb)(moduleState)||1===typeCode)&&hasDeletePermission;return canDelete},getTicketTypeName:function(record){var typeId=this.$getProperty(record,"type.id",-1),ticketType=this.getTicketType(typeId)||{};return this.$getProperty(ticketType,"name","---")},isResourceAvailable:function(record){var resourceId=this.$getProperty(record,"resource.id",-1);return resourceId>-1},getResourceType:function(record){var resourceType=this.$getProperty(record,"resource.resourceType",-1);return 1===resourceType},OpenBulkUpdate:function(){var _this17=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee8(){var dialogObj,moduleName,params,_API$get,_moduleName,_params,_API$get2;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context8){while(1)switch(_context8.prev=_context8.next){case 0:_this17.isDisable?_this17.recordCount>_this17.bulkActionAcount?(dialogObj={title:"Bulk update limit exceeds",htmlMessage:"Bulk update can be performed upto ".concat(_this17.bulkActionAcount," records . Please ensure your selection does not exceed this limit."),rbDanger:!0,rbLabel:"Confirm"},_this17.$dialog.confirm(dialogObj).then((function(value){value&&(_this17.isAllSelected=!0)}))):(_this17.bulkAction=!0,moduleName="workorder",params={moduleName:moduleName},_API$get=api/* API */.bl.get("v3/bulkupdate/workorder/fetchFields",params),_API$get.data,_API$get.error):(_this17.bulkAction=!0,_moduleName="workorder",_params={moduleName:_moduleName},_API$get2=api/* API */.bl.get("v3/bulkupdate/workorder/fetchFields",_params),_API$get2.data,_API$get2.error);case 1:case"end":return _context8.stop()}}),_callee8)})))()},clearSelection:function(){this.bulkAction=!1,this.isAllSelected=!1},validateTotalCount:function(selectedItem){selectedItem?(this.isDisable=!1,this.isBulkUpdateVisible=!1,this.updateBulkRecord=!0):(this.updateBulkRecord=!1,this.isDisable=!0,this.recordCount>this.bulkActionAcount&&(this.isBulkUpdateVisible=!0))},enableNewBulkUpdate:function(){return this.$helpers.isLicenseEnabled("BULK_UPDATE")}}},v3_WorkOrderListvue_type_script_lang_js=WorkOrderListvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(v3_WorkOrderListvue_type_script_lang_js,render,staticRenderFns,!1,null,"9ac07962",null)
/* harmony default export */,WorkOrderList=component.exports},
/***/365565:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"d022638208d4baab3e4d8fbec8ac38ca.svg";
/***/},
/***/250620:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"03daa5e7a5fe4964f41cd5e0c6dbcdb3.svg";
/***/}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/88463.js.map