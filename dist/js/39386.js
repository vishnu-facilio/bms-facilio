"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[39386],{
/***/303514:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return AsyncButton}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/AsyncButton.vue?vue&type=template&id=16ca9ad1
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-button",_vm._b({class:_vm.buttonClass,attrs:{loading:_vm.showLoading,type:_vm.buttonType,size:_vm.size,disabled:_vm.disabled},on:{click:function($event){return _vm.save()}}},"el-button",_vm.$attrs,!1),[_vm._t("default")],2)},staticRenderFns=[],toConsumableArray=__webpack_require__(488478),AsyncButtonvue_type_script_lang_js=(__webpack_require__(260228),__webpack_require__(821694),__webpack_require__(76265),{props:["clickAction","actionParams","buttonType","buttonClass","size","disabled","loading"],data:function(){return{isLoading:!1}},computed:{showLoading:function(){return this.loading||this.isLoading}},methods:{save:function(){var _this=this;if(this.clickAction&&"function"===typeof this.clickAction){this.isLoading=!0;var returnPromise=this.actionParams?this.clickAction.apply(this,(0,toConsumableArray/* default */.Z)(this.actionParams)):this.clickAction(),minimumTimeout=this.$helpers.delay(1e3);returnPromise?Promise.all([returnPromise,minimumTimeout]).finally((function(){_this.isLoading=!1})):this.$helpers.delay(1e3).then((function(){return _this.isLoading=!1}))}}}}),components_AsyncButtonvue_type_script_lang_js=AsyncButtonvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_AsyncButtonvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,AsyncButton=component.exports},
/***/565476:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return SidebarScrollMixin}});
// EXTERNAL MODULE: ./node_modules/core-js/modules/es.array.map.js
__webpack_require__(450886),__webpack_require__(260228),__webpack_require__(947522);
// EXTERNAL MODULE: ./node_modules/core-js/modules/es.object.to-string.js
var render,staticRenderFns,vue_scrollto=__webpack_require__(593081),vue_scrollto_default=__webpack_require__.n(vue_scrollto),SidebarScrollMixinvue_type_script_lang_js={beforeDestroy:function(){var root=document.querySelector(this.rootElementForScroll);root&&root.removeEventListener("scroll",this.scrollhandler)},methods:{registerScrollHandler:function(){var root=document.querySelector(this.rootElementForScroll);root&&root.addEventListener("scroll",this.scrollhandler,{passive:!0})},scrollhandler:function(){var highlightSidebarElement=this.highlightSidebarElement,anchorSectionHeader=this.anchorSectionHeader,deAnchorSectionHeader=this.deAnchorSectionHeader,sectionElements=this.sectionElements,elements=sectionElements.map((function(id){return document.querySelector(id)}));window.requestAnimationFrame((function(){elements.forEach((function(el){var _el$getBoundingClient=el.getBoundingClientRect(),top=_el$getBoundingClient.top,sectionName=el.getAttribute("id").split("-")[0];top<153?anchorSectionHeader(sectionName):deAnchorSectionHeader(sectionName),top<400&&highlightSidebarElement(sectionName)}))}))},scrollTo:function(sectionName){var _this=this,onDone=function(){return _this.highlightSidebarElement(sectionName)};vue_scrollto_default().scrollTo("#".concat(sectionName,"-section"),500,{container:".scroll-container",easing:"ease-in",offset:0,force:!0,onDone:onDone})},highlightSidebarElement:function(sectionName){var sidebarElements=this.sidebarElements,elements=sidebarElements.map((function(e){return document.querySelector(e)}));elements.forEach((function(el){el.getAttribute("id")==="".concat(sectionName,"-link")?el.classList.add("active"):el.classList.remove("active")}))},anchorSectionHeader:function(sectionName){var elements=document.querySelectorAll(".section-header");elements.forEach((function(el){el.getAttribute("id")==="".concat(sectionName,"-header")&&el.classList.add("anchor-top")}))},deAnchorSectionHeader:function(sectionName){var elements=document.querySelectorAll(".section-header");elements.forEach((function(el){el.getAttribute("id")==="".concat(sectionName,"-header")&&el.classList.remove("anchor-top")}))}}},mixins_SidebarScrollMixinvue_type_script_lang_js=SidebarScrollMixinvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(mixins_SidebarScrollMixinvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,SidebarScrollMixin=component.exports},
/***/647110:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return NewVMTemplate}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/vmTemplate/NewVMTemplate.vue?vue&type=template&id=1e5627d5&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"formbuilder-fullscreen-popup vm-template-container form-customization-container"},[_c("div",{staticClass:"setting-header pT10 pB10"},[_c("div",{staticClass:"d-flex flex-direction-column"},[_c("div",{staticClass:"mT10 mB10 f18 bold"},[_vm._v(_vm._s(_vm.title))])]),_c("div",{staticClass:"fR align-center"},[_c("AsyncButton",{attrs:{buttonClass:"vm-cancel-btn",clickAction:_vm.back}},[_vm._v(" "+_vm._s(_vm.$t("common._common.cancel"))+" ")]),_c("AsyncButton",{attrs:{buttonClass:"vm-save-btn",clickAction:_vm.save}},[_vm._v(" "+_vm._s(_vm.$t("common._common._save"))+" ")])],1)]),_c("div",{staticClass:"d-flex grey-bg"},[_c("div",{staticClass:"sla-sidebar pT10"},[_c("a",{staticClass:"sla-link active",attrs:{id:"vmtemplate-link"},on:{click:function($event){return _vm.scrollTo("vmtemplate")}}},[_vm._v(" "+_vm._s(_vm.$t("asset.virtual_meters.virtual_meter_template"))+" ")]),_c("a",{staticClass:"sla-link",attrs:{id:"meterDetails-link"},on:{click:function($event){return _vm.scrollTo("meterDetails")}}},[_vm._v(" "+_vm._s(_vm.$t("asset.virtual_meters.meters_details"))+" ")]),_c("a",{staticClass:"sla-link",attrs:{id:"readingDetails-link"},on:{click:function($event){return _vm.scrollTo("readingDetails")}}},[_vm._v(" "+_vm._s(_vm.$t("asset.virtual_meters.reading_details"))+" ")])]),_c("div",{staticClass:"scroll-container vm-template"},[_vm.isLoading?_c("div",{staticClass:"mT20"},[_c("spinner",{attrs:{show:_vm.isLoading,size:"80"}})],1):[_c("VMTemplate",{ref:"vmtemplate-section",staticClass:"mB20",attrs:{id:"vmtemplate-section",isNew:!_vm.isEditForm,vmInfo:_vm.virtualMeter},on:{updateVirtualMeter:_vm.updateVirtualMeter}}),_c("VMDetailsForm",{ref:"meterDetails-section",staticClass:"mB20",attrs:{id:"meterDetails-section",isNew:!_vm.isEditForm,vmInfo:_vm.virtualMeter},on:{updateVirtualMeter:_vm.updateVirtualMeter}}),_c("ReadingDetailsForm",{ref:"readingDetails-section",staticClass:"mB20 height74vh",attrs:{id:"readingDetails-section",isNew:!_vm.isEditForm,vmInfo:_vm.virtualMeter},on:{updateVirtualMeter:_vm.updateVirtualMeter}})],_c("div",{staticClass:"mT50"})],2)])])},staticRenderFns=[],objectSpread2=__webpack_require__(595082),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),AsyncButton=(__webpack_require__(434284),__webpack_require__(670560),__webpack_require__(303514)),VMTemplatevue_type_template_id_1101e8f8_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("div",{staticClass:"vm-section-header"},[_vm._v(" "+_vm._s(_vm.$t("asset.virtual_meters.vm_templates"))+" ")]),_c("el-form",{ref:"vm-template-form",staticClass:"p50 pT10 pB30",attrs:{model:_vm.vmTemplateObj,rules:_vm.validationRules,"label-width":"150px","label-position":"left"}},[_c("div",{staticClass:"section-container flex-container"},[_c("div",{staticClass:"vm-form-item"},[_c("el-form-item",{attrs:{label:""+this.$t("asset.virtual_meters.vm_template_name"),prop:"name"}},[_c("el-input",{staticClass:"fc-input-full-border2 width60",attrs:{placeholder:""+this.$t("asset.virtual_meters.enter_vm_template_name"),autofocus:!0},model:{value:_vm.vmTemplateObj.name,callback:function($$v){_vm.$set(_vm.vmTemplateObj,"name",$$v)},expression:"vmTemplateObj.name"}})],1)],1),_c("div",{staticClass:"vm-form-item"},[_c("el-form-item",{attrs:{label:""+this.$t("asset.virtual_meters.description"),prop:"description"}},[_c("el-input",{staticClass:"mT3 fc-input-full-border-textarea width60",attrs:{type:"textarea",autofocus:!0,"min-rows":2,autosize:{minRows:4,maxRows:5},placeholder:""+this.$t("asset.virtual_meters.description")},model:{value:_vm.vmTemplateObj.description,callback:function($$v){_vm.$set(_vm.vmTemplateObj,"description",$$v)},expression:"vmTemplateObj.description"}})],1)],1),_c("div",{staticClass:"vm-form-item"},[_c("el-form-item",{attrs:{label:""+this.$t("asset.meters.utilityType"),prop:"utilityType"}},[_c("FLookupField",{key:"utilitytype",staticClass:"width60",attrs:{model:_vm.vmTemplateObj.utilityType,field:_vm.utilityTypeField,isRemoteField:!1,disabled:!_vm.isNew},on:{"update:model":function($event){return _vm.$set(_vm.vmTemplateObj,"utilityType",$event)}}})],1)],1),_c("div",{staticClass:"vm-form-item"},[_c("el-form-item",{attrs:{label:""+this.$t("asset.virtual_meters.scope"),prop:"scope"}},[_c("el-select",{staticClass:"fc-input-full-border-select2 width60",attrs:{placeholder:_vm.$t("asset.virtual_meters.select_scope"),disabled:!_vm.isNew},model:{value:_vm.vmTemplateObj.scope,callback:function($$v){_vm.$set(_vm.vmTemplateObj,"scope",$$v)},expression:"vmTemplateObj.scope"}},_vm._l(_vm.scopeOptions,(function(item){return _c("el-option",{key:item.value,attrs:{label:item.label,value:item.value}})})),1)],1)],1),_c("div",{staticClass:"vm-form-item"},[_c("el-form-item",{attrs:{label:""+this.$t("common._common.sites"),prop:"siteIds"}},[_c("FLookupField",{key:"siteIds",ref:"siteIds",staticClass:"width60",attrs:{model:_vm.vmTemplateObj.siteIds,field:_vm.siteField,disabled:!_vm.isNew},on:{"update:model":function($event){return _vm.$set(_vm.vmTemplateObj,"siteIds",$event)},showLookupWizard:_vm.showLookupWizard,recordSelected:function($event){return _vm.constructBuildingsFilter()}}})],1)],1),_vm.canShowLookup&&_vm.isBuildingNeeded(_vm.vmTemplateObj.scope)?_c("div",{staticClass:"vm-form-item"},[_c("el-form-item",{attrs:{label:""+this.$t("common._common.buildings"),prop:"buildingIds"}},[_c("FLookupField",{key:"buildingIds",ref:"buildingIds",staticClass:"width60",attrs:{model:_vm.vmTemplateObj.buildingIds,field:_vm.buildingField,disabled:!_vm.isNew},on:{"update:model":function($event){return _vm.$set(_vm.vmTemplateObj,"buildingIds",$event)},showLookupWizard:_vm.showLookupWizard}})],1)],1):_vm._e(),3===_vm.vmTemplateObj.scope?_c("div",{staticClass:"vm-form-item"},[_c("el-form-item",{attrs:{label:""+this.$t("asset.virtual_meters.space_category"),prop:"spaceCategory"}},[_c("FLookupField",{key:"spacecategory",staticClass:"width60",attrs:{model:_vm.vmTemplateObj.spaceCategory,field:_vm.spaceCategoryField,isRemoteField:!1,disabled:!_vm.isNew},on:{"update:model":function($event){return _vm.$set(_vm.vmTemplateObj,"spaceCategory",$event)},recordSelected:_vm.onSpaceCategorySelected}})],1)],1):_vm._e(),4===_vm.vmTemplateObj.scope?_c("div",{staticClass:"vm-form-item"},[_c("el-form-item",{attrs:{label:""+this.$t("asset.virtual_meters.asset_category"),prop:"assetCategory"}},[_c("FLookupField",{key:"assetcategory",staticClass:"width60",attrs:{model:_vm.vmTemplateObj.assetCategory,field:_vm.assetCategoryField,isRemoteField:!1,disabled:!_vm.isNew},on:{"update:model":function($event){return _vm.$set(_vm.vmTemplateObj,"assetCategory",$event)},recordSelected:_vm.onAssetCategorySelected}})],1)],1):_vm._e(),_c("div",{staticClass:"vm-rel-form-item"},[_c("el-form-item",{attrs:{label:""+this.$t("asset.virtual_meters.associate_vm_relationship"),prop:"relationShipId"}},[_c("el-select",{key:"relationShipId",ref:"relationShipId",staticClass:"fc-input-full-border-select2 width60 fc-tag",attrs:{"data-test-selector":"relationShipId",filterable:"","collapse-tags":"",placeholder:_vm.$t("asset.virtual_meters.select_relationship"),remote:"","remote-method":_vm.remoteRelationRequest,disabled:!_vm.relationSelectAllowed||!_vm.isNew},on:{"visible-change":_vm.fetchRelationOptions},model:{value:_vm.vmTemplateObj.relationShipId,callback:function($$v){_vm.$set(_vm.vmTemplateObj,"relationShipId",$$v)},expression:"vmTemplateObj.relationShipId"}},[_c("div",{staticClass:"min-width420",attrs:{slot:"empty"},slot:"empty"},[_c("div",{staticClass:"el-select-dropdown__empty"},[_vm._v(" "+_vm._s(_vm.$t("common._common.empty_option_text"))+" ")]),_c("div",{staticClass:"vm-form-item"},[_c("el-button",{staticClass:"add-vm-relationship-container",on:{click:function($event){return _vm.addRelationship()}}},[_vm._v(" "+_vm._s(_vm.$t("asset.virtual_meters.new_relationship")))])],1)]),_vm._l(_vm.relationshipOptions,(function(option,index){return _c("el-option",{key:index,attrs:{label:option.name,value:option.id}})}))],2)],1)],1)])]),_vm.canShowLookupWizard?_c("div",[_vm.checkNewLookupWizardEnabled?_c("LookupWizard",{attrs:{canShowLookupWizard:_vm.canShowLookupWizard,field:_vm.selectedLookupField},on:{"update:canShowLookupWizard":function($event){_vm.canShowLookupWizard=$event},"update:can-show-lookup-wizard":function($event){_vm.canShowLookupWizard=$event},setLookupFieldValue:_vm.setLookupFieldValue}}):_c("FLookupFieldWizard",{attrs:{canShowLookupWizard:_vm.canShowLookupWizard,selectedLookupField:_vm.selectedLookupField},on:{"update:canShowLookupWizard":function($event){_vm.canShowLookupWizard=$event},"update:can-show-lookup-wizard":function($event){_vm.canShowLookupWizard=$event},setLookupFieldValue:_vm.setLookupFieldValue}})],1):_vm._e()],1)},VMTemplatevue_type_template_id_1101e8f8_staticRenderFns=[],FLookupField=(__webpack_require__(260228),__webpack_require__(450886),__webpack_require__(947522),__webpack_require__(212826),__webpack_require__(634338),__webpack_require__(855048)),validation=__webpack_require__(586529),FLookupFieldWizard=__webpack_require__(499751),ui_forms=__webpack_require__(141323),api=__webpack_require__(32284),dlv_umd=(__webpack_require__(228436),__webpack_require__(564043),__webpack_require__(857267),__webpack_require__(976801),__webpack_require__(226905)),dlv_umd_default=__webpack_require__.n(dlv_umd),utils_validation=__webpack_require__(990260),EXCLUDE_OPERATORS=[74,75,76,77,78,79,35,81,82],vmDataModel={name:"",description:"",scope:null,bulkSelectOption:"all",sites:[],siteIds:[],buildings:[],buildingIds:[],assetCategory:null,spaceCategory:null,assets:null,spaces:null,meterName:"",meterDescription:"",utilityType:null,readings:[],relationShipId:null},readingModel={readingFieldId:null,frequency:null,ns:{fields:[],expressionType:"",includedAssetIds:null,workflowContext:{workflowV2String:"",workflowUIMode:null}}},vmScopeHash={1:"floor",2:"space",3:"spaceCategory",4:"assetCategory",7:"building",8:"site"};function validateReadings(){var readings=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],validations=[];return validations=(readings||[]).map((function(reading){var _ref=reading||{},readingFieldId=_ref.readingFieldId,uuid=_ref.uuid,frequency=_ref.frequency,ns=_ref.ns,_ref2=ns||{},workflowContext=_ref2.workflowContext,fields=_ref2.fields,workflowV2String=dlv_umd_default()(workflowContext,"workflowV2String","");if((0,utils_validation/* isEmpty */.xb)(readingFieldId))return{valid:!1,message:"Please select reading name",uuid:uuid};if((0,utils_validation/* isEmpty */.xb)(frequency))return{valid:!1,message:"Please select frequency",uuid:uuid};var variableError={};return(fields||[]).forEach((function(variable){if((0,utils_validation/* isEmpty */.xb)(variableError)){var _ref3=variable||{},varName=_ref3.varName,fieldId=_ref3.fieldId;(0,utils_validation/* isEmpty */.xb)(fieldId)&&(variableError={valid:!1,message:"".concat(varName," is not a valid Variable"),uuid:uuid})}})),(0,utils_validation/* isEmpty */.xb)(variableError)?(workflowV2String=workflowV2String.replace("Number test(){\n","").replace("\nreturn","").replace(";  \n}","").trim(),(0,utils_validation/* isEmpty */.xb)(workflowV2String)?{valid:!1,message:"Expression cannot be empty",uuid:uuid}:{valid:!0,message:"",uuid:uuid}):variableError})),validations}function serializeVM(){var virtualMeter=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},_ref4=virtualMeter||{},sites=_ref4.sites,siteIds=_ref4.siteIds,buildings=_ref4.buildings,buildingIds=_ref4.buildingIds,scope=_ref4.scope,assets=_ref4.assets,spaces=_ref4.spaces,bulkSelectOption=_ref4.bulkSelectOption,readings=_ref4.readings,assetCategory=_ref4.assetCategory,spaceCategory=_ref4.spaceCategory,utilityType=_ref4.utilityType;assetCategory={id:assetCategory},spaceCategory={id:spaceCategory},utilityType={id:utilityType},
// Serializing lookup fields
sites=(siteIds||[]).map((function(siteId){return{id:siteId}})),buildings=(buildingIds||[]).map((function(buildingId){return{id:buildingId}})),assets=(assets||[]).map((function(assetId){return{id:assetId}})),spaces=(spaces||[]).map((function(spaceId){return{id:spaceId}})),readings=(readings||[]).map((function(reading){return delete reading["uuid"],reading})),virtualMeter=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},virtualMeter),{},{sites:sites,buildings:buildings,assets:assets,spaces:spaces,readings:readings,assetCategory:assetCategory,spaceCategory:spaceCategory,utilityType:utilityType});
// Removing unwanted fields from model
var excludeFields=["siteIds","buildingIds","bulkSelectOption"],selectedScope=dlv_umd_default()(vmScopeHash,"".concat(scope),"");return"spaceCategory"!==selectedScope&&excludeFields.push("spaceCategory"),"assetCategory"!==selectedScope&&excludeFields.push("assetCategory"),("assetCategory"===selectedScope&&"all"===bulkSelectOption||"assetCategory"!==selectedScope)&&excludeFields.push("assets"),("spaceCategory"===selectedScope&&"all"===bulkSelectOption||"spaceCategory"!==selectedScope)&&excludeFields.push("spaces"),excludeFields.forEach((function(field){delete virtualMeter["".concat(field)]})),virtualMeter}function deserializeVM(){var virtualMeter=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},_ref5=virtualMeter||{},sites=_ref5.sites,siteIds=_ref5.siteIds,buildings=_ref5.buildings,buildingIds=_ref5.buildingIds,assetCategory=_ref5.assetCategory,spaceCategory=_ref5.spaceCategory,utilityType=_ref5.utilityType;return assetCategory=dlv_umd_default()(assetCategory,"id",null),spaceCategory=dlv_umd_default()(spaceCategory,"id",null),utilityType=dlv_umd_default()(utilityType,"id",null),siteIds=(sites||[]).map((function(site){var _ref6=site||{},id=_ref6.id;return id})),buildingIds=(buildings||[]).map((function(building){var _ref7=building||{},id=_ref7.id;return id})),virtualMeter=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},virtualMeter),{},{siteIds:siteIds,buildingIds:buildingIds,assetCategory:assetCategory,spaceCategory:spaceCategory,utilityType:utilityType}),virtualMeter}var loadMeterReadingFields=function(){var _ref8=(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(meterId,categoryId,excludeEmptyFields,type,fetchValidationRules){var url,fields,_yield$API$get,data;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(!1!==excludeEmptyFields&&(excludeEmptyFields=!0),url=meterId>0?"v2/reading/getmeterspecificreadings?parentId="+meterId:"v2/readings/utilitytype?id="+categoryId,url+="&excludeEmptyFields="+excludeEmptyFields,type&&(url+="&readingType="+type),fetchValidationRules&&(url+="&fetchValidationRules="+fetchValidationRules),fields=[],!(meterId>0)){_context.next=9;break}_context.next=15;break;case 9:return _context.next=11,api/* API */.bl.get(url);case 11:return _yield$API$get=_context.sent,data=_yield$API$get.data,data&&(meterId>0?data.forEach((function(reading){reading.fields.forEach((function(field){field.module={name:reading.name},fields.push(field)}))})):data.readings.forEach((function(field){field.module={name:field.module.name},fetchValidationRules&&data.fieldVsRules&&(field.readingRules=data.fieldVsRules[field.fieldId]);var operators=dlv_umd_default()(field,"dataTypeEnum.operators");if(operators)for(var operatorKey in operators){var operator=operators[operatorKey];EXCLUDE_OPERATORS.includes(operator.operatorId)&&delete operators[operatorKey]}fields.push(field)}))),_context.abrupt("return",fields);case 15:case"end":return _context.stop()}}),_callee)})));return function(_x,_x2,_x3,_x4,_x5){return _ref8.apply(this,arguments)}}(),debounce=__webpack_require__(23279),debounce_default=__webpack_require__.n(debounce),VMTemplatevue_type_script_lang_js={components:{FLookupField:FLookupField/* default */.Z,FLookupFieldWizard:FLookupFieldWizard["default"],LookupWizard:ui_forms/* LookupWizard */.ns},props:["isNew","vmInfo"],data:function(){return{vmTemplateObj:{name:"",description:"",utilityType:{id:null},assetCategory:{id:null},spaceCategory:{id:null},scope:null,assets:null,spaces:null,siteIds:[],buildingIds:[],relationShipId:null},validationRules:{name:[{required:!0,message:"Please enter VM template name",trigger:"blur"}],utilityType:[{required:!0,message:"Please select utility type",trigger:"change"}],assetCategory:[{required:!0,message:"Please select asset category",trigger:"change"}],spaceCategory:[{required:!0,message:"Please select space category",trigger:"change"}],scope:[{required:!0,message:"Please select scope",trigger:"change"}],siteIds:[{required:!0,message:"Please select sites",trigger:"change"}],buildingIds:[{required:!0,message:"Please select buildings",trigger:"change"}],relationShipId:[{required:!0,message:"Please select relationship",trigger:"change"}]},utilityTypeField:{lookupModuleName:"utilitytype",lookupModule:{type:-1},options:[],isDataLoading:!1,placeHolderText:"".concat(this.$t("asset.virtual_meters.select_utilityType"))},siteField:{isDataLoading:!1,options:[],lookupModuleName:"site",placeHolderText:"".concat(this.$t("asset.virtual_meters.select_sites")),field:{lookupModule:{name:"site",displayName:"Site"}},multiple:!0},buildingField:{isDataLoading:!1,options:[],lookupModuleName:"building",placeHolderText:"".concat(this.$t("asset.virtual_meters.select_buildings")),field:{lookupModule:{name:"building",displayName:"Building"}},filters:{},multiple:!0},assetCategoryField:{lookupModuleName:"assetcategory",lookupModule:{type:-1},options:[],isDataLoading:!1,placeHolderText:"".concat(this.$t("asset.virtual_meters.select_asset_category"))},spaceCategoryField:{lookupModuleName:"spacecategory",lookupModule:{type:-1},options:[],isDataLoading:!1,placeHolderText:"".concat(this.$t("asset.virtual_meters.select_space_category"))},assetField:{isDataLoading:!1,options:[],lookupModuleName:"asset",placeHolderText:"".concat(this.$t("asset.virtual_meters.select_asset")),field:{lookupModule:{name:"asset",displayName:"Asset"}},multiple:!0},spaceField:{lookupModuleName:"space",field:{lookupModule:{name:"space",displayName:"Space"}},options:[],isDataLoading:!1,multiple:!0,placeHolderText:"".concat(this.$t("asset.virtual_meters.select_space"))},scopeOptions:[{value:1,label:"All Floors"},{value:2,label:"All Spaces"},{value:3,label:"Space Category"},{value:4,label:"Asset Category"},{value:7,label:"All Buildings"},{value:8,label:"Sites"}],canShowLookupWizard:!1,selectedLookupField:null,selectedAssetCategoryLabel:"",selectedSpaceCategoryLabel:"",canShowLookup:!0,relationshipOptions:[],newRelationName:null}},created:function(){this.vmTemplateObj=this.vmInfo,this.remoteRelationRequest=debounce_default()(this.getRelationRemote,500),this.isNew||this.fetchRelationOptions()},computed:{checkNewLookupWizardEnabled:function(){return this.$helpers.isLicenseEnabled("NEW_LOOKUP_WIZARD")},relationSelectAllowed:function(){var vmTemplateObj=this.vmTemplateObj,_ref=vmTemplateObj||{},utilityType=_ref.utilityType,scope=_ref.scope;return!(0,validation/* isEmpty */.xb)(utilityType)&&!(0,validation/* isEmpty */.xb)(scope)}},watch:{vmTemplateObj:{handler:function(newVal){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:(0,validation/* isEmpty */.xb)(newVal)||_this.$emit("updateVirtualMeter",newVal);case 1:case"end":return _context.stop()}}),_callee)})))()},deep:!0}},methods:{showLookupWizard:function(field,canShow){this.$set(this,"selectedLookupField",field),this.$set(this,"canShowLookupWizard",canShow)},onSpaceCategorySelected:function(selectedValue){var _ref2=selectedValue||{},label=_ref2.label,spaceField=this.spaceField,vmTemplateObj=this.vmTemplateObj,_ref3=spaceField||{},selectedItems=_ref3.selectedItems;(0,validation/* isEmpty */.xb)(label)||(this.selectedSpaceCategoryLabel=label),(0,validation/* isEmpty */.xb)(selectedItems)||(spaceField.selectedItems=[],this.$set(vmTemplateObj,"spaces",null))},onAssetCategorySelected:function(selectedValue){var _ref4=selectedValue||{},label=_ref4.label,assetField=this.assetField,vmTemplateObj=this.vmTemplateObj,_ref5=assetField||{},selectedItems=_ref5.selectedItems;(0,validation/* isEmpty */.xb)(label)||(this.selectedAssetCategoryLabel=label),(0,validation/* isEmpty */.xb)(selectedItems)||(assetField.selectedItems=[],this.$set(vmTemplateObj,"assets",null))},validate:function(){var _this2=this;return new Promise((function(resolve){_this2.$refs["vm-template-form"].validate((function(valid){resolve(!!valid)}))}))},isBuildingNeeded:function(scope){return!(0,validation/* isEmpty */.xb)(scope)&&(1==scope||2==scope||3==scope||4==scope)},setLookupFieldValue:function(props){var field=props.field,_field$selectedItems=field.selectedItems,selectedItems=void 0===_field$selectedItems?[]:_field$selectedItems,lookupModuleName=field.lookupModuleName,selectedItemIds=[];(0,validation/* isEmpty */.xb)(selectedItems)||(selectedItemIds=(selectedItems||[]).map((function(item){return item.value}))),"site"===lookupModuleName?this.$setProperty(this,"vmTemplateObj.siteIds",selectedItemIds):"building"===lookupModuleName&&this.$setProperty(this,"vmTemplateObj.buildingIds",selectedItemIds),this.selectedLookupField=null,this.canShowLookupWizard=!1},constructBuildingsFilter:function(){var _this3=this,vmTemplateObj=this.vmTemplateObj,_ref6=vmTemplateObj||{},siteIds=_ref6.siteIds,buildingFilters={},values=[];(0,validation/* isEmpty */.xb)(siteIds)||siteIds.forEach((function(id){values.push(id.toString())})),(0,validation/* isEmpty */.xb)(values)||(buildingFilters={siteId:{operatorId:9,value:values}}),this.$setProperty(this,"buildingField.filters",buildingFilters),this.$setProperty(this,"vmTemplateObj.buildingIds",[]),this.canShowLookup=!1,this.$nextTick((function(){_this3.canShowLookup=!0}))},getCategoryRecordById:function(id,moduleName){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var _yield$API$fetchRecor,_yield$API$fetchRecor2,record,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,api/* API */.bl.fetchRecord(moduleName,{id:id});case 2:if(_yield$API$fetchRecor=_context2.sent,_yield$API$fetchRecor2=_yield$API$fetchRecor[moduleName],record=void 0===_yield$API$fetchRecor2?{}:_yield$API$fetchRecor2,error=_yield$API$fetchRecor.error,error){_context2.next=10;break}return _context2.abrupt("return",record);case 10:_this4.$message.error((null===error||void 0===error?void 0:error.message)||"Error Occured");case 11:case"end":return _context2.stop()}}),_callee2)})))()},loadModuleMeta:function(scopeModulename){var _this5=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var _yield$API$get,data,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,api/* API */.bl.get("v2/modules/meta/".concat(scopeModulename));case 2:if(_yield$API$get=_context3.sent,data=_yield$API$get.data,error=_yield$API$get.error,!error){_context3.next=9;break}_this5.$message.error(_this5.$t("asset.virtual_meters.error_loading_module_meta")),_context3.next=10;break;case 9:return _context3.abrupt("return",_this5.$getProperty(data,"meta",{})||{});case 10:return _context3.abrupt("return",{});case 11:case"end":return _context3.stop()}}),_callee3)})))()},addRelationship:function(){var _this6=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){var newRelationName,vmTemplateObj,_ref7,utilityType,scope,assetCategory,spaceCategory,selectedUtilityType,vmScope,lookupModuleName,fromId,fromModuleDisplayName,selectedAssetCategory,selectedSpaceCategory,moduleMeta,toId,utilityTypeName,params,_yield$API$post,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:return newRelationName=_this6.newRelationName,vmTemplateObj=_this6.vmTemplateObj,_ref7=vmTemplateObj||{},utilityType=_ref7.utilityType,scope=_ref7.scope,assetCategory=_ref7.assetCategory,spaceCategory=_ref7.spaceCategory,_context4.next=4,_this6.getCategoryRecordById(utilityType,"utilitytype");case 4:if(selectedUtilityType=_context4.sent,vmScope=scope,lookupModuleName=_this6.$getProperty(vmScopeHash,"".concat(vmScope),null),(0,validation/* isEmpty */.xb)(lookupModuleName)||(0,validation/* isEmpty */.xb)(selectedUtilityType)){_context4.next=40;break}if(fromId=null,fromModuleDisplayName="","assetCategory"!==lookupModuleName){_context4.next=18;break}return _context4.next=13,_this6.getCategoryRecordById(assetCategory,"assetcategory");case 13:selectedAssetCategory=_context4.sent,fromId=_this6.$getProperty(selectedAssetCategory,"assetModuleID"),fromModuleDisplayName=_this6.$getProperty(selectedAssetCategory,"displayName"),_context4.next=31;break;case 18:if("spaceCategory"!==lookupModuleName){_context4.next=26;break}return _context4.next=21,_this6.getCategoryRecordById(spaceCategory,"spacecategory");case 21:selectedSpaceCategory=_context4.sent,fromId=_this6.$getProperty(selectedSpaceCategory,"spaceModuleID"),fromModuleDisplayName=_this6.$getProperty(selectedSpaceCategory,"displayName"),_context4.next=31;break;case 26:return _context4.next=28,_this6.loadModuleMeta(lookupModuleName);case 28:moduleMeta=_context4.sent,fromId=_this6.$getProperty(moduleMeta,"module.moduleId"),fromModuleDisplayName=_this6.$getProperty(moduleMeta,"module.displayName");case 31:return toId=_this6.$getProperty(selectedUtilityType,"meterModuleID"),utilityTypeName=_this6.$getProperty(selectedUtilityType,"name"),params={relation:{name:"".concat(newRelationName),fromModuleId:fromId,toModuleId:toId,relationName:"".concat(fromModuleDisplayName," to ").concat(utilityTypeName),reverseRelationName:"".concat(utilityTypeName," to ").concat(fromModuleDisplayName),relationType:1,relationCategory:3}},_context4.next=36,api/* API */.bl.post("v2/relation/addOrUpdate",params);case 36:_yield$API$post=_context4.sent,error=_yield$API$post.error,_yield$API$post.data,(0,validation/* isEmpty */.xb)(error)?_this6.getRelationOptions():_this6.$message.error(error.message||_this6.$t("asset.virtual_meters.error_creating_relationship"));case 40:case"end":return _context4.stop()}}),_callee4)})))()},getRelationRemote:function(searchText){var _this7=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee5(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context5){while(1)switch(_context5.prev=_context5.next){case 0:_this7.getRelationOptions(searchText),_this7.newRelationName=searchText;case 2:case"end":return _context5.stop()}}),_callee5)})))()},fetchRelationOptions:function(){this.getRelationOptions()},getRelationOptions:function(searchText){var _this8=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee6(){var vmTemplateObj,_ref8,utilityType,scope,assetCategory,spaceCategory,selectedUtilityType,vmScope,lookupModuleName,fromId,selectedAssetCategory,selectedSpaceCategory,moduleMeta,toId,params,_yield$API$get2,error,data;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context6){while(1)switch(_context6.prev=_context6.next){case 0:return vmTemplateObj=_this8.vmTemplateObj,_ref8=vmTemplateObj||{},utilityType=_ref8.utilityType,scope=_ref8.scope,assetCategory=_ref8.assetCategory,spaceCategory=_ref8.spaceCategory,_context6.next=4,_this8.getCategoryRecordById(utilityType,"utilitytype");case 4:if(selectedUtilityType=_context6.sent,vmScope=scope,lookupModuleName=_this8.$getProperty(vmScopeHash,"".concat(vmScope),null),(0,validation/* isEmpty */.xb)(lookupModuleName)||(0,validation/* isEmpty */.xb)(selectedUtilityType)){_context6.next=36;break}if(fromId=null,"assetCategory"!==lookupModuleName){_context6.next=16;break}return _context6.next=12,_this8.getCategoryRecordById(assetCategory,"assetcategory");case 12:selectedAssetCategory=_context6.sent,fromId=_this8.$getProperty(selectedAssetCategory,"assetModuleID"),_context6.next=27;break;case 16:if("spaceCategory"!==lookupModuleName){_context6.next=23;break}return _context6.next=19,_this8.getCategoryRecordById(spaceCategory,"spacecategory");case 19:selectedSpaceCategory=_context6.sent,fromId=_this8.$getProperty(selectedSpaceCategory,"spaceModuleID"),_context6.next=27;break;case 23:return _context6.next=25,_this8.loadModuleMeta(lookupModuleName);case 25:moduleMeta=_context6.sent,fromId=_this8.$getProperty(moduleMeta,"module.moduleId");case 27:return toId=_this8.$getProperty(selectedUtilityType,"meterModuleID"),params={fromModuleId:fromId,toModuleId:toId,relationType:1,relationCategory:3},(0,validation/* isEmpty */.xb)(searchText)||(params=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},params),{},{search:searchText})),_context6.next=32,api/* API */.bl.get("v2/relation/fetchRelations",params);case 32:_yield$API$get2=_context6.sent,error=_yield$API$get2.error,data=_yield$API$get2.data,(0,validation/* isEmpty */.xb)(error)&&(_this8.relationshipOptions=_this8.$getProperty(data,"relationList"));case 36:case"end":return _context6.stop()}}),_callee6)})))()}}},vmTemplate_VMTemplatevue_type_script_lang_js=VMTemplatevue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(vmTemplate_VMTemplatevue_type_script_lang_js,VMTemplatevue_type_template_id_1101e8f8_render,VMTemplatevue_type_template_id_1101e8f8_staticRenderFns,!1,null,null,null)
/* harmony default export */,VMTemplate=component.exports,ReadingDetailsFormvue_type_template_id_c292ef78_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("div",{staticClass:"vm-section-header pB10"},[_vm._v(" "+_vm._s(_vm.$t("asset.virtual_meters.reading_details"))+" ")]),_vm.showLoading?_c("div",{staticClass:"flex-middle fc-empty-white"},[_c("Spinner",{attrs:{show:_vm.showLoading,size:"80"}})],1):_c("div",{staticClass:"p30"},[_vm._l(_vm.readings,(function(reading,index){return _c("ReadingInfo",{key:"vm-reading-"+index,attrs:{isNew:_vm.isNew,vmInfo:_vm.getReadingContext(reading),reading:reading,meterReadings:_vm.meterReadings,canShowDelete:_vm.canShowDelete,validation:_vm.getValidationContext(reading),ruleCondition:_vm.getRuleCondition(reading)},on:{updateReading:function($event){var i=arguments.length,argsArray=Array(i);while(i--)argsArray[i]=arguments[i];return _vm.updateReading.apply(void 0,argsArray.concat([index]))},deleteReading:_vm.deleteReading}})})),_c("div",{staticClass:"pT20",class:_vm.disableReading},[_c("el-button",{staticClass:"add-new-reading-btn",on:{click:function($event){return _vm.addReading()}}},[_c("i",{staticClass:"el-icon-plus"}),_vm._v(" "+_vm._s(_vm.$t("asset.virtual_meters.add_new_reading_details"))+" ")])],1)],2)])},ReadingDetailsFormvue_type_template_id_c292ef78_scoped_true_staticRenderFns=[],ReadingInfovue_type_template_id_9cbc5250_render=(__webpack_require__(538077),__webpack_require__(425728),function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"vm-reading-card",class:_vm.readingContentClass},[_c("div",{staticClass:"vm-reading-collapse"},[_c("div",{staticClass:"vm-reading-title",class:_vm.titleClass},[_vm._v(" "+_vm._s(_vm.$getProperty(_vm.activeReading,"displayName",""))+" ")]),_c("div",{staticClass:"vm-action-buttons"},[_vm.canShowDelete?_c("div",{staticClass:"delete-vm-container",on:{click:_vm.deleteReading}},[_c("fc-icon",{staticClass:"vm-action",attrs:{group:"default",name:"trash-can",size:16}})],1):_c("div",{staticClass:"vm-delete-filler"}),_c("div",{staticClass:"vm-button-wrapper",class:_vm.disabledToggleClass,on:{click:_vm.toggleReadingContent}},[_c("fc-icon",{staticClass:"vm-action",attrs:{group:"navigation",name:_vm.accordionIconName,size:16}})],1)])]),_c("div",{staticClass:"p20 vm-reading-content",class:_vm.fullContentClass},[_c("el-row",[_c("el-col",{staticClass:"vm-reading-item",attrs:{span:12}},[_c("div",{staticClass:"vm-reading-title pT10"},[_vm._v(" "+_vm._s(_vm.$t("asset.virtual_meters.reading_name"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width80",attrs:{placeholder:_vm.$t("asset.virtual_meters.select_reading"),disabled:!_vm.isNew&&!_vm.isNewReading(_vm.readingInfo),clearable:""},on:{change:_vm.fillReadingUnit},model:{value:_vm.readingInfo.readingFieldId,callback:function($$v){_vm.$set(_vm.readingInfo,"readingFieldId",$$v)},expression:"readingInfo.readingFieldId"}},_vm._l(_vm.meterReadings,(function(reading){return _c("el-option",{key:reading.id,attrs:{label:reading.displayName,value:reading.id}})})),1)],1),_c("el-col",{staticClass:"vm-reading-item left-align",attrs:{span:8}},[_c("div",{staticClass:"vm-reading-title pT10"},[_vm._v(" "+_vm._s(_vm.$t("asset.virtual_meters.unit"))+" ")]),_c("el-input",{staticClass:"fc-input-full-border2 width70",attrs:{disabled:""},model:{value:_vm.readingInfo.unit,callback:function($$v){_vm.$set(_vm.readingInfo,"unit",$$v)},expression:"readingInfo.unit"}})],1)],1),_c("div",{staticClass:"vm-reading-item mT7"},[_c("div",{staticClass:"vm-reading-title"},[_vm._v(" "+_vm._s(_vm.$t("asset.virtual_meters.select_interval"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width40",attrs:{filterable:"",placeholder:_vm.$t("asset.virtual_meters.select_interval")},model:{value:_vm.readingInfo.frequency,callback:function($$v){_vm.$set(_vm.readingInfo,"frequency",$$v)},expression:"readingInfo.frequency"}},_vm._l(_vm.frequencies,(function(key,label){return _c("el-option",{key:key,attrs:{label:label,value:key}})})),1)],1),_c("div",{staticClass:"vm-reading-item mT7"},[_c("div",{staticClass:"vm-reading-title-main"},[_vm._v(" "+_vm._s(_vm.$t("asset.virtual_meters.formula_builder"))+" ")]),_c("VMFormulaBuilder",{staticClass:"width100 pL0 mT7",attrs:{isEditForm:!_vm.isNew,ruleCondition:_vm.ruleCondition,startDuration:_vm.readingInfo.frequency,moduleName:"virtualMeterTemplate"},on:{setCondition:_vm.setCondition}})],1)],1)])}),ReadingInfovue_type_template_id_9cbc5250_staticRenderFns=[],VMFormulaBuildervue_type_template_id_0927aaa6_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"vm-formula-builder"},[_vm.addRelatedGroups?_c("div",{staticClass:"pL0 mT0"},[_c("div",{staticClass:"vm-reading-sub-title sub-heading mB10"},[_vm._v(" "+_vm._s(_vm.$t("rule.create.related_groups"))+" ")]),_c("div",{staticClass:"cost-impact"},_vm._l(_vm.relatedGroups,(function(relGroup,index){return _c("div",{key:"relGroups-"+index},[_c("div",{staticClass:"rel-group-variable-row"},[_c("el-input",{staticClass:"fc-input-full-border2 width70px rel-group-variable-container",attrs:{type:"text",readonly:!0},model:{value:relGroup.relGroupName,callback:function($$v){_vm.$set(relGroup,"relGroupName",$$v)},expression:"relGroup.relGroupName"}}),_c("span",{staticClass:"separator variable-separator"},[_vm._v("|")]),[_c("el-select",{staticClass:"fc-input-full-border width40 rel-group-linkname-container",attrs:{placeholder:_vm.$t("rule.create.select_relation")},on:{change:function($event){return _vm.handleRelGroupUpdate(relGroup)}},scopedSlots:_vm._u([{key:"prefix",fn:function(){return[_vm.relGroupHasMappingLinkName(relGroup)?_c("div",{staticClass:"display-flex"},[_c("fc-icon",{staticClass:"pR10",attrs:{group:"action",name:relGroup.iconName}})],1):_vm._e()]},proxy:!0}],null,!0),model:{value:relGroup.relMapContext.mappingLinkName,callback:function($$v){_vm.$set(relGroup.relMapContext,"mappingLinkName",$$v)},expression:"relGroup.relMapContext.mappingLinkName"}},_vm._l(_vm.relatedGroupsOptions,(function(relMap,index){return _c("el-option",{key:index,attrs:{label:relMap.label,value:relMap.reverseRelationLinkName}},[_c("div",{staticClass:"display-flex"},[_c("fc-icon",{staticClass:"pR10",attrs:{group:"action",name:relMap.iconName}}),_vm._v(" "+_vm._s(relMap.label)+" ")],1)])})),1)],1!==relGroup.relationType&&_vm.relGroupHasMappingLinkName(relGroup)?_c("el-select",{staticClass:"fc-input-full-border2 mL10 width15",attrs:{filterable:"",placeholder:"Choose Aggregation"},on:{change:_vm.constructNamespace},model:{value:relGroup.relAggregationType,callback:function($$v){_vm.$set(relGroup,"relAggregationType",$$v)},expression:"relGroup.relAggregationType"}},_vm._l(_vm.relAggregateOptions,(function(key,label){return _c("el-option",{key:key,attrs:{label:label,value:key}})})),1):_vm._e(),_vm.relGroupHasCriteria(relGroup)?_c("div",{staticClass:"criteria_button_related"},[_c("el-button",{staticClass:"mL10",on:{click:function($event){return _vm.openCriteriaBuilder(relGroup,!0)}}},[_vm._v(_vm._s(_vm.$t("rule.create.edit_criteria")))]),_c("el-button",{staticClass:"mL10",on:{click:function($event){return _vm.resetCriteria(relGroup)}}},[_vm._v(_vm._s(_vm.$t("common._common.reset")))])],1):1!==relGroup.relationType?_c("div",{staticClass:"criteria_button_related  mL10"},[_c("el-button",{on:{click:function($event){return _vm.openCriteriaBuilder(relGroup,!1)}}},[_vm._v(_vm._s(_vm.$t("rule.create.add_criteria")))])],1):_vm._e(),_c("div",{staticClass:"rel-group-delete-icon p10",on:{click:function($event){return _vm.showConfirmDelete(index)}}},[_c("fc-icon",{staticClass:"vm-action",attrs:{group:"default",name:"trash-can",size:18}})],1)],2)])})),0),_c("div",{staticClass:"d-flex mT10 mB10 align-center pB10",class:_vm.getRelGroupClassName},[_c("fc-icon",{attrs:{group:"navigation",name:"addition",size:"16",color:"#0074d1"}}),_c("div",{staticClass:"fc-id  pointer f14 pL5",on:{click:_vm.addRelGroup}},[_vm._v(" "+_vm._s(_vm.$t("rule.create.add_new_related_group"))+" ")])],1)]):_vm._e(),_c("FDialog",{attrs:{visible:_vm.showCriteriaBuilder,width:"50%",title:_vm.addOrEditCriteria+" Criteria"},on:{"update:visible":function($event){_vm.showCriteriaBuilder=$event},save:_vm.saveCriteria,close:_vm.closeCriteria}},[_c("CriteriaBuilder",{key:_vm.groupKey,staticClass:"pB20 pR75",attrs:{moduleName:_vm.currentToModuleName},model:{value:_vm.criteria,callback:function($$v){_vm.criteria=$$v},expression:"criteria"}})],1),_vm.addRelatedGroups?_c("div",{staticClass:"mT7"}):_vm._e(),_c("div",{staticClass:"pL0 mT0"},[_c("div",{staticClass:"display-flex-between-space fc__layout_media_center pB5 width97"},[_c("div",{staticClass:"vm-reading-sub-title sub-heading mB10"},[_vm._v(" "+_vm._s(_vm.$t("common._common.variables"))+" ")]),_vm.addRelatedGroups||"faultImpact"===_vm.moduleName?_vm._e():_c("div",{staticClass:"d-flex align-center pR15",on:{click:_vm.enableRelatedGroups}},[_c("fc-icon",{attrs:{group:"navigation",name:"addition",size:"16",color:"#0074d1"}}),_c("div",{staticClass:"fc-id  pointer f14 pL5"},[_vm._v(" "+_vm._s(_vm.$t("rule.create.add_related_group"))+" ")])],1)]),_c("div",{staticClass:"cost-impact"},[_vm._l(_vm.variables,(function(variable,index){return _c("div",{key:"variables-"+index},[_c("div",{staticClass:"variable-row d-flex"},[_c("el-input",{staticClass:"fc-input-full-border2 width110px variable-container",attrs:{type:"text"},model:{value:variable.varName,callback:function($$v){_vm.$set(variable,"varName",$$v)},expression:"variable.varName"}}),_c("span",{staticClass:"separator variable-separator"},[_vm._v("|")]),variable.readingsInitLoading?_c("FieldLoader",{staticClass:"width25",attrs:{isLoading:variable.readingsInitLoading}}):_c("el-select",{staticClass:"fc-input-full-border2 width25",attrs:{placeholder:_vm.$t("setup.formulaBuilder.choose_module")},on:{change:function($event){return _vm.loadReadings(null,null,variable)}},model:{value:variable.type,callback:function($$v){_vm.$set(variable,"type",$$v)},expression:"variable.type"}},_vm._l(_vm.moduleOptions,(function(key,label){return _c("el-option",{key:key,attrs:{label:label,value:key}})})),1),variable.readingsInitLoading?_c("FieldLoader",{staticClass:"mL10 width25",attrs:{isLoading:variable.readingsInitLoading}}):"RELATED_READING"!==variable.type?_c("FLookupField",{key:variable.type+"-field",ref:variable.type+"-picker",refInFor:!0,staticClass:"mL10 width25",attrs:{model:variable.resourceId,field:_vm.getLookupField(variable)},on:{showLookupWizard:function($event){var i=arguments.length,argsArray=Array(i);while(i--)argsArray[i]=arguments[i];return _vm.showLookupWizard.apply(void 0,argsArray.concat([variable]))},recordSelected:function($event){var i=arguments.length,argsArray=Array(i);while(i--)argsArray[i]=arguments[i];return _vm.loadReadings.apply(void 0,argsArray.concat([variable]))}}}):[_c("el-select",{staticClass:"fc-input-full-border2 mL10 width25",attrs:{placeholder:_vm.$t("rule.create.select_relation"),clearable:""},on:{change:function($event){return _vm.loadReadings(null,_vm.relationField,variable)}},model:{value:variable.relGroupId,callback:function($$v){_vm.$set(variable,"relGroupId",$$v)},expression:"variable.relGroupId"}},_vm._l(_vm.relationReadingsForOptions,(function(relMap,index){return _c("el-option",{key:index,attrs:{label:relMap.relGroupName,value:relMap.id}})})),1)],variable.readingsInitLoading?_c("FieldLoader",{staticClass:"mL10 width30",attrs:{isLoading:variable.readingsInitLoading}}):_c("el-select",{staticClass:"fc-input-full-border2 mL10 width30",attrs:{filterable:"",loading:variable.readingsLoading,disabled:_vm.canDisableSelect(variable),placeholder:_vm.getPlaceHolderForReading(variable)},on:{change:function($event){return _vm.handleChange(variable)}},model:{value:variable.fieldId,callback:function($$v){_vm.$set(variable,"fieldId",$$v)},expression:"variable.fieldId"}},["ASSET_READING"===variable.type?_vm._l(_vm.getAssetReadings(variable),(function(field){return _c("el-option",{key:variable.id+"-"+field.name,attrs:{label:field.displayName,value:field.id}})})):"SPACE_READING"===variable.type?_vm._l(_vm.getSpaceReadings(variable),(function(field){return _c("el-option",{key:variable.id+"-"+field.name,attrs:{label:field.displayName,value:field.fieldId}})})):"RELATED_READING"===variable.type?_vm._l(_vm.getRelationReadings(variable),(function(field){return _c("el-option",{key:variable.id+"-"+field.name,attrs:{label:field.displayName,value:field.id}})})):"ASSET"===variable.type?_vm._l(_vm.assetFields,(function(field){return _c("el-option",{key:variable.id+"-"+field.name,attrs:{label:field.displayName,value:field.id}})})):"SPACE"===variable.type?_vm._l(_vm.spaceFields,(function(field){return _c("el-option",{key:variable.id+"-"+field.name,attrs:{label:field.displayName,value:field.id}})})):_vm._e()],2),variable.readingsInitLoading?_c("FieldLoader",{staticClass:"mL15 width25",attrs:{isLoading:variable.readingsInitLoading}}):_c("el-select",{staticClass:"fc-input-full-border2  mL15 width25",attrs:{filterable:"",disabled:_vm.disableAggregation(variable),placeholder:"Choose Aggregation"},on:{change:function($event){return _vm.handleAggrgation(variable)}},model:{value:variable.aggregationType,callback:function($$v){_vm.$set(variable,"aggregationType",$$v)},expression:"variable.aggregationType"}},_vm._l(_vm.aggregateOptions,(function(key,label){return _c("el-option",{key:key,attrs:{label:label,value:key}})})),1),variable.readingsInitLoading?_c("FieldLoader",{staticClass:"mL15 width30",attrs:{isLoading:variable.readingsInitLoading}}):_vm.isScheduledKpi?_vm._e():_c("el-select",{staticClass:"fc-input-full-border2 mL15 width30",attrs:{disabled:_vm.disableTime(variable),placeholder:"Choose Time"},on:{change:_vm.constructNamespace},model:{value:variable.dataInterval,callback:function($$v){_vm.$set(variable,"dataInterval",$$v)},expression:"variable.dataInterval"}},_vm._l(_vm.getInterval,(function(key,label){return _c("el-option",{key:key,attrs:{label:label,value:key}})})),1),_c("div",{staticClass:"delete-icon p10",class:_vm.getDeleteBtnClassName(index),on:{click:function($event){return _vm.deleteVariable(index)}}},[_c("fc-icon",{staticClass:"vm-action",attrs:{group:"default",name:"trash-can",size:18}})],1)],2)])})),_vm.canShowLookupWizard?[_vm.isNewLookupWizardEnabled?_c("LookupWizard",{attrs:{canShowLookupWizard:_vm.canShowLookupWizard,field:_vm.selectedLookupField},on:{"update:canShowLookupWizard":function($event){_vm.canShowLookupWizard=$event},"update:can-show-lookup-wizard":function($event){_vm.canShowLookupWizard=$event},setLookupFieldValue:_vm.setFieldValue}}):_c("FLookupFieldWizard",{attrs:{canShowLookupWizard:_vm.canShowLookupWizard,selectedLookupField:_vm.selectedLookupField},on:{"update:canShowLookupWizard":function($event){_vm.canShowLookupWizard=$event},"update:can-show-lookup-wizard":function($event){_vm.canShowLookupWizard=$event},setLookupFieldValue:_vm.setFieldValue}})]:_vm._e()],2),_c("div",{staticClass:"d-flex mT10 mB10 align-center",class:_vm.getVariableClassName},[_c("fc-icon",{attrs:{group:"navigation",name:"addition",size:"16",color:"#0074d1"}}),_c("div",{staticClass:"fc-id  pointer f14 pL5",on:{click:_vm.addVariable}},[_vm._v(" "+_vm._s(_vm.$t("rule.create.add_new_variable"))+" ")])],1),_c("div",{staticClass:"pB30"},[_c("div",{staticClass:"display-flex-between-space width97 mT30 pB10"},[_c("div",{staticClass:"vm-reading-sub-title sub-headingrequired-label"},[_vm._v(" "+_vm._s(_vm.$t("rule.create.expression"))+" ")]),_vm.canShowToggle?_c("div",{staticClass:"toggle-text",on:{click:function($event){return _vm.toggleEditor(!0)}}},[_vm._v(" "+_vm._s(_vm.switchHelper)+" ")]):_vm._e()]),"expression"===_vm.expressionType?_c("el-input",{staticClass:"fc-input-full-border2 width97",attrs:{type:"text",placeholder:""+this.$t("rule.create.enter_expression"),autofocus:!0},on:{input:function($event){return _vm.handleExpression()}},model:{value:_vm.expressionViewString,callback:function($$v){_vm.expressionViewString=$$v},expression:"expressionViewString"}}):_c("div",{staticClass:"height250 overflow-y-scroll width97 pB50 formula-code"},[_c("CodeMirror",{attrs:{codeeditor:!0},model:{value:_vm.codeViewString,callback:function($$v){_vm.codeViewString=$$v},expression:"codeViewString"}})],1)],1)])],1)},VMFormulaBuildervue_type_template_id_0927aaa6_staticRenderFns=[],toConsumableArray=__webpack_require__(488478),FormulaBuilder=(__webpack_require__(169358),__webpack_require__(945484)),isEqual=__webpack_require__(618446),isEqual_default=__webpack_require__.n(isEqual),getFreqInterval=function(freq){var durations={6:"10 Mins",7:"15 Mins",8:"20 Mins",9:"30 Mins",10:"1 Hr",11:"2 Hr",12:"3 Hr",13:"4 Hr",14:"8 Hr",15:"12 Hr",16:"1 Day"};return durations[freq]?durations[freq]:null},VMFormulaBuildervue_type_script_lang_js={name:"VMFormulaBuilder",extends:FormulaBuilder/* default */.Z,props:["startDuration"],data:function(){return{codeBoilerPlate:"Number test(){\n    \nreturn  ;  \n}"}},computed:{getInterval:function(){var _this=this,frequency=this.$getProperty(this,"startDuration"),startfreq=getFreqInterval(frequency),map={};if(!(0,utils_validation/* isEmpty */.xb)(startfreq)){var starttime=this.timeOptions[startfreq];Object.keys(this.timeOptions).filter((function(optionKey){return _this.timeOptions[optionKey]>=starttime})).forEach((function(optionKey){_this.$set(map,optionKey,_this.timeOptions[optionKey])}))}return map}},watch:{ruleCondition:{handler:function(newVal,oldVal){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:(0,utils_validation/* isEmpty */.xb)(newVal)||isEqual_default()(oldVal,newVal)||_this2.loadRelatedGroupsList();case 1:case"end":return _context.stop()}}),_callee)})))()},deep:!0}},methods:{loadAssetCategories:function(){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var params,_yield$API$get,data,error,_ref,moduleDatas;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return params={page:1,perPage:5e3,withCount:!0},_context2.next=3,api/* API */.bl.get("v2/module/data/list?moduleName=assetcategory",params);case 3:return _yield$API$get=_context2.sent,data=_yield$API$get.data,error=_yield$API$get.error,(0,utils_validation/* isEmpty */.xb)(error)&&(_ref=data||[],moduleDatas=_ref.moduleDatas,_this3.assetCategoryList=moduleDatas,_this3.assetCatListLoaded=!0),_context2.next=9,_this3.loadUtilityTypes();case 9:case"end":return _context2.stop()}}),_callee2)})))()},loadUtilityTypes:function(){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var params,_yield$API$get2,data,error,assetCategoryList,utilitytypes;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return params={page:1,perPage:50,withCount:!0},_context3.next=3,api/* API */.bl.get("v2/module/data/list?moduleName=utilitytype",params);case 3:_yield$API$get2=_context3.sent,data=_yield$API$get2.data,error=_yield$API$get2.error,(0,utils_validation/* isEmpty */.xb)(error)&&(assetCategoryList=_this4.assetCategoryList,utilitytypes=_this4.$getProperty(data,"moduleDatas",[]),assetCategoryList=[].concat((0,toConsumableArray/* default */.Z)(assetCategoryList),(0,toConsumableArray/* default */.Z)(utilitytypes)),_this4.assetCategoryList=assetCategoryList,_this4.assetCatListLoaded=!0);case 7:case"end":return _context3.stop()}}),_callee3)})))()},loadRelatedGroupsList:function(categoryId){var _this5=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){var relationField,ruleCondition,_ref2,moduleName,assetCategoryId,url,params,_yield$API$get3,error,data,_ref3,relationList,relatedGroupsOptions;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:if(relationField=_this5.relationField,ruleCondition=_this5.ruleCondition,_ref2=ruleCondition||{},moduleName=_ref2.lookupModuleName,assetCategoryId=_ref2.assetCategoryId,categoryId=assetCategoryId,!["assetCategory","spaceCategory"].includes(moduleName)||!(0,utils_validation/* isEmpty */.xb)(categoryId)){_context4.next=5;break}return _context4.abrupt("return");case 5:if((0,utils_validation/* isEmpty */.xb)(categoryId)||(moduleName=_this5.getCategoryName(categoryId)),_this5.$set(relationField,"lookupModuleName",moduleName),(0,utils_validation/* isEmpty */.xb)(moduleName)){_context4.next=16;break}return url="/v2/relation/list",params={moduleName:moduleName},_context4.next=12,api/* API */.bl.get(url,params);case 12:_yield$API$get3=_context4.sent,error=_yield$API$get3.error,data=_yield$API$get3.data,error?_this5.$message.error("Error Occured"):(_ref3=data||{},relationList=_ref3.relationList,relatedGroupsOptions=relationList.filter((function(relation){return _this5.isNotManyToManyRelation(relation)})),relatedGroupsOptions=relatedGroupsOptions.map((function(relationMap){var _ref4=relationMap||{},name=_ref4.name,reverseRelationLinkName=_ref4.reverseRelationLinkName,relationType=_ref4.relationType,label="".concat(name," - ").concat(reverseRelationLinkName),iconName=_this5.getRelTypeIconName(relationType);return(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},relationMap),{},{label:label,iconName:iconName})})),_this5.relatedGroupsOptions=relatedGroupsOptions);case 16:case"end":return _context4.stop()}}),_callee4)})))()},loadRelationReadings:function(variable){var _this6=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee5(){var _ref5,id,relatedGroups,initiated,_ref6,relGroupId,chosenRelGroup,toModuleId,_this6$getCategoryId,category,type,url,params,_yield$API$get4,readingsData,readingsError,_ref7,readings;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context5){while(1)switch(_context5.prev=_context5.next){case 0:if(_ref5=variable||{},id=_ref5.id,relatedGroups=_this6.relatedGroups,initiated=_this6.initiated,_this6.$set(_this6.readingsMap[id],"relationReadings",relatedGroups.filter((function(relGroup){return!(0,utils_validation/* isEmpty */.xb)(relGroup.relMapContext.mappingLinkName)}))),_this6.$set(variable,"resourceId",-1),initiated||(variable.readingsInitLoading=!0),_this6.$set(variable,"readingsLoading",!0),_ref6=variable||{},relGroupId=_ref6.relGroupId,(0,utils_validation/* isEmpty */.xb)(relGroupId)){_context5.next=20;break}if(chosenRelGroup=relatedGroups.find((function(relGroup){return relGroup.id===relGroupId})),toModuleId=_this6.getRelationModuleId(variable,chosenRelGroup),_this6$getCategoryId=_this6.getCategoryId(toModuleId),category=_this6$getCategoryId.category,type=_this6$getCategoryId.type,(0,utils_validation/* isEmpty */.xb)(category)){_context5.next=20;break}return url="utility"===type?"v2/readings/utilitytype":"v2/readings/assetcategory",params={id:category,excludeEmptyFields:!0},_context5.next=16,api/* API */.bl.get(url,params);case 16:_yield$API$get4=_context5.sent,readingsData=_yield$API$get4.data,readingsError=_yield$API$get4.error,readingsError?_this6.$message.error("Error Occured"):(_ref7=readingsData||{},readings=_ref7.readings,Object.prototype.hasOwnProperty.call(_this6.readingsMap,id)&&(_this6.$set(_this6.readingsMap[id],"readingName",readings),_this6.$set(variable,"readingsLoading",!1),initiated||(variable.readingsInitLoading=!1)));case 20:_this6.setVariables(variable,id);case 21:case"end":return _context5.stop()}}),_callee5)})))()},getCategoryId:function(moduleId){var _ref8=this||{},assetCategoryList=_ref8.assetCategoryList;if(moduleId>0&&assetCategoryList){var type="",category=(assetCategoryList||[]).find((function(category){var _ref9=category||{},assetModuleID=_ref9.assetModuleID,meterModuleID=_ref9.meterModuleID,relModuleId=null;return(0,utils_validation/* isEmpty */.xb)(meterModuleID)?(relModuleId=assetModuleID,type="assetCategory"):(relModuleId=meterModuleID,type="utility"),relModuleId===moduleId}));return{category:this.$getProperty(category,"id",null),type:type}}},deleteVariable:function(index){var variables=this.variables,variable=variables[index],id=variable.id;delete this.readingsMap[id],this.variables=this.variables.filter((function(obj,i){return i!==index})),(0,utils_validation/* isEmpty */.xb)(this.variables)&&this.initVariables(),this.constructNamespace(),this.handleExpression()},handleChange:function(variable){if(this.handleReading(variable),9e5==variable.dataInterval){var frequency=this.$getProperty(this,"startDuration"),startfreq=getFreqInterval(frequency),starttime=this.timeOptions[startfreq];variable.dataInterval=starttime}}}},vmTemplate_VMFormulaBuildervue_type_script_lang_js=VMFormulaBuildervue_type_script_lang_js,VMFormulaBuilder_component=(0,componentNormalizer/* default */.Z)(vmTemplate_VMFormulaBuildervue_type_script_lang_js,VMFormulaBuildervue_type_template_id_0927aaa6_render,VMFormulaBuildervue_type_template_id_0927aaa6_staticRenderFns,!1,null,null,null)
/* harmony default export */,VMFormulaBuilder=VMFormulaBuilder_component.exports,frequencies={"10 Mins":6,"15 Mins":7,"20 Mins":8,"30 Mins":9,"1 Hr":10,"2 Hr":11,"3 Hr":12,"4 Hr":13,"8 Hr":14,"12 Hr":15,"1 Day":16},ReadingInfovue_type_script_lang_js={components:{VMFormulaBuilder:VMFormulaBuilder},props:["isNew","vmInfo","meterReadings","reading","canShowDelete","validation","ruleCondition"],data:function(){return{readingInfo:null,frequencies:frequencies,readingContentClass:""}},created:function(){this.readingInfo=this.reading},computed:{activeReading:function(){var readingInfo=this.readingInfo,meterReadings=this.meterReadings,_ref=readingInfo||{},readingFieldId=_ref.readingFieldId,reading=(meterReadings||[]).find((function(reading){return reading.id===readingFieldId}));return reading||{}},fullContentClass:function(){var readingContentClass=this.readingContentClass;return(0,utils_validation/* isEmpty */.xb)(readingContentClass)?"content-top":""},titleClass:function(){var readingContentClass=this.readingContentClass;return(0,utils_validation/* isEmpty */.xb)(readingContentClass)?"hide-title":""},accordionIconName:function(){var titleClass=this.titleClass;return(0,utils_validation/* isEmpty */.xb)(titleClass)?"accordion-down":"accordion-up"},disabledToggleClass:function(){var activeReading=this.activeReading;return(0,utils_validation/* isEmpty */.xb)(activeReading)?"vm-disable-reading-collapse":""}},watch:{readingInfo:{handler:function(newVal){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:(0,utils_validation/* isEmpty */.xb)(newVal)||_this.$emit("updateReading",newVal);case 1:case"end":return _context.stop()}}),_callee)})))()},deep:!0},reading:{handler:function(newVal){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_this2.readingInfo=newVal||{};case 1:case"end":return _context2.stop()}}),_callee2)})))()},deep:!0},activeReading:{handler:function(){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var isNew;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:isNew=_this3.isNew,isNew||_this3.fillReadingUnit();case 2:case"end":return _context3.stop()}}),_callee3)})))()},deep:!0}},methods:{deleteReading:function(){var readingInfo=this.readingInfo,_ref2=readingInfo||{},uuid=_ref2.uuid;this.$emit("deleteReading",uuid)},setCondition:function(condition){var readingInfo=this.readingInfo;this.readingInfo=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},readingInfo),condition)},toggleReadingContent:function(){var readingContentClass=this.readingContentClass;(0,utils_validation/* isEmpty */.xb)(readingContentClass)?this.readingContentClass="vm-reading-collapse-content":this.readingContentClass=""},fillReadingUnit:function(){var readingInfo=this.readingInfo,activeReading=this.activeReading,_ref3=readingInfo||{},readingFieldId=_ref3.readingFieldId;if((0,utils_validation/* isEmpty */.xb)(readingFieldId))this.$set(this.readingInfo,"unit","");else{var unit=this.$getProperty(activeReading,"unit","");this.$set(this.readingInfo,"unit",unit)}},isNewReading:function(reading){var _ref4=reading||{},id=_ref4.id;return!!(0,utils_validation/* isEmpty */.xb)(id)}}},vmTemplate_ReadingInfovue_type_script_lang_js=ReadingInfovue_type_script_lang_js,ReadingInfo_component=(0,componentNormalizer/* default */.Z)(vmTemplate_ReadingInfovue_type_script_lang_js,ReadingInfovue_type_template_id_9cbc5250_render,ReadingInfovue_type_template_id_9cbc5250_staticRenderFns,!1,null,null,null)
/* harmony default export */,ReadingInfo=ReadingInfo_component.exports,cloneDeep=__webpack_require__(150361),cloneDeep_default=__webpack_require__.n(cloneDeep),Spinner=__webpack_require__(604947),uuid=__webpack_require__(455877),ReadingDetailsFormvue_type_script_lang_js={components:{ReadingInfo:ReadingInfo,Spinner:Spinner/* default */.Z},props:["isNew","vmInfo"],data:function(){return{readings:[],meterReadings:[],readingValidations:[],showLoading:!1}},created:function(){var isNew=this.isNew;isNew?this.addReading():this.initReadings()},computed:{utilityType:function(){var vmInfo=this.vmInfo;return this.$getProperty(vmInfo,"utilityType",null)},vmScope:function(){var vmInfo=this.vmInfo;return this.$getProperty(vmInfo,"scope",null)},canShowDelete:function(){var readings=this.readings;return(readings||[]).length>1},relationConfig:function(){var vmInfo=this.vmInfo,vmScope=this.vmScope,lookupModuleName=this.$getProperty(vmScopeHash,"".concat(vmScope),null),assetCategoryId=null;return["assetCategory","spaceCategory"].includes(lookupModuleName)&&(assetCategoryId=this.$getProperty(vmInfo,"".concat(lookupModuleName),null)),{assetCategoryId:assetCategoryId,lookupModuleName:lookupModuleName}},disableReading:function(){var readingValidations=this.readingValidations,inValidReading=(readingValidations||[]).filter((function(validation){return!validation.valid}));return(0,utils_validation/* isEmpty */.xb)(inValidReading)?"":"disable-vm-reading-add"}},watch:{utilityType:{handler:function(newVal,oldVal){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:(0,utils_validation/* isEmpty */.xb)(newVal)||isEqual_default()(oldVal,newVal)?_this.meterReadings=[]:_this.getAllMeterReadings();case 1:case"end":return _context.stop()}}),_callee)})))()},immediate:!0},vmScope:{handler:function(newVal,oldVal){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:(0,utils_validation/* isEmpty */.xb)(newVal)||isEqual_default()(oldVal,newVal)?_this2.meterReadings=[]:(0,utils_validation/* isEmpty */.xb)(oldVal)||_this2.resetReadings();case 1:case"end":return _context2.stop()}}),_callee2)})))()},immediate:!0}},methods:{initReadings:function(){var vmInfo=this.vmInfo,_ref=vmInfo||{},readings=_ref.readings;this.syncReadings(readings)},addReading:function(){var readings=this.readings,readingObj=cloneDeep_default()(readingModel);readingObj=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},readingObj),{},{uuid:(0,uuid.v4)().substring(0,4)}),readings.push(readingObj),this.syncReadings(readings)},updateReading:function(reading,index){var readings=this.readings;readings[index]=reading||{},this.syncReadings(readings)},getReadingContext:function(reading){var vmInfo=this.vmInfo;return(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},vmInfo),reading)},deleteReading:function(uuid){var readings=this.readings;readings=(readings||[]).filter((function(reading){return reading.uuid!==uuid})),this.syncReadings(readings)},syncReadings:function(readings){this.validateVMReadings(readings),this.$emit("updateVirtualMeter",{readings:readings}),this.readings=readings},validateVMReadings:function(readings){var _this3=this;return new Promise((function(resolve){var validatedReadings=validateReadings(readings)||[],inValidReading=validatedReadings.filter((function(reading){return!reading.valid}));_this3.readingValidations=validatedReadings,resolve((0,utils_validation/* isEmpty */.xb)(inValidReading))}))},getValidationContext:function(reading){var readingValidations=this.readingValidations,_ref2=reading||{},uuid=_ref2.uuid,validation=(readingValidations||[]).find((function(validation){return validation.uuid===uuid}))||{};return validation},getRuleCondition:function(reading){var relationConfig=this.relationConfig;return(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},relationConfig),reading)},getAllMeterReadings:function(){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var utilityType,readings;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return utilityType=_this4.utilityType,_context3.next=3,loadMeterReadingFields(null,utilityType,!1,null,!0);case 3:readings=_context3.sent,_this4.meterReadings=readings||[];case 5:case"end":return _context3.stop()}}),_callee3)})))()},resetReadings:function(){var _this5=this;this.showLoading=!0,this.readings=[],this.addReading(),this.$nextTick((function(){_this5.showLoading=!1}))}}},vmTemplate_ReadingDetailsFormvue_type_script_lang_js=ReadingDetailsFormvue_type_script_lang_js,ReadingDetailsForm_component=(0,componentNormalizer/* default */.Z)(vmTemplate_ReadingDetailsFormvue_type_script_lang_js,ReadingDetailsFormvue_type_template_id_c292ef78_scoped_true_render,ReadingDetailsFormvue_type_template_id_c292ef78_scoped_true_staticRenderFns,!1,null,"c292ef78",null)
/* harmony default export */,ReadingDetailsForm=ReadingDetailsForm_component.exports,VMDetailsFormvue_type_template_id_72895ebc_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("div",{staticClass:"vm-section-header"},[_vm._v(" "+_vm._s(_vm.$t("asset.virtual_meters.meters_info"))+" ")]),_c("el-form",{ref:"vm-details-form",staticClass:"p50 pT10 pB30",attrs:{model:_vm.vmDetailsObj,rules:_vm.validationRules,"label-width":"150px","label-position":"left"}},[_c("div",{staticClass:"section-container flex-container"},[_c("div",{staticClass:"vm-form-item"},[_c("el-form-item",{attrs:{label:""+this.$t("asset.virtual_meters.meter_name"),prop:"meterName"}},[_c("el-input",{staticClass:"fc-input-full-border2 width60",attrs:{disabled:!_vm.isNew,placeholder:""+this.$t("asset.virtual_meters.enter_meter_name"),autofocus:!0},model:{value:_vm.vmDetailsObj.meterName,callback:function($$v){_vm.$set(_vm.vmDetailsObj,"meterName",$$v)},expression:"vmDetailsObj.meterName"}})],1)],1),_c("div",{staticClass:"vm-form-item"},[_c("el-form-item",{attrs:{label:""+this.$t("asset.virtual_meters.meter_description"),prop:"meterDescription"}},[_c("el-input",{staticClass:"mT3 fc-input-full-border-textarea width60",attrs:{type:"textarea",autofocus:!0,"min-rows":2,autosize:{minRows:3,maxRows:4},placeholder:""+this.$t("asset.virtual_meters.description")},model:{value:_vm.vmDetailsObj.meterDescription,callback:function($$v){_vm.$set(_vm.vmDetailsObj,"meterDescription",$$v)},expression:"vmDetailsObj.meterDescription"}})],1)],1)])])],1)},VMDetailsFormvue_type_template_id_72895ebc_staticRenderFns=[],VMDetailsFormvue_type_script_lang_js={components:{},props:["isNew","vmInfo"],data:function(){return{vmDetailsObj:{meterName:"",meterDescription:""},validationRules:{meterName:[{required:!0,message:"Please enter meter name",trigger:"blur"}]}}},created:function(){this.vmDetailsObj=this.vmInfo},watch:{vmDetailsObj:{handler:function(newVal){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:(0,utils_validation/* isEmpty */.xb)(newVal)||_this.$emit("updateVmDetails",newVal);case 1:case"end":return _context.stop()}}),_callee)})))()},deep:!0}},methods:{validate:function(){var _this2=this;return new Promise((function(resolve){_this2.$refs["vm-details-form"].validate((function(valid){resolve(!!valid)}))}))}}},vmTemplate_VMDetailsFormvue_type_script_lang_js=VMDetailsFormvue_type_script_lang_js,VMDetailsForm_component=(0,componentNormalizer/* default */.Z)(vmTemplate_VMDetailsFormvue_type_script_lang_js,VMDetailsFormvue_type_template_id_72895ebc_render,VMDetailsFormvue_type_template_id_72895ebc_staticRenderFns,!1,null,null,null)
/* harmony default export */,VMDetailsForm=VMDetailsForm_component.exports,SidebarScrollMixin=__webpack_require__(565476),router=__webpack_require__(329435),microEmbed=__webpack_require__(273256),NewVMTemplatevue_type_script_lang_js={components:{AsyncButton:AsyncButton/* default */.Z,VMTemplate:VMTemplate,ReadingDetailsForm:ReadingDetailsForm,VMDetailsForm:VMDetailsForm},mounted:function(){this.$nextTick(this.registerScrollHandler)},mixins:[SidebarScrollMixin/* default */.Z],created:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var isEditForm;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(isEditForm=_this.isEditForm,!isEditForm){_context.next=5;break}return _context.next=4,_this.prefillVMTemplate();case 4:_this.isNew=!1;case 5:case"end":return _context.stop()}}),_callee)})))()},data:function(){return{moduleName:"virtualMeterTemplate",isLoading:!1,virtualMeter:cloneDeep_default()(vmDataModel),rootElementForScroll:".scroll-container",sidebarElements:["#vmtemplate-link","#meterDetails-link","#readingDetails-link"],sectionElements:["#vmtemplate-section","#meterDetails-section","#readingDetails-section"],isNew:!0}},computed:{title:function(){var isNew=this.isNew;return isNew?this.$t("asset.virtual_meters.new_virtual_meter_template"):this.$t("asset.virtual_meters.edit_virtual_meter_template")},isEditForm:function(){return this.$getProperty(this,"$route.params.id",!1)}},methods:{save:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var virtualMeter,moduleName,isEditForm,_ref,readings,isTemplateValid,isMeterDetailsValid,isReadingsValid,promise,_ref2,id,_ref3,virtualMeterTemplate,error,_ref4,_id;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return virtualMeter=_this2.virtualMeter,moduleName=_this2.moduleName,isEditForm=_this2.isEditForm,virtualMeter=serializeVM(virtualMeter),_ref=virtualMeter||{},readings=_ref.readings,_context2.next=5,_this2.$refs["vmtemplate-section"].validate();case 5:return isTemplateValid=_context2.sent,_context2.next=8,_this2.$refs["meterDetails-section"].validate();case 8:return isMeterDetailsValid=_context2.sent,_context2.next=11,_this2.$refs["readingDetails-section"].validateVMReadings(readings);case 11:if(isReadingsValid=_context2.sent,!(isTemplateValid&&isMeterDetailsValid&&isReadingsValid)){_context2.next=25;break}if(_ref2=virtualMeter||{},id=_ref2.id,isEditForm){_context2.next=20;break}return _context2.next=17,api/* API */.bl.createRecord(moduleName,{data:virtualMeter});case 17:promise=_context2.sent,_context2.next=23;break;case 20:return _context2.next=22,api/* API */.bl.updateRecord(moduleName,{data:virtualMeter,id:id});case 22:promise=_context2.sent;case 23:_ref3=promise||{},virtualMeterTemplate=_ref3.virtualMeterTemplate,error=_ref3.error,(0,utils_validation/* isEmpty */.xb)(error)?isEditForm?microEmbed/* facilioMicro */.O.emit("saveVMTemplate",{type:"updat",id:id}):(_ref4=virtualMeterTemplate||{},_id=_ref4.id,microEmbed/* facilioMicro */.O.emit("saveVMTemplate",{type:"creat",id:_id})):microEmbed/* facilioMicro */.O.emit("saveVMTemplate",{type:"error",message:(null===error||void 0===error?void 0:error.message)||"Error Occured"});case 25:case"end":return _context2.stop()}}),_callee2)})))()},back:function(){microEmbed/* facilioMicro */.O.emit("cancel")},redirectToList:function(){var moduleName=this.moduleName;if((0,router/* isWebTabsEnabled */.tj)()){var _ref5=(0,router/* findRouteForModule */.Jp)(moduleName,router/* pageTypes */.As.LIST)||{},name=_ref5.name;name&&this.$router.push({name:name})}else this.$router.push({name:"VirtualMeterTemplateList"})},redirectToSummary:function(id){var moduleName=this.moduleName;if((0,router/* isWebTabsEnabled */.tj)()){var _ref6=(0,router/* findRouteForModule */.Jp)(moduleName,router/* pageTypes */.As.OVERVIEW)||{},name=_ref6.name;name&&this.$router.push({name:name,params:{id:id,viewname:"all"}})}else this.$router.push({name:"VirtualMeterTemplateSummary",params:{id:id,viewname:"all"}})},updateVirtualMeter:function(value){var virtualMeter=this.virtualMeter;this.virtualMeter=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},virtualMeter),value)},prefillVMTemplate:function(){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var id;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return _this3.isLoading=!0,id=_this3.$getProperty(_this3,"$route.params.id"),_context3.next=4,_this3.loadSummary(id);case 4:_this3.$nextTick((function(){_this3.isLoading=!1}));case 5:case"end":return _context3.stop()}}),_callee3)})))()},loadSummary:function(id){var _arguments=arguments,_this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){var force,moduleName,_yield$API$fetchRecor,virtualMeterTemplate,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:return force=!(_arguments.length>1&&void 0!==_arguments[1])||_arguments[1],moduleName=_this4.moduleName,_context4.next=4,api/* API */.bl.fetchRecord(moduleName,{id:id},{force:force});case 4:_yield$API$fetchRecor=_context4.sent,virtualMeterTemplate=_yield$API$fetchRecor.virtualMeterTemplate,error=_yield$API$fetchRecor.error,error?_this4.$message.error(error.message||"Error Occured"):_this4.virtualMeter=deserializeVM(virtualMeterTemplate);case 8:case"end":return _context4.stop()}}),_callee4)})))()}}},vmTemplate_NewVMTemplatevue_type_script_lang_js=NewVMTemplatevue_type_script_lang_js,NewVMTemplate_component=(0,componentNormalizer/* default */.Z)(vmTemplate_NewVMTemplatevue_type_script_lang_js,render,staticRenderFns,!1,null,"1e5627d5",null)
/* harmony default export */,NewVMTemplate=NewVMTemplate_component.exports;
// EXTERNAL MODULE: ./node_modules/lodash/debounce.js
},
/***/953204:
/***/function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,_toPropertyKey(descriptor.key),descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}function _toPrimitive(input,hint){if("object"!==typeof input||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==typeof res)return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return"symbol"===typeof key?key:String(key)}
/* harmony export */__webpack_require__.d(__webpack_exports__,{
/* harmony export */Z:function(){/* binding */return FacilioMicro}
/* harmony export */});var pendingPromises={},ids={},FacilioMicro=function(){function FacilioMicro(options){var _this=this;_classCallCheck(this,FacilioMicro),this._source=window.parent,this._name=options.name,this.version=options.version,this._context=null,this._account=null,this._messageHandlers={},this._dsmModalStack=[],this.ready=!1,this.on("loaded",(function(data){_this.ready=!0,_this._context=data.context,_this._account=data.account}),this),window.addEventListener("message",messageHandler.bind(null,this)),this._postMessage("handshake",{version:this.version}),document.addEventListener("dsm.modal.open",(function(event){var _ref=event||{},detail=_ref.detail,_ref2=detail||{},modalId=_ref2.modalId;0===_this._dsmModalStack.length?(
//apply overlay, since stack size is zero
_this._dsmModalStack.push(modalId),_this.execute("setWindowOverlay")):_this._dsmModalStack.push(modalId)})),document.addEventListener("dsm.modal.close",(function(event){var _ref3=event||{},detail=_ref3.detail,_ref4=detail||{},modalId=_ref4.modalId;_this._dsmModalStack=_this._dsmModalStack.filter((function(id){return id!=modalId})),0===_this._dsmModalStack.length&&
//close overlay
_this.execute("hideWindowOverlay")}))}return _createClass(FacilioMicro,[{key:"on",value:function(name,handler,context){"function"===typeof handler&&(handler=context?handler.bind(context):handler,this._messageHandlers[name]=this._messageHandlers[name]||[],this._messageHandlers[name].push(handler))}},{key:"off",value:function(name,handler){if(!this._messageHandlers[name])return!1;var index=this._messageHandlers[name].indexOf(handler);return this.has(name,handler)&&this._messageHandlers[name].splice(index,1),handler}},{key:"has",value:function(name,handler){return!!this._messageHandlers[name]&&-1!==this._messageHandlers[name].indexOf(handler)}},{key:"execute",value:function(namespace,options){return this._postMessageWithPromise(namespace,options)}},{key:"emit",value:function(namespace,options){return this._postMessage(namespace,options)}},{key:"getContext",value:function(){return this._context}},{key:"getAccount",value:function(){return this._account}},{key:"_nextIdFor",value:function(name){return isNaN(ids[name])&&(ids[name]=0),++ids[name]}},{key:"_postMessageWithPromise",value:function(key,params){var _this2=this,id=this._nextIdFor("promise"),promise=new Promise((function(resolve,reject){
// promiseStartTime = window.performance.now();
pendingPromises[id]={resolve:resolve,reject:reject};var msg=JSON.stringify({id:id,key:key,params:params,name:_this2._name});_this2._source.postMessage(msg,"*")}));return promise}},{key:"_postMessage",value:function(key,params){var msg=JSON.stringify({key:key,params:params,name:this._name});this._source.postMessage(msg,"*")}}]),FacilioMicro}();function triggerEvent(client,eventName,data){if(!client._messageHandlers[eventName])return!1;client._messageHandlers[eventName].forEach((function(handler){handler(data)}))}function finalizePendingPromise(pendingPromise,data){if(data.error){var error="object"===_typeof(data.error)?new Error(data.error.message):new Error(data.error);pendingPromise.reject(error)}else pendingPromise.resolve(data.result);delete pendingPromises[data.id]}function messageHandler(client,event){var data=event.data;if(data){if("string"===typeof data)try{data=JSON.parse(event.data)}catch(e){return e}var pendingPromise,_ref5=data||{},id=_ref5.id,dataKey=_ref5.key,message=_ref5.message,_ref6=client||{},clientName=_ref6._name;if(id&&(pendingPromise=pendingPromises[id]))finalizePendingPromise(pendingPromise,data);else if(dataKey&&clientName&&(dataKey||"").includes(clientName)){var key=dataKey.replace("".concat(clientName,"."),"");triggerEvent(client,key,message)}}}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXgubWpzIiwic291cmNlcyI6WyJzcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgcGVuZGluZ1Byb21pc2VzID0ge31cbmNvbnN0IGlkcyA9IHt9XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZhY2lsaW9NaWNybyB7XG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICB0aGlzLl9zb3VyY2UgPSB3aW5kb3cucGFyZW50XG4gICAgdGhpcy5fbmFtZSA9IG9wdGlvbnMubmFtZVxuICAgIHRoaXMudmVyc2lvbiA9IG9wdGlvbnMudmVyc2lvblxuICAgIHRoaXMuX2NvbnRleHQgPSBudWxsXG4gICAgdGhpcy5fYWNjb3VudCA9IG51bGxcbiAgICB0aGlzLl9tZXNzYWdlSGFuZGxlcnMgPSB7fVxuICAgIHRoaXMuX2RzbU1vZGFsU3RhY2sgPSBbXVxuICAgIHRoaXMucmVhZHkgPSBmYWxzZVxuXG4gICAgdGhpcy5vbihcbiAgICAgICdsb2FkZWQnLFxuICAgICAgKGRhdGEpID0+IHtcbiAgICAgICAgdGhpcy5yZWFkeSA9IHRydWVcbiAgICAgICAgdGhpcy5fY29udGV4dCA9IGRhdGEuY29udGV4dFxuICAgICAgICB0aGlzLl9hY2NvdW50ID0gZGF0YS5hY2NvdW50XG4gICAgICB9LFxuICAgICAgdGhpc1xuICAgIClcblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgbWVzc2FnZUhhbmRsZXIuYmluZChudWxsLCB0aGlzKSlcbiAgICB0aGlzLl9wb3N0TWVzc2FnZSgnaGFuZHNoYWtlJywgeyB2ZXJzaW9uOiB0aGlzLnZlcnNpb24gfSlcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdkc20ubW9kYWwub3BlbicsIChldmVudCkgPT4ge1xuICAgICAgbGV0IHsgZGV0YWlsIH0gPSBldmVudCB8fCB7fVxuICAgICAgbGV0IHsgbW9kYWxJZCB9ID0gZGV0YWlsIHx8IHt9XG4gICAgICBpZiAodGhpcy5fZHNtTW9kYWxTdGFjay5sZW5ndGggPT09IDApIHtcbiAgICAgICAgLy9hcHBseSBvdmVybGF5LCBzaW5jZSBzdGFjayBzaXplIGlzIHplcm9cbiAgICAgICAgdGhpcy5fZHNtTW9kYWxTdGFjay5wdXNoKG1vZGFsSWQpXG4gICAgICAgIHRoaXMuZXhlY3V0ZSgnc2V0V2luZG93T3ZlcmxheScpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLl9kc21Nb2RhbFN0YWNrLnB1c2gobW9kYWxJZClcbiAgICAgIH1cbiAgICB9KVxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2RzbS5tb2RhbC5jbG9zZScsIChldmVudCkgPT4ge1xuICAgICAgbGV0IHsgZGV0YWlsIH0gPSBldmVudCB8fCB7fVxuICAgICAgbGV0IHsgbW9kYWxJZCB9ID0gZGV0YWlsIHx8IHt9XG4gICAgICB0aGlzLl9kc21Nb2RhbFN0YWNrID0gdGhpcy5fZHNtTW9kYWxTdGFjay5maWx0ZXIoKGlkKSA9PiBpZCAhPSBtb2RhbElkKVxuICAgICAgaWYgKHRoaXMuX2RzbU1vZGFsU3RhY2subGVuZ3RoID09PSAwKSB7XG4gICAgICAgIC8vY2xvc2Ugb3ZlcmxheVxuICAgICAgICB0aGlzLmV4ZWN1dGUoJ2hpZGVXaW5kb3dPdmVybGF5JylcbiAgICAgIH1cbiAgICB9KVxuICB9XG5cbiAgb24obmFtZSwgaGFuZGxlciwgY29udGV4dCkge1xuICAgIGlmICh0eXBlb2YgaGFuZGxlciA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgaGFuZGxlciA9IGNvbnRleHQgPyBoYW5kbGVyLmJpbmQoY29udGV4dCkgOiBoYW5kbGVyXG5cbiAgICAgIHRoaXMuX21lc3NhZ2VIYW5kbGVyc1tuYW1lXSA9IHRoaXMuX21lc3NhZ2VIYW5kbGVyc1tuYW1lXSB8fCBbXVxuICAgICAgdGhpcy5fbWVzc2FnZUhhbmRsZXJzW25hbWVdLnB1c2goaGFuZGxlcilcbiAgICB9XG4gIH1cblxuICBvZmYobmFtZSwgaGFuZGxlcikge1xuICAgIGlmICghdGhpcy5fbWVzc2FnZUhhbmRsZXJzW25hbWVdKSB7XG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG4gICAgY29uc3QgaW5kZXggPSB0aGlzLl9tZXNzYWdlSGFuZGxlcnNbbmFtZV0uaW5kZXhPZihoYW5kbGVyKVxuICAgIGlmICh0aGlzLmhhcyhuYW1lLCBoYW5kbGVyKSkge1xuICAgICAgdGhpcy5fbWVzc2FnZUhhbmRsZXJzW25hbWVdLnNwbGljZShpbmRleCwgMSlcbiAgICB9XG4gICAgcmV0dXJuIGhhbmRsZXJcbiAgfVxuXG4gIGhhcyhuYW1lLCBoYW5kbGVyKSB7XG4gICAgaWYgKCF0aGlzLl9tZXNzYWdlSGFuZGxlcnNbbmFtZV0pIHtcbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cbiAgICByZXR1cm4gdGhpcy5fbWVzc2FnZUhhbmRsZXJzW25hbWVdLmluZGV4T2YoaGFuZGxlcikgIT09IC0xXG4gIH1cblxuICBleGVjdXRlKG5hbWVzcGFjZSwgb3B0aW9ucykge1xuICAgIHJldHVybiB0aGlzLl9wb3N0TWVzc2FnZVdpdGhQcm9taXNlKG5hbWVzcGFjZSwgb3B0aW9ucylcbiAgfVxuXG4gIGVtaXQobmFtZXNwYWNlLCBvcHRpb25zKSB7XG4gICAgcmV0dXJuIHRoaXMuX3Bvc3RNZXNzYWdlKG5hbWVzcGFjZSwgb3B0aW9ucylcbiAgfVxuXG4gIGdldENvbnRleHQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2NvbnRleHRcbiAgfVxuXG4gIGdldEFjY291bnQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2FjY291bnRcbiAgfVxuXG4gIF9uZXh0SWRGb3IobmFtZSkge1xuICAgIGlmIChpc05hTihpZHNbbmFtZV0pKSB7XG4gICAgICBpZHNbbmFtZV0gPSAwXG4gICAgfVxuICAgIHJldHVybiArK2lkc1tuYW1lXVxuICB9XG5cbiAgX3Bvc3RNZXNzYWdlV2l0aFByb21pc2Uoa2V5LCBwYXJhbXMpIHtcbiAgICBjb25zdCBpZCA9IHRoaXMuX25leHRJZEZvcigncHJvbWlzZScpXG4gICAgLy8gbGV0IHRpbWVvdXRJZCwgcHJvbWlzZVN0YXJ0VGltZTtcbiAgICAvLyBjb25zdCBjbGllbnQgPSB0aGlzO1xuXG4gICAgY29uc3QgcHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIC8vIHByb21pc2VTdGFydFRpbWUgPSB3aW5kb3cucGVyZm9ybWFuY2Uubm93KCk7XG5cbiAgICAgIHBlbmRpbmdQcm9taXNlc1tpZF0gPSB7IHJlc29sdmUsIHJlamVjdCB9XG5cbiAgICAgIGNvbnN0IG1zZyA9IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgaWQ6IGlkLFxuICAgICAgICBrZXk6IGtleSxcbiAgICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICAgIG5hbWU6IHRoaXMuX25hbWUsXG4gICAgICB9KVxuICAgICAgdGhpcy5fc291cmNlLnBvc3RNZXNzYWdlKG1zZywgJyonKVxuICAgIH0pXG4gICAgcmV0dXJuIHByb21pc2VcbiAgfVxuXG4gIF9wb3N0TWVzc2FnZShrZXksIHBhcmFtcykge1xuICAgIGNvbnN0IG1zZyA9IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgIGtleToga2V5LFxuICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICBuYW1lOiB0aGlzLl9uYW1lLFxuICAgIH0pXG4gICAgdGhpcy5fc291cmNlLnBvc3RNZXNzYWdlKG1zZywgJyonKVxuICB9XG59XG5cbmZ1bmN0aW9uIHRyaWdnZXJFdmVudChjbGllbnQsIGV2ZW50TmFtZSwgZGF0YSkge1xuICBpZiAoIWNsaWVudC5fbWVzc2FnZUhhbmRsZXJzW2V2ZW50TmFtZV0pIHtcbiAgICByZXR1cm4gZmFsc2VcbiAgfVxuICBjbGllbnQuX21lc3NhZ2VIYW5kbGVyc1tldmVudE5hbWVdLmZvckVhY2goKGhhbmRsZXIpID0+IHtcbiAgICBoYW5kbGVyKGRhdGEpXG4gIH0pXG59XG5cbmZ1bmN0aW9uIGZpbmFsaXplUGVuZGluZ1Byb21pc2UocGVuZGluZ1Byb21pc2UsIGRhdGEpIHtcbiAgaWYgKGRhdGEuZXJyb3IpIHtcbiAgICBjb25zdCBlcnJvciA9XG4gICAgICB0eXBlb2YgZGF0YS5lcnJvciA9PT0gJ29iamVjdCdcbiAgICAgICAgPyBuZXcgRXJyb3IoZGF0YS5lcnJvci5tZXNzYWdlKVxuICAgICAgICA6IG5ldyBFcnJvcihkYXRhLmVycm9yKVxuICAgIHBlbmRpbmdQcm9taXNlLnJlamVjdChlcnJvcilcbiAgfSBlbHNlIHtcbiAgICBwZW5kaW5nUHJvbWlzZS5yZXNvbHZlKGRhdGEucmVzdWx0KVxuICB9XG5cbiAgZGVsZXRlIHBlbmRpbmdQcm9taXNlc1tkYXRhLmlkXVxufVxuXG5mdW5jdGlvbiBtZXNzYWdlSGFuZGxlcihjbGllbnQsIGV2ZW50KSB7XG4gIGxldCBkYXRhID0gZXZlbnQuZGF0YVxuXG4gIGlmICghZGF0YSkge1xuICAgIHJldHVyblxuICB9XG5cbiAgaWYgKHR5cGVvZiBkYXRhID09PSAnc3RyaW5nJykge1xuICAgIHRyeSB7XG4gICAgICBkYXRhID0gSlNPTi5wYXJzZShldmVudC5kYXRhKVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHJldHVybiBlXG4gICAgfVxuICB9XG5cbiAgbGV0IHBlbmRpbmdQcm9taXNlXG4gIGxldCB7IGlkLCBrZXk6IGRhdGFLZXksIG1lc3NhZ2UgfSA9IGRhdGEgfHwge31cbiAgbGV0IHsgX25hbWU6IGNsaWVudE5hbWUgfSA9IGNsaWVudCB8fCB7fVxuXG4gIGlmIChpZCAmJiAocGVuZGluZ1Byb21pc2UgPSBwZW5kaW5nUHJvbWlzZXNbaWRdKSkge1xuICAgIGZpbmFsaXplUGVuZGluZ1Byb21pc2UocGVuZGluZ1Byb21pc2UsIGRhdGEpXG4gIH0gZWxzZSBpZiAoZGF0YUtleSAmJiBjbGllbnROYW1lICYmIChkYXRhS2V5IHx8ICcnKS5pbmNsdWRlcyhjbGllbnROYW1lKSkge1xuICAgIGNvbnN0IGtleSA9IGRhdGFLZXkucmVwbGFjZShgJHtjbGllbnROYW1lfS5gLCAnJylcblxuICAgIHRyaWdnZXJFdmVudChjbGllbnQsIGtleSwgbWVzc2FnZSlcbiAgfVxufVxuIl0sIm5hbWVzIjpbInBlbmRpbmdQcm9taXNlcyIsImlkcyIsIkZhY2lsaW9NaWNybyIsIm9wdGlvbnMiLCJfdGhpcyIsIl9jbGFzc0NhbGxDaGVjayIsIl9zb3VyY2UiLCJ3aW5kb3ciLCJwYXJlbnQiLCJfbmFtZSIsIm5hbWUiLCJ2ZXJzaW9uIiwiX2NvbnRleHQiLCJfYWNjb3VudCIsIl9tZXNzYWdlSGFuZGxlcnMiLCJfZHNtTW9kYWxTdGFjayIsInJlYWR5Iiwib24iLCJkYXRhIiwiY29udGV4dCIsImFjY291bnQiLCJhZGRFdmVudExpc3RlbmVyIiwibWVzc2FnZUhhbmRsZXIiLCJiaW5kIiwiX3Bvc3RNZXNzYWdlIiwiZG9jdW1lbnQiLCJldmVudCIsIl9yZWYiLCJkZXRhaWwiLCJfcmVmMiIsIm1vZGFsSWQiLCJsZW5ndGgiLCJwdXNoIiwiZXhlY3V0ZSIsIl9yZWYzIiwiX3JlZjQiLCJmaWx0ZXIiLCJpZCIsIl9jcmVhdGVDbGFzcyIsImtleSIsInZhbHVlIiwiaGFuZGxlciIsIm9mZiIsImluZGV4IiwiaW5kZXhPZiIsImhhcyIsInNwbGljZSIsIm5hbWVzcGFjZSIsIl9wb3N0TWVzc2FnZVdpdGhQcm9taXNlIiwiZW1pdCIsImdldENvbnRleHQiLCJnZXRBY2NvdW50IiwiX25leHRJZEZvciIsImlzTmFOIiwicGFyYW1zIiwiX3RoaXMyIiwicHJvbWlzZSIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwibXNnIiwiSlNPTiIsInN0cmluZ2lmeSIsInBvc3RNZXNzYWdlIiwidHJpZ2dlckV2ZW50IiwiY2xpZW50IiwiZXZlbnROYW1lIiwiZm9yRWFjaCIsImZpbmFsaXplUGVuZGluZ1Byb21pc2UiLCJwZW5kaW5nUHJvbWlzZSIsImVycm9yIiwiX3R5cGVvZiIsIkVycm9yIiwibWVzc2FnZSIsInJlc3VsdCIsInBhcnNlIiwiZSIsIl9yZWY1IiwiZGF0YUtleSIsIl9yZWY2IiwiY2xpZW50TmFtZSIsImluY2x1ZGVzIiwicmVwbGFjZSIs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
/***/},
/***/204147:
/***/function(module){module.exports={i8:"0.1.1"};
/***/}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/39386.js.map