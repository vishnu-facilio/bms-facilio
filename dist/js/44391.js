(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[44391],{
/***/289612:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return CanvasPanZoomMixin}});
// EXTERNAL MODULE: ./node_modules/core-js/modules/es.object.to-string.js
__webpack_require__(260228),__webpack_require__(947522);
// EXTERNAL MODULE: ./node_modules/core-js/modules/web.dom-collections.for-each.js
var render,staticRenderFns,validation=__webpack_require__(990260),fabric=__webpack_require__(232777),rafThrottle=__webpack_require__(474737),rafThrottle_default=__webpack_require__.n(rafThrottle),CanvasPanZoomMixinvue_type_script_lang_js={data:function(){return{currentZoomLevel:1,isCanvasPanning:!1,allowedCanvasPanSize:1800}},created:function(){this.lastPosX=null,this.lastPosY=null},computed:{formattedZoomLevel:function(){return Math.round(100*this.currentZoomLevel)}},methods:{setDimensions:function(refElement){var container=this.$refs[refElement];(0,validation/* isEmpty */.xb)(container)||(this.canvas.setHeight(container.offsetHeight),this.canvas.setWidth(container.offsetWidth),this.canvas.renderAll())},setInitialZoom:function(){var zoom=(0,validation/* isEmpty */.xb)(this.diagramJson&&this.diagramJson.zoom)?.75:this.diagramJson.zoom;this.canvas.setZoom(zoom),this.currentZoomLevel=zoom},adjustZoom:function(){var _this=this,zoomIn=arguments.length>0&&void 0!==arguments[0]&&arguments[0],delta=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.125,zoom=this.canvas.getZoom();zoomIn?zoom+=delta:zoom-=delta,zoom>1.75&&(zoom=1.75),zoom<.5&&(zoom=.5),this.canvas.setZoom(zoom),this.currentZoomLevel=zoom,this.$nextTick((function(){return _this.autoSave()}))},fitToScreen:function(){var delta=0,edgeBuffer=100,canvas=this.canvas,zoom=canvas.getZoom(),canvasH=canvas.getHeight()-edgeBuffer,canvasW=canvas.getWidth()-edgeBuffer,objs=canvas.getObjects(),g=new fabric.fabric.Group(objs),_g$getBoundingRect=g.getBoundingRect(),width=_g$getBoundingRect.width,height=_g$getBoundingRect.height;g.ungroupOnCanvas(),width*=zoom,height*=zoom;var shouldScaleDown=width>canvasW||height>canvasH,shouldScaleUp=width<canvasW&&height<canvasH;if(shouldScaleDown||shouldScaleUp){var Wx=canvasW/width,Hx=canvasH/height;delta=Wx<Hx?Wx:Hx,zoom>1.75&&(zoom=1.75),zoom<.5&&(zoom=.5),canvas.setZoom(zoom*delta),this.currentZoomLevel=zoom*delta}},onCanvasPanStart:function(_ref){var e=_ref.e;this.isCanvasPanning=!0,this.lastPosX=e.clientX,this.lastPosY=e.clientY,this.canvas.defaultCursor="grabbing",this.canvas.renderAll()},onCanvasPan:rafThrottle_default()((function(_ref2){var e=_ref2.e;
// https://stackoverflow.com/a/52504899
if(this.isCanvasPanning){var canvas=this.canvas,xOffset=e.clientX-this.lastPosX,yOffset=e.clientY-this.lastPosY,xDiffWidth=this.allowedCanvasPanSize-canvas.getWidth(),yDiffHeight=this.allowedCanvasPanSize-canvas.getHeight(),transformArray=canvas.viewportTransform,isXWithinBounds=transformArray[4]+xOffset>=-xDiffWidth&&transformArray[4]+xOffset<=0,isYWithinBounds=transformArray[5]+yOffset>=-yDiffHeight&&transformArray[5]+yOffset<=0;isXWithinBounds?(transformArray[4]+=xOffset,this.lastPosX=e.clientX,canvas.requestRenderAll()):transformArray[4]+xOffset>=-xDiffWidth&&(transformArray[4]=0,this.lastPosX=e.clientX,canvas.requestRenderAll()),isYWithinBounds?(transformArray[5]+=yOffset,this.lastPosY=e.clientY,canvas.requestRenderAll()):transformArray[5]+yOffset>=-yDiffHeight&&(transformArray[5]=0,this.lastPosY=e.clientY,canvas.requestRenderAll())}})),onCanvasPanEnd:function(){var _this2=this;this.isCanvasPanning=!1,this.canvas.getObjects().forEach((function(obj){return obj.setCoords()})),this.canvas.defaultCursor="grab",this.$nextTick((function(){return _this2.canvas.renderAll()}))}}},mixins_CanvasPanZoomMixinvue_type_script_lang_js=CanvasPanZoomMixinvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(mixins_CanvasPanZoomMixinvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,CanvasPanZoomMixin=component.exports},
/***/22716:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return WorkFlowBuilder}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/workflowbuilder/WorkFlowBuilder.vue?vue&type=template&id=04d01df0
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"stateflow-container mT10"},[_c("div",{staticClass:"pL10"},[_vm._v("Workflow builder")]),_c("div",{ref:"workFlowBuilderContainer",staticClass:"builder-container"},[_c("div",{staticClass:"workflow-sidebar"},[_c("WorkFlowSidebar",{attrs:{selectedBlockType:_vm.selectedBlockType,isNewWorkFlowBlockDragged:_vm.isNewWorkFlowBlockDragged},on:{"update:selectedBlockType":function($event){_vm.selectedBlockType=$event},"update:selected-block-type":function($event){_vm.selectedBlockType=$event},"update:isNewWorkFlowBlockDragged":function($event){_vm.isNewWorkFlowBlockDragged=$event},"update:is-new-work-flow-block-dragged":function($event){_vm.isNewWorkFlowBlockDragged=$event}}})],1),_c("canvas",{ref:"workflowCanvas",attrs:{id:"workflow-canvas"}})])])},staticRenderFns=[],objectSpread2=__webpack_require__(595082),fabric=(__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(232777)),validation=__webpack_require__(586529),throttle=__webpack_require__(823493),throttle_default=__webpack_require__.n(throttle),slicedToArray=__webpack_require__(554621),commonObjProps=(__webpack_require__(689730),__webpack_require__(634338),{hasRotatingPoint:!1,lockRotation:!0,hasControls:!1,hasBorders:!1,lockScalingX:!0,lockScalingY:!0,lockMovementX:!0,lockMovementY:!0,perPixelTargetFind:!0,excludeFromExport:!0}),colors={workflowBlock:{bg:{default:"#fff",active:"#FF6660"},text:{default:"#324056",active:"#324056"},stroke:{default:"#cad2d6"}},line:{default:"#3995e2",active:"#FF6660"},stroke:{default:"#000"}},Common=__webpack_require__(144945),utils_Math=__webpack_require__(308530),trimmedName=function(name){return name.length>18?name.slice(0,15)+"...":name},actionSvg=__webpack_require__(635451),eventSvg=__webpack_require__(195041),conditionSvg=__webpack_require__(582598),blockHash={event:{svg:eventSvg},action:{svg:actionSvg},condition:{svg:conditionSvg}},makeWorkFlowBlock=function(selectedBlock,canvas,coords){var blockSvg,label=selectedBlock.label,type=selectedBlock.type,textColor=colors.workflowBlock.text.default,bgColor=colors.workflowBlock.bg.default,strokeColor=colors.workflowBlock.stroke.default,rectWidth=170,rectHeight=70,selectedBlockSvg=blockHash[type].svg,rect=new fabric.fabric.Rect((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},commonObjProps),{},{objType:"rect",originX:"center",originY:"center",width:rectWidth,height:rectHeight,rx:3,ry:3,strokeWidth:1,fill:bgColor,hoverCursor:"move",stroke:strokeColor}));fabric.fabric.loadSVGFromString(selectedBlockSvg,(function(objects,options){var groupedObject=fabric.fabric.util.groupSVGElements(objects,options);groupedObject.set((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},commonObjProps),{},{originX:"center",originY:"center",left:-85})),blockSvg=groupedObject}));var textDesEl=new fabric.fabric.Text(trimmedName(label),(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},commonObjProps),{},{objType:"textEl",originX:"center",left:-30,top:-10,fontFamily:'"Aktiv-Grotesk", Helvetica, Arial, sans-serif',fill:textColor,fontSize:"14"})),group=new fabric.fabric.Group([rect,blockSvg,textDesEl],(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},commonObjProps),{},{workFlowType:type,connectorsArr:[],objType:"workFlowBlock",originX:"center",originY:"center",left:coords?coords.x:100,top:coords?coords.y:100,excludeFromExport:!1,subTargetCheck:!0,cellSize:10}));return group},makeWorkFlowConnectors=function(props){var arrowStartEndCoords=props.arrowStartEndCoords,cursorDirection=props.cursorDirection,id=props.id,arrowPointerDirection="right"===cursorDirection?"left":cursorDirection,_arrowStartEndCoords=(0,slicedToArray/* default */.Z)(arrowStartEndCoords,2),startPos=_arrowStartEndCoords[0],endPos=_arrowStartEndCoords[1],_getLineMidPoint=(0,utils_Math/* getLineMidPoint */.eN)(startPos,endPos),_getLineMidPoint2=(0,slicedToArray/* default */.Z)(_getLineMidPoint,1),lineCenterCoords=_getLineMidPoint2[0],linePath=arrowStartEndCoords.reduce((function(acc,c){return acc+=" ".concat(c.x," ").concat(c.y),acc}),"M"),line=new fabric.fabric.Path(linePath,(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},commonObjProps),{},{objType:"line",fill:"",stroke:"#808080",objectCaching:!1})),circle=new fabric.fabric.Circle((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},commonObjProps),{},{originX:"center",originY:"center",top:lineCenterCoords.y,left:lineCenterCoords.x,radius:5.5,fill:"#fff",stroke:"#808080",objectCaching:!1})),arrowCoords=(0,Common/* getArrowCoords */._W)(endPos,arrowPointerDirection),arrowPath=arrowCoords.reduce((function(acc,c){return acc+=" ".concat(c.x," ").concat(c.y),acc}),"M"),arrow=new fabric.fabric.Path("".concat(arrowPath," Z"),(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},commonObjProps),{},{objType:"arrow",fill:"#808080",stroke:"#808080",objectCaching:!1,hoverCursor:"pointer"})),group=new fabric.fabric.Group([line,arrow,circle],(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},commonObjProps),{},{id:id,originX:"center",originY:"center"}));return group},WorkFlowSidebarvue_type_template_id_4cff32b5_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"workflow-tool"},_vm._l(_vm.availableTypes,(function(type,index){return _c("div",{key:index,staticClass:"workflow-block"},[_c("div",{staticClass:"self-center",attrs:{draggable:"true"},on:{dragstart:function($event){return _vm.setDraggedType(type)}}},[_c("InlineSvg",{attrs:{src:"svgs/workflowbuilder/"+type.svgName,iconClass:"icon icon-40"}})],1),_c("div",{staticClass:"self-center"},[_vm._v(_vm._s(type.label))])])})),0)},WorkFlowSidebarvue_type_template_id_4cff32b5_staticRenderFns=[],WorkFlowSidebarvue_type_script_lang_js={props:["selectedBlockType","isNewWorkFlowBlockDragged"],data:function(){return{availableTypes:[{label:"Event",type:"event",svgName:"event"},{label:"Condition",type:"condition",svgName:"condition"},{label:"Action",type:"action",svgName:"action"}]}},methods:{setDraggedType:function(type){this.$emit("update:selectedBlockType",type),this.$emit("update:isNewWorkFlowBlockDragged",!0)}}},components_WorkFlowSidebarvue_type_script_lang_js=WorkFlowSidebarvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_WorkFlowSidebarvue_type_script_lang_js,WorkFlowSidebarvue_type_template_id_4cff32b5_render,WorkFlowSidebarvue_type_template_id_4cff32b5_staticRenderFns,!1,null,null,null)
/* harmony default export */,WorkFlowSidebar=component.exports,CanvasPanZoomMixin=__webpack_require__(289612),utils_Common=__webpack_require__(126577),cursorDirectionMap={bottom:"bottom",right:"right"},threshold=200,WorkFlowBuildervue_type_script_lang_js={mixins:[CanvasPanZoomMixin/* default */.Z],components:{WorkFlowSidebar:WorkFlowSidebar},data:function(){return{selectedBlockType:null,isNewWorkFlowBlockDragged:null,pseudoConnectorProps:null}},created:function(){this.initData()},methods:{initData:function(){this.initCanvas()},initCanvas:function(){var _this=this;this.$nextTick((function(){var $refs=_this.$refs;(0,validation/* isEmpty */.xb)($refs)||(_this.canvas=new fabric.fabric.Canvas(_this.$refs["workflowCanvas"],{selection:!1,defaultCursor:"grab"}),_this.$nextTick((function(){_this.setupEditor(),_this.$nextTick((function(){_this.registerNativeEvents()}))})))}))},setupEditor:function(){this.setDimensions("workFlowBuilderContainer"),this.registerEvents()},registerEvents:function(){var _this2=this,canvas=this.canvas;canvas.on("mouse:move",(function(event){var target=event.target;(0,validation/* isEmpty */.xb)(target)&&_this2.isCanvasPanning&&_this2.onCanvasPan(event)})),canvas.on("dragover",(function(event){var isNewWorkFlowBlockDragged=_this2.isNewWorkFlowBlockDragged;isNewWorkFlowBlockDragged&&_this2.findClosestWorkFlowBlow(event)})),canvas.on("mouse:down",(function(event){(0,validation/* isEmpty */.xb)(event.target)&&_this2.onCanvasPanStart(event)})),canvas.on("mouse:up",(function(event){_this2.onCanvasPanEnd(event)})),canvas.on("drop",(function(event){var pseudoConnectorProps=_this2.pseudoConnectorProps,selectedBlockType=_this2.selectedBlockType,_ref=selectedBlockType||{},type=_ref.type;(0,validation/* isEmpty */.xb)(pseudoConnectorProps)&&"event"!==type||(_this2.drawWorkFlowBlock(event),_this2.drawWorkFlowConnector({pseudoConnectorProps:pseudoConnectorProps})),_this2.$set(_this2,"pseudoConnectorProps",null),_this2.$set(_this2,"isNewWorkFlowBlockDragged",!1)}))},registerNativeEvents:function(){
// Setup native events here
},findClosestWorkFlowBlow:throttle_default()((function(_ref2){var e=_ref2.e,canvas=this.canvas,isNewWorkFlowBlockDragged=this.isNewWorkFlowBlockDragged,pos=canvas.getPointer(e),canvasObjects=canvas.getObjects(),workFlowObjects=canvasObjects.filter((function(obj){return!(0,validation/* isEmpty */.xb)(obj.workFlowType)}));if(!(0,validation/* isEmpty */.xb)(workFlowObjects)&&isNewWorkFlowBlockDragged)for(var index=0;index<workFlowObjects.length;index++){var obj=workFlowObjects[index],aCoords=obj.aCoords,br=aCoords.br,bl=aCoords.bl,tr=aCoords.tr,pointerX=pos.x,pointerY=pos.y,rectCenterCoords=(0,utils_Common/* getCenterCoords */.us)(obj),centerX=rectCenterCoords.x,centerY=rectCenterCoords.y,cursorDirection=null,distBtwCenterAndPos=null,bottomRightX=br.x,bottomRightY=br.y,topRightX=tr.x,topRightY=tr.y,bottomLeftX=bl.x,bottomLeftY=bl.y,midPointBottom=(0,utils_Math/* getLineMidPoint */.eN)({x:bottomLeftX,y:bottomLeftY},{x:bottomRightX,y:bottomRightY}),midPointRight=(0,utils_Math/* getLineMidPoint */.eN)({x:topRightX,y:topRightY},{x:bottomRightX,y:bottomRightY}),startPos={},endPos={},isAroundBottomSide=pointerX>bottomLeftX&&pointerX<bottomRightX&&bottomLeftY<pointerY,isAroundRightSide=pointerY<bottomRightY&&pointerY>topRightY&&pointerX>bottomRightX;if(isAroundBottomSide?(cursorDirection=cursorDirectionMap.bottom,startPos=midPointBottom[0],endPos={x:startPos.x,y:startPos.y+100}):isAroundRightSide&&(cursorDirection=cursorDirectionMap.right,startPos=midPointRight[0],endPos={x:startPos.x+100,y:startPos.y}),(0,validation/* isEmpty */.xb)(cursorDirection)||(distBtwCenterAndPos=(cursorDirectionMap.right,(0,utils_Math/* getDistBtwPoints */.x_)({x:centerX,y:centerY},{x:pointerX,y:pointerY}))),distBtwCenterAndPos&&distBtwCenterAndPos<threshold){var arrowStartEndCoords=[startPos,endPos];this.drawPseudoConnector({e:e,arrowStartEndCoords:arrowStartEndCoords,cursorDirection:cursorDirection});break}this.removePseudoConnector()}}),40),drawWorkFlowBlock:function(_ref3){var e=_ref3.e,canvas=this.canvas,selectedBlockType=this.selectedBlockType,pseudoConnectorProps=this.pseudoConnectorProps,pos=canvas.getPointer(e),workflowBlockObj=makeWorkFlowBlock(selectedBlockType,canvas,pos),aCoords=workflowBlockObj.aCoords,br=aCoords.br,bl=aCoords.bl,tr=aCoords.tr,width=(0,utils_Math/* getDistBtwPoints */.x_)(br,bl)/2,height=(0,utils_Math/* getDistBtwPoints */.x_)(tr,br)/2;if(!(0,validation/* isEmpty */.xb)(pseudoConnectorProps)){var arrowStartEndCoords=pseudoConnectorProps.arrowStartEndCoords,cursorDirection=pseudoConnectorProps.cursorDirection,endPos=arrowStartEndCoords[1];cursorDirection===cursorDirectionMap.right?workflowBlockObj.set({top:endPos.y,left:endPos.x+width}):cursorDirection===cursorDirectionMap.bottom&&workflowBlockObj.set({top:endPos.y+height,left:endPos.x})}canvas.add(workflowBlockObj)},drawWorkFlowConnector:function(props){var pseudoConnectorProps=props.pseudoConnectorProps;if(!(0,validation/* isEmpty */.xb)(pseudoConnectorProps)){this.removePseudoConnector();var canvas=this.canvas,connector=makeWorkFlowConnectors((0,objectSpread2/* default */.Z)({},pseudoConnectorProps));canvas.add(connector),this.$set(this,"pseudoConnectorProps",null)}},drawPseudoConnector:function(props){this.removePseudoConnector();var canvas=this.canvas,pseudoConnector=makeWorkFlowConnectors((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},props),{},{id:"pseudo-connector"}));canvas.add(pseudoConnector),this.$set(this,"pseudoConnectorProps",props)},removePseudoConnector:function(){var canvas=this.canvas;this.$set(this,"pseudoConnectorProps",null);var existingConnector=(0,utils_Common/* getObjById */.cU)(canvas,"pseudo-connector");canvas.remove(existingConnector),canvas.requestRenderAll()}}},workflowbuilder_WorkFlowBuildervue_type_script_lang_js=WorkFlowBuildervue_type_script_lang_js,WorkFlowBuilder_component=(0,componentNormalizer/* default */.Z)(workflowbuilder_WorkFlowBuildervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,WorkFlowBuilder=WorkFlowBuilder_component.exports},
/***/635451:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);
// Module
var code='<svg viewBox="0 0 512 512" width="40" height="40"><circle cx="256" cy="256" r="256" fill-rule="evenodd" clip-rule="evenodd" fill="#eb8805"/><path d="M321.3 349l-17.7-44.7H204L186.2 349h-28.5l80.7-200.1h30.9L349.8 349h-28.5zm-67.5-174.6l-42.3 108h84.9l-42.6-108z" fill="#fff"/></svg>';
// Exports
/* harmony default export */__webpack_exports__["default"]=code},
/***/582598:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);
// Module
var code='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="40" height="40"><circle cx="256" cy="256" r="256" fill-rule="evenodd" clip-rule="evenodd" fill="#1aa9d0"/><path d="M169 249.1c0-61.5 45.3-103.5 102.9-103.5 35.4 0 60 16.8 75.9 39.6l-20.7 11.7c-11.4-17.1-32.4-29.1-55.2-29.1-43.8 0-77.1 33.3-77.1 81.3 0 47.4 33.3 81.3 77.1 81.3 22.8 0 43.8-12.3 55.2-29.1l21 11.4c-16.8 23.1-40.8 39.9-76.2 39.9-57.6 0-102.9-42-102.9-103.5z" fill="#fff"/></svg>';
// Exports
/* harmony default export */__webpack_exports__["default"]=code},
/***/195041:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);
// Module
var code='<svg viewBox="0 0 512 512" width="40" height="40"><circle cx="256" cy="256" r="256" fill-rule="evenodd" clip-rule="evenodd" fill="#33b67a"/><path d="M192.9 349V148.9H324v22.2H217.8v64.5h104.1v22.2H217.8v69H324V349H192.9z" fill="#fff"/></svg>';
// Exports
/* harmony default export */__webpack_exports__["default"]=code},
/***/324960:
/***/function(){
/* (ignored) */
/***/},
/***/326759:
/***/function(){
/* (ignored) */
/***/},
/***/56272:
/***/function(){
/* (ignored) */
/***/}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/44391.js.map