(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[63344],{
/***/303514:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return AsyncButton}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/AsyncButton.vue?vue&type=template&id=16ca9ad1
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-button",_vm._b({class:_vm.buttonClass,attrs:{loading:_vm.showLoading,type:_vm.buttonType,size:_vm.size,disabled:_vm.disabled},on:{click:function($event){return _vm.save()}}},"el-button",_vm.$attrs,!1),[_vm._t("default")],2)},staticRenderFns=[],toConsumableArray=__webpack_require__(488478),AsyncButtonvue_type_script_lang_js=(__webpack_require__(260228),__webpack_require__(821694),__webpack_require__(76265),{props:["clickAction","actionParams","buttonType","buttonClass","size","disabled","loading"],data:function(){return{isLoading:!1}},computed:{showLoading:function(){return this.loading||this.isLoading}},methods:{save:function(){var _this=this;if(this.clickAction&&"function"===typeof this.clickAction){this.isLoading=!0;var returnPromise=this.actionParams?this.clickAction.apply(this,(0,toConsumableArray/* default */.Z)(this.actionParams)):this.clickAction(),minimumTimeout=this.$helpers.delay(1e3);returnPromise?Promise.all([returnPromise,minimumTimeout]).finally((function(){_this.isLoading=!1})):this.$helpers.delay(1e3).then((function(){return _this.isLoading=!1}))}}}}),components_AsyncButtonvue_type_script_lang_js=AsyncButtonvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_AsyncButtonvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,AsyncButton=component.exports},
/***/919324:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return CodeMirror}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/CodeMirror.vue?vue&type=template&id=f33b888a
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("codemirror",{attrs:{options:_vm.cmOption,placeholder:_vm.placeholder},on:{input:_vm.onCmCodeChange,ready:_vm.onCmReady,focus:_vm.onCmFocus},model:{value:_vm.script,callback:function($$v){_vm.script=$$v},expression:"script"}})],1)},staticRenderFns=[],vue_codemirror=__webpack_require__(375055),CodeMirrorvue_type_script_lang_js=(__webpack_require__(304631),__webpack_require__(471707),__webpack_require__(959372),__webpack_require__(620017),__webpack_require__(796876),__webpack_require__(988386),{data:function(){return{script:null,cmOption:{tabSize:4,styleActiveLine:!0,mode:"text/javascript",theme:"default",lineNumbers:!0,line:!0,matchBrackets:!0,foldGutter:!0,placeholder:!1,hintOptions:{completeSingle:!1},showCursorWhenSelecting:!0}}},props:["value","options","placeholder"],components:{codemirror:vue_codemirror.codemirror},computed:{codemirror:function(){return this.$refs.myCm.codemirror}},watch:{value:{handler:function(){this.script=this.$helpers.cloneObject(this.value),this.options&&Object.assign(this.cmOption,this.options)},immediate:!0}},methods:{onCmReady:function(cm){},onCmFocus:function(cm){},onCmCodeChange:function(newCode){this.$emit("input",newCode)},addCode:function(code){this.script=this.script+="\n"+code+"\n"},onCmScroll:function(){}}}),components_CodeMirrorvue_type_script_lang_js=CodeMirrorvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_CodeMirrorvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,CodeMirror=component.exports},
/***/634559:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FieldUpdateDialog}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/fields/FieldUpdateDialog.vue?vue&type=template&id=3a6c8a46
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("el-dialog",{staticClass:"fieldchange-Dialog pB15 fc-dialog-center-container",attrs:{visible:!0,width:"50%",title:"Field Change","custom-class":"dialog-header-padding","append-to-body":!0,"before-close":_vm.close}},[_c("div",{staticClass:"height330 overflow-y-scroll pB50"},_vm._l(_vm.fieldChange.templateJson.fieldMatcher,(function(fieldMatcher,index){return _c("div",{key:index},[_c("el-row",{staticClass:"visibility-visible-actions fc-row-hover pT10 pB10 pL10 pointer"},[_c("el-col",{attrs:{span:1}},[_c("div",{staticClass:"criteria-alphabet-block pT6"},[_c("div",{staticClass:"alphabet-circle"},[_vm._v(_vm._s(index+1))])])]),_c("el-col",{staticClass:"pL10",attrs:{span:9}},[_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{filterable:""},on:{change:function($event){return _vm.statusFieldName(fieldMatcher,index)}},model:{value:fieldMatcher.field,callback:function($$v){_vm.$set(fieldMatcher,"field",$$v)},expression:"fieldMatcher.field"}},_vm._l(_vm.updateFields,(function(field,index){return _c("el-option",{key:index,attrs:{label:field.displayName,value:field.name}})})),1)],1),_c("el-col",{attrs:{span:9}},[_c("div",{},[fieldMatcher.fieldObj?fieldMatcher.isSpacePicker?_c("div",[_c("el-input",{staticClass:"fc-input-full-border-select2 mL20 width100",attrs:{disabled:""},model:{value:_vm.field.parseLabel,callback:function($$v){_vm.$set(_vm.field,"parseLabel",$$v)},expression:"field.parseLabel"}},[_c("i",{staticClass:"el-input__icon el-icon-search",staticStyle:{"line-height":"0px !important","font-size":"16px !important",cursor:"pointer"},attrs:{slot:"suffix"},slot:"suffix"})])],1):_c("div",{staticClass:"flex-middle"},["NUMBER"===fieldMatcher.fieldObj[0].dataType||"DECIMAL"===fieldMatcher.fieldObj[0].dataType?_c("el-input",{staticClass:"fc-input-full-border-select2 mL20 width100",attrs:{type:"number"},model:{value:fieldMatcher.value,callback:function($$v){_vm.$set(fieldMatcher,"value",$$v)},expression:"fieldMatcher.value"}}):"BOOLEAN"===fieldMatcher.fieldObj[0].dataTypeEnum._name?_c("el-select",{staticClass:"fc-input-full-border-select2 mL20 width100pxss",model:{value:fieldMatcher.value,callback:function($$v){_vm.$set(fieldMatcher,"value",$$v)},expression:"fieldMatcher.value"}},[_c("el-option",{attrs:{label:fieldMatcher.fieldObj[0].trueVal?fieldMatcher.fieldObj[0].trueVal:"Yes",value:"true"}}),_c("el-option",{attrs:{label:fieldMatcher.fieldObj[0].falseVal?fieldMatcher.fieldObj[0].falseVal:"No",value:"false"}})],1):"ENUM"===fieldMatcher.fieldObj[0].dataTypeEnum._name?_c("el-select",{staticClass:"fc-input-full-border-select2 width100 mL20",attrs:{filterable:"","collapse-tags":""},model:{value:fieldMatcher.value,callback:function($$v){_vm.$set(fieldMatcher,"value",$$v)},expression:"fieldMatcher.value"}},_vm._l(_vm.picklistOptions[fieldMatcher.field],(function(value,key){return _c("el-option",{key:key,attrs:{label:value,value:key}})})),1):"DATE"===fieldMatcher.fieldObj[0].dataTypeEnum._name||"DATE_TIME"===fieldMatcher.fieldObj[0].dataTypeEnum._name?_c("el-row",{staticClass:"mL20"},[_c("el-col",{attrs:{span:7}},[_c("el-input",{staticClass:"fc-input-full-border-select2 width75px",attrs:{type:"number"},on:{change:function($event){return _vm.changeDataType(fieldMatcher)}},model:{value:fieldMatcher.dateObject.days,callback:function($$v){_vm.$set(fieldMatcher.dateObject,"days",$$v)},expression:"fieldMatcher.dateObject.days"}}),_c("div",{staticClass:"f12 fc-darkgrey text-left pT10 nowrap"},[_vm._v(" Days ")])],1),_c("el-col",{staticClass:"pL30",attrs:{span:7}},[_c("el-select",{staticClass:"fc-input-full-border-select2 width75px",attrs:{clearable:"",filterable:"",placeholder:"Num"},on:{change:function($event){return _vm.changeDataType(fieldMatcher)}},model:{value:fieldMatcher.dateObject.hours,callback:function($$v){_vm.$set(fieldMatcher.dateObject,"hours",$$v)},expression:"fieldMatcher.dateObject.hours"}},_vm._l(_vm.$constants.HOURS,(function(index){return _c("el-option",{key:index+1,attrs:{label:index,value:index}})})),1),_c("div",{staticClass:"f12 fc-darkgrey text-left pT10 nowrap"},[_vm._v(" Hours ")])],1),_c("el-col",{staticClass:"pL60",attrs:{span:7}},[_c("el-select",{staticClass:"fc-input-full-border-select2 width75px",attrs:{placeholder:"Num",filterable:""},on:{change:function($event){return _vm.changeDataType(fieldMatcher)}},model:{value:fieldMatcher.dateObject.minute,callback:function($$v){_vm.$set(fieldMatcher.dateObject,"minute",$$v)},expression:"fieldMatcher.dateObject.minute"}},_vm._l(_vm.minDuration,(function(index){return _c("el-option",{key:index+1,attrs:{label:index,value:index}})})),1),_c("div",{staticClass:"f12 fc-darkgrey text-left pT10 nowrap"},[_vm._v(" Mins ")])],1)],1):"LOOKUP"===fieldMatcher.fieldObj[0].dataTypeEnum._name&&"LOOKUP_SIMPLE"===fieldMatcher.fieldObj[0].displayType._name||"LOOKUP"===fieldMatcher.fieldObj[0].dataTypeEnum._name?_c("el-select",{staticClass:"fc-input-full-border-select2 width100 mL20",attrs:{filterable:"","collapse-tags":""},on:{change:function($event){return _vm.changeDataType(fieldMatcher)}},model:{value:fieldMatcher.valueArray,callback:function($$v){_vm.$set(fieldMatcher,"valueArray",$$v)},expression:"fieldMatcher.valueArray"}},_vm._l(_vm.picklistOptions[fieldMatcher.field],(function(value,key){return _c("el-option",{key:key,attrs:{label:value,value:key}})})),1):_c("el-input",{staticClass:"fc-input-full-border-select2 mL20 width130px",model:{value:fieldMatcher.value,callback:function($$v){_vm.$set(fieldMatcher,"value",$$v)},expression:"fieldMatcher.value"}})],1):_c("div",[_c("el-input",{staticClass:"fc-input-full-border-select2 mL20 width100",model:{value:fieldMatcher.value,callback:function($$v){_vm.$set(fieldMatcher,"value",$$v)},expression:"fieldMatcher.value"}})],1)])]),_c("el-col",{attrs:{span:5}},[_c("div",{staticClass:"visibility-hide-actions pT10 mR20 text-right pointer"},[_c("img",{staticClass:"pointer",attrs:{src:__webpack_require__(353654)},on:{click:_vm.addRow}}),_vm.fieldChange.templateJson.fieldMatcher.length>1&&1!==_vm.fieldChange.templateJson.fieldMatcher.length?_c("img",{staticClass:"pointer mL5",attrs:{src:__webpack_require__(385769)},on:{click:function($event){return _vm.deleteRow(index)}}}):_vm._e()])])],1)],1)})),0),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){return _vm.close()}}},[_vm._v("CANCEL")]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:function($event){return _vm.actionSave(_vm.fieldChange)}}},[_vm._v("Save")])],1)])],1)},staticRenderFns=[],validation=(__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(976801),__webpack_require__(434284),__webpack_require__(843843),__webpack_require__(670560),__webpack_require__(162506),__webpack_require__(990260)),FieldUpdateDialogvue_type_script_lang_js={props:["statusFieldName","fieldChange","moduleFields","module","picklistOptions","addRow","actionSave","fieldUpdateValue","durationConfig"],data:function(){return{moduleObj:{},excludeFields:["stateFlowId","siteId","photo","moduleState"],updateFieldName:{alarm:["severity"],newreadingalarm:["severity"],workorder:["assignedTo","assignmentGroup","category","dueDate","priority","type"],asset:["type","model","manufacturer","purchasedDate","retireDate","unitPrice","warrantyExpiryDate","department"],dealsandoffers:["active"]}}},computed:{updateFields:function(){var _this=this,fields=[],_this$moduleObj=this.moduleObj,moduleObj=void 0===_this$moduleObj?{}:_this$moduleObj,excludeFields=this.excludeFields,moduleFields=this.moduleFields,$getProperty=this.$getProperty,decommissionFields=["decommission","decommissionedBy","viewRecommissionedBtn","commissionedTime"];return(0,validation/* isEmpty */.xb)(moduleFields)?"CUSTOM"===$getProperty(moduleObj.typeEnum,"_name","")&&(fields=moduleFields.filter((function(field){return!excludeFields.includes(field.name)}))):(moduleFields=moduleFields.filter((function(field){return!decommissionFields.includes(field.name)})),fields=this.updateFieldName[this.module]?moduleFields.filter((function(field){return!field.default||_this.updateFieldName[_this.module]&&_this.updateFieldName[_this.module].includes(field.name)})):moduleFields),fields},minDuration:function(){var durationConfig=this.durationConfig;if(this.$getProperty(durationConfig,"minInterval")){for(var minutes=[],minInterval=durationConfig.minInterval,i=0;i<60;i+=minInterval)minutes.push(i);return minutes}return this.$constants.MINUTES}},mounted:function(){this.getMetaFields()},methods:{getMetaFields:function(){var _this2=this,module=this.module;if(module){var url="/module/meta?moduleName=".concat(module);this.$http.get(url).then((function(response){_this2.moduleObj=response.data.meta.module}))}},changeDataType:function(criteria){if("DATE_TIME"===criteria.fieldObj[0].dataTypeEnum._name||"DATE"===criteria.fieldObj[0].dataTypeEnum._name){if(criteria.dateObject){var interval=this.$helpers.daysHoursMinuToSec(criteria.dateObject);criteria.value=1e3*interval}}else criteria.valueArray&&(
// let values = criteria.valueArray.join()
criteria.value={id:criteria.valueArray});this.$forceUpdate()},deleteRow:function(index){this.fieldChange.templateJson.fieldMatcher.splice(index,1)},close:function(){this.$emit("update:fieldUpdateValue",!1)}}},fields_FieldUpdateDialogvue_type_script_lang_js=FieldUpdateDialogvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(fields_FieldUpdateDialogvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FieldUpdateDialog=component.exports},
/***/292974:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return StatusUpdate}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/newapp/setupActions/components/StatusUpdate.vue?vue&type=template&id=5163edd4&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"fieldchange-Dialog pB15 fc-dialog-center-container",attrs:{visible:!0,width:"40%",title:_vm.$t("setup.setup.change_status"),"custom-class":"dialog-header-padding","append-to-body":!0,"close-on-click-modal":!1,"show-close":!1}},[_vm.isLoading?_c("div",{staticClass:"height120"},[_c("span",{staticClass:"rectangle loading-shimmer"})]):_c("div",{staticClass:"height120 overflow-y-scroll"},[_c("el-select",{staticClass:"fc-input-full-border-select2 width100 mT5",attrs:{filterable:""},model:{value:_vm.statusUpdateObj.new_state,callback:function($$v){_vm.$set(_vm.statusUpdateObj,"new_state",$$v)},expression:"statusUpdateObj.new_state"}},_vm._l(_vm.statusList,(function(label,value){return _c("el-option",{key:value,attrs:{label:label,value:value}})})),1)],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.closeDialog}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:_vm.actionSave}},[_vm._v(" "+_vm._s(_vm.$t("common._common.save")))])],1)])},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),ChangeStatusModel=__webpack_require__(367389),validation=__webpack_require__(990260),StatusUpdatevue_type_script_lang_js={props:["actionObj","moduleName","moduleId"],data:function(){return{statusUpdateObj:{},statusList:{},isLoading:!1}},created:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var metaModuleId;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(_this.isLoading=!0,_this.statusUpdateObj=new ChangeStatusModel/* ChangeStatusModel */.M(_this.actionObj||{}),metaModuleId=null,!(0,validation/* isEmpty */.xb)(_this.moduleId)){_context.next=7;break}return _context.next=6,_this.fetchModuleId();case 6:metaModuleId=_context.sent;case 7:return _context.prev=7,_context.next=10,ChangeStatusModel/* ChangeStatusModel */.M.getTicketStatus(_this.moduleId||metaModuleId);case 10:_this.statusList=_context.sent,_context.next=16;break;case 13:_context.prev=13,_context.t0=_context["catch"](7),_this.$message.error(_context.t0.message);case 16:_this.isLoading=!1;case 17:case"end":return _context.stop()}}),_callee,null,[[7,13]])})))()},methods:{fetchModuleId:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _context2.prev=0,_context2.next=3,ChangeStatusModel/* ChangeStatusModel */.M.fetchMetaModuleId(_this2.moduleName);case 3:return _context2.abrupt("return",_context2.sent);case 6:_context2.prev=6,_context2.t0=_context2["catch"](0),_this2.$message.error(_context2.t0.message);case 9:case"end":return _context2.stop()}}),_callee2,null,[[0,6]])})))()},closeDialog:function(){this.$emit("onClose")},actionSave:function(){this.$emit("onSave",this.statusUpdateObj.serialize()),this.closeDialog()}}},components_StatusUpdatevue_type_script_lang_js=StatusUpdatevue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_StatusUpdatevue_type_script_lang_js,render,staticRenderFns,!1,null,"5163edd4",null)
/* harmony default export */,StatusUpdate=component.exports},
/***/502971:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return NewSLA}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/setup/sla/NewSLA.vue?vue&type=template&id=5c76ce58
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"formbuilder-fullscreen-popup sla-policy-container"},[_c("div",{staticClass:"setting-header"},[_vm.isNew?_c("div",{staticClass:"d-flex flex-direction-column"},[_c("div",{staticClass:"mT10 mB10 f22 fw3 letter-spacing0_5"},[_vm._v(" "+_vm._s(_vm.$t("setup.new.new_sla"))+" ")])]):_c("div",[_c("div",{staticClass:"pointer fc-link fw-normal f13",on:{click:_vm.goBack}},[_c("inline-svg",{attrs:{src:"left-arrow",iconClass:"icon icon-sm vertical-text-top mR5"}}),_vm._v(" "+_vm._s(_vm.$t("setup.setupLabel.go_back"))+" ")],1),_c("div",{staticClass:"mT10 mB5 f22 fw3 letter-spacing0_5"},[_vm._v(" "+_vm._s("Edit "+_vm.policyTitle)+" ")])]),_c("div",{staticClass:"fR stateflow-btn-wrapper"},[_c("async-button",{attrs:{buttonClass:"asset-el-btn",clickAction:_vm.goBack,"data-test-selector":"save-sla-policy"}},[_vm._v(" "+_vm._s(_vm.$t("setup.users_management.cancel"))+" ")]),_c("async-button",{attrs:{buttonType:"primary",buttonClass:"asset-el-btn",clickAction:_vm.save,"data-test-selector":"save-sla-policy"}},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.save"))+" ")])],1)]),_c("div",{staticClass:"d-flex setup-grey-bg"},[_c("div",{staticClass:"sla-sidebar pT10"},[_c("a",{staticClass:"sla-link active",attrs:{id:"policy-link"},on:{click:function($event){return _vm.scrollTo("policy")}}},[_vm._v(" "+_vm._s(_vm.$t("setup.setupLabel.policy"))+" ")]),_c("a",{staticClass:"sla-link",attrs:{id:"commitment-link"},on:{click:function($event){return _vm.scrollTo("commitment")}}},[_vm._v(" "+_vm._s(_vm.$t("setup.setupLabel.commitments"))+" ")]),_c("a",{staticClass:"sla-link",attrs:{id:"escalation-link"},on:{click:function($event){return _vm.scrollTo("escalation")}}},[_vm._v(" "+_vm._s(_vm.$t("setup.setupLabel.escalations"))+" ")])]),_c("div",{staticClass:"scroll-container"},[_vm.isLoading?_c("div",{staticClass:"mT20"},[_c("spinner",{attrs:{show:_vm.isLoading,size:"80"}})],1):[_c("NewPolicy",{ref:"policy-section",staticClass:"mB20",attrs:{id:"policy-section",policy:_vm.slaPolicy,entities:_vm.entities},on:{updateTitle:function(value){return _vm.policyTitle=value},modified:_vm.markAsModified}}),_c("NewCommitments",{ref:"commitment-section",staticClass:"mB20",attrs:{id:"commitment-section",policy:_vm.slaPolicy,entities:_vm.entities},on:{modified:_vm.markAsModified}}),_c("NewEscalations",{ref:"escalation-section",staticClass:"mB20",attrs:{id:"escalation-section",policy:_vm.slaPolicy,entities:_vm.entities},on:{modified:_vm.markAsModified}})],_c("div",{staticClass:"mT50"})],2)])])},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),objectSpread2=__webpack_require__(595082),asyncToGenerator=__webpack_require__(548534),validation=(__webpack_require__(260228),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(434284),__webpack_require__(821057),__webpack_require__(670560),__webpack_require__(990260)),AsyncButton=__webpack_require__(303514),http=__webpack_require__(218430),NewPolicyvue_type_template_id_3b405320_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("div",{staticClass:"section-header policy-section-header policy-section-header-text",attrs:{id:"policy-header"}},[_vm._v(" "+_vm._s(_vm.$t("setup.setupLabel.policy"))+" ")]),_c("el-form",{ref:"slaPolicy-form",staticClass:"p50 pT10 pR70 pB30",attrs:{model:_vm.slaPolicy,rules:_vm.rules,"label-width":"180px","label-position":"left"}},[_c("el-row",{staticClass:"mB10"},[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{staticClass:"mB10",attrs:{prop:"name",label:_vm.$t("setup.setupLabel.sla_name")}},[_c("el-input",{staticClass:"fc-input-full-border2",on:{change:function(name){return _vm.$emit("updateTitle",name)}},model:{value:_vm.slaPolicy.name,callback:function($$v){_vm.$set(_vm.slaPolicy,"name",$$v)},expression:"slaPolicy.name"}})],1)],1)],1),_c("el-row",{staticClass:"mB10"},[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{staticClass:"mB10",attrs:{prop:"description",label:_vm.$t("space.sites.site_description")}},[_c("el-input",{staticClass:"fc-input-full-border-textarea",attrs:{type:"textarea",autosize:{minRows:4,maxRows:4},placeholder:_vm.$t("setup.setupLabel.add_a_decs"),resize:"none"},model:{value:_vm.slaPolicy.description,callback:function($$v){_vm.$set(_vm.slaPolicy,"description",$$v)},expression:"slaPolicy.description"}})],1)],1)],1),_c("el-row",{staticClass:"mB10"},[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{staticClass:"mB10",attrs:{prop:"siteId",label:_vm.$t("space.sites._site")}},[_c("Lookup",{attrs:{field:_vm.fields.site,hideLookupIcon:!0},on:{recordSelected:_vm.setSelectedValue,showLookupWizard:_vm.showLookupWizardSite},model:{value:_vm.slaPolicy.siteId,callback:function($$v){_vm.$set(_vm.slaPolicy,"siteId",$$v)},expression:"slaPolicy.siteId"}})],1)],1)],1),_c("el-row",{staticClass:"mT30"},[_c("el-col",{attrs:{span:24}},[_c("div",[_c("label",{staticClass:"policy-section-header"},[_vm._v(" Conditions to apply policy ")])]),_c("CriteriaBuilder",{ref:"criteria-builder",attrs:{moduleName:_vm.module},model:{value:_vm.slaPolicy.criteria,callback:function($$v){_vm.$set(_vm.slaPolicy,"criteria",$$v)},expression:"slaPolicy.criteria"}})],1)],1)],1)],1)},NewPolicyvue_type_template_id_3b405320_scoped_true_staticRenderFns=[],clone=(__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(659749),__webpack_require__(386544),__webpack_require__(891719),__webpack_require__(766678)),clone_default=__webpack_require__.n(clone),ui_forms=__webpack_require__(141323),dist=__webpack_require__(191853),fields={site:{isDataLoading:!1,options:[],lookupModuleName:"site",field:{lookupModule:{name:"site",displayName:"Sites"}},multiple:!1,additionalParams:{orderBy:"spaceType",orderType:"asc"}}},NewPolicyvue_type_script_lang_js={name:"NewPolicy",props:{policy:{type:Object}},components:{Lookup:ui_forms/* Lookup */.tY,CriteriaBuilder:dist/* CriteriaBuilder */.IP},data:function(){return{fields:fields,slaPolicy:{name:"",description:"",siteId:-1,criteria:null},defaultSite:{label:"All Sites",value:-1},rules:{},isCriteriaRendering:!1,canWatchForChanges:!1}},computed:{id:function(){return this.$route.params.id},isNew:function(){return(0,validation/* isEmpty */.xb)(this.$route.params.id)},module:function(){return this.$route.params.moduleName}},watch:{policy:{handler:function(){this.init()},immediate:!0},slaPolicy:{handler:function(){var slaPolicy=this.slaPolicy,fields=this.fields,defaultSite=this.defaultSite,_ref=fields||{},site=_ref.site,_ref2=site||{},options=_ref2.options,_ref3=slaPolicy||{},siteId=_ref3.siteId;this.canWatchForChanges&&!this.isCriteriaRendering&&this.$emit("modified"),-1===siteId&&(options.includes(defaultSite)||this.setDefaultSite())},deep:!0,immediate:!0}},methods:{init:function(){var _this=this;if(!this.isNew){var _this$policy=this.policy,id=_this$policy.id,name=_this$policy.name,description=_this$policy.description,siteId=_this$policy.siteId,criteria=_this$policy.criteria,criteriaId=_this$policy.criteriaId;this.slaPolicy=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},this.slaPolicy),{},{id:id,name:name,description:description,siteId:siteId,criteria:criteria,criteriaId:criteriaId}),this.$nextTick((function(){return _this.canWatchForChanges=!0}))}},setDefaultSite:function(){this.fields.site.options.unshift(this.defaultSite)},updateCriteria:function(value){this.$set(this.slaPolicy,"criteria",value)},showLookupWizardSite:function(field,canShow){canShow=!1,this.$set(this,"selectedLookupField",field),this.$set(this,"canShowLookupWizardSite",canShow)},setSelectedValue:function(selectedValues,field){},serialize:function(){var _clone=clone_default()(this.slaPolicy),id=_clone.id,name=_clone.name,description=_clone.description,siteId=_clone.siteId,criteria=_clone.criteria,_clone$criteriaId=_clone.criteriaId,criteriaId=void 0===_clone$criteriaId?null:_clone$criteriaId,data={name:name,description:description,siteId:siteId,criteria:criteria};return this.isNew||(data.id=id),(0,validation/* isEmpty */.xb)(criteria)||(0,validation/* isEmpty */.xb)(criteriaId)||(data.criteriaId=criteriaId),data},validation:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.next=2,_this2.$refs["criteria-builder"].validate();case 2:return _context.abrupt("return",_context.sent);case 3:case"end":return _context.stop()}}),_callee)})))()}}},new_NewPolicyvue_type_script_lang_js=NewPolicyvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(new_NewPolicyvue_type_script_lang_js,NewPolicyvue_type_template_id_3b405320_scoped_true_render,NewPolicyvue_type_template_id_3b405320_scoped_true_staticRenderFns,!1,null,"3b405320",null)
/* harmony default export */,NewPolicy=component.exports,NewCommitmentsvue_type_template_id_0917ae40_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("div",{staticClass:"section-header commitments-section-header commitments-section-header-text",attrs:{id:"commitment-header"}},[_vm._v(" "+_vm._s(_vm.$t("setup.setupLabel.commitments"))+" ")]),_c("div",{staticClass:"p50 pT0 pR70 pB30"},[_c("p",{staticClass:"fc-sub-title-desc"},[_vm._v(" "+_vm._s(_vm.$t("setup.setupLabel.sla_commitment_header_desc"))+" ")]),_vm._l(_vm.commitments,(function(commitment,index){return[_c("div",{key:"collapse-"+index,staticClass:"rule-border-blue p20 mB15 position-relative",staticStyle:{"border-left":"1px solid rgb(228, 235, 241)"},attrs:{name:index}},[_c("div",{staticClass:"delete-commitment pointer",on:{click:function($event){return _vm.removeCommitment(index)}}},[_vm.commitments.length>1?_c("inline-svg",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"top",arrow:!0},expression:"{ placement: 'top', arrow: true }"}],key:"delete-"+index,staticClass:"f-delete vertical-middle",attrs:{src:"svgs/delete",iconClass:"icon icon-sm icon-remove",title:"Delete commitment"}}):_vm._e()],1),_c("el-form",{key:"commitments-"+index+"-sla-"+commitment,attrs:{model:commitment,rules:_vm.rules,"label-width":"220px","label-position":"left"}},[_c("el-row",{staticClass:"mB10"},[_c("el-col",{attrs:{span:20}},[_c("el-form-item",{staticClass:"mB10",attrs:{prop:"name",label:_vm.$t("setup.setupLabel.commitment_name")}},[_c("el-input",{staticClass:"fc-input-full-border2",model:{value:commitment.name,callback:function($$v){_vm.$set(commitment,"name",$$v)},expression:"commitment.name"}})],1)],1)],1),_c("el-row",{staticClass:"mT30"},[_c("el-col",{staticStyle:{"max-width":"750px"},attrs:{span:24}},[_c("div",{staticClass:"d-flex flex-direction-row mB20"},[_c("div",{staticClass:"d-flex align-center width220px"},[_c("span",{staticClass:"commitments-section-header"},[_vm._v(_vm._s(_vm.$t("setup.setupLabel.sla_commitment_sub_def_header")))]),_c("el-tooltip",{attrs:{placement:"top-start",content:_vm.$t("setup.setupLabel.sla_commitment_sub_def_header_info")}},[_c("i",{staticClass:"el-icon-info pL5 mT2"})])],1),_c("div",{staticClass:"flex-grow d-flex align-center"},[_c("span",{staticClass:"commitments-section-header"},[_vm._v(_vm._s(_vm.$t("setup.setupLabel.sla_commitment_sub_def_header2")))])])]),_vm._l(commitment.slaEntities,(function(entity){return _c("div",{key:"commitment_"+index+"_sla_"+entity.slaEntityId,staticClass:"mB20"},[_c("div",{staticClass:"d-flex flex-direction-row"},[_c("div",{staticClass:"d-flex align-center",staticStyle:{width:"220px"}},[_c("span",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.getEntityName(entity.slaEntityId))+" ")])]),_c("div",{staticClass:"flex-grow d-flex"},[_c("DurationField",{key:"entity-"+index+"-sla-"+entity.slaEntityId,staticClass:"width100",on:{change:function(duration){return entity.durationPlaceHolder=duration}},model:{value:entity.durationPlaceHolder,callback:function($$v){_vm.$set(entity,"durationPlaceHolder",$$v)},expression:"entity.durationPlaceHolder"}})],1),_c("div",{staticClass:"mL20",staticStyle:{width:"200px"}},[_c("el-select",{staticClass:"fc-input-full-border-select2 width100 vertical-middle",model:{value:entity.type,callback:function($$v){_vm.$set(entity,"type",$$v)},expression:"entity.type"}},_vm._l(_vm.hourTypes,(function(field,index){return _c("el-option",{key:"approvalType-"+index,attrs:{label:field.label,value:field.id}})})),1)],1)])])}))],2)],1),index===_vm.commitments.length-1?[_c("el-row",[_c("el-col",{staticClass:"mT20 d-flex",attrs:{span:15}},[_c("div",{staticClass:"commitments-section-header flex-middle"},[_vm._v(" "+_vm._s(_vm.$t("setup.setupLabel.commitment_satisfies_these_conditions"))+" ")]),_c("el-switch",{staticClass:"Notification-toggle mL-auto mT5",attrs:{"active-color":"rgba(57, 178, 194, 0.8)","inactive-color":"#e5e5e5"},model:{value:_vm.canShowCriteria,callback:function($$v){_vm.canShowCriteria=$$v},expression:"canShowCriteria"}})],1),_vm.canShowCriteria?_c("el-col",{attrs:{span:24}},[_c("CriteriaBuilder",{attrs:{moduleName:_vm.module},model:{value:commitment.criteria,callback:function($$v){_vm.$set(commitment,"criteria",$$v)},expression:"commitment.criteria"}})],1):_vm._e()],1)]:[_c("CriteriaBuilder",{attrs:{moduleName:_vm.module},model:{value:commitment.criteria,callback:function($$v){_vm.$set(commitment,"criteria",$$v)},expression:"commitment.criteria"}})]],2)],1)]})),_c("el-row",{staticClass:"mT30 pB30"},[_c("el-col",{attrs:{span:24}},[_c("el-tooltip",{attrs:{content:"Please define commitment criteria to add more commitments",disabled:_vm.canShowCriteria,placement:"right"}},[_c("div",{staticClass:"inline"},[_c("el-button",{staticClass:"task-add-btn mT5",attrs:{disabled:!_vm.canShowCriteria},on:{click:function($event){return _vm.addCommitment()}}},[_c("img",{attrs:{src:__webpack_require__(511423)}}),_c("span",{staticClass:"btn-label mL5"},[_vm._v(" "+_vm._s(_vm.$t("setup.add.add_commitment"))+" ")])])],1)])],1)],1)],2)])},NewCommitmentsvue_type_template_id_0917ae40_scoped_true_staticRenderFns=[],cloneDeep=(__webpack_require__(450886),__webpack_require__(425728),__webpack_require__(162506),__webpack_require__(947522),__webpack_require__(538077),__webpack_require__(150361)),cloneDeep_default=__webpack_require__.n(cloneDeep),SLADurationFieldvue_type_template_id_1db894fa_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"duration-field-container d-flex"},["minutes"===_vm.selectedUnit?[_c("el-select",{staticClass:"fc-input-full-border2 input-with-select flex-grow",attrs:{type:"number",disabled:_vm.isDisabled,placeholder:"Select duration",clearable:""},on:{change:_vm.handleDurationObjChange},model:{value:_vm.durationObj[_vm.selectedUnit],callback:function($$v){_vm.$set(_vm.durationObj,_vm.selectedUnit,$$v)},expression:"durationObj[selectedUnit]"}},_vm._l(_vm.minuteOptions,(function(option){return _c("el-option",{key:option,attrs:{label:option,value:option}})})),1),_c("el-select",{staticClass:"fc-input-full-border2 unit-selection",attrs:{disabled:_vm.isDisabled},on:{change:function($event){return _vm.onUnitChange.apply(void 0,arguments)}},model:{value:_vm.selectedUnit,callback:function($$v){_vm.selectedUnit=$$v},expression:"selectedUnit"}},_vm._l(_vm.unitOptions,(function(option){return _c("el-option",{key:option.value,attrs:{label:option.label,value:option.value}})})),1)]:"field"===_vm.selectedUnit?[_c("el-cascader",{staticClass:"fc-input-full-border2 input-with-select flex-grow",attrs:{options:_vm.fieldOptions,props:{expandTrigger:"hover",value:"name",label:"displayName",children:"fields"},"popper-class":"sla-duration-field"},on:{change:_vm.handleDurationObjChange},model:{value:_vm.durationObj[_vm.selectedUnit],callback:function($$v){_vm.$set(_vm.durationObj,_vm.selectedUnit,$$v)},expression:"durationObj[selectedUnit]"}}),_c("el-select",{staticClass:"fc-input-full-border2 unit-selection",attrs:{disabled:_vm.isDisabled},on:{change:function($event){return _vm.onUnitChange.apply(void 0,arguments)}},model:{value:_vm.selectedUnit,callback:function($$v){_vm.selectedUnit=$$v},expression:"selectedUnit"}},_vm._l(_vm.unitOptions,(function(option){return _c("el-option",{key:option.value,attrs:{label:option.label,value:option.value}})})),1)]:_c("el-input",{staticClass:"fc-input-full-border2 input-with-select",attrs:{disabled:_vm.isDisabled,placeholder:"Enter duration"},on:{change:_vm.handleDurationObjChange},model:{value:_vm.durationObj[_vm.selectedUnit],callback:function($$v){_vm.$set(_vm.durationObj,_vm.selectedUnit,$$v)},expression:"durationObj[selectedUnit]"}},[_c("el-select",{attrs:{slot:"append",disabled:_vm.isDisabled},on:{change:function($event){return _vm.onUnitChange.apply(void 0,arguments)}},slot:"append",model:{value:_vm.selectedUnit,callback:function($$v){_vm.selectedUnit=$$v},expression:"selectedUnit"}},_vm._l(_vm.unitOptions,(function(option){return _c("el-option",{key:option.value,attrs:{label:option.label,value:option.value}})})),1)],1)],2)},SLADurationFieldvue_type_template_id_1db894fa_staticRenderFns=[],slicedToArray=__webpack_require__(554621),moment_timezone=(__webpack_require__(169358),__webpack_require__(564043),__webpack_require__(907409),__webpack_require__(857267),__webpack_require__(186466),__webpack_require__(634338),__webpack_require__(506203),__webpack_require__(480008)),moment_timezone_default=__webpack_require__.n(moment_timezone),utility_methods=__webpack_require__(555005),api=__webpack_require__(32284),regex=/[\${:\-}]+/gm,SLADurationFieldvue_type_script_lang_js={props:["value","isDisabled"],data:function(){return{selectedUnit:"hours",durationObj:{days:null,hours:null,minutes:null,field:null},unitOptions:[{label:"Days",value:"days"},{label:"Hours",value:"hours"},{label:"Minutes",value:"minutes"},{label:"Field",value:"field"}],minuteOptions:[15,30,45],fieldOptions:[]}},created:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.next=2,_this.loadPlaceholderFieldOptions();case 2:_this.deserializeDurationField();case 3:case"end":return _context.stop()}}),_callee)})))()},computed:{moduleName:function(){return this.$route.params.moduleName}},watch:{value:{handler:"deserializeDurationField"}},methods:{loadPlaceholderFieldOptions:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var _yield$API$get,data,error,_ref,placeholders,_ref2,fields,moduleFields,fieldTypeFilter;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,api/* API */.bl.get("v3/placeholders/".concat(_this2.moduleName));case 2:_yield$API$get=_context2.sent,data=_yield$API$get.data,error=_yield$API$get.error,error||(_ref=data||{},placeholders=_ref.placeholders,_ref2=placeholders||{},fields=_ref2.fields,moduleFields=_ref2.moduleFields,(0,validation/* isEmpty */.xb)(fields)||(fieldTypeFilter=function(fld){return["NUMBER"].includes(fld.dataType)&&["DURATION"].includes(fld.displayType)},(0,validation/* isEmpty */.xb)(moduleFields)||Object.keys(moduleFields).forEach((function(fieldName){var lookupField=fields.find((function(fld){return fld.module===fieldName}));lookupField.fields=moduleFields[fieldName].filter(fieldTypeFilter)})),_this2.fieldOptions=fields.filter((function(fld){return fieldTypeFilter(fld)||!(0,validation/* isEmpty */.xb)(fld.fields)}))));case 6:case"end":return _context2.stop()}}),_callee2)})))()},deserializeDurationField:function(){var value=this.value,selectedUnit=this.selectedUnit;if(!(0,validation/* isEmpty */.xb)(value)){var durationObj={days:null,hours:null,minutes:null,field:null};
//return true if value string has `${}`
if(regex.test(value))durationObj.field=this.getFieldFromPlaceholder(value),selectedUnit="field";else{var duration=moment_timezone_default().duration(parseInt(value,10),"seconds"),Days=parseInt(duration.asDays(),10),Hrs=parseInt(duration.hours(),10),Mins=parseInt(duration.minutes(),10);0!==Days?0!==Hrs?(Hrs=parseInt(duration.asHours(),10),Days=0,selectedUnit="hours"):selectedUnit="days":0!==Hrs?0!==Mins?(selectedUnit="minutes",Hrs=0,Mins=parseInt(duration.asMinutes(),10)):selectedUnit="hours":selectedUnit=0!==Mins?"minutes":"hours",durationObj={days:Days,hours:Hrs,minutes:Mins,field:null},
// Set null for values that are 0. This is to allow users to clear
// values in the field (without this value will always be 0)
Object.keys(durationObj).forEach((function(key){0===durationObj[key]&&(durationObj[key]=null)}))}this.$set(this,"durationObj",durationObj)}this.$set(this,"selectedUnit",selectedUnit)},getFieldFromPlaceholder:function(value){var placeholderArray=value.replace(regex,"").split("."),_placeholderArray=(0,slicedToArray/* default */.Z)(placeholderArray,3),fieldName=_placeholderArray[1],primaryField=_placeholderArray[2],field=(0,validation/* isEmpty */.xb)(fieldName)?null:this.fieldOptions.find((function(f){return f.name===fieldName}));if(!(0,validation/* isEmpty */.xb)(field)){if(primaryField){var _field$fields,lookupField=(null===(_field$fields=field.fields)||void 0===_field$fields?void 0:_field$fields.find((function(f){return f.name===primaryField})))||null;
// Checking if primary field is a lookup field
return(0,validation/* isEmpty */.xb)(lookupField)?[fieldName]:[fieldName,primaryField]}return[fieldName]}return null},onUnitChange:function(unit){var durationObj=this.durationObj,existingDuration=Object.values(durationObj).find((function(value){return 0!=value}));Object.keys(durationObj).forEach((function(key){durationObj[key]=key!==unit?0:"minutes"===unit?30:existingDuration,durationObj["field"]=null})),this.$set(this,"selectedUnit",unit),this.$set(this,"durationObj",durationObj),this.handleDurationObjChange()},getPlaceholderFromField:function(placeholderField){var placeholderString=null;if(!(0,validation/* isEmpty */.xb)(placeholderField)){var _placeholderField=(0,slicedToArray/* default */.Z)(placeholderField,2),fieldName=_placeholderField[0],lookupFieldName=_placeholderField[1],_this$fieldOptions$fi=this.fieldOptions.find((function(f){return f.name===fieldName})),primaryField=_this$fieldOptions$fi.primaryField,fields=_this$fieldOptions$fi.fields;if((0,validation/* isEmpty */.xb)(lookupFieldName))!(0,validation/* isEmpty */.xb)(primaryField)&&placeholderField.push(primaryField);else{var _fields$find=fields.find((function(f){return f.name===lookupFieldName})),lookupPrimaryField=_fields$find.primaryField;!(0,validation/* isEmpty */.xb)(lookupPrimaryField)&&placeholderField.push(lookupPrimaryField)}placeholderString="${".concat(this.moduleName,".").concat(placeholderField.join("."),":-}")}return placeholderString},handleDurationObjChange:function(){var durationObj=this.durationObj,days=durationObj.days,hours=durationObj.hours,_durationObj$minutes=durationObj.minutes,minutes=void 0===_durationObj$minutes?0:_durationObj$minutes,_durationObj$seconds=durationObj.seconds,seconds=void 0===_durationObj$seconds?0:_durationObj$seconds,field=durationObj.field,value=null;if("field"!==this.selectedUnit){var formatedDuration=(0,utility_methods/* durationToSeconds */.Ro)({seconds:seconds,minutes:minutes,hours:hours,days:days});value=(0,validation/* isEmpty */.xb)(formatedDuration)?null:formatedDuration}else value=this.getPlaceholderFromField(field);this.$emit("change",value)}}},components_SLADurationFieldvue_type_script_lang_js=SLADurationFieldvue_type_script_lang_js,SLADurationField_component=(0,componentNormalizer/* default */.Z)(components_SLADurationFieldvue_type_script_lang_js,SLADurationFieldvue_type_template_id_1db894fa_render,SLADurationFieldvue_type_template_id_1db894fa_staticRenderFns,!1,null,null,null)
/* harmony default export */,SLADurationField=SLADurationField_component.exports,hourTypes=[{id:1,label:"Calendar Hours"},{id:2,label:"Business Hours"}],NewCommitmentsvue_type_script_lang_js={name:"NewCommitments",props:{policy:{type:Object},entities:{type:Array}},components:{DurationField:SLADurationField,CriteriaBuilder:dist/* CriteriaBuilder */.IP},data:function(){return{commitments:[],rules:{},hourTypes:hourTypes,canShowCriteria:!1,canWatchForChanges:!1}},computed:{policyId:function(){return this.$route.params.id},isNew:function(){return(0,validation/* isEmpty */.xb)(this.$route.params.id)},module:function(){return this.$route.params.moduleName},slaPolicy:function(){return this.sharedData.slaPolicy},commitmentObj:function(){return{name:"",criteria:null,isCriteriaRendering:!1,slaEntities:this.entities.map((function(_ref){var id=_ref.id;return{slaEntityId:id,durationPlaceHolder:null,type:1}}))}},haveCriteriasRendered:function(){return this.commitments.every((function(c){return!c.isCriteriaRendering}))}},watch:{policy:{handler:function(){this.init()},immediate:!0},commitments:{handler:function(){this.canWatchForChanges&&this.haveCriteriasRendered&&this.$emit("modified")},deep:!0}},methods:{init:function(){var _this=this;this.isNew?this.addCommitment():(this.deserialize(cloneDeep_default()(this.policy.commitments||[])),(0,validation/* isEmpty */.xb)(this.commitments)&&this.addCommitment()),this.$nextTick((function(){return _this.canWatchForChanges=!0}))},updateCriteria:function(commitment,value){this.$set(commitment,"criteria",value)},getEntityName:function(id){var entity=this.entities.find((function(e){return e.id===id}));return entity.name||""},addCommitment:function(){var commitments=this.commitments,commitmentObj=this.commitmentObj,cloneObj=cloneDeep_default()(commitmentObj);commitments.push(cloneObj),this.toggleCriteria()},removeCommitment:function(index){var commitments=this.commitments;commitments.splice(index,1)},toggleCriteria:function(){this.canShowCriteria=!1},validate:function(){return Promise.resolve(!0)},deserialize:function(commitments){var _this2=this;if(this.commitments=commitments.map((function(commitment){var entityList=commitment.slaEntities||[];return _this2.entities.forEach((function(_ref2){var id=_ref2.id,hasEntity=!(0,validation/* isEmpty */.xb)(entityList.find((function(e){return e.slaEntityId===id})));hasEntity||entityList.push({slaEntityId:id,durationPlaceHolder:null,type:1})})),entityList.forEach((function(entity){-1===entity.type&&(entity.type=1)})),(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},commitment),{},{isCriteriaRendering:!1,slaEntities:entityList})})),!(0,validation/* isEmpty */.xb)(commitments)){var lastCommitment=commitments[commitments.length-1]||{},criteria=this.$getProperty(lastCommitment,"criteria",null);(0,validation/* isEmpty */.xb)(criteria)||(this.canShowCriteria=!0)}},serialize:function(){var _this3=this,commitments=clone_default()(this.commitments);return commitments.map((function(commitment,index){
// Filter entities where duration is empty
var slaEntities=commitment.slaEntities.filter((function(entity){return!(0,validation/* isEmpty */.xb)(entity.durationPlaceHolder)||entity.durationPlaceHolder>0})).map((function(entity){return delete entity.addDuration,entity})),criteria=(0,validation/* isEmpty */.xb)(commitment.criteria)?null:commitment.criteria,criteriaId=commitment.criteriaId||null;!(0,validation/* isEmpty */.xb)(criteriaId)&&(0,validation/* isEmpty */.xb)(criteria)&&(criteriaId=-99),index!==commitments.length-1||_this3.canShowCriteria||(criteria=null,criteriaId=-99);var data={name:commitment.name,slaEntities:slaEntities,criteria:criteria};return commitment.id&&(data.id=commitment.id),
// TODO remove isNew check here, check with server if id still required
_this3.isNew||-99!==criteriaId||(data.criteriaId=criteriaId),data}))}}},new_NewCommitmentsvue_type_script_lang_js=NewCommitmentsvue_type_script_lang_js,NewCommitments_component=(0,componentNormalizer/* default */.Z)(new_NewCommitmentsvue_type_script_lang_js,NewCommitmentsvue_type_template_id_0917ae40_scoped_true_render,NewCommitmentsvue_type_template_id_0917ae40_scoped_true_staticRenderFns,!1,null,"0917ae40",null)
/* harmony default export */,NewCommitments=NewCommitments_component.exports,NewEscalationsvue_type_template_id_7e651be2_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{style:_vm.containerHeight},[_c("div",{staticClass:"section-header new-escalation-section-header",attrs:{id:"escalation-header"}},[_vm._v(" "+_vm._s(_vm.$t("setup.setupLabel.escalations"))+" ")]),_c("div",{staticClass:"p50 pT0 pR70 pB50"},[_c("div",[_c("p",{staticClass:"fc-sub-title-desc"},[_vm._v(" "+_vm._s(_vm.$t("setup.setupLabel.sla_new_escalation_header_desc"))+" ")])]),_vm._l(_vm.escalations,(function(escalation,index){return[_c("el-form",{key:"escalation-form-"+index,staticClass:"mB40",attrs:{model:escalation,rules:_vm.rules,"label-width":"180px","label-position":"left"}},[_c("el-row",{staticClass:"mB15"},[_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"entity-type-header"},[_vm._v(" "+_vm._s(_vm.getEntityName(escalation.slaEntityId))+" ")])]),_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"f13 fR pointer",staticStyle:{color:"#3ab2c1"},on:{click:function($event){return _vm.addLevel(escalation)}}},[_c("inline-svg",{staticClass:"vertical-middle fill-greeny-blue",staticStyle:{height:"18px",width:"18px","margin-right":"4px"},attrs:{src:"svgs/plus-button"}}),_vm._v(" "+_vm._s(_vm.$t("setup.add.add_escalation"))+" ")],1)])],1),_c("el-table",{staticClass:"mB10",staticStyle:{width:"100%"},attrs:{data:escalation.levels,"empty-text":_vm.$t("setup.empty.empty_escalations"),border:""}},[_c("el-table-column",{attrs:{label:"Escalation Level",width:"220"},scopedSlots:_vm._u([{key:"default",fn:function(ref){var $index=ref.$index;return[_c("div",{staticClass:"pL20",on:{click:function($event){return _vm.editLevel(escalation,$index)}}},[_vm._v(" Level "+_vm._s($index+1)+" ")])]}}],null,!0)}),_c("el-table-column",{attrs:{label:_vm.$t("setup.setupLabel.escalations_point"),width:"210"},scopedSlots:_vm._u([{key:"default",fn:function(ref){var row=ref.row;return[_c("div",{staticClass:"pL20"},[_vm._v(" "+_vm._s(_vm.getEscalationPoint(row,_vm.getEntityName(escalation.slaEntityId)))+" ")])]}}],null,!0)}),_c("el-table-column",{attrs:{label:"Actions"},scopedSlots:_vm._u([{key:"default",fn:function(ref){var row=ref.row,$index=ref.$index;return[_c("div",{staticClass:"d-flex pL20"},[_vm.$validation.isEmpty(_vm.getEscalationActions(row))?_c("div",[_vm._v("No actions configured.")]):_vm._l(_vm.getEscalationActions(row),(function(action,index){return _c("div",{key:action,staticClass:"action-badge",class:{mL5:index>0}},[_vm._v(" "+_vm._s(action)+" ")])})),_c("div",{staticClass:"flex-middle mL-auto mR20 actions"},[_c("div",{staticStyle:{height:"14px"},on:{click:function($event){return _vm.editLevel(escalation,$index)}}},[_c("inline-svg",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"bottom",arrow:!0},expression:"{ placement: 'bottom', arrow: true }"}],staticClass:"edit-icon-color mR20",attrs:{src:"svgs/edit",iconClass:"icon icon-sm icon-edit",title:"Edit Escalation"}})],1),_c("div",{staticStyle:{height:"14px"},on:{click:function($event){return _vm.removeLevel(escalation,$index)}}},[_c("inline-svg",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"bottom",arrow:!0},expression:"{ placement: 'bottom', arrow: true }"}],key:"delete-level-"+$index,staticClass:"f-delete",attrs:{src:"svgs/delete",iconClass:"icon icon-sm icon-remove",title:"Remove Escalation"}})],1)])],2)]}}],null,!0)})],1)],1),_vm._l(escalation.levels,(function(level,index){return _c("NewEscalationLevel",{key:escalation.slaEntityId+"_"+index,ref:escalation.slaEntityId+"_"+index,refInFor:!0,attrs:{visibility:level.showPopup,entityId:escalation.slaEntityId,entityName:_vm.getEntityName(escalation.slaEntityId),level:level,position:index,onSave:function(levelObj){return _vm.handleLevelUpdate(escalation.slaEntityId,index,levelObj)},onClose:function(){return level.showPopup=!1}}})}))]}))],2)])},NewEscalationsvue_type_template_id_7e651be2_scoped_true_staticRenderFns=[],NewEscalationLevelvue_type_template_id_98d332f6_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("el-dialog",{staticStyle:{"z-index":"1999"},attrs:{visible:_vm.visibility,fullscreen:!0,"append-to-body":!0,"before-close":_vm.close,"custom-class":"fc-dialog-form fc-dialog-right custom-rule-dialog setup-dialog40 setup-dialog"}},[_c("el-form",{ref:"new-sla-escalation",attrs:{model:_vm.levelObj,rules:_vm.rules,"label-position":"top"}},[_c("div",{staticClass:"new-header-container mR30 pL30"},[_c("div",{staticClass:"new-header-modal"},[_c("div",{staticClass:"new-header-text"},[_c("div",{staticClass:"setup-modal-title"},[_vm._v(" Level "+_vm._s(_vm.position+1)+" Escalation ")])])])]),_c("div",{staticClass:"new-body-modal new-escalation-level"},[_c("el-row",{staticClass:"mB10"},[_c("el-col",{attrs:{span:20}},[_c("label",{staticClass:"newescaltion-level-title"},[_vm._v(" "+_vm._s(_vm.$t("setup.setupLabel.new_edit_escalations_point",{entityName:_vm.entityName}))+" "),1===_vm.supportedTypes.length?_c("span",[_vm._v(_vm._s(_vm.$t("setup.setupLabel.after")))]):_vm._e()])])],1),_c("el-row",{staticClass:"mB20",attrs:{gutter:10}},[_vm.supportedTypes.length>1?_c("el-col",{attrs:{span:10}},[_c("el-form-item",{attrs:{prop:"type"}},[_c("el-select",{staticClass:"fc-input-full-border-select2 width100",model:{value:_vm.levelObj.type,callback:function($$v){_vm.$set(_vm.levelObj,"type",$$v)},expression:"levelObj.type"}},_vm._l(_vm.supportedTypes,(function(item){return _c("el-option",{key:item.id,attrs:{label:item.name,value:item.id}})})),1)],1)],1):_vm._e(),2!==_vm.levelObj.type?_c("el-col",{attrs:{span:8}},[_c("DurationField",{staticClass:"mL-auto width300px",on:{change:function(duration){return _vm.levelObj.interval=duration}},model:{value:_vm.levelObj.interval,callback:function($$v){_vm.$set(_vm.levelObj,"interval",$$v)},expression:"levelObj.interval"}})],1):_vm._e()],1),_c("el-row",{staticClass:"mB10"},[_c("el-col",{attrs:{span:12}},[_c("label",{staticClass:"newescaltion-level-title"},[_vm._v(_vm._s(_vm.$t("rule.create.actions")))]),_c("div",{staticClass:"fc-sub-title-desc"},[_vm._v(" "+_vm._s(_vm.$t("setup.setupLabel.escalations_point_actions"))+" ")])]),_c("el-col",{attrs:{span:12}},[_c("el-dropdown",{staticClass:"fR pointer",attrs:{"hide-on-click":"",trigger:"click"},on:{command:_vm.addAction}},[_c("div",{staticClass:"f13 mT10",staticStyle:{color:"#3ab2c1"}},[_c("inline-svg",{staticClass:"pointer vertical-middle fill-greeny-blue",staticStyle:{height:"18px",width:"18px","margin-right":"4px"},attrs:{src:"svgs/plus-button"}}),_vm._v(" Add Action ")],1),_c("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},_vm._l(_vm.supportedActions,(function(action,index){return _c("el-dropdown-item",{key:"actiontype-"+index,attrs:{command:_vm.actionsHash[action].actionParam}},[_vm._v(" "+_vm._s(_vm.actionsHash[action]&&_vm.actionsHash[action].label)+" ")])})),1)],1)],1)],1),_vm.isEmailConfi?_c("el-row",{staticClass:"action-row"},[_c("el-col",{attrs:{span:12}},[_c("p",{staticClass:"details-Heading"},[_vm._v("Send Email")])]),_c("el-col",{staticClass:"pT4 text-right",attrs:{span:12}},[_c("span",{staticClass:"configured-green"},[_vm._v("Configured")]),_vm.isEmailConfi?_c("span",{staticClass:"mL20 action-edit-section"},[_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-edit pointer",attrs:{title:"Edit Mail"},on:{click:function($event){return _vm.editAction(_vm.emailContext)}}}),_c("span",{staticClass:"mL20 reset-txt pointer",on:{click:function($event){return _vm.reset("mail")}}},[_vm._v(" "+_vm._s(_vm.$t("setup.setupLabel.reset"))+" ")])]):_vm._e()])],1):_vm._e(),_vm.isSmsConfi?_c("el-row",{staticClass:"action-row"},[_c("el-col",{attrs:{span:12}},[_c("p",{staticClass:"details-Heading"},[_vm._v("Send SMS")])]),_c("el-col",{staticClass:"pT4 text-right",attrs:{span:12}},[_c("span",{staticClass:"configured-green"},[_vm._v("Configured")]),_vm.isSmsConfi?_c("span",{staticClass:"mL20 action-edit-section"},[_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-edit pointer",attrs:{title:"Edit Sms"},on:{click:function($event){return _vm.editAction(_vm.smsContent)}}}),_c("span",{staticClass:"mL20 reset-txt pointer",on:{click:function($event){return _vm.reset("sms")}}},[_vm._v(_vm._s(_vm.$t("setup.setupLabel.reset")))])]):_vm._e()])],1):_vm._e(),_vm.isMobileConfig?_c("el-row",{staticClass:"action-row"},[_c("el-col",{attrs:{span:12}},[_c("p",{staticClass:"details-Heading"},[_vm._v("Send Mobile Notification")])]),_c("el-col",{staticClass:"pT4 text-right",attrs:{span:12}},[_c("span",{staticClass:"configured-green"},[_vm._v("Configured")]),_vm.isMobileConfig?_c("span",{staticClass:"mL20 action-edit-section"},[_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-edit pointer",attrs:{title:"Edit Mobile"},on:{click:function($event){return _vm.editAction(_vm.mobileContent)}}}),_c("span",{staticClass:"mL20 reset-txt pointer",on:{click:function($event){return _vm.reset("mobile")}}},[_vm._v(_vm._s(_vm.$t("setup.setupLabel.reset")))])]):_vm._e()])],1):_vm._e(),_vm.isFieldConfi?_c("el-row",{staticClass:"action-row"},[_c("el-col",{attrs:{span:12}},[_c("p",{staticClass:"details-Heading"},[_vm._v("Field Update")])]),_c("el-col",{staticClass:"pT4 text-right",attrs:{span:12}},[_c("span",{staticClass:"configured-green"},[_vm._v("Configured")]),_vm.isFieldConfi?_c("span",{staticClass:"mL20 action-edit-section"},[_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-edit pointer",attrs:{title:"Edit Field"},on:{click:function($event){return _vm.editAction(_vm.fieldContext)}}}),_c("span",{staticClass:"mL20 reset-txt pointer",on:{click:function($event){return _vm.reset("fieldChange")}}},[_vm._v(_vm._s(_vm.$t("setup.setupLabel.reset")))])]):_vm._e()])],1):_vm._e(),_vm.isScript?_c("el-row",{staticClass:"action-row"},[_c("el-col",{attrs:{span:12}},[_c("p",{staticClass:"details-Heading"},[_vm._v(" "+_vm._s(_vm.$t("common.profile.execute_script"))+" ")])]),_c("el-col",{staticClass:"pT4 text-right",attrs:{span:12}},[_c("span",{staticClass:"configured-green"},[_vm._v(_vm._s(_vm.$t("common._common.configured")))]),_vm.isScript?_c("span",{staticClass:"mL20 action-edit-section"},[_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-edit pointer",attrs:{title:_vm.$t("agent.edit.edit_script")},on:{click:function($event){return _vm.editAction(_vm.scriptContent)}}}),_c("span",{staticClass:"mL20 reset-txt pointer",on:{click:function($event){return _vm.reset("script")}}},[_vm._v(_vm._s(_vm.$t("setup.setupLabel.reset")))])]):_vm._e()])],1):_vm._e(),_vm.isStatus?_c("el-row",{staticClass:"action-row"},[_c("el-col",{attrs:{span:12}},[_c("p",{staticClass:"details-Heading"},[_vm._v(" "+_vm._s(_vm.$t("common.profile.change_status"))+" ")])]),_c("el-col",{staticClass:"pT4 text-right",attrs:{span:12}},[_c("span",{staticClass:"configured-green"},[_vm._v(_vm._s(_vm.$t("common._common.configured")))]),_vm.isStatus?_c("span",{staticClass:"mL20 action-edit-section"},[_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-edit pointer",attrs:{title:_vm.$t("agent.edit.edit_status")},on:{click:function($event){return _vm.editAction(_vm.statusContent)}}}),_c("span",{staticClass:"mL20 reset-txt pointer",on:{click:function($event){return _vm.reset("changeStatus")}}},[_vm._v(_vm._s(_vm.$t("setup.setupLabel.reset")))])]):_vm._e()])],1):_vm._e()],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel text-uppercase",on:{click:_vm.close}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.isSaving},on:{click:_vm.save}},[_vm._v(_vm._s(_vm.isSaving?_vm.$t("common._common._saving"):_vm.$t("common._common._save")))])],1)])],1),_vm.showScriptDialog?_c("ScriptAction",{attrs:{existingAction:_vm.scriptContent,module:_vm.module},on:{onSave:_vm.actionSave,onClose:function($event){_vm.showScriptDialog=!1}}}):_vm._e(),_vm.showChangeStatusDialog?_c("ChangeStatusDialog",{attrs:{actionObj:_vm.statusContent,moduleId:_vm.moduleId,moduleName:_vm.module},on:{onSave:_vm.actionSave,onClose:function($event){_vm.showChangeStatusDialog=!1}}}):_vm._e(),_c("send-notification",{ref:"notificationpage",staticClass:"ruleDialog",attrs:{visibility:_vm.actionEdit,mode:_vm.actionMode,option:_vm.actionData,module:_vm.module},on:{onsave:_vm.actionSave,"update:visibility":function($event){_vm.actionEdit=$event},"update:mode":function($event){_vm.actionMode=$event},"update:option":function($event){_vm.actionData=$event}}}),_vm.fieldUpdateValue?_c("field-update-dialog",{attrs:{statusFieldName:_vm.statusFieldName,fieldChange:_vm.fieldChange,moduleFields:_vm.moduleFields,module:_vm.module,picklistOptions:_vm.picklistOptions,addRow:_vm.addRow,actionSave:_vm.actionSave,fieldUpdateValue:_vm.fieldUpdateValue},on:{"update:fieldUpdateValue":function($event){_vm.fieldUpdateValue=$event},"update:field-update-value":function($event){_vm.fieldUpdateValue=$event}}}):_vm._e()],1)},NewEscalationLevelvue_type_template_id_98d332f6_scoped_true_staticRenderFns=[],createForOfIteratorHelper=__webpack_require__(566347),toConsumableArray=__webpack_require__(488478),vuex_esm=(__webpack_require__(339772),__webpack_require__(648324),__webpack_require__(420629)),FieldUpdateDialog=__webpack_require__(634559),SendNotification=__webpack_require__(617650),picklist=__webpack_require__(961358),StatusUpdate=__webpack_require__(292974),ScriptActionvue_type_template_id_17eb89aa_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"fieldchange-Dialog pB15 fc-dialog-center-container fc-dialog-center-body-p0",attrs:{visible:!0,width:"60%",title:_vm.$t("agent.edit.script"),"append-to-body":!0,"before-close":_vm.close}},[_c("div",{staticClass:"height350 overflow-y-scroll pB50"},[_c("code-mirror",{attrs:{codeeditor:!0},model:{value:_vm.workflowString,callback:function($$v){_vm.workflowString=$$v},expression:"workflowString"}})],1),_c("div",{staticClass:"modal-dialog-footer",staticStyle:{"z-index":"900"}},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.close}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:_vm.save}},[_vm._v(" "+_vm._s(_vm.$t("common._common._save"))+" ")])],1)])},ScriptActionvue_type_template_id_17eb89aa_staticRenderFns=[],CodeMirror=(__webpack_require__(952003),__webpack_require__(68518),__webpack_require__(113440),__webpack_require__(212826),__webpack_require__(919324)),ScriptActionvue_type_script_lang_js={props:["module","existingAction"],components:{CodeMirror:CodeMirror/* default */.Z},data:function(){return{workflowString:""}},created:function(){(0,validation/* isEmpty */.xb)(this.existingAction)||this.init()},methods:{init:function(){var _ref=this.existingAction||{},templateJson=_ref.templateJson,_ref2=templateJson||{},resultWorkflowContext=_ref2.resultWorkflowContext,_ref3=resultWorkflowContext||{},workflowV2String=_ref3.workflowV2String;this.workflowString=this.getScriptWorkflow(workflowV2String)},getScriptWorkflow:function(workflowV2String){return workflowV2String?workflowV2String.replace("void scriptFunc(Map "+this.module+") {\n","").replace(new RegExp("\n}$"),""):null},close:function(){this.$emit("onClose")},save:function(){var scriptData={actionType:21,templateJson:{resultWorkflowContext:{workflowV2String:null,isV2Script:!0}}},workflowV2String="void scriptFunc(Map "+this.module+") {\n"+this.workflowString+"\n}";this.$set(scriptData.templateJson.resultWorkflowContext,"workflowV2String",workflowV2String),this.$emit("onSave",scriptData)}}},components_ScriptActionvue_type_script_lang_js=ScriptActionvue_type_script_lang_js,ScriptAction_component=(0,componentNormalizer/* default */.Z)(components_ScriptActionvue_type_script_lang_js,ScriptActionvue_type_template_id_17eb89aa_render,ScriptActionvue_type_template_id_17eb89aa_staticRenderFns,!1,null,null,null)
/* harmony default export */,ScriptAction=ScriptAction_component.exports,actionsHash={email:{label:"Send Email",actionParam:"mail"},sms:{label:"Send SMS",actionParam:"sms"},mobile:{label:"Send Mobile Notification",actionParam:"mobile"},fieldUpdate:{label:"Field Update",actionParam:"fieldChange"},script:{label:"Exceute Script",actionParam:"script"},changeStatus:{label:"Change Status",actionParam:"changeStatus"}},NewEscalationLevelvue_type_script_lang_js={name:"NewEscalationLevel",props:["visibility","onClose","onSave","position","level","entityId","entityName"],components:{DurationField:SLADurationField,SendNotification:SendNotification/* default */.Z,FieldUpdateDialog:FieldUpdateDialog/* default */.Z,ChangeStatusDialog:StatusUpdate/* default */.Z,ScriptAction:ScriptAction},data:function(){return{levelObj:{type:1,interval:0,actions:[]},scriptContent:"",statusContent:{actionType:19,templateJson:{new_state:null}},rules:{},showScriptDialog:!1,showChangeStatusDialog:!1,actionsHash:actionsHash,isSaving:!1,isEmailConfi:!1,isSmsConfi:!1,isMobileConfig:!1,isFieldConfi:!1,isScript:!1,isStatus:!1,mobileContent:"",emailContext:"",fieldContext:"",moduleId:null,smsContent:"",actionMode:"mail",actionEdit:!1,actionIndex:null,actionData:null,fieldUpdateValue:!1,fieldChange:{actionType:13,templateJson:{fieldMatcher:[]}},assets:null,categoryMetric:null,picklistOptions:{},moduleFields:[]}},created:function(){var _this=this;Promise.all([this.$store.dispatch("loadTicketCategory"),this.$store.dispatch("loadTicketPriority"),this.$store.dispatch("loadAssetCategory"),this.$store.dispatch("loadGroups"),this.$store.dispatch("loadTicketStatus",this.module),this.getModuleFields()]).then((function(){return _this.initData(_this.level)}))},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({users:function(state){return state.users},groups:function(state){return state.groups},ticketcategory:function(state){return state.ticketCategory},assetCategory:function(state){return state.assetCategory},ticketpriority:function(state){return state.ticketPriority}})),{},{module:function(){return this.$route.params.moduleName},types:function(){return[{id:1,name:"Before"},{id:2,name:"On ".concat(this.entityName)},{id:3,name:"After"}]},supportedTypes:function(){var _this2=this;return this.types.filter((function(type){var isFirstLevel=0===_this2.position,isBefore=1===type.id,isOnDue=2===type.id;return isFirstLevel?!isBefore:!(isBefore||isOnDue)}))},supportedActions:function(){var actions=["email","mobile","fieldUpdate","script","changeStatus"];return this.$helpers.isLicenseEnabled("SMS")&&actions.push("sms"),actions}}),methods:{initData:function(level){var _this3=this,_ref=level||{},type=_ref.type,interval=_ref.interval,actions=this.$getProperty(level,"actions",[])||[];["mail","sms","mobile","fieldChange","script","changeStatus"].forEach(this.reset),(0,validation/* isEmpty */.xb)(actions)||actions.forEach((function(action){if(3===parseInt(action.actionType))_this3.isEmailConfi=!0,_this3.emailContext=action;else if(4===parseInt(action.actionType))_this3.isSmsConfi=!0,_this3.smsContent=action;else if(7===parseInt(action.actionType))_this3.isMobileConfig=!0,_this3.mobileContent=action;else if(13===parseInt(action.actionType)){_this3.isFieldConfi=!0;var index=0;if(!(0,validation/* isEmpty */.xb)(action.template)){var originalTemplate=action.template.originalTemplate,_loop=function(key){if(_this3.addRow(),originalTemplate.hasOwnProperty(key)){var fieldMatcher=_this3.fieldChange.templateJson.fieldMatcher[index],field=_this3.moduleFields.filter((function(field){return field.name===key}));!(0,validation/* isEmpty */.xb)(field)&&_this3.setFieldMatcher(fieldMatcher,field,key,originalTemplate),_this3.statusFieldName(fieldMatcher,index),index++}};for(var key in originalTemplate)_loop(key);_this3.fieldContext=action}}else 21===parseInt(action.actionType)?(_this3.isScript=!0,_this3.scriptContent=action):19===parseInt(action.actionType)&&(_this3.isStatus=!0,_this3.statusContent=action)})),this.levelObj={type:type||3,interval:interval||0,actions:(0,validation/* isEmpty */.xb)(actions)?[]:actions}},serialize:function(){var _clone=clone_default()(this.levelObj),type=_clone.type,interval=_clone.interval,_clone$actions=_clone.actions,actions=void 0===_clone$actions?[]:_clone$actions;2===type&&(interval=0);var newActions=actions.filter((function(action){return!(0,validation/* isEmpty */.xb)(action.templateJson)})).map((function(action){return{actionType:action.actionType,templateJson:action.templateJson}})),savedActions=actions.filter((function(action){return(0,validation/* isEmpty */.xb)(action.templateJson)})),serializedActions=this.updateAction(savedActions||[]);return{type:type,interval:interval,actions:[].concat((0,toConsumableArray/* default */.Z)(newActions),(0,toConsumableArray/* default */.Z)(serializedActions))}},save:function(){this.onSave(this.serialize())},close:function(){this.onClose()},addAction:function(cmd){this.actionMode=cmd,this.actionData=null,"workorder"!==cmd&&"fieldChange"!==cmd&&"controls"!==cmd&&"script"!==cmd&&"changeStatus"!=cmd?this.actionEdit=!0:"fieldChange"===cmd?(this.fieldUpdateValue=!0,this.$getProperty(this.fieldChange,"templateJson.fieldMatcher.length",0)<=0&&this.addRow()):"script"===cmd?this.showScriptDialog=!0:"changeStatus"===cmd&&(this.showChangeStatusDialog=!0)},editAction:function(action){this.actionData=action,3===action.actionType?(this.actionMode="mail",this.isEmailConfi=!0,this.actionEdit=!0):4===action.actionType?(this.actionMode="sms",this.isSmsConfi=!0,this.actionEdit=!0):7===action.actionType?(this.actionMode="mobile",this.isMobileConfig=!0,this.actionEdit=!0):13===action.actionType?(this.isFieldConfi=!0,this.fieldUpdateValue=!0,this.actionMode="fieldChange"):21===parseInt(action.actionType)?(this.showScriptDialog=!0,this.actionMode="script"):19===parseInt(action.actionType)&&(this.showChangeStatusDialog=!0,this.actionMode="changeStatus")},deleteAction:function(idx){var actions=this.$getProperty(this,"levelObj.actions",[])||[];actions.splice(idx,1),this.$set(this.levelObj,"actions",actions)},actionSave:function(dataObj){var data=this.$helpers.cloneObject(dataObj),actions=this.$getProperty(this,"levelObj.actions",[])||[],index=actions.findIndex((function(d){return d.actionType===data.actionType}));-1!==index&&actions.splice(index,1),3===data.actionType?(this.isEmailConfi=!0,this.emailContext=data):4===data.actionType?(this.isSmsConfi=!0,this.smsContent=data):7===data.actionType?(this.isMobileConfig=!0,this.formatMobileData(data.templateJson),this.mobileContent=data):13===data.actionType?(this.fieldUpdateValue=!1,this.fieldContext=data,this.isFieldConfi=!0):21===data.actionType?(this.showScriptDialog=!1,this.scriptContent=data,this.isScript=!0):19===data.actionType&&(this.showChangeStatusDialog=!1,this.statusContent=data,this.isStatus=!0),this.addModuleParam(data),actions.push(data),this.actionEdit=!1},reset:function(action){var actions=this.$getProperty(this,"levelObj.actions",[])||[];if("sms"===action){var idx=actions.findIndex((function(d){return 4===d.actionType}));actions.splice(idx,1),this.smsContent="",this.isSmsConfi=!1}else if("mail"===action){var _idx=actions.findIndex((function(d){return 3===d.actionType}));actions.splice(_idx,1),this.emailContext="",this.isEmailConfi=!1}else if("mobile"===action){var _idx2=actions.findIndex((function(d){return 7===d.actionType}));actions.splice(_idx2,1),this.mobileContent="",this.isMobileConfig=!1}else if("fieldChange"===action){var _idx3=actions.findIndex((function(d){return 13===d.actionType}));actions.splice(_idx3,1),this.isFieldConfi=!1}else if("script"===action){var _idx4=actions.findIndex((function(d){return 21===d.actionType}));actions.splice(_idx4,1),this.scriptContent="",this.isScript=!1}else if("changeStatus"===action){var _idx5=actions.findIndex((function(d){return 19===d.actionType}));actions.splice(_idx5,1),this.statusContent=null,this.isStatus=!1}},formatMobileData:function(data){var summaryPage=this.module.toUpperCase()+"_SUMMARY",message={content_available:!0,summary_id:"${"+this.module+".id}",sound:"default",module_name:this.module,priority:"high",text:data.message,click_action:summaryPage,title:data.subject};data.body=JSON.stringify({name:this.module.toUpperCase()+"_PUSH_NOTIFICATION",notification:message,data:message,id:data.id}),data.to=data.id,this.$common.setExpressionFromPlaceHolder(data.workflow,"${"+this.module+".id}")},addModuleParam:function(template){var _this4=this,workflowParameters=this.$getProperty(template,"templateJson.workflow.parameters"),ftl=this.$getProperty(template,"templateJson.ftl");ftl&&workflowParameters&&!workflowParameters.some((function(param){return param.name===_this4.module}))&&template.templateJson.workflow.parameters.push({name:this.module,typeString:"String"})},updateAction:function(actions){var _this5=this,newlist=[];return actions.filter((function(action){return 5!==action.actionType})).forEach((function(action){var template;if(3===action.actionType)template=_this5.$refs.notificationpage.getDataToSave(_this5.emailContext,"mail");else if(4===action.actionType)template=_this5.$refs.notificationpage.getDataToSave(_this5.smsContent,"sms");else if(7===action.actionType){var data=_this5.$refs.notificationpage.getDataToSave(_this5.mobileContent,"mobile");_this5.formatMobileData(data.templateJson),template=data}else 13===action.actionType?template=_this5.fieldChange:21===action.actionType?template={actionType:action.actionType,templateJson:action.templateJson}:19===action.actionType&&(template=action);_this5.addModuleParam(template),newlist.push(template||action)})),newlist},setFieldMatcher:function(fieldMatcher,field,key,originalTemplate){fieldMatcher.field=key,fieldMatcher.value=originalTemplate[key],"LOOKUP"===field[0].dataTypeEnum._name?(0,validation/* isEmpty */.xb)(originalTemplate[key].id)?(fieldMatcher.valueArray=originalTemplate[key],fieldMatcher.value=originalTemplate[key]):(fieldMatcher.valueArray=originalTemplate[key].id,fieldMatcher.value.id=originalTemplate[key].id):"DATE_TIME"!==field[0].dataTypeEnum._name&&"DATE"!==field[0].dataTypeEnum._name||(fieldMatcher.dateObject=this.$helpers.secTodaysHoursMinu(originalTemplate[key]/1e3)),fieldMatcher.fieldObj=field},statusFieldName:function(selectedField,index){var field=this.moduleFields.filter((function(field){return field.name===selectedField.field})),fieldMatcher=this.fieldChange.templateJson.fieldMatcher[index];if(fieldMatcher.fieldObj=field,fieldMatcher.isSpacePicker=!1,!(0,validation/* isEmpty */.xb)(field))if(fieldMatcher.columnName=field[0].completeColumnName,"ENUM"===field[0].dataTypeEnum._name&&this.$set(this.picklistOptions,field[0].name,field[0].enumMap),"LOOKUP"===field[0].dataTypeEnum._name&&field[0].specialType)this.loadSpecialTypePickList(field[0].specialType,field[0].name);else if("LOOKUP"===field[0].dataTypeEnum._name&&field[0].lookupModule)if("ticketpriority"===field[0].lookupModule.name){
// handling key value pair to match existing flow pattern
var priority={};this.ticketpriority.forEach((function(d){priority[d.id]=d.displayName})),this.$set(this.picklistOptions,field[0].name,priority)}else this.loadPickList(field[0].lookupModule.name,field[0].name)},loadPickList:function(moduleName,fieldName){var _this6=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var _yield$getFieldOption,error,options;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _this6.picklistOptions={},_context.next=3,(0,picklist/* getFieldOptions */._K)({field:{lookupModuleName:moduleName,skipDeserialize:!0}});case 3:_yield$getFieldOption=_context.sent,error=_yield$getFieldOption.error,options=_yield$getFieldOption.options,error?_this6.$message.error(error.message||"Error Occured"):_this6.$set(_this6.picklistOptions,fieldName,options);case 7:case"end":return _context.stop()}}),_callee)})))()},loadSpecialTypePickList:function(specialType,fieldName){var pickOption={};if("users"===specialType){var userList=this.$store.state.users;pickOption["${LOGGED_USER}"]="Current User";var _step,_iterator=(0,createForOfIteratorHelper/* default */.Z)(userList);try{for(_iterator.s();!(_step=_iterator.n()).done;){var user=_step.value;pickOption[user.id]=user.name}}catch(err){_iterator.e(err)}finally{_iterator.f()}this.$set(this.picklistOptions,fieldName,pickOption)}else if("groups"===specialType){var _step2,groupList=this.$store.state.groups,_iterator2=(0,createForOfIteratorHelper/* default */.Z)(groupList);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var group=_step2.value;pickOption[group.groupId]=group.name}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}this.$set(this.picklistOptions,fieldName,pickOption)}else"alarmType"===specialType?this.$set(this.picklistOptions,fieldName,this.$constants.AlarmCategory):"sourceType"===specialType&&this.$set(this.picklistOptions,fieldName,this.$constants.SourceType)},addRow:function(){this.$getProperty(this.fieldChange,"templateJson.fieldMatcher",[]).push({field:"",isSpacePicker:!1,value:null,parseLabel:null,valueArray:null,dateObject:{},fieldObj:null})},getModuleFields:function(){var _this7=this;return this.$http.get("/module/metafields?moduleName=".concat(this.module)).then((function(response){_this7.moduleFields=_this7.$getProperty(response,"data.meta.fields",[]),_this7.moduleId=_this7.$getProperty(response,"data.meta.module.moduleId",null)})).catch((function(){}))}}},components_NewEscalationLevelvue_type_script_lang_js=NewEscalationLevelvue_type_script_lang_js,NewEscalationLevel_component=(0,componentNormalizer/* default */.Z)(components_NewEscalationLevelvue_type_script_lang_js,NewEscalationLevelvue_type_template_id_98d332f6_scoped_true_render,NewEscalationLevelvue_type_template_id_98d332f6_scoped_true_staticRenderFns,!1,null,"98d332f6",null)
/* harmony default export */,NewEscalationLevel=NewEscalationLevel_component.exports,intervalTypes=[{id:1,name:"Before"},{id:2,name:"On"},{id:3,name:"After"}],NewEscalationsvue_type_script_lang_js={name:"NewEscalations",props:{policy:{type:Object},entities:{type:Array}},components:{NewEscalationLevel:NewEscalationLevel},data:function(){return{escalations:[],rules:{},intervalTypes:intervalTypes,showLevelPopup:!1,canWatchForChanges:!1}},computed:{isNew:function(){return(0,validation/* isEmpty */.xb)(this.$route.params.id)},policyId:function(){return this.$route.params.id},module:function(){return this.$route.params.moduleName},slaPolicy:function(){return this.sharedData.slaPolicy},levelObj:function(){return{type:null,interval:null,actions:[],showPopup:!1}},containerHeight:function(){var root=document.querySelector(".scroll-container"),height=root.offsetHeight||370;return{"min-height":height-60+"px"}}},watch:{policy:{handler:function(){this.init()},immediate:!0},escalations:{handler:function(){this.canWatchForChanges&&this.$emit("modified")},deep:!0}},methods:{init:function(){var _this=this;this.isNew?this.createEscalations():(this.deserialize(cloneDeep_default()(this.policy.escalations)),(0,validation/* isEmpty */.xb)(this.escalations)&&this.createEscalations()),this.$nextTick((function(){return _this.canWatchForChanges=!0}))},serialize:function(){var _this2=this,escalations=cloneDeep_default()(this.escalations);return escalations.map((function(escalation){var levels=(escalation.levels||[]).map((function(level,index){var EscalationPopup=_this2.$refs[escalation.slaEntityId+"_"+index][0];
// EscalationPopup.initData(level)
return EscalationPopup.serialize()}));return levels.filter((function(level){return!(0,validation/* isEmpty */.xb)(level.type)})).forEach((function(level,index){
// Serialize level intervals to be successive ie. current value plus sum of all previous vaues
0!==index&&(level.interval=level.interval+levels[index-1].interval)})),{slaEntityId:escalation.slaEntityId,levels:levels}})).filter((function(escalation){return!(0,validation/* isEmpty */.xb)(escalation.levels)}))},deserialize:function(escalationsList){escalationsList=escalationsList||[],this.entities.forEach((function(_ref){var id=_ref.id,hasEntity=!(0,validation/* isEmpty */.xb)((escalationsList||[]).find((function(e){return e.slaEntityId===id})));hasEntity||escalationsList.push({slaEntityId:id,levels:[]})})),escalationsList.forEach((function(_ref2){var levels=_ref2.levels,_levels=cloneDeep_default()(levels);levels.forEach((function(level,index){0!==index&&(
// Deserialize level intervals to be successive ie. reduce value from sum of all previous values.
level.interval=level.interval-_levels[index-1].interval),level.showPopup=!1}))})),this.escalations=escalationsList},createEscalations:function(){this.escalations=this.entities.map((function(entity){return{slaEntityId:entity.id,levels:[]}}))},handleLevelUpdate:function(entityId,position,level){var escalation=this.escalations.find((function(_ref3){var slaEntityId=_ref3.slaEntityId;return slaEntityId===entityId}));this.$set(escalation.levels,position,level)},addLevel:function(escalation){var levelObj=this.levelObj,level=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},cloneDeep_default()(levelObj)),{},{showPopup:!0});this.handleLevelUpdate(escalation.slaEntityId,escalation.levels.length,level)},editLevel:function(escalation,position){this.$set(escalation.levels[position],"showPopup",!0)},removeLevel:function(escalation,index){var levels=escalation.levels;levels.splice(index,1),this.$set(escalation,"levels",levels)},getEntityName:function(id){var entity=this.entities.find((function(e){return e.id===id}))||{};return entity.name||""},getEscalationPoint:function(row,entityName){if((0,validation/* isEmpty */.xb)(row.type))return"Not Configured";if(2===row.type)return"On ".concat(entityName);var _intervalTypes=this.intervalTypes,intervalType=_intervalTypes.find((function(_ref4){var id=_ref4.id;return row.type===id}))||{},_this$$helpers$getDur=this.$helpers.getDuration(row.interval,"seconds",1),_this$$helpers$getDur2=_this$$helpers$getDur.Days,Days=void 0===_this$$helpers$getDur2?0:_this$$helpers$getDur2,_this$$helpers$getDur3=_this$$helpers$getDur.Hrs,Hrs=void 0===_this$$helpers$getDur3?0:_this$$helpers$getDur3,_this$$helpers$getDur4=_this$$helpers$getDur.Mins,Mins=void 0===_this$$helpers$getDur4?0:_this$$helpers$getDur4,interval=0===Days?0===Mins?Hrs:Mins:Days,unit=0===Days?0===Mins?"hour(s)":"minute(s)":"day(s)";return"".concat(intervalType.name," ").concat(interval," ").concat(unit)},getEscalationActions:function(row){var actions=row.actions||[],configuredActions=[];return actions.forEach((function(action){3===parseInt(action.actionType)?configuredActions.push("Email"):4===parseInt(action.actionType)?configuredActions.push("SMS"):7===parseInt(action.actionType)?configuredActions.push("Notify"):13===parseInt(action.actionType)?configuredActions.push("Field"):21===parseInt(action.actionType)?configuredActions.push("Script"):19===parseInt(action.actionType)&&configuredActions.push("Change Status")})),configuredActions}}},new_NewEscalationsvue_type_script_lang_js=NewEscalationsvue_type_script_lang_js,NewEscalations_component=(0,componentNormalizer/* default */.Z)(new_NewEscalationsvue_type_script_lang_js,NewEscalationsvue_type_template_id_7e651be2_scoped_true_render,NewEscalationsvue_type_template_id_7e651be2_scoped_true_staticRenderFns,!1,null,"7e651be2",null)
/* harmony default export */,NewEscalations=NewEscalations_component.exports,SidebarScrollMixin=__webpack_require__(565476),NewSLAvue_type_script_lang_js={name:"New-SLA",props:["id","moduleName"],mixins:[SidebarScrollMixin/* default */.Z],components:{NewPolicy:NewPolicy,NewCommitments:NewCommitments,NewEscalations:NewEscalations,AsyncButton:AsyncButton/* default */.Z},created:function(){var _this=this,$store=this.$store;Promise.all([$store.dispatch("loadSites"),this.fetchPolicyDetails(),this.fetchSLAEntities()]).then((function(){_this.isNew||(_this.policyTitle=_this.slaPolicy.name)})).finally((function(){_this.isLoading=!1,_this.$nextTick(_this.registerScrollHandler)}))},data:function(){return{isLoading:!0,hasChanged:!1,slaPolicy:null,policyTitle:"SLA Policy",entities:[],rootElementForScroll:".scroll-container",sidebarElements:["#policy-link","#commitment-link","#escalation-link"],sectionElements:["#policy-section","#commitment-section","#escalation-section"]}},computed:{isNew:function(){return(0,validation/* isEmpty */.xb)(this.id)}},methods:{fetchSLAEntities:function(){var _this2=this;return this.$http.post("v2/slaEntity/list",{moduleName:this.moduleName}).then((function(_ref){var data=_ref.data;0===data.responseCode&&(_this2.entities=data.result.slaEntityList||[])}))},fetchPolicyDetails:function(){var _this3=this;return this.id?http/* default */.ZP.post("v2/slaPolicy/getWithChildren",{slaPolicyId:this.id}).then((function(_ref2){var data=_ref2.data;if(0!==data.responseCode)throw new Error;_this3.slaPolicy=data.result.slaPolicy})).catch((function(){_this3.$message.error("Could not load SLA Policy")})):Promise.resolve()},save:function(){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var valid,policy,commitments,escalations;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.next=2,_this4.validate();case 2:if(valid=_context.sent,valid){_context.next=5;break}return _context.abrupt("return");case 5:return policy=_this4.$refs["policy-section"].serialize(),commitments=_this4.$refs["commitment-section"].serialize(),escalations=_this4.$refs["escalation-section"].serialize(),_context.abrupt("return",http/* default */.ZP.post("v2/slaPolicy/addOrUpdateWithChildren",{moduleName:_this4.moduleName,slaPolicy:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},policy),{},{commitments:commitments,escalations:escalations})}).then((function(_ref3){var data=_ref3.data;if(0!==data.responseCode)throw new Error(data.message||"");_this4.$message.success("SLA Policy saved"),_this4.$nextTick(_this4.goBack)})).catch((function(){var error=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},message=(0,validation/* isEmpty */.xb)(error.message)?"Could not save SLA Policy":error.message;_this4.$message.error(message)})));case 9:case"end":return _context.stop()}}),_callee)})))()},validate:function(){var _this5=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var policyValid;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,_this5.$refs["policy-section"].validation();case 2:return policyValid=_context2.sent,_context2.abrupt("return",policyValid);case 4:case"end":return _context2.stop()}}),_callee2)})))()},goBack:function(){this.$router.push({name:"sla.list",moduleName:this.moduleName})},markAsModified:function(){
/* Should decide whether to allow save based on this property
       * Currently not used because criteria builder doesn't have a reliable way
       * to tell if it has loaded or not
       */
this.hasChanged=!0}}},sla_NewSLAvue_type_script_lang_js=NewSLAvue_type_script_lang_js,NewSLA_component=(0,componentNormalizer/* default */.Z)(sla_NewSLAvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,NewSLA=NewSLA_component.exports},
/***/565476:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return SidebarScrollMixin}});
// EXTERNAL MODULE: ./node_modules/core-js/modules/es.array.map.js
__webpack_require__(450886),__webpack_require__(260228),__webpack_require__(947522);
// EXTERNAL MODULE: ./node_modules/core-js/modules/es.object.to-string.js
var render,staticRenderFns,vue_scrollto=__webpack_require__(593081),vue_scrollto_default=__webpack_require__.n(vue_scrollto),SidebarScrollMixinvue_type_script_lang_js={beforeDestroy:function(){var root=document.querySelector(this.rootElementForScroll);root&&root.removeEventListener("scroll",this.scrollhandler)},methods:{registerScrollHandler:function(){var root=document.querySelector(this.rootElementForScroll);root&&root.addEventListener("scroll",this.scrollhandler,{passive:!0})},scrollhandler:function(){var highlightSidebarElement=this.highlightSidebarElement,anchorSectionHeader=this.anchorSectionHeader,deAnchorSectionHeader=this.deAnchorSectionHeader,sectionElements=this.sectionElements,elements=sectionElements.map((function(id){return document.querySelector(id)}));window.requestAnimationFrame((function(){elements.forEach((function(el){var _el$getBoundingClient=el.getBoundingClientRect(),top=_el$getBoundingClient.top,sectionName=el.getAttribute("id").split("-")[0];top<153?anchorSectionHeader(sectionName):deAnchorSectionHeader(sectionName),top<400&&highlightSidebarElement(sectionName)}))}))},scrollTo:function(sectionName){var _this=this,onDone=function(){return _this.highlightSidebarElement(sectionName)};vue_scrollto_default().scrollTo("#".concat(sectionName,"-section"),500,{container:".scroll-container",easing:"ease-in",offset:0,force:!0,onDone:onDone})},highlightSidebarElement:function(sectionName){var sidebarElements=this.sidebarElements,elements=sidebarElements.map((function(e){return document.querySelector(e)}));elements.forEach((function(el){el.getAttribute("id")==="".concat(sectionName,"-link")?el.classList.add("active"):el.classList.remove("active")}))},anchorSectionHeader:function(sectionName){var elements=document.querySelectorAll(".section-header");elements.forEach((function(el){el.getAttribute("id")==="".concat(sectionName,"-header")&&el.classList.add("anchor-top")}))},deAnchorSectionHeader:function(sectionName){var elements=document.querySelectorAll(".section-header");elements.forEach((function(el){el.getAttribute("id")==="".concat(sectionName,"-header")&&el.classList.remove("anchor-top")}))}}},mixins_SidebarScrollMixinvue_type_script_lang_js=SidebarScrollMixinvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(mixins_SidebarScrollMixinvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,SidebarScrollMixin=component.exports},
/***/511423:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"b924ed3856bb4e9406aa8f8b4a5913cd.svg";
/***/},
/***/353654:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"d7f1f315aba97cd14240ee6f3d34465f.svg";
/***/},
/***/385769:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"4a9843791f38c4a28fdf9f0a4584780d.svg";
/***/},
/***/581121:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"88cd7135ef1417b08c9498c51d2cda59.svg";
/***/}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/63344.js.map