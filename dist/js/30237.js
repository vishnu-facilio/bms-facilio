"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[30237,32686,80865,53021],{
/***/720096:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return PreviewFile}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/PreviewFile.vue?vue&type=template&id=447c7e89
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.currentFile?_c("div",{directives:[{name:"show",rawName:"v-show",value:_vm.show,expression:"show"}],staticClass:"preview-file"},[_c("div",{staticClass:"top-toolbar"},[_c("div",{staticClass:"a-top-toolbar"},[_c("div",{staticClass:"file-name word-break-keep"},[_vm._v(" "+_vm._s(_vm.currentFile.fileName)+" ")]),_c("div",{staticClass:"top-toolbar-icon-right flex align-center"},[_vm.currentFile.contentType.includes("image")?[_c("div",{staticClass:"flex-middle pL15"},[_vm.showOriginalImage?_c("div",{staticClass:"fc-white-14 word-break-keep pointer",on:{click:_vm.showOriginalPhoto}},[_vm._v(" "+_vm._s(_vm.$t("common._common.view_original"))+" ")]):_vm._e(),_vm.showCompressedImage?_c("div",{staticClass:"fc-white-14 word-break-keep pointer",on:{click:_vm.showCompressedPhoto}},[_vm._v(" "+_vm._s(_vm.$t("common._common.view_default"))+" ")]):_vm._e()]),_c("div",{staticClass:"download-icon round flex-middle pL15",on:{click:function($event){return _vm.downloadAttachment(_vm.currentFile)}}},[_c("i",{staticClass:"el-icon-download op8",staticStyle:{color:"#ffff"}})])]:_vm._e(),_vm.currentFile.contentType.includes("pdf")?[_c("div",{staticClass:"download-icon round flex-middle pL15",on:{click:function($event){return _vm.downloadAttachment(_vm.currentFile)}}},[_c("i",{staticClass:"el-icon-download op8",staticStyle:{color:"#ffff"}})])]:_vm._e(),_vm.showDeleteOption()?_c("div",{staticClass:"flex-middle pL15",on:{click:function($event){return _vm.deletePreview()}}},[_c("inline-svg",{staticClass:"pointer edit-icon-color close vertical-text-top",attrs:{src:"svgs/delete",iconClass:"icon icon-md"}})],1):_vm._e(),_c("div",{staticClass:"pL15"},[_c("i",{staticClass:"el-icon-close close",on:{click:_vm.closePreview}})])],2)])]),_vm.currentFileIndex>0?_c("a",{staticClass:"el-icon-arrow-left prev",staticStyle:{"font-size":"30px"},on:{click:function($event){return _vm.plusSlides(-1)}}}):_vm._e(),_vm.currentFileIndex<_vm.files.length-1?_c("a",{staticClass:"el-icon-arrow-right next",staticStyle:{"font-size":"30px"},on:{click:function($event){return _vm.plusSlides(1)}}}):_vm._e(),_c("div",{staticClass:"preview-content"},[_vm.currentFile.contentType.includes("image")?[_vm.compressedImage?_c("img",{staticClass:"content",staticStyle:{"box-shadow":"none"},attrs:{src:_vm.$prependBaseUrl(_vm.currentFile.previewUrl)}}):_vm.originalImage?_c("img",{staticClass:"content original",staticStyle:{"box-shadow":"none"},attrs:{src:_vm.$prependBaseUrl(_vm.currentFile.previewUrl+"?fetchOriginal=true")}}):_vm._e()]:_vm.currentFile.contentType.includes("pdf")?_c("div",{staticClass:"width100 height-100"},[_c("iframe",{staticClass:"fc-preview-pdf",attrs:{src:_vm.$prependBaseUrl(_vm.currentFile.previewUrl),height:"100%",width:"100%"}})]):_vm.isVideoSupported(_vm.currentFile.contentType)?_c("div",{staticClass:"width100 height-100 fc-preview-video"},[_c("video",{attrs:{controls:""}},[_c("source",{attrs:{src:_vm.$prependBaseUrl(_vm.$getProperty(_vm.currentFile,"downloadUrl",null)),type:_vm.$getProperty(_vm.currentFile,"contentType")}}),_vm._v(" "+_vm._s(_vm.$t("common._common.browser_not_supported"))+" ")])]):_c("div",{staticClass:"no-preview"},[_c("div",{staticClass:"flex justify-center pT24"},[_c("inline-svg",{staticClass:"d-flex",attrs:{src:_vm.getFileIcon(_vm.currentFile),iconClass:"icon icon-60 overlay"}})],1),_c("div",{staticClass:"f14 pT12 pB12"},[_vm._v("No preview available")]),_c("div",{staticClass:"download-button"},[_c("a",{staticClass:"flex flex-row",staticStyle:{color:"#ffff"},on:{click:function($event){return _vm.downloadAttachment(_vm.currentFile)}}},[_c("div",[_vm._v("Download")])])])])],2),_vm.exportDownloadUrl?_c("iframe",{staticStyle:{display:"none"},attrs:{src:_vm.exportDownloadUrl}}):_vm._e()]):_vm._e()},staticRenderFns=[],validation=(__webpack_require__(339772),__webpack_require__(260228),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(228436),__webpack_require__(990260)),PreviewFilevue_type_script_lang_js={props:["previewFile","files","visibility","showDelete","isLockedState","isTaskClosed"],data:function(){return{show:!0,previewUrl:null,currentFileIndex:0,currentFile:null,imageMargin:null,exportDownloadUrl:null,originalImage:!1,compressedImage:!0,showOriginalImage:!0,showCompressedImage:!1}},destroyed:function(){window.removeEventListener("keyup",this.handler)},mounted:function(){window.addEventListener("keyup",this.handler),this.preloadImages()},watch:{},computed:{},methods:{handler:function(){
// If escape key is pressed...
27===event.keyCode?this.closePreview():37===event.keyCode?this.plusSlides(-1):39===event.keyCode&&this.plusSlides(1)},preloadImages:function(){this.currentFile=this.previewFile?this.previewFile:this.files[0],this.currentFileIndex=this.files.indexOf(this.currentFile)},plusSlides:function(n){var index=this.currentFileIndex+n;index<0&&(index=0),index>=this.files.length&&(index=this.files.length-1),this.currentFileIndex=index,this.currentFile=this.files[index]},closePreview:function(){this.$emit("update:visibility",!1)},deletePreview:function(){var currentFile=this.currentFile;this.$emit("onDelete",currentFile)},downloadAttachment:function(file){var _this=this,_ref=file||{},url=_ref.downloadUrl;this.exportDownloadUrl&&(this.exportDownloadUrl=null),this.$nextTick((function(){_this.exportDownloadUrl=url}))},showOriginalPhoto:function(){this.originalImage=!0,this.showCompressedImage=!0,this.showOriginalImage=!1,this.compressedImage=!1},showCompressedPhoto:function(){this.showCompressedImage=!1,this.originalImage=!1,this.showOriginalImage=!0,this.compressedImage=!0},getFileIcon:function(attachment){var contentType=attachment.contentType,FILE_TYPE_ICONS=this.$constants.FILE_TYPE_ICONS,selectedIndex=FILE_TYPE_ICONS.findIndex((function(icons){var fileTypes=icons.fileTypes;return fileTypes.some((function(type){return contentType.includes(type)}))}));return(0,validation/* isEmpty */.xb)(selectedIndex)?FILE_TYPE_ICONS[0].path:FILE_TYPE_ICONS[selectedIndex].path},isVideoSupported:function(contentType){contentType=contentType||"";var supportedTypes=["video/webm","video/mp4","video/ogg"];return supportedTypes.includes(contentType.trim().toLowerCase())},showDeleteOption:function(){var showDelete=this.showDelete,isLockedState=this.isLockedState,isTaskClosed=this.isTaskClosed;return showDelete&&!isLockedState&&!isTaskClosed}}},components_PreviewFilevue_type_script_lang_js=PreviewFilevue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_PreviewFilevue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,PreviewFile=component.exports},
/***/838897:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return ServiceRequestSummary}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/servicerequest/ServiceRequestSummary.vue?vue&type=template&id=35e45730
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"custom-modules-overview overflow-y-scroll width100 service-request-summary",attrs:{"data-testid":"service-request-summary"}},[_vm.isLoading||_vm.$validation.isEmpty(_vm.customModuleData)?_vm._e():_c("div",{staticClass:"header pT10 pB15 pL20 pR20"},[_c("div",{staticClass:"asset-details"},[_c("div",{staticClass:"asset-id mT10"},[_c("i",{directives:[{name:"tippy",rawName:"v-tippy",value:{animateFill:!1,animation:"shift-toward"},expression:"{ animateFill: false, animation: 'shift-toward' }"}],staticClass:"el-icon-back fc-grey3-text14 fw6 pR10 pointer",attrs:{content:"back",arrow:""},on:{click:_vm.routeToList}}),_vm._v(" #"+_vm._s(_vm.customModuleData.id)+" ")]),_c("div",{staticClass:"d-flex flex-middle mT10"},[_vm.modeAllow?_c("div",{staticClass:"flex-shrink-0"},[_c("el-tooltip",{attrs:{effect:"dark",content:_vm.modeTypes[_vm.customModuleData.mode],placement:"top","open-delay":400}},[_c("div",{class:_vm.modeClass(_vm.customModuleData)})])],1):_vm._e(),_c("div",{staticClass:"mL5"},[_c("div",{staticClass:"heading-black22 pT5 mb5 d-flex"},[_vm._v(" "+_vm._s(_vm.customModuleData[_vm.mainFieldKey])+" ")])]),_vm.currentModuleState?_c("div",{staticClass:"fc-badge text-uppercase inline vertical-middle mL15"},[_vm._v(" "+_vm._s(_vm.currentModuleState)+" ")]):_vm._e()])]),_c("div",{staticClass:"d-flex flex-direction-row",staticStyle:{"margin-left":"auto"}},[_c("CustomButton",{staticClass:"mT15",attrs:{"data-testid":"custom-button",record:_vm.customModuleData,moduleName:_vm.moduleName,position:_vm.POSITION.SUMMARY},on:{refresh:function($event){return _vm.refreshObj(!0)},onError:function(){}}}),_vm.downloadUrl?_c("iframe",{staticStyle:{display:"none"},attrs:{src:_vm.downloadUrl}}):_vm._e(),_vm.isStateFlowEnabled?[_c("TransitionButtons",{key:_vm.customModuleData.id,staticClass:"mR10",attrs:{moduleName:_vm.moduleName,record:_vm.customModuleData,disabled:_vm.isApprovalEnabled,buttonClass:"asset-el-btn"},on:{currentState:function(){},transitionSuccess:function($event){return _vm.refreshObj(!0)},transitionFailure:function(){}}})]:_vm._e(),_vm.isApprovalEnabled?_c("portal",{attrs:{to:"pagebuilder-sticky-top","data-testid":"pagebuilder-sticky-top"}},[_c("ApprovalBar",{key:_vm.customModuleData.id+"approval-bar",staticClass:"approval-bar-shadow",attrs:{moduleName:_vm.moduleName,record:_vm.customModuleData,hideApprovers:_vm.shouldHideApprovers},on:{onSuccess:function($event){return _vm.refreshObj(!0)},onFailure:function(){}}})],1):_vm._e(),_vm.isSurveyEnabled&&!_vm.isApprovalEnabled?_c("portal",{attrs:{to:"pagebuilder-fixed-top"}},[_c("SurveyBar",{attrs:{surveyDetails:_vm.surveyDetails,moduleName:"serviceRequest",recordId:_vm.serviceRequestId}})],1):_vm._e(),_c("el-dropdown",{staticClass:"mL10 self-center fc-btn-ico-lg pT3 pB3 pL8 pR8 pointer",attrs:{trigger:"click","data-testid":"summary-dropdown"},on:{command:function(action){return _vm.summaryDropDownAction(action)}}},[_c("span",{staticClass:"el-dropdown-link"},[_c("inline-svg",{staticClass:"vertical-middle",attrs:{src:"svgs/menu",iconClass:"icon icon-md"}})],1),_c("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[_vm.showEdit?_c("el-dropdown-item",{key:1,attrs:{command:"edit"}},[_vm._v("Edit")]):_vm._e(),_vm.showViewAllSurvey?_c("el-dropdown-item",{key:2,attrs:{command:"showAllSurveyDialog"}},[_vm._v(_vm._s(_vm.$t("survey.take_other_surveys")))]):_vm._e(),_vm._l(_vm.subModulesList,(function(module,index){return _c("el-dropdown-item",{key:"convert-"+index,attrs:{command:""+module.name}},[null==_vm.$account.data.orgInfo.hideCreateWOSystemButtonInSR||_vm.$account.data.orgInfo.hideCreateWOSystemButtonInSR&&"true"!=_vm.$account.data.orgInfo.hideCreateWOSystemButtonInSR?_c("div",[_vm._v(" "+_vm._s("Convert to "+(_vm.$constants.moduleSingularDisplayNameMap[module.name]?_vm.$constants.moduleSingularDisplayNameMap[module.name]:module.displayName))+" ")]):_vm._e()])}))],2)],1)],2)]),_c("ViewAllSurveysDialog",{attrs:{showSurveyDialog:_vm.showSurveyDialog,recordId:_vm.serviceRequestId,moduleName:"serviceRequest"},on:{"update:showSurveyDialog":function($event){_vm.showSurveyDialog=$event},"update:show-survey-dialog":function($event){_vm.showSurveyDialog=$event}}}),!_vm.isLoading&&_vm.customModuleData&&_vm.customModuleData.id?_c("page",{key:_vm.customModuleData.id,attrs:{module:_vm.moduleName,moduleDisplayName:_vm.moduleDisplayName,id:_vm.customModuleData.id,recordName:_vm.recordName,details:_vm.customModuleData,primaryFields:_vm.primaryFields,notesModuleName:_vm.notesModuleName,attachmentsModuleName:_vm.attachmentsModuleName,isV3Api:!0}}):_vm._e(),_c("el-dialog",{staticClass:"dialog-d",attrs:{visible:_vm.showDeleteDialog,"custom-class":"setup-dialog45","data-testid":"setup-dialog","show-close":!1},on:{"update:visible":function($event){_vm.showDeleteDialog=$event}}},[_c("div",{staticClass:"text-center fc-black-20"},[_vm._v(" Do you want to delete or dissociate from "+_vm._s(_vm.moduleName?_vm.moduleName:"")+" ? ")]),_c("span",{staticClass:"fc-dialog-center-container delete-dialog-footer padding-px18",attrs:{slot:"footer"},slot:"footer"},[_c("el-button",{on:{click:function($event){_vm.showDeleteDialog=!1}}},[_vm._v("CANCEL")]),_c("el-button",{staticClass:"delete-dissociate-buttons",on:{click:function($event){return _vm.dissociate()}}},[_vm._v("DISSOCIATE")]),_c("el-button",{staticClass:"delete-dissociate-buttons",on:{click:function($event){return _vm.deleteRecord()}}},[_vm._v("MOVE TO RECYCLE BIN")])],1)])],1)},staticRenderFns=[],objectSpread2=__webpack_require__(595082),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),Overview=(__webpack_require__(434284),__webpack_require__(670560),__webpack_require__(659749),__webpack_require__(386544),__webpack_require__(422273)),vuex_esm=__webpack_require__(420629),api=__webpack_require__(32284),router=__webpack_require__(329435),validation=__webpack_require__(586529),SurveyUtil=__webpack_require__(575369),SurveyBar=__webpack_require__(667345),ViewAllSurveys=__webpack_require__(565003),SurveyMixin=__webpack_require__(872125),modeTypes={1:"New",2:"Customer Replied",3:"Admin Replied","-1":"Created"},ServiceRequestSummaryvue_type_script_lang_js={props:["viewname"],extends:Overview/* default */.Z,mixins:[SurveyMixin/* default */.Z],components:{SurveyBar:SurveyBar/* default */.Z,ViewAllSurveysDialog:ViewAllSurveys/* default */.Z},data:function(){return{notesModuleName:"servicerequestsnotes",attachmentsModuleName:"servicerequestsattachments",primaryFields:["subject"],serviceRequest:null,subModulesDataList:[],modeTypes:modeTypes}},created:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _this.fetchSubModuleList(),_context.next=3,(0,SurveyUtil/* loadSurveyForSurveyBar */.It)(!1,"serviceRequest",_this.serviceRequestId,_this.surveyDetails);case 3:_this.surveyDetails=_context.sent;case 4:case"end":return _context.stop()}}),_callee)})))()},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({modeAllow:function(){var hideSRMode=this.$getProperty(this.$account,"data.orgInfo.hideSRMode",{});return(0,validation/* isEmpty */.xb)(hideSRMode)||"true"!=hideSRMode},showEdit:function(){return this.$hasPermission("".concat(this.moduleName,":UPDATE"))&&!this.isRecordLocked},customModuleData:function(){return this.serviceRequest},subModulesList:function(){return this.subModulesDataList},mainFieldKey:function(){return"subject"}},(0,vuex_esm/* mapState */.rn)({ticketStatus:function(state){return state.ticketStatus.serviceRequest},moduleMeta:function(state){return state.view.metaInfo}})),{},{moduleDisplayName:function(){var moduleMeta=this.moduleMeta,_ref=moduleMeta||{},displayName=_ref.displayName;return displayName},serviceRequestId:function(){return this.$route.params.id},recordName:function(){var customModuleData=this.customModuleData,_ref2=customModuleData||{},subject=_ref2.subject;return subject}}),methods:{refreshObj:function(){var _arguments=arguments,_this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var force;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return force=_arguments.length>0&&void 0!==_arguments[0]&&_arguments[0],_this2.loadCustomModuleData(force),_context2.next=4,(0,SurveyUtil/* loadSurveyForSurveyBar */.It)(!0,_this2.moduleName,_this2.serviceRequestId,_this2.surveyDetails);case 4:_this2.surveyDetails=_context2.sent;case 5:case"end":return _context2.stop()}}),_callee2)})))()},modeClass:function(customModuleData){var modeClass={1:"is-new",2:"customer-replied",3:"admin-replied","-1":"created"},_ref3=customModuleData||{},mode=_ref3.mode;if(mode)return"service-request-mode-in-summary-page ".concat(modeClass[mode])},loadCustomModuleData:function(){var _arguments2=arguments,_this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var force,id,moduleName,_yield$API$fetchRecor,error,serviceRequest;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return force=_arguments2.length>0&&void 0!==_arguments2[0]&&_arguments2[0],_this3.isLoading=!0,id=_this3.id,moduleName=_this3.moduleName,_context3.next=5,api/* API */.bl.fetchRecord(moduleName,{id:id},{force:force});case 5:_yield$API$fetchRecor=_context3.sent,error=_yield$API$fetchRecor.error,serviceRequest=_yield$API$fetchRecor.serviceRequest,error?_this3.$message.error(error.message||"Error Occurred"):_this3.serviceRequest=serviceRequest,_this3.isLoading=!1;case 10:case"end":return _context3.stop()}}),_callee3)})))()},editCustomModuleData:function(){var id=this.id,moduleName=this.moduleName;if((0,router/* isWebTabsEnabled */.tj)()){var _ref4=(0,router/* findRouteForModule */.Jp)(moduleName,router/* pageTypes */.As.EDIT)||{},name=_ref4.name;name&&this.$router.push({name:name,params:{id:id}})}else this.$router.push({path:"/app/sr/serviceRequest/edit/".concat(id)})},openNewForm:function(moduleName){if("workorder"===moduleName){var _ref5=this.customModuleData||{},id=_ref5.id,subject=_ref5.subject,description=_ref5.description,siteId=_ref5.siteId,_ref5$resource=_ref5.resource,resource=void 0===_ref5$resource?{}:_ref5$resource;this.$router.push({path:"/app/wo/create",query:{serviceRequest:id,subject:subject,description:description,siteId:siteId,resource:(resource||{}).id,resourceLabel:(resource||{}).name}})}},fetchSubModuleList:function(){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){var _yield$API$get,error,data;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,api/* API */.bl.get("v2/servicerequests/fetchSubModules");case 2:_yield$API$get=_context4.sent,error=_yield$API$get.error,data=_yield$API$get.data,error?_this4.$message.error(error.message||"Error Occurred"):_this4.subModulesDataList=data.submodules||[];case 6:case"end":return _context4.stop()}}),_callee4)})))()},routeToList:function(){var viewname=this.viewname,query=this.$route.query;if((0,router/* isWebTabsEnabled */.tj)()){var _ref6=(0,router/* findRouteForModule */.Jp)(this.moduleName,router/* pageTypes */.As.LIST)||{},name=_ref6.name;name&&this.$router.push({name:name,params:{viewname:viewname},query:query})}else this.$router.push({path:"/app/sr/serviceRequest/".concat(viewname),query:query})},summaryDropDownAction:function(action){"edit"===action?this.editCustomModuleData():"showAllSurveyDialog"===action?this.setshowSurveyDialog():action&&this.openNewForm(action)}}},servicerequest_ServiceRequestSummaryvue_type_script_lang_js=ServiceRequestSummaryvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(servicerequest_ServiceRequestSummaryvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,ServiceRequestSummary=component.exports},
/***/667345:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return SurveyBar}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/setup/survey/SurveyBar.vue?vue&type=template&id=4819c4ba&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.showBar?_c("div",{staticClass:"survey-bar-container",attrs:{"data-testid":"survey-bar-container"}},[_c("div",{class:["sidebar-loader",_vm.isLoading&&"on"]}),_vm.isLoading?_c("div",{staticClass:"d-flex survey-bar"},[_vm._v(" "+_vm._s(_vm.$t("panel.loading_load"))+" ")]):_c("div",{staticClass:"d-flex survey-bar"},[_c("i",{staticClass:"el-icon-warning-outline warning-icon"}),_c("el-tooltip",{staticClass:"m4",attrs:{effect:"dark",content:_vm.surveyBarTitle,placement:"top-start"}},[_c("div",{staticClass:"survey-bar-helper mR40",attrs:{"data-testid":"survey-bar-helper"}},[_vm._v(" "+_vm._s(_vm.surveyBarTitle)+" ")])]),_vm.showSurveyOptions?_c("div",["Take Survey"===_vm.buttonTitle?_c("div",{staticClass:"survey-btn mR15"},[_c("div",{staticClass:"take-survey-btn",attrs:{"data-testid":"take-survey-btn"},on:{click:function($event){return _vm.redirectToLatestSurvey()}}},[_vm._v(" "+_vm._s(_vm.buttonTitle)+" ")])]):_vm._e()]):_vm._e()],1)]):_vm._e()},staticRenderFns=[],router=(__webpack_require__(976801),__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(70630)),_facilio_router=__webpack_require__(329435),validation=__webpack_require__(990260),helpers=__webpack_require__(778390),moment=helpers/* default */.ZP.getOrgMoment,SurveyBarvue_type_script_lang_js={name:"SurveyBar",data:function(){return{isLoading:!1,responseStatusHash:{1:"DISABLED",2:"NOT_ANSWERED",3:"PARIALLY_ANSWERED",4:"COMPLETED"}}},props:["surveyDetails","moduleName","recordId"],computed:{getCurrentUserId:function(){var $account=this.$account,_ref=$account||{},user=_ref.user,peopleId=this.$getProperty(user,"peopleId",null);return peopleId},surveyBarTitle:function(){var surveyDetails=this.surveyDetails,_ref2=surveyDetails||{},_ref2$response=_ref2.response,response=void 0===_ref2$response?[]:_ref2$response,name=this.$t("survey.survey_title");if(!(0,validation/* isEmpty */.xb)(response)){var latestSurvey=response[response.length-1]||{},surveyTitle=this.$t("survey.survey_title");name=this.$getProperty(latestSurvey,"name",surveyTitle)}return name},buttonTitle:function(){var surveyDetails=this.surveyDetails,responseStatusHash=this.responseStatusHash,_ref3=surveyDetails||{},_ref3$response=_ref3.response,response=void 0===_ref3$response?[]:_ref3$response;if(!(0,validation/* isEmpty */.xb)(response)){var latestSurvey=response[response.length-1]||{};if(this.isSurveyExpired())return null;var _ref4=latestSurvey||{},responseStatus=_ref4.responseStatus,isRetakeAllowed=_ref4.isRetakeAllowed;return"COMPLETED"!==responseStatusHash[responseStatus]||isRetakeAllowed?["COMPLETED","PARIALLY_ANSWERED"].includes(responseStatusHash[responseStatus])?this.$t("survey.retake_survey"):this.$t("survey.take_survey"):""}return null},canShowResults:function(){var surveyDetails=this.surveyDetails,responseStatusHash=this.responseStatusHash,_ref5=surveyDetails||{},response=_ref5.response,isSuperAdmin=_ref5.isSuperAdmin,canShowResult=!1;return response.forEach((function(survey){var _ref6=survey||{},responseStatus=_ref6.responseStatus;canShowResult=canShowResult||"COMPLETED"===responseStatusHash[responseStatus]})),canShowResult&&isSuperAdmin},isSurveyForCurrentUser:function(){var surveyDetails=this.surveyDetails,getCurrentUserId=this.getCurrentUserId,_ref7=surveyDetails||{},_ref7$response=_ref7.response,response=void 0===_ref7$response?[]:_ref7$response,_ref8=response[response.length-1]||{},assignedTo=_ref8.assignedTo,_ref9=assignedTo||{},id=_ref9.id;return id===getCurrentUserId},showBar:function(){var showViewAllSurvey=this.showViewAllSurvey,buttonTitle=this.buttonTitle,canShowResults=this.canShowResults,isSurveyForCurrentUser=this.isSurveyForCurrentUser,canShowSurveyBtn=!(0,validation/* isEmpty */.xb)(buttonTitle);return(canShowSurveyBtn||showViewAllSurvey||canShowResults)&&buttonTitle===this.$t("survey.take_survey")&&isSurveyForCurrentUser},showSurveyOptions:function(){var buttonTitle=this.buttonTitle;return!(0,validation/* isEmpty */.xb)(buttonTitle)},allSurveysRetakeAvailable:function(){var surveyDetails=this.surveyDetails,responseStatusHash=this.responseStatusHash,_ref10=surveyDetails||{},response=_ref10.response,allSurveysAvailable=!0;return response.forEach((function(survey){var currentSurveyAvailable=!0,_ref11=survey||{},responseStatus=_ref11.responseStatus,isRetakeAllowed=_ref11.isRetakeAllowed;currentSurveyAvailable=["COMPLETED","PARIALLY_ANSWERED"].includes(responseStatusHash[responseStatus])||"COMPLETED"===responseStatusHash[responseStatus]&&isRetakeAllowed,allSurveysAvailable=allSurveysAvailable||currentSurveyAvailable})),allSurveysAvailable},showViewAllSurvey:function(){var _this=this,surveyDetails=this.surveyDetails,allSurveysRetakeAvailable=this.allSurveysRetakeAvailable,_ref12=surveyDetails||{},isViewAllSurvey=_ref12.isViewAllSurvey,response=_ref12.response,activeSurveyCount=0,allSurveysExpired=!0;return response.forEach((function(survey){var surveyExpired=_this.isSurveyExpired(survey);surveyExpired||(activeSurveyCount+=1),allSurveysExpired=allSurveysExpired&&surveyExpired})),isViewAllSurvey&&!allSurveysExpired&&allSurveysRetakeAvailable&&activeSurveyCount>1}},methods:{isSurveyExpired:function(surveyInfo){var surveyDetails=this.surveyDetails,_ref13=surveyDetails||{},_ref13$response=_ref13.response,response=void 0===_ref13$response?[]:_ref13$response,retakeTime=null,expiryTime=null;if(!(0,validation/* isEmpty */.xb)(response)){var latestSurvey=response[response.length-1]||{},_ref14=latestSurvey||{},retakeExpiry=_ref14.retakeExpiry,expiryDate=_ref14.expiryDate;retakeTime=retakeExpiry,expiryTime=expiryDate}var currentTimeStamp=moment().valueOf(),reTakeOptionExpired=!1,surveyExpired=!1;if(!(0,validation/* isEmpty */.xb)(surveyInfo)){var _ref15=surveyInfo||{},_retakeExpiry=_ref15.retakeExpiry,_expiryDate=_ref15.expiryDate;retakeTime=_retakeExpiry,expiryTime=_expiryDate}return!(0,validation/* isEmpty */.xb)(retakeTime)&&currentTimeStamp>retakeTime&&(reTakeOptionExpired=!0),!(0,validation/* isEmpty */.xb)(expiryTime)&&currentTimeStamp>expiryTime&&(surveyExpired=!0),reTakeOptionExpired||surveyExpired},redirectToLatestSurvey:function(){var _this2=this,surveyDetails=this.surveyDetails,_getApp=(0,_facilio_router/* getApp */.wx)(),appName=_getApp.linkName,_ref16=surveyDetails||{},_ref16$response=_ref16.response,response=void 0===_ref16$response?[]:_ref16$response,_ref17=response[response.length-1]||{},id=_ref17.id,params={id:id,appName:appName},_router$resolve=router/* default */.Z.resolve({name:"newSurveyLiveForm",params:params}),href=_router$resolve.href;window.open(href,"_blank"),window.addEventListener("message",(function(event){event.origin===window.origin&&_this2.$router.go(0)}))}}},survey_SurveyBarvue_type_script_lang_js=SurveyBarvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(survey_SurveyBarvue_type_script_lang_js,render,staticRenderFns,!1,null,"4819c4ba",null)
/* harmony default export */,SurveyBar=component.exports},
/***/565003:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return ViewAllSurveys}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/setup/survey/ViewAllSurveys.vue?vue&type=template&id=78b35bb0&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"fc-dialog-center-container all-surveys",attrs:{title:_vm.$t("survey.all_surveys"),visible:_vm.showSurveyDialog||_vm.showAllResponses,width:"40%","append-to-body":!0,"before-close":_vm.closeDialog}},[_c("div",{staticClass:"survey-container mT10"},[_vm.isLoading?_c("div",{staticClass:"mT20"},[_c("spinner",{attrs:{show:_vm.isLoading,size:"80"}})],1):_c("div",[_vm.checkSurveyAvailable?_vm._l(_vm.surveys,(function(survey){return _c("div",{key:"survey-"+survey.id},[_vm.showAllResponses?_c("div",{staticClass:"survey-row flex-middle d-flex mB20"},[_c("div",{staticClass:"survey-title pL30"},[_vm._v(" "+_vm._s(survey.name)+" ")]),_c("div",{staticClass:"survey-btn"},[_c("div",{staticClass:"retake-survey mR20",on:{click:function($event){return _vm.showIndividualResponseDialog(survey)}}},[_vm._v(" "+_vm._s(_vm.$t("survey.view_survey_answer"))+" ")])])]):_c("div",{staticClass:"survey-row flex-middle d-flex mB20"},[_c("div",{staticClass:"survey-title pL30 mR40"},[_vm._v(" "+_vm._s(survey.name)+" ")]),_c("div",{staticClass:"survey-btn"},[_vm.canShowTakeSurvey(survey)?_c("div",{staticClass:"retake-survey mL10 mR20",on:{click:function($event){return _vm.redirectToSurvey(survey.id)}}},[_vm._v(" "+_vm._s(_vm.$t("survey.take_survey"))+" ")]):_vm.canShowReTakeSurvey(survey)&&!_vm.isSurveyExpired(survey)?_c("div",{staticClass:"retake-survey mL10 mR20",on:{click:function($event){return _vm.redirectToSurvey(survey.id)}}},[_vm._v(" "+_vm._s(_vm.$t("survey.retake_survey"))+" ")]):_c("span")])]),_c("div",{staticClass:"row-seperator mB10"})])})):_c("div",{staticStyle:{"margin-left":"35%"}},[_c("InlineSvg",{staticClass:"self-center mT10",attrs:{src:"svgs/emptystate/readings-empty",iconClass:"icon text-center icon-130 emptystate-icon-size "}}),_c("div",{staticClass:"fc-black-dark\n           f16 bold mT10 line-height10 self-center",staticStyle:{"margin-left":"-30px"}},[_vm._v(" "+_vm._s(_vm.$t("survey.no_more_surveys_available"))+" ")])],1)],2)]),_c("IndividualSurveyResult",{ref:"user-response",attrs:{showResultDialog:_vm.showIndividualResponse,details:_vm.details,surveyLoading:_vm.surveyLoading,module:_vm.moduleName,recordName:_vm.recordName},on:{"update:showResultDialog":function($event){_vm.showIndividualResponse=$event},"update:show-result-dialog":function($event){_vm.showIndividualResponse=$event},"update:surveyLoading":function($event){_vm.surveyLoading=$event},"update:survey-loading":function($event){_vm.surveyLoading=$event}}})],1)},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),validation=(__webpack_require__(689730),__webpack_require__(976801),__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(990260)),router=__webpack_require__(70630),_facilio_router=__webpack_require__(329435),SurveyUtil=__webpack_require__(575369),helpers=__webpack_require__(778390),IndividualSurveyResult=__webpack_require__(640879),moment=helpers/* default */.ZP.getOrgMoment,ViewAllSurveysvue_type_script_lang_js={name:"ViewAllSurveys",props:["showSurveyDialog","moduleName","recordId","showAllResponses","recordName"],data:function(){return{isLoading:!1,surveys:[],templates:[],responseStatusHash:{1:"DISABLED",2:"NOT_ANSWERED",3:"PARIALLY_ANSWERED",4:"COMPLETED"},buttonTitleHash:{},details:{},surveyLoading:!1,surveyPage:1,surveyPerPage:50,templatePage:1,templatePerPage:50,viewName:"all",showIndividualResponse:!1}},components:{IndividualSurveyResult:IndividualSurveyResult/* default */.Z},watch:{showSurveyDialog:{handler:function(newVal){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(!newVal){_context.next=3;break}return _context.next=3,_this.loadAvailableSurveys();case 3:case"end":return _context.stop()}}),_callee)})))()},immediate:!0},showAllResponses:{handler:function(newVal){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if(!newVal){_context2.next=3;break}return _context2.next=3,_this2.loadAvailableSurveys();case 3:case"end":return _context2.stop()}}),_callee2)})))()},immediate:!0}},computed:{checkSurveyAvailable:function(){var surveys=this.surveys;return surveys.length>0},getCurrentUserId:function(){var $account=this.$account,_ref=$account||{},user=_ref.user,peopleId=this.$getProperty(user,"peopleId",null);return peopleId}},methods:{loadAvailableSurveys:function(){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var recordId,moduleName,surveyPage,surveyPerPage,viewName,showAllResponses,type,filters,surveys;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return _this3.isLoading=!0,recordId=_this3.recordId,moduleName=_this3.moduleName,surveyPage=_this3.surveyPage,surveyPerPage=_this3.surveyPerPage,viewName=_this3.viewName,showAllResponses=_this3.showAllResponses,type={},filters={},showAllResponses?showAllResponses&&(filters={responseStatus:{operatorId:54,value:["4"]}}):type={isViewAllSurvey:!0},surveys=[],_context3.next=8,(0,SurveyUtil/* loadAllSurveys */.UI)(moduleName,recordId,type,surveyPage,surveyPerPage,viewName,null,filters);case 8:surveys=_context3.sent,surveys=surveys.slice(),surveys=surveys.reverse(),_this3.surveys=surveys,_this3.fillButtonTitles(),_this3.isLoading=!1;case 14:case"end":return _context3.stop()}}),_callee3)})))()},isSurveyForCurrentUser:function(survey){var _ref2=survey||{},assignedTo=_ref2.assignedTo,_ref3=assignedTo||{},id=_ref3.id;return id===this.getCurrentUserId},showAllSurveyResponses:function(survey){var responseStatusHash=this.responseStatusHash,_ref4=survey||{},responseStatus=_ref4.responseStatus,isRetakeAllowed=_ref4.isRetakeAllowed;return["COMPLETED","PARIALLY_ANSWERED","NOT_ANSWERED"].includes(responseStatusHash[responseStatus])||"COMPLETED"===responseStatusHash[responseStatus]&&isRetakeAllowed},showIndividualResponseDialog:function(survey){this.showIndividualResponse=!0,this.loadSurveyDetail(survey)},loadSurveyDetail:function(selectedSurvey){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:return _this4.surveyLoading=!0,_context4.next=3,(0,SurveyUtil/* getSurveyDetails */["if"])(selectedSurvey);case 3:_this4.details=_context4.sent,_this4.surveyLoading=!1;case 5:case"end":return _context4.stop()}}),_callee4)})))()},fillButtonTitles:function(){var _this5=this,surveys=this.surveys,buttonTitleHash=this.buttonTitleHash;surveys.forEach((function(survey){var _ref5=survey||{},id=_ref5.id,buttonTitle=_this5.getButtonTitle(survey);_this5.$set(buttonTitleHash,"".concat(id),buttonTitle)}))},isSurveyExpired:function(survey){var _ref6=survey||{},retakeExpiry=_ref6.retakeExpiry,expiryDate=_ref6.expiryDate,isRetakeAllowed=_ref6.isRetakeAllowed,currentTimeStamp=moment().valueOf(),reTakeOptionExpired=!1,surveyExpired=!1;return!(0,validation/* isEmpty */.xb)(retakeExpiry)&&currentTimeStamp>retakeExpiry&&(reTakeOptionExpired=!0),!(0,validation/* isEmpty */.xb)(expiryDate)&&(0,validation/* isEmpty */.xb)(isRetakeAllowed)&&currentTimeStamp>expiryDate&&(surveyExpired=!0),reTakeOptionExpired||surveyExpired},getButtonTitle:function(survey){var responseStatusHash=this.responseStatusHash,_ref7=survey||{},responseStatus=_ref7.responseStatus,isRetakeAllowed=_ref7.isRetakeAllowed;return["NOT_ANSWERED","PARIALLY_ANSWERED"].includes(responseStatusHash[responseStatus])?this.$t("survey.take_survey"):"COMPLETED"===responseStatusHash[responseStatus]&&isRetakeAllowed?this.$t("survey.retake_survey"):this.$t("survey.survey_taken")},canShowTakeSurvey:function(survey){var buttonTitleHash=this.buttonTitleHash,_ref8=survey||{},id=_ref8.id,buttonTitle=this.$getProperty(buttonTitleHash,"".concat(id),"");return"Take Survey"===buttonTitle},canShowReTakeSurvey:function(survey){var buttonTitleHash=this.buttonTitleHash,_ref9=survey||{},id=_ref9.id,buttonTitle=this.$getProperty(buttonTitleHash,"".concat(id),"");return"Retake Survey"===buttonTitle},redirectToSurvey:function(id){var moduleName=this.moduleName,recordId=this.recordId,_getApp=(0,_facilio_router/* getApp */.wx)(),appName=_getApp.linkName,params={id:id,appName:appName},_router$resolve=router/* default */.Z.resolve({name:"newSurveyLiveForm",params:params,query:{name:moduleName,recordId:recordId}}),href=_router$resolve.href;window.open(href,"_blank")},closeDialog:function(){var showAllResponses=this.showAllResponses;showAllResponses?this.$emit("update:showAllResponses",!1):this.$emit("update:showSurveyDialog",!1)}}},survey_ViewAllSurveysvue_type_script_lang_js=ViewAllSurveysvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(survey_ViewAllSurveysvue_type_script_lang_js,render,staticRenderFns,!1,null,"78b35bb0",null)
/* harmony default export */,ViewAllSurveys=component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/30237.js.map