"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[48154],{
/***/835002:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return JPWarningDialog}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/workorder/jobplan/JPWarningDialog.vue?vue&type=template&id=dca5fbce&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"fc-dialog-center-container dialog-header-remove",attrs:{visible:_vm.showDialog,width:"35%","append-to-body":!0,"before-close":_vm.closeDialog},on:{"update:visible":function($event){_vm.showDialog=$event}}},[_c("div",{staticClass:"height180 d-flex"},[_c("i",{staticClass:"fa fa-exclamation-triangle pR5 pL10",attrs:{"aria-hidden":"true"}}),_c("div",{staticClass:"d-flex flex-direction-column mL10 width100"},[_c("div",{staticClass:"dialog-heading"},[_vm._v(" "+_vm._s(_vm.dialogHeader)+" ")]),_c("div",{staticClass:"dialog-content mT15",domProps:{innerHTML:_vm._s(_vm.dialogContent)}})])]),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.closeDialog}},[_vm._v(_vm._s(_vm.$t("agent.agent.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.stateUpdating},on:{click:_vm.saveDialog}},[_vm._v(_vm._s(_vm.buttonText))])],1)])},staticRenderFns=[],dialogHeaderHash=(__webpack_require__(634338),{jobplan:{Edit:"jobplan.edit_jp",Publish:"jobplan.publish_jp",Unpublish:"jobplan.unpublish_jp",Disable:"jobplan.disable_jp"},plannedmaintenance:{Edit:"maintenance.pm._edit_pm",Publish:"maintenance.pm.publish_pm",Unpublish:"maintenance.pm.unpublish_pm",Disable:"maintenance.pm.disable_pm"}}),dialogContentHash={jobplan:{Edit:"jobplan.edit_jp_content",Publish:"jobplan.publish_jp_content",Unpublish:"jobplan.unpublish_jp_content",Disable:"jobplan.disable_jp_content"},plannedmaintenance:{Edit:"maintenance.pm.edit_pm_content",Publish:"maintenance.pm.publish_pm_content",Unpublish:"maintenance.pm.unpublish_pm_content",Disable:"maintenance.pm.disable_pm_content"}},buttonTextHash={jobplan:{Edit:"jobplan.edit",Publish:"jobplan.publish",Unpublish:"jobplan.unpublish",Disable:"jobplan.disable"},plannedmaintenance:{Edit:"jobplan.edit",Publish:"jobplan.publish",Unpublish:"jobplan.unpublish",Disable:"jobplan.disable"}},JPWarningDialogvue_type_script_lang_js={props:["showDialog","dialogType","moduleName","stateUpdating","recordId"],computed:{dialogHeader:function(){var dialogType=this.dialogType,moduleName=this.moduleName,dialogHeader=this.$getProperty(dialogHeaderHash,"".concat(moduleName,".").concat(dialogType),"jobplan.edit");return this.$t("".concat(dialogHeader))},dialogContent:function(){var dialogType=this.dialogType,moduleName=this.moduleName,dialogContent=this.$getProperty(dialogContentHash,"".concat(moduleName,".").concat(dialogType),"jobplan.edit_content");return this.$t("".concat(dialogContent))},buttonText:function(){var dialogType=this.dialogType,moduleName=this.moduleName,buttonText=this.$getProperty(buttonTextHash,"".concat(moduleName,".").concat(dialogType),"jobplan.edit");return this.$t("".concat(buttonText))}},methods:{closeDialog:function(){this.$emit("closeDialog")},saveDialog:function(){var dialogType=this.dialogType;this.$emit("saveAction",dialogType)}}},jobplan_JPWarningDialogvue_type_script_lang_js=JPWarningDialogvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(jobplan_JPWarningDialogvue_type_script_lang_js,render,staticRenderFns,!1,null,"dca5fbce",null)
/* harmony default export */,JPWarningDialog=component.exports},
/***/922521:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return PMList}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/workorder/pm/PMList.vue?vue&type=template&id=4d2bdd7b
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.isSummaryOpen?_c("div",{staticClass:"height100"},[_vm.showLoading?_c("div",{staticClass:"flex-middle fc-empty-white"},[_c("spinner",{attrs:{show:_vm.showLoading,size:"80"}})],1):_c("div",{staticClass:"flex flex-row"},[_c("div",{staticClass:"flex-1"},[_c("router-view",{attrs:{viewname:_vm.viewname}})],1)])]):_c("CommonListLayout",{key:_vm.moduleName+"-list-layout",staticClass:"custom-module-list-layout",attrs:{moduleName:_vm.moduleName,showViewRearrange:!0,showViewEdit:!0,visibleViewCount:3,getPageTitle:function(){return _vm.moduleDisplayName},pathPrefix:_vm.parentPath,hideSubHeader:_vm.canHideSubHeader,recordCount:_vm.recordCount,recordLoading:_vm.showLoading},scopedSlots:_vm._u([{key:"header",fn:function(){return[_vm.canHideFilter?_vm._e():_c("AdvancedSearchWrapper",{key:"ftags-list-"+_vm.moduleName,attrs:{filters:_vm.filters,moduleName:_vm.moduleName,moduleDisplayName:_vm.moduleDisplayName}}),_vm.canShowVisualSwitch?[_c("visual-type",{on:{onSwitchVisualize:function(val){return _vm.canShowListView=val}}})]:_vm._e(),_c("CustomButton",{staticClass:"custom-button",attrs:{moduleName:_vm.moduleName,position:_vm.POSITION.LIST_TOP},on:{onSuccess:_vm.onCustomButtonSuccess,onError:function(){}}}),_vm.hasPermission("CREATE")?[_c("button",{staticClass:"fc-create-btn create-btn",on:{click:function($event){return _vm.redirectToFormCreation()}}},[_vm._v(" "+_vm._s(_vm.$t("custommodules.list.new"))+" "+_vm._s(_vm.moduleDisplayName?_vm.moduleDisplayName:"")+" ")])]:_vm._e()]},proxy:!0},{key:"sub-header-actions",fn:function(){return[!_vm.isEmpty(_vm.records)&&_vm.showListView?[_c("pagination",{staticClass:"pL15 fc-black-small-txt-12",attrs:{total:_vm.recordCount,currentPageCount:_vm.currentPageCount,perPage:_vm.perPage,skipTotalCount:!0}}),_vm.recordCount>0?_c("span",{staticClass:"separator"},[_vm._v("|")]):_vm._e(),_c("el-tooltip",{attrs:{effect:"dark",content:_vm.$t("common._common.sort"),"open-delay":500,placement:"top",tabindex:-1}},[_c("Sort",{key:_vm.moduleName+"-sort",attrs:{moduleName:_vm.moduleName},on:{onSortChange:_vm.updateSort}})],1),_vm.hasPermission("EXPORT")?_c("span",{staticClass:"separator"},[_vm._v("|")]):_vm._e(),_vm.hasPermission("EXPORT")?_c("el-tooltip",{attrs:{effect:"dark",content:_vm.$t("common._common.export"),"open-delay":500,placement:"top",tabindex:-1}},[_c("f-export-settings",{attrs:{module:_vm.moduleName,viewDetail:_vm.viewDetail,showViewScheduler:!1,showMail:!1,filters:_vm.filters}})],1):_vm._e()]:_vm._e()]},proxy:!0},_vm.showBulkActionBar()&&this.$helpers.isLicenseEnabled("BULK_UPDATE")?{key:"sub-header-selectedall",fn:function(){return[_c("div",{staticClass:"bulk-update-bar"},[_c("NewBulkActionBar",{ref:"bulk-action-bar",attrs:{visible:"true",totalCount:_vm.recordCount,perPage:_vm.perPage,isAllSelected:_vm.isAllSelected,moduleName:_vm.moduleName,selectedItem:_vm.selectedListItemsIds.length,limit:_vm.bulkActionAcount},on:{"update:isAllSelected":function($event){_vm.isAllSelected=$event},"update:is-all-selected":function($event){_vm.isAllSelected=$event},change:_vm.validateTotalCount}})],1)]},proxy:!0}:null,{key:"content",fn:function(){return[_vm.showLoading?_c("Spinner",{staticClass:"mT40",attrs:{show:_vm.showLoading}}):_vm._e(),_vm.$validation.isEmpty(_vm.records)&&!_vm.showLoading?_c("div",{staticClass:"cm-empty-state-container"},[_c("img",{staticClass:"mT20 self-center",attrs:{src:__webpack_require__(15482),width:"100",height:"100"}}),_c("div",{staticClass:"mT10 label-txt-black f14 self-center"},[_vm._v(" "+_vm._s(_vm.emptyStateText)+" ")])]):_vm._e(),_vm.showLoading||_vm.$validation.isEmpty(_vm.records)?_vm._e():[_c("div",{staticClass:"cm-list-container"},[_c("div",{staticClass:"column-customization-icon",attrs:{disabled:!_vm.isColumnCustomizable},on:{click:_vm.toShowColumnSettings}},[_c("el-tooltip",{attrs:{disabled:_vm.isColumnCustomizable,placement:"top",content:_vm.$t("common._common.you_dont_have_permission")}},[_c("inline-svg",{staticClass:"text-center position-absolute icon",attrs:{src:"column-setting"}})],1)],1),_vm.$validation.isEmpty(_vm.selectedListItemsIds)?_vm._e():_c("div",{staticClass:"pull-left table-header-actions"},[_c("div",{staticClass:"action-btn-slide btn-block"},[_vm.hasPermission("EDIT,UPDATE")&&_vm.enablePmBulkUpdate()?_c("button",{staticClass:"btn btn--tertiary pointer",attrs:{disabled:_vm.isBulkUpdateVisible},on:{click:function($event){return _vm.OpenBulkUpdate()}}},[_vm._v(" "+_vm._s(_vm.$t("common._common.bulk_update"))+" ")]):_vm._e(),_c("button",{staticClass:"btn btn--tertiary pointer mL10",attrs:{disabled:_vm.isDisable},on:{click:function($event){return _vm.deleteRecords(_vm.selectedListItemsIds)}}},[_vm._v(" "+_vm._s(_vm.$t("custommodules.list.delete"))+" ")]),_c("button",{staticClass:"btn btn--tertiary pointer mL10",on:{click:function($event){return _vm.showWarningDialog("Publish")}}},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm.publish"))+" ")]),_c("button",{staticClass:"btn btn--tertiary pointer",attrs:{disabled:_vm.isDisable},on:{click:function($event){return _vm.showWarningDialog("Unpublish")}}},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm.unpublish"))+" ")])]),_vm.isDisable?_vm._e():_c("CustomButton",{key:_vm.moduleName+"_"+_vm.viewname+"_"+_vm.POSITION.LIST_BAR,staticClass:"custom-button",attrs:{modelDataClass:_vm.modelDataClass,moduleName:_vm.moduleName,position:_vm.POSITION.LIST_BAR,selectedRecords:_vm.selectedListItemsObj},on:{onSuccess:_vm.onCustomButtonSuccess,onError:function(){}}}),_vm.enablePmBulkUpdate?[_vm.bulkAction?_c("new-bulk-update-viewer",{ref:"bulk-update-dialog",attrs:{module:"plannedmaintenance",fieldlist:_vm.bulkActionFieldList,recordCount:_vm.recordCount,"content-css":{padding:"0px",background:"#f7f8fa",Width:"10vw",Height:"30vh"}},on:{submit:_vm.newbulkActionHandler,closed:_vm.handleBulkActiondialogClose}}):_vm._e()]:[_vm.bulkAction?_c("bulk-update-viewer",{attrs:{module:"plannedmaintenance",fieldlist:_vm.bulkActionFieldList,"content-css":{padding:"0px",background:"#f7f8fa",Width:"10vw",Height:"30vh"}},on:{submit:_vm.bulkActionHandler,closed:_vm.closeBulkActionDialog}}):_vm._e()]],2),_c("CommonList",{attrs:{viewDetail:_vm.viewDetail,records:_vm.records,moduleName:_vm.moduleName,redirectToOverview:_vm.redirectToOverview,slotList:_vm.slotList,canShowCustomButton:"true",refreshList:_vm.onCustomButtonSuccess},on:{"selection-change":_vm.selectItems},scopedSlots:_vm._u([{key:_vm.slotList[0].criteria,fn:function(ref){var record=ref.record;return[_c("router-link",{staticClass:"d-flex fw5 label-txt-black ellipsis main-field-column",attrs:{to:_vm.redirectToOverview(record.id)}},[_c("el-tooltip",{attrs:{effect:"dark",content:record.name||"---",placement:"top-end","open-delay":600}},[_c("div",{staticClass:"self-center width200px"},[_c("span",{staticClass:"list-main-field"},[_vm._v(_vm._s(record.name||"---"))])])])],1)]}},{key:_vm.slotList[1].name,fn:function(ref){var record=ref.record;return[_c("div",{staticClass:"d-flex"},[_c("div",{staticClass:"fc-id"},[_vm._v(_vm._s("#"+record.id))])])]}},{key:_vm.slotList[2].name,fn:function(ref){var record=ref.record;return[_c("div",{staticClass:"d-flex text-center"},[_vm.hasPermission("EDIT,UPDATE")&&record.canEdit()?_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-edit pointer edit-icon-color visibility-hide-actions mL10",attrs:{"data-arrow":"true",title:_vm.$t("common._common.edit")},on:{click:function($event){return _vm.editModule(record)}}}):_vm._e(),_vm.hasPermission("DELETE")?_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-delete pointer edit-icon-color visibility-hide-actions mL10",attrs:{"data-arrow":"true",title:_vm.$t("common._common.delete")},on:{click:function($event){return _vm.deleteRecords([record.id])}}}):_vm._e()])]}}],null,!0)})],1)],_c("column-customization",{attrs:{visible:_vm.showColumnSettings,moduleName:_vm.moduleName,viewName:_vm.viewname},on:{"update:visible":function($event){_vm.showColumnSettings=$event}}})]},proxy:!0}],null,!0)},[_c("portal",{attrs:{to:"view-manager-link"}},[_c("div",{staticClass:"view-manager-btn",on:{click:_vm.getViewManagerRoute}},[_c("inline-svg",{staticClass:"d-flex",attrs:{src:"svgs/hamburger-menu",iconClass:"icon icon-sm"}}),_c("span",{staticClass:"label mL10 text-uppercase"},[_vm._v(" "+_vm._s(_vm.$t("viewsmanager.list.views_manager"))+" ")])],1)]),_vm.isBulkPublish?[_vm.showDialog?_c("BulkPublish",{attrs:{showDialog:_vm.showDialog,dialogType:_vm.dialogType,moduleName:_vm.moduleName,stateUpdating:_vm.stateUpdating,showStatus:_vm.showStatus,statusMessage:_vm.statusMessage},on:{closeDialog:_vm.handleBulkActiondialogClose,saveAction:_vm.saveAction}}):_vm._e()]:[_vm.showDialog?_c("PMWarningDialog",{attrs:{showDialog:_vm.showDialog,dialogType:_vm.dialogType,moduleName:_vm.moduleName,stateUpdating:_vm.stateUpdating},on:{closeDialog:_vm.closeDialog,saveAction:_vm.saveAction}}):_vm._e()]],2)},staticRenderFns=[],objectSpread2=__webpack_require__(595082),createForOfIteratorHelper=__webpack_require__(566347),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),CommonModuleList=(__webpack_require__(648324),__webpack_require__(434284),__webpack_require__(670560),__webpack_require__(634338),__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(347446)),api=__webpack_require__(32284),validation=__webpack_require__(990260),router=__webpack_require__(329435),pm_utils=__webpack_require__(195123),JPWarningDialog=__webpack_require__(835002),NewBulkUpdateViewer=__webpack_require__(962223),NewBulkActionBar=__webpack_require__(844611),moment_timezone=__webpack_require__(480008),moment_timezone_default=__webpack_require__.n(moment_timezone),BulkUpdateViewer=__webpack_require__(574655),NewBulkPublishvue_type_template_id_cb9b98e6_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"fc-dialog-center-container dialog-header-remove",attrs:{visible:_vm.showDialog,width:"35%","append-to-body":!0,"before-close":_vm.closeDialog},on:{"update:visible":function($event){_vm.showDialog=$event}}},[_c("div",{staticClass:"height180 d-flex"},[_c("i",{staticClass:"fa fa-exclamation-triangle pR5 pL10 bulk-update-icon",attrs:{"aria-hidden":"true"}}),_c("div",{staticClass:"d-flex flex-direction-column mL10 width100"},[_c("div",{staticClass:"dialog-heading"},[_vm._v(" "+_vm._s(_vm.dialogHeader)+" ")]),_vm.stateUpdating?_c("div",{staticClass:"dialog-content mT15"},[_c("spinner",{attrs:{show:!0,size:"80"}})],1):_vm.showStatus&&_vm.statusMessage?_c("div",{staticClass:"status-message"},[_vm._v(" "+_vm._s(_vm.statusMessage)+" ")]):_c("div",{staticClass:"dialog-content mT15",domProps:{innerHTML:_vm._s(_vm.dialogContent)}})])]),_c("div",{staticClass:"modal-dialog-footer"},[_vm.showStatus?[_c("el-button",{staticClass:"modal-btn-save full-width",on:{click:_vm.closeDialog}},[_vm._v(_vm._s("CLOSE"))])]:[_c("el-button",{staticClass:"modal-btn-cancel",attrs:{disabled:_vm.stateUpdating},on:{click:_vm.closeDialog}},[_vm._v(_vm._s(_vm.$t("agent.agent.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.stateUpdating},on:{click:_vm.saveDialog}},[_vm._v(_vm._s(_vm.btnMessage))])]],2)])},NewBulkPublishvue_type_template_id_cb9b98e6_scoped_true_staticRenderFns=[],dialogHeaderHash={jobplan:{Edit:"jobplan.edit_jp",Publish:"jobplan.publish_jp",Unpublish:"jobplan.unpublish_jp",Disable:"jobplan.disable_jp"},plannedmaintenance:{Edit:"maintenance.pm._edit_pm",Publish:"maintenance.pm.publish_pm",Unpublish:"maintenance.pm.unpublish_pm",Disable:"maintenance.pm.disable_pm"}},dialogContentHash={jobplan:{Edit:"jobplan.edit_jp_content",Publish:"jobplan.publish_jp_content",Unpublish:"jobplan.unpublish_jp_content",Disable:"jobplan.disable_jp_content"},plannedmaintenance:{Edit:"maintenance.pm.edit_pm_content",Publish:"maintenance.pm.publish_pm_content",Unpublish:"maintenance.pm.unpublish_pm_content",Disable:"maintenance.pm.disable_pm_content"}},buttonTextHash={jobplan:{Edit:"jobplan.edit",Publish:"jobplan.publish",Unpublish:"jobplan.unpublish",Disable:"jobplan.disable"},plannedmaintenance:{Edit:"jobplan.edit",Publish:"jobplan.publish",Unpublish:"jobplan.unpublish",Disable:"jobplan.disable"}},NewBulkPublishvue_type_script_lang_js={props:["showDialog","dialogType","moduleName","stateUpdating","recordId","showStatus","statusMessage"],computed:{btnMessage:function(){return this.stateUpdating?"PUBLISHING...":this.buttonText},dialogHeader:function(){var dialogType=this.dialogType,moduleName=this.moduleName,dialogHeader=this.$getProperty(dialogHeaderHash,"".concat(moduleName,".").concat(dialogType),"jobplan.edit");return this.$t("".concat(dialogHeader))},dialogContent:function(){var dialogType=this.dialogType,moduleName=this.moduleName,dialogContent=this.$getProperty(dialogContentHash,"".concat(moduleName,".").concat(dialogType),"jobplan.edit_content");return this.$t("".concat(dialogContent))},buttonText:function(){var dialogType=this.dialogType,moduleName=this.moduleName,buttonText=this.$getProperty(buttonTextHash,"".concat(moduleName,".").concat(dialogType),"jobplan.edit");return this.$t("".concat(buttonText))}},methods:{closeDialog:function(){this.$emit("closeDialog")},saveDialog:function(){var dialogType=this.dialogType;this.$emit("saveAction",dialogType)}}},jobplan_NewBulkPublishvue_type_script_lang_js=NewBulkPublishvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(jobplan_NewBulkPublishvue_type_script_lang_js,NewBulkPublishvue_type_template_id_cb9b98e6_scoped_true_render,NewBulkPublishvue_type_template_id_cb9b98e6_scoped_true_staticRenderFns,!1,null,"cb9b98e6",null)
/* harmony default export */,NewBulkPublish=component.exports,PMListvue_type_script_lang_js={name:"PMList",extends:CommonModuleList["default"],data:function(){return{showStatus:!1,statusMessage:"",bulkActionFieldList:["vendor","leadTime"],bulkAction:!1,bulkActionAcount:0,isPublishLoading:!1,isUnpublishLoading:!1,showDialog:!1,dialogType:null,stateUpdating:!1,currentRecordId:null,isDisable:!1,isBulkUpdateVisible:!1,isAllSelected:!1,updateBulkRecord:!0,isBulkPublish:!1,moduleFieldList:[]}},components:{PMWarningDialog:JPWarningDialog/* default */.Z,BulkUpdateViewer:BulkUpdateViewer/* default */.Z,NewBulkActionBar:NewBulkActionBar/* default */.Z,NewBulkUpdateViewer:NewBulkUpdateViewer/* default */.Z,BulkPublish:NewBulkPublish},mounted:function(){this.updateLimit()},computed:{moduleDisplayName:function(){return this.$t("maintenance.pm.pm")},parentPath:function(){return"/app/wo/pm/"},slotList:function(){return[{criteria:JSON.stringify({name:"name"})},{name:"id",isHardcodedColumn:!0,columnAttrs:{"min-width":110,label:"ID",fixed:"left"}},{name:"editDelete",isActionColumn:!0,columnAttrs:{width:130,class:"visibility-visible-actions",fixed:"right"}}]}},methods:{updateLimit:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var actionName,params,_yield$API$get,data;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return actionName="ppmbulkupdate",params={actionName:actionName},_context.next=4,api/* API */.bl.get("v3/bulkaction/limit/fetch",params);case 4:_yield$API$get=_context.sent,data=_yield$API$get.data,data&&(_this.bulkActionAcount=data.limit);case 7:case"end":return _context.stop()}}),_callee)})))()},showBulkActionBar:function(){return(0,validation/* isEmpty */.xb)(this.selectedListItemsObj)?(this.isAllSelected=!0,!1):(this.isAllSelected=!1,this.isDisable=!1,this.isBulkUpdateVisible=!1,!0)},redirectToOverview:function(id){var moduleName=this.moduleName,viewname=this.viewname,$route=this.$route;if((0,router/* isWebTabsEnabled */.tj)()){var _ref=(0,router/* findRouteForModule */.Jp)(moduleName,router/* pageTypes */.As.OVERVIEW)||{},name=_ref.name,route={name:name,params:{viewname:viewname,id:id},query:$route.query};return name&&route}return{name:"pm-summary",params:{moduleName:moduleName,viewname:viewname,id:id},query:$route.query}},publishPm:function(isPublish){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var _ref2,selectedListItemsIds,params,url,_yield$API$post,error,successMsg;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if(_this2.stateUpdating=!0,_ref2=_this2||{},selectedListItemsIds=_ref2.selectedListItemsIds,!_this2.isBulkPublish){_context2.next=7;break}return _context2.next=5,_this2.newPublish(isPublish);case 5:_context2.next=26;break;case 7:return params={pmIds:selectedListItemsIds},url="v3/plannedmaintenance/".concat(isPublish?"bulkpublish":"bulkunpublish"),_context2.next=11,api/* API */.bl.post(url,params);case 11:if(_yield$API$post=_context2.sent,error=_yield$API$post.error,(0,validation/* isEmpty */.xb)(error)){_context2.next=17;break}_this2.$message.error(error.message||"Error occured"),_context2.next=24;break;case 17:return successMsg="",successMsg=isPublish?_this2.$t("maintenance.pm.bulk_publish_success"):_this2.$t("maintenance.pm.bulk_unpublish_success"),_this2.$message.success(successMsg),_context2.next=22,_this2.loadRecords();case 22:_this2.selectedListItemsIds=[],_this2.selectedListItemsObj=[];case 24:_this2.stateUpdating=!1,_this2.closeDialog();case 26:case"end":return _context2.stop()}}),_callee2)})))()},resetdialogStatus:function(){this.statusMessage="",this.showStatus=!1},newPublish:function(){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var filters,viewname,moduleName,_yield$API$post2,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return _this3.showStatus=!1,_this3.statusMessage="",filters=_this3.filters,viewname=_this3.viewname,moduleName=_this3.moduleName,_context3.next=5,api/* API */.bl.post("v3/bulkupdate/plannedmaintenance/publish",{moduleName:moduleName,filters:JSON.stringify(filters),viewName:viewname});case 5:_yield$API$post2=_context3.sent,error=_yield$API$post2.error,(0,validation/* isEmpty */.xb)(error)?(_this3.showStatus=!0,_this3.statusMessage="Records are published successfully"):(_this3.showStatus=!0,_this3.statusMessage=error.message||"Error occured"),_this3.stateUpdating=!1;case 9:case"end":return _context3.stop()}}),_callee3)})))()},redirectToFormCreation:function(){var moduleName=this.moduleName;if((0,router/* isWebTabsEnabled */.tj)()){var _ref3=(0,router/* findRouteForModule */.Jp)(moduleName,router/* pageTypes */.As.CREATE)||{},name=_ref3.name;name&&this.$router.push({name:name})}else this.$router.push({name:"pm-create",params:{moduleName:moduleName}})},editModule:function(record){var _ref4=record||{},pmStatus=_ref4.pmStatus,id=_ref4.id,isActive="Published"===pm_utils/* PUBLISHED_STATUS */.Iq[pmStatus];this.currentRecordId=id,isActive?this.showWarningDialog("Edit"):this.editRecord()},editRecord:function(){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){var moduleName,currentRecordId,_ref5,name;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:moduleName=_this4.moduleName,currentRecordId=_this4.currentRecordId,(0,router/* isWebTabsEnabled */.tj)()?(_ref5=(0,router/* findRouteForModule */.Jp)(moduleName,router/* pageTypes */.As.EDIT)||{},name=_ref5.name,name&&_this4.$router.push({name:name,params:{id:currentRecordId}})):_this4.$router.push({name:"pm-create",params:{moduleName:moduleName},query:{id:currentRecordId}}),_this4.currentRecordId=null;case 3:case"end":return _context4.stop()}}),_callee4)})))()},deleteRecords:function(idList){var _this5=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee5(){var moduleDisplayName,moduleName,value;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context5){while(1)switch(_context5.prev=_context5.next){case 0:return moduleDisplayName=_this5.moduleDisplayName,moduleName=_this5.moduleName,_context5.next=3,_this5.$dialog.confirm({title:"".concat(_this5.$t("custommodules.list.delete")," ").concat(moduleDisplayName),message:"".concat(_this5.$t("custommodules.list.delete_confirmation")," ").concat(moduleDisplayName,"?"),rbDanger:!0,rbLabel:_this5.$t("custommodules.list.delete"),rbClass:"pmv2-edit-dialog-btn",className:"pmv2-delete-dialog"});case 3:if(value=_context5.sent,!value){_context5.next=20;break}return _this5.isLoading=!0,_context5.prev=6,_context5.next=9,_this5.modelDataClass.delete(moduleName,idList);case 9:return _this5.$message.success("".concat(moduleDisplayName," ").concat(_this5.$t("custommodules.list.delete_success"))),_context5.next=12,_this5.refreshRecordDetails(!0);case 12:_this5.selectedListItemsIds=[],_this5.selectedListItemsObj=[],_context5.next=19;break;case 16:_context5.prev=16,_context5.t0=_context5["catch"](6),_this5.$message.error(_context5.t0);case 19:_this5.isLoading=!1;case 20:case"end":return _context5.stop()}}),_callee5,null,[[6,16]])})))()},removeMoreVisibility:function(record,isOpen){var _ref6=record||{},id=_ref6.id,element=this.$refs["pm-more-".concat(id)]||{},_ref7=element||{},classList=_ref7.classList;isOpen?classList.remove("visibility-hide-actions"):classList.add("visibility-hide-actions")},showWarningDialog:function(status){this.showDialog=!0,this.dialogType=status},closeDialog:function(){this.showDialog=!1,this.dialogType=null},saveAction:function(status){var _this6=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee6(){var isPublish;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context6){while(1)switch(_context6.prev=_context6.next){case 0:if("Edit"!==status){_context6.next=4;break}_this6.editRecord(),_context6.next=7;break;case 4:return isPublish="Publish"===status,_context6.next=7,_this6.publishPm(isPublish);case 7:case"end":return _context6.stop()}}),_callee6)})))()},newbulkActionHandler:function(actions){var _this7=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee7(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context7){while(1)switch(_context7.prev=_context7.next){case 0:
//await this.getRecordCount()
_this7.isDisable?_this7.executeBulkAction(actions):_this7.bulkActionHandler(actions);case 1:case"end":return _context7.stop()}}),_callee7)})))()},getRecordCount:function(){var _this8=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee8(){var moduleName,viewname,filters,recordCount,params;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context8){while(1)switch(_context8.prev=_context8.next){case 0:return moduleName=_this8.moduleName,viewname=_this8.viewname,filters=_this8.filters,recordCount=null,_context8.prev=2,params={moduleName:moduleName,viewname:viewname,filters:filters},_context8.next=6,_this8.modelDataClass.fetchRecordsCount(params);case 6:recordCount=_context8.sent,_context8.next=12;break;case 9:_context8.prev=9,_context8.t0=_context8["catch"](2),_this8.showErrorToastMessage(_context8.t0,_this8.$t("custommodules.list.unable_to_fetch_count"));case 12:return _context8.abrupt("return",recordCount);case 13:case"end":return _context8.stop()}}),_callee8,null,[[2,9]])})))()},executeBulkAction:function(actions){var _this9=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee9(){var fields,datas,_yield$_this9$bulkUpd,error,message;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context9){while(1)switch(_context9.prev=_context9.next){case 0:if(
// each action represents a field update
fields={},actions.forEach((function(action){var _ref8=action||{},field=_ref8.field,valueArray=_ref8.valueArray,fieldObj=_ref8.fieldObj;if("vendor"===field)fields[field]={id:parseInt(valueArray)};else if((0,validation/* isEmpty */.xb)(fieldObj))fields[field]=action.value;else{var fieldObject=fieldObj[0];
//date and dateTime Handling
6!=fieldObject.dataType&&5!=fieldObject.dataType||(0,validation/* isEmpty */.xb)(action.value)?
// other
fields[field]=action.value:fields[field]=moment_timezone_default()(action.value).valueOf()}})),datas=[],datas.push(fields),_this9.updateBulkRecord){_context9.next=11;break}return _context9.next=7,_this9.bulkUpdateWithV3(datas);case 7:_yield$_this9$bulkUpd=_context9.sent,error=_yield$_this9$bulkUpd.error,_this9.showLoading=!1,_this9.$refs["bulk-update-dialog"]&&(error?(message=null!==error&&void 0!==error&&error.message?error.message:"",_this9.$refs["bulk-update-dialog"].updateAPICallback({message:message,error:!0})):_this9.$refs["bulk-update-dialog"].updateAPICallback({message:"Records updated successfully."}));case 11:case"end":return _context9.stop()}}),_callee9)})))()},handleBulkActiondialogClose:function(){this.bulkAction=!1,this.showDialog=!1,this.dialogType=null,this.resetdialogStatus(),this.resetSelectAll(),this.loadRecords()},bulkActionHandler:function(actions){var _this10=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee10(){var fields,data,_iterator,_step,woID;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context10){while(1)switch(_context10.prev=_context10.next){case 0:
// each action represents a field update
fields={},actions.forEach((function(action){var _ref9=action||{},field=_ref9.field,valueArray=_ref9.valueArray,fieldObj=_ref9.fieldObj;if("vendor"===field)fields[field]={id:parseInt(valueArray)};else if((0,validation/* isEmpty */.xb)(fieldObj))fields[field]=action.value;else{var fieldObject=fieldObj[0];
//date and dateTime Handling
6!=fieldObject.dataType&&5!=fieldObject.dataType||(0,validation/* isEmpty */.xb)(action.value)?
// other
fields[field]=action.value:fields[field]=moment_timezone_default()(action.value).valueOf()}})),data=[],_iterator=(0,createForOfIteratorHelper/* default */.Z)(_this10.selectedListItemsIds);try{for(_iterator.s();!(_step=_iterator.n()).done;)woID=_step.value,data.push((0,objectSpread2/* default */.Z)({id:woID},fields))}catch(err){_iterator.e(err)}finally{_iterator.f()}_this10.bulkUpdate(data),_this10.closeBulkActionDialog(),_this10.resetSelectAll();case 8:case"end":return _context10.stop()}}),_callee10)})))()},resetSelectAll:function(){this.selectedListItemsIds=[],this.selectedListItemsObj=[]},bulkUpdate:function(data){var _this11=this,moduleName=this.moduleName,body={plannedmaintenance:data};return api/* API */.bl.post("v3/modules/bulkPatch/".concat(moduleName),{data:body,moduleName:moduleName}).then((function(_ref10){var error=_ref10.error;error?_this11.$message.error(_this11.$t(error.message)):_this11.$message.success("Update successful")})).then((function(){_this11.resetSelectAll(),_this11.closeBulkActionDialog(),_this11.loadRecords()})).catch((function(){_this11.$message.error("Updation failed")}))},bulkUpdateWithV3:function(fields){var _this12=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee11(){var moduleName,viewname,filters,viewName,body;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context11){while(1)switch(_context11.prev=_context11.next){case 0:return moduleName=_this12.moduleName,viewname=_this12.viewname,filters=_this12.filters,_this12.isSaving=!0,viewName=viewname,body={plannedmaintenance:fields},_this12.showLoading=!0,_context11.next=7,api/* API */.bl.post("v3/bulkupdate/plannedmaintenance/update",{data:body,moduleName:moduleName,viewName:viewName,filters:JSON.stringify(filters),count:_this12.recordCount}).catch((function(){_this12.$message.error("Updation failed")}));case 7:return _context11.abrupt("return",_context11.sent);case 8:case"end":return _context11.stop()}}),_callee11)})))()},hasUpdatePermission:function(){return this.$hasPermission("".concat(this.moduleName,":UPDATE"))},closeBulkActionDialog:function(){this.bulkAction=!1},OpenBulkUpdate:function(){var _this13=this;if(this.isDisable)if(this.recordCount>this.bulkActionAcount){var dialogObj={title:"Bulk update limit exceeds",htmlMessage:"Bulk update can be performed upto ".concat(this.bulkActionAcount,"$ records . Please ensure your selection does not exceed this limit."),rbDanger:!0,rbLabel:"Confirm"};this.$dialog.confirm(dialogObj).then((function(value){value&&(_this13.isAllSelected=!0)}))}else this.bulkAction=!0;else this.bulkAction=!0,api/* API */.bl.get("v3/bulkupdate/workorder/fetchFields",{moduleName:"plannedmaintenance"})},validateTotalCount:function(selectedItem){selectedItem?(this.isDisable=!1,this.isBulkUpdateVisible=!1,this.updateBulkRecord=!0,this.isBulkPublish=!1):(this.isDisable=!0,this.updateBulkRecord=!1,this.isBulkPublish=!0,this.recordCount>this.bulkActionAcount&&(this.isBulkUpdateVisible=!0))},clearSelection:function(){this.bulkAction=!1,this.isAllSelected=!1},enablePmBulkUpdate:function(){return this.$helpers.isLicenseEnabled("BULK_UPDATE")}}},pm_PMListvue_type_script_lang_js=PMListvue_type_script_lang_js,PMList_component=(0,componentNormalizer/* default */.Z)(pm_PMListvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,PMList=PMList_component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/48154.js.map