"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[65699],{
/***/574752:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return Avatar}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/Avatar.vue?vue&type=template&id=7f0d5689
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.user||_vm.name?_c("div",{staticClass:"fc-avatar-inline"},[_vm.avatarUrl?_c("img",{staticClass:"fc-avatar",class:_vm.sizeClass,attrs:{src:_vm.avatarUrl,alt:"Profile Avatar"}}):_c("div",{staticClass:"fc-avatar",class:_vm.sizeClass,style:_vm.bgColor},[_vm._v(" "+_vm._s(_vm.trimmedName)+" ")])]):_vm._e()},staticRenderFns=[],objectSpread2=__webpack_require__(595082),vuex_esm=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(434284),__webpack_require__(564043),__webpack_require__(709873),__webpack_require__(228436),__webpack_require__(450886),__webpack_require__(677049),__webpack_require__(821694),__webpack_require__(420629)),Avatarvue_type_script_lang_js={props:{size:{type:String},user:{type:Object},avatarStyle:{type:Object},color:{type:String},name:{type:Boolean}},data:function(){return{sizeClass:"fc-avatar-"+this.size,fullName:"",trimmedName:null,avatarUrl:null,bgColor:"background-color: "+(this.color?this.color:this.getRandomBgColor())}},computed:(0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({users:function(state){return state.users}})),mounted:function(){var _this=this;if(this.user){var userName="";if(this.user.avatarUrl)this.avatarUrl=this.user.avatarUrl;else if(this.user.id){var userObj=this.users.find((function(user){return user.id===_this.user.id}));userObj&&userObj.avatarUrl&&(this.avatarUrl=userObj.avatarUrl),userObj&&userObj.name&&(userName=userObj.name)}userName=userName||this.user.name,userName&&(this.fullName=userName,this.trimmedName=this.getAvatarName(userName),this.bgColor="background-color: "+(this.color?this.color:this.getRandomBgColor()))}else this.name&&(this.trimmedName=this.getAvatarName(this.name),this.bgColor="background-color: "+(this.color?this.color:this.getRandomBgColor()))},watch:{user:function(){var _this2=this;if(this.user.avatarUrl)this.avatarUrl=this.user.avatarUrl;else if(this.user.id){var userObj=this.users.find((function(user){return user.id===_this2.user.id}));userObj&&userObj.avatarUrl?this.avatarUrl=userObj.avatarUrl:this.avatarUrl=null}else this.avatarUrl=null;this.user.name&&(this.fullName=this.user.name,this.trimmedName=this.getAvatarName(this.user.name),this.bgColor="background-color: "+(this.color?this.color:this.getRandomBgColor()))},"user.name":function(){this.user.name&&(this.fullName=this.user.name,this.trimmedName=this.getAvatarName(this.user.name),this.bgColor="background-color: "+(this.color?this.color:this.getRandomBgColor()))},"user.avatarUrl":function(){this.user.avatarUrl?this.avatarUrl=this.user.avatarUrl:this.avatarUrl=null},"user.id":function(){var _this3=this;if(this.user.id){var userObj=this.users.find((function(user){return user.id===_this3.user.id}));userObj&&userObj.avatarUrl?this.avatarUrl=userObj.avatarUrl:this.avatarUrl=null}else this.avatarUrl=null}},methods:{getAvatarName:function(name){for(var parts=name.split(/[ -]/),initials="",initialLen=2,count=0,i=0;i<parts.length;i++)if(""!==parts[i].trim()&&(initials+=parts[i].charAt(0),count++,count>=initialLen))break;initials.length<initialLen&&name.length>=initialLen&&(initials=name.trim().substring(0,initialLen));var avatarName=initials.toUpperCase();return avatarName},getRandomBgColor:function(){var colors=["#FFBA51","#34BFA3","#FF2F82","#29D9A7","#ECDC74","#927FED","#FF61A8","#fbf383","#ac4352","#6db1f4"],userKey=this.user.email?this.user.email:this.user.name,userUniqueNum=Array.from(userKey).map((function(letter){return letter.charCodeAt(0)})).reduce((function(current,previous){return previous+current})),colorIndex=userUniqueNum%colors.length,color=colors[colorIndex];return color}}},components_Avatarvue_type_script_lang_js=Avatarvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_Avatarvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,Avatar=component.exports},
/***/512208:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return ActivitiesView}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/relatedlist/ActivitiesView.vue?vue&type=template&id=acf06790
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"block"},[_vm.loading?_c("spinner",{attrs:{show:_vm.loading}}):_vm.activities&&_vm.activities.length?_c("el-timeline",{staticClass:"wo-activity"},[_vm._l(_vm.activities,(function(activity,index){return[null!==_vm.getActivityMessage(activity).message?_c("el-timeline-item",{key:index,attrs:{type:"primary",color:activity.color,timestamp:_vm._f("formatDate")(activity.ttime)}},[3===activity.type&&activity.info.assigned?_c("div",[_c("avatar",{attrs:{size:"sm",user:{name:activity.doneBy.name}}}),_vm._v(" "+_vm._s(activity.doneBy.name)+" "),activity.info.assigned.assignedTo?[activity.info.assigned.assignedTo>0?[_c("span",{domProps:{innerHTML:_vm._s(_vm.getActivityMessage(activity).message)}}),_vm._v(" "+_vm._s(" ")+" "),_c("avatar",{attrs:{size:"sm",user:{name:_vm.getUserName(activity.info.assigned.assignedTo,activity)}}}),_vm._v(" "+_vm._s(" ")+" "),_c("i",[_vm._v(_vm._s(_vm.getUserName(activity.info.assigned.assignedTo,activity)))])]:[_c("b",[_vm._v(_vm._s(_vm.$t("common._common.removed_the_staff")))])]]:[activity.info.assigned.assignmentGroup>0?[_c("span",{domProps:{innerHTML:_vm._s(_vm.getActivityMessage(activity).message)}}),_vm._v(" "+_vm._s(_vm.$t("common.wo_report.team"))+" "),_c("i",[_vm._v(_vm._s(_vm.getGroup(activity.info.assigned.assignmentGroup,activity).name))])]:[_c("b",[_vm._v(_vm._s(_vm.$t("common._common.removed_the_team")))])]]],2):24===activity.type?_c("div",[_c("avatar",{attrs:{size:"sm",user:{name:activity.doneBy.name}}}),_vm._v(" "+_vm._s(activity.doneBy.name)+" "),_c("span",{domProps:{innerHTML:_vm._s(_vm.getActivityMessage(activity).message)}}),_c("i",[_c("span",{staticClass:"fc-id pointer",on:{click:function($event){return _vm.openPm(activity)}}},[_vm._v(" #"+_vm._s(_vm.getPmId(activity))+" ")])])],1):3!==activity.type&&24!==activity.type?_c("div",[_c("avatar",{attrs:{size:"sm",user:{name:activity.doneBy.name}}}),_vm._v(" "+_vm._s(activity.doneBy.name)+" "),_c("span",{domProps:{innerHTML:_vm._s(_vm.getActivityMessage(activity).message)}})],1):_vm._e()]):_vm._e()]}))],2):_c("div",[_vm._v(" "+_vm._s(_vm.$t("common.products.no_activities_tracked_yet"))+" ")])],1)},staticRenderFns=[],toConsumableArray=__webpack_require__(488478),objectSpread2=__webpack_require__(595082),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),vuex_esm=(__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(434284),__webpack_require__(425728),__webpack_require__(670560),__webpack_require__(564043),__webpack_require__(857267),__webpack_require__(919649),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(634338),__webpack_require__(648324),__webpack_require__(538077),__webpack_require__(879288),__webpack_require__(420629)),validation=__webpack_require__(990260),api=__webpack_require__(32284),Avatar=__webpack_require__(574752),ActivitiesMixin=__webpack_require__(832568),router=__webpack_require__(329435),ActivitiesViewvue_type_script_lang_js={props:["record","serviceportal","module"],data:function(){return{activities:[],loading:!1,userlist:[]}},mixins:[ActivitiesMixin/* default */.Z],components:{Avatar:Avatar["default"]},mounted:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(!_this.serviceportal){_context.next=5;break}return _context.next=3,_this.loadServicePortalActivities();case 3:_context.next=7;break;case 5:return _context.next=7,_this.loadActivities();case 7:_this.loadusers();case 8:case"end":return _context.stop()}}),_callee)})))()},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({users:function(state){return state.users},sites:function(state){return state.site},metaInfo:function(state){return state.view.metaInfo}})),(0,vuex_esm/* mapGetters */.Se)(["getUser","getGroup","getTicketCategory","getTicketPriority","getTicketType"])),{},{fieldsMap:function(){var _this2=this,metaInfo=this.metaInfo,map={};if(!(0,validation/* isEmpty */.xb)(metaInfo)){var fields=this.$getProperty(metaInfo,"fields",[]);fields.forEach((function(field){_this2.$setProperty(map,"".concat(field.name),field)}))}return map},recordId:function(){var record=this.record,_ref=record||{},id=_ref.id;return id}}),watch:{record:function(){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if(!_this3.serviceportal){_context2.next=5;break}return _context2.next=3,_this3.loadServicePortalActivities();case 3:_context2.next=7;break;case 5:return _context2.next=7,_this3.loadActivities();case 7:return _context2.next=9,_this3.loadusers();case 9:case"end":return _context2.stop()}}),_callee2)})))()}},created:function(){this.$store.dispatch("view/loadModuleMeta",this.module),this.$store.dispatch("loadTicketType"),this.$store.dispatch("loadTicketPriority"),this.$store.dispatch("loadSite"),this.$store.dispatch("loadGroups"),this.$store.dispatch("loadTicketCategory")},methods:{getPmId:function(activity){var _ref2=activity||{},info=_ref2.info,_ref3=info||{},addPMWO=_ref3.addPMWO,pmIdObj=(addPMWO||[]).find((function(obj){return Object.prototype.hasOwnProperty.call(obj,"pmid")}));return(0,validation/* isEmpty */.xb)(pmIdObj)?"":pmIdObj.pmid},loadServicePortalActivities:function(){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var _yield$API$get,data;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return _this4.loading=!0,_this4.modulename="workorders",_context3.next=4,api/* API */.bl.get("/v2/activity?workOrderId="+_this4.recordId);case 4:_yield$API$get=_context3.sent,data=_yield$API$get.data,_this4.activities=data,_this4.loading=!1;case 8:case"end":return _context3.stop()}}),_callee3)})))()},openPm:function(activity){var id=this.getPmId(activity);if((0,router/* isWebTabsEnabled */.tj)()){var _ref4=(0,router/* findRouteForModule */.Jp)("preventivemaintenance",router/* pageTypes */.As.OVERVIEW)||{},name=_ref4.name;name&&this.$router.push({name:name,params:{viewname:"all",id:id}})}else this.$router.replace({path:"/app/wo/planned/summary/"+id})},loadusers:function(){var _this5=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){var activities,assignedToIds,userIds,params,_yield$API$get2,data,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:if(_this5.loading=!0,activities=_this5.activities,// let ouids = [],
assignedToIds=[],activities.forEach((function(activity){var $getProperty=_this5.$getProperty,assignedToId=$getProperty(activity,"info.assigned.assignedTo",null);
// let ouid = $getProperty(activity, 'doneBy.ouid', null)
// !isEmpty(ouid) && ouids.push(`${ouid}`)
(0,validation/* isEmpty */.xb)(assignedToId)||-99===assignedToId||assignedToIds.push("".concat(assignedToId))})),userIds=(0,toConsumableArray/* default */.Z)(new Set([].concat(assignedToIds))),(0,validation/* isEmpty */.xb)(userIds)){_context4.next=13;break}return params={includeParentFilter:!0,filters:JSON.stringify({ouid:{operatorId:36,value:userIds}})},_context4.next=9,api/* API */.bl.get("/setup/portalUsersList",params);case 9:_yield$API$get2=_context4.sent,data=_yield$API$get2.data,error=_yield$API$get2.error,error||(_this5.userlist=(null===data||void 0===data?void 0:data.users)||[]);case 13:_this5.loading=!1;case 14:case"end":return _context4.stop()}}),_callee4)})))()},getUserName:function(id){if(id){var usr=[];if(usr=this.users.filter((function(us){return us.ouid===id})),usr.length){var userName=usr[0].name;return userName}if(this.userlist.length){var us=[];if(us=this.userlist.filter((function(u){return u.ouid===id})),us.length){var _userName=us[0].name;return _userName}return"---1"}return"---2"}return"---3"},loadActivities:function(){var _this6=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee5(){var params,_yield$API$get3,error,data;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context5){while(1)switch(_context5.prev=_context5.next){case 0:return _this6.loading=!0,params={},"asset"===_this6.module?(_this6.modulename="assets",params.assetId=_this6.recordId):"workorder"===_this6.module&&(_this6.modulename="workorders",params.workOrderId=_this6.recordId),_context5.next=5,api/* API */.bl.get("/v2/".concat(_this6.modulename,"/activity"),params);case 5:_yield$API$get3=_context5.sent,error=_yield$API$get3.error,data=_yield$API$get3.data,error||(_this6.activities=data.activity,_this6.loading=!1);case 9:case"end":return _context5.stop()}}),_callee5)})))()},
// getAttachmentsString(obj) {
//   let str = ''
//   for (let item = 0; item < (obj || []).length; item++) {
//     if (item !== 0) {
//       if (item === obj.length - 1) {
//         str += ' and '
//       } else {
//         str += ', '
//       }
//     }
//     str += obj[item]
//   }
//   return str
// },
// getUserCall(names) {
//   if (this.serviceportal) {
//     if (this.$account.user.id === names) {
//       return this.$account.user.name
//     } else {
//       return this.getUser(names).name
//     }
//   } else {
//     return this.getUser(names).name
//   }
// },
// getAssignedBy(updatedFields) {
//   let user = updatedFields.find(el => el.fieldName === 'assignedTo')
//   if (user.newValue) {
//     return this.getUser(user.newValue.id).name
//   } else if (user.oldValue) {
//     return this.getUser(user.oldValue.id).name
//   }
// },
// getLocation(value) {
//   return this.$helpers.parseLocation(value)
// },
// compare(str1, str2) {
//   return !str1.localeCompare(str2)
// },
getTicket:function(info){var _ref5=info||{},field=_ref5.field,displayName=_ref5.displayName,newValue=_ref5.newValue;if("type"===field){var _ref6=this.getTicketType(newValue)||{},ticketTypeName=_ref6.name;return"<b>"+displayName+"</b> as <i>"+ticketTypeName+"</i>"}if("category"===field){var _ref7=this.getTicketCategory(newValue)||{},ticketCategoryDisplayName=_ref7.displayName;return"<b>"+displayName+"</b> as <i>"+ticketCategoryDisplayName+"</i>"}if("priority"===field){var _ref8=this.getTicketPriority(newValue)||{},ticketPriorityDisplayName=_ref8.displayName;return"<b>"+displayName+"</b> as <i>"+ticketPriorityDisplayName+"</i>"}if("dueDate"===field)return"<b>"+displayName+"</b> as <i>"+this.$options.filters.formatDate(newValue)+"</i>";if("resource"===field)return"<b>"+displayName+"</b> as <i>"+newValue+"</i>";if("site"===field)return"<b>"+displayName+"</b> as <i>"+this.getSiteName(newValue)+"</i>";var fieldsMap=this.fieldsMap,_ref9=info||{},fieldName=_ref9.field,_newValue=_ref9.newValue,_field=fieldsMap[fieldName]||{},displayValue=_newValue;return(0,validation/* isEmpty */.xb)(_field)||((0,validation/* isArray */.kJ)(displayValue)||Number(displayValue)&&(displayValue=Number(displayValue)),displayValue=this.$fieldUtils.getDisplayValue(_field,displayValue)),"<b>"+displayName+"</b> as <i>"+displayValue+"</i>"},getSiteName:function(siteId){var site=(this.sites||[]).find((function(site){return site.id===siteId}));return site?site.name:""},getActivityMessage:function(activity){var _this7=this,_ref10=activity||{},type=_ref10.type,info=_ref10.info,message=_ref10.message;if((0,validation/* isEmpty */.xb)(info)||(0,validation/* isEmpty */.xb)(type))return 2===type?{message:"<b> closed all the tasks  </b>"}:{message:"<b>  </b>"};if(4===type&&info.addWO)return{message:"<b>created workorder</b>"};if(24===type&&info.addPMWO&&info.addPMWO.length>2)return{message:"<b> created workorder from PM</b>"};if(5===type&&info.status)return{message:"<b>".concat(info.status.toLowerCase(),"</b> the Work Order")};if(5===type&&info.woupdate){
// let a3 = []
var woupdate=info.woupdate.filter((function(a){return"modifiedTime"!==a.field&&-99!==a.newValue&&a.oldValue!==a.newValue}));
// a3 = a3.filter(a => a.newValue !== -99)
return(0,validation/* isEmpty */.xb)(woupdate)?{message:null}:{message:"<b>updated </b>"+woupdate.reduce((function(accStr,activity){return(0,validation/* isEmpty */.xb)(accStr)?_this7.getTicket(activity):"".concat(accStr,", ").concat(_this7.getTicket(activity))}),"")}}if(3===type)return{message:"<b> assigned </b> the Work Order to"};if(10===type)return{message:"<b> attached </b> <i> ".concat(info.attachment[0].Filename," </i>")};if(36===type)return{message:"<b> added prerequisite photo </b> <i> ".concat(info.taskattachment[0].Filename," </i>")};if(38===type)return{message:"<b> removed prerequisite photo </b> <i> ".concat(info.taskattachment[0].Filename," </i>")};if(37===type)return{message:"<b> approved prerequisite </b>"};if(23===type)return{message:"<b> closed the task </b> <i> ".concat(info.subject," </i>")};if(25===type)return{message:"<b> reopened the task </b> <i> ".concat(info.subject," </i>")};if(8===type)return{message:"<b>"+message+"</b><i>"+info.Task[0].Task+"</i>"};if(12===type)return{message:"<b>updated task ("+info.taskupdate.subject+")</b> input value as <i>"+info.taskupdate.newvalue+"</i>"};if(35===type)return{message:"<b>updated prerequisite ("+info.taskupdate.subject+")</b> input value as <i>"+info.taskupdate.newvalue+"</i>"};if(26===type)return{message:"<b>updated status </b>from <i>"+info.oldValue+" to "+info.newValue+"</i>"};if(9===type)return{message:"<b> added the Comment </b> <i> (".concat(info.Comment,") </i>")};if(113===type)return{message:"<b> deleted the Comment </b> <i> (".concat(info.Comment,") </i>")};if(60===type)return{message:info.message};if(61===type){var _ref11=info||{},_message=_ref11.message,slaEntity=_ref11.slaEntity;return{message:" - "+"<strong>".concat(_message,"</strong>")+(slaEntity?" for ":" ")+(slaEntity||"")}}if(62!==type)return this.getMessage(activity);var _ref12=info||{},name=_ref12.name,slaEntityName=_ref12.slaEntityName,oldDate=_ref12.oldDate,newDate=_ref12.newDate,formatDate=this.$options.filters.formatDate,slaEntityDisplayName=slaEntityName||name||"SLA Date";return(0,validation/* isEmpty */.xb)(oldDate)||(0,validation/* isEmpty */.xb)(newDate)?(0,validation/* isEmpty */.xb)(newDate)?void 0:{message:"has changed <strong>".concat(slaEntityDisplayName,"</strong>  to ")+"<i>".concat(formatDate(newDate,!0,!1),"</i>")}:{message:"has changed <strong>".concat(slaEntityDisplayName,"</strong>  from ")+"<i>".concat(formatDate(oldDate,!0,!1),"</i> to")+"<i>".concat(formatDate(newDate,!0,!1),"</i>")}}}},relatedlist_ActivitiesViewvue_type_script_lang_js=ActivitiesViewvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(relatedlist_ActivitiesViewvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,ActivitiesView=component.exports},
/***/832568:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return ActivitiesMixin}});
// EXTERNAL MODULE: ./node_modules/core-js/modules/es.array.find.js
__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(434284),__webpack_require__(976801),__webpack_require__(538077),__webpack_require__(634338),__webpack_require__(879288),__webpack_require__(450886),__webpack_require__(506203),__webpack_require__(689730);
// EXTERNAL MODULE: ./node_modules/core-js/modules/es.object.to-string.js
var render,staticRenderFns,validation=__webpack_require__(990260),field_utils=__webpack_require__(455344),isEqual=__webpack_require__(618446),isEqual_default=__webpack_require__.n(isEqual),ActivitiesMixinvue_type_script_lang_js={methods:{getUserName:function(id){if(id){var user=null;return user=(this.users||[]).find((function(us){return us.ouid===id})),user?user.name:(0,validation/* isEmpty */.xb)(this.portalUserList)?"---2":(user=(this.portalUserList||[]).find((function(u){return u.ouid===id})),user?user.name:"---1")}return"---3"},getAttachmentsString:function(obj){for(var str="",item=0;item<(obj||[]).length;item++)0!==item&&(item===obj.length-1?str+=" and ":str+=", "),str+=obj[item];return str},getAssignedBy:function(updatedFields){var user=(updatedFields||[]).find((function(el){return"assignedTo"===el.fieldName}));return user.newValue?this.getUser(user.newValue.id).name:user.oldValue?this.getUser(user.oldValue.id).name:void 0},getLocation:function(value){return this.$helpers.parseLocation(value)},getMessage:function(activity){var _this=this,_ref=activity||{},info=_ref.info,module=this.module,fieldsMap=this.fieldsMap;if("newreadingalarm"===module)return this.processAlarmActivity(activity);if([63,64,70,71].includes(activity.type))return this.formatQuotationActivity(activity);if(75===activity.type&&!(0,validation/* isEmpty */.xb)(info.changeSet)){var filteredArr=info.changeSet.filter((function(a){var _ref2=a||{},fieldName=_ref2.field,newValue=_ref2.newValue,oldValue=_ref2.oldValue,field=fieldsMap[fieldName]||{},isMultiLookupChanged=!0;return(0,field_utils/* isMultiLookupField */.Xn)(field)&&(isMultiLookupChanged=(newValue||[]).length!==(oldValue||[]).length),isMultiLookupChanged&&"modifiedTime"!==a.field&&-99!==a.newValue&&!((0,validation/* isEmpty */.xb)(a.oldValue)&&(0,validation/* isEmpty */.xb)(a.newValue))&&!isEqual_default()(a.oldValue,a.newValue)&&"moduleState"!==a.field&&"sysModifiedTime"!==a.field}));return(0,validation/* isEmpty */.xb)(filteredArr)?{message:null}:{message:"<b>updated </b>"+filteredArr.reduce((function(accStr,activity){return(0,validation/* isEmpty */.xb)(accStr)?_this.getValue(activity):"".concat(accStr,", ").concat(_this.getValue(activity))}),"")}}
// 64,66,69,71,72 Common Activities for Comment, Attachments, Status Update, Approval, Approval Entry respectively
// use same for other modules
if(65===activity.type)return{message:"<b> added the Comment </b><i>("+this.$getProperty(activity,"info.Comment","")+")</i>"};if(66===(activity||{}).type)return{message:"<b>attached </b><i>"+this.$getProperty(activity,["info","attachment",0,"Filename"],"")+"</i>"};if(69===(activity||{}).type)return{message:"<b>updated status </b>from <i>"+this.$getProperty(activity,"info.oldValue","")+" to "+this.$getProperty(activity,"info.newValue","")+"</i>"};if(72===(activity||{}).type){
// Approval Activity Message
var metaInfo=this.metaInfo,_ref3=metaInfo||{},_module=_ref3.module,_ref4=_module||{},displayName=_ref4.displayName;(0,validation/* isEmpty */.xb)(displayName)&&(displayName=_module);var approvalMessage="",approvalStatus=this.$getProperty(activity,"info.status",""),moduleSingularDisplayName=this.$constants.moduleSingularDisplayNameMap[_module]?this.$constants.moduleSingularDisplayNameMap[_module]:displayName;return"Approved"===approvalStatus?approvalMessage="<b> approved the ".concat(moduleSingularDisplayName,"</b>"):"Rejected"===approvalStatus?approvalMessage="<b> rejected the ".concat(moduleSingularDisplayName,"</b>"):"Requested"===approvalStatus&&(approvalMessage="<b> resent for Approval.</b>"),{message:approvalMessage}}if(73===(activity||{}).type)return{message:"<b> initiated Approval process</b>"};if(109===(activity||{}).type){var employee=((null===info||void 0===info?void 0:info.changeSet)||[]).find((function(a){return"employee"===a.field&&a.newValue>0&&a.oldValue!==a.newValue}));return employee?{message:"<b> assigned <i>".concat(info.empName,"</i> to desk <i>").concat(info.deskName,"</i> </b>")}:{message:null}}if(110===(activity||{}).type){var _employee=((null===info||void 0===info?void 0:info.changeSet)||[]).find((function(a){return"employee"===a.field&&a.oldValue>0&&a.oldValue!==a.newValue}));return _employee?{message:"<b> unassigned <i>".concat(info.empName,"</i> from desk <i>").concat(info.deskName,"</i> </b>")}:{message:null}}return{message:"<b>"+activity.message+"</b>"}},getValue:function(info){var fieldsMap=this.fieldsMap,_ref5=info||{},fieldName=_ref5.field,newValue=_ref5.newValue,oldValue=_ref5.oldValue,field=fieldsMap[fieldName]||{},displayValue=newValue,displayOldValue=oldValue;if(!(0,validation/* isEmpty */.xb)(field)&&((0,validation/* isArray */.kJ)(displayValue)||Number(displayValue)&&(displayValue=Number(displayValue)),displayValue=this.$fieldUtils.getDisplayValue(field,displayValue),(0,validation/* isArray */.kJ)(displayOldValue)||Number(displayOldValue)&&(displayOldValue=Number(displayOldValue)),!(0,validation/* isEmpty */.xb)(displayOldValue)))if((0,field_utils/* isMultiLookupField */.Xn)(field)){var lookupRecordNames=(displayOldValue||[]).map((function(currRecord){return currRecord.displayName||currRecord.name||currRecord.subject}));displayOldValue=lookupRecordNames.length>5?"".concat(lookupRecordNames.slice(0,5).join(", ")," +").concat(Math.abs(lookupRecordNames.length-5)):(0,validation/* isEmpty */.xb)(lookupRecordNames)?"---":"".concat(lookupRecordNames.join(", "))}else displayOldValue=this.$fieldUtils.getDisplayValue(field,displayOldValue);return(0,validation/* isEmpty */.xb)(displayOldValue)||"---"===displayOldValue?"<b>"+info.displayName+"</b> as <i>"+displayValue+"</i>":"<b>"+info.displayName+"</b> from <i>"+displayOldValue+"</i> to <i>"+displayValue+"</i>"},processAlarmActivity:function(activity){return 50===activity.type?{message:"<b>created alarm occurrence </b>"}:51===activity.type?{message:"<b> created workorder </b>"}:53===activity.type?{message:"<b> Acknowledged Alarm </b>"}:54===activity.type?{message:"<b> added the Comment </b><i>("+activity.infoJsonStr.Comment+")</i>"}:56===activity.type?{message:"<b> alarm occurrence cleared </b>"}:57===activity.type?{message:"<b> Auto Cleared </b>"}:"Activity"},formatQuotationActivity:function(activity){var amount,message="",val=this.$getProperty(activity,"info.totalCost",null);return val&&(val=this.$d3.format(",.2f")(val),amount="$"===this.$currency||"₹"===this.$currency?this.$currency+val:val+" "+this.$currency),63===activity.type?message="<b> Created the Quote for </b>"+(amount?"<i>".concat(amount,"</i>"):""):64===activity.type?message="<b> Updated the Quote.</b>"+(amount?"<b> Amount changed to</b> <i>".concat(amount,"</i>"):""):70===activity.type?message="<b> Associated Term(s)</b> <i>".concat(this.$getProperty(activity,"info.termsName"),"</i>"):71===activity.type&&(message="<b> Disassociated Term(s) </b> <i>".concat(this.$getProperty(activity,"info.termsName"),"</i>")),{message:message}}}},widget_ActivitiesMixinvue_type_script_lang_js=ActivitiesMixinvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(widget_ActivitiesMixinvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,ActivitiesMixin=component.exports},
/***/465699:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return History}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/workorder/workorders/v3/widgets/History.vue?vue&type=template&id=39e1a31a
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"pm-summary-inner-container mT20 height100"},[_c("div",{staticClass:"width100 height100 fc-summary-content-scroll"},[_c("div",{staticClass:"p30 pL80 pT30"},[_c("ActivitiesView",{ref:"activitiesDiv",attrs:{record:_vm.workorder,module:_vm.currModuleName}})],1)])])},staticRenderFns=[],ActivitiesView=__webpack_require__(512208),Historyvue_type_script_lang_js={name:"Resource",components:{ActivitiesView:ActivitiesView/* default */.Z},props:["moduleName","details"],computed:{currModuleName:function(){return"workorder"},widgetTitle:function(){return"Resource"},workorder:function(){return this.details.workorder}}},widgets_Historyvue_type_script_lang_js=Historyvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(widgets_Historyvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,History=component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/65699.js.map