(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[3926,26737],{
/***/720096:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return PreviewFile}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/PreviewFile.vue?vue&type=template&id=447c7e89
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.currentFile?_c("div",{directives:[{name:"show",rawName:"v-show",value:_vm.show,expression:"show"}],staticClass:"preview-file"},[_c("div",{staticClass:"top-toolbar"},[_c("div",{staticClass:"a-top-toolbar"},[_c("div",{staticClass:"file-name word-break-keep"},[_vm._v(" "+_vm._s(_vm.currentFile.fileName)+" ")]),_c("div",{staticClass:"top-toolbar-icon-right flex align-center"},[_vm.currentFile.contentType.includes("image")?[_c("div",{staticClass:"flex-middle pL15"},[_vm.showOriginalImage?_c("div",{staticClass:"fc-white-14 word-break-keep pointer",on:{click:_vm.showOriginalPhoto}},[_vm._v(" "+_vm._s(_vm.$t("common._common.view_original"))+" ")]):_vm._e(),_vm.showCompressedImage?_c("div",{staticClass:"fc-white-14 word-break-keep pointer",on:{click:_vm.showCompressedPhoto}},[_vm._v(" "+_vm._s(_vm.$t("common._common.view_default"))+" ")]):_vm._e()]),_c("div",{staticClass:"download-icon round flex-middle pL15",on:{click:function($event){return _vm.downloadAttachment(_vm.currentFile)}}},[_c("i",{staticClass:"el-icon-download op8",staticStyle:{color:"#ffff"}})])]:_vm._e(),_vm.currentFile.contentType.includes("pdf")?[_c("div",{staticClass:"download-icon round flex-middle pL15",on:{click:function($event){return _vm.downloadAttachment(_vm.currentFile)}}},[_c("i",{staticClass:"el-icon-download op8",staticStyle:{color:"#ffff"}})])]:_vm._e(),_vm.showDeleteOption()?_c("div",{staticClass:"flex-middle pL15",on:{click:function($event){return _vm.deletePreview()}}},[_c("inline-svg",{staticClass:"pointer edit-icon-color close vertical-text-top",attrs:{src:"svgs/delete",iconClass:"icon icon-md"}})],1):_vm._e(),_c("div",{staticClass:"pL15"},[_c("i",{staticClass:"el-icon-close close",on:{click:_vm.closePreview}})])],2)])]),_vm.currentFileIndex>0?_c("a",{staticClass:"el-icon-arrow-left prev",staticStyle:{"font-size":"30px"},on:{click:function($event){return _vm.plusSlides(-1)}}}):_vm._e(),_vm.currentFileIndex<_vm.files.length-1?_c("a",{staticClass:"el-icon-arrow-right next",staticStyle:{"font-size":"30px"},on:{click:function($event){return _vm.plusSlides(1)}}}):_vm._e(),_c("div",{staticClass:"preview-content"},[_vm.currentFile.contentType.includes("image")?[_vm.compressedImage?_c("img",{staticClass:"content",staticStyle:{"box-shadow":"none"},attrs:{src:_vm.$prependBaseUrl(_vm.currentFile.previewUrl)}}):_vm.originalImage?_c("img",{staticClass:"content original",staticStyle:{"box-shadow":"none"},attrs:{src:_vm.$prependBaseUrl(_vm.currentFile.previewUrl+"?fetchOriginal=true")}}):_vm._e()]:_vm.currentFile.contentType.includes("pdf")?_c("div",{staticClass:"width100 height-100"},[_c("iframe",{staticClass:"fc-preview-pdf",attrs:{src:_vm.$prependBaseUrl(_vm.currentFile.previewUrl),height:"100%",width:"100%"}})]):_vm.isVideoSupported(_vm.currentFile.contentType)?_c("div",{staticClass:"width100 height-100 fc-preview-video"},[_c("video",{attrs:{controls:""}},[_c("source",{attrs:{src:_vm.$prependBaseUrl(_vm.$getProperty(_vm.currentFile,"downloadUrl",null)),type:_vm.$getProperty(_vm.currentFile,"contentType")}}),_vm._v(" "+_vm._s(_vm.$t("common._common.browser_not_supported"))+" ")])]):_c("div",{staticClass:"no-preview"},[_c("div",{staticClass:"flex justify-center pT24"},[_c("inline-svg",{staticClass:"d-flex",attrs:{src:_vm.getFileIcon(_vm.currentFile),iconClass:"icon icon-60 overlay"}})],1),_c("div",{staticClass:"f14 pT12 pB12"},[_vm._v("No preview available")]),_c("div",{staticClass:"download-button"},[_c("a",{staticClass:"flex flex-row",staticStyle:{color:"#ffff"},on:{click:function($event){return _vm.downloadAttachment(_vm.currentFile)}}},[_c("div",[_vm._v("Download")])])])])],2),_vm.exportDownloadUrl?_c("iframe",{staticStyle:{display:"none"},attrs:{src:_vm.exportDownloadUrl}}):_vm._e()]):_vm._e()},staticRenderFns=[],validation=(__webpack_require__(339772),__webpack_require__(260228),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(228436),__webpack_require__(990260)),PreviewFilevue_type_script_lang_js={props:["previewFile","files","visibility","showDelete","isLockedState","isTaskClosed"],data:function(){return{show:!0,previewUrl:null,currentFileIndex:0,currentFile:null,imageMargin:null,exportDownloadUrl:null,originalImage:!1,compressedImage:!0,showOriginalImage:!0,showCompressedImage:!1}},destroyed:function(){window.removeEventListener("keyup",this.handler)},mounted:function(){window.addEventListener("keyup",this.handler),this.preloadImages()},watch:{},computed:{},methods:{handler:function(){
// If escape key is pressed...
27===event.keyCode?this.closePreview():37===event.keyCode?this.plusSlides(-1):39===event.keyCode&&this.plusSlides(1)},preloadImages:function(){this.currentFile=this.previewFile?this.previewFile:this.files[0],this.currentFileIndex=this.files.indexOf(this.currentFile)},plusSlides:function(n){var index=this.currentFileIndex+n;index<0&&(index=0),index>=this.files.length&&(index=this.files.length-1),this.currentFileIndex=index,this.currentFile=this.files[index]},closePreview:function(){this.$emit("update:visibility",!1)},deletePreview:function(){var currentFile=this.currentFile;this.$emit("onDelete",currentFile)},downloadAttachment:function(file){var _this=this,_ref=file||{},url=_ref.downloadUrl;this.exportDownloadUrl&&(this.exportDownloadUrl=null),this.$nextTick((function(){_this.exportDownloadUrl=url}))},showOriginalPhoto:function(){this.originalImage=!0,this.showCompressedImage=!0,this.showOriginalImage=!1,this.compressedImage=!1},showCompressedPhoto:function(){this.showCompressedImage=!1,this.originalImage=!1,this.showOriginalImage=!0,this.compressedImage=!0},getFileIcon:function(attachment){var contentType=attachment.contentType,FILE_TYPE_ICONS=this.$constants.FILE_TYPE_ICONS,selectedIndex=FILE_TYPE_ICONS.findIndex((function(icons){var fileTypes=icons.fileTypes;return fileTypes.some((function(type){return contentType.includes(type)}))}));return(0,validation/* isEmpty */.xb)(selectedIndex)?FILE_TYPE_ICONS[0].path:FILE_TYPE_ICONS[selectedIndex].path},isVideoSupported:function(contentType){contentType=contentType||"";var supportedTypes=["video/webm","video/mp4","video/ogg"];return supportedTypes.includes(contentType.trim().toLowerCase())},showDeleteOption:function(){var showDelete=this.showDelete,isLockedState=this.isLockedState,isTaskClosed=this.isTaskClosed;return showDelete&&!isLockedState&&!isTaskClosed}}},components_PreviewFilevue_type_script_lang_js=PreviewFilevue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_PreviewFilevue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,PreviewFile=component.exports},
/***/281375:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return Attachments}});
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/objectSpread2.js
var render,staticRenderFns,objectSpread2=__webpack_require__(595082),validation=(__webpack_require__(634338),__webpack_require__(677049),__webpack_require__(821694),__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(434284),__webpack_require__(891719),__webpack_require__(339772),__webpack_require__(670560),__webpack_require__(162506),__webpack_require__(821057),__webpack_require__(990260)),Attachmentsvue_type_script_lang_js={props:["module","record","parentModule"],data:function(){return{loading:!0,status:{UPLOADING:1,SUCCESS:2,FAILED:3},attachments:[],formFieldName:"attachment",selectedAttachedFile:null,visibility:!1}},mounted:function(){this.loadAttachments()},watch:{record:function(){this.loadAttachments()},attachments:function(){var _this$attachments=this.attachments,attachments=void 0===_this$attachments?[]:_this$attachments;this.record.noOfAttachments=(attachments||[]).length}},methods:{loadAttachments:function(){var _this=this;this.loading=!0;var url="/attachment?module=".concat(this.module,"&recordId=").concat(this.record.id);return(0,validation/* isEmpty */.xb)(this.parentModule)||(url+="&parentModuleName=".concat(this.parentModule)),this.$http.get(url).then((function(response){_this.loading=!1,_this.attachments=response.data.attachments?response.data.attachments:[]})).catch((function(error){error&&(_this.loading=!1,_this.attachments=null)}))},filesChange:function(file){var _this2=this,fileList=Array.from(file);if(fileList.length){
// Append the files to FormData
var formData=new FormData;formData.append("module",this.module),formData.append("recordId",this.record.id),formData.append("parentModuleName",this.parentModule);var _this$status=this.status,UPLOADING=_this$status.UPLOADING,SUCCESS=_this$status.SUCCESS,FAILED=_this$status.FAILED;fileList.forEach((function(file){var _ref=file||{},name=_ref.name,size=_ref.size,type=_ref.type,fileEntry={fileId:-1,fileName:name,fileSize:size,contentType:type,status:UPLOADING,error:null,previewUrl:null,uploadedBy:_this2.$account.user.id};formData.append(_this2.formFieldName,file,name),_this2.attachments.unshift(fileEntry)})),this.$http.post("/attachment/add",formData).then((function(_ref2){var data=_ref2.data;data.attachments.forEach((function(attachment){var fileId=attachment.fileId,fileName=attachment.fileName,fileSize=attachment.fileSize,attachmentIdx=_this2.attachments.findIndex((function(a){return a.fileName===fileName&&a.fileSize===fileSize}));if(!(0,validation/* isEmpty */.xb)(attachmentIdx)){var attachmentFile=_this2.attachments[attachmentIdx];attachmentFile=fileId?(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},attachmentFile),attachment),{},{status:SUCCESS}):(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},attachmentFile),{},{status:FAILED,error:"Upload failed."}),_this2.$set(_this2.attachments,attachmentIdx,attachmentFile)}}))})).catch((function(){fileList.forEach((function(file){var _ref3=file||{},name=_ref3.name,size=_ref3.size,attachmentIdx=_this2.attachments.findIndex((function(a){return a.fileName===name&&a.fileSize===size}));if(!(0,validation/* isEmpty */.xb)(attachmentIdx)){var attachmentFile=_this2.attachments[attachmentIdx];attachmentFile=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},attachmentFile),{},{status:FAILED,error:"Upload failed."}),_this2.$set(_this2.attachments,attachmentIdx,attachmentFile)}}))}))}},canShowDelete:function(attachment){var _ref4=attachment||{},uploadedBy=_ref4.uploadedBy,status=_ref4.status,SUCCESS=this.status.SUCCESS;return((0,validation/* isEmpty */.xb)(status)||status===SUCCESS)&&uploadedBy===this.$account.user.id},deleteAttachment:function(attachment,index){var _this3=this,ids=[],module=this.module,parentModule=this.parentModule,record=this.record;ids.push(attachment.id);var obj={attachmentId:ids,module:module,parentModuleName:parentModule,recordId:null===record||void 0===record?void 0:record.id};this.$dialog.confirm({title:"Delete Attachment",message:"Are you sure you want to delete this attachment",rbDanger:!0,rbLabel:"Delete"}).then((function(value){value&&_this3.$http.post("/v2/attachments/delete",obj).then((function(_ref5){var _ref5$data=_ref5.data,message=_ref5$data.message,responseCode=_ref5$data.responseCode;_ref5$data.result;if(0!==responseCode)throw new Error(message);_this3.attachments.splice(index,1),_this3.loadAttachments()}))}))}}},base_Attachmentsvue_type_script_lang_js=Attachmentsvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(base_Attachmentsvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,Attachments=component.exports;
// EXTERNAL MODULE: ./node_modules/core-js/modules/es.array.concat.js
},
/***/349318:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return Comments}});
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/objectSpread2.js
var render,staticRenderFns,objectSpread2=__webpack_require__(595082),esm_typeof=__webpack_require__(103336),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),vuex_esm=(__webpack_require__(634338),__webpack_require__(670560),__webpack_require__(843097),__webpack_require__(420629)),api=__webpack_require__(32284),Commentsvue_type_script_lang_js={props:["module","record","notify","parentModule","isServicePortal","setNoOfNotesLength"],created:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.next=2,_this.availablePortalApps();case 2:_this.canShowSharing&&(_this.newComment.commentSharing=_this.defaultSharingApps),_this.loadComments();case 4:case"end":return _context.stop()}}),_callee)})))()},data:function(){return{isAddingNotes:!1,loading:!0,selectedPortal:[],portalApps:[],defaultSharingApps:[],comments:[],newComment:{parentModuleLinkName:this.module,parentId:this.record.id,body:null,notifyRequester:!1,commentSharing:[]},commentFocus:!1}},watch:{record:function(recordObj){this.loadComments()},comments:function(newVal){this.record&&"object"===(0,esm_typeof/* default */.Z)(this.record)&&this.setNoOfNotesLength&&
//this.record.noOfNotes = this.comments.length
this.setNoOfNotesLength(this.comments.length)}},computed:(0,objectSpread2/* default */.Z)({showNotifyRequester:function(){return"undefined"===typeof this.notify||this.notify}},(0,vuex_esm/* mapGetters */.Se)(["getCurrentUser"])),methods:{availablePortalApps:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var _yield$API$get,error,data,licensedPortalApps,commentSharingPreferences;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,api/* API */.bl.get("/v3/commentPreferences/sharingOptions");case 2:_yield$API$get=_context2.sent,error=_yield$API$get.error,data=_yield$API$get.data,error?_this2.$message.error(error.message||_this2.$t("common._common.error_occured")):(licensedPortalApps=data.licensedPortalApps,commentSharingPreferences=data.commentSharingPreferences,_this2.portalApps=licensedPortalApps,_this2.defaultSharingApps=commentSharingPreferences);case 6:case"end":return _context2.stop()}}),_callee2)})))()},loadComments:function(){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var url;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:if(_this3.record&&"object"===(0,esm_typeof/* default */.Z)(_this3.record)){_context3.next=2;break}return _context3.abrupt("return");case 2:return _this3.loading=!0,_this3.newComment.parentId=_this3.record.id,url="/note/get?module=",_this3.isServicePortal&&(url="/notelist?module="),_context3.abrupt("return",_this3.$http.get(url+_this3.module+"&parentId="+_this3.record.id+"&parentModuleName="+_this3.parentModule).then((function(response){_this3.loading=!1,_this3.comments=response.data})).catch((function(error){_this3.loading=!1,_this3.comments=[]})));case 7:case"end":return _context3.stop()}}),_callee3)})))()},reset:function(){this.newComment={parentModuleLinkName:this.module,parentId:this.record.id,body:null,notifyRequester:!1},this.canShowSharing&&(this.newComment.commentSharing=this.defaultSharingApps)},addComment:function(){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){var param,url,record,parentModule,module,_yield$API$post,data,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:if(!_this4.newComment.body){_context4.next=13;break}return _this4.isServicePortal&&(_this4.newComment.notifyRequester=!0),param={note:_this4.newComment,module:_this4.module,parentModuleName:_this4.parentModule},"basealarmnotes"===_this4.module&&(param.alarmOccurrenceId=_this4.record.occurrence?_this4.record.occurrence.id:-1),_this4.isAddingNotes=!0,url="v2/notes/add",_this4.$helpers.isLicenseEnabled("THROW_403_WEBTAB")&&(record=_this4.record,parentModule=_this4.parentModule,module=_this4.module,url="v2/notes/".concat(module,"/").concat(parentModule,"/add/").concat(record.id)),_context4.next=9,api/* API */.bl.post(url,param);case 9:_yield$API$post=_context4.sent,data=_yield$API$post.data,error=_yield$API$post.error,error?_this4.$message.error(error.message||"Error Occured"):(_this4.reset(),_this4.comments.push(data.Notes),_this4.closeComment(),_this4.isAddingNotes=!1);case 13:case"end":return _context4.stop()}}),_callee4)})))()}}},base_Commentsvue_type_script_lang_js=Commentsvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(base_Commentsvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,Comments=component.exports;
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/typeof.js
},
/***/77098:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return relatedlist_Attachments}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/relatedlist/Attachments.vue?vue&type=template&id=85c96020
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"fc-attachments"},[_vm.loading?_c("div",{staticClass:"text-center"},[_c("spinner",{attrs:{show:_vm.loading}})],1):_c("div",[_vm._l(_vm.attachments,(function(attachment,index){return _c("div",{key:attachment.attachmentId,staticClass:"fc-attachment-row visibility-visible-actions"},[_c("div",{staticClass:"attachment-label pointer"},[attachment.previewUrl?_c("a",{on:{click:function($event){return _vm.selectedFile(attachment)}}},[_vm._v(_vm._s(attachment.fileName))]):_c("span",[_vm._v(_vm._s(attachment.fileName))])]),_c("div",{staticClass:"attachment-sublabel pT15 pB10"},[_c("span",[_vm._v(_vm._s(_vm._f("prettyBytes")(attachment.fileSize)))]),1===attachment.status?_c("span",{staticClass:"attachment-sublabel"},[_vm._v(", Uploading...")]):2===attachment.status?_c("span",{staticClass:"attachment-sublabel"},[_vm._v(", Success")]):_c("span",{staticClass:"attachment-sublabel"},[_vm._v(" "+_vm._s(attachment.error))])]),_c("div",{staticClass:"remove pull-right"},[1===attachment.status?_c("a",{staticClass:"visibility-hide-actions",staticStyle:{cursor:"wait"},attrs:{onclick:"javascript:void(0)"}},[_c("img",{attrs:{src:__webpack_require__(984329),width:"15",height:"15"}})]):_vm.canShowDelete(attachment)?_c("a",{staticClass:"remove-attachment-link fc-delete visibility-hide-actions",on:{click:function($event){return _vm.deleteAttachment(attachment,index)}}},[_c("img",{attrs:{src:__webpack_require__(984329),width:"15",height:"15"}})]):_vm._e()])])})),_c("form",{staticClass:"pT20 pB20",attrs:{enctype:"multipart/form-data",novalidate:""}},[_c("div",{staticClass:"dropbox"},[_c("input",{staticClass:"input-file",attrs:{type:"file",multiple:""},on:{change:function($event){return _vm.filesChange($event.target.files)}}}),_c("img",{staticClass:"mT20 opacity-05 mB10",attrs:{src:__webpack_require__(581121),width:"20",height:"20"}}),_c("p",[_vm._v(" "+_vm._s(_vm.$t("common.attachment_form.drag_and_drop_files"))),_c("br"),_vm._v(" "+_vm._s(_vm.$t("common.attachment_form.click_to_browse"))+" ")])])])],2),_vm.visibility&&_vm.selectedAttachedFile?_c("preview-file",{attrs:{visibility:_vm.visibility,previewFile:_vm.selectedAttachedFile,files:_vm.attachments},on:{"update:visibility":function($event){_vm.visibility=$event}}}):_vm._e()],1)},staticRenderFns=[],Attachments=__webpack_require__(281375),PreviewFile=__webpack_require__(720096),Attachmentsvue_type_script_lang_js={extends:Attachments/* default */.Z,components:{PreviewFile:PreviewFile/* default */.Z},methods:{selectedFile:function(inList){this.selectedAttachedFile=inList,this.visibility=!0}}},relatedlist_Attachmentsvue_type_script_lang_js=Attachmentsvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(relatedlist_Attachmentsvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,relatedlist_Attachments=component.exports},
/***/147105:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return relatedlist_Comments}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/relatedlist/Comments.vue?vue&type=template&id=9c5de910
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"fc-comments"},[_vm.loading?_c("div",{staticClass:"text-center"},[_c("spinner",{attrs:{show:_vm.loading}})],1):_c("div",{staticClass:"comment-msg-container"},_vm._l(_vm.comments,(function(comment){return _c("div",{key:comment.id,staticClass:"fc-comment-row"},[_c("div",{staticClass:"flLeft f12 secondary-color comment-by"},[_c("user-avatar",{staticClass:"comments-avatar",attrs:{size:"md",user:comment.createdBy,id:comment.createdBy.id}}),_c("div",{staticClass:"pL45 comment-time"},[_c("i",{staticClass:"fa fa-circle",staticStyle:{opacity:"0.4px",color:"rgba(140,161,173,0.30)","font-size":"8px","padding-right":"5px"},attrs:{"aria-hidden":"true"}}),_vm._v(" "+_vm._s(_vm._f("fromNow")(comment.createdTime))+" ")])],1),null!=comment.bodyHTML?_c("div",{staticClass:"markdown-style",domProps:{innerHTML:_vm._s(comment.bodyHTML)}}):_vm._e(),_c("div",{staticClass:"clearboth"})])})),0),_c("div",{staticClass:"row new-comment-area width100 mT20",attrs:{id:"commentBoxPar"}},[_c("form",{staticClass:"col-12",on:{submit:function($event){return $event.preventDefault(),_vm.addComment.apply(null,arguments)}}},[_c("div",{staticClass:"markdown-inside"},[_c("textarea",{directives:[{name:"model",rawName:"v-model",value:_vm.newComment.body,expression:"newComment.body"}],ref:"commentBoxRef",staticClass:"comment-box pT10",class:{height75:_vm.commentFocus,height35:!_vm.commentFocus},staticStyle:{"font-size":"13px","letter-spacing":"0.3px",color:"#333333","border-color":"#d0d9e2 !important","border-radius":"3px",width:"100%",height:"40px"},attrs:{placeholder:_vm.placeholder?_vm.placeholder:_vm.$t("common._common.write_comment")},domProps:{value:_vm.newComment.body},on:{focus:_vm.focusCommentBox,input:function($event){$event.target.composing||_vm.$set(_vm.newComment,"body",$event.target.value)}}}),_vm._v(" "),_c("button",{class:[_vm.commentFocus?"show":"hide"],on:{click:_vm.markdownhelplist}},[_c("img",{staticClass:"pull-right pointer",attrs:{src:__webpack_require__(773339)}})])]),this.markdownshow?[_c("markdown-help-list",{attrs:{markdownshow:_vm.markdownshow},on:{"update:markdownshow":function($event){_vm.markdownshow=$event}}})]:_vm._e(),_vm.commentFocus?_c("div",[_c("div",{staticClass:"flRight"},[_c("button",{staticClass:"comment-btn"},[_vm._v(" "+_vm._s(_vm.btnLabel?_vm.btnLabel:_vm.$t("common._common.comment"))+" ")])]),!_vm.isServicePortal&&_vm.showNotifyRequester?_c("div",{staticClass:"flLeft"},[_c("input",{directives:[{name:"model",rawName:"v-model",value:_vm.newComment.notifyRequester,expression:"newComment.notifyRequester"}],staticClass:"notify-requester-checkbox",attrs:{type:"checkbox",name:"notifyRequester"},domProps:{checked:Array.isArray(_vm.newComment.notifyRequester)?_vm._i(_vm.newComment.notifyRequester,null)>-1:_vm.newComment.notifyRequester},on:{change:function($event){var $$a=_vm.newComment.notifyRequester,$$el=$event.target,$$c=!!$$el.checked;if(Array.isArray($$a)){var $$v=null,$$i=_vm._i($$a,$$v);$$el.checked?$$i<0&&_vm.$set(_vm.newComment,"notifyRequester",$$a.concat([$$v])):$$i>-1&&_vm.$set(_vm.newComment,"notifyRequester",$$a.slice(0,$$i).concat($$a.slice($$i+1)))}else _vm.$set(_vm.newComment,"notifyRequester",$$c)}}}),_c("label",{staticClass:"notify-req",attrs:{for:"notifyRequester"}},[_vm._v(_vm._s(_vm.$t("common._common.notify")))])]):_vm._e(),_c("div",{staticClass:"clearboth"})]):_vm._e()],2)])])},staticRenderFns=[],User=(__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(228436),__webpack_require__(426803)),Comments=__webpack_require__(349318),MarkdownHelpList=__webpack_require__(566302),Commentsvue_type_script_lang_js={extends:Comments/* default */.Z,props:["placeholder","btnLabel"],components:{UserAvatar:User/* default */.Z,MarkdownHelpList:MarkdownHelpList/* default */.Z},data:function(){return{markdownshow:!1}},created:function(){window.addEventListener("click",this.blurCommentBox)},methods:{markdownhelplist:function(){this.markdownshow=!0},focusCommentBox:function(){this.$refs.commentBoxRef.focus(),this.commentFocus=!0},blurCommentBox:function(e){var itTargetPar=e.path.filter((function(ele){if("commentBoxPar"===ele.id)return!0}));this.newComment.body&&""!==this.newComment.body.trim()||itTargetPar.length||(this.commentFocus=!1)}}},relatedlist_Commentsvue_type_script_lang_js=Commentsvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(relatedlist_Commentsvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,relatedlist_Comments=component.exports},
/***/882900:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return ApprovalSummary}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/workorder/approval/ApprovalSummary.vue?vue&type=template&id=b2b1ebc6
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("div",{attrs:{clasc:"row"}},[_vm.workorder?_c("div",{staticClass:"white-color"},[_c("div",[_c("div",{staticClass:"summaryHeader"},[_c("div",{staticClass:"fL",staticStyle:{"padding-top":"12px"}},[_c("div",{staticStyle:{display:"inline-box"}},[_c("div",{staticClass:"q-item-label primary-field summary-header-heading"},[_vm._v(" "+_vm._s(_vm.workorder.subject)+" ")]),_vm.workorder.urgency>0?_c("span",{staticClass:"fc-tag-urgent mL20",style:{background:_vm.urgencyColorCode[_vm.workorder.urgency]}},[_vm._v(" "+_vm._s(_vm.$constants.WO_URGENCY[_vm.workorder.urgency]))]):_vm._e()]),_c("div",{staticStyle:{"font-size":"13px",position:"relative",clear:"both",top:"4px",left:"0px"}},[_c("span",{staticClass:"fc-id bold"},[_vm._v("#"+_vm._s(_vm.workorder.serialNumber))]),_vm.workorder.sourceType?_c("span",{staticClass:"separator"},[_vm._v("|")]):_vm._e(),[_c("span",{staticStyle:{color:"#8ca1ad","padding-right":"5px"}},[2===_vm.workorder.sourceType?_c("i",{staticClass:"fa fa-envelope-o"}):10===_vm.workorder.sourceType?_c("i",{staticClass:"f14 fa fa-globe"}):1===_vm.workorder.sourceType?_c("i",{staticClass:"f14 el-icon-service approval-el-icon-service"}):4===_vm.workorder.sourceType?_c("i",{staticClass:"f14 el-icon-bell approval-el-icon-bell"}):5===_vm.workorder.sourceType?_c("i",{staticClass:"f14 el-icon-date approval-el-icon-date"}):_vm._e()]),_vm.workorder.requester?_c("span",{staticStyle:{color:"#2ea2b2","font-size":"13px","vertical-align":"middle","padding-right":"8px","padding-left":"5px"}},[_vm._v(_vm._s(_vm.workorder.requester.name))]):_vm._e()],_c("div",{staticClass:"clearboth"})],2)]),_c("div",{staticClass:"fR",staticStyle:{padding:"0 25px",position:"relative",top:"-4",right:"35px"}},[_vm.workorder.moduleState&&_vm.workorder.moduleState.id>0?_c("approve-reject",{attrs:{record:_vm.workorder,moduleName:"workorder",transformFn:_vm.transformFormData,updateUrl:"/v2/workorders/update"},on:{transitionSuccess:_vm.onFormSave}}):_vm._e()],1),_c("div",{staticClass:"fR close-summary-request"},[_c("div",{staticClass:"triangle-close"},[_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"close-summary-icon material-icons pull-right pointer",attrs:{"data-theme":"light","data-arrow":"true"},on:{click:_vm.closeSummary}},[_vm._v("close")])])]),_c("div",{staticClass:"clearboth"})])]),_c("div",{staticClass:"overflow-scroll approval-request-details-block"},[_c("wo-field-details",{staticClass:"approval-wo-fields-",attrs:{isDisableForApproval:!0,workorder:_vm.workorder,excludeFields:["space","type","tenant","sourceType","createdTime","vendor","parentWO","sourceTypeVal"],refreshWoDetails:_vm.onFormSave}})],1),_c("div",{staticClass:"wo-actual-content"},[_c("el-tabs",{staticClass:"fc-tab-container approval-tab-container",model:{value:_vm.activeName,callback:function($$v){_vm.activeName=$$v},expression:"activeName"}},[_c("el-tab-pane",{attrs:{label:"SUMMARY",name:"first"}},[_c("div",{staticClass:"summaryMainContent"},[_c("h5",{staticStyle:{"font-size":"26px"}},[_vm._v(_vm._s(_vm.workorder.subject))]),_c("p",{staticClass:"description"},[_vm._v(_vm._s(_vm.workorder.description))])]),_c("div",{staticStyle:{"margin-right":"30px","margin-left":"24px",padding:"10px"}},[_c("div",{staticClass:"row",staticStyle:{"padding-bottom":"10px","border-bottom":"1px solid #f4f4f4",width:"100%"}},[_c("div",{staticClass:"col-12"},[_c("div",{staticStyle:{color:"#84828c","padding-top":"25px",position:"relative"}},[_c("div",{staticClass:"col-6",staticStyle:{width:"21%",float:"left"}},[_c("span",{staticStyle:{"font-size":"13px",cursor:"pointer"},on:{click:function($event){return _vm.selectSubSection("comment")}}},[_vm._v(_vm._s(_vm.$t("maintenance.wr_list.comments"))+" ("+_vm._s(_vm.workorder.noOfNotes>=0?_vm.workorder.noOfNotes:0)+") "),_c("div",{class:{wosactive:"comment"===_vm.subSection},staticStyle:{position:"absolute",width:"30px",height:"2px",left:"0",right:"0"}})])]),_c("div",{staticClass:"col-6",staticStyle:{width:"40%",float:"left"}},[_c("span",{staticStyle:{"padding-right":"15px","font-size":"13px","margin-left":"10px",cursor:"pointer"},on:{click:function($event){return _vm.selectSubSection("file")}}},[_vm._v(" "+_vm._s(_vm.$t("maintenance.wr_list.attachments"))+" ("+_vm._s(_vm.workorder.noOfAttachments>=0?_vm.workorder.noOfAttachments:0)+") "),_c("div",{class:{wosactive:"file"===_vm.subSection},staticStyle:{position:"absolute",width:"30px",height:"2px",bottom:"left: 0","margin-left":"10px"}})])])])])]),"file"===_vm.subSection?_c("attachments",{attrs:{module:"ticketattachments",record:_vm.workorder}}):_vm._e(),"task"===_vm.subSection?_c("tasks",{attrs:{module:"ticket",record:_vm.workorder}}):_vm._e(),"comment"===_vm.subSection?_c("comments",{attrs:{module:"ticketnotes",parentModule:"workorder",record:_vm.workorder}}):_vm._e(),_c("div",{staticClass:"pT15"})],1)]),_c("el-tab-pane",{attrs:{label:"TASK",name:"second"}},[_c("tasks",{attrs:{module:"ticket",record:_vm.workorder}})],1)],1)],1)]):_vm._e()]),_c("space-asset-chooser",{attrs:{visibility:_vm.chooserVisibility,initialValues:{}},on:{associate:_vm.associateResource,"update:visibility":function($event){_vm.chooserVisibility=$event}}})],1)},staticRenderFns=[],objectSpread2=__webpack_require__(595082),Attachments=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(434284),__webpack_require__(648324),__webpack_require__(564043),__webpack_require__(857267),__webpack_require__(77098)),SpaceAssetChooser=__webpack_require__(372587),NewTasksvue_type_template_id_72bc0f00_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"pL30 pR30",attrs:{id:"summarytask"}},[_vm.newTaskList.length>0?_c("div",{staticClass:"pT20"},[_vm._l(_vm.newTaskList,(function(obj,index){return _vm.sequencedData?_c("div",{key:index},[_vm.sections[obj.sectionId]?_c("div",{staticClass:"task-subject pB10 pL8",style:{"border-bottom":_vm.sections[obj.sectionId]?"solid 2px #d9f4f7":"0"}},[_vm._v(" "+_vm._s(_vm.sections[obj.sectionId]?_vm.sections[obj.sectionId].name:"")+" ")]):_vm._e(),_vm._l(obj.taskList,(function(task,index1){return _c("div",{key:index1,staticClass:"task-list",class:{selected:_vm.selectedTask===task,closed:"OPEN"!==task.status.type}},[_c("div",{staticStyle:{cursor:"pointer","padding-left":"5px","margin-right":"8px"}},["OPEN"===task.status.type?_c("i",{staticClass:"el-icon-circle-check-outline",staticStyle:{color:"#b8e5eb","font-size":"24px"}}):_c("i",{staticClass:"el-icon-circle-check",staticStyle:{color:"#39b2c2","font-size":"24px"}})]),_c("div",{staticClass:"task-item width100 pL5 position-relative"},[_c("el-row",[_c("el-col",{attrs:{span:9}},[-1===task.id?_c("el-input",{staticStyle:{width:"100%"},attrs:{type:"text",placeholder:_vm.$t("maintenance._workorder.write_a_task_name")},model:{value:task.subject,callback:function($$v){_vm.$set(task,"subject",$$v)},expression:"task.subject"}}):_c("div",{staticClass:"pL0 max-width480px width100 ellipsis",class:[{closedTask:"OPEN"!==task.status.type},"task-subject pL8 flLeft"],attrs:{type:"text",placeholder:""}},[_vm._v(" "+_vm._s(task.subject)+" ")]),-1===task.id||task.resource&&task.resource.name?_c("div",{staticClass:"pT5 mL10 flLeft"},[-1===task.id?_c("div",{staticClass:"flLeft",staticStyle:{height:"10px",width:"10px",cursor:"pointer"}},[_c("img",{attrs:{src:__webpack_require__(539884)}})]):_c("div",{staticClass:"flLeft pR5"},[1===task.resource.resourceType?_c("img",{staticStyle:{height:"12px",width:"14px"},attrs:{src:__webpack_require__(572902)}}):_c("img",{staticStyle:{height:"11px",width:"14px"},attrs:{src:__webpack_require__(30684)}})]),_c("div",{staticClass:"f12 pL6 ellipsis max-width300px blue-color"},[_vm._v(" "+_vm._s(task.resource.name||"")+" ")])]):_vm._e()],1),_c("el-col",{staticClass:"height0",attrs:{span:15}},[_c("div",{staticClass:"flRight row"},[_c("div",[5===task.inputType||"5"===task.inputType?_c("span",[_vm.checkOptionsLength(task.options)?_c("el-radio-group",{model:{value:task.inputValue,callback:function($$v){_vm.$set(task,"inputValue",$$v)},expression:"task.inputValue"}},_vm._l(task.options,(function(option,index){return _c("el-radio",{key:index,staticClass:"task-radio-group",attrs:{disabled:"",color:"secondary",label:option}},[_vm._v(_vm._s(option))])})),1):_vm._e()],1):3===task.inputType||"3"===task.inputType?_c("el-input",{attrs:{disabled:"",type:"text",placeholder:_vm.$t("maintenance._workorder.enter_text")},model:{value:task.inputValue,callback:function($$v){_vm.$set(task,"inputValue",$$v)},expression:"task.inputValue"}}):4===task.inputType||"4"===task.inputType?_c("el-input",{attrs:{disabled:"",type:"number",placeholder:_vm.$t("maintenance._workorder.enter_numeric_value")},model:{value:task.inputValue,callback:function($$v){_vm.$set(task,"inputValue",$$v)},expression:"task.inputValue"}}):2===task.inputType||"2"===task.inputType?_c("div",[_c("el-input",{staticClass:"inline",staticStyle:{width:"auto"},attrs:{disabled:"",type:"number",placeholder:_vm.$t("maintenance._workorder.enter_reading")},model:{value:task.inputValue,callback:function($$v){_vm.$set(task,"inputValue",$$v)},expression:"task.inputValue"}}),task.readingField&&task.readingField.unit?_c("div",{staticClass:"inline",staticStyle:{"padding-left":"7px"}},[_vm._v(" "+_vm._s(task.readingField.unit)+" ")]):_vm._e()],1):task.inputValue?_c("div",{staticClass:"task-subject pL8"},[_vm._v(" "+_vm._s(task.inputValue)+" ")]):_vm._e()],1),task.remarks?_c("div",{staticClass:"mR15"},[_c("span",[_c("img",{attrs:{width:"20",height:"20",src:__webpack_require__(24768)},on:{click:function($event){_vm.remarkDialog=!0,_vm.selectedRemark=task.remarks}}})])]):_vm._e(),task.noOfAttachments>0?_c("div",[_c("el-badge",{staticClass:"badge fc-approval-badge",attrs:{value:task.noOfAttachments,max:99},on:{click:function($event){return _vm.showAttachment(task)}}},[_c("img",{attrs:{src:__webpack_require__(793382),width:"28",height:"18"}})])],1):_vm._e()])])],1)],1)])}))],2):_vm._e()})),_c("el-dialog",{staticClass:"fc-dialog-center-container",attrs:{title:"Remark",visible:_vm.remarkDialog,width:"30%"},on:{"update:visible":function($event){_vm.remarkDialog=$event}}},[_c("div",{staticClass:"height300"},[_c("div",{staticClass:"label-txt-black"},[_vm._v(_vm._s(_vm.selectedRemark))])]),_c("div",{staticClass:"modal-dialog-footer",attrs:{slot:"footer"},slot:"footer"},[_c("el-button",{staticClass:"btn-green-full",on:{click:function($event){_vm.remarkDialog=!1,_vm.selectedRemark=null}}},[_vm._v("Cancel")])],1)]),_vm._l(Object.keys(_vm.taskList).sort(),(function(section,index){return _vm.sequencedData?_vm._e():_c("div",{key:index},[_vm.sections[section]?_c("div",{staticStyle:{"padding-top":"35px","font-size":"13px","font-weight":"bold","letter-spacing":"0.6px",color:"#333333","padding-bottom":"10px","padding-left":"8px"},style:{"border-bottom":_vm.sections[section]?"solid 2px #d9f4f7":"0"}},[_vm._v(" "+_vm._s(_vm.sections[section]?_vm.sections[section].name:"")+" ")]):_vm._e(),_vm._l(_vm.taskList[section],(function(task,index1){return _c("div",{key:index1,staticClass:"task-list",class:{selected:_vm.selectedTask===task,closed:"OPEN"!==task.status.type}},[_c("div",{staticStyle:{cursor:"pointer","padding-left":"5px","margin-right":"8px"}},["OPEN"===task.status.type?_c("i",{staticClass:"el-icon-circle-check-outline",staticStyle:{color:"#b8e5eb","font-size":"24px"}}):_c("i",{staticClass:"el-icon-circle-check",staticStyle:{color:"#39b2c2","font-size":"24px"}})])])}))],2)}))],2):_c("div",{staticClass:"text-center mT50"},[_c("img",{attrs:{src:__webpack_require__(254452),width:"100",height:"100"}})]),_vm.selectedTask&&_vm.visibility?_c("preview-file",{attrs:{visibility:_vm.visibility,previewFile:_vm.selectedTask.attachments[0],files:_vm.selectedTask.attachments},on:{"update:visibility":function($event){_vm.visibility=$event}}}):_vm._e()],1)},NewTasksvue_type_template_id_72bc0f00_staticRenderFns=[],vuex_esm=(__webpack_require__(879288),__webpack_require__(169358),__webpack_require__(947522),__webpack_require__(670560),__webpack_require__(865137),__webpack_require__(450886),__webpack_require__(420629)),PreviewFile=__webpack_require__(720096),validation=__webpack_require__(990260),NewTasksvue_type_script_lang_js={props:["record"],watch:{record:function(newVal){newVal&&(this.workorder=newVal,this.loadTasks())}},components:{PreviewFile:PreviewFile/* default */.Z},created:function(){this.$store.dispatch("loadSite"),this.$store.dispatch("loadTicketCategory"),this.$store.dispatch("loadTicketStatus","workorder"),this.$store.dispatch("loadTicketType"),this.$store.dispatch("loadTicketPriority"),this.$store.dispatch("loadGroups")},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({users:function(state){return state.users},groups:function(state){return state.groups},ticketcategory:function(state){return state.ticketCategory},ticketpriority:function(state){return state.ticketPriority},ticketstatus:function(state){return state.ticketStatus.workorder},sites:function(state){return state.site}})),(0,vuex_esm/* mapGetters */.Se)(["getTicketTypePickList"])),{},{tickettype:function(){return this.getTicketTypePickList()},openStatusId:function(){var id=this.$store.getters.getTicketStatusByLabel("Submitted","workorder").id;return id?parseInt(id):id},closedStatusId:function(){var id=this.$store.getters.getTicketStatusByLabel("Closed","workorder").id;return id?parseInt(id):id},ticketStatusValue:function(){return this.workorder&&this.workorder.status&&this.workorder.status.id&&this.$store.getters.getTicketStatus(this.workorder.status.id,"workorder").displayName||""}}),data:function(){return{attachmentDialog:!1,remarkDialog:!1,selectedRemark:null,showSiteEdit:!0,loading:!0,selectedTask:null,sequencedData:!1,taskList:{},newTaskList:[],sections:{},showAddTask:!1,visibility:!1}},mounted:function(){this.record&&(this.workorder=this.record),this.loadTasks();var currentSiteId=Number(this.$cookie.get("fc.currentSite"))||-1;-1!==currentSiteId&&(this.showSiteEdit=!1)},methods:{showAttachment:function(task){this.visibility=!0,this.selectedTask=task},checkOptionsLength:function(options){return options.length<=2&&!options.some((function(option){return option.length>10}))},loadTasks:function(){var _this=this,moduleId=this.$getProperty(this.workorder,"moduleState.id",null);return this.canEdit=!(0,validation/* isEmpty */.xb)(moduleId)&&!this.$store.getters.isStatusLocked(this.workorder.moduleState.id,"workorder"),this.loading=!0,this.newTaskList=[],this.taskList={},this.$http.get("/task?module=task&recordId="+this.workorder.id).then((function(response){if(_this.loading=!1,-1!==response.data.tasks[Object.keys(response.data.tasks)[0]][0].sequence){var unsorted=[];Object.keys(response.data.tasks).forEach((function(key){unsorted.push({secId:key,seq:response.data.tasks[key][0].sequence})}));var sorted=_this.sort(unsorted),newTaskList=[];sorted.forEach((function(ele){newTaskList.push({sectionId:ele.secId,taskList:response.data.tasks[ele.secId]})})),newTaskList=newTaskList.map((function(obj,objInx){var tasks=obj.taskList.map((function(task,index){return _this.loadAttachments(task),task.status&&task.status.id!==_this.openStatusId?task.status={type:"CLOSED",typeCode:2,id:_this.closedStatusId}:task.status={type:"OPEN",typeCode:1,id:_this.openStatusId},-1===task.inputTime&&(task.inputTime=null),task}));return obj.taskList=tasks,obj})),_this.newTaskList=newTaskList,_this.sequencedData=!0}else _this.sequencedData=!1;for(var idx in _this.taskList=response.data.tasks?response.data.tasks:{},_this.taskList)for(var idx2 in _this.taskList[idx])_this.taskList[idx][idx2].status&&_this.taskList[idx][idx2].status.id!==_this.openStatusId?_this.taskList[idx][idx2].status={type:"CLOSED",typeCode:2,id:_this.closedStatusId}:_this.taskList[idx][idx2].status={type:"OPEN",typeCode:1,id:_this.openStatusId},-1===_this.taskList[idx][idx2].inputTime&&(_this.taskList[idx][idx2].inputTime=null);_this.sections=response.data.sections?response.data.sections:{}})).catch((function(error){error&&(_this.loading=!1,_this.tasks=[])}))},loadAttachments:function(task){var _this2=this;return this.$http.get("/attachment?module=taskattachments&recordId="+task.id).then((function(response){200===response.status&&(_this2.loading=!1,task.attachments=response.data.attachments?response.data.attachments:[])}))},sort:function(arr){for(var len=arr.length,i=len-1;i>=0;i--)for(var j=1;j<=i;j++)if(arr[j-1].seq>arr[j].seq){var temp=arr[j-1];arr[j-1]=arr[j],arr[j]=temp}return arr}}},relatedlist_NewTasksvue_type_script_lang_js=NewTasksvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(relatedlist_NewTasksvue_type_script_lang_js,NewTasksvue_type_template_id_72bc0f00_render,NewTasksvue_type_template_id_72bc0f00_staticRenderFns,!1,null,null,null)
/* harmony default export */,NewTasks=component.exports,Comments=__webpack_require__(147105),ApproveReject=__webpack_require__(600675),WorkOrderFieldDetails=__webpack_require__(587971),workorderTransform=__webpack_require__(112143),log_map_state=__webpack_require__(766331),ApprovalSummaryvue_type_script_lang_js={mixins:[workorderTransform/* default */.Z],props:["model"],data:function(){return{duedate:"",confirmRequest:{category:null,assignedTo:{id:""},assignmentGroup:{id:""},space:null,priority:null,dialogVisible:!1},assignment:{assignedTo:{id:""},assignmentGroup:{id:""}},summaryCheckbox:!0,loading:!0,subSection:"comment",visibility:!1,spaceAssetDisplayName:"",pickerOptions:{disabledDate:function(time){return time.getTime()<Date.now()-864e5}},chooserVisibility:!1,selectedResource:{name:""},actions:{approve:{loading:!1},reject:{loading:!1},delete:{loading:!1}},activeName:"first",urgencyColorCode:{1:"#7fa5ff",2:"#f56837",3:"#e65244"},WOUrgency:{1:"Not Urgent",2:"Urgent",3:"Emergency"}}},created:function(){this.$store.dispatch("loadSite"),this.$store.dispatch("loadTicketCategory"),this.$store.dispatch("loadTicketStatus","workorder"),this.$store.dispatch("loadTicketPriority"),this.$store.dispatch("loadGroups")},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({users:function(state){return state.users},ticketcategory:function(state){return state.ticketCategory},ticketpriority:function(state){return state.ticketPriority},sites:function(state){return state.site}})),(0,log_map_state/* mapStateWithLogging */.g)({spaces:function(state){return state.spaces}})),{},{workorder:function(){return this.$store.getters["workorder/getWorkOrderById"](parseInt(this.$route.params.id))},isLocked:function(){var moduleId=this.$getProperty(this.workorder,"moduleState.id",null);return!(0,validation/* isEmpty */.xb)(moduleId)&&!this.$store.getters.isStatusLocked(this.workorder.moduleState.id,"workorder")}}),filters:{getUser:function(id){var userObj=this.users.find((function(user){return user.id===id}));return userObj||{name:"System"}}},watch:{workorder:function(newVal){var title="[#"+this.workorder.serialNumber+"] "+this.workorder.subject;this.setTitle(title),this.spaceAssetDisplayName="",newVal.resource&&(this.spaceAssetDisplayName=newVal.resource.name),this.setDueDate(this.workorder.dueDate)},"model.resource":function(val){val&&(this.spaceAssetDisplayName=val.name)},"assignment.assignedTo.id":function(){this.updateWorkOrder({assignedTo:{id:this.assignment.assignedTo.id}})},"assignment.assignmentGroup.id":function(){this.updateWorkOrder({assignmentGroup:{id:this.assignment.assignmentGroup.id}})}},mounted:function(){if(this.workorder){var title="[#"+this.workorder.serialNumber+"] "+this.workorder.subject;this.setTitle(title),this.spaceAssetDisplayName="",this.workorder.resource&&(this.spaceAssetDisplayName=this.workorder.resource.name)}},methods:{getSiteName:function(siteId){if(this.sites){var s=this.sites.find((function(i){return i.id===siteId}));return s?s.name:"---"}return"---"},assignWorkOrder:function(idList,assignedTo,assignmentGroup){var self=this;self.actions.assign.loading=!0;var assignedStatus={id:this.$store.getters.getTicketStatusByLabel("Assigned","workorder").id,status:"Assigned"},data={};data.id=idList,assignedTo&&(data.assignedTo=assignedTo),assignmentGroup&&(data.assignmentGroup=assignmentGroup),data.status=assignedStatus,self.$store.dispatch("workorder/updateWorkOrder",data).then((function(){self.actions.assign.loading=!1,self.$dialog.notify("Workorder assigned successfully!"),self.resetSelectAll(),self.onFormSave()}))},setDueDate:function(duedate){this.duedate=-1===duedate?Date.now()-864e5:new Date(duedate)},updateWorkOrder:function(field){var self=this,updateObj={id:[this.workorder.id],fields:field};self.$store.dispatch("workorder/updateWorkOrder",updateObj).then((function(){self.$dialog.notify("Workorder request updated successfully!"),field.assignedTo?self.workorder.assignedTo.id=field.assignedTo.id:field.assignmentGroup&&(self.workorder.assignmentGroup.id=field.assignmentGroup.id),self.onFormSave()}))},updateSite:function(siteId){var _this=this;this.$dialog.confirm({title:this.$t("maintenance._workorder.change_site"),message:"Changing Site will remove Assignees and Space/Assets from this request. Are you sure you want to change the site ?",rbDanger:!0,rbLabel:"Change"}).then((function(value){value&&_this.updateWorkOrder({siteId:siteId})}))},closeSummary:function(){var newpath=this.$route.path.substring(0,this.$route.path.indexOf("/summary/"));this.$router.replace({path:newpath})},selectSubSection:function(section){this.subSection=section},showSpaceAssetChooser:function(){this.visibility=!0},associateResource:function(selectedObj){
// console.log('associateResource' + JSON.stringify(selectedObj))
this.selectedResource=selectedObj,this.chooserVisibility=!1;var self=this,updateObj={id:[this.workorder.id],fields:{resource:{id:selectedObj.id}}};self.$store.dispatch("workorder/updateWorkOrder",updateObj).then((function(){self.$dialog.notify("Work Request updated successfully!"),self.spaceAssetDisplayName=selectedObj.name,self.onFormSave()}))},reset:function(){this.confirmRequest={category:null,assignedTo:{id:""},assignmentGroup:{id:""},space:null,priority:null,resource:null,spaceAssetDisplayName:""}},onChangeDueDate:function(pickVal){this.updateWorkOrderDueDate([this.workorder.id],this.$helpers.getTimeInOrg(pickVal))},updateWorkOrderDueDate:function(idList,date){var _this2=this,updateObj={id:idList,fields:{dueDate:date}};this.$store.dispatch("workorder/updateWorkOrder",updateObj).then((function(response){_this2.$message.success("work request Due Date updated successfully!"),_this2.onFormSave()})).catch((function(){_this2.$message.error("work request Due Date updation failed")}))},openAsset:function(id){if(id){var url="/app/at/assets/all/"+id+"/overview";this.$router.replace({path:url})}},onFormSave:function(){this.$store.dispatch("workorder/reloadApproval",null,{root:!0})}},components:{Attachments:Attachments/* default */.Z,Tasks:NewTasks,Comments:Comments/* default */.Z,SpaceAssetChooser:SpaceAssetChooser/* default */.Z,ApproveReject:ApproveReject/* default */.Z,WoFieldDetails:WorkOrderFieldDetails/* default */.Z}},approval_ApprovalSummaryvue_type_script_lang_js=ApprovalSummaryvue_type_script_lang_js,ApprovalSummary_component=(0,componentNormalizer/* default */.Z)(approval_ApprovalSummaryvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,ApprovalSummary=ApprovalSummary_component.exports},
/***/984329:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"78e9b94d763d88d92daab6faadbef8f9.svg";
/***/},
/***/24768:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"b6c3ca882f5ea06e796972c88d80a49e.svg";
/***/},
/***/773339:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"2ec28172b828295676202641adbd2566.svg";
/***/},
/***/793382:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"8a778c902a3810ded7aa897bac763209.svg";
/***/},
/***/254452:
/***/function(module,__unused_webpack_exports,__webpack_require__){"use strict";module.exports=__webpack_require__.p+"img/nochartData.3af04c93.png"}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/3926.js.map