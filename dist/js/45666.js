(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[45666],{
/***/574752:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return Avatar}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/Avatar.vue?vue&type=template&id=7f0d5689
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.user||_vm.name?_c("div",{staticClass:"fc-avatar-inline"},[_vm.avatarUrl?_c("img",{staticClass:"fc-avatar",class:_vm.sizeClass,attrs:{src:_vm.avatarUrl,alt:"Profile Avatar"}}):_c("div",{staticClass:"fc-avatar",class:_vm.sizeClass,style:_vm.bgColor},[_vm._v(" "+_vm._s(_vm.trimmedName)+" ")])]):_vm._e()},staticRenderFns=[],objectSpread2=__webpack_require__(595082),vuex_esm=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(434284),__webpack_require__(564043),__webpack_require__(709873),__webpack_require__(228436),__webpack_require__(450886),__webpack_require__(677049),__webpack_require__(821694),__webpack_require__(420629)),Avatarvue_type_script_lang_js={props:{size:{type:String},user:{type:Object},avatarStyle:{type:Object},color:{type:String},name:{type:Boolean}},data:function(){return{sizeClass:"fc-avatar-"+this.size,fullName:"",trimmedName:null,avatarUrl:null,bgColor:"background-color: "+(this.color?this.color:this.getRandomBgColor())}},computed:(0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({users:function(state){return state.users}})),mounted:function(){var _this=this;if(this.user){var userName="";if(this.user.avatarUrl)this.avatarUrl=this.user.avatarUrl;else if(this.user.id){var userObj=this.users.find((function(user){return user.id===_this.user.id}));userObj&&userObj.avatarUrl&&(this.avatarUrl=userObj.avatarUrl),userObj&&userObj.name&&(userName=userObj.name)}userName=userName||this.user.name,userName&&(this.fullName=userName,this.trimmedName=this.getAvatarName(userName),this.bgColor="background-color: "+(this.color?this.color:this.getRandomBgColor()))}else this.name&&(this.trimmedName=this.getAvatarName(this.name),this.bgColor="background-color: "+(this.color?this.color:this.getRandomBgColor()))},watch:{user:function(){var _this2=this;if(this.user.avatarUrl)this.avatarUrl=this.user.avatarUrl;else if(this.user.id){var userObj=this.users.find((function(user){return user.id===_this2.user.id}));userObj&&userObj.avatarUrl?this.avatarUrl=userObj.avatarUrl:this.avatarUrl=null}else this.avatarUrl=null;this.user.name&&(this.fullName=this.user.name,this.trimmedName=this.getAvatarName(this.user.name),this.bgColor="background-color: "+(this.color?this.color:this.getRandomBgColor()))},"user.name":function(){this.user.name&&(this.fullName=this.user.name,this.trimmedName=this.getAvatarName(this.user.name),this.bgColor="background-color: "+(this.color?this.color:this.getRandomBgColor()))},"user.avatarUrl":function(){this.user.avatarUrl?this.avatarUrl=this.user.avatarUrl:this.avatarUrl=null},"user.id":function(){var _this3=this;if(this.user.id){var userObj=this.users.find((function(user){return user.id===_this3.user.id}));userObj&&userObj.avatarUrl?this.avatarUrl=userObj.avatarUrl:this.avatarUrl=null}else this.avatarUrl=null}},methods:{getAvatarName:function(name){for(var parts=name.split(/[ -]/),initials="",initialLen=2,count=0,i=0;i<parts.length;i++)if(""!==parts[i].trim()&&(initials+=parts[i].charAt(0),count++,count>=initialLen))break;initials.length<initialLen&&name.length>=initialLen&&(initials=name.trim().substring(0,initialLen));var avatarName=initials.toUpperCase();return avatarName},getRandomBgColor:function(){var colors=["#FFBA51","#34BFA3","#FF2F82","#29D9A7","#ECDC74","#927FED","#FF61A8","#fbf383","#ac4352","#6db1f4"],userKey=this.user.email?this.user.email:this.user.name,userUniqueNum=Array.from(userKey).map((function(letter){return letter.charCodeAt(0)})).reduce((function(current,previous){return previous+current})),colorIndex=userUniqueNum%colors.length,color=colors[colorIndex];return color}}},components_Avatarvue_type_script_lang_js=Avatarvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_Avatarvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,Avatar=component.exports},
/***/919324:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return CodeMirror}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/CodeMirror.vue?vue&type=template&id=f33b888a
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("codemirror",{attrs:{options:_vm.cmOption,placeholder:_vm.placeholder},on:{input:_vm.onCmCodeChange,ready:_vm.onCmReady,focus:_vm.onCmFocus},model:{value:_vm.script,callback:function($$v){_vm.script=$$v},expression:"script"}})],1)},staticRenderFns=[],vue_codemirror=__webpack_require__(375055),CodeMirrorvue_type_script_lang_js=(__webpack_require__(304631),__webpack_require__(471707),__webpack_require__(959372),__webpack_require__(620017),__webpack_require__(796876),__webpack_require__(988386),{data:function(){return{script:null,cmOption:{tabSize:4,styleActiveLine:!0,mode:"text/javascript",theme:"default",lineNumbers:!0,line:!0,matchBrackets:!0,foldGutter:!0,placeholder:!1,hintOptions:{completeSingle:!1},showCursorWhenSelecting:!0}}},props:["value","options","placeholder"],components:{codemirror:vue_codemirror.codemirror},computed:{codemirror:function(){return this.$refs.myCm.codemirror}},watch:{value:{handler:function(){this.script=this.$helpers.cloneObject(this.value),this.options&&Object.assign(this.cmOption,this.options)},immediate:!0}},methods:{onCmReady:function(cm){},onCmFocus:function(cm){},onCmCodeChange:function(newCode){this.$emit("input",newCode)},addCode:function(code){this.script=this.script+="\n"+code+"\n"},onCmScroll:function(){}}}),components_CodeMirrorvue_type_script_lang_js=CodeMirrorvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_CodeMirrorvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,CodeMirror=component.exports},
/***/507008:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FPopover}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/FPopover.vue?vue&type=template&id=878762a4
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-popover",{ref:_vm.getRef,attrs:{"popper-class":"f-popover",width:_vm.width||""===_vm.width?_vm.width:280,placement:_vm.placement,trigger:_vm.trigger||"click",hide:"hide"},on:{show:function(){return _vm.$emit("show")}},model:{value:_vm.showpopover,callback:function($$v){_vm.showpopover=$$v},expression:"showpopover"}},[_c("div",{staticClass:"fc-popover-content"},[_vm._t("header",(function(){return[_c("div",{staticClass:"title uppercase f12 bold",staticStyle:{"letter-spacing":"1.1px",color:"#000000"}},[_vm._v(" "+_vm._s(_vm.title)+" ")])]})),_c("div",[_vm._t("content")],2)],2),_c("div",{staticClass:"f-footer row",staticStyle:{height:"46px"}},[_vm._t("footer",(function(){return[_c("button",{staticClass:"footer-btn footer-btn-secondary col-6",attrs:{type:"button"},on:{click:_vm.cancel}},[_c("span",[_vm._v(_vm._s(_vm.$t("setup.users_management.cancel")))])]),_c("button",{staticClass:"footer-btn footer-btn-primary col-6",attrs:{type:"button"},on:{click:_vm.save}},[_c("span",[_vm._v(_vm._s(_vm.confirmTitle?_vm.confirmTitle:_vm.$t("common._common.ok")))])])]}))],2),_c("template",{slot:"reference"},[_vm._t("reference")],2)],2)},staticRenderFns=[],FPopovervue_type_script_lang_js={props:["popperClass","placement","value","popperRef","trigger","title","width","maxHeight","confirmTitle"],data:function(){return{showpopover:!1}},watch:{showpopover:function(val){null!=this.value&&this.$emit("input",val)},value:function(val){this.showpopover=val}},mounted:function(){var element=this.$refs[this.getRef].$el;if(this.popperClass&&element.firstElementChild.classList.add(this.popperClass),this.maxHeight){var content=element.querySelector(".fc-popover-content");content.classList.add("scrollable"),content.style["max-height"]=this.maxHeight+"px"}},computed:{getRef:function(){return this.popperRef?this.popperRef:"fpopup"}},methods:{save:function(){this.showpopover=!1,this.$emit("save")},cancel:function(){this.showpopover=!1,this.$emit("close")},hide:function(){this.$emit("hide")}}},components_FPopovervue_type_script_lang_js=FPopovervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FPopovervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FPopover=component.exports},
/***/426803:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return User}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/avatar/User.vue?vue&type=template&id=c662fbbc
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.userObj?_c("div",{staticClass:"inline"},[_c("div",{staticClass:"fc-avatar-element q-item-division relative-position"},[_c("div",{staticClass:"q-item-side-left q-item-section"},[_vm.showPopover&&-1!==_vm.userObj.id?_c("avatarPopover",{attrs:{user:_vm.userObj,moduleName:_vm.moduleName}},[_c("span",{attrs:{slot:"reference"},slot:"reference"},[_c("avatar",{attrs:{size:_vm.size,user:_vm.userObj,color:_vm.color}})],1)]):_c("span",[_c("avatar",{attrs:{size:_vm.size,user:_vm.userObj,color:_vm.color}})],1)],1),_vm.showLabel?[_vm.user&&_vm.user.id>0||_vm.group&&_vm.group.id>0?_c("div",{staticClass:"wo-team-txt"},[_c("div",{staticClass:"assignment-avatar-name",class:{"color-d":!_vm.user}},[_vm._v(" "+_vm._s(_vm.user&&_vm.user.id>0?_vm.user.name||(_vm.users.find((function(usr){return usr.id===_vm.user.id}))||{}).name:"---")+" ")]),_c("div",{staticClass:"assignment-group-name",class:{"color-d":!_vm.group}},[_vm._v(" "+_vm._s(_vm.group?_vm.group.name||(_vm.$store.getters.getGroup(_vm.group.id)||{}).name:"---")+" ")])]):_c("div",{staticClass:"wo-team-txt",staticStyle:{"padding-top":"7px","font-size":"14px",color:"#aaa","letter-spacing":"0.2px"}},[_vm._v(" ---/--- ")])]:0!=_vm.name?_c("div",[_c("div",[_c("span",{staticClass:"q-item-label d-flex flex-wrap"},[_vm._v(_vm._s(_vm.userObj.name))])])]):_vm._e()],2)]):_vm._e()},staticRenderFns=[],objectSpread2=__webpack_require__(595082),Avatar=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(574752)),AvatarPopovervue_type_template_id_8ef9b9ec_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"avatar-popover-container"},[_c("el-popover",{ref:"popover1",staticStyle:{display:"block",padding:"0"},attrs:{placement:"top-start",trigger:"hover",width:"383",clas:"avatar-popover","popper-class":"avatar-popover",height:_vm.defaultheight,"open-delay":600},model:{value:_vm.popoverShown,callback:function($$v){_vm.popoverShown=$$v},expression:"popoverShown"}},[_c("div",{staticClass:"popover-content-block"},[_c("div",{staticClass:"popover-avatar"},[_c("avatar",{attrs:{size:_vm.size,user:_vm.user,color:_vm.color,showPopover:!1}})],1),_c("div",{staticClass:"popover-avatar-det"},[_c("div",{staticClass:"avatar-name-txt"},[_vm._v(" "+_vm._s(_vm.user.name?_vm.user.name:"----")+" ")]),_c("div",{staticClass:"mail-block"},[_c("img",{staticClass:"envelope-icon",staticStyle:{height:"13px","vertical-align":"middle"},attrs:{src:__webpack_require__(702638)}}),_c("span",{staticClass:"mail-txt"},[_vm._v(_vm._s(_vm.user.email?_vm.user.email:"----")+" ")])]),_c("div",[_c("img",{staticClass:"envelope-icon",staticStyle:{height:"15px"},attrs:{src:__webpack_require__(47424)}}),_c("span",{staticClass:"popover-phone-number"},[_vm._v(" "+_vm._s(_vm.user.mobile?_vm.user.mobile:"----")+" ")])])]),"workorder"===_vm.moduleName?_c("div",{staticClass:"popover-footer"},[_c("ul",[_c("li",{staticClass:"popover-footer-list",on:{click:function($event){return _vm.getOpen("open")}}},[_c("div",{staticClass:"open-result-txt"},[_vm._v(" "+_vm._s(_vm.result.openWorkOrdersCount)+" ")]),_c("div",{staticClass:"result-txt-black"},[_vm._v("OPEN")])]),_c("li",{staticClass:"popover-footer-list border-RL",on:{click:function($event){return _vm.getOpen("overdue")}}},[_c("div",{staticClass:"overdue-result-txt"},[_vm._v(" "+_vm._s(_vm.result.overDueWorkOrdersCount)+" ")]),_c("div",{staticClass:"result-txt-black"},[_vm._v("OVERDUE")])]),_c("li",{staticClass:"popover-footer-list",on:{click:function($event){return _vm.getOpen("duetoday")}}},[_c("div",{staticClass:"dueday-result-txt"},[_vm._v(" "+_vm._s(_vm.result.dueTodayWorkOrdersCount)+" ")]),_c("div",{staticClass:"result-txt-black"},[_vm._v("DUE TODAY")])])])]):_vm._e()]),_c("template",{slot:"reference"},[_vm._t("reference")],2)],2)],1)},AvatarPopovervue_type_template_id_8ef9b9ec_staticRenderFns=[],AvatarPopovervue_type_script_lang_js=(__webpack_require__(670560),__webpack_require__(648324),{props:["size","user","color","name","moduleName"],data:function(){return{defaultheight:"230px",result:{},popoverShown:!1,viewname:""}},components:{Avatar:Avatar["default"]},mounted:function(){
// this.showPopover = this.showpopoverFooter
this.moduleName&&(this.defaultheight="160px")},watch:{popoverShown:function(val){val&&this.userOpenDatas()}},methods:{userOpenDatas:function(){var self=this;self.$http.post("/widget/getUserCardData",{ouid:this.user.id}).then((function(response){200===response.status&&(self.result=response.data.result)}))},getOpen:function(viewName){var filter={assignedTo:{operator:"is",value:[this.user.id+""]}};this.$router.push("/app/wo/orders/"+viewName+"?search="+encodeURIComponent(JSON.stringify(filter)))}}}),components_AvatarPopovervue_type_script_lang_js=AvatarPopovervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_AvatarPopovervue_type_script_lang_js,AvatarPopovervue_type_template_id_8ef9b9ec_render,AvatarPopovervue_type_template_id_8ef9b9ec_staticRenderFns,!1,null,null,null)
/* harmony default export */,AvatarPopover=component.exports,vuex_esm=__webpack_require__(420629),Uservue_type_script_lang_js={created:function(){this.$store.dispatch("loadGroups")},components:{Avatar:Avatar["default"],AvatarPopover:AvatarPopover},props:{size:{type:String},user:{type:Object},avatarStyle:{type:Object},name:{type:Boolean,default:function(){return!0}},showLabel:{type:Boolean},showPopover:{type:Boolean},moduleName:{type:String},group:{type:Object},hovercard:{type:Boolean}},data:function(){return{hoverCardId:"userHoverCardId-"+(this.user?this.user.id:"unkown"),loadHoverCardData:!1,labelStatus:this.hideLabel}},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({users:function(state){return state.users}})),{},{userObj:function(){var _this=this,hasUser=this.user&&this.user.id>0,user=hasUser?this.$getProperty(this.user,"name")?this.user:this.users.find((function(usr){return usr.id===_this.user.id})):null;return user||{id:-1,name:"Unknown"}},color:function(){return-1!==this.userObj.id?"":this.group?"#c3c3c3":"#e3e3e3"}}),methods:{loadHoverCard:function(){this.loadHoverCardData=!0},hideHoverCard:function(){this.loadHoverCardData=!1}}},avatar_Uservue_type_script_lang_js=Uservue_type_script_lang_js,User_component=(0,componentNormalizer/* default */.Z)(avatar_Uservue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,User=User_component.exports},
/***/374219:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return EnergyMeter}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/setup/v1/EnergyMeter.vue?vue&type=template&id=5b12a693
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"energy-meter-page height100vh"},[_c("div",{staticClass:"fc-setup-header"},[_c("div",{staticClass:"setting-title-block fL"},[_c("div",{staticClass:"setting-form-title"},[_vm._v(" "+_vm._s(_vm.$t("common.header.energy_meter"))+" ")]),_c("div",{staticClass:"heading-description"},[_vm._v(" "+_vm._s(_vm.$t("setup.list.list_energymeter"))+" ")])]),_c("div",{staticClass:"action-btn setting-page-btn fR"},[_c("el-button",{staticClass:"fc-btn-grey-border p5",staticStyle:{width:"40px",height:"42px"},attrs:{type:"primary"},on:{click:function($event){_vm.runthroughVisible=!0}}},[_c("inline-svg",{staticClass:"vertical-middle fc-grey-svg-color pT10 pL3",attrs:{src:"svgs/filter",iconClass:"icon icon-md"}})],1),_c("el-button",{staticClass:"setup-el-btn",attrs:{type:"primary"},on:{click:_vm.showNewEnergyMeter}},[_vm._v(" "+_vm._s(_vm.$t("setup.add.new_energyMeter"))+" ")])],1),_c("el-tabs",{staticClass:"fc-setup-tab",model:{value:_vm.activeName,callback:function($$v){_vm.activeName=$$v},expression:"activeName"}},[_c("el-tab-pane",{attrs:{label:"Energy Meter",name:"first"}},[_c("div",{staticClass:"row setting-Rlayout mT20 p0"},[_c("div",{staticClass:"col-lg-12 col-md-12 overflow-x"},[_c("table",{staticClass:"setting-list-view-table"},[_c("thead",[_c("tr",[_c("th",{staticClass:"setting-table-th setting-th-text"},[_vm._v(" "+_vm._s(_vm.$t("common.roles.name"))+" ")]),_c("th",{staticClass:"setting-table-th setting-th-text"},[_vm._v(" "+_vm._s(_vm.$t("setup.setupLabel.purpose"))+" ")]),_c("th",{staticClass:"setting-table-th setting-th-text"},[_vm._v(" "+_vm._s(_vm.$t("setup.setupLabel.serving_location"))+" ")]),_c("th",{staticClass:"setting-table-th setting-th-text"},[_vm._v(" "+_vm._s(_vm.$t("setup.setupLabel.is_root_meter"))+" ")]),_c("th",{staticClass:"setting-table-th setting-th-text"},[_vm._v(" "+_vm._s(_vm.$t("setup.setupLabel.is_virtual_meter"))+" ")]),_c("th",{staticClass:"setting-table-th setting-th-text"})])]),_vm.loading?_c("tbody",[_c("tr",[_c("td",{staticClass:"text-center",attrs:{colspan:"100%"}},[_c("spinner",{attrs:{show:_vm.loading,size:"80"}})],1)])]):_vm.meterList.length?_c("tbody",_vm._l(_vm.meterList,(function(meter,index){return _c("tr",{directives:[{name:"loading",rawName:"v-loading",value:_vm.loading,expression:"loading"}],key:index,staticClass:"tablerow"},[_c("td",[_vm._v(_vm._s(meter.name))]),_c("td",[_vm._v(" "+_vm._s(meter.purpose&&meter.purpose.id?_vm.serviceList[meter.purpose.id]:"---")+" ")]),_c("td",[_vm._v(" "+_vm._s(meter.purposeSpace&&_vm.$store.getters.getSpace(meter.purposeSpace.id)?_vm.$store.getters.getSpace(meter.purposeSpace.id).name:"---")+" ")]),_c("td",[_vm._v(_vm._s(meter.root?"Yes":"No"))]),_c("td",[_vm._v(_vm._s(meter.isVirtual?"Yes":"No"))]),_c("td",[_c("div",{staticClass:"text-left actions",staticStyle:{"margin-top":"-3px","margin-right":"15px","text-align":"center",width:"80px"}},[_c("i",{staticClass:"el-icon-edit pointer",on:{click:function($event){return _vm.showEditEnergyMeter(meter)}}}),_vm._v("    "),_c("i",{staticClass:"el-icon-delete pointer",on:{click:function($event){return _vm.deleteEm(meter.id)}}})])])])})),0):_c("tbody",[_c("tr",[_c("td",[_vm._v(_vm._s(_vm.$t("setup.empty.empty_energyMeter")))])])])])])])]),_c("el-tab-pane",{attrs:{label:"Activity Log",name:"second"}},[_c("div",{staticClass:"row setting-Rlayout mT20 p0 fc-border1"},[_c("div",{staticClass:"col-lg-12 col-md-12 overflow-x height100 width100 overflow-y-scroll"},[_c("el-row",{staticClass:"activity-log-header width100 pT20 pB20 pL30 pR30"},[_c("el-col",{attrs:{span:4}},[_c("div",{staticClass:"history-log-header-txt"},[_vm._v(" "+_vm._s(_vm.$t("setup.setupLabel.energy_meter_name"))+" ")])]),_c("el-col",{attrs:{span:8}},[_c("div",{staticClass:"history-log-header-txt"},[_vm._v(" "+_vm._s(_vm.$t("setup.setupLabel.startTime_endTime"))+" ")])]),_c("el-col",{attrs:{span:5}},[_c("div",{staticClass:"history-log-header-txt"},[_vm._v(" "+_vm._s(_vm.$t("setup.setupLabel.executed_by"))+" ")])]),_c("el-col",{attrs:{span:4}},[_c("div",{staticClass:"history-log-header-txt"},[_vm._v(" "+_vm._s(_vm.$t("setup.setupLabel.executed_time"))+" ")])]),_c("el-col",{attrs:{span:2}},[_c("div",{staticClass:"history-log-header-txt text-right"},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.status"))+" ")])])],1),_c("el-tree",{staticClass:"energy-meter-tree",attrs:{data:_vm.activities,"node-key":"id",lazy:!0,load:_vm.loadChildren,"expand-on-click-node":!0,"empty-text":this.$t("setup.setupLabel.no_ActivityLog")},scopedSlots:_vm._u([{key:"default",fn:function(ref){var node=ref.node,data=ref.data;return[_c("div",{staticClass:"custom-tree-node"},[_c("el-row",{staticClass:"history-log-header width100 pT20 pB20 pL5 pR30"},[_c("el-col",{attrs:{span:4}},[_c("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"top",animation:"shift-away",arrow:!0},expression:"{\n                          placement: 'top',\n                          animation: 'shift-away',\n                          arrow: true,\n                        }"}],staticClass:"label-txt-black bold textoverflow-ellipsis",attrs:{title:node.label}},[_vm._v(" "+_vm._s(node.label)+" ")])]),_c("el-col",{attrs:{span:8}},[1===node.level?_c("div",{staticClass:"label-txt-black"},[_vm._v(" "+_vm._s(_vm._f("formatDate")(data.info.startTime))+" - "+_vm._s(_vm._f("formatDate")(data.info.endTime))+" ")]):_vm._e()]),_c("el-col",{attrs:{span:5}},[1===node.level?_c("div",{staticClass:"fc-energy-meter-ellipsis"},[_c("user-avatar",{attrs:{size:"md",user:_vm.$store.getters.getUser(data.info.createdBy)}})],1):_vm._e()]),_c("el-col",{attrs:{span:4}},[1===node.level?_c("div",{staticClass:"label-txt-black"},[_vm._v(" "+_vm._s(_vm._f("formatDate")(data.info.createdTime))+" ")]):_vm._e()]),_c("el-col",{staticClass:"fR",attrs:{span:2}},[_c("div",{style:{color:_vm.$constants.JOB_STATUS[Number(data.info.status)].color}},[_vm._v(" "+_vm._s(_vm.$constants.JOB_STATUS[Number(data.info.status)].label)+" ")])])],1)],1)]}}])})],1)])])],1)],1),_c("run-through-filter",{attrs:{visible:_vm.runthroughVisible,meterList:_vm.meterList},on:{"update:visible":function($event){_vm.runthroughVisible=$event},loadfilterlist:_vm.loadactivitylog}}),_vm.loadEnergyMeterForm?_c("new-energy-meter",{attrs:{meter:_vm.selectedMeter,rule:_vm.rule,isNew:_vm.isNew,visibility:_vm.loadEnergyMeterForm},on:{saved:_vm.addMeterSaved,canceled:_vm.close,"update:visibility":function($event){_vm.loadEnergyMeterForm=$event}}}):_vm._e()],1)},staticRenderFns=[],toConsumableArray=__webpack_require__(488478),objectSpread2=__webpack_require__(595082),NewEnergyMetervue_type_template_id_01fe77e4_render=(__webpack_require__(450886),__webpack_require__(434284),__webpack_require__(903650),__webpack_require__(670560),__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(339772),__webpack_require__(162506),function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticStyle:{"z-index":"999999"},attrs:{visible:_vm.visibility,fullscreen:!0,"append-to-body":!0,"custom-class":"fc-dialog-form fc-dialog-right setup-dialog50 setup-dialog","before-close":_vm.closeDialog},on:{"update:visible":function($event){_vm.visibility=$event}}},[_c("div",{attrs:{id:"newenergymeter"}},[_c("el-popover",{ref:"purposePopver",attrs:{placement:"right",title:_vm.$t("common.products.add_purpose"),width:"300",trigger:"click","popper-class":"purpose-popover"},model:{value:_vm.popoverVisible,callback:function($$v){_vm.popoverVisible=$$v},expression:"popoverVisible"}},[_c("div",[_c("el-input",{staticStyle:{"margin-bottom":"40px","padding-left":"20px","padding-right":"20px"},model:{value:_vm.newPurpose,callback:function($$v){_vm.newPurpose=$$v},expression:"newPurpose"}}),_c("div",{staticStyle:{"text-align":"right",margin:"0px 0px 0px"}},[_c("el-button",{staticClass:"modal-btn-cancel",attrs:{size:"mini",type:"text"},on:{click:function($event){_vm.popoverVisible=!1}}},[_vm._v(_vm._s(_vm.$t("setup.users_management.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",size:"mini",loading:_vm.purposeSaving},on:{click:_vm.addNewPurpose}},[_vm._v(_vm._s(_vm.purposeSaving?_vm.$t("common._common._saving"):_vm.$t("common._common._save")))])],1)],1)]),_c("el-form",{ref:"meterForm",staticClass:"fc-form",attrs:{model:_vm.meter,rules:_vm.rules,"label-position":"top"}},[_c("div",{staticClass:"form-header",staticStyle:{"margin-top":"0px","padding-top":"20px","padding-left":"45px","padding-bottom":"20px"}},[_c("div",{staticClass:"setup-modal-title"},[_vm._v(" "+_vm._s(_vm.isNew?_vm.$t("common.wo_report.new_energy_meter"):_vm.$t("common.header.edit_energy_meter"))+" ")])]),_c("div",{staticStyle:{"border-bottom":"1px solid #edeeef"}}),_c("el-row",{staticStyle:{margin:"0px","border-bottom":"1px solid #edeeef","padding-top":"10px","padding-bottom":"15px","padding-left":"20px",background:"#fcfcfc"},attrs:{align:"middle",gutter:50}},[_c("el-col",{staticStyle:{"padding-right":"25px"},attrs:{span:24}},[_c("div",{staticStyle:{float:"left","font-size":"13px","font-weight":"500","letter-spacing":"0.7px","padding-top":"6px"}},[_vm._v(" "+_vm._s(_vm.$t("setup.setupLabel.is_virtual_meter"))+" ")]),_c("div",{staticStyle:{float:"left","padding-left":"100px","font-size":"13px","font-weight":"normal","letter-spacing":"0.4px","padding-top":"5px",color:"#666666"}},[_vm._v(" "+_vm._s(_vm.meter.isVirtual?"Yes":"No")+" ")]),_c("div",{staticStyle:{float:"left","padding-top":"2px","padding-left":"10px"}},[_vm.isNew?_c("el-switch",{attrs:{"active-color":"#ef4f8f"},model:{value:_vm.meter.isVirtual,callback:function($$v){_vm.$set(_vm.meter,"isVirtual",$$v)},expression:"meter.isVirtual"}}):_c("el-switch",{attrs:{disabled:"","active-color":"#ef4f8f"},model:{value:_vm.meter.isVirtual,callback:function($$v){_vm.$set(_vm.meter,"isVirtual",$$v)},expression:"meter.isVirtual"}})],1),_c("div",{staticStyle:{clear:"both"}})])],1),_c("div",{staticClass:"new-body-modal energy-body-modal",staticStyle:{"padding-top":"0"}},[_c("el-row",{attrs:{gutter:20}},[_c("el-col",{attrs:{span:24}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v(_vm._s(_vm.$t("common.roles.name")))]),_c("el-input",{staticClass:"text required header width100 fc-input-full-border2",attrs:{type:"text",autocomplete:"off",autofocus:"",placeholder:_vm.$t("setup.setupLabel.enter_meter_name")},model:{value:_vm.meter.name,callback:function($$v){_vm.$set(_vm.meter,"name",$$v)},expression:"meter.name"}})],1)],1),_c("el-row",[_c("el-col",{staticClass:"mT20",attrs:{span:24}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.description"))+" ")]),_c("el-input",{staticClass:"text required header fc-input-full-border-textarea",attrs:{type:"textarea",placeholder:_vm.$t("common._common.enter_desc"),autosize:{minRows:3,maxRows:4},autocomplete:"off",resize:"none"},model:{value:_vm.meter.description,callback:function($$v){_vm.$set(_vm.meter,"description",$$v)},expression:"meter.description"}})],1)],1),1!==_vm.sites.length&&_vm.isNew?_c("el-row",{attrs:{align:"middle",gutter:20}},[_c("el-col",{staticClass:"mT20",attrs:{span:12}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.$t("space.sites._site"))+" ")]),_c("div",{staticClass:"add"},[_c("Lookup",{attrs:{field:_vm.fields.site,hideLookupIcon:!0},on:{recordSelected:_vm.setSelectedValue,showLookupWizard:_vm.showLookupWizardSite},model:{value:_vm.meter.siteId,callback:function($$v){_vm.$set(_vm.meter,"siteId",$$v)},expression:"meter.siteId"}})],1)])],1):_vm._e(),_c("el-row",{attrs:{gutter:20}},[_c("el-col",{staticClass:"mT30",attrs:{span:12}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.$t("setup.setupLabel.serving_location"))+" ")]),_c("div",{staticClass:"add"},[_c("el-select",{staticClass:"form-item width100 fc-input-full-border2 ",attrs:{filterable:"",placeholder:_vm.$t("common._common.choose_serving_location")},model:{value:_vm.meter.purposeSpace.id,callback:function($$v){_vm.$set(_vm.meter.purposeSpace,"id",$$v)},expression:"meter.purposeSpace.id"}},_vm._l(_vm.spaces,(function(space){return _c("el-option",{key:space.id,attrs:{label:space.name,value:space.id}})})),1)],1)]),_vm.showRootMeterOption?_c("el-col",{staticStyle:{"padding-left":"0px","padding-right":"25px","padding-top":"23px",position:"relative",top:"29px",left:"30px"},attrs:{span:12}},[_c("div",{staticClass:"add"},[_c("el-switch",{staticStyle:{float:"left"},attrs:{"active-color":"#ef4f8f"},model:{value:_vm.meter.root,callback:function($$v){_vm.$set(_vm.meter,"root",$$v)},expression:"meter.root"}}),_c("div",{staticStyle:{float:"left","padding-left":"10px","padding-top":"2px"}},[_vm._v(" "+_vm._s(_vm.$t("setup.setupLabel.is_root_meter"))+" ")]),_c("div",{staticStyle:{clear:"both"}})],1)]):_vm._e()],1),_c("el-row",{attrs:{align:"middle",gutter:20}},[_c("el-col",{staticClass:"mT30",attrs:{span:12}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.$t("common.header.purpose"))+" ")]),_c("div",{staticClass:"add"},[_c("el-select",{staticClass:"form-item width100 fc-input-full-border2 ",attrs:{filterable:"",placeholder:_vm.$t("common._common.choose_purpose")},model:{value:_vm.meter.purpose.id,callback:function($$v){_vm.$set(_vm.meter.purpose,"id",$$v)},expression:"meter.purpose.id"}},_vm._l(_vm.picklistOptions,(function(purpose,key){return _c("el-option",{key:key,attrs:{label:purpose,value:parseInt(key)}})})),1)],1)]),_c("el-col",{staticStyle:{position:"relative",top:"56px",left:"30px"},attrs:{span:4}},[_c("div",{staticClass:"inline"},[_c("el-button",{directives:[{name:"popover",rawName:"v-popover:purposePopver",arg:"purposePopver"}],staticStyle:{"text-align":"center",width:"44px","border-width":"1px","font-weight":"normal",height:"40px","font-sie":"16px",color:"#333"},attrs:{size:"small",icon:"el-icon-plus"}})],1)]),_vm.showPurposeRootMeterOption?_c("el-col",{staticStyle:{"padding-top":"23px","padding-left":"0px","padding-right":"25px",position:"relative",top:"0",left:"100px"},attrs:{span:12}},[_c("div",{staticClass:"add"},[_c("el-switch",{staticStyle:{float:"left"},attrs:{"active-color":"#ef4f8f"},model:{value:_vm.meter.root,callback:function($$v){_vm.$set(_vm.meter,"root",$$v)},expression:"meter.root"}}),_c("div",{staticStyle:{float:"left","padding-left":"10px","padding-top":"2px"}},[_vm._v(" "+_vm._s(_vm.$t("setup.setupLabel.is_root_meter"))+" ")]),_c("div",{staticStyle:{clear:"both"}})],1)]):_vm._e()],1),_vm.meter.isVirtual?_vm._e():_c("el-row",{attrs:{align:"middle",gutter:20}},[_c("el-col",{staticClass:"mT30",attrs:{span:12}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.$t("common._common.serial_number"))+" ")]),_c("div",{staticClass:"add"},[_c("el-input",{staticClass:"fc-input-full-border2 ",attrs:{placeholder:_vm.$t("setup.setupLabel.enter_meter_serial")},model:{value:_vm.meter.serialNumber,callback:function($$v){_vm.$set(_vm.meter,"serialNumber",$$v)},expression:"meter.serialNumber"}})],1)])],1),_vm.meter.isVirtual?_vm._e():_c("el-row",{attrs:{align:"middle",gutter:20}},[_c("el-col",{staticClass:"mT30",attrs:{span:12}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.$t("common._common.located_at"))+" ")]),_c("div",{staticClass:"add"},[_c("el-select",{staticClass:"form-item fc-input-full-border2 ",staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:_vm.$t("common._common.choose_location")},model:{value:_vm.meter.space.id,callback:function($$v){_vm.$set(_vm.meter.space,"id",$$v)},expression:"meter.space.id"}},_vm._l(_vm.spaces,(function(space){return _c("el-option",{key:space.id,attrs:{label:space.name,value:space.id}})})),1)],1)])],1),_c("el-row",{attrs:{align:"middle",gutter:20}},[_c("el-col",{staticClass:"mT30",attrs:{span:12}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.$t("setup.setupLabel.multi_factor"))+" ")]),_c("div",{staticClass:"add"},[_c("el-input",{staticClass:"fc-input-full-border2 ",attrs:{placeholder:_vm.$t("setup.setupLabel.enter_multi_factor")},model:{value:_vm.meter.multiplicationFactor,callback:function($$v){_vm.$set(_vm.meter,"multiplicationFactor",$$v)},expression:"meter.multiplicationFactor"}})],1)])],1),_vm.meter.isVirtual?_c("div",{staticStyle:{"padding-top":"40px"}},[_vm.meter.isVirtual?_c("f-formula-builder",{attrs:{module:"virtual",hideModeChange:!0},model:{value:_vm.meter.childMeterExpression,callback:function($$v){_vm.$set(_vm.meter,"childMeterExpression",$$v)},expression:"meter.childMeterExpression"}}):_vm._e()],1):_vm._e()],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.cancel}},[_vm._v(" "+_vm._s(_vm.$t("setup.users_management.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.saving},on:{click:function($event){return _vm.submitForm("meterForm")}}},[_vm._v(_vm._s(_vm.saving?_vm.$t("common._common._saving"):_vm.$t("common._common._save"))+" ")])],1)],1)],1)])}),NewEnergyMetervue_type_template_id_01fe77e4_staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),FFormulaBuilder=(__webpack_require__(648324),__webpack_require__(902294)),validation=__webpack_require__(990260),vuex_esm=__webpack_require__(420629),picklist=__webpack_require__(961358),ui_forms=__webpack_require__(141323),log_map_state=__webpack_require__(766331),fields={site:{isDataLoading:!1,options:[],lookupModuleName:"site",field:{lookupModule:{name:"site",displayName:"Sites"}},multiple:!1,additionalParams:{orderBy:"spaceType",orderType:"asc"}}},NewEnergyMetervue_type_script_lang_js={name:"NewEnergyMeter",props:["meter","isNew","visibility"],data:function(){return{fields:fields,workflow:null,saving:!1,purposeSaving:!1,picklistOptions:{},popoverVisible:!1,initialValue:null,newPurpose:"",rules:{"meter.name":[{required:!0,message:this.$t("common._common.please_enter_a_name"),trigger:"blur"}],"meter.purpose":[{required:!0,message:this.$t("common.header.please_select_a_purpose"),trigger:"blur"}],"meter.siteId":[{required:!0,message:this.$t("common.header.please_select_a_site"),trigger:"blur"}]},spaces:[]}},watch:{"meter.siteId":{handler:function(newVal,oldVal){var _this=this;newVal!==oldVal&&this.$util.loadSpace(null,null,[{key:"site",value:newVal}],null).then((function(data){_this.spaces=data.basespaces}))},deep:!0}},components:{Lookup:ui_forms/* Lookup */.tY,FFormulaBuilder:FFormulaBuilder/* default */.Z},created:function(){this.$store.dispatch("loadEnergyMeters"),this.$store.dispatch("loadServiceList"),this.$store.dispatch("loadSite"),this.$store.dispatch("loadSpaces")},mounted:function(){this.initEnergyMeter(),this.loadPickList("energymeterpurpose")},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({sites:function(state){return state.site}})),(0,log_map_state/* mapStateWithLogging */.g)({spaces:function(state){return state.spaces}})),{},{showRootMeterOption:function(){return this.meter.purposeSpace&&this.meter.purposeSpace.id&&!this.meter.purpose.id},showPurposeRootMeterOption:function(){return this.meter.purposeSpace&&this.meter.purposeSpace.id&&this.meter.purpose.id}}),methods:{initEnergyMeter:function(){this.workflow=this.meter.childMeterExpression,this.isNew||(this.initialValue=this.$helpers.cloneObject(this.meter))},showLookupWizardSite:function(field,canShow){canShow=!1,this.$set(this,"selectedLookupField",field),this.$set(this,"canShowLookupWizardSite",canShow)},setSelectedValue:function(selectedValues,field){},setExpressionString:function(expression){this.meter.childMeterExpression=expression},loadPickList:function(moduleName){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var _yield$getFieldOption,error,options;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _this2.picklistOptions={},_context.next=3,(0,picklist/* getFieldOptions */._K)({field:{lookupModuleName:moduleName,skipDeserialize:!0}});case 3:_yield$getFieldOption=_context.sent,error=_yield$getFieldOption.error,options=_yield$getFieldOption.options,error?_this2.$message.error(error.message||"Error Occured"):_this2.picklistOptions=options;case 7:case"end":return _context.stop()}}),_callee)})))()},submitForm:function(meterForm){var _this3=this,self=this;this.$refs[meterForm].validate((function(valid){if(!valid)return!1;var url,meterObj={};_this3.isNew?(url="/energymeter/add",meterObj.energyMeter=_this3.$helpers.cloneObject(_this3.meter),meterObj.energyMeter.purposeSpace&&!meterObj.energyMeter.purposeSpace.id&&(meterObj.energyMeter.purposeSpace.id=-1),meterObj.energyMeter.purpose&&!meterObj.energyMeter.purpose.id&&(meterObj.energyMeter.purpose.id=-1),meterObj.energyMeter.space&&!meterObj.energyMeter.space.id&&(meterObj.energyMeter.space.id=-1)):(url="/energymeter/update",meterObj.energyMeter=_this3.$helpers.compareObject(_this3.meter,_this3.initialValue),meterObj.energyMeter.id=_this3.meter.id),_this3.meter.isVirtual?(0,validation/* isEmpty */.xb)(_this3.$getProperty(meterObj,"energyMeter.purposeSpace.id",null))||(meterObj.energyMeter.space||(meterObj.energyMeter.space={}),meterObj.energyMeter.space.id=meterObj.energyMeter.purposeSpace.id):delete meterObj.energyMeter.childMeterExpression,self.saving=!0,_this3.$http.post(url,meterObj).then((function(response){JSON.stringify(response),200===response.status?(self.$message(self.isNew?self.$t("common.wo_report.new_energy_meter_created"):self.$t("common.wo_report.energy_meter_updated_sucess")),self.saving=!1,self.$emit("saved"),self.$emit("update:visibility",!1)):self.saving=!1})).catch((function(error){}))}))},cancel:function(){this.$emit("canceled")},closeDialog:function(){this.$emit("update:visibility",!1)},save:function(){var self=this;self.saving=!0},addNewPurpose:function(){var self=this;this.purposeSaving=!0,this.$http.post("/energymeter/addPurpose",{energyMeterPurpose:{name:this.newPurpose}}).then((function(response){self.purposeSaving=!1,response.data&&(self.popoverVisible=!1,self.picklistOptions[response.data.id]=self.newPurpose,self.meter.purpose.id=response.data.id,self.$store.dispatch("updateServiceList",{id:response.data.id,name:self.newPurpose}),self.newPurpose="")}))}}},new_NewEnergyMetervue_type_script_lang_js=NewEnergyMetervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(new_NewEnergyMetervue_type_script_lang_js,NewEnergyMetervue_type_template_id_01fe77e4_render,NewEnergyMetervue_type_template_id_01fe77e4_staticRenderFns,!1,null,null,null)
/* harmony default export */,NewEnergyMeter=component.exports,NewRunThroughFiltervue_type_template_id_68ff3de9_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{attrs:{visible:_vm.showDialog,width:"40%",title:_vm.$t("setup.setupLabel.run_through_meter"),"custom-class":"new-runthrough-page fc-dialog-center-container"},on:{"update:visible":function($event){_vm.showDialog=$event}}},[_c("div",{},[_c("el-row",[_c("el-col",{staticClass:"width100",attrs:{span:24}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.$t("setup.setupLabel.virtual_meter"))+" ")]),_c("el-select",{staticClass:"width100 fc-input-full-border2 fc-tag",attrs:{multiple:"","collapse-tags":""},model:{value:_vm.selectedvmmeterlist,callback:function($$v){_vm.selectedvmmeterlist=$$v},expression:"selectedvmmeterlist"}},_vm._l(_vm.virtualMeterslist,(function(meter,index){return _c("el-option",{key:index,attrs:{label:meter.name,value:meter.id,disabled:meter.isHistoricalRunning}})})),1)],1)],1),_c("el-row",{staticClass:"mT20",attrs:{gutter:20}},[_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"fc-input-label-txt pT15"},[_vm._v(" "+_vm._s(_vm.$t("setup.setupLabel.start_time"))+" ")]),_c("el-date-picker",{staticClass:"fc-input-full-border2 width100",attrs:{type:"datetime"},model:{value:_vm.startTime,callback:function($$v){_vm.startTime=$$v},expression:"startTime"}})],1),_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"fc-input-label-txt pT15"},[_vm._v(" "+_vm._s(_vm.$t("setup.setupLabel.end_time"))+" ")]),_c("el-date-picker",{staticClass:"fc-input-full-border2 width100",attrs:{type:"datetime"},model:{value:_vm.endTime,callback:function($$v){_vm.endTime=$$v},expression:"endTime"}})],1)],1)],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("button",{staticClass:"modal-btn-cancel",attrs:{type:"button"},on:{click:function($event){_vm.showDialog=!1}}},[_c("span",[_vm._v(_vm._s(_vm.$t("setup.users_management.cancel")))])]),_c("button",{staticClass:"modal-btn-save",attrs:{type:"button"},on:{click:_vm.start}},[_c("span",[_vm._v(_vm._s(_vm.$t("setup.setupLabel.start")))])])])])},NewRunThroughFiltervue_type_template_id_68ff3de9_staticRenderFns=[],NewRunThroughFiltervue_type_script_lang_js={props:["visible","meterList"],data:function(){return{selectedMeters:[],selectedvmmeterlist:[],virtualMeterslist:[],startTime:null,endTime:null,interval:"",showDialog:this.visible,runParentMeter:!0}},computed:{},mounted:function(){this.loadvmmeterlist()},watch:{visible:function(val,oldVal){this.showDialog=val},showDialog:function(val,oldVal){this.$emit("update:visible",val)}},methods:{start:function(){var _this=this,data={startTime:this.$helpers.getTimeInOrg(this.startTime),endTime:this.$helpers.getTimeInOrg(this.endTime)};this.selectedvmmeterlist.length&&(data.vmList=this.selectedvmmeterlist),this.$http.post("/energymeter/insertvmeterreadings",data).then((function(d){_this.selectedvmmeterlist=[],_this.startTime=null,_this.endTime=null,
// this.interval = null
_this.$emit("loadfilterlist"),_this.$message("Run through filter started"),_this.showDialog=!1}))},loadvmmeterlist:function(){var data={startTime:this.$helpers.getTimeInOrg(this.startTime),endTime:this.$helpers.getTimeInOrg(this.endTime)};this.startTime=null,this.endTime=null;var self=this;self.loading=!0,self.$http.get("/v2/virtualMeter/getvmList",data).then((function(response){self.virtualMeterslist=response.data.result.virtualMeters}))}}},setup_NewRunThroughFiltervue_type_script_lang_js=NewRunThroughFiltervue_type_script_lang_js,NewRunThroughFilter_component=(0,componentNormalizer/* default */.Z)(setup_NewRunThroughFiltervue_type_script_lang_js,NewRunThroughFiltervue_type_template_id_68ff3de9_render,NewRunThroughFiltervue_type_template_id_68ff3de9_staticRenderFns,!1,null,null,null)
/* harmony default export */,NewRunThroughFilter=NewRunThroughFilter_component.exports,User=__webpack_require__(426803),EnergyMetervue_type_script_lang_js={title:function(){return"Energy Meters"},components:{NewEnergyMeter:NewEnergyMeter,RunThroughFilter:NewRunThroughFilter,UserAvatar:User/* default */.Z},data:function(){return{loading:!0,meterList:[],parentActivitylog:[],meterchildId:null,selectedMeter:{},parentLogLoading:!1,isNew:!0,loadEnergyMeterForm:!1,runthroughVisible:!1,rule:null,activities:[],newEnergyMeter:{name:"",description:"",serialNumber:"",space:{id:null},purposeSpace:{id:null},purpose:{id:null},isVirtual:!1,root:!1,childMeterExpression:"",siteId:null},activeName:"first",activeNames:["1"]}},created:function(){this.$store.dispatch("loadEnergyMeters"),this.$store.dispatch("loadServiceList"),this.$store.dispatch("loadSite")},mounted:function(){this.loadaddMeter(),this.loadactivitylog()},computed:(0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({sites:function(state){return state.site},serviceList:function(state){return state.serviceList}})),methods:{showNewEnergyMeter:function(){this.loadEnergyMeterForm=!0,this.selectedMeter=this.$helpers.cloneObject(this.newEnergyMeter),1===this.sites.length&&(this.selectedMeter.siteId=this.sites[0].id),this.isNew=!0},showEditEnergyMeter:function(meter){this.loadEnergyMeterForm=!0,this.selectedMeter=this.$helpers.cloneObject(meter),this.selectedMeter.space={id:this.selectedMeter.space&&this.selectedMeter.space.id>-1?this.selectedMeter.space.id:null},this.selectedMeter.purposeSpace={id:this.selectedMeter.purposeSpace&&this.selectedMeter.space.id>-1?this.selectedMeter.purposeSpace.id:null},this.selectedMeter.purpose={id:this.selectedMeter.purpose&&this.selectedMeter.purpose.id>-1?this.selectedMeter.purpose.id:null},this.isNew=!1},close:function(){this.loadEnergyMeterForm=!1},loadaddMeter:function(){var that=this;that.$http.get("/energymeter/all").then((function(response){that.loading=!1,200===response.status&&(that.meterList=response.data?response.data:[])}))},loadactivitylog:function(){var _this=this;this.parentLogLoading=!0;var url="v2/historicalLogger/vmParentMeters";this.$http.get(url).then((function(response){200===response.status&&(_this.parentActivitylog=response.data.result.parentHistoricalLoggers,_this.parentActivitylog&&(_this.activities=_this.parentActivitylog.map((function(activity){return{id:activity.id,label:activity.parentResourceContext.name,info:activity,children:[]}}))),_this.parentLogLoading=!1)}))},loadChildren:function(node,resolve){var _this2=this;if(1!==node.level)return resolve(node.data.children||[]);var id=node.data.id;this.$http.get("v2/historicalLogger/vmChildMeters?parentId=".concat(id)).then((function(response){if(0===response.data.responseCode){var childMeters=response.data.result.childMeters,logs=[];return childMeters&&childMeters[1]&&_this2.setChildMeters(1,childMeters,id,logs),resolve(logs)}self.$message.error("Error Occured")}))},setChildMeters:function(level,meters,id,logs){var _this3=this;return meters[level]&&logs.push.apply(logs,(0,toConsumableArray/* default */.Z)(meters[level].filter((function(meter){return meter.dependentId===id})).map((function(meter){var child={id:meter.id,label:meter.parentResourceContext.name,info:meter,children:[]};return _this3.setChildMeters(level+1,meters,meter.id,child.children),child})))),[]},addMeterSaved:function(){this.loadaddMeter(),this.loadEnergyMeterForm=!1},deleteEm:function(id){var self=this;self.$dialog.confirm({title:this.$t("common.wo_report.delete_energy_meter_title"),message:this.$t("common.header.are_you_sure_you_want_to_delete_this_meter"),rbDanger:!0,rbLabel:this.$t("common._common.delete")}).then((function(value){value&&self.$http.post("/v2/assets/delete",{assetsId:[id]}).then((function(response){if(0===response.data.responseCode){self.$message.success(this.$t("common.products.meter_removed_successfully"));var idx=self.meterList.findIndex((function(meter){return meter.id===id}));self.meterList.splice(idx,1)}}))}))}}},v1_EnergyMetervue_type_script_lang_js=EnergyMetervue_type_script_lang_js,EnergyMeter_component=(0,componentNormalizer/* default */.Z)(v1_EnergyMetervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,EnergyMeter=EnergyMeter_component.exports},
/***/702638:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"763b584b7aa649bd99722d2be3c8036a.svg";
/***/},
/***/47424:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"400bdd76d58614975db74618a6f968ef.svg";
/***/}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/45666.js.map