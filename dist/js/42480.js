"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[42480],{
/***/439667:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return NewAlarmRules}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/setup/new/NewAlarmRules.vue?vue&type=template&id=75953909
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:" height100"},[_c("div",{staticClass:"setting-header2"},[_vm._m(0),_c("div",{staticClass:"action-btn setting-page-btn"},[_c("el-button",{staticClass:"setup-el-btn",attrs:{type:"primary"},on:{click:_vm.newThresholdRule}},[_vm._v("New Alarm Rule")]),_vm.thresholddialog?_c("new-rule",{attrs:{rules:_vm.selectedRules,ruleId:_vm.selectedRule,visibility:_vm.thresholddialog},on:{"update:visibility":function($event){_vm.thresholddialog=$event},onSaveRule:_vm.loadReadingRules}}):_vm._e()],1)]),_c("div",{staticClass:"select-all-rule"},[_c("el-popover",{staticClass:"rule-popover",attrs:{placement:"bottom",width:"200",trigger:"click","after-enter":"true","popper-class":"alarmrule-list-popover"},model:{value:_vm.closepopover,callback:function($$v){_vm.closepopover=$$v},expression:"closepopover"}},[_vm._l(_vm.categoryTypes,(function(category,index){return _c("div",{key:index,staticClass:"rule-list-txt",attrs:{label:category.label,value:category.value},on:{click:function($event){return _vm.selectedRuleTypes(category.value)}}},[_vm._v(" "+_vm._s(category.label)+" ")])})),_c("el-button",{staticClass:"all-rule-btn",attrs:{slot:"reference"},slot:"reference"},[_vm._v(_vm._s(_vm.categoryTypes.find((function(type){return _vm.categoryType===type.value})).label)),_c("i",{staticClass:"el-icon-arrow-down"})])],2)],1),_c("div",{staticClass:"container-scroll"},[_c("div",{staticClass:"row setting-Rlayout"},[_c("div",{staticClass:"col-lg-12 col-md-12"},[_c("table",{staticClass:"setting-list-view-table mT20"},[_vm._m(1),_vm.loading?_c("tbody",[_c("tr",[_c("td",{staticClass:"text-center",attrs:{colspan:"100%"}},[_c("spinner",{attrs:{show:_vm.loading,size:"80"}})],1)])]):Object.keys(_vm.readingRules).length?_c("tbody",[_vm._l(_vm.readingRules,(function(list,index){return["all"===_vm.categoryType?_c("tr",{key:index,staticClass:"list-rule-head nohover"},[_c("td",{attrs:{colspan:"100%"}},[_vm._v(" "+_vm._s(list.category)+" "),_c("span",{staticClass:"rules-count"},[_vm._v(_vm._s(list.rules.length)+" Rules")])])]):_vm._e(),_vm._l(list.rules,(function(readingRule,ruleIndex){return"all"===_vm.categoryType||_vm.categoryType===list.category?_c("tr",{key:index+"_"+ruleIndex,staticClass:"tablerow"},[_c("td",{staticStyle:{"padding-right":"0"}},[_c("div",{staticStyle:{width:"100%","line-height":"22px"}},[_vm._v(" "+_vm._s(readingRule.name)+" ")])]),_c("td",{staticStyle:{width:"200px",",max-width":"200px"}},[_vm._v(" "+_vm._s(_vm.getResourceName(readingRule))+" ")]),_c("td",{staticStyle:{width:"100px",",max-width":"100px"}},[_c("el-switch",{staticClass:"Notification-toggle",attrs:{"active-color":"rgba(57, 178, 194, 0.8)","inactive-color":"#e5e5e5"},on:{change:function($event){return _vm.changeRuleStatus(readingRule)}},model:{value:readingRule.status,callback:function($$v){_vm.$set(readingRule,"status",$$v)},expression:"readingRule.status"}})],1),_c("td",{staticStyle:{width:"15%"}},[_c("div",{staticClass:"text-left actions",staticStyle:{"margin-top":"0px","margin-right":"15px","text-align":"center"}},[_c("i",{staticClass:"el-icon-edit pointer",on:{click:function($event){return _vm.editThresholdRule(readingRule)}}}),_vm._v("    "),_c("i",{staticClass:"el-icon-delete pointer",on:{click:function($event){return _vm.deleteRule(readingRule,list.category,index,ruleIndex)}}})])])]):_vm._e()}))]}))],2):_c("tbody",[_vm._m(2)])])])])]),_c("el-dialog",{attrs:{title:"Confirm Delete",visible:_vm.showDialog,width:"40%"},on:{"update:visible":function($event){_vm.showDialog=$event}}},[_c("div",[_vm._v("Are you sure you want to delete this?")]),_c("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[_c("el-button",{on:{click:function($event){_vm.showDialog=!1}}},[_vm._v("CANCEL")]),_c("el-button",{attrs:{type:"primary"},on:{click:function($event){_vm.showDialog=!1,_vm.deleteRule()}}},[_vm._v("CONFIRM")])],1)])],1)},staticRenderFns=[function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"setting-title-block"},[_c("div",{staticClass:"setting-form-title"},[_vm._v("Alarm Rules")]),_c("div",{staticClass:"heading-description"},[_vm._v("List of all Alarm Rules")])])},function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("thead",[_c("tr",[_c("th",{staticClass:"setting-table-th setting-th-text"},[_vm._v("RULE NAME")]),_c("th",{staticClass:"setting-table-th setting-th-text",staticStyle:{width:"200px"}},[_vm._v(" SPACE / ASSET ")]),_c("th",{staticClass:"setting-table-th setting-th-text"},[_vm._v("STATUS")]),_c("th",{staticClass:"setting-table-th setting-th-text"})])])},function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("tr",[_c("td",{staticClass:"text-center",attrs:{colspan:"100%"}},[_vm._v(" No rules created yet. ")])])}],NewRule=(__webpack_require__(450886),__webpack_require__(434284),__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(169358),__webpack_require__(947522),__webpack_require__(670560),__webpack_require__(162506),__webpack_require__(552154)),NewAlarmRulesvue_type_script_lang_js={components:{NewRule:NewRule/* default */.Z},title:function(){return"Alarm Rules"},created:function(){this.$store.dispatch("loadAssetCategory")},data:function(){return{loading:!0,readingRules:[],isNew:!0,isDependant:!1,rule:{},loadThresholdRuleForm:!1,selectedRule:null,selectedRules:null,showDialog:!1,thresholddialog:!1,parentRuleName:null,closepopover:!1,subheaderMenu:[{label:"Asset",path:{path:"/app/setup/alarmsettings/alarmrules/asset"}},{label:"Space",path:{path:"/app/setup/alarmsettings/alarmrules/space"}}],categoryTypes:[{label:"All Alarm Rules",value:"all"}],categoryType:"all"}},mounted:function(){this.loadReadingRules()},computed:{assetCategoryList:function(){return this.$store.state.assetCategory}},methods:{getRuleName:function(ruleId){var rules=this.readingRules.map((function(list){return list.rules}));return rules.find((function(rule){return rule.id===ruleId})).name},getResourceName:function(rule){if(rule.assetCategoryId>0){var message,selectedCount,isIncluded=rule.includedResources&&rule.includedResources.length;isIncluded?selectedCount=rule.includedResources.length:rule.excludedResources&&rule.excludedResources.length&&(selectedCount=rule.excludedResources.length);var categoryName=this.getCategoryName(rule.assetCategoryId);return message=selectedCount?(isIncluded?selectedCount:"Some")+" "+categoryName+(!isIncluded||selectedCount>1?"s":""):"All "+categoryName+"s",message}return rule.resourceId>0?rule.matchedResources[Object.keys(rule.matchedResources)[0]].name:"---"},getCategoryName:function(categoryId){if(categoryId>0&&this.assetCategoryList){var category=this.assetCategoryList.find((function(category){return category.id===categoryId}));if(category)return category.displayName}},aftersave:function(){this.closeCreateDialog()},newThresholdRule:function(){this.loadThresholdRuleForm=!0,this.isNew=!0,this.selectedRules=null,this.selectedRule=null,this.thresholddialog=!0},newThresholdDependantRule:function(rule){this.loadThresholdRuleForm=!0,this.isNew=!0,this.isDependant=!0,this.rule=this.$helpers.cloneObject(rule),this.parentRuleName=this.rule.name,this.thresholddialog=!0},editThresholdRule:function(rule){var self=this;self.$util.fetchRules("alarm",rule.id).then((function(rules){self.selectedRules=rules,self.selectedRule=rule.id,self.thresholddialog=!0}))},changeRuleStatus:function(rule){this.$util.changeRuleStatus("alarm",rule.id,rule.status).then((function(response){})).catch((function(error){}))},loadReadingRules:function(){var _this=this;this.loading=!0,this.$util.loadRules("alarm").then((function(rules){if(_this.readingRules=[],rules){var spaceRules=[],energyRules=[],chillerRules=[],fcuRules=[],otherRules={};for(var category in rules.forEach((function(rule){var category;if(rule.assetCategoryId>0)category=_this.getCategoryName(rule.assetCategoryId);else if(rule.resourceId>0){var resource=rule.matchedResources[Object.keys(rule.matchedResources)[0]];2===resource.resourceType?category=_this.getCategoryName(resource.category.id):spaceRules.push(rule)}else spaceRules.push(rule);category&&("Energy Meter"===category?energyRules.push(rule):"Chiller"===category?chillerRules.push(rule):"FCU"===category?fcuRules.push(rule):(otherRules[category]||(otherRules[category]=[]),otherRules[category].push(rule)))})),energyRules.length&&(_this.readingRules.push({category:"Energy Meter",rules:energyRules}),_this.categoryTypes.push({label:"Energy Meter Rules",value:"Energy Meter"})),chillerRules.length&&(_this.readingRules.push({category:"Chiller",rules:chillerRules}),_this.categoryTypes.push({label:"Chiller Rules",value:"Chiller"})),fcuRules.length&&(_this.readingRules.push({category:"FCU",rules:fcuRules}),_this.categoryTypes.push({label:"FCU Rules",value:"FCU"})),otherRules){var _rules=otherRules[category];_this.readingRules.push({category:category,rules:_rules}),_this.categoryTypes.push({label:category+" Rules",value:category})}spaceRules.length&&(_this.readingRules.push({category:"All Spaces",rules:spaceRules}),_this.categoryTypes.push({label:"All Space Rules",value:"All Spaces"}))}_this.loading=!1}))},deleteRule:function(rule,category,idx,ruleIndex){var _this2=this;this.$dialog.confirm({title:"Delete Rule",message:"Are you sure you want to delete this rule?",rbDanger:!0,rbLabel:"Delete"}).then((function(value){value&&_this2.$util.deleteRule("alarm",rule.id).then((function(response){_this2.readingRules[idx].rules.splice(ruleIndex,1),_this2.readingRules[idx].rules.length||_this2.readingRules.splice(idx,1)}))}))},closeCreateDialog:function(){this.loadReadingRules()},selectedRuleTypes:function(category){this.categoryType=category,this.closepopover=!1}}},new_NewAlarmRulesvue_type_script_lang_js=NewAlarmRulesvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(new_NewAlarmRulesvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,NewAlarmRules=component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/42480.js.map