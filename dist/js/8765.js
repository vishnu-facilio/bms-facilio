(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[8765],{
/***/785869:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return Subheader}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/Subheader.vue?vue&type=template&id=fa337eb6
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"subheader-section",class:{filterclass:!0===_vm.querry}},[_c("div",{staticClass:"subheader-div"},[_c("ul",{staticClass:"subheader-tabs pull-left"},[_vm._t("prefix"),_vm._l(_vm.activeMenuList,(function(item,index){return[item.multilevel?_c("li",{key:index,staticClass:"sh-multilevel-header",class:{"router-link-exact-active active":_vm.getTabTitlenew(item)!==item.label||_vm.$route.params&&"chilleroverview"===_vm.$route.params.dashboardlink}},[_c("el-popover",{attrs:{placement:"bottom",width:"200","popper-class":"sh-popup-tree",trigger:"hover"},model:{value:_vm.closepop,callback:function($$v){_vm.closepop=$$v},expression:"closepop"}},[_vm._l(item.children,(function(d,index){return item.children?_c("div",{key:index,staticClass:"p5 parent-sh"},[_c("div",{staticClass:"sh-pop-parent p5 pointer",class:{active:d.path.path===_vm.$route.path},on:{click:function($event){return _vm.getparent(d)}}},[_vm._v(" "+_vm._s(d.label)+" ")]),d.children?_c("div",{staticClass:"p5 sh-con-header"},_vm._l(d.children,(function(c,idx){return d.children?_c("div",{key:idx,staticClass:"child-sh"},[_c("div",{staticClass:"sh-pop-child p5 pointer",class:{active:c.path.path===_vm.$route.path},on:{click:function($event){return _vm.getchild(c)}}},[_c("i",{staticClass:"fa fa-circle sh-indicater",class:{active:c.path.path===_vm.$route.path}}),_vm._v(_vm._s(c.label)+" ")])]):_vm._e()})),0):_vm._e()]):_vm._e()})),_c("a",{attrs:{slot:"reference"},slot:"reference"},[_vm._v(" "+_vm._s(_vm.getTabTitlenew(item))+" "),_c("i",{staticClass:"switch-icon-dropdown el-icon-arrow-down",staticStyle:{float:"right",margin:"5px"}})])],2),_c("div",{staticClass:"sh-selection-bar"})],1):item.disable?_c("li",{key:index,class:{"router-link-exact-active active":_vm.getTabTitle(item)!==item.label}},[_c("el-dropdown",{on:{command:_vm.openChild}},[_c("a",[_vm._v(" "+_vm._s(_vm.getTabTitle(item))+" "),_c("i",{staticClass:"switch-icon-dropdown el-icon-arrow-down",staticStyle:{float:"right",margin:"5px"}})]),_c("div",{staticClass:"sh-selection-bar"}),_c("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},_vm._l(item.childrens,(function(child,childindex){return _c("el-dropdown-item",{key:childindex,attrs:{command:{curentItem:child,parentItem:item},disabled:child.disable}},[_vm._v(_vm._s(child.label))])})),1)],1)],1):item.childrens||!_vm.showCurrentViewOnly||_vm.currentView===item.name?_c("router-link",{key:index,attrs:{tag:"li",to:item.childrens&&item.childrens.find((function(cl){return cl.path.path===_vm.$route.path}))?item.childrens.find((function(cl){return cl.path.path===_vm.$route.path})).path:item.path}},[_c("a",[_vm._v(_vm._s(_vm.getTabTitle(item)))]),item.childrens?_c("div",{staticStyle:{float:"right",margin:"3px"}},[_c("el-dropdown",{on:{command:_vm.openChild}},[_c("i",{staticClass:"switch-icon-dropdown el-icon-arrow-down"}),_c("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},_vm._l(item.childrens,(function(child,childindex){return _c("el-dropdown-item",{key:childindex,attrs:{command:{curentItem:child,parentItem:item},disabled:child.disable}},[_vm._v(_vm._s(child.label))])})),1)],1)],1):_vm._e(),item.disable?_vm._e():_c("div",{staticClass:"sh-selection-bar"})]):_vm._e()]})),_vm.moreMenuList.length&&!_vm.showCurrentViewOnly?_c("li",{staticClass:"pointer",class:{active:_vm.isMoreMenuActive}},[_c("div",[_c("svg",{staticStyle:{"enable-background":"new 0 0 408 408"},attrs:{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",id:"Capa_1",x:"0px",y:"0px",width:"18px",height:"18px",viewBox:"0 0 408 408","xml:space":"preserve"}},[_c("g",[_c("g",{attrs:{id:"more-horiz"}},[_c("path",{attrs:{d:"M51,153c-28.05,0-51,22.95-51,51s22.95,51,51,51s51-22.95,51-51S79.05,153,51,153z M357,153c-28.05,0-51,22.95-51,51    s22.95,51,51,51s51-22.95,51-51S385.05,153,357,153z M204,153c-28.05,0-51,22.95-51,51s22.95,51,51,51s51-22.95,51-51    S232.05,153,204,153z",fill:"#b1bdc9"}})])])])]),_c("q-popover",{ref:"shpopover",on:{open:_vm.moreMenuOpened,close:_vm.moreMenuClosed}},[_c("q-list",{staticClass:"scroll q-list-item",staticStyle:{"min-width":"150px"},attrs:{link:""}},[_vm._l(_vm.moreMenuList,(function(item,index){return _c("q-item",{key:index,on:{click:function($event){return _vm.openSubTab(item,index)}}},[_c("q-item-main",{staticStyle:{"font-size":"13px"},attrs:{label:item.label}})],1)})),_vm.showRearrange?_c("q-item",{staticClass:"rearrange-button",attrs:{menu:_vm.menu},on:{click:_vm.rearrange}},[_c("q-item-main",{staticStyle:{"font-size":"13px"},attrs:{label:_vm.$t("setup.users_management.rearrange")}})],1):_vm._e()],2)],1)],1):_vm._e()],2),_vm._t("suffix"),_c("div",{class:_vm.positionsheaders},[_vm._t("default")],2)],2)])},staticRenderFns=[],toConsumableArray=__webpack_require__(488478),quasar_esm=(__webpack_require__(670560),__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(538077),__webpack_require__(162506),__webpack_require__(564043),__webpack_require__(857267),__webpack_require__(634338),__webpack_require__(902918),__webpack_require__(450886),__webpack_require__(434284),__webpack_require__(641358)),Subheadervue_type_script_lang_js={computed:{currentView:function(){return this.$route.params.viewname},querry:function(){return""===this.$route.query.filters||!!this.$route.query.filters}},props:["menu","filtersRetain","newbtn","type","parent","positionsheader","showRearrange","listCount","showCurrentViewOnly","maxVisibleMenu"],components:{QPopover:quasar_esm/* QPopover */.oe,QList:quasar_esm/* QList */.tu,QItem:quasar_esm/* QItem */.ry,QItemMain:quasar_esm/* QItemMain */.Ui},data:function(){return{positionsheaders:"pull-right",closepop:!1,activeMenuList:[],moreMenuList:[],seletedvalue:null,isMoreMenuActive:!1}},watch:{$route:function(to,from){if(this.filtersRetain&&from.path!==to.path)for(var i=0;i<this.filtersRetain.length;i++){var key1=from.query.hasOwnProperty(this.filtersRetain[i]);key1&&this.$router.push({query:from.query})}this.setFirstMenu(),this.$emit("tabChange")},menu:function(newVal){this.multilevelheader()}},mounted:function(){this.multilevelheader()},methods:{getTabTitle:function(item){var _this=this;if(item.path.path!==this.$route.path&&item.childrens&&item.childrens.length){var child=item.childrens.find((function(it){return it.path.path===_this.$route.path}));if(child)return child.label}return item.label},getTabTitlenew:function(item){var _this2=this;if(item.path.path!==this.$route.path&&item.children&&item.children.length){var child=item.children.find((function(it){return it.path.path===_this2.$route.path})),ch=item.children.filter((function(it){return it.children}));if(child)return child.label;for(var i=0;i<ch.length;i++){var c=ch[i].children&&ch[i].children.find((function(rt){return rt.path.path===_this2.$route.path}));if(c)return c.label}}return item.label},getparent:function(data){data.path&&data.path.path&&(this.$router.push({path:data.path.path}),this.closepop=!1)},getchild:function(data){data.path&&data.path.path&&(this.$router.push({path:data.path.path}),this.closepop=!1)},selectheader:function(value,event){this.seletedvalue=value,this.$router.push(value[value.length-1])},multilevelheader:function(){this.seletedvalue=["/app/em/newdashboard/chilleroverview/391"],this.loadMenuList()},multiheaderClickEvent:function(){},callbackMethod:function(newVal){},handleFcAfterDateBack:function(data,event){},onClickChild:function(value){},openChild:function(obj){this.$router.push(obj.curentItem.path)},companyListSelected:function(label,id){},loadMenuList:function(){var self=this;self.positionsheaders=self.positionsheader||"pull-right",self.activeMenuList=[],self.moreMenuList=[];var accessibleMenu=this.menu.filter((function(m){return"undefined"===typeof m.permission||self.$hasPermission(m.permission)?m:void 0}));for(var idx in accessibleMenu)parseInt(idx)<(this.maxVisibleMenu||4)?this.activeMenuList.push(accessibleMenu[idx]):this.moreMenuList.push(accessibleMenu[idx]);this.setFirstMenu()},openSubTab:function(item,index,keepQuery){if(item&&item.disable&&item.childrens.length){var data=[];if(data=item.childrens.filter((function(rt){return rt.label!==item.label})),data.length){this.moreMenuList.splice(index,1);var lastMenu=this.activeMenuList.pop();this.moreMenuList.splice(0,0,lastMenu),this.activeMenuList.push(item),this.$router.push({path:data[0].path.path}),this.isMoreMenuActive&&this.$refs.shpopover.close()}}else{this.moreMenuList.splice(index,1);var _lastMenu=this.activeMenuList.pop();this.moreMenuList.splice(0,0,_lastMenu),this.activeMenuList.push(item),keepQuery?this.$router.replace({path:item.path.path,query:this.$route.query}):this.$router.push(item.path),this.isMoreMenuActive&&this.$refs.shpopover.close()}},setFirstMenu:function(){var _this3=this;if(this.parent&&(this.$route.path===this.parent||this.$route.path+"/"===this.parent)&&this.activeMenuList.length){var primaryView=this.activeMenuList.find((function(menu){return menu.primary}));primaryView||(primaryView=this.activeMenuList[0]),this.$router.replace({path:primaryView.path.path,query:this.$route.query,params:primaryView.path.params})}else this.checkAndSetMoreList(this.currentView);if(![].concat((0,toConsumableArray/* default */.Z)(this.activeMenuList),(0,toConsumableArray/* default */.Z)(this.moreMenuList)).find((function(menu){return menu.path.path===_this3.$route.path}))){var portfolio=[].concat((0,toConsumableArray/* default */.Z)(this.activeMenuList),(0,toConsumableArray/* default */.Z)(this.moreMenuList)).find((function(menu){return menu.path.path.endsWith("portfolio")}));if(portfolio&&null!==portfolio&&void 0!==portfolio&&portfolio.childrens){var currentBuilding=portfolio.childrens.find((function(menu){return menu.path.path===_this3.$route.path}));currentBuilding&&(currentBuilding.childrens=portfolio.childrens,this.activeMenuList.find((function(menu){return menu.path.path.endsWith("portfolio")}))?this.activeMenuList=this.activeMenuList.map((function(ele){return ele.path.path===portfolio.path.path?currentBuilding:ele})):this.moreMenuList=this.moreMenuList.map((function(ele){return ele.path.path===portfolio.path.path?currentBuilding:ele})))}else this.menu.length&&"/app/em/newdashboard"===this.$route.path&&(this.menu[0].disable&&this.menu[0].childrens&&this.menu[0].childrens.length>1&&this.menu[0].childrens[0].disable?this.$router.push(this.menu[0].childrens[1].path.path):this.$router.push(this.menu[0].path.path))}},moreMenuOpened:function(){this.isMoreMenuActive=!0},moreMenuClosed:function(){this.isMoreMenuActive=!1},checkAndSetMoreList:function(newView){if(newView){var index,menu=this.moreMenuList.find((function(menu,idx){if(menu.name===newView)return index=idx,!0}));menu&&this.openSubTab(menu,index,!0)}},rearrange:function(){this.$refs.shpopover.close(),this.$emit("rearrange")}}},components_Subheadervue_type_script_lang_js=Subheadervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_Subheadervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,Subheader=component.exports},
/***/202970:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return Layout}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/controls/ControlLogic/Layout.vue?vue&type=template&id=5ebeefc2
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"layout container"},[_c("subheader",{attrs:{menu:_vm.subheaderMenu,newbtn:"false",type:"workorder",parent:"/app/co/controls"}},[_c("div",{staticClass:"row"},[_c("div",{staticClass:"col-12"},[_c("div",{staticClass:"fR fc-subheader-right"},[_c("portal-target",{attrs:{name:"controllogicpagenation"}}),_c("div",{staticClass:"block"})],1)])]),_c("button",{staticClass:"fc-create-btn mR60 control-logic-list-btn",on:{click:function($event){return _vm.addControlRule()}}},[_vm._v(" NEW CONTROL LOGIC ")])]),_c("router-view",{ref:"controllist",on:{syncCount:_vm.callbackMethod}}),_vm.controlLogicVisible?_c("new-logic",{attrs:{controlLogic:_vm.selectedControlLogic,isNew:_vm.isNew,visibility:_vm.controlLogicVisible},on:{"update:visibility":function($event){_vm.controlLogicVisible=$event}}}):_vm._e()],1)},staticRenderFns=[],Subheader=__webpack_require__(785869),NewControlLogicForm=__webpack_require__(706891),Layoutvue_type_script_lang_js={data:function(){return{subheaderMenu:[{label:"All Control Logic",path:{path:"/app/co/cl/controllogic"}}],controlLogicVisible:!1,selectedControlLogic:null}},watch:{},components:{Subheader:Subheader/* default */.Z,NewLogic:NewControlLogicForm/* default */.Z},mounted:function(){this.$store.dispatch("view/loadModuleMeta","workflowrule")},methods:{addControlRule:function(controlData){
// this.$refs.controllist.addControllogic()
this.controlLogicVisible=!0,this.isNew=!0,this.selectedControlLogic=controlData}}},ControlLogic_Layoutvue_type_script_lang_js=Layoutvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(ControlLogic_Layoutvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,Layout=component.exports},
/***/706891:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return NewControlLogicForm}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/controls/ControlLogic/NewControlLogicForm.vue?vue&type=template&id=199056ba
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{attrs:{visible:_vm.visibility,width:"50%","before-close":_vm.closeDialog,"append-to-body":!0,"custom-class":"fc-dialog-form fc-dialog-right setup-dialog50 setup-dialog"},on:{"update:visible":function($event){_vm.visibility=$event}}},[_c("el-form",{ref:"logicrule",attrs:{model:_vm.controlpoints,"label-position":"top"}},[_c("div",{staticClass:"new-header-container"},[_c("div",{staticClass:"new-header-text"},[_c("div",{staticClass:"fc-setup-modal-title"},[_vm._v(" "+_vm._s(_vm.isNew?"New Control Logic":"Edit Control Logic")+" ")])])]),_c("div",{staticClass:"new-body-modal"},[_c("el-form-item",{attrs:{label:"Name"}},[_c("el-input",{staticClass:"fc-input-full-border2",attrs:{autofocus:"",placeholder:"Control Logic Name"},model:{value:_vm.controlpoints.name,callback:function($$v){_vm.$set(_vm.controlpoints,"name",$$v)},expression:"controlpoints.name"}})],1),_c("el-form-item",{attrs:{label:"Execute Based On"}},[_c("el-radio-group",{attrs:{disabled:_vm.disableRadioGroup},on:{change:function($event){return _vm.changeOptions()}},model:{value:_vm.executed,callback:function($$v){_vm.executed=$$v},expression:"executed"}},[_c("el-radio",{staticClass:"fc-radio-btn",attrs:{label:35}},[_vm._v(" Alarms")]),_c("el-radio",{staticClass:"fc-radio-btn",attrs:{label:36}},[_vm._v(" Schedule")]),this.$helpers.isLicenseEnabled("RESOURCE_BOOKING")?_c("el-radio",{staticClass:"fc-radio-btn",attrs:{label:34}},[_vm._v(" Reservation")]):_vm._e()],1)],1),_c("div",{directives:[{name:"show",rawName:"v-show",value:35===_vm.executed,expression:"executed === 35"}]},[_c("el-row",{attrs:{gutter:20}},[_c("el-col",{attrs:{span:12}},[_c("el-form-item",{attrs:{label:"Asset Category"}},[_c("el-select",{staticClass:"width100",attrs:{placeholder:"Select Asset category"},on:{change:_vm.fetchRules},model:{value:_vm.assetcategoryId,callback:function($$v){_vm.assetcategoryId=$$v},expression:"assetcategoryId"}},_vm._l(_vm.assetCategory,(function(category,index){return _c("el-option",{key:index,attrs:{label:category.displayName,value:parseInt(category.id)}})})),1)],1)],1),_c("el-col",{attrs:{span:12}},[_c("el-form-item",{attrs:{label:"Rule"}},[_c("el-select",{staticClass:"width100 fc-input-full-border2",attrs:{filterable:"","loading-text":"Loading...",loading:_vm.ruleLoading},on:{change:_vm.rcaRulesDataload},model:{value:_vm.actionTyperule,callback:function($$v){_vm.actionTyperule=$$v},expression:"actionTyperule"}},_vm._l(_vm.rules,(function(rule,index){return _c("el-option",{key:index,attrs:{label:rule.name,value:rule.id}})})),1)],1)],1)],1),_c("el-row",{attrs:{gutter:20}},[_c("el-col",{attrs:{span:12}},[_c("el-form-item",{attrs:{label:"Asset"}},[_c("el-select",{staticClass:"width100 fc-input-full-border2",attrs:{filterable:""},model:{value:_vm.ruleMatchedResources,callback:function($$v){_vm.ruleMatchedResources=$$v},expression:"ruleMatchedResources"}},_vm._l(_vm.matchedResources,(function(resource,index){return _c("el-option",{key:index,attrs:{label:resource.name,value:resource.id}})})),1)],1)],1),_c("el-col",{attrs:{span:12}},[_c("el-form-item",{attrs:{label:"Rca Rule"}},[_c("el-select",{staticClass:"width100 fc-input-full-border2",attrs:{filterable:"","no-data-text":"No Rca Rule available"},model:{value:_vm.actionRcaRule,callback:function($$v){_vm.actionRcaRule=$$v},expression:"actionRcaRule"}},_vm._l(_vm.rcarules,(function(rcarule,index){return _c("el-option",{key:index,attrs:{label:rcarule.name,value:rcarule.id}})})),1)],1)],1)],1)],1),_c("div",{directives:[{name:"show",rawName:"v-show",value:36===_vm.executed,expression:"executed === 36"}]},[1===_vm.trigger.type?_c("schedule-trigger",{attrs:{trigger:_vm.trigger,hideFields:_vm.hideFields}}):_vm._e()],1),this.$helpers.isLicenseEnabled("RESOURCE_BOOKING")?_c("div",{directives:[{name:"show",rawName:"v-show",value:34===_vm.executed,expression:"executed === 34"}]},[_c("div",{staticClass:"fc-div-bg-border"},[_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v("Name")]),_c("el-select",{staticClass:"width100",attrs:{filterable:"",disabled:_vm.reservationData.disabled,placeholder:"Select"},model:{value:_vm.reservationData.id,callback:function($$v){_vm.$set(_vm.reservationData,"id",$$v)},expression:"reservationData.id"}},_vm._l(_vm.reservationName,(function(reserv,index){return _c("el-option",{key:index,attrs:{label:reserv.name,value:reserv.id}})})),1)],1)],1),_c("el-row",{staticClass:"mT20"},[_c("el-col",{attrs:{span:12}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v("Date Field")]),_c("el-select",{staticClass:"width300px",attrs:{placeholder:"Select",filterable:""},model:{value:_vm.dateFieldId,callback:function($$v){_vm.dateFieldId=$$v},expression:"dateFieldId"}},_vm._l(_vm.dateFields,(function(fld,index){return _c("el-option",{key:index,attrs:{label:fld.displayName,value:fld.id}})})),1)],1),_c("el-col",{staticClass:"pL40",attrs:{span:12}},[_c("p",{staticClass:"fc-input-label-txt mB10"},[_vm._v(" "+_vm._s(_vm.$t("setup.setupLabel.scheduled_type"))+" ")]),_c("el-radio-group",{model:{value:_vm.scheduleType,callback:function($$v){_vm.scheduleType=$$v},expression:"scheduleType"}},[_c("el-radio",{key:2,staticClass:"fc-radio-btn",attrs:{label:2,value:!0}},[_vm._v("On")]),_c("el-radio",{key:3,staticClass:"fc-radio-btn",attrs:{label:3,value:!1}},[_vm._v("After")]),_c("el-radio",{key:1,staticClass:"fc-radio-btn",attrs:{label:1,value:!1}},[_vm._v("Before")])],1)],1)],1),[1,3].includes(parseInt(_vm.scheduleType))?_c("el-row",{staticClass:"mT30",attrs:{gutter:20}},[_c("el-col",{attrs:{span:12}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v("Hours")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{clearable:"",filterable:""},model:{value:_vm.dateObject.hours,callback:function($$v){_vm.$set(_vm.dateObject,"hours",$$v)},expression:"dateObject.hours"}},_vm._l(_vm.$constants.HOURS,(function(index){return _c("el-option",{key:index+1,attrs:{label:index,value:index}})})),1)],1),_c("el-col",{attrs:{span:12}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v("Mins")]),_c("el-select",{staticClass:"fc-input-full-border-select2",attrs:{filterable:"",placeholder:"Select"},model:{value:_vm.dateObject.minute,callback:function($$v){_vm.$set(_vm.dateObject,"minute",$$v)},expression:"dateObject.minute"}},_vm._l(_vm.$constants.MINUTES,(function(index){return _c("el-option",{key:index+1,attrs:{label:index,value:index}})})),1)],1)],1):_vm._e()],1)]):_vm._e(),_c("div",{staticClass:"fc-text-pink text-uppercase mT20"},[_vm._v("Command Action")]),_c("el-collapse",{staticClass:"new-rule-collapse position-relative controllogic-collapse",attrs:{accordion:!0},model:{value:_vm.activeNames,callback:function($$v){_vm.activeNames=$$v},expression:"activeNames"}},_vm._l(_vm.controlaction,(function(action,cindex){return _c("el-collapse-item",{key:cindex,staticClass:"rule-border-blue mT20 position-relative",staticStyle:{"border-left":"1px solid rgb(228, 235, 241)"},attrs:{name:action.name}},[_c("template",{slot:"title"},[_vm._v(" "+_vm._s(action.name)+" ")]),_c("div",{},[_c("el-radio-group",{on:{change:_vm.changecondition},model:{value:action.templateJson.actionType,callback:function($$v){_vm.$set(action.templateJson,"actionType",$$v)},expression:"action.templateJson.actionType"}},[_c("el-radio",{staticClass:"fc-radio-btn",attrs:{label:1}},[_vm._v("Point")]),_c("el-radio",{staticClass:"fc-radio-btn",attrs:{label:2}},[_vm._v("Group")])],1)],1),_c("div",{directives:[{name:"show",rawName:"v-show",value:1===action.templateJson.actionType||-1===action.templateJson.actionType,expression:"\n              action.templateJson.actionType === 1 ||\n                action.templateJson.actionType === -1\n            "}],staticClass:"pT20"},[_c("el-row",[_c("el-col",{attrs:{span:4}},[_c("div",{staticClass:"label-txt-black"},[_vm._v("Asset")])]),_c("el-col",{attrs:{span:15}},[_c("el-form-item",[_c("el-select",{staticClass:"fc-input-full-border2 width100",attrs:{placeholder:"Select asset"},on:{change:_vm.fetchFields},model:{value:action.templateJson.resource,callback:function($$v){_vm.$set(action.templateJson,"resource",$$v)},expression:"action.templateJson.resource"}},_vm._l(_vm.assets,(function(asset,index){return _c("el-option",{key:index,attrs:{label:asset.name,value:asset.id}})})),1)],1)],1)],1),_c("el-row",{},[_c("el-col",{attrs:{span:4}},[_c("div",{staticClass:"label-txt-black"},[_vm._v("Field")])]),_c("el-col",{attrs:{span:15}},[_c("el-form-item",[_c("el-select",{staticClass:"fc-input-full-border2 width100",attrs:{placeholder:"Select fields"},model:{value:action.templateJson.metric,callback:function($$v){_vm.$set(action.templateJson,"metric",$$v)},expression:"action.templateJson.metric"}},_vm._l(_vm.assetFields[action.templateJson.resource],(function(field,index){return _c("el-option",{key:index,attrs:{label:field.displayName,value:field.id}})})),1)],1)],1)],1),_c("el-row",{},[_c("el-col",{attrs:{span:4}},[_c("div",{staticClass:"label-txt-black"},[_vm._v("Value")])]),_c("el-col",{attrs:{span:15}},[_c("el-form-item",[_c("el-input",{staticClass:"fc-input-full-border2",attrs:{autofocus:"",placeholder:"Enter the value",type:"number"},model:{value:action.templateJson.val,callback:function($$v){_vm.$set(action.templateJson,"val",$$v)},expression:"action.templateJson.val"}})],1)],1)],1),_c("img",{staticClass:"delete-icon pointer",staticStyle:{height:"18px",width:"18px","margin-right":"3px"},attrs:{src:__webpack_require__(385769)},on:{click:function($event){return _vm.deleteaction(cindex)}}})],1),_c("div",{directives:[{name:"show",rawName:"v-show",value:2===action.templateJson.actionType,expression:"action.templateJson.actionType === 2"}],staticClass:"pT20"},[_c("el-row",{},[_c("el-col",{attrs:{span:4}},[_c("div",{staticClass:"label-txt-black"},[_vm._v("Actions Group")])]),_c("el-col",{attrs:{span:15}},[_c("el-form-item",[_c("el-select",{staticClass:"width100 fc-input-full-border2",attrs:{filterable:""},model:{value:action.templateJson.controlActionGroupId,callback:function($$v){_vm.$set(action.templateJson,"controlActionGroupId",$$v)},expression:"action.templateJson.controlActionGroupId"}},_vm._l(_vm.rcagrouplist,(function(grouprule,index){return _c("el-option",{key:index,attrs:{label:grouprule.name,value:grouprule.id}})})),1)],1)],1)],1),_c("el-row",{},[_c("el-col",{attrs:{span:4}},[_c("div",{staticClass:"label-txt-black"},[_vm._v("Value")])]),_c("el-col",{attrs:{span:15}},[_c("el-form-item",[_c("el-input",{staticClass:"fc-input-full-border2",attrs:{autofocus:"",placeholder:"Enter the value",type:"number"},model:{value:action.templateJson.val,callback:function($$v){_vm.$set(action.templateJson,"val",$$v)},expression:"action.templateJson.val"}})],1)],1)],1),_c("img",{staticClass:"delete-icon pointer",staticStyle:{height:"18px",width:"18px","margin-right":"3px"},attrs:{src:__webpack_require__(385769)},on:{click:function($event){return _vm.deleteaction(cindex)}}})],1)],2)})),1),_c("el-button",{staticClass:"fc-btn-green-medium-fill mT20",attrs:{type:"primary"},on:{click:_vm.addaction}},[_vm._v("Add Command")])],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){return _vm.closeDialog()}}},[_vm._v("CANCEL")]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.saving},on:{click:function($event){return _vm.submitForm()}}},[_vm._v(" "+_vm._s(_vm.saving?"Submitting...":"SAVE"))])],1)])],1)},staticRenderFns=[],toConsumableArray=__webpack_require__(488478),esm_typeof=__webpack_require__(103336),objectSpread2=__webpack_require__(595082),TriggerTypeSchedule=(__webpack_require__(169358),__webpack_require__(162506),__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(450886),__webpack_require__(434284),__webpack_require__(947522),__webpack_require__(670560),__webpack_require__(634338),__webpack_require__(538077),__webpack_require__(648324),__webpack_require__(121472)),vuex_esm=__webpack_require__(420629),PMMixin=__webpack_require__(369087),utility_methods=__webpack_require__(773258),NewControlLogicFormvue_type_script_lang_js={props:["visibility","controlLogic","ruleId","isNew","reservationEditObj"],data:function(){return{hideFields:{skipEvery:!0},
// Reservations
dateFields:[],scheduleType:null,interval:null,dateObject:{days:null,minute:0,hours:0,minu:null},ruleLoading:!1,assetcategoryId:null,dateFieldId:"",time:null,executed:35,id:"",rulefield:{},isEdit:!1,controllogicsingleruleload:[],isFormulaField:!1,controlObj:{},ruleMatchedResources:"",actionRcaRule:"",actionGroupRule:"",assets:[],rules:[],rcarules:[],rcagrouplist:[],actionTyperule:"",reservationName:[],reservationData:{id:"",disabled:!1},assetFields:{},logicaction:{},showControlAction:!0,controlaction:[],activeNames:["actionName0"],isNewControl:!1,controllogicformload:[],resourceQuery:null,isIncludeResource:!1,chooserVisibility:!1,chooserVisibilityAction:!1,resourceType:"asset",saving:!1,loading:!0,updatelogiclist:[],selectedResourceList:[],actionIndex:0,selectedResource:{name:""},formula:{name:"",workflow:null,includedResources:[],frequency:null},trigger:{name:name,type:1,startDate:new Date,startTime:(new Date).getTime(),showSkip:!1,basedOn:"Date",schedule:{times:["00:00"],frequency:1,skipEvery:-1,showSkip:!1,values:[],frequencyType:1,weekFrequency:-1,yearlyDayValue:null,monthValue:-1,yearlyDayOfWeekValues:[]},stopAfter:"never",endTime:new Date,startReading:null,readingFieldId:null,stopAfterReading:"never",endReading:null,readingInterval:null,assignedTo:null,reminders:[],criteria:null},frequencyTypes:[{label:"Do not repeat",value:0}],controlpoints:{name:"",actionTyperule:""},disableRadioGroup:!1,rcaRuleSelectShow:!1}},components:{ScheduleTrigger:TriggerTypeSchedule/* default */.Z},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({isAsset:function(){return"asset"===this.resourceType},isMultiResource:function(){return this.isAsset&&(!this.rule||!Object.keys(this.rule).length||this.rule.assetCategoryId>0)},triggerTypes:function(){var types=[{label:"Schedule",value:1}];return types.splice(1,2),types}},(0,vuex_esm/* mapState */.rn)({assetCategory:function(state){return state.assetCategory}})),{},{selectedRule:function(){var _this=this;return this.actionTyperule?this.rules.find((function(rule){return _this.actionTyperule===rule.id})):null},matchedResources:function(){return this.selectedRule?this.selectedRule.matchedResources:[]},resourceData:function(){return{assetCategory:this.controlpoints.assetCategoryId,isIncludeResource:this.isIncludeResource,selectedResources:Array.isArray(this.selectedResourceList)?this.selectedResourceList.map((function(resource){return{id:resource&&"object"===(0,esm_typeof/* default */.Z)(resource)?resource.id:resource}})):this.selectedResourceList.id}}//   isDateTimeField () {
//   let isDatetime = false
//   this.dateFields.filter(d => {
//     if(d.fieldId === this.dateFieldId){
//       return isDatetime = d.dataTypeEnum._name === 'DATE_TIME'
//     }
//   })
// return isDatetime
// }
}),mounted:function(){this.addaction(),this.getfetchrule(),this.setReservationForOptions(),this.setOptionsForAssets(),this.init(),this.fetchReservationFields(),this.fieldrules(),this.loadrulegroup(),this.reservationEditObj&&this.constructForReservation(),this.controlpoints.interval&&(this.dateObject=this.$helpers.secTodaysHoursMinu(this.interval)),this.$forceUpdate()},watch:{trigger:function(){},isNew:function(){this.init()}},methods:{init:function(){this.isNew?this.controlpoints={name:"",actionTyperule:""}:this.controlpoints=this.controlLogic},closeDialog:function(){this.$emit("update:visibility",!1)},addControllogic:function(){this.controlObj=this.$helpers.cloneObject(this.controlmodel),this.isNewControl=!0,this.visibility=!0},changeOptions:function(){this.$forceUpdate()},changecondition:function(){this.$forceUpdate()},submitForm:function(){var url,_this2=this,self=this;self.saving=!0,self.controlpoints.resourceId||(self.controlpoints.resourceId=-1);var payload=null,context={actions:this.controlaction,name:this.controlpoints.name,id:this.controlpoints.id,resourceId:this.ruleMatchedResources,event:{moduleName:"alarm"}};36===this.executed?(payload={workflowRuleContext:context},payload.workflowRuleContext.schedule=this._data.trigger.schedule,payload.workflowRuleContext.event.activityType=2097152):35===this.executed?(payload={readingAlarmRuleContext:context},this.selectedRule&&(payload.readingAlarmRuleContext.readingRuleGroupId=this.selectedRule.ruleGroupId),payload.readingAlarmRuleContext.event.activityType=3,payload.readingAlarmRuleContext.rcaRuleId=this.actionRcaRule||-1):34===this.executed&&(payload={recordRule:context},delete payload.recordRule.resourceId,payload.recordRule.event.activityType=524288,payload.recordRule.event.moduleName="reservation",payload.recordRule.scheduleType=this.scheduleType,payload.recordRule.parentId=this.reservationData.id,payload.recordRule.dateFieldId=this.dateFieldId,payload.recordRule.ruleType=34,payload.recordRule.interval=60*(60*this.dateObject.hours+this.dateObject.min)),this.controlpoints.id?(url="/v2/controlAction/updateControlActionRule",34===this.executed&&(url="/v2/recordrule/addOrUpdate"),self.$http.post(url,payload).then((function(response){0===response.data.responseCode?(_this2.controlpoints=response.data.result.readingAlarmRuleContext,_this2.controlpoints={name:""},self.$message.success("ControlLogic Edit Successfully"),self.$emit("update:visibility",!1),self.$emit("saved")):self.$message.error(response.data.message)})).catch((function(error){self.$message.error("Unable to Edit")}))):(url="/v2/controlAction/addControlActionRule",34===this.executed&&(url="/v2/recordrule/addOrUpdate"),self.$http.post(url,payload).then((function(response){0===response.data.responseCode?(_this2.controlpoints=response.data.result.readingAlarmRuleContext,_this2.controlpoints={name:""},self.$message.success("ControlLogic Added Successfully"),self.$emit("update:visibility",!1),self.$emit("saved")):self.$message.error(response.data.message),self.saving=!1})).catch((function(error){self.saving=!1,self.$message.error("Unable to Edit")})))},getfetchrule:function(){var _this3=this;if(this.controlLogic){var self=this;self.loading=!0;var url="/v2/controlAction/getControlActionRule?ruleId="+this.controlLogic.id;this.$http.get(url).then((function(response){_this3.controlLogicEdit=response.data.result.workflowRule||null,_this3.setData(response.data.result.workflowRule),self.loading=!1}))}},setData:function(workflowRule){this.executed=workflowRule.moduleName,this.executed=workflowRule.ruleType,this.controlpoints.name=workflowRule.name,this.controlpoints.id=workflowRule.id,this.controlaction=this.decoeactions(workflowRule.actions),this.ruleMatchedResources=workflowRule.resourceId,"35"===this.executed?
// this.assetcategoryId =
this.ruleMatchedResources=workflowRule.resourceId:"34"===this.executed?(this.reservationData.id=workflowRule.parentId,this.reservationData.disabled=!0,this.dateFieldId=workflowRule.dateFieldId,this.scheduleType=workflowRule.scheduleType,this.interval=workflowRule.interval,this.dateObject=this.$helpers.secTodaysHoursMinu(this.interval)):"36"===this.executed&&(this.trigger=workflowRule,this.executed=workflowRule.ruleType),this.ruleMatchedResources=workflowRule.resourceId,this._data.trigger.schedule=workflowRule.schedule},decoeactions:function(actions){var _this4=this;return actions.forEach((function(rt,index){rt.templateJson||(_this4.$set(rt,"templateJson",rt.template),_this4.$set(rt,"name","Command Action ".concat(index+1)))})),actions},rcaRulesDataload:function(ruleId){var _this5=this,self=this;self.loading=!0,this.rcarules=[];var url="/v2/alarm/rules/fetchRule?ruleId=".concat(ruleId);this.$http.get(url).then((function(response){200===response.status&&(response.data.result.alarmRule&&response.data.result.alarmRule.alarmRCARules&&(_this5.rcarules=response.data.result.alarmRule.alarmRCARules),self.loading=!1)}))},showActionAssetChooser:function(index){this.actionIndex=index,this.chooserVisibilityAction=!0},addaction:function(){this.controlaction.push({actionType:18,templateJson:{val:"",resource:null,metric:null,actionType:1,controlActionGroupId:null},name:"Command Action"+(this.controlaction.length+1)})},deleteaction:function(key){this.controlaction.splice(key,1)},onTriggerTypeChange:function(val){this.trigger.schedule=1!=val?null:(0,utility_methods/* deepCloneObject */.kh)(PMMixin/* default */.Z.INITIAL_SCHEDULE)},setOptionsForAssets:function(){var self=this;self.loading=!0;var url="/v2/controlAction/getControllableAssets";this.$http.get(url).then((function(response){200===response.status&&(response.data.result.controllableResources&&(self.assets=[{id:-1,name:"Current Asset"}].concat((0,toConsumableArray/* default */.Z)(response.data.result.controllableResources))),
// this.addaction()
self.loading=!1)}))},fetchFields:function(resourceId){if(!this.assetFields[resourceId]){var self=this;self.loading=!0;var url="/v2/controlAction/getControllableFields?resourceId="+resourceId;this.$http.get(url).then((function(response){200===response.status&&(response.data.result.controllableFields&&self.$set(self.assetFields,resourceId,response.data.result.controllableFields),self.loading=!1)}))}},fieldrules:function(){var self=this;self.loading=!0;var url="/v2/rules/all";this.$http.get(url).then((function(response){200===response.status&&(response.data.result.rules&&(self.rules=response.data.result.rules),self.loading=!1)}))},loadrulegroup:function(){var self=this;self.loading=!0;var url="/v2/controlAction/getControlGroups";this.$http.get(url).then((function(response){200===response.status&&(response.data.result.controlActionGroups&&(self.rcagrouplist=response.data.result.controlActionGroups),self.loading=!1)}))},setReservationForOptions:function(){var self=this;self.loading=!0;var url="/v2/reservations/view/all?parentId";this.$http.get(url).then((function(response){0===response.data.responseCode&&(response.data.result.reservations&&(self.reservationName=response.data.result.reservations),self.loading=!1)}))},fetchReservationFields:function(){var _this6=this;this.$http.get("/module/meta?moduleName=reservation").then((function(response){var tempFields;response.data.meta&&(tempFields=response.data.meta.fields,_this6.dateFields=tempFields.filter((function(d){return"DATE_TIME"===d.dataTypeEnum._name})))}))},constructForReservation:function(){this.reservationEditObj&&(this.executed=34,this.reservationData.id=this.reservationEditObj.id,this.reservationData.disabled=!0,this.disableRadioGroup=!0,this.controlpoints.name=this.reservationEditObj.name+"_Control")},fetchRules:function(assetcategoryId){var _this7=this;this.rules=[];var queryparams={assetCategoryId:{operatorId:36,value:[assetcategoryId+""]}};this.ruleLoading=!0;var url="/v2/rules/all?filters=".concat(encodeURIComponent(JSON.stringify(queryparams)),"&includeParentFilter=true");this.$http.get(url).then((function(response){0===response.data.responseCode&&(_this7.rules=response.data.result.rules,_this7.ruleLoading=!1)})).catch((function(){_this7.ruleLoading=!1}))}}},ControlLogic_NewControlLogicFormvue_type_script_lang_js=NewControlLogicFormvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(ControlLogic_NewControlLogicFormvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,NewControlLogicForm=component.exports},
/***/385769:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"4a9843791f38c4a28fdf9f0a4584780d.svg";
/***/}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/8765.js.map