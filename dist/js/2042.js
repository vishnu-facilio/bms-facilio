(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[2042],{
/***/2042:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return TriggersList}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/setup/trigger/TriggersList.vue?vue&type=template&id=223f1ccb
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"triggers-list"},[_c("div",{staticClass:"trigger-header"},[_c("div",[_c("div",{staticClass:"trigger-name"},[_vm._v(_vm._s(_vm.$t("common.wo_report.triggers")))]),_c("div",{staticClass:"trigger-desc"},[_vm._v(" "+_vm._s(_vm.$t("common._common.list_of_all"))+" "+_vm._s(_vm.moduleDisplayName||_vm.moduleName)+" "+_vm._s(_vm.$t("common.wo_report.triggers"))+" ")])]),_c("el-button",{staticClass:"setup-el-btn",attrs:{type:"primary"},on:{click:_vm.addTrigger}},[_vm._v(" "+_vm._s(_vm.$t("common.header.add_trigger"))+" ")])],1),_c("portal-target",{staticClass:"mB30",attrs:{name:"automation-modules"}}),_vm.loading?_c("spinner",{attrs:{show:_vm.loading,size:"80"}}):_c("el-table",{staticStyle:{width:"100%"},attrs:{data:_vm.triggersList,"cell-style":{padding:"12px 30px"},"empty-text":"No triggers available.",height:"calc(100vh - 200px)"}},[_c("el-table-column",{attrs:{label:_vm.$t("common._common.name"),prop:"name"}}),_c("el-table-column",{attrs:{label:_vm.$t("common.header.event_type"),width:"300px"},scopedSlots:_vm._u([{key:"default",fn:function(trigger){return[_vm._v(" "+_vm._s(_vm.eventTypes[trigger.row.eventType])+" ")]}}])}),_c("el-table-column",{attrs:{label:_vm.$t("common.products.status"),width:"150px"},scopedSlots:_vm._u([{key:"default",fn:function(trigger){return[_c("el-switch",{attrs:{disabled:trigger.row.isDefault,"active-color":"rgba(57, 178, 194, 0.8)","inactive-color":"#e5e5e5"},on:{change:function($event){return _vm.changeStatus(trigger.row)}},model:{value:trigger.row.status,callback:function($$v){_vm.$set(trigger.row,"status",$$v)},expression:"trigger.row.status"}})]}}])}),_c("el-table-column",{staticClass:"visibility-visible-actions",attrs:{width:"200px"},scopedSlots:_vm._u([{key:"default",fn:function(trigger){return[_c("div",{staticClass:"text-center flex-middle"},[_c("div",{staticClass:"visibility-hide-actions pR15 actions-txt",on:{click:function($event){return _vm.openSummary(trigger.row)}}},[_vm._v(" "+_vm._s(_vm.$t("common.products.actions"))+" ")]),trigger.row.isDefault?_vm._e():[_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-edit edit-icon visibility-hide-actions pR15",attrs:{"data-arrow":"true",title:_vm.$t("common.wo_report.edit_trigger")},on:{click:function($event){return _vm.editTrigger(trigger.row)}}}),_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-delete fc-delete-icon visibility-hide-actions",attrs:{"data-arrow":"true",title:_vm.$t("common._common.delete_trigger")},on:{click:function($event){return _vm.deleteTrigger(trigger.row)}}})]],2)]}}])})],1),_vm.showAddTrigger?_c("TriggersForm",{attrs:{trigger:_vm.selectedTrigger,isNew:_vm.isNew,moduleName:_vm.moduleName},on:{onSave:_vm.loadTriggers,onClose:function($event){_vm.showAddTrigger=!1}}}):_vm._e(),_vm.showSummary?_c("TriggerActions",{attrs:{trigger:_vm.selectedTrigger},on:{onClose:function($event){_vm.showSummary=!1}}}):_vm._e()],1)},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),TriggersFormvue_type_template_id_8671e1c2_render=(__webpack_require__(339772),__webpack_require__(162506),function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"fc-dialog-center-container",attrs:{title:_vm.isNew?_vm.$t("common.wo_report.create_trigger"):_vm.$t("common.wo_report.edit_trigger"),visible:!0,width:"30%","append-to-body":!0,"before-close":_vm.closeDialog}},[_c("div",{staticClass:"height200"},[_c("el-form",{ref:"triggerForm",attrs:{rules:_vm.rules,model:_vm.triggerData}},[_c("el-form-item",{attrs:{label:"Name",prop:"name",required:!0}},[_c("el-input",{staticClass:"width100 fc-input-full-border2",attrs:{autofocus:"",type:"text",placeholder:_vm.$t("common._common.enter_trigger_name")},model:{value:_vm.triggerData.name,callback:function($$v){_vm.$set(_vm.triggerData,"name",$$v)},expression:"triggerData.name"}})],1)],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.closeDialog}},[_vm._v(" "+_vm._s(_vm.$t("setup.users_management.cancel"))+" ")]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.saving},on:{click:function($event){return _vm.saveTrigger()}}},[_vm._v(" "+_vm._s(_vm.$t("panel.dashboard.confirm"))+" ")])],1)],1)])}),TriggersFormvue_type_template_id_8671e1c2_staticRenderFns=[],TriggerModel=__webpack_require__(362218),cloneDeep=__webpack_require__(150361),cloneDeep_default=__webpack_require__.n(cloneDeep),TriggersFormvue_type_script_lang_js={props:["trigger","isNew","moduleName"],data:function(){return{saving:!1,triggerData:{},rules:{name:{required:!0,message:this.$t("common._common.please_enter_a_name"),trigger:"change"}}}},created:function(){if(this.isNew){var moduleName=this.moduleName;this.triggerData=new TriggerModel/* Trigger */.x({moduleName:moduleName})}else this.triggerData=cloneDeep_default()(this.trigger)},methods:{closeDialog:function(){this.$emit("onClose")},saveTrigger:function(){var _this=this;this.$refs["triggerForm"].validate(function(){var _ref=(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(valid){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(valid){_context.next=2;break}return _context.abrupt("return",!1);case 2:return _this.saving=!0,_context.prev=3,_context.next=6,_this.triggerData.save();case 6:_this.$message.success(_this.$t("common._common.trigger_saved_successfully")),_this.$emit("onSave"),_this.closeDialog(),_context.next=14;break;case 11:_context.prev=11,_context.t0=_context["catch"](3),_this.$message.error(_context.t0);case 14:_this.saving=!1;case 15:case"end":return _context.stop()}}),_callee,null,[[3,11]])})));return function(_x){return _ref.apply(this,arguments)}}())}}},trigger_TriggersFormvue_type_script_lang_js=TriggersFormvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(trigger_TriggersFormvue_type_script_lang_js,TriggersFormvue_type_template_id_8671e1c2_render,TriggersFormvue_type_template_id_8671e1c2_staticRenderFns,!1,null,null,null)
/* harmony default export */,TriggersForm=component.exports,TriggerActionsvue_type_template_id_66032236_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"fieldchange-Dialog pB15 fc-dialog-center-container trigger-summary",attrs:{visible:!0,width:"50%",title:_vm.trigger.name+" Actions","custom-class":"dialog-header-padding","append-to-body":!0,"before-close":_vm.closeDialog}},[_c("div",{staticClass:"height350 pB50"},[_c("div",{staticClass:"trigger-descrip"},[_vm._v(" List of rules to which this trigger is associated. ")]),_c("div",{staticClass:"height250"},[_vm.$validation.isEmpty(_vm.triggerActions)?_c("div",{staticClass:"d-flex height-100"},[_c("div",{staticClass:"empty-state"},[_c("inline-svg",{staticClass:"margin-auto",attrs:{src:"svgs/emptystate/readings-empty",iconClass:"icon text-center icon-60"}}),_c("div",{staticClass:"margin-auto",staticStyle:{color:"#909399"}},[_vm._v(" No actions available ")])],1)]):_c("draggable",_vm._b({attrs:{list:_vm.triggerActions,handle:".task-handle"}},"draggable",_vm.fieldSectionDragOptions,!1),_vm._l(_vm.triggerActions,(function(action,index){return _c("div",{key:action.id+"_"+index,staticClass:"trigger-actions"},[_c("div",{staticClass:"task-handle mR10"},[_c("img",{attrs:{src:__webpack_require__(271791)}})]),_c("div",{staticClass:"action-details"},[_c("div",{staticClass:"action-name"},[_vm._v(" "+_vm._s(action.name||action.typeRefPrimaryId)+" ")]),_c("div",{staticClass:"action-type"},[_vm._v(" "+_vm._s(_vm.actionTypes[action.actionType])+" ")])])])})),0)],1)]),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){return _vm.closeDialog()}}},[_vm._v(" CANCEL ")]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.saving},on:{click:function($event){return _vm.save()}}},[_vm._v(" Save ")])],1)])},TriggerActionsvue_type_template_id_66032236_staticRenderFns=[],vuedraggable_umd=__webpack_require__(909980),vuedraggable_umd_default=__webpack_require__.n(vuedraggable_umd),sortBy=__webpack_require__(189734),sortBy_default=__webpack_require__.n(sortBy),actionTypes={2:"Rule Execution"},TriggerActionsvue_type_script_lang_js={props:["trigger"],components:{draggable:vuedraggable_umd_default()},data:function(){return{triggerActions:[],saving:!1,fieldSectionDragOptions:{animation:150,easing:"cubic-bezier(1, 0, 0, 1)",group:"tasksection",sort:!0},actionTypes:actionTypes}},created:function(){var triggerActions=this.trigger.triggerActions;this.triggerActions=sortBy_default()(triggerActions||[],["executionOrder"])},methods:{closeDialog:function(){this.$emit("onClose")},save:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _this.saving=!0,_context.prev=1,_context.next=4,_this.trigger.saveActionsOrder(_this.triggerActions);case 4:_this.$message.success("Actions rearranged successfully"),_this.closeDialog(),_context.next=12;break;case 8:_context.prev=8,_context.t0=_context["catch"](1),_this.$message.error(_context.t0),_this.saving=!1;case 12:case"end":return _context.stop()}}),_callee,null,[[1,8]])})))()}}},trigger_TriggerActionsvue_type_script_lang_js=TriggerActionsvue_type_script_lang_js,TriggerActions_component=(0,componentNormalizer/* default */.Z)(trigger_TriggerActionsvue_type_script_lang_js,TriggerActionsvue_type_template_id_66032236_render,TriggerActionsvue_type_template_id_66032236_staticRenderFns,!1,null,null,null)
/* harmony default export */,TriggerActions=TriggerActions_component.exports,validation=__webpack_require__(990260),eventTypes={1:"Create",2:"Edit",4:"Delete",1073741824:"Custom"},TriggersListvue_type_script_lang_js={props:["moduleName","moduleDisplayName"],components:{TriggersForm:TriggersForm,TriggerActions:TriggerActions},data:function(){return{loading:!1,triggersList:[],showAddTrigger:!1,selectedTrigger:null,showSummary:!1,isNew:!1,eventTypes:eventTypes}},created:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:_this.loadTriggers();case 1:case"end":return _context.stop()}}),_callee)})))()},methods:{loadTriggers:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _context2.prev=0,_this2.loading=!0,_context2.next=4,TriggerModel/* Trigger */.x.fetchAll(_this2.moduleName);case 4:_this2.triggersList=_context2.sent,_context2.next=10;break;case 7:_context2.prev=7,_context2.t0=_context2["catch"](0),_this2.$message.error(_context2.t0);case 10:_this2.loading=!1;case 11:case"end":return _context2.stop()}}),_callee2,null,[[0,7]])})))()},addTrigger:function(){this.selectedTrigger=null,this.isNew=!0,this.showAddTrigger=!0},editTrigger:function(trigger){this.selectedTrigger=trigger,this.isNew=!1,this.showAddTrigger=!0},deleteTrigger:function(_ref){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var id,value,idx;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return id=_ref.id,_context3.next=3,_this3.$dialog.confirm({title:_this3.$t("common._common.delete_trigger"),htmlMessage:_this3.$t("common.wo_report.are_you_want_delete_trigger"),rbDanger:!0,rbLabel:_this3.$t("common._common.confirm")});case 3:if(value=_context3.sent,value){_context3.next=6;break}return _context3.abrupt("return");case 6:return _context3.prev=6,_context3.next=9,TriggerModel/* Trigger */.x.delete({id:id});case 9:idx=_this3.triggersList.findIndex((function(t){return t.id===id})),(0,validation/* isEmpty */.xb)(idx)||_this3.triggersList.splice(idx,1),_this3.$message.success("Deleted trigger successfully"),_context3.next=17;break;case 14:_context3.prev=14,_context3.t0=_context3["catch"](6),_this3.$message.error(_context3.t0);case 17:case"end":return _context3.stop()}}),_callee3,null,[[6,14]])})))()},changeStatus:function(trigger){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:return _context4.prev=0,_context4.next=3,trigger.patch();case 3:_this4.$message.success(_this4.$t("common.wo_report.changed_trigger_status")),_context4.next=10;break;case 6:_context4.prev=6,_context4.t0=_context4["catch"](0),_this4.$message.error(_context4.t0),trigger.status=!trigger.status;case 10:case"end":return _context4.stop()}}),_callee4,null,[[0,6]])})))()},openSummary:function(trigger){this.selectedTrigger=trigger,this.showSummary=!0}}},trigger_TriggersListvue_type_script_lang_js=TriggersListvue_type_script_lang_js,TriggersList_component=(0,componentNormalizer/* default */.Z)(trigger_TriggersListvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,TriggersList=TriggersList_component.exports},
/***/271791:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"8f181d382ffbfa8849763c3ada75c3c6.svg";
/***/}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/2042.js.map