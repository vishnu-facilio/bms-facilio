(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[19347],{
/***/574752:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return Avatar}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/Avatar.vue?vue&type=template&id=7f0d5689
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.user||_vm.name?_c("div",{staticClass:"fc-avatar-inline"},[_vm.avatarUrl?_c("img",{staticClass:"fc-avatar",class:_vm.sizeClass,attrs:{src:_vm.avatarUrl,alt:"Profile Avatar"}}):_c("div",{staticClass:"fc-avatar",class:_vm.sizeClass,style:_vm.bgColor},[_vm._v(" "+_vm._s(_vm.trimmedName)+" ")])]):_vm._e()},staticRenderFns=[],objectSpread2=__webpack_require__(595082),vuex_esm=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(434284),__webpack_require__(564043),__webpack_require__(709873),__webpack_require__(228436),__webpack_require__(450886),__webpack_require__(677049),__webpack_require__(821694),__webpack_require__(420629)),Avatarvue_type_script_lang_js={props:{size:{type:String},user:{type:Object},avatarStyle:{type:Object},color:{type:String},name:{type:Boolean}},data:function(){return{sizeClass:"fc-avatar-"+this.size,fullName:"",trimmedName:null,avatarUrl:null,bgColor:"background-color: "+(this.color?this.color:this.getRandomBgColor())}},computed:(0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({users:function(state){return state.users}})),mounted:function(){var _this=this;if(this.user){var userName="";if(this.user.avatarUrl)this.avatarUrl=this.user.avatarUrl;else if(this.user.id){var userObj=this.users.find((function(user){return user.id===_this.user.id}));userObj&&userObj.avatarUrl&&(this.avatarUrl=userObj.avatarUrl),userObj&&userObj.name&&(userName=userObj.name)}userName=userName||this.user.name,userName&&(this.fullName=userName,this.trimmedName=this.getAvatarName(userName),this.bgColor="background-color: "+(this.color?this.color:this.getRandomBgColor()))}else this.name&&(this.trimmedName=this.getAvatarName(this.name),this.bgColor="background-color: "+(this.color?this.color:this.getRandomBgColor()))},watch:{user:function(){var _this2=this;if(this.user.avatarUrl)this.avatarUrl=this.user.avatarUrl;else if(this.user.id){var userObj=this.users.find((function(user){return user.id===_this2.user.id}));userObj&&userObj.avatarUrl?this.avatarUrl=userObj.avatarUrl:this.avatarUrl=null}else this.avatarUrl=null;this.user.name&&(this.fullName=this.user.name,this.trimmedName=this.getAvatarName(this.user.name),this.bgColor="background-color: "+(this.color?this.color:this.getRandomBgColor()))},"user.name":function(){this.user.name&&(this.fullName=this.user.name,this.trimmedName=this.getAvatarName(this.user.name),this.bgColor="background-color: "+(this.color?this.color:this.getRandomBgColor()))},"user.avatarUrl":function(){this.user.avatarUrl?this.avatarUrl=this.user.avatarUrl:this.avatarUrl=null},"user.id":function(){var _this3=this;if(this.user.id){var userObj=this.users.find((function(user){return user.id===_this3.user.id}));userObj&&userObj.avatarUrl?this.avatarUrl=userObj.avatarUrl:this.avatarUrl=null}else this.avatarUrl=null}},methods:{getAvatarName:function(name){for(var parts=name.split(/[ -]/),initials="",initialLen=2,count=0,i=0;i<parts.length;i++)if(""!==parts[i].trim()&&(initials+=parts[i].charAt(0),count++,count>=initialLen))break;initials.length<initialLen&&name.length>=initialLen&&(initials=name.trim().substring(0,initialLen));var avatarName=initials.toUpperCase();return avatarName},getRandomBgColor:function(){var colors=["#FFBA51","#34BFA3","#FF2F82","#29D9A7","#ECDC74","#927FED","#FF61A8","#fbf383","#ac4352","#6db1f4"],userKey=this.user.email?this.user.email:this.user.name,userUniqueNum=Array.from(userKey).map((function(letter){return letter.charCodeAt(0)})).reduce((function(current,previous){return previous+current})),colorIndex=userUniqueNum%colors.length,color=colors[colorIndex];return color}}},components_Avatarvue_type_script_lang_js=Avatarvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_Avatarvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,Avatar=component.exports},
/***/142885:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return InstantTranslate}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/InstantTranslate.vue?vue&type=template&id=7d2632e2
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_vm.detectLangShow?_c("div",[_vm.orgAndUserLanguage!==_vm.detectLanguage.language?_c("div",[_vm.extraContent?_c("div",_vm._l(_vm.translateListMoreThan,(function(translate,inex){return _c("div",{key:inex},[_c("div",{staticClass:"fc-translate-text"},[_c("div",{staticClass:"fc-grey8-14 f13 bold"},[_vm._v(" "+_vm._s(_vm.$t("common.translation.translate_text"))+" "),translate&&translate.detectedSourceLanguage?_c("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Translated from "+_vm.languagesData[translate.detectedSourceLanguage]||0,placement:"top-start"}},[_c("i",{staticClass:"el-icon-info"})]):_vm._e()],1),_c("div",{staticClass:"pT5 fc-grey8-14 f13 line-height20"},[_vm._v(" "+_vm._s(translate.translatedText)+" ")])])])})),0):_c("div",{staticClass:"fc-grey8-14 f13 fc-translate-text"},[_c("div",{staticClass:"fc-grey8-14 f13 bold"},[_vm._v(" "+_vm._s(_vm.$t("common.translation.translate_text"))+" "),_vm.translateListData&&_vm.translateListData.detectedSourceLanguage?_c("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Translated from "+_vm.languagesData[_vm.translateListData.detectedSourceLanguage],placement:"top-start"}},[_c("i",{staticClass:"el-icon-info"})]):_vm._e()],1),_c("div",{staticClass:"pT5 fc-grey8-14 f13 line-height20"},[_vm._v(" "+_vm._s(_vm.translateListData.translatedText)+" ")])])]):_vm._e()]):_vm._e()])},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),axios=(__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(634338),__webpack_require__(409669)),axios_default=__webpack_require__.n(axios),validation=__webpack_require__(586529),languages=__webpack_require__(601273),InstantTranslatevue_type_script_lang_js={props:["content","extraContent"],data:function(){return{detectLanguage:[],loading:!0,translateListData:[],languageData:this.$org.language,seeTranslation:!1,seeTranslationStartContent:!0,googleKey:"AIzaSyAeJBX0k0BxzMvvlRyCsOtPYWKVs62603w",translateListMoreThan:[],detectLangShow:!1,languages:null,languageTranslateData:{}}},computed:{orgAndUserLanguage:function(){return(0,validation/* isEmpty */.xb)(this.$account.user.language)?this.$org.language:this.$account.user.language},languagesData:function(){var _this=this,data={};return languages/* default */.Z.forEach((function(rt){_this.$set(data,rt.value,rt.label)})),data}},mounted:function(){var _this2=this;this.$nextTick((function(){_this2.getDetectLanguage()}))},methods:{
// This API for detect app language
detectAppLanguage:function(){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var response;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _this3.loading=!0,_context.next=3,axios_default().post("https://translation.googleapis.com/language/translate/v2/detect?key=".concat(_this3.googleKey,"&q=").concat(_this3.content));case 3:response=_context.sent,_this3.detectLanguage=response.data&&response.data.data&&response.data.data.detections[0][0],_this3.loading=!1;case 6:case"end":return _context.stop()}}),_callee)})))()},
// This API for translate text
translateLanguageList:function(){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var params,response;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _this4.loading=!0,params={q:[_this4.content]},_this4.extraContent&&(params.q=[_this4.content,_this4.extraContent]),_context2.next=5,axios_default().post("https://translation.googleapis.com/language/translate/v2?key=".concat(_this4.googleKey,"&target=").concat(_this4.orgAndUserLanguage,"&format=html"),params);case 5:response=_context2.sent,_this4.translateListData=response.data&&response.data.data&&response.data.data.translations[0],_this4.translateListMoreThan=response.data&&response.data.data&&response.data.data.translations,_this4.loading=!1;case 9:case"end":return _context2.stop()}}),_callee2)})))()},showLanguageHideList:function(){var _this5=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return _this5.seeTranslation=!0,_this5.seeTranslationStartContent=!1,_context3.next=4,_this5.translateLanguageList();case 4:_this5.$emit("onData");case 5:case"end":return _context3.stop()}}),_callee3)})))()},backToOriginal:function(){this.seeTranslation=!1,this.seeTranslationStartContent=!0},getDetectLanguage:function(){var _this6=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:return _this6.detectAppLanguage(),_context4.next=3,_this6.translateLanguageList();case 3:_this6.$emit("reLoad"),_this6.$emit("onData"),_this6.detectLangShow=!0;case 6:case"end":return _context4.stop()}}),_callee4)})))()}}},components_InstantTranslatevue_type_script_lang_js=InstantTranslatevue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_InstantTranslatevue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,InstantTranslate=component.exports},
/***/720096:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return PreviewFile}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/PreviewFile.vue?vue&type=template&id=447c7e89
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.currentFile?_c("div",{directives:[{name:"show",rawName:"v-show",value:_vm.show,expression:"show"}],staticClass:"preview-file"},[_c("div",{staticClass:"top-toolbar"},[_c("div",{staticClass:"a-top-toolbar"},[_c("div",{staticClass:"file-name word-break-keep"},[_vm._v(" "+_vm._s(_vm.currentFile.fileName)+" ")]),_c("div",{staticClass:"top-toolbar-icon-right flex align-center"},[_vm.currentFile.contentType.includes("image")?[_c("div",{staticClass:"flex-middle pL15"},[_vm.showOriginalImage?_c("div",{staticClass:"fc-white-14 word-break-keep pointer",on:{click:_vm.showOriginalPhoto}},[_vm._v(" "+_vm._s(_vm.$t("common._common.view_original"))+" ")]):_vm._e(),_vm.showCompressedImage?_c("div",{staticClass:"fc-white-14 word-break-keep pointer",on:{click:_vm.showCompressedPhoto}},[_vm._v(" "+_vm._s(_vm.$t("common._common.view_default"))+" ")]):_vm._e()]),_c("div",{staticClass:"download-icon round flex-middle pL15",on:{click:function($event){return _vm.downloadAttachment(_vm.currentFile)}}},[_c("i",{staticClass:"el-icon-download op8",staticStyle:{color:"#ffff"}})])]:_vm._e(),_vm.currentFile.contentType.includes("pdf")?[_c("div",{staticClass:"download-icon round flex-middle pL15",on:{click:function($event){return _vm.downloadAttachment(_vm.currentFile)}}},[_c("i",{staticClass:"el-icon-download op8",staticStyle:{color:"#ffff"}})])]:_vm._e(),_vm.showDeleteOption()?_c("div",{staticClass:"flex-middle pL15",on:{click:function($event){return _vm.deletePreview()}}},[_c("inline-svg",{staticClass:"pointer edit-icon-color close vertical-text-top",attrs:{src:"svgs/delete",iconClass:"icon icon-md"}})],1):_vm._e(),_c("div",{staticClass:"pL15"},[_c("i",{staticClass:"el-icon-close close",on:{click:_vm.closePreview}})])],2)])]),_vm.currentFileIndex>0?_c("a",{staticClass:"el-icon-arrow-left prev",staticStyle:{"font-size":"30px"},on:{click:function($event){return _vm.plusSlides(-1)}}}):_vm._e(),_vm.currentFileIndex<_vm.files.length-1?_c("a",{staticClass:"el-icon-arrow-right next",staticStyle:{"font-size":"30px"},on:{click:function($event){return _vm.plusSlides(1)}}}):_vm._e(),_c("div",{staticClass:"preview-content"},[_vm.currentFile.contentType.includes("image")?[_vm.compressedImage?_c("img",{staticClass:"content",staticStyle:{"box-shadow":"none"},attrs:{src:_vm.$prependBaseUrl(_vm.currentFile.previewUrl)}}):_vm.originalImage?_c("img",{staticClass:"content original",staticStyle:{"box-shadow":"none"},attrs:{src:_vm.$prependBaseUrl(_vm.currentFile.previewUrl+"?fetchOriginal=true")}}):_vm._e()]:_vm.currentFile.contentType.includes("pdf")?_c("div",{staticClass:"width100 height-100"},[_c("iframe",{staticClass:"fc-preview-pdf",attrs:{src:_vm.$prependBaseUrl(_vm.currentFile.previewUrl),height:"100%",width:"100%"}})]):_vm.isVideoSupported(_vm.currentFile.contentType)?_c("div",{staticClass:"width100 height-100 fc-preview-video"},[_c("video",{attrs:{controls:""}},[_c("source",{attrs:{src:_vm.$prependBaseUrl(_vm.$getProperty(_vm.currentFile,"downloadUrl",null)),type:_vm.$getProperty(_vm.currentFile,"contentType")}}),_vm._v(" "+_vm._s(_vm.$t("common._common.browser_not_supported"))+" ")])]):_c("div",{staticClass:"no-preview"},[_c("div",{staticClass:"flex justify-center pT24"},[_c("inline-svg",{staticClass:"d-flex",attrs:{src:_vm.getFileIcon(_vm.currentFile),iconClass:"icon icon-60 overlay"}})],1),_c("div",{staticClass:"f14 pT12 pB12"},[_vm._v("No preview available")]),_c("div",{staticClass:"download-button"},[_c("a",{staticClass:"flex flex-row",staticStyle:{color:"#ffff"},on:{click:function($event){return _vm.downloadAttachment(_vm.currentFile)}}},[_c("div",[_vm._v("Download")])])])])],2),_vm.exportDownloadUrl?_c("iframe",{staticStyle:{display:"none"},attrs:{src:_vm.exportDownloadUrl}}):_vm._e()]):_vm._e()},staticRenderFns=[],validation=(__webpack_require__(339772),__webpack_require__(260228),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(228436),__webpack_require__(990260)),PreviewFilevue_type_script_lang_js={props:["previewFile","files","visibility","showDelete","isLockedState","isTaskClosed"],data:function(){return{show:!0,previewUrl:null,currentFileIndex:0,currentFile:null,imageMargin:null,exportDownloadUrl:null,originalImage:!1,compressedImage:!0,showOriginalImage:!0,showCompressedImage:!1}},destroyed:function(){window.removeEventListener("keyup",this.handler)},mounted:function(){window.addEventListener("keyup",this.handler),this.preloadImages()},watch:{},computed:{},methods:{handler:function(){
// If escape key is pressed...
27===event.keyCode?this.closePreview():37===event.keyCode?this.plusSlides(-1):39===event.keyCode&&this.plusSlides(1)},preloadImages:function(){this.currentFile=this.previewFile?this.previewFile:this.files[0],this.currentFileIndex=this.files.indexOf(this.currentFile)},plusSlides:function(n){var index=this.currentFileIndex+n;index<0&&(index=0),index>=this.files.length&&(index=this.files.length-1),this.currentFileIndex=index,this.currentFile=this.files[index]},closePreview:function(){this.$emit("update:visibility",!1)},deletePreview:function(){var currentFile=this.currentFile;this.$emit("onDelete",currentFile)},downloadAttachment:function(file){var _this=this,_ref=file||{},url=_ref.downloadUrl;this.exportDownloadUrl&&(this.exportDownloadUrl=null),this.$nextTick((function(){_this.exportDownloadUrl=url}))},showOriginalPhoto:function(){this.originalImage=!0,this.showCompressedImage=!0,this.showOriginalImage=!1,this.compressedImage=!1},showCompressedPhoto:function(){this.showCompressedImage=!1,this.originalImage=!1,this.showOriginalImage=!0,this.compressedImage=!0},getFileIcon:function(attachment){var contentType=attachment.contentType,FILE_TYPE_ICONS=this.$constants.FILE_TYPE_ICONS,selectedIndex=FILE_TYPE_ICONS.findIndex((function(icons){var fileTypes=icons.fileTypes;return fileTypes.some((function(type){return contentType.includes(type)}))}));return(0,validation/* isEmpty */.xb)(selectedIndex)?FILE_TYPE_ICONS[0].path:FILE_TYPE_ICONS[selectedIndex].path},isVideoSupported:function(contentType){contentType=contentType||"";var supportedTypes=["video/webm","video/mp4","video/ogg"];return supportedTypes.includes(contentType.trim().toLowerCase())},showDeleteOption:function(){var showDelete=this.showDelete,isLockedState=this.isLockedState,isTaskClosed=this.isTaskClosed;return showDelete&&!isLockedState&&!isTaskClosed}}},components_PreviewFilevue_type_script_lang_js=PreviewFilevue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_PreviewFilevue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,PreviewFile=component.exports},
/***/604947:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return Spinner}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/Spinner.vue?vue&type=template&id=06a81286&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("transition",[_c("svg",{directives:[{name:"show",rawName:"v-show",value:_vm.show,expression:"show"}],staticClass:"spinner",class:{show:_vm.show},attrs:{width:_vm.spinnerSize,height:_vm.spinnerSize,viewBox:"0 0 44 44"}},[_c("circle",{staticClass:"path",style:{stroke:_vm.strokeColor},attrs:{fill:"none","stroke-width":"4","stroke-linecap":"round",cx:"22",cy:"22",r:"20"}})])])},staticRenderFns=[],Spinnervue_type_script_lang_js={name:"spinner",props:["show","size","colour"],computed:{spinnerSize:function(){return this.size?this.size+"px":"50px"},strokeColor:function(){return this.colour?this.colour:"#fd4b92"}}},components_Spinnervue_type_script_lang_js=Spinnervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_Spinnervue_type_script_lang_js,render,staticRenderFns,!1,null,"06a81286",null)
/* harmony default export */,Spinner=component.exports},
/***/116920:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return NewNotes}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/widget/NewNotes.vue?vue&type=template&id=2d377cb9&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{ref:"comment-section",staticClass:"fc-comments-widget"},[_vm.isActive&&_vm.groupKey?_c("portal",{attrs:{to:_vm.groupKey+"-topbar",slim:""}},[_c("div",{staticClass:"ex-icon-container",on:{click:function($event){return _vm.expandNotesWidget()}}},[_c("InlineSvg",{attrs:{src:"svgs/expand-icon",iconClass:"expand-icon"}})],1)]):_vm._e(),_c("CommentInput",{ref:"commentInput",staticClass:"comment-input pT10 pB10",attrs:{placeHolder:_vm.forWO?_vm.$t("common._common.add_a_comment"):_vm.$t("common._common.add_note")},on:{focus:_vm.closeAllReplyInputs,save:_vm.createHandler}}),_c("div",[_vm.loading?_c("div",{staticClass:"text-center"},[_c("spinner",{attrs:{show:_vm.loading}})],1):_vm.$validation.isEmpty(_vm.comments)?_c("div",{staticClass:"d-flex flex-direction-column text-fc-grey mT20"},[_c("inline-svg",{staticClass:"vertical-middle self-center",attrs:{src:"svgs/community-empty-state/comments",iconClass:"icon empty-note mR5 "}}),_c("div",{staticClass:"empty-notes-desc f13 pL10 self-center"},[_vm._v(" "+_vm._s(_vm.title?_vm.$t("common.products.no_mod_available")+_vm.title+_vm.$t("common._common.added_yet"):_vm.$t("common._common.no_notes"))+" ")])],1):_c("div",{ref:"notes-container"},[_vm._l(_vm.filteredComments,(function(comment,index){return _c("div",{key:comment.id},[_c("CommentView",{staticClass:"parent-comments",attrs:{comment:comment,currentLevel:1,index:index,woDescriptiontranslate:_vm.woDescriptiontranslate},on:{edit:_vm.editHandler,delete:_vm.deleteHandler,updateCommentSharing:_vm.updateCommentSharing,refreshComments:function($event){return _vm.loadComments()}}})],1)})),_vm.comments&&_vm.canShowViewMore?_c("div",[_c("a",{staticClass:"show-all-comments fc-text-underline",on:{click:_vm.showOrHideComments}},[_vm._v(_vm._s(_vm.canShowAllComments?_vm.forWO?_vm.$t("common._common.view_recent_comments"):_vm.$t("common._common.view_recent_notes"):_vm.forWO?_vm.$t("common._common.view_new")+(_vm.comments.length-_vm.filteredComments.length)+_vm.$t("common._common.more_comments"):_vm.$t("common._common.view_new")+(_vm.comments.length-_vm.filteredComments.length)+_vm.$t("common._common.more_notes")))])]):_vm._e()],2)])],1)},staticRenderFns=[],esm_typeof=__webpack_require__(103336),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),validation=(__webpack_require__(865137),__webpack_require__(689730),__webpack_require__(450886),__webpack_require__(670560),__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(162506),__webpack_require__(990260)),CommentUtils=__webpack_require__(518700),CommentInput=__webpack_require__(965757),CommentViewvue_type_template_id_64057a01_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"d-flex flex-direction-column comment-view"},[_vm.showEdit?_c("CommentInput",{attrs:{value:_vm.comment,isEdit:_vm.showEdit},on:{save:_vm.emitUpdate,close:function($event){_vm.showEdit=!1}}}):_c("div",{staticClass:"fc-commentview-row d-flex flex-direction-row visibility-visible-actions position-relative"},[_c("div",{staticClass:"f13 secondary-color comment-by mR5"},[_c("avatar",{attrs:{size:"md",user:_vm.comment.createdBy&&_vm.comment.createdBy.id?_vm.comment.createdBy:{id:-1,name:"Unknown"}}})],1),_c("div",{staticClass:"comment-time width100"},[_c("div",{staticClass:"flex-middle flex-row mT8 mB8"},[_vm.comment.createdBy&&_vm.comment.createdBy.id?_c("span",{staticClass:"fc-commentview-title-14"},[_vm._v(_vm._s(_vm.comment.createdBy.name))]):_vm._e(),_c("div",{staticClass:"comments-dot comments-dot-grey-color"}),_c("el-tooltip",{attrs:{placement:"top",trigger:"hover","open-delay":500,content:_vm._f("formatDate")(_vm.comment.createdTime),"popper-class":"comment-message-tooltip f12 p6"}},[_c("span",{staticClass:"fc-comment-subtext-12"},[_vm._v(" "+_vm._s(_vm._f("fromNow")(_vm.comment.createdTime))+" ")])])],1),null!=_vm.comment.bodyHTML?_c("div",{staticClass:"markdown-style fc-commentview-text-14 mB8",domProps:{innerHTML:_vm._s(_vm.comment.bodyHTML)}}):_vm._e(),_vm.canShowAttachments?_c("CommentAttachments",{staticClass:"comment-attachments-preview mb5",attrs:{attachments:_vm.comment.attachments}}):_vm._e(),_c("div",{staticClass:"comment-options d-flex",class:{mB8:_vm.canShowCommentBar||_vm.canShowReplies}},[_c("div",{staticClass:"comment-reply-button pL0",on:{click:_vm.showOrHideReply,mouseover:function($event){_vm.replyBtnHover=!0},mouseleave:function($event){_vm.replyBtnHover=!1}}},[_c("span",{staticClass:"flex-middle"},[_c("fc-icon",{staticClass:"mR3",attrs:{group:"communication",name:"reply",color:_vm.replyBtnColor,size:"18"}}),_c("span",{staticClass:"reply-btn"},[_vm._v(_vm._s("Reply"))])],1)]),_vm.CommentService.canShowSharing&&!_vm.isReply?_c("div",{staticClass:"comments-dot comments-dot-light-grey-color"}):_vm._e(),_vm.CommentService.canShowSharing&&!_vm.isReply?_c("el-button",{staticClass:"comment-reply-button flex-middle"},[_vm.CommentService.canShowSharing&&!_vm.isReply?_c("SharingPopover",{staticClass:"comment-sharing-btn",staticStyle:{display:"inline-block"},attrs:{apps:_vm.CommentService.portalApps,disable:!_vm.comment.editAvailable},on:{change:function(){return _vm.updateCommentSharing(_vm.comment)}},model:{value:_vm.comment.commentSharing,callback:function($$v){_vm.$set(_vm.comment,"commentSharing",$$v)},expression:"comment.commentSharing"}},[_c("el-tooltip",{attrs:{placement:"top","open-delay":500,"popper-class":"comment-message-tooltip f12 p6"}},[_c("div",{attrs:{slot:"content"},slot:"content"},[_vm.comment.commentSharing&&_vm.comment.commentSharing.length?_c("div",[_c("span",[_vm._v(_vm._s("Public:"))]),_c("br"),_vm._l(_vm.comment.commentSharing,(function(sharing){return _c("div",{key:sharing.appId},[_c("span",[_vm._v(_vm._s(_vm.getAppName(sharing.appId))),_c("br")])])}))],2):_c("div",[_c("span",[_vm._v(_vm._s("Private"))])])]),_vm.canShowSharingIcon&&_vm.isPublicComment?_c("fc-icon",{staticClass:"mT2",attrs:{group:"default",color:_vm.sharingIconColor,size:"17.5",name:"eye-open"},on:{mouseover:function($event){_vm.sharingIconHover=!0},mouseleave:function($event){_vm.sharingIconHover=!1}}}):_vm.canShowSharingIcon&&!_vm.isPublicComment?_c("fc-icon",{staticClass:"mT2",attrs:{group:"default",color:_vm.sharingIconColor,size:"17.5",name:"eye-slashed"},on:{mouseover:function($event){_vm.sharingIconHover=!0},mouseleave:function($event){_vm.sharingIconHover=!1}}}):_vm._e()],1)],1):_vm._e()],1):_vm._e()],1),_c("div",{staticClass:"reply-thread-container"},[_vm.canShowCommentBar||_vm.canShowReplies?_c("div",{staticClass:"reply-thread"},[_vm.canShowCommentBar?_c("div",{staticClass:"pL10 pT10 pB10"},[_c("CommentInput",{ref:"reply-input",attrs:{parentNote:_vm.comment,placeHolder:_vm.$t("common._common.add_a_reply"),referer:_vm.refererForReply},on:{save:_vm.createHandler,close:_vm.showOrHideReply}})],1):_vm._e(),_vm.loading?_c("div",{staticClass:"text-center"},[_c("spinner",{attrs:{show:_vm.loading}})],1):_vm.canShowReplies?_c("div",_vm._l(_vm.filteredReplies,(function(reply,replyIndex){return _c("RecursiveComment",{key:reply.id,staticClass:"pL10",attrs:{comment:reply,currentLevel:_vm.currentLevel+1,index:replyIndex,woDescriptiontranslate:_vm.woDescriptiontranslate},on:{edit:_vm.editHandler,delete:_vm.deleteHandler,replyParent:_vm.showOrHideReply}})})),1):_vm._e()]):_vm._e(),_c("div",[_vm.showRepliesButton?_c("span",{staticClass:"view-more-replies fc-text-underline pointer pT5 pB5",on:{click:_vm.viewMoreReplies}},[_vm._v(" "+_vm._s(_vm.repliesExpandText)+" ")]):_vm._e()])]),_vm.woDescriptiontranslate?_c("InstantTranslate",{key:_vm.comment.id,staticClass:"fc-wo-comments-translate",attrs:{content:_vm.comment.bodyText}}):_vm._e()],1),_c("div",{staticClass:"comment-more-options position-absolute top-0 right-0"},[(_vm.comment.createdBy||{}).id===_vm.$account.user.id?_c("div",{},[_c("el-dropdown",{staticClass:"delete-dropdown",attrs:{trigger:"click"},on:{command:function($event){return _vm.EditOrDeleteNote($event,_vm.comment,_vm.index)}}},[_c("span",{staticClass:"el-dropdown-link"},[_c("i",{staticClass:"el-icon-more pointer fc-grey6",staticStyle:{padding:"8px"}})]),_c("el-dropdown-menu",{staticClass:"p0",attrs:{slot:"dropdown"},slot:"dropdown"},[_c("el-dropdown-item",{staticClass:"el-dropdown-comments-delete",attrs:{command:"edit"}},[_c("div",[_vm._v(" "+_vm._s(_vm.$t("common._common.edit"))+" ")])]),_c("el-dropdown-item",{staticClass:"el-dropdown-comments-delete",attrs:{command:"delete"}},[_c("div",[_vm._v(" "+_vm._s(_vm.$t("common._common.delete"))+" ")])])],1)],1)],1):_vm._e()])])],1)},CommentViewvue_type_template_id_64057a01_scoped_true_staticRenderFns=[],objectSpread2=__webpack_require__(595082),Avatar=(__webpack_require__(300268),__webpack_require__(434284),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(634338),__webpack_require__(574752)),eventBus=__webpack_require__(398011),InstantTranslate=__webpack_require__(142885),SharingPopover=__webpack_require__(804804),PeoplePopovervue_type_template_id_3e6c9a1d_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"people-mention-popover d-flex p20"},[_c("div",{staticClass:" flex-middle"},[_c("PeopleAvatar",{attrs:{name:!1,users:_vm.users,size:"lg",people:_vm.people}})],1),_c("div",{staticClass:"mL20"},[_c("div",{staticClass:"bold f16 primary-font mT2"},[_vm._v(" "+_vm._s(_vm.people.name||"---")+" ")]),_c("div",{staticClass:" flex-middle mT5"},[_c("fc-icon",{staticClass:"pR5",attrs:{color:"#324056",size:"16",group:"communication",name:"mail"}}),_c("span",{staticClass:"primary-font f13 maxWidth200px textoverflow-ellipsis"},[_vm._v(_vm._s(_vm.people.email||"---")+" ")])],1),_c("div",{staticClass:"flex-middle mT5"},[_c("fc-icon",{staticClass:"pR5",attrs:{color:"#324056",size:"16",group:"communication",name:"call"}}),_c("span",{staticClass:"primary-font f13"},[_vm._v(_vm._s(_vm.people.mobile||"---")+" ")])],1)])])},PeoplePopovervue_type_template_id_3e6c9a1d_scoped_true_staticRenderFns=[],PeopleAvatarvue_type_template_id_e21083c8_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.people?_c("div",{staticClass:"inline"},[_c("div",{staticClass:"fc-avatar-element q-item-division relative-position cursor-pointer"},[_c("div",{staticClass:"q-item-side q-item-side-left q-item-section relative"},[_vm.avatarUrl?_c("div",[_c("img",{staticClass:"fc-people-avatar",attrs:{src:_vm.avatarUrl}})]):_c("div",{staticClass:"fc-people-avatar",style:_vm.bgColor},[_vm._v(" "+_vm._s(_vm.trimmedName)+" ")])])])]):_vm._e()},PeopleAvatarvue_type_template_id_e21083c8_staticRenderFns=[],PeopleAvatarvue_type_script_lang_js=(__webpack_require__(564043),__webpack_require__(709873),__webpack_require__(228436),__webpack_require__(677049),__webpack_require__(821694),{props:["size","people","color","users"],data:function(){return{avatarUrl:null,trimmedName:"",bgColor:"background-color: "+(this.color?this.color:this.getRandomBgColor())}},mounted:function(){this.loadAvatarUrl()},watch:{people:function(){this.loadAvatarUrl()}},methods:{loadAvatarUrl:function(){var people=this.people;if(people.avatarId&&people.avatarId>0)this.avatarUrl=people.avatarUrl;else{if(people.id){var userObj=this.users.find((function(user){return user.peopleId===people.id}));if(userObj&&userObj.avatarUrl)return void(this.avatarUrl=userObj.avatarUrl)}this.trimmedName=this.getAvatarName(this.people.name)}},getAvatarName:function(name){for(var parts=name.split(/[ -]/),initials="",initialLen=2,count=0,i=0;i<parts.length;i++)if(""!==parts[i].trim()&&(initials+=parts[i].charAt(0),count++,count>=initialLen))break;initials.length<initialLen&&name.length>=initialLen&&(initials=name.trim().substring(0,initialLen));var avatarName=initials.toUpperCase();return avatarName},getDefaultAvatar:function(){var avatarUrl="";return avatarUrl=__webpack_require__(188742),avatarUrl},getRandomBgColor:function(){var colors=["#FFBA51","#34BFA3","#FF2F82","#29D9A7","#ECDC74","#927FED","#FF61A8","#fbf383","#ac4352","#6db1f4"],userKey=this.people.name,userUniqueNum=Array.from(userKey).map((function(letter){return letter.charCodeAt(0)})).reduce((function(current,previous){return previous+current})),colorIndex=userUniqueNum%colors.length,color=colors[colorIndex];return color}}}),notes_PeopleAvatarvue_type_script_lang_js=PeopleAvatarvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(notes_PeopleAvatarvue_type_script_lang_js,PeopleAvatarvue_type_template_id_e21083c8_render,PeopleAvatarvue_type_template_id_e21083c8_staticRenderFns,!1,null,null,null)
/* harmony default export */,PeopleAvatar=component.exports,PeoplePopovervue_type_script_lang_js={props:["people","users"],mounted:function(){},data:function(){return{defaultheight:"160px"}},components:{PeopleAvatar:PeopleAvatar},computed:{}},notes_PeoplePopovervue_type_script_lang_js=PeoplePopovervue_type_script_lang_js,PeoplePopover_component=(0,componentNormalizer/* default */.Z)(notes_PeoplePopovervue_type_script_lang_js,PeoplePopovervue_type_template_id_3e6c9a1d_scoped_true_render,PeoplePopovervue_type_template_id_3e6c9a1d_scoped_true_staticRenderFns,!1,null,"3e6c9a1d",null)
/* harmony default export */,PeoplePopover=PeoplePopover_component.exports,lodash=__webpack_require__(496486),lodash_default=__webpack_require__.n(lodash),vue_runtime_esm=__webpack_require__(720144),CommentAttachmentsvue_type_template_id_4d9f366a_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"d-flex flex-direction-column"},[_c("div",{ref:"attachment-container",class:["d-flex",_vm.$validation.isEmpty(_vm.attachments)&&"justify-content-center"]},[_vm.loading?_c("div",[_c("div",{staticClass:"text-center"},[_c("spinner",{attrs:{show:_vm.loading}})],1)]):_vm.$validation.isEmpty(_vm.attachments)?_vm._e():_c("div",{staticClass:"d-flex"},_vm._l(_vm.previewAttachments,(function(attachment,index){return _c("div",{key:index},[_c("el-tooltip",{attrs:{placement:"top",trigger:"hover","open-delay":500,content:attachment.fileName,"popper-class":"comment-message-tooltip"}},[attachment.contentType.includes("image")?_c("div",[_c("div",{key:index+attachment.id,staticClass:"fc-avatar-square image-preview cursor-pointer",style:_vm.getOverlayStyle(attachment),on:{click:function($event){return _vm.openAttachmentsPreview(!0,attachment)}}},[_vm.canShowOverlay(index)?_c("div",{staticClass:"image-overlay"},[_c("span",{staticClass:"overlay-count f24"},[_vm._v("+"+_vm._s(_vm.hiddenAttachmentCount))])]):_vm._e()])]):_c("div",[_c("div",{key:index+attachment.id,staticClass:"position-relative cursor-pointer",on:{click:function($event){return _vm.openAttachmentsPreview(!0,attachment)}}},[_vm.canShowOverlay(index)?_c("div",{staticClass:"overlay-count f24"},[_vm._v(" +"+_vm._s(_vm.hiddenAttachmentCount)+" ")]):_vm._e(),_c("div",{class:["file-icon flex flex-row",_vm.canShowOverlay(index)&&"svg-overlay"]},[_c("InlineSvg",{staticClass:"d-flex ",attrs:{src:_vm.getFileIcon(attachment),iconClass:"icon icon-40"}})],1)])])])],1)})),0)]),_vm.visibility?_c("preview-file",{attrs:{visibility:_vm.visibility,previewFile:_vm.previewFile,files:_vm.attachments},on:{"update:visibility":function($event){_vm.visibility=$event}}}):_vm._e()],1)},CommentAttachmentsvue_type_template_id_4d9f366a_scoped_true_staticRenderFns=[],PreviewFile=(__webpack_require__(339772),__webpack_require__(720096)),CommentAttachmentsvue_type_script_lang_js={name:"AttachmentPreview",props:["attachments"],components:{PreviewFile:PreviewFile/* default */.Z},data:function(){return{loading:!1,visibility:!1,previewFile:null,maxCount:4}},computed:{previewAttachments:function(){var attachments=this.attachments,maxCount=this.maxCount;return attachments.slice(0,maxCount+1)},hiddenAttachmentCount:function(){var _this$attachments=this.attachments,_this$attachments2=void 0===_this$attachments?{}:_this$attachments,length=_this$attachments2.length,maxCount=this.maxCount;return Math.abs(length-maxCount)}},methods:{openAttachmentsPreview:function(fileAttached,image){var attachments=this.attachments;attachments.length>0&&(this.visibility=!0,this.previewFile=fileAttached?image:attachments[0])},getFileIcon:function(attachment){var contentType=attachment.contentType,FILE_TYPE_ICONS=this.$constants.FILE_TYPE_ICONS,selectedIndex=FILE_TYPE_ICONS.findIndex((function(icons){var fileTypes=icons.fileTypes;return fileTypes.some((function(type){return contentType.includes(type)}))}));return(0,validation/* isEmpty */.xb)(selectedIndex)?FILE_TYPE_ICONS[0].path:FILE_TYPE_ICONS[selectedIndex].path},getOverlayStyle:function(attachment){var url=this.$prependBaseUrl(attachment.previewUrl);return"background-image: url(".concat(url,")")},canShowOverlay:function(index){var maxCount=this.maxCount,hiddenAttachmentCount=this.hiddenAttachmentCount;return index===maxCount&&hiddenAttachmentCount>1}}},notes_CommentAttachmentsvue_type_script_lang_js=CommentAttachmentsvue_type_script_lang_js,CommentAttachments_component=(0,componentNormalizer/* default */.Z)(notes_CommentAttachmentsvue_type_script_lang_js,CommentAttachmentsvue_type_template_id_4d9f366a_scoped_true_render,CommentAttachmentsvue_type_template_id_4d9f366a_scoped_true_staticRenderFns,!1,null,"4d9f366a",null)
/* harmony default export */,CommentAttachments=CommentAttachments_component.exports,vuex_esm=__webpack_require__(420629),tippy_esm=__webpack_require__(145088),router=__webpack_require__(329435),CommentViewvue_type_script_lang_js={name:"RecursiveComment",props:["comment","index","currentLevel","woDescriptiontranslate"],components:{Avatar:Avatar["default"],InstantTranslate:InstantTranslate/* default */.Z,SharingPopover:SharingPopover/* default */.Z,CommentInput:CommentInput/* default */.Z,CommentAttachments:CommentAttachments},inject:["CommentService","resizeNotesWidget"],mounted:function(){this.init()},destroyed:function(){this.removeEventBusListeners(),this.removeClickEventForMentions()},data:function(){return{canShowReplyInput:!1,peoplePopoverVisible:!1,canShowReplies:!1,showEdit:!1,repliesCount:0,replies:[],loading:!1,refererForReply:null,replyBtnHover:!1,sharingIconHover:!1,peoplePopoverReference:null}},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({users:function(state){return state.users}})),(0,vuex_esm/* mapGetters */.Se)(["getCurrentUser"])),{},{isCustomModule:function(){
//temp evaluation
var CommentService=this.CommentService,parentModule=CommentService.parentModule;return!!(this.$route.meta.moduleType&&"custom"===this.$route.meta.moduleType||parentModule.startsWith("custom_"))},canShowCommentBar:function(){var currentLevel=this.currentLevel,canShowReplyInput=this.canShowReplyInput;return 1===currentLevel&&canShowReplyInput},showRepliesButton:function(){var repliesCount=this.repliesCount,currentLevel=this.currentLevel,canShowReplies=this.canShowReplies;return repliesCount>0&&1===currentLevel&&!canShowReplies},isReply:function(){var currentLevel=this.currentLevel;return currentLevel>1},isPublicComment:function(){var comment=this.comment;return comment.commentSharing&&comment.commentSharing.length},canShowAttachments:function(){var _this$comment,_this$comment2;return!((0,validation/* isEmpty */.xb)(null===(_this$comment=this.comment)||void 0===_this$comment?void 0:_this$comment.attachments)||!(null!==(_this$comment2=this.comment)&&void 0!==_this$comment2&&_this$comment2.attachments.length)>0)},canShowSharingIcon:function(){var comment=this.comment,isReply=this.isReply;return comment.editAvailable&&!isReply},replyBtnColor:function(){var replyBtnHover=this.replyBtnHover;return replyBtnHover?"#324056":"#90959c"},sharingIconColor:function(){var sharingIconHover=this.sharingIconHover;return sharingIconHover?"#324056":"#90959c"},filteredReplies:function(){var replies=this.replies;if((0,validation/* isEmpty */.xb)(replies)||(0,validation/* areValuesEmpty */.sD)(replies))return[];var filteredComments=this.$helpers.cloneObject(replies||[]).sort((function(a,b){return b.createdTime-a.createdTime}));return filteredComments},repliesExpandText:function(){var canShowReplies=this.canShowReplies,repliesCount=this.repliesCount;return canShowReplies?"Hide replies":repliesCount>0?1===repliesCount?"View 1 reply":"View ".concat(repliesCount," Replies"):"View replies"}}),methods:{init:function(){var _this$comment3;this.setEventBusListeners(),this.repliesCount=null===(_this$comment3=this.comment)||void 0===_this$comment3?void 0:_this$comment3.replyCount,this.addClickEventForMentions(),this.initiateTippyrForMentions()},setEventBusListeners:function(){var _this=this;eventBus/* eventBus */.Y.$on("close-reply-text-area",(function(id){id!=_this.commentViewId&&(_this.canShowReplyInput=!1)}))},removeEventBusListeners:function(){eventBus/* eventBus */.Y.$off("close-reply-text-area")},initiateTippyrForMentions:function(){var _this2=this;(0,tippy_esm/* default */.ZP)("."+this.$constants.PEOPLE_MENTION_CLASS,{arrow:!0,allowHTML:!0,placement:"bottom",
// trigger: 'click',
trigger:"mouseenter",onShow:function(instance){var attributeValue=instance.reference.getAttribute("data-id"),people=_this2.getPeopleForAttribute(attributeValue);if(people){var ToastComponent=vue_runtime_esm["default"].extend(PeoplePopover),PopoverInstance=new ToastComponent({propsData:{people:people,users:_this2.users}});PopoverInstance.$mount(),instance.setContent(PopoverInstance.$el)}}})},getPeopleForAttribute:function(attributeValue){var recordId,ppl,MentionDetails=attributeValue.split("~");return isNaN(MentionDetails[1])||(recordId=parseInt(MentionDetails[1])),recordId&&(ppl=this.getPeopleForId(recordId)),ppl},getPeopleForId:function(peopleId){var comment=this.comment,_ref=comment||[],mentions=_ref.mentions;if(!(0,validation/* isEmpty */.xb)(mentions)){var mention=mentions.find((function(mention){var _mention$recordObj;return(null===mention||void 0===mention||null===(_mention$recordObj=mention.recordObj)||void 0===_mention$recordObj?void 0:_mention$recordObj.id)===peopleId}));if(!(0,validation/* isEmpty */.xb)(null===mention||void 0===mention?void 0:mention.recordObj))return mention.recordObj}return null},showOrHideReply:function(command){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var currentLevel,canShowReplyInput,comment,canShowReplies,showRepliesButton,_command,showReply,_this3$$refs$replyIn,referer;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(currentLevel=_this3.currentLevel,canShowReplyInput=_this3.canShowReplyInput,comment=_this3.comment,canShowReplies=_this3.canShowReplies,showRepliesButton=_this3.showRepliesButton,1==currentLevel){_context.next=6;break}command={action:"open",referer:comment.createdBy},_this3.$emit("replyParent",command),_context.next=18;break;case 6:if(showReply=!canShowReplyInput,"open"===(null===(_command=command)||void 0===_command?void 0:_command.action)&&(showReply=!0),!showReply){_context.next=15;break}return referer=(0,validation/* isEmpty */.xb)(command.referer)?comment.createdBy:command.referer,_this3.refererForReply=referer.peopleId==_this3.getCurrentUser().peopleId?null:referer,_context.next=13,_this3.$nextTick();case 13:null===(_this3$$refs$replyIn=_this3.$refs["reply-input"])||void 0===_this3$$refs$replyIn||_this3$$refs$replyIn.resetComment(),_this3.closeOtherCommentInputs();case 15:_this3.canShowReplyInput=showReply,showRepliesButton&&!canShowReplies&&_this3.viewMoreReplies(),_this3.resizeNotesWidget();case 18:case"end":return _context.stop()}}),_callee)})))()},closeOtherCommentInputs:function(){var commentViewId=this.commentViewId;eventBus/* eventBus */.Y.$emit("shrink-comment-text-area"),eventBus/* eventBus */.Y.$emit("close-reply-text-area",commentViewId)},createHandler:function(note){this.replies.push(note),this.repliesCount=this.replies.length},emitUpdate:function(note){this.$emit("edit",note)},editHandler:function(note){var replies=this.replies,existingNote=replies.find((function(r){return r.id===note.id}));existingNote&&this.replies.splice(replies.indexOf(existingNote),1,note)},deleteHandler:function(note){var replies=this.replies,doNote=replies.find((function(r){return r.id===note.id}));doNote&&(this.replies.splice(replies.indexOf(doNote),1),this.repliesCount=replies.length)},updateCommentSharing:function(comment){this.$emit("updateCommentSharing",comment)},commentViewId:function(){return lodash_default().uniqueId("comment_view")},getAppName:function(appId){var CommentService=this.CommentService;if(CommentService.portalApps){var app=CommentService.portalApps.find((function(a){return a.id==appId}));if(app)return app.name}return""},loadReplies:function(){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var CommentService,comment,_yield$CommentService,data,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return CommentService=_this4.CommentService,comment=_this4.comment,_this4.loading=!0,_context2.next=4,CommentService.fetchComments(comment);case 4:_yield$CommentService=_context2.sent,data=_yield$CommentService.data,error=_yield$CommentService.error,error?_this4.$message.error(error.message||"Error Occured"):(_this4.replies=data,_this4.repliesCount=_this4.replies.length),_this4.loading=!1,_this4.resizeNotesWidget();case 10:case"end":return _context2.stop()}}),_callee2)})))()},EditOrDeleteNote:function(command,note){var _this5=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var success;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:if("delete"!==command){_context3.next=5;break}return _context3.next=3,_this5.deleteNote(note);case 3:success=_context3.sent,success&&_this5.$emit("delete",note);case 5:"edit"===command&&(_this5.closeOtherCommentInputs(),_this5.showEdit=!0);case 6:case"end":return _context3.stop()}}),_callee3)})))()},deleteNote:function(note){var _this6=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){var promptDelete,isDelete,_this6$CommentService,error,message;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:return promptDelete=_this6.promptDelete,_context4.next=3,promptDelete();case 3:if(isDelete=_context4.sent,isDelete){_context4.next=8;break}return _context4.abrupt("return",!1);case 8:if(_this6$CommentService=_this6.CommentService.delete(note),error=_this6$CommentService.error,!error){_context4.next=15;break}return message=error.message,_this6.$message.error(message),_context4.abrupt("return",!1);case 15:return _this6.$message.success(_this6.$t("common.products.note_deleted_successfully")),_context4.abrupt("return",!0);case 17:case"end":return _context4.stop()}}),_callee4)})))()},promptDelete:function(){var _this7=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee5(){var value;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context5){while(1)switch(_context5.prev=_context5.next){case 0:return _context5.next=2,_this7.$dialog.confirm({title:_this7.$t("common.header.delete_note"),message:_this7.$t("common.header.are_you_sure_you_want_to_delete_this_note"),rbDanger:!0,rbLabel:_this7.$t("common._common.delete")});case 2:return value=_context5.sent,_context5.abrupt("return",!!value);case 4:case"end":return _context5.stop()}}),_callee5)})))()},viewMoreReplies:function(){var replies=this.replies;this.canShowReplies=!0,(0,validation/* isEmpty */.xb)(replies)&&this.loadReplies(),this.resizeNotesWidget()},addClickEventForMentions:function(){var _this8=this;this.$nextTick((function(){var recordmentionelements=_this8.$el.getElementsByClassName(_this8.$constants.RECORD_MENTION_CLASS);if(recordmentionelements&&recordmentionelements.length)for(var lengthofEl=recordmentionelements.length,_loop=function(i){recordmentionelements[i].addEventListener("click",(function(){_this8.redirectToOverview(recordmentionelements[i])}))},i=0;i<lengthofEl;i++)_loop(i)}))},removeClickEventForMentions:function(){var _this9=this;this.$nextTick((function(){var recordmentionelements=_this9.$el.getElementsByClassName(_this9.$constants.RECORD_MENTION_CLASS);if(recordmentionelements&&recordmentionelements.length)for(var lengthofEl=recordmentionelements.length,_loop2=function(i){recordmentionelements[i].removeEventListener("click",(function(){_this9.redirectToOverview(recordmentionelements[i])}))},i=0;i<lengthofEl;i++)_loop2(i)}))},redirectToOverview:function(el){var route,isCustomModule=this.isCustomModule,mentionId=el.getAttribute("data-id");if(!(0,validation/* isEmpty */.xb)(mentionId)&&mentionId.includes("~")){var mentionDetails=mentionId.split("~"),moduleName=mentionDetails[0],recordId=mentionDetails[1];if(!isNaN(recordId)){if((0,router/* isWebTabsEnabled */.tj)()){var _ref2=(0,router/* findRouteForModule */.Jp)(moduleName,router/* pageTypes */.As.OVERVIEW)||{},name=_ref2.name;name&&(route=this.$router.resolve({name:name,params:{viewname:"all",id:recordId}}).href)}else{var hasPermission=this.$hasPermission("".concat(moduleName,": READ"));if(!hasPermission)return;var routerMap={workorder:{name:"wosummarynew",params:{id:recordId}},workpermit:{name:"workPermitSummary",params:{id:recordId,viewname:"all"}},purchaserequest:{name:"prSummary",params:{id:recordId,viewname:"all"}},purchaseorder:{name:"poSummary",params:{id:recordId,viewname:"all"}},tenantcontact:{name:"tenantcontact",params:{id:recordId,viewname:"all"}},tenantunit:{name:"tenantUnitSummary",params:{id:recordId,viewname:"all"}},vendors:{name:"vendorsSummary",params:{id:recordId,viewname:"all"}},asset:{name:"assetsummary",params:{assetid:recordId,viewname:"all"}},tenantspaces:{name:"tenant",params:{id:(recordId||{}).id,viewname:"all"}},serviceRequest:{name:"serviceRequestSummary",params:{id:recordId,viewname:"all"}},client:{name:"clientSummary",params:{id:recordId,viewname:"all"}},vendorcontact:{name:"vendorContactsSummary",params:{id:recordId,viewname:"all"}},insurance:{name:"insurancesSummary",params:{id:recordId,viewname:"all"}},quote:{path:"/app/tm/quotation/all/".concat(recordId,"/overview")},item:{path:"/app/inventory/item/all/".concat(recordId,"/summary")},tool:{path:"/app/inventory/tool/all/".concat(recordId,"/summary")},inspectionResponse:{path:"/app/inspection/individual/all/summary/".concat(recordId)}};if(isCustomModule)route=this.$router.resolve({path:"/app/ca/modules/".concat(moduleName,"/all/").concat(recordId,"/summary")}).href;else{if((0,validation/* isEmpty */.xb)(routerMap[moduleName]))return;route=this.$router.resolve(routerMap[moduleName]).href}}route&&route&&window.open(route,"_blank")}}}}},notes_CommentViewvue_type_script_lang_js=CommentViewvue_type_script_lang_js,CommentView_component=(0,componentNormalizer/* default */.Z)(notes_CommentViewvue_type_script_lang_js,CommentViewvue_type_template_id_64057a01_scoped_true_render,CommentViewvue_type_template_id_64057a01_scoped_true_staticRenderFns,!1,null,"64057a01",null)
/* harmony default export */,CommentView=CommentView_component.exports,NewNotesvue_type_script_lang_js={props:["module","record","notify","parentModule","isCustomModule","isServicePortal","setNoOfNotesLength","resizeWidget","layoutParams","isActive","title","forWO","listViewComments","isPopoverView","groupKey"],components:{CommentInput:CommentInput/* default */.Z,CommentView:CommentView},data:function(){return{CommentService:(0,CommentUtils/* getCommentService */.k)(),comments:[],loading:!0,woDescriptiontranslate:!1,canShowAllComments:this.listViewComments||!1,visibleCommentCount:3,maxWidgetHeight:650,currentWidgetHeight:0,sharingPopover:!1,defaultWidgetHeight:this.$getProperty(this.layoutParams,"h",null)}},created:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.next=2,_this.init();case 2:case"end":return _context.stop()}}),_callee)})))()},destroyed:function(){this.killActiveEvents(),this.CommentService.$destroy()},provide:function(){return{CommentService:this.CommentService,fetchComments:this.fetchComments,resizeNotesWidget:this.resizeNotesWidget}},computed:{filteredComments:function(){var comments=this.comments,canShowAllComments=this.canShowAllComments,visibleCommentCount=this.visibleCommentCount;if((0,validation/* isEmpty */.xb)(comments)||(0,validation/* areValuesEmpty */.sD)(comments))return[];var filteredArr=this.$helpers.cloneObject(comments).sort((function(a,b){return b.createdTime-a.createdTime})),count=filteredArr&&filteredArr.length;return canShowAllComments&&count>0?filteredArr:filteredArr.slice(0,visibleCommentCount)},showNotifyRequester:function(){var notify=this.notify;return"undefined"===typeof notify||notify},canShowViewMore:function(){var comments=this.comments,listViewComments=this.listViewComments,visibleCommentCount=this.visibleCommentCount,isPopoverView=this.isPopoverView;return!(!comments||isPopoverView)&&(!(!(0,validation/* isEmpty */.xb)(listViewComments)&&listViewComments)&&(comments&&comments.length>visibleCommentCount))},fliterTranslateComments:function(){var filteredComments=this.filteredComments;return filteredComments.map((function(_ref){var bodyText=_ref.bodyText;return bodyText}))}},watch:{isActive:function(_isActive){!_isActive&&this.canShowAllComments&&this.showOrHideComments()},filteredComments:function(list){(0,validation/* isEmpty */.xb)(list)&&(this.$refs["commentInput"].expandTextBox=!0)},record:function(){this.loadComments()},comments:function(){this.record&&"object"===(0,esm_typeof/* default */.Z)(this.record)&&this.setNoOfNotesLength&&this.setNoOfNotesLength(this.comments.length)}},methods:{init:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,_this2.initCommentService();case 2:return _context2.next=4,_this2.initiateEventListeners();case 4:return _context2.next=6,_this2.loadComments();case 6:_this2.isPopoverView&&(_this2.canShowAllComments=!0);case 7:case"end":return _context2.stop()}}),_callee2)})))()},initCommentService:function(){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_this3.prefillCommentSharing(),_this3.setupCommentServiceData();case 2:case"end":return _context3.stop()}}),_callee3)})))()},prefillCommentSharing:function(){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){var CommentService;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:return CommentService=_this4.CommentService,_context4.next=3,CommentService.getSharingApps();case 3:CommentService.canShowSharing&&_this4.$refs["commentInput"]&&(_this4.$refs["commentInput"].commentSharing=CommentService.defaultSharingApps);case 4:case"end":return _context4.stop()}}),_callee4)})))()},setupCommentServiceData:function(){this.CommentService.module=this.module,this.CommentService.parentModule=this.parentModule,this.CommentService.record=this.record,this.CommentService.isServicePortal=this.isServicePortal,this.CommentService.forWO=this.forWO,this.CommentService.getPeopleFieldForRecord()},initiateEventListeners:function(){var _this5=this;eventBus/* eventBus */.Y.$on("woDescriptiontranslate",(function(woDescriptiontranslate){_this5.woDescriptiontranslate=woDescriptiontranslate})),eventBus/* eventBus */.Y.$on("tictketnotes_reloadlist",this.loadComments),eventBus/* eventBus */.Y.$on("shrink-comment-text-area",this.blurCommentBox)},killActiveEvents:function(){var _this6=this;eventBus/* eventBus */.Y.$off("woDescriptiontranslate",(function(){_this6.woDescriptiontranslate=!1})),eventBus/* eventBus */.Y.$on("tictketnotes_reloadlist"),eventBus/* eventBus */.Y.$off("shrink-comment-text-area")},closeAllReplyInputs:function(){eventBus/* eventBus */.Y.$emit("close-reply-text-area")},blurCommentBox:function(){this.$refs["commentInput"].expandTextBox=!1},expandNotesWidget:function(){eventBus/* eventBus */.Y.$emit("expandNotesWidget")},createHandler:function(note){this.comments.push(note)},editHandler:function(note){var comments=this.comments,existingNote=comments.find((function(r){return r.id===note.id}));if(existingNote){var index=comments.indexOf(existingNote);this.comments.splice(index,1,note)}},deleteHandler:function(note){var comments=this.comments,existingNote=comments.find((function(r){return r.id===note.id}));existingNote&&this.comments.splice(comments.indexOf(existingNote),1)},updateCommentSharing:function(comment){var comments=this.comments,CommentService=this.CommentService,existComment=comments.find((function(c){return c.id==comment.id})),commentIndex=comments.indexOf(existComment);this.$set(this.comments,commentIndex,comment);var _CommentService$updat=CommentService.updateCommentSharing(comment),error=_CommentService$updat.error;error?this.$message.error(error.message||"Error Occured"):this.$message.success("Comments have been updated")},loadComments:function(){var _this7=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee5(){var CommentService,resizeNotesWidget,_yield$CommentService,data,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context5){while(1)switch(_context5.prev=_context5.next){case 0:return CommentService=_this7.CommentService,resizeNotesWidget=_this7.resizeNotesWidget,_this7.loading=!0,_context5.next=4,CommentService.fetchComments();case 4:_yield$CommentService=_context5.sent,data=_yield$CommentService.data,error=_yield$CommentService.error,error?_this7.$message.error(error.message||"Error Occured"):_this7.comments=(0,validation/* isEmpty */.xb)(data)?[]:data,_this7.loading=!1,resizeNotesWidget();case 10:case"end":return _context5.stop()}}),_callee5)})))()},showOrHideComments:function(){var canShowAllComments=this.canShowAllComments;this.canShowAllComments=!canShowAllComments,this.resizeNotesWidget()},resizeNotesWidget:function(){var _this8=this,currentWidgetHeight=this.currentWidgetHeight,defaultWidgetHeight=this.defaultWidgetHeight;this.$nextTick((function(){if((0,validation/* isEmpty */.xb)(_this8.$refs["notes-container"]))_this8.resizeWidget({h:defaultWidgetHeight});else{var height=_this8.$refs["comment-section"].scrollHeight+80,width=_this8.$refs["notes-container"].scrollWidth;height!=currentWidgetHeight&&(0,validation/* isFunction */.mf)(_this8.resizeWidget)&&(_this8.resizeWidget({height:height,width:width}),_this8.currentWidgetHeight=height)}}))}}},widget_NewNotesvue_type_script_lang_js=NewNotesvue_type_script_lang_js,NewNotes_component=(0,componentNormalizer/* default */.Z)(widget_NewNotesvue_type_script_lang_js,render,staticRenderFns,!1,null,"2d377cb9",null)
/* harmony default export */,NewNotes=NewNotes_component.exports},
/***/188742:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"22bc1f7e3fecc069519710728d363ce9.svg";
/***/}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/19347.js.map