(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[16504],{
/***/720096:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return PreviewFile}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/PreviewFile.vue?vue&type=template&id=447c7e89
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.currentFile?_c("div",{directives:[{name:"show",rawName:"v-show",value:_vm.show,expression:"show"}],staticClass:"preview-file"},[_c("div",{staticClass:"top-toolbar"},[_c("div",{staticClass:"a-top-toolbar"},[_c("div",{staticClass:"file-name word-break-keep"},[_vm._v(" "+_vm._s(_vm.currentFile.fileName)+" ")]),_c("div",{staticClass:"top-toolbar-icon-right flex align-center"},[_vm.currentFile.contentType.includes("image")?[_c("div",{staticClass:"flex-middle pL15"},[_vm.showOriginalImage?_c("div",{staticClass:"fc-white-14 word-break-keep pointer",on:{click:_vm.showOriginalPhoto}},[_vm._v(" "+_vm._s(_vm.$t("common._common.view_original"))+" ")]):_vm._e(),_vm.showCompressedImage?_c("div",{staticClass:"fc-white-14 word-break-keep pointer",on:{click:_vm.showCompressedPhoto}},[_vm._v(" "+_vm._s(_vm.$t("common._common.view_default"))+" ")]):_vm._e()]),_c("div",{staticClass:"download-icon round flex-middle pL15",on:{click:function($event){return _vm.downloadAttachment(_vm.currentFile)}}},[_c("i",{staticClass:"el-icon-download op8",staticStyle:{color:"#ffff"}})])]:_vm._e(),_vm.currentFile.contentType.includes("pdf")?[_c("div",{staticClass:"download-icon round flex-middle pL15",on:{click:function($event){return _vm.downloadAttachment(_vm.currentFile)}}},[_c("i",{staticClass:"el-icon-download op8",staticStyle:{color:"#ffff"}})])]:_vm._e(),_vm.showDeleteOption()?_c("div",{staticClass:"flex-middle pL15",on:{click:function($event){return _vm.deletePreview()}}},[_c("inline-svg",{staticClass:"pointer edit-icon-color close vertical-text-top",attrs:{src:"svgs/delete",iconClass:"icon icon-md"}})],1):_vm._e(),_c("div",{staticClass:"pL15"},[_c("i",{staticClass:"el-icon-close close",on:{click:_vm.closePreview}})])],2)])]),_vm.currentFileIndex>0?_c("a",{staticClass:"el-icon-arrow-left prev",staticStyle:{"font-size":"30px"},on:{click:function($event){return _vm.plusSlides(-1)}}}):_vm._e(),_vm.currentFileIndex<_vm.files.length-1?_c("a",{staticClass:"el-icon-arrow-right next",staticStyle:{"font-size":"30px"},on:{click:function($event){return _vm.plusSlides(1)}}}):_vm._e(),_c("div",{staticClass:"preview-content"},[_vm.currentFile.contentType.includes("image")?[_vm.compressedImage?_c("img",{staticClass:"content",staticStyle:{"box-shadow":"none"},attrs:{src:_vm.$prependBaseUrl(_vm.currentFile.previewUrl)}}):_vm.originalImage?_c("img",{staticClass:"content original",staticStyle:{"box-shadow":"none"},attrs:{src:_vm.$prependBaseUrl(_vm.currentFile.previewUrl+"?fetchOriginal=true")}}):_vm._e()]:_vm.currentFile.contentType.includes("pdf")?_c("div",{staticClass:"width100 height-100"},[_c("iframe",{staticClass:"fc-preview-pdf",attrs:{src:_vm.$prependBaseUrl(_vm.currentFile.previewUrl),height:"100%",width:"100%"}})]):_vm.isVideoSupported(_vm.currentFile.contentType)?_c("div",{staticClass:"width100 height-100 fc-preview-video"},[_c("video",{attrs:{controls:""}},[_c("source",{attrs:{src:_vm.$prependBaseUrl(_vm.$getProperty(_vm.currentFile,"downloadUrl",null)),type:_vm.$getProperty(_vm.currentFile,"contentType")}}),_vm._v(" "+_vm._s(_vm.$t("common._common.browser_not_supported"))+" ")])]):_c("div",{staticClass:"no-preview"},[_c("div",{staticClass:"flex justify-center pT24"},[_c("inline-svg",{staticClass:"d-flex",attrs:{src:_vm.getFileIcon(_vm.currentFile),iconClass:"icon icon-60 overlay"}})],1),_c("div",{staticClass:"f14 pT12 pB12"},[_vm._v("No preview available")]),_c("div",{staticClass:"download-button"},[_c("a",{staticClass:"flex flex-row",staticStyle:{color:"#ffff"},on:{click:function($event){return _vm.downloadAttachment(_vm.currentFile)}}},[_c("div",[_vm._v("Download")])])])])],2),_vm.exportDownloadUrl?_c("iframe",{staticStyle:{display:"none"},attrs:{src:_vm.exportDownloadUrl}}):_vm._e()]):_vm._e()},staticRenderFns=[],validation=(__webpack_require__(339772),__webpack_require__(260228),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(228436),__webpack_require__(990260)),PreviewFilevue_type_script_lang_js={props:["previewFile","files","visibility","showDelete","isLockedState","isTaskClosed"],data:function(){return{show:!0,previewUrl:null,currentFileIndex:0,currentFile:null,imageMargin:null,exportDownloadUrl:null,originalImage:!1,compressedImage:!0,showOriginalImage:!0,showCompressedImage:!1}},destroyed:function(){window.removeEventListener("keyup",this.handler)},mounted:function(){window.addEventListener("keyup",this.handler),this.preloadImages()},watch:{},computed:{},methods:{handler:function(){
// If escape key is pressed...
27===event.keyCode?this.closePreview():37===event.keyCode?this.plusSlides(-1):39===event.keyCode&&this.plusSlides(1)},preloadImages:function(){this.currentFile=this.previewFile?this.previewFile:this.files[0],this.currentFileIndex=this.files.indexOf(this.currentFile)},plusSlides:function(n){var index=this.currentFileIndex+n;index<0&&(index=0),index>=this.files.length&&(index=this.files.length-1),this.currentFileIndex=index,this.currentFile=this.files[index]},closePreview:function(){this.$emit("update:visibility",!1)},deletePreview:function(){var currentFile=this.currentFile;this.$emit("onDelete",currentFile)},downloadAttachment:function(file){var _this=this,_ref=file||{},url=_ref.downloadUrl;this.exportDownloadUrl&&(this.exportDownloadUrl=null),this.$nextTick((function(){_this.exportDownloadUrl=url}))},showOriginalPhoto:function(){this.originalImage=!0,this.showCompressedImage=!0,this.showOriginalImage=!1,this.compressedImage=!1},showCompressedPhoto:function(){this.showCompressedImage=!1,this.originalImage=!1,this.showOriginalImage=!0,this.compressedImage=!0},getFileIcon:function(attachment){var contentType=attachment.contentType,FILE_TYPE_ICONS=this.$constants.FILE_TYPE_ICONS,selectedIndex=FILE_TYPE_ICONS.findIndex((function(icons){var fileTypes=icons.fileTypes;return fileTypes.some((function(type){return contentType.includes(type)}))}));return(0,validation/* isEmpty */.xb)(selectedIndex)?FILE_TYPE_ICONS[0].path:FILE_TYPE_ICONS[selectedIndex].path},isVideoSupported:function(contentType){contentType=contentType||"";var supportedTypes=["video/webm","video/mp4","video/ogg"];return supportedTypes.includes(contentType.trim().toLowerCase())},showDeleteOption:function(){var showDelete=this.showDelete,isLockedState=this.isLockedState,isTaskClosed=this.isTaskClosed;return showDelete&&!isLockedState&&!isTaskClosed}}},components_PreviewFilevue_type_script_lang_js=PreviewFilevue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_PreviewFilevue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,PreviewFile=component.exports},
/***/929593:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FPagination}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/list/FPagination.vue?vue&type=template&id=7641710c&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_vm.total>0?_c("div",{staticClass:"flex-center-row-space mT-5",class:{"fc-black-small-txt-12":!_vm.hideToggle}},[_c("el-popover",{attrs:{placement:"bottom",trigger:"click",disabled:_vm.disablePopup}},[_c("span",{staticClass:"p8 pointer",class:[!_vm.disablePopup&&"button-hover"],attrs:{slot:"reference"},slot:"reference"},[_vm.from!==_vm.to?_c("span",[_vm._v(_vm._s(_vm.from)+" - ")]):_vm._e(),_c("span",[_vm._v(_vm._s(_vm.to))]),_vm._v(" of "+_vm._s(_vm.total)+" ")]),_c("el-pagination",{attrs:{layout:"prev, pager, next",total:_vm.total,"pager-count":5,"page-size":_vm.perPage,"current-page":_vm.page},on:{"current-change":_vm.handleCurrentChange,"update:pageSize":function($event){_vm.perPage=$event},"update:page-size":function($event){_vm.perPage=$event},"update:currentPage":function($event){_vm.page=$event},"update:current-page":function($event){_vm.page=$event}}})],1),_vm.hideToggle?_vm._e():_c("span",[_c("span",{staticClass:"el-icon-arrow-left pagination-arrow fc-black-small-txt-12 f16 fw-bold pointer p5",class:{disable:_vm.from<=1},on:{click:function($event){_vm.from>1&&_vm.prev()}}}),_c("span",{staticClass:"el-icon-arrow-right pagination-arrow fc-black-small-txt-12 f16 fw-bold pointer p5",class:{disable:_vm.to===_vm.total},on:{click:function($event){_vm.to!==_vm.total&&_vm.next()}}})])],1):_vm._e()])},staticRenderFns=[],router=(__webpack_require__(879288),__webpack_require__(670560),__webpack_require__(329435)),FPaginationvue_type_script_lang_js={props:{total:[Number,String],perPage:Number,hideToggle:{type:Boolean,default:!1},pageNo:Number,hidePopover:{type:Boolean,default:!1}},data:function(){return{from:0,to:0,page:1}},created:function(){(0,router/* isWebTabsEnabled */.tj)()&&document.addEventListener("keydown",this.keyDownHandler)},mounted:function(){this.init()},beforeDestroy:function(){(0,router/* isWebTabsEnabled */.tj)()&&document.removeEventListener("keydown",this.keyDownHandler)},computed:{pageQuery:function(){var _ref=this.$route||{},query=_ref.query,_ref2=query||{},page=_ref2.page;return parseInt(page)||1},hasMorePage:function(){return this.total/this.perPage>1},disablePopup:function(){return this.hidePopover||!this.hasMorePage}},watch:{total:function(){this.init()},pageQuery:function(){this.init()}},methods:{init:function(){if(this.page=this.pageQuery,this.from=(this.page-1)*this.perPage+1,this.from>this.total&&this.from&&this.from>0&&this.total&&this.total>0)this.reset();else{var to=this.from+this.perPage-1;this.to=this.total>to?to:this.total}},handleCurrentChange:function(val){this.page=val,this.from=(this.page-1)*this.perPage+1,this.to=this.total>=this.from+this.perPage?this.from+this.perPage-1:this.total,this.setPage()},next:function(){this.from=this.to+1,this.to+=this.perPage,this.to>this.total&&(this.to=this.total),this.page++,this.setPage()},prev:function(){this.to=this.from-1,this.from-=this.perPage,this.from<=1?this.from=this.page=1:this.page--,this.setPage()},reset:function(){this.page=1,this.setPage(!0)},setPage:function(isReset){if(this.pageNo)this.$emit("onPageChanged",this.page);else{var query={};Object.assign(query,this.$route.query),query?query.page=this.page:query={page:this.page},this.$router.push({query:query}),isReset||this.$emit("onPageChanged",this.page)}},keyDownHandler:function(e){e.shiftKey&&("ArrowRight"===e.key&&this.to!==this.total?this.next():"ArrowLeft"===e.key&&this.from>1&&this.prev())}}},list_FPaginationvue_type_script_lang_js=FPaginationvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(list_FPaginationvue_type_script_lang_js,render,staticRenderFns,!1,null,"7641710c",null)
/* harmony default export */,FPagination=component.exports},
/***/418672:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return InventoryIssueUse}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/workorder/workorders/v1/InventoryIssueUse.vue?vue&type=template&id=47035aee
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("div",[_c("el-dialog",{attrs:{"before-close":_vm.cancelItemsDialog,visible:_vm.visibility,fullscreen:!1,width:"60%",open:"top","custom-class":"fc-dialog-up Inventoryaddvaluedialog","append-to-body":!0},on:{"update:visible":function($event){_vm.visibility=$event}}},[_c("div",[_c("div",{staticClass:"new-header-container popup-container-new"},[_c("div",{staticClass:"fc-setup-modal-title"},[_vm._v(" "+_vm._s(_vm.$t("common.products.issued_inventory_list"))+" ")]),_c("div",{staticClass:"store-room-bar",class:{active:!_vm.hideQuery}},[_c("el-select",{staticClass:"fc-tag mL20 fc-input-full-border-select2",attrs:{multiple:"","collapse-tags":"",placeholder:_vm.$t("common.products.select_storeroom")},model:{value:_vm.selectedStoreList,callback:function($$v){_vm.selectedStoreList=$$v},expression:"selectedStoreList"}},_vm._l(_vm.tempStoreList,(function(item,index){return _c("el-option",{key:index,attrs:{label:item.name,value:item.id}})})),1)],1),_c("div",{staticClass:"search-bar",class:{active:_vm.hideQuery}},[_vm.hideQuery?_c("i",{staticClass:"el-input__icon el-icon-search inventory-table-search-bar",attrs:{slot:"suffix"},on:{click:function($event){_vm.hideQuery=!1}},slot:"suffix"}):_c("el-input",{staticClass:"el-input-textbox-full-border",attrs:{autofocus:!0,type:"text",placeholder:_vm.$t("common._common.to_search_type")},on:{blur:function($event){_vm.hideQuery=!0}},model:{value:_vm.itemSearchQuery,callback:function($$v){_vm.itemSearchQuery=$$v},expression:"itemSearchQuery"}},[_c("span",{staticClass:"sub-divider"},[_vm._v("|")]),_c("i",{staticClass:"el-input__icon el-icon-search pointer inventory-table-search-bar",attrs:{slot:"suffix"},slot:"suffix"})])],1)]),_c("div",{staticClass:"height400"},[_vm.newIRIssueItem?_c("div",[_c("el-table",{directives:[{name:"loading",rawName:"v-loading",value:_vm.itemLoading,expression:"itemLoading"}],ref:"table1",staticClass:"inventory-inner-table width100",attrs:{data:_vm.itemTransactionsTableList,height:"350","empty-text":_vm.$t("common.products.no_issued_items"),"default-sort":{prop:"item.itemType.name",order:"descending"}},on:{"selection-change":_vm.selectItemActions}},[_c("el-table-column",{attrs:{width:"60",type:"selection"}}),_c("el-table-column",{attrs:{prop:"item.itemType.name",sortable:"",width:"170",label:_vm.$t("common.header._item")}}),_c("el-table-column",{attrs:{prop:"item.storeRoom.name",sortable:"",width:"170",label:_vm.$t("common.products.storeroom")}}),_c("el-table-column",{attrs:{prop:"remainingQuantity",sortable:"",width:"200",label:_vm.$t("common.wo_report.remaining_qty")}}),_c("el-table-column",{attrs:{prop:"asset.serialNumber",sortable:"",width:"130",label:"S NO"}}),_c("el-table-column",{attrs:{label:_vm.$t("common.products.issue_qty"),width:"180"},scopedSlots:_vm._u([{key:"default",fn:function(issuedItem){return[_c("div",[_c("el-input",{ref:"quantityElInput",staticClass:"fc-input-full-border-select2",attrs:{placeholder:_vm.$t("common._common.quantity"),min:1,disabled:issuedItem.row.item.itemType.isRotating,type:"number"},model:{value:issuedItem.row.updateQuantity,callback:function($$v){_vm.$set(issuedItem.row,"updateQuantity",$$v)},expression:"issuedItem.row.updateQuantity"}})],1)]}}],null,!1,844767329)})],1)],1):_vm._e(),_vm.newIRIssueTool?_c("div",[_c("el-table",{directives:[{name:"loading",rawName:"v-loading",value:_vm.toolLoading,expression:"toolLoading"}],ref:"table2",staticClass:"inventory-inner-table width100",attrs:{data:_vm.toolTransactionsTableList,height:"350","empty-text":_vm.$t("common.products.no_issued_tools"),"default-sort":{prop:"tool.toolType.name",order:"descending"}},on:{"selection-change":_vm.selectToolActions}},[_c("el-table-column",{attrs:{width:"60",type:"selection"}}),_c("el-table-column",{attrs:{prop:"tool.toolType.name",sortable:"",width:"170",label:_vm.$t("common.header._tool")}}),_c("el-table-column",{attrs:{prop:"tool.storeRoom.name",sortable:"",width:"170",label:_vm.$t("common.products.storeroom")}}),_c("el-table-column",{attrs:{prop:"remainingQuantity",sortable:"",width:"200",label:_vm.$t("common.wo_report.remaining_qty")}}),_c("el-table-column",{attrs:{prop:"asset.serialNumber",sortable:"",width:"130",label:_vm.$t("common.header.s_no")}}),_c("el-table-column",{attrs:{label:"ISSUE QTY"},scopedSlots:_vm._u([{key:"default",fn:function(issuedTool){return[_c("div",[_c("el-input",{ref:"quantityElInput",staticClass:"fc-input-full-border-select2",attrs:{placeholder:_vm.$t("common._common.quantity"),min:1,disabled:issuedTool.row.tool.toolType.isRotating,type:"number"},model:{value:issuedTool.row.updateQuantity,callback:function($$v){_vm.$set(issuedTool.row,"updateQuantity",$$v)},expression:"issuedTool.row.updateQuantity"}})],1)]}}],null,!1,1039748108)})],1)],1):_vm._e()]),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){return _vm.cancelItemsDialog()}}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_vm.newIRIssueItem?_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.saveLoading},on:{click:function($event){return _vm.addSelectedItemTransactions()}}},[_vm._v(_vm._s(_vm.$t("common._common._add")))]):_vm._e(),_vm.newIRIssueTool?_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.saveLoading},on:{click:function($event){return _vm.addSelectedToolTransactions()}}},[_vm._v(_vm._s(_vm.$t("common._common._add")))]):_vm._e()],1)])])],1)])},staticRenderFns=[],createForOfIteratorHelper=__webpack_require__(566347),toConsumableArray=__webpack_require__(488478),InventoryIssueUsevue_type_script_lang_js=(__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(339772),__webpack_require__(434284),__webpack_require__(648324),__webpack_require__(634338),__webpack_require__(919649),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(450886),__webpack_require__(670560),__webpack_require__(947522),{props:["visibility","workorder","woItemsList","woToolsList","newIRIssueItem","newIRIssueTool"],data:function(){return{rotatingItemList:[],itemSearchQuery:null,hideQuery:!0,issuedItemsList:[],selectedItem:null,itemLoading:!1,iTloading:!1,selectedStoreList:[],tempStoreList:[],saveLoading:!1,selectedLineItems:[],itemTransactionsList:[],selectedItemsTransactions:[],toolTransactionsList:[],selectedToolsTransactions:[],toolLoading:!1}},mounted:function(){this.newIRIssueItem?this.loadItemTransactions():this.newIRIssueTool&&this.loadToolTransactions()},computed:{rotatingItemTableList:function(){var list=this.rotatingItemList;if(this.itemSearchQuery){var self=this;return list.filter((function(data){if(data.serialNumber.toLowerCase().indexOf(self.itemSearchQuery.toLowerCase())>-1)return data}))}return list},issuedItemsTableList:function(){var list=[];list=this.issuedItemsList;var self=this;if(this.selectedStoreList.length&&(list=list.filter((function(rt){if(self.selectedStoreList.findIndex((function(rl){return rl===rt.storeRoom.id}))>-1)return rt}))),this.itemSearchQuery){var _self=this;return list.filter((function(data){if(1===data.inventoryType&&data.itemType.name.toLowerCase().indexOf(_self.itemSearchQuery.toLowerCase())>-1||2===data.inventoryType&&data.toolType.name.toLowerCase().indexOf(_self.itemSearchQuery.toLowerCase())>-1||data.storeRoom.name.toLowerCase().indexOf(_self.itemSearchQuery.toLowerCase())>-1||0===JSON.stringify(data.tempQuantity).toLowerCase().indexOf(_self.itemSearchQuery.toLowerCase())||data.asset&&data.asset.serialNumber.toLowerCase().indexOf(_self.itemSearchQuery.toLowerCase())>-1)return data}))}return list},itemTransactionsTableList:function(){var _this=this,list=[];return list=this.itemTransactionsList,this.selectedStoreList.length&&(list=list.filter((function(rt){if(_this.selectedStoreList.findIndex((function(rl){return rl===rt.item.storeRoom.id}))>-1)return rt}))),this.itemSearchQuery?list.filter((function(data){if(data.item.itemType.name.toLowerCase().indexOf(_this.itemSearchQuery.toLowerCase())>-1||data.item.storeRoom.name.toLowerCase().indexOf(_this.itemSearchQuery.toLowerCase())>-1||0===JSON.stringify(data.updateQuantity).toLowerCase().indexOf(_this.itemSearchQuery.toLowerCase())||data.asset&&data.asset.serialNumber.toLowerCase().indexOf(_this.itemSearchQuery.toLowerCase())>-1)return data})):list},toolTransactionsTableList:function(){var _this2=this,list=[];return list=this.toolTransactionsList,this.selectedStoreList.length&&(list=list.filter((function(rt){if(_this2.selectedStoreList.findIndex((function(rl){return rl===rt.tool.storeRoom.id}))>-1)return rt}))),this.itemSearchQuery?list.filter((function(data){if(data.tool.toolType.name.toLowerCase().indexOf(_this2.itemSearchQuery.toLowerCase())>-1||data.tool.storeRoom.name.toLowerCase().indexOf(_this2.itemSearchQuery.toLowerCase())>-1||0===JSON.stringify(data.updateQuantity).toLowerCase().indexOf(_this2.itemSearchQuery.toLowerCase())||data.asset&&data.asset.serialNumber.toLowerCase().indexOf(_this2.itemSearchQuery.toLowerCase())>-1)return data})):list}},methods:{loadIssuedItemsList:function(){var self=this,param={status:6,parentId:this.workorder.id};this.itemLoading=!0;var workOrderInventoryList=[].concat((0,toConsumableArray/* default */.Z)(this.woItemsList),(0,toConsumableArray/* default */.Z)(this.woToolsList)),reqLineItemList=workOrderInventoryList.filter((function(i){if(i.requestedLineItem&&i.requestedLineItem.id)return!0})),reqLineItemId=new Set(reqLineItemList.map((function(i){return i.requestedLineItem.id})));this.$http.post("/v2/inventoryrequest/lineItemListByParentId",param).then((function(r){var woLineItemsList,param2={status:6,requesterId:self.$store.state.account.user.id};0===r.data.responseCode&&(woLineItemsList=r.data.result.inventoryrequestlineitems),self.$http.post("/v2/inventoryrequest/lineItemListByRequesterId",param2).then((function(response){if(0===response.data.responseCode){var reqItemsList=response.data.result.inventoryrequestlineitems,ids=new Set(woLineItemsList.map((function(d){return d.id})));self.issuedItemsList=[].concat((0,toConsumableArray/* default */.Z)(woLineItemsList),(0,toConsumableArray/* default */.Z)(reqItemsList.filter((function(d){return!ids.has(d.id)})))),self.issuedItemsList=self.issuedItemsList.filter((function(i){return!reqLineItemId.has(i.id)})),self.issuedItemsList=self.issuedItemsList.filter((function(i){return 1!==i.inventoryType||i.issuedQuantity-i.usedQuantity>0}));var _step,_iterator=(0,createForOfIteratorHelper/* default */.Z)(self.issuedItemsList);try{var _loop=function(){var item=_step.value;self.$set(item,"checked",!1),self.$set(item,"tempQuantity",item.asset?1:1===item.inventoryType?item.issuedQuantity-item.usedQuantity:item.issuedQuantity),item.storeRoom&&self.tempStoreList.findIndex((function(rt){return rt.id===item.storeRoom.id}))<0&&self.tempStoreList.push(item.storeRoom)};for(_iterator.s();!(_step=_iterator.n()).done;)_loop()}catch(err){_iterator.e(err)}finally{_iterator.f()}}self.itemLoading=!1}))})).catch((function(error){}))},selectItemActions:function(val){this.selectedItemsTransactions=val},loadItemTransactions:function(){var self=this;self.itemLoading=!0;var workOrderItemList=this.woItemsList.filter((function(i){if(-1!==i.parentTransactionId)return!0})),parentTransactionIdList=new Set(workOrderItemList.map((function(i){return i.parentTransactionId})));this.$http.get("/v2/itemTransactions/view/showItemTransactionListForIssue?showItemsForIssue=true").then((function(response){self.itemLoading=!1,self.itemTransactionsList=response.data.result.itemTransactions||[],self.itemTransactionsList=self.itemTransactionsList.filter((function(i){return!parentTransactionIdList.has(i.id)}));var _step2,_iterator2=(0,createForOfIteratorHelper/* default */.Z)(self.itemTransactionsList);try{var _loop2=function(){var item=_step2.value;self.$set(item,"updateQuantity",item.remainingQuantity),item.item.storeRoom&&self.tempStoreList.findIndex((function(rt){return rt.id===item.item.storeRoom.id}))<0&&self.tempStoreList.push(item.item.storeRoom)};for(_iterator2.s();!(_step2=_iterator2.n()).done;)_loop2()}catch(err){_iterator2.e(err)}finally{_iterator2.f()}})).catch((function(error){error&&(self.itemLoading=!1)}))},addSelectedItemTransactions:function(){var _this3=this,param={workorderItems:[]},obj={};if(0!==this.selectedItemsTransactions.length){this.selectedItemsTransactions.forEach((function(item,index){if(obj={},item.itemType.isRotating){var assetIds=[];assetIds.push(item.asset.id),obj={parentId:_this3.workorder.id,item:{id:item.item.id},quantity:1,assetIds:assetIds,parentTransactionId:item.id,remainingQuantity:item.remainingQuantity,requestedLineItem:item.requestedLineItem?item.requestedLineItem:null},param.workorderItems.push(obj)}else obj={parentId:_this3.workorder.id,item:{id:item.item.id},quantity:item.updateQuantity,assetIds:null,parentTransactionId:item.id,remainingQuantity:item.remainingQuantity,requestedLineItem:item.requestedLineItem?item.requestedLineItem:null},param.workorderItems.push(obj)})),this.saveLoading=!0;var self=this;this.$http.post("/v2/workorderItems/addOrUpdate",param).then((function(response){0!==response.data.responseCode?(self.$message.error(response.data.message),self.saveLoading=!1):(self.$message.success(_this3.$t("common.products.items_added_successfully")),self.$emit("update:visibility",!1),self.$emit("refreshItemList"),_this3.$emit("refresh-item-list"),self.saveLoading=!1)})).catch((function(error){self.saveLoading=!1}))}else this.$message.error(this.$t("common.header.kindly_select_items_to_add"))},selectToolActions:function(val){this.selectedToolsTransactions=val},loadToolTransactions:function(){var self=this;self.toolLoading=!0;var workOrderToolList=this.woToolsList.filter((function(i){if(-1!==i.parentTransactionId)return!0})),parentTransactionIdList=new Set(workOrderToolList.map((function(i){return i.parentTransactionId})));this.$http.get("/v2/toolTransactions/view/showToolTransactionListForIssue?showToolsForIssue=true").then((function(response){self.toolLoading=!1,self.toolTransactionsList=response.data.result.toolTransactions||[],self.toolTransactionsList=self.toolTransactionsList.filter((function(i){return!parentTransactionIdList.has(i.id)}));var _step3,_iterator3=(0,createForOfIteratorHelper/* default */.Z)(self.toolTransactionsList);try{var _loop3=function(){var tool=_step3.value;self.$set(tool,"updateQuantity",tool.remainingQuantity),tool.tool.storeRoom&&self.tempStoreList.findIndex((function(rt){return rt.id===tool.tool.storeRoom.id}))<0&&self.tempStoreList.push(tool.tool.storeRoom)};for(_iterator3.s();!(_step3=_iterator3.n()).done;)_loop3()}catch(err){_iterator3.e(err)}finally{_iterator3.f()}})).catch((function(error){error&&(self.toolLoading=!1)}))},addSelectedToolTransactions:function(){var _this4=this,self=this,param={workorderToolsList:[]},obj={};0!==this.selectedToolsTransactions.length?(this.selectedToolsTransactions.forEach((function(item,index){if(obj={},item.toolType.isRotating){var assetIds=[];assetIds.push(item.asset.id),obj={parentId:_this4.workorder.id,tool:{id:item.tool.id},quantity:1,duration:36e5,assetIds:assetIds,parentTransactionId:item.id,requestedLineItem:item.requestedLineItem?item.requestedLineItem:null},param.workorderToolsList.push(obj)}else obj={parentId:_this4.workorder.id,tool:{id:item.tool.id},quantity:item.updateQuantity,duration:36e5,assetIds:null,parentTransactionId:item.id,requestedLineItem:item.requestedLineItem?item.requestedLineItem:null},param.workorderToolsList.push(obj)})),self.saveLoading=!0,this.$http.post("/v2/workorderTools/addOrUpdate",param).then((function(response){0!==response.data.responseCode?(self.$message.error(response.data.message),self.saveLoading=!1):(self.$message.success(_this4.$t("common.products.tools_added_successfully")),self.$emit("update:visibility",!1),self.$emit("refreshToolList"),_this4.$emit("refresh-tool-list"),self.saveLoading=!1)})).catch((function(error){self.saveLoading=!1}))):this.$message.error(this.$t("common.header.kindly_select_tools_to_add"))},cancelItemsDialog:function(){this.$emit("update:visibility",!1),this.selectedItem=null},toggleSelection:function(selected){this.selectedLineItems=selected},addSelectedItem:function(){var _this5=this,param={inventoryType:1,lineItems:[]},param2={inventoryType:2,lineItems:[]},obj={};
// Temp fix Should be changed to single API .. Has Bug
this.selectedLineItems.forEach((function(item,index){obj={},[],1===item.inventoryType?item.itemType.isRotating?(item.assetIds=[item.asset],[item.asset],item.parentId=_this5.workorder.id,obj={parentId:_this5.workorder.id,id:item.id,itemType:{id:item.itemType.id},storeRoom:item.storeRoom,inventoryRequestId:item.inventoryRequestId,quantity:1,asset:item.asset,inventoryType:1},param.lineItems.push(obj)):item.tempQuantity>0&&(item.assetIds=[item.asset],[item.asset],item.parentId=_this5.workorder.id,obj={parentId:_this5.workorder.id,id:item.id,itemType:{id:item.itemType.id},storeRoom:item.storeRoom,inventoryRequestId:item.inventoryRequestId,quantity:item.tempQuantity,inventoryType:1},param.lineItems.push(obj)):2===item.inventoryType&&(item.toolType.isRotating?([item.asset],obj={parentId:_this5.workorder.id,id:item.id,toolType:{id:item.toolType.id},storeRoom:item.storeRoom,inventoryRequestId:item.inventoryRequestId,quantity:1,asset:item.asset,inventoryType:2},param2.lineItems.push(obj)):item.tempQuantity>0&&(obj={parentId:_this5.workorder.id,id:item.id,toolType:{id:item.toolType.id},storeRoom:item.storeRoom,inventoryRequestId:item.inventoryRequestId,quantity:item.tempQuantity,inventoryType:2},param2.lineItems.push(obj)))}));var self=this;this.saveLoading=!0;var successCount=0,callCount=0;param.lineItems.length&&(callCount++,this.$http.post("/v2/inventoryrequest/useLineItems",param).then((function(response){0===response.data.responseCode?(self.$message.success(_this5.$t("common.products.items_added_successfully")),self.$emit("refreshItemList"),successCount++,callCount===successCount&&self.$emit("update:visibility",!1)):self.$message.error(response.data.message),self.saveLoading=!1})).catch((function(error){}))),param2.lineItems.length&&(callCount++,this.$http.post("/v2/inventoryrequest/useLineItems",param2).then((function(response){0===response.data.responseCode?(self.$message.success(_this5.$t("common.products.tools_added_successfully")),self.$emit("refreshToolList"),successCount++,callCount===successCount&&self.$emit("update:visibility",!1)):self.$message.error(response.data.message),self.saveLoading=!1})).catch((function(error){})))}}}),v1_InventoryIssueUsevue_type_script_lang_js=InventoryIssueUsevue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(v1_InventoryIssueUsevue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,InventoryIssueUse=component.exports},
/***/926460:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return InventoryPagination}});
// EXTERNAL MODULE: ./src/components/list/FPagination.vue + 7 modules
var render,staticRenderFns,FPagination=__webpack_require__(929593),InventoryPaginationvue_type_script_lang_js={name:"InventoryPagination",extends:FPagination/* default */.Z,methods:{setPage:function(isReset){this.pageNo?this.$emit("onPageChanged",this.page):isReset||this.$emit("onPageChanged",this.page)}}},widgets_InventoryPaginationvue_type_script_lang_js=InventoryPaginationvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(widgets_InventoryPaginationvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,InventoryPagination=component.exports},
/***/446816:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return InventoryTools}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/workorder/workorders/v3/widgets/InventoryTools.vue?vue&type=template&id=dee80efa&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"p30 white-bg-block mB100"},[_c("div",{staticClass:"flex-middle justify-content-space"},[_c("div",{staticClass:"inline-flex"},[_c("div",{staticClass:"fc-v1-icon-bg"},[_c("InlineSvg",{attrs:{src:"svgs/settings3",iconClass:"icon icon-md stroke-white"}})],1),_c("div",{staticClass:"fc-black3-16 mL10 mT12"},[_vm._v(" "+_vm._s(_vm.$t("common.header.tools"))+" ")])])]),_c("div",{ref:"inventoryToolsWidget",staticClass:"inventory-table inventory-tool-table inventory-table-body-border-none overflow-x mT20",staticStyle:{border:"1px solid #eceef1"}},[_vm.toolLoading?_c("table",{staticClass:"width100",staticStyle:{border:"none"}},[_c("tr",[_c("td",{attrs:{colspan:"100%"}},[_c("div",{staticClass:"iTloading in-no-data"},[_c("spinner",{attrs:{show:!0,size:"80"}})],1)])])]):_c("table",{staticClass:"width100",staticStyle:{border:"none"}},[_c("thead",[_c("tr",{staticClass:"border-top-none"},[_c("th",{staticClass:"border-top-none tool-header-sticky",staticStyle:{width:"300px"}},[_vm._v(" "+_vm._s(_vm.$t("common.header._tool"))+" ")]),_c("th",{staticClass:"pR0 border-top-none"},[_vm._v(" "+_vm._s(_vm.$t("common._common._quantity"))+" ")]),_c("th",{staticClass:"text-right width110px border-top-none"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report._start_time"))+" ")]),_c("th",{staticClass:"text-right width110px pL20 border-top-none"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report._end_time"))+" ")]),_c("th",{staticClass:"text-right width130px border-top-none"},[_vm._v(" "+_vm._s(_vm.$t("common._common.duration_hr"))+" ")]),_c("th",{staticClass:"text-right border-top-none width130px pR20 pL20"},[_vm._v(" "+_vm._s(_vm.$t("common.header.rate_hr"))+" ")]),_c("th",{staticClass:"text-right worktool-cost-sticky border-top-none"},[_vm._v(" "+_vm._s(_vm.$t("common.tabs._cost"))+" ")]),_c("th",{staticClass:"width40px worktool-cost-edit-sticky border-top-none"})])]),_vm.workorderToolsList.length?_c("tbody",[_vm._l(_vm.workorderToolsList,(function(workTool,index){return[2===workTool.approvedState?_c("tr",{key:workTool.id,staticClass:"borderB1px border-color11 visibility-visible-actions pointer"},[_c("td",{staticClass:"pT10 pB10 tool-header-sticky"},[_c("div",{staticClass:"pL17",staticStyle:{width:"180px"}},[workTool.tool.toolType.isRotating&&workTool.purchasedTool?_c("div",{staticClass:"fc-id",staticStyle:{"padding-bottom":"4px"}},[_vm._v(" #"+_vm._s(workTool.purchasedTool.serialNumber)+" ")]):_vm._e(),_c("div",[_vm._v(_vm._s(workTool.tool.toolType.name))])])]),_c("td",{staticClass:"pT10 pB10"},[_c("div",{staticClass:"in-Quantity"},[workTool.tool.toolType.isRotating?_c("div",{staticClass:"item"},[_c("div",{staticClass:"workItem-quantity"},[_vm._v(" "+_vm._s(workTool.quantity)+" ")])]):_c("el-tooltip",{staticClass:"item text-center quant",class:{exceeded:_vm.getToolQuantityState(workTool)},attrs:{effect:"dark",content:_vm.actionRule?_vm.$t("common.products.available_tools")+" "+_vm.getToolCount(workTool):_vm.$t("common.header.please_open_the_workorder"),placement:"right-end"}},[[_c("el-form",{ref:"numberValidateForm",refInFor:!0,staticClass:"width50px inventory-input-width",class:{exceeded:_vm.getToolQuantityState(workTool)},attrs:{model:workTool},nativeOn:{submit:function($event){return $event.preventDefault(),_vm.checkEnter.apply(null,arguments)}}},[_c("el-form-item",{attrs:{label:"",prop:"quantity"}},[_c("el-input",{staticClass:"fc-input-full-border2 width50px inventory-input-width text-right pL20",attrs:{placeholder:"",type:"number",disabled:!_vm.actionRule},on:{change:function($event){return _vm.changeWorkToolField(workTool,index)}},model:{value:workTool.quantity,callback:function($$v){_vm.$set(workTool,"quantity",$$v)},expression:"workTool.quantity"}})],1)],1)]],2)],1)]),_c("td",{staticClass:"pT10 pB10"},[_c("div",{staticClass:"in-Quantity pL0 width110px"},[_c("div",{staticClass:"fc-black-13 text-right"},[_vm._v(" "+_vm._s(_vm.formatTime(Number(workTool.issueTime),"hh:mm a",!1))+" ")]),_c("div",{staticClass:"fc-grey2-text12 text-right"},[_c("el-date-picker",{staticClass:"fc-input-border-remove inventory-date-picker pL40 fc-grey2-text12",attrs:{format:"dd-MM-yyyy hh:mm a","value-format":"timestamp",type:"datetime",disabled:!_vm.actionRule,placeholder:"Start time","default-time":["12:00:00"]},on:{change:function($event){return _vm.changeWorkToolField(workTool,index,!1,1)}},model:{value:workTool.issueTime,callback:function($$v){_vm.$set(workTool,"issueTime",$$v)},expression:"workTool.issueTime"}})],1)])]),_c("td",{staticClass:"pT10 pB10 pL20"},[_c("div",{staticClass:"in-Quantity width110px"},[_c("div",{staticClass:"fc-black-13 text-right"},[_vm._v(" "+_vm._s(_vm.formatTime(Number(workTool.returnTime),"hh:mm a",!1))+" ")]),_c("div",{staticClass:"fc-grey2-text12 text-right"},[_c("el-date-picker",{staticClass:"fc-input-border-remove inventory-date-picker pL40 fc-grey2-text12",attrs:{format:"dd-MM-yyyy hh:mm a","value-format":"timestamp",type:"datetime",disabled:!_vm.actionRule,placeholder:_vm.$t("common.wo_report.end_time"),"picker-options":{disabledDate:function(time){return time.getTime()<workTool.issueTime}}},on:{change:function($event){return _vm.changeWorkToolField(workTool,index,!1,2)}},model:{value:workTool.returnTime,callback:function($$v){_vm.$set(workTool,"returnTime",$$v)},expression:"workTool.returnTime"}})],1)])]),_c("td",{staticClass:"pT10 pB10"},[_c("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"top",arrow:!0,animation:"shift-away"},expression:"{\n                  placement: 'top',\n                  arrow: true,\n                  animation: 'shift-away',\n                }"}],staticClass:"in-Quantity",staticStyle:{width:"70%","text-align":"right",float:"right"},attrs:{title:workTool.durationInHour}},[_c("el-input",{staticClass:"pL10 inventory-items-input fc-input-full-border-select2",attrs:{placeholder:_vm.$t("common._common._duration"),disabled:!_vm.actionRule},on:{change:function($event){return _vm.changeWorkToolField(workTool,index,!0,3)}},model:{value:workTool.durationInHour,callback:function($$v){_vm.$set(workTool,"durationInHour",$$v)},expression:"workTool.durationInHour"}})],1)]),_c("td",[_c("div",{staticClass:"text-right"},[_c("currency",{attrs:{value:workTool.tool.rate,recordCurrency:_vm.recordCurrency}})],1)]),_c("td",{staticClass:"pT10 pB10"},[_c("div",{staticClass:"text-right"},[_c("div",{staticClass:"text-right"},[_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"fa fa-lock f18",attrs:{"data-arrow":"true",title:_vm.$t("common.products.waiting_for_approval")}})])])]),_c("td",[_vm.actionRule?_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-delete pointer inv-delet-icon visibility-hide-actions pR10 pL10",attrs:{"data-arrow":"true",title:_vm.$t("common.header.delete_tool")},on:{click:function($event){return _vm.deleteWorkorderTool(workTool,index)}}}):_vm._e()])]):4===workTool.approvedState?_c("tr",{key:workTool.id,staticClass:"borderB1px border-color11 visibility-visible-actions pointer disabled"},[_c("td",{staticClass:"pT10 pB10 tool-header-sticky"},[_c("div",{staticClass:"pL17",staticStyle:{width:"300px"}},[workTool.tool.toolType.isRotating&&workTool.purchasedTool?_c("div",{staticClass:"fc-id",staticStyle:{"padding-bottom":"4px"}},[_vm._v(" #"+_vm._s(workTool.purchasedTool.serialNumber)+" ")]):_vm._e(),_c("div",[_vm._v(_vm._s(workTool.tool.toolType.name))])])]),_c("td",{staticClass:"pT10 pB10"},[_c("div",{staticClass:"in-Quantity"},[_c("div",{staticClass:"item"},[_c("div",{staticClass:"workItem-quantity"},[_vm._v(" "+_vm._s(workTool.quantity)+" ")])])])]),_c("td",{staticClass:"pT10 pB10"},[_c("div",{staticClass:"in-Quantity pL0 width110px"},[_c("div",{staticClass:"fc-black-13 text-right"},[_vm._v(" "+_vm._s(_vm.formatTime(Number(workTool.issueTime),"hh:mm a",!1))+" ")]),_c("div",{staticClass:"fc-grey2-text12 text-right"},[_vm._v(" "+_vm._s(_vm.formatTime(Number(workTool.issueTime),"DD-MM-YYYY",!1))+" ")])])]),_c("td",{staticClass:"pT10 pB10 pL20"},[_c("div",{staticClass:"in-Quantity width110px"},[_c("div",{staticClass:"fc-black-13 text-right"},[_vm._v(" "+_vm._s(_vm.formatTime(Number(workTool.returnTime),"hh:mm a",!1))+" ")]),_c("div",{staticClass:"fc-grey2-text12 text-right"},[_vm._v(" "+_vm._s(_vm.formatTime(Number(workTool.returnTime),"DD-MM-YYYY",!1))+" ")])])]),_c("td",{staticClass:"pT10 pB10"},[_c("div",{staticClass:"in-Quantity",staticStyle:{width:"70%","text-align":"right",float:"right"}},[_vm._v(" "+_vm._s(workTool.durationInHour)+" ")])]),_c("td",{staticClass:"pT10 pB10"},[_c("div",{staticClass:"text-right"},[_c("currency",{attrs:{value:workTool.tool.rate,recordCurrency:_vm.recordCurrency}})],1)]),_c("td",{staticClass:"pT10 pB10"},[_c("div",{staticClass:"text-right"},[_c("currency",{attrs:{value:workTool.cost,recordCurrency:_vm.recordCurrency}})],1)]),_c("td",[_vm.actionRule?_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-delete pointer inv-delet-icon visibility-hide-actions pR10 pL10",attrs:{"data-arrow":"true",title:_vm.$t("common.header.delete_tool")},on:{click:function($event){return _vm.deleteWorkorderTool(workTool,index)}}}):_vm._e()])]):_c("tr",{key:workTool.id,staticClass:"borderB1px border-color11 visibility-visible-actions pointer"},[_c("td",{staticClass:"pT10 pB10 tool-header-sticky"},[_c("div",{staticClass:"pL17",staticStyle:{width:"300px"}},[workTool.tool.toolType.isRotating&&workTool.asset?_c("div",{staticClass:"fc-id",staticStyle:{"padding-bottom":"4px"}},[_vm._v(" #"+_vm._s(workTool.asset.serialNumber)+" ")]):_vm._e(),_c("div",[_vm._v(_vm._s(workTool.tool.toolType.name))])])]),_c("td",{staticClass:"pT10 pB10"},[_c("div",{staticClass:"in-Quantity"},[workTool.tool.toolType.isRotating?_c("div",{staticClass:"item"},[_c("div",{staticClass:"workItem-quantity"},[_vm._v(" "+_vm._s(workTool.quantity)+" ")])]):_c("el-tooltip",{staticClass:"item text-center quant",class:{exceeded:_vm.getToolQuantityState(workTool)},attrs:{effect:"dark",content:_vm.actionRule?_vm.$t("common.products.available_tools")+" "+_vm.getToolCount(workTool):_vm.$t("common.header.please_open_the_workorder"),placement:"right-end"}},[[_c("el-form",{ref:"numberValidateForm",refInFor:!0,staticClass:"width50px inventory-input-width",class:{exceeded:_vm.getToolQuantityState(workTool)},attrs:{model:workTool},nativeOn:{submit:function($event){return $event.preventDefault(),_vm.checkEnter.apply(null,arguments)}}},[_c("el-form-item",{attrs:{label:"",prop:"quantity"}},[_c("el-input",{staticClass:"fc-input-full-border2 width50px inventory-input-width text-right pL20",attrs:{placeholder:"",type:"number",disabled:!_vm.actionRule},on:{change:function($event){return _vm.changeWorkToolField(workTool,index)}},model:{value:workTool.quantity,callback:function($$v){_vm.$set(workTool,"quantity",$$v)},expression:"workTool.quantity"}})],1)],1)]],2)],1)]),_c("td",{staticClass:"pT10 pB10"},[_c("div",{staticClass:"in-Quantity pL0 width110px"},[_c("div",{staticClass:"fc-black-13 text-right"},[_vm._v(" "+_vm._s(_vm.formatTime(Number(workTool.issueTime),"hh:mm a",!1))+" ")]),_c("div",{staticClass:"fc-grey2-text12 text-right"},[_c("el-date-picker",{staticClass:"fc-input-border-remove inventory-date-picker pL40 fc-grey2-text12",attrs:{format:"dd-MM-yyyy hh:mm a","value-format":"timestamp",type:"datetime",placeholder:_vm.$t("common.wo_report.start_time"),disabled:!_vm.actionRule},on:{change:function($event){return _vm.changeWorkToolField(workTool,index,!1,1)}},model:{value:workTool.issueTime,callback:function($$v){_vm.$set(workTool,"issueTime",$$v)},expression:"workTool.issueTime"}})],1)])]),_c("td",{staticClass:"pT10 pB10 pL20"},[_c("div",{staticClass:"in-Quantity width110px"},[_c("div",{staticClass:"fc-black-13 text-right"},[_vm._v(" "+_vm._s(_vm.formatTime(Number(workTool.returnTime),"hh:mm a",!1))+" ")]),_c("div",{staticClass:"fc-grey2-text12 text-right"},[_c("el-date-picker",{staticClass:"fc-input-border-remove inventory-date-picker pL40 fc-grey2-text12",attrs:{format:"dd-MM-yyyy hh:mm a","value-format":"timestamp",type:"datetime",disabled:!_vm.actionRule,placeholder:_vm.$t("common.wo_report.end_time"),"picker-options":{disabledDate:function(time){return time.getTime()<workTool.issueTime}}},on:{change:function($event){return _vm.changeWorkToolField(workTool,index,!1,2)}},model:{value:workTool.returnTime,callback:function($$v){_vm.$set(workTool,"returnTime",$$v)},expression:"workTool.returnTime"}})],1)])]),_c("td",{staticClass:"pT10 pB10"},[_c("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"top",arrow:!0,animation:"shift-away"},expression:"{\n                  placement: 'top',\n                  arrow: true,\n                  animation: 'shift-away',\n                }"}],staticClass:"in-Quantity",staticStyle:{width:"70%","text-align":"right",float:"right"},attrs:{title:workTool.durationInHour}},[_c("el-input",{staticClass:"pL10 inventory-items-input fc-input-full-border-select2",attrs:{placeholder:_vm.$t("common._common._duration"),disabled:!_vm.actionRule},on:{change:function($event){return _vm.changeWorkToolField(workTool,index,!0,3)}},model:{value:workTool.durationInHour,callback:function($$v){_vm.$set(workTool,"durationInHour",$$v)},expression:"workTool.durationInHour"}})],1)]),_c("td",[_c("div",{staticClass:"text-right pR20 pL20"},[_c("currency",{attrs:{value:workTool.tool.rate,recordCurrency:_vm.recordCurrency}})],1)]),_c("td",{staticClass:"pT10 pB10 worktool-cost-sticky"},[_c("div",{staticClass:"text-right"},[_c("currency",{attrs:{value:workTool.cost,recordCurrency:_vm.recordCurrency}})],1)]),_c("td",{staticClass:"pT10 pB10 worktool-cost-edit-sticky"},[_vm.actionRule?_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-delete pointer inv-delet-icon visibility-hide-actions pR10 pL10",attrs:{"data-arrow":"true",title:_vm.$t("common.header.delete_tool")},on:{click:function($event){return _vm.deleteWorkorderTool(workTool,index)}}}):_vm._e()])])]}))],2):_c("tbody",[_c("tr",[_c("td",{staticClass:"inventory-td-selected pL20 pT10 pB10",class:{disabled:!_vm.actionRule},on:{click:function($event){_vm.actionRule&&_vm.addNewWOTool()}}},[_c("div",[_vm._v(_vm._s(_vm.$t("common.products.add_tool")))])]),_c("td",{staticClass:"pT10 pB10"},[_c("div",[_c("el-input",{staticClass:"fc-input-full-border2 width50px inventory-input-width text-center pL20",attrs:{placeholder:"",type:"number",disabled:""}})],1)]),_vm._m(0),_vm._m(1),_c("td",{staticClass:"pT10 pB10"},[_c("div",{staticClass:"text-right"},[_c("el-input",{staticClass:"fc-input-full-border2 width50px inventory-input-width text-center mR10",attrs:{placeholder:"",type:"number",disabled:""}})],1)]),_c("td",{staticClass:"pT10 pB10"},[_c("div",{staticClass:"fc-grey3-13 text-right"},[_c("currency",{attrs:{value:0,recordCurrency:_vm.recordCurrency}})],1)]),_c("td",{staticClass:"pT10 pB10"},[_c("div",{staticClass:"fc-grey3-13 text-right"},[_c("currency",{attrs:{value:0,recordCurrency:_vm.recordCurrency}})],1)]),_c("td",{staticClass:"pT10 pB10"})])])])]),_vm.toolLoading?_c("div",{staticClass:"item-add"}):_c("div",{staticClass:"item-add"},[_vm.isNotPortal&&_vm.actionRule?_c("div",{staticClass:"fL"},[_c("div",{staticClass:"green-txt-13 fc-v1-add-txt pointer"},[_vm.workorderToolsList.length?_c("span",{staticClass:"pR20",on:{click:_vm.addNewWOTool}},[_c("img",{attrs:{src:__webpack_require__(353654)}}),_vm._v(_vm._s(_vm.$t("common.products.add_tool"))+" ")]):_vm._e(),_c("span",{on:{click:function($event){_vm.issueToolIRDialogVisibility=!0}}},[_c("img",{attrs:{src:__webpack_require__(353654)}}),_vm._v(_vm._s(_vm.$t("common.products.add_issued_tool"))+" ")])])]):_vm._e(),_c("div",{staticClass:"fR inline-flex mR40"},[_c("div",{staticClass:"bold mR50"},[_vm._v(_vm._s(_vm.$t("common.header._total")))]),_c("div",{staticClass:"fc-black3-16 text-right bold pL10"},[_c("currency",{attrs:{value:_vm.workToolTotalCost,recordCurrency:_vm.recordCurrency}})],1)])]),_vm.issueToolIRDialogVisibility?[_c("inventory-issue-use",{attrs:{visibility:_vm.issueToolIRDialogVisibility,newIRIssueTool:_vm.issueToolIRDialogVisibility,workorder:_vm.workorder,woToolsList:_vm.workorderToolsList},on:{"update:visibility":function($event){_vm.issueToolIRDialogVisibility=$event},refreshToolList:_vm.loadWorkOrderToolParts}})]:_vm._e(),_c("el-dialog",{attrs:{visible:_vm.newToolPartToggle,fullscreen:!1,open:"top","custom-class":"fc-dialog-up Inventoryaddvaluedialog","append-to-body":!0},on:{"update:visible":function($event){_vm.newToolPartToggle=$event}}},[_vm.individualToolTracking?_c("div",[_c("div",{staticClass:"new-header-container popup-container-new"},[_c("div",{staticClass:"fc-setup-modal-title"},[_c("i",{staticClass:"el-icon-back inv-id-bac-icon pointer",on:{click:function($event){_vm.individualToolList=[],_vm.selectedTool=null}}}),_vm._v(" "+_vm._s(_vm.selectedTool.toolType.name)+" ")]),_c("div",{staticClass:"search-bar",class:{active:_vm.hidequrry}},[_vm.hidequrry?_c("i",{staticClass:"el-input__icon el-icon-search",staticStyle:{"line-height":"0px !important","font-size":"16px !important"},attrs:{slot:"suffix"},on:{click:function($event){_vm.hidequrry=!1}},slot:"suffix"}):_c("el-input",{staticClass:"el-input-textbox-full-border",attrs:{autofocus:!0,type:"text",placeholder:_vm.$t("common._common.to_search_type")},on:{blur:function($event){_vm.hidequrry=!0}},model:{value:_vm.itemSerachQuerry,callback:function($$v){_vm.itemSerachQuerry=$$v},expression:"itemSerachQuerry"}},[_c("i",{staticClass:"el-input__icon el-icon-search",staticStyle:{"line-height":"0px !important","font-size":"16px !important"},attrs:{slot:"suffix"},slot:"suffix"})])],1)]),_c("div",{staticClass:"fc-inv-container-body"},[_c("table",{staticClass:"invent-table-dialog setting-list-view-table width100"},[_c("thead",[_c("th",{staticClass:"setting-table-th setting-th-text"},[_vm._v(" "+_vm._s(_vm.$t("common.header.s_no"))+" ")]),_c("th",{staticClass:"setting-table-th setting-th-text"})]),_vm.iTloading?_c("tbody",[_c("tr",[_c("td",{attrs:{colspan:"100%"}},[_c("div",{staticClass:"iTloading"},[_c("spinner",{attrs:{show:!0,size:"80"}})],1)])])]):_vm.individualToolListwrapper.length?_c("tbody",_vm._l(_vm.individualToolListwrapper,(function(stool){return _c("tr",{key:stool.id,staticClass:"tablerow asset-hover-td"},[_c("td",[_c("div",[_vm._v(_vm._s(stool.serialNumber))]),_c("div")]),_c("td",{staticClass:"text-right"},[_vm.selectedTool.invidualList.findIndex((function(rt){return rt.id===stool.id}))>-1?[_c("el-button",{staticClass:"f-number-input f-number-input-no-border",attrs:{size:"mini"},on:{click:function($event){_vm.selectedTool.invidualList.splice(_vm.selectedTool.invidualList.findIndex((function(rt){return rt.id===stool.id})),1)}}},[_vm._v(_vm._s(_vm.$t("common.products.added")))])]:stool.checked?[_c("el-button",{staticClass:"f-number-input f-number-input-no-border",attrs:{size:"mini"},on:{click:function($event){stool.checked=!1}}},[_vm._v(_vm._s(_vm.$t("common.products.added")))])]:[_c("el-button",{staticClass:"f-number-input",attrs:{size:"mini"},on:{click:function($event){stool.checked=!0}}},[_vm._v(_vm._s(_vm.$t("common._common._add")))])]],2)])})),0):_c("tbody",[_c("tr",[_c("td",{attrs:{colspan:"100%"}},[_c("div",{staticClass:"flex-middle justify-content-center flex-direction-column"},[_c("inline-svg",{attrs:{src:"svgs/emptystate/inventory",iconClass:"icon text-center icon-100"}}),_c("div",{staticClass:"nowo-label f14 bold"},[_vm._v(" "+_vm._s(_vm.$t("common.products.no_tools_present"))+" ")])],1)])])])])]),_c("div",{staticClass:"modal-dialog-footer-parts-dialog"},[_c("div",{staticClass:"modal-dialog-footer-parts-dialog"},[_c("el-button",{staticClass:"modal-btn-save width100",staticStyle:{"margin-left":"0px !important"},attrs:{type:"primary",disabled:_vm.iTloading},on:{click:_vm.addindIvidualTrackingTool}},[_vm._v(_vm._s(_vm.$t("common._common._done")))])],1)])]):_c("div",[_c("div",{staticClass:"new-header-container popup-container-new"},[_c("div",{staticClass:"fc-setup-modal-title"},[_vm._v(" "+_vm._s(_vm.$t("common.products.tools_list"))+" ")])]),_c("div",{staticClass:"new-header-container popup-container"},[_c("div",{staticClass:"store-room-bar-item",class:{active:!_vm.hidequrry}},[_c("el-select",{staticClass:"fc-tag fc-input-full-border2",staticStyle:{"margin-left":"20px"},attrs:{"collapse-tags":"",placeholder:_vm.$t("common.products.select_storeroom")},on:{change:_vm.loadToolslist},model:{value:_vm.selectedStoreList,callback:function($$v){_vm.selectedStoreList=$$v},expression:"selectedStoreList"}},_vm._l(_vm.tempStoreList,(function(item,index){return _c("el-option",{key:index,attrs:{label:item.name,value:item.id}})})),1)],1),_c("div",{staticClass:"search-container"},[_c("el-input",{staticClass:"el-input-textbox-full-border",attrs:{autofocus:!0,type:"text",placeholder:_vm.$t("common._common.search")},on:{change:_vm.loadToolslist},model:{value:_vm.itemSerachQuerry,callback:function($$v){_vm.itemSerachQuerry=$$v},expression:"itemSerachQuerry"}},[_c("i",{staticClass:"el-input__icon el-icon-search pointer",staticStyle:{"line-height":"0px !important","font-size":"16px !important"},attrs:{slot:"suffix"},slot:"suffix"})])],1),_c("div",{staticClass:"pagination"},[_vm.newToolPartToggle?_c("pagination",{attrs:{total:_vm.listCount,perPage:20,hidePopover:!0},on:{onPageChanged:_vm.onPageChange}}):_vm._e()],1)]),_c("div",{staticClass:"fc-inv-container-body"},[_vm.allToolListLoading?_c("table",{staticClass:"width100"},[_c("tr",[_c("td",{attrs:{colspan:"100%"}},[_c("div",{staticClass:"iTloading in-no-data"},[_c("spinner",{attrs:{show:!0,size:"80"}})],1)])])]):_c("table",{staticClass:"setting-list-view-table width100 invent-table-dialog"},[_vm.toolsList.length?_c("tbody",_vm._l(_vm.toolsList,(function(stool,index){return _c("tr",{key:stool.id,staticClass:"tablerow asset-hover-td height100px"},[_c("td",{staticClass:"width80"},[_c("div",[_vm._v(_vm._s(_vm.$getProperty(stool,"toolType.name")))]),_c("div",{staticClass:"item-description",class:_vm.getSubjectClassname(stool,index)},[_vm._v(" "+_vm._s(_vm.$getProperty(stool,"toolType.description"))+" ")]),_c("div",{staticClass:"flex flex-direction-row pT6"},[_vm.canShowMore(stool)?_c("a",{staticClass:"text-capitalize letter-spacing0_3 f13 pR8 pointer",on:{click:function($event){return _vm.toggleVisibility(index)}}},[_vm._v(_vm._s(_vm.showMoreLinkText(index)))]):_vm._e()])]),_c("td",{staticClass:"text-align-inventory"},[stool.toolType.isRotating?[stool.invidualList&&stool.invidualList.length>0?_c("el-button",{staticClass:"f-number-input f-number-input-no-border",attrs:{size:"mini"},on:{click:function($event){_vm.selectTool(stool,index),stool.checked=!0}}},[_vm._v(_vm._s(stool.invidualList.length)+" "+_vm._s(_vm.$t("common.products.qty_added")))]):_c("el-button",{staticClass:"f-number-input",attrs:{size:"mini"},on:{click:function($event){_vm.selectTool(stool,index),stool.checked=!0,_vm.itemSerachQuerry=null}}},[_vm._v(_vm._s(_vm.$t("common._common._add")))])]:0===stool.addedQuantity?[_c("el-button",{staticClass:"f-number-input",attrs:{size:"mini"},on:{click:function($event){stool.addedQuantity=1,stool.checked=!0}}},[_vm._v(_vm._s(_vm.$t("common._common._add")))])]:[_c("el-input-number",{staticClass:"f-number-input",attrs:{size:"mini",min:0,max:stool.currentQuantity},on:{change:function($event){return _vm.handeler1(stool,index)}},model:{value:stool.addedQuantity,callback:function($$v){_vm.$set(stool,"addedQuantity",$$v)},expression:"stool.addedQuantity"}})],_c("div",{staticClass:"secondary-quantity-text pT10"},[_vm._v(" "+_vm._s(_vm.$t("common.products.available")+": "+stool.currentQuantity)+" ")])],2)])})),0):_c("tbody",[_c("tr",[_c("td",{attrs:{colspan:"100%"}},[_c("div",{staticClass:"flex-middle justify-content-center flex-direction-column"},[_c("inline-svg",{attrs:{src:"svgs/emptystate/inventory",iconClass:"icon text-center icon-100"}}),_c("div",{staticClass:"nowo-label f14 bold"},[_vm._v(" "+_vm._s(_vm.$t("common.products.no_tools_present"))+" ")])],1)])])])])]),_c("div",{staticClass:"modal-dialog-footer-parts-dialog"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){return _vm.cancelToolPartsDialog()}}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",staticStyle:{"margin-left":"0px !important"},attrs:{type:"primary"},on:{click:function($event){return _vm.addNewbulkTool()}}},[_vm._v(_vm._s(_vm.$t("common._common._add")))])],1)])])],2)},staticRenderFns=[function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("td",{staticClass:"pT10 pB10"},[_c("div",{staticClass:"fc-black-13 text-right"},[_vm._v("-- -- --")])])},function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("td",{staticClass:"pT10 pB10 pL20"},[_c("div",{staticClass:"fc-black-13 text-right"},[_vm._v("-- -- --")])])}],objectSpread2=__webpack_require__(595082),createForOfIteratorHelper=__webpack_require__(566347),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),moment_timezone=(__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(425728),__webpack_require__(564043),__webpack_require__(709873),__webpack_require__(670560),__webpack_require__(162506),__webpack_require__(648324),__webpack_require__(879288),__webpack_require__(947522),__webpack_require__(450886),__webpack_require__(897389),__webpack_require__(480008)),moment_timezone_default=__webpack_require__.n(moment_timezone),workorderHelper=__webpack_require__(865764),InventoryIssueUse=__webpack_require__(418672),InlineSvg=__webpack_require__(586166),eventBus=__webpack_require__(398011),api=__webpack_require__(32284),validation=__webpack_require__(990260),InventoryUtil=__webpack_require__(976195),InventoryPagination=__webpack_require__(926460),filters=__webpack_require__(638203),InventoryToolsvue_type_script_lang_js={props:["details","resizeWidget"],mixins:[workorderHelper/* default */.Z],components:{InventoryIssueUse:InventoryIssueUse/* default */.Z,InlineSvg:InlineSvg/* default */.Z,Pagination:InventoryPagination/* default */.Z},data:function(){return{selectedInventory:null,hidequrry:!0,additionalCost:{name:null,cost:null},loading:{deleteAdditionalCost:!1},toolLoading:!1,selectedInventoryList:[],inventoryRequestForWOLoading:!1,iTloading:!1,toolsloading:!1,selectedTool:null,workorderToolsList:[],newToolPartToggle:!1,workOrderCostList:[],individualToolList:[],inventory:[],stockedTools:[],tempStoreList:[],selectedStoreList:[],inventoryRequestDialogVisibility:!1,issueToolIRDialogVisibility:!1,issueInventoryIRDialogVisibility:!1,inventoryRequestList:null,allToolListLoading:!1,inventoryListLoading:!1,listCount:null,page:1,searchPage:1,selectedIndex:[],itemSerachQuerry:null}},created:function(){this.$store.dispatch("loadTicketStatus","workorder"),this.init()},mounted:function(){var _this=this;this.autoResize(),eventBus/* eventBus */.Y.$on("refresh-inventory-summary",(function(){_this.reload()}))},computed:{workorder:function(){return this.details.workorder},toolsList:function(){var list=[];return list=this.stockedTools.filter((function(item){return!(item.toolType.approvalNeeded||item.storeRoom.approvalNeeded)})),list},individualToolListwrapper:function(){var list=this.individualToolList;if(this.itemSerachQuerry){var self=this;return list.filter((function(data){if(data.serialNumber.toLowerCase().indexOf(self.itemSerachQuerry.toLowerCase())>-1)return data}))}return list},workToolTotalCost:function(){return this.workOrderCostList.length&&this.workOrderCostList.find((function(rt){return"tools"===rt.costTypeEnum}))?this.workOrderCostList.find((function(rt){return"tools"===rt.costTypeEnum})).cost:0},actionRule:function(){return!!this.canEdit},individualToolTracking:function(){return!!(this.stockedTools&&this.stockedTools.length&&this.selectedTool)},canEdit:function(){return this.isStateFlowEnabled?!this.$store.getters.isStatusLocked(this.workorder.moduleState.id,"workorder"):this.workorder&&2!==this.workorder.approvalState},isStateFlowEnabled:function(){return Boolean(this.workorder.moduleState&&this.workorder.moduleState.id)}},methods:{init:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _this2.loadWorkOrderToolParts(!0),_context.next=3,_this2.getStoreroom();case 3:_this2.loadItemsCount(),_this2.getWorkOrderCostList(!0);case 5:case"end":return _context.stop()}}),_callee)})))()},cancelToolPartsDialog:function(){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _this3.newToolPartToggle=!1,_this3.selectedTool=null,_this3.page=1,_this3.searchPage=1,_this3.itemSerachQuerry=null,_this3.selectedIndex=[],_context2.next=8,_this3.getStoreroom();case 8:_this3.loadInventory();case 9:case"end":return _context2.stop()}}),_callee2)})))()},reload:function(){this.loadWoItemParts(!0)},showMoreLinkText:function(index){var selectedIndex=this.selectedIndex;return-1!==selectedIndex.indexOf(index)?"View Less":"View More"},canShowMore:function(inventory){var description=this.$getProperty(inventory,"toolType.description");if(description){var descriptionLength=description.length,htmlToStringLength=(0,filters/* htmlToText */.s9)(description).split(/\r\n|\r|\n/).length;return htmlToStringLength>2||descriptionLength>130}return!1},getSubjectClassname:function(inventory,index){return this.canShowMore(inventory)?-1!==this.selectedIndex.indexOf(index)?"description-content description-content-viewMore":"description-content description-content-viewLess":"popover-description"},toggleVisibility:function(index){var selectedIndex=this.selectedIndex;if(-1===selectedIndex.indexOf(index))selectedIndex.push(index);else{var indexOfDesc=selectedIndex.indexOf(index);selectedIndex.splice(indexOfDesc,1)}},autoResize:function(){var _this4=this;this.$nextTick((function(){var container=_this4.$refs["inventoryToolsWidget"];if(container){var height=container.scrollHeight+200,width=container.scrollWidth;_this4.resizeWidget&&_this4.resizeWidget({height:height,width:width})}}))},onPageChange:function(pageNo){var itemSerachQuerry=this.itemSerachQuerry;this.page=pageNo,(0,validation/* isEmpty */.xb)(itemSerachQuerry)||(this.searchPage=pageNo),this.loadToolslist()},loadItemsCount:function(){var _this5=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var siteId,selectedStoreList,itemSerachQuerry,params,filters,url,_yield$API$get,data,error,message;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return _this5.page=1,siteId=_this5.$getProperty(_this5.workorder,"siteId"),selectedStoreList=_this5.selectedStoreList,itemSerachQuerry=_this5.itemSerachQuerry,params={showForWorkorder:!0,includeServingSite:!0,siteId:siteId,count:!0},(0,validation/* isEmpty */.xb)(itemSerachQuerry)||(_this5.$set(params,"searchQuery",itemSerachQuerry),_this5.searchPage=1),(0,validation/* isEmpty */.xb)(selectedStoreList)||(filters={storeRoom:{value:["".concat(selectedStoreList)],operatorId:36}},_this5.$set(params,"filters",JSON.stringify(filters))),url="v2/tool/view/all",_context3.next=9,api/* API */.bl.get(url,params);case 9:_yield$API$get=_context3.sent,data=_yield$API$get.data,error=_yield$API$get.error,error?(message=error.message,_this5.$message.error(message)):_this5.listCount=_this5.$getProperty(data,"count");case 13:case"end":return _context3.stop()}}),_callee3)})))()},getStoreroom:function(){var _this6=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){var siteId,params,_yield$API$get2,error,data,_ref,storeRooms,_ref2,id;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:return siteId=_this6.$getProperty(_this6.workorder,"siteId"),params={siteId:siteId},_context4.next=4,api/* API */.bl.get("v2/storeRoom/view/all",params);case 4:_yield$API$get2=_context4.sent,error=_yield$API$get2.error,data=_yield$API$get2.data,error?_this6.$message.error(error.message||"Error Occured"):(_ref=data||{},storeRooms=_ref.storeRooms,_this6.tempStoreList=storeRooms,_ref2=storeRooms[0]||{},id=_ref2.id,_this6.selectedStoreList=id);case 8:case"end":return _context4.stop()}}),_callee4)})))()},loadToolslist:function(){var _this7=this;this.allToolListLoading=!0;var siteId=this.$getProperty(this.workorder,"siteId"),page=this.page,itemSerachQuerry=this.itemSerachQuerry,selectedStoreList=this.selectedStoreList,searchPage=this.searchPage,params={page:page,perPage:20,showForWorkorder:!0,includeServingSite:!0,siteId:siteId};if(itemSerachQuerry&&(this.$set(params,"searchQuery",itemSerachQuerry),this.$set(params,"page",searchPage),this.loadItemsCount()),!(0,validation/* isEmpty */.xb)(selectedStoreList)){var filters={storeRoom:{value:["".concat(selectedStoreList)],operatorId:36}};this.$set(params,"filters",JSON.stringify(filters)),this.loadItemsCount()}api/* API */.bl.get("v2/tool/view/all",params).then((function(_ref3){var data=_ref3.data;_this7.allToolListLoading=!1;var inventory=[];if(inventory=_this7.$getProperty(data,"tool",[]),data){var _step,_iterator=(0,createForOfIteratorHelper/* default */.Z)(inventory);try{for(_iterator.s();!(_step=_iterator.n()).done;){var item=_step.value;item.checked=!1,item.addedQuantity=0,item.invidualList=[]}}catch(err){_iterator.e(err)}finally{_iterator.f()}_this7.stockedTools=inventory}}))},getToolCount:function(worktool){var diff;return worktool?(diff=worktool.requestedLineItem?Number(worktool.requestedLineItem.issuedQuantity)-Number(worktool.quantity):-1!==worktool.parentTransactionId?Number(worktool.tempQuantity)+Number(worktool.remainingQuantity)-Number(worktool.quantity):Number(worktool.tempQuantity)+Number(worktool.tempTool.currentQuantity)-Number(worktool.quantity),Number(worktool.quantity)<0?"Quantity must be nonzero":diff<0?"Exceeded":diff):""},getToolQuantityState:function(worktool){var diff;return!!worktool&&(diff=worktool.requestedLineItem?Number(worktool.requestedLineItem.issuedQuantity)-Number(worktool.quantity):-1!==worktool.parentTransactionId?Number(worktool.tempQuantity)+Number(worktool.remainingQuantity)-Number(worktool.quantity):Number(worktool.tempQuantity)+Number(worktool.tempTool.currentQuantity)-Number(worktool.quantity),Number(worktool.quantity)<0||diff<0)},addNewWOTool:function(){this.individualToolList=[],this.newToolPartToggle=!0},toolshowRule:function(invt){if(invt.toolType.isRotating)return invt.toolType.currentQuantity>0;var tempWorkItem=this.workorderToolsList.filter((function(i){return i.tool.id===invt.id})),check=!0;return tempWorkItem.forEach((function(i){-1===i.parentTransactionId&&(check=!1)})),check},actionToWorkorderStatusChange:function(){this.fetchWo()},getWorkOrderCostList:function(loading){var self=this;this.$http.get("v2/workorderCostsList/parent/"+this.workorder.id).then((function(response){loading||(self.itemnsloading=!1),self.workOrderCostList=response.data.result.workorderCost,eventBus/* eventBus */.Y.$emit("reloadOverallCost")}))},deleteWorkorderTool:function(workTool,index){var _this8=this;if(workTool.tool.hasOwnProperty("storeRoom")){var self=this,param={parentId:this.workorder.id,workorderToolsIds:[]};param.workorderToolsIds.push(workTool.id),this.$http.post("v2/workorderTools/delete",param).then((function(response){0===response.data.responseCode?(self.actionToWorkorderStatusChange(),self.loadToolslist(),self.loadWorkOrderToolParts(),self.getWorkOrderCostList(),self.$message.success("Tool Deleted"),self.workorderToolsList.splice(index,1),_this8.autoResize()):self.$message.error(response.data.message)})).catch()}else this.workorderToolsList.pop()},addToolPartSave:function(){var _this9=this,self=this,param={workorderToolsList:[]},purchasedTools=[];this.individualToolList.length&&(purchasedTools=this.individualToolList.map((function(rt){if(rt.checked)return rt.id})),purchasedTools=purchasedTools.filter((function(rt){return"undefined"!==typeof rt})));var temp={parentId:this.workorder.id,tool:{id:this.selectedTool},quantity:1,assetIds:purchasedTools};param.workorderToolsList.push(temp),this.toolsloading=!0,this.$http.post("/v2/workorderTools/addOrUpdate",param).then((function(response){0!==response.data.responseCode?_this9.$message.error(response.data.message):(self.$message.success(_this9.$t("common._common.added_successfully")),self.selectedTool=null,self.actionToWorkorderStatusChange(),self.loadWorkOrderToolParts(!1,!0),self.getWorkOrderCostList())})).catch((function(error){_this9.$message.error(_this9.$t("common.wo_report.unable_to_update"))})),this.newToolPartToggle=!1},bulkaddTool:function(){var selectedItems=this.stockedTools.filter((function(rt){return rt.checked})),bulkItem=selectedItems.filter((function(rt){if(rt&&rt.toolType&&!rt.toolType.isRotating)return rt}));bulkItem.length&&(this.addbulkTool(bulkItem),this.individualToolList.length||(this.newToolPartToggle=!1)),this.individualToolTracking&&this.individualToolList.length&&(this.addbulkTool(!1,this.individualToolList),this.newToolPartToggle=!1)},addbulkTool:function(tools,individualToolList){var _this10=this,self=this,param={workorderToolsList:[]},obj={},assetIds=[],data=[];if(individualToolList&&individualToolList.length)for(var i=0;i<individualToolList.length;i++)data=individualToolList[i],data.checked&&(assetIds=[data.id],obj={parentId:this.workorder.id,tool:{id:data.tool.id},quantity:1,assetIds:assetIds},param.workorderToolsList.push(obj));else if(tools){data=[];for(var _i=0;_i<tools.length;_i++){var _data=tools[_i];obj={parentId:this.workorder.id,tool:{id:_data.id},quantity:1,assetIds:assetIds},param.workorderToolsList.push(obj)}}this.toolsloading=!0,this.$http.post("/v2/workorderTools/addOrUpdate",param).then((function(response){0!==response.data.responseCode?_this10.$message.error(response.data.message):(self.$message.success(_this10.$t("common._common.added_successfully")),self.selectedTool=null,self.actionToWorkorderStatusChange(),self.loadWorkOrderToolParts(!1,!0),self.getWorkOrderCostList())})).catch((function(){_this10.$message.error(_this10.$t("common.wo_report.unable_to_update"))}))},addNewbulkTool:function(){var _this11=this,self=this,param={workorderToolsList:[]},obj={},assetIds=[];this.toolsList.forEach((function(item){obj={},assetIds=[],item.toolType.isRotating?item.invidualList.length&&(assetIds=item.invidualList.map((function(rl){return rl.id})),obj={parentId:_this11.workorder.id,tool:{id:item.id},quantity:item.invidualList.length,assetIds:assetIds},param.workorderToolsList.push(obj)):item.addedQuantity>0&&(obj={parentId:_this11.workorder.id,tool:{id:item.id},quantity:item.addedQuantity,assetIds:assetIds},param.workorderToolsList.push(obj))})),this.selectedTool=null,this.individualItemList=[],this.individualToolList=[],this.newToolPartToggle=!1,this.$http.post("/v2/workorderTools/addOrUpdate",param).then((function(response){0!==response.data.responseCode?self.$message.error(response.data.message):(self.$message.success(_this11.$t("common.products.tools_added_successfully")),self.selectedTool=null,self.actionToWorkorderStatusChange(),self.loadWorkOrderToolParts(!1,!0),self.getWorkOrderCostList())})).catch((function(){}))},loadStockedTools:function(){var _this12=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee5(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context5){while(1)switch(_context5.prev=_context5.next){case 0:return _context5.next=2,(0,InventoryUtil/* getFilteredToolListWithParentModule */.EJ)("workorder");case 2:_this12.tools=_context5.sent;case 3:case"end":return _context5.stop()}}),_callee5)})))()},changeWorkToolField:function(workTool,index,durationHour,changedField){var _this13=this;if(Number(workTool.quantity)<=Number(workTool.tempQuantity)+Number(workTool.tempTool.quantity)){var param={workorderToolsList:[]};-1===workTool.issueTime&&(workTool.issueTime=null),-1===workTool.returnTime&&(workTool.returnTime=null);var issueTime=null!==workTool.issueTime?moment_timezone_default()(workTool.issueTime).tz(this.$timezone).valueOf():workTool.issueTime,returnTime=null!==workTool.returnTime?moment_timezone_default()(workTool.returnTime).tz(this.$timezone).valueOf():workTool.returnTime,temp={},duration=Number(workTool.duration);durationHour?(duration=Number(workTool.durationInHour).toFixed(2),null!==issueTime&&issueTime>0&&duration>0&&(returnTime=Number(issueTime)+Number(duration))):(duration=Number(duration).toFixed(2),duration=this.getDurationInHour(duration)),0!==issueTime&&null!==issueTime||(issueTime=-1),0!==returnTime&&null!==returnTime||(returnTime=-1),this.workorderToolsList[index].duration=duration,temp={parentId:this.workorder.id,id:workTool.id,tool:{id:workTool.tool.id},quantity:parseInt(workTool.quantity),duration:1==changedField||3==changedField?duration:-1,issueTime:issueTime||-99,returnTime:2===changedField?returnTime:-99,requestedLineItem:workTool.requestedLineItem,parentTransactionId:workTool.parentTransactionId},param.workorderToolsList.push(temp);var self=this;this.$http.post("/v2/workorderTools/addOrUpdate",param).then((function(response){0===response.data.responseCode?(self.$message.success(_this13.$t("common._common.edited_successfully")),self.actionToWorkorderStatusChange(),self.loadWorkOrderToolParts(),self.getWorkOrderCostList()):self.$message.error(response.data.message)}))}else this.$message.error(this.$t("common.dashboard.quantity_should_be_less"))},getDurationInHour:function(durationInSeconds){var durationInHour=0;return!(0,validation/* isEmpty */.xb)(durationInSeconds)&&durationInSeconds>0&&(durationInHour=durationInSeconds/3600,durationInHour=Number(durationInHour).toFixed(2)),durationInHour},loadWorkOrderToolParts:function(loading,inventory){var _this14=this;loading&&(this.toolLoading=!0);var self=this;this.$http.get("/v2/workorderToolsList/parent/"+this.workorder.id).then((function(response){var wktool={};for(var workTool in _this14.workorderToolsList=response.data.result.workorderTools,response.data.result.workorderTools){var durationInSeconds=_this14.workorderToolsList[workTool].duration,durationInHour=_this14.getDurationInHour(durationInSeconds);_this14.workorderToolsList[workTool].durationInHour=durationInHour,_this14.workorderToolsList[workTool].issueTime=-1===_this14.workorderToolsList[workTool].issueTime||null===_this14.workorderToolsList[workTool].issueTime?null:_this14.workorderToolsList[workTool].issueTime,_this14.workorderToolsList[workTool].returnTime=-1===_this14.workorderToolsList[workTool].returnTime||null===_this14.workorderToolsList[workTool].returnTime?null:_this14.workorderToolsList[workTool].returnTime,wktool=response.data.result.workorderTools[workTool],wktool.tempQuantity=wktool.quantity,wktool.tempTool=wktool.tool}self.workorderToolsList=self.$helpers.cloneObject(response.data.result.workorderTools),loading&&self.loadToolslist(),inventory&&self.loadToolslist(),_this14.toolLoading=!1,_this14.autoResize()})).catch((function(error){_this14.$message.error(_this14.$t("common.wo_report.unable_to_load_tools")),_this14.toolLoading=!1})),this.loadStockedTools()},loadindividualToolTrackingList:function(items){var _this15=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee6(){var filters,individualToolList;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context6){while(1)switch(_context6.prev=_context6.next){case 0:return _this15.individualToolList=[],_this15.iTloading=!0,filters={rotatingTool:{operatorId:36,value:items.map((function(rt){return rt.id+""}))},isUsed:{operatorId:15,value:["false"]}},_context6.next=5,_this15.$util.getFilteredAssetList(filters);case 5:individualToolList=_context6.sent,_this15.individualToolList=individualToolList.map((function(item){return(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},item),{},{checked:!1})})),_this15.iTloading=!1;case 8:case"end":return _context6.stop()}}),_callee6)})))()}}},widgets_InventoryToolsvue_type_script_lang_js=InventoryToolsvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(widgets_InventoryToolsvue_type_script_lang_js,render,staticRenderFns,!1,null,"dee80efa",null)
/* harmony default export */,InventoryTools=component.exports},
/***/353654:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"d7f1f315aba97cd14240ee6f3d34465f.svg";
/***/}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/16504.js.map