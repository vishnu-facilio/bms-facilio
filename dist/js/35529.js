"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[35529],{
/***/806339:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return WidgetPagination}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/page/widget/utils/WidgetPagination.vue?vue&type=template&id=6b10cd5b
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"fc-widget-pagination"},[_vm.total>0?_c("div",{class:{"fc-black-small-txt-12":!_vm.hideToggle}},[_vm.from!==_vm.to?_c("span",[_vm._v(_vm._s(_vm.from)+" -")]):_vm._e(),_c("span",[_vm._v(_vm._s(_vm.to))]),_vm.hideToggle?_vm._e():[_vm._v(" of "+_vm._s(_vm.total)+" "),_c("span",{staticClass:"el-icon-arrow-left fc-black-small-txt-12 fw-bold f16 pointer mL10 mR5",class:{disable:_vm.from<=1},on:{click:function($event){_vm.from>1&&_vm.prev()}}}),_c("span",{staticClass:"el-icon-arrow-right fc-black-small-txt-12 f16 pointer mR10 fw-bold",class:{disable:_vm.to===_vm.total},on:{click:function($event){_vm.to!==_vm.total&&_vm.next()}}})]],2):_vm._e()])},staticRenderFns=[],WidgetPaginationvue_type_script_lang_js={props:["currentPage","perPage","total","hideToggle"],data:function(){return{from:0,to:0,page:1}},mounted:function(){this.init()},watch:{total:function(){this.init()},currentPage:function(val){val!==this.page&&this.init()}},methods:{init:function(){this.page=this.currentPage||1,this.from=(this.page-1)*this.perPage+1;var to=this.from+this.perPage-1;this.to=this.total>to?to:this.total},next:function(){this.from=this.to+1,this.to+=this.perPage,this.to>this.total&&(this.to=this.total),this.page++,this.updateCurrentPage()},prev:function(){this.to=this.from-1,this.from-=this.perPage,this.from<=1?this.from=this.page=1:this.page--,this.updateCurrentPage()},updateCurrentPage:function(){
// Update currentPage value
this.$emit("update:currentPage",this.page),this.$emit("onChange")}}},utils_WidgetPaginationvue_type_script_lang_js=WidgetPaginationvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(utils_WidgetPaginationvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,WidgetPagination=component.exports},
/***/35529:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return PMPlannerDetails}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/workorder/pm/summary/PMPlannerDetails.vue?vue&type=template&id=305baac2&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{ref:"pm-planner-details",staticClass:"pm-planner-details height100"},[_vm.isListLoading?_c("div",{staticClass:"flex-middle fc-empty-white"},[_c("spinner",{attrs:{show:_vm.isListLoading,size:"80"}})],1):_c("div",{staticClass:"d-flex"},[_c("div",{staticClass:"pm-navbar"},_vm._l(_vm.summaryTabs,(function(tab){return _c("div",{key:tab.name,staticClass:"pm-nav-item",class:[_vm.isSelectedTab(tab)?"pm-selected-nav":""],on:{click:function($event){return _vm.toggleTab(tab.name)}}},[_vm._v(" "+_vm._s(tab.displayName)+" ")])})),0),_c("div",{staticClass:"pm-tabs flex-direction-column"},[_c("el-tabs",{staticClass:"fpage-tabs width100 planner-summary-main-container",model:{value:_vm.selectedPlannerId,callback:function($$v){_vm.selectedPlannerId=$$v},expression:"selectedPlannerId"}},_vm._l(_vm.plannerList,(function(planner){return _c("el-tab-pane",{key:planner.id,staticClass:"pm-tabs-container",attrs:{label:planner.name,name:""+planner.id}},[_c("PlannerSummary",{attrs:{id:"summary",planner:planner,resourcePlaceholder:_vm.resourcePlaceholder,pm:_vm.details}}),_c("ResourcePlanner",{attrs:{id:"resourcePlanner",planner:planner,pm:_vm.details,placeholder:_vm.resourcePlaceholder}})],1)})),1)],1)])])},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),api=(__webpack_require__(434284),__webpack_require__(32284)),validation=__webpack_require__(990260),PlannerSummaryvue_type_template_id_b7afc02a_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"planner-summary-container"},[_c("div",{staticClass:"planner-summary-header"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm.trigger_summary"))+" ")]),_c("div",{staticClass:"planner-field-container"},[_vm._l(_vm.fieldList,(function(field,index){return _c("div",{key:"pm-fields-"+index,staticClass:"planner-field"},[_c("div",{staticClass:"planner-field-label"},[_vm._v(_vm._s(field.name))]),_c("div",{staticClass:"planner-field-value"},[_vm._v(" "+_vm._s(field.getValue({planner:_vm.planner}))+" ")])])})),_c("div",{staticClass:"planner-field"},[_c("div",{staticClass:"planner-field-label"},[_vm._v(_vm._s(_vm.resourcePlaceholder))]),_c("div",{staticClass:"planner-field-value"},[_vm._v(" "+_vm._s(_vm.resourceCount)+" ")])])],2),_vm.$validation.isEmpty(_vm.triggerSeasons)?_vm._e():[_c("div",{staticClass:"planner-summary-header mT20"},[_vm._v(" "+_vm._s("Season Details")+" ")]),_vm._l(_vm.triggerSeasons,(function(value,index){return[_c("div",{key:index+"-field-season",staticClass:"planner-field-container"},[_c("div",{key:"seasonname-"+index,staticClass:"planner-field"},[_c("div",{staticClass:"planner-field-label"},[_vm._v(_vm._s("Season Name"))]),_c("div",{staticClass:"planner-field-value"},[_vm._v(" "+_vm._s(value.name)+" ")])]),_c("div",{key:"seasonstart-"+index,staticClass:"planner-field"},[_c("div",{staticClass:"planner-field-label"},[_vm._v(_vm._s("Season Start"))]),_c("div",{staticClass:"planner-field-value"},[_vm._v(" "+_vm._s(("00"+value.startDate).slice(-2)+" "+_vm.getMonthName(value.startMonth))+" ")])]),_c("div",{key:"seasonend-"+index,staticClass:"planner-field"},[_c("div",{staticClass:"planner-field-label"},[_vm._v(_vm._s("Season End"))]),_c("div",{staticClass:"planner-field-value"},[_vm._v(" "+_vm._s(("00"+value.endDate).slice(-2)+" "+_vm.getMonthName(value.endMonth))+" ")])]),_c("div",{key:"seasonspace-"+index,staticClass:"planner-field"})])]}))]],2)},PlannerSummaryvue_type_template_id_b7afc02a_scoped_true_staticRenderFns=[],constant=(__webpack_require__(169358),__webpack_require__(976801),__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(354754)),dlv_umd=__webpack_require__(226905),dlv_umd_default=__webpack_require__.n(dlv_umd),helpers=__webpack_require__(778390),vue_runtime_esm=__webpack_require__(720144),pm_utils=__webpack_require__(195123),moment=helpers/* default */.ZP.getOrgMoment,getSchedulerData=function(planner){var schedule=dlv_umd_default()(planner,"trigger.schedule");return(0,validation/* isEmpty */.xb)(schedule)?{}:JSON.parse(schedule)},SKIP_OPTIONS=[{label:"Do not skip",value:-1},{label:"Second Cycle",value:2},{label:"Third Cycle",value:3},{label:"Fourth Cycle",value:4},{label:"Fifth Cycle",value:5},{label:"Sixth Cycle",value:6},{label:"Seventh Cycle",value:7},{label:"Eighth Cycle",value:8},{label:"Ninth Cycle",value:9},{label:"Tenth Cycle",value:10}],formatTime=function(timeStamp){var currentOrgTimeZone=vue_runtime_esm["default"].prototype.$timezone;return timeStamp=moment(timeStamp),timeStamp.tz(currentOrgTimeZone).format("DD MMM YYYY")},FIELDS_HASH=[{name:"Frequency",getValue:function(_ref){var planner=_ref.planner,schedule=getSchedulerData(planner),facilioFrequency=constant/* default */.Z.FACILIO_FREQUENCY;if(!(0,validation/* isEmpty */.xb)(schedule)){var _ref2=schedule||{},frequencyType=_ref2.frequencyType;return["MONTHLY_DATE","MONTHLY_WEEK"].includes(pm_utils/* FREQUENCY_HASH */.UC[frequencyType])?frequencyType=3:["QUARTERLY_DATE","QUARTERLY_WEEK"].includes(pm_utils/* FREQUENCY_HASH */.UC[frequencyType])?frequencyType=4:["HALF_YEARLY_DATE","HALF_YEARLY_WEEK"].includes(pm_utils/* FREQUENCY_HASH */.UC[frequencyType])?frequencyType=5:["ANNUALLY_DATE","ANNUALLY_WEEK"].includes(pm_utils/* FREQUENCY_HASH */.UC[frequencyType])&&(frequencyType=6),facilioFrequency[frequencyType]?facilioFrequency[frequencyType]:frequencyType}return"---"}},{name:"Execution Start Date",getValue:function(_ref3){var planner=_ref3.planner,_ref4=planner||{},trigger=_ref4.trigger,_ref5=trigger||{},startTime=_ref5.startTime;return startTime?formatTime(startTime):"---"}},{name:"Execution End Date",getValue:function(_ref6){var planner=_ref6.planner,_ref7=planner||{},trigger=_ref7.trigger,_ref8=trigger||{},endTime=_ref8.endTime;return endTime?formatTime(endTime):"---"}},{name:"Skip",getValue:function(_ref9){var planner=_ref9.planner,scheduler=getSchedulerData(planner),_ref10=scheduler||{},skipEvery=_ref10.skipEvery,skipObject=SKIP_OPTIONS.find((function(option){var _ref11=option||{},value=_ref11.value;return value===skipEvery})),_ref12=skipObject||{},label=_ref12.label;return label||"---"}}],PlannerSummaryvue_type_script_lang_js={name:"PlannerSummary",props:["planner","resourcePlaceholder"],data:function(){return{fieldList:FIELDS_HASH,months:constant/* default */.Z.MONTHS}},computed:{resourceCount:function(){var planner=this.planner;return this.$getProperty(planner,"resourceCount",0)},triggerSeasons:function(){var planner=this.planner,allSeasons=[],schedule=this.$getProperty(planner,"trigger.schedule");if(!(0,validation/* isEmpty */.xb)(schedule)){schedule=JSON.parse(schedule);var _ref13=schedule||{},seasons=_ref13.seasons;allSeasons=seasons}return allSeasons}},methods:{getMonthName:function(value){return this.$constants.scheduleMonthValue[value-1]}}},summary_PlannerSummaryvue_type_script_lang_js=PlannerSummaryvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(summary_PlannerSummaryvue_type_script_lang_js,PlannerSummaryvue_type_template_id_b7afc02a_scoped_true_render,PlannerSummaryvue_type_template_id_b7afc02a_scoped_true_staticRenderFns,!1,null,"b7afc02a",null)
/* harmony default export */,PlannerSummary=component.exports,ResourcePlannerListvue_type_template_id_15d5d5e8_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"planner-summary-container p0 height100"},[_c("div",{staticClass:"d-flex justify-between items-center pT20 pB20 pR20 pL30"},[_c("div",{staticClass:"planner-summary-header mB0"},[_vm._v(" "+_vm._s(_vm.placeholder+" "+_vm.$t("maintenance.pm.resource_planner"))+" ")]),_c("pagination",{staticClass:"self-center mR20",attrs:{currentPage:_vm.page,total:_vm.totalCount,perPage:_vm.perPage},on:{"update:currentPage":function($event){_vm.page=$event},"update:current-page":function($event){_vm.page=$event}}})],1),_vm.isLoading?_c("div",{staticClass:"width100 pB20"},[_c("spinner",{staticClass:"mT40",attrs:{show:_vm.isLoading}})],1):_c("el-table",{attrs:{data:_vm.resourcePlannerList,height:"calc(100vh - 380px)",fit:!0}},[_c("el-table-column",{attrs:{width:"40"},scopedSlots:_vm._u([{key:"default",fn:function(record){return[_vm.isDecommission(record.row)?_c("span",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"pointer",attrs:{title:_vm.$t("setup.decommission.decommissioned")}},[_c("fc-icon",{staticClass:"pR5 pT5",attrs:{group:"alert",name:"decommissioning",size:"16"}})],1):_vm._e()]}}])}),_c("el-table-column",{attrs:{prop:"resource",label:_vm.mainFieldName},scopedSlots:_vm._u([{key:"default",fn:function(record){return[_vm._v(" "+_vm._s(_vm.getResourceValue(record,"resource"))+" ")]}}])}),_c("el-table-column",{attrs:{prop:"jobPlan",label:_vm.$t("maintenance.pm.job_plan")},scopedSlots:_vm._u([{key:"default",fn:function(record){return[_vm._v(" "+_vm._s(_vm.getResourceValue(record,"jobPlan"))+" ")]}}])}),_c("el-table-column",{attrs:{prop:"assignedTo",label:_vm.$t("maintenance.wr_list.assignedto")},scopedSlots:_vm._u([{key:"default",fn:function(record){return[_vm._v(" "+_vm._s(_vm.getResourceValue(record,"assignedTo"))+" ")]}}])})],1)],1)},ResourcePlannerListvue_type_template_id_15d5d5e8_staticRenderFns=[],WidgetPagination=__webpack_require__(806339),isEqual=__webpack_require__(618446),isEqual_default=__webpack_require__.n(isEqual),relatedFieldUtil=__webpack_require__(850558),ResourcePlannerListvue_type_script_lang_js={name:"ResourcePlannerList",props:["placeholder"],components:{Pagination:WidgetPagination/* default */.Z},created:function(){this.loadResources()},data:function(){return{isLoading:!1,moduleName:"pmResourcePlanner",resourcePlannerList:[],page:1,totalCount:0,perPage:10}},watch:{page:{handler:function(newVal,oldVal){isEqual_default()(newVal,oldVal)||this.loadResources()}}},computed:{plannerId:function(){var $attrs=this.$attrs,_ref=$attrs||{},planner=_ref.planner,_ref2=planner||{},plannerId=_ref2.id;return plannerId},mainFieldName:function(){var placeholder=this.placeholder,placeholderHash={Sites:this.$t("maintenance.pm.site_name"),Assets:this.$t("maintenance.pm.asset_name"),Spaces:this.$t("maintenance.pm.space_name"),Buildings:this.$t("maintenance.pm.building_name")};return this.$getProperty(placeholderHash,placeholder,this.$t("maintenance.pm.resource"))}},methods:{loadResources:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var _ref3,moduleName,page,plannerId,params,relatedFieldName,relatedConfig,_yield$API$fetchAllRe,error,list,meta;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _ref3=_this||{},moduleName=_ref3.moduleName,page=_ref3.page,plannerId=_ref3.plannerId,_this.isLoading=!0,params={page:page,perPage:10,withCount:!0},relatedFieldName=(0,relatedFieldUtil/* getRelatedFieldName */.C9)("pmPlanner",moduleName),relatedConfig={moduleName:"pmPlanner",id:plannerId,relatedModuleName:moduleName,relatedFieldName:relatedFieldName},_context.next=7,api/* API */.bl.fetchAllRelatedList(relatedConfig,params);case 7:_yield$API$fetchAllRe=_context.sent,error=_yield$API$fetchAllRe.error,list=_yield$API$fetchAllRe.list,meta=_yield$API$fetchAllRe.meta,(0,validation/* isEmpty */.xb)(error)?(_this.totalCount=_this.$getProperty(meta,"pagination.totalCount"),_this.resourcePlannerList=list):_this.$message.error(error.message||"Error occured"),_this.isLoading=!1;case 13:case"end":return _context.stop()}}),_callee)})))()},isDecommission:function(data){var _ref4=data||{},resource=_ref4.resource,_ref5=resource||{},decommission=_ref5.decommission;return!(0,validation/* isEmpty */.xb)(decommission)&&decommission},getResourceValue:function(record,prop){var value=this.$getProperty(record,"row.".concat(prop,".name"),"---");return value}}},summary_ResourcePlannerListvue_type_script_lang_js=ResourcePlannerListvue_type_script_lang_js,ResourcePlannerList_component=(0,componentNormalizer/* default */.Z)(summary_ResourcePlannerListvue_type_script_lang_js,ResourcePlannerListvue_type_template_id_15d5d5e8_render,ResourcePlannerListvue_type_template_id_15d5d5e8_staticRenderFns,!1,null,null,null)
/* harmony default export */,ResourcePlannerList=ResourcePlannerList_component.exports,vue_scrollto=__webpack_require__(593081),vue_scrollto_default=__webpack_require__.n(vue_scrollto),PMPlannerDetailsvue_type_script_lang_js={name:"PMPlannerDetails",props:["details","resizeWidget"],components:{PlannerSummary:PlannerSummary,ResourcePlanner:ResourcePlannerList},created:function(){this.init()},mounted:function(){this.autoResize()},data:function(){return{moduleName:"pmPlanner",plannerList:[],isListLoading:!1,selectedPlannerId:null,selectedTab:"summary"}},computed:{resourcePlaceholder:function(){var _ref=this||{},details=_ref.details,_ref2=details||{},assignmentTypeEnum=_ref2.assignmentTypeEnum;return pm_utils/* SCOPE_CATEGORY_PLACEHOLDER */.B3[assignmentTypeEnum]||this.$t("maintenance.pm.resources")},summaryTabs:function(){var _ref3=this||{},resourcePlaceholder=_ref3.resourcePlaceholder;return[{displayName:"Summary",name:"summary"},{displayName:"".concat(resourcePlaceholder," Planner"),name:"resourcePlanner"}]}},methods:{autoResize:function(){var _this=this;this.$nextTick((function(){var container=_this.$refs["pm-planner-details"];if(container){var height=container.scrollHeight+40,width=container.scrollWidth;_this.resizeWidget&&_this.resizeWidget({height:height,width:width})}}))},init:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.next=2,_this2.loadPlannerList();case 2:case"end":return _context.stop()}}),_callee)})))()},loadPlannerList:function(){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var _ref4,moduleName,details,_ref5,id,relatedFieldName,relatedConfig,_yield$API$fetchAllRe,error,list,selectedPlanner,_ref6,_id;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _this3.isListLoading=!0,_ref4=_this3||{},moduleName=_ref4.moduleName,details=_ref4.details,_ref5=details||{},id=_ref5.id,relatedFieldName=(0,relatedFieldUtil/* getRelatedFieldName */.C9)("plannedmaintenance",moduleName),relatedConfig={moduleName:"plannedmaintenance",id:id,relatedModuleName:moduleName,relatedFieldName:relatedFieldName},_context2.next=7,api/* API */.bl.fetchAllRelatedList(relatedConfig);case 7:_yield$API$fetchAllRe=_context2.sent,error=_yield$API$fetchAllRe.error,list=_yield$API$fetchAllRe.list,(0,validation/* isEmpty */.xb)(error)?(_this3.plannerList=list||[],(0,validation/* isEmpty */.xb)(list)||(selectedPlanner=list[0],_ref6=selectedPlanner||{},_id=_ref6.id,_this3.selectedPlannerId="".concat(_id))):_this3.$message.error(error.message||_this3.$t("maintenance.pm.planner_list_error")),_this3.isListLoading=!1;case 12:case"end":return _context2.stop()}}),_callee2)})))()},toggleTab:function(name){this.selectedTab=name,vue_scrollto_default().scrollTo("#".concat(name),500,{container:".pm-tabs-container",easing:"ease-in",offset:-10,force:!0})},isSelectedTab:function(tab){var _ref7=this||{},selectedTab=_ref7.selectedTab,_ref8=tab||{},name=_ref8.name;return name===selectedTab}}},summary_PMPlannerDetailsvue_type_script_lang_js=PMPlannerDetailsvue_type_script_lang_js,PMPlannerDetails_component=(0,componentNormalizer/* default */.Z)(summary_PMPlannerDetailsvue_type_script_lang_js,render,staticRenderFns,!1,null,"305baac2",null)
/* harmony default export */,PMPlannerDetails=PMPlannerDetails_component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/35529.js.map