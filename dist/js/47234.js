(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[47234],{
/***/919324:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return CodeMirror}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/CodeMirror.vue?vue&type=template&id=f33b888a
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("codemirror",{attrs:{options:_vm.cmOption,placeholder:_vm.placeholder},on:{input:_vm.onCmCodeChange,ready:_vm.onCmReady,focus:_vm.onCmFocus},model:{value:_vm.script,callback:function($$v){_vm.script=$$v},expression:"script"}})],1)},staticRenderFns=[],vue_codemirror=__webpack_require__(375055),CodeMirrorvue_type_script_lang_js=(__webpack_require__(304631),__webpack_require__(471707),__webpack_require__(959372),__webpack_require__(620017),__webpack_require__(796876),__webpack_require__(988386),{data:function(){return{script:null,cmOption:{tabSize:4,styleActiveLine:!0,mode:"text/javascript",theme:"default",lineNumbers:!0,line:!0,matchBrackets:!0,foldGutter:!0,placeholder:!1,hintOptions:{completeSingle:!1},showCursorWhenSelecting:!0}}},props:["value","options","placeholder"],components:{codemirror:vue_codemirror.codemirror},computed:{codemirror:function(){return this.$refs.myCm.codemirror}},watch:{value:{handler:function(){this.script=this.$helpers.cloneObject(this.value),this.options&&Object.assign(this.cmOption,this.options)},immediate:!0}},methods:{onCmReady:function(cm){},onCmFocus:function(cm){},onCmCodeChange:function(newCode){this.$emit("input",newCode)},addCode:function(code){this.script=this.script+="\n"+code+"\n"},onCmScroll:function(){}}}),components_CodeMirrorvue_type_script_lang_js=CodeMirrorvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_CodeMirrorvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,CodeMirror=component.exports},
/***/706512:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FSafeLimit}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/FSafeLimit.vue?vue&type=template&id=62fb55f3
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"mT20 pB20"},[_c("div",{staticClass:"fc-text-pink2 mT20"},[_vm._v("SAFE LIMIT")]),_c("p",{staticClass:"grey-text2 pT5"},[_vm._v(" "+_vm._s(_vm.$t("setup.users_management.specify_rules_for_reading"))+" ")]),_c("el-row",{staticClass:"mT20"},[_c("el-col",{staticClass:"mT10",attrs:{span:6}},[_c("el-radio",{staticClass:"fc-radio-btn fc-radio-btn2",attrs:{label:"none"},on:{change:function($event){return _vm.clearData(_vm.field.safeLimitPattern)}},model:{value:_vm.field.safeLimitPattern,callback:function($$v){_vm.$set(_vm.field,"safeLimitPattern",$$v)},expression:"field.safeLimitPattern"}},[_vm._v(" "+_vm._s(_vm.$t("maintenance.wr_list.none"))+" ")])],1)],1),_c("el-row",{staticClass:"mT10"},[_c("el-col",{staticClass:"mT10",attrs:{span:7}},[_c("el-radio",{staticClass:"fc-radio-btn fc-radio-btn2",attrs:{label:"greater"},on:{change:function($event){return _vm.clearData(_vm.field.safeLimitPattern)}},model:{value:_vm.field.safeLimitPattern,callback:function($$v){_vm.$set(_vm.field,"safeLimitPattern",$$v)},expression:"field.safeLimitPattern"}},[_vm._v("Greater Than")])],1),"greater"===_vm.field.safeLimitPattern?_c("el-col",{attrs:{span:6}},[_c("el-input",{staticClass:"fc-input-full-border2",model:{value:_vm.field.greaterThan,callback:function($$v){_vm.$set(_vm.field,"greaterThan",$$v)},expression:"field.greaterThan"}})],1):_vm._e()],1),_c("el-row",{staticClass:"mT10"},[_c("el-col",{staticClass:"mT10",attrs:{span:7}},[_c("el-radio",{staticClass:"fc-radio-btn fc-radio-btn2",attrs:{label:"lesser"},on:{change:function($event){return _vm.clearData(_vm.field.safeLimitPattern)}},model:{value:_vm.field.safeLimitPattern,callback:function($$v){_vm.$set(_vm.field,"safeLimitPattern",$$v)},expression:"field.safeLimitPattern"}},[_vm._v("Lesser Than")])],1),"lesser"===_vm.field.safeLimitPattern?_c("el-col",{attrs:{span:6}},[_c("el-input",{staticClass:"fc-input-full-border2",model:{value:_vm.field.lesserThan,callback:function($$v){_vm.$set(_vm.field,"lesserThan",$$v)},expression:"field.lesserThan"}})],1):_vm._e()],1),_c("el-row",{staticClass:"mT10"},[_c("el-col",{staticClass:"mT10",attrs:{span:6}},[_c("el-radio",{staticClass:"fc-radio-btn fc-radio-btn2",attrs:{label:"between"},on:{change:function($event){return _vm.clearData(_vm.field.safeLimitPattern)}},model:{value:_vm.field.safeLimitPattern,callback:function($$v){_vm.$set(_vm.field,"safeLimitPattern",$$v)},expression:"field.safeLimitPattern"}},[_vm._v("Between")])],1),"between"===_vm.field.safeLimitPattern?_c("div",[_c("el-col",{attrs:{span:6}},[_c("el-input",{staticClass:"fc-input-full-border2",model:{value:_vm.field.betweenFrom,callback:function($$v){_vm.$set(_vm.field,"betweenFrom",$$v)},expression:"field.betweenFrom"}})],1),_c("el-col",{staticStyle:{"margin-top":"18px","text-align":"center"},attrs:{span:2}},[_c("span",{staticClass:"label-txt-black"},[_vm._v("to")])]),_c("el-col",{attrs:{span:6}},[_c("el-input",{staticClass:"fc-input-full-border2",model:{value:_vm.field.betweenTo,callback:function($$v){_vm.$set(_vm.field,"betweenTo",$$v)},expression:"field.betweenTo"}})],1)],1):_vm._e()],1),_c("div",{staticClass:"mT30"},[_c("el-row",[_c("el-col",{staticClass:"el-checkbox-container mT10",attrs:{span:7}},[_c("el-checkbox",{model:{value:_vm.field.raiseSafeLimitAlarm,callback:function($$v){_vm.$set(_vm.field,"raiseSafeLimitAlarm",$$v)},expression:"field.raiseSafeLimitAlarm"}},[_vm._v("Raise Alarm")])],1),_c("el-col",{staticClass:"mT10",attrs:{span:7}},[_c("div",{staticClass:"label-txt2"},[_vm._v("Alarm Severity")])]),_c("el-col",{attrs:{span:6}},[_c("el-select",{staticClass:"fc-input-full-border-select2",attrs:{placeholder:"Select"},model:{value:_vm.field.safeLimitSeverity,callback:function($$v){_vm.$set(_vm.field,"safeLimitSeverity",$$v)},expression:"field.safeLimitSeverity"}},_vm._l(_vm.alarmSeverity,(function(item){return _c("el-option",{key:item,attrs:{label:item,value:item}})})),1)],1)],1)],1)],1)},staticRenderFns=[],FSafeLimitvue_type_script_lang_js=(__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(425728),__webpack_require__(434284),{props:["value","edit"],data:function(){return{field:{safeLimitId:-1,raiseSafeLimitAlarm:!1,displayName:"",dataType:1,lesserThan:null,greaterThan:null,betweenTo:null,betweenFrom:null,safeLimitPattern:"none",safeLimitSeverity:"Minor"},alarmSeverity:["Critical","Major","Minor"]}},mounted:function(){this.$helpers.extend(this.field,this.value),this.edit&&this.editReadingRules(this.value)},created:function(){this.$store.dispatch("loadAlarmSeverity")},watch:{field:{handler:function(val){this.$emit("input",this.field)},deep:!0}},methods:{editReadingRules:function(fields){var _this=this;this.field.raiseSafeLimitAlarm=!1,this.field.safeLimitSeverity="Minor",this.field.lesserThan=null,this.field.greaterThan=null,this.field.betweenTo=null,this.field.betweenFrom=null,this.field.safeLimitPattern="none",fields.readingRules&&fields.readingRules.forEach((function(rule){if("(b!=-1&&a<b)||(c!=-1&&a>c)"===rule.workflow.resultEvaluator){var min=rule.workflow.expressions.find((function(e){return"b"===e.name})).constant,max=rule.workflow.expressions.find((function(e){return"c"===e.name})).constant;"-1"===min&&"-1"===max?_this.field.safeLimitPattern="none":"-1"===min?(_this.field.safeLimitPattern="lesser",_this.field.lesserThan=max):"-1"===max?(_this.field.safeLimitPattern="greater",_this.field.greaterThan=min):(_this.field.safeLimitPattern="between",_this.field.betweenTo=max,_this.field.betweenFrom=min),_this.field.safeLimitId=rule.id||-1,rule.actions&&(_this.field.safeLimitSeverity=rule.actions[0].template.originalTemplate.severity,_this.field.raiseSafeLimitAlarm=!0)}}))},clearData:function(safeLimitPattern){"none"===safeLimitPattern?(this.field.lesserThan=null,this.field.greaterThan=null,this.field.betweenFrom=null,this.field.betweenTo=null):"lesser"===safeLimitPattern?(this.field.greaterThan=null,this.field.betweenFrom=null,this.field.betweenTo=null):"greater"===safeLimitPattern?(this.field.lesserThan=null,this.field.betweenFrom=null,this.field.betweenTo=null):"between"===safeLimitPattern&&(this.field.lesserThan=null,this.field.greaterThan=null)}}}),components_FSafeLimitvue_type_script_lang_js=FSafeLimitvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FSafeLimitvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FSafeLimit=component.exports},
/***/372587:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return SpaceAssetChooser}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/SpaceAssetChooser.vue?vue&type=template&id=daefb110
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{attrs:{visible:_vm.visibility,fullscreen:!1,open:"top","custom-class":" fc-dialog-up spaceassetchooser setup-dialog60","append-to-body":!0,"before-close":_vm.handleclose},on:{"update:visible":function($event){_vm.visibility=$event}}},[_c("div",{attrs:{id:"spaceassetchooser"}},[_c("div",{staticStyle:{height:"600px","max-height":"600px"}},[_vm.hideSidebar?_vm._e():_c("div",{staticClass:"sidebar",staticStyle:{height:"100%",width:"33%",display:"inline-block"}},[_c("div",{staticClass:"pT30",staticStyle:{"margin-left":"30px","z-index":"100"}},[_c("div",{staticClass:"flLeft",staticStyle:{"padding-right":"30px"},attrs:{disabled:"asset"===_vm.picktype},on:{click:function($event){"asset"!==_vm.picktype&&_vm.openSpace()}}},[_c("div",{staticClass:"flLeft",staticStyle:{"padding-top":"1px"}},[_c("i",{staticClass:"el-icon-circle-check",class:_vm.isAsset?"normalspace":"selectedspace"})]),_c("div",{staticClass:"txtstyle pointer flLeft",staticStyle:{"padding-left":"5px"}},[_vm._v(" "+_vm._s(_vm.$t("common.space_asset_chooser.space"))+" ")]),_c("div",{staticClass:"clearboth"})]),_c("div",{staticClass:"flLeft",attrs:{disabled:"space"===_vm.picktype},on:{click:function($event){"space"!==_vm.picktype&&_vm.openAsset()}}},[_c("div",{staticClass:"flLeft",staticStyle:{"padding-top":"1px"}},[_c("i",{staticClass:"el-icon-circle-check",class:_vm.isAsset?"selectedspace":"normalspace"})]),_c("div",{staticClass:"flLeft"},[_c("span",{staticClass:"txtstyle pointer",staticStyle:{"padding-left":"5px"}},[_vm._v(_vm._s(_vm.$t("common.space_asset_chooser.asset")))])]),_c("div",{staticClass:"clearboth"})]),_c("div",{staticClass:"clearboth"})]),_c("div",{staticStyle:{"margin-left":"30px"}},[_c("div",{staticClass:"space-heading pT30 pB5"},[_vm._v(" "+_vm._s(_vm.$t("common.space_asset_chooser.by_location"))+" ")]),_vm._l(_vm.resourceConfig,(function(field){return _c("div",{key:field.spaceType,staticClass:"pB15"},[_c("el-select",{attrs:{filterable:"",clearable:"",placeholder:field.placeHolder,"data-test-selector":""+field.placeHolder,disabled:4===field.spaceType&&!_vm.isAsset||field.disabled},on:{change:function($event){return _vm.onLocationSelected(field)}},model:{value:field.value,callback:function($$v){_vm.$set(field,"value",$$v)},expression:"field.value"}},_vm._l(field.options,(function(option){return _c("el-option",{key:option.id,attrs:{label:option.name,value:option.id,"data-test-selector":field.placeHolder+"_"+option.name}})})),1)],1)})),_c("div",{staticClass:"pT30"},[_c("div",{staticClass:"space-heading pT15 pB5"},[_vm._v(" "+_vm._s(_vm.$t("common.space_asset_chooser.by_category"))+" ")]),_c("div",[_vm.isAsset?_c("el-select",{attrs:{filterable:"",clearable:"",placeholder:_vm.assetCategory.placeHolder,"data-test-selector":""+_vm.$t("common.space_asset_chooser.by_category"),disabled:!_vm.isAsset},on:{change:_vm.onCategorySelected},model:{value:_vm.assetCategory.value,callback:function($$v){_vm.$set(_vm.assetCategory,"value",$$v)},expression:"assetCategory.value"}},_vm._l(_vm.assetCategory.options,(function(label,value){return _c("el-option",{key:value,attrs:{label:label,value:value,"data-test-selector":_vm.$t("common.space_asset_chooser.by_category")+"_"+label}})})),1):_c("el-select",{staticClass:"inline asset-category fc-input-full-border2",attrs:{filterable:"",clearable:"",placeholder:_vm.spaceCategory.placeHolder},on:{change:_vm.onSpaceCategorySelected},model:{value:_vm.spaceCategory.value,callback:function($$v){_vm.$set(_vm.spaceCategory,"value",$$v)},expression:"spaceCategory.value"}},_vm._l(_vm.spaceCategory.options,(function(label,value){return _c("el-option",{key:value,attrs:{label:label,value:value}})})),1)],1)])],2)]),_c("div",{staticClass:"pull-right heightlist",style:{width:_vm.hideSidebar?"100%":"67%"}},[_c("div",{staticStyle:{"padding-left":"20px","padding-right":"20px"}},[_vm.showQuickSearch?_c("div",{staticStyle:{display:"inline-block",width:"100%"}},[_c("div",{staticClass:"col-6 fc-list-search"},[_c("div",{staticClass:"fc-list-search-wrapper relative chooser-search"},[_c("svg",{staticClass:"search-icon",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32"}},[_c("title",[_vm._v(_vm._s(_vm.$t("common._common.search")))]),_c("path",{attrs:{d:"M21.487 22.927l7.037 7.037c.473.473 1.238.475 1.71.003s.47-1.237-.003-1.71l-7.037-7.037c3.96-4.82 3.675-11.967-.846-16.487C17.539-.076 9.757-.092 4.966 4.699S.191 17.272 5 22.081c4.52 4.52 11.667 4.805 16.487.846zM6.679 6.413c3.848-3.848 10.099-3.836 13.962.027s3.875 10.114.027 13.962c-3.848 3.848-10.099 3.836-13.962-.027S2.831 10.261 6.679 6.413z"}})]),_c("input",{directives:[{name:"model",rawName:"v-model",value:_vm.quickSearchQuery,expression:"quickSearchQuery"}],ref:"quickSearchQuery",staticClass:"quick-search-input",attrs:{autofocus:"autofocus",type:"text",placeholder:"Search"},domProps:{value:_vm.quickSearchQuery},on:{keyup:function($event){return!$event.type.indexOf("key")&&_vm._k($event.keyCode,"enter",13,$event.key,"Enter")?null:_vm.loadResourceData.apply(null,arguments)},input:function($event){$event.target.composing||(_vm.quickSearchQuery=$event.target.value)}}}),_c("svg",{staticClass:"close-icon",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32","aria-hidden":"true"},on:{click:_vm.toggleQuickSearch}},[_c("title",[_vm._v("close")]),_c("path",{attrs:{d:"M17.992 16l8.796-8.796a1.409 1.409 0 0 0-1.992-1.992L16 14.008 7.204 5.212a1.409 1.409 0 0 0-1.992 1.992L14.008 16l-8.796 8.796a1.409 1.409 0 0 0 1.992 1.992L16 17.992l8.796 8.796a1.409 1.409 0 0 0 1.992-1.992L17.992 16z"}})])])])]):_c("div",{staticClass:"flex-middle justify-content-space"},[_c("span",{staticClass:"spaceheading",staticStyle:{display:"inline-block"}},[_vm._v(_vm._s(_vm.isAsset?this.$t("common.space_asset_chooser.asset_list"):this.$t("common.space_asset_chooser.space_list")))]),_c("span",{staticClass:"pull-right pointer"},[_c("span",{on:{click:_vm.toggleQuickSearch}},[_c("i",{staticClass:"el-icon-search"})])])])]),_c("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:_vm.loadMores,expression:"loadMores"}],staticClass:"scroll",attrs:{"infinite-scroll-distance":"10","infinite-scroll-immediate-check":"true"}},[_c("v-infinite-scroll",{staticStyle:{"max-height":"500px",height:"500px","overflow-y":"scroll"},attrs:{loading:_vm.loading,offset:20},on:{bottom:_vm.nextPage}},[_c("table",{staticClass:" pT15 fc-list-view-table"},[_c("thead",[_c("tr",{staticClass:"tablerow pT30",staticStyle:{"background-color":"#ffffff",padding:"15px"}},[_c("td",{staticClass:"headerrow width30"},[_vm._v(" #"+_vm._s(_vm.$t("common._common.id"))+" ")]),_c("td",{staticClass:"headerrow width30"},[_vm._v(" "+_vm._s(_vm.$t("common.space_asset_chooser.name"))+" ")]),_vm.hideSidebar?_vm._e():_c("td",{staticClass:"headerrow width30"},[_vm._v(" "+_vm._s(_vm.$t("common.space_asset_chooser.category"))+" ")]),_c("td"),_c("td")])]),_c("tbody",[_vm._l(_vm.spaceList,(function(space){return _vm.isAsset?_vm._e():_c("tr",{key:space.id,staticClass:"tablerow",class:{selectedrow:_vm.selectedObj===space},attrs:{"data-test-selector":""+space.name},on:{click:function($event){return _vm.select(space,1)}}},[_c("td",{staticClass:"contentrow width30"},[_vm._v(" #"+_vm._s(1==space.spaceType?"SI"+space.id:2==space.spaceType?"BU"+space.id:3==space.spaceType?"FL"+space.id:4==space.spaceType?"SP"+space.id:space.id)+" ")]),_c("td",{staticClass:"contentrow width30"},[_vm._v(_vm._s(space.name))]),_c("td",{staticClass:"contentrow width30"},[_vm._v(_vm._s(space.spaceTypeVal))]),_c("td"),_c("td",[_c("i",{staticClass:"el-icon-check",staticStyle:{color:"#39b2c2","padding-left":"20px"},style:{visibility:_vm.selectedObj===space?"visible":"hidden"}})])])})),_vm._l(_vm.assetList,(function(asset){return _vm.isAsset?_c("tr",{key:"asset_"+asset.id,staticClass:"tablerow",class:{selectedrow:_vm.selectedObj===asset},attrs:{"data-test-selector":""+asset.name},on:{click:function($event){return _vm.select(asset,2)}}},[_c("td",{staticClass:"contentrow width30"},[_vm._v("#"+_vm._s(asset.id))]),_c("td",{staticClass:"contentrow width30"},[_vm._v(_vm._s(asset.name))]),_vm.hideSidebar?_vm._e():_c("td",{staticClass:"contentrow width30"},[_vm._v(" "+_vm._s(asset.category?_vm.getAssetCategory(asset.category.id).displayName:"---")+" ")]),_c("td"),_c("td",[_c("i",{staticClass:"el-icon-check",staticStyle:{color:"#39b2c2","padding-left":"20px"},style:{visibility:_vm.selectedObj===asset?"visible":"hidden"}})])]):_vm._e()})),_vm.spaceList.length<1&&_vm.assetList.length<1?_c("tr",{staticStyle:{background:"none",border:"none","margin-top":"20px"}},[_c("td",{staticClass:"text-center label-txt-black",staticStyle:{"border-bottom":"none","font-size":"14px","padding-top":"40px",cursor:"auto"},attrs:{colspan:"100%"}},[_vm._v(" No "+_vm._s(_vm.isAsset?"Asset":"Space")+" to display! ")])]):_vm._e()],2)])])],1),_c("div",{staticClass:"space-asset-footer"},[_c("div",{staticClass:"space-asset-footer-align"},[_c("el-button",{staticStyle:{"font-size":"13px","font-weight":"bold",border:"2px solid #cde2e5",color:"#8eb1b6","letter-spacing":"0.5px",padding:"8px",width:"100px","text-transform":"uppercase"},attrs:{"data-test-selector":"SpaceAsset_cancel"},on:{click:_vm.handleclose}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_c("el-button",{staticStyle:{"font-size":"13px","font-weight":"bold","letter-spacing":"0.5px","background-color":"#39b2c2","border-color":"#39b2c2",padding:"8px","text-transform":"uppercase"},attrs:{"data-test-selector":"SpaceAsset_save",type:"primary"},on:{click:_vm.associate}},[_vm._v(_vm._s(_vm.$t("common._common.select")))])],1)])])]),_c("div",{staticStyle:{position:"absolute",top:"40%",left:"55%","z-index":"5"}},[_c("spinner",{attrs:{show:_vm.resourceLoading,size:"70"}})],1)])])},staticRenderFns=[],objectSpread2=__webpack_require__(595082),vue_infinite_scroll=__webpack_require__(49026),vue_infinite_scroll_default=__webpack_require__.n(vue_infinite_scroll),ResourceMixin=__webpack_require__(22637),v_infinite_scroll=__webpack_require__(561364),v_infinite_scroll_default=__webpack_require__.n(v_infinite_scroll),Spinner=__webpack_require__(604947),vuex_esm=__webpack_require__(420629),SpaceAssetChooservue_type_script_lang_js={mixins:[ResourceMixin/* default */.Z],props:["visibility","appendToBody","query","picktype","hideSidebar","isService"],directives:{infiniteScroll:vue_infinite_scroll_default()},components:{Spinner:Spinner/* default */.Z,VInfiniteScroll:v_infinite_scroll_default()},data:function(){return{fetchingMore:!1,selected:!1,selectedObj:{},showQuickSearch:!1}},created:function(){this.$store.dispatch("loadAssetCategory"),this.$store.dispatch("loadSpaceCategory")},mounted:function(){
// quickSearchQuery
"asset"===this.picktype&&(this.isAsset=!0),this.initResourceData()},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapGetters */.Se)(["getAssetCategory"])),{},{scrollDisabled:function(){return!1}}),component:{Spinner:Spinner/* default */.Z},watch:{visibility:function(val){var _this=this;val&&!this.query?(this.reInit(),this.hideSidebar&&(this.showQuickSearch=!0,this.$nextTick((function(){_this.$refs.quickSearchQuery&&_this.$refs.quickSearchQuery.focus()})))):val||!this.query||this.selectedObj&&this.selectedObj.id||this.$emit("associate",{},this.isAsset?"asset":"space")},query:function(val){var _this2=this;this.quickSearchQuery=val,val&&this.$refs.quickSearchQuery&&(this.selectedObj={},this.showQuickSearch=!0,this.$nextTick((function(){_this2.$refs.quickSearchQuery.focus()})),this.loadResourceData())}},methods:{loadMores:function(){this.fetchingMore=!0,this.openAsset(!0)},reInit:function(){this.showQuickSearch=!1,this.quickSearchQuery=null,this.paging.page=1,this.checkAndInitResourceData()},handleclose:function(){this.$emit("update:visibility",!1)},openSpace:function(){this.isAsset=!1,this.paging.page=1,this.loadSpace()},openAsset:function(isLoad){this.isAsset=!0,this.paging.page=1,this.loadAsset(isLoad)},select:function(obj,type){this.selectedObj=obj},associate:function(){this.$emit("associate",this.selectedObj,this.isAsset?"asset":"space")},toggleQuickSearch:function(){var _this3=this;this.showQuickSearch=!this.showQuickSearch,this.showQuickSearch?this.$nextTick((function(){_this3.$refs.quickSearchQuery.focus()})):(this.quickSearchQuery=null,this.loadResourceData())}}},components_SpaceAssetChooservue_type_script_lang_js=SpaceAssetChooservue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_SpaceAssetChooservue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,SpaceAssetChooser=component.exports},
/***/595118:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return DashboardShare}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/dashboard/components/DashboardShare.vue?vue&type=template&id=81a2e1e6
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("el-popover",{ref:"popover5",attrs:{placement:"bottom",width:"350",height:"400","popper-class":"sharepopover"},model:{value:_vm.sharingDialogVisible,callback:function($$v){_vm.sharingDialogVisible=$$v},expression:"sharingDialogVisible"}},[_c("div",{staticClass:"share-container"},[_c("el-row",{staticClass:"share-header",attrs:{align:"middle ",guttr:20}},[_c("el-col",{staticStyle:{"padding-right":"35px","padding-left":"0px"},attrs:{span:24}},[_c("div",{staticClass:"add"},[_c("el-radio",{attrs:{label:1},model:{value:_vm.shareTo,callback:function($$v){_vm.shareTo=$$v},expression:"shareTo"}},[_vm._v(" "+_vm._s(_vm.$t("panel.share.me")))]),_c("el-radio",{attrs:{label:2},model:{value:_vm.shareTo,callback:function($$v){_vm.shareTo=$$v},expression:"shareTo"}},[_vm._v(_vm._s(_vm.$t("panel.share.everyone")))]),_c("el-radio",{attrs:{label:3},model:{value:_vm.shareTo,callback:function($$v){_vm.shareTo=$$v},expression:"shareTo"}},[_vm._v(_vm._s(_vm.$t("panel.share.specific")))])],1)])],1),3===_vm.shareTo?_c("el-row",{staticStyle:{margin:"0px","padding-top":"20px"},attrs:{align:"middle",gutter:20}},[_c("el-col",{staticStyle:{"padding-right":"0px","padding-left":"0px"},attrs:{span:24}},[_c("div",{staticClass:"textcolor"},[_vm._v(_vm._s(_vm.$t("panel.share.users")))]),_c("div",{staticClass:"add"},[_c("el-select",{staticClass:"form-item ",staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:_vm.$t("common.wo_report.choose_users")},model:{value:_vm.sharedUsers,callback:function($$v){_vm.sharedUsers=$$v},expression:"sharedUsers"}},_vm._l(_vm.users,(function(user){return _c("el-option",{key:user.id,attrs:{label:user.name,value:user.id}})})),1)],1)])],1):_vm._e(),3===_vm.shareTo?_c("el-row",{staticStyle:{margin:"0px","padding-top":"20px"},attrs:{align:"middle",gutter:20}},[_c("el-col",{staticStyle:{"padding-right":"0px","padding-left":"0px"},attrs:{span:24}},[_c("div",{staticClass:"textcolor"},[_vm._v(_vm._s(_vm.$t("panel.share.roles")))]),_c("div",{staticClass:"add"},[_c("el-select",{staticClass:"form-item ",staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:_vm.$t("common.wo_report.choose_roles")},model:{value:_vm.sharedRoles,callback:function($$v){_vm.sharedRoles=$$v},expression:"sharedRoles"}},_vm._l(_vm.roles,(function(role){return _c("el-option",{key:role.id,attrs:{label:role.name,value:role.id}})})),1)],1)])],1):_vm._e(),3===_vm.shareTo?_c("el-row",{staticStyle:{margin:"0px","padding-top":"20px"},attrs:{align:"middle",gutter:20}},[_c("el-col",{staticStyle:{"padding-right":"0px","padding-left":"0px"},attrs:{span:24}},[_c("div",{staticClass:"textcolor"},[_vm._v(_vm._s(_vm.$t("panel.share.teams")))]),_c("div",{staticClass:"add"},[_c("el-select",{staticClass:"form-item ",staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:_vm.$t("common.wo_report.choose_teams")},model:{value:_vm.sharedGroups,callback:function($$v){_vm.sharedGroups=$$v},expression:"sharedGroups"}},_vm._l(_vm.groups,(function(group){return _c("el-option",{key:group.id,attrs:{label:group.name,value:group.id}})})),1)],1)])],1):_vm._e(),4===_vm.shareTo?_c("el-row",{staticStyle:{margin:"0px","padding-top":"20px"},attrs:{align:"middle",gutter:20}},[_c("el-col",{staticStyle:{"padding-right":"0px","padding-left":"0px"},attrs:{span:24}},[_c("div",{staticClass:"textcolor"},[_vm._v(_vm._s(_vm.$t("panel.share.portal")))]),_c("div",{staticClass:"add"},[_c("el-select",{staticClass:"form-item ",staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:_vm.$t("common.wo_report.choose_users")},model:{value:_vm.portalusers,callback:function($$v){_vm.portalusers=$$v},expression:"portalusers"}},_vm._l(_vm.portalusers,(function(user){return _c("el-option",{key:user.id,attrs:{label:user.name,value:user.id}})})),1)],1)])],1):_vm._e()],1),_c("div",{staticClass:"dialog-footer row"},[_c("div",{staticClass:"col-6 shareoverbtn shrbtn1",on:{click:function($event){_vm.sharingDialogVisible=!1}}},[_vm._v(" "+_vm._s(_vm.$t("panel.share.cancel"))+" ")]),_c("div",{staticClass:"col-6 shareoverbtn shrbtn2",on:{click:_vm.applySharing}},[_vm._v(" "+_vm._s(_vm.$t("panel.share.confirm"))+" ")])])]),_c("div",{directives:[{name:"popover",rawName:"v-popover:popover5",arg:"popover5"}]},[_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-share default dashboard-edit share-icon",attrs:{title:"Share","data-position":"top","data-arrow":"true"}})])],1)},staticRenderFns=[],objectSpread2=__webpack_require__(595082),ReportHelper=(__webpack_require__(670560),__webpack_require__(507815)),vuex_esm=__webpack_require__(420629),DashboardSharevue_type_script_lang_js={mixins:[ReportHelper/* default */.Z],props:["id","dashboard"],data:function(){return{shareTo:2,sharedUsers:[],sharedRoles:[],portalusers:[],sharedGroups:[],sharingDialogVisible:!1}},watch:{dashboard:{handler:function(newData,oldData){newData!==oldData&&this.loadSharing()},deep:!0}},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({groups:function(state){return state.groups},users:function(state){return state.users},roles:function(state){return state.roles}})),(0,vuex_esm/* mapGetters */.Se)(["getCurrentUser"])),{},{dashboardLink:function(){return this.$route.params.dashboardlink}}),created:function(){this.$store.dispatch("loadRoles"),this.$store.dispatch("loadGroups"),this.$store.dispatch("loadUsers")},mounted:function(){this.loadSharing(),this.loadPortalUsers()},methods:{loadPortalUsers:function(){var self=this;self.$http.get("/setup/portalusers").then((function(response){self.portalusers=response.data.users}))},loadSharing:function(){var self=this;null!==self.dashboard&&self.$http.get("/dashboardsharing/"+self.dashboard.id).then((function(response){if(response.data.dashboardSharing)if(0===response.data.dashboardSharing.length)self.shareTo=2;else{self.sharedUsers=[],self.sharedRoles=[],self.sharedGroups=[];for(var i=0;i<response.data.dashboardSharing.length;i++){var dashboardSharing=response.data.dashboardSharing[i];1===dashboardSharing.sharingType?self.sharedUsers.push(dashboardSharing.orgUserId):2===dashboardSharing.sharingType?self.sharedRoles.push(dashboardSharing.roleId):3===dashboardSharing.sharingType?self.sharedGroups.push(dashboardSharing.groupId):4===dashboardSharing.sharingType&&self.sharedUsers.push(dashboardSharing.orgUserId)}1===response.data.dashboardSharing.length&&1===self.sharedUsers.length&&self.sharedUsers[0]===self.getCurrentUser().ouid?self.shareTo=1:self.shareTo=3}}))},applySharing:function(){var self=this;self.sharingDialogVisible=!1;var dashboardSharing=[];if(1===self.shareTo)dashboardSharing.push({dashboardId:self.dashboard.id,sharingType:1,orgUserId:self.getCurrentUser().ouid});else if(3===self.shareTo){if(self.sharedUsers.length>0){dashboardSharing.push({dashboardId:self.dashboard.id,sharingType:1,orgUserId:self.getCurrentUser().ouid});for(var i=0;i<self.sharedUsers.length;i++)self.sharedUsers[i]!==self.getCurrentUser().ouid&&dashboardSharing.push({dashboardId:self.dashboard.id,sharingType:1,orgUserId:self.sharedUsers[i]})}if(self.sharedRoles.length>0)for(var _i=0;_i<self.sharedRoles.length;_i++)dashboardSharing.push({dashboardId:self.dashboard.id,sharingType:2,roleId:self.sharedRoles[_i]});if(self.sharedGroups.length>0)for(var _i2=0;_i2<self.sharedGroups.length;_i2++)dashboardSharing.push({dashboardId:self.dashboard.id,sharingType:3,groupId:self.sharedGroups[_i2]})}else if(4===self.shareTo&&self.sharedUsers.length>0)for(var _i3=0;_i3<self.sharedUsers.length;_i3++)self.sharedUsers[_i3]!==self.getCurrentUser().ouid&&dashboardSharing.push({dashboardId:self.dashboard.id,sharingType:1,orgUserId:self.sharedUsers[_i3]});self.$http.post("/dashboardsharing/apply",{dashboardId:self.dashboard.id,dashboardSharing:dashboardSharing}).then((function(response){self.$message({message:"Sharing applied successfully!",type:"success"})}))}}},components_DashboardSharevue_type_script_lang_js=DashboardSharevue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_DashboardSharevue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,DashboardShare=component.exports},
/***/171140:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return NewDashboard}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/dashboard/forms/NewDashboard.vue?vue&type=template&id=32f74c7c
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("f-form",{ref:"newDashboardForm",attrs:{type:"dialog50",title:"New Dashboard",model:_vm.model},on:{save:_vm.save},scopedSlots:_vm._u([{key:"form",fn:function(fscope){return[_c("el-row",{attrs:{gutter:50,align:"middle"}},[_c("el-col",{attrs:{span:24}},[_c("q-input",{staticClass:"form-item",attrs:{"float-label":"Name"},model:{value:fscope.formModel.dashboardName,callback:function($$v){_vm.$set(fscope.formModel,"dashboardName",$$v)},expression:"fscope.formModel.dashboardName"}})],1)],1),_c("el-row",{attrs:{gutter:50,align:"middle"}},[_c("el-col",{attrs:{span:24}},[_c("q-input",{staticClass:"form-item",attrs:{"float-label":"Description",type:"textarea"},model:{value:fscope.formModel.dashboardDesc,callback:function($$v){_vm.$set(fscope.formModel,"dashboardDesc",$$v)},expression:"fscope.formModel.dashboardDesc"}})],1)],1),_c("el-row",{attrs:{gutter:50,align:"middle"}},[_c("el-col",{attrs:{span:24}},[_c("q-select",{staticClass:"form-item",attrs:{"float-label":"Module",options:_vm._f("options")(_vm.supportedModules,"displayName","moduleId")},model:{value:fscope.formModel.moduleId,callback:function($$v){_vm.$set(fscope.formModel,"moduleId",$$v)},expression:"fscope.formModel.moduleId"}})],1)],1)]}}])})},staticRenderFns=[],quasar_esm=__webpack_require__(641358),FForm=__webpack_require__(570992),NewDashboardvue_type_script_lang_js={components:{QInput:quasar_esm/* QInput */.Ke,QSelect:quasar_esm/* QSelect */.zO,FForm:FForm/* default */.Z},data:function(){return{model:{dashboardName:null,dashboardDesc:null,moduleId:null},supportedModules:[]}},
// watch: {
//   visibility: function (newVal) {
//     this.visibilityState = newVal
//     if (this.visibilityState) {
//       this.$refs.newDashboardForm.open()
//     }
//     else {
//       this.$refs.newDashboardForm.close()
//     }
//   }
// },
mounted:function(){this.loadSupportedModules()},methods:{loadSupportedModules:function(){var self=this,url="/dashboard/supportedmodules";this.$http.get(url).then((function(response){response.data.modules&&(self.supportedModules=response.data.modules)}))},open:function(){this.$refs.newDashboardForm.open()},close:function(){this.$refs.newDashboardForm.close()},save:function(){var self=this,formModel=self.$refs.newDashboardForm.getFormModel(),formdata={dashboard:{dashboardName:formModel.dashboardName,moduleId:formModel.moduleId}};self.$http.post("/dashboard/add",formdata).then((function(response){self.$message({message:"Dashboard created successfully!",type:"success"}),self.close()}))}}},forms_NewDashboardvue_type_script_lang_js=NewDashboardvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(forms_NewDashboardvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,NewDashboard=component.exports},
/***/967850:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return MoveReportToDashBoard}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/energy/analytics/newTools/MoveReportToDashBoard.vue?vue&type=template&id=340232a5
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("el-dialog",{attrs:{title:_vm.$t("home.dashboard.dashboard_add"),visible:_vm.enableMoveDialog,"before-close":_vm.handleclose,width:"450px","custom-class":"add-to-dashboard-dialog fc-dialog-center-container","append-to-body":""},on:{"update:visible":function($event){_vm.enableMoveDialog=$event}}},[_c("div",{staticClass:"p20",staticStyle:{"max-height":"450px"}},[_c("div",[_c("p",{staticClass:"grey-text2"},[_vm._v(" "+_vm._s(_vm.$t("common.products.select_the_existing_dashboard__enter_new_dashboard_name"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border2 mT10 width100",attrs:{filterable:""},on:{change:_vm.loadWidgets},model:{value:_vm.choosenDashboard,callback:function($$v){_vm.choosenDashboard=$$v},expression:"choosenDashboard"}},_vm._l(_vm.dashboardFolders,(function(dashboardFolder,index){return _c("el-option-group",{key:index,attrs:{label:dashboardFolder.name}},_vm._l(dashboardFolder.dashboards,(function(dashboard,index1){return _c("el-option",{key:index1,attrs:{label:dashboard.dashboardName,value:dashboard.linkName}})})),1)})),1),_vm.warningMessage?_c("div",{staticStyle:{color:"#FF0000","font-size":"12px","padding-top":"8px"}},[_vm._v(" "+_vm._s(_vm.$t("common.dialog.this_report_already_exists_the_selected_dashboard"))+" ")]):_vm._e()],1),_vm.isTabsEnabled?_c("div",{staticClass:"mT20",attrs:{isTabsEnabled:_vm.isTabsEnabled}},[_c("p",{staticClass:"grey-text2"},[_vm._v(" "+_vm._s(_vm.$t("common.products.select_tab_for_dashboard"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border2 mT10 width100",attrs:{filterable:""},model:{value:_vm.choosenDashboardTab,callback:function($$v){_vm.choosenDashboardTab=$$v},expression:"choosenDashboardTab"}},_vm._l(_vm.dashboardTabs,(function(dashboardTab,dashboardTabIndex){return _c("el-option",{key:dashboardTabIndex,attrs:{label:dashboardTab.name,value:dashboardTab}})})),1)],1):_vm._e(),_c("div",{staticClass:"mT20"},[_c("p",{staticClass:"grey-text2"},[_vm._v(_vm._s(_vm.$t("common.products.widget_title")))]),_c("el-input",{staticClass:"fc-input-full-border2",attrs:{placeholder:_vm.$t("common.dialog.type_a_name_that_describes_your_widget")},model:{value:_vm.widgetTitle,callback:function($$v){_vm.widgetTitle=$$v},expression:"widgetTitle"}})],1),_c("div",{staticClass:"mT20"},[_c("p",{staticClass:"grey-text2"},[_vm._v(_vm._s(_vm.$t("common.products.widget_size")))]),_c("el-radio-group",{model:{value:_vm.widgetSize,callback:function($$v){_vm.widgetSize=$$v},expression:"widgetSize"}},[_c("el-radio-button",{attrs:{label:_vm.$t("common.products.half")}}),_c("el-radio-button",{attrs:{label:_vm.$t("common.products.full")}})],1)],1),_vm.widgetToggle?_c("div",{staticClass:"mT10"},[_c("div",[_vm._v(_vm._s(_vm.$t("common.products.widget_position")))]),_c("el-cascader",{attrs:{options:_vm.widgetPositioningList},model:{value:_vm.widgetPositioning,callback:function($$v){_vm.widgetPositioning=$$v},expression:"widgetPositioning"}})],1):_vm._e(),_c("div",{staticClass:"pT20 pB50 f12 op6"},[_c("i",{staticClass:"el-icon-info"}),_vm._v(" "+_vm._s(_vm.$t("common.dialog.widget_will_be_added_end_the_selected dashboard"))+" ")])]),_c("div",{staticClass:"f-footer row",staticStyle:{height:"46px"}},[_vm._t("footer",(function(){return[_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.cancel}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{disabled:null===_vm.choosenDashboard,type:"primary",loading:_vm.adding},on:{click:_vm.moveToDashBoard}},[_vm._v(_vm._s(_vm.adding?_vm.$t("common.products.adding"):_vm.$t("common._common._add"))+" ")])],1)]}))],2)])],1)},staticRenderFns=[],createForOfIteratorHelper=__webpack_require__(566347),router=(__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(670560),__webpack_require__(634338),__webpack_require__(169358),__webpack_require__(228436),__webpack_require__(434284),__webpack_require__(450886),__webpack_require__(865137),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(564043),__webpack_require__(857267),__webpack_require__(329435)),MoveReportToDashBoardvue_type_script_lang_js={created:function(){var _this=this;this.$http.get("/dashboardWithFolder").then((function(response){_this.dashboardFolders=response.data.dashboardFolders,_this.dashboardFolders&&_this.dashboardFolders.length&&_this.dashboardFolders[0].dashboardFolderId&&(_this.defaultFolderId=_this.dashboardFolders[0].dashboards[0].dashboardFolderId)}))},data:function(){return{dashboardAction:1,dashboardFolders:null,defaultFolderId:null,dashboardWidgets:[],choosenDashboard:null,widgetSize:"Half",widgetTitle:"",widgetPositioning:["end"],widgetToggle:!1,warningMessage:!1,adding:!1,isTabsEnabled:!1,dashboardTabs:null,choosenDashboardTab:null,widgetPositioningList:[{value:"beginning",label:"Beginning"},{value:"end",label:"End"},{value:"beforeTo",label:"Before To",children:[]},{value:"afterTo",label:"After",children:[]}],positions:{START:1,END:2,BEFORE:3,AFTER:4}}},props:["enableMoveDialog","reportObj","moduleName"],computed:{dashBoards:function(){var dashboards={};if(this.dashboardFolders){var dashboardList=[];this.dashboardFolders.forEach((function(folder){folder.dashboards&&dashboardList.push(folder.dashboards)}));var merged=[].concat.apply([],dashboardList);merged.forEach((function(dashboard){dashboards[dashboard.linkName]=dashboard}))}return dashboards},nonExistingDashBoard:function(){var isNew=!0;if(this.choosenDashboard&&this.dashBoards)for(var _i=0,_Object$keys=Object.keys(this.dashBoards);_i<_Object$keys.length;_i++){var dashboard=_Object$keys[_i];dashboard===this.choosenDashboard.trim().toLowerCase()&&(isNew=!1)}return isNew},isDashboardEmpty:function(){if(this.choosenDashboard)return 0===this.dashboardWidgets.length}},watch:{reportObj:function(){this.reportObj&&!this.widgetTitle&&(this.widgetTitle=this.reportObj.report.name)}},methods:{getWidgetWithMaximumHeight:function(){var _step,maxHeightWidget=this.dashboardWidgets[0],maxHeight=this.dashboardWidgets[0].widget.layout.y+this.dashboardWidgets[0].widget.layout.height,_iterator=(0,createForOfIteratorHelper/* default */.Z)(this.dashboardWidgets);try{for(_iterator.s();!(_step=_iterator.n()).done;){var widget=_step.value,height=widget.widget.layout.y+widget.widget.layout.height;maxHeight<height&&(maxHeight=height)}}catch(err){_iterator.e(err)}finally{_iterator.f()}return maxHeightWidget},clearToDefaults:function(){this.dashboardWidgets=[],this.choosenDashboard=null,null!==this.dashboardName&&(this.dashboardName=null),this.widgetSize="Half",this.widgetTitle="",this.widgetPositioning=["end"],this.warningMessage=!1},cancel:function(){this.clearToDefaults(),this.$emit("update:enableMoveDialog",!1)},handleclose:function(done){this.clearToDefaults(),this.$emit("update:enableMoveDialog",!1),done()},sortedWidgetsBasedOnCoordinates:function(){var orderedWidgets=this.computeEucledianDistance(this.dashboardWidgets);return orderedWidgets},computeEucledianDistance:function(widgets){var _step2,final=[],distances={},x1=0,y1=0,_iterator2=(0,createForOfIteratorHelper/* default */.Z)(widgets);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var widgetIndex=_step2.value,xSquare=Math.pow(widgetIndex.widget.layout.x-x1,2),ySquare=Math.pow(widgetIndex.widget.layout.y-y1,2),distance=Math.sqrt(xSquare+ySquare);distances[distance]=widgetIndex}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}var keys=Object.keys(distances),temp=keys.map((function(element){return parseFloat(element)}));temp=temp.sort((function(a,b){return a-b}));var _step3,_iterator3=(0,createForOfIteratorHelper/* default */.Z)(temp);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var widgetDistance=_step3.value;final.push(distances[widgetDistance])}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}return final},addNewWidget:function(dashboardObj){if(this.nonExistingDashBoard||this.isDashboardEmpty){var newWidget=this.getNewWidgetDefaults();newWidget["order"]=1,newWidget["xPosition"]=0,newWidget["yPosition"]=0,dashboardObj.dashboardWidgets||(dashboardObj["dashboardWidgets"]=[]),dashboardObj.dashboardWidgets.push(newWidget)}else if("beforeTo"===this.widgetPositioning[0]||"afterTo"===this.widgetPositioning[0]);else if("beginning"===this.widgetPositioning[0]){var _newWidget=this.getNewWidgetDefaults();_newWidget["order"]=_newWidget["xPosition"]=0,_newWidget["yPosition"]=0;var sortedWidgets=this.sortedWidgetsBasedOnCoordinates(),adjustedWidgets=this.adjustedWidgets(_newWidget,sortedWidgets);dashboardObj.dashboardWidgets=adjustedWidgets}else{var _newWidget2=this.getNewWidgetDefaults(),length=dashboardObj.dashboardWidgets.length-1,temp=dashboardObj.dashboardWidgets[length];_newWidget2["order"]=temp.order+1;var _sortedWidgets=this.sortedWidgetsBasedOnCoordinates(),lastWidget=_sortedWidgets[_sortedWidgets.length-1];_newWidget2["xPosition"]=96-(lastWidget.widget.layout.x+lastWidget.widget.layout.width)>=_newWidget2.layoutWidth?lastWidget.widget.layout.x+lastWidget.widget.layout.width:0,_newWidget2["yPosition"]=96-(lastWidget.widget.layout.x+lastWidget.widget.layout.width)>=_newWidget2.layoutWidth?lastWidget.widget.layout.y:lastWidget.widget.layout.y+lastWidget.widget.layout.height,dashboardObj.dashboardWidgets.push(_newWidget2)}return dashboardObj},getNewWidgetDefaults:function(){var newWidget={};return newWidget["headerText"]=this.widgetTitle?this.widgetTitle:this.reportObj.report.name,newWidget["id"]=-1,newWidget["layoutHeight"]=30,newWidget["layoutWidth"]="Half"===this.widgetSize?48:96,newWidget["moduleName"]=null,newWidget["newReportId"]=this.reportObj.report.id?this.reportObj.report.id:null,newWidget["reportId"]=null,newWidget["staticKey"]=null,newWidget["type"]="chart",newWidget["viewName"]=null,newWidget},getDashboardIdAndName:function(){var temp={};if(this.choosenDashboard.includes("/")){var dashboardNameAndId=this.choosenDashboard.split("/");switch(temp["linkName"]=dashboardNameAndId[0],dashboardNameAndId[0]){case"sitedashboard":temp["type"]="siteId";break;case"buildingdashboard":temp["type"]="buildingId";break;case"chillerdashboard":temp["type"]="chillerId";break}temp["id"]=dashboardNameAndId[1]}else temp["linkName"]=this.choosenDashboard;return temp},moveToDashBoard:function(){var _this2=this;if(this.adding=!0,this.isTabsEnabled&&!this.choosenDashboardTab)return this.$message.error("Please select the dashboard tab"),void(this.adding=!1);var dashboardObj=this.addNewWidget(this.loadDashboardWidgets(this.prepareDashBoardObject())),params={},dashBoardLinkSplit=this.getDashboardIdAndName();dashBoardLinkSplit.id&&dashBoardLinkSplit.type&&(params[dashBoardLinkSplit.type]=dashBoardLinkSplit.id);var updateUrl="/dashboard/update";this.isTabsEnabled&&(dashboardObj.dashboardTabName=this.choosenDashboardTab.name,dashboardObj.tabId=this.choosenDashboardTab.id,dashboardObj.fromType="report_page",updateUrl="/dashboard/updateTab"),dashboardObj["isFromReport"]=!0,params["dashboardMeta"]=dashboardObj,this.$http.post(updateUrl,params).then((function(response){_this2.adding=!1;var dashboardLinkName=null;if(updateUrl.includes("updateTab")?dashboardLinkName=dashboardObj.linkName:response.data.dashboard.linkName&&(dashboardLinkName=response.data.dashboard.linkName),dashboardLinkName){var self=_this2,notifyInstance=_this2.$notify({title:self.$t("common._common.widget_added_successfully"),message:self.$t("common._common.click_here_to_open_dashboard"),type:"success",duration:0,customClass:"report-save-success",onClick:function(){notifyInstance&&notifyInstance.close();var dashboardURL="/app/home/dashboard/"+dashboardLinkName;if((0,router/* isWebTabsEnabled */.tj)()){var _ref=(0,router/* findRouteForTab */.OD)(router/* pageTypes */.As.DASHBOARD_VIEWER)||{},name=_ref.name;name&&(dashboardURL=self.$router.resolve({name:name}).href+"/"+dashboardLinkName)}dashBoardLinkSplit&&dashBoardLinkSplit.id&&(dashboardURL+="/"+dashBoardLinkSplit.id),self.$router.replace({path:dashboardURL})}});_this2.clearToDefaults(),_this2.$emit("update:enableMoveDialog",!1)}})).catch((function(error){error&&_this2.$message.error(_this2.$t("common._common.error_in_adding_new_widget"))}))},loadDashboardWidgets:function(dashboardObj){dashboardObj["dashboardWidgets"]=[];for(var i=0;i<this.dashboardWidgets.length;i++){var temp={};temp["headerText"]=this.dashboardWidgets[i].label,temp["id"]=this.dashboardWidgets[i].widget.id,temp["layoutHeight"]=this.dashboardWidgets[i].widget.layout.height,temp["layoutWidth"]=this.dashboardWidgets[i].widget.layout.width,temp["moduleName"]=null,temp["newReportId"]=this.dashboardWidgets[i].widget.dataOptions.newReportId,temp["order"]=this.dashboardWidgets[i].widget.layout.position,temp["staticKey"]=this.dashboardWidgets[i].widget.dataOptions.staticKey,temp["type"]=this.dashboardWidgets[i].widget.type,temp["viewName"]=this.dashboardWidgets[i].widget.dataOptions.viewName,temp["xPosition"]=this.dashboardWidgets[i].widget.layout.x,temp["yPosition"]=this.dashboardWidgets[i].widget.layout.y,dashboardObj.dashboardWidgets.push(temp)}return dashboardObj},prepareDashBoardObject:function(){var temp={};if(this.nonExistingDashBoard)temp["dashboardName"]=this.choosenDashboard,temp["id"]=this.newdashboardId;else{var dashboard=this.dashBoards[this.choosenDashboard];temp["dashboardName"]=dashboard.dashboardName,temp["id"]=dashboard.id,temp["dashboardId"]=dashboard.id,temp["dashboardFolderId"]=dashboard.dashboardFolderId;var dashboardLinkSplit=this.getDashboardIdAndName();temp["linkName"]=dashboardLinkSplit.linkName}return temp},handleResponse:function(dashboardJson){for(var index in this.isTabsEnabled=!1,this.dashboardWidgets=[],this.dashboardTabs=null,this.choosenDashboardTab=null,dashboardJson){var children=dashboardJson[index].children;for(var index2 in children){var _children$index,temp={};(null===(_children$index=children[index2])||void 0===_children$index||null===(_children$index=_children$index.widget)||void 0===_children$index||null===(_children$index=_children$index.dataOptions)||void 0===_children$index?void 0:_children$index.newReportId)===this.reportObj.report.id&&(this.warningMessage=!0),this.dashboardWidgets.push(children[index2]),null!==children[index2].label&&null!==children[index2].widget.header.title&&(temp["label"]=null!==children[index2].label?children[index2].label:children[index2].widget.header.title,temp["value"]=children[index2].widget.id,this.widgetPositioningList[2].children.push(temp))}dashboardJson[index].tabs&&dashboardJson[index].tabs.length>0&&(this.isTabsEnabled=!0,this.dashboardTabs=dashboardJson[index].tabs)}this.widgetPositioningList[3].children=this.widgetPositioningList[2].children},loadWidgets:function(choosenDashboard){var _this3=this;if(!0!==this.nonExistingDashBoard)if(this.choosenDashboard=choosenDashboard,this.warningMessage=!1,this.choosenDashboard.includes("/")){
// fetch and load widgets
var dashboardPlusId=this.choosenDashboard.split("/"),_url="/dashboard/";if(1===dashboardPlusId.length)_url+=dashboardPlusId[0];else{switch(dashboardPlusId[0]){case"buildingdashboard":_url+="buildingdashboard";break;case"sitedashboard":_url+="sitedashboard";break;case"chillerdashboard":_url+="chillerdashboard";break}_url=_url+"?moduleName="+this.moduleName,dashboardPlusId[1]&&(_url=_url+"&id="+dashboardPlusId[1])}this.$http.get(_url).then((function(response){var dashboardJson=response.data.dashboardJson;_this3.handleResponse(dashboardJson)}))}else{var url="/dashboard/"+this.choosenDashboard;
// '?moduleName=' +
// this.moduleName
this.$http.get(url).then((function(response){var dashboardResponse=response.data.dashboardJson;_this3.handleResponse(dashboardResponse)}))}}}},newTools_MoveReportToDashBoardvue_type_script_lang_js=MoveReportToDashBoardvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(newTools_MoveReportToDashBoardvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,MoveReportToDashBoard=component.exports},
/***/503658:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return BaseDialogBox}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/energy/pivot/Components/BaseDialogBox.vue?vue&type=template&id=4730d566
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_vm.visibility?_c("el-dialog",{attrs:{"custom-class":"base-dialog-box",title:_vm.title,visible:_vm.visibility,"append-to-body":!0,"show-close":!1,"close-on-click-modal":!1,width:_vm.width,"destroy-on-close":!0},on:{"update:visible":function($event){_vm.visibility=$event}}},[_c("div",{staticClass:"title-slot",style:{display:_vm.hideHeader?"none":"block"},attrs:{slot:"title"},slot:"title"},[_c("div",{staticClass:"title-div"},[_vm._v(" "+_vm._s(_vm.title)+" ")]),_c("hr")]),_c("div",{staticClass:"dialog-body"},[_vm._t("body")],2),_c("span",{class:_vm.isAlert?"dialog-footer-alert":"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[_c("el-button",{staticClass:"mR10 dialog-btn confirm-btn",attrs:{disabled:_vm.disableConfirm,type:"el-button  el-button--primary"},on:{click:_vm.onConfirm}},[_vm._v(_vm._s(_vm.confirmText))]),_c("el-button",{staticClass:"mL10 dialog-btn cancel-btn",attrs:{disabled:_vm.disableCancel},on:{click:_vm.onCancel}},[_vm._v(_vm._s(_vm.cancelText))]),_vm.onClearAll?_c("el-button",{staticClass:"clear-all-btn",staticStyle:{"margin-left":"20px !important","text-decoration":"underline"},attrs:{type:"text"},on:{click:_vm.onClearAll}},[_vm._v("Clear all")]):_vm._e()],1)]):_vm._e()],1)},staticRenderFns=[],BaseDialogBoxvue_type_script_lang_js={props:["title","visibility","width","onCancel","cancelText","onConfirm","confirmText","disableCancel","disableConfirm","hideHeader","onClearAll","isAlert"]},Components_BaseDialogBoxvue_type_script_lang_js=BaseDialogBoxvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(Components_BaseDialogBoxvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,BaseDialogBox=component.exports},
/***/608578:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return UnsavedChangesErrorDialogBox}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/energy/pivot/Components/UnsavedChangesErrorDialogBox.vue?vue&type=template&id=1cce89bc&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("base-dialog-box",{attrs:{visibility:_vm.visibility,onConfirm:_vm.save,onCancel:_vm.cancel,hideHeader:!0,isAlert:!0,cancelText:"No",confirmText:"Yes",width:"480px"},on:{"update:visibility":function($event){_vm.visibility=$event}}},[_c("div",{staticClass:"dialog-content-body",attrs:{slot:"body"},slot:"body"},[_c("div",{staticClass:"header"},[_vm._v(" Cancel Editing? ")]),_c("div",{staticClass:"content-body",staticStyle:{"margin-bottom":"0px"}},[_vm._v(" Changes you made so far will not be saved ")])])])],1)},staticRenderFns=[],BaseDialogBox=__webpack_require__(503658),UnsavedChangesErrorDialogBoxvue_type_script_lang_js={props:["visibility"],components:{BaseDialogBox:BaseDialogBox/* default */.Z},methods:{cancel:function(){this.$emit("result",!1),this.$emit("update:visibility",!1)},save:function(){this.$emit("result",!0),this.$emit("update:visibility",!1)}}},Components_UnsavedChangesErrorDialogBoxvue_type_script_lang_js=UnsavedChangesErrorDialogBoxvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(Components_UnsavedChangesErrorDialogBoxvue_type_script_lang_js,render,staticRenderFns,!1,null,"1cce89bc",null)
/* harmony default export */,UnsavedChangesErrorDialogBox=component.exports},
/***/791514:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FReportOptions}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/report/components/FReportOptions.vue?vue&type=template&id=5408f2ec&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_vm.reportId&&_vm.isFromDashboard?_c("el-button",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"freport-btn",staticStyle:{border:"none"},attrs:{title:_vm.$t("common._common.back_to_dashboard"),"data-position":"top","data-arrow":"true"},on:{click:function($event){return _vm.$router.back()}}},[_vm._v(_vm._s(_vm.$t("common.header.back")))]):_vm.reportId?_c("el-button",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"freport-btn",staticStyle:{border:"none"},attrs:{title:_vm.$t("common._common.back_to_report"),"data-position":"top","data-arrow":"true"},on:{click:function($event){_vm.showConfirmDialog=!0}}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]):_vm._e(),_vm.showConfirmDialog?_c("UnsavedChangesErrorDialogBox",{attrs:{visibility:_vm.showConfirmDialog},on:{"update:visibility":function($event){_vm.showConfirmDialog=$event},result:_vm.backToReport}}):_vm._e(),_vm.checkOption("save")&&!_vm.isRegression||_vm.checkOption("save")&&_vm.isRegression&&this.reportObject&&"multiple"===this.reportObject.params.regressionType?_c("f-save-as-report",{attrs:{template:_vm.getReportTemplate(),config:_vm.config,moduleName:_vm.moduleName,moduleFromRoute:_vm.moduleFromRoute,iscustomModule:!!_vm.iscustomModule&&_vm.iscustomModule,report:_vm.reportObject,savedReport:_vm.savedReport},on:{close:_vm.closeSaveDialog}},[_c("el-button",{staticClass:"freport-btn newanalytics-save-as-report mL10",attrs:{slot:"reference",disabled:_vm.isActionsDisabled},on:{click:function($event){_vm.visibility.saveAsDialog=!0}},slot:"reference"},[_vm._v(_vm._s(_vm.reportId?_vm.$t("common.wo_report.update_report"):_vm.$t("common.wo_report.save_as_report")))])],1):_vm._e(),_vm.checkOption("saveExpression")?_c("el-button",{staticClass:"freport-btn newanalytics-save-as-report mL10",attrs:{disabled:_vm.isActionsDisabled||_vm.reportObject&&"undefined"===typeof _vm.reportObject.data},on:{click:function($event){return _vm.initSaveExpression()}}},[_vm._v(_vm._s(_vm.$t("common._common.create_enpi")))]):_vm._e(),_vm.checkOption("saveExpression")?_c("FSaveAsRegression",{attrs:{reportObject:_vm.reportObject,visibility:_vm.visibility.saveRegressionExpr},on:{"update:visibility":function($event){return _vm.$set(_vm.visibility,"saveRegressionExpr",$event)},newEnpiConfig:_vm.openEnpiDialog}}):_vm._e(),_vm.newflow?_c("div",{style:"display:flex;margin:5px 35px 0 0;"},[_vm.reportObject?_c("div",{staticStyle:{height:"26px",width:"74px","margin-bottom":"4px"}},[_vm.hasCreateEditPermission?_c("el-button",{staticClass:"edit-button",attrs:{plain:""},on:{click:function($event){return _vm.editReport(_vm.resultObject.report.id)}}},[_c("InlineSvg",{attrs:{src:"svgs/pivot/edit",iconClass:"icon-sm flex icon"}}),_vm._v(" "+_vm._s(_vm.$t("common.wo_report.edit"))+" ")],1):_vm._e()],1):_vm._e(),_vm.reportObject?_c("div",{staticClass:"more-button",staticStyle:{"margin-left":"20px","margin-bottom":"8px","margin-top":"2px",transform:"rotate(90deg)"}},[_c("el-dropdown",{attrs:{trigger:"click",placement:"bottom","hide-on-click":!1},on:{command:function(command){return _vm.handleCommand(command,_vm.isCloneToAnotherApp)}}},[_c("el-button",{attrs:{icon:"el-icon-more",size:"medium"},on:{click:function($event){$event.stopPropagation()}}}),_c("el-dropdown-menu",{staticClass:"reportoptions",staticStyle:{"margin-left":"155px"},attrs:{slot:"dropdown"},slot:"dropdown"},[_vm.hasDeletePermission?_c("el-dropdown-item",{attrs:{command:"delete"}},[_c("InlineSvg",{attrs:{src:"svgs/pivot/delete-icon",iconClass:"icon-sm flex icon iconstyle"}}),_vm._v(_vm._s(_vm.$t("common.wo_report.delete_report_option")))],1):_vm._e(),1!=_vm.resultObject.report.type&&3!=_vm.resultObject.report.type&&_vm.hasCreateEditPermission?_c("el-dropdown-item",{attrs:{command:"duplicate"}},[_c("InlineSvg",{attrs:{src:"svgs/pivot/duplicate",iconClass:"icon-sm flex icon iconstyle"}}),_vm._v(" "+_vm._s(_vm.$t("common.wo_report.duplicate_report_option")))],1):_vm._e(),_vm.hasCreateEditPermission?_c("el-dropdown-item",{attrs:{command:"move"}},[_c("el-popover",{attrs:{placement:"right",width:"185",title:"Folders",trigger:"hover"}},[_vm._l(_vm.newReportTree,(function(folder){return _c("div",{key:folder.id,staticClass:"pivot-folder-option",on:{click:function($event){return _vm.handleMoveFolder(folder)}}},[_vm._v(" "+_vm._s(folder.name)+" ")])})),_c("button",{staticClass:"move-btn",attrs:{slot:"reference"},slot:"reference"},[_c("InlineSvg",{attrs:{src:"svgs/pivot/Move",iconClass:"icon-sm flex icon iconstyle"}}),_vm._v(" "+_vm._s(_vm.$t("common.wo_report.move_report_option"))+" ")],1)],2)],1):_vm._e(),3!=_vm.resultObject.report.type&&_vm.hasExportPermission?_c("el-dropdown-item",{attrs:{command:"export"}},[_c("el-popover",{attrs:{placement:"right",width:"185",trigger:"hover"}},[_c("div",{staticClass:"pivot-folder-option",on:{click:function(){return _vm.triggerExport("1")}}},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.export_csv_report_option"))+" ")]),_c("div",{staticClass:"pivot-folder-option",on:{click:function(){return _vm.triggerExport("2")}}},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.export_excel_report_option"))+" ")]),_c("div",{staticClass:"pivot-folder-option",on:{click:function(){return _vm.triggerExport("3")}}},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.export_pdf_report_option"))+" ")]),_c("div",{staticClass:"pivot-folder-option",on:{click:function(){return _vm.triggerExport("4")}}},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.export_image_report_option"))+" ")]),_c("button",{staticClass:"move-btn",attrs:{slot:"reference"},slot:"reference"},[_c("InlineSvg",{attrs:{src:"svgs/pivot/Export",iconClass:"icon-xs flex icon iconstyle"}}),_vm._v(" "+_vm._s(_vm.$t("common.wo_report.export_report_option"))+" ")],1)])],1):_vm._e(),3!=_vm.resultObject.report.type&&_vm.hasSchedulePermission?_c("el-dropdown-item",{attrs:{command:"Schedule"}},[_c("img",{staticClass:"report-icon flex icon",staticStyle:{height:"14px",width:"14px","margin-left":"2px","margin-right":"8px"},attrs:{src:__webpack_require__(598685)}}),_vm._v(" "+_vm._s(_vm.$t("common.wo_report.schedule_report_option"))+" ")]):_vm._e(),3!=_vm.resultObject.report.type?_c("el-dropdown-item",{attrs:{command:"Mail"}},[_c("img",{staticClass:"report icon flex icon",staticStyle:{height:"14px",width:"14px","margin-left":"2px","margin-right":"8px"},attrs:{src:__webpack_require__(2175)}}),_vm._v(" "+_vm._s(_vm.$t("common.wo_report.sendmail_report_option"))+" ")]):_vm._e(),3!=_vm.resultObject.report.type&&_vm.hasCreateEditPermission?_c("el-dropdown-item",{attrs:{command:"CloneReport"}},[_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],class:["fa fa-clone"],attrs:{"data-position":"top","data-arrow":"true",title:_vm.$t("home.dashboard.duplicate_report")}}),_vm._v(" "+_vm._s(_vm.$t("common.wo_report.clone_report_option"))+" ")]):_vm._e()],1)],1)],1):_vm._e()]):_c("div",{class:_vm.optionClass},[_vm.checkOption("export")?_c("el-dropdown",{class:{"action-disabled":_vm.isActionsDisabled},attrs:{disabled:_vm.isActionsDisabled},on:{command:function($event){return _vm.triggerExport($event)}}},[_c("el-button",{staticClass:"fc-chart-btn",attrs:{size:"small",type:"text"}},[_c("img",{staticClass:"report-icon",attrs:{src:__webpack_require__(153813)}})]),_c("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[_c("el-dropdown-item",{attrs:{command:"1",disabled:_vm.isActionsDisabled}},[_vm._v(_vm._s(_vm.$t("common.wo_report.export_csv")))]),_c("el-dropdown-item",{attrs:{command:"2",disabled:_vm.isActionsDisabled}},[_vm._v(_vm._s(_vm.$t("common.wo_report.export_xcl")))]),_vm.pdf&&(_vm.params&&_vm.params.reportId||"undefined"===typeof _vm.config)?[_c("el-dropdown-item",{attrs:{command:"3",disabled:_vm.isActionsDisabled}},[_vm._v(_vm._s(_vm.$t("common.wo_report.export_pdf")))]),_vm.optionSettings&&!1===_vm.optionSettings.chart||"pivot"===_vm.reportType?_vm._e():_c("el-dropdown-item",{attrs:{command:"4",disabled:_vm.isActionsDisabled}},[_vm._v(_vm._s(_vm.$t("common.wo_report.export_image"))+" ")])]:_vm._e()],2)],1):_vm._e(),_vm.checkOption("schedule")?_c("el-button",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"fc-chart-btn",attrs:{size:"small",type:"text",title:_vm.$t("home.dashboard.schedule_report"),"data-position":"bottom","data-arrow":"true"},on:{click:function($event){_vm.visibility.showScheduleDialog=!0}}},[_c("img",{staticClass:"report-icon",attrs:{src:__webpack_require__(598685)}})]):_vm._e(),_vm.checkOption("email")?_c("el-button",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"fc-chart-btn",attrs:{size:"small",disabled:_vm.isActionsDisabled,type:"text",title:_vm.$t("common.wo_report.email_this_report"),"data-position":"bottom","data-arrow":"true"},on:{click:function($event){_vm.visibility.showEmailDialog=!0}}},[_c("img",{staticClass:"report-icon",attrs:{src:__webpack_require__(2175)}})]):_vm._e(),_c("outside-click",{staticClass:"comment-dialog",staticStyle:{top:"0"},attrs:{visibility:_vm.visibility.showCommentDialog},on:{"update:visibility":function($event){return _vm.$set(_vm.visibility,"showCommentDialog",$event)}}},[_c("div",[_c("div",{staticClass:"comment-dialog-header"},[_c("h3",{staticClass:"comment-dialog-heading",staticStyle:{"text-transform":"uppercase"}},[_vm._v(" "+_vm._s(_vm.$t("maintenance.wr_list.comments"))+" ")]),_c("div",{staticClass:"comment-close"},[_c("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Close",placement:"bottom"}},[_c("i",{staticClass:"el-icon-close",attrs:{"aria-hidden":"true"},on:{click:function($event){_vm.visibility.showCommentDialog=!1}}})])],1)]),_c("div",{staticClass:"comment-dialog-body"},[_c("comments",{attrs:{module:"reportnotes",notify:!1,record:_vm.reportCommentObject}})],1)])]),_vm.visibility.saveAsEnpi?_c("NewEnpi",{attrs:{isNew:!0,visibility:_vm.visibility.saveAsEnpi,enpi:_vm.loadedEnpi},on:{"update:visibility":function($event){return _vm.$set(_vm.visibility,"saveAsEnpi",$event)}}}):_vm._e()],1),_vm.exportDownloadUrl?_c("iframe",{staticStyle:{display:"none"},attrs:{src:_vm.exportDownloadUrl}}):_vm._e(),_c("el-dialog",{staticClass:"fc-dialog-form pdf-dialog-hide",attrs:{visible:_vm.dialogVisible,width:"20%","before-close":_vm.closeDialog},on:{"update:visible":function($event){_vm.dialogVisible=$event}}},[_c("div",{staticClass:"new-header-container"},[_c("div",{staticClass:"new-header-text"},[_c("div",{staticClass:"fc-setup-modal-title"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.pdf_options"))+" ")])])]),_c("div",{staticClass:"mL40 mT20"},[_c("div",[_c("el-checkbox",{model:{value:_vm.checked,callback:function($$v){_vm.checked=$$v},expression:"checked"}},[_vm._v(_vm._s(_vm.$t("common.wo_report.include_legends")))])],1),_c("div",{staticClass:"mT10"},[_c("el-checkbox",{model:{value:_vm.checked,callback:function($$v){_vm.checked=$$v},expression:"checked"}},[_vm._v(_vm._s(_vm.$t("common.wo_report.include_table")))])],1)]),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){_vm.dialogVisible=!1}}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.saving},on:{click:_vm.save}},[_vm._v(_vm._s(_vm.saving?_vm.$t("common._common._saving"):_vm.$t("common._common._save")))])],1)]),_c("el-dialog",{staticClass:"fc-dialog-center-container",attrs:{title:_vm.$t("common._common.export"),visible:_vm.exportDialog,width:"30%","append-to-body":!0},on:{"update:visible":function($event){_vm.exportDialog=$event}}},[_c("div",{staticClass:"height100px"},[_c("el-radio-group",{model:{value:_vm.exportOption,callback:function($$v){_vm.exportOption=$$v},expression:"exportOption"}},[_c("el-radio",{staticClass:"fc-radio-btn",attrs:{label:1}},[_vm._v(_vm._s(_vm.$t("common._common.tabular_report")))]),_c("el-radio",{staticClass:"fc-radio-btn",attrs:{label:2}},[_vm._v(_vm._s(_vm.$t("common._common.underlying_data")))])],1)],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){_vm.exportDialog=!1}}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:_vm.newExportData}},[_vm._v(_vm._s(_vm.$t("common._common.export")))])],1)]),_vm.showImageOptionsDialog?_c("f-dialog",{staticClass:"print-image-options",attrs:{title:_vm.$constants.FILE_FORMAT[_vm.exportType]+" Settings",visible:_vm.showImageOptionsDialog,width:"30%",confirmTitle:"Export"},on:{save:function($event){_vm.showImageOptionsDialog=!1,_vm.exportData(_vm.exportType)},close:_vm.closeImageOptionsDialog}},[_c("div",{staticClass:"mB20 mT20"},[_c("div",[_c("el-checkbox",{model:{value:_vm.showHeader,callback:function($$v){_vm.showHeader=$$v},expression:"showHeader"}},[_vm._v(_vm._s(_vm.$t("common.wo_report.include_title")))])],1),_c("div",{staticClass:"mT10"},[_c("el-checkbox",{model:{value:_vm.showPrintDetails,callback:function($$v){_vm.showPrintDetails=$$v},expression:"showPrintDetails"}},[_vm._v(_vm._s(_vm.$t("common.wo_report.include_description")))])],1)])]):_vm._e(),_c("MoveReportToDashBoard",{attrs:{enableMoveDialog:_vm.sendToDashBoard,reportObj:_vm.savedReportObj,moduleName:"energyData"},on:{"update:enableMoveDialog":function($event){_vm.sendToDashBoard=$event},"update:enable-move-dialog":function($event){_vm.sendToDashBoard=$event}}}),_vm.showColumnSelectionDialog?_c("column-selection-dialog",{attrs:{moduleName:_vm.moduleName,fields:_vm.reportObject?_vm.reportObject.underlyingFields:null,visibility:_vm.showColumnSelectionDialog},on:{"update:visibility":function($event){_vm.showColumnSelectionDialog=$event},save:_vm.onColumnSelection}}):_vm._e(),_vm.visibility.showEmailDialog?_c("email-report",{attrs:{moduleReportConfig:_vm.computedConfig,moduleName:_vm.moduleName,visibility:_vm.visibility.showEmailDialog,params:_vm.params,chartState:_vm.reportObject.options,report:_vm.reportObject?_vm.reportObject.report:{},url:_vm.url},on:{"update:visibility":function($event){return _vm.$set(_vm.visibility,"showEmailDialog",$event)}}}):_vm._e(),_vm.visibility.showScheduleDialog?_c("schedule-report",{attrs:{moduleName:_vm.moduleName,visibility:_vm.visibility.showScheduleDialog,report:_vm.resultObject?_vm.resultObject.report:{},appId:_vm.appId},on:{"update:visibility":function($event){return _vm.$set(_vm.visibility,"showScheduleDialog",$event)}}}):_vm._e(),_vm.isClone?_c("div",{staticClass:"dashboard-share dialog-box"},[_c("el-dialog",{staticClass:"fc-dialog-center-container report-clone-dialog",attrs:{title:"Clone Report",visible:_vm.isClone,width:"35%","append-to-body":!0},on:{"update:visible":function($event){_vm.isClone=$event}}},[_c("div",[_c("div",[_c("div",{staticClass:"clonePopup"},[_c("el-form",{ref:"cloneDashboardForm",staticClass:"clone_dialog",attrs:{rules:_vm.rules,model:_vm.reportCloneObj}},[_c("el-form-item",{staticClass:"mB10",attrs:{label:"Report Name",prop:"name",required:!0}},[_c("el-input",{staticClass:"width300px fc-input-full-border2 pR15",model:{value:_vm.reportCloneObj.name,callback:function($$v){_vm.$set(_vm.reportCloneObj,"name",$$v)},expression:"reportCloneObj.name"}})],1),_vm.isCloneToAnotherApp?_c("el-form-item",{staticClass:"mB10",attrs:{label:"Target Application",prop:"name"}},[_c("el-select",{staticClass:"fc-input-full-border2 width300px pR15",attrs:{filterable:""},model:{value:_vm.reportCloneObj.selectedAppId,callback:function($$v){_vm.$set(_vm.reportCloneObj,"selectedAppId",$$v)},expression:"reportCloneObj.selectedAppId"}},_vm._l(_vm.apps,(function(app){return _c("el-option",{key:app.linkName,attrs:{label:app.name,value:app.id}})})),1)],1):_vm._e()],1)],1)]),_c("span",{staticClass:"dialog-footer row"},[_c("el-button",{staticClass:"col-6 shareoverbtn shrbtn1",on:{click:function($event){_vm.isClone=!1}}},[_vm._v(" "+_vm._s(_vm.$t("common._common.cancel"))+" ")]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.Saving},on:{click:function($event){return _vm.cloneReporttoAnotherApp(_vm.isCloneToAnotherApp)}}},[_vm._v(" "+_vm._s(_vm.$t("common._common._save"))+" ")])],1)])])],1):_vm._e()],1)},staticRenderFns=[],objectSpread2=__webpack_require__(595082),createForOfIteratorHelper=__webpack_require__(566347),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),element_ui_common=(__webpack_require__(260228),__webpack_require__(919649),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(648324),__webpack_require__(634338),__webpack_require__(336585),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(169358),__webpack_require__(434284),__webpack_require__(228436),__webpack_require__(425728),__webpack_require__(450886),__webpack_require__(538077),__webpack_require__(947522),__webpack_require__(162506),__webpack_require__(670560),__webpack_require__(506203),__webpack_require__(364720)),EmailReportNew=__webpack_require__(853017),FSaveAsReportvue_type_template_id_1b56e916_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("span",[_c("el-popover",{attrs:{"popper-class":"f-popover",placement:"left",width:300},model:{value:_vm.visibility,callback:function($$v){_vm.visibility=$$v},expression:"visibility"}},[_c("div",{staticClass:"fc-popover-content"},[_vm._t("header",(function(){return[_vm.newReport.id&&!_vm.userSpecific?_c("div",{staticClass:"title uppercase f12 bold",staticStyle:{"letter-spacing":"1.1px",color:"#000000"}},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.update_report"))+" ")]):_vm.userSpecific?_vm._e():_c("div",{staticClass:"title uppercase f12 bold",staticStyle:{"letter-spacing":"1.1px",color:"#000000"}},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.save_as_report"))+" ")])]})),_vm.userSpecific?_c("div",[_c("div",{staticClass:"fc-dark-blue-txt13 f13 pointer fwBold",on:{click:function($event){return _vm.back()}}},[_c("i",{staticClass:"el-icon-back fw6 mR10 fc-dark-blue-txt13"}),_vm._v(" "+_vm._s(_vm.$t("common.header.back"))+" ")]),_c("div",[_c("div",[_c("el-radio",{staticClass:"fc-radio-btn pB10 pT10",attrs:{label:1},model:{value:_vm.shareTo,callback:function($$v){_vm.shareTo=$$v},expression:"shareTo"}},[_vm._v(_vm._s(_vm.$t("common.wo_report.only_me")))])],1),_c("div",[_c("el-radio",{staticClass:"fc-radio-btn pB10",attrs:{label:2},model:{value:_vm.shareTo,callback:function($$v){_vm.shareTo=$$v},expression:"shareTo"}},[_vm._v(_vm._s(_vm.$t("common.wo_report.everyone")))])],1),_c("div",[_c("el-radio",{staticClass:"fc-radio-btn pB10",attrs:{label:3},model:{value:_vm.shareTo,callback:function($$v){_vm.shareTo=$$v},expression:"shareTo"}},[_vm._v(_vm._s(_vm.$t("common.wo_report.specific")))])],1),3===_vm.shareTo?_c("el-row",{staticClass:"mT20 el-select-block"},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"label-txt-black pB5"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.team"))+" ")]),_c("el-select",{staticClass:"width100 fc-full-border-select-multiple2",attrs:{filterable:"",multiple:"","collapse-tags":"",placeholder:_vm.$t("common.wo_report.choose_users")},model:{value:_vm.sharedGroups,callback:function($$v){_vm.sharedGroups=$$v},expression:"sharedGroups"}},_vm._l(_vm.groups,(function(group){return _c("el-option",{key:group.id,attrs:{label:group.name,value:group.id}})})),1)],1)],1):_vm._e(),3===_vm.shareTo?_c("el-row",{staticClass:"mT20 el-select-block"},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"label-txt-black pB5"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.role"))+" ")]),_c("el-select",{staticClass:"width100 fc-full-border-select-multiple2",attrs:{filterable:"",multiple:"","collapse-tags":"",placeholder:_vm.$t("common.wo_report.choose_roles")},model:{value:_vm.sharedRoles,callback:function($$v){_vm.sharedRoles=$$v},expression:"sharedRoles"}},_vm._l(_vm.roles,(function(role){return _c("el-option",{key:role.id,attrs:{label:role.name,value:role.id}})})),1)],1)],1):_vm._e(),3===_vm.shareTo?_c("el-row",{staticClass:"mT20 el-select-block"},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"label-txt-black pB5"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.staff"))+" ")]),_c("el-select",{staticClass:"width100 fc-full-border-select-multiple2",attrs:{filterable:"",multiple:"","collapse-tags":"",placeholder:_vm.$t("common.wo_report.choose_teams")},model:{value:_vm.sharedUsers,callback:function($$v){_vm.sharedUsers=$$v},expression:"sharedUsers"}},_vm._l(_vm.users,(function(user){return _c("el-option",{key:user.id,attrs:{label:user.name,value:user.id}})})),1)],1)],1):_vm._e()],1)]):_c("div",[_c("el-form",{ref:"saveAsReportForm",attrs:{model:_vm.newReport,"label-position":"top"}},[_c("el-form-item",{staticClass:"mT10 mB0",attrs:{prop:"name"}},[_c("p",{staticClass:"label-txt-black pB5 mB0"},[_vm._v(" "+_vm._s(_vm.$t("common.products.name"))+" ")]),_c("el-input",{staticClass:"fc-input-full-border2",attrs:{autofocus:!0,placeholder:_vm.$t("common.products.name")},model:{value:_vm.newReport.name,callback:function($$v){_vm.$set(_vm.newReport,"name",$$v)},expression:"newReport.name"}})],1),_c("el-form-item",{staticClass:"mB0 mT10",attrs:{prop:"description"}},[_c("p",{staticClass:"label-txt-black pB5 mB0"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.report_description"))+" ")]),_c("el-input",{staticClass:"fc-input-full-border2 fc-input-full-border-select2 width100",attrs:{autofocus:!0,type:"textarea",placeholder:_vm.$t("common.wo_report.report_description")},model:{value:_vm.newReport.description,callback:function($$v){_vm.$set(_vm.newReport,"description",$$v)},expression:"newReport.description"}})],1),_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{staticClass:"mB0",attrs:{prop:"folder"}},[_c("p",{staticClass:"label-txt-black pB5 mB0"},[_vm._v(" "+_vm._s(_vm.$t("common.products.folder"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border2 width100",attrs:{filterable:!0,"allow-create":!0,placeholder:_vm.$t("common._common.enter_new_folder_name")},model:{value:_vm.newReport.reportFolderId,callback:function($$v){_vm.$set(_vm.newReport,"reportFolderId",$$v)},expression:"newReport.reportFolderId"}},_vm._l(_vm.reportFolders,(function(folder,idx){return _c("el-option",{key:idx,attrs:{label:folder.name,value:folder.id}})})),1)],1)],1)],1)],1)],1)],2),_c("div",{staticClass:"f-footer row",staticStyle:{height:"46px"}},[_vm._t("footer",(function(){return[_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.close}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.saving},on:{click:_vm.saveReport}},[_vm._v(_vm._s(_vm.saving?_vm.$t("common._common._saving"):_vm.$t("common._common._save")))])],1)]}))],2),_c("template",{slot:"reference"},[_vm._t("reference")],2)],2)],1)},FSaveAsReportvue_type_template_id_1b56e916_staticRenderFns=[],deepmerge=(__webpack_require__(564043),__webpack_require__(857267),__webpack_require__(708634)),NewReportSummaryHelper=__webpack_require__(601458),vuex_esm=__webpack_require__(420629),api=__webpack_require__(32284),validation=__webpack_require__(990260),ReportHelper=__webpack_require__(507815),router=__webpack_require__(329435),FSaveAsReportvue_type_script_lang_js={mixins:[NewReportSummaryHelper/* default */.Z,ReportHelper/* default */.Z],props:["report","savedReport","moduleName","iscustomModule","config","template","moduleFromRoute"],data:function(){return{reportTemplateError:!1,visibility:!1,reportSharing:[],userSpecific:!1,sharedGroups:[],sharedUsers:[],sharedRoles:[],shareTo:2,newReport:{name:"",description:"",reportFolderId:"",analyticsType:1,addToDashboard:!1,isTemplate:!1},reportFolders:[],saving:!1}},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({groups:function(state){return state.groups},users:function(state){return state.users},roles:function(state){return state.roles}})),(0,vuex_esm/* mapGetters */.Se)(["getCurrentUser"])),{},{reportId:function(){return this.$route.query&&this.$route.query.reportId&&this.$route.query.duplicate?null:parseInt(this.$route.query.reportId)}}),created:function(){this.$store.dispatch("loadRoles"),this.$store.dispatch("loadGroups"),this.$store.dispatch("loadUsers")},mounted:function(){this.loadReportFolders(),this.init()},watch:{visibility:function(val){val&&this.init()}},methods:{back:function(){this.userSpecific=!1},init:function(){this.reportId&&this.savedReport?(this.$helpers.copy(this.newReport,this.savedReport),this.newReport.id=this.reportId,"undefined"!==typeof this.template&&null!==this.template&&(this.newReport.isTemplate=!0)):this.report&&this.$helpers.copy(this.newReport,this.report)},loadReportFolders:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var url,self;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:
// no module name case is energy data reports, DON't send moduleName prop as energydata.;leave null for energreports
((0,router/* isWebTabsEnabled */.tj)()||_this.$helpers.isEtisalat())&&_this.moduleFromRoute?api/* API */.bl.get("/v3/report/folders?moduleName="+_this.moduleFromRoute).then((function(response){response.error||(_this.reportFolders=response.data.reportFolders)})):_this.iscustomModule&&!0===_this.iscustomModule?api/* API */.bl.get("/v3/report/folders?moduleName=custommodule").then((function(response){response.error||(_this.reportFolders=response.data.reportFolders)})):_this.$route.meta.module?api/* API */.bl.get("/v3/report/folders?moduleName=".concat(_this.$route.meta.module)).then((function(response){response.error||(_this.reportFolders=response.data.reportFolders)})):_this.moduleName?api/* API */.bl.get("/v3/report/folders?moduleName=".concat(_this.moduleName)).then((function(response){response.error||(_this.reportFolders=response.data.reportFolders)})):(url="/v3/report/folders?moduleName=energydata",self=_this,_this.report&&5==_this.report.reportType&&(
//pivot
url+="&isPivot=true"),api/* API */.bl.get(url).then((function(response){response.error||(self.reportFolders=response.data.reportFolders)})));case 1:case"end":return _context.stop()}}),_callee)})))()},overrideTemplate:function(){this.visibility=!1,this.reportTemplateError=!1;var self=this;if(self.newReport.id&&delete self.newReport.id,this.newReport.name&&this.newReport.name.trim().length)if(this.newReport.reportFolderId){var reportFolderId=-1;try{reportFolderId=parseInt(this.newReport.reportFolderId)}catch(err){}isNaN(reportFolderId)||reportFolderId<0?self.saveFolder(this.newReport.reportFolderId).then((function(response){reportFolderId=response.data.result.reportFolder.id,self.newReport.reportFolderId=reportFolderId,self.addReport(!0)})):self.addReport(!0)}else alert(this.$t("common.header.please_choose_folder_enter_new_folder"));else alert(this.$t("common.header.please_enter_the_report_name"))},saveFolder:function(folderName){var _this2=this,self=this;this.applySharing();var apiUrl=null;return apiUrl="undefined"!==typeof this.moduleName&&this.moduleName?["workorder","alarm"].includes(this.moduleName)||this.iscustomModule&&!0===this.iscustomModule?"/v3/report/folder/create?moduleName="+this.moduleName:["newreadingalarm","readingalarmoccurrence","bmsalarm","mlAnomalyAlarm","anomalyalarmoccurrence","violationalarm","violationalarmoccurrence","operationalarm","operationalarmoccurrence","sensoralarm","sensoralarmoccurrence","sensorrollupalarm","sensorrollupalarmoccurrence","basealarm","alarmoccurrence","readingevent","bmsevent","mlAnomalyEvent","violationevent","operationevent","sensorevent","baseevent"].includes(this.moduleName)?"/v3/report/folder/create?moduleName=alarm":"visitorlog"===this.$route.meta.module?"/v3/report/folder/create?moduleName=visitorlog":"workorder"===this.$route.meta.module?"/v3/report/folder/create?moduleName=workorder":"tenant"===this.$route.meta.module?"/v3/report/folder/create?moduleName=tenant":"contracts"===this.$route.meta.module?"/v3/report/folder/create?moduleName=contracts":"serviceRequest"===this.$route.meta.module?"/v3/report/folder/create?moduleName=serviceRequest":"purchaseorder"===this.$route.meta.module?"/v3/report/folder/create?moduleName=purchaseorder":"budget"===this.$route.meta.module?"/v3/report/folder/create?moduleName=budget":"item"===this.$route.meta.module?"/v3/report/folder/create?moduleName=item":"inspectionTemplate"===this.$route.meta.module?"/v3/report/folder/create?moduleName=inspectionTemplate":void 0===this.$route.meta.module&&this.moduleName.includes("custom_")&&void 0!=this.moduleFromRoute&&this.moduleFromRoute?"/v3/report/folder/create?moduleName="+this.moduleName:void 0===this.$route.meta.module&&void 0!==this.moduleName&&void 0!=this.moduleFromRoute&&this.moduleFromRoute?"/v3/report/folder/create?moduleName="+this.moduleFromRoute:"/v3/report/folder/create?moduleName=asset":"/v3/report/folder/create?moduleName=energydata",new Promise((function(resolve,reject){var a={reportFolder:{name:folderName,reportSharing:_this2.reportSharing}};
//adding folder type =>3 for pivot reports.TODO  send typeEnum for Reading and module reports too
self.report&&5==self.report.reportType&&(a.reportFolder.folderType=3),api/* API */.bl.post(apiUrl,a).then((function(response){response.error?(_this2.$message.error(response.error.message),reject(response.error)):response.data.reportFolder&&response.data.reportFolder.id?resolve(response):reject(response)})).catch((function(error){error&&reject(error)}))}))},saveReport:function(){var self=this;if(this.newReport.name&&this.newReport.name.trim().length)if(this.newReport.reportFolderId){var reportFolderId=-1;try{isNaN(this.newReport.reportFolderId)||(reportFolderId=parseInt(this.newReport.reportFolderId))}catch(err){}isNaN(reportFolderId)||reportFolderId<0?self.saveFolder(this.newReport.reportFolderId).then((function(response){var reportFolder=self.$getProperty(response,"data.reportFolder")||{};self.newReport.reportFolderId=reportFolder.id,self.reportFolders.push(response.data.reportFolder),self.addReport()})):self.addReport()}else alert(this.$t("common.header.please_choose_folder_enter_new_folder"));else alert(this.$t("common.header.please_enter_the_report_name"))},addReport:function(override){var self=this,newReportParams={},setModuleName="undefined"!==typeof this.moduleName&&this.moduleName?this.$helpers.isLicenseEnabled("NEW_ALARMS")&&"alarm"===this.moduleName?"alarmoccurrence":this.moduleName:"energydata";if(this.report&&this.report.params&&this.report.params.regressionConfig&&0!=this.report.params.regressionConfig.length){var params=this.report.params;this.newReport["type"]=3,"multiple"===params.regressionType?newReportParams={reportContext:this.newReport,chartState:JSON.stringify(this.report?this.report.options:null),tabularState:"",moduleName:setModuleName}:params.regressionType}else newReportParams={reportContext:this.newReport,chartState:JSON.stringify(this.report?this.report.options:null),tabularState:JSON.stringify(this.report?this.report.tabularState:null),moduleName:setModuleName};"undefined"!==typeof self.template&&null!=self.template&&self.template.show&&(self.newReport["template"]=JSON.stringify(self.template),self.newReport["type"]=4);var apiUrl=null;if(this.report&&5==this.report.reportType){
//pivot report
apiUrl="v2/report/savePivotReport";var reportId=this.$route.query.reportId&&!this.$route.query.duplicate?this.$route.query.reportId:-1;
//apiUrl = reportId === -1 ? 'v3/report/pivot/create' : 'v3/report/pivot/update'
newReportParams=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},this.config),{},{reportContext:this.newReport,reportId:reportId})}else if("undefined"===typeof this.moduleName||null===this.moduleName)apiUrl=newReportParams.reportContext.id?"v3/report/analytics/update":"v3/report/analytics/create",this.report.options.settings&&(newReportParams.showAlarms=this.report.options.settings.alarm,newReportParams.showSafeLimit=this.report.options.settings.safelimit),this.report.dateRange.operatorId&&(newReportParams.dateOperator=this.report.dateRange.operatorId,42===this.report.dateRange.operatorId||49===this.report.dateRange.operatorId||50===this.report.dateRange.operatorId||51===this.report.dateRange.operatorId?
// last N days/weeks/months/quarters/years
newReportParams.dateOperatorValue=this.report.dateRange.offset:62===this.report.dateRange.operatorId||63===this.report.dateRange.operatorId||64===this.report.dateRange.operatorId||65===this.report.dateRange.operatorId?
// custom date/week/month/quarter/year
newReportParams.dateOperatorValue=this.report.dateRange.time[0]:"R"===this.report.dateRange.rangeType&&(newReportParams.dateOperatorValue=this.report.dateRange.time.join(","))),newReportParams=Object.assign(newReportParams,this.report.params);else if(apiUrl=newReportParams.reportContext.id?"v3/report/update":"v3/report/create",this.config){var baselines,_params=this.$helpers.cloneObject(this.config);if(_params.dateField=this.config.isCustomDateField||this.config.isTime?this.config.dateField:null,_params.dateFilter=null,newReportParams=deepmerge/* default */.Z.objectAssignDeep(newReportParams,_params),this.config.baseLine&&Array.isArray(this.config.baseLine)&&this.config.baseLine.length){if(this.config.baseLine[0]>0){var bl={};bl.baseLineId=this.config.baseLine[0],this.config.baseLine.length>1&&(bl.adjustType=this.config.baseLine[1]);var blList=[];blList.push(bl),baselines=blList}}else this.config.baseLine&&this.config.baseLine>0&&(baselines=[{baseLineId:this.config.baseLine}]);baselines&&(newReportParams.baseLines=JSON.stringify(baselines))}self.saving=!0,api/* API */.bl.post(apiUrl,newReportParams).then((function(response){var reportContext=response.data.report;if(override){var reportURL=self.getRouterUrl(reportContext,self.viewModes().EDIT,!1),reportURLSplit=reportURL.split("?");reportURL=reportURLSplit[0];var addToDashboard=!!self.newReport.addToDashboard;self.close(addToDashboard,response.data),self.$router.replace({path:reportURL,query:{reportId:reportContext.id}})}else{self.saving=!1,self.$router.replace({query:{reportId:reportContext.id}});var notifyInstance=self.$notify({title:self.$t("common._common.report_saved_successfully"),message:self.$t("common._common.click_here_to_open_report"),type:"success",duration:0,customClass:"report-save-success",onClick:function(){notifyInstance&&notifyInstance.close();var reportURL=null;reportURL=self.getRouterUrl(reportContext,self.viewModes().VIEW,!0),self.$router.push({path:reportURL})}}),_addToDashboard=!!self.newReport.addToDashboard;self.close(_addToDashboard,response.data)}})).catch((function(error){self.saving=!1,alert(error)}))},viewModes:function(){var viewModes={VIEW:1,EDIT:2};return viewModes},getRouterUrl:function(reportContext,mode,append){var reportURL;if(mode===this.viewModes().VIEW){if((0,router/* isWebTabsEnabled */.tj)()){var routeObj;if(this.moduleName){if("energydata"===this.moduleName)routeObj=(0,router/* findRouteForReport */.Mq)("analytics_reports",router/* pageTypes */.As.REPORT_VIEW,{moduleName:this.moduleName});else if(routeObj=(0,router/* findRouteForReport */.Mq)("module_reports",router/* pageTypes */.As.REPORT_VIEW,{moduleName:this.moduleName}),(0,validation/* isEmpty */.xb)(routeObj)){var parent_module_name=ReportHelper/* default */.Z.findModuleFromSubmodule(this.moduleName);(0,validation/* isEmpty */.xb)(parent_module_name)||(routeObj=(0,router/* findRouteForReport */.Mq)("module_reports",router/* pageTypes */.As.REPORT_VIEW,{moduleName:parent_module_name}))}}else routeObj=(0,router/* findRouteForReport */.Mq)("analytics_reports",router/* pageTypes */.As.REPORT_VIEW);var _ref=routeObj||{},name=_ref.name,params={};return append&&(params={reportid:reportContext.id}),name&&(reportURL=this.$router.resolve({name:name,params:params}).href),reportURL}if("PIVOT_REPORT"==reportContext.typeEnum)reportURL="/app/em/pivot/view/";else if("undefined"===typeof this.moduleName||null===this.moduleName)reportURL="/app/em/reports/newview/";else if(this.$helpers.isEtisalat())reportURL="/app/em/modulereports/newview/";else if(this.iscustomModule&&!0===this.iscustomModule)reportURL="/app/ca/reports/newview/";else switch(this.moduleName.toLowerCase()){case"workorder":case"workorderLabour":case"workorderCost":case"workorderItem":case"workorderTools":case"workorderService":case"workorderTimeLog":case"workorderHazard":case"plannedmaintenance":reportURL="/app/wo/reports/newview/";break;case"purchaseorder":case"poterms":case"purchaseorderlineitems":case"purchaserequest":case"purchaserequestlineitems":reportURL="/app/purchase/reports/newview/";break;case"inspectiontemplate":case"inspectionresponse":reportURL="/app/inspection/reports/newview/";break;case"budget":case"budgetamount":reportURL="/app/ac/reports/newview/";break;case"item":case"tool":case"itemtransactions":case"toottransactions":case"itemtypes":case"tooltypes":case"storeroom":case"shipment":case"transferrequest":case"transferrequestpurchaseditems":case"transferrequestshipmentreceivables":reportURL=this.$route.path&&this.$route.path.includes("/at/reports/")?"/app/at/reports/newview/":"/app/inventory/reports/newview/";break;case"asset":reportURL="/app/at/reports/newview/";break;case"alarm":case"newreadingalarm":case"readingalarmoccurrence":case"bmsalarm":case"mlAnomalyAlarm":case"anomalyalarmoccurrence":case"violationalarm":case"violationalarmoccurrence":case"operationalarm":case"operationalarmoccurrence":case"sensoralarm":case"sensoralarmoccurrence":case"sensorrollupalarm":case"sensorrollupalarmoccurrence":case"basealarm":case"alarmoccurrence":case"readingevent":case"bmsevent":case"mlAnomalyEvent":case"violationevent":case"operationevent":case"sensorevent":case"baseevent":reportURL="/app/fa/reports/newview/";break;case"servicerequest":reportURL="/app/sr/reports/newview/";break;case"visitor":case"visitorlog":case"invitevisitor":case"watchlist":reportURL="/app/vi/reports/newview/";break;case"tenant":case"tenantunit":case"tenantcontact":case"quote":case"contact":case"tenantspaces":case"quotelineitems":case"quoteterms":case"people":case"newsandinformationsharing":case"neighbourhoodsharing":case"dealsandofferssharing":case"contactdirectorysharing":case"admindocumentsharing":case"audienceSharing":reportURL="/app/tm/reports/newview/";break;case"contracts":case"purchasecontracts":case"purchasecontractlineitems":case"labourcontracts":case"labourcontractlineitems":case"warrantycontracts":case"warrantycontractlineitems":case"rentalleasecontracts":case"rentalleasecontractlineitems":reportURL="/app/ct/reports/newview/";break;default:reportURL="/app/at/reports/newview/";break}append&&(reportURL+=reportContext.id)}else if(mode===this.viewModes().EDIT){if((0,router/* isWebTabsEnabled */.tj)()){var _ref2=(0,router/* findRouteForReport */.Mq)("module_reports",router/* pageTypes */.As.REPORT_FORM,{moduleName:this.moduleName})||{},_name=_ref2.name;return _name&&(reportURL=this.$router.resolve({name:_name}).href),reportURL}if("undefined"===typeof this.moduleName||null===this.moduleName)reportURL="/app/em/analytics/building?reportId=$$";else if(this.$helpers.isEtisalat())reportURL="/app/em/modulereports/new?reportId=$$&module="+this.moduleName;else if(this.iscustomModule&&!0===this.iscustomModule)reportURL="/app/ca/reports/new?reportId=$$&module="+this.moduleName;else switch(this.moduleName){case"workorder":case"workorderLabour":case"workorderCost":case"workorderItem":case"workorderTools":case"workorderService":case"workorderTimeLog":case"workorderHazard":reportURL="app/wo/reports/new?reportId=$$&module="+this.moduleName;break;case"purchaseorder":case"poterms":case"purchaseorderlineitems":case"purchaserequest":case"purchaserequestlineitems":reportURL="app/wo/reports/new?reportId=$$&module=purchaseorder";break;case"budget":case"budgetamount":reportURL="app/ac/reports/new?reportId=$$&module=budget";break;case"item":case"tool":case"itemTransactions":case"tootTransactions":case"itemTypes":case"toolTypes":case"storeRoom":case"shipment":case"transferrequest":case"transferrequestpurchaseditems":case"transferrequestshipmentreceivables":reportURL="app/inventory/reports/new?reportId=$$&module=item";break;case"asset":reportURL="app/at/reports/new?reportId=$$&module=asset";break;case"alarm":case"newreadingalarm":case"readingalarmoccurrence":case"bmsalarm":case"mlAnomalyAlarm":case"anomalyalarmoccurrence":case"violationalarm":case"violationalarmoccurrence":case"operationalarm":case"operationalarmoccurrence":case"sensoralarm":case"sensoralarmoccurrence":case"sensorrollupalarm":case"sensorrollupalarmoccurrence":case"basealarm":case"alarmoccurrence":case"readingevent":case"bmsevent":case"mlAnomalyEvent":case"violationevent":case"operationevent":case"sensorevent":case"baseevent":reportURL="/app/fa/reports/new?reportId=$$&module="+this.moduleName;break;case"servicerequest":reportURL="/app/sr/reports/new?reportId=$$&module="+this.moduleName;break;case"visitor":case"visitorlog":case"invitevisitor":case"watchlist":reportURL="/app/vi/reports/new?reportId=$$&module="+this.moduleName;break;case"tenant":case"tenantunit":case"tenantcontact":case"quote":case"contact":case"tenantspaces":case"quotelineitems":case"quoteterms":case"people":case"newsandinformationsharing":case"neighbourhoodsharing":case"dealsandofferssharing":case"contactdirectorysharing":case"admindocumentsharing":case"audienceSharing":reportURL="/app/tm/reports/new?reportId=$$&module="+this.moduleName;break;case"contracts":case"purchasecontracts":case"purchasecontractlineitems":case"labourcontracts":case"labourcontractlineitems":case"warrantycontracts":case"warrantycontractlineitems":case"rentalleasecontracts":case"rentalleasecontractlineitems":reportURL="/app/ct/reports/new?reportId=$$&module="+this.moduleName;break;default:reportURL="app/at/reports/new?reportId=$$&module="+this.moduleName;break}append&&(reportURL=reportURL.replace("$$",reportContext.id))}return reportURL},applySharing:function(){var self=this;if(this.reportSharing=[],1===self.shareTo)this.reportSharing.push({type:1,userId:self.getCurrentUser().ouid});else if(3===self.shareTo){if(self.sharedUsers.length>0){this.reportSharing.push({type:1,userId:self.getCurrentUser().ouid});for(var i=0;i<self.sharedUsers.length;i++)self.sharedUsers[i]!==self.getCurrentUser().ouid&&this.reportSharing.push({type:1,userId:self.sharedUsers[i]})}if(self.sharedRoles.length>0)for(var _i=0;_i<self.sharedRoles.length;_i++)this.reportSharing.push({type:2,roleId:self.sharedRoles[_i]});if(self.sharedGroups.length>0)for(var _i2=0;_i2<self.sharedGroups.length;_i2++)this.reportSharing.push({type:3,groupId:self.sharedGroups[_i2]})}},close:function(addToDashboard,reportObj){this.newReport={name:"",description:"",reportFolderId:"",addToDashboard:!1},this.visibility=!1,this.$emit("close",addToDashboard,reportObj)}}},components_FSaveAsReportvue_type_script_lang_js=FSaveAsReportvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FSaveAsReportvue_type_script_lang_js,FSaveAsReportvue_type_template_id_1b56e916_render,FSaveAsReportvue_type_template_id_1b56e916_staticRenderFns,!1,null,null,null)
/* harmony default export */,FSaveAsReport=component.exports,ScheduleReportNew=__webpack_require__(91699),MoveReportToDashBoard=__webpack_require__(967850),OutsideClick=__webpack_require__(21864),Comments2=__webpack_require__(487565),NewEnPI=__webpack_require__(585213),FNewAnalyticsModelHelper=__webpack_require__(146371),FSaveRegressionExprvue_type_template_id_74c49ed4_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-popover",{attrs:{width:"250",trigger:"click",placement:"","popper-class":"f-popover save-regression-popup"},model:{value:_vm.visibility,callback:function($$v){_vm.visibility=$$v},expression:"visibility"}},[0===_vm.computedRegressionList.length?_c("div",[_vm._v(" No Expressions Available ")]):_c("div",{staticClass:"fc-popover-content"},[_vm._t("head",(function(){return[_c("div",{staticClass:"title uppercase f12 bold",staticStyle:{"letter-spacing":"1.1px",color:"#000000"}},[_vm._v(" Save Expression ")])]})),_c("el-select",{staticClass:"width100 fc-full-border-select-multiple2 pT10",attrs:{filterable:"",clearable:"",placeholder:"Choose group"},model:{value:_vm.choosenDataPoints,callback:function($$v){_vm.choosenDataPoints=$$v},expression:"choosenDataPoints"}},_vm._l(_vm.computedRegressionList,(function(rPoint,rPointIdx){return _c("el-option",{key:rPointIdx,attrs:{label:rPoint.label,value:rPoint.key}})})),1)],2),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){return _vm.closeDialog()}}},[_vm._v("Close")]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",disabled:0===_vm.computedRegressionList.length},on:{click:function($event){return _vm.saveAsEnpi()}}},[_vm._v("Save")])],1)])},FSaveRegressionExprvue_type_template_id_74c49ed4_staticRenderFns=[],FSaveRegressionExprvue_type_script_lang_js={props:["reportObject","visibility"],computed:{computedRegressionList:function(){var finalDataPoints=[];if("undefined"!==typeof this.reportObject&&this.reportObject){var _step,dataPoints=JSON.parse(JSON.stringify(this.reportObject.options.dataPoints)),_iterator=(0,createForOfIteratorHelper/* default */.Z)(dataPoints);try{var _loop=function(){var dp=_step.value;if("group"===dp.type&&dp.pointType&&dp.pointType===FNewAnalyticsModelHelper/* default */.Z.contextNames().REGRESSION){var regressionPoint=dp.children.filter((function(dataPoint){return dataPoint.alias===dp.key}));regressionPoint.length&&(dp.label=regressionPoint[0].label),finalDataPoints.push(dp)}};for(_iterator.s();!(_step=_iterator.n()).done;)_loop()}catch(err){_iterator.e(err)}finally{_iterator.f()}}return finalDataPoints}},data:function(){return{choosenDataPoints:null}},methods:{closeDialog:function(){this.choosenDataPoints=null,this.$emit("update:visibility",!1)},saveAsEnpi:function(){var enpiConfig=FNewAnalyticsModelHelper/* default */.Z.prepareNewEnpiObject(this.reportObject,[this.choosenDataPoints]);this.$emit("newEnpiConfig",enpiConfig),this.$emit("update:visibility",!1)}}},components_FSaveRegressionExprvue_type_script_lang_js=FSaveRegressionExprvue_type_script_lang_js,FSaveRegressionExpr_component=(0,componentNormalizer/* default */.Z)(components_FSaveRegressionExprvue_type_script_lang_js,FSaveRegressionExprvue_type_template_id_74c49ed4_render,FSaveRegressionExprvue_type_template_id_74c49ed4_staticRenderFns,!1,null,null,null)
/* harmony default export */,FSaveRegressionExpr=FSaveRegressionExpr_component.exports,ModuleColumnSelection=__webpack_require__(207018),newDashboardlayoutHelper=__webpack_require__(915552),UnsavedChangesErrorDialogBox=__webpack_require__(608578),FDialogNew=__webpack_require__(436756),ReportTabPermissions=__webpack_require__(902040),FReportOptionsvue_type_script_lang_js={props:["isActionsDisabled","resultObject","reportObject","params","optionsToEnable","optionClass","savedReport","moduleName","iscustomModule","config","pdf","optionSettings","moduleFromRoute","reportType","newflow"],mixins:[NewReportSummaryHelper/* default */.Z,newDashboardlayoutHelper/* default */.Z,ReportHelper/* default */.Z,ReportTabPermissions/* default */.Z],components:{EmailReport:EmailReportNew/* default */.Z,FSaveAsReport:FSaveAsReport,ScheduleReport:ScheduleReportNew/* default */.Z,MoveReportToDashBoard:MoveReportToDashBoard/* default */.Z,OutsideClick:OutsideClick/* default */.Z,Comments:Comments2/* default */.Z,FSaveAsRegression:FSaveRegressionExpr,NewEnpi:NewEnPI/* default */.Z,ColumnSelectionDialog:ModuleColumnSelection/* default */.Z,FDialog:FDialogNew/* default */.Z,UnsavedChangesErrorDialogBox:UnsavedChangesErrorDialogBox/* default */.Z},data:function(){return{report_id:null,isClone:!1,reportCloneObj:{folder:null,selectedAppId:null,dashboard:null,name:null},rules:{folder:{required:!0,message:this.$t("common.placeholders.enter_folder_name")},name:{required:!0,message:this.$t("common.placeholders.enter_report_name"),trigger:"change"}},apps:null,appId:null,url:null,Saving:!1,folderState:{},isCloneToAnotherApp:!1,showConfirmDialog:!1,reportTemplate:void 0,loadedEnpi:null,exportDialog:!1,checked:!1,exportDownloadUrl:null,exportType:null,exportOption:1,visibility:{saveAsEnpi:!1,saveRegressionExpr:!1,saveAsDialog:!1,showEmailDialog:!1,showScheduleDialog:!1,showCommentDialog:!1},sendToDashBoard:!1,savedReportObj:null,options:{export:1,email:2,print:3,schedule:4,save:5,saveExpression:6},saving:!1,dialogVisible:!1,showColumnSelectionDialog:!1,exportParams:null,showImageOptionsDialog:!1,newReportTree:[]}},watch:{activateTemplateSave:{handler:function(){this.getReportTemplate()}}},mounted:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.next=2,_this.loadNewReportTree();case 2:_this.availableApps();case 3:case"end":return _context.stop()}}),_callee)})))()},computed:{activateTemplateSave:function(){var duplicateCase;if(this.reportObject&&this.resultObject&&this.resultObject.report&&2!==this.resultObject.report.type&&3!==this.resultObject.report.type){var _step,currentLocation=new Set,_iterator=(0,createForOfIteratorHelper/* default */.Z)(this.resultObject.report.dataPoints);try{for(_iterator.s();!(_step=_iterator.n()).done;){var _dataPoint=_step.value;_dataPoint.buildingId&&-1!==_dataPoint.buildingId&&currentLocation.add(_dataPoint.buildingId)}}catch(err){_iterator.e(err)}finally{_iterator.f()}if(1===currentLocation.size){if(duplicateCase=this.getDuplicateCase(this.reportObject),(0,validation/* isEmpty */.xb)(duplicateCase)||1!==duplicateCase.case&&2!==duplicateCase.case)return!1;var _step2,isSpaceReadingPresent=!1,_iterator2=(0,createForOfIteratorHelper/* default */.Z)(this.resultObject.report.dataPoints);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _dataPoint$metaData,dataPoint=_step2.value,parentId=null===dataPoint||void 0===dataPoint||null===(_dataPoint$metaData=dataPoint.metaData)||void 0===_dataPoint$metaData?void 0:_dataPoint$metaData.parentIds[0];if(currentLocation.has(parentId)){isSpaceReadingPresent=!0;break}}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}return!isSpaceReadingPresent}return!1}return!1},isRegression:function(){return!!(this.reportObject&&"undefined"!==typeof this.reportObject&&this.reportObject.options&&this.reportObject.options.regressionConfig&&0!==this.reportObject.options.regressionConfig.length)},computedConfig:function(){var config={};return this.config?(config["xField"]=this.config.xField,config["yField"]=this.config.yField?this.config.yField:null,config["dateField"]=this.config.dateField&&(this.config.isTime||this.config.isCustomDateField)?this.config.dateField:null,config["groupBy"]=this.config.groupBy?this.config.groupBy:null,config["criteria"]=this.config.criteria?this.config.criteria:null,config["sortFields"]=this.config.sortFields?this.config.sortFields:null,config["sortOrder"]=this.config.sortOrder?this.config.sortOrder:null,config["limit"]=this.config.limit?this.config.limit:null,config["moduleType"]=this.config.moduleType?this.config.moduleType:null,config):null},isFromDashboard:function(){return!(!this.$route.query||!this.$route.query.fromDashboard)},reportId:function(){return this.$route.query&&this.$route.query.reportId&&this.$route.query.duplicate?null:"number"===typeof this.$route.query.reportId?this.$route.query.reportId:parseInt(this.$route.query.reportId)},reportCommentObject:function(){var temp={};return temp["id"]=parseInt(this.$route.params.reportid),temp}},methods:{getDateObj:function(dateRange){if(!(0,validation/* isEmpty */.xb)(dateRange)){var dateObj={};return dateObj.operatorId=dateRange.operatorId,dateObj.startTime=dateRange.value[0],dateObj.endTime=dateRange.value[1],dateObj}},constructUrl:function(id,type,filterObject,dateObject){var path="pdf/report";if("reading"===type)path="pdf/readingReport";else if("alarm"===type){path="pdf/alarmReport",dateObject=(0,validation/* isEmpty */.xb)(dateObject)?null:encodeURIComponent(JSON.stringify(dateObject));var _url="".concat(window.location.protocol,"//").concat(window.location.host,"/").concat((0,router/* getApp */.wx)().linkName,"/").concat(path,"?alarmId=").concat(id,"&daterange=").concat(dateObject,"&isWithPrerequsite=true");return _url}var url="".concat(window.location.protocol,"//").concat(window.location.host,"/").concat((0,router/* getApp */.wx)().linkName,"/").concat(path,"/").concat(id);return(0,validation/* isEmpty */.xb)(dateObject)||(dateObject=encodeURIComponent(JSON.stringify(dateObject)),url="".concat(url,"?daterange=").concat(dateObject)),(0,validation/* isEmpty */.xb)(filterObject)||(filterObject=encodeURIComponent(JSON.stringify(filterObject)),url=(0,validation/* isEmpty */.xb)(dateObject)?"".concat(url,"?filters=").concat(filterObject):"".concat(url,"&filters=").concat(filterObject)),url},printPage:function(){var _this$resultObject,url,_this$params,_ref=null!==(_this$resultObject=this.resultObject)&&void 0!==_this$resultObject?_this$resultObject:this.reportObject,_ref$report=_ref.report,report=void 0===_ref$report?{}:_ref$report;(0,validation/* isEmpty */.xb)(report)||(url=null!==(_this$params=this.params)&&void 0!==_this$params&&_this$params.alarmId?this.alarmReportUrl():"READING_REPORT"===report.typeEnum||"TEMPLATE_REPORT"===report.typeEnum?this.readingReportUrl(report):this.moduleReportUrl(report),window.open(url))},alarmReportUrl:function(){var id=this.params.alarmId||null,dateRange=this.resultObject.dateRange,url=this.constructUrl(id,"alarm",null,dateRange);return url},readingReportUrl:function(report){var id=null===report||void 0===report?void 0:report.id,dateRange=this.reportObject.dateRange,dateObject=this.getDateObj(dateRange),filterObject={},_this$params2=this.params,parentId=_this$params2.parentId,spaceId=_this$params2.spaceId;parentId&&(filterObject.parentId=parentId),spaceId&&(filterObject.spaceId=spaceId),(0,validation/* isEmpty */.xb)(filterObject)||(filterObject.xCriteriaMode=this.params.xCriteriaMode);var url=this.constructUrl(id,"reading",filterObject,dateObject);return url},moduleReportUrl:function(report){var _report$userFilters,_this$reportObject$fi,dateRange=this.resultObject.dateRange,id=null===report||void 0===report?void 0:report.id,dateObject=this.getDateObj(dateRange),filterObject={},userFilter=null!==(_report$userFilters=report.userFilters)&&void 0!==_report$userFilters?_report$userFilters:this.reportObject.userFilters;(0,validation/* isEmpty */.xb)(userFilter)||(filterObject=null===(_this$reportObject$fi=this.reportObject.filters)||void 0===_this$reportObject$fi?void 0:_this$reportObject$fi.underlyingDataFilters,(0,validation/* isEmpty */.xb)(filterObject)&&(filterObject=this.getFilters()),filterObject=Object.entries(filterObject).reduce((function(validFilter,filter){return Object.keys(filter[1]).includes("value")&&(0,validation/* isEmpty */.xb)(filter[1].value[0])||(validFilter[filter[0]]=filter[1]),validFilter}),{}));var url=this.constructUrl(id,"module",filterObject,dateObject);return url},cloneReporttoAnotherApp:function(isCloneToAnotherPortal){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var reportObj,params,_yield$API$post,data,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if(reportObj=_this2.reportCloneObj,params=null,null!==reportObj&&void 0!==reportObj&&reportObj.name&&""!==(null===reportObj||void 0===reportObj?void 0:reportObj.name.trim())&&(null===reportObj||void 0===reportObj?void 0:reportObj.selectedAppId)>0&&(params={cloned_report_name:reportObj.name,target_app_id:reportObj.selectedAppId,cloned_app_id:_this2.appId,report_id:_this2.report_id}),!params){_context2.next=12;break}return _this2.Saving=!0,_context2.next=7,api/* API */.bl.post("v3/report/clone",{data:params});case 7:_yield$API$post=_context2.sent,data=_yield$API$post.data,error=_yield$API$post.error,_this2.isClone=!1,!error&&null!==data&&void 0!==data&&data.cloned_report_name?_this2.$message.success("Report Cloned Successfully"):_this2.$message.error("Error while cloning report");case 12:_this2.Saving=!1;case 13:case"end":return _context2.stop()}}),_callee2)})))()},availableApps:function(){var _this3=this;api/* API */.bl.get("v2/application/list").then((function(_ref2){var data=_ref2.data,error=_ref2.error;if(error)_this3.$message.error(error.message||"Error Occured");else{var _this3$apps;if(_this3.apps=data.application,(null===_this3||void 0===_this3||null===(_this3$apps=_this3.apps)||void 0===_this3$apps?void 0:_this3$apps.length)>1&&(_this3.isShowCloneToAnotherApp=!0),_this3.appId=((0,router/* getApp */.wx)()||{}).id,(0,validation/* isEmpty */.xb)(_this3.appId)){var defaultApp=_this3.apps.find((function(app){return"newapp"===app.linkName}))||_this3.apps[0];_this3.appId=defaultApp.id,_this3.reportCloneObj.selectedAppId=_this3.appId}_this3.reportCloneObj.selectedAppId=_this3.appId}}))},getRoute:function(id){var moduleName=this.moduleName;if((0,router/* isWebTabsEnabled */.tj)()){var routeObj;routeObj=moduleName?"energydata"===moduleName?(0,router/* findRouteForReport */.Mq)("analytics_reports",router/* pageTypes */.As.REPORT_VIEW,{moduleName:moduleName}):(0,router/* findRouteForReport */.Mq)("module_reports",router/* pageTypes */.As.REPORT_VIEW,{moduleName:moduleName}):(0,router/* findRouteForReport */.Mq)("analytics_reports",router/* pageTypes */.As.REPORT_VIEW);var _ref3=routeObj||{},name=_ref3.name,url=this.$router.resolve({name:name}).href+"/"+id;this.url=url}},loadNewReportTree:function(){var _this$resultObject2,self=this;if(null!==this&&void 0!==this&&null!==(_this$resultObject2=this.resultObject)&&void 0!==_this$resultObject2&&null!==(_this$resultObject2=_this$resultObject2.report)&&void 0!==_this$resultObject2&&null!==(_this$resultObject2=_this$resultObject2.module)&&void 0!==_this$resultObject2&&_this$resultObject2.name){var moduleName=this.resultObject.report.module.name;this.$route.query.module&&(moduleName=this.$route.query.module),"energy"===moduleName&&(moduleName="energyData");var url="/v3/report/folders?moduleName="+moduleName;"custom"===moduleName&&(url="/v3/report/folders?moduleName=custommodule"),this.isPivot&&(url+="&isPivot=true"),api/* API */.bl.get(url,{},{}).then((function(resp){if(!resp.error){var data=resp.data.reportFolders,treeData=data.map((function(d){if(d.expand=!1,self.reportId){var report=d.reports.find((function(rt){return rt.id===self.reportId}));report&&(d.expand=!0)}return d}));for(var key in self.newReportTree=treeData,self.newReportTree){var folder=self.newReportTree[key],folderState={};folderState["name"]=folder.name,folderState["newName"]=folder.name,folderState["setting"]=!1,folderState["editFolder"]=!1,self.folderState[folder.id]=folderState}}}))}},handleCommand:function(command,isCloneToAnotherApp){var report=this.resultObject.report;"delete"==command?this.$emit("deleteReport",report.id):"duplicate"==command?this.$emit("duplicateReport",report.id):"move"==command?this.showMovePopOver=!0:"Mail"==command?(this.getRoute(report.id),this.visibility.showEmailDialog=!0):"CloneReport"==command?this.openClonePopup(report.id,report.name,isCloneToAnotherApp):"Schedule"==command?this.visibility.showScheduleDialog=!0:"printPreview"==command&&this.printPage()},editReport:function(id){this.$emit("editReport",id)},openClonePopup:function(id,name,isCloneToAnotherApp){this.isClone=!0,this.report_id=id,this.reportCloneObj.name=name,this.isCloneToAnotherApp=isCloneToAnotherApp||!1,this.isCloneToAnotherApp=!0},handleMoveFolder:function(newFolder){var _this4=this;this.closePopover();var currentFolder=this.newReportTree.filter((function(folder){return folder.id===_this4.reportObject.report.reportFolderId}));this.moveReport(currentFolder,newFolder)},closePopover:function(){var popper=document.querySelectorAll(".el-popover");popper.forEach((function(pop){pop.remove()}))},moveReport:function(currentFolder,newFolder){var curIndex,newIndex,reportIndex,_this5=this,report=this.reportObject.report;
// this.$set(this.folderState[currentFolder.id], 'setting', false)
for(var key in this.newReportTree)this.newReportTree[key].name===currentFolder.name&&(curIndex=key,reportIndex=this.newReportTree[key].reports.indexOf(report)),this.newReportTree[key].name===newFolder.name&&(newIndex=key);api/* API */.bl.put("/v3/report/moveto",{reportId:report.id,folderId:newFolder.id}).then((function(response){_this5.newReportTree[curIndex].reports.splice(reportIndex,1),_this5.newReportTree[newIndex].reports.push(report)})).catch((function(){_this5.$message({message:_this5.$t("common.wo_report.cannot_move_report"),type:"error"})}))},initSaveExpression:function(){this.resultObject&&(this.resultObject.regressionConfig&&1===this.resultObject.regressionConfig.length?this.loadEnpi():this.$set(this.visibility,"saveRegressionExpr",!0))},loadEnpi:function(){if(this.resultObject.regressionType===FNewAnalyticsModelHelper/* default */.Z.regressionTypes().SINGLE){var choosenAlias=[this.reportObject.options.dataPoints[0].key];this.loadedEnpi=FNewAnalyticsModelHelper/* default */.Z.prepareNewEnpiObject(this.reportObject,choosenAlias),this.$set(this.visibility,"saveAsEnpi",!0)}else{var _choosenAlias=[this.resultObject.regressionConfig[0].groupAlias];this.loadedEnpi=FNewAnalyticsModelHelper/* default */.Z.prepareNewEnpiObject(this.resultObject,_choosenAlias,this.reportObject.options.common,this.reportObject.dateRange.period),this.$set(this.visibility,"saveAsEnpi",!0)}},openEnpiDialog:function(enpiConfig){this.loadedEnpi=enpiConfig,this.$set(this.visibility,"saveAsEnpi",!0)},newExportData:function(){var _this6=this;if(this.exportDialog=!1,1===this.exportOption)this.exportData(this.exportType);else{
// export underlying data
this.$message({message:"Exporting as "+this.$constants.FILE_FORMAT[this.exportType],showClose:!0});var url="/exportModule?type="+this.exportType+"&moduleName="+this.moduleName+"&viewName=all",params=null;this.reportObject.filters.underlyingDataFilters&&0!==Object.keys(this.reportObject.filters.underlyingDataFilters).length&&(params="&filters="+JSON.stringify(this.reportObject.filters.underlyingDataFilters)),this.$http.post(url,params).then((function(response){_this6.$message.close(),_this6.exportDownloadUrl=response.data.fileUrl})).catch((function(){_this6.$error.message(_this6.$t("common.wo_report.export_failed"))}))}},triggerExport:function(type){if(this.exportType=type,"4"===type)this.getRoute(this.resultObject.report.id),this.showImageOptionsDialog=!0;else if(this.reportObject&&this.reportObject.report&&2===this.reportObject.report.type)"3"===type?(this.getRoute(this.resultObject.report.id),this.showColumnSelectionDialog=!0):this.exportDialog=!0;else{var _this$resultObject3;null!==(_this$resultObject3=this.resultObject)&&void 0!==_this$resultObject3&&null!==(_this$resultObject3=_this$resultObject3.report)&&void 0!==_this$resultObject3&&_this$resultObject3.id&&this.getRoute(this.resultObject.report.id),this.exportData(type)}},backToReport:function(status){if(status)if((0,router/* isWebTabsEnabled */.tj)()){var routeObj;routeObj=this.moduleName?"energydata"===this.moduleName?(0,router/* findRouteForReport */.Mq)("analytics_reports",router/* pageTypes */.As.REPORT_VIEW,{moduleName:this.moduleName}):(0,router/* findRouteForReport */.Mq)("module_reports",router/* pageTypes */.As.REPORT_VIEW,{moduleName:this.moduleName}):(0,router/* findRouteForReport */.Mq)("analytics_reports",router/* pageTypes */.As.REPORT_VIEW);var reportId=this.reportId,_ref4=routeObj||{},name=_ref4.name;name&&this.$router.push({name:name,params:{reportid:reportId}})}else if("undefined"===typeof this.moduleName)this.$route.path&&this.$route.path.includes("em/pivot")?this.$router.push({path:"/app/em/pivot/view/"+this.reportId}):this.$router.push({path:"/app/em/reports/newview/"+this.reportId});else if(this.$helpers.isEtisalat())this.$router.push({path:"/app/em/modulereports/newview/"+this.reportId});else if(this.iscustomModule&&!0===this.iscustomModule)this.$router.push({path:"/app/ca/reports/newview/"+this.reportId});else{var url="";switch(this.moduleName){case"workorder":case"workorderLabour":case"workorderCost":case"workorderItem":case"workorderTools":case"workorderService":case"workorderTimeLog":case"workorderHazard":case"plannedmaintenance":url="/app/wo/reports/newview/"+this.reportId;break;case"purchaseorder":case"poterms":case"purchaseorderlineitems":case"purchaserequest":case"purchaserequestlineitems":url="/app/purchase/reports/newview/"+this.reportId;break;case"budget":case"budgetamount":url="/app/ac/reports/newview/"+this.reportId;break;case"item":case"tool":case"itemTransactions":case"tootTransactions":case"itemTypes":case"toolTypes":case"storeRoom":case"shipment":case"transferrequest":case"transferrequestshipmentreceivables":case"transferrequestpurchaseditems":url="/app/inventory/reports/newview/"+this.reportId;break;case"visitor":case"visitorlog":case"invitevisitor":case"watchlist":url="/app/vi/reports/newview/"+this.reportId;break;case"inspectionTemplate":case"inspectionResponse":url="/app/inspection/reports/newview/"+this.reportId;break;case"tenant":case"tenantunit":case"tenantcontact":case"quote":case"contact":case"tenantspaces":case"quotelineitems":case"quoteterms":case"people":case"newsandinformationsharing":case"neighbourhoodsharing":case"dealsandofferssharing":case"contactdirectorysharing":case"admindocumentsharing":case"audienceSharing":url="/app/tm/reports/newview/"+this.reportId;break;case"contracts":case"purchasecontracts":case"purchasecontractlineitems":case"labourcontracts":case"labourcontractlineitems":case"warrantycontracts":case"warrantycontractlineitems":case"rentalleasecontracts":case"rentalleasecontractlineitems":url="/app/ct/reports/newview/"+this.reportId;break;case"alarm":case"newreadingalarm":case"readingalarmoccurrence":case"bmsalarm":case"mlAnomalyAlarm":case"anomalyalarmoccurrence":case"violationalarm":case"violationalarmoccurrence":case"operationalarm":case"operationalarmoccurrence":case"sensoralarm":case"sensoralarmoccurrence":case"sensorrollupalarm":case"sensorrollupalarmoccurrence":case"basealarm":case"alarmoccurrence":case"readingevent":case"bmsevent":case"mlAnomalyEvent":case"violationevent":case"operationevent":case"sensorevent":case"baseevent":url="/app/fa/reports/newview/"+this.reportId;break;case"serviceRequest":url="/app/sr/reports/newview/"+this.reportId;break;default:url="/app/at/reports/newview/"+this.reportId;break}this.$router.push({path:url})}else this.showConfirmDialog=!1},exportData:function(type){var _this7=this,params=this.params;if(params&&(params.fileFormat=type,
/* params.exportInfo = {
        fileFormat: type
        } */
params.newFormat=!0),"3"!==type&&"4"!==type||(null==this.exportParams&&(this.exportParams={}),this.exportParams.showHeader=this.showHeader,this.exportParams.showPrintDetails=this.showPrintDetails),this.$message({message:"Exporting as "+this.$constants.FILE_FORMAT[type],showClose:!0,duration:0}),"undefined"!==typeof this.moduleName&&"pivot"!==this.reportType){var _this$reportObject,moduleReportExportParams={};this.reportId||this.$route.params.reportid?(moduleReportExportParams["reportId"]=this.reportId?this.reportId:this.$route.params.reportid,this.resultObject&&this.resultObject.dateRange&&(moduleReportExportParams["startTime"]=this.resultObject.dateRange.value[0],moduleReportExportParams["endTime"]=this.resultObject.dateRange.value[1])):(moduleReportExportParams=(0,objectSpread2/* default */.Z)({},this.computedConfig),moduleReportExportParams["moduleName"]=this.moduleName),moduleReportExportParams["fileFormat"]=type,this.exportParams&&(moduleReportExportParams.exportParams=this.exportParams),"3"!==type&&"4"!==type||(moduleReportExportParams["url"]=null!==this&&void 0!==this&&this.url?this.url:""),null!==this&&void 0!==this&&null!==(_this$reportObject=this.reportObject)&&void 0!==_this$reportObject&&null!==(_this$reportObject=_this$reportObject.filters)&&void 0!==_this$reportObject&&_this$reportObject.underlyingDataFilters&&0!==Object.keys(this.reportObject.filters.underlyingDataFilters).length&&(moduleReportExportParams["filters"]=JSON.stringify(this.reportObject.filters.underlyingDataFilters)),this.$http.post("/v2/report/exportModuleReport",moduleReportExportParams).then((function(response){element_ui_common.Message.closeAll(),response.data&&0===response.data.responseCode&&(_this7.exportDownloadUrl=response.data.result.fileUrl)}))}else{var url=null;url="pivot"!==this.reportType?"/v2/report/export":"/v2/report/exportPivotReport",this.reportObject&&this.reportObject.report&&4===this.reportObject.report.type&&this.reportObject.report.currentTemplate&&(url=url+"?templateString="+encodeURIComponent(JSON.stringify(this.reportObject.report.currentTemplate))),params||(params={}),this.exportParams&&(params.exportParams=this.exportParams),"4"!==type&&"3"!==type||(params["url"]=null!==this&&void 0!==this&&this.url?this.url:""),"pivot"==this.reportType&&(params={reportId:this.$route.params.id,fileFormat:type}),this.$http.post(url,params).then((function(response){element_ui_common.Message.closeAll(),response.data&&0===response.data.responseCode&&(_this7.exportDownloadUrl=response.data.result.fileUrl)}))}},printReport:function(){setTimeout((function(){window.print()}),1e3)},checkOption:function(key){return!this.optionsToEnable||this.optionsToEnable.includes(this.options[key])},closeDialog:function(){this.$emit("update:visibility",!1)},closeImageOptionsDialog:function(){this.showImageOptionsDialog=!1},onColumnSelection:function(fields){this.exportParams||(this.exportParams={}),fields&&fields.length&&(this.exportParams.fields=fields.join(",")),this.exportParams.pageLimit="all",this.showColumnSelectionDialog=!1,this.exportData(this.exportType)},closeSaveDialog:function(addToDashboard,savedReportObj){this.savedReportObj=null,!0===addToDashboard&&(this.savedReportObj=savedReportObj,this.sendToDashBoard=!0),this.$emit("update:savedReport",savedReportObj?savedReportObj.report:null)},getReportTemplate:function(){if(this.resultObject&&this.resultObject.report&&this.resultObject.report.currentTemplate){var template=JSON.parse(JSON.stringify(this.resultObject.report.currentTemplate));return template.chooseValues=[],template}},save:function(){}}},components_FReportOptionsvue_type_script_lang_js=FReportOptionsvue_type_script_lang_js,FReportOptions_component=(0,componentNormalizer/* default */.Z)(components_FReportOptionsvue_type_script_lang_js,render,staticRenderFns,!1,null,"5408f2ec",null)
/* harmony default export */,FReportOptions=FReportOptions_component.exports},
/***/207018:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return ModuleColumnSelection}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/report/components/ModuleColumnSelection.vue?vue&type=template&id=3c832206&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_vm.visibility?_c("f-dialog",{attrs:{visible:_vm.visibility,width:"30%",maxHeight:"350px",title:"Select Columns",confirmTitle:"OK"},on:{save:_vm.onSave,close:_vm.close}},[_vm.loading?_c("spinner",{attrs:{show:_vm.loading,size:"80"}}):_c("el-checkbox-group",{attrs:{max:_vm.MAX_COLUMNS},model:{value:_vm.selectedNames,callback:function($$v){_vm.selectedNames=$$v},expression:"selectedNames"}},_vm._l(_vm.selectableFields,(function(field,index){return _c("div",{key:index},[_c("el-checkbox",{staticClass:"pT10 pB10",attrs:{label:field.name}},[_vm._v(_vm._s(field.displayName||field.name))])],1)})),0)],1):_vm._e()],1)},staticRenderFns=[],toConsumableArray=__webpack_require__(488478),FDialogNew=(__webpack_require__(634338),__webpack_require__(450886),__webpack_require__(434284),__webpack_require__(162506),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(670560),__webpack_require__(436756)),ModuleColumnSelectionvue_type_script_lang_js={props:["moduleName","visibility","fields"],components:{FDialog:FDialogNew/* default */.Z},data:function(){return{loading:!1,metaFields:[],selectableFields:[],selectedNames:[],MAX_COLUMNS:12}},mounted:function(){this.fields&&(this.selectableFields=[{name:"id",displayName:"ID"}].concat((0,toConsumableArray/* default */.Z)(this.fields)),this.selectedNames=this.selectableFields.map((function(field){return field.name})),this.selectedNames.length>7&&this.selectedNames.splice(7,this.selectedNames.length)),this.loadMetaFields()},methods:{loadMetaFields:function(){var _this=this;this.loading=!0,this.$http.get("/module/metafields?moduleName=".concat(this.moduleName)).then((function(response){_this.metaFields=response.data.meta.fields||[];for(var i=0,j=_this.selectedNames.length;i<_this.metaFields.length;i++){var field=_this.metaFields[i];_this.selectedNames.includes(field.name)||(_this.selectableFields.push(field),j<7&&(_this.selectedNames.push(field.name),j++))}_this.loading=!1}))},onSave:function(){this.$emit("save",this.selectedNames)},close:function(){this.$emit("update:visibility",!1)}}},components_ModuleColumnSelectionvue_type_script_lang_js=ModuleColumnSelectionvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_ModuleColumnSelectionvue_type_script_lang_js,render,staticRenderFns,!1,null,"3c832206",null)
/* harmony default export */,ModuleColumnSelection=component.exports},
/***/585213:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return NewEnPI}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/setup/new/NewEnPI.vue?vue&type=template&id=34932632
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticStyle:{"z-index":"999999"},attrs:{visible:_vm.visibility,fullscreen:!0,"append-to-body":!0,"custom-class":"fc-dialog-form fc-dialog-right setup-dialog50 setup-dialog","before-close":_vm.closeDialog},on:{"update:visible":function($event){_vm.visibility=$event}}},[_c("div",{attrs:{id:"newenpi"}},[_c("el-form",{ref:"meterForm",staticClass:"fc-form",attrs:{model:_vm.newenpi,"label-position":"top"}},[_c("div",{staticClass:"new-header-container"},[_c("div",{staticClass:"new-header-text"},[_c("div",{staticClass:"fc-setup-modal-title"},[_vm._v(" "+_vm._s(_vm.isNew?_vm.$t("setup.list.new"):_vm.$t("maintenance.pm_list.edit"))+" ENPI DEFINITION ")])])]),_c("div",{staticClass:"new-body-modal enpi-body-modal"},[_c("div",{staticClass:"body-scroll"},[_c("el-row",{attrs:{gutter:20}},[_c("el-col",{attrs:{span:24}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v(" ENPI "+_vm._s(_vm.$t("common.roles.name"))+" ")]),_c("el-form-item",[_c("el-input",{staticClass:"width100 fc-input-full-border2",attrs:{autofocus:"",type:"text",autocomplete:"off",placeholder:"Enter EnPI Name"},model:{value:_vm.newenpi.name,callback:function($$v){_vm.$set(_vm.newenpi,"name",$$v)},expression:"newenpi.name"}})],1)],1)],1),_c("el-row",{attrs:{gutter:20}},[_c("el-col",{attrs:{span:24}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.$t("space.sites.site_description"))+" ")]),_c("el-form-item",[_c("el-input",{staticClass:"width100 fc-input-full-border-textarea",attrs:{type:"textarea",autosize:{minRows:4,maxRows:4},placeholder:_vm.$t("common._common.enter_desc"),resize:"none"},model:{value:_vm.newenpi.description,callback:function($$v){_vm.$set(_vm.newenpi,"description",$$v)},expression:"newenpi.description"}})],1)],1)],1),_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("p",{staticClass:"fc-input-label-txt mT10"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.wr_list.type"))+" ")]),_c("el-radio",{staticClass:"fc-radio-btn",attrs:{disabled:!_vm.isNew,label:"space",value:"space"},model:{value:_vm.enpiType,callback:function($$v){_vm.enpiType=$$v},expression:"enpiType"}},[_vm._v(_vm._s(_vm.$t("alarm.alarm.space")))]),_c("el-radio",{staticClass:"fc-radio-btn",attrs:{disabled:!_vm.isNew,label:"asset",value:"asset"},model:{value:_vm.enpiType,callback:function($$v){_vm.enpiType=$$v},expression:"enpiType"}},[_vm._v(_vm._s(_vm.$t("alarm.alarm.asset")))])],1)],1),_c("el-row",{staticClass:"mT30",attrs:{gutter:20}},["asset"===_vm.enpiType?[_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.$t("space.sites.site_category"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{disabled:!_vm.isNew,filterable:"",placeholder:"Select Category"},model:{value:_vm.newenpi.assetCategoryId,callback:function($$v){_vm.$set(_vm.newenpi,"assetCategoryId",$$v)},expression:"newenpi.assetCategoryId"}},_vm._l(_vm.assetCategory,(function(category,index){return _c("el-option",{key:index,attrs:{label:category.displayName,value:parseInt(category.id)}})})),1)],1),_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v("Asset(s)")]),_c("el-input",{staticClass:"fc-border-select fc-input-full-border-select2 width100",attrs:{disabled:""},model:{value:_vm.resourceLabel,callback:function($$v){_vm.resourceLabel=$$v},expression:"resourceLabel"}},[_c("i",{staticClass:"el-input__icon el-icon-search",staticStyle:{"line-height":"0px !important","font-size":"16px !important",cursor:"pointer"},attrs:{slot:"suffix"},on:{click:function($event){_vm.isNew&&(_vm.chooserVisibility=!0)}},slot:"suffix"})])],1)]:_c("el-col",{attrs:{span:12}},[[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.$t("alarm.alarm.space"))+" ")]),_c("el-input",{staticClass:"mT10 fc-input-full-border2",attrs:{disabled:!_vm.isNew,type:"text",placeholder:_vm.$t("common._common.to_search_type")},on:{change:function($event){_vm.resourceQuery=_vm.selectedResourceName,_vm.chooserVisibility=!0}},model:{value:_vm.selectedResourceName,callback:function($$v){_vm.selectedResourceName=$$v},expression:"selectedResourceName"}},[_c("i",{staticClass:"el-input__icon el-icon-search enpi-icon-search",attrs:{slot:"suffix",disabled:!_vm.isNew},on:{click:function($event){_vm.isNew&&(_vm.chooserVisibility=!0)}},slot:"suffix"})])]],2)],2),_c("el-row",[_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"fc-input-label-txt mT30"},[_vm._v(" "+_vm._s(_vm.$t("space.sites.site_freq"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border2 width100",attrs:{placeholder:"Choose Frequency",disabled:!_vm.isNew},model:{value:_vm.newenpi.frequency,callback:function($$v){_vm.$set(_vm.newenpi,"frequency",$$v)},expression:"newenpi.frequency"}},_vm._l(_vm.frequencyTypes,(function(label,value){return _c("el-option",{key:value,attrs:{label:label,value:parseInt(value)}})})),1)],1)],1),_c("el-row",[_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"fc-input-label-txt mT30"},[_vm._v(" "+_vm._s(_vm.$t("commissioning.sheet.header_unit"))+" ")]),_c("el-input",{staticClass:"fc-input-full-border2",attrs:{type:"text",placeholder:"Enter Unit"},model:{value:_vm.formulaFieldUnit,callback:function($$v){_vm.formulaFieldUnit=$$v},expression:"formulaFieldUnit"}})],1)],1),_c("div",{staticClass:"mT40"},[_c("f-formula-builder",{attrs:{isNew:_vm.isNew,module:"enpi",assetCategory:{id:_vm.newenpi.assetCategoryId}},model:{value:_vm.newenpi.workflow,callback:function($$v){_vm.$set(_vm.newenpi,"workflow",$$v)},expression:"newenpi.workflow"}})],1),_c("f-safe-limit",{ref:"safelimit",attrs:{edit:!this.isNew},model:{value:_vm.newenpi.readingField,callback:function($$v){_vm.$set(_vm.newenpi,"readingField",$$v)},expression:"newenpi.readingField"}})],1)]),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){return _vm.closeDialog()}}},[_vm._v(" "+_vm._s(_vm.$t("setup.users_management.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.saving},on:{click:function($event){return _vm.submitForm("meterForm")}}},[_vm._v(_vm._s(_vm.saving?_vm.$t("maintenance._workorder.saving"):_vm.$t("maintenance._workorder.save"))+" ")])],1)]),_vm.newenpi.assetCategoryId>0?_c("space-asset-multi-chooser",{attrs:{visibility:_vm.chooserVisibility,initialValues:_vm.resourceData,query:_vm.resourceQuery,showAsset:!0,disable:!0,hideBanner:!0},on:{associate:_vm.associateResource,"update:visibility":function($event){_vm.chooserVisibility=$event}}}):_c("space-asset-chooser",{attrs:{visibility:_vm.chooserVisibility,initialValues:{},query:_vm.resourceQuery,showAsset:"asset"===_vm.enpiType,picktype:_vm.enpiType},on:{associate:_vm.associateResource,"update:visibility":function($event){_vm.chooserVisibility=$event}}})],1)])},staticRenderFns=[],esm_typeof=__webpack_require__(103336),objectSpread2=__webpack_require__(595082),FFormulaBuilder=(__webpack_require__(450886),__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(434284),__webpack_require__(169358),__webpack_require__(670560),__webpack_require__(902294)),SpaceAssetChooser=__webpack_require__(372587),SpaceAssetMultiChooser=__webpack_require__(673362),FSafeLimit=__webpack_require__(706512),vuex_esm=__webpack_require__(420629),NewEnPIvue_type_script_lang_js={props:["isNew","enpi","visibility"],data:function(){return{saving:!1,formulaFieldUnit:"",enpiType:"space",newenpi:{name:"",description:"",resourceId:null,frequency:null,triggerType:1,formulaFieldType:1,resourceType:1,resultDataType:3,workflow:{},assetCategoryId:null,includedResources:[],readingField:{safeLimitId:-1,raiseSafeLimitAlarm:!1,displayName:"",dataType:1,lesserThan:null,greaterThan:null,betweenTo:null,betweenFrom:null,safeLimitPattern:"none",safeLimitSeverity:"Minor"}},selectedResourceName:null,selectedResourceList:null,resourceQuery:null,chooserVisibility:!1}},components:{FFormulaBuilder:FFormulaBuilder/* default */.Z,SpaceAssetChooser:SpaceAssetChooser/* default */.Z,SpaceAssetMultiChooser:SpaceAssetMultiChooser/* default */.Z,FSafeLimit:FSafeLimit/* default */.Z},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({assetCategory:function(state){return state.assetCategory}})),{},{frequencyTypes:function(){var types=this.$helpers.cloneObject(this.$constants.FACILIO_FREQUENCY);return types["8"]="Hourly",types},resourceData:function(){var resourceData={};return this.newenpi.assetCategoryId>0&&(resourceData.assetCategory=this.newenpi.assetCategoryId),this.newenpi.includedResources&&this.newenpi.includedResources.length&&(resourceData.isIncludeResource=!0,resourceData.selectedResources=this.newenpi.includedResources.map((function(resource){return{id:resource}}))),resourceData},dummyAssetValue:function(){return this.resourceLabel?[1]:[]},resourceLabel:function(){var _this=this;if(this.newenpi.assetCategoryId>0){var message,category=this.assetCategory.filter((function(d){return d.id===_this.newenpi.assetCategoryId})),selectedCount=0;if(this.newenpi.includedResources&&(selectedCount=this.newenpi.includedResources.length),selectedCount){if(1===selectedCount)return this.newenpi.includedResources[0].name;message=selectedCount+" "+category[0].name+(selectedCount>1?"s":"")}else message="All "+category[0].name+"s selected";return message}return this.selectedResourceName}}),mounted:function(){this.isNew?this.isNew&&"undefined"!==typeof this.enpi&&0!==Object.keys(this.enpi).length&&(
// saving regression expressions
this.newenpi=this.$helpers.cloneObject(this.enpi),this.selectedResourceName=this.enpi.matchedResources[0].name,delete this.newenpi.matchedResources):(this.newenpi=this.$helpers.cloneObject(this.enpi),this.selectedResourceName=this.enpi.matchedResources[0].name,this.formulaFieldUnit=this.enpi.readingField.unit,-1===this.enpi.assetCategoryId&&(this.newenpi.assetCategoryId=null),this.enpiType=1===this.enpi.matchedResources[0].resourceType?"space":"asset")},created:function(){this.$store.dispatch("loadAssetCategory"),this.$store.dispatch("loadAlarmSeverity")},methods:{submitForm:function(meterForm){var _this2=this,self=this;this.$refs[meterForm].validate((function(valid){if(!valid)return!1;var fieldReadingRules=[];fieldReadingRules.push(_this2.$common.getSafeLimitRules(_this2.newenpi.readingField,_this2.newenpi.assetCategoryId));var url="/reading/addformula",objToSave=_this2.$helpers.cloneObject(_this2.newenpi);
// this.newenpi.interval = 60
objToSave.assetCategoryId>0?(objToSave.resourceType=6,delete objToSave.resourceId):(objToSave.resourceType=1,delete objToSave.assetCategoryId);var param={formula:objToSave,fieldReadingRules:fieldReadingRules,formulaFieldUnit:_this2.formulaFieldUnit};if(_this2.isNew&&(param.formula.interval=60),!_this2.isNew){var delReadingRulesIds=[];_this2.newenpi.readingField&&"none"===_this2.newenpi.readingField.safeLimitPattern&&_this2.newenpi.readingField.safeLimitId&&-1!==_this2.newenpi.readingField.safeLimitId&&delReadingRulesIds.push(_this2.newenpi.readingField.safeLimitId),url="/reading/updateformula",objToSave=_this2.$helpers.compareObject(objToSave,_this2.enpi),objToSave.id=_this2.enpi.id,
// param=  {formula: self.newenpi}
param={formula:objToSave,moduleId:_this2.enpi.moduleId,formulaFieldUnit:_this2.formulaFieldUnit,delReadingRulesIds:delReadingRulesIds,fieldReadingRules:fieldReadingRules}}
/* let newenpi = {}
          newenpi.enpi = {
            name: enpi.name,
            description: enpi.description,
            frequency: enpi.frequency
          }
          // if (this.newenpi.frequency === 1) {
          //   newenpi.enpi.schedule = {'frequencyType': 1, 'frequency': 1, 'tim
          resultDataType: 3,es': ['00:01']}
          // }
          // else if (this.newenpi.frequency === 2) {
          //   newenpi.enpi.schedule = {'frequencyType': 3, 'frequency': 1, 'times': ['00:01']}
          // }
          // else if (this.newenpi.frequency === 3) {
          //   newenpi.enpi.schedule = {'frequencyType': 3, 'frequency': 3, 'times': ['00:01']}
          // }
          if (enpi.resourceId) {
            newenpi.enpi.resourceId = enpi.resourceId
          }
          newenpi.enpi.workflow = this.newenpi.workflow */self.saving=!0,_this2.$http.post(url,param).then((function(response){self.saving=!1,"object"===(0,esm_typeof/* default */.Z)(response.data)?(self.$message.success(self.isNew?self.$t("setup.new.new_enpi_success"):self.$t("setup.new.update_enpi_success")),self.resetForm(),self.$emit("saved"),self.$emit("update:visibility",!1)):self.$message.error(self.isNew?"EnPI addition failed":"EnPI updation failed")})).catch((function(error){self.saving=!1,self.$message.error(self.isNew?"EnPI addition failed":"EnPI updation failed")}))}))},resetForm:function(){this.newenpi={name:"",description:"",space:{id:null},frequency:null,workflow:{}}},cancel:function(){this.resetForm(),this.$emit("canceled")},save:function(){var self=this;self.saving=!0},closeDialog:function(){this.$emit("update:visibility",!1)},associateResource:function(selectedObj){this.chooserVisibility=!1,this.resourceQuery=null,this.newenpi.assetCategoryId>0?selectedObj.resourceList&&selectedObj.resourceList.length&&(this.newenpi.includedResources=selectedObj.resourceList.map((function(resource){return resource.id}))):(this.newenpi.resourceId=selectedObj.id,this.selectedResourceName=selectedObj.name)}}},new_NewEnPIvue_type_script_lang_js=NewEnPIvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(new_NewEnPIvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,NewEnPI=component.exports},
/***/153813:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"9c716467b9890487a1b01493444e23c1.svg";
/***/}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/47234.js.map