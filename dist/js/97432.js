(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[97432],{
/***/359911:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FHeatMapCustomization}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/newcharts/components/FHeatMapCustomization.vue?vue&type=template&id=1e0241c0
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticStyle:{position:"relative"}},[_c("div",{staticClass:"customize-tab-body-axis clearboth pT0"},[_c("div",{staticClass:"customize-scroll-hidden"},[_vm.heatMapOptions?_c("div",{staticClass:"customize-scroll datapoints-malign mL20 mR20",staticStyle:{"margin-right":"20px"}},[_c("p",{staticClass:"label-txt-black mB0"},[_vm._v("Range")]),_c("div",{staticClass:"customize-input-block pT10"},[_c("el-row",{attrs:{gutter:20}},[_c("el-col",{attrs:{span:12}},[_c("p",{staticClass:"customize-label"},[_vm._v("Min")]),_c("el-input",{staticClass:"fc-input-full-border2 width100",attrs:{placeholder:"auto"},model:{value:_vm.heatMapOptions.minValue,callback:function($$v){_vm.$set(_vm.heatMapOptions,"minValue",_vm._n($$v))},expression:"heatMapOptions.minValue"}})],1),_c("el-col",{attrs:{span:12}},[_c("p",{staticClass:"customize-label"},[_vm._v("Max")]),_c("el-input",{staticClass:"fc-input-full-border2 width100",attrs:{placeholder:"auto"},model:{value:_vm.heatMapOptions.maxValue,callback:function($$v){_vm.$set(_vm.heatMapOptions,"maxValue",_vm._n($$v))},expression:"heatMapOptions.maxValue"}})],1)],1)],1),_vm._m(0),_c("div",{staticClass:"analytics-data-point flex-middle"},[_c("div",{staticClass:"colorPalette-main",on:{click:_vm.openDialog}},_vm._l(_vm.heatMapOptions.Colors[_vm.heatMapOptions.chosenColors],(function(color,idx){return _c("div",{key:idx,staticClass:"colorBlock",style:{background:color}})})),0),_c("div",{staticClass:"flex-middle mL30 pB10 pointer",on:{click:_vm.openDialog}},[_c("div",{staticClass:"fc-link2 f11"},[_vm._v("Change")]),_c("InlineSvg",{staticClass:"vertical-middle pointer color-pallete",staticStyle:{top:"2px"},attrs:{src:"svgs/painter-palette",iconClass:"icon icon-xs mL5"}})],1)]),"undefined"!==typeof _vm.heatMapOptions.reversePallete?_c("div",[_c("el-row",[_c("el-col",{attrs:{span:18}},[_c("div",{staticClass:"flex-middle"},[_c("p",{staticClass:"label-txt-black pT20 line-height20 mB10"},[_vm._v(" reverse pallete ")])])]),_c("el-col",{attrs:{span:6}},[_c("div",{staticClass:"flex-middle pT20"},[_c("span",{staticClass:"customize-label pR10"}),_c("el-checkbox",{model:{value:_vm.heatMapOptions.reversePallete,callback:function($$v){_vm.$set(_vm.heatMapOptions,"reversePallete",$$v)},expression:"heatMapOptions.reversePallete"}})],1)])],1)],1):_vm._e(),"undefined"!==typeof _vm.heatMapOptions.showGrandParent?_c("div",[_c("el-row",[_c("el-col",{attrs:{span:18}},[_c("div",{staticClass:"flex-middle"},[_c("p",{staticClass:"label-txt-black pT20 line-height20 mB10"},[_vm._v("Header")])])]),_c("el-col",{attrs:{span:6}},[_c("div",{staticClass:"flex-middle pT20"},[_c("span",{staticClass:"customize-label pR10"},[_vm._v("Show")]),_c("el-checkbox",{model:{value:_vm.heatMapOptions.showGrandParent,callback:function($$v){_vm.$set(_vm.heatMapOptions,"showGrandParent",$$v)},expression:"heatMapOptions.showGrandParent"}})],1)])],1)],1):_vm._e(),"undefined"!==typeof _vm.heatMapOptions.treemapTextMode?_c("div",{staticClass:"customize-input-block"},[_c("el-row",[_c("div",{staticClass:"label-txt-black pT20 pB10 label-line-height"},[_vm._v(" Display Label ")]),_c("el-select",{staticClass:"fc-input-full-border2 width100",attrs:{placeholder:"Select"},model:{value:_vm.heatMapOptions.treemapTextMode,callback:function($$v){_vm.$set(_vm.heatMapOptions,"treemapTextMode",$$v)},expression:"heatMapOptions.treemapTextMode"}},[_c("el-option",{attrs:{label:"Size Metric",value:1}}),_c("el-option",{attrs:{label:"Color Metric",value:2}}),_c("el-option",{attrs:{label:"Dimension Only",value:3}})],1)],1)],1):_vm._e(),"undefined"!==typeof _vm.heatMapOptions.showColorScale?_c("div",[_c("el-row",[_c("el-col",{attrs:{span:18}},[_c("div",{staticClass:"flex-middle"},[_c("div",{staticClass:"label-txt-black pT20 line-height20 mB10"},[_vm._v(" Color Scale ")])])]),_c("el-col",{attrs:{span:6}},[_c("div",{staticClass:"flex-middle pT20"},[_c("span",{staticClass:"customize-label pR10"},[_vm._v("Show")]),_c("el-checkbox",{model:{value:_vm.heatMapOptions.showColorScale,callback:function($$v){_vm.$set(_vm.heatMapOptions,"showColorScale",$$v)},expression:"heatMapOptions.showColorScale"}})],1)])],1)],1):_vm._e(),"undefined"!==typeof _vm.heatMapOptions.showWidgetLegends?_c("div",[_c("el-row",[_c("el-col",{attrs:{span:18}},[_c("div",{staticClass:"flex-middle"},[_c("div",{staticClass:"label-txt-black pT20 line-height20 mB10"},[_vm._v(" Widget Legends ")])])]),_c("el-col",{attrs:{span:6}},[_c("div",{staticClass:"flex-middle pT20"},[_c("span",{staticClass:"customize-label pR10"},[_vm._v("Show")]),_c("el-checkbox",{model:{value:_vm.heatMapOptions.showWidgetLegends,callback:function($$v){_vm.$set(_vm.heatMapOptions,"showWidgetLegends",$$v)},expression:"heatMapOptions.showWidgetLegends"}})],1)])],1),_vm.heatMapOptions.showWidgetLegends?_c("el-collapse",{staticClass:"customize-widget-legends mT20",staticStyle:{padding:"20 15px"},attrs:{accordion:""},model:{value:_vm.activeWidgetLegendItem,callback:function($$v){_vm.activeWidgetLegendItem=$$v},expression:"activeWidgetLegendItem"}},_vm._l(_vm.allPoints.filter((function(dp){return"x"!==dp.axes})),(function(point,index){return _c("el-collapse-item",{key:index,staticClass:"fc-analytics-legend-collapse",attrs:{title:point.label,name:point.alias}},[_c("el-checkbox-group",{staticClass:"pT20",model:{value:_vm.report.options.widgetLegend.variances[point.alias],callback:function($$v){_vm.$set(_vm.report.options.widgetLegend.variances,point.alias,$$v)},expression:"report.options.widgetLegend.variances[point.alias]"}},[[4,8].includes(point.dataTypeId)?_vm._l(point.enumMap,(function(value,key){return _c("el-checkbox",{key:key,staticClass:"width35 pL20 pB20",attrs:{label:key}},[_vm._v(_vm._s(value))])})):_vm._l(["min","max","sum","avg","lastValue"],(function(legend,index){return _c("el-checkbox",{key:index,staticClass:"width35 pL20 pB20",attrs:{label:legend}},[_vm._v(_vm._s(_vm.$constants.VarianceLabels[legend]))])}))],2)],1)})),1):_vm._e()],1):_vm._e(),_c("el-dialog",{staticClass:"fc-dialog-center-container color-pallete-lock",attrs:{title:"Colour palettes",width:"35%",visible:_vm.showColorPalette,"append-to-body":!0,"lock-scroll":!0},on:{"update:visible":function($event){_vm.showColorPalette=$event}}},[_c("div",{staticClass:"heatmap-custom-con"},[_c("el-row",{attrs:{gutter:20}},_vm._l(_vm.heatMapOptions.Colors,(function(colors,index){return _c("el-col",{key:index,staticClass:"dialogcolorpalette mB10",attrs:{span:12}},[_vm.loading?_c("div",{staticClass:"color-palette-loading-con mB10"},[_c("div",{staticClass:"fc-animated-background width100px height20"}),_c("div",{staticClass:"width100 height20 mT10 fc-animated-background"})]):_c("div",[_c("div",{staticClass:"fc-input-label-txt f13 flex-middle position-relative"},[_vm._v(" "+_vm._s(index)+" "),_vm.heatMapOptions.chosenColors===index?_c("div",{staticClass:"selected-icon-color position-absolute"},[_c("InlineSvg",{staticClass:"vertical-middle",attrs:{src:"svgs/check-icon",iconClass:"icon icon-xs mL10"}})],1):_vm._e()]),_c("div",{staticClass:"colorPalette position-relative",on:{click:function($event){return _vm.changeColor(index)}}},_vm._l(colors,(function(color,idx){return _c("div",{key:idx,staticClass:"colorBlock",style:{background:color}})})),0)])])})),1)],1)])],1):_vm._e()])])])},staticRenderFns=[function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"flex-middle"},[_c("p",{staticClass:"label-txt-black pT20 line-height20 mB10"},[_vm._v("Color Palette")])])}],InlineSvg=(__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(976801),__webpack_require__(670560),__webpack_require__(586166)),FHeatMapCustomizationvue_type_script_lang_js={props:["heatMapOptions","report"],data:function(){return{showColorPalette:!1,loading:!0,updateTimeout:null,activeWidgetLegendItem:null}},mounted:function(){},components:{InlineSvg:InlineSvg/* default */.Z},methods:{openDialog:function(){var _this=this;this.showColorPalette=!0,this.loading=!0,this.updateTimeout&&clearTimeout(this.updateTimeout),this.updateTimeout=setTimeout((function(){_this.loading=!1}),500)},changeColor:function(index){this.heatMapOptions.chosenColors=index,this.showColorPalette=!1}},computed:{dataPointObject:{get:function(){return this.report?this.$helpers.getDataPoints(this.report.options.dataPoints,[1,2,4],!0):[]},set:function(newDataPointObject){this.report.options.dataPoints=newDataPointObject}},allPoints:function(){var points=[],FieldsIncluded=[];return this.dataPointObject&&this.dataPointObject.forEach((function(dp){"group"===dp.type?dp.children.forEach((function(children){FieldsIncluded.includes(children.fieldId)||(FieldsIncluded.push(children.fieldId),points.push(children))})):FieldsIncluded.includes(dp.fieldId)||(FieldsIncluded.push(dp.fieldId),points.push(dp))})),points}}},components_FHeatMapCustomizationvue_type_script_lang_js=FHeatMapCustomizationvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FHeatMapCustomizationvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FHeatMapCustomization=component.exports},
/***/486348:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FDerivation}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/energy/analytics/components/FDerivation.vue?vue&type=template&id=75dbeec2
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("div",[_vm.visibility?_c("f-dialog",{staticClass:"derivation newderivation",attrs:{visible:_vm.visibility,width:_vm.modelWidth,maxHeight:"500px"},on:{save:_vm.save,close:_vm.close}},[_c("div",{staticClass:"left-container",class:{active:_vm.showRightView},attrs:{slot:"content"},slot:"content"},[_c("el-col",{staticClass:"left-conatiner-content",attrs:{span:24}},[_c("div",[_c("div",{staticClass:"new-header-container"},[_c("div",{staticClass:"fc-setup-modal-title fL"},[_vm._v(" "+_vm._s(_vm.isEdit?"Edit Derivation":"Add Derivation")+" ")]),_c("div",{staticClass:"summation fR"},[_c("el-button",{staticClass:"formula-btn",attrs:{type:"button"},on:{click:function($event){return _vm.showFunctions()}}},[_c("img",{staticStyle:{width:"10px",height:"10px",opacity:"0.9"},attrs:{src:__webpack_require__(667527)}})])],1)]),_c("div",{staticClass:"fc-input-label-txt mB10 clearboth"},[_vm._v(" Derivation Name ")]),_c("el-input",{staticClass:"el-input-textbox-full-border",attrs:{placeholder:_vm.$t("common._common.enter_name")},model:{value:_vm.newDerivation.name,callback:function($$v){_vm.$set(_vm.newDerivation,"name",$$v)},expression:"newDerivation.name"}}),_c("el-row",{staticClass:"mT20"},[_c("el-col",{attrs:{span:18}},[_c("div",{staticClass:"fc-input-label-txt mB10"},[_vm._v("Expression")]),_c("el-input",{staticClass:"el-input-textbox-full-border",attrs:{placeholder:"Enter Expression"},model:{value:_vm.newDerivation.expResult,callback:function($$v){_vm.$set(_vm.newDerivation,"expResult",$$v)},expression:"newDerivation.expResult"}})],1),_c("el-col",{staticClass:"mL20",attrs:{span:5}},[_c("div",{staticClass:"fc-input-label-txt mB10"},[_vm._v("Unit")]),_c("el-input",{staticClass:"el-input-textbox-full-border",attrs:{placeholder:"Enter Unit"},model:{value:_vm.newDerivation.unitStr,callback:function($$v){_vm.$set(_vm.newDerivation,"unitStr",$$v)},expression:"newDerivation.unitStr"}})],1)],1),_c("div",{staticClass:"fbVariableLegendContainer mT20 formulalengendscontainer"},[_c("table",{attrs:{border:"0",cellspacing:"0",cellpadding:"0"}},_vm._l(_vm.dataPoints,(function(point,index){return _vm.isEdit&&_vm.higherDerivationAliases.includes(point.alias)?_vm._e():_c("tr",{key:index,staticClass:"fbVariableLegend"},[_c("td",{staticClass:"fbVariableLegend"},[_vm._v(_vm._s(point.alias))]),_c("td",{staticClass:"fbVariableLegendInfo"},[_c("span",[_vm._v(_vm._s(point.label))])])])})),0)])],1)])],1),_vm.showRightView?_c("div",{staticClass:"right-container",attrs:{slot:"content"},slot:"content"},[_c("div",{staticClass:"build-functions-scroll"},[_c("div",{staticClass:"fc-setup-modal-title mB20"},[_vm._v("BUILT IN FUNCTIONS")]),_vm._l(_vm.builtInFunctions,(function(fields){return _c("div",{key:fields.value,staticClass:"list-data"},[_c("div",{staticClass:"fields"},[_c("img",{staticClass:"selected-icon",staticStyle:{width:"15px",height:"15px",position:"relative",top:"17px",left:"4px"},attrs:{src:__webpack_require__(552184)},on:{click:function($event){return _vm.addFunction(fields.value)}}}),_c("div",{staticClass:"field-info"},[_vm._v(_vm._s(fields.label))]),_c("div",{staticClass:"bottom"},[_c("el-tooltip",{staticClass:"help-tooltip",attrs:{effect:"dark",placement:"bottom","popper-class":"element-tooltip"}},[_c("div",{attrs:{slot:"content"},slot:"content"},[_vm._v(_vm._s(fields.description))]),_c("img",{staticClass:"derivation-info-icon",attrs:{src:__webpack_require__(196510)}})])],1)])])}))],2)]):_vm._e()]):_vm._e()],1),_c("div")])},staticRenderFns=[],toConsumableArray=__webpack_require__(488478),createForOfIteratorHelper=__webpack_require__(566347),FDialogNew=(__webpack_require__(260228),__webpack_require__(564043),__webpack_require__(322462),__webpack_require__(670560),__webpack_require__(425728),__webpack_require__(450886),__webpack_require__(538077),__webpack_require__(947522),__webpack_require__(865137),__webpack_require__(434284),__webpack_require__(339772),__webpack_require__(919649),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(162506),__webpack_require__(634338),__webpack_require__(857267),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(436756)),expRegex=/(NOT|IF|MIN|MAX|ROUND|ABS|FLOOR|CEILING|LOG|LOG10|SQRT|FACT|PI|TRUE|FALSE|true|false|NULL|null)|([A-Za-z][0-9]*\.(sum|avg|lastValue|min|max))|([A-Za-z][0-9]*)|([^A-Za-z][0-9]*)+/g,alphaRegex=/[a-z]+|\d+/gi,FDerivationvue_type_script_lang_js={props:["report","config","visibility","selectedPoint"],components:{FDialog:FDialogNew/* default */.Z},data:function(){return{modelWidth:"38%",showRightView:!1,newDerivation:{name:"",expResult:"",unitStr:"",analyticsType:this.report.analyticsType},expressionIndex:0,builtInFunctions:[{value:"NOT()",label:"NOT(expression)",description:"Boolean negation, 1 (means true) if the expression is not zero"},{value:"IF()",label:"IF(condition,value_if_true,value_if_false)",description:"Returns one value if the condition evaluates to true or the other if it evaluates to false"},{value:"MIN()",label:"MIN(e1,e2, ...)",description:"Returns the smallest of the given expressions"},{value:"MAX()",label:"MAX(e1,e2, ...)",description:"Returns the biggest of the given expressions"},{value:"ROUND()",label:"ROUND(expression,precision)",description:"Rounds a value to a certain number of digits, uses the current rounding mode"},{value:"ABS()",label:"ABS(expression) ",description:"Returns the absolute (non-negative) value of the expression"},{value:"FLOOR()",label:"FLOOR(expression)",description:"Rounds the value down to the nearest integer"},{value:"CEILING()",label:"CEILING(expression)",description:"Rounds the value up to the nearest integer"},{value:"LOG()",label:"LOG(expression)",description:"Returns the natural logarithm (base e) of an expression"},{value:"LOG10()",label:"LOG10(expression)",description:"Returns the common logarithm (base 10) of an expression"},{value:"SQRT()",label:"SQRT(expression)",description:"Returns the square root of an expression"},{value:"FACT()",label:"FACT(expression)",description:"Retuns the factorial value of an integer. Will return 1 for 0 or a negative number"}]}},computed:{currentAlias:function(){var currentAlias,dpAlias={lastAlias:0,lastNum:0};if(this.isEdit)currentAlias=this.selectedPoint.alias;else{var _step,aliases=[],dataPoints=this.$helpers.getDataPoints(this.report.options.dataPoints,[1,2,4],!0),_iterator=(0,createForOfIteratorHelper/* default */.Z)(dataPoints);try{for(_iterator.s();!(_step=_iterator.n()).done;){var dataPoint=_step.value;if("datapoint"===dataPoint.type)aliases.push(dataPoint);else{var _step2,_iterator2=(0,createForOfIteratorHelper/* default */.Z)(dataPoint.children);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var child=_step2.value;aliases.push(child)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}}}catch(err){_iterator.e(err)}finally{_iterator.f()}aliases.forEach((function(dp){if(dp.alias.length>1){var num=dp.alias.match(alphaRegex)[1];dpAlias.lastNum=num>dpAlias.lastNum?num:dpAlias.lastNum}else dpAlias.lastAlias=dp.alias.charCodeAt(0)>dpAlias.lastAlias?dp.alias.charCodeAt(0):dpAlias.lastAlias})),currentAlias=this.$helpers.getNextAlias(dpAlias)}return currentAlias},configSelectedPoint:function(){var _this=this;return this.isEdit?this.$helpers.getDataPoints(this.config.dataPoints,[1,2,4],!0).find((function(dp){return dp.aliases.actual===_this.selectedPoint.key})):null},isEdit:function(){return void 0!==this.selectedPoint},higherDerivationAliases:function(){var _this2=this,aliases=[];return this.isEdit&&(aliases=this.$helpers.getDataPoints(this.report.options.dataPoints,[1,2,4],!0).filter((function(dp){return 2===dp.pointType&&_this2.isHigherAlias(dp.alias)})).map((function(dp){return dp.alias}))),aliases},dataPoints:function(){var dataPoints=[];return this.$helpers.getDataPoints(this.report.options.dataPoints,[1,2,4],!0).forEach((function(dp){"group"===dp.type||"rangeGroup"===dp.type?dataPoints.push.apply(dataPoints,(0,toConsumableArray/* default */.Z)(dp.children)):dataPoints.push(dp)})),dataPoints.sort()}},mounted:function(){var _this3=this;if(this.isEdit){this.newDerivation.name=this.configSelectedPoint.name,this.newDerivation.unitStr=this.configSelectedPoint.yAxis.unitStr;var alias=this.currentAlias;this.newDerivation.expResult=this.report.options.derivations[alias].result,this.expressionIndex=this.config.transformWorkflow.expressions[0].expressions.findIndex((function(exp){return"put"===exp.name&&exp.defaultFunctionContext&&exp.defaultFunctionContext.params===_this3.getResultFuncParam(alias)}))-1}else this.expressionIndex=this.config.transformWorkflow?this.config.transformWorkflow.expressions[0].expressions.length:0},methods:{close:function(){this.$emit("update:visibility",!1)},showFunctions:function(){this.showRightView=!this.showRightView,this.showRightView?this.modelWidth="60%":this.modelWidth="38%"},addFunction:function(fieldsList){this.newDerivation.expResult+=" "+fieldsList},save:function(){var _this4=this,aliasesUsed=(0,toConsumableArray/* default */.Z)(new Set(this.newDerivation.expResult.match(/[A-Z]+/g)));if(this.validate(aliasesUsed)){var alias=this.currentAlias;this.config.transformWorkflow||(this.config.transformWorkflow={parameters:[{name:"data",typeString:"list"},{name:"aggr",typeString:"map"}],expressions:[{workflowExpressionType:2,iteratableVariable:"data",loopVariableIndexName:"index",loopVariableValueName:"value",expressions:[]}]}),this.setWorkflowExpression(alias,this.config.transformWorkflow.expressions[0].expressions),this.setDerivationDetails(alias,aliasesUsed);var point={name:this.newDerivation.name,type:2,aliases:{actual:alias},xAxis:{label:"Timestamp"},yAxis:{dataType:3,label:this.newDerivation.name,unitStr:this.newDerivation.unitStr}};if(this.isEdit){var _this$report;if(null!==this&&void 0!==this&&null!==(_this$report=this.report)&&void 0!==_this$report&&null!==(_this$report=_this$report.options)&&void 0!==_this$report&&null!==(_this$report=_this$report.dataPoints)&&void 0!==_this$report&&_this$report.length){var option_idx=this.report.options.dataPoints.findIndex((function(dp){return dp.name===_this4.configSelectedPoint.name}));this.$set(this.report.options.dataPoints[option_idx],"label",this.newDerivation.name),this.$set(this.report.options.dataPoints[option_idx],"name",this.newDerivation.name)}var idx=this.config.dataPoints.findIndex((function(dp){return dp.name===_this4.configSelectedPoint.name}));this.$set(this.config.dataPoints,idx,point)}else this.config.dataPoints.push(point);this.close()}},setWorkflowExpression:function(alias,itrExp){var _this5=this,match=expRegex.exec(this.newDerivation.expResult),result="",expressions=[],_loop=function(){if(match[2]){var name="aggr".concat(match[2].replace(".",""));[].concat((0,toConsumableArray/* default */.Z)(itrExp),expressions).some((function(exp){return exp.name===name}))||(expressions.push({name:name,defaultFunctionContext:{nameSpace:"map",functionName:"get",params:"aggr, '"+match[2]+"'"}}),match[0]=name)}else if(match[4]&&(result+="param",![].concat((0,toConsumableArray/* default */.Z)(itrExp),expressions).some((function(exp){return exp.name==="param".concat(match[4])})))){var dp=_this5.dataPoints.find((function(dp){return dp.alias===match[4]})),value="value, '"+match[4];4!==dp.dataTypeId&&8!==dp.dataTypeId||(value+=".value"),value+="'",expressions.push({name:"param".concat(match[4]),defaultFunctionContext:{nameSpace:"map",functionName:"get",params:value}})}result+=match[0],match=expRegex.exec(_this5.newDerivation.expResult)};while(null!=match)_loop();expressions.push({name:"result",expr:result},{name:"put",
// Please change the expressionIndex finding also if name is changed
defaultFunctionContext:{nameSpace:"map",functionName:"put",params:this.getResultFuncParam(alias)}}),itrExp.splice.apply(itrExp,[this.expressionIndex,this.isEdit?2:0].concat(expressions))},getResultFuncParam:function(alias){return"value, '"+alias+"', result"},setDerivationDetails:function(alias,aliasesUsed){this.report.options.derivations||(this.report.options.derivations={}),this.report.options.derivations[alias]={result:this.newDerivation.expResult,
// usedIn: [],
usedAliases:aliasesUsed}},validate:function(aliasesUsed){var errorMessage,_this6=this,variables=aliasesUsed;if(this.newDerivation.name)if(this.newDerivation.expResult)if(variables.some((function(v){return _this6.higherDerivationAliases.includes(v)})))errorMessage="Some derivations cannot be used";else{var brackets=this.newDerivation.expResult.match(/[\\(\\)]/g);if(brackets){var openBrackets=brackets.filter((function(b){return"("===b})),closedBrackets=brackets.filter((function(b){return")"===b}));openBrackets.length!==closedBrackets.length&&(errorMessage="Please enter valid expression")}}else errorMessage="Please enter expression";else errorMessage="Please enter name";return!errorMessage||(this.$message.error(errorMessage),!1)},isHigherAlias:function(alias){return 1==alias.length&&1==this.currentAlias.length?alias.charCodeAt(0)>=this.currentAlias.charCodeAt(0):1!=alias.length&&(1==this.currentAlias.length||alias.match(alphaRegex)[1]>=this.currentAlias.match(alphaRegex)[1])}}},components_FDerivationvue_type_script_lang_js=FDerivationvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FDerivationvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FDerivation=component.exports},
/***/35662:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return Treemap}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/energy/analytics/newTools/Treemap.vue?vue&type=template&id=c42d9cd6
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{key:_vm.$route.path,staticClass:"fc-energy-building-analysis"},[_c("div",{staticClass:"report-main-con"},[_c("div",{},[_c("f-report-options",{staticClass:"analytics-page-options-building-analysis fc-v1-portfolio-anlaysis",attrs:{isActionsDisabled:_vm.isActionsDisabled,optionClass:"analytics-page-options",optionsToEnable:[5,1,2],reportObject:_vm.reportObject,resultObject:_vm.resultObject,params:_vm.reportObject?_vm.reportObject.params:null,savedReport:_vm.analyticsConfig.savedReport,pdf:!1},on:{"update:savedReport":function($event){return _vm.$set(_vm.analyticsConfig,"savedReport",$event)},"update:saved-report":function($event){return _vm.$set(_vm.analyticsConfig,"savedReport",$event)}}})],1),_c("div",{staticClass:"report-sidebar-con"},[_vm.hideSideBar?_vm._e():_c("div",{class:{"new-report-sidebar fc-new-report-sidebar col-3 pT0":!_vm.hideSideBar}},[_c("div",{directives:[{name:"show",rawName:"v-show",value:_vm.showgeneratedata,expression:"showgeneratedata"}],staticClass:"report-sidebar-inner"},[_c("div",{staticClass:"analytics-body p20 clearboth"},[_c("div",{staticClass:"fc-text-pink"},[_vm._v(" "+_vm._s(_vm.$t("home.dashboard.generate_chart"))+" ")]),_c("el-row",{staticClass:"mT10"},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"label-txt-black pB5"},[_vm._v(" "+_vm._s(_vm.$t("home.reports.dimension"))+" ")]),_c("el-select",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"period-select width100 fc-input-full-border2 ",attrs:{placeholder:_vm.$t("common._common.mode"),title:_vm.$t("home.reports.dimension"),"data-arrow":"true"},on:{change:_vm.onModeChange},model:{value:_vm.analyticsConfig.mode,callback:function($$v){_vm.$set(_vm.analyticsConfig,"mode",$$v)},expression:"analyticsConfig.mode"}},[_c("el-option",{attrs:{label:_vm.$t("common.wo_report.time"),value:4}}),_c("el-option",{attrs:{label:_vm.$t("common.products.site"),value:6}}),_c("el-option",{attrs:{label:_vm.$t("common._common.building"),value:7}}),_c("el-option",{attrs:{label:_vm.$t("common._common.asset"),value:8}})],1)],1)],1),_c("el-row",{staticClass:"pT20"},[_c("div",{staticClass:"label-txt-black pB10"},[_vm._v(" "+_vm._s(_vm.$t("common._common.size_based_on"))+" ")]),_c("el-col",{attrs:{span:_vm.sizeDataPoint?20:24}},[_vm.sizeDataPoint?[_c("el-row",{staticClass:"visibility-visible-actions"},[_c("el-col",[_c("div",{staticClass:"fc-input-div-full-border-f14",on:{click:function($event){_vm.showSizeDataPointSelector=!0,_vm.showDataPointSelector=!0}}},[_c("span",[_vm._v(" "+_vm._s(_vm.sizeDataPoint.name)+" ")]),_c("i",{staticClass:"pointer mT12 el-icon-arrow-right pull-right"})])])],1)]:_c("div",{staticClass:"fc-input-div-full-border-f14 position-relative",on:{click:function($event){_vm.showSizeDataPointSelector=!0,_vm.showDataPointSelector=!0}}},[_c("span",[_vm._v(" "+_vm._s(_vm.$t("common._common.select"))+" ")]),_c("i",{staticClass:" pointer mT12 el-icon-arrow-right pull-right heatmap-right-icon"})])],2),_vm.sizeDataPoint?_c("el-col",{staticClass:"pL5",attrs:{span:4}},[_c("div",{staticClass:"fc-input-div-full-border pointer"},[_c("el-popover",{attrs:{disabled:!_vm.sizeDataPoint||_vm.isModuleField(_vm.sizeDataPoint),placement:"top-start",width:"90",trigger:"hover","popper-class":"metric-popover"},model:{value:_vm.toggleSizeAggr,callback:function($$v){_vm.toggleSizeAggr=$$v},expression:"toggleSizeAggr"}},[_vm._l(_vm.aggregations,(function(metricAggr,metricAggrIdx){return _c("div",{key:metricAggrIdx,staticClass:"pointer pT5 pB5 fc-label-hover label-txt-black f14 text-center",class:{"selected-field-background":metricAggr.value===_vm.sizeDataPoint.yAxis.aggr},attrs:{value:metricAggr.value},on:{click:function($event){_vm.sizeDataPoint.yAxis.aggr=metricAggr.value}}},[_vm._v(" "+_vm._s(metricAggr.label)+" ")])})),_c("img",{attrs:{slot:"reference",disabled:!_vm.sizeDataPoint||_vm.isModuleField(_vm.sizeDataPoint),src:__webpack_require__(667527)},slot:"reference"})],2)],1)]):_vm._e()],1),_c("el-row",{staticClass:"pT20"},[_c("div",{staticClass:"label-txt-black pB10"},[_vm._v(" "+_vm._s(_vm.$t("common.header.color_based_on"))+" ")]),_c("el-col",{attrs:{span:_vm.colorDataPoint?20:24}},[_vm.colorDataPoint?[_c("el-row",{staticClass:"visibility-visible-actions"},[_c("el-col",[_c("div",{staticClass:"fc-input-div-full-border-f14",on:{click:function($event){_vm.showColorDataPointSelector=!0,_vm.showDataPointSelector=!0}}},[_c("span",[_vm._v(_vm._s(_vm.colorDataPoint.name))]),_c("i",{staticClass:"pointer mT12 el-icon-arrow-right pull-right"})])])],1)]:_c("div",{staticClass:"fc-input-div-full-border-f14 position-relative",on:{click:function($event){_vm.showColorDataPointSelector=!0,_vm.showDataPointSelector=!0}}},[_c("span",[_vm._v(_vm._s(_vm.$t("common._common.select")))]),_c("i",{staticClass:"pointer mT12 el-icon-arrow-right pull-right heatmap-right-icon"})])],2),_vm.colorDataPoint?_c("el-col",{staticClass:"pL5",attrs:{span:4}},[_c("div",{staticClass:"fc-input-div-full-border pointer"},[_c("el-popover",{attrs:{disabled:!_vm.colorDataPoint||_vm.isModuleField(_vm.colorDataPoint),placement:"top-start",width:"90",trigger:"hover","popper-class":"metric-popover"},model:{value:_vm.toggleColorAggr,callback:function($$v){_vm.toggleColorAggr=$$v},expression:"toggleColorAggr"}},[_vm._l(_vm.aggregations,(function(metricAggr,metricAggrIdx){return _c("div",{key:metricAggrIdx,staticClass:"pointer pT5 pB5 fc-label-hover label-txt-black f14 text-center",class:{"selected-field-background":metricAggr.value===_vm.colorDataPoint.yAxis.aggr},attrs:{value:metricAggr.value},on:{click:function($event){_vm.colorDataPoint.yAxis.aggr=metricAggr.value}}},[_vm._v(" "+_vm._s(metricAggr.label)+" ")])})),_c("img",{attrs:{slot:"reference",disabled:!_vm.colorDataPoint||_vm.isModuleField(_vm.colorDataPoint),src:__webpack_require__(667527)},slot:"reference"})],2)],1)]):_vm._e()],1),_vm.isTimeMode?_c("el-row",[_c("el-col",{staticClass:"mT20",attrs:{span:24}},[_c("div",{staticClass:"label-txt-black pB5"},[_vm._v(" "+_vm._s(_vm.$t("common.dashboard.time_period"))+" ")]),_c("el-select",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"period-select width100 fc-input-full-border2",attrs:{placeholder:_vm.$t("common.wo_report.period"),title:_vm.$t("common.dashboard.time_period"),"data-arrow":"true"},on:{change:_vm.onPeriodChange},model:{value:_vm.analyticsConfig.period,callback:function($$v){_vm.$set(_vm.analyticsConfig,"period",$$v)},expression:"analyticsConfig.period"}},_vm._l(_vm.availablePeriods,(function(period,index){return _c("el-option",{key:index,attrs:{label:period.name,value:period.value,disabled:!period.enable}})})),1)],1)],1):_vm._e(),_vm.isTimeMode?_vm._e():_c("el-row",[_c("el-col",{staticClass:"mT20",attrs:{span:24}},[_c("div",{staticClass:"fc-text-pink fw6"},[_vm._v(" "+_vm._s(_vm.$t("home.reports.sorting"))+" ")]),_c("div",{staticClass:"mT15"},[_c("el-form",{ref:"reportSortingForm",attrs:{model:_vm.analyticsConfig.sorting,"label-position":"top"}},[_vm.resultObject&&_vm.resultObject.report.dataPoints.length>1&&!_vm.isSameDataPoint?_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"sortByField"}},[_c("div",{staticClass:"label-txt-black pB5 label-line-height"},[_vm._v(" "+_vm._s(_vm.$t("common._common.sort_by"))+" ")]),_c("el-select",{staticClass:"period-select width100 fc-input-full-border2 ",staticStyle:{width:"90%"},model:{value:_vm.analyticsConfig.sorting.sortByField,callback:function($$v){_vm.$set(_vm.analyticsConfig.sorting,"sortByField",$$v)},expression:"analyticsConfig.sorting.sortByField"}},_vm._l(_vm.resultObject.report.dataPoints,(function(dp,index){return _c("el-option",{key:index,attrs:{label:dp.name,value:dp.yAxis.fieldId}})})),1)],1)],1)],1):_vm._e(),_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"orderByFunc"}},[_c("div",{staticClass:"label-txt-black pB5 label-line-height"},[_vm._v(" "+_vm._s(_vm.$t("common._common.sort_order"))+" ")]),_c("el-select",{staticClass:"period-select width100 fc-input-full-border2",staticStyle:{width:"90%"},model:{value:_vm.analyticsConfig.sorting.orderByFunc,callback:function($$v){_vm.$set(_vm.analyticsConfig.sorting,"orderByFunc",$$v)},expression:"analyticsConfig.sorting.orderByFunc"}},[_c("el-option",{attrs:{label:_vm.$t("common._common.ascending"),value:2}}),_c("el-option",{attrs:{label:_vm.$t("common._common.descending"),value:3}})],1)],1)],1)],1),_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"limit"}},[_c("div",{staticClass:"label-txt-black pB5 label-line-height"},[_vm._v(" "+_vm._s(_vm.$t("common._common.limit"))+" ")]),_c("el-select",{staticClass:"period-select width100 fc-input-full-border2",staticStyle:{width:"90%"},model:{value:_vm.analyticsConfig.sorting.limit,callback:function($$v){_vm.$set(_vm.analyticsConfig.sorting,"limit",$$v)},expression:"analyticsConfig.sorting.limit"}},_vm._l(20,(function(i){return i>=3?_c("el-option",{key:i,attrs:{label:i,value:i}}):_vm._e()})),1)],1)],1)],1)],1)],1)])],1),_c("el-row",{staticClass:"mT20"},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"label-txt-black pB10 pB5"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm_list.filters"))+" ")]),_c("div",{staticClass:"fL"},[1===_vm.setfilter?_c("div",[_c("div",{staticClass:"fc-black2 f14 fw-bold pB5"},[_vm._v(" "+_vm._s(_vm.$t("common.header.edit_filter"))+" ")])]):_c("div",[_c("div",{staticClass:"fc-black2 f14 fw-bold pB5"},[_vm._v(" "+_vm._s(_vm.$t("common._common.add_filter"))+" ")])])]),_c("div",{staticClass:"fR"},[1===_vm.setfilter?_c("span",{staticClass:"pointer label-txt-blue2 pR10",on:{click:_vm.resetFilter}},[_vm._v(_vm._s(_vm.$t("common._common.reset")))]):_vm._e(),_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-edit report-edit-icon pointer",attrs:{title:_vm.$t("common.header.edit_filters")},on:{click:function($event){_vm.filtersPopover=!0,_vm.prepareFilterData()}}})])])],1)],1)])]),_vm.hideSideBar?_vm._e():_c("div",{class:{"new-chart-custom fc-new-portfolio-chart-custom":!_vm.hideSideBar}},[_vm.reportObject?_c("div",{directives:[{name:"show",rawName:"v-show",value:_vm.showCustomization,expression:"showCustomization"}],staticClass:"customize-container building-customize-container col-3 fc-new-portfolio-cus fc-heatmap-cus",staticStyle:{top:"0px"}},[_c("div",{staticClass:"customize-header pB10"},[_c("div",{staticClass:"fc-text-pink"},[_vm._v(" "+_vm._s(_vm.$t("home.reports.chart_customization"))+" ")])]),_c("div",{staticClass:"customize-body fc-customize-body pT0"},[_vm.reportObject?_c("FHeatMapCustomization",{directives:[{name:"show",rawName:"v-show",value:_vm.showCustomization,expression:"showCustomization"}],attrs:{report:_vm.reportObject,heatMapOptions:_vm.heatMapOptions},on:{close:function($event){_vm.showCustomization=!1,_vm.showgeneratedata=!0}}}):_vm._e()],1)]):_vm._e()]),_c("f-portfolio-data-point-selector",{ref:"building-selector",attrs:{mode:_vm.analyticsConfig.mode,visibility:_vm.showDataPointSelector,isSinglePointSelector:!0,disableMultipleAssetCategories:"true"},on:{"update:visibility":function($event){_vm.showDataPointSelector=$event},selectBuildings:_vm.setSelectedBuildings,updateDataPoints:_vm.updateDataPoints}}),_vm.hideSideBar?_vm._e():_c("div",{staticClass:"analytics-options-block"},[_c("div",{},[_c("div",{staticClass:"text-center analytics-report-icon-bg line-height50 height50",class:{"analytics-report-icon-bg-active":_vm.showgeneratedata},on:{click:function($event){return _vm.showgeneratedataDialog()}}},[_c("InlineSvg",{attrs:{src:"statistics",iconClass:"icon icon-sm-md  vertical-middle"}})],1),_c("div",{staticClass:"text-center analytics-report-icon-bg line-height50 height50",class:{"analytics-report-icon-bg-active":_vm.showCustomization},attrs:{disabled:!_vm.reportObject},on:{click:function($event){_vm.reportObject&&_vm.showCustomizationDialog()}}},[_c("InlineSvg",{attrs:{src:"settings-grey",iconClass:"icon icon-sm-md vertical-middle"}})],1),_c("div",{staticClass:"text-center analytics-report-icon-bg line-height50 height50",on:{click:function($event){return _vm.toggleSideBar()}}},[_c("InlineSvg",{attrs:{src:"arrow-pointing-to-left2",iconClass:"icon icon-sm-md vertical-middle"}})],1)])]),_vm.hideSideBar?_c("div",{staticClass:"analytics-options-block",style:{left:_vm.cssLeft}},[_c("div",{},[_c("div",{staticClass:"text-center analytics-report-icon-bg line-height50 height50",class:{"analytics-report-icon-bg-active":_vm.showgeneratedata},on:{click:function($event){return _vm.showgeneratedataDialog()}}},[_c("InlineSvg",{attrs:{src:"statistics",iconClass:"icon icon-sm-md  vertical-middle"}})],1),_c("div",{staticClass:"text-center analytics-report-icon-bg line-height50 height50",class:{"analytics-report-icon-bg-active":_vm.showCustomization},attrs:{disabled:!_vm.reportObject},on:{click:function($event){_vm.reportObject&&_vm.showCustomizationDialog()}}},[_c("InlineSvg",{attrs:{src:"settings-grey",iconClass:"icon icon-sm-md vertical-middle"}})],1),_c("div",{staticClass:"text-center analytics-report-icon-bg line-height50 height50",on:{click:function($event){return _vm.toggleSideBar()}}},[_c("InlineSvg",{staticStyle:{transform:"rotate(180deg)"},attrs:{src:"arrow-pointing-to-left2",iconClass:"icon icon-sm-md vertical-middle"}})],1)])]):_vm._e(),_c("div",{staticClass:"report-graph-con position-relative",class:{"new-report-graph-con-heatmap":!_vm.hideSideBar,"new-report-graph-con-stretch":_vm.hideSideBar},staticStyle:{height:"calc(100vh - 100px)","overflow-y":"scroll","padding-bottom":"100px"}},[_c("div",{ref:"chartSection",class:["self-center fchart-section building-graph-container heatmap-graph-container",{"prediction-timings-container":_vm.analyticsConfig.predictionTimings&&_vm.analyticsConfig.predictionTimings.length>1}]},[_vm.analyticsConfig.dataPoints.length?_c("div",[!1===_vm.isOptimize?_c("f-new-analytic-report-optimize",{ref:"newAnalyticReport",staticClass:"text-center",attrs:{config:_vm.analyticsConfig,baseLines:_vm.baseLineList,showTimePeriod:1===_vm.analyticsConfig.mode,showChartMode:!0,heatMapOptions:_vm.heatMapOptions,chartDimensions:_vm.chartDimensions},on:{"update:config":function($event){_vm.analyticsConfig=$event},reportLoaded:_vm.reportLoaded}}):_vm._e(),!0===_vm.isOptimize?_c("f-new-analytic-report",{ref:"newAnalyticReport",attrs:{config:_vm.analyticsConfig,baseLines:_vm.baseLineList,showTimePeriod:1===_vm.analyticsConfig.mode,showChartMode:!0},on:{"update:config":function($event){_vm.analyticsConfig=$event},reportLoaded:_vm.reportLoaded}}):_vm._e()],1):_c("div",{staticClass:"text-center"},[_vm.reportId||_vm.alarmId||_vm.cardId?_c("div",{staticClass:"p15"},[_c("spinner",{attrs:{show:!0}})],1):_c("div",{staticClass:"p15 flex-middle height80vh justify-content-center flex-direction-column"},[_c("div",[_c("inline-svg",{attrs:{src:"svgs/emptystate/reportlist",iconClass:"icon text-center icon-xxxlg"}})],1),_c("div",{staticClass:"nowo-label"},[_vm._v(" "+_vm._s(_vm.$t("common._common.please_select_data_points_analyze"))+" ")])])])])])],1)]),_c("el-dialog",{staticClass:"fc-dialog-center-container fc-dialog-center-container-body-p20",attrs:{visible:_vm.filtersPopover,width:"30%",title:_vm.$t("common._common.add_filters"),"lock-scroll":!1},on:{"update:visible":function($event){_vm.filtersPopover=$event}}},[_c("div",{staticClass:"height100 pB50"},[_c("el-form",{ref:"reportFilterForm",attrs:{model:_vm.reportFilterForm,"label-position":"top"}},[_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"assetFilter"}},[_c("p",{staticClass:"grey-text2"},[_vm._v(" "+_vm._s(_vm.$t("common._common.select_sites"))+" ")]),_c("FLookupFieldWrapper",{attrs:{field:{lookupModule:{name:"site"},multiple:!0},hideWizard:!0},on:{recordSelected:function($event){return _vm.updateFilterdata("site")}},model:{value:_vm.reportFilterForm.siteFilter,callback:function($$v){_vm.$set(_vm.reportFilterForm,"siteFilter",$$v)},expression:"reportFilterForm.siteFilter"}})],1)],1)],1),_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"assetFilter"}},[_c("p",{staticClass:"grey-text2"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.select_buildings"))+" ")]),_c("FLookupFieldWrapper",{attrs:{field:{lookupModule:{name:"building"},multiple:!0},hideWizard:!0},on:{recordSelected:function($event){return _vm.updateFilterdata("building")}},model:{value:_vm.reportFilterForm.buildingFilter,callback:function($$v){_vm.$set(_vm.reportFilterForm,"buildingFilter",$$v)},expression:"reportFilterForm.buildingFilter"}})],1)],1)],1),_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"assetFilter"}},[_c("p",{staticClass:"grey-text2"},[_vm._v(" "+_vm._s(_vm.$t("common._common.select_asset_category"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border2 width100 fc-tag",attrs:{filterable:"",multiple:"","collapse-tags":""},on:{change:function($event){return _vm.updateFilterdata("category")}},model:{value:_vm.reportFilterForm.categoryFilter,callback:function($$v){_vm.$set(_vm.reportFilterForm,"categoryFilter",$$v)},expression:"reportFilterForm.categoryFilter"}},_vm._l(_vm.selectedCategory.categoryList,(function(category,index){return _vm.selectedCategory.categoryList&&_vm.selectedCategory.categoryList.length?_c("el-option",{key:index,attrs:{label:category.name,value:category.id}}):_vm._e()})),1)],1)],1)],1),_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"assetFilter"}},[_c("p",{staticClass:"grey-text2"},[_vm._v(" "+_vm._s(_vm.$t("common._common.select_assets"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border2 width100 fc-tag",attrs:{filterable:"",multiple:"","collapse-tags":""},model:{value:_vm.reportFilterForm.assetFilter,callback:function($$v){_vm.$set(_vm.reportFilterForm,"assetFilter",$$v)},expression:"reportFilterForm.assetFilter"}},_vm._l(_vm.selectedCategory.assetList,(function(asset,index){return _vm.selectedCategory.assetList&&_vm.selectedCategory.assetList.length?_c("el-option",{key:index,attrs:{label:_vm.assetsMap[Number(asset)],value:Number(asset)}}):_vm._e()})),1)],1)],1)],1),_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"field"}},[_c("p",{staticClass:"grey-text2"},[_vm._v(_vm._s(_vm.$t("common._common.live_filter")))]),_c("el-select",{staticClass:"fc-input-full-border2 width100 ",attrs:{placeholder:_vm.$t("common.products._select_")},model:{value:_vm.reportFilterForm.liveFilterField,callback:function($$v){_vm.$set(_vm.reportFilterForm,"liveFilterField",$$v)},expression:"reportFilterForm.liveFilterField"}},[_c("el-option",{attrs:{value:"none",label:_vm.$t("common.wo_report.none")}}),_c("el-option",{attrs:{value:"site",label:_vm.$t("common.products.site")}}),_c("el-option",{attrs:{value:"building",label:_vm.$t("common._common.building")}}),_c("el-option",{attrs:{value:"asset",label:_vm.$t("common._common.asset")}})],1)],1)],1),_vm.reportFilterForm.liveFilterField&&"none"!==_vm.reportFilterForm.liveFilterField?_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"selectBoxType"}},[_c("p",{staticClass:"grey-text2"},[_vm._v(_vm._s(_vm.$t("common._common.type")))]),_c("el-select",{staticClass:"fc-input-full-border2 width100",model:{value:_vm.reportFilterForm.liveFilterType,callback:function($$v){_vm.$set(_vm.reportFilterForm,"liveFilterType",$$v)},expression:"reportFilterForm.liveFilterType"}},[_c("el-option",{attrs:{value:"single",label:_vm.$t("common.header.single_select_box")}}),_c("el-option",{attrs:{value:"multi",label:_vm.$t("common.header.single_select_box")}})],1)],1)],1):_vm._e()],1)],1)],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){_vm.filtersPopover=!1}}},[_vm._v(_vm._s(_vm.$t("setup.users_management.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:function($event){return _vm.applyFilter(null)}}},[_vm._v(_vm._s(_vm.$t("maintenance.pm_list.apply")))])],1)]),_vm.showDerivation?_c("derivation",{attrs:{visibility:_vm.showDerivation,report:_vm.reportObject,config:_vm.analyticsConfig},on:{"update:visibility":function($event){_vm.showDerivation=$event}}}):_vm._e()],1)},staticRenderFns=[],toConsumableArray=__webpack_require__(488478),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),objectSpread2=__webpack_require__(595082),createForOfIteratorHelper=__webpack_require__(566347),AnalyticsMixin=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(538077),__webpack_require__(169358),__webpack_require__(670560),__webpack_require__(434284),__webpack_require__(976801),__webpack_require__(450886),__webpack_require__(212826),__webpack_require__(648324),__webpack_require__(634338),__webpack_require__(843843),__webpack_require__(244936)),FNewAnalyticsReportV1=__webpack_require__(937376),FNAROptimize=__webpack_require__(520245),FPortfolioDataPointSelector=__webpack_require__(852244),FDerivation=__webpack_require__(486348),FHeatMapCustomization=__webpack_require__(359911),FReportOptions=__webpack_require__(791514),NewDateHelper=__webpack_require__(105534),InlineSvg=__webpack_require__(586166),cloneDeep=__webpack_require__(150361),cloneDeep_default=__webpack_require__.n(cloneDeep),vuex_esm=__webpack_require__(420629),FLookupFieldWrapper=__webpack_require__(201117),api=__webpack_require__(32284),Treemapvue_type_script_lang_js={props:["mobileConfig"],mixins:[AnalyticsMixin/* default */.Z],components:{Derivation:FDerivation/* default */.Z,FNewAnalyticReport:FNewAnalyticsReportV1/* default */.Z,FNewAnalyticReportOptimize:FNAROptimize/* default */.Z,FHeatMapCustomization:FHeatMapCustomization/* default */.Z,FPortfolioDataPointSelector:FPortfolioDataPointSelector/* default */.Z,FReportOptions:FReportOptions/* default */.Z,InlineSvg:InlineSvg/* default */.Z,FLookupFieldWrapper:FLookupFieldWrapper/* default */.Z},data:function(){return{hideSideBar:!1,enableFloatimngIcon:!0,showDataPointSelector:!1,showColorDataPointSelector:!1,showSizeDataPointSelector:!1,showgeneratedata:!0,showCustomization:!1,showDerivation:!1,selectedBaseLineId:"",baseLineList:null,baseLineCasecaderOptions:[],oldBaseLine:null,toggleSizeAggr:!1,toggleColorAggr:!1,analyticsConfig:{name:"Tree Map Analysis",key:"TREE_MAP_ANALYSIS",analyticsType:7,hidechartoptions:!0,hidecharttypechanger:!0,type:"reading",period:12,mode:7,baseLine:null,dateFilter:NewDateHelper/* default */.Z.getDatePickerObject(49,30),chartViewOption:0,dataPoints:[],predictionTimings:[],transformWorkflow:null,filters:{xCriteriaMode:5},sorting:{sortByField:null,orderByFunc:3,limit:10}},chartDimensions:{width:980,height:600},aggregations:[{label:this.$t("common._common.sum"),value:3,name:this.$t("common._common.sum")},{label:this.$t("common.header.avg"),value:2,name:this.$t("common.header.avg")},{label:this.$t("common._common.min"),value:4,name:this.$t("common._common.min")},{label:this.$t("common._common.max"),value:5,name:this.$t("common._common.max")}],sizeDataPoint:null,colorDataPoint:null,heatMapOptions:{Colors:{Default:["#5EC343","#90E214","#E9F600","#FDA504","#F47533"],"Palette 1":["#40AF22","#77C700","#FFA000","#F76E0C","#E54619"],"Palette 2":["#16AC99","#037E80","#004852","#D25A38","#E8721E"],"Palette 3":["#70B804","#2DA70C","#006A6D","#002E5B","#2E004D"],"Palette 4":["#00AAB3","#009BC2","#2872C7","#623CB7","#C84D99"],"Palette 5":["#3A688A","#27916F","#44AE7A","#A4B83B","#839A08"],"Palette 6":["#4BB82D","#2DA70C","#44AE7A","#18898B","#076163"],"Palette 7":["#AFE7FF","#87DBFF","#69D2FF","#64C2FF","#53B4F2"],"Palette 8":["#C5E3FF","#FFB5B4","#B0F7CF","#C1A4FF","#FDCEE3"],"Palette 9":["#32AEF9","#1F98E3","#177ABD","#1869A0","#135582"],"Palette 10":["#FFA000","#FF7E30","#E02564","#500083","#0B0310"],"Palette 11":["#1CACEE","#009BE2","#3674FF","#0150FF","#1700FF"],"Palette 12":["#E8E4FF","#D8D1FD","#BDABF6","#AA90FB","#987AF4"],"Palette 13":["#00BBA4","#009BC2","#4D60A6","#4E177D","#4A0052"],"Palette 14":["#FFF2B5","#F7E383","#FFA085","#F4797B","#DF6A6B"],"Palette 15":["#F7E383","#F4D814","#FFC05C","#FFAA82","#FF9665"],"Palette 16":["#DC687F","#24C4BC","#366CBA","#30B089","#0297CC"],"Palette 17":["#135582","#1869A0","#177ABD","#1F98E3","#32AEF9"]},reversePallete:!1,chosenColors:"Default",minValue:null,maxValue:null,showGrandParent:!0,showColorScale:!0,showWidgetLegends:!1,treemapTextMode:1},reportObject:null,resultObject:null,selectedBuildings:[],selectedBuildingTitle:"",zones:null,dataPointSummaryList:null,reportFilterForm:{siteFilter:[],buildingFilter:[],categoryFilter:[],assetFilter:[],liveFilterField:"none",liveFilterType:"single"},buildingList:null,setfilter:0,filtersPopover:!1,selectedCategory:{categoryId:[],assetList:null,allAsset:null,categoryList:null,allBuildings:null}}},created:function(){this.$store.dispatch("loadAlarmSeverity"),this.$store.dispatch("loadAssetCategory"),this.getBuildingList()},watch:{availablePeriods:{handler:function(newData,oldData){var _this=this,avail=this.availablePeriods,selected=avail.find((function(a){return a.value===_this.analyticsConfig.period&&a.enable}));if(!selected){var filterName=this.analyticsConfig.dateFilter.operationOn,defaultPeriod=avail.filter((function(a){return a.enable}))[0].value;("week"===filterName||"month"===filterName||"year"===filterName)&&(defaultPeriod=20),this.analyticsConfig.period=defaultPeriod}},immediate:!0}},mounted:function(){if(this.isSiteAnalysis&&(this.analyticsConfig.analyticsType=6),this.$route.query.filters){var filters=this.$route.query.filters,filtersJSON=JSON.parse(filters);this.analyticsConfig=filtersJSON}(this.reportId||this.alarmId||this.cardId)&&(this.$mobile?this.loadReport(this.mobileConfig):this.loadReport());var self=this;self.$http.get("/baseline/all").then((function(response){if(200===response.status){self.baseLineList=response.data?response.data:[],self.baseLineCasecaderOptions=[],self.baseLineCasecaderOptions.push({label:"None",value:-1});var _step,_iterator=(0,createForOfIteratorHelper/* default */.Z)(self.baseLineList);try{for(_iterator.s();!(_step=_iterator.n()).done;){var b=_step.value,children=null;"PREVIOUS_MONTH"===b.rangeTypeEnum||"ANY_MONTH"===b.rangeTypeEnum?children=[{label:"Same date",value:4},{label:"Same week",value:1}]:"PREVIOUS_YEAR"!==b.rangeTypeEnum&&"ANY_YEAR"!==b.rangeTypeEnum||(children=[{label:"Same date",value:3},{label:"Same week",value:1}]),"PREVIOUS"!==b.rangeTypeEnum&&self.baseLineCasecaderOptions.push({label:b.name,value:b.id,children:children})}}catch(err){_iterator.e(err)}finally{_iterator.f()}}})),self.loadZones()},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({assetCategory:function(state){return state.assetCategory}})),{},{siteList:function(){return[]},isTimeMode:function(){return 4===this.analyticsConfig.mode},cssLeft:function(){return"0px !important"},isOptimize:function(){return!!this.$route.query.newchart},isSiteAnalysis:function(){return this.$route.meta&&"site"===this.$route.meta.analyticsType},isSameDataPoint:function(){if(this.analyticsConfig&&this.analyticsConfig.dataPoints.length){var _step2,dp={},_iterator2=(0,createForOfIteratorHelper/* default */.Z)(this.analyticsConfig.dataPoints);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var d=_step2.value;dp[d.yAxis.fieldId]=!0}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}if(1===Object.keys(dp).length)return!0}return!1},availablePeriods:function(){var operationOnId=this.analyticsConfig.dateFilter.operationOnId,avail=[];return avail.push({name:this.$t("common._common.daily"),value:12,enable:!0}),avail.push({name:this.$t("common._common.weekly"),value:11,enable:6===operationOnId||(3===operationOnId||4===operationOnId)}),avail.push({name:this.$t("common._common.monthly"),value:10,enable:!0}),avail.push({name:this.$t("common.products.quarterly"),value:25,enable:4===operationOnId||5===operationOnId}),avail.push({name:this.$t("common._common.yearly"),value:8,enable:4===operationOnId}),avail}}),methods:{getBuildingList:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var _yield$API$get,data,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.next=2,api/* API */.bl.get("/v3/picklist/building");case 2:_yield$API$get=_context.sent,data=_yield$API$get.data,error=_yield$API$get.error,error||(_this2.buildingList=cloneDeep_default()(data.pickList),_this2.selectedCategory.allBuildings=cloneDeep_default()(data.pickList));case 6:case"end":return _context.stop()}}),_callee)})))()},onModeChange:function(){this.analyticsConfig.dataPoints=[],this.sizeDataPoint=this.colorDataPoint=null},isModuleField:function(dp){return!(!dp||!["building","site","asset"].includes(dp.moduleName))},loadReadings:function(categoryList,spaceList){var self=this;this.reportFilterForm.categoryFilter.length>0&&self.$http.post("/asset/getReadingsForSpecificAssetCategory",{buildingIds:spaceList,categoryIds:categoryList}).then((function(response){self.filterAssetsFromCategory(response.data)}))},loadAssetCategories:function(buildingList,siteList){var self=this;siteList?(self.loading=!0,self.$http.post("/asset/getAssetCategoryWithReadings",{buildingIds:siteList||self.reportFilterForm.siteFilter}).then((function(response){var categoryIds=response.data?Object.keys(response.data):[-1];self.selectedCategory.categoryList=self.assetCategory.filter((function(ele){for(var index=0;index<categoryIds.length;index++){var element=categoryIds[index];if(parseInt(element)===ele.id)return ele.toggle=!1,ele}})),self.loadReadings(categoryIds,siteList||self.reportFilterForm.siteFilter)}))):self.buildingList?(self.loading=!0,self.$http.post("/asset/getAssetCategoryWithReadings",{buildingIds:buildingList||self.selectedCategory.allBuildings.map((function(rt){return rt.id}))}).then((function(response){var categoryIds=response.data?Object.keys(response.data):[-1];self.selectedCategory.categoryList=self.assetCategory.filter((function(ele){for(var index=0;index<categoryIds.length;index++){var element=categoryIds[index];if(parseInt(element)===ele.id)return ele.toggle=!1,ele}})),self.loadReadings(categoryIds,buildingList||self.selectedCategory.allBuildings.map((function(rt){return rt.id})))}))):(self.loading=!0,self.$http.get("/asset/getAssetCategoryWithReadings").then((function(response){var categoryIds=response.data?Object.keys(response.data):[-1];self.selectedCategory.categoryList=self.assetCategory.filter((function(ele){for(var index=0;index<categoryIds.length;index++){var element=categoryIds[index];if(parseInt(element)===ele.id)return ele.toggle=!1,ele}})),self.loadReadings(categoryIds)})))},updateFilterdata:function(root){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var site_ids,filters,_yield$API$get2,error,data;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if("site"!==root){_context2.next=22;break}if(_this3.reportFilterForm.assetFilter=[],_this3.reportFilterForm.buildingFilter=[],!_this3.reportFilterForm.siteFilter||!_this3.reportFilterForm.siteFilter.length){_context2.next=17;break}return site_ids=[],_this3.reportFilterForm.siteFilter.filter((function(siteId){siteId&&site_ids.push(siteId.toString())})),_this3.buildingList=null,filters=JSON.stringify({siteId:{operatorId:36,value:site_ids}}),_context2.next=10,api/* API */.bl.get("/v3/picklist/building",{filters:filters});case 10:_yield$API$get2=_context2.sent,error=_yield$API$get2.error,data=_yield$API$get2.data,!error&&null!==data&&void 0!==data&&data.picklist&&(_this3.buildingList=data.picklist),
// this.buildingList =
//   this.selectedCategory.allBuildings &&
//   this.selectedCategory.allBuildings.length
//     ? this.selectedCategory.allBuildings.filter(f =>
//         this.reportFilterForm.siteFilter.includes(f.siteId)
//       )
//     : null
_this3.buildingList&&_this3.buildingList.length?_this3.loadAssetCategories(_this3.buildingList.map((function(rt){return rt.id}))):_this3.reportFilterForm.siteFilter&&_this3.reportFilterForm.siteFilter.length?_this3.loadAssetCategories(!1,_this3.reportFilterForm.siteFilter):_this3.loadAssetCategories(),_context2.next=20;break;case 17:_this3.selectedCategory.assetList=_this3.selectedCategory.allAsset,_this3.buildingList=_this3.selectedCategory.allBuildings,_this3.buildingList&&_this3.buildingList.length?_this3.loadAssetCategories(_this3.buildingList.map((function(rt){return rt.id}))):_this3.loadAssetCategories();case 20:_context2.next=23;break;case 22:"building"===root?(_this3.reportFilterForm.assetFilter=[],_this3.selectedCategory.assetList=null,_this3.reportFilterForm.buildingFilter&&_this3.reportFilterForm.buildingFilter.length?_this3.loadAssetCategories(_this3.reportFilterForm.buildingFilter):(_this3.selectedCategory.assetList=_this3.selectedCategory.allAsset,_this3.loadAssetCategories(_this3.buildingList.map((function(rt){return rt.id}))))):"category"===root&&_this3.loadReadings(_this3.reportFilterForm.categoryFilter);case 23:case"end":return _context2.stop()}}),_callee2)})))()},filterAssetsFromCategory:function(readings){var self=this;self.assetCategoryMap=readings.categoryWithAssets,this.selectedCategory.assetList=[];for(var i=0;i<this.reportFilterForm.categoryFilter.length;i++)self.assetCategoryMap[this.reportFilterForm.categoryFilter[i]]&&(this.selectedCategory.assetList=[].concat((0,toConsumableArray/* default */.Z)(this.selectedCategory.assetList),(0,toConsumableArray/* default */.Z)(Object.keys(this.assetCategoryMap[this.reportFilterForm.categoryFilter[i]]))));this.selectedCategory.allAsset=self.selectedCategory.assetList,self.assetsMap=readings.assets},prepareFilterData:function(){this.selectedCategory.categoryList||this.loadAssetCategories()},resetFilter:function(){this.reportFilterForm={siteFilter:[],buildingFilter:[],categoryFilter:[],assetFilter:[],liveFilterField:"none",liveFilterType:"single"},this.applyFilter(null)},applyFilter:function(){if(this.reportFilterForm.siteFilter.length||this.reportFilterForm.buildingFilter.length||this.reportFilterForm.categoryFilter.length||this.reportFilterForm.assetFilter.length||"none"!==this.reportFilterForm.liveFilterField||"single"!==this.reportFilterForm.liveFilterType)if(this.setfilter=1,this.reportFilterForm.siteFilter.length||this.reportFilterForm.buildingFilter.length||this.reportFilterForm.categoryFilter.length||this.reportFilterForm.assetFilter.length)if(this.reportFilterForm.assetFilter.length)this.analyticsConfig.filters={xCriteriaMode:3,parentId:this.reportFilterForm.assetFilter,filterState:this.$helpers.cloneObject(this.reportFilterForm)};else{var spaceFilter=this.reportFilterForm.buildingFilter.length?this.reportFilterForm.buildingFilter:this.reportFilterForm.siteFilter;this.analyticsConfig.filters={xCriteriaMode:4,assetCategory:this.reportFilterForm.categoryFilter,spaceId:spaceFilter,filterState:this.$helpers.cloneObject(this.reportFilterForm)}}else this.analyticsConfig.filters={xCriteriaMode:2,filterState:this.$helpers.cloneObject(this.reportFilterForm)};else this.setfilter=0,this.analyticsConfig.filters={xCriteriaMode:5,filterState:this.$helpers.cloneObject(this.reportFilterForm)};this.filtersPopover=!1},toggleSideBar:function(){this.hideSideBar?(this.hideSideBar=!1,this.chartDimensions.width=980,this.chartDimensions.height=600):(this.hideSideBar=!0,this.chartDimensions.width=1340,this.chartDimensions.height=600)},prepareDataPointSummary:function(){var _this4=this;if(this.resultObject){var _step3,summaryList=[],weatherModules={weather:"Live Weather",weatherDaily:"Daily Weather",psychrometric:"Psychrometric",cdd:"Degree Days",wdd:"Degree Days",hdd:"Degree Days"},_iterator3=(0,createForOfIteratorHelper/* default */.Z)(this.resultObject.report.dataPoints);try{var _loop=function(){var dataPoint=_step3.value;if(dataPoint.yAxis&&dataPoint.yAxis.module)if(Object.keys(weatherModules).includes(dataPoint.yAxis.module.name))_this4.addToGroup(dataPoint,weatherModules[dataPoint.yAxis.module.name],summaryList);else if(dataPoint.metaData.parentIds&&dataPoint.metaData.parentIds[0]===parseInt(_this4.selectedBuildings[0])&&"scheduled_formula"===dataPoint.yAxis.module.typeEnum.toLowerCase())_this4.addToGroup(dataPoint,"Enpi",summaryList);else{var self=_this4;self.$http.post("v2/resource/getResourcesDetails",{resourceId:dataPoint.metaData.parentIds}).then((function(response){response.data.result.resource&&"SPACE"===response.data.result.resource[0].resourceTypeEnum?_this4.addToGroup(dataPoint,"Space",summaryList):_this4.addToGroup(dataPoint,"Asset",summaryList)}))}};for(_iterator3.s();!(_step3=_iterator3.n()).done;)_loop()}catch(err){_iterator3.e(err)}finally{_iterator3.f()}return summaryList}},addToGroup:function(dataPoint,label,summaryList){var _this5=this,reading={};if(reading["readingId"]=dataPoint.yAxis.fieldId,reading["readingLabel"]="Asset"===label?"":dataPoint.name,reading["resourceId"]="Asset"===label?parseInt(dataPoint.metaData.parentIds[0]):"Space"===label||"Enpi"===label?parseInt(this.selectedBuildings[0]):this.$store.state.buildings.filter((function(building){return building.id===parseInt(_this5.selectedBuildings[0])}))[0].siteId,reading["resourceLabel"]=null,reading["marked"]=null,reading["location"]=this.selectedBuildingTitle,summaryList&&0===summaryList.length){var temp={};temp["label"]=label,temp["readings"]=[],temp.readings.push(reading),summaryList.push(temp)}else if(summaryList&&summaryList.length>0){var readingGroup=summaryList.filter((function(group){return group.label===label}));if(0!==readingGroup.length)readingGroup[0].readings.push(reading);else{var _temp={};_temp["label"]=label,_temp["readings"]=[],_temp.readings.push(reading),summaryList.push(_temp)}}},loadAlarmMeta:function(){var _this6=this;this.$http.post("/dashboard/getReportMetaForAlarms",{alarmId:this.$route.query.alarmId}).then((function(response){response.data&&response.data.reportMeta&&(_this6.analyticsConfig.dataPoints=response.data.reportMeta.dataPoints)}))},reportLoaded:function(report,result){this.reportObject=report,this.resultObject=result,report.options.common&&report.options.common.buildingIds&&(!report.options.common.buildingIds.length&&this.selectedBuildings?this.$route.query.filters||this.$route.query.alarmId||this.$route.query.cardId?(this.analyticsConfig.buildingId?this.reportObject.options.common.buildingIds.push(this.analyticsConfig.buildingId):this.$route.query.buildingId?this.reportObject.options.common.buildingIds.push(this.$route.query.buildingId):this.reportObject.options.common.buildingIds=this.selectedBuildings,this.resetDataPointSelector(this.reportObject.options.common.buildingIds)):this.reportObject.options.common.buildingIds=this.selectedBuildings:this.resetDataPointSelector(report.options.common.buildingIds))},loadZones:function(){var self=this;self.$http.get("/zone").then((function(response){response.data&&response.data.records&&(self.zones=response.data.records)}))},resetDataPointSelector:function(buildingIds){this.$refs["building-selector"].setInitialValues(this.analyticsConfig.dataPoints,buildingIds)},updateDataPoints:function(changedDataPoints){this.showSizeDataPointSelector?(this.sizeDataPoint=changedDataPoints[0],(null===this.colorDataPoint||this.colorDataPoint&&changedDataPoints[0].categoryId&&this.colorDataPoint.categoryId&&changedDataPoints[0].categoryId!==this.colorDataPoint.categoryId)&&(this.colorDataPoint=Object.assign({},changedDataPoints[0])),this.showSizeDataPointSelector=!1):this.showColorDataPointSelector&&(this.colorDataPoint=changedDataPoints[0],(null===this.sizeDataPoint||this.sizeDataPoint&&changedDataPoints[0].categoryId&&this.sizeDataPoint.categoryId&&changedDataPoints[0].categoryId!==this.sizeDataPoint.categoryId)&&(this.sizeDataPoint=Object.assign({},changedDataPoints[0])),this.showColorDataPointSelector=!1),this.analyticsConfig.dataPoints=[this.sizeDataPoint,this.colorDataPoint],this.addPredictionFields(this.analyticsConfig),this.showDataPointSelector=!1},showCustomizationDialog:function(){this.hideSideBar=!1,this.showgeneratedata=!1,this.showCustomization=!0},hideChartCustomizationDialog:function(){this.showCustomization=!1},showgeneratedataDialog:function(){this.hideSideBar=!1,this.showCustomization=!1,this.showgeneratedata=!0},setSelectedBuildings:function(_ref){var name=_ref.name,ids=_ref.ids;this.selectedBuildingTitle=name,this.selectedBuildings=ids,this.reportObject&&this.reportObject.options&&this.reportObject.options.common&&(this.reportObject.options.common.buildingIds=this.selectedBuildings)},onPeriodChange:function(){if(!this.analyticsConfig.dataPoints.length){var filter=22;20===this.analyticsConfig.period?filter=31:12===this.analyticsConfig.period?filter=28:10===this.analyticsConfig.period&&(filter=44),this.analyticsConfig.dateFilter=NewDateHelper/* default */.Z.getDatePickerObject(filter)}},onSettingsChange:function(changedOption){"alarm"===changedOption&&(this.reportObj.alarms&&this.reportObj.alarms.regions.length||!this.reportObj.options.settings.alarm||this.initChart())}}},newTools_Treemapvue_type_script_lang_js=Treemapvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(newTools_Treemapvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,Treemap=component.exports},
/***/937376:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FNewAnalyticsReportV1}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/energy/analytics/newTools/v1/FNewAnalyticsReportV1.vue?vue&type=template&id=1fa73ec3&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"analytics-section mT20 height100"},[_c("div",{staticClass:"new-analytics-filter-section"},[_vm.config.hidedatepicker?_vm._e():_c("new-date-picker",{ref:"newDatePicker",staticClass:"filter-field date-filter-comp inline",attrs:{zone:_vm.$timezone,dateObj:_vm.config.dateFilter,isDateFixed:_vm.config.applyReportDate},on:{date:_vm.setDateFilter}}),this.reportObj&&this.reportObj.options&&!0===this.reportObj.options.settings.timeperiod&&[1,4].includes(_vm.config.mode)?_c("div",{staticClass:"chart-icon pointer flRight pB8 el-popover__reference",staticStyle:{"margin-right":"120px"}},[_c("el-select",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"period-select width20 fc-input-full-border2 ",attrs:{placeholder:"Period",title:"Time period","data-arrow":"true"},on:{change:_vm.onPeriodChange},model:{value:_vm.config.period,callback:function($$v){_vm.$set(_vm.config,"period",$$v)},expression:"config.period"}},_vm._l(_vm.getAvailablePeriods,(function(period,index){return _c("el-option",{key:index,attrs:{label:period.name,value:period.value,disabled:!period.enable}})})),1)],1):_vm._e(),_vm.showTemplateFilter&&_vm.resultObj&&_vm.resultObj.report&&_vm.resultObj.report.currentTemplate&&_vm.resultObj.report.currentTemplate.show?_c("div",[_c("el-select",{staticClass:"fc-input-full-border-h35 fc-report-label-position",attrs:{filterable:""},on:{change:_vm.changeParentForTemplate},model:{value:_vm.resultObj.report.currentTemplate.parentId,callback:function($$v){_vm.$set(_vm.resultObj.report.currentTemplate,"parentId",$$v)},expression:"resultObj.report.currentTemplate.parentId"}},_vm._l(_vm.resultObj.report.currentTemplate.chooseValues,(function(asset,assetIdx){return _c("el-option",{key:assetIdx,attrs:{value:asset.id,label:asset.name}})})),1)],1):_vm._e(),!_vm.config.hidechartoptions&&_vm.reportObj&&!0===!_vm.isRegression?_c("f-chart-settings",{attrs:{dataPoints:_vm.reportObj.options.dataPoints,settings:_vm.reportObj.options.settings,showChart:!1,showTable:!1,showChartMode:_vm.showChartMode,showTimePeriod:_vm.showTimePeriod,showAlarm:!(!_vm.reportObj.options||!_vm.reportObj.options.common||1!==_vm.reportObj.options.common.type),showSafelimit:!(!_vm.reportObj.options||!_vm.reportObj.options.common||1!==_vm.reportObj.options.common.type||"undefined"!==typeof _vm.resultObj.regression),disableChartMode:_vm.reportObj.booleanData},on:{onSettingsChange:_vm.onSettingsChange}},[_vm._v(_vm._s(_vm.showTimePeriod))]):_vm._e(),_vm.resultObj&&_vm.resultObj.report&&0!==_vm.resultObj.report.dataPoints.length&&!_vm.isRegression?_c("span"):_vm._e()],1),!_vm.$mobile&&_vm.predictive&&_vm.config.predictionTimings&&_vm.config.predictionTimings.length?_c("prediction-timings-bar",{staticClass:" prediction-timing-bar",attrs:{reportObj:_vm.reportObj,config:_vm.config}}):_vm._e(),_vm.loading?_c("spinner",{staticClass:"analytics-spinner",attrs:{show:_vm.loading,size:"80"}}):_vm.failed?_c("div",{staticStyle:{"margin-top":"30px",opacity:"0.7","font-size":"13px",padding:"50px","line-height":"25px","text-align":"center"}},[_c("div",[_vm._v(_vm._s(_vm.$t("home.dashboard.data_loading_failed")))])]):_vm.reportObj.data?_c("div",{staticClass:"height100"},[_vm.config.hidechart?_vm._e():_c("div",{staticClass:"height100"},[_vm.$route.meta&&_vm.$route.meta.layout&&"mobile"===_vm.$route.meta.layout&&_vm.reportObj&&"multi"===_vm.reportObj.options.settings.chartMode?_c("f-mobile-multi-chart",{ref:"multiChart",attrs:{isWidget:!!_vm.config,width:_vm.config&&_vm.config.width?_vm.config.width:null,resultObj:_vm.resultObj,height:_vm.config&&_vm.config.height?_vm.config.height:null,data:_vm.reportObj.data,options:_vm.reportObj.options,alarms:_vm.reportObj.alarms,dateRange:_vm.reportObj.dateRange,hidecharttypechanger:_vm.config&&_vm.config.widget,booleanData:_vm.reportObj.booleanData}}):_vm._e(),_vm.$route.meta&&_vm.$route.meta.layout&&"mobile"===_vm.$route.meta.layout&&_vm.reportObj&&"multi"===_vm.reportObj.options.settings.chartMode?_c("div",{staticClass:"empty-multi-chart"},[_vm._v(" Currently this chart not supported in the mobile ")]):_vm.reportObj&&"multi"===_vm.reportObj.options.settings.chartMode?_c("f-multi-chart",{ref:"multiChart",attrs:{data:_vm.reportObj.data,options:_vm.reportObj.options,alarms:_vm.reportObj.alarms,booleanData:_vm.reportObj.booleanData,dateRange:_vm.reportObj.dateRange,resultObj:_vm.resultObj,hidecharttypechanger:_vm.config.hidecharttypechanger||_vm.isRegression}}):_c("div",{staticClass:"height100"},[_vm.$route.meta&&_vm.$route.meta.layout&&"mobile"===_vm.$route.meta.layout&&!_vm.isHeatMap?_c("f-mobile-chart",{ref:"newChart",staticClass:"mobile-chart",attrs:{data:_vm.reportObj.data,options:_vm.reportObj.options,dateRange:_vm.reportObj.dateRange,resultObj:_vm.resultObj}}):_vm.isHeatMap?_vm._e():_c("f-new-chart",{ref:"newChart",attrs:{data:_vm.reportObj.data,options:_vm.reportObj.options,alarms:_vm.reportObj.alarms,dateRange:_vm.reportObj.dateRange,resultObj:_vm.resultObj,hidecharttypechanger:_vm.config.hidecharttypechanger||_vm.isRegression,fixedChartHeight:_vm.config.fixedChartHeight,config:_vm.config,showWidgetLegends:!_vm.config||_vm.config.showWidgetLegends,chartTypeTarget:_vm.chartTypeTarget}},[_c("template",{slot:"relatedAlarmBar"},[_vm._t("relatedAlarmBarLayout")],2)],2),_vm.isHeatMap?_c("FNewHeatMap",{attrs:{config:_vm.config,resultObject:_vm.resultObj,reportObject:_vm.reportObj}}):_vm._e()],1)],1),_vm.config.hidetabular?_vm._e():_c("f-tabular-report",{ref:"newTable",staticClass:"new-analytics-table mL30 mR30",class:{"regression-table-fit":_vm.isRegression},attrs:{reportObject:_vm.resultObj,reportConfig:_vm.reportObj}})],1):_c("div",{staticStyle:{"margin-top":"30px","font-size":"13px",padding:"50px","line-height":"25px","text-align":"center"}},[_c("inline-svg",{attrs:{src:"svgs/emptystate/reportlist",iconClass:"icon text-center icon-100"}}),_c("div",{staticClass:"nowo-label f13"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.empty_data"))+" "),_vm.resultObj&&_vm.resultObj.dateRange?_c("span",{staticClass:"bold"},[_vm._v(_vm._s(_vm._f("formatPeriod")(_vm.resultObj.dateRange.value,"MMM DD, YYYY")))]):_vm._e()])],1),_vm.resultObj?_c("RangeChartDialog",{attrs:{visibility:_vm.showRangeChartDialog,dataPoints:_vm.resultObj.report.dataPoints},on:{"update:visibility":function($event){_vm.showRangeChartDialog=$event},rangePoints:_vm.addRangePoints}}):_vm._e()],1)},staticRenderFns=[],createForOfIteratorHelper=__webpack_require__(566347),NewDatePicker=(__webpack_require__(670560),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(538077),__webpack_require__(947522),__webpack_require__(434284),__webpack_require__(648324),__webpack_require__(169358),__webpack_require__(900773)),FNewchartV1vue_type_template_id_4ddd8122_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"height100 f-singlechart mL20 mR20"},[_vm.chartTypeTarget&&!_vm.hidecharttypechanger?_c("portal",{attrs:{to:_vm.chartTypeTarget,slim:""}},[_c("f-chart-type",{attrs:{options:_vm.options}})],1):_vm.hidecharttypechanger?_vm._e():_c("f-chart-type",{staticClass:"charttypechanger fc-new--chart-type-single",attrs:{options:_vm.options}}),_vm.chartContext&&!1!==_vm.options.settings.chart?_c("div",{staticStyle:{"text-align":"center"}},[_vm.chartContext.options.legend.show&&"top"===_vm.chartContext.options.legend.position?_c("f-chart-legends",{ref:"chartLegend",attrs:{chart:_vm.c3.chart,options:_vm.options,xValueMode:_vm.chartContext.xValueMode,xLabelMap:_vm.chartContext.xLabelMap,config:_vm.config}}):_vm._e(),_vm._t("relatedAlarmBar"),_vm.chartContext.options.regionConfig?_c("f-chart-title",{ref:"chartTitle",attrs:{chart:_vm.c3.chart,options:_vm.options,xValueMode:_vm.chartContext.xValueMode,xLabelMap:_vm.chartContext.xLabelMap,config:_vm.config,chartContext:_vm.chartContext}}):_vm._e(),_c("div",{style:_vm.isWidget?"position: relative; top: 15px;":""},[_vm.showAlarms&&_vm.showAlarmTitle?_c("div",{staticClass:"fc-alarms-chart-title"},[_vm._v(" Alarms ")]):_vm._e(),_c("div",{ref:"alarmsChartEle",staticClass:"fc-alarms-chart pdf-chart"})]),_c("div",{staticClass:"fc-newchart-container"},[_c("div",{ref:"newChartEle",staticClass:"fc-new-chart pdf-chart",class:{"hide-y2-axis":_vm.options&&_vm.options.axis&&!1===_vm.options.axis.showy2axis}}),_vm.chartContext.options.legend.show&&"right"===_vm.chartContext.options.legend.position?_c("f-chart-legends",{style:{width:_vm.chartContext.options.legend.width+"px"},attrs:{chart:_vm.c3.chart,options:_vm.options,xValueMode:_vm.chartContext.xValueMode,xLabelMap:_vm.chartContext.xLabelMap,config:_vm.config}}):_vm._e()],1),_vm.chartContext.options.legend.show&&"bottom"===_vm.chartContext.options.legend.position?_c("f-chart-legends",{ref:"chartLegend",attrs:{chart:_vm.c3.chart,options:_vm.options,xValueMode:_vm.chartContext.xValueMode,xLabelMap:_vm.chartContext.xLabelMap}}):_vm._e(),_vm.showWidget?_c("f-widget-legends",{ref:"newWidget",staticClass:"widget-legends",attrs:{chart:_vm.c3.chart,reportVarianceData:_vm.resultObj?_vm.resultObj.reportData.aggr:null,data:_vm.data,options:_vm.options}}):_vm._e()],2):_vm._e()],1)},FNewchartV1vue_type_template_id_4ddd8122_staticRenderFns=[],billboard=(__webpack_require__(212826),__webpack_require__(872695)),basechart=__webpack_require__(503162),c3_helper=__webpack_require__(167021),FChartLegends=__webpack_require__(906575),FChartTitle=__webpack_require__(23369),FWidgetLegends=__webpack_require__(547301),FNewChartType=__webpack_require__(270352),JumpToHelper=__webpack_require__(921466),tooltip=__webpack_require__(460895),color_helper=__webpack_require__(794211),deepmerge=__webpack_require__(708634),FNewchartV1vue_type_script_lang_js={mixins:[basechart/* default */.Z,JumpToHelper/* default */.Z],props:["resultObj","isWidget","showWidgetLegends","config","chartTypeTarget"],components:{FChartLegends:FChartLegends/* default */.Z,FWidgetLegends:FWidgetLegends/* default */.Z,FChartType:FNewChartType/* default */.Z,FChartTitle:FChartTitle/* default */.Z},computed:{showWidget:function(){return"undefined"===typeof this.showWidgetLegends||!!this.config.hasOwnProperty("showWidgetLegends")&&this.config.showWidgetLegends},isRegression:function(){return!!(this.$route.path.includes("regression")||this.resultObj&&this.resultObj.regressionConfig&&0!==this.resultObj.regressionConfig.length&&!0===this.resultObj.regression)},showAlarmTitle:function(){return!this.chartContext||!this.chartContext.options||!this.chartContext.options.hideAlarmTitle}},data:function(){return{chartContext:null,chartId:Math.random().toString(36).substr(2,9),c3:{params:null,chart:null},showAlarms:!1,updateTimeout:null}},mounted:function(){this.config.hidecharttypechanger&&(this.hidecharttypechanger=!0),this.isRegression&&(this.hidecharttypechanger=!0),this.render()},beforeDestroy:function(){tooltip/* default */.Z.hideTooltip(),this.c3&&this.c3.chart&&this.c3.chart.destroy(),this.chartContext=null,this.c3.params=null,this.c3.chart=null},methods:{render:function(){var _this=this;this.data&&(this.chartContext=null,this.$nextTick((function(){_this.chartContext={},_this.chartContext.options=_this.getOptions(),_this.chartContext.dateRange=_this.dateRange,_this.chartContext.data=_this.data,_this.chartContext.xValueMode=_this.isXValueMode(_this.chartContext.options,_this.data),_this.chartContext.unitMap=_this.getUnitMap(_this.options.dataPoints),_this.chartContext.enumMap=_this.getEnumMap(_this.options.dataPoints),_this.chartContext.openAlarm=function(alarmList){if(alarmList){var _step,alarmId=[],_iterator=(0,createForOfIteratorHelper/* default */.Z)(alarmList);try{for(_iterator.s();!(_step=_iterator.n()).done;){var a=_step.value;alarmId.push(a.id)}}catch(err){_iterator.e(err)}finally{_iterator.f()}_this.jumpToAlarms(alarmId)}},"pie"!==_this.chartContext.options.type&&"donut"!==_this.chartContext.options.type||(_this.chartContext.options.padding.top=20);var c3Params=c3_helper/* default */.Z.prepare(_this.chartContext);c3Params&&(c3Params.data.onclick=function(d){_this.$emit("drilldown",d)}),_this.mergeOption&&(_this.chartContext.options.padding.left=_this.mergeOption.padding.left,_this.chartContext.options.padding.right=_this.mergeOption.padding.right,_this.chartContext.options.axis.x.label.text="Month",c3Params.axis.y.label.text="No of Work Request"),_this.isWidget&&(_this.chartContext.options.legend.show?c3Params.size.height=c3Params.size.height-50:c3Params.size.height=c3Params.size.height-20,_this.options.widgetLegend.show&&(c3Params.size.height=c3Params.size.height-75),_this.resultObj&&_this.resultObj.report.userFilters&&(c3Params.size.height=c3Params.size.height-65));var self=_this;self.showAlarms=1===_this.getOptions().common.mode&&_this.getOptions().settings.alarm,_this.config&&_this.config.hasOwnProperty("showAlarms")&&(self.showAlarms=_this.config.showAlarms),self.showAlarms&&(_this.chartContext.alarms=_this.alarms,c3Params.size.height=c3Params.size.height-100);var alarmsParams=null;if(self.showAlarms&&(alarmsParams=c3_helper/* default */.Z.prepareBooleanChart(_this.chartContext,c3Params.data.json.x,_this.alarms),self.$refs["alarmsChartEle"]&&(alarmsParams.bindto=self.$refs["alarmsChartEle"],billboard.bb.generate(alarmsParams))),_this.chartContext.options.customizeC3){var defaultOptions={},mergedOptions=deepmerge/* default */.Z.objectAssignDeep(defaultOptions,c3Params,_this.chartContext.options.customizeC3);c3Params=mergedOptions}self.$refs["newChartEle"]?(c3Params.bindto=self.$refs["newChartEle"],self.isWidget&&self.$refs["chartLegend"]&&(c3Params.size.height=c3Params.size.height-(self.$refs["chartLegend"].$el.clientHeight-20)),self.fixedChartHeight&&(c3Params.size.height=self.fixedChartHeight),self.c3.params=c3Params,self.c3.chart=billboard.bb.generate(c3Params)):_this.$nextTick((function(){self.showAlarms&&self.$refs["alarmsChartEle"]&&(alarmsParams.bindto=self.$refs["alarmsChartEle"],billboard.bb.generate(alarmsParams)),c3Params.bindto=self.$refs["newChartEle"],self.isWidget&&self.$refs["chartLegend"]&&(c3Params.size.height=c3Params.size.height-(self.$refs["chartLegend"].$el.clientHeight-20)),self.fixedChartHeight&&(c3Params.size.height=self.fixedChartHeight),self.c3.params=c3Params,self.c3.chart=billboard.bb.generate(c3Params)}))})))},isXValueMode:function(options,data){if("pie"===options.type||"donut"===options.type){if(options.xColorMap)return!0;if(data&&data.x&&2===Object.keys(data).length&&data.x.length<=15){for(var colors=color_helper/* default */.Z.newColorPicker(data.x.length),xColorMap={},i=0;i<data.x.length;i++){var xVal=data.x[i];xColorMap[xVal]=options.xColorMap&&options.xColorMap[xVal]?options.xColorMap[xVal]:colors[i]}return options.xColorMap=xColorMap,!0}}return!1},reRender:function(){var _this2=this;this.updateTimeout&&clearTimeout(this.updateTimeout),this.updateTimeout=setTimeout((function(){return _this2.render()}),500)},resize:function(){this.reRender(),this.$refs["newWidget"]&&this.$refs["newWidget"].resize()},update:function(){this.reRender()}}},components_FNewchartV1vue_type_script_lang_js=FNewchartV1vue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FNewchartV1vue_type_script_lang_js,FNewchartV1vue_type_template_id_4ddd8122_render,FNewchartV1vue_type_template_id_4ddd8122_staticRenderFns,!1,null,null,null)
/* harmony default export */,FNewchartV1=component.exports,FMobileChart=__webpack_require__(242208),FMultiChart=__webpack_require__(649206),NewDataFormatHelper=__webpack_require__(804911),AnalyticsMixin=__webpack_require__(244936),FTabularReportNew=__webpack_require__(979),FNewChartSettings=__webpack_require__(83322),FMobileMultiChart=__webpack_require__(696593),PredictionTimingsBar=__webpack_require__(107387),NewDateHelper=__webpack_require__(105534),RangeChartDialog=__webpack_require__(515326),NewReportSummaryHelper=__webpack_require__(601458),FNewHeatMap=__webpack_require__(283938),FNewAnalyticsReportV1vue_type_script_lang_js={props:["config","baseLines","readings","showChartMode","showTimePeriod","chartTypeTarget"],mixins:[NewDataFormatHelper/* default */.Z,AnalyticsMixin/* default */.Z,NewDateHelper/* default */.Z,NewReportSummaryHelper/* default */.Z],components:{NewDatePicker:NewDatePicker/* default */.Z,FNewChart:FNewchartV1,FMultiChart:FMultiChart/* default */.Z,FTabularReport:FTabularReportNew/* default */.Z,FMobileChart:FMobileChart/* default */.Z,FChartSettings:FNewChartSettings/* default */.Z,FMobileMultiChart:FMobileMultiChart/* default */.Z,PredictionTimingsBar:PredictionTimingsBar/* default */.Z,RangeChartDialog:RangeChartDialog/* default */.Z,FNewHeatMap:FNewHeatMap/* default */.Z},data:function(){return{loading:!0,predictive:!0,failed:!1,reportObj:null,resultObj:null,showRangeChartDialog:!1,showTemplateFilter:!1}},mounted:function(){this.init()},created:function(){this.$store.dispatch("loadAssetCategory")},computed:{isHeatMap:function(){return!(!this.$route||!this.$route.meta||"heatmap"!==this.$route.meta.analyticsType)},getAvailablePeriods:function(){var operationOnId=this.config.dateFilter.operationOnId,avail=[];
// avail.push({
//   name:'Week of year', // W1, W2
//   value: 16,
//   enable: true
// })
// avail.push({
//   name:'Month of year', // Jan, Feb , march
//   value: 15,
//   enable: true
// })
return avail.push({name:"High-res",value:0,enable:6===operationOnId||4!==operationOnId}),avail.push({name:"Hourly",value:20,enable:6===operationOnId||4!==operationOnId}),avail.push({name:"Daily",value:12,enable:!0}),avail.push({name:"Weekly",value:11,enable:!0}),avail.push({name:"Monthly",value:10,enable:!0}),avail.push({name:"Quarterly",value:25,enable:4===operationOnId||5===operationOnId}),avail.push({name:"Yearly",value:8,enable:4===operationOnId}),avail.push({name:"Hour of day",
// 12, 1, 2, 3
value:19,enable:!0}),avail.push({name:"Day of week",
// sun, mon
value:17,enable:!0}),avail.push({name:"Day of month",
// 1,2,3
value:18,enable:!0}),avail},isRegression:function(){return!!this.$route.path.includes("regression")}},watch:{config:{handler:function(newData,oldData){this.config.applyReportDate&&this.config.period||this.init(!1)},deep:!0},getAvailablePeriods:{handler:function(newData,oldData){var _this=this,avail=this.getAvailablePeriods,selected=avail.find((function(a){return a.value===_this.config.period&&a.enable}));if(!selected){var filterName=this.config.dateFilter.operationOn,defaultPeriod=avail.filter((function(a){return a.enable}))[0].value;"week"===filterName||"month"===filterName?defaultPeriod=12:"year"===filterName&&(defaultPeriod=10),this.config.period=defaultPeriod}},immediate:!0}},methods:{changeParentForTemplate:function(){this.config.template&&(this.config.template.parentId=this.resultObj.report.currentTemplate.parentId)},onPeriodChange:function(){if(!this.config.dataPoints.length){var filter="D";20===this.config.period?filter="W":12===this.config.period?filter="M":10===this.config.period&&(filter="Y"),this.config.dateFilter=this.getDefaultDateFilter(filter)}},addRangePoints:function(val,remainingDataPoints){var _step,ranges=["min","max","avg"],dataPoints=[],_iterator=(0,createForOfIteratorHelper/* default */.Z)(val);try{for(_iterator.s();!(_step=_iterator.n()).done;){var rangeConfig=_step.value;for(var key in rangeConfig){var config={};ranges.includes(key)&&(config["parentId"]=rangeConfig[key].parentId,config["prediction"]=!1,config["aliases"]={actual:rangeConfig[key].alias},config["yAxis"]={aggr:rangeConfig[key].aggr,fieldId:rangeConfig[key].fieldId},dataPoints.push(config))}}}catch(err){_iterator.e(err)}finally{_iterator.f()}var _step2,_iterator2=(0,createForOfIteratorHelper/* default */.Z)(remainingDataPoints);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var dataPoint=_step2.value,_config={};_config["parentId"]=dataPoint.metaData.parentIds[0],_config["prediction"]=!1,_config["aliases"]={actual:dataPoint.aliases.actual},_config["yAxis"]={aggr:dataPoint.yAxis.aggr,fieldId:dataPoint.yAxis.fieldId},dataPoints.push(_config)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}var analyticConfig=this.$helpers.cloneObject(this.config);analyticConfig.dataPoints=dataPoints,analyticConfig.period="undefined"!==typeof this.config.period&&null!==this.config.period?0===this.config.period?this.getXAggr():this.config.period:0,this.$emit("update:config",analyticConfig)},setDateFilter:function(dateFilter){this.$set(this.config,"dateFilter",dateFilter);
// this.$emit('update:config', this.config)
},init:function(){this.initChart()},resize:function(){this.$refs["newChart"]&&this.$refs["newChart"].resize(),this.$refs["multiChart"]&&this.$refs["multiChart"].resize(),this.$refs["newTable"]&&this.$refs["newTable"].resize()},getReportParams:function(){var baselines,baselineNames,_this2=this;if(this.config.baseLine&&Array.isArray(this.config.baseLine)&&this.config.baseLine.length){if(this.config.baseLine[0]>0){var bl={};bl.baseLineId=this.config.baseLine[0],this.config.baseLine.length>1&&(bl.adjustType=this.config.baseLine[1]);var blList=[];blList.push(bl),baselines=blList}}else this.config.baseLine&&this.config.baseLine>0&&(baselines=[{baseLineId:this.config.baseLine}]);baselines&&this.baseLines&&(baselineNames=[],baselines.forEach((function(baseline){var baseLineName=_this2.baseLines.find((function(bl){return bl.id===baseline.baseLineId})).name;baselineNames.push(baseLineName)})));var fields=[];if(3===this.config.mode){var _step3,parentId=[],fieldId=null,yAggr=3,_iterator3=(0,createForOfIteratorHelper/* default */.Z)(this.config.dataPoints);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var dp=_step3.value;parentId.push(dp.parentId),fieldId=dp.yAxis.fieldId,yAggr=dp.yAxis.aggr}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}fields.push({parentId:parentId,yAxis:{fieldId:fieldId,aggr:0!==this.config.period&&0===yAggr?3:yAggr},type:1,aliases:{actual:"A"}}),this.setAlias(fields,baselineNames)}else{this.setAlias(this.config.dataPoints,baselineNames);var _step4,_iterator4=(0,createForOfIteratorHelper/* default */.Z)(this.config.dataPoints);try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var _dp=_step4.value,metaData={};_dp.categoryId&&(metaData.categoryId=_dp.categoryId),this.config.template?fields.push({parentId:_dp.parentId?Array.isArray(_dp.parentId)?_dp.parentId:[_dp.parentId]:null,buildingId:_dp.buildingId?_dp.buildingId:-1,metaData:metaData,yAxis:{fieldId:_dp.yAxis.fieldId,aggr:_dp.yAxis.aggr},aliases:_dp.aliases,type:_dp.type>0?_dp.type:1,predictedTime:_dp.predictedTime,rule_aggr_type:null===_dp||void 0===_dp?void 0:_dp.rule_aggr_type}):fields.push({parentId:_dp.parentId?Array.isArray(_dp.parentId)?_dp.parentId:[_dp.parentId]:null,name:_dp.name,buildingId:_dp.buildingId?_dp.buildingId:-1,metaData:metaData,yAxis:_dp.yAxis,aliases:_dp.aliases,type:_dp.type>0?_dp.type:1,predictedTime:_dp.predictedTime,moduleName:_dp.reportModuleName})}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}}if(this.config.sorting&&(6===this.config.mode||7===this.config.mode||8===this.config.mode)&&(this.config.sorting.orderByFunc||this.config.sorting.limit)){var sortByField=this.config.sorting.sortByField;if(sortByField){var _field=fields.find((function(f){return f.yAxis.fieldId===sortByField}));_field||(sortByField=null)}sortByField||(sortByField=fields[0].yAxis.fieldId,this.config.sorting.sortByField=fields[0].yAxis.fieldId);var field=null;sortByField?field=fields.find((function(f){return f.yAxis.fieldId===sortByField})):this.config.dataPoints.length<=1&&(field=fields[0]),field&&(field.defaultSortPoint=!0,this.config.sorting.orderByFunc&&(field.orderByFunc=this.config.sorting.orderByFunc),this.config.sorting.limit&&(field.limit=this.config.sorting.limit))}this.config.template&&null!==this.config.template.parentId&&fields.forEach((function(d){d.parentId=[_this2.config.template.parentId]}));var params={mode:this.config.mode,startTime:this.config.dateFilter.value[0],endTime:this.config.dateFilter.value[1],xAggr:1===this.config.mode||3===this.config.mode||4===this.config.mode||5===this.config.mode?this.config.period:0,fields:JSON.stringify(fields),transformWorkflow:this.config.transformWorkflow};if(this.reportObj&&this.reportObj.options&&this.reportObj.options.settings?(params.showAlarms=this.reportObj.options.settings.alarm,params.showSafeLimit=this.reportObj.options.settings.safelimit):this.config.savedReport?(params.showAlarms=this.config.savedReport.showAlarms,params.showSafeLimit=this.config.savedReport.showSafeLimit):params.showSafeLimit=!0,window.fetchMarkedAlso&&(params.shouldIncludeMarked=!0),baselines&&(params.baseLines=JSON.stringify(baselines)),this.config.filters&&this.config.filters.xCriteriaMode)if(params.xCriteriaMode=this.config.filters.xCriteriaMode,this.config.filters.parentId&&this.config.filters.parentId.length)params.parentId=this.config.filters.parentId;else{var categoryId=this.config.filters.assetCategory;if(!categoryId||!categoryId.length){categoryId=[];var _step5,_iterator5=(0,createForOfIteratorHelper/* default */.Z)(this.config.dataPoints);try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var _dp2=_step5.value;-1===categoryId.indexOf(_dp2.categoryId)&&categoryId.push(_dp2.categoryId)}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}}categoryId.length&&(params.assetCategory=categoryId),this.config.filters.spaceId&&this.config.filters.spaceId.length&&(params.spaceId=this.config.filters.spaceId)}return this.$route.query&&this.$route.query.alarmId&&(params.alarmId=parseInt(this.$route.query.alarmId),params.showAlarms=!0),params},initChart:function(){var self=this;self.loading=!0,self.failed=!1;var apiURL=this.config.api?this.config.api:"/v2/report/readingReport",params=null;this.config.alarmId&&(apiURL="/v2/report/fetchReadingsFromAlarm",params={alarmId:this.config.alarmId,mode:1,xAggr:this.config.period||0,startTime:this.config.dateFilter.value[0],endTime:this.config.dateFilter.value[1],showAlarms:!0}),this.config.readingRuleId&&(params.readingRuleId=this.config.readingRuleId),this.config.isWithPrerequsite&&(params.isWithPrerequsite=this.config.isWithPrerequsite),params||(params=self.getReportParams()),this.config.template&&this.config.template.show&&(apiURL=apiURL+"?templateString="+encodeURIComponent(JSON.stringify(this.config.template))),this.config.analyticsType&&(params.analyticsType=this.config.analyticsType),params.newFormat=!0,self.$http.post(apiURL,params).then((function(response){var result=response.data.result;if(result.xAggr=params.xAggr,result.mode=params.mode,self.config.analyticsType&&(result.report.analyticsType=self.config.analyticsType),self.config.filters&&(result.filters=self.config.filters),self.config.sorting&&(result.sorting=self.config.sorting),self.config.applyReportDate?(self.config.dateFilter=result.dateRange=NewDateHelper/* default */.Z.getDatePickerObject(self.config.dateFilter.operatorId,result.report.dateValue),self.$nextTick((function(){self.$refs.newDatePicker.loadFromObject()}))):result.dateRange=self.config.dateFilter,self.reportObj&&!self.config.alarmId?(result.report.chartState=self.reportObj.options,result.report.tabularState=self.reportObj.params.tabularState):self.config.savedReport&&(result.report.chartState=self.config.savedReport.chartState,result.report.tabularState=self.config.savedReport.tabularState),self.reportObj=self.prepareReport(result),self.config.customizeC3&&self.reportObj.options&&(self.reportObj.options["customizeC3"]=self.config.customizeC3),self.config.customizeChartOptions&&self.reportObj.options&&(self.reportObj.options=deepmerge/* default */.Z.objectAssignDeep(self.reportObj.options,self.config.customizeChartOptions)),self.config.template){var currentTemplate=JSON.parse(JSON.stringify(self.config.template)),filters=self.getFiltersFromCriteria(currentTemplate);self.loadReportTemplateValues(currentTemplate,filters).then((function(){currentTemplate.parentId=null===currentTemplate.parentId?currentTemplate.defaultValue:currentTemplate.parentId,self.$set(self.resultObj.report,"currentTemplate",currentTemplate),self.showTemplateFilter=!0}))}(self.config.isFromAlarmSummary||self.$route.query&&self.$route.query.isFromAlarmSummary&&!self.resultObj)&&self.reportObj.booleanData&&(self.reportObj.options.dataPoints=self.groupNonBooleanPoints(self.reportObj.options.dataPoints)),(self.$route.query&&self.$route.query.alarmId||self.config.alarmId)&&(self.reportObj.options.settings.alarm=!0),self.config.alarmId&&"undefined"!=typeof self.config.showAlarmBar&&(self.reportObj.options.settings.alarm=self.config.showAlarmBar),self.resultObj=result,self.reportObj.params=params,self.reportObj.tableConfig=self.config.tableConfig,self.reportObj.alarms=self.prepareBooleanReport(result.reportData.aggr),self.config.alarmId&&(self.reportObj.alarms.barSize="medium"),self.config.regionConfig&&(self.reportObj.options.regionConfig=self.config.regionConfig),self.config.hideDataPoints&&(self.reportObj.options.hideDataPoints=self.config.hideDataPoints),self.config.hasOwnProperty("disbaleNiceTickMarks")&&(self.reportObj.options.disbaleNiceTickMarks=self.config.disbaleNiceTickMarks),self.config.chartType&&(self.reportObj.options.chartType=self.config.chartType),self.config.diffChartConfig&&(self.reportObj.options.diffChartConfig=self.config.diffChartConfig),self.config.hideLegends&&self.reportObj.options.legend&&(self.reportObj.options.legend.show=!1),self.config.paddingOptions&&(self.reportObj.options.padding=self.config.paddingOptions),self.config.intersections&&(self.reportObj.options.intersections=self.config.intersections),self.config.point&&(self.config.pointShowRule?self.reportObj.options.point=self.pointShowRule(self.reportObj.dateRange,self.config.pointShowRule):self.reportObj.options.point=self.config.point),self.config.zoom&&(self.reportObj.options.zoom=self.config.zoom),self.config.size&&(self.config.size.width||self.config.size.height)&&(self.reportObj.options.size=self.config.size),self.config.axes&&(self.reportObj.options.axes=self.config.axes),self.reportObj.options.xFormat="MM-DD-YYYY",self.config.xFormat&&(self.reportObj.options.xFormat=self.config.xFormat),self.config.colors&&self.reportObj.options.dataPoints&&self.reportObj.options.dataPoints.length&&self.reportObj.options.dataPoints.forEach((function(rt){rt.color=self.config.colors[rt.key]})),self.config.axis&&(self.reportObj.options.fixedAxis=self.config.axis),self.reportObj.options.predictionTimings=self.config.predictionTimings,self.$emit("reportLoaded",self.reportObj,self.resultObj),self.loading=!1})).catch((function(error){error&&(self.loading=!1,self.failed=!0)}))},onSettingsChange:function(changedOption){"alarm"===changedOption?this.reportObj.alarms&&this.reportObj.alarms.regions.length||!this.reportObj.options.settings.alarm||this.init():"safelimit"===changedOption&&!this.reportObj.options.safeLimit.length&&this.reportObj.options.settings.safelimit&&this.init()}}},v1_FNewAnalyticsReportV1vue_type_script_lang_js=FNewAnalyticsReportV1vue_type_script_lang_js,FNewAnalyticsReportV1_component=(0,componentNormalizer/* default */.Z)(v1_FNewAnalyticsReportV1vue_type_script_lang_js,render,staticRenderFns,!1,null,"1fa73ec3",null)
/* harmony default export */,FNewAnalyticsReportV1=FNewAnalyticsReportV1_component.exports},
/***/196510:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"2da26706fa3b7cf6cb36528c88c86d0d.svg";
/***/},
/***/552184:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"c993f6dafb3c0b9ebe399cdf6c4b3a02.svg";
/***/},
/***/587758:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"5ee9b0f49c6e73cc51f35d51be8bad36.svg";
/***/},
/***/667527:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"00e2f8b54392f5c9d15bf4a60fcf5285.svg";
/***/}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/97432.js.map