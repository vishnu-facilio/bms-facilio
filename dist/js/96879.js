"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[96879],{
/***/641384:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return BaseConfig}});
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/objectSpread2.js
var render,staticRenderFns,objectSpread2=__webpack_require__(595082),createForOfIteratorHelper=__webpack_require__(566347),esm_typeof=__webpack_require__(103336),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),validation=(__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(670560),__webpack_require__(169358),__webpack_require__(821057),__webpack_require__(450886),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(425728),__webpack_require__(434284),__webpack_require__(990260)),debounce=__webpack_require__(23279),debounce_default=__webpack_require__.n(debounce),cloneDeep=__webpack_require__(150361),cloneDeep_default=__webpack_require__.n(cloneDeep),uuid=__webpack_require__(455877),card_constants=__webpack_require__(806186),isString=__webpack_require__(747037),isString_default=__webpack_require__.n(isString),api=__webpack_require__(32284),BaseConfigvue_type_script_lang_js={props:["isNew","savedCardData","cardType","onClose","onGoBack","onCardSave","onCardUpdate","closePopup","cardMeta","isDuplicate","onCardDuplicate"],data:function(){return{conditionalFormatting:{},decimalPlaces:card_constants/* decimalPlaces */.N3,scriptModeInt:null,customScriptId:null,nameSpaces:[],enableBoxchecked:!1}},created:function(){this.initializeValidators();var isNew=this.isNew,savedCardData=this.savedCardData;isNew||(0,validation/* isEmpty */.xb)(savedCardData)||(this.deserialize(this.savedCardData.cardParams),this.deserializeState(this.savedCardData.cardState),this.deserializeActions(this.savedCardData.cardDrilldown),this.deserializeConditions(this.savedCardData.conditionalFormatting),this.deserializeCustomScriptData(this.savedCardData),
// TODO Revaluate if necessary and model this as computed
this.setConditionalData(this.cardDataObj))},watch:{cardDataObj:{deep:!0,handler:function(){this.validate()&&this.debouncedGetData()}},cardStateObj:{deep:!0,handler:function(){this.validate()&&this.debouncedGetData()}},conditionalFormatting:{deep:!0,handler:function(){this.validate()&&this.debouncedGetData()}},customScriptId:{deep:!0,handler:function(newval,oldVal){newval!==oldVal&&this.debouncedGetData()}}},computed:{previewState:function(){var result=this.result,cardStateObj=this.cardStateObj,_ref=result||{},cardContext=_ref.cardContext;return(0,validation/* isEmpty */.xb)(result&&cardContext)?this.serializeState(cardStateObj):result.state?result.state:this.serializeState(cardStateObj)},componentKey:function(){return(0,uuid.v4)()},variables:function(){var result=this.result;if(result&&result.data){var previewData=result.data,variables=previewData.variables;if(variables)return variables}return[]}},methods:{setProps:function(){3===this.scriptModeInt||null===this.scriptModeInt?this.enableBoxchecked=!1:null!==this.scriptModeInt&&(this.enableBoxchecked=!0)},loadNameSpaceList:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.next=2,api/* API */.bl.get("/v2/workflow/getNameSpaceListWithFunctions").then((function(_ref2){var data=_ref2.data;_this.nameSpaces=data.workflowNameSpaceList?data.workflowNameSpaceList:[]})).catch((function(){_this.nameSpaces=[]}));case 2:case"end":return _context.stop()}}),_callee)})))()},deserializeCustomScriptData:function(_ref3){var customScriptId=_ref3.customScriptId,scriptModeInt=_ref3.scriptModeInt;this.customScriptId=customScriptId,this.scriptModeInt=scriptModeInt},serializeCustomScriptData:function(_ref4){var customScriptId=_ref4.customScriptId,scriptModeInt=_ref4.scriptModeInt;this.customScriptId=customScriptId,this.scriptModeInt=scriptModeInt},validate:function(){var hasEmptyField=!1,customRules=this.validateProperty()||{},cardDataObj=this.serialize();return this.resourceProps.forEach((function(prop){var isMap="object"===(0,esm_typeof/* default */.Z)(prop),propName=isMap?prop.prop:prop;customRules[propName]?customRules[propName](cardDataObj)&&(hasEmptyField=!0):isMap&&prop.resourceProps?prop.resourceProps.forEach((function(p){((0,validation/* isEmpty */.xb)(cardDataObj[propName])||(0,validation/* isEmpty */.xb)(cardDataObj[propName][p]))&&(hasEmptyField=!0)})):(0,validation/* isEmpty */.xb)(cardDataObj[propName])&&(hasEmptyField=!0)})),!hasEmptyField},changescriptModeInt:function(){var id=[];if(this.nameSpaces){var _step,_iterator=(0,createForOfIteratorHelper/* default */.Z)(this.nameSpaces);try{for(_iterator.s();!(_step=_iterator.n()).done;){var nameSpace=_step.value;if(null!==nameSpace.functions){var _step2,_iterator2=(0,createForOfIteratorHelper/* default */.Z)(nameSpace.functions);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var func=_step2.value;id.push(func.id)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}}}catch(err){_iterator.e(err)}finally{_iterator.f()}}1==this.enableBoxchecked?(id.length&&(this.customScriptId=id[0]),this.scriptModeInt=2):(this.customScriptId=-99,this.scriptModeInt=3)},validateProperty:function(){
// To be overriden in card component if data validation rule for a property
// needs to be more complex that just an isEmpty() check
// {
//   prop1: validatorFn1(data) {
//      return true when field is invalid or has error
//   },
//   prop2: validatorFn2(data) {
//      return false when data is correct
//   }
// }
},validateForm:function(){var form=this.$refs["".concat(this.cardLayout,"_form")];return new Promise((function(resolve,reject){form.validate((function(isValid){isValid?resolve():reject()}))}))},initializeValidators:function(){var _this2=this,cardDataObj=this.cardDataObj,customValidationRules=this.validateField()||{},validationRules={};Object.keys(cardDataObj).forEach((function(prop){var propName="object"===(0,esm_typeof/* default */.Z)(prop)?prop.prop:prop,validator=function(rule,value,callback){(0,validation/* isEmpty */.xb)(this.cardDataObj[propName])?callback(new Error("Field can not be empty")):callback()}.bind(_this2),type=_this2.$getProperty(_this2,"cardMeta.type")||null;"KPICARD2"===type&&"dateRange"===propName||(validationRules[propName]={trigger:"blur",validator:validator})})),this.$set(this,"validationRules",(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},validationRules),customValidationRules))},validateField:function(){
// To be overriden in card component if form validation rule for a property
// needs to be more complex that just an isEmpty() check
// Return an object with prop vs {trigger, validator} (ElementUI form rule format)
// as below:
// {
//   prop1: {trigger: 'change', validator: (rule, value, callback)=>{}}
//   prop2: {trigger: 'blur', validator: (rule, value, callback)=>{}}
// }
},deserialize:function(cardParams){var _this3=this,params=cloneDeep_default()(cardParams);Object.keys(params).forEach((function(prop){return _this3.deserializeProperty(prop,params)}))},deserializeProperty:function(prop,data){
// To be overriden in card components if required.
// By default only sets the props in resourceProps to cardDataObj
var validProps=this.resourceProps.map((function(p){return"object"===(0,esm_typeof/* default */.Z)(p)?p.prop:p}));validProps.includes(prop)&&this.$set(this.cardDataObj,prop,data[prop])},serialize:function(){var _data$kpiType,_this4=this,resourceProps=this.resourceProps,cardDataObj=this.cardDataObj,data={};resourceProps.forEach((function(prop){var propName="object"===(0,esm_typeof/* default */.Z)(prop)?prop.prop:prop;data[propName]=cardDataObj[propName];var value=_this4.serializeProperty(propName,cardDataObj);(0,validation/* isUndefined */.o8)(value)||(data[propName]=value)}));var kpiType=null!==(_data$kpiType=null===data||void 0===data?void 0:data.kpiType)&&void 0!==_data$kpiType?_data$kpiType:null;if("reading"===kpiType){var newData=this.$helpers.cloneObject(data),_ref5=null!==newData&&void 0!==newData?newData:{},kpis=_ref5.kpis,maxSafeLimitKpi=_ref5.maxSafeLimitKpi,centerTextKpi=_ref5.centerTextKpi,kpi=_ref5.kpi;return(0,validation/* isEmpty */.xb)(kpis)||(newData.kpis=kpis.map((function(kpi){var kpiId=kpi.kpiId;return!(0,validation/* isEmpty */.xb)(kpiId)&&isString_default()(kpiId)&&(kpi.kpiId=parseInt(kpiId.split("_")[0])),kpi}))),[maxSafeLimitKpi,centerTextKpi,kpi].forEach((function(key,index){if(!(0,validation/* isEmpty */.xb)(key)){var kpiId=key.kpiId;key.kpiId=isString_default()(kpiId)?parseInt(kpiId.split("_")[0]):kpiId,0===index?newData["maxSafeLimitKpi"]=key:1===index?newData["centerTextkpi"]=key:newData["kpi"]=key}})),newData}return data},serializeProperty:function(){
// To be implemented in card components if any special handling is required
// before sending to server, for any of the props in resourceProps
}/* prop, data */,serializeState:function(){
// To be overriden in the card components as required.
// By default, sends the cardStateObj as it is.
var cardStateObj=this.cardStateObj;if(!(0,validation/* isEmpty */.xb)(cardStateObj))return cardStateObj},serializeConditions:function(){
// to serialize the conditional formatting
var conditionalFormatting=this.conditionalFormatting;if(!(0,validation/* isEmpty */.xb)(conditionalFormatting))return conditionalFormatting},deserializeConditions:function(conditionalFormatting){
// TO deserialize the state
(0,validation/* isEmpty */.xb)(conditionalFormatting)||this.$set(this,"conditionalFormatting",conditionalFormatting)},deserializeState:function(cardState){
// To be overriden in the card components if required.
// Receives cardState from server as the only param
(0,validation/* isEmpty */.xb)(cardState)||this.$set(this,"cardStateObj",cardState)},serializeActions:function(){
// To be overriden in the card components as required.
// By default, sends the cardActions as it is.
var cardActions=this.cardActions;if(!(0,validation/* isEmpty */.xb)(cardActions))return cardActions},deserializeActions:function(cardDrilldown){
// To be overriden in the card components if required.
// Receives cardDrillDdown from server as the only param
(0,validation/* isEmpty */.xb)(cardDrilldown)||this.$set(this,"cardActions",cardDrilldown)},configWatchHook:function(){
// use this method insted of watch => config
},customValidation:function(){
// this methods should be removed
// if any custom validation requirement needed then use this method ..also this is the last validation
return!0},getData:function(){var _this5=this;this.configWatchHook();var data={cardContext:{cardLayout:this.cardLayout,cardParams:this.serialize(),cardState:this.serializeState(),cardDrilldown:this.serializeActions(),conditionalFormatting:this.serializeConditions(),customScriptId:this.customScriptId,scriptModeInt:this.scriptModeInt}};return this.isPreviewLoading=!0,this.$http.post("/v2/dashboard/cards/getCardData",data).then((function(_ref6){var data=_ref6.data;0===data.responseCode?_this5.$set(_this5,"result",data.result):_this5.$set(_this5,"result",null),_this5.isPreviewLoading=!1})).catch((function(){_this5.isPreviewLoading=!1}))},debouncedGetData:debounce_default()((function(){return this.getData()}),1e3),save:function(){var _this6=this;this.validateForm().then((function(){if(_this6.customValidation()){var data={cardContext:{cardLayout:_this6.cardLayout,cardParams:_this6.serialize(),cardState:_this6.serializeState(),cardDrilldown:_this6.serializeActions(),conditionalFormatting:_this6.serializeConditions(),customScriptId:_this6.customScriptId,scriptModeInt:_this6.scriptModeInt}};_this6.isNew?_this6.onCardSave(data,_this6.layout):_this6.isDuplicate?_this6.onCardDuplicate(data,_this6.layout):_this6.onCardUpdate(data,_this6.layout)}})).catch((function(){}))},close:function(){this.onClose()},setConditionalData:function(cardDataObj){var reading=cardDataObj.reading,readings=cardDataObj.readings,readingArray=(0,validation/* isEmpty */.xb)(reading)?(0,validation/* isEmpty */.xb)(readings)?[]:readings:[reading];this.setConditionalVariables(readingArray,!0)},setConditionalVariables:function(){var _this7=this,readings=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],skipRerender=arguments.length>1?arguments[1]:void 0;Array.isArray(readings)||(readings=[readings]);var cardType=this.cardType;readings.forEach((function(reading){var dataType=reading.dataType,conditionalVariables=_this7.conditionalVariables,variable=(conditionalVariables||[]).find((function(v){return"value"===v.name})),assignOperator=function(){variable.dataType=2===dataType?"NUMBER":3===dataType?"DECIMAL":4===dataType?"BOOLEAN":"STRING"};("kpi"===cardType&&dataType||!(0,validation/* isEmpty */.xb)(conditionalVariables)&&variable&&"kpi"!=cardType)&&assignOperator(),skipRerender||_this7.rerenderConditionalFormatting()}))},rerenderConditionalFormatting:function(){var conditionalComponent=this.$refs["conditional-formatting"];(0,validation/* isEmpty */.xb)(conditionalComponent)||conditionalComponent.rerender()}}},common_BaseConfigvue_type_script_lang_js=BaseConfigvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(common_BaseConfigvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,BaseConfig=component.exports;
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js
},
/***/700697:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return ReadingPicker}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/card-builder/cards/common/ReadingPicker.vue?vue&type=template&id=664846d2&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",_vm._l(_vm.readings,(function(obj,index){return _c("el-row",{key:obj.id+index+"row",staticClass:"row mB10",attrs:{gutter:10}},[_c("el-col",{attrs:{span:_vm.isDynamicKpi()?_vm.isMultiMode?8:9:12}},["multiple"===_vm.options["parentId"].type||0===index?_c("el-form-item",[_c("el-input",{staticClass:"fc-input-full-border-select2",attrs:{disabled:!0,type:"text",placeholder:"Space/Asset"},model:{value:obj.parentName,callback:function($$v){_vm.$set(obj,"parentName",$$v)},expression:"obj.parentName"}},[_c("i",{staticClass:"el-input__icon el-icon-search",staticStyle:{"line-height":"0px !important","font-size":"16px !important",cursor:"pointer"},attrs:{slot:"suffix"},on:{click:function($event){return _vm.showPicker(index)}},slot:"suffix"})]),obj.pickerVisibility?_c("space-asset-chooser",{attrs:{visibility:obj.pickerVisibility,query:_vm.quickSearchQuery,picktype:_vm.options.pickerModule?_vm.options.pickerModule:null,showAsset:!0,closeOnClickModel:!0},on:{associate:function(resource,resourceType){return _vm.associate(index,resource,resourceType)},"update:visibility":function($event){return _vm.$set(obj,"pickerVisibility",$event)}}}):_vm._e()],1):_c("el-form-item",[_c("el-input",{staticClass:"fc-input-full-border-select2",attrs:{disabled:!0,type:"text",placeholder:"Space/Asset"},model:{value:_vm.readings[0].parentName,callback:function($$v){_vm.$set(_vm.readings[0],"parentName",$$v)},expression:"readings[0].parentName"}},[_c("i",{staticClass:"el-input__icon el-icon-search",staticStyle:{"line-height":"0px !important","font-size":"16px !important"},attrs:{slot:"suffix"},slot:"suffix"})])],1)],1),_c("el-col",{attrs:{span:_vm.isDynamicKpi()?_vm.isMultiMode?9:10:12}},["multiple"===_vm.options["fieldName"].type||0===index?_c("el-form-item",[_vm.isRender?_c("div",[_vm.loading?_c("div",[_c("FieldLoader",{attrs:{isLoading:!0}})],1):obj.selectedFieldId||null==obj.fieldName||void 0==obj.fieldName||""==obj.fieldName?_c("div",[_c("el-select",{staticClass:"report-dropDown el-input-textbox-full-border",attrs:{filterable:"",placeholder:"Reading",clearable:!0},on:{change:function(){return _vm.setDatapoint(index,obj.selectedFieldId)}},model:{value:obj.selectedFieldId,callback:function($$v){_vm.$set(obj,"selectedFieldId",$$v)},expression:"obj.selectedFieldId"}},_vm._l(_vm.readingFields,(function(field,idx){return _c("el-option",{key:idx,attrs:{label:_vm.readingName(field),value:JSON.stringify({id:field.id,name:field.name,kpiType:field.kpiType})}})})),1)],1):_c("div",[_c("el-select",{staticClass:"report-dropDown el-input-textbox-full-border",attrs:{filterable:"",placeholder:"Reading",clearable:!0},on:{change:function(){return _vm.setDatapoint(index,obj.fieldName)}},model:{value:obj.fieldName,callback:function($$v){_vm.$set(obj,"fieldName",$$v)},expression:"obj.fieldName"}},_vm._l(_vm.readingFields,(function(field,idx){return _c("el-option",{key:idx,attrs:{label:_vm.readingName(field),value:field.name}})})),1)],1)]):_vm._e()]):_c("el-form-item",[_c("el-select",{staticClass:"report-dropDown el-input-textbox-full-border",attrs:{filterable:"",placeholder:"Reading",disabled:""},model:{value:_vm.readings[0].fieldName,callback:function($$v){_vm.$set(_vm.readings[0],"fieldName",$$v)},expression:"readings[0].fieldName"}},_vm._l(_vm.readingFields,(function(field,idx){return _c("el-option",{key:idx,attrs:{label:_vm.readingName(field),value:field.name}})})),1)],1)],1),_vm.options["yAggr"]&&_vm.isDynamicKpi()?_c("el-col",{attrs:{span:_vm.isMultiMode?4:5}},["multiple"===_vm.options["yAggr"].type||0===index?_c("el-form-item",[_c("el-select",{staticClass:"width100 el-input-textbox-full-border",attrs:{placeholder:"Aggr"},on:{change:_vm.emitReading},model:{value:obj.yAggr,callback:function($$v){_vm.$set(obj,"yAggr",$$v)},expression:"obj.yAggr"}},_vm._l(_vm.aggregateFunctions,(function(fn,index){return _c("el-option",{key:index,attrs:{label:fn.label,value:fn.value}})})),1)],1):_c("el-form-item",[_c("el-select",{staticClass:"width100 el-input-textbox-full-border",attrs:{placeholder:"Aggr",disabled:""},model:{value:_vm.readings[0].yAggr,callback:function($$v){_vm.$set(_vm.readings[0],"yAggr",$$v)},expression:"readings[0].yAggr"}},_vm._l(_vm.aggregateFunctions,(function(fn,index){return _c("el-option",{key:index,attrs:{label:fn.label,value:fn.value}})})),1)],1)],1):_vm._e(),_vm.isMultiMode?_c("div",{key:obj.id+index+"",staticClass:"reading-controls"},[index===_vm.readings.length-1&&_vm.readings.length<10?_c("img",{staticClass:"delete-icon pointer",staticStyle:{"margin-right":"6px"},attrs:{src:__webpack_require__(353654)},on:{click:function($event){return _vm.addRow()}}}):_vm._e(),1!==_vm.readings.length?_c("img",{staticClass:"delete-icon pointer",staticStyle:{"margin-right":"3px"},attrs:{src:__webpack_require__(385769)},on:{click:function($event){return _vm.deleteRow(index)}}}):_vm._e()]):_vm._e()],1)})),1)},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),toConsumableArray=__webpack_require__(488478),asyncToGenerator=__webpack_require__(548534),objectSpread2=__webpack_require__(595082),slicedToArray=__webpack_require__(554621),esm_typeof=__webpack_require__(103336),uuid=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(186466),__webpack_require__(434284),__webpack_require__(169358),__webpack_require__(947522),__webpack_require__(336585),__webpack_require__(450886),__webpack_require__(670560),__webpack_require__(634338),__webpack_require__(162506),__webpack_require__(455877)),card_constants=__webpack_require__(806186),SpaceAssetChooser=__webpack_require__(372587),validation=__webpack_require__(990260),api=__webpack_require__(32284),FieldLoader=__webpack_require__(62979),ReadingPickervue_type_script_lang_js={name:"ReadingPicker",components:{SpaceAssetChooser:SpaceAssetChooser/* default */.Z,FieldLoader:FieldLoader/* default */.Z},props:{gaugeCard:{type:Boolean},options:{required:!0,type:Object,default:function(){return{pickerModule:"asset"}}},initialReading:{type:Object}},data:function(){return{loading:!1,selectedIndex:-1,quickSearchQuery:"",readingFields:[],readings:[{id:(0,uuid.v4)(),pickerVisibility:!1,parentType:null,parentName:null,parentId:null,moduleName:null,fieldName:null,fieldId:null,yAggr:null,selectedFieldId:null}],fieldName:null,aggregateFunctions:card_constants/* aggregateFunctions */.rD,isRender:!0}},created:function(){(0,validation/* isEmpty */.xb)(this.initialReading)||this.deserializeReading(this.initialReading)},computed:{isMultiMode:function(){return!(0,validation/* isEmpty */.xb)(Object.values(this.options).find((function(rt){return"multiple"===rt.type})))}},methods:{isDynamicKpi:function(){return!("DYNAMIC"===this.readings[0].kpiType)},readingName:function(field){return(0,validation/* isEmpty */.xb)(field.displayName)?field.name:field.displayName},setDatapoint:function(index,fieldName){var fieldobj,_this=this,decimal=3;try{var fieldNameObj=JSON.parse(fieldName);(0,validation/* isEmpty */.xb)(fieldNameObj)||"object"!==(0,esm_typeof/* default */.Z)(fieldNameObj)||(this.readings[index].selectedFieldId=fieldName,fieldobj=this.readingFields.find((function(rt){var condition=rt.id===fieldNameObj.id&&rt.name===fieldNameObj.name;return((0,validation/* isEmpty */.xb)(fieldNameObj.kpiType)||rt.kpiType===fieldNameObj.kpiType)&&condition})))}catch(e){fieldobj=this.readingFields.find((function(rt){return rt.name===fieldName})),this.readings[index].selectedFieldId={id:fieldobj.id,name:fieldobj.name}}finally{var _fieldobj,_fieldobj2;this.readings[index].kpiType=fieldobj.kpiType,this.readings[index].moduleName=null===(_fieldobj=fieldobj)||void 0===_fieldobj||null===(_fieldobj=_fieldobj.module)||void 0===_fieldobj?void 0:_fieldobj.name,this.readings[index].fieldName=fieldobj.name,this.readings[index].fieldId=fieldobj.id,this.readings[index].dataType=(null===(_fieldobj2=fieldobj)||void 0===_fieldobj2?void 0:_fieldobj2.dataType)||decimal,this.isRender=!1,this.emitReading(),this.$nextTick((function(){_this.isRender=!0}))}},emitReading:function(){var readings=this.readings;this.$emit("onReadingSelect",this.serializeReading(readings))},validateReading:function(readings){return readings.reduce((function(acc,reading){return Object.values(reading).forEach((function(value){(0,validation/* isEmpty */.xb)(value)&&(acc=!1)})),acc}),!0)},serializeReading:function(readings){for(var _this2=this,formattedReading={},reading=readings[0],_loop=function(){var _Object$entries$_i=(0,slicedToArray/* default */.Z)(_Object$entries[_i],2),key=_Object$entries$_i[0],value=_Object$entries$_i[1];"single"===value.type?_this2.$set(formattedReading,key,reading[key]):"multiple"===value.type&&_this2.$set(formattedReading,key,readings.map((function(rt){return rt[key]})))},_i=0,_Object$entries=Object.entries(this.options);_i<_Object$entries.length;_i++)_loop();return formattedReading},deserializeReading:function(initialReading){if(this.loading=!0,this.isMultiMode){for(var readings=[],readingCount=Object.values(initialReading).reduce((function(acc,value){return(0,validation/* isArray */.kJ)(value)&&(acc=value.length),acc}),1),i=0;i<readingCount;i++)readings.push(this.getEmptyObj());Object.entries(initialReading).forEach((function(_ref){var _ref2=(0,slicedToArray/* default */.Z)(_ref,2),key=_ref2[0],value=_ref2[1];(0,validation/* isArray */.kJ)(value)?readings.forEach((function(reading,index){return reading[key]=value[index]})):readings.forEach((function(r){return r[key]=value}))})),this.$set(this,"readings",readings),this.loadReadingFields(0,readings[0].parentId,readings[0].parentType)}else{this.$set(this.readings,0,(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},initialReading),{},{id:(0,uuid.v4)()}));var _readings=this.readings;this.loadReadingFields(0,_readings[0].parentId,_readings[0].parentType)}},loadReadingFields:function(index,parentId,resourceType){var _this3=this;if(!(0,validation/* isEmpty */.xb)(parentId)){var promise="space"===resourceType?this.$util.loadSpaceReadingFields(parentId):this.$util.loadAssetReadingFields(parentId);return promise.then(function(){var _ref3=(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(readingFields){var dynamicKpisList,_yield$API$get,data,error,_ref4,dynamicKpis;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(dynamicKpisList=[],!0!==_this3.gaugeCard||"asset"!==resourceType){_context.next=8;break}return _context.next=4,api/* API */.bl.get("/v3/readingKpi/analytics/getDynamicKpisForAsset",{assetId:parentId});case 4:_yield$API$get=_context.sent,data=_yield$API$get.data,error=_yield$API$get.error,error||(_ref4=data||{},dynamicKpis=_ref4.dynamicKpis,(0,validation/* isEmpty */.xb)(dynamicKpis)||(dynamicKpisList=dynamicKpis.map((function(kpi){return kpi.kpiType="DYNAMIC",kpi}))));case 8:_this3.readingFields=[].concat((0,toConsumableArray/* default */.Z)(readingFields),(0,toConsumableArray/* default */.Z)(dynamicKpisList)),_this3.loading=!1;case 10:case"end":return _context.stop()}}),_callee)})));return function(_x){return _ref3.apply(this,arguments)}}())}this.loading=!1},showPicker:function(index){this.$set(this.readings,index,(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},this.readings[index]),{},{pickerVisibility:!0}))},associate:function(index,resource,resourceType){this.readings[index].pickerVisibility=!1,this.readings[index].parentName=resource.name,this.readings[index].parentId=resource.id,this.readings[index].parentType=resourceType,this.readings[index].selectedFieldId=null,this.readings[index].fieldName=null,this.readings[index].kpiType=null,this.readings[index].moduleName=null,this.readings[index].fieldId=null,this.readings[index].dataType=null,this.loadReadingFields(index,resource.id,resourceType),this.emitReading()},getEmptyObj:function(){return{id:(0,uuid.v4)(),pickerVisibility:!1,parentType:null,parentName:null,moduleName:null,fieldName:null,parentId:null,fieldId:null,yAggr:null}},addRow:function(){var readings=this.readings;this.readings.length<10&&(this.$set(this,"readings",[].concat((0,toConsumableArray/* default */.Z)(readings),[this.getEmptyObj()])),this.$forceUpdate())},deleteRow:function(index){this.readings.splice(index,1),this.$forceUpdate()}}},common_ReadingPickervue_type_script_lang_js=ReadingPickervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(common_ReadingPickervue_type_script_lang_js,render,staticRenderFns,!1,null,"664846d2",null)
/* harmony default export */,ReadingPicker=component.exports},
/***/624817:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return ActionPicker}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/card-builder/components/ActionPicker.vue?vue&type=template&id=07e1b3ae
var _ACTION_CONFIG,ActionsMixin_render,ActionsMixin_staticRenderFns,render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"action-config"},_vm._l(_vm.actionData,(function(action,actionElement,index){return _c("div",{key:_vm.getElement(actionElement).name+"action"},[_c("el-form",{ref:"action_form_"+index,refInFor:!0,attrs:{model:action,rules:_vm.rules,"label-position":"top"}},[_vm._t("element-title",(function(){return[_c("div",{key:_vm.getElement(actionElement).name+"actionName",staticClass:"element-title fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.getElement(actionElement).displayName||_vm.getElement(actionElement).name)+" ")])]}),{element:_vm.getElement(actionElement),index:index}),_vm._t("action-type",(function(){return[_c("el-row",{staticClass:"pB10",attrs:{gutter:10}},[_c("el-col",{attrs:{span:10}},[_c("p",{staticClass:"fc-input-label-txt pB5"},[_vm._v("Action Type")]),_c("el-select",{key:_vm.getElement(actionElement).name+"actionType",staticClass:"fc-input-full-border-select2 mB10",attrs:{filterable:"",placeholder:"Select Action"},on:{change:function(value){_vm.onActionTypeChange(actionElement,value),_vm.save()}},model:{value:action.actionType,callback:function($$v){_vm.$set(action,"actionType",$$v)},expression:"action.actionType"}},_vm._l(_vm.FILTERED_CONFIG?Object.values(_vm.FILTERED_CONFIG):Object.values(_vm.ACTION_CONFIG),(function(type,i){return _c("el-option",{key:type.actionType+i+"",attrs:{label:type.actionName,value:type.actionType}})})),1)],1)],1)]}),{actionType:action.actionType,onActionTypeChange:_vm.onActionTypeChange,actionTypes:_vm.ACTION_CONFIG,index:index,element:_vm.getElement(actionElement)}),action.actionType===_vm.ACTION_TYPES.CONTROL?_c("div",[_c("el-row",{attrs:{gutter:10}},[_c("el-col",{attrs:{span:10}},[_c("el-form-item",{staticClass:"mB10",attrs:{prop:"data"}},[_c("p",{staticClass:"fc-input-label-txt pB5"},[_vm._v("Control Type")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{placeholder:"Type"},on:{change:_vm.save},model:{value:action.data.controlType,callback:function($$v){_vm.$set(action.data,"controlType",$$v)},expression:"action.data.controlType"}},[_c("el-option",{attrs:{label:"Control Point",value:_vm.CONTROL_TYPES.POINT}}),_c("el-option",{attrs:{label:"Control Group",value:_vm.CONTROL_TYPES.GROUP}})],1)],1)],1),action.data.controlType===_vm.CONTROL_TYPES.POINT?_c("el-col",{attrs:{span:14}},[_c("p",{staticClass:"fc-input-label-txt pB5"},[_vm._v("Asset")]),_c("el-input",{staticClass:"fc-input-full-border-select2",attrs:{readonly:!0,type:"text",placeholder:"Choose Asset"},model:{value:action.data.label,callback:function($$v){_vm.$set(action.data,"label",$$v)},expression:"action.data.label"}},[_c("i",{staticClass:"el-input__icon el-icon-search",staticStyle:{"line-height":"0px !important","font-size":"16px !important",cursor:"pointer"},attrs:{slot:"suffix"},on:{click:function($event){_vm.showControlPointAssetPicker=!0}},slot:"suffix"})]),_vm.showControlPointAssetPicker?_c("space-asset-chooser",{attrs:{visibility:_vm.showControlPointAssetPicker,picktype:"asset",closeOnClickModel:!0},on:{associate:function(resource,resourceType){return _vm.associateControlPointAsset(action.data,resource,resourceType)},"update:visibility":function($event){_vm.showControlPointAssetPicker=$event}}}):_vm._e()],1):_vm._e(),_c("el-col",{attrs:{span:24}},[_c("el-form-item",{staticClass:"mB10",attrs:{prop:"data"}},[_c("p",{staticClass:"fc-input-label-txt pB5"},[_vm._v("Control Points")]),action.data.controlType===_vm.CONTROL_TYPES.POINT?_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{filterable:"",remote:"","remote-method":function(querry){_vm.fetchControlPoints(action,querry)},placeholder:"Select Control Point"},on:{change:function($event){_vm.setControlPoint(action.data),_vm.save()}},model:{value:action.data.controlPointId,callback:function($$v){_vm.$set(action.data,"controlPointId",$$v)},expression:"action.data.controlPointId"}},_vm._l(_vm.controlPoints,(function(cp,index){return _c("el-option",{key:index,attrs:{label:cp.resourceContext.name+" ("+cp.field.displayName+")",value:cp.id}})})),1):_vm._e(),action.data.controlType===_vm.CONTROL_TYPES.GROUP?_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{filterable:"",placeholder:"Select Control Group"},on:{change:function($event){_vm.setControlGroup(action.data.controlGroupId),_vm.save()}},model:{value:action.data.controlGroupId,callback:function($$v){_vm.$set(action.data,"controlGroupId",$$v)},expression:"action.data.controlGroupId"}},_vm._l(_vm.controlGroups,(function(cg,index){return _c("el-option",{key:index,attrs:{label:cg.name,value:cg.id}})})),1):_vm._e()],1)],1)],1)],1):_vm._e(),action.actionType===_vm.ACTION_TYPES.LINK?[_c("el-row",{attrs:{gutter:10}},[_c("el-col",{attrs:{span:16}},[_c("p",{staticClass:"fc-input-label-txt pB5"},[_vm._v("URL")]),_c("el-form-item",{staticClass:"mB10",attrs:{prop:"data"}},[_c("el-input",{staticClass:"fc-input-full-border2",attrs:{placeholder:"URL"},model:{value:action.data.url,callback:function($$v){_vm.$set(action.data,"url",$$v)},expression:"action.data.url"}})],1)],1),_c("el-col",{attrs:{span:8}},[_c("p",{staticClass:"fc-input-label-txt pB5"},[_vm._v("Target")]),_c("el-form-item",{staticClass:"mB10",attrs:{prop:"data"}},[_c("el-select",{staticClass:"fc-input-full-border-select2",attrs:{placeholder:"Target"},model:{value:action.data.target,callback:function($$v){_vm.$set(action.data,"target",$$v)},expression:"action.data.target"}},[_c("el-option",{attrs:{label:"Same tab",value:"self"}}),_c("el-option",{attrs:{label:"New tab",value:"_blank"}}),_c("el-option",{attrs:{label:"Popup",value:"popup"}})],1)],1)],1)],1)]:_vm._e(),action.actionType===_vm.ACTION_TYPES.LISTVIEW?[_c("el-row",{attrs:{gutter:10}},[_c("el-col",{attrs:{span:10}},[_c("p",{staticClass:"fc-input-label-txt pB5"},[_vm._v("Target")]),_c("el-form-item",{staticClass:"mB10",attrs:{prop:"data"}},[_c("el-select",{staticClass:"fc-input-full-border-select2",attrs:{placeholder:"Target"},model:{value:action.data.target,callback:function($$v){_vm.$set(action.data,"target",$$v)},expression:"action.data.target"}},[_c("el-option",{attrs:{label:"Same tab",value:"self"}}),_c("el-option",{attrs:{label:"New tab",value:"_blank"}}),_c("el-option",{attrs:{label:"Popup",value:"popup"}})],1)],1)],1),_c("el-col",{attrs:{span:10}},[_c("p",{staticClass:"fc-input-label-txt pB5"},[_vm._v("View")]),_c("el-form-item",{staticClass:"mB10",attrs:{prop:"data"}},[_c("el-select",{staticClass:"fc-input-full-border-select2",attrs:{filterable:"",placeholder:"View"},model:{value:action.data.view,callback:function($$v){_vm.$set(action.data,"view",$$v)},expression:"action.data.view"}},[_vm._l(_vm.Kpiviews,(function(kpi,index){return[_c("el-option-group",{key:index,attrs:{label:kpi.displayName,value:kpi.name}},_vm._l(kpi.views,(function(item,j){return _c("el-option",{key:index+j+"",attrs:{label:item.displayName,value:item.name}})})),1)]}))],2)],1)],1)],1)]:_vm._e(),action.actionType===_vm.ACTION_TYPES.REPORT?[_c("el-row",{attrs:{gutter:10}},[_c("el-col",{attrs:{span:10}},[_c("p",{staticClass:"fc-input-label-txt pB5"},[_vm._v("Target")]),_c("el-form-item",{staticClass:"mB10",attrs:{prop:"data"}},[_c("el-select",{staticClass:"fc-input-full-border-select2",attrs:{placeholder:"Target"},model:{value:action.data.target,callback:function($$v){_vm.$set(action.data,"target",$$v)},expression:"action.data.target"}},[_c("el-option",{attrs:{label:"Same tab",value:"self"}}),_c("el-option",{attrs:{label:"New tab",value:"_blank"}}),_c("el-option",{attrs:{label:"Popup",value:"popup"}})],1)],1)],1),_c("el-col",{attrs:{span:10}},[_c("p",{staticClass:"fc-input-label-txt pB5"},[_vm._v("Report type")]),_c("el-form-item",{staticClass:"mB10",attrs:{prop:"data"}},[_c("el-select",{staticClass:"fc-input-full-border-select2",attrs:{placeholder:"Target"},on:{change:function($event){return _vm.chooseReport(action.data.type)}},model:{value:action.data.type,callback:function($$v){_vm.$set(action.data,"type",$$v)},expression:"action.data.type"}},[_c("el-option",{attrs:{label:"Module Report",value:1}}),_c("el-option",{attrs:{label:"Reading Report",value:2}})],1)],1)],1),1===action.data.type?_c("el-col",{attrs:{span:10}},[_c("p",{staticClass:"fc-input-label-txt pB5"},[_vm._v("Module")]),_c("el-form-item",{staticClass:"mB10",attrs:{prop:"data"}},[_c("el-select",{staticClass:"fc-input-full-border-select2",attrs:{placeholder:_vm.$t("setup.formulaBuilder.choose_module"),filterable:"",clearable:""},on:{change:function($event){return _vm.loadReports(action.data.moduleName)}},model:{value:action.data.moduleName,callback:function($$v){_vm.$set(action.data,"moduleName",$$v)},expression:"action.data.moduleName"}},_vm._l(_vm.moduleList,(function(m,i){return _c("el-option",{key:i,attrs:{label:m.displayName,value:m.name}})})),1)],1)],1):_vm._e(),_c("el-col",{attrs:{span:10}},[_c("p",{staticClass:"fc-input-label-txt pB5"},[_vm._v("Report")]),_c("el-form-item",{staticClass:"mB10",attrs:{prop:"data"}},[_c("el-select",{staticClass:"fc-input-full-border-select2",attrs:{placeholder:"Choose Reports",filterable:"",clearable:""},on:{change:function($event){return _vm.getReportObj(action.data.reportId)}},model:{value:action.data.reportId,callback:function($$v){_vm.$set(action.data,"reportId",$$v)},expression:"action.data.reportId"}},_vm._l(_vm.reportFolders,(function(folder,index){return _c("el-option-group",{key:index,attrs:{label:folder.name}},_vm._l(folder.reports,(function(report,idx){return _c("el-option",{key:idx,attrs:{label:report.name,value:report.id}})})),1)})),1)],1)],1)],1),_c("el-row",{attrs:{gutter:10}},[_c("el-col",{attrs:{span:20}},[_c("el-form-item",{staticClass:"mB10"},[_c("p",{staticClass:"fc-input-label-txt pB5"},[_vm._v("Parameters")]),_c("el-input",{staticClass:"width100 fc-input-full-border2",attrs:{clearable:""},model:{value:action.data.parameter,callback:function($$v){_vm.$set(action.data,"parameter",$$v)},expression:"action.data.parameter"}})],1)],1),_c("el-col",{attrs:{span:2}},[_c("el-form-item",{staticClass:"mB10 mT25"},[_c("p",{staticClass:"fc-input-label-txt pB5"}),_c("el-popover",{attrs:{placement:"right",width:"250",trigger:"click","popper-class":"f-popover"},model:{value:_vm.showInsertVariablePopover,callback:function($$v){_vm.showInsertVariablePopover=$$v},expression:"showInsertVariablePopover"}},[_c("div",{staticClass:"graphics-insert-variable-container"},[_c("div",{staticClass:"graphics-insert-variable-title"},[_vm._v(" Insert Variable ")]),_c("div",{staticClass:"graphics-insert-variable-filter"},[_c("el-input",{staticClass:"fc-input-full-border2",attrs:{placeholder:"Filter variables"},model:{value:_vm.filterVariablesInput,callback:function($$v){_vm.filterVariablesInput=$$v},expression:"filterVariablesInput"}})],1),_vm.variables?_c("div",{staticClass:"graphics-insert-variable-list"},[_c("ul",_vm._l(_vm.variables.filter((function(v){return!_vm.filterVariablesInput||v.name.toLowerCase().indexOf(_vm.filterVariablesInput.toLowerCase())>=0})),(function(v,index){return _c("li",{key:index,on:{click:function($event){action.data.parameter=action.data.parameter+" ${"+v.name+"}",_vm.showInsertVariablePopover=!1}}},[_vm._v(" "+_vm._s(v.displayName)+" ")])})),0)]):_vm._e()]),_c("el-tooltip",{staticClass:"item",attrs:{slot:"reference",effect:"dark",content:"Insert Variable",placement:"top"},slot:"reference"},[_c("el-button",{staticStyle:{padding:"2px 8px","font-size":"24px"},attrs:{icon:"el-icon-s-order",type:"text"}})],1)],1)],1)],1)],1),_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{staticClass:"mB10"},[_c("el-checkbox",{model:{value:action.data.dashboardFilters,callback:function($$v){_vm.$set(action.data,"dashboardFilters",$$v)},expression:"action.data.dashboardFilters"}},[_vm._v("Dashboard Filters")])],1)],1)],1)]:_vm._e()],2)],1)})),0)},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),objectSpread2=__webpack_require__(595082),defineProperty=__webpack_require__(482482),validation=(__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(434284),__webpack_require__(425728),__webpack_require__(648324),__webpack_require__(990260)),api=__webpack_require__(32284),ACTION_TYPES={FN:"function",CONTROL:"controlAction",LINK:"hyperLink",ANALYTIC:"showTrend",LISTVIEW:"showListView",REPORT:"showReport",NONE:"none"},CONTROL_TYPES={POINT:"point",GROUP:"group"},LINK_TYPES={URL:"url"},LINK_TARGET_TYPES={SELF:"self",BLANK:"_blank",POPUP:"popup"},LIST_TARGET_TYPES={SELF:"self",BLANK:"_blank",POPUP:"popup"},REPORT_TARGET_TYPES={SELF:"self",BLANK:"_blank",POPUP:"popup"},ACTION_CONFIG=(_ACTION_CONFIG={},(0,defineProperty/* default */.Z)(_ACTION_CONFIG,ACTION_TYPES.CONTROL,{actionName:"Control Action",actionType:ACTION_TYPES.CONTROL,data:{buttonLabel:"Set",controlType:CONTROL_TYPES.POINT,controlPointId:null,controlGroupId:null,label:null,assetId:null,fieldId:null}}),(0,defineProperty/* default */.Z)(_ACTION_CONFIG,ACTION_TYPES.LINK,{actionName:"Link To",actionType:ACTION_TYPES.LINK,data:{linkType:LINK_TYPES.URL,target:LINK_TARGET_TYPES.POPUP,url:null}}),(0,defineProperty/* default */.Z)(_ACTION_CONFIG,ACTION_TYPES.ANALYTIC,{actionName:"Show Trend",actionType:ACTION_TYPES.ANALYTIC,data:{}}),(0,defineProperty/* default */.Z)(_ACTION_CONFIG,ACTION_TYPES.LISTVIEW,{actionName:"Show Underlying List",actionType:ACTION_TYPES.LISTVIEW,data:{target:LIST_TARGET_TYPES.POPUP,view:"all"}}),(0,defineProperty/* default */.Z)(_ACTION_CONFIG,ACTION_TYPES.REPORT,{actionName:"Show Report",actionType:ACTION_TYPES.REPORT,data:{target:REPORT_TARGET_TYPES.POPUP,reportId:null,
// report: null,
type:1,moduleName:null,dashboardFilters:!1}}),(0,defineProperty/* default */.Z)(_ACTION_CONFIG,ACTION_TYPES.NONE,{actionName:"None",actionType:ACTION_TYPES.NONE,data:{}}),_ACTION_CONFIG),ActionsMixinvue_type_script_lang_js={props:["value","defaultType","elements","definedActionTypes","variables","moduleName"],data:function(){return{ACTION_TYPES:ACTION_TYPES,ACTION_CONFIG:ACTION_CONFIG,CONTROL_TYPES:CONTROL_TYPES,LINK_TYPES:LINK_TYPES,LINK_TARGET_TYPES:LINK_TARGET_TYPES,selectedActionType:this.defaultType||ACTION_TYPES.CONTROL,actionData:{},controlPoints:[],controlGroups:[],reportFolders:[],Kpiviews:[]}},created:function(){(0,validation/* isEmpty */.xb)(this.value)||this.init()},computed:{FILTERED_CONFIG:function(){var _this=this;if(this.definedActionTypes&&this.definedActionTypes.length){var config={};return this.definedActionTypes.forEach((function(rt){_this.$set(config,rt,ACTION_CONFIG[rt])})),config}return null}},methods:{init:function(){var actions=this.value,elements=this.elements,length=(elements||[]).length;0===length&&(length=1,elements=["default"]);for(var index=0;index<length;index++){var element=elements[index].name,action=actions[element]||{},params={};(0,validation/* isEmpty */.xb)(action)||(params=ACTION_CONFIG[action.actionType],this.loadRequiredData(action.actionType,action),this.loadpreReportdata(action.actionType,action)),this.$set(this.actionData,element,(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},params),action))}},onActionTypeChange:function(element,type){if(!(0,validation/* isEmpty */.xb)(element)){var ACTION_CONFIG=this.ACTION_CONFIG,params=this.$helpers.cloneObject(ACTION_CONFIG[type]);this.$set(this.actionData,element,(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},this.actionData[element]),params)),this.loadRequiredData(type)}},getElement:function(name){return this.elements.find((function(el){return el.name===name}))},loadpreReportdata:function(actionType,action){if(actionType===ACTION_TYPES.REPORT&&action.data.moduleName){var _action$data=action.data,type=_action$data.type,moduleName=_action$data.moduleName;1===type?this.loadReports(moduleName):2===type&&this.chooseReport(type)}},getlistview:function(){var _this2=this;if(this.moduleName){var url="/v2/views/viewList?moduleName=".concat(this.moduleName);api/* API */.bl.get(url).then((function(_ref){var data=_ref.data;_this2.Kpiviews=data.groupViews||[]}))}},loadRequiredData:function(actionType,action){(0,validation/* isEmpty */.xb)(action)||(0,validation/* isEmpty */.xb)(action.data)||(0,validation/* isEmpty */.xb)(action.data.assetId)?actionType===ACTION_TYPES.CONTROL?this.loadControlPoints():ACTION_TYPES.REPORT:(this.loadAssetControlPoints(action.data.assetId),this.loadControlGroups())},loadControlPoints:function(){var _this3=this;this.controlPoints=[],this.$http.get("/v2/controlAction/getControllablePoints").then((function(response){response.data.result&&response.data.result.controllablePoints&&(_this3.controlPoints=response.data.result.controllablePoints)})).catch((function(){})),this.controlGroups=[],this.$http.get("/v2/controlAction/getControlGroups").then((function(response){response.data.result&&response.data.result.controlActionGroups&&(_this3.controlGroups=response.data.result.controlActionGroups)})).catch((function(){}))},loadControlGroups:function(){var _this4=this;this.controlGroups=[],this.$http.get("/v2/controlAction/getControlGroups").then((function(response){response.data.result&&response.data.result.controlActionGroups&&(_this4.controlGroups=response.data.result.controlActionGroups)})).catch((function(){}))},setControlPoint:function(data){var cp=this.controlPoints.find((function(c){return c.id===data.controlPointId}));cp&&(data.assetId=cp.resourceId,data.fieldId=cp.fieldId,data.actionName=cp.resourceContext.name+" ("+cp.field.displayName+")")},setControlGroup:function(data){var cg=this.controlGroups.find((function(c){return c.id===data.groupId}));cg&&(data.actionName=cg.name)},associateControlPointAsset:function(data,resource,resourceType){data.label=resource.name,data.assetId=resource.id,data.controlPointId=null,this.loadAssetControlPoints(resource.id),this.showControlPointAssetPicker=!1},fetchControlPoints:function(action){var _action$data2,_this5=this,assetId=null!==action&&void 0!==action&&null!==(_action$data2=action.data)&&void 0!==_action$data2&&_action$data2.assetId?action.data.assetId:null,filters={};assetId&&this.$set(filters,"resourceId",{operatorId:9,value:[assetId+""]}),
// need to handle the querry data here.
// if (querry) {
//   this.$set(filters, 'resourceId', { operatorId: 9, value: [assetId + ''] })
// }
this.controlPoints=[],this.$http.get("/v2/controlAction/getControllablePoints?page=1&perPage=200&filters="+encodeURIComponent(JSON.stringify(filters))).then((function(response){response.data.result&&response.data.result.controllablePoints&&(_this5.controlPoints=response.data.result.controllablePoints)}))},loadAssetControlPoints:function(assetId){var _this6=this;if(assetId){var filters={resourceId:{operatorId:9,value:[assetId+""]}};this.controlPoints=[],this.$http.get("/v2/controlAction/getControllablePoints?filters="+encodeURIComponent(JSON.stringify(filters))).then((function(response){response.data.result&&response.data.result.controllablePoints&&(_this6.controlPoints=response.data.result.controllablePoints)}))}},chooseReport:function(type){this.reportFolders=[],2===type&&this.loadReports("energydata")},loadReports:function(moduleName){var _this7=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var _yield$API$get,data,error,_yield$API$get2,_data,_error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if("custommodule"!==moduleName){_context.next=9;break}return _context.next=3,api/* API */.bl.get("v3/report/folders?moduleName=custommodule");case 3:_yield$API$get=_context.sent,data=_yield$API$get.data,error=_yield$API$get.error,error||(_this7.reportFolders=data.reportFolders),_context.next=15;break;case 9:return _context.next=11,api/* API */.bl.get("v3/report/folders?moduleName=".concat(moduleName));case 11:_yield$API$get2=_context.sent,_data=_yield$API$get2.data,_error=_yield$API$get2.error,_error||(_this7.reportFolders=_data.reportFolders);case 15:case"end":return _context.stop()}}),_callee)})))()},getReportObj:function(reportId){
// let { data } = this.actionData.default
// this.reportFolders.forEach(folder => {
//   folder.reports.forEach(report => {
//     if (report.id === data.reportId) {
//       data.report = report
//     }
//   })
// })
}}},mixins_ActionsMixinvue_type_script_lang_js=ActionsMixinvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(mixins_ActionsMixinvue_type_script_lang_js,ActionsMixin_render,ActionsMixin_staticRenderFns,!1,null,null,null)
/* harmony default export */,ActionsMixin=component.exports,clone=__webpack_require__(766678),clone_default=__webpack_require__.n(clone),SpaceAssetChooser=__webpack_require__(372587),constant=__webpack_require__(354754),ActionPickervue_type_script_lang_js={props:["value","defaultType","elements","canShowActionType","definedActionTypes","ModuleName"],mixins:[ActionsMixin],components:{SpaceAssetChooser:SpaceAssetChooser/* default */.Z},data:function(){return{showControlPointAssetPicker:!1,showInsertVariablePopover:!1,filterVariablesInput:"",rules:{}}},computed:{moduleList:function(){return constant/* default */.Z.moduleList}},watch:{moduleName:function(){this.getlistview()}},mounted:function(){},methods:{save:function(){var cardDrilldown=clone_default()(this.actionData);this.$emit("input",cardDrilldown)}}},components_ActionPickervue_type_script_lang_js=ActionPickervue_type_script_lang_js,ActionPicker_component=(0,componentNormalizer/* default */.Z)(components_ActionPickervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,ActionPicker=ActionPicker_component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/96879.js.map