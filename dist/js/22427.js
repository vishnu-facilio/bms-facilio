"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[22427],{
/***/22427:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return TenantList}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/tenants/TenantList.vue?vue&type=template&id=56b46290&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.isSummaryOpen?_c("div",{staticClass:"height100"},[_vm.showLoading?_c("div",{staticClass:"flex-middle fc-empty-white"},[_c("spinner",{attrs:{show:_vm.showLoading,size:"80"}})],1):_c("div",{staticClass:"flex flex-row"},[_c("div",{staticClass:"cm-side-bar-container"},[_c("SummarySidebar",{attrs:{list:_vm.records,isLoading:_vm.isLoading,activeRecordId:_vm.selectedRecordId,total:_vm.recordCount,currentCount:(_vm.records||[]).length},on:{"update:isLoading":function($event){_vm.isLoading=$event},"update:is-loading":function($event){_vm.isLoading=$event}},scopedSlots:_vm._u([{key:"title",fn:function(){return[_c("el-row",{staticClass:"cm-sidebar-header"},[_c("el-col",{attrs:{span:2}},[_c("span",{on:{click:function($event){return _vm.openList()}}},[_c("inline-svg",{staticClass:"rotate-90 pointer",attrs:{src:"svgs/arrow",iconClass:"icon icon-sm"}})],1)]),_c("el-col",{attrs:{span:22}},[_c("div",{staticClass:"bold"},[_vm._v(_vm._s(_vm.currentViewDetail))])])],1)]},proxy:!0},{key:"default",fn:function(ref){var record=ref.record;return[_c("div",{staticClass:"cm-sidebar-list-item",on:{click:function($event){return _vm.redirectToOverview(record.id)}}},[_c("div",{staticClass:"text-fc-grey"},[_vm._v("#"+_vm._s(record["id"]))]),_c("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"top",animation:"shift-away",arrow:!0},expression:"{\n                placement: 'top',\n                animation: 'shift-away',\n                arrow: true,\n              }"}],staticClass:"f14 truncate-text bold mT5",attrs:{title:record[_vm.mainField.name]||"---"}},[_vm._v(" "+_vm._s(record[_vm.mainField.name]||"---")+" ")])])]}}],null,!1,4047170451)})],1),_c("div",{staticClass:"flex-1"},[_c("router-view")],1)])]):_c("CommonListLayout",{key:_vm.moduleName+"-list-layout",staticClass:"custom-module-list-layout",attrs:{moduleName:_vm.moduleName,showViewRearrange:!0,showViewEdit:!0,visibleViewCount:3,getPageTitle:function(){return _vm.moduleDisplayName},pathPrefix:_vm.parentPath,hideSubHeader:_vm.isEmpty(_vm.records),recordCount:_vm.recordCount,recordLoading:_vm.showLoading},scopedSlots:_vm._u([{key:"header",fn:function(){return[_c("AdvancedSearchWrapper",{key:_vm.moduleName+"-search",attrs:{moduleName:_vm.moduleName,moduleDisplayName:_vm.moduleDisplayName}}),_c("CustomButton",{staticClass:"custom-button ",attrs:{moduleName:_vm.moduleName,position:_vm.POSITION.LIST_TOP},on:{onSuccess:_vm.onCustomButtonSuccess,onError:function(){}}}),_vm.hasPermission("CREATE")?[_c("button",{staticClass:"fc-create-btn ",on:{click:function($event){return _vm.redirectToFormCreation()}}},[_vm._v(" "+_vm._s(_vm.$t("custommodules.list.new"))+" "+_vm._s(_vm.moduleDisplayName?_vm.moduleDisplayName:"")+" ")])]:_vm._e()]},proxy:!0},{key:"sub-header-actions",fn:function(){return[_vm.isEmpty(_vm.records)?_vm._e():[_c("pagination",{staticClass:"pL15 fc-black-small-txt-12",attrs:{total:_vm.recordCount,perPage:50,skipTotalCount:!0}}),_c("span",{staticClass:"separator"},[_vm._v("|")]),_c("el-tooltip",{attrs:{effect:"dark",content:_vm.$t("common._common.sort"),placement:"right"}},[_c("sort",{key:_vm.moduleName+"-sort",attrs:{config:_vm.sortConfig,sortList:_vm.sortConfigLists},on:{onchange:_vm.updateSort}})],1),_vm.hasPermission("EXPORT")?_c("span",{staticClass:"separator"},[_vm._v("|")]):_vm._e(),_vm.hasPermission("EXPORT")?_c("el-tooltip",{attrs:{effect:"dark",content:_vm.$t("common._common.export"),placement:"left"}},[_c("f-export-settings",{attrs:{module:_vm.moduleName,viewDetail:_vm.viewDetail,showViewScheduler:!1,showMail:!1,filters:_vm.filters}})],1):_vm._e()]]},proxy:!0},{key:"content",fn:function(){return[_vm.showLoading?_c("Spinner",{staticClass:"mT40",attrs:{show:_vm.showLoading}}):_vm._e(),_vm.$validation.isEmpty(_vm.records)&&!_vm.showLoading?_c("div",{staticClass:"cm-empty-state-container"},[_c("img",{staticClass:"mT20 self-center",attrs:{src:__webpack_require__(15482),width:"100",height:"100"}}),_c("div",{staticClass:"mT10 label-txt-black f14 self-center"},[_vm._v(" "+_vm._s(_vm.emptyStateText)+" ")])]):_vm._e(),_vm.showLoading||_vm.$validation.isEmpty(_vm.records)?_vm._e():[_c("div",{staticClass:"cm-list-container"},[_c("div",{staticClass:"column-customization-icon",on:{click:function($event){_vm.showColumnSettings=!0}}},[_c("img",{staticClass:"text-center position-absolute icon",attrs:{src:__webpack_require__(266707)}})]),_vm.$validation.isEmpty(_vm.selectedListItemsIds)?_vm._e():_c("div",{staticClass:"pull-left table-header-actions"},[_c("div",{staticClass:"action-btn-slide btn-block"},[_c("button",{staticClass:"btn btn--tertiary pointer",on:{click:function($event){return _vm.deleteRecords(_vm.selectedListItemsIds)}}},[_vm._v(" "+_vm._s(_vm.$t("custommodules.list.delete"))+" ")])]),_c("CustomButton",{key:_vm.moduleName+"_"+_vm.viewname+"_"+_vm.POSITION.LIST_BAR,staticClass:"custom-button margin-left-80",attrs:{modelDataClass:_vm.modelDataClass,moduleName:_vm.moduleName,position:_vm.POSITION.LIST_BAR,selectedRecords:_vm.selectedListItemsObj},on:{onSuccess:_vm.onCustomButtonSuccess,onError:function(){}}})],1),_c("CommonList",{attrs:{viewDetail:_vm.viewDetail,records:_vm.records,moduleName:_vm.moduleName,redirectToOverview:_vm.redirectToOverview,slotList:_vm.slotList,canShowCustomButton:"true",refreshList:_vm.onCustomButtonSuccess},on:{"selection-change":_vm.selectItems},scopedSlots:_vm._u([{key:_vm.slotList[0].criteria,fn:function(ref){var record=ref.record;return[_c("div",{staticClass:"d-flex",on:{click:function($event){return _vm.redirectToOverview(record.id)}}},[_c("tenant-avatar",{attrs:{name:!1,size:"md",tenant:record}}),_c("el-tooltip",{attrs:{effect:"dark",content:record.name||"---",placement:"top","open-delay":600}},[_c("div",{staticClass:"self-center mL5  main-field-column"},[_vm._v(" "+_vm._s(record.name||"---")+" ")])])],1)]}},{key:_vm.slotList[1].name,fn:function(ref){var record=ref.record;return[_c("div",{staticClass:"d-flex text-center"},[_vm.hasPermission("EDIT")?_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-edit pointer edit-icon-color visibility-hide-actions mL10",attrs:{"data-arrow":"true",title:_vm.$t("common._common.edit")},on:{click:function($event){return _vm.editModule(record)}}}):_vm._e(),_vm.hasPermission("DELETE")?_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-delete pointer edit-icon-color visibility-hide-actions mL10",attrs:{"data-arrow":"true",title:_vm.$t("common._common.delete")},on:{click:function($event){return _vm.deleteRecords([record.id])}}}):_vm._e()])]}},{key:_vm.slotList[2].name,fn:function(ref){var record=ref.record;return[_c("div",{staticClass:"fc-id"},[_vm._v(" "+_vm._s("#"+record.id)+" ")])]}}],null,!0)})],1),_c("column-customization",{attrs:{visible:_vm.showColumnSettings,moduleName:_vm.moduleName,viewName:_vm.viewname},on:{"update:visible":function($event){_vm.showColumnSettings=$event}}})]]},proxy:!0}])},[_c("portal",{attrs:{to:"view-manager-link"}},[_c("div",{staticClass:"view-manager-btn",on:{click:_vm.redirectToViewManager}},[_c("inline-svg",{staticClass:"d-flex",attrs:{src:"svgs/hamburger-menu",iconClass:"icon icon-sm"}}),_c("span",{staticClass:"label mL10 text-uppercase"},[_vm._v(" "+_vm._s(_vm.$t("viewsmanager.list.views_manager"))+" ")])],1)])],1)},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),objectSpread2=__webpack_require__(595082),vuex_esm=(__webpack_require__(648324),__webpack_require__(564043),__webpack_require__(61514),__webpack_require__(169358),__webpack_require__(634338),__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(434284),__webpack_require__(947522),__webpack_require__(670560),__webpack_require__(450886),__webpack_require__(420629)),ViewMixin=__webpack_require__(453877),validation=__webpack_require__(990260),ColumnCustomization=__webpack_require__(490966),Spinner=__webpack_require__(604947),CommonLayout=__webpack_require__(951478),ListPagination=__webpack_require__(890608),FExportSettings=__webpack_require__(641435),Sort=__webpack_require__(487390),router=__webpack_require__(329435),SummarySideBar=__webpack_require__(105402),CommonList=__webpack_require__(820920),isEqual=__webpack_require__(618446),isEqual_default=__webpack_require__.n(isEqual),CustomButton=__webpack_require__(623857),CustomButtonUtil=__webpack_require__(746095),CustomModuleData=__webpack_require__(689565),Tenant=__webpack_require__(6840),CustomModuleList=__webpack_require__(668931),AdvancedSearchWrapper=__webpack_require__(207001),TenantListvue_type_script_lang_js={name:"tenant",props:["moduleName","viewname"],mixins:[ViewMixin/* default */.Z],extends:{CustomModuleList:CustomModuleList/* default */.Z},components:{ColumnCustomization:ColumnCustomization/* default */.Z,Spinner:Spinner/* default */.Z,CommonListLayout:CommonLayout/* default */.Z,Pagination:ListPagination/* default */.Z,FExportSettings:FExportSettings/* default */.Z,Sort:Sort/* default */.Z,AdvancedSearchWrapper:AdvancedSearchWrapper/* default */.Z,SummarySidebar:SummarySideBar/* default */.Z,CommonList:CommonList/* default */.Z,CustomButton:CustomButton/* default */.Z,TenantAvatar:Tenant/* default */.Z},data:function(){return{selectedListItemsIds:[],selectedListItemsObj:[],showColumnSettings:!1,sortConfig:{orderBy:{label:"System Created Time",value:"sysCreatedTime"},orderType:"desc"},sortConfigLists:[],recordCount:"",isLoading:!1,records:null,POSITION:CustomButtonUtil/* POSITION_TYPE */.Rz,canShowListView:!0,isEmpty:validation/* isEmpty */.xb}},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({viewDetail:function(state){return state.view.currentViewDetail},isViewLoading:function(state){return state.view.isLoading},metaInfo:function(state){return state.view.metaInfo}})),{},{slotList:function(){return[{criteria:JSON.stringify({name:"name"})},{name:"editDelete",isActionColumn:!0,columnAttrs:{width:130,class:"visibility-visible-actions",fixed:"right"}},{name:"id",isHardcodedColumn:!0,columnAttrs:{"min-width":90,label:"ID",fixed:"left"}}]},moduleDisplayName:function(){var _this$metaInfo;return null===(_this$metaInfo=this.metaInfo)||void 0===_this$metaInfo?void 0:_this$metaInfo.displayName},parentPath:function(){return"/app/tm/tenants/"},showLoading:function(){return this.isLoading||this.isViewLoading},page:function(){var $route=this.$route,_ref=$route||{},page=_ref.query.page;return page||1},filters:function(){var $route=this.$route,_ref2=$route||{},search=_ref2.query.search;return(0,validation/* isEmpty */.xb)(search)?null:JSON.parse(this.$route.query.search)},isV3Api:function(){return!0},selectedRecordId:function(){var id=this.$getProperty(this,"$route.params.id");return id?parseInt(id):-1},isSummaryOpen:function(){return!(0,validation/* isEmpty */.xb)(this.selectedRecordId)},currentViewDetail:function(){var viewDetail=this.viewDetail,filters=this.filters;return filters?this.$t("custommodules.list.filtered_view"):viewDetail.displayName},emptyStateText:function(){var moduleDisplayName=this.moduleDisplayName,moduleName=this.moduleName;return moduleDisplayName=moduleDisplayName||moduleName,"".concat(this.$t("custommodules.list.no")," ").concat(moduleDisplayName," ").concat(this.$t("custommodules.list.available"),".")},mainField:function(){var viewColumns=this.viewColumns;return(0,validation/* isEmpty */.xb)(viewColumns)?{}:viewColumns.find((function(column){return"name"===column.name}))}}),watch:{viewname:{handler:function(newVal,oldVal){(0,validation/* isEmpty */.xb)(newVal)||isEqual_default()(newVal,oldVal)||(this.loadRecords(),this.getViewDetail())},immediate:!0},metaInfo:{handler:function(value){var fields=value.fields;(0,validation/* isEmpty */.xb)(fields)||this.constructSortConfig(fields)},immediate:!0},moduleName:function(newVal,oldVal){isEqual_default()(newVal,oldVal)||this.loadRecords()},filters:function(newVal,oldVal){isEqual_default()(newVal,oldVal)||this.loadRecords()},viewDetail:function(newVal,oldVal){if(!isEqual_default()(newVal,oldVal)){var _ref3=newVal||{},_ref3$sortFields=_ref3.sortFields,sortFields=void 0===_ref3$sortFields?[]:_ref3$sortFields;if(!(0,validation/* isEmpty */.xb)(sortFields)){var name=this.$getProperty(sortFields[0],"sortField.name",null),isAscending=this.$getProperty(sortFields[0],"isAscending",null);(0,validation/* isEmpty */.xb)(name)||(0,validation/* isEmpty */.xb)(isAscending)||(this.sortConfig={orderType:isAscending?"asc":"desc",orderBy:name||""})}}},page:function(newVal,oldVal){isEqual_default()(newVal,oldVal)||this.loadRecords()},sortConfig:function(newVal,oldVal){isEqual_default()(newVal,oldVal)||this.loadRecords()}},methods:{getViewDetail:function(){var viewname=this.viewname,moduleName=this.moduleName;this.$store.dispatch("view/loadViewDetail",{viewName:viewname,moduleName:moduleName})},constructSortConfig:function(fields){var configArr=[];fields.forEach((function(field){configArr.push(field.name)})),this.$set(this,"sortConfigLists",configArr)},updateSort:function(sorting){var _this=this,moduleName=this.moduleName,viewname=this.viewname,sortObj={moduleName:moduleName,viewName:viewname,orderBy:sorting.orderBy,orderType:sorting.orderType,skipDispatch:!0};this.$store.dispatch("view/savesorting",sortObj).then((function(){return _this.loadRecords(!0)}))},selectItems:function(selectedItem){this.selectedListItemsObj=selectedItem,this.selectedListItemsIds=selectedItem.map((function(value){return value.id}))},loadRecords:function(){var _arguments=arguments,_this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var force,moduleName,viewname,filters,page,params;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return force=_arguments.length>0&&void 0!==_arguments[0]&&_arguments[0],_context.prev=1,moduleName=_this2.moduleName,viewname=_this2.viewname,filters=_this2.filters,page=_this2.page,params={moduleName:moduleName,viewname:viewname,filters:filters,page:page,force:force,withCount:!0,fetchOnlyViewGroupColumn:!1},_this2.isLoading=!0,_context.next=7,CustomModuleData/* CustomModuleData */.u.fetchAll(params);case 7:_this2.records=_context.sent,_this2.recordCount=CustomModuleData/* CustomModuleData */.u.recordListCount,_context.next=14;break;case 11:_context.prev=11,_context.t0=_context["catch"](1),_this2.$message.error(_context.t0);case 14:_this2.isLoading=!1;case 15:case"end":return _context.stop()}}),_callee,null,[[1,11]])})))()},deleteRecords:function(idList){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var moduleDisplayName,moduleName,value;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return moduleDisplayName=_this3.moduleDisplayName,moduleName=_this3.moduleName,_context2.next=3,_this3.$dialog.confirm({title:"".concat(_this3.$t("custommodules.list.delete")," ").concat(moduleDisplayName),message:"".concat(_this3.$t("custommodules.list.delete_confirmation")," ").concat(moduleDisplayName,"?"),rbDanger:!0,rbLabel:_this3.$t("custommodules.list.delete")});case 3:if(value=_context2.sent,!value){_context2.next=20;break}return _this3.isLoading=!0,_context2.prev=6,_context2.next=9,CustomModuleData/* CustomModuleData */.u.delete(moduleName,idList);case 9:return _this3.$message.success("".concat(moduleDisplayName," ").concat(_this3.$t("custommodules.list.delete_success"))),_context2.next=12,_this3.loadRecords();case 12:_this3.selectedListItemsIds=[],_this3.selectedListItemsObj=[],_context2.next=19;break;case 16:_context2.prev=16,_context2.t0=_context2["catch"](6),_this3.$message.error(_context2.t0);case 19:_this3.isLoading=!1;case 20:case"end":return _context2.stop()}}),_callee2,null,[[6,16]])})))()},hasPermission:function(action){return this.$hasPermission("".concat(this.moduleName,":").concat(action))},
// route redirection handling
openList:function(){var viewname=this.viewname;if((0,router/* isWebTabsEnabled */.tj)()){var _ref4=(0,router/* findRouteForModule */.Jp)(this.moduleName,router/* pageTypes */.As.LIST)||{},name=_ref4.name;name&&this.$router.push({name:name,params:{viewname:viewname},query:this.$route.query})}else this.$router.push({name:"tenant-list",params:{viewname:viewname},query:this.$route.query})},redirectToOverview:function(id){var moduleName=this.moduleName,viewname=this.viewname;if((0,router/* isWebTabsEnabled */.tj)()){var _ref5=(0,router/* findRouteForModule */.Jp)(moduleName,router/* pageTypes */.As.OVERVIEW)||{},name=_ref5.name;name&&this.$router.push({name:name,params:{viewname:viewname,id:id},query:this.$route.query})}else this.$router.push({path:"/app/tm/tenants/".concat(viewname,"/").concat(id,"/overview"),query:this.$route.query})},editModule:function(row){var moduleName=this.moduleName,id=row.id;if((0,router/* isWebTabsEnabled */.tj)()){var _ref6=(0,router/* findRouteForModule */.Jp)(moduleName,router/* pageTypes */.As.EDIT)||{},name=_ref6.name;name&&this.$router.push({name:name,params:{id:id}})}else this.$router.push({name:"tenant-edit",params:{id:id}})},redirectToViewManager:function(){var moduleName=this.moduleName;if((0,router/* isWebTabsEnabled */.tj)()){var _ref7=(0,router/* findRouteForModule */.Jp)(moduleName,router/* pageTypes */.As.VIEW_MANAGER)||{},name=_ref7.name;name&&this.$router.push({name:name,params:{moduleName:moduleName}})}else this.$router.push({name:"tm-viewmanager",params:{moduleName:moduleName}})},redirectToFormCreation:function(){var moduleName=this.moduleName;if((0,router/* isWebTabsEnabled */.tj)()){var _ref8=(0,router/* findRouteForModule */.Jp)(moduleName,router/* pageTypes */.As.CREATE)||{},name=_ref8.name;name&&this.$router.push({name:name})}else this.$router.push({name:"tenant-new"})},onCustomButtonSuccess:function(){this.loadRecords(),this.selectedListItemsIds=[],this.selectedListItemsObj=[]}}},tenants_TenantListvue_type_script_lang_js=TenantListvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(tenants_TenantListvue_type_script_lang_js,render,staticRenderFns,!1,null,"56b46290",null)
/* harmony default export */,TenantList=component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/22427.js.map