"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[4912],{
/***/834483:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return BuildingReadings}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/setup/v1/BuildingReadings.vue?vue&type=template&id=3dee23a1
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"height100 user-layout setup-readings"},[_c("div",{staticClass:"fc-setup-header",staticStyle:{height:"183px"}},[_vm._m(0),_c("div",{staticClass:"action-btn setting-page-btn fR"},[_c("el-button",{staticClass:"setup-el-btn",attrs:{type:"primary"},on:{click:function($event){_vm.showDialog=!0}}},[_vm._v("New Building Reading")]),_vm.showDialog?_c("new-building-reading",{attrs:{resourceType:"Building",visibility:_vm.showDialog},on:{saved:_vm.aftersave,"update:visibility":function($event){_vm.showDialog=$event}}}):_vm._e()],1),_c("div",{staticClass:"clearboth flex-middle pT20 justify-content-space width100"},[_c("div",[_c("el-select",{staticClass:"fc-input-full-border2 space-reading-link",attrs:{placeholder:"Select Readings"},on:{change:_vm.readingSpaceAssetChoosing},model:{value:_vm.readinglist,callback:function($$v){_vm.readinglist=$$v},expression:"readinglist"}},[_c("el-option",{attrs:{label:"Asset Readings",value:"assetreadings"}},[_vm._v(" Asset Readings ")]),_c("el-option",{attrs:{label:"Space Readings",value:"spacereadings"}},[_vm._v(" Space Readings ")]),_c("el-option",{attrs:{label:"Weather Readings",value:"weatherreadings"}},[_vm._v(" Weather Readings ")])],1),_c("el-select",{staticClass:"fc-input-full-border2 space-reading-link mL20",attrs:{placeholder:"Select Readings"},on:{change:_vm.assetReadingChooser},model:{value:_vm.readingFilter,callback:function($$v){_vm.readingFilter=$$v},expression:"readingFilter"}},[_c("el-option",{attrs:{label:"Site",value:"site"}},[_vm._v(" Site ")]),_c("el-option",{attrs:{label:"Building",value:"building"}},[_vm._v(" Building ")]),_c("el-option",{attrs:{label:"Floor",value:"floor"}},[_vm._v(" Floor ")]),_c("el-option",{attrs:{label:"Space",value:"space"}},[_vm._v(" Space ")])],1)],1),_c("div",[_c("f-search",{staticClass:"reading-search",model:{value:_vm.buildingReadingFields,callback:function($$v){_vm.buildingReadingFields=$$v},expression:"buildingReadingFields"}})],1)]),_c("div",{staticClass:"mT15"},[_c("el-tabs",{staticClass:"width100 setup-reading-tab",on:{"tab-click":_vm.readingsTabChange},model:{value:_vm.selectedtab,callback:function($$v){_vm.selectedtab=$$v},expression:"selectedtab"}},_vm._l(_vm.tabs,(function(tab){return _c("el-tab-pane",{key:tab.key,attrs:{label:tab.label,name:tab.key}},[_c("div",{staticClass:"container-scroll"},[_c("div",{},[_c("div",{staticClass:"col-lg-12 col-md-12"},[_c("table",{staticClass:"setting-list-view-table width100"},[_c("thead",[_c("tr",[_c("th",{staticClass:"setting-table-th setting-th-text"},[_vm._v(" SITE NAME ")]),_c("th",{staticClass:"setting-table-th setting-th-text"},[_vm._v(" BUILDING NAME ")]),_c("th",{staticClass:"setting-table-th setting-th-text"},[_vm._v(" Reading NAME ")]),_c("th",{staticClass:"setting-table-th setting-th-text"},[_vm._v(" Reading TYPE ")]),_c("th")])]),_vm.loading?_c("tbody",[_c("tr",[_c("td",{staticClass:"text-center",attrs:{colspan:"100%"}},[_c("spinner",{attrs:{show:_vm.loading,size:"80"}})],1)])]):0===_vm.buildingReadingFields.length?_c("tbody",[_c("tr",[_c("td",{staticStyle:{"text-align":"center"},attrs:{colspan:"100%"}},[_vm._v(" NO DATA ")])])]):_c("tbody",_vm._l(_vm.buildingReadingFields,(function(field,index){return _c("tr",{key:index,staticClass:"tablerow"},[_c("td",[_vm._v(" "+_vm._s(field.siteName)+" ")]),_c("td",[_vm._v(" "+_vm._s(field.spaceId)+" ")]),_c("td",[_vm._v(" "+_vm._s(field.displayName)+" ")]),_c("td",[_vm._v(" "+_vm._s(field.counterField?"Counter":_vm.$constants.dataType[field.dataType])+" ")]),_c("td",{staticStyle:{width:"30%"}},[_c("div",{staticClass:"text-left actions",staticStyle:{"margin-top":"-3px","margin-right":"15px","text-align":"center"}},[_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-edit pointer",attrs:{title:"Edit Reading"},on:{click:function($event){return _vm.editReadingField(field)}}})])])])})),0)])])])])])})),1)],1)]),_vm.editshowDialog?_c("edit-reading",{attrs:{model:_vm.model,visibility:_vm.editshowDialog,unitDetails:_vm.metricsUnits,resourceType:"buildings"},on:{"update:visibility":function($event){_vm.editshowDialog=$event},saved:_vm.aftersave}}):_vm._e()],1)},staticRenderFns=[function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"setting-title-block fL"},[_c("div",{staticClass:"setting-form-title"},[_vm._v("Building Readings")]),_c("div",{staticClass:"heading-description"},[_vm._v(" List of all building related readings ")])])}],NewBuildingReadingvue_type_template_id_80126df4_render=(__webpack_require__(434284),__webpack_require__(670560),function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticStyle:{"z-index":"999999"},attrs:{visible:_vm.visibility,fullscreen:!0,"append-to-body":!0,"custom-class":"fc-dialog-form fc-dialog-right setup-dialog45 setup-dialog","before-close":_vm.closeDialog},on:{"update:visible":function($event){_vm.visibility=$event}}},[_c("el-form",{ref:"newBuildingReadingForm",attrs:{model:_vm.model,"label-position":"top"}},[_c("div",{staticClass:"new-header-container"},[_c("div",{staticClass:"new-header-modal"},[_c("div",{staticClass:"new-header-text"},[_c("div",{staticClass:"setup-modal-title"},[_vm._v("New Building Reading")])])])]),_c("div",{staticClass:"new-body-modal mT20"},[_c("el-row",[_c("el-col",{attrs:{span:12}},[0!==_vm.siteListOptions.length?_c("div",[_c("div",{staticClass:"label-txt-black pB10"},[_vm._v("Select Site")]),_c("el-select",{staticClass:"width250px fc-input-full-border-select2",attrs:{filterable:"",clearable:"",placeholder:"Select Site"},on:{change:_vm.clearList},model:{value:_vm.model.parentName,callback:function($$v){_vm.$set(_vm.model,"parentName",$$v)},expression:"model.parentName"}},_vm._l(_vm.siteListOptions,(function(option,index){return _c("el-option",{key:index,attrs:{label:option,value:index}})})),1)],1):_vm._e()]),_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"label-txt-black pB10"},[_vm._v("Select Building")]),_c("el-select",{staticClass:"width250px fc-input-full-border-select2",attrs:{filterable:"",clearable:"",placeholder:"Select Building"},model:{value:_vm.model.buildingId,callback:function($$v){_vm.$set(_vm.model,"buildingId",$$v)},expression:"model.buildingId"}},_vm._l(_vm.buildingListOptions,(function(building){return _c("el-option",{key:building.id,attrs:{label:building.name,value:building.id}})})),1)],1)],1),_c("div",[_c("f-module-builder",{attrs:{isNew:_vm.isNew,settingsIcon:!1},on:{input:_vm.input},model:{value:_vm.model,callback:function($$v){_vm.model=$$v},expression:"model"}})],1)],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){return _vm.closeDialog()}}},[_vm._v("Cancel")]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:_vm.save}},[_vm._v("Save")])],1)])],1)}),NewBuildingReadingvue_type_template_id_80126df4_staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),NewFmoduleBuilder=__webpack_require__(28651),picklist=__webpack_require__(961358),NewBuildingReadingvue_type_script_lang_js={props:["data","visibility"],components:{FModuleBuilder:NewFmoduleBuilder/* default */.Z},data:function(){return{isNew:!0,formTitle:"New Asset Reading",categoryList:[],dataTypeEnum:["Text","Number","Decimal","Boolean"],model:{parentName:"",moduleName:"",buildingId:"",fields:[{displayName:"",dataType:3,dataTypeTemp:3,counterField:!1}]},siteListOptions:{},buildingListOptions:{}}},created:function(){this.$store.dispatch("loadBuildings")},mounted:function(){this.init()},watch:{"model.parentName":function(siteId){var _this=this;this.$util.loadSpace(2,null,[{key:"site",value:siteId}]).then((function(response){_this.buildingListOptions=response.basespaces}))}},methods:{init:function(){this.loadPickLists()},closeDialog:function(ruleForm){this.$emit("update:visibility",!1);
// this.$refs[ruleForm].resetFields()
},loadPickLists:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var _yield$getFieldOption,siteError,siteOptions,_yield$getFieldOption2,buildingError,buildingOptions;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _this2.siteListOptions={},_context.next=3,(0,picklist/* getFieldOptions */._K)({field:{lookupModuleName:"site",skipDeserialize:!0}});case 3:return _yield$getFieldOption=_context.sent,siteError=_yield$getFieldOption.error,siteOptions=_yield$getFieldOption.options,siteError?_this2.$message.error(siteError.message||"Error Occured"):_this2.siteListOptions=siteOptions,_this2.buildingListOptions={},_context.next=10,(0,picklist/* getFieldOptions */._K)({field:{lookupModuleName:"building",skipDeserialize:!0}});case 10:_yield$getFieldOption2=_context.sent,buildingError=_yield$getFieldOption2.error,buildingOptions=_yield$getFieldOption2.options,buildingError?_this2.$message.error(buildingError.message||"Error Occured"):_this2.buildingListOptions=buildingOptions;case 14:case"end":return _context.stop()}}),_callee)})))()},clearList:function(){""===this.model.parentName&&(this.model.buildingId="")},input:function(val){this.model.fields=val.fields},cancel:function(){this.$emit("canceled")},save:function(){var formModel=this.model,self=this;self.$http.post("/reading/addsetupreading",{resourceType:"Building",fieldJsons:self.model.fields,parentCategoryId:formModel.buildingId,readingName:self.model.fields[0].displayName}).then((function(response){response.data;self.$message.success(" New Reading added Successfully."),self.$refs.newBuildingReadingForm.buildingId="",self.$refs.newBuildingReadingForm.fields=[],self.$emit("saved"),self.closeDialog()}))}}},v1_NewBuildingReadingvue_type_script_lang_js=NewBuildingReadingvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(v1_NewBuildingReadingvue_type_script_lang_js,NewBuildingReadingvue_type_template_id_80126df4_render,NewBuildingReadingvue_type_template_id_80126df4_staticRenderFns,!1,null,null,null)
/* harmony default export */,NewBuildingReading=component.exports,EditAssetReadingDialog=__webpack_require__(18903),FSearch=__webpack_require__(947748),ReadingsHelper=__webpack_require__(414577),BuildingReadingsvue_type_script_lang_js={title:function(){return"Asset Reading"},mixins:[ReadingsHelper/* default */.Z],components:{NewBuildingReading:NewBuildingReading,EditReading:EditAssetReadingDialog/* default */.Z,FSearch:FSearch/* default */.Z},data:function(){return{metricsUnits:null,loading:!0,model:{},buildingReadingFields:[],loadForm:!1,
// showNewReading: false,
editshowDialog:!1,selectedtab:"connected",tabs:[{key:"connected",label:"Connected"},{key:"formula",label:"Formula"},{key:"available",label:"Available"}],showDialog:!1,readinglist:"spacereadings",readingFilter:"building"}},mounted:function(){this.loadDefaultMetricUnits(),this.getBuildingReadings()},methods:{aftersave:function(){this.buildingReadingFields=[],this.getBuildingReadings()},getBuildingReadings:function(){var self=this,type="Buildings";this.loading=!0,self.buildingReadingFields=[],self.$http.post("/reading/getallspacetypereadings?readingType=".concat(this.selectedtab),{spaceType:type,readingType:this.selectedtab}).then((function(response){for(var buildingName in response.data.moduleMap){var moduleJson=response.data.moduleMap[buildingName];for(var moduleIndex in moduleJson){var readingFields=moduleJson[moduleIndex].fields;for(var fieldIndex in readingFields){var field=readingFields[fieldIndex];"-1"===buildingName?(field["spaceId"]="All Buildings",field.siteName="-"):(field["spaceId"]=response.data.spaces[buildingName].name,field.siteName=response.data.spaces[buildingName].site.name),self.buildingReadingFields.push(field)}}}self.loading=!1}))},editReadingField:function(field){this.model.fields=[field],this.editshowDialog=!0},newBuildingReadingDialog:function(){this.$refs.NewBuildingReading.open()},readingsTabChange:function(){this.getBuildingReadings()},loadDefaultMetricUnits:function(){var self=this;self.$http.get("/units/getDefaultMetricUnits").then((function(response){self.metricsUnits=response.data}))}}},v1_BuildingReadingsvue_type_script_lang_js=BuildingReadingsvue_type_script_lang_js,BuildingReadings_component=(0,componentNormalizer/* default */.Z)(v1_BuildingReadingsvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,BuildingReadings=BuildingReadings_component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/4912.js.map