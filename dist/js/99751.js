(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[99751],{
/***/499751:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return FLookupFieldWizard}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/FLookupFieldWizard.vue?vue&type=template&id=5e866684
var CommonRelatedList_render,CommonRelatedList_staticRenderFns,render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"fc-dialog-center-container f-lookup-wizard scale-up-center fc-wizard-table-width100",attrs:{visible:_vm.canShowWizard,width:"70%",top:"5vh","append-to-body":!0,"show-close":!1,"before-close":_vm.closeWizard},on:{"update:visible":function($event){_vm.canShowWizard=$event}}},[_c("template",{slot:"title"},[_c("div",{staticClass:"header d-flex"},[_vm.resourceModule?_c("div",{staticClass:"el-dialog__title self-center pointer d-flex"},[_c("div",{class:["mR20",{"font-hairline":"space"!==_vm.resourceSubModuleName}],on:{click:function($event){return _vm.onTabSwitch("space")}}},[_vm._v(" "+_vm._s(_vm.$t("common.space_asset_chooser.space"))+" ")]),_c("div",{class:{"font-hairline":"asset"!==_vm.resourceSubModuleName,disabled:_vm.disableTabSwitch},on:{click:function($event){return _vm.onTabSwitch("asset")}}},[_vm._v(" "+_vm._s(_vm.$t("common._common.asset"))+" ")])]):_c("div",{staticClass:"el-dialog__title self-center"},[_vm._v(" "+_vm._s(_vm.title)+" ")]),_c("div",{staticClass:"mL-auto d-flex"},[_vm.showSearch?[_c("el-tooltip",{attrs:{effect:"dark",content:_vm.$t("common._common.search"),placement:"left"}},[_c("SearchComponent",{key:_vm.moduleName+"-search",staticClass:"self-center mL-auto lookup-wizard-search",attrs:{moduleName:_vm.moduleName,searchMetaInfo:_vm.moduleMetaInfo,hideOperatorDialog:!0,singleFieldSearch:!0,clearFilters:_vm.clearAllFilters},on:{onChange:_vm.applyFilter,clearedFilters:function($event){_vm.clearAllFilters=!1}}})],1),_vm.$validation.isEmpty(_vm.wizardFilterValue)?_vm._e():_c("el-tooltip",{attrs:{effect:"dark",content:"Clear Filters",placement:"right"}},[_c("span",{staticClass:"self-center",on:{click:function($event){return _vm.clearFilter()}}},[_c("img",{staticStyle:{position:"relative",top:"4px",left:"10px"},attrs:{src:__webpack_require__(644634),width:"20px",height:"20px"}})])]),_c("span",{staticClass:"separator self-center"},[_vm._v("|")])]:_vm._e(),!_vm.hidePaginationSearch&&_vm.totalCount>0?[_c("pagination",{staticClass:"self-center",staticStyle:{"margin-right":"-10px"},attrs:{currentPage:_vm.page,total:_vm.totalCount,perPage:_vm.perPage},on:{"update:currentPage":function($event){_vm.page=$event},"update:current-page":function($event){_vm.page=$event}}}),_c("span",{staticClass:"separator self-center"},[_vm._v("|")])]:_vm._e(),(_vm.selectedLookupField||{}).allowCreate&&!_vm.isLoading?[_c("span",{staticClass:"self-center"},[_c("el-button",{staticClass:"fc-create-btn",on:{click:_vm.quickAddRecordToggle}},[_c("i",{staticClass:"el-icon-plus"})])],1),_c("span",{staticClass:"separator self-center"},[_vm._v("|")])]:_vm._e(),_c("div",{staticClass:"close-btn self-center cursor-pointer",class:_vm.hidePaginationSearch?"mL-auto pL10":"",on:{click:_vm.closeWizard}},[_c("i",{staticClass:"el-dialog__close el-icon el-icon-close"})])],2)])]),_c("div",[_vm.isLoading?_c("div",{staticClass:"loading-container d-flex justify-content-center height550px"},[_c("Spinner",{attrs:{show:_vm.isLoading}})],1):_c("div",{staticClass:"height550 fc__layout__has__row"},[_c("div",{staticClass:"lookup-wizard-scroll"},[_vm.resourceModule||_vm.showFilters?_c("div",{staticClass:"d-flex pT20 pB20"},[_vm._l(_vm.quickFilters,(function(field,index){return[_c("FLookupField",{key:index,staticClass:"quick-filter",attrs:{model:field.value,hideLookupIcon:!0,field:field,disabled:field.disabled,fetchOptionsOnLoad:!0,preHookFilterConstruction:_vm.resourceFilterConstruction},on:{"update:model":function($event){return _vm.$set(field,"value",$event)},recordSelected:function(value){return _vm.setLookUpFilter(field,value)}}})]}))],2):_vm._e(),_vm.$validation.isEmpty(_vm.selectedItem)?_vm._e():_c("div",{staticClass:"pT20 pL20 pB10 fc-black-color letter-spacing0_5 f13 bold d-flex items-baseline flex-direction-row flex-wrap"},[[_c("div",{staticClass:"mR10 mB10 mT5 flex-shrink-0"},[_vm._v(_vm._s(_vm.selectedLabel))]),_vm._l(_vm.selectedItemName,(function(name,index){return _c("div",{key:index,staticClass:"action-badge mR10 mb5"},[_vm._v(" "+_vm._s(name)+" "),_vm.multiSelect?_c("i",{staticClass:"el-icon-close pointer",on:{click:function($event){return _vm.handleClose(name)}}}):_vm._e()])}))]],2),_c("div",{staticClass:"fc-list-view fc-table-td-height fc-list-table-container fc-table-viewchooser overflow-scroll pB30"},[_vm.isSearchDataLoading?_c("div",{staticClass:"loading-container d-flex justify-content-center height550px"},[_c("Spinner",{attrs:{show:_vm.isSearchDataLoading}})],1):[_c("el-table",{ref:"listTable",staticStyle:{width:"100%"},attrs:{data:_vm.modulesList,fit:!0,height:"100%"},on:{"selection-change":_vm.handleSelection}},[_c("template",{slot:"empty"},[_c("img",{staticClass:"mT20",attrs:{src:__webpack_require__(15482),width:"100",height:"100"}}),_c("div",{staticClass:"mT10 label-txt-black f14"},[_vm._v(" "+_vm._s(_vm.$t("common.products.no_module_available",{moduleName:_vm.moduleDisplayName?_vm.moduleDisplayName:_vm.moduleName}))+" ")])]),_vm.multiSelect?_c("el-table-column",{attrs:{type:"selection",width:"60",fixed:""}}):_vm._e(),_vm.multiSelect?_vm._e():_c("el-table-column",{attrs:{fixed:"",width:"60"},scopedSlots:_vm._u([{key:"default",fn:function(item){return[_c("div",[_c("el-radio",{staticClass:"fc-radio-btn",attrs:{label:item.row.id},on:{change:_vm.setSelectedItem},model:{value:_vm.selectedItemId,callback:function($$v){_vm.selectedItemId=$$v},expression:"selectedItemId"}})],1)]}}],null,!1,3560327844)}),_vm.$validation.isEmpty(_vm.mainFieldColumn)?_vm._e():_c("el-table-column",{attrs:{label:_vm.mainFieldColumn.displayName,prop:_vm.mainFieldColumn.name,fixed:"","min-width":"200"},scopedSlots:_vm._u([{key:"default",fn:function(item){return[_c("div",{staticClass:"table-subheading"},[_c("div",{staticClass:"d-flex"},[_c("div",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"self-center name bold main-field-column",attrs:{title:_vm.getColumnDisplayValue(_vm.mainFieldColumn,item.row)}},[_vm._v(" "+_vm._s(_vm.getColumnDisplayValue(_vm.mainFieldColumn,item.row)||"---")+" ")])])])]}}],null,!1,1766926856)}),_vm._l(_vm.filteredViewColumns,(function(field,index){return _c("el-table-column",{key:index,attrs:{prop:field.name,label:field.displayName,align:_vm.getColumnAlignment(field),"min-width":"200"},scopedSlots:_vm._u([{key:"default",fn:function(scope){return[_vm.isSpecialHandlingField(field)?_c("keep-alive",[_c((_vm.listComponentsMap[_vm.moduleName]||{}).componentName,{tag:"component",attrs:{field:field,moduleData:scope.row}})],1):"MULTI_CURRENCY"===((field||{}).field||{}).displayType?_c("div",[_c("CurrencyPopOver",{key:field.fieldId+"-"+field.name,attrs:{field:field,details:scope.row}})],1):_c("div",{staticClass:"table-subheading",class:["right"===_vm.getColumnAlignment(field)?"text-right":""]},[_vm._v(" "+_vm._s(_vm.getColumnDisplayValue(field,scope.row)||"---")+" ")])]}}],null,!0)})}))],2)]],2)]),_vm.multiSelect&&!_vm.isLoading?_c("div",{staticClass:"d-flex mT-auto"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){_vm.canShowWizard=!1}}},[_vm._v(" "+_vm._s(_vm.$t("common._common.cancel"))+" ")]),_c("el-button",{staticClass:"modal-btn-save m0",attrs:{type:"primary"},on:{click:function($event){return _vm.setSelectedItem()}}},[_vm._v(" "+_vm._s(_vm.$t("common._common._save"))+" ")])],1):_vm._e()]),_vm.canShowQuickCreate?_c("QuickCreateData",{attrs:{canShowDialog:_vm.canShowQuickCreate,quickCreateField:_vm.selectedLookupField,setAddedRecord:_vm.setAddedRecord},on:{"update:canShowDialog":function($event){_vm.canShowQuickCreate=$event},"update:can-show-dialog":function($event){_vm.canShowQuickCreate=$event}}}):_vm._e()],1)],2)},staticRenderFns=[],toConsumableArray=__webpack_require__(488478),slicedToArray=__webpack_require__(554621),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),objectSpread2=(__webpack_require__(260228),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(634338),__webpack_require__(450886),__webpack_require__(425728),__webpack_require__(434284),__webpack_require__(538077),__webpack_require__(339772),__webpack_require__(947522),__webpack_require__(162506),__webpack_require__(670560),__webpack_require__(595082)),ViewMixin=(__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(648324),__webpack_require__(821057),__webpack_require__(336585),__webpack_require__(453877)),WidgetPagination=__webpack_require__(806339),validation=__webpack_require__(990260),isEqual=__webpack_require__(618446),isEqual_default=__webpack_require__.n(isEqual),router=__webpack_require__(329435),fetchListUrlAndResultMap={users:{url:"v2/setup/userlist",result:"users"},alarm:{url:"v2/newAlarms/view/all",result:"alarms"},newreadingalarm:{url:"v2/newAlarms/view/active?alarmModule=newreadingalarm",result:"alarms"},workorder:{url:"/workorder/all"},safetyPlanHazard:{url:"v2/safetyPlanHazard/list",result:"safetyPlanHazardList"},hazardPrecaution:{url:"v2/hazardPrecaution/list",result:"hazardPrecautionList"},workorderHazard:{url:"v2/workorderHazard/list",result:"workorderHazards"},assetHazard:{url:"v2/assetHazard/list",result:"assetHazards"},tenant:{url:"v2/tenant/all",countUrl:"v2/tenant/all?count=true",result:"tenants"},asset:{url:"v2/assets/view/all",countUrl:"v2/assets/view/all?count=true",result:"assets"}},skipSiteIdModules=["vendors","safetyPlan","people","vendorcontact","service","client"],CommonRelatedListvue_type_script_lang_js={mixins:[ViewMixin/* default */.Z],components:{Pagination:WidgetPagination/* default */.Z},computed:{mainField:function(){var viewDetail=this.viewDetail,mainField=null;if((0,validation/* isEmpty */.xb)(viewDetail))mainField={name:"name",displayName:"Name",field:{name:"name",dataTypeEnum:"STRING"}};else{var fields=viewDetail.fields;mainField=(fields||[]).find((function(field){var fieldObj=field.field;return(fieldObj||{}).mainField}))}return mainField},mainFieldColumn:function(){var viewColumns=this.viewColumns,mainField=this.mainField,mainFieldName=this.$getProperty(mainField,"field.name","")||"name";return(0,validation/* isEmpty */.xb)(viewColumns)?{}:viewColumns.find((function(column){return column.name===mainFieldName}))},hideColumns:function(){var _this$defaultHideColu=this.defaultHideColumns,defaultHideColumns=void 0===_this$defaultHideColu?[]:_this$defaultHideColu,mainField=this.mainField,mainFieldName=this.$getProperty(mainField,"field.name","")||"name";return defaultHideColumns.concat(mainFieldName)},hidePaginationSearch:function(){var moduleName=this.moduleName;return["users"].includes(moduleName)},filteredViewColumns:function(){var viewColumns=this.viewColumns,hideColumns=this.hideColumns;return(0,validation/* isEmpty */.xb)(viewColumns)?[]:viewColumns.filter((function(column){return!hideColumns.includes(column.name)}))},filters:function(){var $route=this.$route,widget=this.widget,siteId=this.siteId,moduleName=this.moduleName,specialFilters=this.specialFilters,resourceModule=this.resourceModule,showFilters=this.showFilters,categoryId=this.categoryId,_this$skipSiteFilter=this.skipSiteFilter,skipSiteFilter=void 0!==_this$skipSiteFilter&&_this$skipSiteFilter,selectedLookupField=this.selectedLookupField,params=$route.params,name=$route.name,id=params.id,assetid=params.assetid,_ref=widget||{},relatedList=_ref.relatedList,_ref2=relatedList||{},field=_ref2.field,fieldName=(field||{}).name,_ref3=selectedLookupField||{},filters=_ref3.filters,filterObj={};return"assetsummary"===name&&(id=assetid),(resourceModule||showFilters)&&(filterObj=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},filterObj),this.resourceFilterConstruction())),
//temp should be changed as prop
!(["wosummarynew","portalVendorsummary","vendorsummary","vendorWorkorderSummary","hazardSummary","safetyPlanSummary","precautionSummary","tenantSummary","assetsummary","serviceRequestSummary","custommodules-summary","clientSummary","spaceOverview","tenantUnitSummary","et-custommodules-summary","newapprovalsummary","quotationSummary","prSummary","poSummary","tenant"].includes(name)||406===this.$account.org.id&&"service"===(0,router/* getApp */.wx)().linkName&&["custom_supplierquotation","custom_supplierselectionform"].includes(moduleName))||specialFilters||(0,validation/* isEmpty */.xb)(fieldName)||(filterObj[fieldName]={operatorId:36,value:["".concat(id)]}),(0,validation/* isEmpty */.xb)(categoryId)||(filterObj.category={operator:"is",value:["".concat(categoryId)]}),(0,validation/* isEmpty */.xb)(siteId)||skipSiteIdModules.includes(moduleName)||skipSiteFilter||(filterObj.siteId={operatorId:36,value:["".concat(siteId)]}),(0,validation/* isEmpty */.xb)(specialFilters)||(filterObj=Object.assign(filterObj,specialFilters)),"workorder"===moduleName&&"quote"===this.$getProperty(this,"selectedLookupField.field.module.name","")&&(filterObj["isQuotationNeeded"]={operatorId:15,value:[String(!0)]}),(0,validation/* isEmpty */.xb)(filters)||(filterObj=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},filterObj),filters)),filterObj},routeName:function(){var $route=this.$route,_ref4=$route||{},name=_ref4.name;return name||""}},data:function(){return{isLoading:!1,uniqueListFetchModules:["alarm"],viewDetail:null,modulesList:[],page:1,perPage:10,totalCount:null,isSearchDataLoading:!1,debounceDelay:2e3}},watch:{filters:function(newVal,oldVal){isEqual_default()(newVal,oldVal)||(0,validation/* isEmpty */.xb)(newVal)||(this.$set(this,"isSearchDataLoading",!0),this.debounceMainFieldSearch())},page:function(newVal,oldVal){var _this=this;if(!isEqual_default()(newVal,oldVal)){var isSearchDataLoading=this.isSearchDataLoading;isSearchDataLoading||(this.isLoading=!0,this.fetchModulesData(!0).finally((function(){_this.isLoading=!1,_this.onDataLoad&&_this.onDataLoad()})),this.loadDataCount(!0))}}},methods:{init:function(){var _this2=this;this.fetchListUrlAndResultMap=this.$helpers.cloneObject(fetchListUrlAndResultMap),this.debounceMainFieldSearch=this.$helpers.debounce((function(){_this2.fetchModulesData().finally((function(){_this2.onDataLoad&&_this2.onDataLoad()})),_this2.loadDataCount()}),this.debounceDelay),this.loadData(),this.loadDataCount()},loadData:function(){var _this3=this,promise=[];this.moduleName&&(promise.push(this.fetchViewDetail()),promise.push(this.fetchModulesData()),this.isLoading=!0,Promise.all(promise).finally((function(){_this3.isLoading=!1,_this3.onDataLoad&&_this3.onDataLoad()})))},loadDataCount:function(){var _this4=this,moduleName=this.moduleName,filters=this.filters,hidePaginationSearch=this.hidePaginationSearch,selectedLookupField=this.selectedLookupField,withReadings=this.withReadings,_ref5=selectedLookupField||{},clientCriteria=_ref5.clientCriteria;if(!hidePaginationSearch&&moduleName){var url=(fetchListUrlAndResultMap[moduleName]||{}).countUrl||"v2/module/data/list?moduleName=".concat(moduleName,"&fetchCount=true");if(!(0,validation/* isEmpty */.xb)(filters)){var encodedFilters=encodeURIComponent(JSON.stringify(filters));url="".concat(url,"&filters=").concat(encodedFilters)}if("workorder"===moduleName&&(url+="&viewName=all",(0,validation/* isEmpty */.xb)(filters)||(url+="&includeParentFilter=true")),"tenant"!==moduleName||(0,validation/* isEmpty */.xb)(selectedLookupField)||(0,validation/* isEmpty */.xb)(selectedLookupField.spaceId)||320===this.$org.id||(url="".concat(url,"&spaceId=").concat(selectedLookupField.spaceId)),withReadings&&(url="".concat(url,"&withReadings=true")),!(0,validation/* isEmpty */.xb)(clientCriteria)){var criteria=encodeURIComponent(JSON.stringify(clientCriteria));url="".concat(url,"&clientCriteria=").concat(criteria)}return this.$http.get(url).then((function(_ref6){var _ref6$data=_ref6.data,message=_ref6$data.message,responseCode=_ref6$data.responseCode,_ref6$data$result=_ref6$data.result,result=void 0===_ref6$data$result?{}:_ref6$data$result;if(0!==responseCode)throw new Error(message);var count=result.count;_this4.$set(_this4,"totalCount",count)})).catch((function(_ref7){var message=_ref7.message;_this4.$message.error("".concat(message," while fetching count"))}))}},isSpecialHandlingField:function(field){var name=field.name,moduleName=this.moduleName,_this$listComponentsM=this.listComponentsMap,listComponentsMap=void 0===_this$listComponentsM?{}:_this$listComponentsM,specialFields=(listComponentsMap[moduleName]||{}).specialHandlingFields;return(specialFields||[]).includes(name)},fetchViewDetail:function(){var _this5=this,moduleName=this.moduleName,viewDetailUrl="v2/views/hidden-all?moduleName=".concat(moduleName);return this.$http.get(viewDetailUrl).then((function(viewDetailsData){if(!(0,validation/* isEmpty */.xb)(viewDetailsData)){var _viewDetailsData$data=viewDetailsData.data,message=_viewDetailsData$data.message,responseCode=_viewDetailsData$data.responseCode,_viewDetailsData$data2=_viewDetailsData$data.result,result=void 0===_viewDetailsData$data2?{}:_viewDetailsData$data2;if(0!==responseCode)throw new Error(message);var viewDetail=result.viewDetail;(0,validation/* isEmpty */.xb)(viewDetail)||_this5.$set(_this5,"viewDetail",viewDetail)}}))},fetchModulesData:function(){var modulesListDataUrl,_this6=this,skipResetPage=arguments.length>0&&void 0!==arguments[0]&&arguments[0],moduleName=this.moduleName,filters=this.filters,perPage=this.perPage,hidePaginationSearch=this.hidePaginationSearch,fetchListUrlAndResultMap=this.fetchListUrlAndResultMap,selectedLookupField=this.selectedLookupField,withReadings=this.withReadings,_ref8=selectedLookupField||{},clientCriteria=_ref8.clientCriteria,additionalParams=_ref8.additionalParams;if(modulesListDataUrl=(fetchListUrlAndResultMap[moduleName]||{}).url||"v2/module/data/list?moduleName=".concat(moduleName),
// Reset page to 1 on search
(0,validation/* isEmpty */.xb)(filters)||skipResetPage||this.$set(this,"page",1),modulesListDataUrl.includes("?")?modulesListDataUrl+="&":modulesListDataUrl+="?",hidePaginationSearch||(modulesListDataUrl+="page=".concat(this.page,"&perPage=").concat(perPage)),"workorder"!==moduleName&&(modulesListDataUrl+="&viewName=hidden-all"),!(0,validation/* isEmpty */.xb)(filters)){var encodedFilters=encodeURIComponent(JSON.stringify(filters));modulesListDataUrl="".concat(modulesListDataUrl,"&filters=").concat(encodedFilters)}if((0,validation/* isEmpty */.xb)(filters)||"workorder"!==moduleName||(modulesListDataUrl+="&includeParentFilter=true"),"tenant"!==moduleName||(0,validation/* isEmpty */.xb)(selectedLookupField)||(0,validation/* isEmpty */.xb)(selectedLookupField.spaceId)||320===this.$org.id||(modulesListDataUrl="".concat(modulesListDataUrl,"&spaceId=").concat(this.selectedLookupField.spaceId)),withReadings&&(modulesListDataUrl="".concat(modulesListDataUrl,"&withReadings=true")),!(0,validation/* isEmpty */.xb)(clientCriteria)){var criteria=encodeURIComponent(JSON.stringify(clientCriteria));modulesListDataUrl="".concat(modulesListDataUrl,"&clientCriteria=").concat(criteria)}return(0,validation/* isEmpty */.xb)(additionalParams)||Object.entries(additionalParams).forEach((function(_ref9){var _ref10=(0,slicedToArray/* default */.Z)(_ref9,2),key=_ref10[0],value=_ref10[1];modulesListDataUrl="".concat(modulesListDataUrl,"&").concat(key,"=").concat(value)})),this.$http.get(modulesListDataUrl).then((function(modulesListData){if(!(0,validation/* isEmpty */.xb)(modulesListData))if("workorder"===moduleName){var _modulesListData$data=modulesListData.data.workOrders,workOrders=void 0===_modulesListData$data?{}:_modulesListData$data;(0,validation/* isNullOrUndefined */.le)(workOrders)||(_this6.modulesList=workOrders)}else{var _modulesListData$data2=modulesListData.data,message=_modulesListData$data2.message,responseCode=_modulesListData$data2.responseCode,_modulesListData$data3=_modulesListData$data2.result,result=void 0===_modulesListData$data3?{}:_modulesListData$data3;if(0!==responseCode)throw new Error(message);var moduleDatas=fetchListUrlAndResultMap[moduleName]&&result[fetchListUrlAndResultMap[moduleName].result]?result[fetchListUrlAndResultMap[moduleName].result]:result.moduleDatas;(0,validation/* isNullOrUndefined */.le)(moduleDatas)||_this6.$set(_this6,"modulesList",moduleDatas)}})).catch((function(_ref11){var message=_ref11.message;_this6.$message.error(message)})).finally((function(){_this6.isSearchDataLoading=!1}))},refreshRelatedList:function(){this.loadData(),this.loadDataCount()}}},list_CommonRelatedListvue_type_script_lang_js=CommonRelatedListvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(list_CommonRelatedListvue_type_script_lang_js,CommonRelatedList_render,CommonRelatedList_staticRenderFns,!1,null,null,null)
/* harmony default export */,CommonRelatedList=component.exports,WorkOrderSpecialFieldsList=__webpack_require__(786113),Spinner=__webpack_require__(604947),AlarmSpecialFieldsListvue_type_template_id_6b5ca42c_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",["resource"===_vm.field.name?_c("div",{staticClass:"q-item-division relative-position",staticStyle:{"min-width":"170px"}},[_vm.$validation.isEmpty(_vm.moduleData.resource)||_vm.$validation.isEmpty(_vm.moduleData.resource.space)||_vm.$validation.isEmpty(_vm.moduleData.resource.space.id)?_c("div",[_c("span",{staticClass:"q-item-label secondary-color color-d"},[_vm._v("--- "+_vm._s(_vm.$t("maintenance.wr_list.space_asset"))+" ---")])]):_c("div",[_vm._m(0),_c("span",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"flLeft q-item-label ellipsis max-width140px",attrs:{small:"","data-position":"bottom",title:_vm.moduleData.resource.space.name}},[_vm._v(_vm._s(_vm.moduleData.resource.space.name))])])]):"acknowledgedBy"===_vm.field.name?_c("div",{staticClass:"q-item-division relative-position wo_assignedto_avatarblock"},[_vm.moduleData.acknowledgedBy&&_vm.moduleData.acknowledgedBy.id?_c("div",{staticClass:"wo-assigned-avatar fL"},[_c("user-avatar",{attrs:{size:"sm",user:_vm.$store.getters.getUser(_vm.moduleData.acknowledgedBy.id),showLabel:!0,moduleName:"lookupModuleName"}})],1):_c("div",[_vm._v("Unacknowledged")])]):"noOfEvents"===_vm.field.name?_c("div",[_vm._m(1),_c("span",{staticClass:"flLeft pL5"},[_vm._v(_vm._s(_vm.eventsLabel))])]):"modifiedTime"===_vm.field.name?_c("div",{staticStyle:{"min-width":"150px"}},[_c("timer",{directives:[{name:"tippy",rawName:"v-tippy",value:{html:"#timer_popover_"+_vm.moduleData.id,distance:0,interactive:!0,theme:"light",animation:"scale",arrow:!0},expression:"{\n        html: '#timer_popover_' + moduleData.id,\n        distance: 0,\n        interactive: true,\n        theme: 'light',\n        animation: 'scale',\n        arrow: true,\n      }"}],staticClass:"alarm-timer p10",attrs:{time:_vm.moduleData.modifiedTime,title:_vm._f("formatDate")(_vm.moduleData.modifiedTime)}}),_c("div",{staticClass:"hide",attrs:{id:"timer_popover_"+_vm.moduleData.id}},[_c("div",{staticStyle:{"font-size":"12px","letter-spacing":"0.5px",color:"#666666"}},[_vm._v(" "+_vm._s(_vm._f("formatDate")(_vm.moduleData.modifiedTime))+" ")])])],1):"previousSeverity"===_vm.field.name&&_vm.moduleData.previousSeverity?_c("div",{staticClass:"q-item-label self-center f10 secondary-color"},[_c("div",{staticClass:"q-item-label uppercase",class:_vm.moduleData.previousSeverity?{severityTag:!0}:"",style:{"background-color":_vm.getAlarmSeverity(_vm.moduleData.previousSeverity.id).color}},[_vm._v(" "+_vm._s(_vm.moduleData.previousSeverity?_vm.getAlarmSeverity(_vm.moduleData.previousSeverity.id).displayName:"---")+" ")])]):"severity"===_vm.field.name?_c("div",[_vm.moduleData.severity?_c("div",{staticClass:"q-item-label self-center f10 secondary-color",staticStyle:{"min-width":"90px","margin-left":"13%"}},[_c("div",{staticClass:"q-item-label uppercase severityTag",style:{"background-color":_vm.getAlarmSeverity(_vm.moduleData.severity.id).color}},[_vm._v(" "+_vm._s(_vm.moduleData.severity.id?_vm.getAlarmSeverity(_vm.moduleData.severity.id).displayName:"---")+" ")])]):_vm._e()]):"alarmType"===_vm.field.name?_c("div",[_c("span",{staticClass:"q-item-label",staticStyle:{"font-size":"13px","letter-spacing":"0.4px"}},[_vm._v(_vm._s(_vm.moduleData.alarmTypeVal?_vm.moduleData.alarmTypeVal:"---"))])]):_vm._e()])},AlarmSpecialFieldsListvue_type_template_id_6b5ca42c_staticRenderFns=[function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"flLeft mR7"},[_c("img",{staticStyle:{height:"12px",width:"14px"},attrs:{src:__webpack_require__(572902)}})])},function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("span",{staticClass:"flLeft"},[_c("img",{staticStyle:{width:"15px"},attrs:{src:__webpack_require__(912146)}})])}],User=__webpack_require__(426803),Timer=__webpack_require__(114857),vuex_esm=__webpack_require__(420629),AlarmSpecialFieldsListvue_type_script_lang_js={components:{UserAvatar:User/* default */.Z,Timer:Timer/* default */.Z},props:["field","moduleData"],computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapGetters */.Se)(["getAlarmSeverity"])),{},{eventsLabel:function(){var moduleData=this.moduleData,noOfEvents=moduleData.noOfEvents;return(0,validation/* isEmpty */.xb)(noOfEvents)||0===noOfEvents?"0":moduleData.noOfEvents}}),methods:{isActiveAlarm:function(alarm){return"Clear"!==this.getAlarmSeverity(alarm.severity.id).severity}}},list_AlarmSpecialFieldsListvue_type_script_lang_js=AlarmSpecialFieldsListvue_type_script_lang_js,AlarmSpecialFieldsList_component=(0,componentNormalizer/* default */.Z)(list_AlarmSpecialFieldsListvue_type_script_lang_js,AlarmSpecialFieldsListvue_type_template_id_6b5ca42c_render,AlarmSpecialFieldsListvue_type_template_id_6b5ca42c_staticRenderFns,!1,null,null,null)
/* harmony default export */,AlarmSpecialFieldsList=AlarmSpecialFieldsList_component.exports,WizardSearch=__webpack_require__(57791),AssetSpecialFieldsListvue_type_template_id_85b3078e_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",["movable"===_vm.field.name?_c("div",[_vm._v(" "+_vm._s(_vm.moduleData.type&&_vm.getAssetType(_vm.moduleData.type.id).movable?"Yes":"No")+" ")]):_vm._e(),"geoLocation"===_vm.field.name?_c("div",[_vm._v(" "+_vm._s(_vm.moduleData.geoLocation?"@"+_vm.$helpers.parseLocation(_vm.moduleData.geoLocation):"---")+" ")]):_vm._e(),"currentLocation"===_vm.field.name?_c("div",[_vm._v(" "+_vm._s(_vm.moduleData.currentLocation?"@"+_vm.$helpers.parseLocation(_vm.moduleData.currentLocation):"---")+" ")]):_vm._e(),"designatedLocation"===_vm.field.name?_c("div",[_vm._v(" "+_vm._s(_vm.moduleData.designatedLocation?"Yes":"No")+" ")]):_vm._e(),"distanceMoved"===_vm.field.name?_c("div",[_vm._v(" "+_vm._s(_vm.moduleData.currentLocation?"@"+_vm.$helpers.parseLocation(_vm.moduleData.currentLocation):"---")+" ")]):_vm._e(),"boundaryRadius"===_vm.field.name?_c("div",[_vm._v(" "+_vm._s(_vm.moduleData.boundaryRadius>0?_vm.moduleData.boundaryRadius+"m":"---")+" ")]):_vm._e()])},AssetSpecialFieldsListvue_type_template_id_85b3078e_staticRenderFns=[],AssetSpecialFieldsListvue_type_script_lang_js={props:["field","moduleData"],computed:(0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapGetters */.Se)(["getAssetType"]))},list_AssetSpecialFieldsListvue_type_script_lang_js=AssetSpecialFieldsListvue_type_script_lang_js,AssetSpecialFieldsList_component=(0,componentNormalizer/* default */.Z)(list_AssetSpecialFieldsListvue_type_script_lang_js,AssetSpecialFieldsListvue_type_template_id_85b3078e_render,AssetSpecialFieldsListvue_type_template_id_85b3078e_staticRenderFns,!1,null,null,null)
/* harmony default export */,AssetSpecialFieldsList=AssetSpecialFieldsList_component.exports,constant=__webpack_require__(354754),FLookupField=__webpack_require__(855048),WizardQuickFilterAndSearchMixin=__webpack_require__(854711),picklist=__webpack_require__(961358),CurrencyPopOver=__webpack_require__(706881),FLookupFieldWizardvue_type_script_lang_js={name:"f-lookup-field-wizard",components:{Spinner:Spinner/* default */.Z,SearchComponent:WizardSearch/* default */.Z,FLookupField:FLookupField/* default */.Z,CurrencyPopOver:CurrencyPopOver/* default */.Z,QuickCreateData:function(){return Promise.all(/* import() */[__webpack_require__.e(93208),__webpack_require__.e(50232),__webpack_require__.e(93765),__webpack_require__.e(95953),__webpack_require__.e(35309),__webpack_require__.e(18778),__webpack_require__.e(12303),__webpack_require__.e(84290),__webpack_require__.e(31721),__webpack_require__.e(64418),__webpack_require__.e(5603),__webpack_require__.e(57432),__webpack_require__.e(435),__webpack_require__.e(72230),__webpack_require__.e(94255),__webpack_require__.e(67683),__webpack_require__.e(44178),__webpack_require__.e(91132),__webpack_require__.e(20280),__webpack_require__.e(78256),__webpack_require__.e(22200),__webpack_require__.e(49081),__webpack_require__.e(89472),__webpack_require__.e(12085),__webpack_require__.e(55754),__webpack_require__.e(86494),__webpack_require__.e(3037),__webpack_require__.e(49908),__webpack_require__.e(22061),__webpack_require__.e(31602),__webpack_require__.e(73609),__webpack_require__.e(41323),__webpack_require__.e(11305),__webpack_require__.e(80390),__webpack_require__.e(89142),__webpack_require__.e(97770),__webpack_require__.e(76422),__webpack_require__.e(18830)]).then(__webpack_require__.bind(__webpack_require__,676433))}},mixins:[CommonRelatedList,WizardQuickFilterAndSearchMixin/* default */.Z],props:["canShowLookupWizard","selectedLookupField","siteId","withReadings","specialFilterValue","categoryId","disableTabSwitch","showFilters","skipDecommission"],created:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.next=2,_this.initSelectedItems();case 2:_this.constructQuickFilters(),_this.init(),_this.fetchModuleMetaInfo();case 5:case"end":return _context.stop()}}),_callee)})))()},computed:{canShowWizard:{get:function(){return this.canShowLookupWizard},set:function(value){this.$emit("update:canShowLookupWizard",value)}},moduleDisplayName:function(){var selectedLookupField=this.selectedLookupField,config=selectedLookupField.config,operatorLookupModule=selectedLookupField.operatorLookupModule,_ref=config||{},isFiltersEnabled=_ref.isFiltersEnabled,filterValue=_ref.filterValue,configLookupModuleName=_ref.lookupModuleName;if(isFiltersEnabled){var selectedFilter=constant/* default */.Z.LOOKUP_FILTERS_MAP[filterValue];return configLookupModuleName||this.$t("fields.properties.show_only_".concat(selectedFilter))}var displayName=this.$getProperty(selectedLookupField,"field.lookupModule.displayName","")||this.$getProperty(selectedLookupField,"lookupModule.displayName","");if(!(0,validation/* isEmpty */.xb)(operatorLookupModule)){var operatorLookupModuleDisplayName=this.$getProperty(operatorLookupModule,"displayName","");(0,validation/* isEmpty */.xb)(operatorLookupModuleDisplayName)||(displayName=operatorLookupModuleDisplayName)}return displayName},moduleName:function(){var selectedLookupField=this.selectedLookupField,resourceSubModuleName=this.resourceSubModuleName,resourceModule=this.resourceModule,resourceFilterObj=this.resourceFilterObj,config=selectedLookupField.config,_ref2=config||{},isFiltersEnabled=_ref2.isFiltersEnabled,filterValue=_ref2.filterValue,configLookupModuleName=_ref2.lookupModuleName;if(isFiltersEnabled)return configLookupModuleName||constant/* default */.Z.LOOKUP_FILTERS_MAP[filterValue];var name=this.$getProperty(selectedLookupField,"operatorLookupModule.name","")||this.$getProperty(selectedLookupField,"lookupModuleName","")||this.$getProperty(selectedLookupField,"field.lookupModule.name","")||this.$getProperty(selectedLookupField,"lookupModule.name",""),categorySelected=!(0,validation/* isEmpty */.xb)(resourceFilterObj["spaceCategory"])||!(0,validation/* isEmpty */.xb)(resourceFilterObj["category"]),subModuleName=categorySelected||"space"!==resourceSubModuleName?resourceSubModuleName:"basespace";return name=resourceModule?subModuleName:name,name},title:function(){var moduleDisplayName=this.moduleDisplayName;return"".concat(this.$t("common.text.choose")," ").concat(moduleDisplayName)},selectedLabel:function(){var moduleDisplayName=this.moduleDisplayName;return"Selected ".concat(moduleDisplayName," ")},multiSelect:function(){var selectedLookupField=this.selectedLookupField,_ref3=selectedLookupField||{},multiple=_ref3.multiple;return!!multiple},selectedItemName:function(){var selectedItemNames=this.selectedItem.map((function(list){return list.label}));return(0,validation/* isEmpty */.xb)(selectedItemNames)?null:selectedItemNames},skipSiteFilter:function(){var selectedLookupField=this.selectedLookupField,_ref4=selectedLookupField||{},config=_ref4.config,_ref5=config||{},_ref5$skipSiteFilter=_ref5.skipSiteFilter,skipSiteFilter=void 0!==_ref5$skipSiteFilter&&_ref5$skipSiteFilter;return skipSiteFilter}},data:function(){return{debounceDelay:0,modelValue:null,fieldObj:{},selectedItemId:[],defaultHideColumns:["photo","moduleState","stateFlowId"],listComponentsMap:{workorder:{componentName:WorkOrderSpecialFieldsList/* default */.Z,specialHandlingFields:["resource","assignedTo","noOfNotes","noOfTasks","noOfAttachments"]},alarm:{componentName:AlarmSpecialFieldsList,specialHandlingFields:["severity","noOfEvents","acknowledgedBy","modifiedTime","previousSeverity","resource","alarmType"]},asset:{componentName:AssetSpecialFieldsList,specialHandlingFields:["movable","geoLocation","currentLocation","designatedLocation","distanceMoved","boundaryRadius"]}},canShowQuickCreate:!1,selectedItem:[],selectedCategoryName:""}},watch:{categoryId:{handler:function(newVal,oldVal){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var _yield$getFieldValue,data,_ref6,_ref7,categoryObj,_ref8,_ref8$label,label;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if(isEqual_default()(newVal,oldVal)||(0,validation/* isEmpty */.xb)(newVal)){_context2.next=8;break}return _context2.next=3,(0,picklist/* getFieldValue */.oe)({lookupModuleName:"assetCategory",selectedOptionId:[newVal]});case 3:_yield$getFieldValue=_context2.sent,data=_yield$getFieldValue.data,_ref6=data||[],_ref7=(0,slicedToArray/* default */.Z)(_ref6,1),categoryObj=_ref7[0],_ref8=categoryObj||{},_ref8$label=_ref8.label,label=void 0===_ref8$label?"":_ref8$label,_this2.$set(_this2,"selectedCategoryName",label);case 8:case"end":return _context2.stop()}}),_callee2)})))()},immediate:!0}},methods:{closeWizard:function(data){var _data$field;this.canShowWizard=!1,null!==data&&void 0!==data&&null!==(_data$field=data.field)&&void 0!==_data$field&&_data$field.selectedItems&&data.field.selectedItems.length&&this.$emit("closeWizard",data)},loadInitialData:function(){this.loadData(),this.loadDataCount()},setSelectedItem:function(){var _this3=this,selectedItem=this.selectedItem,mainField=this.mainField,selectedItemId=this.selectedItemId,multiSelect=this.multiSelect,selectedLookupField=this.selectedLookupField;multiSelect||(selectedItem=[this.modulesList.find((function(list){return list.id===selectedItemId}))],selectedItem=selectedItem.map((function(list){var id=list.id,_ref9=_this3.mainField||{name:"name"},name=_ref9.name,selectedItem={label:list[name],value:id};return selectedItem}))),(0,validation/* isEmpty */.xb)(mainField)&&(mainField={name:"name"}),selectedLookupField.selectedItems=selectedItem;var data={field:selectedLookupField};this.$emit("setLookupFieldValue",data),this.$nextTick((function(){_this3.closeWizard(data)}))},initSelectedItems:function(){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var _ref10,_ref10$selectedItems,selectedItems,selectedIds;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:if(_ref10=_this4.selectedLookupField||{},_ref10$selectedItems=_ref10.selectedItems,selectedItems=void 0===_ref10$selectedItems?[]:_ref10$selectedItems,(0,validation/* isEmpty */.xb)(selectedItems)){_context3.next=13;break}if(selectedIds=selectedItems.map((function(item){return item.value})),_this4.selectedItemId=_this4.multiSelect?selectedIds:selectedIds[0],!_this4.resourceModule){_context3.next=10;break}return _this4.isLoading=!0,_context3.next=8,_this4.getResourceDetails(selectedIds);case 8:_context3.next=11;break;case 10:_this4.selectedItem=(0,toConsumableArray/* default */.Z)(selectedItems);case 11:_context3.next=14;break;case 13:_this4.resourceSubModuleName="space";case 14:case"end":return _context3.stop()}}),_callee3)})))()},onDataLoad:function(){var _this5=this,isLoading=this.isLoading,isSearchDataLoading=this.isSearchDataLoading,multiSelect=this.multiSelect,selectedItemId=this.selectedItemId,toggleSelection=!isLoading&&!isSearchDataLoading&&multiSelect&&!(0,validation/* isEmpty */.xb)(selectedItemId);toggleSelection&&this.$nextTick((function(){var currentSelectedList=_this5.modulesList.filter((function(list){return-1!==selectedItemId.findIndex((function(item){return item===list.id}))})),ref=_this5.$refs.listTable;(0,validation/* isEmpty */.xb)(ref)||currentSelectedList.forEach((function(item){return ref.toggleRowSelection(item,!0)}))}))},getNonCurrentList:function(selectedList){var resourceSubModuleName=this.resourceSubModuleName,modulesList=this.modulesList,resourceModule=this.resourceModule,currentModuleList=selectedList.filter((function(item){return-1===modulesList.findIndex((function(list){return list.id===item.value}))}));return resourceModule?currentModuleList.filter((function(list){return list.subModule===resourceSubModuleName})):currentModuleList},getColumnAlignment:function(field){var fieldObj=field.field,_ref11=fieldObj||{},dataTypeEnum=_ref11.dataTypeEnum;return"DECIMAL"===dataTypeEnum?"right":"left"},handleSelection:function(selectedList){var _this6=this,nonCurrentItems=this.getNonCurrentList(this.selectedItem),currentItems=selectedList.map((function(list){var id=list.id,resourceTypeEnum=list.resourceTypeEnum,_ref12=_this6.mainField||{name:"name"},name=_ref12.name,selectedItem={label:list[name],value:id};return _this6.resourceModule&&(selectedItem["subModule"]=resourceTypeEnum.toLowerCase()),selectedItem}));this.selectedItem=[].concat((0,toConsumableArray/* default */.Z)(nonCurrentItems),(0,toConsumableArray/* default */.Z)(currentItems)),this.selectedItemId=this.selectedItem.map((function(list){return list.value}))},handleClose:function(item){var index=this.selectedItem.findIndex((function(list){return list.label===item}));this.selectedItem.splice(index,1),this.selectedItemId=this.selectedItem.map((function(list){return list.value})),this.onDataLoad()},quickAddRecordToggle:function(){this.$set(this,"canShowQuickCreate",!this.canShowQuickCreate)},setAddedRecord:function(props){var record=props.record;this.selectedItemId=(record||{}).id,this.modulesList.push(record),this.setSelectedItem()}}},components_FLookupFieldWizardvue_type_script_lang_js=FLookupFieldWizardvue_type_script_lang_js,FLookupFieldWizard_component=(0,componentNormalizer/* default */.Z)(components_FLookupFieldWizardvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FLookupFieldWizard=FLookupFieldWizard_component.exports},
/***/114857:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return Timer}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/Timer.vue?vue&type=template&id=79408276
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"fc-timer"},[_c("div",{staticClass:"inline_flex"},[_vm.days>0?_c("div",{staticClass:"t-days"},[_vm.days<9&&_vm.twoDigits?_c("div",{staticClass:"t-label",style:_vm.bgColor},[_vm._v(" 0"+_vm._s(_vm.days)+" ")]):_c("div",{staticClass:"t-label",style:_vm.bgColor},[_vm._v(_vm._s(_vm.days))]),_vm.days<2?_c("div",{staticClass:"t-sublabel uppercase"},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.day"))+" ")]):_c("div",{staticClass:"t-sublabel uppercase"},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.days"))+" ")])]):_vm._e(),_vm.days>0?_c("div",{staticClass:"t-separate"},[_vm._v(":")]):_vm._e(),_c("div",{staticClass:"t-hours"},[_vm.hours<9&&_vm.twoDigits?_c("div",{staticClass:"t-label",style:_vm.bgColor},[_vm._v(" 0"+_vm._s(_vm.hours)+" ")]):_c("div",{staticClass:"t-label",style:_vm.bgColor},[_vm._v(_vm._s(_vm.hours))]),_vm.hours<2?_c("div",{staticClass:"t-sublabel uppercase"},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.hour"))+" ")]):_c("div",{staticClass:"t-sublabel uppercase"},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.hours"))+" ")])]),_c("div",{staticClass:"t-separate"},[_vm._v(":")]),_c("div",{staticClass:"t-mins"},[_vm.mins<9&&_vm.twoDigits?_c("div",{staticClass:"t-label",style:_vm.bgColor},[_vm._v(" 0"+_vm._s(_vm.mins)+" ")]):_c("div",{staticClass:"t-label",style:_vm.bgColor},[_vm._v(_vm._s(_vm.mins))]),_vm.mins<2?_c("div",{staticClass:"t-sublabel uppercase"},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.min"))+" ")]):_c("div",{staticClass:"t-sublabel uppercase"},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.mins"))+" ")])]),_vm.days<=0?_c("div",{staticClass:"t-separate"},[_vm._v(":")]):_vm._e(),_vm.days<=0?_c("div",{staticClass:"t-secs"},[_vm.secs<9&&_vm.twoDigits?_c("div",{staticClass:"t-label",style:_vm.bgColor},[_vm._v(" 0"+_vm._s(_vm.secs)+" ")]):_c("div",{staticClass:"t-label",style:_vm.bgColor},[_vm._v(_vm._s(_vm.secs))]),_vm.secs<2?_c("div",{staticClass:"t-sublabel uppercase"},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.sec"))+" ")]):_c("div",{staticClass:"t-sublabel uppercase"},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.secs"))+" ")])]):_vm._e()])])},staticRenderFns=[],Timervue_type_script_lang_js={props:["time","color","twoDigits","staticTime","static","duration"],data:function(){return{days:"",hours:"",mins:"",secs:"",bgColor:"color: "+this.color+";",intervalObj:null}},watch:{time:function(){this.initCounter()},staticTime:{handler:function(newValue,oldValue){newValue!==oldValue&&this.staticTime&&this.initCounter()}}},mounted:function(){this.initCounter()},methods:{initCounter:function(){var date,dateObj=new Date(this.time),currentTime=Date.now();if(this.staticTime){this.days="",this.hours="",this.mins="",this.secs="",this.intervalObj&&(clearInterval(this.intervalObj),this.intervalObj=null),date=dateObj/1e3,date<0&&date>-2&&(date=0);var d=Math.floor(date/86400),h=Math.floor(date%86400/3600),m=Math.floor(date%3600/60),s=Math.floor(date%3600%60);this.days=d>=0?d:0,this.hours=h>=0?h:0,this.mins=m>=0?m:0,this.secs=s>=0?s:0}else if(this.static){this.days="",this.hours="",this.mins="",this.secs="",date=this.duration,date<0&&date>-2&&(date=0);var _d=Math.floor(date/86400),_h=Math.floor(date%86400/3600),_m=Math.floor(date%3600/60),_s=Math.floor(date%3600%60);this.days=_d>=0?_d:0,this.hours=_h>=0?_h:0,this.mins=_m>=0?_m:0,this.secs=_s>=0?_s:0}else{date=(currentTime-dateObj)/1e3,date<0&&date>-2&&(date=0);var _d2=Math.floor(date/86400),_h2=Math.floor(date%86400/3600),_m2=Math.floor(date%3600/60),_s2=Math.floor(date%3600%60);this.days=_d2>=0?_d2:0,this.hours=_h2>=0?_h2:0,this.mins=_m2>=0?_m2:0,this.secs=_s2>=0?_s2:0,this.startCounter()}},startCounter:function(){this.intervalObj&&(clearInterval(this.intervalObj),this.intervalObj=null);var self=this;this.intervalObj=setInterval((function(){self.secs++,self.secs>=60&&(self.secs=0,self.mins++),self.mins>=60&&(self.mins=0,self.hours++),self.hours>=24&&(self.hours=0,self.days++)}),1e3)}}},components_Timervue_type_script_lang_js=Timervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_Timervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,Timer=component.exports},
/***/718452:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return Search}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/newapp/components/Search.vue?vue&type=template&id=1f319dc4&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"fc-black-small-txt-12"},[_vm.showSearch?_vm._e():_c("div",{on:{click:function($event){return $event.stopPropagation(),_vm.search()}}},[_c("i",{staticClass:"el-icon-search fc-black-2 f16 pointer fw-bold",on:{click:function($event){return $event.stopPropagation(),_vm.search()}}})]),_vm.showSearch?_c("outside-click",{attrs:{visibility:_vm.showSearch},on:{onOutsideClick:function($event){return _vm.close()}}},[_c("div",{staticClass:"inline-flex hideSearch fc-subheader-right-search"},[_c("el-select",{staticClass:"search-select-comp",attrs:{filterable:"",placeholder:"Select"},on:{change:function($event){return _vm.onFilterChange()}},model:{value:_vm.fieldName,callback:function($$v){_vm.fieldName=$$v},expression:"fieldName"}},_vm._l(_vm.filterObjectsData,(function(label,value){return _c("el-option",{key:value,attrs:{label:label.label,value:value}})})),1),_vm.$validation.isEmpty(_vm.$getProperty(_vm.filterObjectsData,_vm.fieldName))?_vm._e():_c("div",["select"===_vm.currentFilterProxy.displayType?_c("div",["date"===_vm.currentFilterProxy.type?["20"!==_vm.currentFilterValueProxy?_c("el-select",{staticClass:"search-select-comp2 search-border-left fc-tag fc-search-bar-select",attrs:{filterable:"",placeholder:"Select","popper-class":"f-search-popover"},on:{change:function($event){return _vm.applyDateFilter()}},model:{value:_vm.currentFilterValueProxy,callback:function($$v){_vm.currentFilterValueProxy=$$v},expression:"currentFilterValueProxy"}},[_vm._l(_vm.currentFilterProxy.options,(function(label,value){return _c("el-option",{key:value,attrs:{label:label,value:value}})})),_vm.currentFilterProxy.hideDateRange?_vm._e():_c("el-option",{attrs:{label:"Custom",value:"20"}})],2):_vm._e(),_c("f-date-picker",{directives:[{name:"show",rawName:"v-show",value:"20"===_vm.currentFilterValueProxy,expression:"currentFilterValueProxy === '20'"}],ref:"fdate",staticClass:"mT10 new-search-date-filter search-date-picker",attrs:{type:"datetimerange","value-format":"timestamp",format:"dd-MM-yyyy HH:mm"},on:{change:function($event){return _vm.applyFilter()}},model:{value:_vm.currentFilterProxy.dateRange,callback:function($$v){_vm.$set(_vm.currentFilterProxy,"dateRange",$$v)},expression:"currentFilterProxy.dateRange"}})]:_c("el-select",{ref:"selectDropdown",staticClass:"search-select-comp2 search-border-left fc-tag",attrs:{multiple:"","collapse-tags":"",filterable:"",disabled:_vm.canDisableField,placeholder:_vm.conditionsPlaceHolder,"popper-class":"f-search-popover"},model:{value:_vm.currentFilterValueProxy,callback:function($$v){_vm.currentFilterValueProxy=$$v},expression:"currentFilterValueProxy"}},[_vm._l(_vm.currentFilterProxy.options,(function(label,value){return _c("el-option",{key:"option-"+value,attrs:{label:label,value:value}})})),_c("div",{staticClass:"search-select-filter-btn pT5"},[_c("el-button",{staticClass:"btn-green-full filter-footer-btn fw-bold",on:{click:function($event){return _vm.applyFilter()}}},[_vm._v("DONE")])],1)],2)],2):_vm._e(),["resourceType","lookup"].includes(_vm.currentFilterProxy.displayType)&&!_vm.currentFilterProxy.specialType?[_c("FLookupFieldWrapper",{key:"lookup-"+_vm.fieldName,staticClass:"search-input-comp",attrs:{field:_vm.getFieldObj(_vm.currentFilterProxy,_vm.fieldName),label:_vm.currentFilterProxy.selectedLabel,hideWizard:_vm.hideLookupWizard,hideDropDown:_vm.hideDropDown},on:{recordSelected:_vm.setLookUpFilter,showingLookupWizard:function(value){return _vm.showingLookupWizard=value}},model:{value:_vm.currentFilterValueProxy,callback:function($$v){_vm.currentFilterValueProxy=$$v},expression:"currentFilterValueProxy"}})]:_vm._e(),"string"===_vm.currentFilterProxy.displayType?[_c("el-input",{ref:"f-search",staticClass:"input-with-select search-input-comp search-icon-set",attrs:{disabled:_vm.canDisableField,placeholder:_vm.conditionsPlaceHolder,clearable:"",autofocus:!0,type:"search","prefix-icon":_vm.canDisableField?"":"el-icon-search"},nativeOn:{click:function($event){return $event.stopPropagation(),$event.preventDefault(),function(){}.apply(null,arguments)},keyup:function($event){return!$event.type.indexOf("key")&&_vm._k($event.keyCode,"enter",13,$event.key,"Enter")?null:_vm.applyFilter()}},model:{value:_vm.currentFilterValueProxy,callback:function($$v){_vm.currentFilterValueProxy=$$v},expression:"currentFilterValueProxy"}})]:_vm._e(),["number","decimal"].includes(_vm.currentFilterProxy.displayType)?_c("div",[_c("el-input",{ref:"f-search",staticClass:"input-with-select search-input-comp search-icon-set",attrs:{type:"number",disabled:_vm.canDisableField,placeholder:_vm.conditionsPlaceHolder,clearable:"",autofocus:!0,"prefix-icon":_vm.canDisableField?"":"el-icon-search"},nativeOn:{click:function($event){return $event.stopPropagation(),$event.preventDefault(),function(){}.apply(null,arguments)},keyup:function($event){return!$event.type.indexOf("key")&&_vm._k($event.keyCode,"enter",13,$event.key,"Enter")?null:_vm.applyFilter()}},model:{value:_vm.currentFilterValueProxy,callback:function($$v){_vm.currentFilterValueProxy=$$v},expression:"currentFilterValueProxy"}})],1):_vm._e(),["asset","space"].includes(_vm.currentFilterProxy.displayType)?_c("div",{staticClass:"resource-list"},[_c("el-select",{staticClass:"multi resource-list el-input-textbox-full-border search-select-comp2 down-arrow-remove search-border-left fc-tag width100",attrs:{filterable:"",multiple:"","collapse-tags":"",value:_vm.$validation.isEmpty(_vm.currentFilterValueProxy)?[]:[1],disabled:""}},[_c("el-option",{attrs:{label:_vm.spaceAssetFilter,value:1}})],1),_vm.canDisableField?_vm._e():_c("i",{staticClass:"el-input__icon el-icon-search filter-space-search-icon3",on:{click:function($event){return _vm.spaceAssetProps(_vm.currentFilterProxy)}}})],1):_vm._e()],2),_vm.hideOperatorDialog?_vm._e():_c("el-button",{staticClass:"pointer user-select-none filter-btn",attrs:{disabled:"date"===_vm.currentFilterProxy.type&&"20"!==_vm.currentFilterValueProxy},on:{click:function($event){return $event.stopPropagation(),_vm.openFilterConditionPopup()}}},[_c("img",{staticStyle:{width:"18px"},attrs:{src:__webpack_require__(7634)}})]),_vm.showFilterCondition?_c("filter-condition",{attrs:{fieldName:_vm.fieldName,hideDropDownForLookup:_vm.hideDropDown},on:{close:function($event){_vm.showFilterCondition=!1}}}):_vm._e()],1)]):_vm._e(),_vm.chooserVisibility?_c("space-asset-multi-chooser",{staticClass:"fc-input-full-border-select2",attrs:{showAsset:"asset"===_vm.currentFilterProxy.displayType,initialValues:_vm.initialValues,visibility:_vm.chooserVisibility,hideBanner:!0},on:{associate:function($event){return _vm.associateResource($event,_vm.currentFilterProxy)},"update:visibility":function($event){_vm.chooserVisibility=$event}}}):_vm._e()],1)},staticRenderFns=[],objectSpread2=__webpack_require__(595082),OutsideClick=(__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(434284),__webpack_require__(648324),__webpack_require__(450886),__webpack_require__(21864)),FDatePicker=__webpack_require__(358551),validation=__webpack_require__(990260),SpaceAssetMultiChooser=__webpack_require__(673362),FilterCondition=__webpack_require__(930871),SearchTagMixin=__webpack_require__(200689),FLookupFieldWrapper=__webpack_require__(201117),Searchvue_type_script_lang_js={name:"Search",props:["config","moduleName","defaultFilter","includeAllMetaFields","hideOperatorDialog"],components:{OutsideClick:OutsideClick/* default */.Z,FDatePicker:FDatePicker/* default */.Z,SpaceAssetMultiChooser:SpaceAssetMultiChooser/* default */.Z,FilterCondition:FilterCondition/* default */.Z,FLookupFieldWrapper:FLookupFieldWrapper/* default */.Z},mixins:[SearchTagMixin/* default */.Z],data:function(){return{fieldName:null,showFilterCondition:!1,chooserVisibility:!1,initialValues:null,showingLookupWizard:!1}},computed:{currentFilterProxy:{get:function(){var fieldName=this.fieldName,filterObjectsData=this.filterObjectsData;return filterObjectsData[fieldName]||{}},set:function(value){var filterObjectsData=this.filterObjectsData,fieldName=this.fieldName;this.$set(filterObjectsData,fieldName,value)}},currentFilterValueProxy:{get:function(){var currentFilterProxy=this.currentFilterProxy;return currentFilterProxy.value||[]},set:function(value){this.currentFilterProxy=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},this.currentFilterProxy),{},{value:value})}},spaceAssetFilter:function(){var currentFilterProxy=this.currentFilterProxy,filter="";return(0,validation/* isEmpty */.xb)(currentFilterProxy.value)||(filter=currentFilterProxy.value.length,"asset"===currentFilterProxy.displayType?filter+="Asset":filter+="Space",currentFilterProxy.value.length>1&&(filter+="s")),filter},conditionsPlaceHolder:function(){var currentFilterProxy=this.currentFilterProxy,_ref=currentFilterProxy||{},operatorId=_ref.operatorId;return 1===operatorId?"is Empty":2===operatorId?"is Not Empty":"Search..."},canDisableField:function(){var currentFilterProxy=this.currentFilterProxy,operatorId=currentFilterProxy.operatorId,OPERATOR_CHECK={isEmpty:1,isNotEmpty:2};return[OPERATOR_CHECK.isEmpty,OPERATOR_CHECK.isNotEmpty].includes(operatorId)},hideLookupWizard:function(){return!1},hideDropDown:function(){var currentFilterProxy=this.currentFilterProxy,fieldName=this.fieldName,_ref2=this.getFieldObj(currentFilterProxy,fieldName)||{},name=_ref2.name;return"resource"===name}},watch:{config:{handler:function(value,oldValue){JSON.stringify(value)!==JSON.stringify(oldValue)&&this.initSearchFields()}},defaultFilter:{handler:function(value){this.fieldName=value},immediate:!0},appliedFilters:function(value,oldValue){JSON.stringify(value)!==JSON.stringify(oldValue)&&(this.setFilterApplied(),this.resetFilterData())}},methods:{onFilterChange:function(){if(this.showFilterCondition){var filterObj=this.currentFilterProxy;this.setOperatorId(filterObj,this.fieldName)}},openFilterConditionPopup:function(){this.showFilterCondition=!0,this.setOperatorId()},applyDateFilter:function(){var filterData=this.currentFilterProxy;filterData&&"20"!==filterData.value?this.applyFilter():this.$refs["fdate"].focus()},associateResource:function(resource,field){this.chooserVisibility=!1,field.value=resource.resourceList?resource.resourceList.map((function(res){return res.id})):[],this.applyFilter()},search:function(){this.$store.dispatch("search/toggleActiveStatus",!0)},close:function(){this.showingLookupWizard||this.showFilterCondition||this.$store.dispatch("search/toggleActiveStatus",!1)}}},components_Searchvue_type_script_lang_js=Searchvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_Searchvue_type_script_lang_js,render,staticRenderFns,!1,null,"1f319dc4",null)
/* harmony default export */,Search=component.exports},
/***/854711:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return WizardQuickFilterAndSearchMixin}});
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/slicedToArray.js + 1 modules
var render,staticRenderFns,slicedToArray=__webpack_require__(554621),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),objectSpread2=__webpack_require__(595082),cloneDeep=(__webpack_require__(434284),__webpack_require__(976801),__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(336585),__webpack_require__(150361)),cloneDeep_default=__webpack_require__.n(cloneDeep),validation=__webpack_require__(990260),picklist=__webpack_require__(961358),RESOURCE_MODULES=["site","building","floor","space","asset","basespace"],WizardQuickFilterAndSearchMixinvue_type_script_lang_js={data:function(){return{showSearch:!1,moduleMetaInfo:{},clearAllFilters:!1,wizardFilterValue:{},resourceSubModuleName:null,resourceFilterObj:{},quickFilters:null}},computed:{resourceModule:function(){var selectedLookupField=this.selectedLookupField,config=selectedLookupField.config,field=selectedLookupField.field,lookupModule=selectedLookupField.lookupModule,_ref=config||{},isFiltersEnabled=_ref.isFiltersEnabled;if(isFiltersEnabled)return!1;var fieldName="";return fieldName=(0,validation/* isEmpty */.xb)(lookupModule)?this.$getProperty(field,"lookupModule.name",""):lookupModule.name,"resource"===fieldName},specialFilters:function(){var specialFilterValue=this.specialFilterValue,wizardFilterValue=this.wizardFilterValue,moduleName=this.moduleName,skipDecommission=this.skipDecommission;if(RESOURCE_MODULES.includes(moduleName)&&!skipDecommission){var resourceFilter={decommission:{operatorId:15,value:["false"]}};wizardFilterValue=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},wizardFilterValue),resourceFilter)}return(0,validation/* isEmpty */.xb)(specialFilterValue)||(0,validation/* isEmpty */.xb)(wizardFilterValue)?(0,validation/* isEmpty */.xb)(wizardFilterValue)?(0,validation/* isEmpty */.xb)(specialFilterValue)?{}:specialFilterValue:wizardFilterValue:Object.assign(specialFilterValue,wizardFilterValue)}},methods:{getResourceDetails:function(selectedIds){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var moduleName,resourceModule,lookupModuleName;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return moduleName=_this.moduleName,resourceModule=_this.resourceModule,lookupModuleName=moduleName,resourceModule&&(lookupModuleName="resource"),_context.abrupt("return",(0,picklist/* getFieldValue */.oe)({lookupModuleName:lookupModuleName,selectedOptionId:selectedIds}).then((function(_ref2){var error=_ref2.error,data=_ref2.data;error?_this.$message.error(error.message||"Error Occured"):(_this.selectedItem=data,"basespace"===_this.$getProperty(data,"0.subModule")&&_this.selectedItem.forEach((function(item){return item.subModule="space"})),_this.setResourceSubModuleName(_this.selectedItem))})));case 4:case"end":return _context.stop()}}),_callee)})))()},setResourceSubModuleName:function(selectedItems){var subModule=selectedItems[0].subModule;this.resourceSubModuleName=subModule},onTabSwitch:function(tabName){var disableTabSwitch=this.disableTabSwitch;disableTabSwitch||(this.showSearch=!1,this.resourceSubModuleName=tabName,this.fetchModuleMetaInfo(),this.constructQuickFilters(),this.loadInitialData())},fetchModuleMetaInfo:function(){var _this2=this,moduleName=this.moduleName;(0,validation/* isEmpty */.xb)(moduleName)||this.$http.get("/module/metafields?moduleName="+moduleName).then((function(response){(0,validation/* isEmpty */.xb)(response.data.meta)||(_this2.moduleMetaInfo=response.data.meta),_this2.showSearch=!0})).catch((function(){}))},constructQuickFilters:function(){var _this3=this;this.quickFilters=cloneDeep_default()(this.$constants.QUICK_FILTERS),this.resourceFilterObj={};var moduleName=this.moduleName,quickFilters=this.quickFilters,siteId=this.siteId,categoryId=this.categoryId,selectedLookupField=this.selectedLookupField,config=selectedLookupField.config,_ref3=config||{},skipSiteFilter=_ref3.skipSiteFilter;quickFilters.forEach((function(filter){filter.value=null,"category"===filter.key?("space"===moduleName||"basespace"===moduleName?filter.lookupModule.name="spacecategory":"asset"===moduleName&&(filter.lookupModule.name="assetcategory"),(0,validation/* isEmpty */.xb)(categoryId)||skipSiteFilter||(filter.value=categoryId,filter.disabled=!0)):"site"===filter.key&&siteId&&!skipSiteFilter&&(filter.value=siteId,filter.disabled=!0),_this3.resourceFilterConstruction(filter)}))},resourceFilterConstruction:function(field){if((0,validation/* isEmpty */.xb)(field)){var moduleName=this.moduleName,resourceFilterObj=this.resourceFilterObj;if("asset"===moduleName){var filterObj={},spaceFilter={operator:"building_is",value:null},space=resourceFilterObj.space,floor=resourceFilterObj.floor,building=resourceFilterObj.building,siteId=resourceFilterObj.siteId,category=resourceFilterObj.category;category&&(filterObj.category=(0,objectSpread2/* default */.Z)({},category)),space?this.$set(spaceFilter,"value",space.value):floor?this.$set(spaceFilter,"value",floor.value):building?this.$set(spaceFilter,"value",building.value):siteId&&this.$set(spaceFilter,"value",siteId.value),spaceFilter.value&&(filterObj.space=(0,objectSpread2/* default */.Z)({},spaceFilter));var parentModuleName=this.$getProperty(this.selectedLookupField,"field.module.name");return"inspectionTemplate"===parentModuleName&&(filterObj.storeRoom={operatorId:1}),filterObj}return this.resourceFilterObj}var name=field.lookupModule.name,value=field.value,filterHash={spacecategory:"spaceCategory",assetcategory:"category",site:"siteId",building:"building",floor:"floor",basespace:"space"};if((0,validation/* isEmpty */.xb)(value))this.$delete(this.resourceFilterObj,filterHash[name]);else{var filter={};filter="category"===field.key?{operator:"is",value:["".concat(value)]}:{operatorId:36,value:["".concat(value)]},this.$set(this.resourceFilterObj,filterHash[name],filter)}var filters={};return"basespace"===name?Object.entries(this.resourceFilterObj).forEach((function(_ref4){var _ref5=(0,slicedToArray/* default */.Z)(_ref4,2),key=_ref5[0],value=_ref5[1];["siteId","building","floor"].includes(key)&&(filters[key]=value)})):"building"===name?Object.entries(this.resourceFilterObj).forEach((function(_ref6){var _ref7=(0,slicedToArray/* default */.Z)(_ref6,2),key=_ref7[0],value=_ref7[1];"siteId"===key&&(filters[key]=value)})):"floor"===name&&Object.entries(this.resourceFilterObj).forEach((function(_ref8){var _ref9=(0,slicedToArray/* default */.Z)(_ref8,2),key=_ref9[0],value=_ref9[1];["siteId","building"].includes(key)&&(filters[key]=value)})),filters},setLookUpFilter:function(field,valueObj){var _this4=this,spaceType=field.spaceType,_ref10=valueObj||{},value=_ref10.value;this.quickFilters.forEach((function(fld){fld.key===field.key&&(fld.value=(0,validation/* isEmpty */.xb)(value)?null:value,_this4.resourceFilterConstruction(fld))})),this.quickFilters.forEach((function(fld){var resetOptions=spaceType&&spaceType<fld.spaceType;if(fld.filters=_this4.resourceFilterConstruction(fld),resetOptions){"building"!==fld.key&&(fld.disabled=(0,validation/* isEmpty */.xb)(value)),fld.value=null,_this4.resourceFilterConstruction(fld),value=null;var params={page:1,perPage:50};(0,picklist/* getFieldOptions */._K)((0,objectSpread2/* default */.Z)({field:fld},params)).then((function(_ref11){var error=_ref11.error,options=_ref11.options;error?_this4.$message.error(error.message||"Error Occured"):fld.options=options}))}}))},applyFilter:function(filter){(0,validation/* isEmpty */.xb)(filter)||(this.wizardFilterValue=filter)},clearFilter:function(){this.wizardFilterValue=null,this.$set(this,"clearAllFilters",!0)}}},components_WizardQuickFilterAndSearchMixinvue_type_script_lang_js=WizardQuickFilterAndSearchMixinvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_WizardQuickFilterAndSearchMixinvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,WizardQuickFilterAndSearchMixin=component.exports;
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js
},
/***/57791:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return WizardSearch}});
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/defineProperty.js
var render,staticRenderFns,defineProperty=__webpack_require__(482482),slicedToArray=__webpack_require__(554621),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),objectSpread2=__webpack_require__(595082),Search=(__webpack_require__(434284),__webpack_require__(260228),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(450886),__webpack_require__(947522),__webpack_require__(976801),__webpack_require__(169358),__webpack_require__(336585),__webpack_require__(718452)),validation=__webpack_require__(990260),field_utils=__webpack_require__(455344),vuex_esm=__webpack_require__(420629),cloneDeep=__webpack_require__(150361),cloneDeep_default=__webpack_require__.n(cloneDeep),picklist=__webpack_require__(961358),WizardSearchvue_type_script_lang_js={extends:Search/* default */.Z,props:["clearFilters","singleFieldSearch","searchMetaInfo"],data:function(){return{singleFieldFilterObj:{},canShow:!1}},created:function(){this.$store.dispatch("loadTicketStatus",this.moduleName),this.setFilterObject()},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({users:function(state){return state.users},ticketStatus:function(state){return state.ticketStatus},ticketCategory:function(state){return state.ticketCategory},readingAlarmCategory:function(state){return state.readingAlarmCategory},assetCategory:function(state){return state.assetCategory},assetDepartment:function(state){return state.assetDepartment},assetType:function(state){return state.assetType},inventoryCategory:function(state){return state.inventoryCategory},sites:function(state){return state.sites},ticketPriority:function(state){return state.ticketPriority},ticketType:function(state){return state.ticketType},groups:function(state){return state.groups},alarmSeverity:function(state){return state.alarmSeverity}})),(0,vuex_esm/* mapGetters */.Se)(["getTicketStatusPickList"])),{},{showSearch:{get:function(){return this.canShow},set:function(value){this.canShow=value}},filterObjectsData:{get:function(){return this.singleFieldFilterObj},set:function(value){this.singleFieldFilterObj=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},this.singleFieldFilterObj),value)}},metaInfo:function(){return this.searchMetaInfo||this.viewMetaInfo},hideLookupWizard:function(){var currentFilterProxy=this.currentFilterProxy,fieldName=this.fieldName,_ref=this.getFieldObj(currentFilterProxy,fieldName)||{},name=_ref.name;return"resource"!==name}}),watch:{clearFilters:function(value){!(0,validation/* isEmpty */.xb)(value)&&value&&(this.resetFilterData(),this.close(!0))}},methods:{setFilterObject:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var config;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.next=2,Promise.all([_this.$store.dispatch("loadGroups"),_this.$store.dispatch("loadUsers")]);case 2:return _context.next=4,_this.setFilterConfig();case 4:config=_context.sent,_this.singleFieldFilterObj=(config||{}).data||{},_this.fieldName=_this.setDefaultFieldName();case 7:case"end":return _context.stop()}}),_callee)})))()},setFilterConfig:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var moduleName,metaInfo,_ref2,fields,configObj;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return moduleName=_this2.moduleName,metaInfo=_this2.metaInfo,_ref2=metaInfo||[],fields=_ref2.fields,configObj={includeParentCriteria:!0,data:{},availableColumns:[],saveView:!1,moduleName:moduleName,path:""},_context3.next=5,Promise.all(fields.map(function(){var _ref3=(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(field){var name,dataTypeEnum,trueVal,falseVal,specialType,enumMap,displayName,lookupModule,values,options,error,_options,lookupModuleName,response,responseError,responseOptions,userOptions;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if(name=field.name,dataTypeEnum=field.dataTypeEnum,trueVal=field.trueVal,falseVal=field.falseVal,specialType=field.specialType,enumMap=field.enumMap,displayName=field.displayName,lookupModule=field.lookupModule,"DATE"!=dataTypeEnum._name&&"DATE_TIME"!=dataTypeEnum._name){_context2.next=5;break}values={label:"",displayType:"select",dateRange:[],type:"date",customdate:!0,value:"",options:{22:"Today",26:"Till Yesterday",31:"This Week",30:"Last Week","2_50":"Last 2 Weeks",32:"Next Week","2_61":"Next 2 Days","7_61":"Next 7 Days",28:"This Month",27:"Last Month"}},_context2.next=39;break;case 5:if(values={label:"",displayType:"string",value:[]},"STRING"!=dataTypeEnum._name){_context2.next=11;break}values.displayType="string",values.operatorId=5,_context2.next=39;break;case 11:if("BOOLEAN"!=dataTypeEnum._name){_context2.next=18;break}values.displayType="select",values.type="Boolean",values.options={true:trueVal||"Yes",false:falseVal||"No"},values.value=[],_context2.next=39;break;case 18:if("NUMBER"!=dataTypeEnum._name){_context2.next=22;break}"siteId"===field.name?(values.displayType="select",values.options={}):"frequency"===name?(options=cloneDeep_default()(_this2.$constants.FACILIO_FREQUENCY),options["0"]="Once",values.options=options,values.displayType="select"):(values.displayType="number",values.operatorId=9),_context2.next=39;break;case 22:if("LOOKUP"!=dataTypeEnum._name){_context2.next=38;break}if(lookupModuleName=_this2.$getProperty(lookupModule,"name"),"ticketstatus"!==lookupModuleName){_context2.next=28;break}_options=_this2.getTicketStatusPickList(lookupModuleName),_context2.next=34;break;case 28:return _context2.next=30,(0,picklist/* getFieldOptions */._K)({field:{lookupModule:lookupModule,skipDeserialize:!0},page:1,perPage:50});case 30:response=_context2.sent,responseError=response.error,responseOptions=response.options,error=responseError,_options=responseOptions;case 34:(0,field_utils/* isLookupDropDownField */.Nz)(field)?values.displayType="lookup":values.displayType="select","users"===specialType?(userOptions={},_this2.users.forEach((function(user){userOptions[user.id]=user.name})),["assignedTo","executedBy"].includes(name)&&!(0,validation/* isEmpty */.xb)(_this2.groups)&&_this2.groups.forEach((function(group){userOptions[group.id+"_group"]=group.name})),values.specialType,values.displayType="select",values.options=userOptions):values.options=error?{}:_options,_context2.next=39;break;case 38:"ENUM"==dataTypeEnum._name&&(values.displayType="select",values.type="enum",values.value=[],values.options=enumMap);case 39:["DATE","DATE_TIME","BOOLEAN","ENUM"].includes(dataTypeEnum._name)&&(values["key"]=name),values.label=displayName,values.default=field.default,values.operator=dataTypeEnum._name,["LOOKUP","NUMBER","ENUM","BOOLEAN","STRING","DATE","DATE_TIME"].includes(dataTypeEnum._name)&&(
// Set only allowed field types
configObj.data[name]=values);case 44:case"end":return _context2.stop()}}),_callee2)})));return function(_x){return _ref3.apply(this,arguments)}}()));case 5:return _context3.abrupt("return",configObj);case 6:case"end":return _context3.stop()}}),_callee3)})))()},setDefaultFieldName:function(){var moduleName=this.moduleName,singleFieldFilterObj=this.singleFieldFilterObj;if("workorder"===moduleName)return"subject";var hasNameFilter=singleFieldFilterObj.hasOwnProperty("name");return hasNameFilter?"name":(Object.keys(singleFieldFilterObj)||[])[0]},setFilterApplied:function(){},resetFilterData:function(){var _this3=this;Object.entries(this.filterObjectsData||{}).forEach((function(_ref4){var _ref5=(0,slicedToArray/* default */.Z)(_ref4,2),fieldName=_ref5[0],filterData=_ref5[1];filterData.value=(0,validation/* isArray */.kJ)(filterData.value)?[]:"",delete filterData.operatorId,delete filterData.selectedLabel,_this3.filterObjectsData=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},_this3.filterObjectsData),{},(0,defineProperty/* default */.Z)({},fieldName,filterData))})),this.$emit("clearedFilters",!0)},search:function(){var _this4=this;this.showSearch=!0,this.$nextTick((function(){var element=_this4.$refs["f-search"];(0,validation/* isEmpty */.xb)(element)||element.focus()}))},close:function(forceClose){this.showingLookupWizard&&!forceClose||(this.showSearch=!1)},applyFilter:function(filterData){(0,validation/* isEmpty */.xb)(filterData)?filterData=this.filterObjectsData:this.filterObjectsData=filterData;var filters=this.formatDataForFilter(filterData);(0,validation/* isEmpty */.xb)(filters)?this.resetFilterData():this.singleFieldSearch&&((0,validation/* isEmpty */.xb)(this.$refs["selectDropdown"])||this.$refs.selectDropdown.blur(),this.$emit("onChange",filters))}}},components_WizardSearchvue_type_script_lang_js=WizardSearchvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_WizardSearchvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,WizardSearch=component.exports;
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/slicedToArray.js + 1 modules
},
/***/644634:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"e2cd3812348a98834a1f24b05065a090.svg";
/***/},
/***/7634:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"a9487fe98c87670f4c21aa6dfd4aef8d.svg";
/***/},
/***/912146:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"08f3bc22d8be8b23fd43d8a724856b19.svg";
/***/}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/99751.js.map