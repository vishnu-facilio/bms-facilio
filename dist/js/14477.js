"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[14477],{
/***/814477:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return InspectionQuestionWidget}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/inspection/inspection-template/InspectionQuestionWidget.vue?vue&type=template&id=2ff9a48a&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"inspection-page-details"},[_c("portal",{attrs:{to:_vm.widget.key+"-title-section"}},[_c("div",{staticClass:"widget-header display-flex-between-space width100 p10 "},[_c("div",{staticClass:"widget-header-name f12"},[_vm._v(_vm._s(_vm.widgetTitle))]),_c("div",{staticClass:"d-flex fc-black-small-txt-12 widget-header-name"},[_c("div",[_vm._v(_vm._s(_vm.pageNumber)+" of "+_vm._s(_vm.totalPages)+" Pages")]),_c("span",{staticClass:"el-icon-arrow-left fc-black-small-txt-12 fw-bold f16 pointer mL10 mR5",class:{disable:1===_vm.pageNumber},on:{click:function($event){return _vm.prev()}}}),_c("span",{staticClass:"el-icon-arrow-right fc-black-small-txt-12 f16 pointer mR10 fw-bold",class:{disable:_vm.pageNumber===_vm.totalPages},on:{click:function($event){return _vm.next()}}})])])]),!_vm.loading&&_vm.$validation.isEmpty(_vm.questions)?_c("div",{staticClass:"fc-empty-center height100"},[_c("inline-svg",{attrs:{src:"svgs/inspection-empty",iconClass:"icon text-center icon-80"}}),_c("div",{staticClass:"questions-empty-text"},[_vm._v(" "+_vm._s(_vm.$t("qanda.response.no_questions"))+" ")])],1):_c("div",{ref:"inspection-answers"},[_vm.loading?_c("div",{staticClass:"flex-center-vH mT10"},[_c("spinner",{attrs:{show:_vm.loading,size:"80"}})],1):_vm.$validation.isEmpty(_vm.questions)?_vm._e():[_c("div",{staticClass:"header-container"},[_c("div",{staticClass:"bold fc-black-13 text-left letter-spacing1"},[_vm._v(" "+_vm._s(_vm.page.name)+" ")]),_vm.page.description?_c("div",{staticClass:"mT10 f13 text-fc-grey"},[_vm._v(" "+_vm._s(_vm.page.description)+" ")]):_vm._e()]),_vm._l(_vm.questionList,(function(question,index){return _c("div",{key:index,staticClass:"questions-container p20"},[_c("div",{staticClass:"display-flex-between-space align-center"},[_c("div",[_c("div",{staticClass:"question"},[_vm._v(" "+_vm._s(question.questionNo)+" "+_vm._s(question.question)+" ")]),question.answerRequired?_c("div",{staticClass:"d-flex flex-row primary-font"},[_c("div",{staticClass:"f13 mL25 mT8"},[_vm._v(" "+_vm._s(_vm.$t("qanda.template.answered"))+": "),_c("span",[_vm._v(_vm._s(question.answered?question.answered:0))])]),_c("div",{staticClass:"f13 mT8"},[_vm._v(" , "+_vm._s(_vm.$t("qanda.template.skipped"))+": "),_c("span",[_vm._v(_vm._s(question.answered&&_vm.totalResponses?Math.abs(_vm.totalResponses-question.answered):0))])])]):_vm._e()]),question.showResponses?_c("div",{staticClass:"show-responses-container",on:{click:function($event){return _vm.openResponseDialog(question)}}},[_vm._v(" Show Answer ")]):_vm._e()]),_vm.isMultiChoice(question)?_c("div",[_c("MCQTable",{attrs:{question:question}}),question.summary?_c("div",{staticClass:"show-responses-container mT10",on:{click:function($event){return _vm.openResponseDialog(question)}}},[_vm._v(" Show Other Responses ")]):_vm._e()],1):_vm.isRatingField(question)?_c("div",[_c("RatingTable",{attrs:{question:question}})],1):_vm._e()])}))],_c("InspectionResponse",{attrs:{isOpen:_vm.isDialogOpen,question:_vm.selectedQuestion,closeDialog:_vm.closeDialog,dateObj:_vm.dateObj}})],2)],1)},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),objectSpread2=__webpack_require__(595082),api=(__webpack_require__(450886),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(634338),__webpack_require__(32284)),validation=__webpack_require__(990260),InspectionResponsevue_type_template_id_e79ac528_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"inspection-response-dialog",attrs:{title:_vm.question.question,visible:_vm.openResponses,width:"40%","before-close":_vm.closeDialog},on:{"update:visible":function($event){_vm.openResponses=$event}}},[_vm.loading?_c("div",{staticClass:"flex"},[_c("spinner",{attrs:{show:_vm.loading,size:"80"}})],1):_vm.$validation.isEmpty(_vm.answers)?_c("div",{staticClass:"fc-empty-center"},[_c("inline-svg",{attrs:{src:"svgs/list-empty",iconClass:"icon text-center icon-xxxxlg"}}),_c("div",{staticClass:"page-name mT10"},[_vm._v(" "+_vm._s(_vm.$t("qanda.template.no_answers"))+" ")])],1):_c("div",[_c("div",{staticClass:"mB10 d-flex flex-col"},[_c("div",{staticClass:"font-medium f12 mB10 text-fc-grey"},[_vm._v(" "+_vm._s(_vm.$t("qanda.template.response_dialog_desc"))+", "+_vm._s(_vm.timeRange)+" ")]),_c("div",{staticClass:"fc-text-pink2"},[_vm._v(_vm._s(_vm.$t("qanda.template.answers")))])]),_vm._l(_vm.answers,(function(answer,index){return _c("div",{key:answer.id,staticClass:"f14 mT5 pT5 pB5"},[_c("div",{staticClass:"break-word"},[_vm._v(" "+_vm._s(index+1)+". "+_vm._s(_vm.getAnswer(answer))+" ")]),_c("div",{staticClass:"view-response",on:{click:function($event){return _vm.redirectToResponse(answer)}}},[_vm._v(" "+_vm._s(_vm.$t("qanda.template.view_inspection"))+" ")])])}))],2)])},InspectionResponsevue_type_template_id_e79ac528_staticRenderFns=[],helpers=(__webpack_require__(506203),__webpack_require__(434284),__webpack_require__(778390)),router=__webpack_require__(329435),dlv_umd=__webpack_require__(226905),dlv_umd_default=__webpack_require__.n(dlv_umd),_ref=helpers/* default */.ZP||{},moment=_ref.getOrgMoment,QUESTION_TYPE_ANSWER_RENDERER={MULTIPLE_CHOICE_MANY:function(answer){return answer.other},MULTIPLE_CHOICE_ONE:function(answer){return answer.other},BOOLEAN:function(answer,question){var _ref2=question||{},trueLabel=_ref2.trueLabel,falseLabel=_ref2.falseLabel;return answer.answer?trueLabel:falseLabel},DATE_TIME:function(answer,question){return question.showTime?moment(answer.answer).format("HH:mm a - DD MMM, YYYY"):moment(answer.answer).format("DD MMM, YYYY")},FILE_UPLOAD:function(answer){var fileName=dlv_umd_default()(answer,"answer.fileName");return fileName},MULTI_FILE_UPLOAD:function(answer){var _ref3=answer||{},filesArray=_ref3.answer;return filesArray.map((function(file){return file.fileName})).join(", ")}},InspectionResponsevue_type_script_lang_js={props:["question","isOpen","closeDialog","dateObj"],data:function(){return{answers:[],openResponses:!1,loading:!1}},computed:{timeRange:function(){var dateObj=this.dateObj,_ref4=dateObj||{},value=_ref4.value;if((0,validation/* isEmpty */.xb)(value))return"";var startTime=moment(value[0]).format("DD MMM, YYYY"),endTime=moment(value[1]).format("DD MMM, YYYY");return"".concat(startTime," - ").concat(endTime)},isMultiChoice:function(){var question=this.question,_ref5=question||{},questionType=_ref5.questionType;return!!["MULTIPLE_CHOICE_ONE","MULTIPLE_CHOICE_MANY"].includes(questionType)}},watch:{isOpen:{handler:function(newVal){this.openResponses=newVal,newVal&&this.loadQuestionResponse()}}},methods:{loadQuestionResponse:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var dateObj,isMultiChoice,value,id,params,url,_yield$API$post,data,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return dateObj=_this.dateObj,isMultiChoice=_this.isMultiChoice,value=dateObj.value,_this.loading=!0,id=_this.question.id,params={startTime:value[0],endTime:value[1]},url="v3/qanda/questions/fetchanswers/".concat(id),isMultiChoice&&(url="v3/qanda/questions/fetchotheroptions/".concat(id)),_context.next=9,api/* API */.bl.post(url,params);case 9:_yield$API$post=_context.sent,data=_yield$API$post.data,error=_yield$API$post.error,error?_this.$message.error(error.message||"Error Occured"):_this.answers=data.answers||data.otherResponses,_this.loading=!1;case 14:case"end":return _context.stop()}}),_callee)})))()},redirectToResponse:function(answer){var route,_ref6=answer||{},responseId=_ref6.responseId,response=_ref6.response,id=response||responseId;if(id){if((0,router/* isWebTabsEnabled */.tj)()){var _ref7=(0,router/* findRouteForModule */.Jp)("inspectionResponse",router/* pageTypes */.As.OVERVIEW)||{},name=_ref7.name;name&&(route=this.$router.resolve({name:name,params:{viewname:"all",id:id}}))}else route=this.$router.resolve({name:"individualInspectionSummary",params:{viewname:"all",id:id}});var _ref8=route||{},href=_ref8.href;window.open(href,"_blank")}},getAnswer:function(answer){var question=this.question,_ref9=question||{},questionType=_ref9.questionType;return(0,validation/* isEmpty */.xb)(QUESTION_TYPE_ANSWER_RENDERER[questionType])?answer.answer:QUESTION_TYPE_ANSWER_RENDERER[questionType](answer,question)}}},inspection_template_InspectionResponsevue_type_script_lang_js=InspectionResponsevue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(inspection_template_InspectionResponsevue_type_script_lang_js,InspectionResponsevue_type_template_id_e79ac528_render,InspectionResponsevue_type_template_id_e79ac528_staticRenderFns,!1,null,null,null)
/* harmony default export */,InspectionResponse=component.exports,NewDateHelper=__webpack_require__(105534),clone=__webpack_require__(766678),clone_default=__webpack_require__.n(clone),MCQTablevue_type_template_id_d086f88c_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"mcq-table-container justify-content-center d-flex"},[_vm.$validation.isEmpty(_vm.mcqSummary)?_vm._e():_c("el-table",{staticClass:"mcq-table mT20",staticStyle:{width:"100%"},attrs:{data:_vm.mcqSummary}},[_c("el-table-column",{attrs:{label:_vm.$t("qanda.template.choice")},scopedSlots:_vm._u([{key:"default",fn:function(data){return[_c("div",[_vm._v(_vm._s((data.row||{}).option.label))])]}}],null,!1,4091721501)}),_c("el-table-column",{attrs:{label:_vm.$t("qanda.template.response_percent")},scopedSlots:_vm._u([{key:"default",fn:function(data){return[_c("div",[_vm._v(_vm._s((data.row||{}).percent||0)+" %")])]}}],null,!1,774778771)}),_c("el-table-column",{attrs:{label:_vm.$t("qanda.template.response_count")},scopedSlots:_vm._u([{key:"default",fn:function(data){return[_c("div",[_vm._v(_vm._s((data.row||{}).count||0))])]}}],null,!1,2094562309)})],1)],1)},MCQTablevue_type_template_id_d086f88c_staticRenderFns=[],MCQTablevue_type_script_lang_js=(__webpack_require__(425728),__webpack_require__(260228),{props:["question"],computed:{mcqSummary:function(){var question=this.question,_ref=question||{},summary=_ref.summary,options=_ref.options,deserializedSummary=[];return summary&&(deserializedSummary=summary.map((function(currSummary){var option=currSummary.option,optionObject=options.find((function(currOption){return currOption.id===option}));return(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},currSummary),{},{option:optionObject})}))),deserializedSummary}}}),inspection_template_MCQTablevue_type_script_lang_js=MCQTablevue_type_script_lang_js,MCQTable_component=(0,componentNormalizer/* default */.Z)(inspection_template_MCQTablevue_type_script_lang_js,MCQTablevue_type_template_id_d086f88c_render,MCQTablevue_type_template_id_d086f88c_staticRenderFns,!1,null,null,null)
/* harmony default export */,MCQTable=MCQTable_component.exports,RatingTablevue_type_template_id_3188b19a_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"mcq-table-container justify-content-center d-flex"},[_vm.$validation.isEmpty(_vm.mcqSummary)?_vm._e():_c("el-table",{staticClass:"mcq-table mT20",staticStyle:{width:"100%"},attrs:{data:_vm.mcqSummary}},[_vm.isStarRating?[_c("el-table-column",{attrs:{label:_vm.$t("qanda.template.stars")},scopedSlots:_vm._u([{key:"default",fn:function(data){return[_c("div",{staticClass:"flex"},_vm._l(_vm.getCurrentOption(data),(function(stars){return _c("inline-svg",{key:stars,staticClass:"vertical-middle fill-blue5",attrs:{src:"svgs/star-yellow",iconClass:"icon icon-xxl"}})})),1)]}}],null,!1,2839378407)})]:[_c("el-table-column",{attrs:{label:_vm.$t("qanda.template.emoji")},scopedSlots:_vm._u([{key:"default",fn:function(data){return[_c("EmojiIconRenderer",{staticClass:"emoji-icon-layout mL_7",attrs:{rating:_vm.getCurrentOption(data),isActive:!0}})]}}],null,!1,4060847105)})],_c("el-table-column",{attrs:{label:_vm.$t("qanda.template.response_percent")},scopedSlots:_vm._u([{key:"default",fn:function(data){return[_c("div",[_vm._v(_vm._s((data.row||{}).percent||0)+" %")])]}}],null,!1,774778771)}),_c("el-table-column",{attrs:{label:_vm.$t("qanda.template.response_count")},scopedSlots:_vm._u([{key:"default",fn:function(data){return[_c("div",[_vm._v(_vm._s((data.row||{}).count||0))])]}}],null,!1,2094562309)})],2)],1)},RatingTablevue_type_template_id_3188b19a_scoped_true_staticRenderFns=[],dist=__webpack_require__(635120),RatingTablevue_type_script_lang_js={extends:MCQTable,components:{EmojiIconRenderer:dist/* EmojiIconRenderer */.ZI},computed:{emojiStartRating:function(){var _ref=this||{},question=_ref.question,ratingScale=question.ratingScale,halfScal=ratingScale/2;return Math.round(5-halfScal)},mcqSummary:function(){var question=this.question,emojiStartRating=this.emojiStartRating,isStarRating=this.isStarRating,_ref2=question||{},summary=_ref2.summary,deserializedSummary=[];return summary&&(deserializedSummary=summary.map((function(currSummary){var option=currSummary.option;return isStarRating||(option=Math.abs(option+emojiStartRating-1)),(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},currSummary),{},{option:option})}))),deserializedSummary},isStarRating:function(){var _ref3=this||{},question=_ref3.question,_ref4=question||{},questionType=_ref4.questionType;return"STAR_RATING"===questionType}},methods:{getCurrentOption:function(data){return(data.row||{}).option}}},inspection_template_RatingTablevue_type_script_lang_js=RatingTablevue_type_script_lang_js,RatingTable_component=(0,componentNormalizer/* default */.Z)(inspection_template_RatingTablevue_type_script_lang_js,RatingTablevue_type_template_id_3188b19a_scoped_true_render,RatingTablevue_type_template_id_3188b19a_scoped_true_staticRenderFns,!1,null,"3188b19a",null)
/* harmony default export */,RatingTable=RatingTable_component.exports,eventBus=__webpack_require__(398011),InspectionQuestionWidgetvue_type_script_lang_js={props:["details","resizeWidget","widget","sectionKey","moduleName"],data:function(){return{pageNumber:1,questions:[],page:null,loading:!1,isDialogOpen:!1,selectedQuestion:!1,dateObj:clone_default()(NewDateHelper/* default */.Z.getDatePickerObject(44,null))}},components:{InspectionResponse:InspectionResponse,MCQTable:MCQTable,RatingTable:RatingTable},created:function(){eventBus/* eventBus */.Y.$on("date-change-inspection",this.setDateObject)},computed:{pageModuleName:function(){return"qandaPage"},totalPages:function(){var details=this.details,_ref=details||{},pages=_ref.pages;return(pages||[]).length},totalResponses:function(){var _ref2=this||{},details=_ref2.details,_ref3=details||{},totalResponses=_ref3.totalResponses;return totalResponses},questionList:function(){var questions=this.questions,count=0;return questions.map((function(question){return question.answerRequired?(count+=1,(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},question),{},{questionNo:"Q".concat(count,".")})):question}))},widgetTitle:function(){var moduleName=this.moduleName;return moduleName.includes("induction")?"".concat(this.$t("qanda.template.induction")," ").concat(this.$t("qanda.template.summary")):moduleName.includes("survey")?"".concat(this.$t("qanda.template.survey")," ").concat(this.$t("qanda.template.summary")):"".concat(this.$t("qanda.template.inspection")," ").concat(this.$t("qanda.template.summary"))}},watch:{pageNumber:{handler:function(){this.loadPagesSummary()}},details:{handler:function(){this.loadPagesSummary()},immediate:!0}},methods:{setDateObject:function(dateFilter){this.dateObj=dateFilter,this.loadPagesSummary()},loadPagesSummary:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var details,pageNumber,pageModuleName,dateObj,value,_ref4,pages,id,_yield$API$fetchRecor,record,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(details=_this.details,pageNumber=_this.pageNumber,pageModuleName=_this.pageModuleName,dateObj=_this.dateObj,value=dateObj.value,_ref4=details||{},pages=_ref4.pages,(0,validation/* isEmpty */.xb)(pages)){_context.next=14;break}return _this.loading=!0,id=pages[pageNumber-1].id,_context.next=8,api/* API */.bl.fetchRecord(pageModuleName,{id:id,fetchSummary:!0,startTime:value[0],endTime:value[1]});case 8:_yield$API$fetchRecor=_context.sent,record=_yield$API$fetchRecor[pageModuleName],error=_yield$API$fetchRecor.error,error?_this.$message.error(error.message||"Error Occured"):(_this.page=record,_this.questions=_this.$getProperty(record,"questions")),_this.loading=!1,_this.autoResize();case 14:case"end":return _context.stop()}}),_callee)})))()},prev:function(){var pageNumber=this.pageNumber;1!==pageNumber&&this.$set(this,"pageNumber",pageNumber-1)},next:function(){var pageNumber=this.pageNumber,totalPages=this.totalPages;pageNumber!==totalPages&&this.$set(this,"pageNumber",pageNumber+1)},autoResize:function(){var _this2=this;this.$nextTick((function(){var container=_this2.$refs["inspection-answers"];if(container){var height=container.scrollHeight,width=container.scrollWidth;_this2.resizeWidget&&_this2.resizeWidget({height:height+70,width:width})}}))},openResponseDialog:function(question){this.selectedQuestion=question,this.isDialogOpen=!0},closeDialog:function(){this.isDialogOpen=!1},isMultiChoice:function(question){var _ref5=question||{},questionType=_ref5.questionType;return!!["MULTIPLE_CHOICE_ONE","MULTIPLE_CHOICE_MANY"].includes(questionType)},isRatingField:function(question){var _ref6=question||{},questionType=_ref6.questionType;return!!["STAR_RATING","SMILEY_RATING"].includes(questionType)}}},inspection_template_InspectionQuestionWidgetvue_type_script_lang_js=InspectionQuestionWidgetvue_type_script_lang_js,InspectionQuestionWidget_component=(0,componentNormalizer/* default */.Z)(inspection_template_InspectionQuestionWidgetvue_type_script_lang_js,render,staticRenderFns,!1,null,"2ff9a48a",null)
/* harmony default export */,InspectionQuestionWidget=InspectionQuestionWidget_component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/14477.js.map