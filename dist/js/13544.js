"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[13544],{
/***/297157:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return ErrorBanner}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/ErrorBanner.vue?vue&type=template&id=3d9e5288
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_vm.hasError?_c("div",{staticClass:"error-block",attrs:{id:"error"}},[_c("p",{staticClass:"error-txt"},[_c("i",{staticClass:"fa fa-info-circle",attrs:{"aria-hidden":"true"}}),_vm._v(" "+_vm._s(_vm.errorMessage?_vm.errorMessage:"Please fill all mandatory fields.")+" ")]),_c("i",{staticClass:"el-icon-close error-close-icon",on:{click:_vm.closeBanner}})]):_vm._e()])},staticRenderFns=[],ErrorBannervue_type_script_lang_js={props:["error","errorMessage"],computed:{hasError:{get:function(){return this.error},set:function(value){this.$emit("update:error",value)}}},methods:{closeBanner:function(){this.hasError=!1,this.$emit("update:errorMessage","")}}},components_ErrorBannervue_type_script_lang_js=ErrorBannervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_ErrorBannervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,ErrorBanner=component.exports},
/***/713544:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return WorkorderEmailSettings}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/setup/WorkorderEmailSettings.vue?vue&type=template&id=44466776
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"height100"},[_c("div",{staticClass:"setting-header2"},[_vm._m(0),_c("div",{staticClass:"action-btn setting-page-btn"},[_c("el-button",{staticClass:"setup-el-btn",attrs:{type:"primary"},on:{click:_vm.showSupportMail}},[_vm._v("Add Email "),_vm.showDialog?_c("new-supportemail",{attrs:{visibility:_vm.showDialog,supportEmailContext:_vm.editingSupportEmail},on:{"update:visibility":function($event){_vm.showDialog=$event},onsave:_vm.appendSupportEmail}}):_vm._e()],1)],1)]),_c("div",{staticClass:"container-scroll"},[_c("div",{staticClass:"row setting-Rlayout mT30"},[_c("div",{staticClass:"col-lg-12 col-md-12"},[_c("table",{staticClass:"setting-list-view-table"},[_vm._m(1),_vm.supportEmails&&_vm.supportEmails.length?_c("tbody",_vm._l(_vm.supportEmails,(function(supportEmail,idx){return _c("tr",{key:supportEmail.id,staticClass:"tablerow"},[_c("td",{attrs:{tyle:"width: 150px;"}},[_c("div",{staticClass:" mailfont"},[_vm._v(_vm._s(supportEmail.replyName))]),_c("div",{staticClass:" content"},[_vm._v(_vm._s(supportEmail.actualEmail))])]),_c("td",{staticStyle:{width:"150px"}},[_c("div",{staticClass:" content"},[_vm._v(_vm._s(supportEmail.fwdEmail))])]),_c("td",{attrs:{tyle:"width: 150px;"}},[_c("div",{staticClass:" content"},[_vm._v(" "+_vm._s(supportEmail.autoAssignGroupId>0?_vm.$store.getters.getGroup(supportEmail.autoAssignGroupId).name:"---")+" ")])]),_c("td",{attrs:{tyle:"width: 200px;"}},[_c("div",{staticClass:" content"},[_vm._v(" "+_vm._s(supportEmail.siteId>0?_vm.getSiteName(supportEmail.siteId):"---")+" ")])]),_c("td",[_c("div",{staticClass:"text-left actions",staticStyle:{"margin-top":"-3px","margin-right":"15px","text-align":"center",width:"100px"}},[_c("i",{staticClass:"el-icon-edit pointer",on:{click:function($event){return _vm.editEmail(supportEmail)}}}),_vm._v("    "),_c("i",{staticClass:"el-icon-delete pointer",on:{click:function($event){return _vm.deleteEmail(supportEmail.id,idx)}}})])])])})),0):_c("tbody",[_vm._m(2)])])])])])])},staticRenderFns=[function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"setting-title-block"},[_c("div",{staticClass:"setting-form-title"},[_vm._v("Email Settings")]),_c("div",{staticClass:"heading-description"},[_vm._v("List of all Support Email")])])},function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("thead",[_c("tr",[_c("th",{staticClass:"setting-table-th setting-th-text"},[_vm._v("NAME")]),_c("th",{staticClass:"setting-table-th setting-th-text"},[_vm._v("Forwarded to")]),_c("th",{staticClass:"setting-table-th setting-th-text"},[_vm._v("Team")]),_c("th",{staticClass:"setting-table-th setting-th-text"},[_vm._v("Site")]),_c("th",{staticClass:"setting-table-th setting-th-text"})])])},function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("tr",{staticClass:"tablerow"},[_c("td",{staticClass:"text-center",staticStyle:{"padding-top":"18px","padding-bottom":"18px"},attrs:{colspan:"100%"}},[_vm._v(" No supportEmail added yet ")])])}],esm_typeof=__webpack_require__(103336),newSupportemailvue_type_template_id_1588388a_render=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(434284),__webpack_require__(162506),function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"support-container",attrs:{visible:_vm.visibility,fullscreen:!0,"append-to-body":!0,"custom-class":"fc-dialog-form fc-support-dialog fc-dialog-right setup-dialog45","before-close":_vm.handleclose},on:{"update:visible":function($event){_vm.visibility=$event},close:_vm.close}},[_c("error-banner",{attrs:{error:_vm.error,errorMessage:_vm.errorText},on:{"update:error":function($event){_vm.error=$event},"update:errorMessage":function($event){_vm.errorText=$event},"update:error-message":function($event){_vm.errorText=$event}}}),_c("div",{staticClass:"new-header-container"},[_c("div",{staticClass:"new-header-text"},[_c("div",{staticClass:"fc-setup-modal-title"},[_vm._v(" "+_vm._s(_vm.isEditMode?"Edit Support email":"New Support email")+" ")])])]),_c("div",{staticClass:"new-body-modal"},[_c("el-form",{ref:"newSupportEmailForm",attrs:{model:_vm.supportEmail,"label-position":"top"},on:{submit:function($event){return $event.preventDefault(),_vm.save.apply(null,arguments)}}},[_c("el-row",[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v("Name")]),_c("el-form-item",{attrs:{prop:"replyName"}},[_c("el-input",{staticClass:"fc-input-full-border2 width100",attrs:{autofocus:!0,placeholder:"Support Name"},model:{value:_vm.supportEmail.replyName,callback:function($$v){_vm.$set(_vm.supportEmail,"replyName",$$v)},expression:"supportEmail.replyName"}})],1)],1),_c("el-row",{attrs:{gutter:20}},[_c("el-col",{attrs:{span:12}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v("Your support email")]),_c("el-form-item",{attrs:{prop:"actualEmail"}},[_c("el-input",{staticClass:"fc-input-full-border-select2 width100",attrs:{placeholder:"Eg:support@domain.facilio.com"},model:{value:_vm.supportEmail.actualEmail,callback:function($$v){_vm.$set(_vm.supportEmail,"actualEmail",$$v)},expression:"supportEmail.actualEmail"}})],1)],1),_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"setup-input-block"},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v("Forward your emails to")]),_c("el-form-item",{attrs:{prop:"fwdEmail"}},[_c("el-input",{staticClass:"fc-input-full-border-select2 width100",attrs:{disable:!0,placeholder:"Support Forward Email"},model:{value:_vm.supportEmail.fwdEmail,callback:function($$v){_vm.$set(_vm.supportEmail,"fwdEmail",$$v)},expression:"supportEmail.fwdEmail"}})],1)],1)])],1),_c("el-row",{attrs:{gutter:20}},[_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"setup-input-block"},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v("Sites")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{placeholder:"Select Site"},model:{value:_vm.supportEmail.siteId,callback:function($$v){_vm.$set(_vm.supportEmail,"siteId",$$v)},expression:"supportEmail.siteId"}},_vm._l(_vm.sites,(function(site){return _c("el-option",{key:site.id,attrs:{label:site.name,value:site.id}})})),1)],1)]),_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"setup-input-block"},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v("Assign to Team")]),_c("el-form-item",{attrs:{prop:"autoAssignGroupId"}},[_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{"float-label":"Assign to Team",placeholder:"Assign Team"},model:{value:_vm.supportEmail.autoAssignGroupId,callback:function($$v){_vm.$set(_vm.supportEmail,"autoAssignGroupId",$$v)},expression:"supportEmail.autoAssignGroupId"}},_vm._l(_vm.groups,(function(group){return _c("el-option",{key:group.id,attrs:{label:group.name,value:group.id}})})),1)],1)],1)])],1),_vm.isCustomMail?_c("el-row",{attrs:{gutter:20}},[_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"setup-input-block"},[_c("el-checkbox",{model:{value:_vm.supportEmail.customMail,callback:function($$v){_vm.$set(_vm.supportEmail,"customMail",$$v)},expression:"supportEmail.customMail"}},[_vm._v(" Use your own mail server ")])],1)])],1):_vm._e(),_vm.supportEmail.customMail?_c("el-row",[_c("div",{staticClass:"pT10 pB30"},[_c("div",{staticClass:"rule-border-blue p20 mB15 position-relative",staticStyle:{"border-left":"1px solid rgb(228, 235, 241)"}},[_c("div",{staticClass:"fc-input-label-txt mL10 pB0 text-fc-pink",attrs:{id:"ownMailServer-header"}},[_vm._v(" Incoming Mail Settings ")]),_c("el-row",{staticClass:"pT20",attrs:{gutter:20}},[_c("el-col",{attrs:{span:12}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v("Incoming Mail Server")]),_c("el-form-item",{attrs:{prop:"mailServer"}},[_c("el-input",{staticClass:"fc-input-full-border-select2 width100",attrs:{placeholder:""},model:{value:_vm.supportEmail.mailServer,callback:function($$v){_vm.$set(_vm.supportEmail,"mailServer",$$v)},expression:"supportEmail.mailServer"}})],1)],1),_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"setup-input-block"},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v("Port")]),_c("el-form-item",{attrs:{prop:"port"}},[_c("el-input",{staticClass:"fc-input-full-border-select2 width100",attrs:{disable:!0},model:{value:_vm.supportEmail.port,callback:function($$v){_vm.$set(_vm.supportEmail,"port",$$v)},expression:"supportEmail.port"}})],1)],1)])],1),_c("el-row",{staticClass:"pT20",attrs:{gutter:20}},[_c("el-col",{attrs:{span:24}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v("Authentication")]),_c("el-form-item",{attrs:{prop:"mailServer"}},[_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{placeholder:"Select Site"},model:{value:_vm.supportEmail.authentication,callback:function($$v){_vm.$set(_vm.supportEmail,"authentication",$$v)},expression:"supportEmail.authentication"}},[_c("el-option",{attrs:{label:"Plain",value:"1"}}),_c("el-option",{attrs:{label:"MD5",value:"2"}})],1)],1)],1)],1),_c("el-row",{attrs:{gutter:20}},[_c("el-col",{attrs:{span:12}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v("User Name")]),_c("el-form-item",{attrs:{prop:"userName"}},[_c("el-input",{staticClass:"fc-input-full-border-select2 width100",attrs:{placeholder:""},model:{value:_vm.supportEmail.userName,callback:function($$v){_vm.$set(_vm.supportEmail,"userName",$$v)},expression:"supportEmail.userName"}})],1)],1),_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"setup-input-block"},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v("Password")]),_c("el-form-item",{attrs:{prop:"password"}},[_c("el-input",{staticClass:"fc-input-full-border-select2 width100",attrs:{disable:!0,placeholder:""},model:{value:_vm.supportEmail.password,callback:function($$v){_vm.$set(_vm.supportEmail,"password",$$v)},expression:"supportEmail.password"}})],1)],1)])],1)],1)])]):_vm._e()],1)],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.handleclose}},[_vm._v("Cancel")]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:function($event){return _vm.saveSupportEmail("newSupportEmailForm")}}},[_vm._v(_vm._s(_vm.saving?"saving...":"Save"))])],1)],1)}),newSupportemailvue_type_template_id_1588388a_staticRenderFns=[],ErrorBanner=(__webpack_require__(450886),__webpack_require__(902918),__webpack_require__(564043),__webpack_require__(857267),__webpack_require__(297157)),newSupportemailvue_type_script_lang_js={props:["supportEmailContext","visibility"],data:function(){return{saving:!1,errorText:"",error:!1,customMail:!1,supportEmail:{replyName:"",actualEmail:"",autoAssignGroupId:"",fwdEmail:"",siteId:"",mailServer:"imap.gmail.com",port:"993",authentication:"1",userName:null,password:null},sites:[]}},created:function(){this.$store.dispatch("loadGroups")},mounted:function(){var _this=this;this.list=this.groups.map((function(group){return{group:group}})),this.initEditSupportEmail(),this.$util.loadSpace(1).then((function(response){_this.sites=response.basespaces}))},watch:{"supportEmail.actualEmail":function(newVal){this.fwdMail(newVal)}},components:{ErrorBanner:ErrorBanner/* default */.Z},computed:{groups:function(){return this.$store.state.groups},isEditMode:function(){return this.supportEmailContext},isCustomMail:function(){return this.$route.query.showCustom}},methods:{update:function(){var self=this;self.updating=!0},handleclose:function(){this.$emit("update:visibility",!1),this.reset()},reset:function(){this.supportEmail={replyName:"",actualEmail:"",autoAssignGroupId:"",fwdEmail:""}},close:function(){this.handleclose(),this.reset()},initEditSupportEmail:function(){this.isEditMode&&(this.$helpers.copy(this.supportEmail,this.supportEmailContext),this.replyName=this.supportEmailContext.replyName,this.actualEmail=this.supportEmailContext.actualEmail,this.autoAssignGroupId=this.supportEmailContext.autoAssignGroupId,this.fwdEmail=this.supportEmailContext.fwdEmail)},fwdMail:function(actualEmail){var orgEmailDomain="@"+this.$account.org.domain+".facilio.com";if(actualEmail.toLowerCase().endsWith(orgEmailDomain))this.supportEmail.fwdEmail=actualEmail;else{var emailSplit=actualEmail.toLowerCase().split("@"),domain=emailSplit[1]||"";this.supportEmail.fwdEmail=domain.replace(/\./g,"")+emailSplit[0]+orgEmailDomain}},validation:function(rule){this.error=!1,this.errorText="",rule.replyName?!rule.siteId||rule.siteId<=0?(this.errorText="Please select a site",this.error=!0):(this.errorText="",this.error=!1):(this.errorText="Please enter the Name",this.error=!0)},saveSupportEmail:function(newSupportEmailForm){var url,data,_this2=this,self=this;(this.validation(self.supportEmail),this.error)||(this.isEditMode?(url="/setup/updateemailsettings",data=this.$helpers.compareObject(this.supportEmail,this.supportEmailContext),data.id=this.supportEmailContext.id):(url="/setup/addemailsettings",data=this.$helpers.cloneObject(this.supportEmail)),data.autoAssignGroupId||delete data.autoAssignGroupId,data.siteId||delete data.siteId,this.$http.post(url,{supportEmail:data}).then((function(response){"object"===(0,esm_typeof/* default */.Z)(response.data)?(_this2.$emit("onsave"),_this2.$message.success(_this2.isEditMode?"Support Email updated successfully!":"Email created successfully!"),_this2.handleclose()):_this2.$message.error("Support Email "+(_this2.isEditMode?"updation":"creation")+" failed")})))}}},new_newSupportemailvue_type_script_lang_js=newSupportemailvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(new_newSupportemailvue_type_script_lang_js,newSupportemailvue_type_template_id_1588388a_render,newSupportemailvue_type_template_id_1588388a_staticRenderFns,!1,null,null,null)
/* harmony default export */,newSupportemail=component.exports,WorkorderEmailSettingsvue_type_script_lang_js={title:function(){return"Email Settings"},components:{NewSupportemail:newSupportemail},data:function(){return{loading:!0,isEdit:!0,editingSupportEmail:null,showCreateNewUserDialog:!1,newsupportmail:!1,visibility:!1,emailNotifications:[],supportEmails:[],showDialog:!1,sites:[]}},created:function(){this.$store.dispatch("loadGroups")},mounted:function(){var _this=this;this.loadnotifications(),this.$util.loadSpace(1).then((function(response){_this.sites=response.basespaces}))},watch:{supportEmail:function(newVal){this.loadnotifications()}},methods:{menuClick:function(event){alert(event)},showNewUser:function(){this.showCreateNewUserDialog=!0},showSupportMail:function(){this.editingSupportEmail=null,this.showDialog=!0},close:function(){this.showCreateNewUserDialog=!1},closeDialog:function(){
// this.visibility = false
this.$emit("update:visibility",!1),this.reset()},getSiteName:function(siteId){var site=this.sites.find((function(site){return site.id===siteId}));return site?site.name:""},editEmail:function(supportEmail){this.editingSupportEmail=this.$helpers.cloneObject(supportEmail),
// this.$refs.createFieldModel.open()
this.showCreateNewUserDialog=!0,this.showDialog=!0},deleteEmail:function(id,idx){var _this2=this;this.$dialog.confirm({title:"Delete the email setting?",message:"Are you sure you want to delete this Email setting?",rbDanger:!0,rbLabel:"Delete"}).then((function(value){value&&_this2.$http.post("/setup/deleteemailsettings",{supportEmailId:id}).then((function(response){"object"===(0,esm_typeof/* default */.Z)(response.data)?(_this2.$message.success("Deleted successfully"),_this2.supportEmails.splice(idx,0)):_this2.$message.error("Deletion failed")}))}))},loadnotifications:function(){var that=this;that.$http.get("/setup/emailsettings").then((function(response){that.emailNotifications=response["data"].emailSetting,that.supportEmails=response["data"].supportEmails,that.loading=!1})).catch((function(error){}))},appendSupportEmail:function(){this.loadnotifications()}}},setup_WorkorderEmailSettingsvue_type_script_lang_js=WorkorderEmailSettingsvue_type_script_lang_js,WorkorderEmailSettings_component=(0,componentNormalizer/* default */.Z)(setup_WorkorderEmailSettingsvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,WorkorderEmailSettings=WorkorderEmailSettings_component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/13544.js.map