(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[53524],{
/***/398758:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return AnalayticsFilter}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/energy/analytics/components/AnalayticsFilter.vue?vue&type=template&id=c060834c
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"building-popover"},[_c("div",{staticClass:"side-bar-site-details flex-middle"},[_vm.isSiteAnalysis?_c("div",[_c("InlineSvg",{staticClass:"pointer",attrs:{src:"svgs/spacemanagement/site",iconClass:"icon-50"}})],1):_c("div",{staticClass:"building-icon-container",staticStyle:{margin:"-10px -10px"}},[_c("InlineSvg",{staticClass:"pointer",attrs:{src:"svgs/spacemanagement/building",iconClass:"icon-50 resize_building_icon"}})],1),_c("div",{staticClass:"pL10 width100"},[_c("div",{staticClass:"display-flex-between-space"},[_c("div",{staticClass:"fc-id"},[_vm._v(_vm._s("#")+_vm._s(_vm.selectedBuildingId))]),_c("div",{staticStyle:{"margin-top":"12px","margin-right":"15px"}},[_c("div",{staticClass:"popover-text",attrs:{slot:"reference"},on:{click:function($event){return _vm.showLookupWizard()}},slot:"reference"},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.change_site_message_label"))+" ")])])]),_c("div",{staticClass:"display-flex-between-space",staticStyle:{"margin-top":"-8px"}},[_c("div",{staticClass:"label-text pointer label_text",on:{click:function($event){return _vm.showLookupWizard()}}},[_vm._v(" "+_vm._s(_vm.selectedBuildingLabel)+" ")])])])]),_vm.showingLookupWizard?_c("div",[_c("LookupWizard",{attrs:{canShowLookupWizard:_vm.showingLookupWizard,field:_vm.isSiteAnalysis?_vm.siteFieldObj:_vm.buildingFieldObj},on:{"update:canShowLookupWizard":function($event){_vm.showingLookupWizard=$event},"update:can-show-lookup-wizard":function($event){_vm.showingLookupWizard=$event},setLookupFieldValue:function(value){return _vm.toggleBuilding(value.field.selectedItems[0].value,value.field.selectedItems[0].label)}}})],1):_vm._e()])},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),ui_forms=(__webpack_require__(162506),__webpack_require__(670560),__webpack_require__(141323)),picklist=__webpack_require__(961358),AnalayticsFiltervue_type_script_lang_js={props:["config","selectedBuildings","multiple","zones","isSiteAnalysis"],components:{LookupWizard:ui_forms/* LookupWizard */.ns},data:function(){return{selectedBuildingsInternal:[],showingLookupWizard:!1,selectedBuildingLabel:"",selectedBuildingId:null,buildingFieldObj:{isDataLoading:!1,options:[],lookupModuleName:"building",field:{lookupModule:{name:"building",displayName:"Building"}},selectedItems:[],forceFetchAlways:!0,filters:{},isDisabled:!1},siteFieldObj:{isDataLoading:!1,options:[],lookupModuleName:"site",field:{lookupModule:{name:"site",displayName:"Site"}},selectedItems:[],forceFetchAlways:!0,filters:{},isDisabled:!1}}},created:function(){
// this.$store.dispatch('loadSites')
// this.$store.dispatch('loadBuildings')
},computed:{},mounted:function(){this.selectedBuildingsInternal=this.selectedBuildings,this.getBuildingLabel(),this.selectedBuildingId=this.selectedBuildings&&this.selectedBuildings[0]?this.selectedBuildings[0]:this.isSiteAnalysis?"No Sites":"No Buildings"},watch:{selectedBuildingsInternal:function(newVal){this.$emit("update:selectedBuildings",this.selectedBuildingsInternal)}},methods:{showLookupWizard:function(){this.showingLookupWizard=!0},getBuildingLabel:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(_this.selectedBuildingsInternal=_this.selectedBuildings,!_this.selectedBuildingsInternal[0]||_this.isSiteAnalysis){_context.next=6;break}return _context.next=4,(0,picklist/* getFieldValue */.oe)({lookupModuleName:"building",selectedOptionId:[_this.selectedBuildingsInternal[0]]}).then((function(_ref){var error=_ref.error,data=_ref.data;if(!error&&data){var value=data[0].label;_this.selectedBuildingLabel=value,_this.buildingFieldObj.selectedItems[0]={value:_this.selectedBuildingsInternal[0],label:_this.selectedBuildingLabel}}}));case 4:_context.next=12;break;case 6:if(!_this.selectedBuildingsInternal[0]||!_this.isSiteAnalysis){_context.next=11;break}return _context.next=9,(0,picklist/* getFieldValue */.oe)({lookupModuleName:"site",selectedOptionId:[_this.selectedBuildingsInternal[0]]}).then((function(_ref2){var error=_ref2.error,data=_ref2.data;if(!error&&data){var value=_this.$getProperty(data,"0.label");_this.selectedBuildingLabel=value,_this.siteFieldObj.selectedItems[0]={value:_this.selectedBuildingsInternal[0],label:_this.selectedBuildingLabel}}}));case 9:_context.next=12;break;case 11:_this.selectedBuildingLabel=_this.isSiteAnalysis?"No Sites":"No Buildings";case 12:case"end":return _context.stop()}}),_callee)})))()},toggleBuilding:function(buildingId,buildingName){if(this.multiple){var idx=this.selectedBuildingsInternal.indexOf(buildingId);-1!==idx?this.selectedBuildingsInternal.length>1&&this.selectedBuildingsInternal.splice(idx,1):this.selectedBuildingsInternal.push(buildingId)}else this.selectedBuildingsInternal=[buildingId],buildingId&&buildingName&&(this.selectedBuildingId=buildingId,this.selectedBuildingLabel=buildingName)},updateSelectedBuilding:function(buildings){this.selectedBuildingsInternal=buildings}}},components_AnalayticsFiltervue_type_script_lang_js=AnalayticsFiltervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_AnalayticsFiltervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,AnalayticsFilter=component.exports},
/***/5517:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return PortfolioAnalysis}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/energy/analytics/newTools/PortfolioAnalysis.vue?vue&type=template&id=77b07ad6
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"analytics-section-new row"},[_c("div",{staticClass:"newanalytics-page-header"},[_c("div",{staticClass:"row"},[_c("div",{staticClass:"col-8"},[_c("div",{staticClass:"analytics-page-header-filters"},[_vm._m(0),_c("div",{staticClass:"col-2"},[_c("div",{staticClass:"fL"},[_c("div",{staticClass:"selected-portfolio-analytics"},[_vm.selectedBuildings?_c("analaytics-filter",{ref:"buildings-filter",staticClass:"portfolio-analysis-add-points-btn",attrs:{multiple:!0,selectedBuildings:_vm.selectedBuildings},on:{"update:selectedBuildings":function($event){_vm.selectedBuildings=$event},"update:selected-buildings":function($event){_vm.selectedBuildings=$event}}}):_vm._e()],1)])]),_c("div",{staticClass:"col-4"},[_c("div",{staticClass:"mL20"},[_c("el-select",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"period-select",attrs:{placeholder:_vm.$t("common._common.mode"),title:_vm.$t("common._common.mode"),"data-arrow":"true"},on:{change:_vm.onModeChange},model:{value:_vm.analyticsConfig.mode,callback:function($$v){_vm.$set(_vm.analyticsConfig,"mode",$$v)},expression:"analyticsConfig.mode"}},[_c("el-option",{attrs:{label:_vm.$t("common.wo_report.time"),value:1}}),_c("el-option",{attrs:{label:_vm.$t("common.products.series"),value:2}}),_vm.isSameDataPoint?_c("el-option",{attrs:{label:_vm.$t("common.products.conslidated"),value:3}}):_vm._e()],1),_vm.baseLineList&&!_vm.isActionsDisabled?_c("el-cascader",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"period-select",attrs:{placeholder:_vm.$t("common.wo_report.compare_to"),options:_vm.baseLineCasecaderOptions,value:_vm.analyticsConfig.baseLine,title:_vm.$t("common.wo_report.compare_with_baseline"),"data-arrow":"true"},on:{change:_vm.onBaseLineChange}}):_vm._e(),2!==_vm.analyticsConfig.mode?_c("el-select",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"period-select",attrs:{placeholder:_vm.$t("common.wo_report.period"),title:_vm.$t("common.dashboard.time_period"),"data-arrow":"true"},on:{change:_vm.onPeriodChange},model:{value:_vm.analyticsConfig.period,callback:function($$v){_vm.$set(_vm.analyticsConfig,"period",$$v)},expression:"analyticsConfig.period"}},_vm._l(_vm.getAvailablePeriods,(function(period,index){return _c("el-option",{key:index,attrs:{label:period.name,value:period.value,disabled:!period.enable}})})),1):_vm._e()],1)])])]),_c("div",{staticClass:"col-4",staticStyle:{"text-align":"right"}},[_c("f-report-options",{staticClass:"analytics-page-options-building-analysis",attrs:{isActionsDisabled:_vm.isActionsDisabled,optionClass:"analytics-page-options",optionsToEnable:[1,2,5],reportObject:_vm.reportObject,params:_vm.reportObject?_vm.reportObject.params:null,savedReport:_vm.analyticsConfig.savedReport}})],1)])]),_vm.reportObject?_c("div",{directives:[{name:"show",rawName:"v-show",value:_vm.showChartCustomization,expression:"showChartCustomization"}],staticClass:"customize-container col-4 portfolio-customize-container"},[_c("div",{staticClass:"customize-header"},[_c("div",{staticClass:"customize-H"},[_vm._v(" "+_vm._s(_vm.$t("home.reports.chart_customization"))+" "),_c("i",{staticClass:"el-icon-close",on:{click:_vm.hideChartCustomizationDialog}})])]),_c("div",{staticClass:"customize-body"},[_vm.reportObject?_c("f-chart-customization",{directives:[{name:"show",rawName:"v-show",value:_vm.showChartCustomization,expression:"showChartCustomization"}],attrs:{tab:_vm.chartCustomizationActiveTab,report:_vm.reportObject,resultDataPoints:_vm.resultObject?_vm.resultObject.report.dataPoints:[],config:_vm.analyticsConfig},on:{close:function($event){_vm.showChartCustomization=!1}}}):_vm._e()],1)]):_vm._e(),_c("div",{staticClass:"portfolio-sidebar col-2"},[_vm.loading?_c("spinner",{attrs:{show:_vm.loading}}):_c("div",[_c("div",{staticClass:"na-parent"},[_c("div",{staticClass:"na-header mT20",on:{click:function($event){_vm.collapseState.buildingEnergy=!_vm.collapseState.buildingEnergy}}},[_vm._v(" "+_vm._s(_vm.$t("common._common.building_energy"))+" ")]),_vm.collapseState.buildingEnergy?_c("div",{staticClass:"na-content"},[_c("div",{staticClass:"na-child",on:{click:function($event){return _vm.showBuildingDataPoints("Energy")}}},[_c("div",{staticClass:"na-child-content",class:{active:"Energy"===_vm.selectedTab}},[_vm._v(" "+_vm._s(_vm.$t("common.products.energy"))+" ")])]),_c("div",{staticClass:"na-child",on:{click:function($event){return _vm.showBuildingDataPoints("Power",2)}}},[_c("div",{staticClass:"na-child-content",class:{active:"Power"===_vm.selectedTab}},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.power"))+" ")])])]):_vm._e()]),_vm.serviceWithMeters&&Object.keys(_vm.serviceWithMeters).length?_c("div",{staticClass:"na-parent"},[_c("div",{staticClass:"na-header",on:{click:function($event){_vm.collapseState.endUseEnergy=!_vm.collapseState.endUseEnergy}}},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.end_use_energy"))+" ")]),_vm.collapseState.endUseEnergy?_c("div",{staticClass:"na-content"},_vm._l(_vm.serviceWithMeters,(function(label,id){return _c("div",{key:id,staticClass:"na-child",on:{click:function($event){return _vm.showServiceDataPoints(id)}}},[_c("div",{staticClass:"na-child-content",class:{active:"id"===_vm.selectedTab}},[_vm._v(" "+_vm._s(label)+" ")])])})),0):_vm._e()]):_vm._e(),_c("div",{staticClass:"na-parent"},[_c("div",{staticClass:"na-header",on:{click:function($event){_vm.collapseState.cost=!_vm.collapseState.cost}}},[_vm._v(" "+_vm._s(_vm.$t("common.tabs.cost"))+" ")]),_vm.collapseState.cost?_c("div",{staticClass:"na-content"},[_c("div",{staticClass:"na-child",on:{click:function($event){return _vm.showBuildingDataPoints("Cost")}}},[_c("div",{staticClass:"na-child-content",class:{active:"Cost"===_vm.selectedTab}},[_vm._v(" "+_vm._s(_vm.$t("common._common.building_energy_cost"))+" ")])])]):_vm._e()])])],1),_c("div",{staticClass:"portfolio-analytic-summary col-10 scrollable",class:{"col-12, mleft0":!_vm.showChartCustomization,"col-8, mleft217":_vm.showChartCustomization},style:_vm.showChartCustomization?"max-width: calc(100% - 450px) !important;":""},[_vm.reportObject?_c("div",{staticClass:"add-points-block portfolio-add-points-block"},[1===_vm.analyticsConfig.mode?_c("el-button-group",[_c("el-button",{staticClass:"add-points-btn mL10",attrs:{type:"primary"},on:{click:function($event){_vm.showDerivation=!0}}},[_c("img",{attrs:{src:__webpack_require__(857539),width:"17px",height:"17px"}})])],1):_vm._e(),_c("el-button-group",[_c("el-button",{staticClass:"add-points-btn",attrs:{type:"primary"},on:{click:function($event){return _vm.showChartCustomizationDialog("datapoints")}}},[_c("img",{attrs:{src:__webpack_require__(108277),width:"17px",height:"17px"}})])],1)],1):_vm._e(),_c("div",{ref:"chartSection",staticClass:"self-center fchart-section building-graph-container portfolio-building-graph-container"},[_vm.analyticsConfig.dataPoints.length?_c("f-new-analytic-report",{ref:"newAnalyticReport",attrs:{config:_vm.analyticsConfig,baseLines:_vm.baseLineList},on:{"update:config":function($event){_vm.analyticsConfig=$event},reportLoaded:_vm.reportLoaded}}):_c("div",{staticClass:"text-center"},[_vm.reportId||_vm.alarmId||_vm.cardId?_c("div",{staticClass:"p15"},[_c("spinner",{attrs:{show:!0}})],1):_c("div",{staticClass:"p15 flex-middle height80vh justify-content-center flex-direction-column"},[_c("div",[_c("inline-svg",{attrs:{src:"svgs/emptystate/reportlist",iconClass:"icon text-center icon-xxxlg"}})],1),_c("div",{staticClass:"nowo-label"},[_vm._v(" "+_vm._s(_vm.$t("common._common.please_select_data_points_analyze"))+" ")])])])],1)]),_vm.showDerivation?_c("derivation",{attrs:{visibility:_vm.showDerivation,report:_vm.reportObject,config:_vm.analyticsConfig},on:{"update:visibility":function($event){_vm.showDerivation=$event}}}):_vm._e()],1)},staticRenderFns=[function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"col-2"},[_c("div",{staticClass:"building-avatar-block fL"},[_c("div",{staticClass:"building-avatar"},[_c("img",{attrs:{src:__webpack_require__(188742),height:"40px",width:"40px"}})])])])}],toConsumableArray=__webpack_require__(488478),createForOfIteratorHelper=__webpack_require__(566347),objectSpread2=__webpack_require__(595082),AnalayticsFilter=(__webpack_require__(169358),__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(538077),__webpack_require__(670560),__webpack_require__(434284),__webpack_require__(398758)),AnalyticsMixin=__webpack_require__(244936),FNewAnalyticReport=__webpack_require__(794925),FChartCustomization=__webpack_require__(472511),FReportOptions=__webpack_require__(791514),FDerivation=__webpack_require__(486348),NewDateHelper=__webpack_require__(105534),vuex_esm=__webpack_require__(420629),PortfolioAnalysisvue_type_script_lang_js={mixins:[AnalyticsMixin/* default */.Z],components:{AnalayticsFilter:AnalayticsFilter/* default */.Z,FChartCustomization:FChartCustomization/* default */.Z,FNewAnalyticReport:FNewAnalyticReport["default"],FReportOptions:FReportOptions/* default */.Z,Derivation:FDerivation/* default */.Z},data:function(){return{loading:!0,showChartCustomization:!1,chartCustomizationActiveTab:"datapoints",selectedBaseLineId:"",showDerivation:!1,baseLineList:null,oldBaseLine:null,baseLineCasecaderOptions:[],analyticsConfig:{name:"Portfolio Analysis",key:"PORTFOLIO_ANALYSIS",analyticsType:1,type:"reading",period:12,mode:1,baseLine:null,dateFilter:NewDateHelper/* default */.Z.getDatePickerObject(28),chartViewOption:0,dataPoints:[]},collapseState:{buildingEnergy:!0,endUseEnergy:!1,cost:!1,water:!1},reportObject:null,resultObject:null,selectedBuildings:this.$store.getters.getBuildingsPickList()?Object.keys(this.$store.getters.getBuildingsPickList()):null,readingFields:null,buildingWithMeters:[],selectedTab:null}},watch:{getAvailablePeriods:{handler:function(newData,oldData){var _this=this,avail=this.getAvailablePeriods,selected=avail.find((function(a){return a.value===_this.analyticsConfig.period&&a.enable}));if(!selected){var filterName=this.analyticsConfig.dateFilter.operationOn,defaultPeriod=avail.filter((function(a){return a.enable}))[0].value;"week"===filterName||"month"===filterName?defaultPeriod=12:"year"===filterName&&(defaultPeriod=10),this.analyticsConfig.period=defaultPeriod}},immediate:!0},selectedBuildings:function(){this.reportObject&&this.reportObject.options&&this.reportObject.options.common&&(this.reportObject.options.common.buildingIds=this.selectedBuildings)}},created:function(){this.$store.dispatch("loadServiceList"),this.$store.dispatch("loadBuildings")},mounted:function(){this.loadBuildingWithMeters(),this.loadBaselineList(),this.reportId&&this.loadReport()},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({serviceList:function(state){return state.serviceList}})),{},{isSameDataPoint:function(){if(this.analyticsConfig&&this.analyticsConfig.dataPoints.length){var _step,dp={},_iterator=(0,createForOfIteratorHelper/* default */.Z)(this.analyticsConfig.dataPoints);try{for(_iterator.s();!(_step=_iterator.n()).done;){var d=_step.value;dp[d.yAxis.fieldId]=!0}}catch(err){_iterator.e(err)}finally{_iterator.f()}if(1===Object.keys(dp).length)return!0}return!1},getAvailablePeriods:function(){var operationOnId=this.analyticsConfig.dateFilter.operationOnId,avail=[];
// avail.push({
//   name:'Week of year', // W1, W2
//   value: 16,
//   enable: true
// })
// avail.push({
//   name:'Month of year', // Jan, Feb , march
//   value: 15,
//   enable: true
// })
return avail.push({name:this.$t("common.wo_report.high_res"),value:0,enable:6===operationOnId||4!==operationOnId}),avail.push({name:this.$t("common.wo_report.hourly"),value:20,enable:6===operationOnId||4!==operationOnId}),avail.push({name:this.$t("common._common.daily"),value:12,enable:!0}),avail.push({name:this.$t("common._common.weekly"),value:11,enable:6===operationOnId||(3===operationOnId||4===operationOnId)}),avail.push({name:this.$t("common._common.monthly"),value:10,enable:!0}),avail.push({name:this.$t("common.products.quarterly"),value:25,enable:4===operationOnId||5===operationOnId}),avail.push({name:this.$t("common._common.yearly"),value:8,enable:4===operationOnId}),avail.push({name:this.$t("common.header.hour_of_day"),
// 12, 1, 2, 3
value:19,enable:!0}),avail.push({name:this.$t("common.header.day_of_week"),
// sun, mon
value:17,enable:!0}),avail.push({name:this.$t("common.header.day_of_month"),
// 1,2,3
value:18,enable:!0}),avail},serviceWithMeters:function(){var _this2=this;if(this.serviceList){var filteredServiceList={},_loop=function(serviceId){var _step2,serviceName=_this2.serviceList[serviceId],_iterator2=(0,createForOfIteratorHelper/* default */.Z)(_this2.buildingWithMeters);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var building=_step2.value;if(-1!==_this2.selectedBuildings.indexOf(building.id)||-1!==_this2.selectedBuildings.indexOf(building.id+"")){var rootServiceMeter=building.rootServiceMeters?building.rootServiceMeters.find((function(sm){return sm.purpose.id===parseInt(serviceId)})):null;rootServiceMeter&&(filteredServiceList[serviceId]=serviceName)}}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}};for(var serviceId in this.serviceList)_loop(serviceId);return filteredServiceList}return{}}}),methods:{loadBuildingWithMeters:function(){var self=this;self.loading=!0,self.$http.get("/report/energy/portfolio/getAllBuildings").then((function(response){var reportData=response.data.reportData;if(reportData)if(self.buildingWithMeters=reportData.buildingDetails,self.buildingWithMeters&&self.buildingWithMeters.length){var _step3,_iterator3=(0,createForOfIteratorHelper/* default */.Z)(self.buildingWithMeters);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var b=_step3.value;if(b.rootMeter){self.$util.loadAssetReadingFields(b.rootMeter.id).then((function(readingFields){self.readingFields=readingFields,self.loading=!1}));break}}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}}else self.loading=!1}))},loadBaselineList:function(){var self=this;self.$http.get("/baseline/all").then((function(response){if(200===response.status){self.baseLineList=response.data?response.data:[],self.baseLineCasecaderOptions=[],self.baseLineCasecaderOptions.push({label:"None",value:-1});var _step4,_iterator4=(0,createForOfIteratorHelper/* default */.Z)(self.baseLineList);try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var b=_step4.value,children=null;"PREVIOUS_MONTH"===b.rangeTypeEnum||"ANY_MONTH"===b.rangeTypeEnum?children=[{label:"Same date",value:5},{label:"Same week",value:2}]:"PREVIOUS_YEAR"!==b.rangeTypeEnum&&"ANY_YEAR"!==b.rangeTypeEnum||(children=[{label:"Same date",value:4},{label:"Same week",value:2}]),"PREVIOUS"!==b.rangeTypeEnum&&self.baseLineCasecaderOptions.push({label:b.name,value:b.id,children:children})}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}}}))},showBuildingDataPoints:function(pointName,aggregation){var self=this,dataPoints=[];if(self.readingFields){var readingField=self.readingFields.find((function(rt){return rt.displayName===pointName}));if(readingField){if(readingField&&this.buildingWithMeters&&this.buildingWithMeters.length){var _step5,_iterator5=(0,createForOfIteratorHelper/* default */.Z)(this.buildingWithMeters);try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var building=_step5.value;-1===this.selectedBuildings.indexOf(building.id)&&-1===this.selectedBuildings.indexOf(building.id+"")||!building.rootMeter||dataPoints.push({yAxis:{fieldId:readingField.id,aggr:aggregation||3},parentId:building.rootMeter.id})}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}}this.analyticsConfig.dataPoints=dataPoints,this.selectedTab=pointName}else this.$message.error(this.$t("common.products.no")+pointName+this.$t("common.header.reading_available"))}else this.$message.error(this.$t("common.products.no_root_meters_configured"))},showServiceDataPoints:function(serviceId,pointName,aggregation){var self=this,dataPoints=[],readingField=self.readingFields.find((function(rt){return rt.displayName===(pointName||"Energy")}));if(readingField&&this.buildingWithMeters&&this.buildingWithMeters.length){var _step6,_iterator6=(0,createForOfIteratorHelper/* default */.Z)(this.buildingWithMeters);try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var building=_step6.value;if(-1!==this.selectedBuildings.indexOf(building.id)||-1!==this.selectedBuildings.indexOf(building.id+"")){var rootServiceMeter=building.rootServiceMeters?building.rootServiceMeters.find((function(sm){return sm.purpose.id===parseInt(serviceId)})):null;rootServiceMeter&&dataPoints.push({yAxis:{fieldId:readingField.id,aggr:aggregation||3},parentId:rootServiceMeter.id})}}}catch(err){_iterator6.e(err)}finally{_iterator6.f()}}dataPoints&&dataPoints.length?this.analyticsConfig.dataPoints=dataPoints:this.$message.error(this.$t("common.products.no_root_meter_configured_end_use"))},showChartCustomizationDialog:function(defaultTab){this.showChartCustomization=!0,defaultTab&&(this.chartCustomizationActiveTab=defaultTab)},hideChartCustomizationDialog:function(){this.showChartCustomization=!1},reportLoaded:function(report,result){this.reportObject=report,this.resultObject=result,report.options.common&&report.options.common.buildingIds&&(!report.options.common.buildingIds.length&&this.selectedBuildings?this.reportObject.options.common.buildingIds=this.selectedBuildings:(this.selectedBuildings=report.options.common.buildingIds,this.$refs["buildings-filter"].updateSelectedBuilding(report.options.common.buildingIds)))},onPeriodChange:function(){if(!this.analyticsConfig.dataPoints.length){var filter="M";0===this.analyticsConfig.period&&(filter="D"),20===this.analyticsConfig.period?filter="W":10===this.analyticsConfig.period&&(filter="Y"),this.analyticsConfig.dateFilter=this.getDefaultDateFilter(filter)}},onModeChange:function(){1!==this.analyticsConfig.mode&&(this.analyticsConfig.dataPoints=this.analyticsConfig.dataPoints.filter((function(dp){return 2!==dp.type})))},onBaseLineChange:function(newBaseLine){var _this3=this;if(!this.oldBaseLine||this.oldBaseLine[0]!==newBaseLine[0]){if(this.oldBaseLine&&-1!==this.oldBaseLine[0]){var oldBlName=this.baseLineList.find((function(bl){return bl.id===_this3.oldBaseLine[0]})).name,dp=this.reportObject.options.dataPoints.find((function(dp){return dp.baseLineName===oldBlName}));if(!this.checkAndDeletePointsRel(this.reportObject.options,dp.alias))return this.$message.error(dp.baseLineName+this.$t("common.header.has_been_derivation_please_delete_derivation")),void this.$set(this.analyticsConfig,"baseLine",this.oldBaseLine)}this.oldBaseLine=(0,toConsumableArray/* default */.Z)(newBaseLine),this.$set(this.analyticsConfig,"baseLine",newBaseLine)}}}},newTools_PortfolioAnalysisvue_type_script_lang_js=PortfolioAnalysisvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(newTools_PortfolioAnalysisvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,PortfolioAnalysis=component.exports},
/***/857539:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"0c4c867eeab407b0ed9771b49db7359e.svg";
/***/}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/53524.js.map