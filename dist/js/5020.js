(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[5020],{
/***/426803:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return User}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/avatar/User.vue?vue&type=template&id=c662fbbc
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.userObj?_c("div",{staticClass:"inline"},[_c("div",{staticClass:"fc-avatar-element q-item-division relative-position"},[_c("div",{staticClass:"q-item-side-left q-item-section"},[_vm.showPopover&&-1!==_vm.userObj.id?_c("avatarPopover",{attrs:{user:_vm.userObj,moduleName:_vm.moduleName}},[_c("span",{attrs:{slot:"reference"},slot:"reference"},[_c("avatar",{attrs:{size:_vm.size,user:_vm.userObj,color:_vm.color}})],1)]):_c("span",[_c("avatar",{attrs:{size:_vm.size,user:_vm.userObj,color:_vm.color}})],1)],1),_vm.showLabel?[_vm.user&&_vm.user.id>0||_vm.group&&_vm.group.id>0?_c("div",{staticClass:"wo-team-txt"},[_c("div",{staticClass:"assignment-avatar-name",class:{"color-d":!_vm.user}},[_vm._v(" "+_vm._s(_vm.user&&_vm.user.id>0?_vm.user.name||(_vm.users.find((function(usr){return usr.id===_vm.user.id}))||{}).name:"---")+" ")]),_c("div",{staticClass:"assignment-group-name",class:{"color-d":!_vm.group}},[_vm._v(" "+_vm._s(_vm.group?_vm.group.name||(_vm.$store.getters.getGroup(_vm.group.id)||{}).name:"---")+" ")])]):_c("div",{staticClass:"wo-team-txt",staticStyle:{"padding-top":"7px","font-size":"14px",color:"#aaa","letter-spacing":"0.2px"}},[_vm._v(" ---/--- ")])]:0!=_vm.name?_c("div",[_c("div",[_c("span",{staticClass:"q-item-label d-flex flex-wrap"},[_vm._v(_vm._s(_vm.userObj.name))])])]):_vm._e()],2)]):_vm._e()},staticRenderFns=[],objectSpread2=__webpack_require__(595082),Avatar=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(574752)),AvatarPopovervue_type_template_id_8ef9b9ec_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"avatar-popover-container"},[_c("el-popover",{ref:"popover1",staticStyle:{display:"block",padding:"0"},attrs:{placement:"top-start",trigger:"hover",width:"383",clas:"avatar-popover","popper-class":"avatar-popover",height:_vm.defaultheight,"open-delay":600},model:{value:_vm.popoverShown,callback:function($$v){_vm.popoverShown=$$v},expression:"popoverShown"}},[_c("div",{staticClass:"popover-content-block"},[_c("div",{staticClass:"popover-avatar"},[_c("avatar",{attrs:{size:_vm.size,user:_vm.user,color:_vm.color,showPopover:!1}})],1),_c("div",{staticClass:"popover-avatar-det"},[_c("div",{staticClass:"avatar-name-txt"},[_vm._v(" "+_vm._s(_vm.user.name?_vm.user.name:"----")+" ")]),_c("div",{staticClass:"mail-block"},[_c("img",{staticClass:"envelope-icon",staticStyle:{height:"13px","vertical-align":"middle"},attrs:{src:__webpack_require__(702638)}}),_c("span",{staticClass:"mail-txt"},[_vm._v(_vm._s(_vm.user.email?_vm.user.email:"----")+" ")])]),_c("div",[_c("img",{staticClass:"envelope-icon",staticStyle:{height:"15px"},attrs:{src:__webpack_require__(47424)}}),_c("span",{staticClass:"popover-phone-number"},[_vm._v(" "+_vm._s(_vm.user.mobile?_vm.user.mobile:"----")+" ")])])]),"workorder"===_vm.moduleName?_c("div",{staticClass:"popover-footer"},[_c("ul",[_c("li",{staticClass:"popover-footer-list",on:{click:function($event){return _vm.getOpen("open")}}},[_c("div",{staticClass:"open-result-txt"},[_vm._v(" "+_vm._s(_vm.result.openWorkOrdersCount)+" ")]),_c("div",{staticClass:"result-txt-black"},[_vm._v("OPEN")])]),_c("li",{staticClass:"popover-footer-list border-RL",on:{click:function($event){return _vm.getOpen("overdue")}}},[_c("div",{staticClass:"overdue-result-txt"},[_vm._v(" "+_vm._s(_vm.result.overDueWorkOrdersCount)+" ")]),_c("div",{staticClass:"result-txt-black"},[_vm._v("OVERDUE")])]),_c("li",{staticClass:"popover-footer-list",on:{click:function($event){return _vm.getOpen("duetoday")}}},[_c("div",{staticClass:"dueday-result-txt"},[_vm._v(" "+_vm._s(_vm.result.dueTodayWorkOrdersCount)+" ")]),_c("div",{staticClass:"result-txt-black"},[_vm._v("DUE TODAY")])])])]):_vm._e()]),_c("template",{slot:"reference"},[_vm._t("reference")],2)],2)],1)},AvatarPopovervue_type_template_id_8ef9b9ec_staticRenderFns=[],AvatarPopovervue_type_script_lang_js=(__webpack_require__(670560),__webpack_require__(648324),{props:["size","user","color","name","moduleName"],data:function(){return{defaultheight:"230px",result:{},popoverShown:!1,viewname:""}},components:{Avatar:Avatar["default"]},mounted:function(){
// this.showPopover = this.showpopoverFooter
this.moduleName&&(this.defaultheight="160px")},watch:{popoverShown:function(val){val&&this.userOpenDatas()}},methods:{userOpenDatas:function(){var self=this;self.$http.post("/widget/getUserCardData",{ouid:this.user.id}).then((function(response){200===response.status&&(self.result=response.data.result)}))},getOpen:function(viewName){var filter={assignedTo:{operator:"is",value:[this.user.id+""]}};this.$router.push("/app/wo/orders/"+viewName+"?search="+encodeURIComponent(JSON.stringify(filter)))}}}),components_AvatarPopovervue_type_script_lang_js=AvatarPopovervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_AvatarPopovervue_type_script_lang_js,AvatarPopovervue_type_template_id_8ef9b9ec_render,AvatarPopovervue_type_template_id_8ef9b9ec_staticRenderFns,!1,null,null,null)
/* harmony default export */,AvatarPopover=component.exports,vuex_esm=__webpack_require__(420629),Uservue_type_script_lang_js={created:function(){this.$store.dispatch("loadGroups")},components:{Avatar:Avatar["default"],AvatarPopover:AvatarPopover},props:{size:{type:String},user:{type:Object},avatarStyle:{type:Object},name:{type:Boolean,default:function(){return!0}},showLabel:{type:Boolean},showPopover:{type:Boolean},moduleName:{type:String},group:{type:Object},hovercard:{type:Boolean}},data:function(){return{hoverCardId:"userHoverCardId-"+(this.user?this.user.id:"unkown"),loadHoverCardData:!1,labelStatus:this.hideLabel}},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({users:function(state){return state.users}})),{},{userObj:function(){var _this=this,hasUser=this.user&&this.user.id>0,user=hasUser?this.$getProperty(this.user,"name")?this.user:this.users.find((function(usr){return usr.id===_this.user.id})):null;return user||{id:-1,name:"Unknown"}},color:function(){return-1!==this.userObj.id?"":this.group?"#c3c3c3":"#e3e3e3"}}),methods:{loadHoverCard:function(){this.loadHoverCardData=!0},hideHoverCard:function(){this.loadHoverCardData=!1}}},avatar_Uservue_type_script_lang_js=Uservue_type_script_lang_js,User_component=(0,componentNormalizer/* default */.Z)(avatar_Uservue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,User=User_component.exports},
/***/786113:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return WorkOrderSpecialFieldsList}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/list/WorkOrderSpecialFieldsList.vue?vue&type=template&id=c5129894
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",["resource"===_vm.field.name?_c("div",{staticClass:"q-item-division relative-position",staticStyle:{"min-width":"170px"}},[_vm.$validation.isEmpty(_vm.moduleData.resource)||_vm.$validation.isEmpty(_vm.moduleData.resource.id)?_c("div",[_c("span",{staticClass:"q-item-label secondary-color color-d"},[_vm._v("--- "+_vm._s(_vm.$t("maintenance.wr_list.space_asset"))+" ---")])]):_c("div",[_c("div",{staticClass:"flLeft mR7"},[1===_vm.moduleData.resource.resourceType?_c("img",{staticStyle:{height:"12px",width:"14px"},attrs:{src:__webpack_require__(572902)}}):_c("img",{staticStyle:{height:"11px",width:"14px"},attrs:{src:__webpack_require__(30684)}})]),_c("span",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"flLeft q-item-label ellipsis max-width140px",attrs:{small:"","data-position":"bottom",title:_vm.moduleData.resource.name}},[_vm._v(_vm._s(_vm.moduleData.resource.name))])])]):"assignedTo"===_vm.field.name?_c("div",{staticClass:"q-item-division relative-position wo_assignedto_avatarblock"},[_c("div",{staticClass:"wo-assigned-avatar fL"},[_c("user-avatar",{attrs:{size:"md",user:_vm.moduleData.assignedTo,group:_vm.moduleData.assignmentGroup,showLabel:!0,moduleName:"lookupModuleName"}})],1)]):"noOfNotes"===_vm.field.name?_c("div",[_vm._m(0),_c("span",{staticClass:"width5px q-item-sublabel comment-counnt-txt"},[_vm._v(_vm._s(_vm.notesLabel))])]):"noOfTasks"===_vm.field.name?_c("div",[_vm.canShowTaskIcon?_c("inline-svg",{staticClass:"vertical-middle cursor-pointer",attrs:{src:"svgs/task-list",iconClass:"icon icon-sm mT5 mR5 task-icon"}}):_vm._e(),_c("span",{staticClass:"q-item-sublabel pL5"},[_vm._v(_vm._s(_vm.taskLabel))])],1):"noOfAttachments"===_vm.field.name?_c("div",{staticStyle:{float:"left"}},[_vm._m(1),_c("span",{staticClass:"width5px q-item-sublabel comment-counnt-txt"},[_vm._v(_vm._s(_vm.attachmentLabel))])]):_vm._e()])},staticRenderFns=[function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("span",[_c("img",{staticStyle:{width:"14px",height:"12.8px"},attrs:{src:__webpack_require__(293656)}})])},function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("span",[_c("img",{staticStyle:{width:"14px",height:"12.8px"},attrs:{src:__webpack_require__(345265)}})])}],User=(__webpack_require__(634338),__webpack_require__(426803)),validation=__webpack_require__(990260),WorkOrderSpecialFieldsListvue_type_script_lang_js={components:{UserAvatar:User/* default */.Z},props:["field","moduleData"],computed:{canShowTaskIcon:function(){var moduleData=this.moduleData;return!(0,validation/* isEmpty */.xb)(moduleData.noOfTasks)&&0!==moduleData.noOfNotes},taskLabel:function(){var moduleData=this.moduleData,noOfTasks=moduleData.noOfTasks,noOfNotes=moduleData.noOfNotes,noOfClosedTasks=moduleData.noOfClosedTasks,taskLabel="---";return(0,validation/* isEmpty */.xb)(noOfTasks)||0===noOfNotes?taskLabel:(0,validation/* isEmpty */.xb)(noOfClosedTasks)?"0":"".concat(noOfClosedTasks,"/").concat(noOfTasks)},notesLabel:function(){var moduleData=this.moduleData,noOfNotes=moduleData.noOfNotes;return(0,validation/* isEmpty */.xb)(noOfNotes)||0===noOfNotes?"0":moduleData.noOfNotes},attachmentLabel:function(){var moduleData=this.moduleData,_ref=moduleData||{},noOfAttachments=_ref.noOfAttachments;return(0,validation/* isEmpty */.xb)(noOfAttachments)||0===noOfAttachments?"0":noOfAttachments}}},list_WorkOrderSpecialFieldsListvue_type_script_lang_js=WorkOrderSpecialFieldsListvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(list_WorkOrderSpecialFieldsListvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,WorkOrderSpecialFieldsList=component.exports},
/***/806339:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return WidgetPagination}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/page/widget/utils/WidgetPagination.vue?vue&type=template&id=6b10cd5b
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"fc-widget-pagination"},[_vm.total>0?_c("div",{class:{"fc-black-small-txt-12":!_vm.hideToggle}},[_vm.from!==_vm.to?_c("span",[_vm._v(_vm._s(_vm.from)+" -")]):_vm._e(),_c("span",[_vm._v(_vm._s(_vm.to))]),_vm.hideToggle?_vm._e():[_vm._v(" of "+_vm._s(_vm.total)+" "),_c("span",{staticClass:"el-icon-arrow-left fc-black-small-txt-12 fw-bold f16 pointer mL10 mR5",class:{disable:_vm.from<=1},on:{click:function($event){_vm.from>1&&_vm.prev()}}}),_c("span",{staticClass:"el-icon-arrow-right fc-black-small-txt-12 f16 pointer mR10 fw-bold",class:{disable:_vm.to===_vm.total},on:{click:function($event){_vm.to!==_vm.total&&_vm.next()}}})]],2):_vm._e()])},staticRenderFns=[],WidgetPaginationvue_type_script_lang_js={props:["currentPage","perPage","total","hideToggle"],data:function(){return{from:0,to:0,page:1}},mounted:function(){this.init()},watch:{total:function(){this.init()},currentPage:function(val){val!==this.page&&this.init()}},methods:{init:function(){this.page=this.currentPage||1,this.from=(this.page-1)*this.perPage+1;var to=this.from+this.perPage-1;this.to=this.total>to?to:this.total},next:function(){this.from=this.to+1,this.to+=this.perPage,this.to>this.total&&(this.to=this.total),this.page++,this.updateCurrentPage()},prev:function(){this.to=this.from-1,this.from-=this.perPage,this.from<=1?this.from=this.page=1:this.page--,this.updateCurrentPage()},updateCurrentPage:function(){
// Update currentPage value
this.$emit("update:currentPage",this.page),this.$emit("onChange")}}},utils_WidgetPaginationvue_type_script_lang_js=WidgetPaginationvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(utils_WidgetPaginationvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,WidgetPagination=component.exports},
/***/169251:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return AddKpi}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/energy/kpi/components/AddKpi.vue?vue&type=template&id=1e7f8f11&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticStyle:{"z-index":"999999"},attrs:{visible:!0,fullscreen:!0,"append-to-body":!0,"custom-class":"fc-dialog-form fc-dialog-right setup-dialog50 setup-dialog","before-close":_vm.closeDialog}},[_c("div",{staticClass:"kpi-modal"},[_c("el-form",{ref:"categoryForm",staticClass:"fc-form",attrs:{model:_vm.newkpi,rules:_vm.rules,"label-position":"top"}},[_c("div",{staticClass:"new-header-container"},[_c("div",{staticClass:"new-header-text"},[_c("div",{staticClass:"fc-setup-modal-title"},[_vm._v(" "+_vm._s(_vm.isNew?_vm.$t("common._common.new"):_vm.$t("common._common._edit"))+" "+_vm._s(_vm.$t("common.header.kpi_definition"))+" ")])])]),_c("div",{staticClass:"new-body-modal enpi-body-modal"},[_c("div",{staticClass:"body-scroll pR10"},[_c("el-row",{staticClass:"mB10",attrs:{gutter:20}},[_c("el-col",{attrs:{span:24}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.$t("common._common.kpi_name"))+" ")]),_c("el-form-item",{attrs:{prop:"name"}},[_c("el-input",{staticClass:"width100 fc-input-full-border2",attrs:{autofocus:"",type:"text",autocomplete:"off",placeholder:_vm.$t("common._common.enter_kpi_name")},model:{value:_vm.newkpi.name,callback:function($$v){_vm.$set(_vm.newkpi,"name",$$v)},expression:"newkpi.name"}})],1)],1)],1),_c("el-row",{staticClass:"mB10",attrs:{gutter:20}},[_c("el-col",{attrs:{span:24}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.report_description"))+" ")]),_c("el-form-item",[_c("el-input",{staticClass:"width100 fc-input-full-border-textarea",attrs:{type:"textarea",autosize:{minRows:4,maxRows:4},placeholder:_vm.$t("common._common.enter_desc"),resize:"none"},model:{value:_vm.newkpi.description,callback:function($$v){_vm.$set(_vm.newkpi,"description",$$v)},expression:"newkpi.description"}})],1)],1)],1),_c("el-row",{staticClass:"mB10",attrs:{gutter:20}},[_c("el-col",{attrs:{span:24}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.$t("common.header.kpi_category"))+" ")]),_c("el-form-item",{staticClass:"category-autocomplete",attrs:{prop:"kpiCategoryName"}},[_c("el-select",{staticClass:"fc-input-full-border2 width300px",attrs:{filterable:"",placeholder:_vm.$t("common.products.select_kpi_category"),disabled:!_vm.isNew},model:{value:_vm.newkpi.kpiCategoryName,callback:function($$v){_vm.$set(_vm.newkpi,"kpiCategoryName",$$v)},expression:"newkpi.kpiCategoryName"}},_vm._l(_vm.kpiCategory,(function(category){return _c("el-option",{key:category.value,attrs:{label:category.label,value:category.label}})})),1),_vm.isNew?_c("el-button",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"inline mL10",attrs:{title:_vm.$t("common.products.add_kpi_category")},on:{click:_vm.showAddCategoryDialog}},[_c("inline-svg",{attrs:{src:"svgs/add",iconClass:"icon icon-xxs"}})],1):_vm._e()],1)],1)],1),_c("el-row",{staticClass:"mB10"},[_c("el-col",{attrs:{span:12}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.$t("common.products.site"))+" ")]),_c("Lookup",{attrs:{field:_vm.siteField,hideLookupIcon:!0,disabled:!_vm.isNew},model:{value:_vm.newkpi.siteId,callback:function($$v){_vm.$set(_vm.newkpi,"siteId",$$v)},expression:"newkpi.siteId"}})],1)],1),_c("el-row",{staticClass:"mB10"},[_c("el-col",{attrs:{span:24}},[_c("p",{staticClass:"fc-input-label-txt mT10"},[_vm._v(" "+_vm._s(_vm.$t("common._common.type"))+" ")]),_c("el-radio",{staticClass:"fc-radio-btn",attrs:{disabled:!_vm.isNew,value:_vm.$t("common.space_asset_chooser.space"),label:"space"},model:{value:_vm.kpiType,callback:function($$v){_vm.kpiType=$$v},expression:"kpiType"}},[_vm._v(_vm._s(_vm.$t("common.space_asset_chooser.space")))]),_c("el-radio",{staticClass:"fc-radio-btn",attrs:{disabled:!_vm.isNew,label:"asset",value:_vm.$t("common._common.asset")},model:{value:_vm.kpiType,callback:function($$v){_vm.kpiType=$$v},expression:"kpiType"}},[_vm._v(_vm._s(_vm.$t("common._common.asset")))])],1)],1),_c("el-row",{staticClass:"mT30",attrs:{gutter:20}},["asset"===_vm.kpiType?[_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.$t("common._common.category"))+" ")]),_c("el-form-item",{attrs:{prop:"assetCategoryId"}},[_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{disabled:!_vm.isNew,filterable:"",placeholder:_vm.$t("common.products.select_category")},model:{value:_vm.newkpi.assetCategoryId,callback:function($$v){_vm.$set(_vm.newkpi,"assetCategoryId",$$v)},expression:"newkpi.assetCategoryId"}},_vm._l(_vm.assetCategory,(function(category,index){return _c("el-option",{key:index,attrs:{label:category.displayName,value:parseInt(category.id)}})})),1)],1)],1),_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.$t("common.products.asset_s"))+" ")]),_c("FLookupField",{staticClass:"resource-field",attrs:{model:_vm.newkpi.includedResources,field:_vm.spaceAssetField,siteId:_vm.newkpi.siteId,categoryId:_vm.newkpi.assetCategoryId,disabled:!_vm.isNew||!_vm.newkpi.assetCategoryId},on:{"update:model":function($event){return _vm.$set(_vm.newkpi,"includedResources",$event)},showLookupWizard:_vm.showLookupWizard}})],1)]:_c("el-col",{attrs:{span:12}},[[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.$t("common.space_asset_chooser.space"))+" ")]),_c("el-form-item",{attrs:{prop:"resourceId"}},[_c("FLookupField",{staticClass:"resource-field",attrs:{model:_vm.newkpi.resourceId,field:_vm.spaceAssetField,siteId:_vm.newkpi.siteId,disabled:!_vm.isNew},on:{"update:model":function($event){return _vm.$set(_vm.newkpi,"resourceId",$event)},showLookupWizard:_vm.showLookupWizard}})],1)]],2)],2),_c("el-row",[_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"fc-input-label-txt mT30"},[_vm._v(" "+_vm._s(_vm.$t("common._common.frequency"))+" ")]),_c("el-form-item",{attrs:{prop:"frequency"}},[_c("el-select",{staticClass:"fc-input-full-border2 width100",attrs:{placeholder:_vm.$t("common._common.choose_frequency"),disabled:!_vm.isNew},model:{value:_vm.newkpi.frequency,callback:function($$v){_vm.$set(_vm.newkpi,"frequency",$$v)},expression:"newkpi.frequency"}},_vm._l(_vm.frequencyTypes,(function(label,value){return _c("el-option",{key:value,attrs:{label:label,value:parseInt(value)}})})),1)],1)],1)],1),_c("el-row",{staticClass:"mB20"},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"fc-input-label-txt mT30 pB20"},[_vm._v(" "+_vm._s(_vm.$t("commissioning.sheet.header_unit"))+" ")]),_c("el-radio",{staticClass:"fc-radio-btn",attrs:{label:"choose",value:_vm.$t("common.text.choose")},model:{value:_vm.unit,callback:function($$v){_vm.unit=$$v},expression:"unit"}},[_vm._v(_vm._s(_vm.$t("common.products.choose_unit")))]),_c("el-radio",{staticClass:"fc-radio-btn",attrs:{label:"custom",value:_vm.$t("common.date_picker.custom")},model:{value:_vm.unit,callback:function($$v){_vm.unit=$$v},expression:"unit"}},[_vm._v(_vm._s(_vm.$t("common.header.custom_unit")))])],1)],1),_c("el-row",[_c("el-col",{attrs:{span:24}},["custom"===_vm.unit?_c("el-col",{attrs:{span:12}},[_c("el-input",{staticClass:"fc-input-full-border2",attrs:{type:"text",placeholder:_vm.$t("common._common.enter_unit")},model:{value:_vm.formulaFieldUnit,callback:function($$v){_vm.formulaFieldUnit=$$v},expression:"formulaFieldUnit"}})],1):[_c("el-col",{staticClass:"pR5",attrs:{span:12}},[_c("el-select",{staticClass:"fc-input-full-border2 width100",attrs:{filterable:"",placeholder:_vm.$t("common.products.select_metric")},on:{change:function($event){return _vm.loadUnit(_vm.metricsUnits)}},model:{value:_vm.metricId,callback:function($$v){_vm.metricId=$$v},expression:"metricId"}},_vm._l(_vm.metricsUnits.metrics,(function(metric,index){return _c("el-option",{key:index,attrs:{label:metric.name,value:metric.metricId}})})),1)],1),_c("el-col",{staticClass:"pL5",attrs:{span:12}},[_c("el-select",{staticClass:"fc-input-full-border2 width100",attrs:{disabled:!_vm.metricId,placeholder:_vm.$t("common.products.select_unit")},model:{value:_vm.unitId,callback:function($$v){_vm.unitId=$$v},expression:"unitId"}},_vm._l(_vm.hasMetricName,(function(unit,index){return _c("el-option",{key:index,attrs:{label:unit.displayName+" ("+unit.symbol+")",value:unit.unitId}})})),1)],1)]],2)],1),_c("el-row",[_c("el-col",{staticClass:"flex align-center"},[_c("div",{staticClass:"fc-input-label-txt mT30 pB20 pR30"},[_vm._v(" "+_vm._s(_vm.$t("kpi.kpi.is_v2"))+" "),_c("el-switch",{attrs:{"active-color":"rgba(57, 178, 194, 0.8)","inactive-color":"#e5e5e5"},model:{value:_vm.isV2,callback:function($$v){_vm.isV2=$$v},expression:"isV2"}})],1)])],1),_vm.isV2?_c("el-form-item",{attrs:{prop:"workflow"}},[_c("div",{staticClass:"height250 overflow-y-scroll width90 pB50 script-line-height"},[_c("CodeMirror",{attrs:{codeeditor:!0},model:{value:_vm.workflowV2String,callback:function($$v){_vm.workflowV2String=$$v},expression:"workflowV2String"}})],1)]):_c("el-form-item",{attrs:{prop:"workflow"}},[_c("div",{staticClass:"mT5 line-height20 pR20"},[_c("f-formula-builder",{attrs:{isNew:_vm.isNew,assetCategory:{id:_vm.newkpi.assetCategoryId},module:"enpi"},model:{value:_vm.newkpi.workflow,callback:function($$v){_vm.$set(_vm.newkpi,"workflow",$$v)},expression:"newkpi.workflow"}})],1)])],1)]),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){return _vm.closeDialog()}}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_vm.isV2?_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.saving},on:{click:function($event){return _vm.submitV2Form()}}},[_vm._v(_vm._s(_vm.saving?_vm.$t("common._common._saving"):_vm.$t("common._common._save")))]):_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.saving},on:{click:function($event){return _vm.submitForm()}}},[_vm._v(_vm._s(_vm.saving?_vm.$t("common._common._saving"):_vm.$t("common._common._save")))])],1)]),_vm.canShowLookupWizard?_c("FLookupFieldWizard",{attrs:{canShowLookupWizard:_vm.canShowLookupWizard,selectedLookupField:_vm.selectedLookupField,siteId:_vm.newkpi.siteId,categoryId:_vm.newkpi.assetCategoryId},on:{"update:canShowLookupWizard":function($event){_vm.canShowLookupWizard=$event},"update:can-show-lookup-wizard":function($event){_vm.canShowLookupWizard=$event},setLookupFieldValue:_vm.setLookupFieldValue}}):_vm._e(),_vm.canShowCategoryDialog?_c("AddKpiCategory",{attrs:{category:{}},on:{onCategoryCreate:_vm.refreshCategories,onClose:function($event){_vm.canShowCategoryDialog=!1}}}):_vm._e()],1)])},staticRenderFns=[],toConsumableArray=__webpack_require__(488478),objectSpread2=__webpack_require__(595082),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),FFormulaBuilder=(__webpack_require__(821057),__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(434284),__webpack_require__(450886),__webpack_require__(538077),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(891719),__webpack_require__(659749),__webpack_require__(386544),__webpack_require__(902294)),AddKpiCategoryvue_type_template_id_26e6c5c9_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"fc-dialog-center-container kpi-details",staticStyle:{"z-index":"999999"},attrs:{visible:!0,"append-to-body":!0,title:_vm.$t("common.products.add_kpi_category"),"custom-class":"setup-dialog35","before-close":_vm.cancel}},[_c("el-row",[_c("el-col",[_c("div",{staticClass:"fc-input-label-txt mb5"},[_vm._v(" "+_vm._s(_vm.$t("common._common.category_name"))+" ")]),_c("div",[_c("el-input",{staticClass:"fc-input-full-border2 pB100",model:{value:_vm.kpiCategory.name,callback:function($$v){_vm.$set(_vm.kpiCategory,"name",$$v)},expression:"kpiCategory.name"}})],1)])],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){return _vm.cancel()}}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:function($event){return _vm.save()}}},[_vm._v(_vm._s(_vm.kpiCategory.id?_vm.$t("common._common.update"):_vm.$t("common._common.add")))])],1)],1)},AddKpiCategoryvue_type_template_id_26e6c5c9_staticRenderFns=[],AddKpiCategoryvue_type_script_lang_js={props:["category"],data:function(){return{loading:!1,kpiCategory:{name:""}}},created:function(){this.kpiCategory=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},this.kpiCategory),this.category)},methods:{save:function(){var _this=this;this.loading=!0;var params={kpiCategory:{name:this.kpiCategory.name}};this.$http.post("v2/kpi/category/add",params).then((function(response){0===response.data.responseCode&&_this.$emit("onCategoryCreate",response.data.result.kpiCategoryContext.id)})).catch((function(){var error=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_this.loading=!1,_this.$message.error(error.message||_this.$t("common._common.error_while_creatingkpi_category"))}))},cancel:function(){this.$emit("onClose")}}},components_AddKpiCategoryvue_type_script_lang_js=AddKpiCategoryvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_AddKpiCategoryvue_type_script_lang_js,AddKpiCategoryvue_type_template_id_26e6c5c9_render,AddKpiCategoryvue_type_template_id_26e6c5c9_staticRenderFns,!1,null,null,null)
/* harmony default export */,AddKpiCategory=component.exports,FLookupField=__webpack_require__(855048),FLookupFieldWizard=__webpack_require__(499751),vuex_esm=__webpack_require__(420629),validation=__webpack_require__(990260),find=__webpack_require__(313311),find_default=__webpack_require__.n(find),picklist=__webpack_require__(961358),CodeMirror=__webpack_require__(919324),api=__webpack_require__(32284),ui_forms=__webpack_require__(141323),siteField={isDataLoading:!0,options:[],lookupModuleName:"site",field:{lookupModule:{name:"site",displayName:"Sites"}},placeHolderText:"All Sites",multiple:!1,additionalParams:{orderBy:"spaceType",orderType:"asc"}},safeLimitTypes={MIN:0,MAX:1,BETWEEN:2,NONE:-99},AddKpivue_type_script_lang_js={components:{Lookup:ui_forms/* Lookup */.tY,FFormulaBuilder:FFormulaBuilder/* default */.Z,AddKpiCategory:AddKpiCategory,FLookupField:FLookupField/* default */.Z,FLookupFieldWizard:FLookupFieldWizard["default"],CodeMirror:CodeMirror/* default */.Z},props:["isNew","kpi"],data:function(){return{siteField:siteField,isV2:!1,kpiCategory:null,metricsUnits:{},saving:!1,formulaFieldUnit:"",unit:"choose",metricId:null,metricName:"",unitId:null,kpiType:"space",safeLimitType:safeLimitTypes.MIN,newkpi:{name:"",description:"",siteId:null,kpiCategoryName:null,resourceId:null,frequency:null,triggerType:1,formulaFieldType:1,resourceType:1,resultDataType:3,workflow:null,assetCategoryId:null,includedResources:[],target:null,minTarget:null},workflowV2String:null,canShowCategoryDialog:!1,safeLimitTypes:safeLimitTypes,canShowLookupWizard:!1,selectedLookupField:null,spaceAssetField:{},rules:{kpiCategoryName:{validator:function(rule,value,callback){(0,validation/* isEmpty */.xb)(find_default()(this.kpiCategory,["label",value]))?callback(new Error(this.$t("common.header.please_select_kpi_category_create_new_category"))):callback()}.bind(this),trigger:"change"},name:{required:!0,message:this.$t("common._common.please_enter_a_name"),trigger:"change"},workflow:{validator:function(rule,value,callback){var _this=this;setTimeout((function(){(0,validation/* isNull */.Ft)(_this.newkpi.workflow)?callback(new Error(_this.$t("common._common.formula_cannot_be_ready"))):callback()}),500)}.bind(this),trigger:"blur"},target:{validator:function(rule,value,callback){this.safeLimitType!==this.safeLimitTypes.MIN&&this.safeLimitType!==this.safeLimitTypes.BETWEEN||((0,validation/* isEmpty */.xb)(this.newkpi.target)?callback(new Error(this.$t("common._common.fields_cannot_be_empty"))):callback())}.bind(this),trigger:"change"},minTarget:{validator:function(rule,value,callback){this.safeLimitType!==this.safeLimitTypes.MAX&&this.safeLimitType!==this.safeLimitTypes.BETWEEN||((0,validation/* isEmpty */.xb)(this.newkpi.minTarget)?callback(new Error(this.$t("common._common.fields_cannot_be_empty"))):callback())}.bind(this),trigger:"change"},frequency:{required:!0,message:this.$t("common.header.please_select_frequency"),trigger:"blur"},resourceId:{validator:function(rule,value,callback){"space"===this.kpiType&&((0,validation/* isEmpty */.xb)(this.newkpi.resourceId)?callback(new Error(this.$t("common.header.please_select_a_space"))):callback())}.bind(this),trigger:"change"},assetCategoryId:{validator:function(rule,value,callback){"asset"===this.kpiType&&((0,validation/* isEmpty */.xb)(this.newkpi.assetCategoryId)?callback(new Error(this.$t("common.header.please_select_an_asset"))):callback())}.bind(this),trigger:"blur"}}}},created:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var _yield$getFieldOption,error,options;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _this2.$store.dispatch("loadAssetCategory"),_this2.$store.dispatch("loadAlarmSeverity"),_context.next=4,(0,picklist/* getFieldOptions */._K)({field:{lookupModuleName:"kpiCategory"}});case 4:_yield$getFieldOption=_context.sent,error=_yield$getFieldOption.error,options=_yield$getFieldOption.options,error?_this2.$message.error(error.message||"Error Occured"):(_this2.kpiCategory=options,_this2.init()),_this2.loadDefaultMetricUnits();case 9:case"end":return _context.stop()}}),_callee)})))()},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({assetCategory:function(state){return state.assetCategory}})),{},{kpiCategoryId:{get:function(){var kpiCategory=this.kpiCategory;if(this.newkpi.kpiCategoryName){var selectedCategory=find_default()(kpiCategory,["label",this.newkpi.kpiCategoryName]);return selectedCategory.value}return-1},set:function(id){var kpiCategory=this.kpiCategory,selectedCategory=find_default()(kpiCategory,["value",id])||[];this.newkpi.kpiCategoryName=selectedCategory.label,this.newkpi.kpiCategoryId=selectedCategory.value}},frequencyTypes:function(){var types={1:"Daily",2:"Weekly",3:"Monthly",6:"Annually",8:"Hourly"};return types},hasMetricName:function(){return(0,validation/* isEmpty */.xb)(this.metricName)||(0,validation/* isEmpty */.xb)(this.metricsUnits.metricWithUnits)?[]:this.metricsUnits.metricWithUnits[this.metricName]}}),watch:{"newkpi.siteId":function(){this.newkpi.includedResources=[]},"newkpi.assetCategoryId":{handler:function(value){var _this3=this;if(!(0,validation/* isEmpty */.xb)(value)){var _this$assetCategory$f=this.assetCategory.find((function(d){return d.id===_this3.newkpi.assetCategoryId})),categoryName=_this$assetCategory$f.name;this.spaceAssetField.placeHolderText="All ".concat(categoryName,"s selected"),this.newkpi.includedResources=[]}}},kpiType:{handler:function(value){var fieldObj={lookupModuleName:value,filters:null,lookupModule:{displayName:value}};"asset"===value?(fieldObj.multiple=!0,this.newkpi.resourceId=null):(this.newkpi.assetCategoryId=null,this.newkpi.includedResources=[]),this.spaceAssetField=fieldObj},immediate:!0}},methods:{init:function(){if(!this.isNew){this.newkpi=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},this.newkpi),this.$helpers.cloneObject(this.kpi)),this.newkpi.kpiCategory>0&&(this.kpiCategoryId=this.newkpi.kpiCategory),this.kpi.matchedResources&&0!==this.kpi.matchedResources.length&&(this.kpiType=1===this.kpi.matchedResources[0].resourceType?"space":"asset");var _this$kpi$readingFiel=this.kpi.readingField,unit=_this$kpi$readingFiel.unit,unitId=_this$kpi$readingFiel.unitId,metric=_this$kpi$readingFiel.metric,metricEnum=_this$kpi$readingFiel.metricEnum;this.formulaFieldUnit=(0,validation/* isEmpty */.xb)(unitId)?unit:null,this.unitId=(0,validation/* isEmpty */.xb)(unitId)?null:unitId,this.metricId=(0,validation/* isEmpty */.xb)(metric)?null:metric,this.metricName=metricEnum,!(0,validation/* isEmpty */.xb)(this.formulaFieldUnit)&&(this.unit="custom");var _this$newkpi=this.newkpi,minTarget=_this$newkpi.minTarget,target=_this$newkpi.target;minTarget=(0,validation/* isEmpty */.xb)(minTarget)?null:minTarget,target=(0,validation/* isEmpty */.xb)(target)?null:target,(0,validation/* isEmpty */.xb)(minTarget)&&(0,validation/* isEmpty */.xb)(target)?this.safeLimitType=safeLimitTypes.NONE:(0,validation/* isEmpty */.xb)(minTarget)?(0,validation/* isEmpty */.xb)(target)?this.safeLimitType=safeLimitTypes.BETWEEN:this.safeLimitType=safeLimitTypes.MIN:this.safeLimitType=safeLimitTypes.MAX,this.$set(this.newkpi,"minTarget",minTarget),this.$set(this.newkpi,"target",target);var workflowScript=this.$getProperty(this,"kpi.workflow.workflowV2String");this.kpi.workflow.isV2Script&&(this.isV2=!0),(0,validation/* isEmpty */.xb)(workflowScript)||(this.workflowV2String=workflowScript,this.$set(this.newkpi.workflow,"workflowV2String",workflowScript)),-1===this.kpi.assetCategoryId&&(this.newkpi.assetCategoryId=null)}},showLookupWizard:function(field,canShow){this.selectedLookupField=field,this.canShowLookupWizard=canShow},setLookupFieldValue:function(props){var field=props.field,_field$options=field.options,options=void 0===_field$options?[]:_field$options,_field$selectedItems=field.selectedItems,selectedItems=void 0===_field$selectedItems?[]:_field$selectedItems,lookupModuleName=field.lookupModuleName,selectedItemIds=[];if(!(0,validation/* isEmpty */.xb)(selectedItems))if(selectedItemIds=selectedItems.map((function(item){return item.value})),(0,validation/* isEmpty */.xb)(options))options=(0,toConsumableArray/* default */.Z)(selectedItems);else{var _options,ids=options.map((function(item){return item.value})),newOptions=selectedItems.filter((function(item){return!ids.includes(item.value)}));(_options=options).unshift.apply(_options,(0,toConsumableArray/* default */.Z)(newOptions))}this.selectedLookupField={},this.$set(this.spaceAssetField,"options",options),"space"===lookupModuleName?this.newkpi.resourceId=selectedItemIds[0]:this.newkpi.includedResources=selectedItemIds},showAddCategoryDialog:function(){this.canShowCategoryDialog=!0},refreshCategories:function(categoryId){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var _yield$getFieldOption2,error,options;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,(0,picklist/* getFieldOptions */._K)({field:{lookupModuleName:"kpiCategory"}});case 2:_yield$getFieldOption2=_context2.sent,error=_yield$getFieldOption2.error,options=_yield$getFieldOption2.options,error?_this4.$message.error(error.message||"Error Occured"):(_this4.kpiCategory=options,_this4.kpiCategoryId=categoryId,_this4.canShowCategoryDialog=!1);case 6:case"end":return _context2.stop()}}),_callee2)})))()},submitForm:function(){var _this5=this;this.$refs["categoryForm"].validate((function(valid){if(!valid)return!1;var url="/v2/kpi/add",_this5$$helpers$clone=_this5.$helpers.cloneObject(_this5.newkpi),name=_this5$$helpers$clone.name,description=_this5$$helpers$clone.description,id=_this5$$helpers$clone.id,workflow=_this5$$helpers$clone.workflow,target=_this5$$helpers$clone.target,minTarget=_this5$$helpers$clone.minTarget,formulaFieldUnit=_this5$$helpers$clone.formulaFieldUnit,kpiObj={name:name,description:(0,validation/* isEmpty */.xb)(description)?"":description,id:id,workflow:workflow,target:target,minTarget:minTarget,formulaFieldUnit:formulaFieldUnit};null===_this5.newkpi.siteId&&(_this5.newkpi.siteId=-1),_this5.isNew&&(kpiObj=_this5.$helpers.cloneObject(_this5.newkpi),kpiObj.assetCategoryId>0?(kpiObj.resourceType=6,delete kpiObj.resourceId):(kpiObj.resourceType=1,delete kpiObj.assetCategoryId),kpiObj.interval=60),_this5.safeLimitType===safeLimitTypes.MIN?delete kpiObj.minTarget:_this5.safeLimitType===safeLimitTypes.MAX?delete kpiObj.target:_this5.safeLimitType===safeLimitTypes.NONE&&(delete kpiObj.target,delete kpiObj.minTarget);var param={formula:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},kpiObj),{},{kpiCategory:_this5.kpiCategoryId}),formulaFieldUnit:"custom"===_this5.unit?_this5.formulaFieldUnit:"",metricId:"choose"===_this5.unit?_this5.metricId:null,unitId:"choose"===_this5.unit?_this5.unitId:null};"custom"===_this5.unit?(delete param.metricId,delete param.unitId):delete param.formulaFieldUnit,_this5.$set(param.formula.workflow,"isV2Script",!1),_this5.isNew||(url="/v2/kpi/update",kpiObj=_this5.$helpers.compareObject(kpiObj,_this5.kpi),kpiObj.id=_this5.kpi.id,delete param.formula.kpiCategory,param=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},param),{},{moduleId:_this5.kpi.moduleId}));var showError=function(){_this5.$message.error(_this5.isNew?_this5.$t("common.header.kpi_addition_failed"):_this5.$t("common.header.kpi_updation_failed"))};_this5.saving=!0,_this5.$http.post(url,param).then((function(response){_this5.saving=!1,0===response.data.responseCode?(_this5.$message.success(_this5.isNew?_this5.$t("common.products.new_kpi_added_successfully"):_this5.$t("common.header.kpi_updated_successfully")),_this5.$emit("onSave",response.data.result.formulaField||kpiObj),_this5.$emit("onClose")):showError()})).catch((function(){_this5.saving=!1,showError()}))}))},submitV2Form:function(){var _this6=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:_this6.$refs["categoryForm"].validate(function(){var _ref=(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(valid){var url,_this6$$helpers$clone,name,description,id,workflow,target,minTarget,formulaFieldUnit,kpiObj,param,_yield$API$post,data,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:if(valid){_context3.next=2;break}return _context3.abrupt("return",!1);case 2:return url="/v2/kpi/add",_this6$$helpers$clone=_this6.$helpers.cloneObject(_this6.newkpi),name=_this6$$helpers$clone.name,description=_this6$$helpers$clone.description,id=_this6$$helpers$clone.id,workflow=_this6$$helpers$clone.workflow,target=_this6$$helpers$clone.target,minTarget=_this6$$helpers$clone.minTarget,formulaFieldUnit=_this6$$helpers$clone.formulaFieldUnit,kpiObj={name:name,description:(0,validation/* isEmpty */.xb)(description)?"":description,id:id,workflow:workflow,target:target,minTarget:minTarget,formulaFieldUnit:formulaFieldUnit},_this6.isNew&&(kpiObj=_this6.$helpers.cloneObject(_this6.newkpi),kpiObj.assetCategoryId>0?(kpiObj.resourceType=6,delete kpiObj.resourceId):(kpiObj.resourceType=1,delete kpiObj.assetCategoryId),kpiObj.interval=60),_this6.safeLimitType===safeLimitTypes.MIN?delete kpiObj.minTarget:_this6.safeLimitType===safeLimitTypes.MAX?delete kpiObj.target:_this6.safeLimitType===safeLimitTypes.NONE&&(delete kpiObj.target,delete kpiObj.minTarget),param={formula:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},kpiObj),{},{kpiCategory:_this6.kpiCategoryId}),formulaFieldUnit:"custom"===_this6.unit?_this6.formulaFieldUnit:"",metricId:"choose"===_this6.unit?_this6.metricId:null,unitId:"choose"===_this6.unit?_this6.unitId:null},"custom"===_this6.unit?(delete param.metricId,delete param.unitId):delete param.formulaFieldUnit,_this6.isNew||(url="/v2/kpi/update",kpiObj=_this6.$helpers.compareObject(kpiObj,_this6.kpi),kpiObj.id=_this6.kpi.id,delete param.formula.kpiCategory,param=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},param),{},{moduleId:_this6.kpi.moduleId})),_this6.$set(param.formula.workflow,"workflowV2String",_this6.workflowV2String),_this6.$set(param.formula.workflow,"isV2Script",!0),_this6.saving=!0,_context3.next=15,api/* API */.bl.post(url,param);case 15:_yield$API$post=_context3.sent,data=_yield$API$post.data,error=_yield$API$post.error,_this6.saving=!1,error?_this6.$message.error(error.message||"Error Occurred"):(_this6.$message.success(_this6.isNew?_this6.$t("common.products.new_kpi_added_successfully"):_this6.$t("common.header.kpi_updated_successfully")),_this6.$emit("onSave",data.formulaField||kpiObj),_this6.$emit("onClose"));case 20:case"end":return _context3.stop()}}),_callee3)})));return function(_x){return _ref.apply(this,arguments)}}());case 1:case"end":return _context4.stop()}}),_callee4)})))()},closeDialog:function(){this.$emit("onClose")},loadDefaultMetricUnits:function(){var _this7=this;this.$http.get("/units/getDefaultMetricUnits").then((function(response){_this7.metricsUnits=response.data}))},loadUnit:function(metricsUnits){var _this8=this;this.metricName=metricsUnits.metrics.find((function(metric){return _this8.metricId===metric.metricId})),this.metricName=this.metricName._name,this.unitId=metricsUnits.orgUnitsList.find((function(metric){return metric.metric===_this8.metricId})),this.unitId=(0,validation/* isEmpty */.xb)(this.unitId)?null:this.unitId.unit}}},components_AddKpivue_type_script_lang_js=AddKpivue_type_script_lang_js,AddKpi_component=(0,componentNormalizer/* default */.Z)(components_AddKpivue_type_script_lang_js,render,staticRenderFns,!1,null,"1e7f8f11",null)
/* harmony default export */,AddKpi=AddKpi_component.exports},
/***/706881:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return CurrencyPopOver}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/setup/organizationSetting/currency/CurrencyPopOver.vue?vue&type=template&id=434b446a&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_vm.showCurrencyField?_c("div",{staticClass:"d-flex"},[_vm.showInfo?_c("span",[_vm._v(_vm._s(_vm.getMultiCurrencyFieldValue||"---"))]):_vm._e(),_vm.showMultiCurrencyInfo?_c("el-popover",{attrs:{placement:"right",title:_vm.$t("setup.currency.rate"),width:"230",trigger:"hover",content:_vm.currencyContent,"open-delay":5,disabled:_vm.isEmpty(_vm.baseValue)}},[_vm.showInfo?_vm._e():_c("div",{class:[_vm.baseValue&&"pointer"],attrs:{slot:"reference"},slot:"reference"},[_c("div",[_vm._v(_vm._s(""+_vm.getMultiCurrencyFieldValue))]),_c("div",{staticClass:"f12"},[_vm._v(_vm._s(_vm.baseValue))])]),_vm.isBaseCode||!_vm.showInfo||_vm.hideInfoBtn?_vm._e():_c("fc-icon",{staticClass:"pointer info-position mL2",attrs:{slot:"reference",group:"dsm",name:"info",size:"13"},slot:"reference"})],1):_c("span",[_vm._v(_vm._s(_vm.getMultiCurrencyFieldValue||"---"))])],1):_c("span",[_vm._v("---")])])},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),objectSpread2=__webpack_require__(595082),validation=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(634338),__webpack_require__(434284),__webpack_require__(990260)),CurrencyUtil=__webpack_require__(15426),vuex_esm=__webpack_require__(420629),CurrencyPopOvervue_type_script_lang_js={props:["field","details","showInfo","hideInfoBtn"],data:function(){return{baseValue:"",isEmpty:validation/* isEmpty */.xb}},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({account:function(state){return state.account},currencyList:function(state){return state.activeCurrencies}})),{},{showMultiCurrencyInfo:function(){var _ref=this.multiCurrency||{},multiCurrencyEnabled=_ref.multiCurrencyEnabled;return multiCurrencyEnabled},isBaseCode:function(){var _ref2=this.multiCurrency||{},baseCode=_ref2.currencyCode,_ref3=this.details||{},currencyCode=_ref3.currencyCode;return baseCode===currencyCode},showCurrencyField:function(){var currencyValue=this.currencyValue;return!(0,validation/* isEmpty */.xb)(currencyValue)&&"---"!=currencyValue},multiCurrency:function(){var _ref4=this.$getProperty(this.account,"data.currencyInfo")||{},displaySymbol=_ref4.displaySymbol,currencyCode=_ref4.currencyCode,multiCurrencyEnabled=_ref4.multiCurrencyEnabled;return{displaySymbol:displaySymbol,currencyCode:currencyCode,multiCurrencyEnabled:multiCurrencyEnabled}},currencyContent:function(){var details=this.details,currencyValue=this.currencyValue,baseSymbol=this.multiCurrency.displaySymbol;if(!(0,validation/* isEmpty */.xb)(currencyValue)){var _ref5=details||{},exchangeRate=_ref5.exchangeRate,currencyCode=_ref5.currencyCode,currency=(this.currencyList||[]).find((function(currency){return currencyCode===currency.currencyCode}));if((0,validation/* isEmpty */.xb)(currency)||currency.displaySymbol===baseSymbol)return null;var _ref6=currency||{},displaySymbol=_ref6.displaySymbol,content="".concat(baseSymbol," 1 = ").concat(displaySymbol," ").concat(exchangeRate);return content}return"---"},currencyValue:function(){var details=this.details,field=this.field,_ref7=details||{},data=_ref7.data;return field.displayValue||details[field.name]||(null===data||void 0===data?void 0:data[field.name])},getMultiCurrencyFieldValue:function(){var currencyValue=this.currencyValue,showInfo=this.showInfo,_this$multiCurrency=this.multiCurrency,baseSymbol=_this$multiCurrency.displaySymbol,baseCode=_this$multiCurrency.currencyCode,multiCurrencyEnabled=_this$multiCurrency.multiCurrencyEnabled,_ref8=this.details||{},currencyCode=_ref8.currencyCode,exchangeRate=_ref8.exchangeRate,currency=(this.currencyList||[]).find((function(currency){return currencyCode===currency.currencyCode})),baseCurrency=(this.currencyList||[]).find((function(currency){return baseCode===currency.currencyCode}));if((0,validation/* isEmpty */.xb)(currency)&&!(0,validation/* isEmpty */.xb)(currencyValue))return"".concat(baseSymbol," ").concat(currencyValue);var _ref9=currency||{},displaySymbol=_ref9.displaySymbol;displaySymbol=(0,validation/* isEmpty */.xb)(displaySymbol)?baseSymbol:displaySymbol;var baseValue="";if(multiCurrencyEnabled&&baseCode!==currencyCode){var value=(0,CurrencyUtil/* getCurrencyInDecimalValue */.Jg)(currencyValue/exchangeRate,baseCurrency);baseValue="( ".concat(baseSymbol," ").concat(value," )")}return currencyValue=(0,CurrencyUtil/* getCurrencyInDecimalValue */.Jg)(currencyValue,currency),this.setBaseValue(baseValue),showInfo?"".concat(displaySymbol," ").concat(currencyValue," ").concat(baseValue):"".concat(displaySymbol," ").concat(currencyValue)}}),created:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.next=2,_this.$store.dispatch("getActiveCurrencyList");case 2:case"end":return _context.stop()}}),_callee)})))()},methods:{setBaseValue:function(value){this.baseValue=value}}},currency_CurrencyPopOvervue_type_script_lang_js=CurrencyPopOvervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(currency_CurrencyPopOvervue_type_script_lang_js,render,staticRenderFns,!1,null,"434b446a",null)
/* harmony default export */,CurrencyPopOver=component.exports},
/***/345265:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"35079cf978684c9b6a17e182df923ff5.svg";
/***/},
/***/30684:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"52c2ff301190417db7febd08d4cd5153.svg";
/***/},
/***/572902:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"db5324b7cf9058a0aa45899e55bf6444.svg";
/***/}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/5020.js.map