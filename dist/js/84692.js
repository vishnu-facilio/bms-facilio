"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[84692],{
/***/470172:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return InventoryRequestForm}});
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js
var render,staticRenderFns,regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),objectSpread2=__webpack_require__(595082),FormCreation=(__webpack_require__(879288),__webpack_require__(634338),__webpack_require__(434284),__webpack_require__(450886),__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(670560),__webpack_require__(373729)),FetchViewsMixin=__webpack_require__(646716),validation=__webpack_require__(990260),vuex_esm=__webpack_require__(420629),router=__webpack_require__(329435),InventoryRequestFormvue_type_script_lang_js={extends:FormCreation/* default */.Z,mixins:[FetchViewsMixin/* default */.Z],data:function(){return{}},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({account:function(state){return state.account}})),{},{moduleDataId:function(){var $route=this.$route,recordIds=$route.query.recordIds,id=$route.params.id;return Number(id)||recordIds},title:function(){var moduleDisplayName=this.moduleDisplayName,moduleDataId=this.moduleDataId;return(0,validation/* isNumber */.hj)(moduleDataId)?"Edit ".concat(moduleDisplayName):"Create ".concat(moduleDisplayName)},isWidgetsSupported:function(){return!0},isV3Api:function(){return!0},moduleName:function(){return"inventoryrequest"},moduleDisplayName:function(){return"Inventory Request"}}),methods:{modifyFieldPropsHook:function(field){var $route=this.$route,_$route$query=$route.query,requestedFromWorkOrder=_$route$query.requestedFromWorkOrder,woId=_$route$query.woId,localId=_$route$query.woLocalId;woId=(0,validation/* isEmpty */.xb)(woId)?null:parseInt(woId);var moduleDataId=this.moduleDataId,account=this.account;if(!requestedFromWorkOrder||(0,validation/* isEmpty */.xb)(woId)||(0,validation/* isEmpty */.xb)(localId)){var _fieldValueObj={requestedBy:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},field),{},{isDisabled:!0}),workorder:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},field),{},{isDisabled:!0})};if(!(0,validation/* isEmpty */.xb)(moduleDataId)){var _ref4=field||{},_name=_ref4.name;return _fieldValueObj[_name]||field}}else{var _ref=account||{},user=_ref.user,_ref2=user||{},userId=_ref2.id,fieldValueObj={name:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},field),{},{value:"".concat(this.$t("common.inventory.required_inventory_items_for_wo")).concat(localId)}),requestedBy:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},field),{},{value:userId,isDisabled:!0}),requestedFor:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},field),{},{value:userId}),workorder:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},field),{},{value:woId,isDisabled:!0})};if((0,validation/* isEmpty */.xb)(moduleDataId)){var _ref3=field||{},name=_ref3.name;return fieldValueObj[name]||field}}},afterSerializeHook:function(_ref5){var data=_ref5.data,_ref6=data||[],lineItems=_ref6.inventoryrequestlineitems;return!(0,validation/* isEmpty */.xb)(lineItems)&&(0,validation/* isArray */.kJ)(lineItems)&&(lineItems=lineItems.filter((function(item){var _item$itemType,_item$toolType;return!(0,validation/* isEmpty */.xb)(item.quantity)&&(1===item.inventoryType&&(null===(_item$itemType=item.itemType)||void 0===_item$itemType?void 0:_item$itemType.id)||2===item.inventoryType&&(null===(_item$toolType=item.toolType)||void 0===_item$toolType?void 0:_item$toolType.id))})).map((function(item){var _ref7=item||{},inventoryType=_ref7.inventoryType;return 1===inventoryType?(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},item),{},{toolType:null}):(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},item),{},{itemType:null})})),this.$setProperty(data,"inventoryrequestlineitems",(0,validation/* isEmpty */.xb)(lineItems)?null:lineItems)),data},afterSaveHook:function(response){var moduleName=this.moduleName,data=response[moduleName],_ref8=data||{},id=_ref8.id;(0,validation/* isEmpty */.xb)(id)||this.redirectToSummary(id)},redirectToList:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var _ref9,name;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:(0,router/* isWebTabsEnabled */.tj)()?(_ref9=(0,router/* findRouteForModule */.Jp)("inventoryrequest",router/* pageTypes */.As.LIST)||{},name=_ref9.name,name&&_this.$router.push({name:name})):_this.$router.push({path:"/app/inventory/inventoryrequest"});case 1:case"end":return _context.stop()}}),_callee)})))()},redirectToSummary:function(id){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var viewname,_ref10,name;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,_this2.fetchView(_this2.moduleName);case 2:viewname=_context2.sent,(0,router/* isWebTabsEnabled */.tj)()?(_ref10=(0,router/* findRouteForModule */.Jp)(_this2.moduleName,router/* pageTypes */.As.OVERVIEW)||{},name=_ref10.name,name&&_this2.$router.push({name:name,params:{viewname:viewname,id:id}})):_this2.$router.push({path:"/app/inventory/inventoryrequest/".concat(viewname,"/").concat(id,"/overview")});case 4:case"end":return _context2.stop()}}),_callee2)})))()}}},InventoryRequest_InventoryRequestFormvue_type_script_lang_js=InventoryRequestFormvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(InventoryRequest_InventoryRequestFormvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,InventoryRequestForm=component.exports;
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js
},
/***/418672:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return InventoryIssueUse}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/workorder/workorders/v1/InventoryIssueUse.vue?vue&type=template&id=47035aee
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("div",[_c("el-dialog",{attrs:{"before-close":_vm.cancelItemsDialog,visible:_vm.visibility,fullscreen:!1,width:"60%",open:"top","custom-class":"fc-dialog-up Inventoryaddvaluedialog","append-to-body":!0},on:{"update:visible":function($event){_vm.visibility=$event}}},[_c("div",[_c("div",{staticClass:"new-header-container popup-container-new"},[_c("div",{staticClass:"fc-setup-modal-title"},[_vm._v(" "+_vm._s(_vm.$t("common.products.issued_inventory_list"))+" ")]),_c("div",{staticClass:"store-room-bar",class:{active:!_vm.hideQuery}},[_c("el-select",{staticClass:"fc-tag mL20 fc-input-full-border-select2",attrs:{multiple:"","collapse-tags":"",placeholder:_vm.$t("common.products.select_storeroom")},model:{value:_vm.selectedStoreList,callback:function($$v){_vm.selectedStoreList=$$v},expression:"selectedStoreList"}},_vm._l(_vm.tempStoreList,(function(item,index){return _c("el-option",{key:index,attrs:{label:item.name,value:item.id}})})),1)],1),_c("div",{staticClass:"search-bar",class:{active:_vm.hideQuery}},[_vm.hideQuery?_c("i",{staticClass:"el-input__icon el-icon-search inventory-table-search-bar",attrs:{slot:"suffix"},on:{click:function($event){_vm.hideQuery=!1}},slot:"suffix"}):_c("el-input",{staticClass:"el-input-textbox-full-border",attrs:{autofocus:!0,type:"text",placeholder:_vm.$t("common._common.to_search_type")},on:{blur:function($event){_vm.hideQuery=!0}},model:{value:_vm.itemSearchQuery,callback:function($$v){_vm.itemSearchQuery=$$v},expression:"itemSearchQuery"}},[_c("span",{staticClass:"sub-divider"},[_vm._v("|")]),_c("i",{staticClass:"el-input__icon el-icon-search pointer inventory-table-search-bar",attrs:{slot:"suffix"},slot:"suffix"})])],1)]),_c("div",{staticClass:"height400"},[_vm.newIRIssueItem?_c("div",[_c("el-table",{directives:[{name:"loading",rawName:"v-loading",value:_vm.itemLoading,expression:"itemLoading"}],ref:"table1",staticClass:"inventory-inner-table width100",attrs:{data:_vm.itemTransactionsTableList,height:"350","empty-text":_vm.$t("common.products.no_issued_items"),"default-sort":{prop:"item.itemType.name",order:"descending"}},on:{"selection-change":_vm.selectItemActions}},[_c("el-table-column",{attrs:{width:"60",type:"selection"}}),_c("el-table-column",{attrs:{prop:"item.itemType.name",sortable:"",width:"170",label:_vm.$t("common.header._item")}}),_c("el-table-column",{attrs:{prop:"item.storeRoom.name",sortable:"",width:"170",label:_vm.$t("common.products.storeroom")}}),_c("el-table-column",{attrs:{prop:"remainingQuantity",sortable:"",width:"200",label:_vm.$t("common.wo_report.remaining_qty")}}),_c("el-table-column",{attrs:{prop:"asset.serialNumber",sortable:"",width:"130",label:"S NO"}}),_c("el-table-column",{attrs:{label:_vm.$t("common.products.issue_qty"),width:"180"},scopedSlots:_vm._u([{key:"default",fn:function(issuedItem){return[_c("div",[_c("el-input",{ref:"quantityElInput",staticClass:"fc-input-full-border-select2",attrs:{placeholder:_vm.$t("common._common.quantity"),min:1,disabled:issuedItem.row.item.itemType.isRotating,type:"number"},model:{value:issuedItem.row.updateQuantity,callback:function($$v){_vm.$set(issuedItem.row,"updateQuantity",$$v)},expression:"issuedItem.row.updateQuantity"}})],1)]}}],null,!1,844767329)})],1)],1):_vm._e(),_vm.newIRIssueTool?_c("div",[_c("el-table",{directives:[{name:"loading",rawName:"v-loading",value:_vm.toolLoading,expression:"toolLoading"}],ref:"table2",staticClass:"inventory-inner-table width100",attrs:{data:_vm.toolTransactionsTableList,height:"350","empty-text":_vm.$t("common.products.no_issued_tools"),"default-sort":{prop:"tool.toolType.name",order:"descending"}},on:{"selection-change":_vm.selectToolActions}},[_c("el-table-column",{attrs:{width:"60",type:"selection"}}),_c("el-table-column",{attrs:{prop:"tool.toolType.name",sortable:"",width:"170",label:_vm.$t("common.header._tool")}}),_c("el-table-column",{attrs:{prop:"tool.storeRoom.name",sortable:"",width:"170",label:_vm.$t("common.products.storeroom")}}),_c("el-table-column",{attrs:{prop:"remainingQuantity",sortable:"",width:"200",label:_vm.$t("common.wo_report.remaining_qty")}}),_c("el-table-column",{attrs:{prop:"asset.serialNumber",sortable:"",width:"130",label:_vm.$t("common.header.s_no")}}),_c("el-table-column",{attrs:{label:"ISSUE QTY"},scopedSlots:_vm._u([{key:"default",fn:function(issuedTool){return[_c("div",[_c("el-input",{ref:"quantityElInput",staticClass:"fc-input-full-border-select2",attrs:{placeholder:_vm.$t("common._common.quantity"),min:1,disabled:issuedTool.row.tool.toolType.isRotating,type:"number"},model:{value:issuedTool.row.updateQuantity,callback:function($$v){_vm.$set(issuedTool.row,"updateQuantity",$$v)},expression:"issuedTool.row.updateQuantity"}})],1)]}}],null,!1,1039748108)})],1)],1):_vm._e()]),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){return _vm.cancelItemsDialog()}}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_vm.newIRIssueItem?_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.saveLoading},on:{click:function($event){return _vm.addSelectedItemTransactions()}}},[_vm._v(_vm._s(_vm.$t("common._common._add")))]):_vm._e(),_vm.newIRIssueTool?_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.saveLoading},on:{click:function($event){return _vm.addSelectedToolTransactions()}}},[_vm._v(_vm._s(_vm.$t("common._common._add")))]):_vm._e()],1)])])],1)])},staticRenderFns=[],createForOfIteratorHelper=__webpack_require__(566347),toConsumableArray=__webpack_require__(488478),InventoryIssueUsevue_type_script_lang_js=(__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(339772),__webpack_require__(434284),__webpack_require__(648324),__webpack_require__(634338),__webpack_require__(919649),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(450886),__webpack_require__(670560),__webpack_require__(947522),{props:["visibility","workorder","woItemsList","woToolsList","newIRIssueItem","newIRIssueTool"],data:function(){return{rotatingItemList:[],itemSearchQuery:null,hideQuery:!0,issuedItemsList:[],selectedItem:null,itemLoading:!1,iTloading:!1,selectedStoreList:[],tempStoreList:[],saveLoading:!1,selectedLineItems:[],itemTransactionsList:[],selectedItemsTransactions:[],toolTransactionsList:[],selectedToolsTransactions:[],toolLoading:!1}},mounted:function(){this.newIRIssueItem?this.loadItemTransactions():this.newIRIssueTool&&this.loadToolTransactions()},computed:{rotatingItemTableList:function(){var list=this.rotatingItemList;if(this.itemSearchQuery){var self=this;return list.filter((function(data){if(data.serialNumber.toLowerCase().indexOf(self.itemSearchQuery.toLowerCase())>-1)return data}))}return list},issuedItemsTableList:function(){var list=[];list=this.issuedItemsList;var self=this;if(this.selectedStoreList.length&&(list=list.filter((function(rt){if(self.selectedStoreList.findIndex((function(rl){return rl===rt.storeRoom.id}))>-1)return rt}))),this.itemSearchQuery){var _self=this;return list.filter((function(data){if(1===data.inventoryType&&data.itemType.name.toLowerCase().indexOf(_self.itemSearchQuery.toLowerCase())>-1||2===data.inventoryType&&data.toolType.name.toLowerCase().indexOf(_self.itemSearchQuery.toLowerCase())>-1||data.storeRoom.name.toLowerCase().indexOf(_self.itemSearchQuery.toLowerCase())>-1||0===JSON.stringify(data.tempQuantity).toLowerCase().indexOf(_self.itemSearchQuery.toLowerCase())||data.asset&&data.asset.serialNumber.toLowerCase().indexOf(_self.itemSearchQuery.toLowerCase())>-1)return data}))}return list},itemTransactionsTableList:function(){var _this=this,list=[];return list=this.itemTransactionsList,this.selectedStoreList.length&&(list=list.filter((function(rt){if(_this.selectedStoreList.findIndex((function(rl){return rl===rt.item.storeRoom.id}))>-1)return rt}))),this.itemSearchQuery?list.filter((function(data){if(data.item.itemType.name.toLowerCase().indexOf(_this.itemSearchQuery.toLowerCase())>-1||data.item.storeRoom.name.toLowerCase().indexOf(_this.itemSearchQuery.toLowerCase())>-1||0===JSON.stringify(data.updateQuantity).toLowerCase().indexOf(_this.itemSearchQuery.toLowerCase())||data.asset&&data.asset.serialNumber.toLowerCase().indexOf(_this.itemSearchQuery.toLowerCase())>-1)return data})):list},toolTransactionsTableList:function(){var _this2=this,list=[];return list=this.toolTransactionsList,this.selectedStoreList.length&&(list=list.filter((function(rt){if(_this2.selectedStoreList.findIndex((function(rl){return rl===rt.tool.storeRoom.id}))>-1)return rt}))),this.itemSearchQuery?list.filter((function(data){if(data.tool.toolType.name.toLowerCase().indexOf(_this2.itemSearchQuery.toLowerCase())>-1||data.tool.storeRoom.name.toLowerCase().indexOf(_this2.itemSearchQuery.toLowerCase())>-1||0===JSON.stringify(data.updateQuantity).toLowerCase().indexOf(_this2.itemSearchQuery.toLowerCase())||data.asset&&data.asset.serialNumber.toLowerCase().indexOf(_this2.itemSearchQuery.toLowerCase())>-1)return data})):list}},methods:{loadIssuedItemsList:function(){var self=this,param={status:6,parentId:this.workorder.id};this.itemLoading=!0;var workOrderInventoryList=[].concat((0,toConsumableArray/* default */.Z)(this.woItemsList),(0,toConsumableArray/* default */.Z)(this.woToolsList)),reqLineItemList=workOrderInventoryList.filter((function(i){if(i.requestedLineItem&&i.requestedLineItem.id)return!0})),reqLineItemId=new Set(reqLineItemList.map((function(i){return i.requestedLineItem.id})));this.$http.post("/v2/inventoryrequest/lineItemListByParentId",param).then((function(r){var woLineItemsList,param2={status:6,requesterId:self.$store.state.account.user.id};0===r.data.responseCode&&(woLineItemsList=r.data.result.inventoryrequestlineitems),self.$http.post("/v2/inventoryrequest/lineItemListByRequesterId",param2).then((function(response){if(0===response.data.responseCode){var reqItemsList=response.data.result.inventoryrequestlineitems,ids=new Set(woLineItemsList.map((function(d){return d.id})));self.issuedItemsList=[].concat((0,toConsumableArray/* default */.Z)(woLineItemsList),(0,toConsumableArray/* default */.Z)(reqItemsList.filter((function(d){return!ids.has(d.id)})))),self.issuedItemsList=self.issuedItemsList.filter((function(i){return!reqLineItemId.has(i.id)})),self.issuedItemsList=self.issuedItemsList.filter((function(i){return 1!==i.inventoryType||i.issuedQuantity-i.usedQuantity>0}));var _step,_iterator=(0,createForOfIteratorHelper/* default */.Z)(self.issuedItemsList);try{var _loop=function(){var item=_step.value;self.$set(item,"checked",!1),self.$set(item,"tempQuantity",item.asset?1:1===item.inventoryType?item.issuedQuantity-item.usedQuantity:item.issuedQuantity),item.storeRoom&&self.tempStoreList.findIndex((function(rt){return rt.id===item.storeRoom.id}))<0&&self.tempStoreList.push(item.storeRoom)};for(_iterator.s();!(_step=_iterator.n()).done;)_loop()}catch(err){_iterator.e(err)}finally{_iterator.f()}}self.itemLoading=!1}))})).catch((function(error){}))},selectItemActions:function(val){this.selectedItemsTransactions=val},loadItemTransactions:function(){var self=this;self.itemLoading=!0;var workOrderItemList=this.woItemsList.filter((function(i){if(-1!==i.parentTransactionId)return!0})),parentTransactionIdList=new Set(workOrderItemList.map((function(i){return i.parentTransactionId})));this.$http.get("/v2/itemTransactions/view/showItemTransactionListForIssue?showItemsForIssue=true").then((function(response){self.itemLoading=!1,self.itemTransactionsList=response.data.result.itemTransactions||[],self.itemTransactionsList=self.itemTransactionsList.filter((function(i){return!parentTransactionIdList.has(i.id)}));var _step2,_iterator2=(0,createForOfIteratorHelper/* default */.Z)(self.itemTransactionsList);try{var _loop2=function(){var item=_step2.value;self.$set(item,"updateQuantity",item.remainingQuantity),item.item.storeRoom&&self.tempStoreList.findIndex((function(rt){return rt.id===item.item.storeRoom.id}))<0&&self.tempStoreList.push(item.item.storeRoom)};for(_iterator2.s();!(_step2=_iterator2.n()).done;)_loop2()}catch(err){_iterator2.e(err)}finally{_iterator2.f()}})).catch((function(error){error&&(self.itemLoading=!1)}))},addSelectedItemTransactions:function(){var _this3=this,param={workorderItems:[]},obj={};if(0!==this.selectedItemsTransactions.length){this.selectedItemsTransactions.forEach((function(item,index){if(obj={},item.itemType.isRotating){var assetIds=[];assetIds.push(item.asset.id),obj={parentId:_this3.workorder.id,item:{id:item.item.id},quantity:1,assetIds:assetIds,parentTransactionId:item.id,remainingQuantity:item.remainingQuantity,requestedLineItem:item.requestedLineItem?item.requestedLineItem:null},param.workorderItems.push(obj)}else obj={parentId:_this3.workorder.id,item:{id:item.item.id},quantity:item.updateQuantity,assetIds:null,parentTransactionId:item.id,remainingQuantity:item.remainingQuantity,requestedLineItem:item.requestedLineItem?item.requestedLineItem:null},param.workorderItems.push(obj)})),this.saveLoading=!0;var self=this;this.$http.post("/v2/workorderItems/addOrUpdate",param).then((function(response){0!==response.data.responseCode?(self.$message.error(response.data.message),self.saveLoading=!1):(self.$message.success(_this3.$t("common.products.items_added_successfully")),self.$emit("update:visibility",!1),self.$emit("refreshItemList"),_this3.$emit("refresh-item-list"),self.saveLoading=!1)})).catch((function(error){self.saveLoading=!1}))}else this.$message.error(this.$t("common.header.kindly_select_items_to_add"))},selectToolActions:function(val){this.selectedToolsTransactions=val},loadToolTransactions:function(){var self=this;self.toolLoading=!0;var workOrderToolList=this.woToolsList.filter((function(i){if(-1!==i.parentTransactionId)return!0})),parentTransactionIdList=new Set(workOrderToolList.map((function(i){return i.parentTransactionId})));this.$http.get("/v2/toolTransactions/view/showToolTransactionListForIssue?showToolsForIssue=true").then((function(response){self.toolLoading=!1,self.toolTransactionsList=response.data.result.toolTransactions||[],self.toolTransactionsList=self.toolTransactionsList.filter((function(i){return!parentTransactionIdList.has(i.id)}));var _step3,_iterator3=(0,createForOfIteratorHelper/* default */.Z)(self.toolTransactionsList);try{var _loop3=function(){var tool=_step3.value;self.$set(tool,"updateQuantity",tool.remainingQuantity),tool.tool.storeRoom&&self.tempStoreList.findIndex((function(rt){return rt.id===tool.tool.storeRoom.id}))<0&&self.tempStoreList.push(tool.tool.storeRoom)};for(_iterator3.s();!(_step3=_iterator3.n()).done;)_loop3()}catch(err){_iterator3.e(err)}finally{_iterator3.f()}})).catch((function(error){error&&(self.toolLoading=!1)}))},addSelectedToolTransactions:function(){var _this4=this,self=this,param={workorderToolsList:[]},obj={};0!==this.selectedToolsTransactions.length?(this.selectedToolsTransactions.forEach((function(item,index){if(obj={},item.toolType.isRotating){var assetIds=[];assetIds.push(item.asset.id),obj={parentId:_this4.workorder.id,tool:{id:item.tool.id},quantity:1,duration:36e5,assetIds:assetIds,parentTransactionId:item.id,requestedLineItem:item.requestedLineItem?item.requestedLineItem:null},param.workorderToolsList.push(obj)}else obj={parentId:_this4.workorder.id,tool:{id:item.tool.id},quantity:item.updateQuantity,duration:36e5,assetIds:null,parentTransactionId:item.id,requestedLineItem:item.requestedLineItem?item.requestedLineItem:null},param.workorderToolsList.push(obj)})),self.saveLoading=!0,this.$http.post("/v2/workorderTools/addOrUpdate",param).then((function(response){0!==response.data.responseCode?(self.$message.error(response.data.message),self.saveLoading=!1):(self.$message.success(_this4.$t("common.products.tools_added_successfully")),self.$emit("update:visibility",!1),self.$emit("refreshToolList"),_this4.$emit("refresh-tool-list"),self.saveLoading=!1)})).catch((function(error){self.saveLoading=!1}))):this.$message.error(this.$t("common.header.kindly_select_tools_to_add"))},cancelItemsDialog:function(){this.$emit("update:visibility",!1),this.selectedItem=null},toggleSelection:function(selected){this.selectedLineItems=selected},addSelectedItem:function(){var _this5=this,param={inventoryType:1,lineItems:[]},param2={inventoryType:2,lineItems:[]},obj={};
// Temp fix Should be changed to single API .. Has Bug
this.selectedLineItems.forEach((function(item,index){obj={},[],1===item.inventoryType?item.itemType.isRotating?(item.assetIds=[item.asset],[item.asset],item.parentId=_this5.workorder.id,obj={parentId:_this5.workorder.id,id:item.id,itemType:{id:item.itemType.id},storeRoom:item.storeRoom,inventoryRequestId:item.inventoryRequestId,quantity:1,asset:item.asset,inventoryType:1},param.lineItems.push(obj)):item.tempQuantity>0&&(item.assetIds=[item.asset],[item.asset],item.parentId=_this5.workorder.id,obj={parentId:_this5.workorder.id,id:item.id,itemType:{id:item.itemType.id},storeRoom:item.storeRoom,inventoryRequestId:item.inventoryRequestId,quantity:item.tempQuantity,inventoryType:1},param.lineItems.push(obj)):2===item.inventoryType&&(item.toolType.isRotating?([item.asset],obj={parentId:_this5.workorder.id,id:item.id,toolType:{id:item.toolType.id},storeRoom:item.storeRoom,inventoryRequestId:item.inventoryRequestId,quantity:1,asset:item.asset,inventoryType:2},param2.lineItems.push(obj)):item.tempQuantity>0&&(obj={parentId:_this5.workorder.id,id:item.id,toolType:{id:item.toolType.id},storeRoom:item.storeRoom,inventoryRequestId:item.inventoryRequestId,quantity:item.tempQuantity,inventoryType:2},param2.lineItems.push(obj)))}));var self=this;this.saveLoading=!0;var successCount=0,callCount=0;param.lineItems.length&&(callCount++,this.$http.post("/v2/inventoryrequest/useLineItems",param).then((function(response){0===response.data.responseCode?(self.$message.success(_this5.$t("common.products.items_added_successfully")),self.$emit("refreshItemList"),successCount++,callCount===successCount&&self.$emit("update:visibility",!1)):self.$message.error(response.data.message),self.saveLoading=!1})).catch((function(error){}))),param2.lineItems.length&&(callCount++,this.$http.post("/v2/inventoryrequest/useLineItems",param2).then((function(response){0===response.data.responseCode?(self.$message.success(_this5.$t("common.products.tools_added_successfully")),self.$emit("refreshToolList"),successCount++,callCount===successCount&&self.$emit("update:visibility",!1)):self.$message.error(response.data.message),self.saveLoading=!1})).catch((function(error){})))}}}),v1_InventoryIssueUsevue_type_script_lang_js=InventoryIssueUsevue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(v1_InventoryIssueUsevue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,InventoryIssueUse=component.exports},
/***/884692:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return inventory}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/workorder/workorders/v1/inventory.vue?vue&type=template&id=4afb74fc&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"pm-summary-inner-container inventory-page v3-layout-override"},[_c("div",{staticClass:"fL pm-summary-inner-left-con mT20 fc-res-dell"},[_c("div",{staticClass:"p30 white-bg-block mB20"},[_c("div",{staticClass:"flex-middle justify-content-space"},[_c("div",{staticClass:"inline-flex"},[_c("div",{staticClass:"fc-v1-icon-bg"},[_c("InlineSvg",{attrs:{src:"svgs/items",iconClass:"icon icon-lg stroke-white"}})],1),_c("div",{staticClass:"fc-black3-16 mL10 mT12"},[_vm._v(" "+_vm._s(_vm.$t("common.products.items"))+" ")])]),_vm.isNotPortal&&_vm.actionRule&&!_vm.inventoryRequestForWOLoading?_c("div",[_vm.inventoryRequestList&&_vm.inventoryRequestList.length>0?_c("el-button",{directives:[{name:"tippy",rawName:"v-tippy"}],class:["fc-create-btn create-btn mL10",{disabled:_vm.canDisable}],attrs:{disabled:_vm.canDisable,title:_vm.$t("common._common.view_inventory_request"),"data-size":"small"},on:{click:function($event){_vm.inventoryRequestDialogVisibility=!0}}},[_c("InlineSvg",{attrs:{src:"svgs/view",iconClass:"icon icon-md vertical-middle fc-white-color"}})],1):_c("el-button",{directives:[{name:"tippy",rawName:"v-tippy"}],class:["fc-create-btn create-btn mL10",{disabled:_vm.canDisable}],attrs:{disabled:_vm.canDisable,title:_vm.$t("common.products.new_inventory_request"),"data-size":"small"},on:{click:function($event){_vm.inventoryRequestDialogVisibility=!0}}},[_c("i",{staticClass:"el-icon-plus white-color f12 fw-bold"})])],1):_vm._e()]),_c("div",{staticClass:"inventory-table pT20"},[_vm.itemnsloading?_c("table",{staticClass:"width100"},[_c("tr",[_c("td",{attrs:{colspan:"100%"}},[_c("div",{staticClass:"iTloading in-no-data"},[_c("spinner",{attrs:{show:!0,size:"80"}})],1)])])]):_c("table",{staticClass:"width100 inventory-tools-table inventory-table"},[_c("thead",[_c("tr",[_c("th",{staticStyle:{width:"63%"}},[_vm._v(_vm._s(_vm.$t("common.header._item")))]),_c("th",{},[_vm._v(_vm._s(_vm.$t("common._common._quantity")))]),_c("th",{staticClass:"p10 text-right"},[_vm._v(" "+_vm._s(_vm.$t("common.header._unit_price"))+" ")]),_c("th",{staticClass:"text-right",staticStyle:{width:"72px"}},[_vm._v(" "+_vm._s(_vm.$t("common.tabs._cost"))+" ")]),_c("th",{staticClass:"width40px"})])]),_vm.workorderItemsList.length?_c("tbody",[_vm._l(_vm.workorderItemsList,(function(workItem,index){return[2===workItem.approvedState?_c("tr",{key:workItem.id,staticClass:"border-top4 border-bottom9 visibility-visible-actions pointer disabled"},[_c("td",[_c("div",{staticClass:"width180px"},[workItem.id>-1?_c("div",{staticClass:"pL17"},[workItem.item.itemType.isRotating&&workItem.asset?_c("div",{staticClass:"fc-id",staticStyle:{"padding-bottom":"4px"}},[_vm._v(" #"+_vm._s(workItem.asset.serialNumber)+" ")]):_vm._e(),_c("div",[_vm._v(_vm._s(workItem.item.itemType.name))])]):_c("el-input",{staticClass:"fc-input-full-border2",attrs:{type:"text",placeholder:_vm.$t("common.header.item_name")},model:{value:workItem.item.itemType.name,callback:function($$v){_vm.$set(workItem.item.itemType,"name",$$v)},expression:"workItem.item.itemType.name"}},[_c("i",{staticClass:"el-input__icon el-icon-search",staticStyle:{"line-height":"0px !important","font-size":"16px !important",cursor:"pointer"},attrs:{slot:"suffix"},on:{click:function($event){return _vm.addNewWOItem()}},slot:"suffix"})])],1)]),_c("td",[_c("div",{staticClass:"in-Quantity row"},[_c("div",{staticClass:"item col-6"},[workItem.item.itemType.isRotating?_c("div",{staticClass:"item"},[_c("div",{staticClass:"workItem-quantity"},[_vm._v(" "+_vm._s(workItem.quantity)+" ")])]):_c("el-tooltip",{staticClass:"item text-center quant",class:{exceeded:_vm.getItemQuantityState(workItem)},attrs:{effect:"dark",content:_vm.actionRule?_vm.$t("common.products.available_items")+_vm.getItemCount(workItem):_vm.$t("common.header.please_open_the_workorder"),placement:"top"}},[[_c("el-form",{ref:"numberValidateForm",refInFor:!0,staticClass:"width50px inventory-input-width",class:{exceeded:_vm.getItemQuantityState(workItem)},attrs:{model:workItem},nativeOn:{submit:function($event){return $event.preventDefault(),_vm.checkEnter.apply(null,arguments)}}},[_c("el-form-item",{attrs:{label:"",prop:"quantity"}},[_c("el-input",{staticClass:"fc-input-full-border2 width50px inventory-input-width75px text-right pL20",attrs:{placeholder:"",type:"number",disabled:!_vm.actionRule},on:{change:function($event){return _vm.changeWorkItemQuantity(workItem,workItem.item.quantity)}},model:{value:workItem.quantity,callback:function($$v){_vm.$set(workItem,"quantity",$$v)},expression:"workItem.quantity"}})],1)],1)]],2)],1)])]),_c("td",[_c("div",[workItem.item.itemType.isRotating?_c("currency",{staticClass:"text-right pR10",attrs:{value:workItem.asset.unitPrice}}):_c("currency",{staticClass:"text-right pR10",attrs:{value:workItem.purchasedItem.unitcost}})],1)]),_c("td",[_c("div",{staticClass:"text-right"},[_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"fa fa-lock f18",attrs:{"data-arrow":"true",title:_vm.$t("common.products.waiting_for_approval")}})])]),_c("td",{staticClass:"text-right"},[_vm.actionRule?_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-delete pointer inv-delet-icon visibility-hide-actions pR10 pL10",attrs:{"data-arrow":"true",title:_vm.$t("common.header.delete_item")},on:{click:function($event){return _vm.deleteWorkorderItem(workItem,index)}}}):_vm._e()])]):4===workItem.approvedState?_c("tr",{key:workItem.id,staticClass:"border-top4 border-bottom9 visibility-visible-actions pointer"},[_c("td",[_c("div",{staticClass:"width180px"},[workItem.id>-1?_c("div",{staticClass:"pL17"},[workItem.item.itemType.isRotating&&workItem.asset?_c("div",{staticClass:"fc-id",staticStyle:{"padding-bottom":"4px"}},[_vm._v(" #"+_vm._s(workItem.asset.serialNumber)+" ")]):_vm._e(),_c("div",[_vm._v(_vm._s(workItem.item.itemType.name))])]):_c("el-input",{staticClass:"fc-input-full-border2",attrs:{type:"text",placeholder:_vm.$t("common.header.item_name")},model:{value:workItem.item.itemType.name,callback:function($$v){_vm.$set(workItem.item.itemType,"name",$$v)},expression:"workItem.item.itemType.name"}},[_c("i",{staticClass:"el-input__icon el-icon-search",staticStyle:{"line-height":"0px !important","font-size":"16px !important",cursor:"pointer"},attrs:{slot:"suffix"},on:{click:function($event){return _vm.addNewWOItem()}},slot:"suffix"})])],1)]),_c("td",[_c("div",{staticClass:"in-Quantity"},[_c("div",{staticClass:"item col-6"},[_c("div",{staticClass:"item"},[_c("div",{staticClass:"workItem-quantity"},[_vm._v(" "+_vm._s(workItem.quantity)+" ")])])])])]),_c("td",[workItem.item.itemType.isRotating?_c("currency",{staticClass:"text-right pR10",attrs:{value:workItem.asset.unitPrice}}):_c("currency",{staticClass:"text-right pR10",attrs:{value:workItem.purchasedItem.unitcost}})],1),_c("td",[_c("div",{staticClass:"text-right"},[_c("currency",{attrs:{value:workItem.cost}})],1)]),_c("td",{staticClass:"text-right"},[_vm.actionRule?_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-delete pointer inv-delet-icon visibility-hide-actions pR10 pL10",attrs:{"data-arrow":"true",title:_vm.$t("common.header.delete_item")},on:{click:function($event){return _vm.deleteWorkorderItem(workItem,index)}}}):_vm._e()])]):_c("tr",{key:workItem.id,staticClass:"border-top4 border-bottom9 visibility-visible-actions pointer"},[_c("td",[_c("div",{staticClass:"width180px inv-table-subject"},[workItem.id>-1?_c("div",{staticClass:"pL17"},[workItem.item.itemType.isRotating&&workItem.asset?_c("div",{staticClass:"fc-id",staticStyle:{"padding-bottom":"4px"}},[_vm._v(" #"+_vm._s(workItem.asset.serialNumber)+" ")]):_vm._e(),_c("div",[_vm._v(_vm._s(workItem.item.itemType.name))])]):_c("el-input",{staticClass:"fc-input-full-border2",attrs:{type:"text",placeholder:_vm.$t("common.header.item_name")},model:{value:workItem.item.itemType.name,callback:function($$v){_vm.$set(workItem.item.itemType,"name",$$v)},expression:"workItem.item.itemType.name"}},[_c("i",{staticClass:"el-input__icon el-icon-search",staticStyle:{"line-height":"0px !important","font-size":"16px !important",cursor:"pointer"},attrs:{slot:"suffix"},on:{click:function($event){return _vm.addNewWOItem()}},slot:"suffix"})])],1)]),_c("td",[_c("div",{staticClass:"in-Quantity"},[workItem.item.itemType.isRotating?_c("div",{staticClass:"item"},[_c("div",{staticClass:"workItem-quantity"},[_vm._v(" "+_vm._s(workItem.quantity)+" ")])]):_c("el-tooltip",{staticClass:"item text-center quant",class:{exceeded:_vm.getItemQuantityState(workItem)},attrs:{effect:"dark",content:_vm.actionRule?_vm.$t("common.products.available_items")+_vm.getItemCount(workItem):_vm.$t("common.header.please_open_the_workorder"),placement:"top"}},[[_c("el-form",{ref:"numberValidateForm",refInFor:!0,staticClass:"width50px inventory-input-width",class:{exceeded:_vm.getItemQuantityState(workItem)},attrs:{model:workItem},nativeOn:{submit:function($event){return $event.preventDefault(),_vm.checkEnter.apply(null,arguments)}}},[_c("el-form-item",{attrs:{label:"",prop:"quantity"}},[_c("el-input",{staticClass:"fc-input-full-border2 width50px inventory-input-width75px text-right pL20",attrs:{placeholder:"",type:"number",disabled:!_vm.actionRule},on:{change:function($event){return _vm.changeWorkItemQuantity(workItem,workItem.item.quantity)}},model:{value:workItem.quantity,callback:function($$v){_vm.$set(workItem,"quantity",$$v)},expression:"workItem.quantity"}})],1)],1)]],2)],1)]),_c("td",[workItem.item.itemType.isRotating?_c("currency",{staticClass:"text-right pR10",attrs:{value:workItem.asset.unitPrice}}):_c("currency",{staticClass:"text-right pR10",attrs:{value:workItem.purchasedItem.unitcost}})],1),_c("td",[_c("div",{staticClass:"text-right"},[_c("currency",{attrs:{value:workItem.cost}})],1)]),_c("td",{staticClass:"text-right"},[_vm.actionRule?_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-delete pointer inv-delet-icon visibility-hide-actions pR10 pL10",attrs:{"data-arrow":"true",title:_vm.$t("common.header.delete_item")},on:{click:function($event){return _vm.deleteWorkorderItem(workItem,index)}}}):_vm._e()])])]}))],2):_c("tbody",[_c("tr",[_c("td",{staticClass:"inventory-td-selected pL20",class:{disabled:!_vm.actionRule},staticStyle:{width:"63%"},on:{click:function($event){_vm.actionRule&&_vm.addNewWOItem()}}},[_c("div",[_vm._v(_vm._s(_vm.$t("common.header.add_item")))])]),_c("td",[_c("div",[_c("el-input",{staticClass:"fc-input-full-border2 width50px inventory-input-width text-center pL20",attrs:{placeholder:"",type:"number",disabled:""}})],1)]),_c("td",[_c("div",{staticClass:"fc-grey3-13 text-right"},[_c("currency",{attrs:{value:0}})],1)]),_c("td",[_c("div",{staticClass:"fc-grey3-13 text-right"},[_c("currency",{attrs:{value:0}})],1)]),_c("td")])])])]),_vm.itemnsloading?_c("div",{staticClass:"item-add"}):_c("div",{staticClass:"item-add"},[_vm.actionRule&&_vm.isNotPortal?_c("div",{staticClass:"fL"},[_c("div",{staticClass:"green-txt-13 fc-v1-add-txt pointer"},[_vm.workorderItemsList.length?_c("span",{staticClass:"mR20",on:{click:function($event){return _vm.addNewWOItem()}}},[_c("img",{attrs:{src:__webpack_require__(353654)}}),_vm._v(" "+_vm._s(_vm.$t("common.header.add_item"))+" ")]):_vm._e(),_c("span",{on:{click:function($event){_vm.issueItemIRDialogVisibility=!0}}},[_c("img",{attrs:{src:__webpack_require__(353654)}}),_vm._v(_vm._s(_vm.$t("common.products.add_issued_item"))+" ")])])]):_vm._e(),_c("div",{staticClass:"fR inline-flex mR30"},[_c("div",{staticClass:"bold mR60"},[_vm._v(_vm._s(_vm.$t("common.header._total")))]),_c("div",{staticClass:"fc-black3-16 text-right bold pR7"},[_c("currency",{attrs:{value:_vm.workItemTotalCost}})],1)])])]),_c("div",{staticClass:"p30 white-bg-block mB20"},[_c("div",{staticClass:"flex-middle"},[_c("div",{staticClass:"fc-v1-icon-bg text-center"},[_c("InlineSvg",{attrs:{src:"svgs/service",iconClass:"icon icon-lg fill-white"}})],1),_c("div",{staticClass:"fc-black3-16 mL10"},[_vm._v(" "+_vm._s(_vm.$t("common.products.services"))+" ")])]),_c("div",{staticClass:"inventory-table inventory-tool-table inventory-labour-tool-table pT20"},[_vm.loading.woService?_c("table",{staticClass:"width100"},[_c("tr",[_c("td",{attrs:{colspan:"100%"}},[_c("div",{staticClass:"iTloading in-no-data"},[_c("spinner",{attrs:{show:!0,size:"80"}})],1)])])]):_c("table",{staticClass:"width100"},[_c("thead",[_c("tr",[_c("th",{staticStyle:{width:"180px"}},[_vm._v(" "+_vm._s(_vm.$t("common.products._service"))+" ")]),_c("th",{staticClass:"text-right width110px"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report._start_time"))+" ")]),_c("th",{staticClass:"text-right width110px pL20"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report._end_time"))+" ")]),_c("th",{staticClass:"text-right width130px"},[_vm._v(" "+_vm._s(_vm.$t("common._common.duration_hr"))+" ")]),_c("th",{staticClass:"text-right width130px"},[_vm._v(" "+_vm._s(_vm.$t("common._common._quantity"))+" ")]),_c("th",{staticClass:"text-right"},[_vm._v(_vm._s(_vm.$t("common.header._price")))]),_c("th",{staticClass:"text-right"},[_vm._v(_vm._s(_vm.$t("common.tabs._cost")))]),_c("th",{staticClass:"width40px"})])]),_vm.workorderServiceList.length?_c("tbody",_vm._l(_vm.workorderServiceList,(function(workService){return _c("tr",{key:workService.id,staticClass:"borderB1px border-color11 visibility-visible-actions pointer"},[_c("td",[_c("div",{staticClass:"pL17",staticStyle:{width:"180px"}},[_c("div",[_vm._v(_vm._s(workService.service.name))])])]),_c("td",[_c("div",{staticClass:"in-Quantity width110px"},[_c("div",{staticClass:"fc-black-13 text-right pR17"},[_vm._v(" "+_vm._s(_vm.formatTime(Number(workService.startTime),"hh:mm a",!1))+" ")]),_c("div",{staticClass:"fc-grey2-text12 text-right"},[_c("el-date-picker",{staticClass:"fc-input-border-remove inventory-date-picker pL40 fc-grey2-text12",attrs:{format:"dd-MM-yyyy hh:mm a","value-format":"timestamp",type:"datetime",disabled:!_vm.actionRule||1===_vm.$getProperty(workService,"service.paymentType"),placeholder:"Start time"},on:{change:function($event){return _vm.changeWorkServiceField(workService,1)}},model:{value:workService.startTime,callback:function($$v){_vm.$set(workService,"startTime",$$v)},expression:"workService.startTime"}})],1)])]),_c("td",{staticClass:"pL20"},[_c("div",{staticClass:"in-Quantity width110px"},[_c("div",{staticClass:"fc-black-13 text-right"},[_vm._v(" "+_vm._s(_vm.formatTime(Number(workService.endTime),"hh:mm a",!1))+" ")]),_c("div",{staticClass:"fc-grey2-text12 text-right"},[_c("el-date-picker",{staticClass:"fc-input-border-remove inventory-date-picker pL40 fc-grey2-text12",attrs:{format:"dd-MM-yyyy hh:mm a","value-format":"timestamp",type:"datetime",disabled:!_vm.actionRule||1===_vm.$getProperty(workService,"service.paymentType"),placeholder:"End time","picker-options":{disabledDate:function(time){return time.getTime()<workService.startTime}}},on:{change:function($event){return _vm.changeWorkServiceField(workService,2)}},model:{value:workService.endTime,callback:function($$v){_vm.$set(workService,"endTime",$$v)},expression:"workService.endTime"}})],1)])]),_c("td",[_c("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"top",arrow:!0,animation:"shift-away"},expression:"{\n                    placement: 'top',\n                    arrow: true,\n                    animation: 'shift-away',\n                  }"}],staticClass:"in-Quantity",staticStyle:{width:"70px","text-align":"right",float:"right"},attrs:{title:workService.duration}},[_c("el-input",{staticClass:"pL10 labour-inventory-items-input labour-inventory-input pR0 fc-input-full-border-select2",attrs:{placeholder:_vm.$t("common._common._duration"),disabled:!_vm.actionRule||1===_vm.$getProperty(workService,"service.paymentType")},on:{change:function($event){return _vm.changeWorkServiceField(workService,3)}},model:{value:workService.duration,callback:function($$v){_vm.$set(workService,"duration",$$v)},expression:"workService.duration"}})],1)]),_c("td",[_c("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"top",arrow:!0,animation:"shift-away"},expression:"{\n                    placement: 'top',\n                    arrow: true,\n                    animation: 'shift-away',\n                  }"}],staticClass:"in-Quantity",staticStyle:{width:"70px","text-align":"right",float:"right"},attrs:{title:workService.quantity}},[_c("el-input",{staticClass:"pL10 labour-inventory-items-input labour-inventory-input pR0 fc-input-full-border-select2",attrs:{placeholder:_vm.$t("common._common._duration"),disabled:!_vm.actionRule||2===_vm.$getProperty(workService,"service.paymentType")},on:{change:function($event){return _vm.changeWorkServiceField(workService,4)}},model:{value:workService.quantity,callback:function($$v){_vm.$set(workService,"quantity",$$v)},expression:"workService.quantity"}})],1)]),_c("td",[_c("div",{staticClass:"text-right"},[_c("currency",{attrs:{value:(workService.service||{}).buyingPrice||0}})],1)]),_c("td",[_c("div",{staticClass:"text-right"},[_c("currency",{attrs:{value:workService.cost}})],1)]),_c("td",{directives:[{name:"show",rawName:"v-show",value:_vm.actionRule,expression:"actionRule"}]},[_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-delete pointer inv-delet-icon visibility-hide-actions pR10 pL10",attrs:{"data-arrow":"true",title:_vm.$t("common._common.delete")},on:{click:function($event){return _vm.deleteWoService(workService)}}})])])})),0):_c("tbody",[_c("tr",[_c("td",{staticClass:"inventory-td-selected pL20 pT10 pB10",class:{disabled:!_vm.actionRule},on:{click:function($event){_vm.actionRule&&_vm.addNewWOService()}}},[_c("div",[_vm._v(_vm._s(_vm.$t("common.header.add_service")))])]),_vm._m(0),_vm._m(1),_c("td",[_c("div",{staticClass:"text-right"},[_c("el-input",{staticClass:"fc-input-full-border2 width50px inventory-input-width text-center mR10",attrs:{placeholder:"",type:"number",disabled:""}})],1)]),_c("td",[_c("div",{staticClass:"text-right"},[_c("el-input",{staticClass:"fc-input-full-border2 width50px inventory-input-width text-center mR10",attrs:{placeholder:"",type:"number",disabled:""}})],1)]),_c("td",{staticClass:"pT10 pB10"},[_c("div",{staticClass:"fc-grey3-13 text-right"},[_c("currency",{attrs:{value:0}})],1)]),_c("td",{staticClass:"pT10 pB10"},[_c("div",{staticClass:"fc-grey3-13 text-right"},[_c("currency",{attrs:{value:0}})],1)]),_c("td")])])])]),_vm.loading.woService?_c("div",{staticClass:"item-add"}):_c("div",{staticClass:"item-add"},[_c("div",{directives:[{name:"show",rawName:"v-show",value:_vm.isNotPortal&&_vm.actionRule&&(_vm.workorderServiceList||[]).length,expression:"\n            isNotPortal && actionRule && (workorderServiceList || []).length\n          "}],staticClass:"fL"},[_c("div",{staticClass:"green-txt-13 fc-v1-add-txt pointer",on:{click:_vm.addNewWOService}},[_c("img",{attrs:{src:__webpack_require__(353654)}}),_vm._v(_vm._s(_vm.$t("common.header.add_service"))+" ")])]),_c("div",{staticClass:"fR inline-flex mR44"},[_c("div",{staticClass:"bold mR50"},[_vm._v(_vm._s(_vm.$t("common.header._total")))]),_c("div",{staticClass:"fc-black3-16 text-right bold pL10"},[_c("currency",{attrs:{value:_vm.workServiceCost}})],1)])])]),_vm.showLabour?_c("div",{staticClass:"p30 white-bg-block mB20"},[_c("div",{staticClass:"flex-middle"},[_c("div",{staticClass:"fc-v1-icon-bg text-center"},[_c("InlineSvg",{attrs:{src:"svgs/labour",iconClass:"icon icon-lg"}})],1),_c("div",{staticClass:"fc-black3-16 mL10"},[_vm._v(_vm._s(_vm.$t("common.header.labour")))])]),_c("div",{staticClass:"inventory-table inventory-tool-table inventory-labour-tool-table pT20"},[_vm.labourLoading?_c("table",{staticClass:"width100"},[_c("tr",[_c("td",{attrs:{colspan:"100%"}},[_c("div",{staticClass:"iTloading in-no-data"},[_c("spinner",{attrs:{show:!0,size:"80"}})],1)])])]):_c("table",{staticClass:"width100"},[_c("thead",[_c("tr",[_c("th",{staticStyle:{width:"180px"}},[_vm._v(" "+_vm._s(_vm.$t("common.header._labour"))+" ")]),_c("th",{staticClass:"text-right width110px"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report._start_time"))+" ")]),_c("th",{staticClass:"text-right width110px pL20"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report._end_time"))+" ")]),_c("th",{staticClass:"text-right width130px"},[_vm._v(" "+_vm._s(_vm.$t("common._common.duration_hr"))+" ")]),_c("th",{staticClass:"text-right"},[_vm._v(_vm._s(_vm.$t("common.header.rate_hr")))]),_c("th",{staticClass:"text-right"},[_vm._v(_vm._s(_vm.$t("common.tabs._cost")))]),_c("th",{staticClass:"width40px"})])]),_vm.workorderLabourList.length?_c("tbody",_vm._l(_vm.workorderLabourList,(function(workLabour,index){return _c("tr",{key:workLabour.id,staticClass:"borderB1px border-color11 visibility-visible-actions pointer"},[_c("td",[_c("div",{staticClass:"pL17",staticStyle:{width:"180px"}},[_c("div",[_vm._v(_vm._s(workLabour.labour.name))])])]),_c("td",[_c("div",{staticClass:"in-Quantity width110px"},[_c("div",{staticClass:"fc-black-13 text-right pR17"},[_vm._v(" "+_vm._s(_vm.formatTime(Number(workLabour.startTime),"hh:mm a",!1))+" ")]),_c("div",{staticClass:"fc-grey2-text12 text-right"},[_c("el-date-picker",{staticClass:"fc-input-border-remove inventory-date-picker pL40 fc-grey2-text12",attrs:{format:"dd-MM-yyyy hh:mm a","value-format":"timestamp",type:"datetime",disabled:!_vm.actionRule,placeholder:_vm.$t("common.wo_report.start_time")},on:{change:function($event){return _vm.changeWorkLabourField(workLabour,index,1)}},model:{value:workLabour.startTime,callback:function($$v){_vm.$set(workLabour,"startTime",$$v)},expression:"workLabour.startTime"}})],1)])]),_c("td",{staticClass:"pL20"},[_c("div",{staticClass:"in-Quantity width110px"},[_c("div",{staticClass:"fc-black-13 text-right"},[_vm._v(" "+_vm._s(_vm.formatTime(Number(workLabour.endTime),"hh:mm a",!1))+" ")]),_c("div",{staticClass:"fc-grey2-text12 text-right"},[_c("el-date-picker",{staticClass:"fc-input-border-remove inventory-date-picker pL40 fc-grey2-text12",attrs:{format:"dd-MM-yyyy hh:mm a","value-format":"timestamp",type:"datetime",disabled:!_vm.actionRule,placeholder:_vm.$t("common.wo_report.end_time"),"picker-options":{disabledDate:function(time){return time.getTime()<workLabour.startTime}}},on:{change:function($event){return _vm.changeWorkLabourField(workLabour,index,2)}},model:{value:workLabour.endTime,callback:function($$v){_vm.$set(workLabour,"endTime",$$v)},expression:"workLabour.endTime"}})],1)])]),_c("td",[_c("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"top",arrow:!0,animation:"shift-away"},expression:"{\n                    placement: 'top',\n                    arrow: true,\n                    animation: 'shift-away',\n                  }"}],staticClass:"in-Quantity",staticStyle:{width:"70px","text-align":"right",float:"right"},attrs:{title:workLabour.duration}},[_c("el-input",{staticClass:"pL10 labour-inventory-items-input labour-inventory-input pR0 fc-input-full-border-select2",attrs:{placeholder:"duration",disabled:!_vm.actionRule},on:{change:function($event){return _vm.changeWorkLabourField(workLabour,index,3)}},model:{value:workLabour.duration,callback:function($$v){_vm.$set(workLabour,"duration",$$v)},expression:"workLabour.duration"}})],1)]),_c("td",[_c("div",{staticClass:"text-right"},[_c("currency",{attrs:{value:workLabour.labour.cost}})],1)]),_c("td",[_c("div",{staticClass:"text-right"},[_c("currency",{attrs:{value:workLabour.cost}})],1)]),_c("td",{directives:[{name:"show",rawName:"v-show",value:_vm.actionRule,expression:"actionRule"}]},[_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-delete pointer inv-delet-icon visibility-hide-actions pR10 pL10",attrs:{"data-arrow":"true",title:_vm.$t("common._common.delete_labour")},on:{click:function($event){return _vm.deleteWorkorderLabour(workLabour,index)}}})])])})),0):_c("tbody",[_c("tr",[_c("td",{staticClass:"inventory-td-selected pL20 pT10 pB10",class:{disabled:!_vm.actionRule},on:{click:function($event){_vm.actionRule&&_vm.addNewWOLabour()}}},[_c("div",[_vm._v(_vm._s(_vm.$t("common.header._add_labour")))])]),_vm._m(2),_vm._m(3),_c("td",[_c("div",{staticClass:"text-right"},[_c("el-input",{staticClass:"fc-input-full-border2 width50px inventory-input-width text-center mR10",attrs:{placeholder:"",type:"number",disabled:""}})],1)]),_c("td",{staticClass:"pT10 pB10"},[_c("div",{staticClass:"fc-grey3-13 text-right"},[_c("currency",{attrs:{value:0}})],1)]),_c("td",{staticClass:"pT10 pB10"},[_c("div",{staticClass:"fc-grey3-13 text-right"},[_c("currency",{attrs:{value:0}})],1)]),_c("td")])])])]),_vm.labourLoading?_c("div",{staticClass:"item-add"}):_c("div",{staticClass:"item-add"},[_c("div",{directives:[{name:"show",rawName:"v-show",value:_vm.isNotPortal&&_vm.actionRule&&_vm.workorderLabourList.length,expression:"isNotPortal && actionRule && workorderLabourList.length"}],staticClass:"fL"},[_c("div",{staticClass:"green-txt-13 fc-v1-add-txt pointer",on:{click:_vm.addNewWOLabour}},[_c("img",{attrs:{src:__webpack_require__(353654)}}),_vm._v(_vm._s(_vm.$t("common.header._add_labour"))+" ")])]),_c("div",{staticClass:"fR inline-flex mR44"},[_c("div",{staticClass:"bold mR50"},[_vm._v(_vm._s(_vm.$t("common.header._total")))]),_c("div",{staticClass:"fc-black3-16 text-right bold pL10"},[_c("currency",{attrs:{value:_vm.workLabourTotalCost}})],1)])])]):_vm._e(),_c("div",{staticClass:"p30 white-bg-block mB100"},[_c("div",{staticClass:"flex-middle justify-content-space"},[_c("div",{staticClass:"inline-flex"},[_c("div",{staticClass:"fc-v1-icon-bg"},[_c("InlineSvg",{attrs:{src:"svgs/settings3",iconClass:"icon icon-md stroke-white"}})],1),_c("div",{staticClass:"fc-black3-16 mL10 mT12"},[_vm._v(" "+_vm._s(_vm.$t("common.header.tools"))+" ")])])]),_c("div",{staticClass:"inventory-table inventory-tool-table inventory-table-body-border-none overflow-x mT20",staticStyle:{border:"1px solid #eceef1"}},[_vm.toolLoading?_c("table",{staticClass:"width100",staticStyle:{border:"none"}},[_c("tr",[_c("td",{attrs:{colspan:"100%"}},[_c("div",{staticClass:"iTloading in-no-data"},[_c("spinner",{attrs:{show:!0,size:"80"}})],1)])])]):_c("table",{staticClass:"width100",staticStyle:{border:"none"}},[_c("thead",[_c("tr",{staticClass:"border-top-none"},[_c("th",{staticClass:"border-top-none",staticStyle:{width:"300px"}},[_vm._v(" "+_vm._s(_vm.$t("common.header._tool"))+" ")]),_c("th",{staticClass:"pR0 border-top-none"},[_vm._v(" "+_vm._s(_vm.$t("common._common._quantity"))+" ")]),_c("th",{staticClass:"text-right width110px border-top-none"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report._start_time"))+" ")]),_c("th",{staticClass:"text-right width110px pL20 border-top-none"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report._end_time"))+" ")]),_c("th",{staticClass:"text-right width130px border-top-none"},[_vm._v(" "+_vm._s(_vm.$t("common._common.duration_hr"))+" ")]),_c("th",{staticClass:"text-right border-top-none width130px pR20 pL20"},[_vm._v(" "+_vm._s(_vm.$t("common.header.rate_hr"))+" ")]),_c("th",{staticClass:"text-right worktool-cost-sticky border-top-none"},[_vm._v(" "+_vm._s(_vm.$t("common.tabs._cost"))+" ")]),_c("th",{staticClass:"width40px worktool-cost-edit-sticky border-top-none"})])]),_vm.workorderToolsList.length?_c("tbody",[_vm._l(_vm.workorderToolsList,(function(workTool,index){return[2===workTool.approvedState?_c("tr",{key:workTool.id,staticClass:"borderB1px border-color11 visibility-visible-actions pointer"},[_c("td",{staticClass:"pT10 pB10"},[_c("div",{staticClass:"pL17",staticStyle:{width:"180px"}},[workTool.tool.toolType.isRotating&&workTool.purchasedTool?_c("div",{staticClass:"fc-id",staticStyle:{"padding-bottom":"4px"}},[_vm._v(" #"+_vm._s(workTool.purchasedTool.serialNumber)+" ")]):_vm._e(),_c("div",[_vm._v(_vm._s(workTool.tool.toolType.name))])])]),_c("td",{staticClass:"pT10 pB10"},[_c("div",{staticClass:"in-Quantity"},[workTool.tool.toolType.isRotating?_c("div",{staticClass:"item"},[_c("div",{staticClass:"workItem-quantity"},[_vm._v(" "+_vm._s(workTool.quantity)+" ")])]):_c("el-tooltip",{staticClass:"item text-center quant",class:{exceeded:_vm.getToolQuantityState(workTool)},attrs:{effect:"dark",content:_vm.actionRule?_vm.$t("common.products.Available tools")+_vm.getToolCount(workTool):_vm.$t("common.header.please_open_the_workorder"),placement:"right-end"}},[[_c("el-form",{ref:"numberValidateForm",refInFor:!0,staticClass:"width50px inventory-input-width",class:{exceeded:_vm.getToolQuantityState(workTool)},attrs:{model:workTool},nativeOn:{submit:function($event){return $event.preventDefault(),_vm.checkEnter.apply(null,arguments)}}},[_c("el-form-item",{attrs:{label:"",prop:"quantity"}},[_c("el-input",{staticClass:"fc-input-full-border2 width50px inventory-input-width text-right pL20",attrs:{placeholder:"",type:"number",disabled:!_vm.actionRule},on:{change:function($event){return _vm.changeWorkToolField(workTool,index)}},model:{value:workTool.quantity,callback:function($$v){_vm.$set(workTool,"quantity",$$v)},expression:"workTool.quantity"}})],1)],1)]],2)],1)]),_c("td",{staticClass:"pT10 pB10"},[_c("div",{staticClass:"in-Quantity pL0 width110px"},[_c("div",{staticClass:"fc-black-13 text-right"},[_vm._v(" "+_vm._s(_vm.formatTime(Number(workTool.issueTime),"hh:mm a",!1))+" ")]),_c("div",{staticClass:"fc-grey2-text12 text-right"},[_c("el-date-picker",{staticClass:"fc-input-border-remove inventory-date-picker pL40 fc-grey2-text12",attrs:{format:"dd-MM-yyyy hh:mm a","value-format":"timestamp",type:"datetime",disabled:!_vm.actionRule,placeholder:"Start time","default-time":["12:00:00"]},on:{change:function($event){return _vm.changeWorkToolField(workTool,index,!1,1)}},model:{value:workTool.issueTime,callback:function($$v){_vm.$set(workTool,"issueTime",$$v)},expression:"workTool.issueTime"}})],1)])]),_c("td",{staticClass:"pT10 pB10 pL20"},[_c("div",{staticClass:"in-Quantity width110px"},[_c("div",{staticClass:"fc-black-13 text-right"},[_vm._v(" "+_vm._s(_vm.formatTime(Number(workTool.returnTime),"hh:mm a",!1))+" ")]),_c("div",{staticClass:"fc-grey2-text12 text-right"},[_c("el-date-picker",{staticClass:"fc-input-border-remove inventory-date-picker pL40 fc-grey2-text12",attrs:{format:"dd-MM-yyyy hh:mm a","value-format":"timestamp",type:"datetime",disabled:!_vm.actionRule,placeholder:_vm.$t("common.wo_report.end_time"),"picker-options":{disabledDate:function(time){return time.getTime()<workTool.issueTime}}},on:{change:function($event){return _vm.changeWorkToolField(workTool,index,!1,2)}},model:{value:workTool.returnTime,callback:function($$v){_vm.$set(workTool,"returnTime",$$v)},expression:"workTool.returnTime"}})],1)])]),_c("td",{staticClass:"pT10 pB10"},[_c("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"top",arrow:!0,animation:"shift-away"},expression:"{\n                      placement: 'top',\n                      arrow: true,\n                      animation: 'shift-away',\n                    }"}],staticClass:"in-Quantity",staticStyle:{width:"70%","text-align":"right",float:"right"},attrs:{title:workTool.durationInHour}},[_c("el-input",{staticClass:"pL10 inventory-items-input fc-input-full-border-select2",attrs:{placeholder:_vm.$t("common._common._duration"),disabled:!_vm.actionRule},on:{change:function($event){return _vm.changeWorkToolField(workTool,index,!0,3)}},model:{value:workTool.durationInHour,callback:function($$v){_vm.$set(workTool,"durationInHour",$$v)},expression:"workTool.durationInHour"}})],1)]),_c("td",[_c("div",{staticClass:"text-right"},[_c("currency",{attrs:{value:workTool.tool.rate}})],1)]),_c("td",{staticClass:"pT10 pB10"},[_c("div",{staticClass:"text-right"},[_c("div",{staticClass:"text-right"},[_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"fa fa-lock f18",attrs:{"data-arrow":"true",title:_vm.$t("common.products.waiting_for_approval")}})])])]),_c("td",[_vm.actionRule?_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-delete pointer inv-delet-icon visibility-hide-actions pR10 pL10",attrs:{"data-arrow":"true",title:_vm.$t("common.header.delete_tool")},on:{click:function($event){return _vm.deleteWorkorderTool(workTool,index)}}}):_vm._e()])]):4===workTool.approvedState?_c("tr",{key:workTool.id,staticClass:"borderB1px border-color11 visibility-visible-actions pointer disabled"},[_c("td",{staticClass:"pT10 pB10"},[_c("div",{staticClass:"pL17",staticStyle:{width:"300px"}},[workTool.tool.toolType.isRotating&&workTool.purchasedTool?_c("div",{staticClass:"fc-id",staticStyle:{"padding-bottom":"4px"}},[_vm._v(" #"+_vm._s(workTool.purchasedTool.serialNumber)+" ")]):_vm._e(),_c("div",[_vm._v(_vm._s(workTool.tool.toolType.name))])])]),_c("td",{staticClass:"pT10 pB10"},[_c("div",{staticClass:"in-Quantity"},[_c("div",{staticClass:"item"},[_c("div",{staticClass:"workItem-quantity"},[_vm._v(" "+_vm._s(workTool.quantity)+" ")])])])]),_c("td",{staticClass:"pT10 pB10"},[_c("div",{staticClass:"in-Quantity pL0 width110px"},[_c("div",{staticClass:"fc-black-13 text-right"},[_vm._v(" "+_vm._s(_vm.formatTime(Number(workTool.issueTime),"hh:mm a",!1))+" ")]),_c("div",{staticClass:"fc-grey2-text12 text-right"},[_vm._v(" "+_vm._s(_vm.formatTime(Number(workTool.issueTime),"DD-MM-YYYY",!1))+" ")])])]),_c("td",{staticClass:"pT10 pB10 pL20"},[_c("div",{staticClass:"in-Quantity width110px"},[_c("div",{staticClass:"fc-black-13 text-right"},[_vm._v(" "+_vm._s(_vm.formatTime(Number(workTool.returnTime),"hh:mm a",!1))+" ")]),_c("div",{staticClass:"fc-grey2-text12 text-right"},[_vm._v(" "+_vm._s(_vm.formatTime(Number(workTool.returnTime),"DD-MM-YYYY",!1))+" ")])])]),_c("td",{staticClass:"pT10 pB10"},[_c("div",{staticClass:"in-Quantity",staticStyle:{width:"70%","text-align":"right",float:"right"}},[_vm._v(" "+_vm._s(workTool.durationInHour)+" ")])]),_c("td",{staticClass:"pT10 pB10"},[_c("div",{staticClass:"text-right"},[_c("currency",{attrs:{value:workTool.tool.rate}})],1)]),_c("td",{staticClass:"pT10 pB10"},[_c("div",{staticClass:"text-right"},[_c("currency",{attrs:{value:workTool.cost}})],1)]),_c("td",[_vm.actionRule?_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-delete pointer inv-delet-icon visibility-hide-actions pR10 pL10",attrs:{"data-arrow":"true",title:_vm.$t("common.header.delete_tool")},on:{click:function($event){return _vm.deleteWorkorderTool(workTool,index)}}}):_vm._e()])]):_c("tr",{key:workTool.id,staticClass:"borderB1px border-color11 visibility-visible-actions pointer"},[_c("td",{staticClass:"pT10 pB10"},[_c("div",{staticClass:"pL17",staticStyle:{width:"300px"}},[workTool.tool.toolType.isRotating&&workTool.asset?_c("div",{staticClass:"fc-id",staticStyle:{"padding-bottom":"4px"}},[_vm._v(" #"+_vm._s(workTool.asset.serialNumber)+" ")]):_vm._e(),_c("div",[_vm._v(_vm._s(workTool.tool.toolType.name))])])]),_c("td",{staticClass:"pT10 pB10"},[_c("div",{staticClass:"in-Quantity"},[workTool.tool.toolType.isRotating?_c("div",{staticClass:"item"},[_c("div",{staticClass:"workItem-quantity"},[_vm._v(" "+_vm._s(workTool.quantity)+" ")])]):_c("el-tooltip",{staticClass:"item text-center quant",class:{exceeded:_vm.getToolQuantityState(workTool)},attrs:{effect:"dark",content:_vm.actionRule?_vm.$t("common.products.available_tools")+_vm.getToolCount(workTool):_vm.$t("common.header.please_open_the_workorder"),placement:"right-end"}},[[_c("el-form",{ref:"numberValidateForm",refInFor:!0,staticClass:"width50px inventory-input-width",class:{exceeded:_vm.getToolQuantityState(workTool)},attrs:{model:workTool},nativeOn:{submit:function($event){return $event.preventDefault(),_vm.checkEnter.apply(null,arguments)}}},[_c("el-form-item",{attrs:{label:"",prop:"quantity"}},[_c("el-input",{staticClass:"fc-input-full-border2 width50px inventory-input-width text-right pL20",attrs:{placeholder:"",type:"number",disabled:!_vm.actionRule},on:{change:function($event){return _vm.changeWorkToolField(workTool,index)}},model:{value:workTool.quantity,callback:function($$v){_vm.$set(workTool,"quantity",$$v)},expression:"workTool.quantity"}})],1)],1)]],2)],1)]),_c("td",{staticClass:"pT10 pB10"},[_c("div",{staticClass:"in-Quantity pL0 width110px"},[_c("div",{staticClass:"fc-black-13 text-right"},[_vm._v(" "+_vm._s(_vm.formatTime(Number(workTool.issueTime),"hh:mm a",!1))+" ")]),_c("div",{staticClass:"fc-grey2-text12 text-right"},[_c("el-date-picker",{staticClass:"fc-input-border-remove inventory-date-picker pL40 fc-grey2-text12",attrs:{format:"dd-MM-yyyy hh:mm a","value-format":"timestamp",type:"datetime",placeholder:_vm.$t("common.wo_report.start_time"),disabled:!_vm.actionRule},on:{change:function($event){return _vm.changeWorkToolField(workTool,index,!1,1)}},model:{value:workTool.issueTime,callback:function($$v){_vm.$set(workTool,"issueTime",$$v)},expression:"workTool.issueTime"}})],1)])]),_c("td",{staticClass:"pT10 pB10 pL20"},[_c("div",{staticClass:"in-Quantity width110px"},[_c("div",{staticClass:"fc-black-13 text-right"},[_vm._v(" "+_vm._s(_vm.formatTime(Number(workTool.returnTime),"hh:mm a",!1))+" ")]),_c("div",{staticClass:"fc-grey2-text12 text-right"},[_c("el-date-picker",{staticClass:"fc-input-border-remove inventory-date-picker pL40 fc-grey2-text12",attrs:{format:"dd-MM-yyyy hh:mm a","value-format":"timestamp",type:"datetime",disabled:!_vm.actionRule,placeholder:_vm.$t("common.wo_report.end_time"),"picker-options":{disabledDate:function(time){return time.getTime()<workTool.issueTime}}},on:{change:function($event){return _vm.changeWorkToolField(workTool,index,!1,2)}},model:{value:workTool.returnTime,callback:function($$v){_vm.$set(workTool,"returnTime",$$v)},expression:"workTool.returnTime"}})],1)])]),_c("td",{staticClass:"pT10 pB10"},[_c("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"top",arrow:!0,animation:"shift-away"},expression:"{\n                      placement: 'top',\n                      arrow: true,\n                      animation: 'shift-away',\n                    }"}],staticClass:"in-Quantity",staticStyle:{width:"70%","text-align":"right",float:"right"},attrs:{title:workTool.durationInHour}},[_c("el-input",{staticClass:"pL10 inventory-items-input fc-input-full-border-select2",attrs:{placeholder:_vm.$t("common._common._duration"),disabled:!_vm.actionRule},on:{change:function($event){return _vm.changeWorkToolField(workTool,index,!0,3)}},model:{value:workTool.durationInHour,callback:function($$v){_vm.$set(workTool,"durationInHour",$$v)},expression:"workTool.durationInHour"}})],1)]),_c("td",[_c("div",{staticClass:"text-right pR20 pL20"},[_c("currency",{attrs:{value:workTool.tool.rate}})],1)]),_c("td",{staticClass:"pT10 pB10 worktool-cost-sticky"},[_c("div",{staticClass:"text-right"},[_c("currency",{attrs:{value:workTool.cost}})],1)]),_c("td",{staticClass:"pT10 pB10 worktool-cost-edit-sticky"},[_vm.actionRule?_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-delete pointer inv-delet-icon visibility-hide-actions pR10 pL10",attrs:{"data-arrow":"true",title:_vm.$t("common.header.delete_tool")},on:{click:function($event){return _vm.deleteWorkorderTool(workTool,index)}}}):_vm._e()])])]}))],2):_c("tbody",[_c("tr",[_c("td",{staticClass:"inventory-td-selected pL20 pT10 pB10",class:{disabled:!_vm.actionRule},on:{click:function($event){_vm.actionRule&&_vm.addNewWOTool()}}},[_c("div",[_vm._v(_vm._s(_vm.$t("common.products.add_tool")))])]),_c("td",{staticClass:"pT10 pB10"},[_c("div",[_c("el-input",{staticClass:"fc-input-full-border2 width50px inventory-input-width text-center pL20",attrs:{placeholder:"",type:"number",disabled:""}})],1)]),_vm._m(4),_vm._m(5),_c("td",{staticClass:"pT10 pB10"},[_c("div",{staticClass:"text-right"},[_c("el-input",{staticClass:"fc-input-full-border2 width50px inventory-input-width text-center mR10",attrs:{placeholder:"",type:"number",disabled:""}})],1)]),_c("td",{staticClass:"pT10 pB10"},[_c("div",{staticClass:"fc-grey3-13 text-right"},[_c("currency",{attrs:{value:0}})],1)]),_c("td",{staticClass:"pT10 pB10"},[_c("div",{staticClass:"fc-grey3-13 text-right"},[_c("currency",{attrs:{value:0}})],1)]),_c("td",{staticClass:"pT10 pB10"})])])])]),_vm.toolLoading?_c("div",{staticClass:"item-add"}):_c("div",{staticClass:"item-add"},[_vm.isNotPortal&&_vm.actionRule?_c("div",{staticClass:"fL"},[_c("div",{staticClass:"green-txt-13 fc-v1-add-txt pointer"},[_vm.workorderToolsList.length?_c("span",{staticClass:"pR20",on:{click:_vm.addNewWOTool}},[_c("img",{attrs:{src:__webpack_require__(353654)}}),_vm._v(_vm._s(_vm.$t("common.products.add_tool"))+" ")]):_vm._e(),_c("span",{on:{click:function($event){_vm.issueToolIRDialogVisibility=!0}}},[_c("img",{attrs:{src:__webpack_require__(353654)}}),_vm._v(_vm._s(_vm.$t("common.products.add_issued_tool"))+" ")])])]):_vm._e(),_c("div",{staticClass:"fR inline-flex mR40"},[_c("div",{staticClass:"bold mR50"},[_vm._v(_vm._s(_vm.$t("common.header._total")))]),_c("div",{staticClass:"fc-black3-16 text-right bold pL10"},[_c("currency",{attrs:{value:_vm.workToolTotalCost}})],1)])])])]),_c("div",{staticClass:"fR pm-summary-inner-right-con mT20"},[_c("div",{staticClass:"fc-scrollbar-wrap mT0"},[_c("div",{staticClass:"white-bg-block pm-summary-right-bg wo-summary-right-bg-border"},[_c("div",{staticClass:"new-in-header p30"},[_vm._v(" "+_vm._s(_vm.$t("common.header.overall_cost"))+" ")]),_vm.workOrderCostList.length?_c("div",_vm._l(_vm.workOrderCostList,(function(cost){return _c("el-row",{key:cost.id,staticClass:"overallCost visibility-visible-actions"},["custom"===cost.costTypeEnum&&_vm.actionRule?_c("span",{staticClass:"visibility-hide-actions mL30 export-dropdown-menu additionalCostIcon additionalCostDelete",on:{click:function($event){return _vm.deleteAdditionalCost(cost.id)}}},[_c("i",{staticClass:"el-icon-delete"})]):_vm._e(),"custom"===cost.costTypeEnum?_c("el-col",{attrs:{span:18}},[_c("div",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"label-txt-black textoverflow-ellipsis",attrs:{content:cost.name}},[_vm._v(" "+_vm._s(cost.name)+" ")])]):_c("el-col",{attrs:{span:18}},[_c("div",{staticClass:"label-txt-black textoverflow-ellipsis"},[_vm._v(" "+_vm._s(cost.name)+" ")])]),(cost.costTypeEnum,_c("el-col",{attrs:{span:6}},[_c("div",{staticClass:"label-txt-black text-right"},[_c("currency",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"textoverflow-ellipsis",attrs:{value:cost.cost,content:_vm.$helpers.formatedCurrencyCost(cost.cost)}})],1)]))],1)})),1):_c("div",[_c("el-row",{staticClass:"p30"},[_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"label-txt-black"},[_vm._v(" "+_vm._s(_vm.$t("common.products.items"))+" ")])]),_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"label-txt-black text-right"},[_vm._v("0")])])],1),_c("el-row",{staticClass:"p30 pT10"},[_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"label-txt-black"},[_vm._v(" "+_vm._s(_vm.$t("common.header.tools"))+" ")])]),_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"label-txt-black text-right"},[_vm._v("0")])])],1)],1),_c("el-row",{staticClass:"fc-spares-subtotal-additional overallCost relative visibility-visible-actions"},[_c("el-col",{attrs:{span:17}},[_c("el-input",{staticClass:"fc-input-full-border2 width140px",attrs:{placeholder:_vm.$t("common._common.additional_cost")},on:{change:function($event){return _vm.addAdditionalCost()}},model:{value:_vm.additionalCost.name,callback:function($$v){_vm.$set(_vm.additionalCost,"name",$$v)},expression:"additionalCost.name"}})],1),_c("el-col",{attrs:{span:1}}),_c("el-col",{staticClass:"text-right additionalCostEnter pL20",attrs:{span:6}},["$"===_vm.$currency?_c("el-input",{staticClass:"fc-input-full-border2 inventory-input-width75px text-right",attrs:{placeholder:"0",type:"number",prefix:_vm.$currency},on:{change:function($event){return _vm.addAdditionalCost()}},model:{value:_vm.additionalCost.cost,callback:function($$v){_vm.$set(_vm.additionalCost,"cost",$$v)},expression:"additionalCost.cost"}}):_vm._e(),"$"!==_vm.$currency?_c("el-input",{staticClass:"fc-input-full-border2 inventory-input-width75px text-right",attrs:{placeholder:"0",type:"number",suffix:_vm.$currency},on:{change:function($event){return _vm.addAdditionalCost()}},model:{value:_vm.additionalCost.cost,callback:function($$v){_vm.$set(_vm.additionalCost,"cost",$$v)},expression:"additionalCost.cost"}}):_vm._e()],1)],1),_c("el-row",{staticClass:"border-top1 text-right total-amount"},[_c("el-col",{staticClass:"p30 pT10",attrs:{span:24}},[_c("div",{},[_c("currency",{attrs:{value:_vm.workOrderTotalCost}})],1),_c("div",{staticClass:"fc-text-pink13 fw-bold text-right pT5"},[_vm._v(" "+_vm._s(_vm.$t("common.header._total"))+" ")])])],1)],1)])]),_c("el-dialog",{attrs:{visible:_vm.newItemPartToggle,fullscreen:!1,open:"top","custom-class":"fc-dialog-up Inventoryaddvaluedialog","append-to-body":!0,width:"55%"},on:{"update:visible":function($event){_vm.newItemPartToggle=$event}}},[_vm.individualTracking?_c("div",[_c("div",{staticClass:"new-header-container popup-container-new"},[_c("div",{staticClass:"fc-setup-modal-title"},[_c("i",{staticClass:"el-icon-back inv-id-bac-icon pointer",on:{click:function($event){_vm.individualItemList=[],_vm.selectedInventory=null}}}),_vm._v(" "+_vm._s(_vm.selectedInventory.itemType.name)+" ")]),_c("div",{staticClass:"search-bar",class:{active:_vm.hidequrry}},[_vm.hidequrry?_c("i",{staticClass:"el-input__icon el-icon-search",staticStyle:{"line-height":"0px !important","font-size":"16px !important"},attrs:{slot:"suffix"},on:{click:function($event){_vm.hidequrry=!1}},slot:"suffix"}):_c("el-input",{staticClass:"el-input-textbox-full-border inv-search-grey",attrs:{autofocus:!0,type:"text",placeholder:_vm.$t("common._common.to_search_type")},on:{blur:function($event){_vm.hidequrry=!0}},model:{value:_vm.itemSerachQuerry,callback:function($$v){_vm.itemSerachQuerry=$$v},expression:"itemSerachQuerry"}},[_c("i",{staticClass:"el-input__icon el-icon-search",staticStyle:{"line-height":"0px !important","font-size":"16px !important"},attrs:{slot:"suffix"},slot:"suffix"})])],1)]),_c("div",{staticClass:"fc-inv-container-body"},[_c("table",{staticClass:"setting-list-view-table width100 invent-table-dialog"},[_c("thead",[_c("th",{staticClass:"setting-table-th setting-th-text"},[_vm._v(" "+_vm._s(_vm.$t("common.header.s_no"))+" ")]),_c("th",{staticClass:"setting-table-th setting-th-text"})]),_vm.iTloading?_c("tbody",[_c("tr",[_c("td",{attrs:{colspan:"100%"}},[_c("div",{staticClass:"iTloading"},[_c("spinner",{attrs:{show:!0,size:"80"}})],1)])])]):_vm.individualItemListwrapper.length?_c("tbody",_vm._l(_vm.individualItemListwrapper,(function(item,idx){return _c("tr",{key:idx,staticClass:"tablerow asset-hover-td"},[_c("td",[_c("div",[_vm._v(_vm._s(item.serialNumber))]),_c("div")]),_c("td",{staticClass:"text-right"},[_vm.selectedInventory.invidualList.findIndex((function(rt){return rt.id===item.id}))>-1?[_c("el-button",{staticClass:"f-number-input f-number-input-no-border",attrs:{size:"mini"},on:{click:function($event){_vm.selectedInventory.invidualList.splice(_vm.selectedInventory.invidualList.findIndex((function(rt){return rt.id===item.id})),1)}}},[_vm._v(_vm._s(_vm.$t("common.products_added")))])]:item.checked?[_c("el-button",{staticClass:"f-number-input f-number-input-no-border",attrs:{size:"mini"},on:{click:function($event){item.checked=!1}}},[_vm._v(_vm._s(_vm.$t("common.products_added")))])]:[_c("el-button",{staticClass:"f-number-input",attrs:{size:"mini"},on:{click:function($event){item.checked=!0}}},[_vm._v(_vm._s(_vm.$t("common._common._add")))])]],2)])})),0):_c("tbody",[_c("tr",[_c("td",{attrs:{colspan:"100%"}},[_c("div",{staticClass:"flex-middle justify-content-center flex-direction-column"},[_c("inline-svg",{attrs:{src:"svgs/emptystate/inventory",iconClass:"icon text-center icon-100"}}),_c("div",{staticClass:"f14 nowo-label"},[_vm._v(" "+_vm._s(_vm.$t("common.products.no_item_present"))+" ")])],1)])])])])]),_c("div",{staticClass:"modal-dialog-footer-parts-dialog"},[_c("el-button",{staticClass:"modal-btn-save width100",staticStyle:{"margin-left":"0px !important"},attrs:{type:"primary",disabled:_vm.iTloading},on:{click:_vm.addindIvidualTrackingItem}},[_vm._v(_vm._s(_vm.$t("common._common._done")))])],1)]):_c("div",[_c("div",{staticClass:"new-header-container popup-container-new"},[_c("div",{staticClass:"fc-setup-modal-title"},[_vm._v(" "+_vm._s(_vm.$t("common.products.items_list"))+" ")]),_c("div",{staticClass:"store-room-bar",class:{active:!_vm.hidequrry}},[_c("el-select",{staticClass:"fc-tag fc-input-full-border2",staticStyle:{"margin-left":"20px"},attrs:{multiple:"","collapse-tags":"",placeholder:_vm.$t("common.products.select_storeroom")},model:{value:_vm.selectedStoreList,callback:function($$v){_vm.selectedStoreList=$$v},expression:"selectedStoreList"}},_vm._l(_vm.tempStoreList,(function(item,index){return _c("el-option",{key:index,attrs:{label:item.name,value:item.id}})})),1)],1),_c("div",{staticClass:"search-bar",class:{active:_vm.hidequrry}},[_vm.hidequrry?_c("i",{staticClass:"el-input__icon el-icon-search",staticStyle:{"line-height":"0px !important","font-size":"16px !important"},attrs:{slot:"suffix"},on:{click:function($event){_vm.hidequrry=!1}},slot:"suffix"}):_c("el-input",{staticClass:"el-input-textbox-full-border",attrs:{autofocus:!0,type:"text",placeholder:_vm.$t("common._common.to_search_type")},on:{blur:function($event){_vm.hidequrry=!0}},model:{value:_vm.itemSerachQuerry,callback:function($$v){_vm.itemSerachQuerry=$$v},expression:"itemSerachQuerry"}},[_c("span",{staticClass:"sub-divider"},[_vm._v("|")]),_c("i",{staticClass:"el-input__icon el-icon-search pointer",staticStyle:{"line-height":"0px !important","font-size":"16px !important"},attrs:{slot:"suffix"},slot:"suffix"})])],1)]),_c("div",{staticClass:"fc-inv-container-body"},[_vm.inventoryListLoading?_c("table",{staticClass:"width100"},[_c("tr",[_c("td",{attrs:{colspan:"100%"}},[_c("div",{staticClass:"iTloading in-no-data"},[_c("spinner",{attrs:{show:!0,size:"80"}})],1)])])]):_c("table",{staticClass:"setting-list-view-table width100 invent-table-dialog inventor-store-adde-table"},[_vm.inventoryList.length?_c("tbody",[_vm._l(_vm.inventoryList,(function(invt,index){return _c("tr",{key:invt.id,staticClass:"tablerow asset-hover-td height100px"},[_c("td",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"top-start",animation:"shift-away"},expression:"{\n                    placement: 'top-start',\n                    animation: 'shift-away',\n                  }"}],staticClass:"width80",attrs:{title:invt.itemType.name+" - "+invt.storeRoom.name}},[_vm._v(" "+_vm._s(invt.itemType.name)+" ")]),_c("td",{staticClass:"width160px text-align-inventory"},[invt.itemType.isRotating?[invt.invidualList&&invt.invidualList.length>0?_c("el-button",{staticClass:"f-number-input f-number-input-no-border",attrs:{size:"mini"},on:{click:function($event){_vm.selectItem(invt,index),invt.checked=!0}}},[_vm._v(_vm._s(invt.invidualList.length)+" "+_vm._s(_vm.$t("common.products.qty_added")))]):_c("el-button",{staticClass:"f-number-input",attrs:{size:"mini"},on:{click:function($event){_vm.selectItem(invt,index),invt.checked=!0,_vm.itemSerachQuerry=null}}},[_vm._v(_vm._s(_vm.$t("common._common._add")))])]:0===invt.addedQuantity?[_c("el-button",{staticClass:"f-number-input",attrs:{size:"mini"},on:{click:function($event){invt.addedQuantity=1,invt.checked=!0}}},[_vm._v(_vm._s(_vm.$t("common._common._add")))])]:[_c("el-input-number",{staticClass:"f-number-input",attrs:{size:"mini",min:0,max:invt.quantity},on:{change:function($event){return _vm.handeler1(invt,index)}},model:{value:invt.addedQuantity,callback:function($$v){_vm.$set(invt,"addedQuantity",$$v)},expression:"invt.addedQuantity"}})],_c("div",{staticClass:"secondary-quantity-text pT10"},[_vm._v(" "+_vm._s(_vm.$t("common.products.available"))+": "+_vm._s(invt.quantity)+" ")])],2)])}))],2):_c("tbody",[_c("tr",[_c("td",{attrs:{colspan:"100%"}},[_c("div",{staticClass:"flex-middle justify-content-center flex-direction-column"},[_c("inline-svg",{attrs:{src:"svgs/emptystate/inventory",iconClass:"icon text-center icon-100"}}),_c("div",{staticClass:"nowo-label"},[_vm._v(" "+_vm._s(_vm.$t("common.products.no_item_present"))+" ")])],1)])])])])]),_c("div",{staticClass:"modal-dialog-footer-parts-dialog"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){return _vm.cancelItemPartsDialog()}}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",staticStyle:{"margin-left":"0px !important"},attrs:{type:"primary"},on:{click:function($event){return _vm.addNewbulkItem()}}},[_vm._v(_vm._s(_vm.$t("common._common._add")))])],1)])]),_c("el-dialog",{attrs:{visible:_vm.newLabourToggle,fullscreen:!1,open:"top","custom-class":"fc-dialog-up Inventoryaddvaluedialog","append-to-body":!0},on:{"update:visible":function($event){_vm.newLabourToggle=$event}}},[_c("div",{staticClass:"new-header-container"},[_c("div",{staticClass:"fc-setup-modal-title"},[_vm._v(" "+_vm._s(_vm.$t("common.header.labour_list"))+" ")])]),_c("div",{staticClass:"fc-inv-container-body"},[_c("table",{staticClass:"setting-list-view-table width100 invent-table-dialog"},[_c("thead",[_c("th",{staticClass:"setting-table-th setting-th-text"}),_c("th",{staticClass:"setting-table-th setting-th-text"},[_vm._v(" "+_vm._s(_vm.$t("common.products.name"))+" ")]),_c("th",{staticClass:"setting-table-th setting-th-text"},[_vm._v(" "+_vm._s(_vm.$t("common._common._phone_number"))+" ")]),_c("th",{staticClass:"setting-table-th setting-th-text"},[_vm._v(" "+_vm._s(_vm.$t("common._common.status"))+" ")])]),_vm.labourList.length?_c("tbody",_vm._l(_vm.labourList,(function(labour){return _c("tr",{key:labour.id,staticClass:"tablerow asset-hover-td"},[_c("td",{staticStyle:{width:"10%"}},[_c("el-checkbox",{model:{value:labour.checked,callback:function($$v){_vm.$set(labour,"checked",$$v)},expression:"labour.checked"}})],1),_c("td",[_vm._v(_vm._s(labour.name))]),_c("td",[_vm._v(_vm._s(labour.phone))]),_c("td",[_vm._v(_vm._s(labour.availability?"Active":"Inactive"))])])})),0):_c("tbody",[_c("tr",[_c("td",{attrs:{colspan:"100%"}},[_c("div",{staticClass:"flex-middle justify-content-center flex-direction-column"},[_c("inline-svg",{attrs:{src:"svgs/emptystate/inventory",iconClass:"icon text-center icon-100"}}),_c("div",{staticClass:"nowo-label f14 bold"},[_vm._v(" "+_vm._s(_vm.$t("common._common.no_labours_present"))+" ")])],1)])])])])]),_c("div",{staticClass:"modal-dialog-footer-parts-dialog"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){return _vm.cancelLabourDialog()}}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",staticStyle:{"margin-left":"0px !important"},attrs:{type:"primary",disabled:_vm.iTloading},on:{click:function($event){return _vm.addLabourSave()}}},[_vm._v(_vm._s(_vm.$t("common._common._add")))])],1)]),_c("el-dialog",{attrs:{visible:_vm.serviceAddDialogVisibility,fullscreen:!1,open:"top","custom-class":"fc-dialog-up Inventoryaddvaluedialog","append-to-body":!0},on:{"update:visible":function($event){_vm.serviceAddDialogVisibility=$event}}},[_c("div",{staticClass:"new-header-container"},[_c("div",{staticClass:"fc-setup-modal-title"},[_vm._v(" "+_vm._s(_vm.$t("common.products.services_list"))+" ")])]),_c("div",{staticClass:"fc-inv-container-body"},[_vm.loading.serviceList?_c("spinner",{staticClass:"flex-middle justify-content-center flex-direction-column",attrs:{show:_vm.loading.serviceList,size:"80"}}):_c("table",{staticClass:"setting-list-view-table width100 invent-table-dialog"},[_c("thead",[_c("th",{staticClass:"setting-table-th setting-th-text"}),_c("th",{staticClass:"setting-table-th setting-th-text"},[_vm._v(" "+_vm._s(_vm.$t("common.products.name"))+" ")]),_c("th",{staticClass:"setting-table-th setting-th-text"},[_vm._v(" "+_vm._s("Buying Price ("+_vm.$currency+")")+" ")])]),_vm.allServiceList.length?_c("tbody",_vm._l(_vm.allServiceList,(function(service){return _c("tr",{key:service.id,staticClass:"tablerow asset-hover-td"},[_c("td",{staticStyle:{width:"10%"}},[_c("el-checkbox",{model:{value:service.checked,callback:function($$v){_vm.$set(service,"checked",$$v)},expression:"service.checked"}})],1),_c("td",[_vm._v(_vm._s(service.name))]),_c("td",[_vm._v(_vm._s(service.buyingPrice||"---"))])])})),0):_c("tbody",[_c("tr",[_c("td",{attrs:{colspan:"100%"}},[_c("div",{staticClass:"flex-middle justify-content-center flex-direction-column"},[_c("inline-svg",{attrs:{src:"svgs/emptystate/inventory",iconClass:"icon text-center icon-100"}}),_c("div",{staticClass:"nowo-label f14 bold"},[_vm._v(" "+_vm._s(_vm.$t("common.products.no_services_present"))+" ")])],1)])])])])],1),_c("div",{staticClass:"modal-dialog-footer-parts-dialog"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){return _vm.closeServiceDialog()}}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",staticStyle:{"margin-left":"0px !important"},attrs:{type:"primary",loading:_vm.loading.woServiceSave},on:{click:function($event){return _vm.addWoService()}}},[_vm._v(_vm._s(_vm.$t("common._common._add")))])],1)]),_c("el-dialog",{attrs:{visible:_vm.newToolPartToggle,fullscreen:!1,open:"top","custom-class":"fc-dialog-up Inventoryaddvaluedialog","append-to-body":!0},on:{"update:visible":function($event){_vm.newToolPartToggle=$event}}},[_vm.individualToolTracking?_c("div",[_c("div",{staticClass:"new-header-container popup-container-new"},[_c("div",{staticClass:"fc-setup-modal-title"},[_c("i",{staticClass:"el-icon-back inv-id-bac-icon pointer",on:{click:function($event){_vm.individualToolList=[],_vm.selectedTool=null}}}),_vm._v(" "+_vm._s(_vm.selectedTool.toolType.name)+" ")]),_c("div",{staticClass:"search-bar",class:{active:_vm.hidequrry}},[_vm.hidequrry?_c("i",{staticClass:"el-input__icon el-icon-search",staticStyle:{"line-height":"0px !important","font-size":"16px !important"},attrs:{slot:"suffix"},on:{click:function($event){_vm.hidequrry=!1}},slot:"suffix"}):_c("el-input",{staticClass:"el-input-textbox-full-border",attrs:{autofocus:!0,type:"text",placeholder:_vm.$t("common._common.to_search_type")},on:{blur:function($event){_vm.hidequrry=!0}},model:{value:_vm.itemSerachQuerry,callback:function($$v){_vm.itemSerachQuerry=$$v},expression:"itemSerachQuerry"}},[_c("i",{staticClass:"el-input__icon el-icon-search",staticStyle:{"line-height":"0px !important","font-size":"16px !important"},attrs:{slot:"suffix"},slot:"suffix"})])],1)]),_c("div",{staticClass:"fc-inv-container-body"},[_c("table",{staticClass:"invent-table-dialog setting-list-view-table width100"},[_c("thead",[_c("th",{staticClass:"setting-table-th setting-th-text"},[_vm._v(" "+_vm._s(_vm.$t("common.header.s_no"))+" ")]),_c("th",{staticClass:"setting-table-th setting-th-text"})]),_vm.iTloading?_c("tbody",[_c("tr",[_c("td",{attrs:{colspan:"100%"}},[_c("div",{staticClass:"iTloading"},[_c("spinner",{attrs:{show:!0,size:"80"}})],1)])])]):_vm.individualToolListwrapper.length?_c("tbody",_vm._l(_vm.individualToolListwrapper,(function(stool){return _c("tr",{key:stool.id,staticClass:"tablerow asset-hover-td"},[_c("td",[_c("div",[_vm._v(_vm._s(stool.serialNumber))]),_c("div")]),_c("td",{staticClass:"text-right"},[_vm.selectedTool.invidualList.findIndex((function(rt){return rt.id===stool.id}))>-1?[_c("el-button",{staticClass:"f-number-input f-number-input-no-border",attrs:{size:"mini"},on:{click:function($event){_vm.selectedTool.invidualList.splice(_vm.selectedTool.invidualList.findIndex((function(rt){return rt.id===stool.id})),1)}}},[_vm._v(_vm._s(_vm.$t("common.products.added")))])]:stool.checked?[_c("el-button",{staticClass:"f-number-input f-number-input-no-border",attrs:{size:"mini"},on:{click:function($event){stool.checked=!1}}},[_vm._v(_vm._s(_vm.$t("common.products.added")))])]:[_c("el-button",{staticClass:"f-number-input",attrs:{size:"mini"},on:{click:function($event){stool.checked=!0}}},[_vm._v(_vm._s(_vm.$t("common._common._add")))])]],2)])})),0):_c("tbody",[_c("tr",[_c("td",{attrs:{colspan:"100%"}},[_c("div",{staticClass:"flex-middle justify-content-center flex-direction-column"},[_c("inline-svg",{attrs:{src:"svgs/emptystate/inventory",iconClass:"icon text-center icon-100"}}),_c("div",{staticClass:"nowo-label f14 bold"},[_vm._v(" "+_vm._s(_vm.$t("common.products.no_tools_present"))+" ")])],1)])])])])]),_c("div",{staticClass:"modal-dialog-footer-parts-dialog"},[_c("div",{staticClass:"modal-dialog-footer-parts-dialog"},[_c("el-button",{staticClass:"modal-btn-save width100",staticStyle:{"margin-left":"0px !important"},attrs:{type:"primary",disabled:_vm.iTloading},on:{click:_vm.addindIvidualTrackingTool}},[_vm._v(_vm._s(_vm.$t("common._common._done")))])],1)])]):_c("div",[_c("div",{staticClass:"new-header-container popup-container-new"},[_c("div",{staticClass:"fc-setup-modal-title"},[_vm._v(" "+_vm._s(_vm.$t("common.products.tools_list"))+" ")]),_c("div",{staticClass:"store-room-bar",class:{active:!_vm.hidequrry}},[_c("el-select",{staticClass:"fc-tag fc-input-full-border2",staticStyle:{"margin-left":"20px"},attrs:{multiple:"","collapse-tags":"",placeholder:_vm.$t("common.products.select_storeroom")},model:{value:_vm.selectedToolStoreList,callback:function($$v){_vm.selectedToolStoreList=$$v},expression:"selectedToolStoreList"}},_vm._l(_vm.temptoolStoreList,(function(item,index){return _c("el-option",{key:index,attrs:{label:item.name,value:item.id}})})),1)],1),_c("div",{staticClass:"search-bar",class:{active:_vm.hidequrry}},[_vm.hidequrry?_c("i",{staticClass:"el-input__icon el-icon-search",staticStyle:{"line-height":"0px !important","font-size":"16px !important"},attrs:{slot:"suffix"},on:{click:function($event){_vm.hidequrry=!1}},slot:"suffix"}):_c("el-input",{staticClass:"el-input-textbox-full-border",attrs:{autofocus:!0,type:"text",placeholder:_vm.$t("common._common.to_search_type")},on:{blur:function($event){_vm.hidequrry=!0}},model:{value:_vm.itemSerachQuerry,callback:function($$v){_vm.itemSerachQuerry=$$v},expression:"itemSerachQuerry"}},[_c("i",{staticClass:"el-input__icon el-icon-search pointer",staticStyle:{"line-height":"0px !important","font-size":"16px !important"},attrs:{slot:"suffix"},slot:"suffix"})])],1)]),_c("div",{staticClass:"fc-inv-container-body"},[_vm.allToolListLoading?_c("table",{staticClass:"width100"},[_c("tr",[_c("td",{attrs:{colspan:"100%"}},[_c("div",{staticClass:"iTloading in-no-data"},[_c("spinner",{attrs:{show:!0,size:"80"}})],1)])])]):_c("table",{staticClass:"setting-list-view-table width100 invent-table-dialog"},[_vm.toolsList.length?_c("tbody",_vm._l(_vm.toolsList,(function(stool,index){return _c("tr",{key:stool.id,staticClass:"tablerow asset-hover-td height100px"},[_c("td",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"top-start",animation:"shift-away"},expression:"{ placement: 'top-start', animation: 'shift-away' }"}],staticClass:"width80",attrs:{title:stool.toolType.name+" - "+stool.storeRoom.name}},[_vm._v(" "+_vm._s(stool.toolType.name)+" ")]),_c("td",{staticClass:"text-align-inventory"},[stool.toolType.isRotating?[stool.invidualList&&stool.invidualList.length>0?_c("el-button",{staticClass:"f-number-input f-number-input-no-border",attrs:{size:"mini"},on:{click:function($event){_vm.selectTool(stool,index),stool.checked=!0}}},[_vm._v(_vm._s(stool.invidualList.length)+" "+_vm._s(_vm.$t("common.products.qty_added")))]):_c("el-button",{staticClass:"f-number-input",attrs:{size:"mini"},on:{click:function($event){_vm.selectTool(stool,index),stool.checked=!0,_vm.itemSerachQuerry=null}}},[_vm._v(_vm._s(_vm.$t("common._common._add")))])]:0===stool.addedQuantity?[_c("el-button",{staticClass:"f-number-input",attrs:{size:"mini"},on:{click:function($event){stool.addedQuantity=1,stool.checked=!0}}},[_vm._v(_vm._s(_vm.$t("common._common._add")))])]:[_c("el-input-number",{staticClass:"f-number-input",attrs:{size:"mini",min:0,max:stool.quantity},on:{change:function($event){return _vm.handeler1(stool,index)}},model:{value:stool.addedQuantity,callback:function($$v){_vm.$set(stool,"addedQuantity",$$v)},expression:"stool.addedQuantity"}})],_c("div",{staticClass:"secondary-quantity-text pT10"},[_vm._v(" "+_vm._s(_vm.$t("common.products.available"))+": "+_vm._s(stool.quantity)+" ")])],2)])})),0):_c("tbody",[_c("tr",[_c("td",{attrs:{colspan:"100%"}},[_c("div",{staticClass:"flex-middle justify-content-center flex-direction-column"},[_c("inline-svg",{attrs:{src:"svgs/emptystate/inventory",iconClass:"icon text-center icon-100"}}),_c("div",{staticClass:"nowo-label f14 bold"},[_vm._v(" "+_vm._s(_vm.$t("common.products.no_tools_present"))+" ")])],1)])])])])]),_c("div",{staticClass:"modal-dialog-footer-parts-dialog"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){return _vm.cancelToolPartsDialog()}}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",staticStyle:{"margin-left":"0px !important"},attrs:{type:"primary"},on:{click:function($event){return _vm.addNewbulkTool()}}},[_vm._v(_vm._s(_vm.$t("common._common._add")))])],1)])]),_vm.inventoryRequestDialogVisibility?_c("WOInvReqForm",{attrs:{dataModuleId:_vm.inventoryRequestList&&_vm.inventoryRequestList.length>0?_vm.inventoryRequestList[0].id:null,woDetails:{id:_vm.workorder.id,name:_vm.workorder.subject,localId:_vm.workorder.localId}},on:{onSave:function($event){return _vm.loadInventoryRequest()},onClose:function($event){_vm.inventoryRequestDialogVisibility=!1}}}):_vm._e(),_vm.issueItemIRDialogVisibility?_c("div",[_c("inventory-issue-use",{attrs:{visibility:_vm.issueItemIRDialogVisibility,newIRIssueItem:_vm.issueItemIRDialogVisibility,workorder:_vm.workorder,woItemsList:_vm.workorderItemsList},on:{"update:visibility":function($event){_vm.issueItemIRDialogVisibility=$event},refreshItemList:_vm.loadWoItemParts}})],1):_vm._e(),_vm.issueToolIRDialogVisibility?_c("div",[_c("inventory-issue-use",{attrs:{visibility:_vm.issueToolIRDialogVisibility,newIRIssueTool:_vm.issueToolIRDialogVisibility,workorder:_vm.workorder,woToolsList:_vm.workorderToolsList},on:{"update:visibility":function($event){_vm.issueToolIRDialogVisibility=$event},refreshToolList:_vm.loadWorkOrderToolParts}})],1):_vm._e()],1)},staticRenderFns=[function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("td",{staticClass:"pT10 pB10"},[_c("div",{staticClass:"fc-black-13 text-right"},[_vm._v("-- -- --")])])},function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("td",{staticClass:"pT10 pB10 pL20"},[_c("div",{staticClass:"fc-black-13 text-right"},[_vm._v("-- -- --")])])},function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("td",{staticClass:"pT10 pB10"},[_c("div",{staticClass:"fc-black-13 text-right"},[_vm._v("-- -- --")])])},function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("td",{staticClass:"pT10 pB10 pL20"},[_c("div",{staticClass:"fc-black-13 text-right"},[_vm._v("-- -- --")])])},function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("td",{staticClass:"pT10 pB10"},[_c("div",{staticClass:"fc-black-13 text-right"},[_vm._v("-- -- --")])])},function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("td",{staticClass:"pT10 pB10 pL20"},[_c("div",{staticClass:"fc-black-13 text-right"},[_vm._v("-- -- --")])])}],objectSpread2=__webpack_require__(595082),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),createForOfIteratorHelper=__webpack_require__(566347),moment_timezone=(__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(339772),__webpack_require__(434284),__webpack_require__(648324),__webpack_require__(425728),__webpack_require__(670560),__webpack_require__(879288),__webpack_require__(947522),__webpack_require__(162506),__webpack_require__(450886),__webpack_require__(897389),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(480008)),moment_timezone_default=__webpack_require__.n(moment_timezone),vue_runtime_esm=__webpack_require__(720144),workorderHelper=__webpack_require__(865764),WOInvReqForm=__webpack_require__(720985),InventoryIssueUse=__webpack_require__(418672),InlineSvg=__webpack_require__(586166),eventBus=__webpack_require__(398011),api=__webpack_require__(32284),validation=__webpack_require__(990260),InventoryUtil=__webpack_require__(976195),relatedFieldUtil=__webpack_require__(850558),inventoryvue_type_script_lang_js={props:["workorder","openWorkorderId","showLabour","canDisable"],mixins:[workorderHelper/* default */.Z],data:function(){return{newItemPartToggle:!1,selectedInventory:null,hidequrry:!0,additionalCost:{name:null,cost:null},loading:{deleteAdditionalCost:!1,serviceList:!1,woService:!1,woServiceSave:!1},toolLoading:!1,addissueditem:!1,selectedInventoryList:[],inventoryRequestForWOLoading:!1,iTloading:!1,itemnsloading:!1,toolsloading:!1,labourLoading:!1,selectedTool:null,workorderItemsList:[],workLabourTotalCost:null,workorderToolsList:[],workorderLabourList:[],workorderServiceList:[],newToolPartToggle:!1,workOrderCostList:[],individualItemList:[],individualToolList:[],labourList:[],newLabourToggle:!1,inventory:[],stockedTools:[],selectedLabour:[],tempStoreList:[],temptoolStoreList:[],itemSerachQuerry:null,selectedStoreList:[],selectedToolStoreList:[],inventoryRequestDialogVisibility:!1,issueToolIRDialogVisibility:!1,issueItemIRDialogVisibility:!1,issueInventoryIRDialogVisibility:!1,inventoryRequestList:null,allToolListLoading:!1,inventoryListLoading:!1,serviceAddDialogVisibility:!1,allServiceList:[],items:[]}},created:function(){this.$store.dispatch("loadTicketStatus","workorder"),this.init()},mounted:function(){var _this=this;eventBus/* eventBus */.Y.$on("refresh-inventory-summary",(function(){_this.reload()}))},components:{WOInvReqForm:WOInvReqForm/* default */.Z,InventoryIssueUse:InventoryIssueUse/* default */.Z,InlineSvg:InlineSvg/* default */.Z},computed:{inventoryList:function(){var list=[];list=this.inventory.filter((function(item){return!(item.itemType.approvalNeeded||item.storeRoom.approvalNeeded)}));var self=this;if(this.selectedStoreList.length&&(list=list.filter((function(rt){if(self.selectedStoreList.findIndex((function(rl){return rl===rt.storeRoom.id}))>-1)return rt}))),this.itemSerachQuerry){var _self=this;return list.filter((function(data){if(data.itemType.name.toLowerCase().indexOf(_self.itemSerachQuerry.toLowerCase())>-1||data.storeRoom.name.toLowerCase().indexOf(_self.itemSerachQuerry.toLowerCase())>-1||0===JSON.stringify(data.quantity).toLowerCase().indexOf(_self.itemSerachQuerry.toLowerCase()))return data}))}return list},toolsList:function(){var list=[];list=this.stockedTools.filter((function(item){return!(item.toolType.approvalNeeded||item.storeRoom.approvalNeeded)}));var self=this;if(this.selectedToolStoreList.length&&(list=list.filter((function(rt){if(self.selectedToolStoreList.findIndex((function(rl){return rl===rt.storeRoom.id}))>-1)return rt}))),this.itemSerachQuerry){var _self2=this;return list.filter((function(data){if(data.toolType.name.toLowerCase().indexOf(_self2.itemSerachQuerry.toLowerCase())>-1||data.storeRoom.name.toLowerCase().indexOf(_self2.itemSerachQuerry.toLowerCase())>-1||0===JSON.stringify(data.quantity).toLowerCase().indexOf(_self2.itemSerachQuerry.toLowerCase()))return data}))}return list},individualItemListwrapper:function(){var list=this.individualItemList;if(this.itemSerachQuerry){var self=this;return list.filter((function(data){if(data.serialNumber.toLowerCase().indexOf(self.itemSerachQuerry.toLowerCase())>-1)return data}))}return list},individualToolListwrapper:function(){var list=this.individualToolList;if(this.itemSerachQuerry){var self=this;return list.filter((function(data){if(data.serialNumber.toLowerCase().indexOf(self.itemSerachQuerry.toLowerCase())>-1)return data}))}return list},workToolTotalCost:function(){return this.workOrderCostList.length&&this.workOrderCostList.find((function(rt){return"tools"===rt.costTypeEnum}))?this.workOrderCostList.find((function(rt){return"tools"===rt.costTypeEnum})).cost:0},actionRule:function(){return!!this.canEdit},workItemTotalCost:function(){return this.workOrderCostList.length&&this.workOrderCostList.find((function(rt){return"items"===rt.costTypeEnum}))?this.workOrderCostList.find((function(rt){return"items"===rt.costTypeEnum})).cost:0},workOrderTotalCost:function(){if(this.workOrderCostList&&this.workOrderCostList.length){for(var cost=0,i=0;i<this.workOrderCostList.length;i++)cost+=this.workOrderCostList[i].cost;return cost}return 0},workServiceCost:function(){return((this.workOrderCostList||[]).find((function(rt){return"service"===rt.costTypeEnum}))||{}).cost||0},individualTracking:function(){return!!(this.inventory&&this.inventory.length&&this.selectedInventory)},individualToolTracking:function(){return!!(this.stockedTools&&this.stockedTools.length&&this.selectedTool)},canEdit:function(){return this.isStateFlowEnabled?!this.$store.getters.isStatusLocked(this.workorder.moduleState.id,"workorder"):this.workorder&&2!==this.workorder.approvalState},isStateFlowEnabled:function(){return Boolean(this.workorder.moduleState&&this.workorder.moduleState.id)}},methods:{init:function(){this.loadWoItemParts(!0),this.loadWorkOrderToolParts(!0),this.getWorkOrderCostList(!0),this.loadWorkOrderLabour(!0),this.loadWorkOrderService(!0),this.loadItem(!0),this.loadInventoryRequest()},reload:function(){this.loadWoItemParts(!0),this.loadInventoryRequest()},loadInventory:function(){var _this2=this,self=this;this.itemSerachQuerry=null,this.inventoryListLoading=!0,this.$http.get("v2/item/view/all?showForWorkorder=true&includeServingSite=true&siteId="+this.workorder.siteId).then((function(response){_this2.inventoryListLoading=!1;var inventory=[];if(inventory=response.data.result&&response.data.result.items?response.data.result.items:[],response){var _step,_iterator=(0,createForOfIteratorHelper/* default */.Z)(inventory);try{var _loop=function(){var item=_step.value;item.checked=!1,item.addedQuantity=0,item.invidualList=[],item.storeRoom&&self.tempStoreList.findIndex((function(rt){return rt.id===item.storeRoom.id}))<0&&self.tempStoreList.push(item.storeRoom)};for(_iterator.s();!(_step=_iterator.n()).done;)_loop()}catch(err){_iterator.e(err)}finally{_iterator.f()}var self2=self;self.inventory=inventory.filter((function(rt){if(self2.itemshowRule(rt))return rt}))}}))},loadToolslist:function(){var _this3=this,self=this;this.itemSerachQuerry=null,this.allToolListLoading=!0,this.$http.get("v2/tool/view/all").then((function(response){var stockedTools=[];if(stockedTools=response.data.result&&response.data.result.tool?response.data.result.tool:[],_this3.allToolListLoading=!1,response){var _step2,_iterator2=(0,createForOfIteratorHelper/* default */.Z)(stockedTools);try{var _loop2=function(){var item=_step2.value;item.checked=!1,item.addedQuantity=0,item.invidualList=[],item.storeRoom&&self.temptoolStoreList.findIndex((function(rt){return rt.id===item.storeRoom.id}))<0&&self.temptoolStoreList.push(item.storeRoom)};for(_iterator2.s();!(_step2=_iterator2.n()).done;)_loop2()}catch(err){_iterator2.e(err)}finally{_iterator2.f()}var self2=self;self.stockedTools=stockedTools.filter((function(rt){if(self2.toolshowRule(rt))return rt}))}}))},getItemCount:function(workItem){var diff;return workItem?(diff=workItem.requestedLineItem?Number(workItem.tempQuantity)+Number(workItem.requestedLineItem.issuedQuantity)-Number(workItem.requestedLineItem.usedQuantity)-Number(workItem.quantity):-1!==workItem.parentTransactionId?Number(workItem.tempQuantity)+Number(workItem.remainingQuantity)-Number(workItem.quantity):Number(workItem.tempQuantity)+Number(workItem.tempItem.quantity)-Number(workItem.quantity),Number(workItem.quantity)<0?"Quantity must be nonzero":diff<0?"Exceeded":diff):""},getItemQuantityState:function(workItem){var diff;return!!workItem&&(diff=workItem.requestedLineItem?Number(workItem.tempQuantity)+Number(workItem.requestedLineItem.issuedQuantity)-Number(workItem.requestedLineItem.usedQuantity)-Number(workItem.quantity):-1!==workItem.parentTransactionId?Number(workItem.tempQuantity)+Number(workItem.remainingQuantity)-Number(workItem.quantity):Number(workItem.tempQuantity)+Number(workItem.tempItem.quantity)-Number(workItem.quantity),Number(workItem.quantity)<0||diff<0)},getToolCount:function(worktool){var diff;return worktool?(diff=worktool.requestedLineItem?Number(worktool.requestedLineItem.issuedQuantity)-Number(worktool.quantity):-1!==worktool.parentTransactionId?Number(worktool.tempQuantity)+Number(worktool.remainingQuantity)-Number(worktool.quantity):Number(worktool.tempQuantity)+Number(worktool.tempTool.currentQuantity)-Number(worktool.quantity),Number(worktool.quantity)<0?"Quantity must be nonzero":diff<0?"Exceeded":diff):""},getToolQuantityState:function(worktool){var diff;return!!worktool&&(diff=worktool.requestedLineItem?Number(worktool.requestedLineItem.issuedQuantity)-Number(worktool.quantity):-1!==worktool.parentTransactionId?Number(worktool.tempQuantity)+Number(worktool.remainingQuantity)-Number(worktool.quantity):Number(worktool.tempQuantity)+Number(worktool.tempTool.currentQuantity)-Number(worktool.quantity),Number(worktool.quantity)<0||diff<0)},addNewWOLabour:function(){this.loadLabour(!0),this.newLabourToggle=!0},addNewWOItem:function(){var self=this;this.individualItemList=[],this.inventory=this.inventory.filter((function(rt){if(self.itemshowRule(rt))return rt.checked=!1,rt})),this.newItemPartToggle=!0},addNewWOTool:function(){var self=this;this.individualToolList=[],this.stockedTools=this.stockedTools.filter((function(rt){if(self.toolshowRule(rt))return rt.checked=!1,rt})),this.newToolPartToggle=!0},ticketstatusvalue:function(id){if(null!==id){var statusObj=this.$store.getters.getTicketStatus(id,"workorder");if(!statusObj)return"";var status=statusObj.status;return status||""}return""},itemshowRule:function(invt){if(invt.itemType.isRotating)return invt.quantity>0&&invt.itemType.currentQuantity>0;var tempWorkItem=this.workorderItemsList.filter((function(i){return i.item.id===invt.id})),check=!0;return tempWorkItem.forEach((function(i){-1===i.parentTransactionId&&(check=!1)})),check},toolshowRule:function(invt){if(invt.toolType.isRotating)return invt.toolType.currentQuantity>0;var tempWorkItem=this.workorderToolsList.filter((function(i){return i.tool.id===invt.id})),check=!0;return tempWorkItem.forEach((function(i){-1===i.parentTransactionId&&(check=!1)})),check},addAdditionalCost:function(){var _this4=this,self=this;if(this.additionalCost.name&&null!==this.additionalCost.cost){var param={workorderCost:{name:this.additionalCost.name,parentId:{id:this.openWorkorderId},cost:Number(this.additionalCost.cost),costType:5}};this.$http.post("v2/workorderCosts/add",param).then((function(response){0===response.data.responseCode?(self.$message.success(_this4.$t("common._common.cost_added_successfully")),self.actionToWorkorderStatusChange(),self.additionalCost={name:null,cost:null},self.getWorkOrderCostList()):self.$message.error(response.data.message)}))}},updateAdditionalCost:function(data){var _this5=this;if(data){var self=this,param={id:data.id,name:data.name,parentId:{id:this.openWorkorderId},costType:5,cost:Number(data.cost)};this.$http.post("v2/workorderCosts/update",param).then((function(response){self.actionToWorkorderStatusChange(),0===response.data.responseCode?(self.$message.success(_this5.$t("common._common.cost_edited_successfully")),self.getWorkOrderCostList()):self.$message.error(response.data.message)}))}},deleteAdditionalCost:function(id){if(id){var self=this,param={workordercostId:[id],parentId:this.openWorkorderId};this.$http.post("v2/workorderCosts/delete",param).then((function(response){self.actionToWorkorderStatusChange(),0===response.data.responseCode?(self.getWorkOrderCostList(),self.$message.success("Cost Deleted")):self.$message.error(response.data.message)}))}},deleteWorkorderLabour:function(workLabour){var _this6=this,self=this,param={parentId:this.openWorkorderId,workorderLabourIds:[]};param.workorderLabourIds.push(workLabour.id),this.$http.post("v2/workorderLabour/delete",param).then((function(response){0===response.data.responseCode?(self.$message.success(_this6.$t("common.products.labour_deleted_successfully")),self.actionToWorkorderStatusChange(),self.loadWorkOrderLabour(),self.getWorkOrderCostList()):self.$message.error(response.data.message)})).catch((function(error){}))},deleteWorkorderTool:function(workTool,index){if(workTool.tool.hasOwnProperty("storeRoom")){var self=this,param={parentId:this.openWorkorderId,workorderToolsIds:[]};param.workorderToolsIds.push(workTool.id),this.$http.post("v2/workorderTools/delete",param).then((function(response){0===response.data.responseCode?(self.actionToWorkorderStatusChange(),self.loadToolslist(),self.loadWorkOrderToolParts(),self.getWorkOrderCostList(),self.$message.success("Tool Deleted"),self.workorderToolsList.splice(index,1)):self.$message.error(response.data.message)})).catch()}else this.workorderToolsList.pop()},deleteWorkorderItem:function(workItem,index){var self=this;if(workItem.hasOwnProperty("purchasedItem")){var param={parentId:this.openWorkorderId,workorderItemsId:[]};param.workorderItemsId.push(workItem.id),this.$http.post("v2/workorderItems/delete",param).then((function(response){0===response.data.responseCode?(self.actionToWorkorderStatusChange(),self.loadInventory(),self.$message.success("Item Deleted"),self.getWorkOrderCostList(),self.workorderItemsList.splice(index,1)):self.$message.error(response.data.message)})).catch((function(error){}))}else this.workorderItemsList.pop()},cancelLabourDialog:function(){this.newLabourToggle=!1},cancelToolPartsDialog:function(){this.newToolPartToggle=!1,this.selectedTool=null,this.selectedTool=null},getWorkOrderCostList:function(loading){var self=this;this.$http.get("v2/workorderCostsList/parent/"+this.openWorkorderId).then((function(response){loading||(self.itemnsloading=!1),self.workOrderCostList=response.data.result.workorderCost}))},getCurrentTime:function(){return moment_timezone_default()().tz(vue_runtime_esm["default"].prototype.$timezone).valueOf()},addLabourSave:function(){var _this7=this,self=this,param={workorderLabourList:[]};if(this.labourList.length){for(var i=0;i<this.labourList.length;i++){var labour=this.labourList[i];if(labour.checked){var temp={parentId:this.openWorkorderId,startTime:-1,endTime:-1,labour:labour};param.workorderLabourList.push(temp),this.labourList[i]=!1}}this.labourLoading=!0,this.$http.post("/v2/workorderLabour/addOrUpdate",param).then((function(response){self.labourLoading=!0,0!==response.data.responseCode?_this7.$message.error(response.data.message):(self.$message.success(_this7.$t("common._common.added_available_labour_successfully")),self.actionToWorkorderStatusChange(),self.loadWorkOrderLabour(),self.getWorkOrderCostList())})).catch((function(error){_this7.$message.error(_this7.$t("common.wo_report.unable_to_add_labour")),self.labourLoading=!1})),this.newLabourToggle=!1}},addToolPartSave:function(){var _this8=this,self=this,param={workorderToolsList:[]},purchasedTools=[];this.individualToolList.length&&(purchasedTools=this.individualToolList.map((function(rt){if(rt.checked)return rt.id})),purchasedTools=purchasedTools.filter((function(rt){return"undefined"!==typeof rt})));var temp={parentId:this.openWorkorderId,tool:{id:this.selectedTool},quantity:1,assetIds:purchasedTools};param.workorderToolsList.push(temp),this.toolsloading=!0,this.$http.post("/v2/workorderTools/addOrUpdate",param).then((function(response){0!==response.data.responseCode?_this8.$message.error(response.data.message):(self.$message.success(_this8.$t("common._common.added_successfully")),self.selectedTool=null,self.actionToWorkorderStatusChange(),self.loadWorkOrderToolParts(!1,!0),self.getWorkOrderCostList())})).catch((function(error){_this8.$message.error(_this8.$t("common.wo_report.unable_to_update"))})),this.newToolPartToggle=!1},bulkaddItem:function(){var selectedItems=this.inventory.filter((function(rt){return rt.checked})),bulkItem=selectedItems.filter((function(rt){if(rt&&rt.itemType&&!rt.itemType.isRotating)return rt}));bulkItem.length&&(this.addbulkItem(bulkItem),this.individualItemList.length||(this.newItemPartToggle=!1)),this.individualTracking&&this.individualItemList.length&&(this.addbulkItem(!1,this.individualItemList),this.newItemPartToggle=!1)},bulkaddTool:function(){var selectedItems=this.stockedTools.filter((function(rt){return rt.checked})),bulkItem=selectedItems.filter((function(rt){if(rt&&rt.toolType&&!rt.toolType.isRotating)return rt}));bulkItem.length&&(this.addbulkTool(bulkItem),this.individualToolList.length||(this.newToolPartToggle=!1)),this.individualToolTracking&&this.individualToolList.length&&(this.addbulkTool(!1,this.individualToolList),this.newToolPartToggle=!1)},addbulkTool:function(tools,individualToolList){var _this9=this,self=this,param={workorderToolsList:[]},obj={},assetIds=[],data=[];if(individualToolList&&individualToolList.length)for(var i=0;i<individualToolList.length;i++)data=individualToolList[i],data.checked&&(assetIds=[data.id],obj={parentId:this.openWorkorderId,tool:{id:data.tool.id},quantity:1,assetIds:assetIds},param.workorderToolsList.push(obj));else if(tools){data=[];for(var _i=0;_i<tools.length;_i++){var _data=tools[_i];obj={parentId:this.openWorkorderId,tool:{id:_data.id},quantity:1,assetIds:assetIds},param.workorderToolsList.push(obj)}}this.toolsloading=!0,this.$http.post("/v2/workorderTools/addOrUpdate",param).then((function(response){0!==response.data.responseCode?_this9.$message.error(response.data.message):(self.$message.success(_this9.$t("common._common.added_successfully")),self.selectedTool=null,self.actionToWorkorderStatusChange(),self.loadWorkOrderToolParts(!1,!0),self.getWorkOrderCostList())})).catch((function(){_this9.$message.error(_this9.$t("common.wo_report.unable_to_update"))}))},addbulkItem:function(items,individualItemList){var _this10=this,param={workorderItems:[]},obj={},assetIds=[],data=[];if(individualItemList&&individualItemList.length)for(var i=0;i<individualItemList.length;i++)data=individualItemList[i],data.checked&&(assetIds=[data.id],obj={parentId:this.openWorkorderId,item:{id:data.item.id},quantity:1,assetIds:assetIds,remainingQuantity:0},param.workorderItems.push(obj));else if(items){data=[];for(var _i2=0;_i2<items.length;_i2++){var _data2=items[_i2];obj={parentId:this.openWorkorderId,item:{id:_data2.id},quantity:1,assetIds:assetIds,remainingQuantity:0},param.workorderItems.push(obj)}}var self=this;this.$http.post("/v2/workorderItems/addOrUpdate",param).then((function(response){0!==response.data.responseCode?self.$message.error(response.data.message):(self.$message.success(_this10.$t("common.header.item_added_successfully")),self.actionToWorkorderStatusChange(),self.loadWoItemParts(!1,!0))})).catch((function(){}))},addNewbulkItem:function(){var _this11=this,param={workorderItems:[]},obj={},assetIds=[];this.inventoryList.forEach((function(item){obj={},assetIds=[],item.itemType.isRotating?item.invidualList.length&&(assetIds=item.invidualList.map((function(rl){return rl.id})),obj={parentId:_this11.openWorkorderId,item:{id:item.id},quantity:item.invidualList.length,assetIds:assetIds},param.workorderItems.push(obj)):item.addedQuantity>0&&(obj={parentId:_this11.openWorkorderId,item:{id:item.id},quantity:item.addedQuantity,assetIds:assetIds},param.workorderItems.push(obj))})),this.selectedInventory=null,this.individualItemList=[],this.individualToolList=[],this.newItemPartToggle=!1;var self=this;this.$http.post("/v2/workorderItems/addOrUpdate",param).then((function(response){0!==response.data.responseCode?self.$message.error(response.data.message):(self.$message.success(_this11.$t("common.header.item_added_successfully")),self.actionToWorkorderStatusChange(),self.loadWoItemParts(!1,!0))})).catch((function(error){}))},addNewbulkTool:function(){var _this12=this,self=this,param={workorderToolsList:[]},obj={},assetIds=[];this.toolsList.forEach((function(item){obj={},assetIds=[],item.toolType.isRotating?item.invidualList.length&&(assetIds=item.invidualList.map((function(rl){return rl.id})),obj={parentId:_this12.openWorkorderId,tool:{id:item.id},quantity:item.invidualList.length,assetIds:assetIds},param.workorderToolsList.push(obj)):item.addedQuantity>0&&(obj={parentId:_this12.openWorkorderId,tool:{id:item.id},quantity:item.addedQuantity,assetIds:assetIds},param.workorderToolsList.push(obj))})),this.selectedTool=null,this.individualItemList=[],this.individualToolList=[],this.newToolPartToggle=!1,this.$http.post("/v2/workorderTools/addOrUpdate",param).then((function(response){0!==response.data.responseCode?self.$message.error(response.data.message):(self.$message.success(_this12.$t("common.products.tools_added_successfully")),self.selectedTool=null,self.actionToWorkorderStatusChange(),self.loadWorkOrderToolParts(!1,!0),self.getWorkOrderCostList())})).catch((function(){}))},actionToWorkorderStatusChange:function(){this.fetchWo()},cancelItemPartsDialog:function(){this.newItemPartToggle=!1,this.selectedInventory=null,this.selectedTool=null},loadItem:function(){var _this13=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.next=2,(0,InventoryUtil/* getFilteredItemListWithParentModule */.fL)("workorder");case 2:_this13.items=_context.sent;case 3:case"end":return _context.stop()}}),_callee)})))()},loadStockedTools:function(){var _this14=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,(0,InventoryUtil/* getFilteredToolListWithParentModule */.EJ)("workorder");case 2:_this14.tools=_context2.sent;case 3:case"end":return _context2.stop()}}),_callee2)})))()},changeWorkLabourField:function(workLabour,index,changedfield){var _this15=this,self=this,duration=Number(workLabour.duration).toFixed(2),param={workorderLabourList:[]};-1===workLabour.startTime&&(workLabour.startTime=null),-1===workLabour.endTime&&(workLabour.endTime=null);var startTime=null!==workLabour.startTime?moment_timezone_default()(workLabour.startTime).tz(this.$timezone).valueOf():workLabour.startTime,endTime=null!==workLabour.endTime?moment_timezone_default()(workLabour.endTime).tz(this.$timezone).valueOf():workLabour.endTime,temp={id:workLabour.id,parentId:this.openWorkorderId,duration:3===changedfield||1===changedfield?duration:-1,labour:workLabour.labour,startTime:startTime||-99,endTime:2===changedfield?endTime:-99};param.workorderLabourList.push(temp),this.$http.post("/v2/workorderLabour/addOrUpdate",param).then((function(response){self.actionToWorkorderStatusChange(),0!==response.data.responseCode?self.$message.error(response.data.message):(self.$message.success(_this15.$t("common._common.updated_successfully")),self.loadWorkOrderLabour())})).catch((function(){}))},changeWorkToolField:function(workTool,index,durationHour,changedField){var _this16=this;if(Number(workTool.quantity)<=Number(workTool.tempQuantity)+Number(workTool.tempTool.quantity)){var param={workorderToolsList:[]};-1===workTool.issueTime&&(workTool.issueTime=null),-1===workTool.returnTime&&(workTool.returnTime=null);var issueTime=null!==workTool.issueTime?moment_timezone_default()(workTool.issueTime).tz(this.$timezone).valueOf():workTool.issueTime,returnTime=null!==workTool.returnTime?moment_timezone_default()(workTool.returnTime).tz(this.$timezone).valueOf():workTool.returnTime,temp={},duration=Number(workTool.duration);durationHour?(duration=Number(workTool.durationInHour).toFixed(2),null!==issueTime&&issueTime>0&&duration>0&&(returnTime=Number(issueTime)+Number(duration))):duration=Number(duration).toFixed(2),0!==issueTime&&null!==issueTime||(issueTime=-1),0!==returnTime&&null!==returnTime||(returnTime=-1),this.workorderToolsList[index].duration=duration,temp={parentId:this.openWorkorderId,id:workTool.id,tool:{id:workTool.tool.id},quantity:parseInt(workTool.quantity),duration:1==changedField||3==changedField?duration:-1,issueTime:issueTime||-99,returnTime:2===changedField?returnTime:-99,requestedLineItem:workTool.requestedLineItem,parentTransactionId:workTool.parentTransactionId},param.workorderToolsList.push(temp);var self=this;this.$http.post("/v2/workorderTools/addOrUpdate",param).then((function(response){0===response.data.responseCode?(self.$message.success(_this16.$t("common._common.edited_successfully")),self.actionToWorkorderStatusChange(),self.loadWorkOrderToolParts(),self.getWorkOrderCostList()):self.$message.error(response.data.message)}))}else this.$message.error(this.$t("common.dashboard.quantity_should_be_less"))},changeWorkItemQuantity:function(workItem){var _this17=this;if(workItem.quantity<=workItem.tempQuantity+workItem.tempItem.quantity){var param={workorderItems:[]},temp={parentId:this.openWorkorderId,id:workItem.id,item:{id:workItem.item.id},quantity:workItem.quantity,requestedLineItem:workItem.requestedLineItem,parentTransactionId:workItem.parentTransactionId,remainingQuantity:workItem.remainingQuantity+workItem.tempQuantity};param.workorderItems.push(temp);var self=this;this.$http.post("/v2/workorderItems/addOrUpdate",param).then((function(response){0===response.data.responseCode?(self.loadWoItemParts(),self.actionToWorkorderStatusChange(),self.$message.success(_this17.$t("common._common.updated_successfully"))):self.$message.error(response.data.message)}))}else this.$message.error(this.$t("common.dashboard.quantity_should_be_less"))},loadWorkOrderToolParts:function(loading,inventory){var _this18=this;loading&&(this.toolLoading=!0);var self=this;this.$http.get("/v2/workorderToolsList/parent/"+this.openWorkorderId).then((function(response){var wktool={};for(var workTool in _this18.workorderToolsList=response.data.result.workorderTools,response.data.result.workorderTools)_this18.workorderToolsList[workTool].durationInHour=_this18.workorderToolsList[workTool].duration.toFixed(2),_this18.workorderToolsList[workTool].issueTime=-1===_this18.workorderToolsList[workTool].issueTime||null===_this18.workorderToolsList[workTool].issueTime?null:_this18.workorderToolsList[workTool].issueTime,_this18.workorderToolsList[workTool].returnTime=-1===_this18.workorderToolsList[workTool].returnTime||null===_this18.workorderToolsList[workTool].returnTime?null:_this18.workorderToolsList[workTool].returnTime,wktool=response.data.result.workorderTools[workTool],wktool.tempQuantity=wktool.quantity,wktool.tempTool=wktool.tool;self.workorderToolsList=self.$helpers.cloneObject(response.data.result.workorderTools),loading&&self.loadToolslist(),inventory&&self.loadToolslist(),_this18.toolLoading=!1})).catch((function(error){_this18.$message.error(_this18.$t("common.wo_report.unable_to_load_tools")),_this18.toolLoading=!1})),this.loadStockedTools()},loadLabour:function(){var _this19=this,self=this;this.$http.get("/v2/labour/labourList").then((function(response){self.labourList=response.data.result.labours;for(var i=0;i<self.labourList.length;i++){var labourItem=self.labourList[i];self.selectedLabour.includes(labourItem.id)&&self.labourList.splice(i,1)}})).catch((function(error){self.$message.error(_this19.$t("common.wo_report.unable_to_labor_list"))}))},loadWorkOrderLabour:function(loading){var _this20=this;loading&&(this.labourLoading=!0);var self=this;this.$http.get("/v2/workorderLabourList/parent/"+this.openWorkorderId).then((function(response){for(var workLabour in _this20.workLabourTotalCost=0,response.data.result.workorderLabour)_this20.workLabourTotalCost=_this20.workLabourTotalCost+response.data.result.workorderLabour[workLabour].cost;for(var index in self.workorderLabourList=self.$helpers.cloneObject(response.data.result.workorderLabour),self.selectedLabour=[],self.workorderLabourList){var workLabourItem=self.workorderLabourList[index];self.selectedLabour.push(workLabourItem.labour.id),workLabourItem.startTime=workLabourItem.startTime<=0?null:workLabourItem.startTime,workLabourItem.endTime=workLabourItem.endTime<=0?null:workLabourItem.endTime,workLabourItem.duration=workLabourItem.duration.toFixed(2)}self.getWorkOrderCostList(),self.labourLoading=!1})).catch((function(error){self.$message.error(_this20.$t("common.wo_report.unable_to_load_labor")),self.labourLoading=!1}))},loadWoItemParts:function(loading,inventory){var _this21=this;this.loadWorkOrderItemParts=[];var self=this,self1=this;loading&&(this.itemnsloading=!0),this.$http.get("/v2/workorderItemsList/parent/"+this.openWorkorderId).then((function(response){var workItem={};for(var item in response.data.result.workorderItem)workItem=response.data.result.workorderItem[item],workItem.tempQuantity=workItem.quantity,workItem.tempItem=workItem.item;(loading||inventory)&&self.loadInventory(),self1.itemnsloading=!1,self.workorderItemsList=self.$helpers.cloneObject(response.data.result.workorderItem),self1.getWorkOrderCostList()})).catch((function(){self.$message.error(_this21.$t("common.wo_report.unable_to_load_parts"))})),this.loadItem()},loadindividualTrackingList:function(items){var _this22=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var filters,individualItemList;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return _this22.individualItemList=[],_this22.iTloading=!0,filters={rotatingItem:{operatorId:36,value:items.map((function(rt){return rt.id+""}))},isUsed:{operatorId:15,value:["false"]}},_context3.next=5,_this22.$util.getFilteredAssetList(filters);case 5:individualItemList=_context3.sent,_this22.individualItemList=individualItemList.map((function(item){return(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},item),{},{checked:!1})})),_this22.iTloading=!1;case 8:case"end":return _context3.stop()}}),_callee3)})))()},loadindividualToolTrackingList:function(items){var _this23=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){var filters,individualToolList;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:return _this23.individualToolList=[],_this23.iTloading=!0,filters={rotatingTool:{operatorId:36,value:items.map((function(rt){return rt.id+""}))},isUsed:{operatorId:15,value:[!1+""]}},_context4.next=5,_this23.$util.getFilteredAssetList(filters);case 5:individualToolList=_context4.sent,_this23.individualToolList=individualToolList.map((function(item){return(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},item),{},{checked:!1})})),_this23.iTloading=!1;case 8:case"end":return _context4.stop()}}),_callee4)})))()},loadInventoryRequest:function(){var _arguments=arguments,_this24=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee5(){var force,workorder,_ref,id,relatedFieldName,relatedConfig,_yield$API$fetchAllRe,error,list;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context5){while(1)switch(_context5.prev=_context5.next){case 0:return force=_arguments.length>0&&void 0!==_arguments[0]&&_arguments[0],_this24.inventoryRequestForWOLoading=!0,workorder=_this24.workorder,_ref=workorder||{},id=_ref.id,relatedFieldName=(0,relatedFieldUtil/* getRelatedFieldName */.C9)("workorder","inventoryrequest"),relatedConfig={moduleName:"workorder",id:id,relatedModuleName:"inventoryrequest",relatedFieldName:relatedFieldName},_context5.next=8,api/* API */.bl.fetchAllRelatedList(relatedConfig,{},{force:force});case 8:_yield$API$fetchAllRe=_context5.sent,error=_yield$API$fetchAllRe.error,list=_yield$API$fetchAllRe.list,error?_this24.$error.message(error.message||"Error Occured"):(0,validation/* isEmpty */.xb)(list)||(_this24.inventoryRequestList=list),_this24.inventoryRequestForWOLoading=!1;case 13:case"end":return _context5.stop()}}),_callee5)})))()},loadWorkOrderService:function(loading){var _this25=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee6(){var _yield$API$get,data,error,message,_data$workorderServic,workorderServices;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context6){while(1)switch(_context6.prev=_context6.next){case 0:return loading&&(_this25.loading.woService=!0),_context6.next=3,api/* API */.bl.get("/v2/workorderServiceList/parent/".concat(_this25.openWorkorderId),null,{force:!0});case 3:_yield$API$get=_context6.sent,data=_yield$API$get.data,error=_yield$API$get.error,error?(message=error.message,_this25.$message.error(message||_this25.$t("common._common.error_occured_while_fetching_workorder"))):(_data$workorderServic=data.workorderServices,workorderServices=void 0===_data$workorderServic?[]:_data$workorderServic,workorderServices.forEach((function(woService){(0,validation/* isEmpty */.xb)(woService.endTime)&&(woService.endTime=null),(0,validation/* isEmpty */.xb)(woService.startTime)&&(woService.startTime=null),(0,validation/* isEmpty */.xb)(woService.duration)||(woService.duration=Number(woService.duration).toFixed(2))})),_this25.workorderServiceList=workorderServices||[]),_this25.loading.woService=!1;case 8:case"end":return _context6.stop()}}),_callee6)})))()},addNewWOService:function(){this.loadAllServices(),this.serviceAddDialogVisibility=!0},loadAllServices:function(){var _this26=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee7(){var allWoServiceIds,_yield$API$get2,data,error,message,_data$services,services;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context7){while(1)switch(_context7.prev=_context7.next){case 0:return allWoServiceIds=(_this26.workorderServiceList||[]).map((function(woService){return _this26.$getProperty(woService,"service.id",-1)})),_this26.loading.serviceList=!0,_context7.next=4,api/* API */.bl.get("/v2/service/all");case 4:_yield$API$get2=_context7.sent,data=_yield$API$get2.data,error=_yield$API$get2.error,error?(message=error.message,_this26.$message.error(message||_this26.$t("common._common.error_occured_while_fetching_services_list"))):(_data$services=data.services,services=void 0===_data$services?[]:_data$services,(0,validation/* isEmpty */.xb)(services)||(services=services.filter((function(service){return!allWoServiceIds.includes(service.id)}))||[],services.forEach((function(service){_this26.$setProperty(service,"checked",!1)}))),_this26.allServiceList=services||[]),_this26.loading.serviceList=!1;case 9:case"end":return _context7.stop()}}),_callee7)})))()},closeServiceDialog:function(){this.serviceAddDialogVisibility=!1},addWoService:function(){var _this27=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee8(){var param,_this27$allServiceLis,allServiceList,_yield$API$post,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context8){while(1)switch(_context8.prev=_context8.next){case 0:if(param={workorderServiceList:[]},_this27$allServiceLis=_this27.allServiceList,allServiceList=void 0===_this27$allServiceLis?[]:_this27$allServiceLis,allServiceList.forEach((function(service){if(service.checked){var tempObj={parentId:_this27.openWorkorderId,startTime:-1,endTime:-1,service:service};param.workorderServiceList.push(tempObj)}})),(0,validation/* isEmpty */.xb)(param.workorderServiceList)){_context8.next=13;break}return _this27.loading.woServiceSave=!0,_context8.next=7,api/* API */.bl.post("/v2/workorderService/addOrUpdate",param);case 7:_yield$API$post=_context8.sent,error=_yield$API$post.error,error?_this27.$message.error(error||_this27.$t("common._common.error_occured_while_adding_workorder_services")):(_this27.$message.success(_this27.$t("common._common.added_service_successfully")),_this27.closeServiceDialog(),_this27.serviceUpdateActions()),_this27.loading.woServiceSave=!1,_context8.next=14;break;case 13:_this27.closeServiceDialog();case 14:case"end":return _context8.stop()}}),_callee8)})))()},serviceUpdateActions:function(){this.actionToWorkorderStatusChange(),this.loadWorkOrderService(!0),this.getWorkOrderCostList()},deleteWoService:function(woService){var _this28=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee9(){var param,_yield$API$post2,error,message;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context9){while(1)switch(_context9.prev=_context9.next){case 0:return param={parentId:_this28.openWorkorderId,workorderServiceIds:[]},param.workorderServiceIds.push(woService.id),_this28.loading.woService=!0,_context9.next=5,api/* API */.bl.post("v2/workorderService/delete",param);case 5:_yield$API$post2=_context9.sent,error=_yield$API$post2.error,error?(message=error.message,_this28.$message.error(message||_this28.$t("common._common.error_occured_while_deleting_workorder_service"))):(_this28.$message.success(_this28.$t("common.products.service_deleted_successfully")),_this28.serviceUpdateActions()),_this28.loading.woService=!0;case 9:case"end":return _context9.stop()}}),_callee9)})))()},changeWorkServiceField:function(workService,changedfield){var _this29=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee10(){var duration,param,startTime,endTime,temp,_yield$API$post3,error,message;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context10){while(1)switch(_context10.prev=_context10.next){case 0:return duration=Number(workService.duration).toFixed(2),param={workorderServiceList:[]},(0,validation/* isEmpty */.xb)(workService.startTime)&&(workService.startTime=null),(0,validation/* isEmpty */.xb)(workService.endTime)&&(workService.endTime=null),startTime=null!==workService.startTime?moment_timezone_default()(workService.startTime).tz(_this29.$timezone).valueOf():workService.startTime,endTime=null!==workService.endTime?moment_timezone_default()(workService.endTime).tz(_this29.$timezone).valueOf():workService.endTime,temp={id:workService.id,parentId:_this29.openWorkorderId,duration:3===changedfield||1===changedfield?duration:-1,service:workService.service,startTime:startTime||-99,endTime:2===changedfield?endTime:-99,quantity:workService.quantity},param.workorderServiceList.push(temp),_context10.next=10,api/* API */.bl.post("/v2/workorderService/addOrUpdate",param);case 10:_yield$API$post3=_context10.sent,error=_yield$API$post3.error,error?(message=error.message,_this29.$message.error(message||_this29.$t("common._common.error_occured_while_updating_workorder_service"))):(_this29.$message.success(_this29.$t("common._common.updated_successfully")),_this29.loadWorkOrderService(!0),_this29.getWorkOrderCostList());case 13:case"end":return _context10.stop()}}),_callee10)})))()}}},v1_inventoryvue_type_script_lang_js=inventoryvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(v1_inventoryvue_type_script_lang_js,render,staticRenderFns,!1,null,"4afb74fc",null)
/* harmony default export */,inventory=component.exports},
/***/720985:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return WOInvReqForm}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/workorder/workorders/v3/widgets/ItemsAndLabor/WOInvReqForm.vue?vue&type=template&id=3555d990
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticStyle:{"z-index":"1999"},attrs:{fullscreen:!0,"append-to-body":!0,visible:!0,"custom-class":"fc-wo-edit-form-dialog fc-dialog-form setup-dialog-right setup-dialog50 setup-dialog f-webform-right-dialog new-asset-container","before-close":_vm.cancelForm}},[_c("div",{staticClass:"header pT10 pB10 pL30 pR30 d-flex"},[_c("div",{staticClass:"title mT10"},[_vm._v(_vm._s(_vm.title))]),_vm.forms.length>1?_c("el-select",{staticClass:"fc-input-full-border-select2 mL-auto width25",attrs:{"value-key":"name"},model:{value:_vm.selectedForm,callback:function($$v){_vm.selectedForm=$$v},expression:"selectedForm"}},_vm._l(_vm.forms,(function(form,index){return _c("el-option",{key:index,attrs:{value:form,label:form.displayName}})})),1):_vm._e()],1),_vm.isLoading?_c("div",{staticClass:"loading-container d-flex"},[_c("Spinner",{attrs:{show:_vm.isLoading}})],1):_c("f-webform",{attrs:{form:_vm.formObj,module:_vm.moduleName,isSaving:_vm.isSaving,isEdit:_vm.isEdit,canShowPrimaryBtn:!0,canShowSecondaryBtn:!0,modifyFieldPropsHook:_vm.modifyFieldPropsHook,moduleDisplayName:_vm.moduleDisplayName,isV3Api:_vm.isV3Api,isWidgetsSupported:_vm.isWidgetsSupported,moduleData:_vm.moduleData,moduleDataId:_vm.moduleDataId,subFormRecords:_vm.subFormRecords},on:{"update:form":function($event){_vm.formObj=$event},onWidgetChange:_vm.onWidgetChange,save:_vm.saveRecord,cancel:_vm.cancelForm}})],1)},staticRenderFns=[],objectSpread2=__webpack_require__(595082),InventoryRequestForm=(__webpack_require__(879288),__webpack_require__(450886),__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(634338),__webpack_require__(434284),__webpack_require__(470172)),validation=__webpack_require__(990260),vuex_esm=__webpack_require__(420629),WOInvReqFormvue_type_script_lang_js={props:["dataModuleId","woDetails"],extends:InventoryRequestForm["default"],computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({account:function(state){return state.account}})),{},{moduleDataId:function(){var dataModuleId=this.dataModuleId;return(0,validation/* isEmpty */.xb)(dataModuleId)?null:Number(dataModuleId)}}),methods:{afterSerializeHook:function(_ref){var data=_ref.data,_ref2=data||{},lineItems=_ref2.inventoryrequestlineitems,id=this.woDetails.id;return!(0,validation/* isEmpty */.xb)(lineItems)&&(0,validation/* isArray */.kJ)(lineItems)&&(lineItems=lineItems.filter((function(item){var _item$itemType,_item$toolType;return!(0,validation/* isEmpty */.xb)(item.quantity)&&(1===item.inventoryType&&(null===(_item$itemType=item.itemType)||void 0===_item$itemType?void 0:_item$itemType.id)||2===item.inventoryType&&(null===(_item$toolType=item.toolType)||void 0===_item$toolType?void 0:_item$toolType.id))})).map((function(item){var _ref3=item||{},inventoryType=_ref3.inventoryType;return 1===inventoryType?(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},item),{},{toolType:null}):(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},item),{},{itemType:null})})),this.$setProperty(data,"inventoryrequestlineitems",(0,validation/* isEmpty */.xb)(lineItems)?null:lineItems)),data.parentId=id,data},afterSaveHook:function(_ref4){var error=_ref4.error;error||(this.$emit("onSave"),this.cancelForm())},cancelForm:function(){this.$emit("onClose")},modifyFieldPropsHook:function(field){var moduleDataId=this.moduleDataId,woDetails=this.woDetails,account=this.account,_ref5=woDetails||{},localId=_ref5.localId,woId=_ref5.id,_ref6=account||{},user=_ref6.user,_ref7=user||{},userId=_ref7.id,fieldValueObj={name:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},field),{},{value:"".concat(this.$t("common.inventory.required_inventory_items_for_wo")," ").concat(localId)}),requestedBy:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},field),{},{value:userId,isDisabled:!0}),requestedFor:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},field),{},{value:userId}),workorder:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},field),{},{value:woId,isDisabled:!0})};if((0,validation/* isEmpty */.xb)(moduleDataId)){var _ref8=field||{},name=_ref8.name;return fieldValueObj[name]||field}var _fieldValueObj={requestedBy:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},field),{},{isDisabled:!0}),workorder:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},field),{},{isDisabled:!0})},_ref9=field||{},_name=_ref9.name;return _fieldValueObj[_name]||field}}},ItemsAndLabor_WOInvReqFormvue_type_script_lang_js=WOInvReqFormvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(ItemsAndLabor_WOInvReqFormvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,WOInvReqForm=component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/84692.js.map