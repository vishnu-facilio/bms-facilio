"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[6531],{
/***/606531:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return NewRulesList}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/firealarm/rules/NewRulesList.vue?vue&type=template&id=615a73f1&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.openRuleSummary?_c("div",{staticClass:"height100"},[_c("div",{staticClass:"flex flex-row"},[_c("div",{staticClass:"cm-side-bar-container"},[_c("SummarySidebar",{attrs:{list:_vm.records,isLoading:_vm.isLoading,activeRecordId:_vm.selectedRuleId,total:_vm.recordCount,currentCount:(_vm.records||[]).length},on:{"update:isLoading":function($event){_vm.isLoading=$event},"update:is-loading":function($event){_vm.isLoading=$event}},scopedSlots:_vm._u([{key:"title",fn:function(){return[_c("el-row",{staticClass:"cm-sidebar-header"},[_c("el-col",{attrs:{span:2}},[_c("span",{on:{click:function($event){return _vm.openList()}}},[_c("inline-svg",{staticClass:"rotate-90 pointer",attrs:{src:"svgs/arrow",iconClass:"icon icon-sm"},on:{click:function($event){return _vm.openList()}}})],1)]),_c("el-col",{attrs:{span:22}},[_c("div",{staticClass:"bold"},[_vm._v(_vm._s(_vm.currentViewDetail))])])],1)]},proxy:!0},{key:"default",fn:function(ref){var record=ref.record;return[_c("div",{staticClass:"sp-li ellipsis f12 pointer asset-item p20",on:{click:function($event){return _vm.redirectToOverview(record.id)}}},[_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"top",animation:"shift-away",arrow:!0},expression:"{\n                    placement: 'top',\n                    animation: 'shift-away',\n                    arrow: true,\n                  }"}],staticClass:"f14 truncate-text",attrs:{title:record.name||"---"}},[_vm._v(" "+_vm._s(record.name||"---")+" ")])])],1)],1)]}}],null,!1,3409283867)})],1),_c("div",{staticClass:"flex-1"},[_c("router-view",{attrs:{viewname:_vm.viewname}})],1)])]):_c("CommonListLayout",{key:_vm.moduleName+"-list-layout",attrs:{moduleName:_vm.moduleName,showViewRearrange:!0,showViewEdit:!0,visibleViewCount:3,getPageTitle:function(){return _vm.moduleDisplayName},pathPrefix:"/app/fa/newrules",hideSubHeader:_vm.canHideSubHeader,recordCount:_vm.recordCount,recordLoading:_vm.showLoading},scopedSlots:_vm._u([{key:"header",fn:function(){return[_vm.canHideFilter?_vm._e():_c("AdvancedSearchWrapper",{key:"ftags-list-"+_vm.moduleName,attrs:{filters:_vm.filters,moduleName:_vm.moduleName,moduleDisplayName:_vm.moduleDisplayName}}),_vm.canShowVisualSwitch?_c("visual-type",{on:{onSwitchVisualize:function(val){return _vm.canShowListView=val}}}):_vm._e(),_vm.$hasPermission("alarmrules:CREATE")?_c("button",{staticClass:"fc-create-btn ",on:{click:function($event){return _vm.createNewRule()}}},[_vm._v(" "+_vm._s(_vm.$t("common.products.new_rule"))+" ")]):_vm._e()]},proxy:!0},_vm.canShowCalendarHeader?{key:"sub-header",fn:function(){return[_vm.showListView?_vm._e():_c("CalendarDateWrapper")]},proxy:!0}:null,{key:"sub-header-actions",fn:function(){return[!_vm.isEmpty(_vm.records)&&_vm.showListView?[_c("Pagination",{staticClass:"mT2",attrs:{total:_vm.recordCount,perPage:_vm.perPage,skipTotalCount:!0}})]:_vm._e()]},proxy:!0},{key:"content",fn:function(){return[_vm.showLoading?_c("Spinner",{staticClass:"mT40",attrs:{show:_vm.showLoading}}):_vm.showListView?[_c("div",{staticClass:"new-rules-list-container"},[_vm.$validation.isEmpty(_vm.records)&&!_vm.isLoading?_c("div",{staticClass:"fc-list-empty-state-container"},[_c("inline-svg",{attrs:{src:"svgs/list-empty",iconClass:"icon text-center icon-xxxxlg"}}),_c("div",{staticClass:"mT10 fc-black-dark f16 fw6"},[_c("div",{staticClass:"mT10 label-txt-black f14"},[_vm._v(" "+_vm._s(_vm.$t("setup.users_management.no_rules_available"))+" ")])])],1):_c("div",{staticClass:"height100"},[_c("div",{staticClass:"column-customization-icon",attrs:{disabled:!_vm.isColumnCustomizable},on:{click:_vm.toShowColumnSettings}},[_c("el-tooltip",{attrs:{disabled:_vm.isColumnCustomizable,placement:"top",content:_vm.$t("common._common.you_dont_have_permission")}},[_c("inline-svg",{staticClass:"text-center position-absolute icon",attrs:{src:"column-setting"}})],1)],1),_c("CommonList",{attrs:{viewDetail:_vm.viewDetail,records:_vm.records,hideListSelect:"true",moduleName:_vm.moduleName,slotList:_vm.slotList,redirectToOverview:_vm.redirectToOverview},scopedSlots:_vm._u([{key:_vm.slotList[0].name,fn:function(ref){var record=ref.record;return[_c("div",{staticClass:"d-flex"},[_c("div",{staticClass:"fc-id"},[_vm._v(_vm._s("#"+record.id))])])]}},{key:_vm.slotList[1].criteria,fn:function(ref){var record=ref.record;return[_c("div",{staticClass:"d-flex main-field-column label-txt-black",on:{click:function($event){return _vm.redirectToOverview(record.id)}}},[_c("el-tooltip",{attrs:{effect:"dark",content:record.name||"---",placement:"top","open-delay":600}},[_c("div",{staticClass:"self-center truncate-text mL5"},[_vm._v(" "+_vm._s(record.name||"---")+" ")])])],1)]}},{key:_vm.slotList[2].name,fn:function(ref){var record=ref.record;return[_c("div",{staticClass:"table-subheading"},[_vm._v(" "+_vm._s(_vm.getSpaceOrAsset(record))+" ")])]}},{key:_vm.slotList[3].criteria,fn:function(ref){var record=ref.record;return[_c("div",{staticClass:"d-flex"},[_c("div",{staticClass:"self-center mL5"},[_vm._v(" "+_vm._s(_vm.getCategoryName(record)||"Space")+" ")])])]}},{key:_vm.slotList[4].name,fn:function(ref){var record=ref.record;return[_c("div",{staticClass:"d-flex"},[_c("div",{staticClass:"self-center mL5"},[_vm._v(" "+_vm._s(_vm.getResourceName(record))+" ")])])]}},{key:_vm.slotList[5].name,fn:function(ref){var record=ref.record;return[_c("div",[record.alarmDetails.severityId?_c("i",{staticClass:"fa fa-circle prioritytag",style:{color:(_vm.getSeverity(record)||{}).color},attrs:{"aria-hidden":"true"}}):_vm._e(),_vm._v(" "+_vm._s((_vm.getSeverity(record)||{}).displayName||"---")+" ")])]}},_vm.$hasPermission("alarmrules:UPDATE,UPDATE_TEAM,UPDATE_OWN")?{key:_vm.slotList[6].criteria,fn:function(ref){var record=ref.record;return[_c("div",{staticClass:"d-flex"},[_c("div",{staticClass:"self-center mL5"},[_c("el-switch",{on:{change:function($event){return _vm.updateStatus(record)}},model:{value:record.status,callback:function($$v){_vm.$set(record,"status",$$v)},expression:"record.status"}})],1)])]}}:null,{key:_vm.slotList[7].criteria,fn:function(ref){var record=ref.record;return[_c("div",[_c("span",{staticClass:"q-item-label f13 letter-spacing0_4"},[_vm._v(" "+_vm._s(_vm.getReadingFieldName(record))+" ")])])]}},{key:_vm.slotList[8].criteria,fn:function(ref){var record=ref.record;return[_c("div",[_c("span",{staticClass:"q-item-label f13 letter-spacing0_4"},[_vm._v(" "+_vm._s(_vm.getReadingModuleName(record))+" ")])])]}},{key:_vm.slotList[9].name,fn:function(ref){var record=ref.record;return[_c("div",{staticClass:"d-flex text-center"},[_vm.$hasPermission("alarmrules:UPDATE,UPDATE_TEAM,UPDATE_OWN")?_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-edit pointer edit-icon-color visibility-hide-actions",attrs:{"data-arrow":"true",title:_vm.$t("rule.create.edit_rule")},on:{click:function($event){return _vm.editRule(record)}}}):_vm._e(),_vm.$hasPermission("alarmrules:DELETE")?_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-delete pointer edit-icon-color visibility-hide-actions mL10",attrs:{"data-arrow":"true",title:_vm.$t("rule.create.delete_rule")},on:{click:function($event){return _vm.deleteRule([record.id])}}}):_vm._e()])]}}],null,!0)})],1)])]:_vm.showListView?_vm._e():_c("CalendarView",{ref:"calendar",attrs:{moduleName:_vm.moduleName,record:_vm.records,viewDetail:_vm.viewDetail,viewname:_vm.viewname,filters:_vm.filters}}),_c("column-customization",{attrs:{visible:_vm.showColumnSettings,moduleName:_vm.moduleName,viewName:_vm.viewname},on:{"update:visible":function($event){_vm.showColumnSettings=$event}}})]},proxy:!0}],null,!0)},[_c("portal",{attrs:{to:"view-manager-link"}},[_c("router-link",{staticClass:"view-manager-btn",attrs:{tag:"div",to:{path:"/app/fa/newrules/newreadingrules/viewmanager"}}},[_c("inline-svg",{staticClass:"d-flex",attrs:{src:"svgs/hamburger-menu",iconClass:"icon icon-sm"}}),_c("span",{staticClass:"label mL10 text-uppercase"},[_vm._v(" "+_vm._s(_vm.$t("viewsmanager.list.views_manager"))+" ")])],1)],1)],1)},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),objectSpread2=__webpack_require__(595082),vuex_esm=(__webpack_require__(564043),__webpack_require__(61514),__webpack_require__(169358),__webpack_require__(648324),__webpack_require__(434284),__webpack_require__(670560),__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(634338),__webpack_require__(420629)),validation=__webpack_require__(990260),Spinner=__webpack_require__(604947),CommonLayout=__webpack_require__(951478),SummarySideBar=__webpack_require__(105402),CommonList=__webpack_require__(820920),api=__webpack_require__(32284),CustomModuleData=__webpack_require__(689565),CommonModuleList=__webpack_require__(347446),router=__webpack_require__(329435),NewRulesListvue_type_script_lang_js={extends:CommonModuleList["default"],components:{Spinner:Spinner/* default */.Z,CommonList:CommonList/* default */.Z,CommonListLayout:CommonLayout/* default */.Z,SummarySidebar:SummarySideBar/* default */.Z},data:function(){return{showColumnSettings:!1,selectedListItemsIds:[],selectedListItemsObj:[],sortConfig:{orderBy:{label:"System Created Time",value:"sysCreatedTime"},orderType:"desc"},sortConfigLists:[],records:null,rulesList:[],perPage:50,recordCount:null}},created:function(){this.$store.dispatch("loadAlarmSeverity"),this.$store.dispatch("loadAssetCategory")},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({assetCategoryList:function(state){return state.assetCategory},viewDetail:function(state){return state.view.currentViewDetail}})),(0,vuex_esm/* mapGetters */.Se)(["getAlarmSeverity"])),{},{currentViewDetail:function(){var viewDetail=this.viewDetail,filters=this.filters;return(0,validation/* isEmpty */.xb)(filters)?viewDetail.displayName:this.$t("custommodules.list.filtered_view")},moduleName:function(){return"newreadingrules"},moduleDisplayName:function(){return"Rules"},modelDataClass:function(){return CustomModuleData/* CustomModuleData */.u},filters:function(){return this.$route.query.search?JSON.parse(this.$route.query.search):null},slotList:function(){return[{name:"id",isHardcodedColumn:!0,columnAttrs:{"min-width":120,fixed:"left",label:"ID"}},
//0
{criteria:JSON.stringify({name:"name"})},
//1
{name:"type",isHardcodedColumn:!0,columnAttrs:{width:200,label:"TYPE"}},
//2
{criteria:JSON.stringify({name:"assetCategory"}),columnAttrs:{label:"CATEGORY"}},
//3
{name:"space/asset",isHardcodedColumn:!0,columnAttrs:{width:250,"max-width":300,label:"SPACE/ASSET"}},
//4
{name:"severity",isHardcodedColumn:!0,columnAttrs:{width:250,"max-width":250,label:"SEVERITY"}},
//5
{criteria:JSON.stringify({name:"status"})},
//6
{criteria:JSON.stringify({name:"readingFieldId"}),columnAttrs:{label:"READING FIELD"}},
//7
{criteria:JSON.stringify({name:"readingModuleId"}),columnAttrs:{label:"READING MODULE"}},
//8
{name:"editDelete",isActionColumn:!0,columnAttrs:{width:130,class:"visibility-visible-actions",fixed:"right"}}]},selectedRuleId:function(){var id=this.$getProperty(this,"$route.params.id");return id?parseInt(id):-1},openRuleSummary:function(){return!(0,validation/* isEmpty */.xb)(this.selectedRuleId)},page:function(){return this.$route.query.page||1},isV3Api:function(){return!0},viewname:function(){return this.$route.params.viewname}}),methods:{updateStatus:function(record){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var _ref,id,url,params,_yield$API$post,error,data;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _ref=record||{},id=_ref.id,url="v3/modules/data/patch",params={data:record,moduleName:_this.moduleName,id:id},_context.next=5,api/* API */.bl.post(url,params);case 5:_yield$API$post=_context.sent,error=_yield$API$post.error,data=_yield$API$post.data,error?_this.$message.error("Error Occurred"):(0,validation/* isEmpty */.xb)(data)||_this.$message.success("Status updated successfully");case 9:case"end":return _context.stop()}}),_callee)})))()},openList:function(){var _ref2=this||{},viewname=_ref2.viewname,$route=_ref2.$route,_ref3=$route||{},query=_ref3.query;if((0,router/* isWebTabsEnabled */.tj)()){var moduleName=this.moduleName,_ref4=(0,router/* findRouteForModule */.Jp)(moduleName,router/* pageTypes */.As.LIST)||{},name=_ref4.name;name&&this.$router.push({name:name,viewname:viewname,query:query})}else this.$router.push({name:"newrules",params:{viewname:viewname},query:query})},redirectToOverview:function(id){var viewname=this.viewname,$route=this.$route,_ref5=$route||{},query=_ref5.query;if((0,router/* isWebTabsEnabled */.tj)()){var moduleName=this.moduleName,_ref6=(0,router/* findRouteForModule */.Jp)(moduleName,router/* pageTypes */.As.OVERVIEW)||{},name=_ref6.name;name&&this.$router.push({name:name,params:{id:id,viewname:viewname},query:query})}else this.$router.push({name:"newRulesSummary",params:{id:id,viewname:viewname},query:query})},getCategoryName:function(record){var _ref7=record||{},assetCategory=_ref7.assetCategory,_ref8=assetCategory||{},id=_ref8.id;if(id>0&&this.assetCategoryList){var category=this.assetCategoryList.find((function(category){return category.id===id}));if(category)return category.displayName}},getReadingFieldName:function(record){return this.$getProperty(record,"readingFieldName","---")},getReadingModuleName:function(record){return this.$getProperty(record,"readingModuleName","---")},getSpaceOrAsset:function(record){var _ref9=record||{},assetCategory=_ref9.assetCategory,_ref10=assetCategory||{},id=_ref10.id;return id>0?"Asset":"Space"},getResourceName:function(rule){var _ref11=rule||{},assetCategory=_ref11.assetCategory,assets=_ref11.assets,excludedResources=_ref11.excludedResources,_ref12=assetCategory||{},id=_ref12.id;if(id>0){var message,selectedCount,isIncluded=!(0,validation/* isEmpty */.xb)(assets);isIncluded?selectedCount=assets.length:excludedResources&&excludedResources.length&&(selectedCount=excludedResources.length);var categoryName=this.getCategoryName(rule);return message=selectedCount?(isIncluded?selectedCount:"Some")+" "+categoryName+(!isIncluded||selectedCount>1?"s":""):"All "+categoryName+"s",message}return rule.resourceId>0?rule.matchedResources?rule.matchedResources[Object.keys(rule.matchedResources)[0]].name:"--- ":"---"},createNewRule:function(){var moduleName=this.moduleName,viewname=this.viewname;if((0,router/* isWebTabsEnabled */.tj)()){var _ref13=(0,router/* findRouteForModule */.Jp)(moduleName,router/* pageTypes */.As.CREATE)||{},name=_ref13.name;name&&this.$router.push({name:name,params:{viewname:viewname}})}else this.$router.push({name:"rule-creation-new",params:{viewname:viewname},query:this.$route.query})},
// Template page is not yet supported for newRule
// handleNewRule(option) {
//   if (option == 'library') {
//     let url = '/app/fa/rules/templates'
//     this.$router.push({ path: url })
//   }
//   if (option == 'custom') {
//     this.$router.push({ path: `/app/fa/newrule/new` })
//   }
// },
getSeverity:function(record){var severityId=this.$getProperty(record,"alarmDetails.severityId",-1);return this.getAlarmSeverity(severityId)},editRule:function(record){var _ref14=record||{},id=_ref14.id,viewname=this.viewname,moduleName=this.moduleName;if((0,router/* isWebTabsEnabled */.tj)()){var _ref15=(0,router/* findRouteForModule */.Jp)(moduleName,router/* pageTypes */.As.EDIT)||{},name=_ref15.name;name&&this.$router.push({name:name,params:{viewname:viewname,id:id}})}else this.$router.push({name:"new-rule-edit",params:{viewname:viewname,id:id},query:this.$route.query})},deleteRule:function(id){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var moduleName,moduleDisplayName,value;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return moduleName=_this2.moduleName,moduleDisplayName=_this2.moduleDisplayName,_context2.next=3,_this2.$dialog.confirm({title:"".concat(_this2.$t("custommodules.list.delete")," ").concat(moduleDisplayName),message:"".concat(_this2.$t("custommodules.list.delete_confirmation")," ").concat(moduleDisplayName,"?"),rbDanger:!0,rbLabel:_this2.$t("custommodules.list.delete")});case 3:if(value=_context2.sent,!value){_context2.next=18;break}return _this2.isLoading=!0,_context2.prev=6,_context2.next=9,_this2.modelDataClass.delete(moduleName,id);case 9:return _this2.$message.success("".concat(moduleDisplayName," ").concat(_this2.$t("custommodules.list.delete_success"))),_context2.next=12,_this2.loadRecords();case 12:_context2.next=17;break;case 14:_context2.prev=14,_context2.t0=_context2["catch"](6),_this2.$message.error(_context2.t0);case 17:_this2.isLoading=!1;case 18:case"end":return _context2.stop()}}),_callee2,null,[[6,14]])})))()},closeEditForm:function(close){close&&(this.canShowEditForm=!1)}}},rules_NewRulesListvue_type_script_lang_js=NewRulesListvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(rules_NewRulesListvue_type_script_lang_js,render,staticRenderFns,!1,null,"615a73f1",null)
/* harmony default export */,NewRulesList=component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/6531.js.map