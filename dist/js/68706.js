"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[68706],{
/***/381056:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return AnomalyMixin}});
// EXTERNAL MODULE: ./node_modules/core-js/modules/es.object.to-string.js
__webpack_require__(260228),__webpack_require__(670560);
// EXTERNAL MODULE: ./node_modules/core-js/modules/es.array.push.js
var render,staticRenderFns,moment_timezone=__webpack_require__(480008),moment_timezone_default=__webpack_require__.n(moment_timezone),NewDateHelper=__webpack_require__(105534),AnomalyMixinvue_type_script_lang_js={computed:{lastMonth:function(){return moment_timezone_default()().tz(this.$timezone).subtract(1,"months").format("MMMM")},currentMonth:function(){return moment_timezone_default()().tz(this.$timezone).startOf("month").format("MMMM")},isMetricsApiLoading:function(){return this.$store.state.anomalies.isLoading},currMntNLastMntRanges:function(){var thisMonthdateRange=NewDateHelper/* default */.Z.getDatePickerObject(28,this.$timezone),lastMonthDateRange=NewDateHelper/* default */.Z.getDatePickerObject(27,this.$timezone),dateRanges={};return dateRanges.startTime=lastMonthDateRange.value[0],dateRanges.endTime=thisMonthdateRange.value[1],dateRanges}},methods:{loadEnrgyByCdd:function(resourcesIds){return this.$util.getWorkFlowResult(49,[resourcesIds,this.details.alarm.resource.siteId])},loadEnergyWastage:function(resourceIds){return this.$util.getWorkFlowResult(99,[resourceIds,this.details.alarm.id])},loadAnomaliesCount:function(resourceIds,isRCA){return this.$util.getWorkFlowResult(100,[resourceIds,this.details.alarm.id,isRCA||!1])},loadDeviation:function(resourceIds){return this.$util.getWorkFlowResult(46,[resourceIds,this.details.alarm.id])},loadMetrics:function(resourceId,alarmId,siteId,dateRange,rca){var _this=this,url="/v2/mlAnomalyAlarm/metrics",paramJson={};return paramJson.alarmId=alarmId,paramJson.resourceId=resourceId,paramJson.siteId=siteId,null!=dateRange&&(paramJson.dateRange=dateRange),rca&&(paramJson.rca=rca),this.loading=!0,new Promise((function(resolve,reject){_this.$http.post(url,paramJson).then((function(response){resolve(response.data.result.metrics)})).catch((function(error){reject(error)}))}))},loadMeanMetrics:function(){var workflowID,_this2=this;workflowID="readingalarm"===this.moduleName?8:"newreadingalarm"===this.moduleName?108:"agentAlarm"===this.moduleName||"operationalarm"===this.moduleName?11:47;
// if (!this.details.metricsPromise) {
var params=[this.details.alarm.id];"newreadingalarm"===this.moduleName&&params.push(this.cardId);var promise=this.$util.getWorkFlowResult(workflowID,params).finally((function(_){_this2.$set(_this2.details,"metricsPromise",null)}));
// }
return this.$set(this.details,"metricsPromise",promise),this.details.metricsPromise}}},mixins_AnomalyMixinvue_type_script_lang_js=AnomalyMixinvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(mixins_AnomalyMixinvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,AnomalyMixin=component.exports},
/***/760218:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return PageBuilder}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/page/PageBuilder.vue?vue&type=template&id=0dd0982f
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.showPage&&_vm.pagebuilderComponent?_c(_vm.pagebuilderComponent,_vm._b({tag:"component",attrs:{module:_vm.module},on:{forceOldPage:function($event){_vm.forceOld=!0}}},"component",_vm.$attrs,!1)):_vm._e()},staticRenderFns=[],objectSpread2=__webpack_require__(595082),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),vuex_esm=(__webpack_require__(260228),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(420629)),PageBuildervue_type_script_lang_js={props:["module"],data:function(){return{forceOld:!1,showPage:!1}},components:{NewPageBuilder:function(){return Promise.all(/* import() */[__webpack_require__.e(93208),__webpack_require__.e(50232),__webpack_require__.e(93765),__webpack_require__.e(95953),__webpack_require__.e(35309),__webpack_require__.e(18778),__webpack_require__.e(12303),__webpack_require__.e(84290),__webpack_require__.e(31721),__webpack_require__.e(64418),__webpack_require__.e(5603),__webpack_require__.e(57432),__webpack_require__.e(435),__webpack_require__.e(72230),__webpack_require__.e(94255),__webpack_require__.e(67683),__webpack_require__.e(44178),__webpack_require__.e(91132),__webpack_require__.e(20280),__webpack_require__.e(78256),__webpack_require__.e(22200),__webpack_require__.e(49081),__webpack_require__.e(89472),__webpack_require__.e(12085),__webpack_require__.e(55754),__webpack_require__.e(86494),__webpack_require__.e(3037),__webpack_require__.e(49908),__webpack_require__.e(22061),__webpack_require__.e(31602),__webpack_require__.e(73609),__webpack_require__.e(44119),__webpack_require__.e(88262),__webpack_require__.e(82080),__webpack_require__.e(88506)]).then(__webpack_require__.bind(__webpack_require__,110570))},OldPageBuilder:function(){return Promise.all(/* import() */[__webpack_require__.e(93208),__webpack_require__.e(50232),__webpack_require__.e(93765),__webpack_require__.e(95953),__webpack_require__.e(35309),__webpack_require__.e(18778),__webpack_require__.e(12303),__webpack_require__.e(84290),__webpack_require__.e(31721),__webpack_require__.e(64418),__webpack_require__.e(5603),__webpack_require__.e(57432),__webpack_require__.e(435),__webpack_require__.e(72230),__webpack_require__.e(94255),__webpack_require__.e(67683),__webpack_require__.e(44178),__webpack_require__.e(91132),__webpack_require__.e(20280),__webpack_require__.e(78256),__webpack_require__.e(22200),__webpack_require__.e(49081),__webpack_require__.e(89472),__webpack_require__.e(12085),__webpack_require__.e(55754),__webpack_require__.e(86494),__webpack_require__.e(3037),__webpack_require__.e(49908),__webpack_require__.e(22061),__webpack_require__.e(31602),__webpack_require__.e(73609),__webpack_require__.e(23803),__webpack_require__.e(55246)]).then(__webpack_require__.bind(__webpack_require__,223803))}},created:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(_context.prev=0,!_this.$helpers.isLicenseEnabled("PAGE_BUILDER")){_context.next=4;break}return _context.next=4,_this.$store.dispatch("pagebuilder/loadNewPageEnabledModules");case 4:_context.next=8;break;case 6:_context.prev=6,_context.t0=_context["catch"](0);case 8:_this.$nextTick((function(){_this.showPage=!0}));case 9:case"end":return _context.stop()}}),_callee,null,[[0,6]])})))()},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({newPageEnabledModules:function(state){return state.pagebuilder.newPageEnabledModules}})),{},{pagebuilderComponent:function(){var newPageEnabledModules=this.newPageEnabledModules,module=this.module,forceOld=this.forceOld,isNew=(newPageEnabledModules||[]).includes(module),showNew=!forceOld&&(this.showNewPageBuilder||isNew);return showNew?"NewPageBuilder":"OldPageBuilder"},showNewPageBuilder:function(){var query=this.$route.query,_query$showNewPageBui=query.showNewPageBuilder,showNewPageBuilder=void 0!==_query$showNewPageBui&&_query$showNewPageBui;return!0===showNewPageBuilder||"true"===showNewPageBuilder}})},page_PageBuildervue_type_script_lang_js=PageBuildervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(page_PageBuildervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,PageBuilder=component.exports},
/***/868706:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return AnomalyOverview}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/firealarm/anomalies/AnomalyOverview.vue?vue&type=template&id=5c3666f8&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.alarm?_c("div",{staticClass:"analmoly-overview-page",staticStyle:{height:"auto","overflow-y":"scroll"}},[_c("div",{staticClass:"fc__layout__align fc__asset__main__header pT20 pB20 pL20 pR20",staticStyle:{width:"auto","align-items":"normal !important","border-bottom":"none"}},[_c("div",{staticClass:"fL"},[_c("div",{staticClass:"fc-id"},[_vm._v("#"+_vm._s(_vm.alarm.id))]),_c("div",[_c("div",{staticClass:"fc-black-22 textoverflow-height-ellipsis max-width700px"},[_vm._v(" "+_vm._s(_vm.alarm.subject?_vm.alarm.subject:"---")+" "),_vm.alarm.severity?_c("div",{staticClass:"text-uppercase inline vertical-middle mL15"},[_c("div",{staticClass:"uppercase secondary-color summaryseverityTag f11",style:{"background-color":_vm.getAlarmSeverity(_vm.alarm.severity.id).color}},[_vm._v(" "+_vm._s(_vm.alarm.severity.id?_vm.getAlarmSeverity(_vm.alarm.severity.id).displayName:"---")+" ")])]):_vm._e()])])]),_c("div",{staticClass:"fR mT15"},[_c("div",{staticClass:"display-flex"},[!_vm.alarm.acknowledged&&_vm.isActiveAlarm(_vm.alarm)&&_vm.$hasPermission("alarm:ACKNOWLEDGE_ALARM")?_c("el-button",{staticClass:"fc-btn-green-lg-fill",on:{click:function($event){return _vm.acknowledgeAlarms()}}},[_vm._v("Acknowledge")]):_vm.isActiveAlarm(_vm.alarm)?_c("div",{staticClass:"q-item-label mR10 status-btn2"},[_c("span",{staticClass:"pB10 fc-summary-ack ellipsis"},[_vm._v("Acknowledged by "+_vm._s(_vm.alarm.acknowledgedBy?_vm.$store.getters.getUser(_vm.alarm.acknowledgedBy.id).name:"Unknown"))]),_c("div",{staticClass:"text-right"},[_vm._v("   "),_c("span",{staticClass:"fc-summary-timeago text-right"},[_vm._v(_vm._s(_vm._f("fromNow")(_vm.alarm.acknowledgedTime>0?_vm.alarm.acknowledgedTime:new Date)))])])]):_c("div",{staticClass:"q-item-label fc-summary-ack status-btn1 pR10 pointer"},[_vm._v(" Unacknowledged ")]),_vm.isActiveAlarm(_vm.alarm)&&_vm.$hasPermission("alarm:CLEAR_ALARM")?_c("el-button",{staticClass:"fc-btn-green-lg-border",on:{click:function($event){return _vm.updateAlarmsStatus()}}},[_vm._v("CLEAR")]):_vm._e()],1)])]),_vm.alarmId&&!_vm.loading?_c("page",{key:_vm.alarmId,attrs:{module:_vm.currentModuleName,id:_vm.alarmId,details:_vm.details}}):_vm._e()],1):_vm._e()},staticRenderFns=[],objectSpread2=__webpack_require__(595082),PageBuilder=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(760218)),vuex_esm=__webpack_require__(420629),NewDateHelper=__webpack_require__(105534),AnomalyMixin=__webpack_require__(381056),validation=__webpack_require__(990260),AnomalyOverviewvue_type_script_lang_js={mixins:[AnomalyMixin/* default */.Z,NewDateHelper/* default */.Z],components:{Page:PageBuilder/* default */.Z},created:function(){this.$store.dispatch("loadTicketPriority"),this.$store.dispatch("loadTicketCategory"),this.$store.dispatch("loadAssetCategory"),this.$store.dispatch("loadAlarmSeverity"),this.loadAlarmDetails()},mounted:function(){},data:function(){return{currentModuleName:"mlAnomalyAlarm",loading:!1}},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapGetters */.Se)(["getAlarmSeverity"])),(0,vuex_esm/* mapActions */.nv)({addAlarmApi:"newAlarm/addAlarm",updateAlarmStatus:"newAlarm/updateAlarmStatus",notifyAlarm:"newAlarm/notifyAlarm",acknowledgeAlarm:"newAlarm/acknowledgeAlarm",severityStatus:function(state){return state.alarmSeverity},deleteAlarm:"newAlarm/deleteAlarm"})),{},{severityStatus:function(){return this.$store.state.alarmSeverity},alarm:function(){return this.$store.state.newAlarm.currentAlarm},occurrence:function(){return this.$store.state.newAlarm.currentOccurrence},alarmId:function(){return parseInt(this.$route.params.id)},details:function(){return{alarm:this.$store.state.newAlarm.currentAlarm,occurrence:this.occurrence,id:this.alarmId}}}),watch:{alarmId:function(newVal){this.loadAlarmDetails()},occurrence:{handler:function(value,oldValue){var _ref=value||{},id=_ref.id;if(!(0,validation/* isEmpty */.xb)(id)){var _ref2=oldValue||{},_ref2$id=_ref2.id,oldId=void 0===_ref2$id?null:_ref2$id;if(id!==oldId){var paramJson={};paramJson.alarmId=this.alarmId,paramJson.resourceId=this.alarm&&this.alarm.resource?this.alarm.resource.id:null,paramJson.siteId=this.alarm&&this.alarm.resource?this.alarm.resource.siteId:null,paramJson.dateRange=this.currMntNLastMntRanges,this.$store.dispatch("anomalies/getMetricsDetails",paramJson)}}},immediate:!0}},methods:{updateAlarmsStatus:function(){var clearSeverity=this.severityStatus.find((function(status){return"Clear"===status.severity})),context={severity:clearSeverity,occurrence:this.occurrence,alarm:this.alarm,clearedTime:Date.now()};this.updateAlarmStatus(context),this.alarm.clearedBy=this.$account.user},exportSummary:function(type){var _this=this;this.exportType=type,this.showAssetExport=!0,this.$util.loadAssetReadingFields(this.alarm.resource.id).then((function(fields){_this.assetFields=fields}))},isActiveAlarm:function(alarm){return"Clear"!==this.getAlarmSeverity(alarm.severity.id).severity},loadAlarmDetails:function(){var _this2=this;this.loading=!0,this.$store.dispatch("newAlarm/fetchAlarm",{id:parseInt(this.alarmId)}).then((function(){_this2.loading=!1})).catch((function(){_this2.loading=!1}))}}},anomalies_AnomalyOverviewvue_type_script_lang_js=AnomalyOverviewvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(anomalies_AnomalyOverviewvue_type_script_lang_js,render,staticRenderFns,!1,null,"5c3666f8",null)
/* harmony default export */,AnomalyOverview=component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/68706.js.map