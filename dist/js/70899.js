"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[70899],{
/***/929593:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FPagination}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/list/FPagination.vue?vue&type=template&id=7641710c&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_vm.total>0?_c("div",{staticClass:"flex-center-row-space mT-5",class:{"fc-black-small-txt-12":!_vm.hideToggle}},[_c("el-popover",{attrs:{placement:"bottom",trigger:"click",disabled:_vm.disablePopup}},[_c("span",{staticClass:"p8 pointer",class:[!_vm.disablePopup&&"button-hover"],attrs:{slot:"reference"},slot:"reference"},[_vm.from!==_vm.to?_c("span",[_vm._v(_vm._s(_vm.from)+" - ")]):_vm._e(),_c("span",[_vm._v(_vm._s(_vm.to))]),_vm._v(" of "+_vm._s(_vm.total)+" ")]),_c("el-pagination",{attrs:{layout:"prev, pager, next",total:_vm.total,"pager-count":5,"page-size":_vm.perPage,"current-page":_vm.page},on:{"current-change":_vm.handleCurrentChange,"update:pageSize":function($event){_vm.perPage=$event},"update:page-size":function($event){_vm.perPage=$event},"update:currentPage":function($event){_vm.page=$event},"update:current-page":function($event){_vm.page=$event}}})],1),_vm.hideToggle?_vm._e():_c("span",[_c("span",{staticClass:"el-icon-arrow-left pagination-arrow fc-black-small-txt-12 f16 fw-bold pointer p5",class:{disable:_vm.from<=1},on:{click:function($event){_vm.from>1&&_vm.prev()}}}),_c("span",{staticClass:"el-icon-arrow-right pagination-arrow fc-black-small-txt-12 f16 fw-bold pointer p5",class:{disable:_vm.to===_vm.total},on:{click:function($event){_vm.to!==_vm.total&&_vm.next()}}})])],1):_vm._e()])},staticRenderFns=[],router=(__webpack_require__(879288),__webpack_require__(670560),__webpack_require__(329435)),FPaginationvue_type_script_lang_js={props:{total:[Number,String],perPage:Number,hideToggle:{type:Boolean,default:!1},pageNo:Number,hidePopover:{type:Boolean,default:!1}},data:function(){return{from:0,to:0,page:1}},created:function(){(0,router/* isWebTabsEnabled */.tj)()&&document.addEventListener("keydown",this.keyDownHandler)},mounted:function(){this.init()},beforeDestroy:function(){(0,router/* isWebTabsEnabled */.tj)()&&document.removeEventListener("keydown",this.keyDownHandler)},computed:{pageQuery:function(){var _ref=this.$route||{},query=_ref.query,_ref2=query||{},page=_ref2.page;return parseInt(page)||1},hasMorePage:function(){return this.total/this.perPage>1},disablePopup:function(){return this.hidePopover||!this.hasMorePage}},watch:{total:function(){this.init()},pageQuery:function(){this.init()}},methods:{init:function(){if(this.page=this.pageQuery,this.from=(this.page-1)*this.perPage+1,this.from>this.total&&this.from&&this.from>0&&this.total&&this.total>0)this.reset();else{var to=this.from+this.perPage-1;this.to=this.total>to?to:this.total}},handleCurrentChange:function(val){this.page=val,this.from=(this.page-1)*this.perPage+1,this.to=this.total>=this.from+this.perPage?this.from+this.perPage-1:this.total,this.setPage()},next:function(){this.from=this.to+1,this.to+=this.perPage,this.to>this.total&&(this.to=this.total),this.page++,this.setPage()},prev:function(){this.to=this.from-1,this.from-=this.perPage,this.from<=1?this.from=this.page=1:this.page--,this.setPage()},reset:function(){this.page=1,this.setPage(!0)},setPage:function(isReset){if(this.pageNo)this.$emit("onPageChanged",this.page);else{var query={};Object.assign(query,this.$route.query),query?query.page=this.page:query={page:this.page},this.$router.push({query:query}),isReset||this.$emit("onPageChanged",this.page)}},keyDownHandler:function(e){e.shiftKey&&("ArrowRight"===e.key&&this.to!==this.total?this.next():"ArrowLeft"===e.key&&this.from>1&&this.prev())}}},list_FPaginationvue_type_script_lang_js=FPaginationvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(list_FPaginationvue_type_script_lang_js,render,staticRenderFns,!1,null,"7641710c",null)
/* harmony default export */,FPagination=component.exports},
/***/455099:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return ControlPointsList}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/controls/ControlPoints/ControlPointsList.vue?vue&type=template&id=bca996ca
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"height100 controlpointlist-page"},[_c("div",{staticClass:"position-relative",staticStyle:{"z-index":"600"}},[_c("portal",{key:"controllistpage",attrs:{to:"controlpagenation",slim:""}},[_c("el-tooltip",{attrs:{effect:"dark",content:_vm.$t("common._common.search"),placement:"left"}},[_c("div",[_c("i",{staticClass:"el-icon-search control-point-search fc-black-2 contr f16 pointer fw-bold mR10",on:{click:function($event){return $event.stopPropagation(),_vm.toggleQuickSearch()}}})])]),_c("pagination",{staticStyle:{"margin-top":"14px"},attrs:{perPage:_vm.perPage,total:_vm.listCount}})],1),_c("div",{directives:[{name:"show",rawName:"v-show",value:_vm.showQuickSearch,expression:"showQuickSearch"}],staticClass:"fc-black-small-txt-12 fc-subheader-right-search controlpoints-search fR"},[_c("new-search",{attrs:{config:_vm.filterConfig,showSearch:_vm.showQuickSearch,defaultFilter:_vm.defaultFilter},on:{hideSearch:function($event){_vm.showQuickSearch=!1}}}),_c("div",{staticClass:"filter-search-close"})],1),null!==_vm.appliedFilters&&_vm.showtag?_c("div",{staticClass:"fL",staticStyle:{width:"84%"}},[_c("new-tag",{staticClass:"layout-new-tag control-points-layout-new-tag",attrs:{config:_vm.filterConfig,filters:_vm.appliedFilters,specialOperatorHandling:"true",showFilterAdd:_vm.showAddFilter,showCloseIcon:!0}}),Object.keys(_vm.appliedFilters).length>"0"?_c("div",{staticClass:"clear-filter pointer control-clear-btn",staticStyle:{top:"13px !important"},on:{click:function($event){return _vm.resetFilters()}}},[_vm._v(" "+_vm._s(_vm.$t("common._common.clear_all_filters"))+" ")]):_vm._e()],1):_vm._e()],1),-1===_vm.openControlId?_c("div",{staticClass:"fc-list-view p10 pT0 mT10 fc-list-table-container height100vh fc-table-td-height fc-table-viewchooser pB100 block",class:_vm.$route.query.search?"fc-list-table-search-scroll":""},[_vm.loading?_c("div",{staticClass:"flex-middle fc-empty-white"},[_c("spinner",{attrs:{show:_vm.loading,size:"80"}})],1):_c("div",[_c("el-table",{attrs:{data:_vm.controlpointsload,width:"100%",height:"auto",type:"index",index:_vm.indexMethod,fit:!0}},[_c("template",{slot:"empty"},[_c("img",{staticClass:"mT50",attrs:{src:__webpack_require__(15482),width:"100",height:"100"}}),_c("div",{staticClass:"mT10 label-txt-black f14 op6"},[_vm._v(" "+_vm._s(_vm.$t("common.products.no_control_points_available"))+" ")])]),_c("el-table-column",{attrs:{fixed:"",label:_vm.$t("common._common._asset"),"min-width":"260",prop:""},scopedSlots:_vm._u([{key:"default",fn:function(scope){return[_c("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"top",animation:"shift-away",arrow:!0},expression:"{\n                placement: 'top',\n                animation: 'shift-away',\n                arrow: true,\n              }"}],staticClass:"max-width300px textoverflow-ellipsis",attrs:{title:scope.row.resourceContext.name}},[_vm._v(" "+_vm._s(scope.row.resourceContext.name)+" ")])]}}],null,!1,1827528185)}),_c("el-table-column",{attrs:{fixed:"",label:_vm.$t("common._common._asset_category"),"min-width":"200",prop:""},scopedSlots:_vm._u([{key:"default",fn:function(scope){return[_vm._v(" "+_vm._s(scope.row.resourceContext.category.displayName)+" ")]}}],null,!1,2613709253)}),_c("el-table-column",{attrs:{label:_vm.$t("common.tabs._reading"),width:"200",prop:""},scopedSlots:_vm._u([{key:"default",fn:function(scope){return[_c("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"top",animation:"shift-away",arrow:!0},expression:"{\n                placement: 'top',\n                animation: 'shift-away',\n                arrow: true,\n              }"}],staticClass:"textoverflow-ellipsis",staticStyle:{"max-width":"200px"},attrs:{title:scope.row.field.displayName}},[_vm._v(" "+_vm._s(scope.row.field.displayName)+" ")])]}}],null,!1,688463293)}),_c("el-table-column",{attrs:{label:_vm.$t("common.header.last_recorded_value"),width:"210",prop:""},scopedSlots:_vm._u([{key:"default",fn:function(scope){return[_vm._v(" "+_vm._s(Math.round(scope.row.value).toFixed(1))+_vm._s(scope.row.field.unit)+" ")]}}],null,!1,3864604340)}),_c("el-table-column",{attrs:{label:_vm.$t("common.header.last_recorded_time"),width:"200",prop:""},scopedSlots:_vm._u([{key:"default",fn:function(scope){return[_vm._v(" "+_vm._s(_vm._f("formatDate")(scope.row.ttime))+" ")]}}],null,!1,656010674)}),_c("el-table-column",{attrs:{label:_vm.$t("common._common._is_sandbox"),width:"150",prop:""},scopedSlots:_vm._u([{key:"default",fn:function(scope){return[_c("el-switch",{staticClass:"Notification-toggle",attrs:{"active-value":1,"inactive-value":2,"active-color":"rgba(57, 178, 194, 0.8)","inactive-color":"#e5e5e5"},on:{change:function($event){return _vm.changestatus(scope.row,scope.row.controlActionMode)}},model:{value:scope.row.controlActionMode,callback:function($$v){_vm.$set(scope.row,"controlActionMode",$$v)},expression:"scope.row.controlActionMode"}})]}}],null,!1,4120035413)}),_c("el-table-column",{staticClass:"visibility-visible-actions",attrs:{label:"",width:"180",prop:""},scopedSlots:_vm._u([{key:"default",fn:function(scope){return[_vm.canShowCommandButton?_c("button",{staticClass:"fc__border__btn visibility-hide-actions",staticStyle:{padding:"5px 16px"},on:{click:function($event){return _vm.setdialogShow(scope.row)}}},[_vm._v(" "+_vm._s(_vm.$t("common.header._command"))+" ")]):_vm._e()]}}],null,!1,3646922680)})],2)],1)]):_vm._e(),_c("el-dialog",{staticClass:"setpoint-dialog fc-dialog-center-container fc-dialog-center-container",attrs:{title:_vm.$t("common.header.command_value"),visible:_vm.controlPopup.visible,width:"30%","before-close":_vm.handleClose},on:{"update:visible":function($event){return _vm.$set(_vm.controlPopup,"visible",$event)}}},[_c("div",[_c("div",{staticClass:"fc-input-label-txt"},[_vm._v(_vm._s(_vm.$t("common.header.command")))]),_c("el-input",{staticClass:"fc-input-full-border2 width100",attrs:{placeholder:_vm.$t("common._common.please_enter_value"),type:"number"},model:{value:_vm.controlPopup.setVal,callback:function($$v){_vm.$set(_vm.controlPopup,"setVal",$$v)},expression:"controlPopup.setVal"}})],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){_vm.controlPopup.visible=!1}}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.controlPopup.saving},on:{click:_vm.saveReading}},[_vm._v(_vm._s(_vm.controlPopup.saving?_vm.$t("common.products.setting"):_vm.$t("common.header.command")))])],1)])],1)},staticRenderFns=[],objectSpread2=__webpack_require__(595082),validation=(__webpack_require__(564043),__webpack_require__(61514),__webpack_require__(169358),__webpack_require__(670560),__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(434284),__webpack_require__(648324),__webpack_require__(634338),__webpack_require__(990260)),router=__webpack_require__(329435),FPagination=__webpack_require__(929593),NewSearch=__webpack_require__(521816),vuex_esm=__webpack_require__(420629),NewTag=__webpack_require__(588633),ControlPointsListvue_type_script_lang_js={data:function(){return{showAddFilter:!1,showtag:!1,defaultFilter:"fieldId",listCount:"",filterConfig:{includeParentCriteria:!0,path:"/app/co/cp/",data:{fieldId:{label:this.$t("common.tabs.reading"),displayType:"select",options:{},value:[]},asset:{label:this.$t("common._common.asset"),displayType:"select",options:{},value:[],key:"resourceId"},controlActionMode:{label:this.$t("common._common._is_sandbox"),displayType:"select",options:{1:"Yes",2:"No"},operatorId:9,value:""},ttime:{label:this.$t("common.header._last_recorded_time"),displayType:"select",single:!0,type:"date",customdate:!0,options:{"1_40":"Within 1 Hour","12_40":"Within 12 Hours","24_40":"Within 24 Hours",22:"Today",25:"Yesterday",31:"This Week",28:"This Month",27:"Last Month","2_39":"Last 2 Months","6_39":"Last 6 Months"},value:""}}},controlpointsload:[],showQuickSearch:!1,loading:!0,totalCount:null,tableData:[],dialogVisible:!1,newReadingValue:null,selectedScope:null,perPage:50,controlPopup:{visible:!1,controlConfig:{resourceId:null,fieldId:null,value:null},setVal:null,saving:!1}}},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({controls:function(state){return state.control.controls}})),(0,vuex_esm/* mapGetters */.Se)({getTabByTabId:"webtabs/getTabByTabId",tabHasPermission:"webtabs/tabHasPermission"})),{},{page:function(){return this.$route.query.page||1},filters:function(){var $route=this.$route,_ref=$route||{},search=_ref.query.search;return(0,validation/* isEmpty */.xb)(search)?null:JSON.parse(this.$route.query.search)},openControlId:function(){return this.$route.params.id?parseInt(this.$route.params.id):-1},appliedFilters:function(){var query=this.$route.query,_ref2=query||{},search=_ref2.search;return search?JSON.parse(search):null},canShowCommandButton:function(){var canShowCommand=!1,moduleName="asset";if((0,router/* isWebTabsEnabled */.tj)()){var _findTab=(0,router/* findTab */.DU)(router/* tabTypes */.VF.MODULE,{moduleName:moduleName}),tabId=_findTab.tabId;if(!(0,validation/* isEmpty */.xb)(tabId)){var assetWebTab=this.getTabByTabId(tabId);canShowCommand=this.tabHasPermission("CONTROL",assetWebTab)}}else canShowCommand=this.$hasPermission("asset:CONTROL");return canShowCommand}}),mounted:function(){this.loadControlPoints(),this.loadCount(),this.loadControlPointsCount(),this.setOptionsForAssets()},watch:{page:function(){this.loadControlPoints()},filters:{handler:function(newVal,oldVal){newVal!==oldVal&&(this.loadControlPoints(),this.loadControlPointsCount())}},appliedFilters:{handler:function(newVal,oldVal){if(newVal!==oldVal){var query=this.$route.query,_ref3=query||{},search=_ref3.search;this.$router.push({query:{search:search,includeParentFilter:"true"}})}}}},components:{Pagination:FPagination/* default */.Z,NewSearch:NewSearch/* default */.Z,NewTag:NewTag/* default */.Z},methods:{setOptionsForAssets:function(){var _this=this;this.showtag=!1;var url="v2/controlAction/getControllableAssets";this.$http.get(url).then((function(response){200===response.status&&(response.data&&response.data.result&&response.data.result.controllableResources&&response.data.result.controllableResources.forEach((function(asset){_this.filterConfig.data.resourceId.options[asset.id]=asset.name})),_this.setOptionsForResources())}))},setOptionsForResources:function(){var _this2=this,url="v2/controlAction/getControllableFields";this.$http.get(url).then((function(response){200===response.status&&response.data&&response.data.result&&response.data.result.controllableFields&&(response.data.result.controllableFields.forEach((function(field){_this2.filterConfig.data.fieldId.options[field.id]=field.displayName})),_this2.showtag=!0)}))},toggleQuickSearch:function(){this.showQuickSearch=!this.showQuickSearch},resetFilters:function(){this.$router.push({path:"/app/co/cp/controlpoints"})},loadControlPointsCount:function(){var params,_this3=this,queryObj={filters:this.filters,includeParentFilter:!0,fetchCount:!0},url="v2/controlAction/getControllablePoints";params="fetchCount="+queryObj.fetchCount,queryObj.filters&&(params=params+"&filters="+encodeURIComponent(JSON.stringify(queryObj.filters))),queryObj.includeParentFilter&&(params=params+"&includeParentFilter="+queryObj.includeParentFilter),url=url+"?"+params,this.$http.get(url).then((function(response){200===response.status&&(_this3.listCount=response.data.result.readingDataMetaCount?response.data.result.readingDataMetaCount:"")}))},loadControlPoints:function(){var _this4=this,filters=this.filters,self=this;self.loading=!0;var url="v2/controlAction/getControllablePoints?page=".concat(this.page,"&perPage=").concat(this.perPage);filters&&(url+="&filters=".concat(encodeURIComponent(JSON.stringify(filters)),"&includeParentFilter=true")),this.$http.get(url).then((function(response){200===response.status&&(_this4.controlpointsload=response.data.result.controllablePoints?response.data.result.controllablePoints:[],_this4.loading=!1)}))},handleClose:function(){this.controlPopup.visible=!1},indexMethod:function(index){return 2*index},setdialogShow:function(scopeRow){this.selectedScope=scopeRow,this.controlPopup.visible=!0},loadCount:function(){var _this5=this;this.$http.get("/v2/controlAction/getControllablePoints?viewName=all&fetchCount=true").then((function(response){0===response.data.responseCode?_this5.totalCount=response.data.result.count:_this5.totalCount=null})).catch((function(){return _this5.totalCount=null}))},changestatus:function(scopeRow,controlActionMode){var jsonParams={rdm:{resourceId:scopeRow.resourceId,fieldId:scopeRow.fieldId,controlActionMode:controlActionMode}},self=this;self.$http.post("/v2/controlAction/updateRDM",jsonParams).then((function(response){var res=response.data.result;res&&res.rdm&&self.$message.success("Switched to "+(1===res.rdm.controlActionMode?"Sand Box":"Live")+" status successfully.")})).catch((function(error){}))},saveReading:function(){this.controlPopup.saving=!0,this.$util.setReadingValue(this.selectedScope.resourceId,this.selectedScope.fieldId,this.controlPopup.setVal,null,null),this.controlPopup.saving=!1,this.controlPopup.visible=!1}}},ControlPoints_ControlPointsListvue_type_script_lang_js=ControlPointsListvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(ControlPoints_ControlPointsListvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,ControlPointsList=component.exports},
/***/15482:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"img/noData-light.3b5d6592.png";
/***/}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/70899.js.map