(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[51349],{
/***/451349:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return NewBuildingAnalysis}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/energy/analytics/newTools/NewBuildingAnalysis.vue?vue&type=template&id=1a956227
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{key:_vm.$route.path,staticClass:"fc-energy-building-analysis"},[_c("div",{staticClass:"report-main-con"},[_c("div",{},[_c("f-report-options",{staticClass:"analytics-page-options-building-analysis fc-v1-portfolio-anlaysis",attrs:{isActionsDisabled:_vm.isActionsDisabled,optionClass:"analytics-page-options",optionsToEnable:[5,1,2],reportObject:_vm.reportObject,resultObject:_vm.resultObject,params:_vm.reportObject?_vm.reportObject.params:null,savedReport:_vm.analyticsConfig.savedReport,pdf:!1},on:{"update:savedReport":function($event){return _vm.$set(_vm.analyticsConfig,"savedReport",$event)},"update:saved-report":function($event){return _vm.$set(_vm.analyticsConfig,"savedReport",$event)}}})],1),_c("div",{staticClass:"report-sidebar-con"},[_vm.hideSideBar?_vm._e():_c("div",{class:{"new-report-sidebar fc-new-report-sidebar col-3 pT0":!_vm.hideSideBar}},[_c("div",{directives:[{name:"show",rawName:"v-show",value:_vm.showgeneratedata,expression:"showgeneratedata"}],staticClass:"report-sidebar-inner"},[_c("div",{staticClass:"analytics-header"},[_c("div",{directives:[{name:"show",rawName:"v-show",value:!_vm.showChartCustomization,expression:"!showChartCustomization"}],staticClass:"add-points-block"},[_c("el-button-group",{staticClass:"mL0"},[_c("el-button",{staticClass:"report_building_add_point_text report_building_add_point_layout setup-el-btn add-points-btn-first-child pR20 pL20",attrs:{type:"primary"},on:{click:_vm.PointSelector}},[_c("i",{staticClass:"el-icon-circle-plus-outline f20 bold pR5 vertical-sub"}),_vm._v(_vm._s(_vm.$t("common.reports.add_points")))]),_vm.reportObject&&[1,"reading",11].includes(_vm.analyticsMode)&&_vm.analyticsConfig.dataPoints.length>0?_c("el-tooltip",{attrs:{effect:"dark",content:_vm.$t("common.products.add_derivation"),placement:"bottom"}},[_c("span",[_vm.reportObject&&[1,"reading",11].includes(_vm.analyticsMode)&&_vm.analyticsConfig.dataPoints.length>0?_c("el-button",{staticClass:"add-points-btn mL20 pL12 pR12",attrs:{type:"primary"},on:{click:function($event){_vm.showDerivation=!0}}},[_c("img",{attrs:{src:__webpack_require__(857539),width:"15px",height:"15px"}})]):_vm._e()],1)]):[1,"reading",11].includes(_vm.analyticsMode)?_c("el-tooltip",{attrs:{effect:"dark",content:_vm.$t("common.dialog.add_at_least_one_datapoint_to_create_derivation"),placement:"bottom"}},[_c("span",[_c("el-button",{staticClass:"add-points-btn mL20 pL12 pR12",attrs:{type:"primary",disabled:!0},on:{click:function($event){_vm.showDerivation=!0}}},[_c("img",{attrs:{src:__webpack_require__(857539),width:"15px",height:"15px"}})])],1)]):_c("el-tooltip",{attrs:{effect:"dark",content:_vm.$t("common.dialog.set_dimension_as_time_to_create_a_derivation"),placement:"bottom"}},[_c("span",[_c("el-button",{staticClass:"add-points-btn mL20 pL12 pR12",attrs:{type:"primary",disabled:![1,"reading",11].includes(_vm.analyticsMode)},on:{click:function($event){_vm.showDerivation=!0}}},[_c("img",{attrs:{src:__webpack_require__(857539),width:"15px",height:"15px"}})])],1)])],1)],1)]),_c("div",{staticClass:"analytics-body p20 clearboth"},[_c("div",{staticClass:"report_building_inputbox"},[_c("span",{staticStyle:{"font-weight":"500"}},[_vm._v(_vm._s(_vm.$t("common.reports.general_settings")))])]),_c("el-row",{staticClass:"mT20"},[_c("el-col",{staticClass:"report_building_inputbox",attrs:{span:24}},[_c("div",{staticClass:"pB5"},[_vm._v(" "+_vm._s(_vm.$t("home.reports.dimension"))+" ")]),_c("el-select",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"period-select width100 fc-input-full-border2 ",attrs:{placeholder:_vm.$t("common._common.mode"),title:_vm.$t("common._common.mode"),"data-arrow":"true"},on:{change:_vm.onModeChange},model:{value:_vm.analyticsMode,callback:function($$v){_vm.analyticsMode=$$v},expression:"analyticsMode"}},[_c("el-option",{attrs:{label:_vm.$t("common.wo_report.time"),value:1}}),_c("el-option",{attrs:{label:_vm.$t("common.tabs.reading"),value:"reading"}}),_c("el-option",{attrs:{label:_vm.$t("common._common.asset"),value:8}}),_c("el-option",{attrs:{label:_vm.$t("common._common.floor"),value:9}}),_c("el-option",{attrs:{label:_vm.$t("common.space_asset_chooser.space"),value:10}}),_c("el-option",{attrs:{label:_vm.$t("common.dashboard.time_duration"),value:11}}),_c("el-option",{attrs:{label:_vm.$t("common.header.m&v"),value:"mv"}})],1)],1)],1),"reading"===_vm.analyticsMode?_c("el-row",{staticClass:"mT20"},[_c("el-col",{staticClass:"report_building_inputbox",attrs:{span:22}},[_c("div",{staticClass:"pB5"},[_vm._v(" "+_vm._s(_vm.$t("common.tabs.reading"))+" ")]),_c("el-select",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"period-select width100 fc-input-full-border2 ",attrs:{disabled:_vm.analyticsConfig.dataPoints.length<=1&&_vm.enableReadingSelection,placeholder:_vm.$t("common.tabs.reading"),title:_vm.$t("common.tabs.reading"),"data-arrow":"true"},on:{change:_vm.OnXdatapointChange},model:{value:_vm.analyticsConfig.dimensionDataPoint,callback:function($$v){_vm.$set(_vm.analyticsConfig,"dimensionDataPoint",$$v)},expression:"analyticsConfig.dimensionDataPoint"}},_vm._l(_vm.analyticsConfig.dataPoints,(function(datapoint,index){return _c("el-option",{key:index,attrs:{label:datapoint.name,value:index}})})),1)],1),_c("el-col",{attrs:{span:2}},[_c("div",{staticClass:"pointer z-20",on:{click:function($event){_vm.showHeatMapPointSelector=!0}}},[_c("inline-svg",{staticClass:"vertical-middle mT30 mL10",attrs:{src:"svgs/add-circled",iconClass:"icon icon-md icon-add"}})],1)])],1):_vm._e(),11===_vm.analyticsMode?_c("el-row",[_c("el-col",{staticClass:"mT20 report_building_inputbox",attrs:{span:24}},[_c("div",{staticClass:"pB5"},[_vm._v(" "+_vm._s(_vm.$t("common.tabs.reading"))+" ")]),_c("el-select",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"period-select width100 fc-input-full-border2 ",attrs:{placeholder:_vm.$t("common.tabs.reading"),title:_vm.$t("common.tabs.reading"),"data-arrow":"true"},on:{change:_vm.OnXdatapointChange},model:{value:_vm.analyticsConfig.dimensionDataPoint,callback:function($$v){_vm.$set(_vm.analyticsConfig,"dimensionDataPoint",$$v)},expression:"analyticsConfig.dimensionDataPoint"}},_vm._l(_vm.analyticsConfig.dataPoints.filter((function(dp){return 4===dp.yAxis.dataType||8===dp.yAxis.dataType})),(function(datapoint,index){return _c("el-option",{key:index,attrs:{label:datapoint.name,value:index}})})),1)],1)],1):_vm._e(),[1,"reading",11].includes(_vm.analyticsConfig.mode)?_vm._e():_c("el-row",[_c("el-col",{staticClass:"mT20",attrs:{span:24}},[_c("div",{staticClass:"fc-text-pink fw6"},[_vm._v(" "+_vm._s(_vm.$t("common._common.sorting"))+" ")]),_c("div",{staticClass:"mT15"},[_c("el-form",{ref:"reportSortingForm",attrs:{model:_vm.analyticsConfig.sorting,"label-position":"top"}},[_vm.resultObject&&_vm.resultObject.report.dataPoints.length>1?_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"sortByField"}},[_c("div",{staticClass:"label-txt-black pB5 label-line-height"},[_vm._v(" "+_vm._s(_vm.$t("common._common.sort_by"))+" ")]),_c("el-select",{staticClass:"period-select width100 fc-input-full-border2 ",staticStyle:{width:"90%"},model:{value:_vm.analyticsConfig.sorting.sortByField,callback:function($$v){_vm.$set(_vm.analyticsConfig.sorting,"sortByField",$$v)},expression:"analyticsConfig.sorting.sortByField"}},_vm._l(_vm.resultObject.report.dataPoints,(function(dp,index){return _c("el-option",{key:index,attrs:{label:dp.name,value:dp.yAxis.fieldId}})})),1)],1)],1)],1):_vm._e(),_vm.show?_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"orderByFunc"}},[_c("div",{staticClass:"label-txt-black pB5 label-line-height"},[_vm._v(" "+_vm._s(_vm.$t("common._common.sort_order"))+" ")]),_c("el-select",{staticClass:"period-select width100 fc-input-full-border2 ",staticStyle:{width:"90%"},model:{value:_vm.analyticsConfig.sorting.orderByFunc,callback:function($$v){_vm.$set(_vm.analyticsConfig.sorting,"orderByFunc",$$v)},expression:"analyticsConfig.sorting.orderByFunc"}},[_c("el-option",{attrs:{label:_vm.$t("common._common.ascending"),value:2}}),_c("el-option",{attrs:{label:_vm.$t("common._common.descending"),value:3}})],1)],1)],1)],1):_vm._e(),_vm.show?_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"limit"}},[_c("div",{staticClass:"label-txt-black pB5 label-line-height"},[_vm._v(" "+_vm._s(_vm.$t("common._common.limit"))+" ")]),_c("el-select",{staticClass:"period-select width100 fc-input-full-border2 ",staticStyle:{width:"90%"},model:{value:_vm.analyticsConfig.sorting.limit,callback:function($$v){_vm.$set(_vm.analyticsConfig.sorting,"limit",$$v)},expression:"analyticsConfig.sorting.limit"}},_vm._l(20,(function(i){return i>=3?_c("el-option",{key:i,attrs:{label:i,value:i}}):_vm._e()})),1)],1)],1)],1):_vm._e()],1)],1)])],1),1===_vm.analyticsConfig.mode||"reading"===_vm.analyticsConfig.mode?_c("el-row",[_c("el-col",{staticClass:"mT20 report_building_inputbox",attrs:{span:24}},[_c("div",{staticClass:"pB5"},[_vm._v(" "+_vm._s(_vm.$t("common.dashboard.time_period"))+" ")]),_c("el-select",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"period-select width100 fc-input-full-border2 ",attrs:{placeholder:_vm.$t("common.wo_report.period"),title:_vm.$t("common.dashboard.time_period"),"data-arrow":"true"},on:{change:_vm.onPeriodChange},model:{value:_vm.analyticsConfig.period,callback:function($$v){_vm.$set(_vm.analyticsConfig,"period",$$v)},expression:"analyticsConfig.period"}},_vm._l(_vm.getAvailablePeriods,(function(period,index){return _c("el-option",{key:index,attrs:{label:period.name,value:period.value,disabled:!period.enable}})})),1)],1)],1):_vm._e(),_c("div",{staticClass:"mT25 report_building_inputbox_divider"}),_vm.baseLineList&&!_vm.isActionsDisabled?_c("div",{staticClass:"mT20"},[_c("div",{staticClass:"report_building_inputbox"},[_c("span",{staticStyle:{"font-weight":"500"}},[_vm._v(" "+_vm._s(_vm.$t("common.reports.comparsion_indicator")))])]),_vm.baseLineList&&!_vm.isActionsDisabled?_c("el-row",{staticClass:"mT10"},[_c("el-col",{staticClass:"mT10 report_building_inputbox",attrs:{span:24}},[_c("div",{staticClass:"pB5"},[_vm._v(" "+_vm._s(_vm.$t("common.reports.compare_with"))+" ")]),_c("el-cascader",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"period-select fc-input-full-border2 width100",attrs:{placeholder:_vm.$t("common.wo_report.compare_to"),options:_vm.baseLineCasecaderOptions,value:_vm.analyticsConfig.baseLine,title:_vm.$t("common.wo_report.compare_with_baseline"),"data-arrow":"true"},on:{change:_vm.onBaseLineChange}})],1)],1):_vm._e(),_vm.isShowCompareIndicator&&_vm.reportObject&&_vm.reportObject.options&&!["pie","donut","gauge"].includes(_vm.reportObject.options.type)?_c("el-row",{staticClass:"mT10"},[_c("el-col",{staticClass:"mT10 report_building_inputbox",attrs:{span:24}},[_c("div",{staticClass:"pB5"},[_vm._v(" "+_vm._s(_vm.$t("common.reports.compare_indicator_on_value"))+" ")]),_c("div",{staticClass:"mT10"},[_c("el-radio",{attrs:{label:1},on:{change:_vm.compareIndicatorChange},model:{value:_vm.compare_indicator,callback:function($$v){_vm.compare_indicator=$$v},expression:"compare_indicator"}},[_vm._v(_vm._s(_vm.$t("common.reports.positive")))]),_c("el-radio",{attrs:{label:2},on:{change:_vm.compareIndicatorChange},model:{value:_vm.compare_indicator,callback:function($$v){_vm.compare_indicator=$$v},expression:"compare_indicator"}},[_vm._v(_vm._s(_vm.$t("common.reports.negative")))])],1)])],1):_vm._e()],1):_vm._e(),[8,10,11,12,17,18,19,25].includes(_vm.analyticsConfig.period)&&!_vm.hasBooleanEnumPoints&&1===_vm.analyticsMode?_c("el-row",[_c("el-col",{staticClass:"mT20 report_building_inputbox",attrs:{span:24}},[_c("div",{staticClass:"pB5"},[_vm._v(" "+_vm._s(_vm.$t("common.header.group_by"))+" ")]),_c("el-select",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"period-select width100 fc-input-full-border2 ",attrs:{placeholder:_vm.$t("common.wo_report.period"),title:_vm.$t("common.dashboard.time_period"),"data-arrow":"true"},model:{value:_vm.analyticsConfig.groupByTimeAggr,callback:function($$v){_vm.$set(_vm.analyticsConfig,"groupByTimeAggr",$$v)},expression:"analyticsConfig.groupByTimeAggr"}},_vm._l(_vm.getAvailableGroupAggr,(function(period,index){return _c("el-option",{key:index,attrs:{label:period.name,value:period.value,disabled:!period.enable}})})),1)],1)],1):_vm._e(),1!==_vm.analyticsConfig.mode&&"reading"!==_vm.analyticsConfig.mode||_vm.hideFilterDynamic||!_vm.isFilterActive?_vm._e():_c("div",[_c("div",{staticClass:"mT25 report_building_inputbox_divider"}),_c("div",{staticClass:"pR5"},[_c("el-row",{directives:[{name:"show",rawName:"v-show",value:_vm.isFilterActive,expression:"isFilterActive"}],staticClass:"clearboth pT20"},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"fL"},[_c("div",{staticClass:"label-txt-black f14 pB5"},[_vm._v(" "+_vm._s(_vm.$t("common.products.user_filters"))+" ")])])])],1),_c("div",[_c("el-row",{directives:[{name:"show",rawName:"v-show",value:_vm.isFilterActive,expression:"isFilterActive"}],staticClass:"mT10"},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"flex-middle justify-content-space"},[_c("div",{staticClass:"flex-middle"},[_c("el-checkbox",{staticClass:"mR10",attrs:{disabled:!_vm.isFilterActive},model:{value:_vm.filterToggle,callback:function($$v){_vm.filterToggle=$$v},expression:"filterToggle"}}),_c("div",{staticClass:"label-txt-black fw4 pR5"},[_vm._v(" "+_vm._s(_vm.filterTitle)+" ")])],1),_c("div",{staticClass:"pointer"},[_c("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"top",arrow:!0,animation:"shift-away"},expression:"{\n                              placement: 'top',\n                              arrow: true,\n                              animation: 'shift-away',\n                            }"}],staticClass:"fc-dark-blue4-12 pointer",attrs:{title:"Edit"},on:{click:function($event){return _vm.openFilter()}}},[_vm._v(" "+_vm._s(null===_vm.analyticsConfig.template||"undefined"===typeof _vm.analyticsConfig.template?"Add":"Edit")+" ")])])])])],1)],1)],1)]),!_vm.reportObject||1!==_vm.analyticsConfig.mode&&"reading"!==_vm.analyticsConfig.mode?_vm._e():_c("div",[_c("el-row",[_c("el-col",{staticClass:"mT20",attrs:{span:24}},[_c("div",{staticClass:"fL"},[_c("div",{staticClass:"label-txt-black f14 pB5"},[_vm._v(" "+_vm._s(_vm.$t("common.products.trendline"))+" ")])])])],1),_c("el-row",{staticClass:"mT10"},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"flex-middle justify-content-space"},[_c("div",{staticClass:"flex-middle"},[_c("el-checkbox",{staticClass:"mR10",on:{change:function($event){return _vm.openTrendLineDialog()}},model:{value:_vm.reportObject.options.trendLine.enable,callback:function($$v){_vm.$set(_vm.reportObject.options.trendLine,"enable",$$v)},expression:"reportObject.options.trendLine.enable"}}),_c("div",{staticClass:"label-txt-black fw4 pR5"},[_vm._v(" "+_vm._s(_vm.$t("common._common.enable"))+" ")])],1),_vm.reportObject.options.trendLine.enable?_c("div",{staticClass:"pointer"},[_c("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"top",arrow:!0,animation:"shift-away"},expression:"{\n                          placement: 'top',\n                          arrow: true,\n                          animation: 'shift-away',\n                        }"}],staticClass:"fc-dark-blue4-12 pointer",attrs:{title:"Edit"},on:{click:function($event){return _vm.openTrendLineDialog()}}},[_vm._v(" "+_vm._s(_vm.$t("common._common.edit"))+" ")])]):_vm._e()])])],1)],1)],1)])]),_vm.hideSideBar?_vm._e():_c("div",{class:{"new-chart-custom fc-new-portfolio-chart-custom":!_vm.hideSideBar}},[_vm.reportObject?_c("div",{directives:[{name:"show",rawName:"v-show",value:_vm.showChartCustomization,expression:"showChartCustomization"}],staticClass:"customize-container building-customize-container col-3 fc-new-portfolio-cus",staticStyle:{top:"0px"}},[_c("div",{staticClass:"customize-header"},[_c("div",{staticClass:"customize-H"},[_vm._v(" "+_vm._s(_vm.$t("home.reports.chart_customization"))+" ")])]),_c("div",{staticClass:"customize-body fc-customize-body"},[_vm.reportObject?_c("f-chart-customization",{directives:[{name:"show",rawName:"v-show",value:_vm.showChartCustomization,expression:"showChartCustomization"}],attrs:{report:_vm.reportObject,resultDataPoints:_vm.resultObject?_vm.resultObject.report.dataPoints:[],config:_vm.analyticsConfig},on:{close:function($event){_vm.showChartCustomization=!1,_vm.showgeneratedata=!0},resetPoints:_vm.resetDataPointSelector}}):_vm._e()],1)]):_vm._e()]),[1,"reading",11].includes(_vm.analyticsMode)?_c("f-data-point-selector",{ref:"building-selector",attrs:{savedPoints:(_vm.analyticsConfig.savedReport||this.$route.query.filters||this.analyticsConfig.template)&&_vm.resultObject?_vm.dataPointSummaryList:null,visibility:_vm.showDataPointSelector,zones:_vm.zones,isSiteAnalysis:_vm.isSiteAnalysis,reportObject:_vm.reportObject,templateFilterToggle:_vm.filterToggle},on:{"update:visibility":function($event){_vm.showDataPointSelector=$event},selectBuildings:_vm.setSelectedBuildings,hideFilter:_vm.hideFilter,updateDataPoints:_vm.updateDataPoints,"update:templateFilterToggle":function($event){_vm.filterToggle=$event},"update:template-filter-toggle":function($event){_vm.filterToggle=$event}}}):_vm._e(),[8,9,10,"mv"].includes(_vm.analyticsMode)?_c("f-building-point-selector",{ref:"portfolio-building-selector",attrs:{visibility:_vm.showBuildingPointSelector,zones:_vm.zones,isSiteAnalysis:_vm.isSiteAnalysis,mode:_vm.analyticsMode,disableMultipleAssetCategories:8===_vm.analyticsMode},on:{"update:visibility":function($event){_vm.showBuildingPointSelector=$event},selectBuildings:_vm.setSelectedBuildings,updateDataPoints:_vm.updateDataPoints}}):_vm._e(),"reading"===_vm.analyticsMode?_c("f-heat-map-point-selector",{ref:"single-point-selector",attrs:{visibility:_vm.showHeatMapPointSelector},on:{"update:visibility":function($event){_vm.showHeatMapPointSelector=$event},updateDataPoints:_vm.updateDimensionDataPoints}}):_vm._e(),_vm.hideSideBar?_vm._e():_c("div",{staticClass:"analytics-options-block"},[_c("div",{},[_c("div",{staticClass:"text-center analytics-report-icon-bg line-height50 height50",class:{"analytics-report-icon-bg-active":_vm.showgeneratedata},on:{click:function($event){return _vm.showgeneratedataDialog()}}},[_c("InlineSvg",{attrs:{src:"statistics",iconClass:"icon icon-sm-md  vertical-middle"}})],1),_c("div",{staticClass:"text-center analytics-report-icon-bg line-height50 height50",class:{"analytics-report-icon-bg-active":_vm.showChartCustomization},attrs:{disabled:!_vm.reportObject||0===_vm.analyticsConfig.dataPoints.length},on:{click:function($event){_vm.reportObject&&_vm.showChartCustomizationDialog()}}},[_c("InlineSvg",{attrs:{src:"settings-grey",iconClass:"icon icon-sm-md vertical-middle"}})],1),_c("div",{staticClass:"text-center analytics-report-icon-bg line-height50 height50",on:{click:function($event){return _vm.toggleSideBar()}}},[_c("InlineSvg",{attrs:{src:"arrow-pointing-to-left2",iconClass:"icon icon-sm-md vertical-middle"}})],1)])]),_vm.hideSideBar?_c("div",{staticClass:"analytics-options-block",style:{left:_vm.cssLeft}},[_c("div",{},[_c("div",{staticClass:"text-center analytics-report-icon-bg line-height50 height50",class:{"analytics-report-icon-bg-active":_vm.showgeneratedata},on:{click:function($event){return _vm.showgeneratedataDialog()}}},[_c("InlineSvg",{attrs:{src:"statistics",iconClass:"icon icon-sm-md  vertical-middle"}})],1),_c("div",{staticClass:"text-center analytics-report-icon-bg line-height50 height50",class:{"analytics-report-icon-bg-active":_vm.showChartCustomization},attrs:{disabled:!_vm.reportObject||0===_vm.analyticsConfig.dataPoints.length},on:{click:function($event){_vm.reportObject&&_vm.showChartCustomizationDialog()}}},[_c("InlineSvg",{attrs:{src:"settings-grey",iconClass:"icon icon-sm-md vertical-middle"}})],1),_c("div",{staticClass:"text-center analytics-report-icon-bg line-height50 height50",on:{click:function($event){return _vm.toggleSideBar()}}},[_c("InlineSvg",{staticStyle:{transform:"rotate(180deg)"},attrs:{src:"arrow-pointing-to-left2",iconClass:"icon icon-sm-md vertical-middle"}})],1)])]):_vm._e(),_c("div",{staticClass:"report-graph-con position-relative",class:{"new-report-graph-con":!_vm.hideSideBar,"new-report-graph-con-stretch":_vm.hideSideBar},staticStyle:{height:"calc(100vh - 100px)","overflow-y":"scroll","padding-bottom":"100px"}},[_c("div",{ref:"chartSection",class:["self-center fchart-section building-graph-container",{"prediction-timings-container":_vm.analyticsConfig.predictionTimings&&_vm.analyticsConfig.predictionTimings.length>1}]},[_vm.analyticsConfig.dataPoints.length?"reading"===_vm.analyticsMode&&null===_vm.analyticsConfig.dimensionDataPoint?_c("div",{staticClass:"text-center"},[_c("div",{staticClass:"p15"},[_vm._v(" "+_vm._s(_vm.$t("common._common.please_select_reading_analyze"))+" ")])]):_c("div",[!1===_vm.isOptimize?_c("f-new-analytic-report-optimize",{ref:"newAnalyticReport",attrs:{config:_vm.analyticsConfig,baseLines:_vm.baseLineList,showTimePeriod:1===_vm.analyticsConfig.mode,showFilterBar:!0,showChartMode:!0,noChartState:_vm.noChartState},on:{"update:config":function($event){_vm.analyticsConfig=$event},reportLoaded:_vm.reportLoaded,removeFilters:_vm.removeFilters}}):_vm._e(),!0===_vm.isOptimize?_c("f-new-analytic-report",{ref:"newAnalyticReport",attrs:{config:_vm.analyticsConfig,baseLines:_vm.baseLineList,showTimePeriod:1===_vm.analyticsConfig.mode,showChartMode:!0},on:{"update:config":function($event){_vm.analyticsConfig=$event},reportLoaded:_vm.reportLoaded}}):_vm._e()],1):_c("div",{staticClass:"text-center"},[(_vm.reportId||_vm.alarmId||_vm.cardId)&&_vm.spinnerToggle?_c("div",{staticClass:"p15"},[_c("spinner",{attrs:{show:_vm.spinnerToggle}})],1):_c("div",{staticClass:"p15 flex-middle height80vh justify-content-center flex-direction-column"},[_c("div",[_c("inline-svg",{attrs:{src:"svgs/emptystate/reportlist",iconClass:"icon text-center icon-xxxlg"}})],1),_c("div",{staticClass:"nowo-label"},[_vm._v(" "+_vm._s(_vm.$t("common._common.please_select_data_points_analyze"))+" ")])])])])])],1)]),_vm.showDerivation?_c("derivation",{attrs:{visibility:_vm.showDerivation,report:_vm.reportObject,config:_vm.analyticsConfig},on:{"update:visibility":function($event){_vm.showDerivation=$event}}}):_vm._e(),_c("el-dialog",{staticClass:"fc-dialog-center-container",attrs:{visible:_vm.showFilter,width:"50%",title:_vm.$t("common.wo_report.configure_asset_filter"),"lock-scroll":!1},on:{"update:visible":function($event){_vm.showFilter=$event}}},[_c("div",{staticClass:"height400"},[_vm.showFilter?_c("new-criteria-builder",{staticClass:"report-criteria-buuilder",attrs:{exrule:_vm.analyticsConfig.template?_vm.analyticsConfig.template.criteria:null,showSiteField:!0,module:"asset",title:_vm.$t("setup.users_management.specify_rules_for_assigment_rules")},on:{condition:_vm.setTemplateFilterCriteria}}):_vm._e()],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){_vm.showFilter=!1}}},[_vm._v(_vm._s(_vm.$t("common._common.close")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:_vm.addFilterCriteria}},[_vm._v(_vm._s(_vm.$t("home.reports.add_criteria")))])],1)]),_c("el-dialog",{staticClass:"fc-dialog-center-container fc-dialog-center-container-body-p20 ",attrs:{visible:_vm.spacefiltersPopover,width:"30%",title:_vm.$t("common._common.add_filters"),"lock-scroll":!1},on:{"update:visible":function($event){_vm.spacefiltersPopover=$event}}},[_c("div",{staticClass:"height100 pB50"},[_c("el-form",{ref:"reportFilterForm",attrs:{model:_vm.reportFilterForm,"label-position":"top"}},[_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"assetFilter"}},[_c("p",{staticClass:"grey-text2"},[_vm._v(" "+_vm._s(_vm.$t("common._common.select_asset_category"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border2 width100 fc-tag",attrs:{filterable:"",multiple:"","collapse-tags":""},on:{change:function($event){return _vm.updateFilterdata("category")}},model:{value:_vm.reportFilterForm.categoryFilter,callback:function($$v){_vm.$set(_vm.reportFilterForm,"categoryFilter",$$v)},expression:"reportFilterForm.categoryFilter"}},_vm._l(_vm.selectedCategory.categoryList,(function(category,index){return _vm.selectedCategory.categoryList&&_vm.selectedCategory.categoryList.length?_c("el-option",{key:index,attrs:{label:category.name,value:category.id}}):_vm._e()})),1)],1)],1)],1),_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"assetFilter"}},[_c("p",{staticClass:"grey-text2"},[_vm._v(" "+_vm._s(_vm.$t("common._common.select_assets"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border2 width100 fc-tag",attrs:{filterable:"",multiple:"","collapse-tags":""},model:{value:_vm.reportFilterForm.assetFilter,callback:function($$v){_vm.$set(_vm.reportFilterForm,"assetFilter",$$v)},expression:"reportFilterForm.assetFilter"}},_vm._l(_vm.selectedCategory.assetList,(function(asset,index){return _vm.selectedCategory.assetList&&_vm.selectedCategory.assetList.length?_c("el-option",{key:index,attrs:{label:_vm.assetsMap[Number(asset)],value:Number(asset)}}):_vm._e()})),1)],1)],1)],1),_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"field"}},[_c("p",{staticClass:"grey-text2"},[_vm._v(_vm._s(_vm.$t("common._common.live_filter")))]),_c("el-select",{staticClass:"fc-input-full-border2 width100",attrs:{placeholder:_vm.$t("common.products._select_")},model:{value:_vm.reportFilterForm.liveFilterField,callback:function($$v){_vm.$set(_vm.reportFilterForm,"liveFilterField",$$v)},expression:"reportFilterForm.liveFilterField"}},[_c("el-option",{attrs:{value:"none",label:_vm.$t("common.wo_report.none")}}),_c("el-option",{attrs:{value:"asset",label:_vm.$t("common._common.asset")}})],1)],1)],1),_vm.reportFilterForm.liveFilterField&&"none"!==_vm.reportFilterForm.liveFilterField?_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"selectBoxType"}},[_c("p",{staticClass:"grey-text2"},[_vm._v(_vm._s(_vm.$t("common._common.type")))]),_c("el-select",{staticClass:"fc-input-full-border2 width100",model:{value:_vm.reportFilterForm.liveFilterType,callback:function($$v){_vm.$set(_vm.reportFilterForm,"liveFilterType",$$v)},expression:"reportFilterForm.liveFilterType"}},[_c("el-option",{attrs:{value:"single",label:_vm.$t("common.header.single_select_box")}}),_c("el-option",{attrs:{value:"multi",label:_vm.$t("common.header.multi_select_box")}})],1)],1)],1):_vm._e()],1)],1)],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){_vm.spacefiltersPopover=!1}}},[_vm._v(_vm._s(_vm.$t("setup.users_management.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:function($event){return _vm.applyFilter(null)}}},[_vm._v(_vm._s(_vm.$t("maintenance.pm_list.apply")))])],1)]),_vm.showTrendLine?_c("trend-line",{attrs:{visibility:_vm.showTrendLine,report:_vm.reportObject},on:{"update:visibility":function($event){_vm.showTrendLine=$event},onTrendLineChange:_vm.onTrendLineChange}}):_vm._e()],1)},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),toConsumableArray=__webpack_require__(488478),objectSpread2=__webpack_require__(595082),createForOfIteratorHelper=__webpack_require__(566347),AnalyticsMixin=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(538077),__webpack_require__(169358),__webpack_require__(670560),__webpack_require__(434284),__webpack_require__(976801),__webpack_require__(648324),__webpack_require__(634338),__webpack_require__(843843),__webpack_require__(339772),__webpack_require__(162506),__webpack_require__(947522),__webpack_require__(244936)),FNewAnalyticsReportV1=__webpack_require__(937376),FNAROptimize=__webpack_require__(520245),FDataPointSelector=__webpack_require__(287374),FBuildingPointSelectorvue_type_template_id_7d5f89c0_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.visibility?_c("div",{staticClass:"analytics-sidebar-bg"},[_vm.isMultipleCategorySelected&&_vm.disableMultipleAssetCategories?_c("div",{staticClass:"analytics-topbar-warning"},[_c("div",{staticClass:"Only-one-data-point flex-middle"},[_c("InlineSvg",{attrs:{src:"svgs/info-warning",iconClass:"icon vertical-middle icon-md fill-orange"}}),_c("div",{staticClass:"pL10"},[_vm._v(" Please choose only a single asset category to customise! To select other data points, please ")]),_c("div",{staticClass:"text-style-1 pL5"},[_vm._v("delete the current selection points.")]),_c("div",{staticClass:"mL10"},[_c("el-switch",{staticClass:"Notification-toggle",attrs:{"active-color":"rgba(57, 178, 194, 0.8)","inactive-color":"#e5e5e5"},on:{change:function($event){return _vm.emptySelectedDataPoints()}},model:{value:_vm.replaceDataPoints,callback:function($$v){_vm.replaceDataPoints=$$v},expression:"replaceDataPoints"}})],1)],1)]):_vm._e(),_c("div",{staticClass:"sidebar-position-setup"},[_c("div",{staticClass:"sidebar-close-btn pointer",on:{click:_vm.cancel}},[_vm._m(0)]),_c("div",{staticClass:"building-analysis-sidebar-conatainer"},[_vm.buildingIds&&_vm.buildingIds.length?_vm.loading?_c("div",{staticClass:"newanalytics-sidebar col-3"},[_c("spinner",{attrs:{show:_vm.loading}})],1):_c("div",{staticClass:"newanalytics-sidebar col-3"},[_c("div",{staticClass:"data-pointer-selector-popup"},[_c("analaytics-filter",{attrs:{zones:_vm.zones,selectedBuildings:_vm.selectedBuildings,isSiteAnalysis:_vm.isSiteAnalysis},on:{"update:selectedBuildings":function($event){_vm.selectedBuildings=$event},"update:selected-buildings":function($event){_vm.selectedBuildings=$event}}})],1),_c("div",[_vm.showQuickSearch?_c("div",[_c("div",{staticClass:"fc-list-search"},[_c("div",{staticClass:"fc-list-search-wrapper relative fc-list-search-wrapperbuilding-search"},[_c("input",{directives:[{name:"model",rawName:"v-model",value:_vm.searchKey,expression:"searchKey"}],ref:"quickSearchQuery",staticClass:"quick-search-input4",attrs:{autofocus:"",type:"text",placeholder:"Search"},domProps:{value:_vm.searchKey},on:{keyup:_vm.quickSearch,input:function($event){$event.target.composing||(_vm.searchKey=$event.target.value)}}}),_c("svg",{staticClass:"close-icon4",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 32 32","aria-hidden":"true"},on:{click:_vm.closeSearch}},[_c("title",[_vm._v("close")]),_c("path",{attrs:{d:"M17.992 16l8.796-8.796a1.409 1.409 0 0 0-1.992-1.992L16 14.008 7.204 5.212a1.409 1.409 0 0 0-1.992 1.992L14.008 16l-8.796 8.796a1.409 1.409 0 0 0 1.992 1.992L16 17.992l8.796 8.796a1.409 1.409 0 0 0 1.992-1.992L17.992 16z"}})])])])]):_vm._e(),_vm.mode&&["mv"].includes(_vm.mode)?_vm._e():_c("div",{staticClass:"building-analysis-side-block"},[_c("div",{staticClass:"building-hover-actions"},[_c("div",{staticClass:"sidebar-asset-H fL",staticStyle:{cursor:"pointer"},on:{click:_vm.loadAssetCategories}},[_vm._v(" Assets ")])]),"assets"===_vm.config.mainPanel.currentModule?_c("div",{staticClass:"building-anlysis-active-block"},[_vm._l(_vm.config.mainPanel.assetCategories,(function(category,index){return _vm.config.mainPanel.assetCategories&&_vm.config.mainPanel.assetCategories.length?_c("div",{key:index,class:["building-anlysis-label-txt","clearboth",{"asset-list-block-txt-active":_vm.config.mainPanel.selectedAssetCategory===category.id}],on:{click:function($event){return _vm.openAssetCategory(category.id)}}},[_c("i",{class:{"fa fa-circle":!0,"dot-blue-icon":_vm.config.mainPanel.selectedAssetCategory===category.id,"dot-grey-icon":_vm.config.mainPanel.selectedAssetCategory!=category.id},attrs:{"aria-hidden":"true"}}),_c("div",{staticClass:"width80"},[_vm._v(_vm._s(category.name))]),_c("span",{staticClass:"active-arrow"},[_vm.config.mainPanel.selectedAssetCategory===category.id?_c("img",{attrs:{src:__webpack_require__(676118),height:"14px",width:"14px"}}):_vm._e()])]):_vm._e()})),_vm.config.mainPanel.assetCategories.length?_vm._e():_c("div",{staticClass:"building-anlysis-label-txt clearboth"},[_vm._v(" -- No assets -- ")])],2):_vm._e()]),[4,"mv"].includes(_vm.mode)?_c("div",{staticClass:"building-analysis-side-block"},[_c("div",{staticClass:"building-hover-actions"},[_c("div",{staticClass:"sidebar-asset-H fL",staticStyle:{cursor:"pointer"},on:{click:_vm.loadMVProjects}},[_vm._v(" M & V ")])])]):_vm._e()])]):_c("div",[_vm._v(" No buildings selected. ")]),_vm.config.assetPointsPanel.show?_c("div",{staticClass:"assets-points-Scontainer assets-points-Scontainer-lalign"},[_c("div",{staticClass:"assets-points-inner-container"},[_vm._m(1),_c("div",{staticClass:"building-points-search"},[_c("el-input",{attrs:{placeholder:"Filter points",autofocus:""},model:{value:_vm.config.assetPointsPanel.filterQuery,callback:function($$v){_vm.$set(_vm.config.assetPointsPanel,"filterQuery",$$v)},expression:"config.assetPointsPanel.filterQuery"}})],1),_c("div",{staticClass:"asset-list-container mT10"},[_vm.config.assetPointsPanel.loading?_c("spinner",{attrs:{show:_vm.config.assetPointsPanel.loading}}):_vm.config.assetPointsPanel.data&&_vm.config.assetPointsPanel.data.length?_c("el-checkbox-group",{staticClass:"building-check-list",model:{value:_vm.config.mainPanel.selectedDataPoints,callback:function($$v){_vm.$set(_vm.config.mainPanel,"selectedDataPoints",$$v)},expression:"config.mainPanel.selectedDataPoints"}},_vm._l(_vm.filteredAssetPointsPanel,(function(item,index){return _c("el-checkbox",{key:index,attrs:{label:_vm.config.mainPanel.selectedAssetCategory+"_"+item.id}},[_vm._v(_vm._s(item.displayName?item.displayName:item.name))])})),1):_c("div",{staticClass:"asset-list-block-txt text-center"},[_vm._v(" No points. ")])],1)])]):_vm._e(),_vm.config.mvPointsPanel.show||"mv"===_vm.mode?_c("div",{staticClass:"assets-points-Scontainer assets-points-Scontainer-lalign"},[_c("div",{staticClass:"assets-points-inner-container"},[_vm._m(2),_c("div",{staticClass:"building-points-search"},[_c("el-input",{attrs:{placeholder:"Filter points",autofocus:""},model:{value:_vm.config.mvPointsPanel.filterQuery,callback:function($$v){_vm.$set(_vm.config.mvPointsPanel,"filterQuery",$$v)},expression:"config.mvPointsPanel.filterQuery"}})],1),_c("div",{staticClass:"asset-list-container mT10"},[_vm.config.mvPointsPanel.loading?_c("spinner",{attrs:{show:_vm.config.mvPointsPanel.loading}}):_vm.config.mvPointsPanel.data&&_vm.config.mvPointsPanel.data.length?_c("el-checkbox-group",{staticClass:"building-check-list",model:{value:_vm.config.mainPanel.selectedDataPoints,callback:function($$v){_vm.$set(_vm.config.mainPanel,"selectedDataPoints",$$v)},expression:"config.mainPanel.selectedDataPoints"}},_vm._l(_vm.filteredmvPointsPanel,(function(item,index){return _c("el-checkbox",{key:index,attrs:{label:_vm.config.mainPanel.selectedAssetCategory+"_"+item.id}},[_vm._v(_vm._s(item.displayName?item.displayName:item.name))])})),1):_c("div",{staticClass:"asset-list-block-txt text-center"},[_vm._v(" No points. ")])],1)])]):_vm._e(),_vm.config.assetPointsPanel.show||_vm.config.mainPanel.selectedDataPoints.length?_c("div",{staticClass:"building-analysis-point-container row"},[_c("div",{staticClass:"building-analysis-points-wrap col-12"},[_vm.config.mainPanel.selectedDataPoints.length?_c("div",{staticClass:"col-4"},[_c("el-popover",{attrs:{width:300,"popper-class":"added-datapoints-popover"}},[_c("div",{staticClass:"added-datapoints-container"},[_c("div",{staticClass:"added-datapoints-header"},[_vm._v(" Selected Points "),_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-delete pointer pL5",staticStyle:{"font-size":"12px"},attrs:{title:"Remove all","data-arrow":"true"},on:{click:_vm.clearSelectedPoints}})]),_c("div",{staticClass:"added-datapoints-collection"},[_c("ul",{staticClass:"list-group"},_vm._l(_vm.config.mainPanel.selectedDataPoints,(function(dataPoint,index){return _c("li",{key:index,staticClass:"list-group-item"},[_c("span",{staticClass:"float: left;"},[_vm._v(_vm._s(_vm.readings.fields[dataPoint.split("_")[1]]?_vm.readings.fields[dataPoint.split("_")[1]].displayName:"---"))]),_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-delete pointer",staticStyle:{float:"right"},attrs:{title:"Remove","data-arrow":"true"},on:{click:function($event){return _vm.removeSelectedDataPoint(dataPoint,index)}}}),_c("span",{staticStyle:{clear:"both"}})])})),0)])]),_c("div",{staticClass:"fc-text-pink fL pointer",attrs:{slot:"reference"},slot:"reference"},[_vm._v(" "+_vm._s(_vm.config.mainPanel.selectedDataPoints.length)+" points selected ")])])],1):_vm._e(),_c("div",{staticClass:"building-analysis-points-btn fR col-8"},[_c("el-button",{staticClass:"btn-grey-fill",attrs:{type:"button"},on:{click:_vm.cancel}},[_vm._v(_vm._s(_vm.$t("setup.users_management.cancel")))]),_c("el-button",{staticClass:"btn-blue-fill",attrs:{type:"button"},on:{click:_vm.apply}},[_vm._v(_vm._s(_vm.$t("maintenance.pm_list.apply")))])],1)])]):_vm._e()])])]):_vm._e()},FBuildingPointSelectorvue_type_template_id_7d5f89c0_staticRenderFns=[function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{},[_c("i",{staticClass:"el-icon-close"})])},function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"select-reading-header",staticStyle:{"padding-bottom":"17px","padding-top":"16px !important"}},[_c("span",[_c("img",{staticStyle:{position:"relative",top:"4px",right:"7px"},attrs:{src:__webpack_require__(587758),width:"18px",height:"18px"}}),_vm._v("Points")])])},function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"select-reading-header",staticStyle:{"padding-bottom":"17px","padding-top":"16px !important"}},[_c("span",[_c("img",{staticStyle:{position:"relative",top:"4px",right:"7px"},attrs:{src:__webpack_require__(587758),width:"18px",height:"18px"}}),_vm._v("Points")])])}],AnalayticsFilter=(__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(228436),__webpack_require__(450886),__webpack_require__(398758)),vuex_esm=__webpack_require__(420629),api=__webpack_require__(32284),picklist=__webpack_require__(961358),FBuildingPointSelectorvue_type_script_lang_js={props:["visibility","zones","isSiteAnalysis","mode","disableMultipleAssetCategories"],data:function(){return{config:{mainPanel:{currentModule:"",assetCategories:null,selectedAssetCategory:null,selectedDataPoints:[]},assetPointsPanel:{show:!1,activeSubTab:"points",data:null,loading:!0,selectedAssetOrPoint:null,filterQuery:""},mvPointsPanel:{show:!1,activeSubTab:"points",data:null,loading:!0,selectedAssetOrPoint:null,filterQuery:""},selectReadingsPanel:{show:!1,data:null,loading:!1,parentId:null,filterQuery:""},selectAssetsPanel:{show:!1,data:null,loading:!1,readingId:null,filterQuery:""}},loading:!0,readings:{categories:[],assets:{},categoryWithAssets:{},fields:{},categoryWithFields:{}},mvreadings:null,showQuickSearch:!1,quickSearchQuery:null,selectedBuildings:[],parentIds:null,replaceDataPoints:!1,isMultipleCategorySelected:!1,urlParams:{perPage:50,page:1,viewName:"hidden-all"},default_building_id:null,selectedBuildingLabel:this.isSiteAnalysis?"No Sites":"No Buildings"}},components:{AnalayticsFilter:AnalayticsFilter/* default */.Z},created:function(){var _this=this;Promise.all([this.$store.dispatch("loadAssetCategory"),this.loadDefaultBuilding()]).then((function(){return _this.setDefaultSelection()}))},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({assetCategory:function(state){return state.assetCategory}})),{},{buildingIds:function(){if(this.selectedBuildings&&this.selectedBuildings.length){var _step,buildingIds=[],_iterator=(0,createForOfIteratorHelper/* default */.Z)(this.selectedBuildings);try{for(_iterator.s();!(_step=_iterator.n()).done;){var sb=_step.value;buildingIds.push(parseInt(sb))}}catch(err){_iterator.e(err)}finally{_iterator.f()}return buildingIds}return null},buildingList:function(){return{}},selectedBuildingName:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var _yield$getFieldValue,data,error,value,_yield$getFieldValue2,_data,_error,_value;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(!_this2.selectedBuildings||!_this2.selectedBuildings.length){_context.next=18;break}if(1!==_this2.selectedBuildings.length){_context.next=18;break}if(!_this2.selectedBuildings[0]||_this2.isSiteAnalysis){_context.next=11;break}return _context.next=5,(0,picklist/* getFieldValue */.oe)({lookupModuleName:"building",selectedOptionId:[_this2.selectedBuildings[0]]});case 5:_yield$getFieldValue=_context.sent,data=_yield$getFieldValue.data,error=_yield$getFieldValue.error,!error&&data&&(value=_this2.$getProperty(data,"0.label"),_this2.selectedBuildingLabel=value),_context.next=18;break;case 11:if(!_this2.selectedBuildings[0]||!_this2.isSiteAnalysis){_context.next=18;break}return _context.next=14,(0,picklist/* getFieldValue */.oe)({lookupModuleName:"site",selectedOptionId:[_this2.selectedBuildings[0]]});case 14:_yield$getFieldValue2=_context.sent,_data=_yield$getFieldValue2.data,_error=_yield$getFieldValue2.error,!_error&&_data&&(_value=_this2.$getProperty(_data,"0.label"),_this2.selectedBuildingLabel=_value);case 18:case"end":return _context.stop()}}),_callee)})))()},filteredAssetPointsPanel:function(){var self=this;return this.config.assetPointsPanel.data&&this.config.assetPointsPanel.data.length?this.config.assetPointsPanel.filterQuery&&this.config.assetPointsPanel.filterQuery.trim().length?this.config.assetPointsPanel.data.filter((function(d){var name=d.displayName?d.displayName:d.name;if(name.toLowerCase().indexOf(self.config.assetPointsPanel.filterQuery.toLowerCase())>=0&&"BOOLEAN"!==d.dataTypeEnum)return d})):this.config.assetPointsPanel.data.filter((function(d){if("BOOLEAN"!==d.dataTypeEnum)return d})):[]},filteredmvPointsPanel:function(){var self=this;if(this.config.mvPointsPanel.data&&this.config.mvPointsPanel.data.length){if(this.config.mvPointsPanel.filterQuery&&this.config.mvPointsPanel.filterQuery.trim().length){var filteredData=this.config.mvPointsPanel.data.filter((function(d){var name=d.displayName?d.displayName:d.name;if(name.toLowerCase().indexOf(self.config.mvPointsPanel.filterQuery.toLowerCase())>=0&&"BOOLEAN"!==d.dataTypeEnum)return d}));return this.$helpers.sortData("name",filteredData)}var _filteredData=this.config.mvPointsPanel.data.filter((function(d){if("BOOLEAN"!==d.dataTypeEnum)return d}));return this.$helpers.sortData("name",_filteredData)}return[]},filteredReadingsPanel:function(){var self=this;return this.config.selectReadingsPanel.data&&this.config.selectReadingsPanel.data.length?this.config.selectReadingsPanel.filterQuery&&this.config.selectReadingsPanel.filterQuery.trim().length?this.config.selectReadingsPanel.data.filter((function(d){var name=d.displayName?d.displayName:d.name;if(name.toLowerCase().indexOf(self.config.selectReadingsPanel.filterQuery.toLowerCase())>=0)return d})):this.config.selectReadingsPanel.data:[]},filteredAssetsPanel:function(){var self=this;return this.config.selectAssetsPanel.data&&this.config.selectAssetsPanel.data.length?this.config.selectAssetsPanel.filterQuery&&this.config.selectAssetsPanel.filterQuery.trim().length?this.config.selectAssetsPanel.data.filter((function(d){var name=d.displayName?d.displayName:d.name;if(name.toLowerCase().indexOf(self.config.selectAssetsPanel.filterQuery.toLowerCase())>=0)return d})):this.config.selectAssetsPanel.data:[]}}),watch:{buildingIds:function(newVal,oldVal){JSON.stringify(newVal)!==JSON.stringify(oldVal)&&(this.loadAssetCategories(),this.resetResetReadings())},selectedBuildingName:function(){var _selectedBuildingName=(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(newVal){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,this.selectedBuildingName;case 2:this.$emit("selectBuildings",{name:this.selectedBuildingLabel,ids:this.selectedBuildings});case 3:case"end":return _context2.stop()}}),_callee2,this)})));function selectedBuildingName(_x){return _selectedBuildingName.apply(this,arguments)}return selectedBuildingName}(),buildingList:function(newval){this.setDefaultSelection()}},mounted:function(){"mv"===this.mode&&this.loadMVProjects()},methods:{loadDefaultBuilding:function(){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var _yield$API$get,data,error,_yield$API$get2,_data2,_error2;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:if(_this3.isSiteAnalysis){_context3.next=9;break}return _context3.next=3,api/* API */.bl.get("/v3/picklist/building",_this3.urlParams,{force:!0});case 3:_yield$API$get=_context3.sent,data=_yield$API$get.data,error=_yield$API$get.error,!error&&(null===data||void 0===data?void 0:data.pickList.length)>0&&(_this3.default_building_id=data.pickList[0].value),_context3.next=15;break;case 9:return _context3.next=11,api/* API */.bl.get("/v3/picklist/site",_this3.urlParams,{force:!0});case 11:_yield$API$get2=_context3.sent,_data2=_yield$API$get2.data,_error2=_yield$API$get2.error,!_error2&&(null===_data2||void 0===_data2?void 0:_data2.pickList.length)>0&&(_this3.default_building_id=_data2.pickList[0].value);case 15:case"end":return _context3.stop()}}),_callee3)})))()},setDefaultSelection:function(){this.selectedBuildings=[],this.default_building_id&&(
// this.selectedBuildings = [Object.keys(this.buildingList)[0]]
this.selectedBuildings=[this.default_building_id])},setSelectedBuildings:function(selectedBuildings){this.selectedBuildings=selectedBuildings},toggleQuickSearch:function(){var _this4=this;this.showQuickSearch=!this.showQuickSearch,this.showQuickSearch&&this.$nextTick((function(){_this4.$refs.quickSearchQuery.focus()}))},closeSearch:function(){this.toggleQuickSearch(),this.quickSearchQuery=null,this.quickSearch()},quickSearch:function(){},loadAssetCategories:function(){var self=this;"assets"!==self.config.mainPanel.currentModule?(self.config.mainPanel.currentModule="assets",self.config.mainPanel.selectedAssetCategory=null,self.config.mainPanel.assetCategories=null,self.$http.post("/asset/getAssetCategoryWithReadings",{buildingIds:self.buildingIds}).then((function(response){var categoryIds=Object.keys(response.data);self.config.mainPanel.assetCategories=self.assetCategory.filter((function(ele){for(var index=0;index<categoryIds.length;index++){var element=categoryIds[index];if(parseInt(element)===ele.id)return ele.toggle=!1,ele}})),self.loading=!1;var panels=[];self.config["assetPointsPanel"].show&&panels.push("assetPointsPanel"),self.config["selectReadingsPanel"].show&&panels.push("selectReadingsPanel"),self.config["selectAssetsPanel"].show&&panels.push("selectAssetsPanel"),self.config["moduleFieldsPanel"]&&self.config["moduleFieldsPanel"].show&&panels.push("moduleFieldsPanel"),self.togglePanel(panels),self.savedPoints&&"undefined"!==typeof self.savedPoints&&0!==self.savedPoints.length&&self.prepareSavedDataPoints()}))):
// toggle
self.config.mainPanel.currentModule=""},resetResetReadings:function(){this.readings={categories:[],assets:{},categoryWithAssets:{},fields:{},categoryWithFields:{}}},loadMVProjects:function(){var self=this;if("mvs"!==self.config.mainPanel.currentModule){self.config.mainPanel.currentModule="mvs";var panels=[];self.config["assetPointsPanel"].show&&panels.push("assetPointsPanel"),self.config["selectReadingsPanel"].show&&panels.push("selectReadingsPanel"),self.config["selectAssetsPanel"].show&&panels.push("selectAssetsPanel"),self.togglePanel(panels),self.togglePanel("mvPointsPanel"),self.$http.get("/v2/readings/getSubModuleRel?moduleName=mvproject").then((function(response){var submodules=response.data.result.submodules;for(var module in self.mvreadings=[],submodules)self.mvreadings=self.mvreadings.concat(submodules[module].fields);self.mvreadings!==[]&&(self.mvreadings=self.mvreadings.filter((function(el){return 3===el.dataType}))),self.config.mvPointsPanel.data=self.mvreadings.map((function(el){return{id:el.id,name:el.displayName}})),self.config.mvPointsPanel.loading=!1}))}else
// toggle
self.config.mainPanel.currentModule=""},clearSelectedPoints:function(){this.config.mainPanel.selectedDataPoints=[]},removeSelectedDataPoint:function(dataPoint,index){this.config.mainPanel.selectedDataPoints.splice(index,1)},togglePanel:function(){for(var self=this,configKeys=Object.keys(self.config),_len=arguments.length,panels=new Array(_len),_key=0;_key<_len;_key++)panels[_key]=arguments[_key];for(var _i=0,_configKeys=configKeys;_i<_configKeys.length;_i++){var configKey=_configKeys[_i];panels.indexOf(configKey)>=0?self.config[configKey].show=!0:(self.config[configKey].show=!1,self.config[configKey].selectedItem=null)}},openAssetCategory:function(categoryId){var self=this;if(self.disableMultipleAssetCategories&&self.config.mainPanel.selectedAssetCategory&&self.config.mainPanel.selectedAssetCategory!==categoryId&&self.config.mainPanel.selectedDataPoints.length>0)this.isMultipleCategorySelected=!0;else if(self.togglePanel("assetPointsPanel"),self.config.mainPanel.selectedAssetCategory=categoryId,self.config.assetPointsPanel.loading=!0,self.config.assetPointsPanel.selectedAssetOrPoint=null,self.readings.categories.includes(categoryId))if("assets"===self.config.assetPointsPanel.activeSubTab){var assetIds=Object.keys(self.readings.categoryWithAssets[categoryId]);self.config.assetPointsPanel.data=assetIds.map((function(el){return{id:el,name:self.readings.assets[el]}})),self.config.assetPointsPanel.loading=!1}else{var readingIds=Object.keys(self.readings.categoryWithFields[categoryId]);self.config.assetPointsPanel.data=readingIds.map((function(el){return self.readings.fields[el]})),self.config.assetPointsPanel.loading=!1}else self.buildingIds&&self.$http.post("/asset/getReadingsForSpecificAssetCategory",{buildingIds:self.buildingIds,categoryIds:[categoryId]}).then((function(response){if(self.readings.categories.includes(categoryId)||self.readings.categories.push(categoryId),self.readings.categoryWithAssets[categoryId]=response.data.categoryWithAssets[categoryId],self.readings.categoryWithFields[categoryId]=response.data.categoryWithFields[categoryId],response.data.fields)for(var _i2=0,_Object$keys=Object.keys(response.data.fields);_i2<_Object$keys.length;_i2++){var fieldId=_Object$keys[_i2];self.readings.fields[fieldId]||(self.readings.fields[fieldId]=response.data.fields[fieldId])}if(response.data.assets)for(var _i3=0,_Object$keys2=Object.keys(response.data.assets);_i3<_Object$keys2.length;_i3++){var assetId=_Object$keys2[_i3];self.readings.assets[assetId]||(self.readings.assets[assetId]=response.data.assets[assetId])}if("assets"===self.config.assetPointsPanel.activeSubTab){var _assetIds=Object.keys(self.readings.categoryWithAssets[categoryId]);self.config.assetPointsPanel.data=_assetIds.map((function(el){return{id:el,name:self.readings.assets[el]}})),self.config.assetPointsPanel.loading=!1}else{var _readingIds=Object.keys(self.readings.categoryWithFields[categoryId]);self.config.assetPointsPanel.data=_readingIds.map((function(el){return self.readings.fields[el]})),self.config.assetPointsPanel.loading=!1}}))},openAsset:function(assetId){var self=this;self.config.assetPointsPanel.selectedAssetOrPoint=assetId,self.togglePanel("assetPointsPanel","selectReadingsPanel"),self.config.selectReadingsPanel.loading=!0,self.config.selectReadingsPanel.parentId=assetId;var fieldIds=self.readings.categoryWithAssets[self.config.mainPanel.selectedAssetCategory][assetId];self.config.selectReadingsPanel.data=fieldIds.map((function(el){return self.readings.fields[el]})),self.config.selectReadingsPanel.loading=!1},openPoint:function(pointId){var _this5=this,self=this;self.config.assetPointsPanel.selectedAssetOrPoint=pointId;var assetIds=self.readings.categoryWithFields[self.config.mainPanel.selectedAssetCategory][pointId],dataPoints=assetIds.map((function(el){return{parentId:el,yAxis:{fieldId:pointId,aggr:_this5.readings.fields[pointId]&&_this5.readings.fields[pointId].unit&&["currency","kwh","co2","kg","mwh"].includes(_this5.readings.fields[pointId].unit.trim().toLowerCase())?3:2}}}));this.$emit("updateDataPoints",dataPoints,self.config.mainPanel.selectedAssetCategory,pointId)},emptySelectedDataPoints:function(){this.replaceDataPoints&&(this.isMultipleCategorySelected=!1,this.replaceDataPoints=!1,this.config.mainPanel.selectedAssetCategory=null,this.setInitialValues([]))},getReadingFields:function(readings){var _step2,data=[],_iterator2=(0,createForOfIteratorHelper/* default */.Z)(readings);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _step3,reading=_step2.value,_iterator3=(0,createForOfIteratorHelper/* default */.Z)(reading.fields);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var field=_step3.value;data.push(field)}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}return data},loadSpaceReadings:function(){var self=this;self.config.mainPanel.currentModule="spaces",self.togglePanel("selectReadingsPanel"),self.config.selectReadingsPanel.loading=!0,self.config.selectReadingsPanel.parentId=self.buildingIds[0],self.$http.get("/reading/getspacespecificreadings?parentId="+self.buildingIds[0]).then((function(response){self.config.selectReadingsPanel.data=self.getReadingFields(response.data.filter((function(el){
// TODO check whether to show for building analysis also, all readings except enpi
if(self.isSiteAnalysis?7!==el.type:3===el.type)return el}))),self.config.selectReadingsPanel.loading=!1}))},loadWeatherReadings:function(){var self=this;self.config.mainPanel.currentModule="weather",self.togglePanel("selectReadingsPanel"),self.config.selectReadingsPanel.loading=!0;var fetchWeatherReadings=function(siteId){self.$http.get("/reading/getspacespecificreadings?excludeForecastReadings=false&parentId="+siteId).then((function(response){self.config.selectReadingsPanel.data=self.getReadingFields(response.data),self.config.selectReadingsPanel.loading=!1}))};self.$http.get("/building/"+self.buildingIds[0]).then((function(response){if(response.data.building){var siteId=response.data.building.siteId;self.config.selectReadingsPanel.parentId=siteId,fetchWeatherReadings(siteId)}else self.$http.get("/zone/"+self.buildingIds[0]).then((function(response){if(response.data.zone){var _siteId=response.data.zone.siteId;self.config.selectReadingsPanel.parentId=_siteId,fetchWeatherReadings(_siteId)}}))}))},loadEnPIReadings:function(){var self=this;self.config.mainPanel.currentModule="enpi",self.togglePanel("selectReadingsPanel"),self.config.selectReadingsPanel.loading=!0,self.config.selectReadingsPanel.parentId=self.buildingIds[0],self.$http.get("/reading/getspacespecificreadings?parentId="+self.buildingIds[0]).then((function(response){self.config.selectReadingsPanel.data=self.getReadingFields(response.data.filter((function(el){if(7===el.type)return el}))),self.config.selectReadingsPanel.loading=!1}))},cancel:function(){this.isMultipleCategorySelected&&(this.isMultipleCategorySelected=!1),this.$emit("update:visibility",!1)},apply:function(){var dataPoints=[],parentId=null;if(this.isMultipleCategorySelected&&(this.isMultipleCategorySelected=!1),this.config.mainPanel.selectedDataPoints&&this.config.mainPanel.selectedDataPoints.length)if("mv"===this.mode){var self=this;self.$http.get("/v2/mv/getMVProjectList").then((function(response){var mvprojects=response.data.result.mvprojects.filter((function(project){return project.siteId===self.$store.state.buildings.filter((function(building){return building.id===parseInt(self.selectedBuildings[0])}))[0].siteId}));mvprojects&&(parentId=mvprojects.map((function(project){return project.id})));var _step4,_iterator4=(0,createForOfIteratorHelper/* default */.Z)(self.config.mainPanel.selectedDataPoints);try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var dp=_step4.value,categoryId=parseInt(dp.split("_")[0]),pointId=parseInt(dp.split("_")[1]);dataPoints.push({categoryId:categoryId,parentId:parentId,moduleName:"mvproject",yAxis:{fieldId:pointId,aggr:self.readings.fields[pointId]&&self.readings.fields[pointId].unit&&["currency","kwh","co2","kg","mwh"].includes(self.readings.fields[pointId].unit.trim().toLowerCase())?3:2},duplicateDataPoint:!1})}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}self.$emit("updateDataPoints",dataPoints)}))}else{var _step5,_iterator5=(0,createForOfIteratorHelper/* default */.Z)(this.config.mainPanel.selectedDataPoints);try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var dp=_step5.value,categoryId=parseInt(dp.split("_")[0]),pointId=parseInt(dp.split("_")[1]);dataPoints.push({categoryId:categoryId,parentId:null,moduleName:null,yAxis:{fieldId:pointId,aggr:this.readings.fields[pointId]&&this.readings.fields[pointId].unit&&["currency","kwh","co2","kg","mwh"].includes(this.readings.fields[pointId].unit.trim().toLowerCase())?3:2}})}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}this.$emit("updateDataPoints",dataPoints)}},setInitialValues:function(dataPoints,buildings){var _this6=this;dataPoints.length!==this.config.mainPanel.selectedDataPoints.length&&(this.config.mainPanel.selectedDataPoints=[],dataPoints.forEach((function(dp){2===dp.type||dp.duplicateDataPoint||(_this6.config.mainPanel.selectedDataPoints.push(dp.categoryId+"_"+dp.yAxis.fieldId),_this6.$route.query.reportId&&_this6.openAssetCategory(dp.categoryId))}))),buildings&&buildings.length&&!this.selectedBuildings.includes(buildings[0])&&this.setSelectedBuildings(buildings)}}},components_FBuildingPointSelectorvue_type_script_lang_js=FBuildingPointSelectorvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FBuildingPointSelectorvue_type_script_lang_js,FBuildingPointSelectorvue_type_template_id_7d5f89c0_render,FBuildingPointSelectorvue_type_template_id_7d5f89c0_staticRenderFns,!1,null,null,null)
/* harmony default export */,FBuildingPointSelector=component.exports,FHeatMapPointSelector=__webpack_require__(315065),FDerivation=__webpack_require__(486348),NewFChartCustomization=__webpack_require__(280843),FReportOptions=__webpack_require__(791514),NewDateHelper=__webpack_require__(105534),InlineSvg=__webpack_require__(586166),NewReportSummaryHelper=__webpack_require__(601458),NewCriteriaBuilder=__webpack_require__(859850),TrendLine=__webpack_require__(839662),validation=(__webpack_require__(150361),__webpack_require__(990260)),deepmerge=__webpack_require__(708634),NewBuildingAnalysisvue_type_script_lang_js={props:["mobileConfig"],mixins:[AnalyticsMixin/* default */.Z,NewReportSummaryHelper/* default */.Z],components:{Derivation:FDerivation/* default */.Z,FNewAnalyticReport:FNewAnalyticsReportV1/* default */.Z,FNewAnalyticReportOptimize:FNAROptimize/* default */.Z,FChartCustomization:NewFChartCustomization/* default */.Z,FDataPointSelector:FDataPointSelector/* default */.Z,FBuildingPointSelector:FBuildingPointSelector,FHeatMapPointSelector:FHeatMapPointSelector/* default */.Z,FReportOptions:FReportOptions/* default */.Z,InlineSvg:InlineSvg/* default */.Z,NewCriteriaBuilder:NewCriteriaBuilder/* default */.Z,TrendLine:TrendLine/* default */.Z},data:function(){return{templateCriteria:null,showFilter:!1,hideSideBar:!1,showDataPointSelector:!1,showBuildingPointSelector:!1,showHeatMapPointSelector:!1,showChartCustomization:!1,showgeneratedata:!0,showDerivation:!1,chartCustomizationActiveTab:"datapoints",selectedBaseLineId:"",baseLineList:null,baseLineCasecaderOptions:[],oldBaseLine:null,spinnerToggle:!0,assetCategoryMap:null,spacefiltersPopover:!1,analyticsConfig:{name:"Building Analysis",key:"BUILDING_ANALYSIS",analyticsType:this.isSiteAnalysis?6:2,type:"reading",period:0,groupByTimeAggr:null,mode:1,baseLine:[-1],dateFilter:NewDateHelper/* default */.Z.getDatePickerObject(22),chartViewOption:0,dataPoints:[],dimensionDataPoint:null,defaultDate:!1,predictionTimings:[],transformWorkflow:null,trendLineChange:0,filters:{xCriteriaMode:2},sorting:{sortByField:null,orderByFunc:3,limit:10},reportFilter:{timeFilter:{conditions:{}},dataFilter:{conditions:{}}}},reportFilterForm:{floorFilter:[],SpaceFilter:[],categoryFilter:[],assetFilter:[],liveFilterField:"none",liveFilterType:"single"},selectedCategory:{categoryId:[],assetList:null,allAsset:null,categoryList:null,FloorList:[],spaceList:[],allBuildings:null},assetsMap:null,analyticsMode:1,setfilter:0,noChartState:!1,reportObject:null,resultObject:null,selectedBuildings:[],selectedBuildingTitle:"",zones:null,dataPointSummaryList:null,dPSummaryList:null,filterToggle:!1,showTrendLine:!1,assetCategoryName:"",filterTitle:"Assets",enableReadingSelection:!1,savedPoints:[],reportFilterEnable:!1,showReportFilter:!1,alarmPdf:!1,hideFilterDynamic:!1,compare_indicator:2,isShowCompareIndicator:!1}},watch:{reportId:function(){this.reportId&&this.loadReport()},filterToggle:{handler:function(newData,oldData){this.toggleFilter(newData)}},getAvailablePeriods:{handler:function(newData,oldData){var _this=this,avail=this.getAvailablePeriods,selected=avail.find((function(a){return a.value===_this.analyticsConfig.period&&a.enable}));if(!selected){var filterName=this.analyticsConfig.dateFilter.operationOn,defaultPeriod=avail.filter((function(a){return a.enable}))[0].value;"week"===filterName||"month"===filterName?defaultPeriod=12:"year"===filterName&&(defaultPeriod=10),this.analyticsConfig.period=defaultPeriod}},immediate:!0},showChartCustomization:function(newVal){var self=this;self.$nextTick((function(){self.$refs["newAnalyticReport"]&&self.$refs["newAnalyticReport"].resize&&self.$refs["newAnalyticReport"].resize()}))},compare_indicator:function(){var self=this;self.$nextTick((function(){self.$refs["newAnalyticReport"]&&self.$refs["newAnalyticReport"].resize&&self.$refs["newAnalyticReport"].resize()}))}},created:function(){this.$store.dispatch("loadAlarmSeverity"),this.$store.dispatch("loadAssetCategory")},mounted:function(){if(!this.alarmPdf){if(this.isSiteAnalysis&&(this.analyticsConfig.analyticsType=6),this.$route.query.filters){var filters=this.$route.query.filters,filtersJSON=JSON.parse(filters);this.analyticsConfig=deepmerge/* default */.Z.objectAssignDeep(this.analyticsConfig,filtersJSON)}(this.reportId||this.alarmId||this.cardId)&&(this.$mobile?this.loadReport(this.mobileConfig):this.loadReport());var self=this;self.$http.get("/baseline/all").then((function(response){if(200===response.status){self.baseLineList=response.data?response.data:[],self.baseLineCasecaderOptions=[],self.baseLineCasecaderOptions.push({label:"None",value:-1});var _step,_iterator=(0,createForOfIteratorHelper/* default */.Z)(self.baseLineList);try{for(_iterator.s();!(_step=_iterator.n()).done;){var b=_step.value,children=null;"PREVIOUS_MONTH"===b.rangeTypeEnum||"ANY_MONTH"===b.rangeTypeEnum?children=[{label:"Same date",value:4},{label:"Same week",value:1}]:"PREVIOUS_YEAR"!==b.rangeTypeEnum&&"ANY_YEAR"!==b.rangeTypeEnum||(children=[{label:"Same date",value:3},{label:"Same week",value:1}]),"PREVIOUS"!==b.rangeTypeEnum&&self.baseLineCasecaderOptions.push({label:b.name,value:b.id,children:children})}}catch(err){_iterator.e(err)}finally{_iterator.f()}}})),self.loadZones()}},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({assetCategory:function(state){return state.assetCategory}})),{},{isFilterActive:function(){var self=this;if(this.reportObject){var isFilterActive=self.checkFilterFeasibility(self.reportObject);return isFilterActive&&(self.filterTitle=self.analyticsConfig.template&&self.analyticsConfig.template.criteria?"Specific "+self.assetCategoryName+" Selected":"All "+self.assetCategoryName),isFilterActive}return!1},cssLeft:function(){return"3px !important"},isOptimize:function(){return!!this.$route.query.newchart},show:function(){return!(this.resultObject&&this.resultObject.report.dataPoints.length>1)||!!this.analyticsConfig.sorting.sortByField},isSiteAnalysis:function(){return this.$route.meta&&"site"===this.$route.meta.analyticsType},isSameDataPoint:function(){if(this.analyticsConfig&&this.analyticsConfig.dataPoints.length){var _step2,dp={},_iterator2=(0,createForOfIteratorHelper/* default */.Z)(this.analyticsConfig.dataPoints);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var d=_step2.value;dp[d.yAxis.fieldId]=!0}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}if(1===Object.keys(dp).length)return!0}return!1},isSameCategoryDataPoint:function(){if(this.analyticsConfig&&this.analyticsConfig.dataPoints.length>1){var _step3,dp={},_iterator3=(0,createForOfIteratorHelper/* default */.Z)(this.analyticsConfig.dataPoints);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var d=_step3.value;dp[d.categoryId]=!0}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}if(1===Object.keys(dp).length)return!1}return!0},getAvailableGroupAggr:function(){var avail=[];return avail.push({name:this.$t("common.wo_report.none"),value:null,enable:!0}),avail.push({name:this.$t("common._common.daily"),value:12,enable:19===this.analyticsConfig.period}),avail.push({name:this.$t("common._common.monthly"),value:10,enable:[17,18,19].includes(this.analyticsConfig.period)}),avail.push({name:this.$t("common.header.hour_of_day"),
// 12, 1, 2, 3
value:19,enable:[12,11,10,8,25,17,18].includes(this.analyticsConfig.period)}),avail.push({name:this.$t("common.header.day_of_week"),
// sun, mon
value:17,enable:[11,10,8,25].includes(this.analyticsConfig.period)}),avail.push({name:this.$t("common.header.day_of_month"),
// 1,2,3
value:18,enable:[10,8,25].includes(this.analyticsConfig.period)}),avail},getAvailablePeriods:function(){var operationOnId=this.analyticsConfig.dateFilter.operationOnId,avail=[];return avail.push({name:this.$t("common.wo_report.high_res"),value:0,enable:6===operationOnId||4!==operationOnId}),avail.push({name:this.$t("common.wo_report.hourly"),value:20,enable:6===operationOnId||4!==operationOnId}),avail.push({name:this.$t("common._common.daily"),value:12,enable:!0}),avail.push({name:this.$t("common._common.weekly"),value:11,enable:!0}),avail.push({name:this.$t("common._common.monthly"),value:10,enable:!0}),avail.push({name:this.$t("common.products.quarterly"),value:25,enable:4===operationOnId||5===operationOnId}),avail.push({name:this.$t("common._common.yearly"),value:8,enable:4===operationOnId}),avail.push({name:this.$t("common.header.hour_of_day"),
// 12, 1, 2, 3
value:19,enable:!0}),avail.push({name:this.$t("common.header.day_of_week"),
// sun, mon
value:17,enable:!0}),avail.push({name:this.$t("common.header.day_of_month"),
// 1,2,3
value:18,enable:!0}),avail},hasBooleanEnumPoints:function(){if(this.analyticsConfig.dataPoints.length){var highResPoints=this.analyticsConfig.dataPoints.filter((function(dp){return[4,8].includes(dp.yAxis.dataType)}));if(highResPoints.length)return!0}return!1}}),methods:{compareIndicatorChange:function(){var _this$reportObject;null!==this&&void 0!==this&&null!==(_this$reportObject=this.reportObject)&&void 0!==_this$reportObject&&null!==(_this$reportObject=_this$reportObject.options)&&void 0!==_this$reportObject&&_this$reportObject.tooltip&&this.$set(this.reportObject.options.tooltip,"compare_indicator",this.compare_indicator)},hideFilter:function(val){this.hideFilterDynamic=val},toggleFilter:function(val){var _this2=this;if(this.analyticsConfig&&this.analyticsConfig.template)this.$set(this.analyticsConfig.template,"show",val);else{
// create a new template
var config=JSON.parse(JSON.stringify(this.analyticsConfig)),duplicateCase=this.getDuplicateCase(this.reportObject);this.prepareReportTemplate(this.resultObject,duplicateCase.case).then((function(newTemplate){newTemplate.show=val,config.template=newTemplate,_this2.analyticsConfig=config}))}},toggleTemplateFilter:function(val){var _this3=this;this.analyticsConfig&&this.analyticsConfig.template&&this.$nextTick((function(){_this3.analyticsConfig.template.show=val}))},setTemplateFilterCriteria:function(val){this.templateCriteria=val},PointSelector:function(){1===this.analyticsConfig.mode||11===this.analyticsConfig.mode||"reading"===this.analyticsConfig.mode?this.showDataPointSelector=!0:this.showBuildingPointSelector=!0},addFilterCriteria:function(){var _this4=this,config=JSON.parse(JSON.stringify(this.analyticsConfig));if(this.showFilter=!1,config.parentId=null,config.template)config.template.criteria=this.templateCriteria,this.analyticsConfig=config;else{var duplicateCase=this.getDuplicateCase(this.reportObject);this.prepareReportTemplate(this.resultObject,duplicateCase.case).then((function(newTemplate){newTemplate.criteria=_this4.templateCriteria,config.template=newTemplate,_this4.analyticsConfig=config}))}},openFilter:function(){this.isFilterActive?this.showFilter=!0:this.showFilter=!1},toggleSideBar:function(){this.hideSideBar?(this.hideSideBar=!1,this.$refs["newAnalyticReport"]&&this.$refs["newAnalyticReport"].resize()):(this.hideSideBar=!0,this.$refs["newAnalyticReport"]&&this.$refs["newAnalyticReport"].resize())},loadSpaceList:function(){var self=this;if(self.selectedBuildings)for(var buildingId in self.selectedCategory.FloorList=[],self.selectedCategory.spaceList=[],self.loading=!0,self.selectedBuildings)self.$http.get("/floor?buildingId="+self.selectedBuildings[buildingId]).then((function(response){self.selectedCategory.FloorList=response.data.records})),self.$util.loadSpacesContext(4,null,[{key:"building",operator:"is",value:self.selectedBuildings[buildingId]},{key:"floor",operator:"is empty"}]).then((function(response){self.selectedCategory.spaceList=response.records}))},loadAssetCategories:function(readings){var self=this;if(readings){var categoryIds=Object.keys(readings.categoryWithFields);self.selectedCategory.categoryList=self.assetCategory.filter((function(ele){for(var index=0;index<categoryIds.length;index++){var element=categoryIds[index];if(parseInt(element)===ele.id)return ele.toggle=!1,ele}})),self.filterAssetsFromCategory(readings)}},updateFilterdata:function(root){if("category"===root){this.selectedCategory.assetList=[];for(var i=0;i<this.reportFilterForm.categoryFilter.length;i++)this.selectedCategory.assetList=[].concat((0,toConsumableArray/* default */.Z)(this.selectedCategory.assetList),(0,toConsumableArray/* default */.Z)(Object.keys(this.assetCategoryMap[this.reportFilterForm.categoryFilter[i]])))}},filterAssetsFromCategory:function(readings){var self=this;self.assetCategoryMap=readings.categoryWithAssets,this.selectedCategory.assetList=[];for(var i=0;i<this.reportFilterForm.categoryFilter.length;i++)this.selectedCategory.assetList=[].concat((0,toConsumableArray/* default */.Z)(this.selectedCategory.assetList),(0,toConsumableArray/* default */.Z)(Object.keys(this.assetCategoryMap[this.reportFilterForm.categoryFilter[i]])));this.selectedCategory.allAsset=self.selectedCategory.assetList,self.assetsMap=readings.assets},resetspaceFilter:function(){this.reportFilterForm={floorFilter:[],SpaceFilter:[],categoryFilter:[],assetFilter:[],liveFilterField:"none",liveFilterType:"single"},this.applyFilter(null)},applyFilter:function(){if(this.reportFilterForm.categoryFilter.length||this.reportFilterForm.assetFilter.length||"none"!==this.reportFilterForm.liveFilterField||"single"!==this.reportFilterForm.liveFilterType)if(this.setfilter=1,this.reportFilterForm.categoryFilter.length||this.reportFilterForm.assetFilter.length)if(this.reportFilterForm.assetFilter.length)this.analyticsConfig.filters={xCriteriaMode:3,parentId:this.reportFilterForm.assetFilter,filterState:this.$helpers.cloneObject(this.reportFilterForm)};else{var spaceFilter=this.selectedBuildings;this.analyticsConfig.filters={xCriteriaMode:4,assetCategory:this.reportFilterForm.categoryFilter,spaceId:spaceFilter,filterState:this.$helpers.cloneObject(this.reportFilterForm)}}else this.analyticsConfig.filters={xCriteriaMode:2,filterState:this.$helpers.cloneObject(this.reportFilterForm)};else this.setfilter=0;this.spacefiltersPopover=!1},prepareDataPointSummary:function(){var _this5=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var summaryList,weatherModules,_iterator4,_step4,dataPoint,_dataPoint$yAxis$modu,_dataPoint$yAxis$modu2,_yield$API$post,error,data,kpiTypeEnum;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(!_this5.resultObject){_context.next=39;break}summaryList=[],weatherModules={weather:"Live Weather",weatherDaily:"Daily Weather",psychrometric:"Psychrometric",cdd:"Degree Days",wdd:"Degree Days",hdd:"Degree Days"},_iterator4=(0,createForOfIteratorHelper/* default */.Z)(_this5.resultObject.report.dataPoints),_context.prev=4,_iterator4.s();case 6:if((_step4=_iterator4.n()).done){_context.next=30;break}if(dataPoint=_step4.value,2===dataPoint.type||dataPoint.duplicateDataPoint||5===dataPoint.type){_context.next=28;break}if(!Object.keys(weatherModules).includes(null===(_dataPoint$yAxis$modu=dataPoint.yAxis.module)||void 0===_dataPoint$yAxis$modu?void 0:_dataPoint$yAxis$modu.name)){_context.next=13;break}_this5.addToGroup(dataPoint,weatherModules[dataPoint.yAxis.module.name],summaryList),_context.next=28;break;case 13:if("MV_Readings"!==(null===(_dataPoint$yAxis$modu2=dataPoint.yAxis.module)||void 0===_dataPoint$yAxis$modu2?void 0:_dataPoint$yAxis$modu2.tableName)){_context.next=17;break}_this5.addToGroup(dataPoint,"M&Vs",summaryList),_context.next=28;break;case 17:if(dataPoint.metaData.parentIds[0]!==parseInt(_this5.selectedBuildings[0])||"scheduled_formula"!==dataPoint.yAxis.module.typeEnum.toLowerCase()){_context.next=21;break}_this5.addToGroup(dataPoint,"Enpi",summaryList),_context.next=28;break;case 21:return _context.next=23,api/* API */.bl.post("v2/resource/getResourcesDetails",{resourceId:dataPoint.metaData.parentIds});case 23:_yield$API$post=_context.sent,error=_yield$API$post.error,data=_yield$API$post.data,kpiTypeEnum=_this5.$getProperty(dataPoint,"yAxis.module.typeEnum")||null,error||("SPACE"===data.resource[0].resourceTypeEnum?_this5.addToGroup(dataPoint,"Space",summaryList):(0,validation/* isEmpty */.xb)(dataPoint.kpiType)?_this5.addToGroup(dataPoint,"Asset",summaryList):_this5.addToGroup(dataPoint,"kpi",summaryList,kpiTypeEnum));case 28:_context.next=6;break;case 30:_context.next=35;break;case 32:_context.prev=32,_context.t0=_context["catch"](4),_iterator4.e(_context.t0);case 35:return _context.prev=35,_iterator4.f(),_context.finish(35);case 38:return _context.abrupt("return",summaryList);case 39:case"end":return _context.stop()}}),_callee,null,[[4,32,35,38]])})))()},addToGroup:function(dataPoint,label,summaryList){var _this6=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var _dataPoint$yAxis$fiel,reading,dynamicKpi,selectedBuidlingSiteId,_yield$API$get,error,data,temp,readingGroup,groupIndex,_temp;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if(reading={},dynamicKpi=_this6.$getProperty(dataPoint,"dynamicKpi.dynamicKpi")||null,(0,validation/* isEmpty */.xb)(dynamicKpi)?reading["readingId"]=dataPoint.yAxis.fieldId:(reading["kpiType"]="DYNAMIC",reading["readingId"]=parseInt(dynamicKpi)),reading["readingLabel"]=null===(_dataPoint$yAxis$fiel=dataPoint.yAxis.field)||void 0===_dataPoint$yAxis$fiel?void 0:_dataPoint$yAxis$fiel.displayName,selectedBuidlingSiteId=null,"Asset"===label||"Space"===label||"Enpi"===label||"kpi"===label||!_this6.selectedBuildings[0]){_context2.next=12;break}return _context2.next=8,api/* API */.bl.get("/v2/pages/building",{id:parseInt(_this6.selectedBuildings[0])});case 8:_yield$API$get=_context2.sent,error=_yield$API$get.error,data=_yield$API$get.data,!error&&null!==data&&void 0!==data&&data.record&&(selectedBuidlingSiteId=data.record.siteId);case 12:reading["resourceId"]="Asset"===label||"kpi"===label?parseInt(dataPoint.metaData.parentIds[0]):"Space"===label||"Enpi"===label?parseInt(_this6.selectedBuildings[0]):selectedBuidlingSiteId,reading["resourceLabel"]=dataPoint.resourceName,reading["marked"]=null,reading["location"]=_this6.selectedBuildingTitle,reading["categoryId"]=dataPoint.assetCategoryId,reading["buildingId"]=dataPoint.buildingId,summaryList&&0===summaryList.length?(temp={},temp["label"]=label,temp["readings"]=[],temp.readings.push(reading),summaryList.push(temp)):summaryList&&summaryList.length>0&&(readingGroup=summaryList.filter((function(group){return group.label===label})),0!==readingGroup.length?(readingGroup[0].readings.push(reading),groupIndex=summaryList.findIndex((function(group){return group.label===readingGroup[0].label})),-1!=groupIndex&&(summaryList.splice(groupIndex,1),summaryList.push(readingGroup[0]))):(_temp={},_temp["label"]=label,_temp["readings"]=[],_temp.readings.push(reading),summaryList.push(_temp)));case 18:case"end":return _context2.stop()}}),_callee2)})))()},loadAlarmMeta:function(){var _this7=this;this.$http.post("/dashboard/getReportMetaForAlarms",{alarmId:this.$route.query.alarmId}).then((function(response){response.data&&response.data.reportMeta&&(_this7.analyticsConfig.dataPoints=response.data.reportMeta.dataPoints)}))},reportLoaded:function(report,result){var _this8=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:if(!0===_this8.noChartState&&(_this8.noChartState=!1),_this8.reportObject=report,_this8.$route.query.reportId&&(_this8.filterToggle=4===report.reportType),_this8.resultObject=result,!(_this8.analyticsConfig.savedReport||_this8.$route.query.filters||_this8.analyticsConfig.template)){_context3.next=9;break}if([8,9,10,"mv"].includes(_this8.analyticsConfig.mode)){_context3.next=9;break}return _context3.next=8,_this8.prepareDataPointSummary();case 8:_this8.dataPointSummaryList=_context3.sent;case 9:4===_this8.reportObject.reportType&&_this8.reportObject.options.reportTemplate.buildingId?(report.options.common.buildingIds.push(_this8.reportObject.options.reportTemplate.buildingId),_this8.resetDataPointSelector(report.options.common.buildingIds)):report.options.common&&report.options.common.buildingIds&&(!report.options.common.buildingIds.length&&_this8.selectedBuildings?_this8.$route.query.filters||_this8.$route.query.alarmId||_this8.$route.query.cardId?(_this8.analyticsConfig.buildingId?_this8.reportObject.options.common.buildingIds.push(_this8.analyticsConfig.buildingId):_this8.$route.query.buildingId?_this8.reportObject.options.common.buildingIds.push(_this8.$route.query.buildingId):_this8.reportObject.options.common.buildingIds=_this8.selectedBuildings,_this8.resetDataPointSelector(_this8.reportObject.options.common.buildingIds)):_this8.reportObject.options.common.buildingIds=_this8.selectedBuildings:_this8.resetDataPointSelector(report.options.common.buildingIds));case 10:case"end":return _context3.stop()}}),_callee3)})))()},removeFilters:function(parentKey){var _this$analyticsConfig,filters=null===(_this$analyticsConfig=this.analyticsConfig)||void 0===_this$analyticsConfig?void 0:_this$analyticsConfig.reportFilter;if((0,validation/* isEmpty */.xb)(filters.timeFilter)||"TimeFilter"!==parentKey){if(!(0,validation/* isEmpty */.xb)(filters.dataFilter&&parentKey.includes("Cri"))){var criteriaId=parentKey.split("_")[1],length=Object.keys(filters.dataFilter.conditions).length;length>1?(delete filters.dataFilter.conditions[criteriaId],this.$set(this.analyticsConfig.reportFilter,filters)):filters.dataFilter.conditions={}}}else filters.timeFilter.conditions={}},loadZones:function(){var self=this;self.$http.get("/zone").then((function(response){response.data&&response.data.records&&(self.zones=response.data.records)}))},resetDataPointSelector:function(buildingIds){if(1===this.analyticsConfig.mode||"reading"===this.analyticsConfig.mode||11===this.analyticsConfig.mode)if("reading"===this.analyticsMode){var _this$$refs$building,filteredPoints=this.analyticsConfig.dataPoints.filter((function(dp){return!(dp.xDataPoint&&!0===dp.xDataPoint)}));null===(_this$$refs$building=this.$refs["building-selector"])||void 0===_this$$refs$building||_this$$refs$building.setInitialValues(filteredPoints,buildingIds)}else{var _this$$refs$building2;null===(_this$$refs$building2=this.$refs["building-selector"])||void 0===_this$$refs$building2||_this$$refs$building2.setInitialValues(this.analyticsConfig.dataPoints,buildingIds)}else if([8,9,10,"mv"].includes(this.analyticsConfig.mode)){var _this$$refs$portfolio;null===(_this$$refs$portfolio=this.$refs["portfolio-building-selector"])||void 0===_this$$refs$portfolio||_this$$refs$portfolio.setInitialValues(this.analyticsConfig.dataPoints,buildingIds)}},updateDataPoints:function(changedDataPoints){var _this9=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){var selectedBuidlingSiteId,_yield$API$get2,error,data,siteId,pointToAdd,configIndexes,alreadyAddedIndexes,pointsToRemove,optionPoints,isValid,idx;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:if(![8,9,10].includes(_this9.analyticsConfig.mode)){_context4.next=4;break}_this9.analyticsConfig.filters={xCriteriaMode:4,spaceId:_this9.selectedBuildings},_context4.next=18;break;case 4:if("mv"!==_this9.analyticsConfig.mode){_context4.next=17;break}if(selectedBuidlingSiteId=null,"Asset"===label||"Space"===label||"Enpi"===label||!_this9.selectedBuildings[0]){_context4.next=13;break}return _context4.next=9,api/* API */.bl.get("/v2/pages/building",{id:parseInt(_this9.selectedBuildings[0])});case 9:_yield$API$get2=_context4.sent,error=_yield$API$get2.error,data=_yield$API$get2.data,!error&&null!==data&&void 0!==data&&data.record&&(selectedBuidlingSiteId=data.record.siteId);case 13:siteId=selectedBuidlingSiteId,_this9.analyticsConfig.filters={xCriteriaMode:4,spaceId:[siteId+""]},_context4.next=18;break;case 17:_this9.analyticsConfig.filters={xCriteriaMode:2};case 18:pointToAdd=null,_this9.analyticsConfig.dataPoints.length?(configIndexes=[],alreadyAddedIndexes=[],pointsToRemove=[],_this9.enableReadingSelection=changedDataPoints.length>1,"reading"===_this9.analyticsMode&&null!==_this9.analyticsConfig.dimensionDataPoint&&(pointToAdd=_this9.analyticsConfig.dataPoints[_this9.analyticsConfig.dimensionDataPoint]),optionPoints=[],_this9.reportObject.options.dataPoints.forEach((function(dp){"group"===dp.type?optionPoints.push.apply(optionPoints,(0,toConsumableArray/* default */.Z)(dp.children)):optionPoints.push(dp)})),isValid=optionPoints.filter((function(dp){return 2!==dp.pointType&&!dp.duplicateDataPoint})).every((function(dp){var idx=changedDataPoints.findIndex((function(cdp){return cdp.parentId===dp.parentId&&cdp.yAxis.fieldId===dp.fieldId}));if(-1===idx){if(!_this9.checkAndDeletePointsRel(_this9.reportObject.options,dp.alias))return _this9.$message.error(dp.label+" has been used in derivation(s). Please delete the derivations before removing this point"),_this9.resetDataPointSelector(),!1;pointsToRemove.push(dp.alias)}if(-1!==idx){var configIdx=_this9.getConfigDataPointFromOptionDP(_this9.analyticsConfig,dp,!0);configIndexes.push(configIdx),alreadyAddedIndexes.push(idx)}return!0})),isValid&&(_this9.removeOptionPoints(_this9.reportObject.options,pointsToRemove),_this9.analyticsConfig.dataPoints=[].concat((0,toConsumableArray/* default */.Z)(_this9.analyticsConfig.dataPoints.filter((function(dp,idx){return 2===dp.type||dp.duplicateDataPoint||configIndexes.includes(idx)}))),(0,toConsumableArray/* default */.Z)(changedDataPoints.filter((function(cdp,idx){return!alreadyAddedIndexes.includes(idx)})))))):_this9.analyticsConfig.dataPoints=changedDataPoints,null!==pointToAdd&&(idx=_this9.analyticsConfig.dataPoints.findIndex((function(adp){return adp.parentId===pointToAdd.parentId&&adp.yAxis.fieldId===pointToAdd.yAxis.fieldId})),-1===idx&&(_this9.analyticsConfig.dataPoints.push(pointToAdd),_this9.analyticsConfig.dimensionDataPoint=_this9.analyticsConfig.dataPoints.length-1)),_this9.hasBooleanEnumPoints&&_this9.analyticsConfig.groupByTimeAggr&&(_this9.analyticsConfig.groupByTimeAggr=null),_this9.addPredictionFields(_this9.analyticsConfig),_this9.showDataPointSelector=!1,_this9.showBuildingPointSelector=!1;case 25:case"end":return _context4.stop()}}),_callee4)})))()},updateDimensionDataPoints:function(changedDataPoints){var index=this.analyticsConfig.dataPoints.findIndex((function(dp){return dp.parentId===changedDataPoints[0].parentId&&dp.yAxis.fieldId===changedDataPoints[0].yAxis.fieldId}));if(-1===index){var idx=this.analyticsConfig.dataPoints.findIndex((function(dp){return!0===dp.xDataPoint}));changedDataPoints[0]["xDataPoint"]=!0,-1===idx?(idx=0,this.analyticsConfig.dataPoints.push(changedDataPoints[0]),this.analyticsConfig.dimensionDataPoint=this.analyticsConfig.dataPoints.length-1):(this.analyticsConfig.dataPoints[idx]=changedDataPoints[0],this.analyticsConfig.dimensionDataPoint=idx)}else this.analyticsConfig.dimensionDataPoint=index;this.addPredictionFields(this.analyticsConfig),this.showHeatMapPointSelector=!1},showChartCustomizationDialog:function(defaultTab){this.hideSideBar=!1,this.showgeneratedata=!1,this.showChartCustomization=!0,defaultTab&&(this.chartCustomizationActiveTab=defaultTab)},hideChartCustomizationDialog:function(){this.showChartCustomization=!1},showgeneratedataDialog:function(){this.hideSideBar=!1,this.showChartCustomization=!1,this.showgeneratedata=!0},setSelectedBuildings:function(_ref){var name=_ref.name,ids=_ref.ids;this.selectedBuildingTitle=name,this.selectedBuildings=ids,this.reportObject&&this.reportObject.options&&this.reportObject.options.common&&(this.reportObject.options.common.buildingIds=this.selectedBuildings)},onPeriodChange:function(){if([8,10,11,12,17,18,19,25].includes(this.analyticsConfig.period)||(this.analyticsConfig.groupByTimeAggr=null),this.analyticsConfig.groupByTimeAggr&&([17,18].includes(this.analyticsConfig.period)&&![10,19].includes(this.analyticsConfig.groupByTimeAggr)||12===this.analyticsConfig.period&&19!==this.analyticsConfig.groupByTimeAggr?this.analyticsConfig.groupByTimeAggr=19:11!==this.analyticsConfig.period||[19,17].includes(this.analyticsConfig.groupByTimeAggr)?19!==this.analyticsConfig.period||[12,10].includes(this.analyticsConfig.groupByTimeAggr)||(this.analyticsConfig.groupByTimeAggr=12):this.analyticsConfig.groupByTimeAggr=17),!this.analyticsConfig.dataPoints.length){var filter=22;20===this.analyticsConfig.period?filter=31:12===this.analyticsConfig.period?filter=28:10===this.analyticsConfig.period&&(filter=44),this.analyticsConfig.dateFilter=NewDateHelper/* default */.Z.getDatePickerObject(filter)}},onModeChange:function(){(this.reportId||this.alarmId||this.cardId)&&(this.spinnerToggle=!1),this.noChartState=!0,![8,9,10].includes(this.analyticsConfig.mode)&&[8,9,10].includes(this.analyticsMode)||"mv"===this.analyticsMode?(
//Asset,Floor,Space,M&V
this.analyticsConfig.dataPoints=[],this.resetDataPointSelector(this.selectedBuildings),this.analyticsConfig.dimensionDataPoint=null):1===this.analyticsConfig.mode||"reading"===this.analyticsConfig.mode||[8,9,10].includes(this.analyticsMode)?8===this.analyticsMode&&this.isSameCategoryDataPoint&&(this.$message({message:"Please choose only a single asset category point to analyse across asset as dimension.",type:"warning"}),this.analyticsConfig.dataPoints=[],this.resetDataPointSelector(this.selectedBuildings),this.analyticsConfig.dimensionDataPoint=null):(
//Reading,Time,TimeDuration
this.analyticsConfig.dataPoints=[],this.resetDataPointSelector(this.selectedBuildings)),"reading"!==this.analyticsMode&&(this.analyticsConfig.dimensionDataPoint=null),this.analyticsConfig.mode=this.analyticsMode,this.enableReadingSelection=this.analyticsConfig.dataPoints.length>1},OnXdatapointChange:function(){var _this$$refs$singlePo;if("reading"===this.analyticsConfig.mode&&null!==this.analyticsConfig.dimensionDataPoint){var point=this.analyticsConfig.dataPoints[this.analyticsConfig.dimensionDataPoint];point.xDataPoint&&!0===point.xDataPoint||(this.analyticsConfig.dataPoints=this.analyticsConfig.dataPoints.filter((function(dp){return!(dp.xDataPoint&&!0===dp.xDataPoint)})))}11===this.analyticsConfig.mode&&null!==this.analyticsConfig.dimensionDataPoint&&(this.analyticsConfig.dataPoints=[this.analyticsConfig.dataPoints[this.analyticsConfig.dimensionDataPoint]]),null===(_this$$refs$singlePo=this.$refs["single-point-selector"])||void 0===_this$$refs$singlePo||_this$$refs$singlePo.setInitialValues([],this.selectedBuildings)},onBaseLineChange:function(newBaseLine){var _this10=this;if(!this.oldBaseLine||this.oldBaseLine[0]!==newBaseLine[0]){if(this.oldBaseLine&&-1!==this.oldBaseLine[0]){var oldBlName=this.baseLineList.find((function(bl){return bl.id===_this10.oldBaseLine[0]})).name,dp=this.reportObject.options.dataPoints.find((function(dp){return dp.baseLineName===oldBlName}));if(!this.checkAndDeletePointsRel(this.reportObject.options,dp.alias))return this.$message.error(dp.baseLineName+this.$t("common.header.has_been_derivation_please_delete_derivation")),void this.$set(this.analyticsConfig,"baseLine",this.oldBaseLine)}this.oldBaseLine=(0,toConsumableArray/* default */.Z)(newBaseLine),this.$set(this.analyticsConfig,"baseLine",newBaseLine),!(0,validation/* isEmpty */.xb)(this.oldBaseLine)&&this.oldBaseLine.length>0&&-1!==this.oldBaseLine[0]?this.isShowCompareIndicator=!0:this.isShowCompareIndicator=!1}},onSettingsChange:function(changedOption){"alarm"===changedOption&&(this.reportObj.alarms&&this.reportObj.alarms.regions.length||!this.reportObj.options.settings.alarm||this.initChart())},openTrendLineDialog:function(){this.reportObject.options.trendLine.enable?this.showTrendLine=!0:this.analyticsConfig.trendLineChange++},onTrendLineChange:function(trendLineObj){this.reportObject.options.trendLine=trendLineObj,this.analyticsConfig.trendLineChange++}}},newTools_NewBuildingAnalysisvue_type_script_lang_js=NewBuildingAnalysisvue_type_script_lang_js,NewBuildingAnalysis_component=(0,componentNormalizer/* default */.Z)(newTools_NewBuildingAnalysisvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,NewBuildingAnalysis=NewBuildingAnalysis_component.exports},
/***/839662:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return TrendLine}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/report/components/TrendLine.vue?vue&type=template&id=1413e50e
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"fc-dialog-center-container",attrs:{title:_vm.algorithmType?_vm.getTitle():"TrendLine",visible:_vm.visibility,width:"40%","append-to-body":!0,"show-close":!1,"before-close":_vm.closeTrendLine,"close-on-click-modal":!1},on:{"update:visible":function($event){_vm.visibility=$event}}},[_c("div",{staticClass:"height350 overflow-y-scroll pB80"},[_c("div",{staticClass:"customize-input-block"},[_c("el-row",[_vm.algorithmType?_vm._e():_c("el-col",{staticClass:"mR20",attrs:{span:12}},[_c("div",{staticClass:"label-txt-black"},[_vm._v("Type")]),_c("el-select",{staticClass:"fc-input-full-border2 width100 mT10",attrs:{placeholder:"Select"},model:{value:_vm.trendLineObj.type,callback:function($$v){_vm.$set(_vm.trendLineObj,"type",$$v)},expression:"trendLineObj.type"}},[_c("el-option",{attrs:{label:"Linear",value:"1"}}),_c("el-option",{attrs:{label:"Polynomial",value:"2"}})],1)],1),2==_vm.trendLineObj.type?_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"label-txt-black"},[_vm._v("Degree")]),_c("el-select",{staticClass:"fc-input-full-border2 width100 mT10",attrs:{placeholder:"Select"},model:{value:_vm.trendLineObj.degree,callback:function($$v){_vm.$set(_vm.trendLineObj,"degree",$$v)},expression:"trendLineObj.degree"}},_vm._l(9,(function(n){return _c("el-option",{key:n,attrs:{label:n+1,value:n+1}})})),1)],1):_vm._e()],1)],1),_c("div",{staticClass:"customize-input-block pT20"},[_c("el-row",[_c("el-col",{staticClass:"mR20",attrs:{span:12}},[_c("div",{staticClass:"label-txt-black"},[_vm._v("Decimals")]),_c("el-input",{staticClass:"fc-input-full-border2 width100 mT10",model:{value:_vm.trendLineObj.decimal,callback:function($$v){_vm.$set(_vm.trendLineObj,"decimal",_vm._n($$v))},expression:"trendLineObj.decimal"}})],1),_c("el-col",{staticClass:"pT40 pL20",attrs:{span:10}},[_c("el-checkbox",{directives:[{name:"tippy",rawName:"v-tippy"}],attrs:{label:"Show R",title:"Show R"},model:{value:_vm.trendLineObj.showr2,callback:function($$v){_vm.$set(_vm.trendLineObj,"showr2",$$v)},expression:"trendLineObj.showr2"}})],1)],1)],1),_c("div",{staticClass:"customize-input-block pT20"},[_c("el-row",[_c("el-col",{staticClass:"mR20",attrs:{span:24}},[_c("div",{staticClass:"label-txt-black"},[_vm._v("Data Points")]),_c("el-select",{staticClass:"fc-input-full-border2 width100 mT10 fc-tag",attrs:{placeholder:"All",multiple:"",filterable:"","collapse-tags":""},model:{value:_vm.trendLineObj.selectedPoints,callback:function($$v){_vm.$set(_vm.trendLineObj,"selectedPoints",$$v)},expression:"trendLineObj.selectedPoints"}},_vm._l(_vm.dataPoints.filter((function(dp){return"x"!==dp.axes})),(function(datapoint,index){return _c("el-option",{directives:[{name:"tippy",rawName:"v-tippy"}],key:index,attrs:{label:datapoint.label,title:datapoint.label,value:datapoint.alias}})})),1)],1)],1)],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.closeTrendLine}},[_vm._v("CANCEL")]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:_vm.saveTrendLine}},[_vm._v("SAVE")])],1)])])},staticRenderFns=[],TrendLinevue_type_script_lang_js=(__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(670560),{props:["visibility","report","algorithmType"],created:function(){"undefined"!==typeof this.report&&null!==this.report&&this.load()},data:function(){return{trendLineObj:null,dataPoints:[]}},methods:{load:function(){var _this=this;this.trendLineObj=this.$helpers.cloneObject(this.report.options.trendLine),this.dataPoints=this.$helpers.getDataPoints(this.report.options.dataPoints,[1,2],!1);var selectedPoints=[];this.dataPoints.forEach((function(dp){_this.trendLineObj.selectedPoints.includes(dp.alias)&&selectedPoints.push(dp.alias)})),this.trendLineObj.selectedPoints=selectedPoints,this.algorithmType&&(this.trendLineObj.type=this.algorithmType)},saveTrendLine:function(){this.$emit("onTrendLineChange",this.trendLineObj),this.closeTrendLine()},closeTrendLine:function(){this.$emit("update:visibility",!1)},getTitle:function(){switch(this.algorithmType){case"1":return"LINEAR ALGORITHM";case"2":return"POLYNOMIAL ALGORITHM";default:return"TRENDLINE"}}}}),components_TrendLinevue_type_script_lang_js=TrendLinevue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_TrendLinevue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,TrendLine=component.exports},
/***/676118:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"bb2cda514b874a7abffd2587d2d4f31d.svg";
/***/}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/51349.js.map