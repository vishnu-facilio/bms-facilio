"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[75545],{
/***/201117:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FLookupFieldWrapper}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/FLookupFieldWrapper.vue?vue&type=template&id=0b196d62
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"lookup-wrapper"},[_vm.fieldObj.field?_c("FLookupField",{class:{"handle-wizard-icon":_vm.handleWizardIcon},attrs:{model:_vm.modelObj,field:_vm.fieldObj,disabled:_vm.disabled,siteId:_vm.siteId,hideLookupIcon:_vm.hideWizard,hideDropDown:_vm.hideDropDown,preHookFilterConstruction:_vm.filterConstruction,fetchOptionsOnLoad:_vm.fetchOptionsOnLoad,fetchOptionsMethod:_vm.fetchOptionsMethod},on:{"update:model":function($event){_vm.modelObj=$event},showLookupWizard:_vm.showLookupWizard,recordSelected:_vm.onRecordSelected}}):_c("el-input"),!_vm.hideWizard&&_vm.canShowLookupWizard?_c("div",[_c("FLookupFieldWizard",{attrs:{canShowLookupWizard:_vm.canShowLookupWizard,selectedLookupField:_vm.fieldObj,siteId:_vm.siteId,withReadings:_vm.withReadings},on:{"update:canShowLookupWizard":function($event){_vm.canShowLookupWizard=$event},"update:can-show-lookup-wizard":function($event){_vm.canShowLookupWizard=$event},setLookupFieldValue:_vm.setLookupFieldValue,showMainFieldSearch:function($event){return _vm.onWizardShow(!1)}}})],1):_vm._e()],1)},staticRenderFns=[],slicedToArray=__webpack_require__(554621),FLookupField=(__webpack_require__(879288),__webpack_require__(260228),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(450886),__webpack_require__(947522),__webpack_require__(670560),__webpack_require__(425728),__webpack_require__(434284),__webpack_require__(634338),__webpack_require__(891719),__webpack_require__(855048)),validation=__webpack_require__(990260),FLookupFieldWrappervue_type_script_lang_js={name:"f-lookup-field-wrapper",props:{value:[Number,String,Array],label:String,
// Label of selected value if any
formField:Object,field:Object,
// Pass field object if form field not available and field avaialble
moduleName:String,
// Pass module name and field name if field object not avaialble
fieldName:String,disabled:{type:Boolean,default:!1},siteId:Number,hideWizard:{type:Boolean,default:!1},hideDropDown:{type:Boolean,default:!1},fetchOptionsOnLoad:{type:Boolean,default:!0},fetchOptionsMethod:{type:Function},withReadings:Boolean,handleWizardIcon:{
// To handle wizard icon css
type:Boolean,default:!0},filterConstruction:{type:Function,default:function(field){return field.filters}}},components:{FLookupField:FLookupField/* default */.Z,FLookupFieldWizard:function(){return Promise.all(/* import() */[__webpack_require__.e(93208),__webpack_require__.e(50232),__webpack_require__.e(93765),__webpack_require__.e(95953),__webpack_require__.e(35309),__webpack_require__.e(18778),__webpack_require__.e(12303),__webpack_require__.e(84290),__webpack_require__.e(31721),__webpack_require__.e(64418),__webpack_require__.e(5603),__webpack_require__.e(57432),__webpack_require__.e(435),__webpack_require__.e(72230),__webpack_require__.e(94255),__webpack_require__.e(67683),__webpack_require__.e(44178),__webpack_require__.e(91132),__webpack_require__.e(20280),__webpack_require__.e(78256),__webpack_require__.e(22200),__webpack_require__.e(49081),__webpack_require__.e(89472),__webpack_require__.e(12085),__webpack_require__.e(55754),__webpack_require__.e(86494),__webpack_require__.e(3037),__webpack_require__.e(49908),__webpack_require__.e(22061),__webpack_require__.e(31602),__webpack_require__.e(73609),__webpack_require__.e(99751),__webpack_require__.e(42054)]).then(__webpack_require__.bind(__webpack_require__,499751))}},data:function(){return{fieldObj:{isDataLoading:!1,options:[],lookupModuleName:"",field:null,filters:{},isDisabled:!1},canShowLookupWizard:!1}},computed:{modelObj:{get:function(){return(0,validation/* isEmpty */.xb)(this.value)?this.value:(0,validation/* isArray */.kJ)(this.value)?this.value.map((function(val){return parseInt(val)})):parseInt(this.value)},set:function(value){this.$emit("input",value)}}},created:function(){this.handleDefaultOption()},mounted:function(){var formField=this.formField,field=this.field;(0,validation/* isEmpty */.xb)(formField)?(0,validation/* isEmpty */.xb)(field)?this.fetchField():this.setField(field):this.fieldObj=formField},watch:{canShowLookupWizard:function(value){value||this.onWizardShow(value)}},methods:{showLookupWizard:function(field,canShow){this.fieldObj=field,this.canShowLookupWizard=canShow,this.onWizardShow(!0)},setLookupFieldValue:function(props){var _this=this,field=props.field,_ref=field||{},multiple=_ref.multiple,selectedItems=_ref.selectedItems;if(multiple){var valueArr=[];selectedItems.forEach((function(item){var value=item.value,label=item.label;_this.addOption(value,label),valueArr.push(value)})),this.modelObj=valueArr,this.onRecordSelected(selectedItems,valueArr)}else{var _ref2=selectedItems||[],_ref3=(0,slicedToArray/* default */.Z)(_ref2,1),selectedItem=_ref3[0],value=selectedItem.value,label=selectedItem.label;this.addOption(value,label),this.modelObj=value,this.onRecordSelected(selectedItem)}this.onWizardShow(!1)},onWizardShow:function(show){this.$emit("showingLookupWizard",show)},fetchField:function(){var _this2=this,moduleName=this.moduleName,fieldName=this.fieldName;this.$util.loadModuleMeta(moduleName).then((function(meta){var field=meta.fields.find((function(field){return field.name===fieldName}));_this2.setField(field)}))},onRecordSelected:function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];this.$emit.apply(this,["recordSelected"].concat(args))},handleDefaultOption:function(){var label=this.label,value=this.value;(0,validation/* isEmpty */.xb)(label)||(0,validation/* isEmpty */.xb)(value)||this.addOption(value,label)},setField:function(field){var fieldObj=this.fieldObj;fieldObj.field=field,fieldObj.multiple=field.multiple,fieldObj.lookupModuleName=field.lookupModule.name,(0,validation/* isArray */.kJ)(this.modelObj)?fieldObj.selectedItems=this.modelObj.map((function(id){return{value:id}})):fieldObj.selectedItems={value:this.modelObj}},addOption:function(id,label){var fieldObj=this.fieldObj,options=fieldObj.options,newOptionObj={label:label,value:id};(0,validation/* isEmpty */.xb)(options)?options.push(newOptionObj):options.some((function(option){return option.value===id}))||options.unshift(newOptionObj),this.$set(this.fieldObj,"options",options)}}},components_FLookupFieldWrappervue_type_script_lang_js=FLookupFieldWrappervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FLookupFieldWrappervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FLookupFieldWrapper=component.exports},
/***/855048:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FLookupField}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/forms/FLookupField.vue?vue&type=template&id=473d4b8e
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.isFieldLoading?_c("FieldLoader",{attrs:{isLoading:_vm.isFieldLoading}}):_c("div",{staticClass:"f-lookup-chooser f-lookup-chooser-container"},[_c("el-select",{ref:"selectBox",class:["fc-input-full-border-select2 width100",(!_vm.canHideLookupIcon||_vm.canShowQuickCreateIcon)&&"resource-search",_vm.isMultiple&&"fc-tag",_vm.hideDropDown&&!_vm.disabled&&"skip-disable"],attrs:{"collapse-tags":"",remote:_vm.isRemote,filterable:"",clearable:_vm.canHideLookupIcon,multiple:_vm.isMultiple,popperAppendToBody:_vm.popperAppendToBody,"remote-method":function(searchText){return _vm.remoteMethod(searchText)},loading:_vm.field.isDataLoading,"loading-text":_vm.$t("common._common.searching"),disabled:_vm.disabled||_vm.hideDropDown,placeholder:_vm.field.placeHolderText||"Select"},on:{change:_vm.recordSelected},model:{value:_vm.modelObj,callback:function($$v){_vm.modelObj=$$v},expression:"modelObj"}},[_c("div",{staticClass:"flRight d-flex",class:!_vm.disabled&&"pointer",attrs:{slot:"prefix"},slot:"prefix"},[_vm.canShowSystemClear?_c("div",{staticClass:"flookup-remove-icon-alignment flookup-remove-icon",on:{click:_vm.clearData}},[_c("i",{staticClass:"el-icon-circle-close pointer fc-lookup-icon f13"})]):_vm._e(),_vm.canHideLookupIcon?_vm._e():_c("div",{staticClass:"icon-class-alignment",on:{click:function($event){return $event.stopPropagation(),_vm.openLookupFieldWizard(_vm.field)}}},[_c("inline-svg",{attrs:{src:"lookup",iconClass:"icon icon-sm-md fc-lookup-icon"}})],1),_vm.canShowQuickCreateIcon?_c("div",{staticClass:"icon-class-alignment",on:{click:function($event){return $event.stopPropagation(),_vm.openQuickCreate()}}},[_c("el-tooltip",{attrs:{effect:"dark",content:"Add\n          "+_vm.moduleDisplayName,placement:"top"}},[_c("inline-svg",{attrs:{src:"add-pink",iconClass:"icon icon-sm-md fc-lookup-icon"}})],1)],1):_vm._e()]),_vm._l(_vm.field.options,(function(option,index){return _c("el-option",{key:option.value+" "+index,staticClass:"fc-input-full-border-select2 width100",attrs:{label:option.label,value:option.value}},[_c("span",{staticClass:"fL"},[_vm._v(_vm._s(option.label))]),_vm.$validation.isEmpty(option.secondaryLabel)?_vm._e():_c("span",{staticClass:"select-float-right-text13"},[_vm._v(_vm._s(option.secondaryLabel))]),_vm.getIsSiteDecommissioned(option)?_c("span",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"select-float-right-text13 pL10",attrs:{title:_vm.$t("setup.decommission.decommissioned")}},[_c("fc-icon",{staticClass:"fR pT10",attrs:{group:"alert",name:"decommissioning",size:"16"}})],1):_vm._e()])}))],2),_vm.showQuickCreateData?_c("QuickCreateData",{attrs:{canShowDialog:_vm.showQuickCreateData,quickCreateField:_vm.field,setAddedRecord:_vm.setAddedRecord},on:{"update:canShowDialog":function($event){_vm.showQuickCreateData=$event},"update:can-show-dialog":function($event){_vm.showQuickCreateData=$event}}}):_vm._e()],1)},staticRenderFns=[],objectSpread2=__webpack_require__(595082),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),toConsumableArray=__webpack_require__(488478),validation=(__webpack_require__(879288),__webpack_require__(260228),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(434284),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(450886),__webpack_require__(538077),__webpack_require__(425728),__webpack_require__(634338),__webpack_require__(990260)),constant=__webpack_require__(354754),picklist=__webpack_require__(961358),field_utils=__webpack_require__(455344),FieldLoader=__webpack_require__(62979),isEqual=__webpack_require__(618446),isEqual_default=__webpack_require__.n(isEqual),LOOKUP_FIELD_PLACEHOLDER_MAP={people:{value:"${LOGGED_PEOPLE}",label:"Current User"},users:{value:"${LOGGED_USER}",label:"Current User"}},FLookupFieldvue_type_script_lang_js={name:"f-lookup-field",props:{model:{},field:{type:Object},disabled:{type:Boolean},siteId:{type:[Number,String]},categoryId:{type:Number},hideLookupIcon:{type:Boolean,default:!1},popperAppendToBody:{required:!1,type:Boolean,default:!0},fetchOptionsOnLoad:{type:Boolean,default:!0},fetchOptionsMethod:{type:Function},preHookFilterConstruction:{type:Function,default:function(field){return field.filters}},hideDropDown:{type:Boolean,default:!1},skipLoading:{type:Boolean,default:!1},isClearable:{type:Boolean,default:!0},userfilmoduleEnum:{type:String},parentModuleId:{type:Number},selectedOptions:{type:Array}},components:{FieldLoader:FieldLoader/* default */.Z,QuickCreateData:function(){return Promise.all(/* import() */[__webpack_require__.e(93208),__webpack_require__.e(50232),__webpack_require__.e(93765),__webpack_require__.e(95953),__webpack_require__.e(35309),__webpack_require__.e(18778),__webpack_require__.e(12303),__webpack_require__.e(84290),__webpack_require__.e(31721),__webpack_require__.e(64418),__webpack_require__.e(5603),__webpack_require__.e(57432),__webpack_require__.e(435),__webpack_require__.e(72230),__webpack_require__.e(94255),__webpack_require__.e(67683),__webpack_require__.e(44178),__webpack_require__.e(91132),__webpack_require__.e(20280),__webpack_require__.e(78256),__webpack_require__.e(22200),__webpack_require__.e(49081),__webpack_require__.e(89472),__webpack_require__.e(12085),__webpack_require__.e(55754),__webpack_require__.e(86494),__webpack_require__.e(3037),__webpack_require__.e(49908),__webpack_require__.e(22061),__webpack_require__.e(31602),__webpack_require__.e(73609),__webpack_require__.e(41323),__webpack_require__.e(99751),__webpack_require__.e(11305),__webpack_require__.e(80390),__webpack_require__.e(89142),__webpack_require__.e(97770),__webpack_require__.e(76422),__webpack_require__.e(99813)]).then(__webpack_require__.bind(__webpack_require__,676433))}},data:function(){return{localSearch:!1,isLoadedOnce:!1,currentModelValue:!1,showQuickCreateData:!1}},computed:{customOptions:function(){var _ref=this||{},field=_ref.field,_ref2=field||{},lookupModule=_ref2.lookupModule;if((0,validation/* isEmpty */.xb)(lookupModule))return[];var _ref3=lookupModule||{},name=_ref3.name;return(0,validation/* isEmpty */.xb)(LOOKUP_FIELD_PLACEHOLDER_MAP[name])?[]:[LOOKUP_FIELD_PLACEHOLDER_MAP[name]]},modelObj:{get:function(){return this.model},set:function(value){this.currentModelValue=value,this.$emit("update:model",value)}},moduleDisplayName:function(){var field=this.field,_ref4=field.field||{},lookupModule=_ref4.lookupModule,_ref5=lookupModule||{},displayName=_ref5.displayName;return displayName},isFieldLoading:function(){var field=this.field,defaultIds=this.defaultIds,skipLoading=this.skipLoading,isLoadedOnce=this.isLoadedOnce;return!skipLoading&&!isLoadedOnce&&!(0,validation/* isEmpty */.xb)(defaultIds)&&field.isDataLoading},isPickListTypeModule:function(){var field=this.field,fieldObj=field.field,_ref6=fieldObj||field,lookupModule=_ref6.lookupModule,_ref7=lookupModule||{},type=_ref7.type;
// type 1 is for base entity modules
return!!type&&1!==type},isRemote:function(){var localSearch=this.localSearch;return!localSearch},canHideLookupIcon:function(){var hideLookupIcon=this.hideLookupIcon,isPickListTypeModule=this.isPickListTypeModule,hideDropDown=this.hideDropDown,field=this.field,userfilmoduleEnum=this.userfilmoduleEnum,_ref8=field||{},config=_ref8.config,canHide=!1;if(!(0,validation/* isEmpty */.xb)(config)){var canShowLookupWizard=this.$getProperty(config,"canShowLookupWizard",null);(0,validation/* isNull */.Ft)(canShowLookupWizard)||(canHide=!canShowLookupWizard)}return!hideDropDown&&("PICK_LIST"===userfilmoduleEnum||(canHide||hideLookupIcon||isPickListTypeModule))},canShowQuickCreateIcon:function(){var disabled=this.disabled,field=this.field,_ref9=field||{},config=_ref9.config,canShow=!1;return(0,validation/* isEmpty */.xb)(config)||(canShow=this.$getProperty(config,"canShowQuickCreate")),disabled&&(canShow=!1),canShow},isSiteEnabled:function(){var siteId=Number(this.$cookie.get("fc.currentSite")),currentSiteId=siteId>0?siteId:-1;return!(0,validation/* isEmpty */.xb)(currentSiteId)},isMultiple:function(){var field=this.field;return!!field.multiple},resourceModuleName:function(){var field=this.field,config=field.config,lookupModuleName=field.lookupModuleName,_ref10=config||{},isFiltersEnabled=_ref10.isFiltersEnabled,filterValue=_ref10.filterValue;if(isFiltersEnabled&&constant/* default */.Z.LOOKUP_FILTER_ENABLED_FIELDS.includes(lookupModuleName)){var moduleName=constant/* default */.Z.LOOKUP_FILTERS_MAP[filterValue];return moduleName}return null},isResourceField:function(){var field=this.field,name=field.name,isResourceField=(0,field_utils/* isChooserTypeField */.Rq)(field)||"resource"===name;return isResourceField},
// To prefill the existing values, we have to send default ids in picklist api
defaultIds:function(){var modelObj=this.modelObj,selectedOptions=this.selectedOptions,isPlaceHoldersEnabled=constant/* default */.Z.FIELD_PLACEHOLDERS.includes(modelObj)||!1,defaultIds=[],selectedOptionsArr=(selectedOptions||[]).map((function(option){return parseInt(option)}));return(0,validation/* isEmpty */.xb)(selectedOptions)?(0,validation/* isEmpty */.xb)(modelObj)||isPlaceHoldersEnabled||(defaultIds=(0,validation/* isArray */.kJ)(modelObj)?(0,toConsumableArray/* default */.Z)(modelObj):[modelObj]):defaultIds=(0,toConsumableArray/* default */.Z)(selectedOptionsArr),defaultIds=defaultIds.filter((function(val){return!constant/* default */.Z.FIELD_PLACEHOLDERS.includes(val)})),defaultIds},operatorLookupModule:function(){var field=this.field,_ref11=field||{},operatorLookupModule=_ref11.operatorLookupModule;return operatorLookupModule||{}},skipSiteFilter:function(){var field=this.field,_ref12=field||{},config=_ref12.config,_ref13=config||{},_ref13$skipSiteFilter=_ref13.skipSiteFilter,skipSiteFilter=void 0!==_ref13$skipSiteFilter&&_ref13$skipSiteFilter;return skipSiteFilter},canShowSystemClear:function(){var canHideLookupIcon=this.canHideLookupIcon,isClearable=this.isClearable,modelObj=this.modelObj,disabled=this.disabled;return!canHideLookupIcon&&!disabled&&(isClearable&&!(0,validation/* isEmpty */.xb)(modelObj))}},watch:{model:function(newVal){var _this=this,currentModelValue=this.currentModelValue,isRemote=this.isRemote;isEqual_default()(newVal,currentModelValue)||(isRemote&&this.getOptions({initialFetch:!0}).then((function(options){_this.$set(_this.field,"options",options)})),this.$set(this,"modelObj",newVal))},siteId:{handler:function(newVal,oldVal){var _this2=this,isSiteEnabled=this.isSiteEnabled,skipSiteFilter=this.skipSiteFilter;skipSiteFilter||isSiteEnabled||newVal===oldVal||this.getOptions({initialFetch:!0}).then((function(options){_this2.$set(_this2.field,"options",options)}))}},parentModuleId:{handler:function(newVal,oldVal){var _this3=this;newVal!==oldVal&&this.getOptions({initialFetch:!0}).then((function(options){_this3.$set(_this3.field,"options",options)}))}},operatorLookupModule:{handler:function(newVal,oldVal){var _this4=this;isEqual_default()(newVal,oldVal)||this.getOptions({initialFetch:!0}).then((function(options){_this4.$set(_this4.field,"options",options)}))}},"field.clientCriteria":{handler:function(newVal,oldVal){var _this5=this;isEqual_default()(newVal,oldVal)||this.getOptions({initialFetch:!0}).then((function(options){_this5.$set(_this5.field,"options",options)}))}},categoryId:{handler:function(newVal,oldVal){var _this6=this;isEqual_default()(newVal,oldVal)||this.getOptions({initialFetch:!0}).then((function(options){_this6.$set(_this6.field,"options",options)}))}},"field.options":{handler:function(value){var modelObj=this.modelObj;if(!(0,validation/* isEmpty */.xb)(value))if((0,validation/* isEmpty */.xb)(modelObj))this.field.selectedItems=[];else if((0,validation/* isArray */.kJ)(modelObj)){var selectedItems=value.filter((function(option){return modelObj.includes(option.value)}));this.field.selectedItems=selectedItems}else{var selectedItem=value.find((function(option){return option.value===modelObj}));this.field.selectedItems=[selectedItem]}},immediate:!0},isLoadedOnce:{handler:function(value){value&&this.$emit("optionsLoadedOnce")}}},created:function(){var _this7=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var fetchOptionsOnLoad,field,modelObj,customOptions,options;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:
// Have to skip fetching options initially, when module is 'resource' and filters is not enabled
if(fetchOptionsOnLoad=_this7.fetchOptionsOnLoad,field=_this7.field,modelObj=_this7.modelObj,customOptions=_this7.customOptions,_this7.currentModelValue=modelObj,_this7.getIsSiteDecommissioned=picklist/* getIsSiteDecommissioned */.Yx,!fetchOptionsOnLoad){_context2.next=12;break}return _context2.next=6,_this7.getOptions({initialFetch:!0});case 6:if(_context2.t0=_context2.sent,_context2.t0){_context2.next=9;break}_context2.t0=[];case 9:options=_context2.t0,_this7.$set(_this7.field,"options",[].concat((0,toConsumableArray/* default */.Z)(customOptions),(0,toConsumableArray/* default */.Z)(options))),_this7.$set(_this7,"isLoadedOnce",!0);case 12:_this7.remoteMethod=_this7.$helpers.debounce(function(){var _ref14=(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(searchText){var isDataLoading,_options;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(isDataLoading=field.isDataLoading,isDataLoading){_context.next=6;break}return _context.next=4,_this7.getOptions({searchText:searchText});case 4:_options=_context.sent,_this7.$set(_this7.field,"options",_options);case 6:case"end":return _context.stop()}}),_callee)})));return function(_x){return _ref14.apply(this,arguments)}}(),1e3);case 13:case"end":return _context2.stop()}}),_callee2)})))()},methods:{focus:function(){(0,validation/* isEmpty */.xb)(this.$refs["selectBox"])||this.$refs["selectBox"].focus()},getOptions:function(params){var _this8=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var searchText,initialFetch,fetchOptionsMethod,field,siteId,categoryId,isRemote,defaultIds,resourceModuleName,isResourceField,skipSiteFilter,selectedOptions,_field$filters,fieldFilters,options,filters,props,perPageCount,_yield$_this8$fetchOp,_yield$_this8$fetchOp2,optionsArr,error,_ref15,message,_yield$getFieldOption,_yield$getFieldOption2,_optionsArr,_error,meta,_ref16,_message,_meta$localSearch,localSearch;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:
/*
                Have to return empty options if field is of resourcetype, if filters havent be enabled
                and if no values selected already
              */
if(searchText=params.searchText,initialFetch=params.initialFetch,fetchOptionsMethod=_this8.fetchOptionsMethod,field=_this8.field,siteId=_this8.siteId,categoryId=_this8.categoryId,isRemote=_this8.isRemote,defaultIds=_this8.defaultIds,resourceModuleName=_this8.resourceModuleName,isResourceField=_this8.isResourceField,skipSiteFilter=_this8.skipSiteFilter,selectedOptions=_this8.selectedOptions,_field$filters=field.filters,fieldFilters=void 0===_field$filters?{}:_field$filters,options=[],(0,validation/* isEmpty */.xb)(resourceModuleName)||(field.resourceLookupModuleName=resourceModuleName),filters=_this8.preHookFilterConstruction(field),(0,validation/* isEmpty */.xb)(filters)||(field.filters=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},fieldFilters),filters)),(0,validation/* isEmpty */.xb)(categoryId)||(field.filters=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},field.filters),{},{category:{operator:"is",value:["".concat(categoryId)]}})),props={field:field,searchText:searchText},skipSiteFilter||(props=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},props),{},{siteId:siteId})),!(isResourceField&&(0,validation/* isEmpty */.xb)(resourceModuleName)&&(0,validation/* isEmpty */.xb)(defaultIds))){_context3.next=12;break}return _context3.abrupt("return",options);case 12:if(initialFetch&&isRemote&&(perPageCount=defaultIds.length>50?defaultIds.length:50,props=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},props),{},{page:1,perPage:perPageCount,defaultIds:defaultIds}),((0,validation/* isEmpty */.xb)(resourceModuleName)&&isResourceField||!(0,validation/* isEmpty */.xb)(selectedOptions))&&(
// Have to fetch only selected values, which is same as the number of defaultids
props=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},props),{},{perPage:defaultIds.length}))),_this8.$set(field,"isDataLoading",!0),(0,validation/* isEmpty */.xb)(fetchOptionsMethod)){_context3.next=25;break}return _context3.next=17,_this8.fetchOptionsMethod(props);case 17:_yield$_this8$fetchOp=_context3.sent,_yield$_this8$fetchOp2=_yield$_this8$fetchOp.options,optionsArr=void 0===_yield$_this8$fetchOp2?[]:_yield$_this8$fetchOp2,error=_yield$_this8$fetchOp.error,error&&(_ref15=error||{},message=_ref15.message,_this8.$message.error(message||"Error Occured")),options=optionsArr,_context3.next=35;break;case 25:return _context3.next=27,(0,picklist/* getFieldOptions */._K)(props);case 27:_yield$getFieldOption=_context3.sent,_yield$getFieldOption2=_yield$getFieldOption.options,_optionsArr=void 0===_yield$getFieldOption2?[]:_yield$getFieldOption2,_error=_yield$getFieldOption.error,meta=_yield$getFieldOption.meta,_error&&(_ref16=_error||{},_message=_ref16.message,_this8.$message.error(_message||"Error Occured")),meta&&(0,validation/* isEmpty */.xb)(searchText)&&(_meta$localSearch=meta.localSearch,localSearch=void 0!==_meta$localSearch&&_meta$localSearch,_this8.$set(_this8,"localSearch",localSearch)),options=_optionsArr;case 35:return _this8.$set(field,"isDataLoading",!1),_context3.abrupt("return",options);case 37:case"end":return _context3.stop()}}),_callee3)})))()},clearData:function(){this.$emit("update:model",""),this.recordSelected("")},recordSelected:function(value){var field=this.field,_this$field$options=this.field.options,options=void 0===_this$field$options?[]:_this$field$options,isMultiple=this.isMultiple,selectedValues=null;isMultiple?(selectedValues=options.filter((function(e){return(value||[]).includes(e.value)})),field.selectedItems=selectedValues):(selectedValues=options.find((function(e){return e.value==value}))||{},field.selectedItems=[],(0,validation/* isEmpty */.xb)(selectedValues)||(field.selectedItems=[selectedValues])),this.$emit("recordSelected",selectedValues,field)},openLookupFieldWizard:function(field){var disabled=this.disabled;disabled||this.$emit("showLookupWizard",field,!0)},openQuickCreate:function(){var disabled=this.disabled;disabled||(this.showQuickCreateData=!0)},setAddedRecord:function(props){var record=props.record,_ref17=record||{},id=_ref17.id,name=record.displayName||record.name||record.subject,field=this.field;field.selectedItems=[{value:id,label:name}],this.$emit("setLookupFieldValue",{field:(0,objectSpread2/* default */.Z)({},field)})}}},forms_FLookupFieldvue_type_script_lang_js=FLookupFieldvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(forms_FLookupFieldvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FLookupField=component.exports},
/***/62979:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FieldLoader}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/forms/FieldLoader.vue?vue&type=template&id=7252e23e
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.isLoading?_c("div",{staticClass:"field-loading loading-shimmer"}):_vm._e()},staticRenderFns=[],FieldLoadervue_type_script_lang_js={props:{isLoading:{type:Boolean,required:!0}}},forms_FieldLoadervue_type_script_lang_js=FieldLoadervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(forms_FieldLoadervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FieldLoader=component.exports},
/***/875545:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return ImportModule}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/module-import/ImportModule.vue?vue&type=template&id=85150f94
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"asset-import-page"},[_vm.moduleExists?_c("div",{staticClass:"asset-import-main-con"},[_c("div",{staticClass:"asset-import-lCol"},[_c("div",{staticClass:"asset-import-lList"},[_c("ul",[_c("li",{staticClass:"label-txt-black pointer"},[_c("div",{class:_vm.uploadPage?"dot-active-pink":"dot-inactive-grey"}),_vm._v(" Upload ")]),_c("li",{staticClass:"label-txt-black pointer"},[_c("div",{class:_vm.fieldMapping?"dot-active-pink":"dot-inactive-grey"}),_vm._v(" Field Mapping ")]),_c("li",{staticClass:"label-txt-black pointer"},[_c("div",{class:_vm.dataValidation?"dot-active-pink":"dot-inactive-grey"}),_vm._v(" Data Validation ")]),_c("li",{staticClass:"label-txt-black pointer"},[_c("div",{class:_vm.finalUpload?"dot-active-pink":"dot-inactive-grey"}),_vm._v(" Finish ")])])])]),_c("div",{staticClass:"asset-import-rCol"},[_c("div",{staticClass:"fc__layout__align pB20"},[_c("div",{staticClass:"heading-black22 line line-height0"},[_vm._v(_vm._s("Import"))]),_c("div",{staticClass:"fc-dark-blue4-12 pointer line-height0",on:{click:function($event){_vm.historyPageVisibility=!0}}},[_vm._v(" Show Import History ")])]),_c("div",{staticClass:"asset-import-main-bg"},[_vm.uploadPage?_c("import-setting",{attrs:{importMode:"1",importProcessContext:_vm.importProcessContext,module:_vm.moduleName,moduleMeta:_vm.moduleMeta},on:{"update:importProcessContext":function($event){_vm.importProcessContext=$event},"update:import-process-context":function($event){_vm.importProcessContext=$event},proceed:_vm.moveToFieldMapping}}):_vm._e(),_vm.fieldMapping?_c("field-mapping",{attrs:{importProcessContext:_vm.importProcessContext},on:{mappingResponse:_vm.moveToValidation,begin:_vm.moveToBegining,"update:importProcessContext":function($event){_vm.importProcessContext=$event},"update:import-process-context":function($event){_vm.importProcessContext=$event}}}):_vm._e(),_vm.dataValidation?_c("data-validation",{attrs:{dataValidation:_vm.dataValidation,parseError:_vm.parseError,importProcessContext:_vm.importProcessContext},on:{"update:dataValidation":function($event){_vm.dataValidation=$event},"update:data-validation":function($event){_vm.dataValidation=$event},"update:importProcessContext":function($event){_vm.importProcessContext=$event},"update:import-process-context":function($event){_vm.importProcessContext=$event},finishValidation:_vm.finishValidation,begin:_vm.moveToBegining}}):_vm._e(),_vm.finalUpload?_c("final-upload",{attrs:{importProcessContext:_vm.importProcessContext},on:{finalDone:_vm.finalDone,"update:importProcessContext":function($event){_vm.importProcessContext=$event},"update:import-process-context":function($event){_vm.importProcessContext=$event}}}):_vm._e()],1)])]):_vm._e(),_vm.historyPageVisibility?_c("import-history",{attrs:{visibility:_vm.historyPageVisibility,historyMeta:{importMode:1,moduleName:this.moduleName}},on:{"update:visibility":function($event){_vm.historyPageVisibility=$event},continueImport:function(data){return _vm.continueImport(data)},showUpload:_vm.toggleHistoryPage}}):_vm._e()],1)},staticRenderFns=[],ImportHistory=(__webpack_require__(689730),__webpack_require__(477572)),ImportSetting=__webpack_require__(349188),ColumnMapping=__webpack_require__(700188),DataValidation=__webpack_require__(50381),FinalUpload=__webpack_require__(753144),ImportHelper=__webpack_require__(638557),ImportModulevue_type_script_lang_js={props:["moduleName"],mixins:[ImportHelper/* default */.Z],data:function(){return{importProcessContext:null,initialImportContext:null,historyPageVisibility:!1,parseError:{visibility:!1,errorMessage:""},uploadPage:!0,fieldMapping:!1,dataValidation:!1,finalUpload:!1,moduleExists:!1,interval:null,moduleMeta:null}},components:{ImportHistory:ImportHistory/* default */.Z,ImportSetting:ImportSetting/* default */.Z,FieldMapping:ColumnMapping/* default */.Z,DataValidation:DataValidation/* default */.Z,FinalUpload:FinalUpload/* default */.Z},created:function(){this.loadImportData()},destroyed:function(){clearInterval(this.interval)},title:function(){return"Import"},methods:{loadImportData:function(){var _this=this;this.$http.post("/import/checkModule",{moduleName:this.moduleName}).then((function(response){_this.moduleExists=response.data.moduleExists.moduleExists,_this.moduleMeta=response.data.moduleExists.moduleMeta,_this.moduleExists?(_this.importProcessContext=response.data.importProcessContext,_this.initialImportContext=response.data.importProcessContext):_this.$message({showClose:!0,message:"Entered URL is invalid. Please try again.",type:"error"})}))},finalDone:function(){this.finalUpload=!1,this.uploadPage=!0,this.importProcessContext=this.initialImportContext},finishValidation:function(validationBoolean){validationBoolean&&(this.dataValidation=!1,this.loadFinal(this.importProcessContext))},moveToBegining:function(){this.$router.go(this.$route.path)},loadFinal:function(data){this.importProcessContext=data.importProcessContext?data.importProcessContext:data,this.dataValidation=!1,this.finalUpload=!0},moveToFieldMapping:function(){this.fieldMapping=!0,this.uploadPage=!1,this.dataValidation=!1,this.finalUpload=!1},continueImport:function(importContext){this.historyPageVisibility=!this.historyPageVisibility,this.importProcessContext=importContext,1===importContext.status?this.moveToFieldMapping():(6===importContext.status||5===importContext.status)&&(this.dataValidation=!0,this.uploadPage=!1,this.fieldMapping=!1,this.finalUpload=!1)},toggleHistoryPage:function(){this.historyPageVisibility=!this.historyPageVisibility},moveToValidation:function(data){this.fieldMapping=!1,this.dataValidation=!0,this.interval=setInterval(this.checkStatus,4e4),this.importProcessContext=data.importProcessContext},stringWithCaps:function(string){var firstChar=string.charAt(0),remaining=string.slice(1);return firstChar.toUpperCase()+remaining.toLowerCase()}}},module_import_ImportModulevue_type_script_lang_js=ImportModulevue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(module_import_ImportModulevue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,ImportModule=component.exports},
/***/700188:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return ColumnMapping}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/assets/import/v1/ColumnMapping.vue?vue&type=template&id=5f24b5e0
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("div",{staticClass:"fc-black-12 text-left bold text-uppercase letter-spacing1"},[_vm._v(" File Mapping ")]),_c("div",{staticClass:"fc-heading-border-width43 mT10 height2px"}),_c("div",{staticClass:"height100 overflow-y-scroll pT20"},[_c("div",{},[_c("el-form",{ref:"fieldMappingForm",attrs:{rules:_vm.rules,model:_vm.fieldMappingForm},nativeOn:{submit:function($event){$event.preventDefault()}}},[_c("el-table",{staticClass:"import-table width100",attrs:{data:_vm.fieldMappingForm.columnHeadings,height:"410"}},[_c("template",{slot:"empty"},[_c("div",{staticClass:"mT50"},[_c("img",{attrs:{src:__webpack_require__(15482),width:"100",height:"100"}}),_c("div",{staticClass:"mT10 label-txt-black f14"},[_vm._v(" No field mapping available ")])])]),_c("el-table-column",{attrs:{prop:"name",label:"FIELDS IN FILE",width:"300"},scopedSlots:_vm._u([{key:"default",fn:function(data){return[_c("div",{staticClass:"label-txt-black"},[_vm._v(_vm._s(data.row))])]}}])}),_c("el-table-column",{attrs:{label:"FIELDS IN FACILIO",width:"300"},scopedSlots:_vm._u([{key:"default",fn:function(field){return[_c("el-form-item",{attrs:{prop:_vm.replaceSpecialChars(field.row)}},[_c("el-select",{staticClass:"fc-input-full-border-select2 import-select-width",attrs:{clearable:"",placeholder:_vm.importProcessContext.facilioFieldMapping[_vm.fieldMappingForm.mappedValues[field.row]]?_vm.importProcessContext.facilioFieldMapping[_vm.fieldMappingForm.mappedValues[field.row]].displayName:_vm.placeHolder,filterable:""},on:{clear:function($event){return _vm.clearField(field.row)},change:function($event){_vm.selectField(field.row),_vm.getDateFormat(field.row)}},model:{value:_vm.fieldMappingForm.mappedValues[field.row],callback:function($$v){_vm.$set(_vm.fieldMappingForm.mappedValues,field.row,$$v)},expression:"fieldMappingForm.mappedValues[field.row]"}},_vm._l(_vm.fieldList,(function(value,index2){return _c("el-option",{key:index2,attrs:{disabled:!value.show,label:_vm.importProcessContext.facilioFieldMapping[value.value]?_vm.importProcessContext.facilioFieldMapping[value.value].displayName:value.value,value:value.value}})})),1),_vm.dateToggles[field.row].dateToggle?_c("el-tooltip",{staticClass:"item",attrs:{content:"Choose a date format",effect:"dark",placement:"right-start"}},[_c("el-popover",{attrs:{trigger:"click",width:"200",placement:"right"},model:{value:_vm.dateToggles[field.row].datePopoverToggle,callback:function($$v){_vm.$set(_vm.dateToggles[field.row],"datePopoverToggle",$$v)},expression:"dateToggles[field.row].datePopoverToggle"}},[_vm._l(_vm.fieldMappingForm.dateFormatsForColumns[field.row],(function(dateFormat,dateFormatIndex){return _c("div",{key:dateFormatIndex,staticClass:"date-format pointer pB10",class:{active:_vm.fieldMappingForm.dateFormatMapping[field.row]===dateFormat,fw5:_vm.fieldMappingForm.dateFormatMapping[field.row]===dateFormat},attrs:{label:dateFormat,value:dateFormat},on:{click:function($event){return _vm.setDateFormat(field.row,dateFormat)}}},[_vm._v(" "+_vm._s(dateFormat)+" ")])})),_vm.dateToggles[field.row].dateToggle?_c("el-button",{staticClass:"el-icon-date",class:_vm.getClass(field.row),attrs:{slot:"reference",circle:""},on:{click:function($event){return _vm.toggleDateFormatPopover(field.row)}},slot:"reference"}):_vm._e()],2)],1):_vm._e()],1)]}}])}),_c("el-table-column",{attrs:{prop:"address",label:"SAMPLE DATA",width:"300"},scopedSlots:_vm._u([{key:"default",fn:function(field){return[null===_vm.importProcessContext.firstRow[field.row]?_c("div",{staticClass:"fc-grey3-text14"}):_c("div",{staticClass:"fc-grey3-text14"},[_vm._v(" "+_vm._s(_vm.importProcessContext.firstRow[field.row])+" ")])]}}])})],2)],1)],1)]),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.goBacktoBeginning}},[_vm._v("CANCEL")]),_c("el-button",{staticClass:"modal-btn-save",attrs:{loading:_vm.saving.sendMapping,type:"primary"},on:{click:function($event){return _vm.submitForm("fieldMappingForm")}}},[_vm._v(" Proceed to next "),_c("img",{staticClass:"fR",attrs:{src:__webpack_require__(936658),width:"17px"}})])],1)])},staticRenderFns=[],createForOfIteratorHelper=__webpack_require__(566347),ImportHelper=(__webpack_require__(169358),__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(162506),__webpack_require__(670560),__webpack_require__(434284),__webpack_require__(564043),__webpack_require__(857267),__webpack_require__(821057),__webpack_require__(425728),__webpack_require__(648324),__webpack_require__(638557)),utils_field=__webpack_require__(815872),validation=__webpack_require__(990260),ColumnMappingvue_type_script_lang_js={props:["importProcessContext","asset"],mixins:[ImportHelper/* default */.Z],data:function(){return{placeHolder:"Select",show:!0,fieldMappingForm:{mappedValues:{},dateFormatsForColumns:{},dateFormatMapping:{},columnHeadings:[]},rules:{},firstRow:[],moduleStaticFields:null,dateToggles:{},moduleName:null,importSetting:{INSERT:1,INSERT_SKIP:2,UPDATE:3,UPDATE_NOT_NULL:4,BOTH:5,BOTH_NOT_NULL:6},saving:{sendMapping:!1}}},created:function(){this.moduleName=this.$route.params.module,this.createDateTogglesAndFormatArrays(),this.loadModuleStaticFields()},mounted:function(){if(null!==this.importProcessContext.fieldMappingJSON){var dateFormats,keys=Object.keys(this.importProcessContext.fieldMappingJSON),meta=JSON.parse(this.importProcessContext.importJobMeta);for(var key in null!=meta&&(dateFormats=meta.dateFormats),keys)if(null!==this.importProcessContext.fieldMappingJSON[keys[key]]){var field=keys[key].split("__");this.$set(this.fieldMappingForm.mappedValues,this.importProcessContext.fieldMappingJSON[keys[key]],field[field.length-1]),this.getDateFormat(this.importProcessContext.fieldMappingJSON[keys[key]]),"undefined"!==typeof dateFormats&&this.$set(this.fieldMappingForm.dateFormatMapping,this.importProcessContext.fieldMappingJSON[keys[key]],dateFormats[this.importProcessContext.fieldMappingJSON[keys[key]]])}}this.initFormRules()},computed:{fieldList:function(){var _step,fields=[],tempIgFields=this.$helpers.cloneObject(this.importProcessContext.ignoreFields),_iterator=(0,createForOfIteratorHelper/* default */.Z)(tempIgFields);try{for(_iterator.s();!(_step=_iterator.n()).done;){var ig=_step.value;if(1===this.importProcessContext.importMode&&"category"===ig&&3!==this.importProcessContext.importSetting&&4!==this.importProcessContext.importSetting){var index=tempIgFields.indexOf(ig);tempIgFields.splice(index,1)}}}catch(err){_iterator.e(err)}finally{_iterator.f()}var _step2,tempFields=this.importProcessContext.fields.filter((function(i){return!tempIgFields.includes(i)})),_iterator2=(0,createForOfIteratorHelper/* default */.Z)(tempFields);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var field=_step2.value,temp={show:!0};temp["value"]=field,temp["columnName"]=null,fields.push(temp)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}return fields},groupedFields:function(){var _step3,_this=this,fields=[],_iterator3=(0,createForOfIteratorHelper/* default */.Z)(this.importProcessContext.fields);try{var _loop=function(){var field=_step3.value;if(_this.importProcessContext.facilioFieldMapping[field])if(fields.filter((function(moduleField){return moduleField.name===_this.importProcessContext.facilioFieldMapping[field].module.name})),0!==fields.length){var moduleField=fields[0];moduleField.fields.push(field)}else{var temp={};temp["name"]=_this.importProcessContext.facilioFieldMapping[field].module.name,temp["displayName"]=_this.importProcessContext.facilioFieldMapping[field].module.displayName,temp["fields"]=[],temp.fields.push(field),fields.push(temp)}else if(
// if field does not have any associated module
fields.filter((function(moduleField){return moduleField.name===_this.importProcessContext.module.name})),0!==fields.length){var _moduleField=fields[0];_moduleField.fields.push(field)}else{var _temp={};_temp["name"]=_this.importProcessContext.module.name,_temp["displayName"]=_this.importProcssContext.module.displayName,_temp["fields"]=[],_temp.fields.push(field)}};for(_iterator3.s();!(_step3=_iterator3.n()).done;)_loop()}catch(err){_iterator3.e(err)}finally{_iterator3.f()}return fields}},methods:{getClass:function(columnName){if(this.isDateOrDateTimeField(this.fieldMappingForm.mappedValues[columnName])){var dateFormats=this.getDateFormats(this.importProcessContext.firstRow[columnName]);return null===dateFormats?"fc-black":this.fieldMappingForm.dateFormatMapping[columnName]?"fc-green":"fc-red3"}},replaceSpecialChars:function(string){return string.replace(/[\:W./,]/,"_")},initFormRules:function(){var _step4,_this2=this,rules={},validateFieldMapping=function(rule,value,callback){if(_this2.isDateOrDateTimeField(_this2.fieldMappingForm.mappedValues[rule.field])){var dateFormats=_this2.getDateFormats(_this2.importProcessContext.firstRow[rule.field]);if(null===dateFormats)return void callback(new Error("Incompatible date format."));if(!_this2.fieldMappingForm.dateFormatMapping[rule.field])return void callback(new Error("Please select the date format."))}callback()},_iterator4=(0,createForOfIteratorHelper/* default */.Z)(this.fieldMappingForm.columnHeadings);try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var column=_step4.value;rules[this.replaceSpecialChars(column)]={validator:validateFieldMapping,trigger:"blur"}}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}this.rules=rules},goBacktoBeginning:function(){this.$emit("begin",0)},clearField:function(columnName){var choosenField=this.fieldList.find((function(field){return field.columnName===columnName}));choosenField&&(choosenField.show=!0)},selectField:function(columnName){var _this3=this;if(this.fieldMappingForm.mappedValues[columnName]){var choosenField=this.fieldList.find((function(field){return field.value===_this3.fieldMappingForm.mappedValues[columnName]}));choosenField&&(choosenField.show=!1,choosenField["columnName"]=columnName),choosenField.show=!0}},loadModuleStaticFields:function(){var _this4=this;if(this.moduleStaticFields=[],this.moduleName)switch(this.moduleName){case"purchasedItem":case"purchasedTool":this.$http.get("/v2/storeRoom/view/all").then((function(response){var _step5,temp={name:"storeRoom",displayName:"Store Room",values:[],value:null},_iterator5=(0,createForOfIteratorHelper/* default */.Z)(response.data.result.storeRooms);try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var room=_step5.value,storeRoom={};storeRoom["displayName"]=room.name,storeRoom["id"]=room.id,temp.values.push(storeRoom)}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}_this4.moduleStaticFields.push(temp)}));break}},setDateFormat:function(columnName,dateFormat){this.$set(this.fieldMappingForm.dateFormatMapping,columnName,dateFormat),this.$set(this.dateToggles[columnName],"datePopoverToggle",!1),this.$refs.fieldMappingForm.validateField(columnName)},getDateFormat:function(columnName){if(""===this.fieldMappingForm.mappedValues[columnName])this.dateToggles[columnName].dateToggle=!1,this.dateToggles[columnName].datePopoverToggle=!1,this.fieldMappingForm.dateFormatsForColumns[columnName]=[],delete this.fieldMappingForm.mappedValues[columnName];else if(this.isDateOrDateTimeField(this.fieldMappingForm.mappedValues[columnName])){var dateFormats=this.getDateFormats(this.importProcessContext.firstRow[columnName]);null===dateFormats?(this.fieldMappingForm.dateFormatsForColumns[columnName]=[],this.fieldMappingForm.dateFormatsForColumns[columnName].push("Incompatible format")):1===dateFormats.length?(this.$set(this.fieldMappingForm.dateFormatsForColumns,columnName,dateFormats),this.$set(this.fieldMappingForm.dateFormatMapping,columnName,dateFormats[0])):this.$set(this.fieldMappingForm.dateFormatsForColumns,columnName,dateFormats),this.$set(this.dateToggles[columnName],"dateToggle",!0)}else this.$set(this.dateToggles[columnName],"dateToggle",!1);this.$refs.fieldMappingForm.validateField(columnName)},isDateOrDateTimeField:function(fieldName){var _ref=this.importProcessContext||{},facilioFieldMapping=_ref.facilioFieldMapping,field=facilioFieldMapping[fieldName]||{};return!(0,validation/* isEmpty */.xb)(field)&&((0,utils_field/* isDateField */.y2)(field)||(0,utils_field/* isDateTimeField */.K)(field))},checkForProperDateMapping:function(){for(var columnName in this.fieldMappingForm.mappedValues)if((0,utils_field/* isDateField */.y2)(this.fieldMappingForm.mappedValues[columnName])){if(this.fieldMappingForm.dateFormatMapping.hasOwnProperty(columnName))continue;return!1}return!0},createDateTogglesAndFormatArrays:function(){var _this5=this;for(var columnIndex in this.importProcessContext&&this.importProcessContext.columnHeadings&&(this.fieldMappingForm.columnHeadings=[],this.importProcessContext.columnHeadings.filter((function(i){i&&_this5.fieldMappingForm.columnHeadings.push(i)}))),this.importProcessContext.columnHeadings){var temp={dateToggle:!1,datePopoverToggle:!1};this.$set(this.dateToggles,this.importProcessContext.columnHeadings[columnIndex],temp),this.$set(this.fieldMappingForm.dateFormatsForColumns,this.importProcessContext.columnHeadings[columnIndex],[])}},backToImportSetting:function(){this.$emit("backToSetting","")},checkForProperFieldMapping:function(){var importJobMetaJson=null,columns=null;if(this.importProcessContext.importJobMeta&&(importJobMetaJson=JSON.parse(this.importProcessContext.importJobMeta)),this.importProcessContext.importSetting===this.importSetting.INSERT_SKIP){if(!importJobMetaJson["insertBy"])return!0;columns=importJobMetaJson["insertBy"]}else this.importProcessContext.importSetting!==this.importSetting.UPDATE&&this.importProcessContext.importSetting!==this.importSetting.BOTH&&this.importProcessContext.importSetting!==this.importSetting.UPDATE_NOT_NULL&&this.importProcessContext.importSetting!==this.importSetting.BOTH_NOT_NULL||(columns=importJobMetaJson["updateBy"]);if(columns){var _step6,_iterator6=(0,createForOfIteratorHelper/* default */.Z)(columns);try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var column=_step6.value;if(!this.fieldMappingForm.mappedValues.hasOwnProperty(column))return!1}}catch(err){_iterator6.e(err)}finally{_iterator6.f()}}return!0},getSettingArrayString:function(){return this.importProcessContext.importSetting===this.importSetting.INSERT_SKIP?"insertBy":this.importProcessContext.importSetting===this.importSetting.UPDATE||this.importProcessContext.importSetting===this.importSetting.UPDATE_NOT_NULL||this.importProcessContext.importSetting===this.importSetting.BOTH||this.importProcessContext.importSetting===this.importSetting.BOTH_NOT_NULL?"updateBy":void 0},mapImportSettingFields:function(){var importMeta=null;if(this.importProcessContext.importJobMeta&&this.importProcessContext.importSetting!==this.importSetting.INSERT){var settingString=this.getSettingArrayString();importMeta=JSON.parse(this.importProcessContext.importJobMeta);var _step7,settingColumns=importMeta[settingString],temp=[],_iterator7=(0,createForOfIteratorHelper/* default */.Z)(settingColumns);try{for(_iterator7.s();!(_step7=_iterator7.n()).done;){var column=_step7.value;"id"===this.fieldMappingForm.mappedValues[column]?temp.push("".concat(this.importProcessContext.module.name,"__id")):temp.push(this.importProcessContext.facilioFieldMapping[this.fieldMappingForm.mappedValues[column]].module.name+"__"+this.fieldMappingForm.mappedValues[column])}}catch(err){_iterator7.e(err)}finally{_iterator7.f()}importMeta[settingString]=temp,this.importProcessContext.importJobMeta=JSON.stringify(importMeta)}},sendMapping:function(){if(this.checkForProperDateMapping()&&this.checkForProperFieldMapping()){for(var key in this.importProcessContext.fieldMapping={},this.importProcessContext.fieldMappingJSON={},this.fieldMappingForm.mappedValues)if(""!==this.fieldMappingForm.mappedValues[key]){var fieldMappingKey=void 0;fieldMappingKey=this.importProcessContext.facilioFieldMapping[this.fieldMappingForm.mappedValues[key]]?this.importProcessContext.facilioFieldMapping[this.fieldMappingForm.mappedValues[key]].module.name+"__"+this.fieldMappingForm.mappedValues[key]:this.importProcessContext.module.name+"__"+this.fieldMappingForm.mappedValues[key],this.importProcessContext.fieldMapping[fieldMappingKey]=key}if(this.mapImportSettingFields(),this.importProcessContext.fieldMappingString=JSON.stringify(this.importProcessContext.fieldMapping),null===this.importProcessContext.importJobMeta){var temp={};temp["dateFormats"]=this.fieldMappingForm.dateFormatMapping,this.importProcessContext.importJobMeta=JSON.stringify(temp)}else{var _temp2=JSON.parse(this.importProcessContext.importJobMeta);_temp2["dateFormats"]=this.fieldMappingForm.dateFormatMapping,this.importProcessContext.importJobMeta=JSON.stringify(_temp2)}var self=this,assetId=this.asset;""===this.asset&&(assetId=null),this.saving.sendMapping=!0,this.$http.post("/import/processImport",{importProcessContext:this.importProcessContext,assetId:assetId}).then((function(response){self.$emit("mappingResponse",response.data),self.saving.sendMapping=!1})).catch((function(error){self.saving.sendMapping=!1,self.$message.error("Data import failed! [ "+error+"]")}))}else!1===this.checkForProperFieldMapping()?this.$message.error("Please map all Update By columns"):!1===this.checkForProperDateMapping()?this.$message.error("Please map all date fields to a format before importing"):this.$message.error("Please map all mandatory columns and date fields")},submitForm:function(fieldMappingForm){var _this6=this;this.$refs[fieldMappingForm].validate((function(valid){if(!valid)return _this6.$message.error("Some fields have incompatible date format. Review the dateformat and try again"),!1;_this6.sendMapping()}))}}},v1_ColumnMappingvue_type_script_lang_js=ColumnMappingvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(v1_ColumnMappingvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,ColumnMapping=component.exports},
/***/349188:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return ImportSetting}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/assets/import/v1/ImportSetting.vue?vue&type=template&id=18bc36eb
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("div",{staticClass:"fc-black-12 text-left bold text-uppercase letter-spacing1"},[_vm._v(" IMPORT SETTINGS ")]),_c("div",{staticClass:"fc-heading-border-width43 mT10 height2px"}),_c("div",{staticClass:"import-file-body border-bottom6"},[_vm.attachments&&_vm.attachments.length>0?_c("div",{staticClass:"pT40 pB40"},_vm._l(_vm.attachments,(function(attachment){return _c("el-row",{key:attachment.attachmentId},[_c("el-col",{attrs:{span:20}},[_c("el-col",{attrs:{span:1}},[_c("InlineSvg",{attrs:{src:"svgs/fileupload-xls",iconClass:"icon icon-xlg vertical-middle"}})],1),_c("el-col",{attrs:{span:19}},[_c("div",{staticClass:"pL20"},[_c("div",{staticClass:"this-center show text-left fc-black-16 textoverflow-ellipsis max-width300px"},[_vm._v(" "+_vm._s(attachment.fileName)+" ")]),_c("div",{staticClass:"fc-grey3-text14"},[_vm._v(" "+_vm._s(_vm._f("prettyBytes")(attachment.fileSize))+" ")])])])],1),_c("el-col",{staticClass:"text-right",attrs:{span:4}},[_c("div",{staticClass:"fc-warning2-12 pointer",on:{click:function($event){return _vm.deleteAttachment()}}},[_vm._v(" Remove ")])])],1)})),1):_c("form",{staticClass:"pT20 pB40",attrs:{enctype:"multipart/form-data",novalidate:""}},[_c("div",{staticClass:"dropbox"},[_c("input",{staticClass:"input-file z-10",attrs:{type:"file",accept:".xls, .xlsx"},on:{change:function($event){return _vm.filesChange($event.target.files[0])}}}),_c("div",{staticClass:"upload-parent"},[_c("div",{staticClass:"upload-folder-box"},[_c("InlineSvg",{attrs:{src:"svgs/folder-open",iconClass:"icon z-index1 icon-xxxl vertical-middle"}})],1)]),_c("p",[_vm._v(" "+_vm._s(_vm.$t("common.attachment_form.drag_and_drop_files"))+" "),_c("br"),_vm._v(" "+_vm._s(_vm.$t("common.attachment_form.click_to_browse"))+" ")])])])]),_vm.importProcessContext?_c("div",{staticClass:"asset-import-rCol-fields pT20 pB40"},[_vm.moduleStaticFields&&_vm.moduleStaticFields.length>0?_c("div",_vm._l(_vm.moduleStaticFields,(function(moduleStaticField,moduleStaticFieldIdx){return _vm.hideSites?_vm._e():_c("el-row",{key:moduleStaticFieldIdx,attrs:{gutter:20}},[_c("el-col",{attrs:{span:4}},[_c("div",{staticClass:"label-txt-black pT10"},[_vm._v(" "+_vm._s(moduleStaticField.displayName)+" ")])]),_c("el-col",{attrs:{span:8}},[_c("FLookupFieldWrapper",{attrs:{field:{lookupModule:{name:_vm.lookupModuleName},multiple:!1},hideLookupIcon:!1},model:{value:moduleStaticField.value,callback:function($$v){_vm.$set(moduleStaticField,"value",$$v)},expression:"moduleStaticField.value"}})],1)],1)})),1):_vm._e(),_c("div",{staticClass:"pT20 label-txt-black"},[_vm._v(" What do you want to do with the records in the file? ")]),_c("div",{staticClass:"pT20"},[_c("el-radio-group",{on:{input:_vm.radioToggler},model:{value:_vm.importSetting.radio,callback:function($$v){_vm.$set(_vm.importSetting,"radio",$$v)},expression:"importSetting.radio"}},[_vm.importProcessContext.options["INSERT"]?_c("el-radio",{staticClass:"fc-radio-btn",attrs:{label:"New"}},[_vm._v(_vm._s("As New "+_vm.printableModuleName()))]):_vm._e(),_vm.importProcessContext.options["UPDATE"]?_c("el-radio",{staticClass:"fc-radio-btn",attrs:{label:"Update"}},[_vm._v(_vm._s("Update Existing "+_vm.printableModuleName()))]):_vm._e(),_vm.importProcessContext.options["BOTH"]?_c("el-radio",{staticClass:"fc-radio-btn",attrs:{label:"Both"}},[_vm._v("Both")]):_vm._e()],1)],1),_vm.radioToggle&&_vm.importProcessContext.options["INSERT_SKIP"]?_c("div",{staticClass:"pT20"},[_c("el-checkbox",{attrs:{label:"skip"},model:{value:_vm.importSetting.checkSkip,callback:function($$v){_vm.$set(_vm.importSetting,"checkSkip",$$v)},expression:"importSetting.checkSkip"}},[_vm._v(_vm._s("Skip existing "+_vm.printableModuleName()))])],1):_vm._e(),_vm.updateToggle&&(_vm.importProcessContext.options["BOTH_NOT_NULL"]||_vm.importProcessContext.options["UPDATE_NOT_NULL"])?_c("div",{staticClass:"pT20"},[_c("el-checkbox",{attrs:{label:"skip"},model:{value:_vm.importSetting.checkNull,callback:function($$v){_vm.$set(_vm.importSetting,"checkNull",$$v)},expression:"importSetting.checkNull"}},[_vm._v("Do not update empty fields")])],1):_vm._e(),_vm.importSetting.checkSkip||_vm.updateToggle?_c("div",{staticClass:"label-txt-black mT20"},[_vm._v(" "+_vm._s(_vm.text)+" "),_c("el-select",{staticClass:"fc-input-full-border-select2",attrs:{"collapse-tags":"",multiple:"",placeholder:"Select"},model:{value:_vm.updateOrInsertByFields,callback:function($$v){_vm.updateOrInsertByFields=$$v},expression:"updateOrInsertByFields"}},_vm._l(_vm.columnHeading,(function(value,index){return _c("el-option",{key:index,attrs:{label:value,value:value}})})),1)],1):_vm._e()]):_vm._e(),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"fc-full-btn-fill-green f13",attrs:{loading:_vm.loading},on:{click:_vm.nextButton}},[_vm._v(" Proceed to next "),_c("img",{staticClass:"fR",attrs:{src:__webpack_require__(936658),width:"17px"}})])],1)])},staticRenderFns=[],createForOfIteratorHelper=__webpack_require__(566347),objectSpread2=__webpack_require__(595082),vuex_esm=(__webpack_require__(976801),__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(434284),__webpack_require__(670560),__webpack_require__(169358),__webpack_require__(648324),__webpack_require__(162506),__webpack_require__(420629)),ImportHelper=__webpack_require__(638557),validation=__webpack_require__(990260),filters=__webpack_require__(638203),FLookupFieldWrapper=__webpack_require__(201117),ImportSettingvue_type_script_lang_js={props:["module","importMode","importProcessContext","moduleMeta"],mixins:[ImportHelper/* default */.Z],components:{FLookupFieldWrapper:FLookupFieldWrapper/* default */.Z},data:function(){return{loading:!1,attachments:[],uploadFile:null,siteId:null,updateOrInsertByFields:[],text:"Insert By",importSetting:{checkNull:!1,checkSkip:!1,radio:"New"},setting:null,radioToggle:!0,updateToggle:!1,moduleStaticFields:null,hideSites:!1}},mounted:function(){(0,validation/* isEmpty */.xb)(this.$route.query)||(this.hideSites=this.$route.query.hideSite)},created:function(){var _this=this;this.$store.dispatch("loadSites").then((function(){_this.loadModuleStaticFields()}))},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({lookupModuleName:function(){return["purchasedItem","purchasedTool"].includes(this.module)?"storeRoom":["asset","workorder"].includes(this.module)?"site":null}},(0,vuex_esm/* mapState */.rn)({siteList:function(state){return state.sites}})),{},{columnHeading:function(){return this.importProcessContext&&this.importProcessContext.columnHeadings?this.importProcessContext.columnHeadings.filter((function(i){return i})):[]},isAssetImport:function(){return"asset"===this.module||"asset"===this.$getProperty(this.moduleMeta,"extendModule.name",null)}}),methods:{loadModuleStaticFields:function(){var _this2=this;this.moduleStaticFields=[];var moduleName=this.module;if(["purchasedItem","purchasedTool"].includes(moduleName))this.$http.get("/v2/storeRoom/view/all").then((function(response){var _step,temp={name:"storeRoom",displayName:"Store Room",values:[],value:null},_iterator=(0,createForOfIteratorHelper/* default */.Z)(response.data.result.storeRooms);try{for(_iterator.s();!(_step=_iterator.n()).done;){var room=_step.value,storeRoom={};storeRoom["displayName"]=room.name,storeRoom["id"]=room.id,temp.values.push(storeRoom)}}catch(err){_iterator.e(err)}finally{_iterator.f()}_this2.moduleStaticFields.push(temp)}));else if(["asset","workorder"].includes(moduleName)||"asset"===this.$getProperty(this.moduleMeta,"extendModule.name",null)){var _step2,temp={name:"site",displayName:"Site",values:[],value:null},_iterator2=(0,createForOfIteratorHelper/* default */.Z)(this.siteList);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var site=_step2.value,tempSite={displayName:site.name,id:site.id};temp.values.push(tempSite)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}this.moduleStaticFields.push(temp)}},filesChange:function(selectedFile){if((selectedFile||{}).size<2097152){this.uploadFile=selectedFile;var fileEntry={attachmentId:-1,fileName:selectedFile.name,fileSize:selectedFile.size,prettyFileSize:(0,filters/* prettyBytes */.Hi)(selectedFile.size),contentType:selectedFile.type,status:null,error:null};this.attachments.push(fileEntry),this.addAttachment()}else this.$message.error("File size limit exceeded (Max File Size is 2MB)")},moduleStaticFieldsValidation:function(){var moduleStaticFields=this.moduleStaticFields;if(!this.isAssetImport&&!(0,validation/* isEmpty */.xb)(moduleStaticFields)&&(0,validation/* isArray */.kJ)(moduleStaticFields)&&moduleStaticFields.length>0){var _step3,_iterator3=(0,createForOfIteratorHelper/* default */.Z)(moduleStaticFields);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var field=_step3.value;if("site"===field.name&&this.hideSites);else if((0,validation/* isEmpty */.xb)(field.value)||field.value<0)return this.$message.error("Please Select a ".concat(field.displayName," to Proceed")),!1}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}}return!0},mapModuleStaticFields:function(importProcessContext){if(this.moduleStaticFields){var importMeta=null;if((0,validation/* isEmpty */.xb)(importProcessContext.importJobMeta));else{try{importMeta=JSON.parse(importProcessContext.importJobMeta)}catch(err){}importMeta&&(importMeta["moduleStaticFields"]={})}var _step4,_iterator4=(0,createForOfIteratorHelper/* default */.Z)(this.moduleStaticFields);try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var staticField=_step4.value;importMeta.moduleStaticFields[staticField.name]=staticField.value,"site"===staticField.name&&(importProcessContext.siteId=staticField.value||-1)}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}importProcessContext.importJobMeta=JSON.stringify(importMeta)}return importProcessContext},updateImportProcessContext:function(){var _this3=this;if(0!==this.attachments.length){if(this.moduleStaticFieldsValidation()){var importProcessContext=this.importProcessContext;importProcessContext=this.mapModuleStaticFields(importProcessContext),this.loading=!0,this.$http.post("/v2/import/updateImportProcessContext",{importProcessContext:importProcessContext}).then((function(response){0===response.data.responseCode?(_this3.$emit("update:importProcessContext",response.data.result.importProcessContext),_this3.$emit("proceed")):_this3.$message.error(response.data.message),_this3.loading=!1})).catch((function(error){_this3.$message.error(error)}))}}else this.$message.error("Please Upload a File to Proceed")},addAttachment:function(){var _this4=this,formData=new FormData;formData.append("moduleName",this.module),formData.append("fileUpload",this.uploadFile),formData.append("importMode",this.importMode),this.loading=!0,this.$http.post("/v2/import/upload",formData).then((function(response){response.data&&(_this4.loading=!1,0!==response.data.responseCode?(_this4.$message.error(response.data.message),_this4.deleteAttachment()):(_this4.$emit("update:importProcessContext",response.data.result.importProcessContext),_this4.$message.success("File Uploaded Successfully")))})).catch((function(error){_this4.loading=!1,_this4.$message.error(error),_this4.deleteAttachment()}))},deleteAttachment:function(){this.attachments.splice(0,1)},radioToggler:function(e){"New"===e?(this.importSetting.checkNull=!1,this.updateToggle=!1,this.radioToggle=!0,this.text="Insert by"):"Update"!==e&&"Both"!==e||(this.importSetting.checkSkip=!1,this.importSetting.checkNull=!1,this.radioToggle=!1,this.updateToggle=!0,this.text="Update by")},nextButton:function(){var meta;this.importSetting.radio?("New"===this.importSetting.radio?this.importSetting.checkSkip?this.setting=2:this.setting=1:"Update"===this.importSetting.radio?this.importSetting.checkNull?this.setting=4:this.setting=3:"Both"===this.importSetting.radio&&(this.importSetting.checkNull?this.setting=6:this.setting=5),this.importProcessContext.importSetting=this.setting,meta=this.importProcessContext.importJobMeta?JSON.parse(this.importProcessContext.importJobMeta):{},2===this.setting?0===this.updateOrInsertByFields.length?meta["insertBy"]=null:meta["insertBy"]=this.updateOrInsertByFields:3!==this.setting&&4!==this.setting&&5!==this.setting&&6!==this.setting||(0===this.updateOrInsertByFields.length?meta["updateBy"]=null:meta["updateBy"]=this.updateOrInsertByFields),this.importProcessContext.importJobMeta=JSON.stringify(meta),this.updateImportProcessContext()):this.$message({message:"Choose a setting",type:"error"})}}},v1_ImportSettingvue_type_script_lang_js=ImportSettingvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(v1_ImportSettingvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,ImportSetting=component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/75545.js.map