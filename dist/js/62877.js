(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[62877],{
/***/670334:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return Fportforlionew}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/energy/analytics/newTools/v1/Fportforlionew.vue?vue&type=template&id=5ad81433
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"fc-energy-portfolio-analysis"},[_c("div",{staticClass:"report-main-con"},[_c("div",{},[_c("f-report-options",{staticClass:"analytics-page-options-building-analysis fc-v1-portfolio-anlaysis",attrs:{isActionsDisabled:_vm.isActionsDisabled,optionClass:"analytics-page-options",optionsToEnable:[1,2,5],reportObject:_vm.reportObject,params:_vm.reportObject?_vm.reportObject.params:null,savedReport:_vm.analyticsConfig.savedReport,pdf:!1},on:{"update:savedReport":function($event){return _vm.$set(_vm.analyticsConfig,"savedReport",$event)},"update:saved-report":function($event){return _vm.$set(_vm.analyticsConfig,"savedReport",$event)}}})],1),_c("div",{staticClass:"report-sidebar-con"},[_vm.hideSideBar?_vm._e():_c("div",{class:{"new-report-sidebar fc-new-report-sidebar col-3 pT0":!_vm.hideSideBar}},[_c("div",{directives:[{name:"show",rawName:"v-show",value:_vm.showgeneratedata,expression:"showgeneratedata"}],staticClass:"report-sidebar-inner"},[_c("div",{staticClass:"analytics-header"},[_c("div",{directives:[{name:"show",rawName:"v-show",value:!_vm.showChartCustomization,expression:"!showChartCustomization"}],staticClass:"add-points-block"},[_c("el-button-group",{staticClass:"mL0"},[_c("el-button",{staticClass:"setup-el-btn add-points-btn-first-child",attrs:{type:"primary"},on:{click:function($event){_vm.showDataPointSelector=!0}}},[_c("i",{staticClass:"el-icon-circle-plus-outline f20 bold pR5 vertical-sub"}),_vm._v(_vm._s(_vm.$t("home.dashboard.add_points")))]),_vm.reportObject&&4===_vm.analyticsConfig.mode?_c("el-tooltip",{attrs:{effect:"dark",content:"Add derivation",placement:"bottom"}},[_vm.reportObject&&4===_vm.analyticsConfig.mode?_c("el-button",{staticClass:"add-points-btn mL20 pL12 pR12",attrs:{type:"primary"},on:{click:function($event){_vm.showDerivation=!0}}},[_c("img",{attrs:{src:__webpack_require__(857539),width:"15px",height:"15px"}})]):_vm._e()],1):4!==_vm.analyticsConfig.mode?_c("el-tooltip",{attrs:{effect:"dark",content:"Set Dimension as time to create a derivation",placement:"bottom"}},[_c("span",[_c("el-button",{staticClass:"add-points-btn mL20 pL12 pR12",attrs:{type:"primary",disabled:!_vm.reportObject&&4!==_vm.analyticsConfig.mode},on:{click:_vm.onclick_fx}},[_c("img",{attrs:{src:__webpack_require__(857539),width:"15px",height:"15px"}})])],1)]):_c("el-tooltip",{attrs:{effect:"dark",content:_vm.$t("common.dialog.add_at_least_one_datapoint_to_create_derivation"),placement:"bottom"}},[_c("span",[_c("el-button",{staticClass:"add-points-btn mL20 pL12 pR12",attrs:{type:"primary",disabled:!_vm.reportObject&&4!==_vm.analyticsConfig.mode},on:{click:_vm.onclick_fx}},[_c("img",{attrs:{src:__webpack_require__(857539),width:"15px",height:"15px"}})])],1)])],1)],1)]),_c("div",{staticClass:"analytics-body p20 clearboth"},[_c("div",{staticClass:"report_building_inputbox"},[_c("span",{staticStyle:{"font-weight":"500"}},[_vm._v(_vm._s(_vm.$t("common.reports.general_settings")))])]),_c("el-row",{staticClass:"mT20"},[_c("el-col",{staticClass:"report_building_inputbox",attrs:{span:24}},[_c("div",{staticClass:"pB5"},[_vm._v(" "+_vm._s(_vm.$t("home.reports.dimension"))+" ")]),_c("el-select",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"period-select width100 fc-input-full-border2 ",attrs:{placeholder:_vm.$t("common._common.mode"),title:_vm.$t("common.header.dimension"),"data-arrow":"true"},on:{change:_vm.onModeChange},model:{value:_vm.analyticsConfig.mode,callback:function($$v){_vm.$set(_vm.analyticsConfig,"mode",$$v)},expression:"analyticsConfig.mode"}},[_c("el-option",{attrs:{label:_vm.$t("common.wo_report.time"),value:4}}),_c("el-option",{attrs:{label:_vm.$t("common.products.site"),value:6}}),_c("el-option",{attrs:{label:_vm.$t("common._common.building"),value:7}}),_c("el-option",{attrs:{label:_vm.$t("common._common.asset"),value:8}}),_c("el-option",{attrs:{label:_vm.$t("common.header.m&v"),value:"mv"}})],1)],1)],1),_vm.isTimeMode?_c("el-row",[_c("el-col",{staticClass:"mT20 report_building_inputbox",attrs:{span:24}},[_c("div",{staticClass:"pB5"},[_vm._v(" "+_vm._s(_vm.$t("common.dashboard.time_period"))+" ")]),_c("el-select",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"period-select width100 fc-input-full-border2 ",attrs:{placeholder:_vm.$t("common.wo_report.period"),title:_vm.$t("common.dashboard.time_period"),"data-arrow":"true"},on:{change:_vm.onPeriodChange},model:{value:_vm.analyticsConfig.period,callback:function($$v){_vm.$set(_vm.analyticsConfig,"period",$$v)},expression:"analyticsConfig.period"}},_vm._l(_vm.getAvailablePeriods,(function(period,index){return _c("el-option",{key:index,attrs:{label:period.name,value:period.value,disabled:!period.enable}})})),1)],1)],1):_vm._e(),_c("div",{staticClass:"mT25 report_building_inputbox_divider"}),_vm.baseLineList&&!_vm.isActionsDisabled?_c("div",{staticClass:"mT20"},[_c("div",{staticClass:"report_building_inputbox"},[_c("span",{staticStyle:{"font-weight":"500"}},[_vm._v(" "+_vm._s(_vm.$t("common.reports.comparsion_indicator")))])]),_vm.baseLineList&&!_vm.isActionsDisabled?_c("el-row",{staticClass:"mT10"},[_c("el-col",{staticClass:"mT10 report_building_inputbox",attrs:{span:24}},[_c("div",{staticClass:"pB5"},[_vm._v(" "+_vm._s(_vm.$t("common.reports.compare_with"))+" ")]),_c("el-cascader",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"period-select fc-input-full-border2 width100",attrs:{placeholder:_vm.$t("common.wo_report.compare_to"),options:_vm.baseLineCasecaderOptions,value:_vm.analyticsConfig.baseLine,title:_vm.$t("common.wo_report.compare_with_baseline"),"data-arrow":"true"},on:{change:_vm.onBaseLineChange}})],1)],1):_vm._e(),_vm.isShowCompareIndicator&&_vm.reportObject&&_vm.reportObject.options&&!["pie","donut","gauge"].includes(_vm.reportObject.options.type)?_c("el-row",{staticClass:"mT10"},[_c("el-col",{staticClass:"mT10 report_building_inputbox",attrs:{span:24}},[_c("div",{staticClass:"pB5"},[_vm._v(" "+_vm._s(_vm.$t("common.reports.compare_indicator_on_value"))+" ")]),_c("div",{staticClass:"mT10"},[_c("el-radio",{attrs:{label:1},on:{change:_vm.compareIndicatorChange},model:{value:_vm.compare_indicator,callback:function($$v){_vm.compare_indicator=$$v},expression:"compare_indicator"}},[_vm._v(_vm._s(_vm.$t("common.reports.positive")))]),_c("el-radio",{attrs:{label:2},on:{change:_vm.compareIndicatorChange},model:{value:_vm.compare_indicator,callback:function($$v){_vm.compare_indicator=$$v},expression:"compare_indicator"}},[_vm._v(_vm._s(_vm.$t("common.reports.negative")))])],1)])],1):_vm._e()],1):_vm._e(),4!==_vm.analyticsConfig.mode?_c("el-row",[_c("el-col",{staticClass:"mT20",attrs:{span:24}},[_c("div",{staticClass:"fc-text-pink fw6"},[_vm._v(" "+_vm._s(_vm.$t("common._common.sorting"))+" ")]),_c("div",{staticClass:"mT15"},[_c("el-form",{ref:"reportSortingForm",attrs:{model:_vm.analyticsConfig.sorting,"label-position":"top"}},[_vm.resultObject&&_vm.resultObject.report.dataPoints.length>1?_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"sortByField"}},[_c("div",{staticClass:"label-txt-black pB5 label-line-height"},[_vm._v(" "+_vm._s(_vm.$t("common._common.sort_by"))+" ")]),_c("el-select",{staticClass:"period-select width100 fc-input-full-border2 ",staticStyle:{width:"90%"},model:{value:_vm.analyticsConfig.sorting.sortByField,callback:function($$v){_vm.$set(_vm.analyticsConfig.sorting,"sortByField",$$v)},expression:"analyticsConfig.sorting.sortByField"}},_vm._l(_vm.resultObject.report.dataPoints,(function(dp,index){return _c("el-option",{key:index,attrs:{label:dp.name,value:dp.yAxis.fieldId}})})),1)],1)],1)],1):_vm._e(),_vm.show?_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"orderByFunc"}},[_c("div",{staticClass:"label-txt-black pB5 label-line-height"},[_vm._v(" "+_vm._s(_vm.$t("common._common.sort_order"))+" ")]),_c("el-select",{staticClass:"period-select width100 fc-input-full-border2 ",staticStyle:{width:"90%"},model:{value:_vm.analyticsConfig.sorting.orderByFunc,callback:function($$v){_vm.$set(_vm.analyticsConfig.sorting,"orderByFunc",$$v)},expression:"analyticsConfig.sorting.orderByFunc"}},[_c("el-option",{attrs:{label:_vm.$t("common._common.ascending"),value:2}}),_c("el-option",{attrs:{label:_vm.$t("common._common.descending"),value:3}})],1)],1)],1)],1):_vm._e(),_vm.show?_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"limit"}},[_c("div",{staticClass:"label-txt-black pB5 label-line-height"},[_vm._v(" "+_vm._s(_vm.$t("common._common.limit"))+" ")]),_c("el-select",{staticClass:"period-select width100 fc-input-full-border2 ",staticStyle:{width:"90%"},model:{value:_vm.analyticsConfig.sorting.limit,callback:function($$v){_vm.$set(_vm.analyticsConfig.sorting,"limit",$$v)},expression:"analyticsConfig.sorting.limit"}},_vm._l(20,(function(i){return i>=3?_c("el-option",{key:i,attrs:{label:i,value:i}}):_vm._e()})),1)],1)],1)],1):_vm._e()],1)],1)])],1):_vm._e(),"mv"!==_vm.analyticsConfig.mode?_c("el-row",{staticClass:"mT20"},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"pB10 pB5"},[_vm._v(" "+_vm._s(_vm.$t("common._common.filters"))+" ")]),_c("div",{staticClass:"fL"},[1===_vm.setfilter?_c("div",[_c("div",{staticClass:"fc-black2 f14 fw-bold pB5"},[_vm._v(" "+_vm._s(_vm.$t("common.header.edit_filter"))+" ")])]):_c("div",[_c("div",{staticClass:"fc-black2 f14 fw-bold pB5"},[_vm._v(" "+_vm._s(_vm.$t("common._common.add_filters"))+" ")])])]),_c("div",{staticClass:"fR"},[1===_vm.setfilter?_c("span",{staticClass:"pointer label-txt-blue2 pR10",on:{click:_vm.resetFilter}},[_vm._v(_vm._s(_vm.$t("common._common.reset")))]):_vm._e(),_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-edit report-edit-icon pointer",attrs:{title:_vm.$t("common.header.edit_filter")},on:{click:function($event){_vm.filtersPopover=!0,_vm.prepareFilterData()}}})])])],1):_vm._e()],1)])]),_vm.hideSideBar?_vm._e():_c("div",{class:{"new-chart-custom fc-new-portfolio-chart-custom":!_vm.hideSideBar}},[_vm.reportObject?_c("div",{directives:[{name:"show",rawName:"v-show",value:_vm.showChartCustomization,expression:"showChartCustomization"}],staticClass:"customize-container building-customize-container col-3 fc-new-portfolio-cus",staticStyle:{top:"0px"}},[_c("div",{staticClass:"customize-header"},[_c("div",{staticClass:"customize-H"},[_vm._v(" "+_vm._s(_vm.$t("home.reports.chart_customization"))+" ")])]),_c("div",{staticClass:"customize-body fc-customize-body"},[_vm.reportObject?_c("f-chart-customization",{directives:[{name:"show",rawName:"v-show",value:_vm.showChartCustomization,expression:"showChartCustomization"}],attrs:{report:_vm.reportObject,resultDataPoints:_vm.resultObject?_vm.resultObject.report.dataPoints:[],config:_vm.analyticsConfig},on:{close:function($event){_vm.showChartCustomization=!1,_vm.showgeneratedata=!0},resetPoints:_vm.resetDataPointSelector}}):_vm._e()],1)]):_vm._e()]),_c("f-portfolio-data-point-selector",{ref:"building-selector",attrs:{mode:_vm.analyticsConfig.mode,visibility:_vm.showDataPointSelector,zones:_vm.zones,isSiteAnalysis:_vm.isSiteAnalysis,disableMultipleAssetCategories:8===_vm.analyticsConfig.mode},on:{"update:visibility":function($event){_vm.showDataPointSelector=$event},selectBuildings:_vm.setSelectedBuildings,updateDataPoints:_vm.updateDataPoints}}),_vm.hideSideBar?_vm._e():_c("div",{staticClass:"analytics-options-block"},[_c("div",{},[_c("div",{staticClass:"text-center analytics-report-icon-bg line-height50 height50",class:{"analytics-report-icon-bg-active":_vm.showgeneratedata},staticStyle:{"border-bottom":"1px solid #eceded"},on:{click:function($event){return _vm.showgeneratedataDialog()}}},[_c("InlineSvg",{attrs:{src:"statistics",iconClass:"icon icon-sm-md vertical-middle"}})],1),_c("div",{staticClass:"text-center analytics-report-icon-bg line-height50 height50",class:{"analytics-report-icon-bg-active":_vm.showChartCustomization},attrs:{disabled:!_vm.reportObject},on:{click:function($event){_vm.reportObject&&_vm.showChartCustomizationDialog()}}},[_c("InlineSvg",{attrs:{src:"settings-grey",iconClass:"icon icon-sm-md vertical-middle"}})],1),_c("div",{staticClass:"text-center analytics-report-icon-bg line-height50 height50",on:{click:function($event){return _vm.toggleSideBar()}}},[_c("InlineSvg",{attrs:{src:"arrow-pointing-to-left2",iconClass:"icon icon-sm-md vertical-middle"}})],1)])]),_vm.hideSideBar?_c("div",{staticClass:"analytics-options-block",style:{left:_vm.cssLeft}},[_c("div",{},[_c("div",{staticClass:"text-center analytics-report-icon-bg line-height50 height50",class:{"analytics-report-icon-bg-active":_vm.showgeneratedata},on:{click:function($event){return _vm.showgeneratedataDialog()}}},[_c("InlineSvg",{attrs:{src:"statistics",iconClass:"icon icon-sm-md  vertical-middle"}})],1),_c("div",{staticClass:"text-center analytics-report-icon-bg line-height50 height50",class:{"analytics-report-icon-bg-active":_vm.showChartCustomization},attrs:{disabled:!_vm.reportObject},on:{click:function($event){_vm.reportObject&&_vm.showChartCustomizationDialog()}}},[_c("InlineSvg",{attrs:{src:"settings-grey",iconClass:"icon icon-sm-md vertical-middle"}})],1),_c("div",{staticClass:"text-center analytics-report-icon-bg line-height50 height50",on:{click:function($event){return _vm.toggleSideBar()}}},[_c("InlineSvg",{staticStyle:{transform:"rotate(180deg)"},attrs:{src:"arrow-pointing-to-left2",iconClass:"icon icon-sm-md vertical-middle"}})],1)])]):_vm._e(),_c("div",{staticClass:"report-graph-con position-relative",class:{"new-report-graph-con":!_vm.hideSideBar,"new-report-graph-con-stretch":_vm.hideSideBar},staticStyle:{height:"calc(100vh - 100px)","overflow-y":"scroll","padding-bottom":"100px"}},[_c("div",{ref:"chartSection",class:["self-center fchart-section building-graph-container",{"prediction-timings-container":_vm.analyticsConfig.predictionTimings&&_vm.analyticsConfig.predictionTimings.length>1}]},[_vm.analyticsConfig.dataPoints.length?_c("f-new-analytic-report-optimize",{ref:"newAnalyticReport",attrs:{config:_vm.analyticsConfig,baseLines:_vm.baseLineList,showTimePeriod:4===_vm.analyticsConfig.mode,showChartMode:!0},on:{"update:config":function($event){_vm.analyticsConfig=$event},reportLoaded:_vm.reportLoaded}}):_c("div",{staticClass:"text-center"},[_vm.reportId||_vm.alarmId||_vm.cardId?_c("div",{staticClass:"p15"},[_c("spinner",{attrs:{show:!0}})],1):_c("div",{staticClass:"p15 flex-middle height80vh justify-content-center flex-direction-column"},[_c("div",[_c("inline-svg",{attrs:{src:"svgs/emptystate/reportlist",iconClass:"icon text-center icon-xxxlg"}})],1),_c("div",{staticClass:"nowo-label"},[_vm._v(" "+_vm._s(_vm.$t("common._common.please_select_data_points_analyze"))+" ")])])])],1)])],1)]),_c("el-dialog",{staticClass:"fc-dialog-center-container fc-dialog-center-container-body-p20",attrs:{visible:_vm.filtersPopover,width:"30%",title:_vm.$t("common._common.add_filters"),"lock-scroll":!1},on:{"update:visible":function($event){_vm.filtersPopover=$event}}},[_c("div",{staticClass:"height100 pB50"},[_c("el-form",{ref:"reportFilterForm",attrs:{model:_vm.reportFilterForm,"label-position":"top"}},[_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"assetFilter"}},[_c("p",{staticClass:"grey-text2"},[_vm._v(" "+_vm._s(_vm.$t("common._common.select_sites"))+" ")]),_c("FLookupFieldWrapper",{attrs:{field:{lookupModule:{name:"site"},multiple:!0},hideWizard:!0},on:{recordSelected:function($event){return _vm.updateFilterdata("site")}},model:{value:_vm.reportFilterForm.siteFilter,callback:function($$v){_vm.$set(_vm.reportFilterForm,"siteFilter",$$v)},expression:"reportFilterForm.siteFilter"}})],1)],1)],1),_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"assetFilter"}},[_c("p",{staticClass:"grey-text2"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.select_buildings"))+" ")]),_c("FLookupFieldWrapper",{attrs:{field:{lookupModule:{name:"building"},multiple:!0},hideWizard:!0},on:{recordSelected:function($event){return _vm.updateFilterdata("building")}},model:{value:_vm.reportFilterForm.buildingFilter,callback:function($$v){_vm.$set(_vm.reportFilterForm,"buildingFilter",$$v)},expression:"reportFilterForm.buildingFilter"}})],1)],1)],1),_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"assetFilter"}},[_c("p",{staticClass:"grey-text2"},[_vm._v(" "+_vm._s(_vm.$t("common._common.select_asset_category"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border2 width100 fc-tag",attrs:{filterable:"",multiple:"","collapse-tags":""},on:{change:function($event){return _vm.updateFilterdata("category")}},model:{value:_vm.reportFilterForm.categoryFilter,callback:function($$v){_vm.$set(_vm.reportFilterForm,"categoryFilter",$$v)},expression:"reportFilterForm.categoryFilter"}},_vm._l(_vm.selectedCategory.categoryList,(function(category,index){return _vm.selectedCategory.categoryList&&_vm.selectedCategory.categoryList.length?_c("el-option",{key:index,attrs:{label:category.name,value:category.id}}):_vm._e()})),1)],1)],1)],1),_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"assetFilter"}},[_c("p",{staticClass:"grey-text2"},[_vm._v(" "+_vm._s(_vm.$t("common._common.select_assets"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border2 width100 fc-tag",attrs:{filterable:"",multiple:"","collapse-tags":""},model:{value:_vm.reportFilterForm.assetFilter,callback:function($$v){_vm.$set(_vm.reportFilterForm,"assetFilter",$$v)},expression:"reportFilterForm.assetFilter"}},_vm._l(_vm.selectedCategory.assetList,(function(asset,index){return _vm.selectedCategory.assetList&&_vm.selectedCategory.assetList.length?_c("el-option",{key:index,attrs:{label:_vm.assetsMap[Number(asset)],value:Number(asset)}}):_vm._e()})),1)],1)],1)],1),_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"field"}},[_c("p",{staticClass:"grey-text2"},[_vm._v(_vm._s(_vm.$t("common._common.live_filter")))]),_c("el-select",{staticClass:"fc-input-full-border2 width100",attrs:{placeholder:_vm.$t("common.products._select_")},model:{value:_vm.reportFilterForm.liveFilterField,callback:function($$v){_vm.$set(_vm.reportFilterForm,"liveFilterField",$$v)},expression:"reportFilterForm.liveFilterField"}},[_c("el-option",{attrs:{value:"none",label:_vm.$t("common.wo_report.none")}}),_c("el-option",{attrs:{value:"site",label:_vm.$t("common.products.site")}}),_c("el-option",{attrs:{value:"building",label:_vm.$t("common._common.building")}}),_c("el-option",{attrs:{value:"asset",label:_vm.$t("common._common.asset")}})],1)],1)],1),_vm.reportFilterForm.liveFilterField&&"none"!==_vm.reportFilterForm.liveFilterField?_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"selectBoxType"}},[_c("p",{staticClass:"grey-text2"},[_vm._v(_vm._s(_vm.$t("common._common.type")))]),_c("el-select",{staticClass:"fc-input-full-border2 width100",model:{value:_vm.reportFilterForm.liveFilterType,callback:function($$v){_vm.$set(_vm.reportFilterForm,"liveFilterType",$$v)},expression:"reportFilterForm.liveFilterType"}},[_c("el-option",{attrs:{value:"single",label:_vm.$t("common.header.single_select_box")}}),_c("el-option",{attrs:{value:"multi",label:_vm.$t("common.header.multi_select_box")}})],1)],1)],1):_vm._e()],1)],1)],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){_vm.filtersPopover=!1}}},[_vm._v(_vm._s(_vm.$t("setup.users_management.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:function($event){return _vm.applyFilter(null)}}},[_vm._v(_vm._s(_vm.$t("maintenance.pm_list.apply")))])],1)]),_vm.showDerivation?_c("derivation",{attrs:{visibility:_vm.showDerivation,report:_vm.reportObject,config:_vm.analyticsConfig},on:{"update:visibility":function($event){_vm.showDerivation=$event}}}):_vm._e()],1)},staticRenderFns=[],toConsumableArray=__webpack_require__(488478),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),objectSpread2=__webpack_require__(595082),createForOfIteratorHelper=__webpack_require__(566347),AnalyticsMixin=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(538077),__webpack_require__(169358),__webpack_require__(670560),__webpack_require__(434284),__webpack_require__(450886),__webpack_require__(634338),__webpack_require__(212826),__webpack_require__(648324),__webpack_require__(947522),__webpack_require__(339772),__webpack_require__(976801),__webpack_require__(244936)),FNAROptimize=__webpack_require__(520245),FPortfolioDataPointSelector=__webpack_require__(852244),FDerivation=__webpack_require__(486348),NewFChartCustomization=__webpack_require__(280843),FReportOptions=__webpack_require__(791514),NewDateHelper=__webpack_require__(105534),InlineSvg=__webpack_require__(586166),validation=__webpack_require__(990260),cloneDeep=__webpack_require__(150361),cloneDeep_default=__webpack_require__.n(cloneDeep),vuex_esm=__webpack_require__(420629),api=__webpack_require__(32284),FLookupFieldWrapper=__webpack_require__(201117),Fportforlionewvue_type_script_lang_js={props:["mobileConfig"],mixins:[AnalyticsMixin/* default */.Z],components:{Derivation:FDerivation/* default */.Z,FNewAnalyticReportOptimize:FNAROptimize/* default */.Z,FChartCustomization:NewFChartCustomization/* default */.Z,FPortfolioDataPointSelector:FPortfolioDataPointSelector/* default */.Z,FReportOptions:FReportOptions/* default */.Z,InlineSvg:InlineSvg/* default */.Z,FLookupFieldWrapper:FLookupFieldWrapper/* default */.Z},data:function(){return{hideSideBar:!1,showDataPointSelector:!1,showChartCustomization:!1,showgeneratedata:!0,assetsMap:null,assetCategoryMap:null,filtersPopover:!1,sortPopover:!1,showDerivation:!1,chartCustomizationActiveTab:"datapoints",selectedBaseLineId:"",baseLineList:null,baseLineCasecaderOptions:[],oldBaseLine:null,analyticsConfig:{name:"Portfolio Analysis",key:"PORTFOLIO_ANALYSIS",analyticsType:1,type:"reading",period:12,mode:4,baseLine:[-1],dateFilter:NewDateHelper/* default */.Z.getDatePickerObject(28),chartViewOption:0,dataPoints:[],mvPoints:[],filters:{xCriteriaMode:5},sorting:{sortByField:null,orderByFunc:3,limit:10}},setfilter:0,reportObject:null,resultObject:null,selectedBuildings:[],selectedBuildingTitle:"",zones:null,buildingList:null,reportFilterForm:{siteFilter:[],buildingFilter:[],categoryFilter:[],assetFilter:[],liveFilterField:"none",liveFilterType:"single"},selectedCategory:{categoryId:[],assetList:null,allAsset:null,categoryList:null,allBuildings:null},compare_indicator:2,isShowCompareIndicator:!1}},watch:{getAvailablePeriods:{handler:function(newData,oldData){var _this=this,avail=this.getAvailablePeriods,selected=avail.find((function(a){return a.value===_this.analyticsConfig.period&&a.enable}));if(!selected){var filterName=this.analyticsConfig.dateFilter.operationOn,defaultPeriod=avail.filter((function(a){return a.enable}))[0].value;"week"===filterName||"month"===filterName?defaultPeriod=12:"year"===filterName&&(defaultPeriod=10),this.analyticsConfig.period=defaultPeriod}},immediate:!0},showChartCustomization:function(newVal){var self=this;self.$nextTick((function(){self.$refs["newAnalyticReport"]&&self.$refs["newAnalyticReport"].resize&&self.$refs["newAnalyticReport"].resize()}))}},created:function(){this.$store.dispatch("loadAlarmSeverity"),this.$store.dispatch("loadAssetCategory"),this.getBuildingList()},mounted:function(){if(this.$route.query.filters){var filters=this.$route.query.filters,filtersJSON=JSON.parse(filters);this.analyticsConfig=filtersJSON}(this.reportId||this.alarmId||this.cardId)&&(this.showDataPointSelector=!1,this.$mobile?this.loadReport(this.mobileConfig):this.loadReport());var self=this;self.$http.get("/baseline/all").then((function(response){if(200===response.status){self.baseLineList=response.data?response.data:[],self.baseLineCasecaderOptions=[],self.baseLineCasecaderOptions.push({label:"None",value:-1});var _step,_iterator=(0,createForOfIteratorHelper/* default */.Z)(self.baseLineList);try{for(_iterator.s();!(_step=_iterator.n()).done;){var b=_step.value,children=null;"PREVIOUS_MONTH"===b.rangeTypeEnum||"ANY_MONTH"===b.rangeTypeEnum?children=[{label:"Same date",value:4},{label:"Same week",value:1}]:"PREVIOUS_YEAR"!==b.rangeTypeEnum&&"ANY_YEAR"!==b.rangeTypeEnum||(children=[{label:"Same date",value:3},{label:"Same week",value:1}]),"PREVIOUS"!==b.rangeTypeEnum&&self.baseLineCasecaderOptions.push({label:b.name,value:b.id,children:children})}}catch(err){_iterator.e(err)}finally{_iterator.f()}}})),self.loadZones()},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({assetCategory:function(state){return state.assetCategory}})),{},{siteList:function(){return[]},show:function(){return!(this.resultObject&&this.resultObject.report.dataPoints.length>1)||!!this.analyticsConfig.sorting.sortByField},cssLeft:function(){return"0px !important"},isSiteAnalysis:function(){return!0},isSameDataPoint:function(){if(this.analyticsConfig&&this.analyticsConfig.dataPoints.length){var _step2,dp={},_iterator2=(0,createForOfIteratorHelper/* default */.Z)(this.analyticsConfig.dataPoints);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var d=_step2.value;dp[d.yAxis.fieldId]=!0}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}if(1===Object.keys(dp).length)return!0}return!1},isSameCategoryDataPoint:function(){if(this.analyticsConfig&&this.analyticsConfig.dataPoints.length>1){var _step3,dp={},_iterator3=(0,createForOfIteratorHelper/* default */.Z)(this.analyticsConfig.dataPoints);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var d=_step3.value;dp[d.categoryId]=!0}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}if(1===Object.keys(dp).length)return!1}return!0},getAvailablePeriods:function(){var operationOnId=this.analyticsConfig.dateFilter.operationOnId,avail=[];return avail.push({name:this.$t("common.wo_report.high_res"),value:0,enable:6===operationOnId||4!==operationOnId}),avail.push({name:this.$t("common.wo_report.hourly"),value:20,enable:6===operationOnId||4!==operationOnId}),avail.push({name:this.$t("common._common.daily"),value:12,enable:!0}),avail.push({name:this.$t("common._common.weekly"),value:11,enable:!0}),avail.push({name:this.$t("common._common.monthly"),value:10,enable:!0}),avail.push({name:this.$t("common.products.quarterly"),value:25,enable:4===operationOnId||5===operationOnId}),avail.push({name:this.$t("common._common.yearly"),value:8,enable:4===operationOnId}),avail.push({name:this.$t("common.header.hour_of_day"),
// 12, 1, 2, 3
value:19,enable:!0}),avail.push({name:this.$t("common.header.day_of_week"),
// sun, mon
value:17,enable:!0}),avail.push({name:this.$t("common.header.day_of_month"),
// 1,2,3
value:18,enable:!0}),avail},isTimeMode:function(){return 4===this.analyticsConfig.mode||5===this.analyticsConfig.mode}}),methods:{compareIndicatorChange:function(){var _this$reportObject;null!==this&&void 0!==this&&null!==(_this$reportObject=this.reportObject)&&void 0!==_this$reportObject&&null!==(_this$reportObject=_this$reportObject.options)&&void 0!==_this$reportObject&&_this$reportObject.tooltip&&this.$set(this.reportObject.options.tooltip,"compare_indicator",this.compare_indicator)},getBuildingList:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var _yield$API$get,data,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.next=2,api/* API */.bl.get("/v3/picklist/building");case 2:_yield$API$get=_context.sent,data=_yield$API$get.data,error=_yield$API$get.error,error||(_this2.buildingList=cloneDeep_default()(data.pickList),_this2.selectedCategory.allBuildings=cloneDeep_default()(data.pickList));case 6:case"end":return _context.stop()}}),_callee)})))()},onclick_fx:function(){4===this.analyticsConfig.mode||this.reportObject||(this.showDerivation=!1)},toggleSideBar:function(){this.hideSideBar?(this.hideSideBar=!1,this.$refs["newAnalyticReport"]&&this.$refs["newAnalyticReport"].resize()):(this.hideSideBar=!0,this.$refs["newAnalyticReport"]&&this.$refs["newAnalyticReport"].resize())},loadAlarmMeta:function(){var _this3=this;this.$http.post("/dashboard/getReportMetaForAlarms",{alarmId:this.$route.query.alarmId}).then((function(response){response.data&&response.data.reportMeta&&(_this3.analyticsConfig.dataPoints=response.data.reportMeta.dataPoints)}))},loadReadings:function(categoryList,spaceList){var self=this;this.reportFilterForm.categoryFilter.length>0&&self.$http.post("/asset/getReadingsForSpecificAssetCategory",{buildingIds:spaceList,categoryIds:categoryList}).then((function(response){self.filterAssetsFromCategory(response.data)}))},loadAssetCategories:function(buildingList,siteList){var self=this;siteList?(self.loading=!0,self.$http.post("/asset/getAssetCategoryWithReadings",{buildingIds:siteList||self.reportFilterForm.siteFilter}).then((function(response){var categoryIds=response.data?Object.keys(response.data):[-1];self.selectedCategory.categoryList=self.assetCategory.filter((function(ele){for(var index=0;index<categoryIds.length;index++){var element=categoryIds[index];if(parseInt(element)===ele.id)return ele.toggle=!1,ele}})),self.loadReadings(categoryIds,siteList||self.reportFilterForm.siteFilter)}))):buildingList?(self.loading=!0,self.$http.post("/asset/getAssetCategoryWithReadings",{buildingIds:buildingList||self.selectedCategory.allBuildings.map((function(rt){return rt.value}))}).then((function(response){var categoryIds=response.data?Object.keys(response.data):[-1];self.selectedCategory.categoryList=self.assetCategory.filter((function(ele){for(var index=0;index<categoryIds.length;index++){var element=categoryIds[index];if(parseInt(element)===ele.id)return ele.toggle=!1,ele}})),self.loadReadings(categoryIds,buildingList||self.selectedCategory.allBuildings.map((function(rt){return rt.value})))}))):(self.loading=!0,self.$http.get("/asset/getAssetCategoryWithReadings").then((function(response){var categoryIds=response.data?Object.keys(response.data):[-1];self.selectedCategory.categoryList=self.assetCategory.filter((function(ele){for(var index=0;index<categoryIds.length;index++){var element=categoryIds[index];if(parseInt(element)===ele.id)return ele.toggle=!1,ele}})),self.loadReadings(categoryIds)})))},filterAssetsFromCategory:function(readings){var self=this;self.assetCategoryMap=readings.categoryWithAssets,this.selectedCategory.assetList=[];for(var i=0;i<this.reportFilterForm.categoryFilter.length;i++)self.assetCategoryMap[this.reportFilterForm.categoryFilter[i]]&&(this.selectedCategory.assetList=[].concat((0,toConsumableArray/* default */.Z)(this.selectedCategory.assetList),(0,toConsumableArray/* default */.Z)(Object.keys(this.assetCategoryMap[this.reportFilterForm.categoryFilter[i]]))));this.selectedCategory.allAsset=self.selectedCategory.assetList,self.assetsMap=readings.assets},prepareFilterData:function(){this.selectedCategory.categoryList||this.loadAssetCategories()},updateFilterdata:function(root){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var site_ids,filters,_yield$API$get2,error,data;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if("site"!==root){_context2.next=22;break}if(_this4.reportFilterForm.assetFilter=[],_this4.reportFilterForm.buildingFilter=[],!_this4.reportFilterForm.siteFilter||!_this4.reportFilterForm.siteFilter.length){_context2.next=17;break}return site_ids=[],_this4.reportFilterForm.siteFilter.filter((function(siteId){siteId&&site_ids.push(siteId.toString())})),_this4.buildingList=null,filters=JSON.stringify({siteId:{operatorId:36,value:site_ids}}),_context2.next=10,api/* API */.bl.get("/v3/picklist/building",{filters:filters});case 10:_yield$API$get2=_context2.sent,error=_yield$API$get2.error,data=_yield$API$get2.data,!error&&null!==data&&void 0!==data&&data.picklist&&(_this4.buildingList=data.picklist),
// this.buildingList =
//   this.selectedCategory.allBuildings &&
//   this.selectedCategory.allBuildings.length
//     ? this.selectedCategory.allBuildings.filter(f =>
//         this.reportFilterForm.siteFilter.includes(f.siteId)
//       )
//     : null
_this4.buildingList&&_this4.buildingList.length?_this4.loadAssetCategories(_this4.buildingList.map((function(rt){return rt.value}))):_this4.reportFilterForm.siteFilter&&_this4.reportFilterForm.siteFilter.length?_this4.loadAssetCategories(!1,_this4.reportFilterForm.siteFilter):_this4.loadAssetCategories(),_context2.next=20;break;case 17:_this4.selectedCategory.assetList=_this4.selectedCategory.allAsset,_this4.buildingList=_this4.selectedCategory.allBuildings,_this4.buildingList&&_this4.buildingList.length?_this4.loadAssetCategories(_this4.buildingList.map((function(rt){return rt.value}))):_this4.loadAssetCategories();case 20:_context2.next=23;break;case 22:"building"===root?(_this4.reportFilterForm.assetFilter=[],_this4.selectedCategory.assetList=null,_this4.reportFilterForm.buildingFilter&&_this4.reportFilterForm.buildingFilter.length?_this4.loadAssetCategories(_this4.reportFilterForm.buildingFilter):(_this4.selectedCategory.assetList=_this4.selectedCategory.allAsset,_this4.loadAssetCategories(_this4.buildingList.map((function(rt){return rt.value}))))):"category"===root&&_this4.loadReadings(_this4.reportFilterForm.categoryFilter);case 23:case"end":return _context2.stop()}}),_callee2)})))()},reportLoaded:function(report,result){this.reportObject=report,this.resultObject=result,report.options.common&&report.options.common.buildingIds&&(!report.options.common.buildingIds.length&&this.selectedBuildings?this.reportObject.options.common.buildingIds=this.selectedBuildings:this.resetDataPointSelector(report.options.common.buildingIds))},loadZones:function(){var self=this;self.$http.get("/zone").then((function(response){response.data&&response.data.records&&(self.zones=response.data.records)}))},resetFilter:function(){this.reportFilterForm={siteFilter:[],buildingFilter:[],categoryFilter:[],assetFilter:[],liveFilterField:"none",liveFilterType:"single"},this.applyFilter(null)},resetDataPointSelector:function(buildingIds){this.$refs["building-selector"].setInitialValues(this.analyticsConfig.dataPoints,buildingIds)},updateDataPoints:function(changedDataPoints){var _this5=this;if(this.analyticsConfig.dataPoints.length){var configIndexes=[],alreadyAddedIndexes=[],pointsToRemove=[],optionPoints=[];this.reportObject.options.dataPoints.forEach((function(dp){"group"===dp.type?optionPoints.push.apply(optionPoints,(0,toConsumableArray/* default */.Z)(dp.children)):optionPoints.push(dp)}));var isValid=optionPoints.filter((function(dp){return 2!==dp.pointType&&!dp.duplicateDataPoint})).every((function(dp){var idx=changedDataPoints.findIndex((function(cdp){return cdp.parentId===dp.parentId&&cdp.yAxis.fieldId===dp.fieldId}));if(-1===idx){if(!_this5.checkAndDeletePointsRel(_this5.reportObject.options,dp.alias))return _this5.$message.error(dp.label+_this5.$t("common.header.has_been_used_derivation_removing_point")),_this5.resetDataPointSelector(),!1;pointsToRemove.push(dp.alias)}if(-1!==idx){var configIdx=_this5.getConfigDataPointFromOptionDP(_this5.analyticsConfig,dp,!0);configIndexes.push(configIdx),alreadyAddedIndexes.push(idx)}return!0}));isValid&&(this.removeOptionPoints(this.reportObject.options,pointsToRemove),this.analyticsConfig.dataPoints=[].concat((0,toConsumableArray/* default */.Z)(this.analyticsConfig.dataPoints.filter((function(dp,idx){return 2===dp.type||dp.duplicateDataPoint||configIndexes.includes(idx)}))),(0,toConsumableArray/* default */.Z)(changedDataPoints.filter((function(cdp,idx){return!alreadyAddedIndexes.includes(idx)})))))}else this.analyticsConfig.dataPoints=changedDataPoints;this.analyticsConfig.mvPoints=this.analyticsConfig.dataPoints.filter((function(point){return"mvproject"===point.moduleName})),this.addPredictionFields(this.analyticsConfig),this.showDataPointSelector=!1},showChartCustomizationDialog:function(defaultTab){this.hideSideBar=!1,this.showgeneratedata=!1,this.showChartCustomization=!0,defaultTab&&(this.chartCustomizationActiveTab=defaultTab)},hideChartCustomizationDialog:function(){this.showChartCustomization=!1},showgeneratedataDialog:function(){this.hideSideBar=!1,this.showChartCustomization=!1,this.showgeneratedata=!0},setSelectedBuildings:function(_ref){var name=_ref.name,ids=_ref.ids;this.selectedBuildingTitle=name,this.selectedBuildings=ids,this.reportObject&&this.reportObject.options&&this.reportObject.options.common&&(this.reportObject.options.common.buildingIds=this.selectedBuildings)},onPeriodChange:function(){if(!this.analyticsConfig.dataPoints.length){var filter=22;20===this.analyticsConfig.period?filter=31:12===this.analyticsConfig.period?filter=28:10===this.analyticsConfig.period&&(filter=44),this.analyticsConfig.dateFilter=NewDateHelper/* default */.Z.getDatePickerObject(filter)}},onModeChange:function(){"mv"===this.analyticsConfig.mode?(this.analyticsConfig.dataPoints=[],this.resetFilter(),this.$refs["building-selector"].setInitialValues(this.analyticsConfig.dataPoints,this.selectedBuildings)):8===this.analyticsConfig.mode&&this.isSameCategoryDataPoint?(this.$message({message:this.$t("common.header.please_choose_single_asset_category_point"),type:"warning"}),this.analyticsConfig.dataPoints=[],this.resetFilter(),this.$refs["building-selector"].setInitialValues(this.analyticsConfig.dataPoints,this.selectedBuildings)):(this.analyticsConfig.dataPoints=this.analyticsConfig.dataPoints.filter((function(dp){return![2,4].includes(dp.type)&&"mvproject"!==dp.moduleName})),this.analyticsConfig.mvPoints=[],(0,validation/* isEmpty */.xb)(this.analyticsConfig.dataPoints)&&this.$refs["building-selector"].setInitialValues(this.analyticsConfig.dataPoints,this.selectedBuildings)),4!==this.analyticsConfig.mode&&(this.analyticsConfig.dataPoints=this.analyticsConfig.dataPoints.filter((function(dp){return![2,4].includes(dp.type)})))},onBaseLineChange:function(newBaseLine){var _this6=this;if(!this.oldBaseLine||this.oldBaseLine[0]!==newBaseLine[0]){if(this.oldBaseLine&&-1!==this.oldBaseLine[0]){var oldBlName=this.baseLineList.find((function(bl){return bl.id===_this6.oldBaseLine[0]})).name,dp=this.reportObject.options.dataPoints.find((function(dp){return dp.baseLineName===oldBlName}));if(!this.checkAndDeletePointsRel(this.reportObject.options,dp.alias))return this.$message.error(dp.baseLineName+this.$t("common.header.has_been_derivation_please_delete_derivation")),void this.$set(this.analyticsConfig,"baseLine",this.oldBaseLine)}this.oldBaseLine=(0,toConsumableArray/* default */.Z)(newBaseLine),this.$set(this.analyticsConfig,"baseLine",newBaseLine),!(0,validation/* isEmpty */.xb)(this.oldBaseLine)&&this.oldBaseLine.length>0&&-1!==this.oldBaseLine[0]?this.isShowCompareIndicator=!0:this.isShowCompareIndicator=!1}},applyFilter:function(){if(this.reportFilterForm.siteFilter.length||this.reportFilterForm.buildingFilter.length||this.reportFilterForm.categoryFilter.length||this.reportFilterForm.assetFilter.length||"none"!==this.reportFilterForm.liveFilterField||"single"!==this.reportFilterForm.liveFilterType)if(this.setfilter=1,this.reportFilterForm.siteFilter.length||this.reportFilterForm.buildingFilter.length||this.reportFilterForm.categoryFilter.length||this.reportFilterForm.assetFilter.length)if(this.reportFilterForm.assetFilter.length)this.analyticsConfig.filters={xCriteriaMode:3,parentId:this.reportFilterForm.assetFilter,filterState:this.$helpers.cloneObject(this.reportFilterForm)};else{var spaceFilter=this.reportFilterForm.buildingFilter.length?this.reportFilterForm.buildingFilter:this.reportFilterForm.siteFilter;this.analyticsConfig.filters={xCriteriaMode:4,assetCategory:this.reportFilterForm.categoryFilter,spaceId:spaceFilter,filterState:this.$helpers.cloneObject(this.reportFilterForm)}}else this.analyticsConfig.filters={xCriteriaMode:2,filterState:this.$helpers.cloneObject(this.reportFilterForm)};else this.setfilter=0,this.analyticsConfig.filters={xCriteriaMode:5,filterState:this.$helpers.cloneObject(this.reportFilterForm)};this.filtersPopover=!1}},onSettingsChange:function(changedOption){"alarm"===changedOption&&(this.reportObj.alarms&&this.reportObj.alarms.regions.length||!this.reportObj.options.settings.alarm||this.initChart())}},v1_Fportforlionewvue_type_script_lang_js=Fportforlionewvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(v1_Fportforlionewvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,Fportforlionew=component.exports},
/***/857539:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"0c4c867eeab407b0ed9771b49db7359e.svg";
/***/}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/62877.js.map