(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[84550],{
/***/490966:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return ColumnCustomization}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/ColumnCustomization.vue?vue&type=template&id=3753cf18
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{attrs:{visible:_vm.showDialog,fullscreen:!0,"custom-class":"cc-dialog",title:_vm.$t("common._common.column_settings"),"append-to-body":!0},on:{"update:visible":function($event){_vm.showDialog=$event}}},[_c("div",{staticClass:"scrollable",staticStyle:{padding:"20px 0","max-height":"85vh"}},[_vm.fixedFields&&_vm.fixedFields.length?_c("div",{staticClass:"fixed-column"},[_c("el-checkbox-group",{model:{value:_vm.selectedFixedColumns,callback:function($$v){_vm.selectedFixedColumns=$$v},expression:"selectedFixedColumns"}},_vm._l(_vm.fixedFields,(function(field){return _c("el-checkbox",{key:field.fieldId,staticClass:"column-item",staticStyle:{border:"none"},attrs:{disabled:field.disabled,label:field.fieldId}},[_vm._v(_vm._s(_vm.getDisplayName(field)))])})),1)],1):_vm._e(),_c("el-divider",{staticClass:"mT0 mB20"}),_c("el-checkbox-group",{staticClass:"fc-column-checkbox pL20 pR20 pT0 pB0",model:{value:_vm.selectedColumns,callback:function($$v){_vm.selectedColumns=$$v},expression:"selectedColumns"}},[_c("draggable",{attrs:{options:_vm.dragOptions,list:_vm.sortedFields,"data-parent":"default"}},_vm._l(_vm.sortedFields,(function(field){return _c("el-checkbox",{key:field.name,staticClass:"column-item",class:{checkboxSelected:!0===field.edit},attrs:{label:field.name,value:field.name}},[_c("el-row",[_c("el-col",{attrs:{span:1}},[_c("inline-svg",{staticClass:"vertical-middle cursor-drag icon-right column-drag-icon",staticStyle:{cursor:"-webkit-grabbing"},attrs:{src:"drag-drop",iconClass:"icon icon-sm-md"}})],1),_c("el-col",{attrs:{span:22}},[field.edit?_c("el-input",{ref:"columnRenameInp",refInFor:!0,staticClass:"fc-input-border-remove width90 column-name-change-input",attrs:{placeholder:"Change your column name",autofocus:!0},on:{blur:function($event){field.edit=!1,_vm.$emit("update")},keyup:function($event){if(!$event.type.indexOf("key")&&_vm._k($event.keyCode,"enter",13,$event.key,"Enter"))return null;field.edit=!1,_vm.$emit("update")}},model:{value:field.columnDisplayName,callback:function($$v){_vm.$set(field,"columnDisplayName",$$v)},expression:"field.columnDisplayName"}}):_c("div",{},[_vm._v(" "+_vm._s(field.columnDisplayName)+" "),field.field&&field.field.displayName!==field.columnDisplayName?_c("span",{staticClass:"fc-grey-text12 pL5"},[_vm._v(_vm._s(field.field.displayName))]):_vm._e()])],1),_c("el-col",{staticClass:"visibility-hide-actions text-right",attrs:{span:1}},[_c("i",{staticClass:"el-icon-edit pR10 fc-grey3-text14 pL25 column-edit-icon",on:{click:function($event){return $event.stopPropagation(),$event.preventDefault(),_vm.showRenameColumn(field)}}})])],1)],1)})),1),_c("draggable",{attrs:{options:_vm.dragOptions,list:_vm.selectedlookupColumns,"data-parent":_vm.selectedLookup}},_vm._l(_vm.selectedlookupColumns,(function(field){return _c("el-checkbox",{key:field.fieldId,staticClass:"column-item",attrs:{label:field.fieldId,"data-field-id":field.fieldId},on:{change:function($event){return _vm.onLookupSelected(field)}}},[_vm._v(" "+_vm._s(field.columnDisplayName)+" ")])})),1)],1)],1),_c("div",{staticClass:"modal-dialog-footer",attrs:{slot:"footer"},slot:"footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){_vm.showDialog=!1}}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.isSaving,disabled:_vm.isSaving},on:{click:_vm.save}},[_vm._v(_vm._s(_vm.isSaving?_vm.$t("common._common._saving"):_vm.$t("common._common._save")))])],1)])},staticRenderFns=[],objectSpread2=__webpack_require__(595082),toConsumableArray=__webpack_require__(488478),vuex_esm=(__webpack_require__(670560),__webpack_require__(450886),__webpack_require__(434284),__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(425728),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(634338),__webpack_require__(339772),__webpack_require__(947522),__webpack_require__(420629)),vuedraggable_umd=__webpack_require__(909980),vuedraggable_umd_default=__webpack_require__.n(vuedraggable_umd),validation=__webpack_require__(990260),jquery=__webpack_require__(619755),jquery_default=__webpack_require__.n(jquery),columnConfigUtil=__webpack_require__(486613),ColumnCustomizationvue_type_script_lang_js={props:["visible","moduleName","viewName","relatedViewDetail","relatedMetaInfo","refreshRelatedList","excludeMainField"],data:function(){return{selectedColumns:[],selectedFixedColumns:[],showDialog:this.visible,sortedFields:this.allFields,nonSelectableColumns:["localId","photoId"],lookupMetaColumns:{},selectedLookup:"",dragOptions:{handle:".icon-right",ghostClass:"drag-ghost",dragClass:"custom-drag",animation:150},columnNameShow:!1,isSaving:!1,editedColumn:null}},components:{draggable:vuedraggable_umd_default()},created:function(){var _this$nonSelectableCo,nonSelectableColumns=this.$getProperty(this.columnConfig,"nonSelectableColumns");(0,validation/* isEmpty */.xb)(nonSelectableColumns)||(_this$nonSelectableCo=this.nonSelectableColumns).push.apply(_this$nonSelectableCo,(0,toConsumableArray/* default */.Z)(nonSelectableColumns));this.sortedFields=this.allFields},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({stateMetaInfo:function(state){return state.view.metaInfo},stateViewDetail:function(state){return state.view.currentViewDetail}})),{},{metaInfo:function(){var stateMetaInfo=this.stateMetaInfo,relatedMetaInfo=this.relatedMetaInfo;return(0,validation/* isEmpty */.xb)(relatedMetaInfo)?stateMetaInfo:relatedMetaInfo},viewDetail:function(){var stateViewDetail=this.stateViewDetail,relatedViewDetail=this.relatedViewDetail;return(0,validation/* isEmpty */.xb)(relatedViewDetail)?stateViewDetail:relatedViewDetail},currentView:function(){return this.viewName?this.viewName:this.$route.params.viewname?this.$route.params.viewname:"all"},columnConfig:function(){var _ref=this.$attrs||{},columnConfig=_ref.columnConfig;return(0,validation/* isEmpty */.xb)(columnConfig)?(0,columnConfigUtil/* getColumnConfig */.U)(this.moduleName):columnConfig},fixedColumns:function(){
// Will be disabled. User wont be able to select
var columnConfig=this.columnConfig;if(!(0,validation/* isEmpty */.xb)(columnConfig)){var fixedColumns=columnConfig.fixedColumns;return fixedColumns}return[]},fixedSelectableColumns:function(){
// Cannot change the order
var columnConfig=this.columnConfig;if(!(0,validation/* isEmpty */.xb)(columnConfig)){var fixedSelectableColumns=columnConfig.fixedSelectableColumns;return fixedSelectableColumns}return[]},availableColumns:function(){var columnConfig=this.columnConfig;if(!(0,validation/* isEmpty */.xb)(columnConfig)){var availableColumns=columnConfig.availableColumns;return availableColumns}return[]},metaColumns:function(){var _this=this,columns=[];return this.metaInfo&&this.metaInfo.fields&&this.viewDetail&&(columns=this.metaInfo.fields.map((function(field){return field.columnDisplayName=_this.viewDetail.defaultModuleFields&&_this.viewDetail.defaultModuleFields[field.name]?_this.viewDetail.defaultModuleFields[field.name].columnDisplayName:field.displayName,field}))),columns},allFields:function(){var _this2=this,viewFields=this.viewFields.filter((function(field){return 17!==_this2.$getProperty(field,"field.dataType")})),metaColumns=this.metaColumns.filter((function(field){return!_this2.viewFields.find((function(val){return val.name===field.name}))&&!(_this2.nonSelectableColumns||[]).includes(field.name)&&(!(_this2.availableColumns||{}).length||-1!==_this2.availableColumns.indexOf(field.name)||!field.default)&&17!==field.dataType})),columns=[].concat((0,toConsumableArray/* default */.Z)(viewFields),(0,toConsumableArray/* default */.Z)(metaColumns)).filter((function(field){return!(_this2.allFixedColumns||[]).includes(field.name)}));return columns},viewFields:function(){var _this3=this,columns=[];return this.viewDetail&&this.viewDetail.fields&&(columns=this.viewDetail.fields.map((function(vf){vf.name=(vf.field||{}).name||vf.fieldName,vf.fieldId=(vf.field||{}).fieldId;var defaultColumnName=_this3.viewDetail.defaultModuleFields&&_this3.viewDetail.defaultModuleFields[vf.name]?_this3.viewDetail.defaultModuleFields[vf.name].columnDisplayName:null;return vf.columnDisplayName=vf.columnDisplayName||defaultColumnName||vf.field.displayName,vf}))),columns},fixedFields:function(){var _this4=this;return this.metaColumns.filter((function(field){return(_this4.allFixedColumns||[]).includes(field.name)})).map((function(field){return field.disabled=(_this4.fixedColumns||[]).includes(field.name),field}))},allFixedColumns:function(){return(0,validation/* isEmpty */.xb)(this.fixedSelectableColumns)?this.fixedColumns:this.fixedColumns.concat(this.fixedSelectableColumns)},lookupList:function(){var _this5=this,fields=[];return(this.columnConfig||{}).lookupToShow&&this.metaColumns&&(fields=this.metaColumns.filter((function(field){return field.lookupModule&&(!_this5.columnConfig.lookupToShow.length||(_this5.columnConfig.lookupToShow||[]).includes(field.name))}))),fields},selectedlookupColumns:function(){var _this6=this;return this.lookupMetaColumns[this.selectedLookup]?this.lookupMetaColumns[this.selectedLookup].filter((function(field){return-1===_this6.sortedFields.findIndex((function(vf){return vf.fieldId===field.fieldId}))})).map((function(field){return field.columnDisplayName=field.displayName,field.parentFieldId=_this6.selectedLookupObj.fieldId,field})):[]},selectedLookupObj:function(){var _this7=this;return this.lookupList.find((function(field){return field.name===_this7.selectedLookup}))},mainField:function(){return this.metaColumns.find((function(field){return field.mainField}))}}),watch:{visible:function(val,oldVal){val&&this.reInit(),this.showDialog=val},showDialog:function(val,oldVal){this.$emit("update:visible",val)},allFields:function(val){this.sortedFields=val}},methods:{showRenameColumn:function(field){var _this8=this;this.$set(field,"edit",!0),this.$nextTick((function(){_this8.$refs["columnRenameInp"][0].focus()}))},save:function(){var _this9=this;this.isSaving=!0;var excludeMainField=this.excludeMainField,fields=[];fields=(0,validation/* isEmpty */.xb)(excludeMainField)?[{fieldId:this.mainField.id}].concat((0,toConsumableArray/* default */.Z)(this.sortedFields.filter((function(sf){return(_this9.selectedColumns||[]).includes(sf.name)})).map((function(sf){return{fieldId:sf.fieldId,parentFieldId:sf.parentFieldId,columnDisplayName:sf.columnDisplayName,fieldName:sf.name||sf.fieldName}})))):(0,toConsumableArray/* default */.Z)(this.sortedFields.filter((function(sf){return(_this9.selectedColumns||[]).includes(sf.name)})).map((function(sf){return{fieldId:sf.fieldId,parentFieldId:sf.parentFieldId,columnDisplayName:sf.columnDisplayName,fieldName:sf.name||sf.fieldName}}))),fields=[].concat((0,toConsumableArray/* default */.Z)(fields),(0,toConsumableArray/* default */.Z)(this.selectedFixedColumns.map((function(id){return{fieldId:id}}))));var self=this;this.$store.dispatch("view/customizeColumns",{moduleName:this.moduleName,viewName:this.currentView,fields:fields}).then((function(){self.isSaving=!1,self.showDialog=!1,self.$emit("refreshRelatedList"),self.$message.success(self.$t("common._common.view_updated_successfully"))})).catch((function(error){_this9.$message.error(error.message||_this9.$t("common._common.error_occured"))}))},editColumn:function(){this.editedColumn=this.field},reInit:function(){var _this10=this;this.selectedLookup="",this.selectedColumns=[],this.selectedFixedColumns=[],this.viewFields.forEach((function(vf){(_this10.allFixedColumns||[]).includes(vf.name)&&-1===vf.parentFieldId?(_this10.fixedSelectableColumns||[]).includes(vf.name)&&_this10.selectedFixedColumns.push(vf.fieldId):_this10.selectedColumns.push(vf.name)}))},loadModuleMeta:function(){var _this11=this;this.selectedLookup&&!this.lookupMetaColumns[this.selectedLookup]&&this.$http.get("/module/meta?moduleName="+this.selectedLookupObj.lookupModule.name).then((function(response){_this11.$set(_this11.lookupMetaColumns,_this11.selectedLookup,response.data.meta.fields)}))},getDisplayName:function(field){var displayName=field.columnDisplayName;if(this.viewDetail&&this.viewDetail.fields){var vf=this.viewDetail.fields.find((function(vf){return vf.name===field.name}));vf&&(displayName=vf.columnDisplayName||displayName)}return displayName},onLookupSelected:function(field){this.animate(field.fieldId,(function(){this.selectedlookupColumns=this.selectedlookupColumns.filter((function(lf){return lf.fieldId!==field.fieldId})),field.columnDisplayName+=" ("+this.selectedLookupObj.displayName+")",this.sortedFields.push(field)}))},animate:function(fieldId,cbk){var $selectedElement=jquery_default()('[data-field-id="'+fieldId+'"]'),oldOffset=$selectedElement.offset();$selectedElement.appendTo(jquery_default()("[data-parent='default']"));var newOffset=$selectedElement.offset(),temp=$selectedElement.clone().appendTo("body");temp.css({position:"absolute",left:oldOffset.left,top:oldOffset.top,zIndex:3e3,width:$selectedElement[0].offsetWidth}),$selectedElement.css("visibility","hidden");var self=this;temp.animate({top:newOffset.top,left:newOffset.left},350,(function(){
// $selectedElement.css('visibility', 'visible')
$selectedElement.remove(),temp.remove(),cbk.call(self)}))}}},components_ColumnCustomizationvue_type_script_lang_js=ColumnCustomizationvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_ColumnCustomizationvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,ColumnCustomization=component.exports},
/***/384550:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return RelationWidget}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/page/widget/relationship/RelationWidget.vue?vue&type=template&id=13b595f6
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.showRelation?_c("RelationList",_vm._b({attrs:{widget:_vm.widget,details:_vm.details,parentId:_vm.parentId,toModuleName:_vm.toModuleName}},"RelationList",_vm.$attrs,!1)):_c("RelationSummary",_vm._b({attrs:{widget:_vm.widget,moduleName:_vm.toModuleName,details:_vm.relationRecord,parentId:_vm.parentId,isV3Api:!0,primaryFields:[],isLoading:_vm.isLoading,toModuleName:_vm.toModuleName},on:{onUpdate:_vm.loadData}},"RelationSummary",_vm.$attrs,!1))},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),RelationListWidgetvue_type_template_id_6d24379c_render=(__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(634338),function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"relationship-list-container"},[_c("div",{staticClass:"relationship-header-container"},[_c("div",{staticClass:"header-title"},[_c("div",{staticClass:"title-name"},[_vm._v(_vm._s(_vm.relationshipDisplayName))]),_c("div",{staticClass:"title-link"},[_vm._v(" "+_vm._s(_vm.relationName)+" - "+_vm._s(_vm.toModuleDisplayName)+" ")])]),_vm.isLoading?_vm._e():_c("div",{staticClass:"header-action"},[_vm.hasRelationList||_vm.hasSearchText?[_vm.showMainFieldSearch?_c("el-input",{ref:"mainFieldSearchInput",staticClass:"fc-input-full-border2 width-auto mL-auto",attrs:{clearable:"",placeholder:_vm.$t("common._common.search")},on:{blur:_vm.hideMainFieldSearch,clear:_vm.hideMainFieldSearch},model:{value:_vm.searchText,callback:function($$v){_vm.searchText=$$v},expression:"searchText"}}):_c("span",{on:{click:_vm.openMainFieldSearch}},[_c("inline-svg",{staticClass:"vertical-middle cursor-pointer",attrs:{src:"svgs/search",iconClass:"icon icon-sm mT5 mR5 search-icon"}})],1)]:_vm._e(),_vm.hasListCount?[_c("span",{staticClass:"separator self-center"},[_vm._v("|")]),_c("Pagination",{attrs:{currentPage:_vm.page,total:_vm.totalCount,perPage:_vm.perPage},on:{"update:currentPage":function($event){_vm.page=$event},"update:current-page":function($event){_vm.page=$event},onChange:_vm.loadRelationData}})]:_vm._e(),_vm.$hasPermission(_vm.moduleName+":UPDATE")?[_vm.hasListCount||_vm.hasRelationList||_vm.hasSearchText?_c("span",{staticClass:"separator"},[_vm._v("|")]):_vm._e(),_c("div",{staticClass:"associate-relation",on:{click:function($event){_vm.showLookupFieldWizard=!0}}},[_c("i",{staticClass:"el-icon-plus"}),_c("div",{staticClass:"associate-text"},[_vm._v(" "+_vm._s(_vm.$t("setup.relationship.associate"))+" ")])])]:_vm._e()],2)]),_vm.isLoading?_c("spinner",{staticClass:"loading-container d-flex justify-content-center",attrs:{show:_vm.isLoading}}):[_vm.hasRelationList?[_c("div",{staticClass:"column-customization-icon",on:{click:function($event){_vm.showColumnSettings=!0}}},[_c("img",{staticClass:"text-center position-absolute icon",attrs:{src:__webpack_require__(266707)}})]),_c("CommonList",{staticClass:"fc-common-table-list-module",attrs:{viewDetail:_vm.viewDetail,records:_vm.relationslist,moduleName:_vm.toModuleName,columnConfig:_vm.columnConfig,redirectToOverview:_vm.openRecordSummary,hideListSelect:!0,slotList:_vm.slotList},scopedSlots:_vm._u([{key:_vm.slotList[0].criteria,fn:function(ref){var record=ref.record;return[_c("div",{staticClass:"d-flex label-txt-black",class:{"main-field-column":_vm.isLink},on:{click:function($event){return _vm.openRecordSummary(record.id)}}},[_c("el-tooltip",{attrs:{effect:"dark",content:_vm.getFixName(record),placement:"top","open-delay":600}},[_c("div",{staticClass:"self-center mL0 "},[_vm._v(" "+_vm._s(_vm.getFixName(record))+" ")])])],1)]}},{key:_vm.slotList[1].name,fn:function(ref){var record=ref.record;return[_c("div",{staticClass:"d-flex justify-end mR20",on:{click:function($event){return _vm.deleteRecords([record.id])}}},[_c("el-tooltip",{attrs:{effect:"dark",content:_vm.$t("setup.relationship.dissociate"),placement:"top","open-delay":600}},[_c("inline-svg",{staticClass:"pointer visibility-hide-actions mT7",attrs:{src:"svgs/unlink",iconClass:"icon text-center icon-lg fill-delete"}})],1)],1)]}}],null,!0)}),_c("column-customization",{attrs:{visible:_vm.showColumnSettings,moduleName:_vm.toModuleName,viewName:"hidden-all",columnConfig:_vm.columnConfig,relatedViewDetail:_vm.viewDetail},on:{"update:visible":function($event){_vm.showColumnSettings=$event},refreshRelatedList:_vm.reloadData}})]:_c("div",{staticClass:"relationship-empty-state"},[_c("inline-svg",{attrs:{src:"svgs/emptystate/readings-empty",iconClass:"icon text-center icon-xxxlg"}}),_c("div",{staticClass:"pT10 fc-black-dark f18 bold pB50"},[_vm._v(" "+_vm._s(_vm.$t("setup.relationship.no_module_available",{moduleName:_vm.toModuleDisplayName}))+" ")])],1)],_vm.showLookupFieldWizard?_c("LookupWizard",{key:_vm.relationName+"-"+_vm.toModuleName,attrs:{canShowLookupWizard:_vm.showLookupFieldWizard,listUrlConfig:_vm.listUrlConfig,config:{}},on:{"update:canShowLookupWizard":function($event){_vm.showLookupFieldWizard=$event},"update:can-show-lookup-wizard":function($event){_vm.showLookupFieldWizard=$event},setListValues:_vm.setListValues}}):_vm._e()],2)}),RelationListWidgetvue_type_template_id_6d24379c_staticRenderFns=[],defineProperty=__webpack_require__(482482),WidgetPagination=(__webpack_require__(564043),__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(434284),__webpack_require__(648324),__webpack_require__(450886),__webpack_require__(806339)),api=__webpack_require__(32284),validation=__webpack_require__(990260),ui_forms=__webpack_require__(141323),CommonList=__webpack_require__(820920),ColumnCustomization=__webpack_require__(490966),isEqual=__webpack_require__(618446),isEqual_default=__webpack_require__.n(isEqual),router=__webpack_require__(329435),RelationListWidgetvue_type_script_lang_js={props:["details","widget","toModuleName","parentId","moduleName"],components:{CommonList:CommonList/* default */.Z,Pagination:WidgetPagination/* default */.Z,ColumnCustomization:ColumnCustomization/* default */.Z,LookupWizard:ui_forms/* LookupWizard */.ns},data:function(){return{relationslist:[],page:1,perPage:10,showMainFieldSearch:!1,searchText:null,viewDetail:{},totalCount:null,showLookupFieldWizard:!1,isLoading:!1,showColumnSettings:!1}},created:function(){var _this=this;this.init(),this.debounceMainFieldSearch=this.$helpers.debounce((function(){_this.page=1,_this.loadRelationData()}),700)},computed:{listUrlConfig:function(){var searchText=this.searchText,details=this.details,_ref=this.widget||{},relation=_ref.relation,_ref2=relation||{},fromModuleName=_ref2.fromModuleName,reverseRelationLinkName=_ref2.reverseRelationLinkName,params={unAssociated:!0};return(0,validation/* isEmpty */.xb)(searchText)||(params.search=searchText),{url:"v3/modules/".concat(fromModuleName,"/").concat(null===details||void 0===details?void 0:details.id,"/relationship/").concat(reverseRelationLinkName),toModuleName:this.toModuleName,params:params,multiple:!0}},mainFieldName:function(){var viewDetail=this.viewDetail,_ref3=viewDetail||{},fields=_ref3.fields,mainFieldObj=(fields||[]).find((function(fld){var _fld$field;return null===fld||void 0===fld||null===(_fld$field=fld.field)||void 0===_fld$field?void 0:_fld$field.mainField}))||{},_ref4=mainFieldObj||{},field=_ref4.field,_ref5=field||{},name=_ref5.name;return name},columnConfig:function(){var mainFieldName=this.mainFieldName;return{fixedColumns:[mainFieldName]}},slotList:function(){return[{criteria:JSON.stringify({name:this.mainFieldName})},{name:"editDelete",isActionColumn:!0,columnAttrs:{width:120,class:"visibility-visible-actions",fixed:"right"}}]},toModuleDisplayName:function(){return this.$getProperty(this.widget,"relation.toModule.displayName")},relationName:function(){return this.$getProperty(this.widget,"relation.relationName")},isLink:function(){var isCustomModule=this.$getProperty(this.widget,"relation.toModule.custom");return isCustomModule||(0,router/* isWebTabsEnabled */.tj)()},filterObj:function(){var filterObj={},mainFieldName=this.mainFieldName,searchText=this.searchText;return(0,validation/* isEmpty */.xb)(mainFieldName)||(0,validation/* isEmpty */.xb)(searchText)||(filterObj[mainFieldName]={operatorId:5,value:[searchText]}),filterObj},hasRelationList:function(){return!(0,validation/* isEmpty */.xb)(this.relationslist)},hasSearchText:function(){return!(0,validation/* isEmpty */.xb)(this.searchText)},hasListCount:function(){return!(0,validation/* isEmpty */.xb)(this.totalCount)&&0!==this.totalCount},relationshipDisplayName:function(){return this.$getProperty(this.widget,"relation.name")}},watch:{filterObj:function(newVal,oldVal){isEqual_default()(newVal,oldVal)||this.debounceMainFieldSearch()}},methods:{init:function(){this.loadRelationData(),this.loadViewDetails()},reloadData:function(){this.showColumnSettings=!1,this.init()},loadViewDetails:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var viewDetailUrl,_yield$API$get,data,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return viewDetailUrl="v2/views/hidden-all?moduleName=".concat(_this2.toModuleName),_context.next=3,api/* API */.bl.get(viewDetailUrl);case 3:_yield$API$get=_context.sent,data=_yield$API$get.data,error=_yield$API$get.error,error?_this2.$message.error(error.message||_this2.$t("common._common.error_occured")):_this2.viewDetail=(null===data||void 0===data?void 0:data.viewDetail)||{};case 7:case"end":return _context.stop()}}),_callee)})))()},getFixName:function(record){var mainFieldName=this.mainFieldName,_ref6=record||{},recordName=_ref6[mainFieldName];return recordName||"---"},loadRelationData:function(){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var _this3$details,_ref7,relation,_ref8,reverseRelationLinkName,params,config,url,_yield$API$get2,data,meta,error,_ref9,isCancelled;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _ref7=_this3.widget||{},relation=_ref7.relation,_ref8=relation||{},reverseRelationLinkName=_ref8.reverseRelationLinkName,params={viewName:"hidden-all",page:_this3.page,includeParentFilter:!0,withCount:!0,perPage:_this3.perPage,filters:(0,validation/* isEmpty */.xb)(_this3.filterObj)?null:JSON.stringify(_this3.filterObj)},_this3.isLoading=!0,config={force:!0},url="v3/modules/".concat(_this3.moduleName,"/").concat(null===(_this3$details=_this3.details)||void 0===_this3$details?void 0:_this3$details.id,"/relationship/").concat(reverseRelationLinkName),_context2.next=8,api/* API */.bl.get(url,params,config);case 8:_yield$API$get2=_context2.sent,data=_yield$API$get2.data,meta=_yield$API$get2.meta,error=_yield$API$get2.error,error?(_ref9=error||{},isCancelled=_ref9.isCancelled,isCancelled||_this3.$message.error(_this3.$t("common._common.error_occured"))):(_this3.relationslist=data[_this3.toModuleName]||[],_this3.totalCount=_this3.$getProperty(meta,"pagination.totalCount",null)),_this3.isLoading=!1;case 14:case"end":return _context2.stop()}}),_callee2)})))()},setListValues:function(selectedItems){if(!(0,validation/* isEmpty */.xb)(selectedItems)){var selectedId=selectedItems.map((function(item){var _ref10=item||{},value=_ref10.value;return value}));this.bulkCreateRelations(selectedId)}},openRecordSummary:function(id){var route,widget=this.widget,isCustomModule=this.$getProperty(widget,"relation.toModule.custom");if((0,router/* isWebTabsEnabled */.tj)()){var _ref11=(0,router/* findRouteForModule */.Jp)(this.toModuleName,router/* pageTypes */.As.OVERVIEW)||{},name=_ref11.name;name&&(route=this.$router.resolve({name:name,params:{viewname:"all",id:id}}).href)}else isCustomModule&&(route=this.$router.resolve({path:"/app/ca/modules/".concat(this.toModuleName,"/all/").concat(id,"/summary")}).href);return route&&window.open(route,"_blank"),route},openMainFieldSearch:function(){var _this4=this;this.showMainFieldSearch=!0,this.$nextTick((function(){var mainFieldSearchInput=_this4.$refs["mainFieldSearchInput"];(0,validation/* isEmpty */.xb)(mainFieldSearchInput)||mainFieldSearchInput.focus()}))},hideMainFieldSearch:function(){(0,validation/* isEmpty */.xb)(this.searchText)&&(this.showMainFieldSearch=!1)},bulkCreateRelations:function(selectedIds){var _this5=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var widget,parentId,_ref12,relation,_ref13,fromModuleName,toModuleName,forwardRelationLinkName,url,params,_yield$API$post,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return _this5.isLoading=!0,widget=_this5.widget,parentId=_this5.parentId,_ref12=widget||{},relation=_ref12.relation,_ref13=relation||{},fromModuleName=_ref13.fromModuleName,toModuleName=_ref13.toModuleName,forwardRelationLinkName=_ref13.forwardRelationLinkName,url="v3/modules/".concat(fromModuleName,"/").concat(parentId,"/relationship/").concat(forwardRelationLinkName),params={data:(0,defineProperty/* default */.Z)({},toModuleName,selectedIds)},_context3.next=8,api/* API */.bl.post(url,params);case 8:_yield$API$post=_context3.sent,error=_yield$API$post.error,error?(_this5.$message.error(error.message||_this5.$t("common._common.error_occured")),_this5.isLoading=!1):_this5.loadRelationData();case 11:case"end":return _context3.stop()}}),_callee3)})))()},deleteRecords:function(idList){var _this6=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){var value,widget,parentId,_ref14,relation,_ref15,fromModuleName,toModuleName,forwardRelationLinkName,url,params,_yield$API$patch,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,_this6.$dialog.confirm({title:_this6.$t("setup.relationship.dissociate"),message:_this6.$t("setup.relationship.delete_message"),rbDanger:!0,rbLabel:_this6.$t("setup.relationship.dissociate")});case 2:if(value=_context4.sent,value){_context4.next=5;break}return _context4.abrupt("return");case 5:return _this6.isLoading=!0,widget=_this6.widget,parentId=_this6.parentId,_ref14=widget||{},relation=_ref14.relation,_ref15=relation||{},fromModuleName=_ref15.fromModuleName,toModuleName=_ref15.toModuleName,forwardRelationLinkName=_ref15.forwardRelationLinkName,url="v3/modules/".concat(fromModuleName,"/").concat(parentId,"/relationship/").concat(forwardRelationLinkName),params={data:(0,defineProperty/* default */.Z)({},toModuleName,idList)},_context4.next=13,api/* API */.bl.patch(url,params);case 13:_yield$API$patch=_context4.sent,error=_yield$API$patch.error,error?(_this6.$message.error(error.message||_this6.$t("common._common.error_occured")),_this6.isLoading=!1):_this6.loadRelationData();case 16:case"end":return _context4.stop()}}),_callee4)})))()}}},relationship_RelationListWidgetvue_type_script_lang_js=RelationListWidgetvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(relationship_RelationListWidgetvue_type_script_lang_js,RelationListWidgetvue_type_template_id_6d24379c_render,RelationListWidgetvue_type_template_id_6d24379c_staticRenderFns,!1,null,null,null)
/* harmony default export */,RelationListWidget=component.exports,RelationSummaryWidgetvue_type_template_id_257e492a_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"relationship-summary-widget"},[_c("div",{staticClass:"relationship-header-container"},[_c("div",{staticClass:"header-title"},[_c("div",{staticClass:"title-name"},[_vm._v(_vm._s(_vm.relationshipDisplayName))]),_c("div",{staticClass:"title-link"},[_vm._v(" "+_vm._s(_vm.relationName)+" - "+_vm._s(_vm.toModuleDisplayName)+" ")])]),_vm.$hasPermission(_vm.parentModuleName+":UPDATE")&&!_vm.showLoading?[_vm.$validation.isEmpty(_vm.details)||_vm.emptyState?_c("div",{staticClass:"associate-relation",on:{click:function($event){_vm.showLookupFieldWizard=!0}}},[_c("i",{staticClass:"el-icon-plus"}),_c("div",{staticClass:"associate-text"},[_vm._v(" "+_vm._s(_vm.$t("setup.relationship.associate"))+" ")])]):_c("div",{staticClass:"disassociate-relation",on:{click:_vm.disassociateRecord}},[_c("i",{staticClass:"el-icon-remove-outline"}),_c("div",{staticClass:"disassociate-text"},[_vm._v(" "+_vm._s(_vm.$t("setup.relationship.dissociate"))+" ")])])]:_vm._e()],2),_c("div",{staticClass:"relationship-details-card"},[_c("div",{class:["asset-details-widget p0",_vm.widget.title&&"pT0"]},[_vm.widget.title?[_c("div",{staticClass:"widget-topbar"},[_c("div",{staticClass:"widget-title mL0"},[_vm._v(_vm._s(_vm.widget.title))])])]:_vm._e(),_vm.showLoading?_c("div",{class:["container",_vm.widget.title&&"pL0"]},[_vm._l([1,2,3],(function(index){return _c("div",{key:index,staticClass:"field"},[_c("el-row",[_c("el-col",{attrs:{span:12}},[_c("span",{class:["lines loading-shimmer",_vm.widget.title&&"m0"]})]),_c("el-col",{attrs:{span:12}},[_c("span",{class:["lines loading-shimmer",_vm.widget.title&&"m0"]})])],1)],1)})),_c("div",{staticClass:"field"},[_c("el-row",[_c("el-col",{attrs:{span:12}}),_c("el-col",{attrs:{span:12}})],1)],1)],2):_vm.emptyState?_c("div",{staticClass:"mT20 height100",staticStyle:{color:"#8ca1ad"}},[_c("div",{staticClass:"d-flex flex-direction-column height100 justify-content-center"},[_c("inline-svg",{staticClass:"vertical-middle self-center",attrs:{src:"svgs/emptystate/readings-empty",iconClass:"icon icon-xxxlg mR5"}}),_c("div",{staticClass:"f18 pB50 fc-black-dark bold pT10 pL10 self-center"},[_vm._v(" "+_vm._s(_vm.$t("setup.relationship.no_module_available",{moduleName:_vm.toModuleDisplayName}))+" ")])],1)]):_c("div",{ref:"content-container",class:["container",_vm.widget.title&&"pL0"]},[_vm._l(_vm.filteredFieldsList,(function(field,index){return[field.field.mainField?_c("el-row",{key:field.name+"-"+index+"-"+field.displayTypeEnum+"-mainfield",staticClass:"field"},[_c("el-col",{staticClass:"field-label",attrs:{span:12}},[_vm._v(" "+_vm._s(field.field.displayName)+" ")]),_c("el-col",{staticClass:"field-value line-height22",class:{"main-field-column":_vm.isLink},attrs:{span:12}},[_c("div",{staticClass:"is-know",on:{click:function($event){return _vm.openRecordSummary(_vm.details.id)}}},[_vm._v(" "+_vm._s(field.displayValue)+" ")])])],1):"TEXTAREA"===field.displayTypeEnum?_c("el-row",{key:field.name+"-"+index+"-TEXTAREA",staticClass:"field full-row"},[_c("el-col",{staticClass:"field-label",attrs:{span:6}},[_vm._v(" "+_vm._s(_vm.getFormattedDisplayName(field))+" ")]),_c("el-col",{staticClass:"field-value line-height22",attrs:{span:16}},[_vm._v(" "+_vm._s(field.displayValue)+" ")])],1):_vm.showChildMeterExp&&"childMeterExpression"===field.name?_c("el-row",{key:"childMeterExpression-"+index+"-"+field.displayTypeEnum,staticClass:"field full-row"},[_c("el-col",{staticClass:"field-label",attrs:{span:6}},[_vm._v(" "+_vm._s(field.displayName)+" ")]),_c("el-col",{staticClass:"field-value",attrs:{span:18}},[_c("child-meter-expression",{attrs:{assetDetails:_vm.details}})],1)],1):_c("el-row",{key:field.name+"-"+index+"-"+field.displayTypeEnum,staticClass:"field"},[_c("el-col",{key:field.displayName,staticClass:"field-label",attrs:{span:12}},[_vm._v(" "+_vm._s(_vm.getFormattedDisplayName(field))+" ")]),_c("el-col",{key:field.displayName+"value",staticClass:"field-value",attrs:{span:12}},[_vm.isRotatingItem(field)?_c("div",[_c("item-tool-avatar",{attrs:{name:"true",size:"lg",module:"item",recordData:_vm.details["rotatingItem"].itemType}})],1):_vm.isRotatingTool(field)?_c("div",[_c("item-tool-avatar",{attrs:{name:"true",size:"lg",module:"tool",recordData:_vm.details["rotatingTool"].toolType}})],1):_vm.systemFields.includes(field.name)?_c("div",[_vm._v(" "+_vm._s(_vm.getSysFieldValue(field))+" ")]):_vm.isFileField(field)?_c("div",[_c("el-row",[_c("el-col",{key:index+1+"asset",staticClass:"attachment-label pointer",attrs:{span:12}},[_vm.exportDownloadUrl[field.name]?_c("iframe",{staticStyle:{display:"none"},attrs:{src:_vm.exportDownloadUrl[field.name]}}):_vm._e(),_c("a",{on:{click:function($event){return _vm.downloadAttachment(field)}}},[_vm._v(" "+_vm._s(_vm.getFileName(field))+" ")])])],1)],1):"SIGNATURE"===_vm.$getProperty(field,"field.displayType")?_c("div",[_c("SignatureField",{attrs:{field:(field||{}).field,record:_vm.details}})],1):_vm.isGeoLocationField(field)?[_vm.$validation.isEmpty(field.displayValue)?_c("span",[_vm._v("---")]):_c("div",{staticClass:"bluetxt pointer",on:{click:function($event){return _vm.$helpers.openInMapForLatLngStr(field.displayValue)}}},[_vm._v(" "+_vm._s("@"+field.displayValue)+" ")])]:"MULTI_CURRENCY"===field.displayTypeEnum?[_c("CurrencyPopOver",{attrs:{field:field,details:_vm.details,showInfo:!0}})]:"URL_FIELD"===field.displayTypeEnum?[_vm.$validation.isEmpty(field.displayValue)||"---"===field.displayValue?_c("span",[_vm._v("---")]):_c("a",{staticClass:"url-field-display",attrs:{rel:"nofollow",href:_vm.$getProperty(field,"displayValue.href",""),target:_vm.$getProperty(field,"displayValue.target",""),referrerpolicy:"no-referrer"}},[_vm._v(_vm._s(_vm.getUrlDisplayName(field)))])]:_c("span",[_vm._v(_vm._s(field.displayValue))])],2)],1)]})),_vm.additionalField?_c("div",{staticClass:"field"},[_c("el-row",[_c("el-col",{staticClass:"field-label",attrs:{span:12}}),_c("el-col",{staticClass:"field-value",attrs:{span:12}})],1)],1):_vm._e()],2),_vm.needsShowMore?_c("div",{staticClass:"text-center pT10 pB15 mR20",staticStyle:{"background-color":"#fff"}},[_c("a",{staticClass:"fc-link fc-link-animation text-capitalize letter-spacing0_3 f13",on:{click:function($event){return _vm.toggleVisibility(120)}}},[_vm._v(_vm._s(_vm.showMoreLinkText))])]):_vm._e()],2)]),_vm.showLookupFieldWizard?_c("LookupWizard",{key:_vm.relationName+"-"+_vm.toModuleName,attrs:{canShowLookupWizard:_vm.showLookupFieldWizard,listUrlConfig:_vm.listUrlConfig,config:{}},on:{"update:canShowLookupWizard":function($event){_vm.showLookupFieldWizard=$event},"update:can-show-lookup-wizard":function($event){_vm.showLookupFieldWizard=$event},setListValues:_vm.setListValues}}):_vm._e()],1)},RelationSummaryWidgetvue_type_template_id_257e492a_scoped_true_staticRenderFns=[],HorizontalFieldDetails=(__webpack_require__(339772),__webpack_require__(162506),__webpack_require__(891719),__webpack_require__(719795)),RelationSummaryWidgetvue_type_script_lang_js={extends:HorizontalFieldDetails/* default */.Z,props:["isLoading","moduleName","parentId","toModuleName"],components:{LookupWizard:ui_forms/* LookupWizard */.ns},data:function(){return{showLookupFieldWizard:!1,loading:!0}},computed:{parentModuleName:function(){return this.$attrs.moduleName},filteredFieldsList:function(){var fieldsList=this.fieldsList;if(!(0,validation/* isEmpty */.xb)(fieldsList)){var mainFieldIdx=fieldsList.findIndex((function(fld){var _fld$field;return null===fld||void 0===fld||null===(_fld$field=fld.field)||void 0===_fld$field?void 0:_fld$field.mainField}));if(-1!==mainFieldIdx){var mainFieldObj=fieldsList[mainFieldIdx];fieldsList.splice(mainFieldIdx,1),fieldsList.unshift(mainFieldObj)}}return fieldsList},toModuleDisplayName:function(){return this.$getProperty(this.widget,"relation.toModule.displayName")},relationName:function(){return this.$getProperty(this.widget,"relation.relationName")},showLoading:function(){return this.isLoading||this.loading},isLink:function(){var isCustomModule=this.$getProperty(this.widget,"relation.toModule.custom");return isCustomModule||(0,router/* isWebTabsEnabled */.tj)()},relationshipDisplayName:function(){return this.$getProperty(this.widget,"relation.name")},listUrlConfig:function(){var searchText=this.searchText,parentId=this.parentId,_ref=this.widget||{},relation=_ref.relation,_ref2=relation||{},fromModuleName=_ref2.fromModuleName,reverseRelationLinkName=_ref2.reverseRelationLinkName,params={unAssociated:!0};return(0,validation/* isEmpty */.xb)(searchText)||(params.search=searchText),{url:"v3/modules/".concat(fromModuleName,"/").concat(parentId,"/relationship/").concat(reverseRelationLinkName),toModuleName:this.toModuleName,params:params}}},watch:{details:{handler:function(value,oldValue){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:isEqual_default()(value,oldValue)?_this.loading=!1:_this.getFormMeta();case 1:case"end":return _context.stop()}}),_callee)})))()}}},methods:{setListValues:function(selectedItems){var selectedId=selectedItems.map((function(item){var _ref3=item||{},value=_ref3.value;return value}));this.createRelations(selectedId)},getFormMeta:function(){var _this$widget,_this$widget2,_this2=this,moduleName=this.moduleName,details=this.details;if((0,validation/* isEmpty */.xb)(moduleName)||(0,validation/* isEmpty */.xb)(details))return this.emptyState=!0,void(this.loading=!1);this.loading=!0,api/* API */.bl.get("/v3/summary/fields/".concat(this.moduleName),{formId:details.formId?details.formId:-1,id:details.id,widgetParams:null!==(_this$widget=this.widget)&&void 0!==_this$widget&&_this$widget.widgetParams?JSON.stringify(null===(_this$widget2=this.widget)||void 0===_this$widget2?void 0:_this$widget2.widgetParams):null,fetchMainFields:!0}).then((function(_ref4){var error=_ref4.error,data=_ref4.data;error?(_this2.emptyState=!0,_this2.autoResize()):(_this2.emptyState=!1,_this2.deserialize(data)),_this2.loading=!1}))},createRelations:function(selectedId){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var widget,parentId,_ref5,relation,_ref6,fromModuleName,toModuleName,forwardRelationLinkName,url,params,_yield$API$post,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _this3.loading=!0,widget=_this3.widget,parentId=_this3.parentId,_ref5=widget||{},relation=_ref5.relation,_ref6=relation||{},fromModuleName=_ref6.fromModuleName,toModuleName=_ref6.toModuleName,forwardRelationLinkName=_ref6.forwardRelationLinkName,url="v3/modules/".concat(fromModuleName,"/").concat(parentId,"/relationship/").concat(forwardRelationLinkName),params={data:(0,defineProperty/* default */.Z)({},toModuleName,selectedId)},_context2.next=8,api/* API */.bl.post(url,params);case 8:_yield$API$post=_context2.sent,error=_yield$API$post.error,error?(_this3.$message.error(error.message||"Error Occurred "),_this3.loading=!1):(_this3.$message.success("Relation Added successfully"),_this3.$emit("onUpdate"));case 11:case"end":return _context2.stop()}}),_callee2)})))()},openRecordSummary:function(id){var route,widget=this.widget,isCustomModule=this.$getProperty(widget,"relation.toModule.custom");if((0,router/* isWebTabsEnabled */.tj)()){var _ref7=(0,router/* findRouteForModule */.Jp)(this.toModuleName,router/* pageTypes */.As.OVERVIEW)||{},name=_ref7.name;name&&(route=this.$router.resolve({name:name,params:{viewname:"all",id:id}}).href)}else isCustomModule&&(route=this.$router.resolve({path:"/app/ca/modules/".concat(this.toModuleName,"/all/").concat(id,"/summary")}).href);route&&window.open(route,"_blank")},disassociateRecord:function(){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var value,widget,parentId,details,_ref8,relation,_ref9,fromModuleName,toModuleName,forwardRelationLinkName,url,params,_yield$API$patch,error,message;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,_this4.$dialog.confirm({title:_this4.$t("setup.relationship.dissociate"),message:_this4.$t("setup.relationship.delete_message"),rbDanger:!0,rbLabel:_this4.$t("setup.relationship.dissociate")});case 2:if(value=_context3.sent,value){_context3.next=5;break}return _context3.abrupt("return");case 5:return _this4.loading=!0,widget=_this4.widget,parentId=_this4.parentId,details=_this4.details,_ref8=widget||{},relation=_ref8.relation,_ref9=relation||{},fromModuleName=_ref9.fromModuleName,toModuleName=_ref9.toModuleName,forwardRelationLinkName=_ref9.forwardRelationLinkName,url="v3/modules/".concat(fromModuleName,"/").concat(parentId,"/relationship/").concat(forwardRelationLinkName),params={data:(0,defineProperty/* default */.Z)({},toModuleName,[null===details||void 0===details?void 0:details.id])},_context3.next=13,api/* API */.bl.patch(url,params);case 13:_yield$API$patch=_context3.sent,error=_yield$API$patch.error,error?(message=error.message,_this4.$message.error(message||"Error Occured while deleting"),_this4.loading=!1):(_this4.$message.success(_this4.$t("common._common.delete_success")),_this4.needsShowMore=!1,_this4.resizeWidget({h:_this4.defaultWidgetHeight}),_this4.$emit("onUpdate"));case 16:case"end":return _context3.stop()}}),_callee3)})))()},isRotatingItem:function(field){var _ref10=field||{},fieldName=_ref10.name,_ref11=this.details||{},rotatingItem=_ref11.rotatingItem,_ref12=rotatingItem||{},rotatingItemId=_ref12.id;return rotatingItemId&&"rotatingItem"===fieldName},isRotatingTool:function(field){var _ref13=field||{},fieldName=_ref13.name,_ref14=this.details||{},rotatingTool=_ref14.rotatingTool,_ref15=rotatingTool||{},rotatingToolId=_ref15.id;return rotatingToolId&&"rotatingTool"===fieldName}}},relationship_RelationSummaryWidgetvue_type_script_lang_js=RelationSummaryWidgetvue_type_script_lang_js,RelationSummaryWidget_component=(0,componentNormalizer/* default */.Z)(relationship_RelationSummaryWidgetvue_type_script_lang_js,RelationSummaryWidgetvue_type_template_id_257e492a_scoped_true_render,RelationSummaryWidgetvue_type_template_id_257e492a_scoped_true_staticRenderFns,!1,null,"257e492a",null)
/* harmony default export */,RelationSummaryWidget=RelationSummaryWidget_component.exports,relationTypeMap={ONE_TO_ONE:1,ONE_TO_MANY:2,MANY_TO_ONE:3,MANY_TO_MANY:4},RelationWidgetvue_type_script_lang_js={name:"RelationWidget",props:["details","widget","id"],components:{RelationList:RelationListWidget,RelationSummary:RelationSummaryWidget},data:function(){return{relationRecord:null,isLoading:!1}},created:function(){this.showRelation||this.loadData()},computed:{parentId:function(){return this.id},toModuleName:function(){var _ref=this.widget||{},relation=_ref.relation,_ref2=relation||{},toModuleName=_ref2.toModuleName;return toModuleName},showRelation:function(){var _ref3=this.widget||{},relation=_ref3.relation,_ref4=relation||{},relationType=_ref4.relationType,_ref5=relationTypeMap||{},ONE_TO_MANY=_ref5.ONE_TO_MANY,MANY_TO_MANY=_ref5.MANY_TO_MANY;return[ONE_TO_MANY,MANY_TO_MANY].includes(relationType)},moduleName:function(){return this.$attrs.moduleName}},methods:{loadData:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var _this$details,_ref6,relation,_ref7,reverseRelationLinkName,params,url,_yield$API$get,data,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _this.isLoading=!0,_ref6=_this.widget||{},relation=_ref6.relation,_ref7=relation||{},reverseRelationLinkName=_ref7.reverseRelationLinkName,params={viewName:"hidden-all",includeParentFilter:!0,withCount:!0},url="v3/modules/".concat(_this.moduleName,"/").concat(null===(_this$details=_this.details)||void 0===_this$details?void 0:_this$details.id,"/relationship/").concat(reverseRelationLinkName),_context.next=7,api/* API */.bl.get(url,params,{force:!0});case 7:_yield$API$get=_context.sent,data=_yield$API$get.data,error=_yield$API$get.error,error?_this.$message.error(error.message||_this.$t("common._common.error_occured")):_this.relationRecord=_this.$getProperty(data,"".concat(_this.toModuleName,".0"),{}),_this.isLoading=!1;case 12:case"end":return _context.stop()}}),_callee)})))()}}},relationship_RelationWidgetvue_type_script_lang_js=RelationWidgetvue_type_script_lang_js,RelationWidget_component=(0,componentNormalizer/* default */.Z)(relationship_RelationWidgetvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,RelationWidget=RelationWidget_component.exports},
/***/266707:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"aa8bf7d214fbcc77945abad62903a613.svg";
/***/}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/84550.js.map