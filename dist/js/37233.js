"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[37233],{
/***/738229:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return NewHeatmapAnalysis}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/energy/analytics/newTools/NewHeatmapAnalysis.vue?vue&type=template&id=8266a59e
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"row"},[_c("div",{staticClass:"col-12 analytic-summary"},[_vm.exportDownloadUrl?_c("iframe",{staticStyle:{display:"none"},attrs:{src:_vm.exportDownloadUrl}}):_vm._e(),_c("div",{staticClass:"analytics-page-header heatmap-analytics new-heatmap-analytics"},[_c("div",{staticClass:"row"},[_c("div",{staticClass:"col-7"},[_c("div",{staticClass:"analytics-page-header-filters"},[_c("el-select",{staticClass:"width200px",attrs:{placeholder:_vm.$t("common.wo_report.select_building")},on:{change:_vm.selectBuilding},model:{value:_vm.heatMapDataPoint.buildingId,callback:function($$v){_vm.$set(_vm.heatMapDataPoint,"buildingId",$$v)},expression:"heatMapDataPoint.buildingId"}},[_c("el-option-group",{attrs:{label:"Building"}},_vm._l(_vm.$store.getters.getBuildingsPickList(),(function(building,key){return _c("el-option",{key:key,attrs:{label:building,value:key}})})),1)],1),_c("el-select",{staticClass:"width200px",attrs:{filterable:"",placeholder:_vm.$t("common.wo_report.select_meter")},on:{change:_vm.selectMeter},model:{value:_vm.heatMapDataPoint.parentId,callback:function($$v){_vm.$set(_vm.heatMapDataPoint,"parentId",$$v)},expression:"heatMapDataPoint.parentId"}},[_c("el-option-group",{attrs:{label:"Meter"}},_vm._l(_vm.subMeters,(function(meter,index){return _c("el-option",{key:index,attrs:{label:meter.name,value:meter.id}})})),1)],1)],1)]),_c("div",{staticClass:"col-5",staticStyle:{"text-align":"right"}},[_c("el-button",{staticClass:"freport-btn analytics-save-as-repor new-analytics-Rbtn",attrs:{disabled:_vm.isActionsDisabled},on:{click:function($event){_vm.visibility.saveAsDialog=!0}}},[_vm._v(_vm._s(_vm.$t("common.wo_report.save_as_report")))]),_c("div",{staticClass:"new-analytics-Rbtn analytics-page-options"},[_c("el-dropdown",{class:{"action-disabled":_vm.isActionsDisabled},on:{command:function($event){return _vm.exportData($event,_vm.analyticsConfig,_vm.iframeLoader)}}},[_c("el-button",{staticClass:"fc-chart-btn",attrs:{size:"small",type:"text"}},[_c("img",{staticClass:"report-icon",attrs:{src:__webpack_require__(153813)}})]),_c("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[_c("el-dropdown-item",{attrs:{command:"1",disabled:_vm.isActionsDisabled}},[_vm._v(_vm._s(_vm.$t("common.wo_report.export_csv")))]),_c("el-dropdown-item",{attrs:{command:"2",disabled:_vm.isActionsDisabled}},[_vm._v(_vm._s(_vm.$t("common.wo_report.export_xcl")))])],1)],1),_c("el-button",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"fc-chart-btn",attrs:{size:"small",disabled:_vm.isActionsDisabled,type:"text",title:_vm.$t("common.wo_report.email_this_report"),"data-position":"bottom","data-arrow":"true"},on:{click:function($event){_vm.visibility.emailReport=!0}}},[_c("img",{staticClass:"report-icon",attrs:{src:__webpack_require__(2175)}})]),_c("el-button",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"fc-chart-btn",attrs:{size:"small",disabled:_vm.isActionsDisabled,type:"text",title:_vm.$t("common.wo_report.print"),"data-position":"bottom","data-arrow":"true"},on:{click:_vm.printReport}},[_c("img",{staticClass:"report-icon",attrs:{src:__webpack_require__(467511)}})]),_c("email-report",{attrs:{visibility:_vm.visibility.emailReport,analyticsConfig:_vm.analyticsConfig},on:{"update:visibility":function($event){return _vm.$set(_vm.visibility,"emailReport",$event)}}}),_c("f-save-as-report",{attrs:{visibility:_vm.visibility.saveAsDialog,config:_vm.analyticsConfig},on:{"update:visibility":function($event){return _vm.$set(_vm.visibility,"saveAsDialog",$event)}}})],1)],1)])]),_c("div",{ref:"chartSection",staticClass:"self-center fchart-section scrollable"},[_vm.analyticsConfig.dataPoints.length?_c("f-analytic-report",{staticClass:"detail-report-align",attrs:{config:_vm.analyticsConfig},on:{"update:config":function($event){_vm.analyticsConfig=$event}}}):_c("div",{staticClass:"text-center"},[_c("div",{staticClass:"p15"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.please_select_meter"))+" ")])])],1)])])},staticRenderFns=[],FAnalyticReport=(__webpack_require__(169358),__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(523163)),FSaveAsReport=__webpack_require__(101699),EmailReport=__webpack_require__(150406),AnalyticsMixin=__webpack_require__(244936),NewHeatmapAnalysisvue_type_script_lang_js={mixins:[AnalyticsMixin/* default */.Z],components:{FAnalyticReport:FAnalyticReport/* default */.Z,FSaveAsReport:FSaveAsReport/* default */.Z,EmailReport:EmailReport/* default */.Z},data:function(){return{analyticsConfig:{name:"Heatmap Analysis",period:20,chartType:"heatMap",chartTypeChangable:!1,dateFilter:this.getDefaultDateFilter("Y"),dataPoints:[]},visibility:{saveAsDialog:!1,emailReport:!1},heatMapDataPoint:{buildingId:"",readingFieldId:"",readingField:null,parentId:"",parent:null,parentType:"asset",name:"Heatmap",yAggr:3},assetList:[],subMeters:[],exportDownloadUrl:null}},created:function(){var _this=this;this.$store.dispatch("loadEnergyMeters"),this.$store.dispatch("loadBuildings").then((function(){_this.loadAssets()}))},mounted:function(){},methods:{initHeatmapAnalysis:function(){Object.keys(this.$store.getters.getBuildingsPickList()).length&&(this.heatMapDataPoint.buildingId=Object.keys(this.$store.getters.getBuildingsPickList())[0],this.selectBuilding())},iframeLoader:function(url){this.exportDownloadUrl=url},selectBuilding:function(){this.subMeters=[],this.heatMapDataPoint.parentId="",this.loadSubMeters()},selectMeter:function(){this.loadReadingFields()},loadSubMeters:function(){var self=this,url="/dashboard/getSubMeters?buildingId="+this.heatMapDataPoint.buildingId;self.$http.get(url).then((function(response){if(self.subMeters=response.data.energyMeters,!self.heatMapDataPoint.parentId){var energyMeter=self.$store.state.energyMeters.find((function(meter){return meter.purposeSpace.id===parseInt(self.heatMapDataPoint.buildingId)}));energyMeter&&(self.heatMapDataPoint.parentId=energyMeter.id)}self.heatMapDataPoint.parentId&&self.selectMeter()}))},getAsset:function(id){return this.assetList.find((function(obj){return obj.id===id}))},loadAssets:function(id){this.loading=!0;var self=this;this.$util.loadAsset({withReadings:!0}).then((function(response){response.assets&&(self.assetList=response.assets,self.initHeatmapAnalysis(),self.loading=!1)}))},loadReadingFields:function(){var self=this,obj=self.getAsset(this.heatMapDataPoint.parentId);self.heatMapDataPoint.parent=obj;var url="/module/meta?moduleName=asset&assetId="+obj.id+"&categoryId="+obj.category.id+"&resourceType=asset";self.$http.get(url).then((function(response){if(self.readingFields=response.data.meta.fields,!self.heatMapDataPoint.readingFieldId){var energyDelta=self.readingFields.find((function(r){return"TOTAL_ENERGY_CONSUMPTION_DELTA"===r.columnName}));energyDelta&&(self.heatMapDataPoint.readingFieldId=energyDelta.id,self.heatMapDataPoint.readingField=energyDelta,self.analyticsConfig.dataPoints=[self.heatMapDataPoint])}}))}}},newTools_NewHeatmapAnalysisvue_type_script_lang_js=NewHeatmapAnalysisvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(newTools_NewHeatmapAnalysisvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,NewHeatmapAnalysis=component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/37233.js.map