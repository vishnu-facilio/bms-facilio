"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[46886,54760],{
/***/720096:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return PreviewFile}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/PreviewFile.vue?vue&type=template&id=447c7e89
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.currentFile?_c("div",{directives:[{name:"show",rawName:"v-show",value:_vm.show,expression:"show"}],staticClass:"preview-file"},[_c("div",{staticClass:"top-toolbar"},[_c("div",{staticClass:"a-top-toolbar"},[_c("div",{staticClass:"file-name word-break-keep"},[_vm._v(" "+_vm._s(_vm.currentFile.fileName)+" ")]),_c("div",{staticClass:"top-toolbar-icon-right flex align-center"},[_vm.currentFile.contentType.includes("image")?[_c("div",{staticClass:"flex-middle pL15"},[_vm.showOriginalImage?_c("div",{staticClass:"fc-white-14 word-break-keep pointer",on:{click:_vm.showOriginalPhoto}},[_vm._v(" "+_vm._s(_vm.$t("common._common.view_original"))+" ")]):_vm._e(),_vm.showCompressedImage?_c("div",{staticClass:"fc-white-14 word-break-keep pointer",on:{click:_vm.showCompressedPhoto}},[_vm._v(" "+_vm._s(_vm.$t("common._common.view_default"))+" ")]):_vm._e()]),_c("div",{staticClass:"download-icon round flex-middle pL15",on:{click:function($event){return _vm.downloadAttachment(_vm.currentFile)}}},[_c("i",{staticClass:"el-icon-download op8",staticStyle:{color:"#ffff"}})])]:_vm._e(),_vm.currentFile.contentType.includes("pdf")?[_c("div",{staticClass:"download-icon round flex-middle pL15",on:{click:function($event){return _vm.downloadAttachment(_vm.currentFile)}}},[_c("i",{staticClass:"el-icon-download op8",staticStyle:{color:"#ffff"}})])]:_vm._e(),_vm.showDeleteOption()?_c("div",{staticClass:"flex-middle pL15",on:{click:function($event){return _vm.deletePreview()}}},[_c("inline-svg",{staticClass:"pointer edit-icon-color close vertical-text-top",attrs:{src:"svgs/delete",iconClass:"icon icon-md"}})],1):_vm._e(),_c("div",{staticClass:"pL15"},[_c("i",{staticClass:"el-icon-close close",on:{click:_vm.closePreview}})])],2)])]),_vm.currentFileIndex>0?_c("a",{staticClass:"el-icon-arrow-left prev",staticStyle:{"font-size":"30px"},on:{click:function($event){return _vm.plusSlides(-1)}}}):_vm._e(),_vm.currentFileIndex<_vm.files.length-1?_c("a",{staticClass:"el-icon-arrow-right next",staticStyle:{"font-size":"30px"},on:{click:function($event){return _vm.plusSlides(1)}}}):_vm._e(),_c("div",{staticClass:"preview-content"},[_vm.currentFile.contentType.includes("image")?[_vm.compressedImage?_c("img",{staticClass:"content",staticStyle:{"box-shadow":"none"},attrs:{src:_vm.$prependBaseUrl(_vm.currentFile.previewUrl)}}):_vm.originalImage?_c("img",{staticClass:"content original",staticStyle:{"box-shadow":"none"},attrs:{src:_vm.$prependBaseUrl(_vm.currentFile.previewUrl+"?fetchOriginal=true")}}):_vm._e()]:_vm.currentFile.contentType.includes("pdf")?_c("div",{staticClass:"width100 height-100"},[_c("iframe",{staticClass:"fc-preview-pdf",attrs:{src:_vm.$prependBaseUrl(_vm.currentFile.previewUrl),height:"100%",width:"100%"}})]):_vm.isVideoSupported(_vm.currentFile.contentType)?_c("div",{staticClass:"width100 height-100 fc-preview-video"},[_c("video",{attrs:{controls:""}},[_c("source",{attrs:{src:_vm.$prependBaseUrl(_vm.$getProperty(_vm.currentFile,"downloadUrl",null)),type:_vm.$getProperty(_vm.currentFile,"contentType")}}),_vm._v(" "+_vm._s(_vm.$t("common._common.browser_not_supported"))+" ")])]):_c("div",{staticClass:"no-preview"},[_c("div",{staticClass:"flex justify-center pT24"},[_c("inline-svg",{staticClass:"d-flex",attrs:{src:_vm.getFileIcon(_vm.currentFile),iconClass:"icon icon-60 overlay"}})],1),_c("div",{staticClass:"f14 pT12 pB12"},[_vm._v("No preview available")]),_c("div",{staticClass:"download-button"},[_c("a",{staticClass:"flex flex-row",staticStyle:{color:"#ffff"},on:{click:function($event){return _vm.downloadAttachment(_vm.currentFile)}}},[_c("div",[_vm._v("Download")])])])])],2),_vm.exportDownloadUrl?_c("iframe",{staticStyle:{display:"none"},attrs:{src:_vm.exportDownloadUrl}}):_vm._e()]):_vm._e()},staticRenderFns=[],validation=(__webpack_require__(339772),__webpack_require__(260228),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(228436),__webpack_require__(990260)),PreviewFilevue_type_script_lang_js={props:["previewFile","files","visibility","showDelete","isLockedState","isTaskClosed"],data:function(){return{show:!0,previewUrl:null,currentFileIndex:0,currentFile:null,imageMargin:null,exportDownloadUrl:null,originalImage:!1,compressedImage:!0,showOriginalImage:!0,showCompressedImage:!1}},destroyed:function(){window.removeEventListener("keyup",this.handler)},mounted:function(){window.addEventListener("keyup",this.handler),this.preloadImages()},watch:{},computed:{},methods:{handler:function(){
// If escape key is pressed...
27===event.keyCode?this.closePreview():37===event.keyCode?this.plusSlides(-1):39===event.keyCode&&this.plusSlides(1)},preloadImages:function(){this.currentFile=this.previewFile?this.previewFile:this.files[0],this.currentFileIndex=this.files.indexOf(this.currentFile)},plusSlides:function(n){var index=this.currentFileIndex+n;index<0&&(index=0),index>=this.files.length&&(index=this.files.length-1),this.currentFileIndex=index,this.currentFile=this.files[index]},closePreview:function(){this.$emit("update:visibility",!1)},deletePreview:function(){var currentFile=this.currentFile;this.$emit("onDelete",currentFile)},downloadAttachment:function(file){var _this=this,_ref=file||{},url=_ref.downloadUrl;this.exportDownloadUrl&&(this.exportDownloadUrl=null),this.$nextTick((function(){_this.exportDownloadUrl=url}))},showOriginalPhoto:function(){this.originalImage=!0,this.showCompressedImage=!0,this.showOriginalImage=!1,this.compressedImage=!1},showCompressedPhoto:function(){this.showCompressedImage=!1,this.originalImage=!1,this.showOriginalImage=!0,this.compressedImage=!0},getFileIcon:function(attachment){var contentType=attachment.contentType,FILE_TYPE_ICONS=this.$constants.FILE_TYPE_ICONS,selectedIndex=FILE_TYPE_ICONS.findIndex((function(icons){var fileTypes=icons.fileTypes;return fileTypes.some((function(type){return contentType.includes(type)}))}));return(0,validation/* isEmpty */.xb)(selectedIndex)?FILE_TYPE_ICONS[0].path:FILE_TYPE_ICONS[selectedIndex].path},isVideoSupported:function(contentType){contentType=contentType||"";var supportedTypes=["video/webm","video/mp4","video/ogg"];return supportedTypes.includes(contentType.trim().toLowerCase())},showDeleteOption:function(){var showDelete=this.showDelete,isLockedState=this.isLockedState,isTaskClosed=this.isTaskClosed;return showDelete&&!isLockedState&&!isTaskClosed}}},components_PreviewFilevue_type_script_lang_js=PreviewFilevue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_PreviewFilevue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,PreviewFile=component.exports},
/***/646716:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FetchViewsMixin}});
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js
var render,staticRenderFns,regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),validation=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(434284),__webpack_require__(990260)),api=__webpack_require__(32284),FetchViewsMixinvue_type_script_lang_js={methods:{fetchView:function(moduleName){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var params,_yield$API$get,data,error,_ref,groupViews;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.prev=0,params={moduleName:moduleName,groupType:1,viewType:1},_context.next=4,api/* API */.bl.get("/v2/views/viewList",params);case 4:if(_yield$API$get=_context.sent,data=_yield$API$get.data,error=_yield$API$get.error,error){_context.next=10;break}return _ref=data||{},groupViews=_ref.groupViews,_context.abrupt("return",_this.getFirstView(groupViews));case 10:_context.next=15;break;case 12:return _context.prev=12,_context.t0=_context["catch"](0),_context.abrupt("return","all");case 15:case"end":return _context.stop()}}),_callee,null,[[0,12]])})))()},getFirstView:function(groupViews){var _ref2=(groupViews||[]).find((function(group){return!(0,validation/* isEmpty */.xb)(group.views)}))||{},views=_ref2.views,_this$$getProperty=this.$getProperty(views,"0",{}),name=_this$$getProperty.name;return name||"all"}}},base_FetchViewsMixinvue_type_script_lang_js=FetchViewsMixinvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(base_FetchViewsMixinvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FetchViewsMixin=component.exports;
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js
},
/***/150159:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return SummaryFieldsWidget}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/page/widget/common/field-details/SummaryFieldsWidget.vue?vue&type=template&id=33a6a147&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"sfw-container"},[_vm.isLoading?_c("spinner",{attrs:{show:_vm.isLoading,size:"80"}}):_vm.$validation.isEmpty(_vm.detailsLayout)?_c("div",{ref:"content-container",staticClass:"sfw-empty-state-container"},[_c("inline-svg",{staticClass:"self-center",attrs:{src:"svgs/custom-empty-state",iconClass:"icon text-center icon-xxxxlg"}}),_c("div",{staticClass:"mT10 label-txt-black f14 self-center"},[_vm._v(" "+_vm._s(_vm.$t("common._common.error_summary_widget_field"))+" ")])],1):_c("div",{ref:"content-container"},[_c("FieldDetails",{attrs:{detailsLayout:_vm.detailsLayout,config:_vm.config},on:{fileDownload:_vm.downloadAttachment,lookupRedirect:_vm.redirectToSummary}})],1),_vm.needsShowMore&&!_vm.$validation.isEmpty(_vm.detailsLayout)?_c("div",{staticClass:"view-more"},[_c("a",{staticClass:" fc-link-animation text-capitalize letter-spacing0_3 f13 margin-auto view-text",on:{click:_vm.toggleVisibility}},[_vm._v(_vm._s(_vm.showMoreLinkText))])]):_vm._e(),_vm.exportDownloadUrl?_c("iframe",{staticStyle:{display:"none"},attrs:{src:_vm.exportDownloadUrl}}):_vm._e(),_vm.showPreview?_c("PreviewFile",{attrs:{visibility:_vm.showPreview,previewFile:_vm.previewFile,files:[_vm.previewFile]},on:{"update:visibility":function($event){_vm.showPreview=$event}}}):_vm._e()],1)},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),objectSpread2=__webpack_require__(595082),app=(__webpack_require__(634338),__webpack_require__(434284),__webpack_require__(450886),__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(782080)),api=__webpack_require__(32284),router=__webpack_require__(329435),validation=__webpack_require__(990260),picklist=__webpack_require__(961358),FetchViewsMixin=__webpack_require__(646716),PreviewFile=__webpack_require__(720096),dlv_umd=__webpack_require__(226905),dlv_umd_default=__webpack_require__.n(dlv_umd),vuex_esm=__webpack_require__(420629),lookupModulesRouterMap={workorder:function(id,viewname){return{name:"wosummarynew",params:{id:id,viewname:viewname}}},ticket:function(id,viewname){return{name:"wosummarynew",params:{id:id,viewname:viewname}}},asset:function(id,viewname){return{path:"/app/at/assets/".concat(viewname,"/").concat(id,"/overview")}},alarm:function(id,viewname){return{path:"/app/fa/faults/".concat(viewname,"/newsummary/").concat(id)}},vendors:function(id,viewname){return{path:"/app/vendor/vendors/".concat(viewname,"/summary/").concat(id)}},purchaseorder:function(id,viewname){return{name:"poSummary",params:{id:id,viewname:viewname}}},custom:function(id,viewname,moduleName){return{name:"custommodules-summary",params:{moduleName:moduleName,viewname:viewname,id:id}}}},dataConstructHash={DEFAULT:function(details,mainField){var name=mainField.name,value=details[name]||null;return{name:name,value:value}},ENUM_HASH:function(details,mainField){var name=mainField.name,value=details[name]||null,_ref=mainField||{},enumMap=_ref.field.enumMap,options=(0,objectSpread2/* default */.Z)({},enumMap);return{value:value,options:options,name:name}},FILE:function(details,mainField){var name=mainField.name,value=details["".concat(name,"FileName")]||null,url=details["".concat(name,"DownloadUrl")]||null,contentType=details["".concat(name,"ContentType")]||null,previewUrl=details["".concat(name,"Url")]||null,isClickable=!(0,validation/* isEmpty */.xb)(value);return{value:value,url:url,contentType:contentType,previewUrl:previewUrl,isClickable:isClickable,name:name}},DIGIT_HASH:function(details,mainField){var _ref2=mainField||{},name=_ref2.name,unit=dlv_umd_default()(mainField,"field.unit",null),value=details[name]||null,returnValue={name:name,value:value};return unit&&(returnValue.options={unit:unit}),returnValue},BOOLEAN:function(details,mainField){var _ref3=mainField||{},fieldObj=_ref3.field,name=_ref3.name,trueVal=fieldObj.trueVal,falseVal=fieldObj.falseVal,options={trueVal:trueVal,falseVal:falseVal},value=details[name]||null;return{options:options,name:name,value:value}},CURRENCY_FIELD:function(details,mainField){var _ref4=mainField||{},name=_ref4.name;return{value:details[name]||{},name:name}},MULTI_CURRENCY_FIELD:function(details,mainField){var _ref5=mainField||{},name=_ref5.name,_ref6=details||{},currencyCode=_ref6.currencyCode,exchangeRate=_ref6.exchangeRate;return{value:details[name]||null,name:name,currencyCode:currencyCode,exchangeRate:exchangeRate}},LOOKUP:function(details,mainField){return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var field,fieldName,parentLookupField,_ref7,lookupModule,moduleName,lookupModuleName,name,getFieldValue,id,idArr,_yield$fetchSecondLev,isClickable,value;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return field=mainField.field,fieldName=mainField.name,parentLookupField=mainField.parentLookupField,_ref7=field||{},lookupModule=_ref7.lookupModule,moduleName=lookupModule.name,lookupModuleName=(null===parentLookupField||void 0===parentLookupField?void 0:parentLookupField.name)||"",name=lookupModuleName?"".concat(lookupModuleName,".").concat(fieldName):"".concat(fieldName),getFieldValue=function(fieldName){var fieldValue=details[fieldName];return(0,validation/* isEmpty */.xb)(fieldValue)?[]:[fieldValue]},id=dlv_umd_default()(details,"".concat(name,".id"),null),idArr=(0,validation/* isEmpty */.xb)(id)?[]:[id],_context.next=10,fetchSecondLevelValues(mainField,getFieldValue,idArr);case 10:return _yield$fetchSecondLev=_context.sent,isClickable=_yield$fetchSecondLev.isClickable,value=_yield$fetchSecondLev.value,value=value[0]||null,_context.abrupt("return",{id:id,isClickable:isClickable,moduleName:moduleName,name:name,value:value});case 15:case"end":return _context.stop()}}),_callee)})))()},MULTI_LOOKUP:function(details,mainField){return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var field,fieldName,parentLookupField,_ref8,lookupModule,_ref9,moduleName,lookupModuleName,name,ids,id,getFieldValue,_yield$fetchSecondLev2,isClickable,value;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return field=mainField.field,fieldName=mainField.name,parentLookupField=mainField.parentLookupField,_ref8=field||{},lookupModule=_ref8.lookupModule,_ref9=lookupModule||{},moduleName=_ref9.name,lookupModuleName=(null===parentLookupField||void 0===parentLookupField?void 0:parentLookupField.name)||"",name=lookupModuleName?"".concat(lookupModuleName,".").concat(fieldName):"".concat(fieldName),ids=dlv_umd_default()(details,"".concat(name),null)||[],id=ids.map((function(lookupObj){return lookupObj.id})),getFieldValue=function(fieldName){return details[fieldName]||[]},_context2.next=10,fetchSecondLevelValues(mainField,getFieldValue,id);case 10:return _yield$fetchSecondLev2=_context2.sent,isClickable=_yield$fetchSecondLev2.isClickable,value=_yield$fetchSecondLev2.value,value=value.map((function(ml){return ml.moduleName=moduleName,ml})),_context2.abrupt("return",{value:value,isClickable:isClickable,name:name});case 15:case"end":return _context2.stop()}}),_callee2)})))()}},fetchSecondLevelValues=function(){var _ref10=(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(mainField,getFieldValue,id){var field,secondLevelLookup,name,_ref11,lookupModule,_ref12,moduleName,typeEnum,custom,value,isClickable;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:if(field=mainField.field,secondLevelLookup=mainField.secondLevelLookup,name=mainField.name,_ref11=field||{},lookupModule=_ref11.lookupModule,_ref12=lookupModule||{},moduleName=_ref12.name,typeEnum=_ref12.typeEnum,custom=_ref12.custom,isClickable="BASE_ENTITY"===typeEnum&&((0,router/* isWebTabsEnabled */.tj)()||custom),!secondLevelLookup){_context3.next=13;break}return _context3.next=7,fetchLookupName(moduleName,id);case 7:if(_context3.t0=_context3.sent,_context3.t0){_context3.next=10;break}_context3.t0=[];case 10:value=_context3.t0,_context3.next=14;break;case 13:value=getFieldValue(name)||[];case 14:return isClickable=!(0,validation/* isEmpty */.xb)(value)&&isClickable,_context3.abrupt("return",{isClickable:isClickable,value:value});case 16:case"end":return _context3.stop()}}),_callee3)})));return function(_x,_x2,_x3){return _ref10.apply(this,arguments)}}(),fetchLookupName=function(){var _ref13=(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(moduleName,id){var value,perPage,_yield$getFieldOption,error,options,filterOptions;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:if(value=[],(0,validation/* isEmpty */.xb)(id)){_context4.next=9;break}return perPage=id.length,_context4.next=5,(0,picklist/* getFieldOptions */._K)({perPage:perPage,field:{lookupModuleName:moduleName},defaultIds:id});case 5:_yield$getFieldOption=_context4.sent,error=_yield$getFieldOption.error,options=_yield$getFieldOption.options,(0,validation/* isEmpty */.xb)(error)&&(filterOptions=(options||[]).filter((function(item){return id.includes(item.value)})),value=filterOptions.map((function(item){return{name:item.label}})));case 9:return _context4.abrupt("return",value);case 10:case"end":return _context4.stop()}}),_callee4)})));return function(_x4,_x5){return _ref13.apply(this,arguments)}}(),SummaryFieldsWidgetvue_type_script_lang_js={props:["layoutParams","details","moduleName","primaryFields","widget","isV3Api","disableAutoResize","detailsLayoutProp","siteList"],components:{FieldDetails:app/* NewFieldDetails */.f3,PreviewFile:PreviewFile/* default */.Z},mixins:[FetchViewsMixin/* default */.Z],data:function(){return{appId:null,detailsLayout:null,sites:{},needsShowMore:!1,isAllVisible:!1,defaultWidgetHeight:(this.layoutParams||{}).h,config:null,isLoading:!1,exportDownloadUrl:null,showPreview:!1,previewFile:null}},created:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee5(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context5){while(1)switch(_context5.prev=_context5.next){case 0:_this.init();case 1:case"end":return _context5.stop()}}),_callee5)})))()},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({account:function(state){return state.account},currencyList:function(state){return state.activeCurrencies}})),{},{showMoreLinkText:function(){return this.isAllVisible?this.$t("common._common.view_less"):this.$t("common._common.view_more")},widgetName:function(){var _this$widget;return this.$attrs.widgetName||(null===(_this$widget=this.widget)||void 0===_this$widget?void 0:_this$widget.name)},multiCurrency:function(){var _ref14=this.account.data.currencyInfo||{},displaySymbol=_ref14.displaySymbol,currencyCode=_ref14.currencyCode,multiCurrencyEnabled=_ref14.multiCurrencyEnabled;return{displaySymbol:displaySymbol,currencyCode:currencyCode,multiCurrencyEnabled:multiCurrencyEnabled}}}),methods:{init:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee6(){var multiCurrency;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context6){while(1)switch(_context6.prev=_context6.next){case 0:return _this2.isLoading=!0,multiCurrency=_this2.multiCurrency,_context6.next=4,_this2.$store.dispatch("getActiveCurrencyList");case 4:return _this2.config={dateformat:_this2.$dateformat,timezone:_this2.$timezone,timeformat:_this2.$timeformat,org:_this2.$account.org,multiCurrency:multiCurrency,currencies:_this2.currencyList},_this2.appId=((0,router/* getApp */.wx)()||{}).id,_context6.next=8,_this2.fetchSites();case 8:return _context6.next=10,_this2.fetchDetails();case 10:_this2.isLoading=!1,_this2.$nextTick((function(){(0,validation/* isEmpty */.xb)(_this2.detailsLayout)?_this2.resizeWidget({height:250}):_this2.disableAutoResize?_this2.$emit("autoResize",_this2.$refs["content-container"]):_this2.autoResize()}));case 12:case"end":return _context6.stop()}}),_callee6)})))()},openAttachment:function(fileObj){var url=fileObj.url,contentType=fileObj.contentType,previewUrl=fileObj.previewUrl,value=fileObj.value;this.previewFile={fileName:value,contentType:contentType,downloadUrl:url,previewUrl:previewUrl},this.showPreview=!0},fetchDetails:function(){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee7(){var detailsLayout,moduleName,appId,widgetName,_yield$API$get,data,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context7){while(1)switch(_context7.prev=_context7.next){case 0:if(detailsLayout=null,!(0,validation/* isEmpty */.xb)(_this3.detailsLayoutProp)){_context7.next=11;break}return moduleName=_this3.moduleName,appId=_this3.appId,widgetName=_this3.widgetName,_context7.next=5,api/* API */.bl.get("v2/customPage/summaryFieldWidget",{moduleName:moduleName,appId:appId,widgetName:widgetName});case 5:_yield$API$get=_context7.sent,data=_yield$API$get.data,error=_yield$API$get.error,error||(detailsLayout=data),_context7.next=12;break;case 11:detailsLayout=_this3.detailsLayoutProp;case 12:return _context7.next=14,_this3.serializeDetailsLayout(detailsLayout);case 14:case"end":return _context7.stop()}}),_callee7)})))()},serializeDetailsLayout:function(data){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee9(){var _ref15,summaryFieldWidget,_ref16,groups,filteredGroup,detailsLayout;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context9){while(1)switch(_context9.prev=_context9.next){case 0:return _ref15=data||{},summaryFieldWidget=_ref15.summaryFieldWidget,_ref16=summaryFieldWidget||{},groups=_ref16.groups,filteredGroup=(groups||[]).filter((function(group){return!(0,validation/* isEmpty */.xb)(group.fields)})),detailsLayout=(filteredGroup||[]).map(function(){var _ref17=(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee8(group){var fields,colorCode,displayName,columns,serializedFields;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context8){while(1)switch(_context8.prev=_context8.next){case 0:return fields=group.fields,colorCode=group.colorCode,displayName=group.displayName,columns=group.columns,_context8.next=3,_this4.constructFieldValues(fields);case 3:return serializedFields=_context8.sent,_context8.abrupt("return",{name:displayName,fields:serializedFields,sectionConfig:{columns:columns,colorCode:colorCode}});case 5:case"end":return _context8.stop()}}),_callee8)})));return function(_x6){return _ref17.apply(this,arguments)}}()),_context9.next=6,Promise.all(detailsLayout);case 6:_this4.detailsLayout=_context9.sent;case 7:case"end":return _context9.stop()}}),_callee9)})))()},constructFieldValues:function(fields){var _this5=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee11(){var details,groupObj;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context11){while(1)switch(_context11.prev=_context11.next){case 0:return details=_this5.details,groupObj=fields.map(function(){var _ref18=(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee10(mainField){var _ref19,field,name,secondLevelLookup,parentLookupField,displayName,colSpan,colIndex,rowIndex,diplayTypeMain,_ref20,dataTypeEnum,displayType,recordHolder,_ref21,lookupModuleName,extraValues,siteId,siteLabel,value;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context10){while(1)switch(_context10.prev=_context10.next){case 0:if(_ref19=mainField||{},field=_ref19.field,name=_ref19.name,secondLevelLookup=_ref19.secondLevelLookup,parentLookupField=_ref19.parentLookupField,displayName=_ref19.displayName,colSpan=_ref19.colSpan,colIndex=_ref19.colIndex,rowIndex=_ref19.rowIndex,diplayTypeMain=_ref19.displayType,_ref20=field||{},dataTypeEnum=_ref20.dataTypeEnum,displayType=_ref20.displayType,recordHolder=details||{},(0,validation/* isEmpty */.xb)(parentLookupField)||secondLevelLookup||(_ref21=parentLookupField||{},lookupModuleName=_ref21.name,recordHolder=details[lookupModuleName]||{}),"siteId"!==name){_context10.next=12;break}siteId=details[name]||"",siteLabel=_this5.sites[siteId]||"",value=siteLabel||null,extraValues={name:name,value:value},dataTypeEnum="OTHERS",_context10.next=15;break;case 12:return _context10.next=14,_this5.getHash(dataTypeEnum)(recordHolder,mainField);case 14:extraValues=_context10.sent;case 15:return _context10.abrupt("return",(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({displayName:displayName},extraValues),{},{dataTypeEnum:dataTypeEnum,displayType:displayType||diplayTypeMain||null,fieldConfig:{rowIndex:rowIndex,colIndex:colIndex,colSpan:colSpan}}));case 16:case"end":return _context10.stop()}}),_callee10)})));return function(_x7){return _ref18.apply(this,arguments)}}()),_context11.abrupt("return",Promise.all(groupObj));case 3:case"end":return _context11.stop()}}),_callee11)})))()},getHash:function(dataTypeEnum){var currentDataType=dataTypeEnum;return["ENUM","SYSTEM_ENUM","MULTI_ENUM"].includes(dataTypeEnum)?currentDataType="ENUM_HASH":["NUMBER","DECIMAL"].includes(dataTypeEnum)&&(currentDataType="DIGIT_HASH"),dataConstructHash[currentDataType]||dataConstructHash["DEFAULT"]},downloadAttachment:function(field){var _this6=this,name=field.name,url=field.url,contentType=field.contentType,contentTypeArr=contentType.split("/");contentTypeArr.includes("image")?this.openAttachment(field):(0,validation/* isEmpty */.xb)(name)||(url=field.url,(0,validation/* isEmpty */.xb)(url)||(this.exportDownloadUrl&&(this.exportDownloadUrl=null),this.$nextTick((function(){_this6.exportDownloadUrl=url}))))},toggleVisibility:function(){var _this7=this;this.isAllVisible=!this.isAllVisible,this.isAllVisible?this.$nextTick((function(){var height=_this7.$refs["content-container"].scrollHeight+40,width=_this7.$refs["content-container"].scrollWidth;_this7.resizeWidget({height:height,width:width})})):this.$nextTick((function(){return _this7.resizeWidget({h:_this7.defaultWidgetHeight})}))},autoResize:function(){var _this8=this;this.$nextTick((function(){var container=_this8.$refs["content-container"];if(container){var height=_this8.$refs["content-container"].scrollHeight,width=_this8.$refs["content-container"].scrollWidth,dimensions=_this8.calculateDimensions({height:height,width:width});if(!(0,validation/* isEmpty */.xb)(dimensions)){var _ref22=dimensions||{},h=_ref22.h,params={};if(h<=_this8.defaultWidgetHeight)_this8.needsShowMore=!1,params={height:height,width:width};else{var _this8$defaultWidgetH=_this8.defaultWidgetHeight,defaultWidgetHeight=void 0===_this8$defaultWidgetH?8:_this8$defaultWidgetH;_this8.needsShowMore=h>defaultWidgetHeight,_this8.defaultWidgetHeight=defaultWidgetHeight,params=_this8.needsShowMore?{h:defaultWidgetHeight}:{h:h}}_this8.resizeWidget(params)}}}))},redirectToSummary:function(field){var _this9=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee12(){var _routerPath,freezeWidget,_ref23,moduleName,id,lookupModule,_ref24,custom,viewname,routerPath,_ref25,name,getRouterObj;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context12){while(1)switch(_context12.prev=_context12.next){case 0:return freezeWidget=_this9.$loading({target:".sfw-container"}),_ref23=field||{},moduleName=_ref23.moduleName,id=_ref23.id,lookupModule=_ref23.lookupModule,_ref24=lookupModule||{},custom=_ref24.custom,_context12.next=5,_this9.fetchView(moduleName);case 5:viewname=_context12.sent,routerPath=null,(0,router/* isWebTabsEnabled */.tj)()?(_ref25=(0,router/* findRouteForModule */.Jp)(moduleName,router/* pageTypes */.As.OVERVIEW)||{},name=_ref25.name,name&&(routerPath=_this9.$router.resolve({name:name,params:{viewname:viewname,id:id}}))):custom?routerPath=_this9.$router.resolve(lookupModulesRouterMap["custom"](id,viewname,moduleName)):(getRouterObj=lookupModulesRouterMap[moduleName],getRouterObj&&(routerPath=_this9.$router.resolve(getRouterObj(id,viewname)))),routerPath&&window.open(null===(_routerPath=routerPath)||void 0===_routerPath?void 0:_routerPath.href,"_blank"),freezeWidget.close();case 10:case"end":return _context12.stop()}}),_callee12)})))()},fetchSites:function(){var _this10=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee13(){var details,siteId,_yield$getFieldOption2,error,options;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context13){while(1)switch(_context13.prev=_context13.next){case 0:if(details=_this10.details,siteId=details.siteId||null,!(0,validation/* isEmpty */.xb)(siteId)){_context13.next=4;break}return _context13.abrupt("return");case 4:if(!(0,validation/* isEmpty */.xb)(_this10.siteList)||(0,validation/* isEmpty */.xb)(siteId)){_context13.next=13;break}return _context13.next=7,(0,picklist/* getFieldOptions */._K)({field:{lookupModuleName:"site",skipDeserialize:!0},defaultIds:[siteId],perPage:1});case 7:_yield$getFieldOption2=_context13.sent,error=_yield$getFieldOption2.error,options=_yield$getFieldOption2.options,error||(0,validation/* isEmpty */.xb)(options[siteId])||(_this10.sites=options),_context13.next=14;break;case 13:_this10.sites=_this10.siteList;case 14:case"end":return _context13.stop()}}),_callee13)})))()},resizeWidget:function(params){var $attrs=this.$attrs;return $attrs.resizeWidget(params)},calculateDimensions:function(params){var $attrs=this.$attrs;return null===$attrs||void 0===$attrs?void 0:$attrs.calculateDimensions(params)}}},field_details_SummaryFieldsWidgetvue_type_script_lang_js=SummaryFieldsWidgetvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(field_details_SummaryFieldsWidgetvue_type_script_lang_js,render,staticRenderFns,!1,null,"33a6a147",null)
/* harmony default export */,SummaryFieldsWidget=component.exports},
/***/703601:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return VendorQuotesRfqDetails}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/purchase/vendorQuotes/components/VendorQuotesRfqDetails.vue?vue&type=template&id=72989996
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("SummaryFieldsWidget",_vm._b({ref:"summaryFieldsWidget",staticClass:"pB20",attrs:{details:_vm.details,moduleName:_vm.moduleName,disableAutoResize:!1,detailsLayoutProp:_vm.detailsLayoutProp}},"SummaryFieldsWidget",_vm.$attrs,!1))},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),SummaryFieldsWidget=__webpack_require__(150159),validation=__webpack_require__(990260),router=__webpack_require__(329435),api=__webpack_require__(32284),VendorQuotesRfqDetailsvue_type_script_lang_js={props:["details"],data:function(){return{detailsLayoutProp:null}},components:{SummaryFieldsWidget:SummaryFieldsWidget["default"]},created:function(){this.loadSummaryDetailLayout()},computed:{moduleName:function(){return"vendorQuotes"}},methods:{loadSummaryDetailLayout:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var moduleName,summaryWidgetName,appId,params,_yield$API$get,data,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(moduleName=_this.moduleName,summaryWidgetName="vendoQuotesRfqDetailsWidget",!(0,validation/* isEmpty */.xb)(summaryWidgetName)){_context.next=4;break}return _context.abrupt("return");case 4:return _this.summaryDetailsLoading=!0,appId=((0,router/* getApp */.wx)()||{}).id,params={moduleName:moduleName,appId:appId,widgetName:summaryWidgetName},_context.next=9,api/* API */.bl.get("v2/customPage/summaryFieldWidget",params);case 9:_yield$API$get=_context.sent,data=_yield$API$get.data,error=_yield$API$get.error,error||(_this.detailsLayoutProp=data);case 13:case"end":return _context.stop()}}),_callee)})))()}}},components_VendorQuotesRfqDetailsvue_type_script_lang_js=VendorQuotesRfqDetailsvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_VendorQuotesRfqDetailsvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,VendorQuotesRfqDetails=component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/46886.js.map