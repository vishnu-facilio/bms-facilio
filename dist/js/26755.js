"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[26755],{
/***/526755:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return Layout}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/indoorFloorPlan/Layout.vue?vue&type=template&id=0ed91899
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"h100 height100 overflow-hidden"},[_c("div",{staticClass:"setting-header2 position-relative fp-header indoor-fp-topbar p10"},[_c("div",{staticClass:"setting-title-block fp-chooser-new",on:{click:_vm.showBuildingFilter}},[_c("div",{staticClass:"fc-black3-16 fw4 f15 line-height20"},[_c("i",{staticClass:"el-icon-office-building f18 mR10"}),_vm.building?_c("span",[_vm._v(_vm._s(""+_vm.building.name))]):_c("span",[_vm._v(_vm._s("Building"))]),_vm._m(0),_vm.floor?_c("span",[_vm._v(_vm._s(""+_vm.floor.name))]):_c("span",[_vm._v(_vm._s("Floor"))])])]),_c("portal-target",{staticClass:"indoor-fp-layout-portal",attrs:{name:"indoorFloorPlanLayout"}}),_vm.portalLayout?_vm._e():_c("div",{staticClass:"action-btn setting-page-btn flex mT5"},[_vm.showViewOption&&(_vm.showViewAssignmentOption||_vm.showAssignmentDepartmentOption||_vm.showAssignmentOwnOption)&&(_vm.showViewBookingOption||_vm.showBookingDepartmentOption||_vm.showBookingOwnOption)?_c("el-radio-group",{staticClass:"fp-mode-switch",model:{value:_vm.viewerMode,callback:function($$v){_vm.viewerMode=$$v},expression:"viewerMode"}},[_c("el-radio-button",{attrs:{label:"ASSIGNMENT"}},[_c("div",{staticClass:"flex-middle"},[_c("inline-svg",{attrs:{src:"svgs/user-check",iconClass:"icon text-center icon-sm-md"}}),_c("div",{staticClass:"pL5"},[_vm._v(" Assignment ")])],1)]),_c("el-radio-button",{attrs:{label:"BOOKING"}},[_c("div",{staticClass:"flex-middle"},[_c("inline-svg",{attrs:{src:"svgs/calendar2",iconClass:"icon text-center icon-sm-md"}}),_c("div",{staticClass:"pL5"},[_vm._v("Booking")])],1)])],1):_vm._e(),_vm.showViewOption&&(_vm.showEditOption||_vm.showCreateOption)?_c("el-dropdown",{staticClass:"pointer fc-actions-floor",attrs:{trigger:"click"},on:{command:_vm.actions}},[_c("span",{staticClass:"el-dropdown-link"},[_c("i",{staticClass:"el-icon-more rotate-90 pointer"})]),_c("el-dropdown-menu",{staticClass:"dashboard-subheader-dp",attrs:{slot:"dropdown"},slot:"dropdown"},[_vm.showEditOption?_c("el-dropdown-item",{attrs:{command:"edit"}},[_c("div",[_vm._v(" "+_vm._s(_vm.$t("common._common.edit"))+" ")])]):_vm._e(),_vm.showCreateOption?_c("el-dropdown-item",{attrs:{command:"new"}},[_c("div",[_vm._v(" "+_vm._s("Add Floor Plan")+" ")])]):_vm._e()],1)],1):_vm._e()],1)],1),!_vm.loading&&_vm.floorplanIdFromRoute&&"ASSIGNMENT"==_vm.viewerMode?_c("IndoorFloorPlanAssignmentView",{ref:"assignmentView",attrs:{id:_vm.floorplanIdFromRoute,building:_vm.building,floor:_vm.floor},on:{floorPlanLoaded:_vm.getFloorDetails}}):!_vm.loading&&_vm.floorplanIdFromRoute&&"BOOKING"==_vm.viewerMode?_c("IndoorFloorPlanBookingsView",{ref:"bookingView",attrs:{id:_vm.floorplanIdFromRoute,customTime:_vm.customTime},on:{floorPlanLoaded:_vm.getFloorDetails}}):_vm._e(),_vm.fpEditor?_c("div",{staticClass:"formbuilder-fullscreen-popup floor-plan-builder height100"},[_c("FloorPlanEditor",{attrs:{id:_vm.floorplanIdFromRoute,visibile:_vm.fpEditor},on:{close:_vm.closeEditor,"update:visibile":function($event){_vm.fpEditor=$event}}})],1):_vm._e(),_vm.filterDialogOpen?_c("IndoorFloorPlanSwitcher",{attrs:{visibility:_vm.filterDialogOpen,floorplanId:_vm.floorplanIdFromRoute,floorId:_vm.floorId,buildingId:_vm.buildingId},on:{"update:visibility":function($event){_vm.filterDialogOpen=$event}}}):_vm._e(),_vm.newFp?_c("floorplanUploader",{attrs:{visibility:_vm.newFp,moduleName:"indoorfloorplan"},on:{"update:visibility":function($event){_vm.newFp=$event},saved:_vm.floorplanSaved}}):_vm._e()],1)},staticRenderFns=[function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("span",[_c("i",{staticClass:"el-icon-arrow-right fc-grey-text12-light f18 pR5 pL5 vertical-bottom bold"})])}],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),objectSpread2=__webpack_require__(595082),vuex_esm=(__webpack_require__(260228),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(670560),__webpack_require__(564043),__webpack_require__(857267),__webpack_require__(648324),__webpack_require__(420629)),api=__webpack_require__(32284),IndoorFloorPlanAssignmentViewvue_type_template_id_b3444d2a_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"indoor-floorplan-editor relative",attrs:{id:"viewer"},on:{mousemove:_vm.mousemove,mouseup:_vm.mouseup}},[_c("div",{staticClass:"dragElement",staticStyle:{display:"none"},attrs:{id:"dragItem"},on:{mouseup:_vm.dropElement}}),_c("div",{staticClass:"indoor-fp-mapbox-section relative"},[_vm.floorplanloading?_c("FloorPlanLoading"):_vm._e(),_vm.showAssignmentsidebar?[_vm.isNewSetting?_c("portal",{attrs:{to:"ASSIGNMENT_SIDEBAR"}},[_c("IndoorFloorplanSearch3",{attrs:{deskList:_vm.deskList,spaceList:_vm.spaceList,loading:_vm.employeLoading,departments:_vm.departments,viewerMode:_vm.viewerMode,lockers:_vm.lockerList,parkings:_vm.parkingList,floorId:_vm.floorId,floorplanId:_vm.floorplanId},on:{dragElement:_vm.mouseDownElement,focus:_vm.focusMarker}})],1):_c("IndoorFloorplanSearch",{attrs:{deskList:_vm.deskList,spaceList:_vm.spaceList,loading:_vm.employeLoading,departments:_vm.departments,viewerMode:_vm.viewerMode,lockers:_vm.lockerList,parkings:_vm.parkingList,floorId:_vm.floorId,floorplanId:_vm.floorplanId},on:{dragElement:_vm.mouseDownElement,focus:_vm.focusMarker}})]:_vm._e(),_c("base-map",{staticStyle:{width:"100%"},attrs:{maxZoom:_vm.maxZoom,zoom:_vm.zoom,minZoom:_vm.minZoom},on:{mapLoaded:_vm.mapLoaded}}),_vm.propertiesFeatureVisibile&&_vm.showAssignOption?_c("ViewerPropertyDialogWrapper",{attrs:{objectId:Number(_vm.selectedFeature.objectId),visible:_vm.propertiesFeatureVisibile,isPortal:_vm.isPortal,siteId:_vm.siteId},on:{"update:visible":function($event){_vm.propertiesFeatureVisibile=$event},refresh:_vm.loadViewerData,close:_vm.closePropertyDialog}}):_vm._e(),_vm.spaceMapDialog?_c("AssignmentViewSpaceDialog",{attrs:{visible:_vm.spaceMapDialog,isPortal:_vm.isPortal,siteId:_vm.siteId,objectId:Number(_vm.selectedFeature.objectId)},on:{"update:visible":function($event){_vm.spaceMapDialog=$event},refresh:_vm.loadViewerData,close:_vm.closeSpaceDialog}}):_vm._e(),_vm.lockerDialog?_c("LockerViewerPropertydialog",{attrs:{visible:_vm.lockerDialog,isPortal:_vm.isPortal,siteId:_vm.siteId,objectId:Number(_vm.selectedFeature.objectId)},on:{"update:visible":function($event){_vm.lockerDialog=$event},close:_vm.closeSpaceDialog,refresh:_vm.loadViewerData,updateLocker:_vm.updateLockerProperty}}):_vm._e(),_vm.parkingdialog?_c("ParkingViewerPropertydialog",{attrs:{visible:_vm.parkingdialog,selectedZone:_vm.selectedZone,isPortal:_vm.isPortal,siteId:_vm.siteId,objectId:Number(_vm.selectedFeature.objectId)},on:{"update:visible":function($event){_vm.parkingdialog=$event},close:_vm.closeSpaceDialog,refresh:_vm.loadViewerData}}):_vm._e(),_vm.floorplantypeSwicthLoading?_vm._e():_c("FloorplanTypeSwitcher",{attrs:{floorplanTypes:_vm.floorplanTypes,indoorFloorplanFields:_vm.indoorFloorplanFields,viewerMode:_vm.viewerMode}})],2),_c("AssignmentViewLeagends",{attrs:{deskList:_vm.deskList,spaceList:_vm.spaceList,departments:_vm.departments,lockers:_vm.lockerList,parkingList:_vm.parkingList,settings:_vm.settings}}),_c("IndoorFloorPlanMarkerTooltip",{ref:"markerTooltip",attrs:{tooltipData:_vm.tooltipData}}),_vm.floorplanloading||_vm.isNewSetting?_vm._e():_c("FloorplanSettings",{attrs:{settingsJson:_vm.settings,viewerMode:_vm.viewerMode,isPortal:_vm.isPortal,parkingList:_vm.parkingList},on:{handleSettings:_vm.handleSettings,applySettings:_vm.applySettings}}),_c("portal",{attrs:{to:"floorplan-new-search-container"}},[_vm.showViewOption?_c("IndoorFloorplanSearch2",{attrs:{deskList:_vm.deskList,spaceList:_vm.spaceList,loading:_vm.employeLoading,departments:_vm.departments,viewerMode:_vm.viewerMode,lockers:_vm.lockerList,parkings:_vm.parkingList,floorId:_vm.floorId,floorplanId:_vm.floorplanId},on:{dragElement:_vm.mouseDownElement,focus:_vm.focusMarker}}):_vm._e()],1),!_vm.floorplanloading&&_vm.isNewSetting?_c("NewFloorplanSettings",{attrs:{settingsJson:_vm.settings,viewerMode:_vm.viewerMode,isPortal:_vm.isPortal,parkingList:_vm.parkingList},on:{handleSettings:_vm.handleSettings,applySettings:_vm.applySettings}}):_vm._e()],1)},IndoorFloorPlanAssignmentViewvue_type_template_id_b3444d2a_staticRenderFns=[],ViewerActions=(__webpack_require__(879288),__webpack_require__(450886),__webpack_require__(339772),__webpack_require__(162506),__webpack_require__(434284),__webpack_require__(381904)),IndoorFloorplanSearch=__webpack_require__(103649),IndoorFloorplanSearch3vue_type_template_id_a0326e9a_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"fp-search-fixed-container",class:{"hide-section":_vm.hidesidebar}},[_c("div",{staticClass:"fc-floor-search-block",staticStyle:{height:"inherit"},on:{mouseleave:function($event){return _vm.handleMouseLeave()},mouseup:function($event){return _vm.handleMouseUP()}}},[_c("div",{staticClass:"fp-search-area",class:{"fc-search-box-shadow":_vm.scrollPosition>2}},[_c("div",{staticClass:"fc-search-bottom-border inline width100 inline-flex self-center"},[_c("el-input",{staticClass:"width100 fc-input-full-border2 fc-input-full-border2-prefix",attrs:{size:"medium",placeholder:"Search",clearable:""},on:{input:function($event){return _vm.searchContent()},focus:function($event){_vm.focused=!0},blur:function($event){return _vm.blurSearchBox()}},model:{value:_vm.search,callback:function($$v){_vm.search=$$v},expression:"search"}},[_c("i",{staticClass:"el-input__icon pointer fc-grey8 f14 fwBold el-icon-search mR5",attrs:{slot:"prefix"},slot:"prefix"})])],1),_vm.focused||Object.keys(_vm.serachResult).length?[_c("div",{},[_c("div",{staticClass:"f12 p10 search-subtext"},[_vm._v(" "+_vm._s(_vm.getModuleDisplayName)+" results ")]),_c("div",{staticClass:"fp-filter-section "},["employee"===_vm.selectedModule?_c("div",{staticClass:"flex"},[_c("div",{staticClass:"p10 pL0 pT0"},[_c("el-select",{staticClass:"fc-input-full-border-select2 round-select",attrs:{prop:"agents",filterable:"","default-first-option":"",placeholder:"Employee",size:"mini"},on:{change:_vm.searchContent},model:{value:_vm.selectedFilter[_vm.selectedModule]["assignment"],callback:function($$v){_vm.$set(_vm.selectedFilter[_vm.selectedModule],"assignment",$$v)},expression:"selectedFilter[selectedModule]['assignment']"}},_vm._l(_vm.filtersOptions[_vm.selectedModule]["assignment"],(function(filter,index){return _c("el-option",{key:index,attrs:{label:filter.name,value:filter.value,"no-data-text":"No filter",clearable:""}})})),1)],1),_c("div",{staticClass:"p10 pL0 pT0"},[_c("el-select",{staticClass:"fc-input-full-border-select2 round-select",attrs:{prop:"agents",filterable:"",clearable:"","default-first-option":"",placeholder:"Department",size:"mini"},on:{change:_vm.searchContent},model:{value:_vm.selectedFilter[_vm.selectedModule]["department"],callback:function($$v){_vm.$set(_vm.selectedFilter[_vm.selectedModule],"department",$$v)},expression:"selectedFilter[selectedModule]['department']"}},_vm._l(_vm.departments,(function(department,index){return _c("el-option",{key:index,attrs:{label:department.name,value:department.id,"no-data-text":"No Data"}})})),1)],1)]):"desks"===_vm.selectedModule?_c("div",{staticClass:"flex"},[_c("div",{staticClass:"p10 pL0 pT0"},[_c("el-select",{staticClass:"fc-input-full-border-select2 round-select",attrs:{filterable:"","default-first-option":"",placeholder:"Desk type",size:"mini"},on:{change:_vm.searchContent},model:{value:_vm.selectedFilter[_vm.selectedModule]["desktype"],callback:function($$v){_vm.$set(_vm.selectedFilter[_vm.selectedModule],"desktype",$$v)},expression:"selectedFilter[selectedModule]['desktype']"}},_vm._l(_vm.filtersOptions[_vm.selectedModule]["desktypes"],(function(filter,index){return _c("el-option",{key:index,attrs:{label:filter.name,value:filter.value,"no-data-text":"No filter",clearable:""}})})),1)],1)]):"space"===_vm.selectedModule?_c("div",{staticClass:"flex"},[_c("div",{staticClass:"p10 pL0 pT0"},[_c("el-select",{staticClass:"fc-input-full-border-select2 round-select fc-floorplan-room",attrs:{filterable:"","default-first-option":"",placeholder:"Capacity",size:"mini"},on:{change:_vm.searchContent},model:{value:_vm.selectedFilter[_vm.selectedModule]["capcity"],callback:function($$v){_vm.$set(_vm.selectedFilter[_vm.selectedModule],"capcity",$$v)},expression:"selectedFilter[selectedModule]['capcity']"}},[_c("i",{staticClass:"el-icon-user-solid f12",staticStyle:{color:"#a9aacb","padding-top":"9px"},attrs:{slot:"prefix"},slot:"prefix"}),_vm._l(_vm.filtersOptions[_vm.selectedModule]["capcity"],(function(filter,index){return _c("el-option",{key:index,attrs:{label:filter.name,value:filter.value,"no-data-text":"No filter",clearable:""}})}))],2)],1)]):"lockers"===_vm.selectedModule||"parkingstall"===_vm.selectedModule?_c("div",{staticClass:"flex"},[_c("div",{staticClass:"p10 pL0 pT0"},[_c("el-select",{staticClass:"fc-input-full-border-select2 round-select",attrs:{filterable:"","default-first-option":"",placeholder:"Status",size:"mini"},on:{change:_vm.searchContent},model:{value:_vm.selectedFilter[_vm.selectedModule]["status"],callback:function($$v){_vm.$set(_vm.selectedFilter[_vm.selectedModule],"status",$$v)},expression:"selectedFilter[selectedModule]['status']"}},_vm._l(_vm.filtersOptions[_vm.selectedModule]["status"],(function(filter,index){return _c("el-option",{key:index,attrs:{label:filter.name,value:filter.value,"no-data-text":"No filter",clearable:""}})})),1)],1)]):_vm._e()])])]:_vm._e()],2),_vm.isLoading&&_vm.firstTimeLoad?[_c("div",{staticClass:"fc-search-result-con list-container mT15 fp-result-list",attrs:{id:"fp-result-view"}},[_c("spinner",{attrs:{show:_vm.isLoading,size:"80"}})],1)]:Object.keys(_vm.serachResult).length&&_vm.firstTimeLoad?[_c("div",{staticClass:"fc-search-result-con list-container mT15 fp-result-list",class:{"all-view":"all"===_vm.selectedModule},attrs:{id:"fp-result-view"},on:{"&scroll":function($event){return _vm.onScroll.apply(null,arguments)}}},[_vm.serachResult["employee"]?_c("div",{staticClass:"fc-pink f12 text-uppercase pT15 bold"},[_vm._v(" Employee ")]):_vm._e(),"ASSIGNMENT"===_vm.viewerMode?_vm._l(_vm.serachResult["employee"],(function(employee,index){return _c("div",{key:index},[_c("el-row",{staticClass:"field-row flex flex-row list-borader-bottom align-center"},[_c("el-col",{staticClass:"self-center",attrs:{span:2}},[_c("div",{staticClass:"task-handle mR5 pointer",on:{click:function($event){return _vm.actionEmployee(employee)}}},[_c("avatar",{attrs:{size:"md",user:employee}})],1)]),_c("el-col",{staticClass:"pL15",attrs:{span:20}},[_c("div",{staticClass:"fc-black-14 text-left fc-rightside-ico pinter",on:{click:function($event){return _vm.actionEmployee(employee)}}},[_c("div",[_vm._v(" "+_vm._s(employee.name||"")+" ")]),_c("div",{staticClass:"flex flex-row pT5"},[employee&&employee.space?_c("div",{staticClass:"flex flex-row pR10"},[_c("div",[_c("inline-svg",{attrs:{src:"svgs/office_desk",iconClass:"deskFill icon-path-fill vertical-bottom"}})],1),_c("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{arrow:!0,arrowType:"round",animation:"fade"},expression:"{\n                          arrow: true,\n                          arrowType: 'round',\n                          animation: 'fade',\n                        }"}],staticClass:"fc-black-12 fw4 text-left break-word line-height18 truncate-text pL3",staticStyle:{"max-width":"100px"},attrs:{content:employee.space.name}},[_vm._v(" "+_vm._s(employee.space.name)+" ")])]):_vm._e(),employee.data&&employee.data.department?_c("div",{staticClass:"flex-middle"},[_c("div",[_c("inline-svg",{attrs:{src:"svgs/department2",iconClass:"icon icon-sm icon-path-fill mR5"}})],1),_c("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{arrow:!0,arrowType:"round",animation:"fade"},expression:"{\n                          arrow: true,\n                          arrowType: 'round',\n                          animation: 'fade',\n                        }"}],staticClass:"fc-black-12 fw4 text-left break-word line-height18 truncate-text",staticStyle:{"max-width":"150px"},attrs:{content:employee.data.department.name}},[_vm._v(" "+_vm._s(employee.data&&employee.data.department?employee.data.department.name:"")+" ")])]):_vm._e()])])]),_vm.showAssignOption?_c("el-col",{staticClass:"cursor-drag",attrs:{span:2}},[_c("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Drag and drop employee",placement:"top-start"}},[_c("div",{staticClass:"more-icon-contianer",on:{mousedown:function($event){return _vm.handleMouseDown($event,employee)},mouseup:function($event){return _vm.handleEmpMouseUp(employee)},mousemove:function($event){return _vm.handleMouseMove($event,employee)}}},[_c("inline-svg",{attrs:{src:"svgs/header-more"}}),_c("inline-svg",{staticStyle:{bottom:"12px"},attrs:{src:"svgs/header-more"}})],1)])],1):_vm._e()],1)],1)})):_vm._l(_vm.serachResult["employee"],(function(employee,index){return _c("div",{key:index,on:{click:function($event){return _vm.actionEmployee(employee)}}},[_c("el-row",{staticClass:"field-row flex flex-row list-borader-bottom align-center"},[_c("el-col",{staticClass:"self-center",attrs:{span:2}},[_c("div",{staticClass:"task-handle mR5 pointer"},[_c("avatar",{attrs:{size:"md",user:employee}})],1)]),_c("el-col",{staticClass:"pL15",attrs:{span:22}},[_c("div",{staticClass:"fc-black-14 text-left fc-rightside-ico pointer"},[_c("div",[_vm._v(" "+_vm._s(employee.name||"")+" ")]),_c("div",{staticClass:"flex flex-row pT5"},[employee&&employee.space?_c("div",{staticClass:"flex flex-row pR10"},[_c("div",[_c("inline-svg",{attrs:{src:"svgs/office_desk",iconClass:"deskFill icon-path-fill vertical-bottom"}})],1),_c("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{arrow:!0,arrowType:"round",animation:"fade"},expression:"{\n                          arrow: true,\n                          arrowType: 'round',\n                          animation: 'fade',\n                        }"}],staticClass:"fc-black-12 fw4 text-left break-word line-height18 truncate-text pL3",staticStyle:{"max-width":"100px"},attrs:{content:employee.space.name}},[_vm._v(" "+_vm._s(employee.space.name)+" ")])]):_vm._e(),employee.data&&employee.data.department?_c("div",{staticClass:"flex-middle"},[_c("div",[_c("inline-svg",{attrs:{src:"svgs/department2",iconClass:"icon icon-sm icon-path-fill mR5"}})],1),_c("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{arrow:!0,arrowType:"round",animation:"fade"},expression:"{\n                          arrow: true,\n                          arrowType: 'round',\n                          animation: 'fade',\n                        }"}],staticClass:"fc-black-12 fw4 text-left break-word line-height18 truncate-text",staticStyle:{"max-width":"150px"},attrs:{content:employee.data.department.name}},[_vm._v(" "+_vm._s(employee.data&&employee.data.department?employee.data.department.name:"")+" ")])]):_vm._e()])])])],1)],1)})),_vm.serachResult["desks"]?_c("div",{staticClass:"fc-pink f12 text-uppercase pT15 bold"},[_vm._v(" Desks ")]):_vm._e(),_vm._l(_vm.serachResult["desks"],(function(desk,index){return _c("div",{key:"desk"+index,on:{click:function($event){return _vm.emitData("desks",desk)}}},[_c("el-row",{staticClass:"field-row flex flex-row list-borader-bottom align-center pT15 pB15"},[_c("el-col",{staticClass:"self-center",attrs:{span:2}},[_c("div",{staticClass:"task-handle mR5 pointer"},[_c("div",{staticClass:"fp-search-icons"},[_c("inline-svg",{attrs:{src:"svgs/office_desk",iconClass:"icon text-center fp-icon-inside icon-xxl"}})],1)])]),_c("el-col",{staticClass:"pL10",attrs:{span:22}},[_c("div",{staticClass:"bold fc-black-14 text-left fc-rightside-ico"},[_c("div",[_vm._v(" "+_vm._s(desk.name||"")+" ")]),_c("div",{staticClass:"flex-middle justify-content-space"},[_c("div",{staticClass:"flex-middle"},[_c("div",{staticClass:"fc-black-12 fw4 pT5",staticStyle:{color:"#a3a6b1"}},[_vm._v(" "+_vm._s(_vm.deskType[desk.deskType])+" ")])])])])])],1)],1)})),_vm.serachResult["space"]?_c("div",{staticClass:"fc-pink f12 text-uppercase pT15 bold"},[_vm._v(" Rooms ")]):_vm._e(),_vm._l(_vm.serachResult["space"],(function(data,index){return _c("div",{key:"space"+index,on:{click:function($event){return _vm.emitData("space",data)}}},[_c("el-row",{staticClass:"field-row flex flex-row list-borader-bottom align-center pT15 pB15"},[_c("el-col",{staticClass:"self-center",attrs:{span:2}},[_c("div",{staticClass:"task-handle mR5 pointer"},[_c("div",{staticClass:"fp-search-icons"},[_c("inline-svg",{attrs:{src:"svgs/room1",iconClass:"icon text-center icon-md  fp-icon-inside"}})],1)])]),_c("el-col",{staticClass:"pL10",attrs:{span:22}},[_c("div",{staticClass:"bold fc-black-14 text-left fc-rightside-ico"},[_c("div",{staticClass:"flex-middle"},[_c("div",[_vm._v(" "+_vm._s(data.name||"")+" ")]),data.isReservable?_c("div",{staticClass:"fc-room-tag"},[_c("el-tag",[_vm._v("Reservable")])],1):_vm._e()]),_c("div",{staticClass:"pT5 flex-middle"},[_c("i",{staticClass:"el-icon-user-solid f14",staticStyle:{color:"#a9aacb"}}),_c("div",{staticClass:"pL5 fc-black-12 fw4"},[_vm._v(" "+_vm._s(data.maxOccupancy>0?data.maxOccupancy:0)+" ")])])])])],1)],1)})),_vm.serachResult["lockers"]?_c("div",{staticClass:"fc-pink f12 text-uppercase pT15 bold"},[_vm._v(" Lockers ")]):_vm._e(),_vm._l(_vm.serachResult["lockers"],(function(data,index){return _c("div",{key:"lockers"+index,on:{click:function($event){return _vm.emitData("space",data)}}},[_c("el-row",{staticClass:"field-row flex flex-row list-borader-bottom align-center pT15 pB15"},[_c("el-col",{staticClass:"self-center",attrs:{span:2}},[_c("div",{staticClass:"task-handle mR5 pointer"},[_c("div",{staticClass:"fp-search-icons"},[_c("inline-svg",{attrs:{src:"svgs/locker",iconClass:"icon text-center icon-md  fp-icon-inside"}})],1)])]),_c("el-col",{staticClass:"pL10",attrs:{span:22}},[_c("div",{staticClass:"bold fc-black-14 text-left fc-rightside-ico"},[_c("div",[_vm._v(" "+_vm._s(data.name||"")+" ")]),_c("div",{staticClass:"flex-middle justify-content-space"},[_c("div",{staticClass:"flex-middle"},[data.data&&data.data.singleline?_c("div",{staticClass:"fc-black-12 fw4"},[_vm._v(" "+_vm._s(data.data.singleline)+" ")]):_vm._e()])])])])],1)],1)})),_vm.serachResult["parkingstall"]?_c("div",{staticClass:"fc-pink f12 text-uppercase pT15 bold"},[_vm._v(" Parkings ")]):_vm._e(),_vm._l(_vm.serachResult["parkingstall"],(function(data,index){return _c("div",{key:"parkingstall"+index,on:{click:function($event){return _vm.emitData("space",data)}}},[_c("el-row",{staticClass:"field-row flex flex-row list-borader-bottom align-center pT15 pB15"},[_c("el-col",{staticClass:"self-center",attrs:{span:2}},[_c("div",{staticClass:"task-handle mR5 pointer"},[_c("div",{staticClass:"fp-search-icons"},[_c("inline-svg",{attrs:{src:"svgs/parking",iconClass:"icon text-center icon-md  fp-icon-inside"}})],1)])]),_c("el-col",{staticClass:"pL10",attrs:{span:22}},[_c("div",{staticClass:"bold fc-black-14 text-left fc-rightside-ico"},[_c("div",[_vm._v(" "+_vm._s(data.name||"")+" ")]),_c("div",{staticClass:"flex-middle justify-content-space"},[_c("div",{staticClass:"flex-middle"},[data.parkingType?_c("div",{staticClass:"fc-black-12 fw4"},[_vm._v(" "+_vm._s(_vm.parkingtypeMap[data.parkingType])+" ")]):_vm._e()])])])])],1)],1)}))],2)]:_vm.firstTimeLoad?[_c("div",{staticClass:"fc-search-result-con list-container mT15 fp-result-list nodata text-center",attrs:{id:"fp-result-view"}},[_c("inline-svg",{attrs:{src:"svgs/floor-plan-empty",iconClass:"icon text-center icon-xxxlg"}}),_c("div",{staticClass:"fwBold"},[_vm._v(" No search results found ")])],1)]:_vm._e()],2),_c("el-dialog",{staticClass:"fc-dialog-center-container",attrs:{title:"SWITCH FLOOR",visible:_vm.openFloorPlanDialog,width:"30%","before-close":_vm.closeDialog,"append-to-body":!0},on:{"update:visible":function($event){_vm.openFloorPlanDialog=$event}}},[_c("div",{staticClass:"height150"},[_vm.openfloorplanData?_c("div",{staticClass:"label-txt-black"},[_vm.openfloorplanData.loading?_c("span",[_c("spinner",{attrs:{show:!0,size:"80"}})],1):_c("span",[_vm._v(" "+_vm._s(_vm.openfloorplanData.message)+" ")])]):_vm._e()]),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){_vm.openFloorPlanDialog=!1}}},[_vm._v(_vm._s("CANCEL")+" ")]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:function($event){return _vm.openFloorPlan()}}},[_vm._v(_vm._s("SWITCH")+" ")])],1)])],1)},IndoorFloorplanSearch3vue_type_template_id_a0326e9a_staticRenderFns=[],IndoorFloorplanSearch3vue_type_script_lang_js={extends:IndoorFloorplanSearch/* default */.Z,data:function(){return{showSearchList:!1}}},components_IndoorFloorplanSearch3vue_type_script_lang_js=IndoorFloorplanSearch3vue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_IndoorFloorplanSearch3vue_type_script_lang_js,IndoorFloorplanSearch3vue_type_template_id_a0326e9a_render,IndoorFloorplanSearch3vue_type_template_id_a0326e9a_staticRenderFns,!1,null,null,null)
/* harmony default export */,IndoorFloorplanSearch3=component.exports,IndoorFloorplanSearch2=__webpack_require__(856071),ViewerPropertyDialogWrappervue_type_template_id_3b0e5658_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"properties-section"},[_vm.loading?_c("spinner",{attrs:{show:_vm.loading,size:"80"}}):[_c("div",{staticClass:"new-header-container pL30"},[_c("div",{staticClass:"new-header-text relative"},[_c("div",{staticClass:"fc-setup-modal-title"},[_vm._v("Properties")]),_c("div",{staticClass:"flex-middle"},[_vm.isPortal||"desks"!==_vm.moduleName?_vm.summaryUrl?_c("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{arrow:!0},expression:"{ arrow: true }"}],attrs:{content:"View Summary"},on:{click:function($event){return _vm.openUrl(this.summaryUrl)}}},[_c("inline-svg",{attrs:{src:"svgs/external-link2",iconClass:"icon icon-sm-md fill-blue mR10 pointer"}})],1):_vm._e():_c("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{arrow:!0},expression:"{ arrow: true }"}],attrs:{content:"View Summary"},on:{click:function($event){return _vm.openRecordSummary(_vm.record,_vm.moduleName)}}},[_c("inline-svg",{attrs:{src:"svgs/external-link2",iconClass:"icon icon-sm-md fill-blue mR10 pointer"}})],1),_c("div",{staticClass:"fc-setup-modal-close f18 pointer",on:{click:_vm.handleClose}},[_c("i",{staticClass:"el-icon-close fwBold"})])])])]),_vm.moduleName&&"desks"===_vm.moduleName&&_vm.record?[_c("div",{staticClass:"new-body-modal infp-left-section height100 pL20 pR20 mT10"},[_c("el-form",{ref:"form",attrs:{model:_vm.record,"label-width":"120px"}},[_c("el-row",{staticClass:"mB10"},[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{staticClass:"mB10 m0",attrs:{prop:"name"}},[_c("p",{staticClass:"fc-input-label-txt pB5"},[_vm._v("Name")]),_c("el-input",{staticClass:"width100 fc-input-full-border2",attrs:{disabled:!0},model:{value:_vm.record.name,callback:function($$v){_vm.$set(_vm.record,"name",$$v)},expression:"record.name"}})],1)],1)],1)],1),_c("el-row",{staticClass:"mB10 mT20"},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"fc-black-14 text-left text-capitalize mB10"},[_vm._v(" "+_vm._s(_vm.deskType)+" ")]),_c("el-button",{staticClass:"fc-input-div-full-border width100 text-left line-height20 fc-btn-desk-type",attrs:{disabled:""}},[_vm._v(" "+_vm._s(_vm.record.deskTypeVal||"")+" ")])],1)],1),1===_vm.record.deskType?_c("el-row",{staticClass:"mB10"},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"fc-black-14 text-left text-capitalize mB10 mT10"},[_vm._v(" "+_vm._s(_vm.department)+" ")]),_c("FLookupFieldWrapper",{staticClass:"fc-department-icon fc-department-input rm-arrow",attrs:{label:_vm.department,field:{lookupModule:{name:"department"},multiple:!1}},on:{recordSelected:function(value){return _vm.setDepartmentValue(value)}},model:{value:_vm.record.department.id,callback:function($$v){_vm.$set(_vm.record.department,"id",$$v)},expression:"record.department.id"}})],1)],1):_vm._e(),1===_vm.record.deskType?_c("el-row",{staticClass:"mB10 pT10"},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"fc-black-14 text-left text-capitalize mB10"},[_vm._v(" "+_vm._s(_vm.employee)+" ")]),_vm.rerenderEmplyWizard?_c("FLookupFieldWrapper",{staticClass:"rm-arrow",attrs:{label:_vm.employee,field:{lookupModule:{name:"employee"},multiple:!1},filterConstruction:_vm.constructEmployeeFilter},on:{recordSelected:function(value){return _vm.setValue(value)}},model:{value:_vm.record.employee.id,callback:function($$v){_vm.$set(_vm.record.employee,"id",$$v)},expression:"record.employee.id"}}):_vm._e()],1)],1):_vm._e(),_vm.moveText?_c("div",{staticClass:"fc-black-14 text-left mB10 f10"},[_vm._v(" "+_vm._s(_vm.moveText)+" ")]):_vm._e(),_c("div",{staticClass:"text-center pT20"}),_c("el-row",{staticClass:"text-center pT20"},[_vm.showbtn?_c("el-col",{attrs:{span:20}},[_c("el-button",{staticClass:"fc-pink-btn-small",attrs:{size:"small"},on:{click:_vm.move}},[_vm._v(_vm._s(_vm.doneChanges))])],1):_vm.departmentChange?_c("el-col",{attrs:{span:20}},[_c("el-button",{staticClass:"fc-pink-btn-small",attrs:{size:"small"},on:{click:_vm.update}},[_vm._v(_vm._s(_vm.doneChanges))])],1):_c("el-col",{attrs:{span:20}},[_c("el-button",{staticClass:"fc-pink-btn-small inactive",attrs:{size:"small",disabled:!0}},[_vm._v(_vm._s(_vm.doneChanges))])],1),_vm.showbtn?_c("el-col",{attrs:{span:4}},[_c("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Reset",placement:"bottom"}},[_c("el-button",{staticClass:"fp-reset-icon",attrs:{size:"small",icon:"el-icon-refresh-left"},on:{click:_vm.reset}})],1)],1):_c("el-col",{attrs:{span:4}},[_c("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Reset",placement:"bottom"}},[_c("el-button",{staticClass:"fp-reset-icon",attrs:{size:"small",disabled:!0,icon:"el-icon-refresh-left"}})],1)],1)],1)],1)]:_vm.object?[_c("div",{staticClass:"new-body-modal infp-left-section height100 pL20 pR20 mT10"},[_c("el-form",{ref:"form",attrs:{model:_vm.object,"label-width":"120px"}},[_c("el-row",{staticClass:"mB10"},[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{staticClass:"mB10 m0",attrs:{prop:"name"}},[_c("p",{staticClass:"fc-input-label-txt pB5"},[_vm._v("Name")]),_c("el-input",{staticClass:"width100 fc-input-full-border2",attrs:{disabled:!0},model:{value:_vm.object.label,callback:function($$v){_vm.$set(_vm.object,"label",$$v)},expression:"object.label"}})],1)],1)],1)],1),_c("div",{staticClass:"text-center pT20"}),_c("el-row",{staticClass:"text-center pT20"},[_c("el-col",{attrs:{span:20}},[_c("el-button",{staticClass:"fc-pink-btn-small inactive",attrs:{size:"small",disabled:!0}},[_vm._v(_vm._s(_vm.doneChanges))])],1),_c("el-col",{attrs:{span:4}},[_c("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Reset",placement:"bottom"}},[_c("el-button",{staticClass:"fp-reset-icon",attrs:{size:"small",disabled:!0,icon:"el-icon-refresh-left"}})],1)],1)],1)],1)]:_vm._e()]],2)},ViewerPropertyDialogWrappervue_type_template_id_3b0e5658_scoped_true_staticRenderFns=[],FLookupFieldWrapper=(__webpack_require__(634338),__webpack_require__(201117)),lodash=__webpack_require__(496486),router=__webpack_require__(329435),ViewerPropertyDialogWrappervue_type_script_lang_js={components:{FLookupFieldWrapper:FLookupFieldWrapper/* default */.Z},props:{objectId:{type:Number,required:!0},isPortal:{type:Boolean,required:!1,default:!1},visible:{type:Boolean,required:!0},siteId:{type:Number,required:!1}},data:function(){return{rerenderEmplyWizard:!0,deskType:"Desk type",department:"Department",employee:"Employee",doneChanges:"Done Changes",departmentChange:!1,showdeskResetIcon:!1,propertiesData:{},record:{},moduleName:null,moveText:"",moveData:{},fromDesk:null,loading:!0,btnLoading:!1,object:null,btnState:!0}},computed:{summaryUrl:function(){if((0,router/* isWebTabsEnabled */.tj)()){var _ref=(0,router/* findRouteForModule */.Jp)(this.moduleName,router/* pageTypes */.As.OVERVIEW)||{},name=_ref.name;if(name)return this.$router.resolve({name:name,params:{viewname:"all",id:this.record.id}}).href}return null},showbtn:function(){return!(this.btnLoading||!this.btnState)&&!(0,lodash.isEqual)(this.record,this.formatRecord(this.propertiesData.record))}},mounted:function(){this.init()},watch:{objectId:{handler:function(newVal,oldVal){newVal!==oldVal&&this.init()}}},methods:{getModelData:function(){},reset:function(){this.moveText="",this.record=this.$helpers.cloneObject(this.formatRecord(this.propertiesData.record)||{})},move:function(){var _this=this;(0,lodash.isEmpty)(this.moveData)?this.updateRecord().then((function(){_this.$emit("refresh"),_this.getPropertiesData(!0)})):this.updateMoveData(this.moveData).then((function(){_this.$emit("refresh"),_this.getPropertiesData(!0)}))},prepareMoveData:function(move){var _move$toDesk,timeOfMove=(new Date).valueOf(),moveParmas={};if(move.fromDesk&&move.toDesk)this.$set(moveParmas,"to",{id:move.toDesk.id}),this.$set(moveParmas,"from",{id:move.fromDesk.id}),this.$set(moveParmas,"timeOfMove",timeOfMove),move.toDesk.employee&&(null!==(_move$toDesk=move.toDesk)&&void 0!==_move$toDesk&&null!==(_move$toDesk=_move$toDesk.department)&&void 0!==_move$toDesk&&_move$toDesk.id&&this.$set(moveParmas,"department",{id:move.toDesk.department.id}),this.$set(moveParmas,"employee",move.toDesk.employee));else if(move.fromDesk&&!move.toDesk){var _move$fromDesk;if(this.$set(moveParmas,"from",{id:move.fromDesk.id}),this.$set(moveParmas,"timeOfMove",timeOfMove),move.fromDesk.employee)this.$set(moveParmas,"employee",{id:move.fromDesk.employee.id}),null!==(_move$fromDesk=move.fromDesk)&&void 0!==_move$fromDesk&&null!==(_move$fromDesk=_move$fromDesk.department)&&void 0!==_move$fromDesk&&_move$fromDesk.id&&this.$set(moveParmas,"department",{id:move.fromDesk.department.id})}else if(move.toDesk&&!move.fromDesk){var _move$toDesk2;if(this.$set(moveParmas,"to",{id:move.toDesk.id}),this.$set(moveParmas,"timeOfMove",timeOfMove),move.toDesk.employee)this.$set(moveParmas,"employee",move.toDesk.employee),null!==(_move$toDesk2=move.toDesk)&&void 0!==_move$toDesk2&&null!==(_move$toDesk2=_move$toDesk2.department)&&void 0!==_move$toDesk2&&_move$toDesk2.id&&this.$set(moveParmas,"department",{id:move.toDesk.department.id})}return this.$set(moveParmas,"scheduledTime",null),this.$set(moveParmas,"moveType",1),this.$set(moveParmas,"siteId",this.siteId),moveParmas},update:function(){var _this2=this;this.updateRecord().then((function(){_this2.$emit("refresh"),_this2.getPropertiesData(!0)}))},constructEmployeeFilter:function(){var _this$record;return null!==(_this$record=this.record)&&void 0!==_this$record&&null!==(_this$record=_this$record.department)&&void 0!==_this$record&&_this$record.id?{department:{operatorId:36,value:["".concat(this.record.department.id)]}}:{}},setValue:function(value){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(_this3.moveText="",!(null!==value&&void 0!==value&&value.value&&value.value>0)){_context.next=7;break}return _context.next=4,_this3.fetchEmployeeFulldetails(value.value);case 4:_this3.moveData=_this3.prepareMoveData(_this3.getMoveData(value)),_context.next=8;break;case 7:_this3.unassign();case 8:case"end":return _context.stop()}}),_callee)})))()},unassign:function(){var _record$employee,record=this.$helpers.cloneObject(this.formatRecord(this.propertiesData.record));null!==record&&void 0!==record&&null!==(_record$employee=record.employee)&&void 0!==_record$employee&&_record$employee.name?this.moveText="".concat(this.record.employee.name," will be unassigned from this desk"):this.moveText="",this.fromDesk=record,this.moveData=this.prepareMoveData(this.getMoveData())},getMoveData:function(toEmployee){var toDesk=toEmployee&&this.record||null,fromDesk=this.fromDesk||null;return null!==toEmployee&&void 0!==toEmployee&&toEmployee.value&&toDesk&&this.$set(toDesk,"employee",{id:toEmployee.value}),{toDesk:toDesk,fromDesk:fromDesk}},setDepartmentValue:function(){var _this4=this,record=this.record;this.moveText="",record.employee={id:null},this.rerenderEmplyWizard=!1,this.$nextTick((function(){_this4.rerenderEmplyWizard=!0}))},handleClose:function(){this.$emit("update:visible",!1),this.$emit("close")},init:function(){this.getPropertiesData()},getPropertiesData:function(loadingfalse){var _this5=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var params;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _this5.moveText="",params={objectId:_this5.objectId},_this5.btnLoading=!0,loadingfalse||(_this5.loading=!0),_context2.next=6,api/* API */.bl.get("/v3/floorplan/propertiesdata",params).then((function(_ref2){var _data$properties,data=_ref2.data;null!==data&&void 0!==data&&data.properties&&(_this5.propertiesData=_this5.$helpers.cloneObject(data.properties),data.properties.moduleName&&(_this5.moduleName=_this5.$helpers.cloneObject(data.properties.moduleName)),null!==(_data$properties=data.properties)&&void 0!==_data$properties&&_data$properties.record&&(_this5.record=_this5.$helpers.cloneObject(_this5.formatRecord(data.properties.record)||{})),_this5.object=_this5.$helpers.cloneObject(data.properties.object||{}));_this5.loading=!1,_this5.btnLoading=!1})).catch((function(error){_this5.loading=!1,_this5.btnLoading=!1,error&&_this5.$message.error("Error While fetching the data")}));case 6:case"end":return _context2.stop()}}),_callee2)})))()},formatRecord:function(record){return"desks"===this.moduleName?(null!==record&&void 0!==record&&record.department||this.$set(record,"department",{id:null}),null!==record&&void 0!==record&&record.employee||this.$set(record,"employee",{id:null})):"lockers"===this.moduleName&&(null!==record&&void 0!==record&&record.employee||this.$set(record,"employee",{id:null})),record},fetchEmployeeFulldetails:function(id){var _this6=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var _yield$API$get,data;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return _this6.btnState=!1,_context3.next=3,api/* API */.bl.get("v2/servicePortalHome?fetchOnlyDesk=true&count=1&recordId=".concat(id));case 3:_yield$API$get=_context3.sent,data=_yield$API$get.data,data&&data.desks&&data.desks.length&&(_this6.loadMoveDetails(data.desks[0]),_this6.setDepartment(data.desks[0])),_this6.btnState=!0;case 7:case"end":return _context3.stop()}}),_callee3)})))()},setDepartment:function(desk){var _desk$department,_this$record2;null===desk||void 0===desk||null===(_desk$department=desk.department)||void 0===_desk$department||!_desk$department.id||null!==(_this$record2=this.record)&&void 0!==_this$record2&&null!==(_this$record2=_this$record2.department)&&void 0!==_this$record2&&_this$record2.id||(this.record.department={id:desk.department.id})},loadMoveDetails:function(desk){if(this.fromDesk=null,desk){this.fromDesk=desk;var floorName=desk.floor&&desk.floor.name?desk.floor.name:null;this.moveText="Employee will be moved from ".concat(desk.name," ").concat(floorName?", "+floorName:""," to this desk")}},updateMoveData:function(move){var _this7=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){var params;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:return _this7.btnState=!1,params={data:move,moduleName:"moves"},_context4.next=4,api/* API */.bl.post("v3/modules/data/create",params);case 4:_this7.btnState=!0;case 5:case"end":return _context4.stop()}}),_callee4)})))()},updateRecord:function(){var _this8=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee5(){var params,_yield$API$post,data,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context5){while(1)switch(_context5.prev=_context5.next){case 0:return _this8.btnState=!1,params={moduleName:_this8.moduleName,id:_this8.record.id,data:_this8.record},_context5.next=4,api/* API */.bl.post("v3/modules/data/update",params);case 4:_yield$API$post=_context5.sent,data=_yield$API$post.data,error=_yield$API$post.error,error?_this8.$message.error("".concat(error.message)):data&&_this8.$message.success("".concat(_this8.record.name," updated")),_this8.btnState=!0;case 9:case"end":return _context5.stop()}}),_callee5)})))()},openUrl:function(url){window.open(url,"_blank")},openRecordSummary:function(_ref3){var id=_ref3.id,viewname="all";
// let { viewname } = this
// default view name should be dynamic
if((0,router/* isWebTabsEnabled */.tj)()){var _ref4=(0,router/* findRouteForModule */.Jp)("desks",router/* pageTypes */.As.OVERVIEW)||{},name=_ref4.name;if(name){var routeData=this.$router.resolve({name:name,params:{viewname:viewname,id:id}});window.open(routeData.href,"_blank")}}else{var _routeData=this.$router.resolve({name:"deskSummary",params:{viewname:viewname,id:id}});window.open(_routeData.href,"_blank")}}}},components_ViewerPropertyDialogWrappervue_type_script_lang_js=ViewerPropertyDialogWrappervue_type_script_lang_js,ViewerPropertyDialogWrapper_component=(0,componentNormalizer/* default */.Z)(components_ViewerPropertyDialogWrappervue_type_script_lang_js,ViewerPropertyDialogWrappervue_type_template_id_3b0e5658_scoped_true_render,ViewerPropertyDialogWrappervue_type_template_id_3b0e5658_scoped_true_staticRenderFns,!1,null,"3b0e5658",null)
/* harmony default export */,ViewerPropertyDialogWrapper=ViewerPropertyDialogWrapper_component.exports,IndoorFloorPlanViewer=__webpack_require__(769240),AssignmentViewSpaceDialogvue_type_template_id_4ed00855_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"properties-section"},[_vm.loading?_c("spinner",{attrs:{show:_vm.loading,size:"80"}}):[_c("div",{staticClass:"new-header-container pL30"},[_c("div",{staticClass:"new-header-text relative"},[_c("div",{staticClass:"fc-setup-modal-title"},[_vm._v("Properties")]),_c("div",{staticClass:"flex-middle"},[_vm.isPortal||"desks"!==_vm.moduleName?_vm._e():_c("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{arrow:!0},expression:"{ arrow: true }"}],attrs:{content:"View Summary"},on:{click:function($event){return _vm.openRecordSummary(_vm.record,_vm.moduleName)}}},[_c("inline-svg",{attrs:{src:"svgs/external-link2",iconClass:"icon icon-sm-md fill-blue mR10 pointer"}})],1),_c("div",{staticClass:"fc-setup-modal-close f18 pointer",on:{click:_vm.handleClose}},[_c("i",{staticClass:"el-icon-close fwBold"})])])])]),_c("div",{staticClass:"new-body-modal infp-left-section height100 pL20 pR20 mT10"},[_c("el-form",{ref:"form",attrs:{model:_vm.record,"label-width":"120px"}},[_c("el-row",{staticClass:"mB10"},[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{staticClass:"mB10 m0",attrs:{prop:"name"}},[_c("p",{staticClass:"fc-input-label-txt pB5"},[_vm._v("Name")]),_c("el-input",{staticClass:"width100 fc-input-full-border2",attrs:{disabled:!0},model:{value:_vm.record.name,callback:function($$v){_vm.$set(_vm.record,"name",$$v)},expression:"record.name"}})],1)],1)],1),_vm.record.employee?_c("el-row",{staticClass:"mB10 pT10"},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"fc-black-14 text-left text-capitalize mB10"},[_vm._v(" "+_vm._s(_vm.employee)+" ")]),_vm.rerenderEmplyWizard?_c("FLookupFieldWrapper",{staticClass:"rm-arrow",attrs:{label:_vm.employee,field:{lookupModule:{name:"employee"},multiple:!1},filterConstruction:_vm.constructEmployeeFilter},on:{recordSelected:function(value){return _vm.setValue(value)}},model:{value:_vm.record.employee.id,callback:function($$v){_vm.$set(_vm.record.employee,"id",$$v)},expression:"record.employee.id"}}):_vm._e()],1)],1):_vm._e()],1),_c("div",{staticClass:"text-center pT20"}),_c("el-row",{staticClass:"text-center pT20"},[_vm.showbtn?_c("el-col",{attrs:{span:20}},[_c("el-button",{staticClass:"fc-pink-btn-small",attrs:{size:"small"},on:{click:_vm.update}},[_vm._v(_vm._s(_vm.doneChanges))])],1):_c("el-col",{attrs:{span:20}},[_c("el-button",{staticClass:"fc-pink-btn-small inactive",attrs:{size:"small",disabled:!0}},[_vm._v(_vm._s(_vm.doneChanges))])],1),_vm.showbtn?_c("el-col",{attrs:{span:4}},[_c("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Reset",placement:"bottom"}},[_c("el-button",{staticClass:"fp-reset-icon",attrs:{size:"small",icon:"el-icon-refresh-left"},on:{click:_vm.reset}})],1)],1):_c("el-col",{attrs:{span:4}},[_c("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Reset",placement:"bottom"}},[_c("el-button",{staticClass:"fp-reset-icon",attrs:{size:"small",disabled:!0,icon:"el-icon-refresh-left"}})],1)],1)],1)],1)]],2)},AssignmentViewSpaceDialogvue_type_template_id_4ed00855_staticRenderFns=[],AssignmentViewSpaceDialogvue_type_script_lang_js={extends:ViewerPropertyDialogWrapper},components_AssignmentViewSpaceDialogvue_type_script_lang_js=AssignmentViewSpaceDialogvue_type_script_lang_js,AssignmentViewSpaceDialog_component=(0,componentNormalizer/* default */.Z)(components_AssignmentViewSpaceDialogvue_type_script_lang_js,AssignmentViewSpaceDialogvue_type_template_id_4ed00855_render,AssignmentViewSpaceDialogvue_type_template_id_4ed00855_staticRenderFns,!1,null,null,null)
/* harmony default export */,AssignmentViewSpaceDialog=AssignmentViewSpaceDialog_component.exports,LockerViewerPropertydialogvue_type_template_id_d80a053c_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"properties-section"},[_vm.loading?_c("spinner",{attrs:{show:_vm.loading,size:"80"}}):[_c("div",{staticClass:"new-header-container pL30"},[_c("div",{staticClass:"new-header-text relative"},[_c("div",{staticClass:"fc-setup-modal-title"},[_vm._v("Properties")]),_c("div",{staticClass:"flex-middle"},[_vm.isPortal||"desks"!==_vm.moduleName?_vm._e():_c("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{arrow:!0},expression:"{ arrow: true }"}],attrs:{content:"View Summary"},on:{click:function($event){return _vm.openRecordSummary(_vm.record,_vm.moduleName)}}},[_c("inline-svg",{attrs:{src:"svgs/external-link2",iconClass:"icon icon-sm-md fill-blue mR10 pointer"}})],1),_c("div",{staticClass:"fc-setup-modal-close f18 pointer",on:{click:_vm.handleClose}},[_c("i",{staticClass:"el-icon-close fwBold"})])])])]),_c("div",{staticClass:"new-body-modal infp-left-section height100 pL20 pR20 mT10"},[_c("el-form",{ref:"form",attrs:{model:_vm.record,"label-width":"120px"}},[_c("el-row",{staticClass:"mB10"},[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{staticClass:"mB10 m0",attrs:{prop:"name"}},[_c("p",{staticClass:"fc-input-label-txt pB5"},[_vm._v("Name")]),_c("el-input",{staticClass:"width100 fc-input-full-border2",attrs:{disabled:!0},model:{value:_vm.record.name,callback:function($$v){_vm.$set(_vm.record,"name",$$v)},expression:"record.name"}})],1)],1)],1)],1),_c("el-row",{staticClass:"mB10 pT10"},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"fc-black-14 text-left text-capitalize mB10"},[_vm._v(" "+_vm._s(_vm.employee)+" ")]),_vm.rerenderEmplyWizard?_c("FLookupFieldWrapper",{staticClass:"rm-arrow",attrs:{label:_vm.employee,field:{lookupModule:{name:"employee"},multiple:!1},filterConstruction:_vm.constructEmployeeFilter},on:{recordSelected:function(value){return _vm.setValue(value)}},model:{value:_vm.record.employee.id,callback:function($$v){_vm.$set(_vm.record.employee,"id",$$v)},expression:"record.employee.id"}}):_vm._e()],1)],1),_c("div",{staticClass:"text-center pT20"}),_c("el-row",{staticClass:"text-center pT20"},[_vm.showbtn?_c("el-col",{attrs:{span:20}},[_c("el-button",{staticClass:"fc-pink-btn-small",attrs:{size:"small"},on:{click:_vm.update}},[_vm._v(_vm._s(_vm.doneChanges))])],1):_c("el-col",{attrs:{span:20}},[_c("el-button",{staticClass:"fc-pink-btn-small inactive",attrs:{size:"small",disabled:!0}},[_vm._v(_vm._s(_vm.doneChanges))])],1),_vm.showbtn?_c("el-col",{attrs:{span:4}},[_c("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Reset",placement:"bottom"}},[_c("el-button",{staticClass:"fp-reset-icon",attrs:{size:"small",icon:"el-icon-refresh-left"},on:{click:_vm.reset}})],1)],1):_c("el-col",{attrs:{span:4}},[_c("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Reset",placement:"bottom"}},[_c("el-button",{staticClass:"fp-reset-icon",attrs:{size:"small",disabled:!0,icon:"el-icon-refresh-left"}})],1)],1)],1)],1)]],2)},LockerViewerPropertydialogvue_type_template_id_d80a053c_staticRenderFns=[],LockerViewerPropertydialogvue_type_script_lang_js={extends:ViewerPropertyDialogWrapper},components_LockerViewerPropertydialogvue_type_script_lang_js=LockerViewerPropertydialogvue_type_script_lang_js,LockerViewerPropertydialog_component=(0,componentNormalizer/* default */.Z)(components_LockerViewerPropertydialogvue_type_script_lang_js,LockerViewerPropertydialogvue_type_template_id_d80a053c_render,LockerViewerPropertydialogvue_type_template_id_d80a053c_staticRenderFns,!1,null,null,null)
/* harmony default export */,LockerViewerPropertydialog=LockerViewerPropertydialog_component.exports,ParkingViewerPropertydialogvue_type_template_id_757b2353_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"properties-section"},[_vm.loading?_c("spinner",{attrs:{show:_vm.loading,size:"80"}}):[_c("div",{staticClass:"new-header-container pL30"},[_c("div",{staticClass:"new-header-text relative"},[_c("div",{staticClass:"fc-setup-modal-title"},[_vm._v("Properties")]),_c("div",{staticClass:"flex-middle"},[!_vm.isPortal&&"parkingstall"===_vm.moduleName&&_vm.isWebTabsEnabled?_c("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{arrow:!0},expression:"{ arrow: true }"}],attrs:{content:"View Summary"},on:{click:function($event){return _vm.openRecordSummary(_vm.record,_vm.moduleName)}}},[_c("inline-svg",{attrs:{src:"svgs/external-link2",iconClass:"icon icon-sm-md fill-blue mR10 pointer"}})],1):_vm._e(),_c("div",{staticClass:"fc-setup-modal-close f18 pointer",on:{click:_vm.handleClose}},[_c("i",{staticClass:"el-icon-close fwBold"})])])])]),_vm.object?[_c("div",{staticClass:"new-body-modal infp-left-section height100 pL20 pR20 mT10"},[_c("el-form",{ref:"form",attrs:{model:_vm.object,"label-width":"120px"}},[_c("el-row",{staticClass:"mB10"},[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{staticClass:"mB10 m0",attrs:{prop:"name"}},[_c("p",{staticClass:"fc-input-label-txt pB5"},[_vm._v("Praking Name")]),_c("el-input",{staticClass:"width100 fc-input-full-border2",attrs:{disabled:!0},model:{value:_vm.object.label,callback:function($$v){_vm.$set(_vm.object,"label",$$v)},expression:"object.label"}})],1)],1)],1),1===_vm.record.parkingMode?_c("el-row",{staticClass:"mB10 pT10"},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"fc-black-14 text-left text-capitalize mB10"},[_vm._v(" "+_vm._s(_vm.employee)+" ")]),_vm.rerenderEmplyWizard?_c("FLookupFieldWrapper",{staticClass:"rm-arrow",attrs:{label:_vm.employee,field:{lookupModule:{name:"employee"},multiple:!1},filterConstruction:_vm.constructEmployeeFilter},on:{recordSelected:function(value){return _vm.setValue(value)}},model:{value:_vm.record.employee.id,callback:function($$v){_vm.$set(_vm.record.employee,"id",$$v)},expression:"record.employee.id"}}):_vm._e()],1)],1):_vm._e()],1),_vm.moveText?_c("div",{staticClass:"fc-black-14 text-left mB10 f10"},[_vm._v(" "+_vm._s(_vm.moveText)+" ")]):_vm._e(),_c("div",{staticClass:"text-center pT20"}),_c("el-row",{staticClass:"text-center pT20"},[_vm.showbtn?_c("el-col",{attrs:{span:20}},[_c("el-button",{staticClass:"fc-pink-btn-small",attrs:{size:"small"},on:{click:_vm.update}},[_vm._v(_vm._s(_vm.doneChanges))])],1):_c("el-col",{attrs:{span:20}},[_c("el-button",{staticClass:"fc-pink-btn-small inactive",attrs:{size:"small",disabled:!0}},[_vm._v(_vm._s(_vm.doneChanges))])],1),_vm.showbtn?_c("el-col",{attrs:{span:4}},[_c("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Reset",placement:"bottom"}},[_c("el-button",{staticClass:"fp-reset-icon",attrs:{size:"small",icon:"el-icon-refresh-left"},on:{click:_vm.reset}})],1)],1):_c("el-col",{attrs:{span:4}},[_c("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Reset",placement:"bottom"}},[_c("el-button",{staticClass:"fp-reset-icon",attrs:{size:"small",disabled:!0,icon:"el-icon-refresh-left"}})],1)],1)],1)],1)]:_vm._e()]],2)},ParkingViewerPropertydialogvue_type_template_id_757b2353_scoped_true_staticRenderFns=[],ParkingViewerPropertydialogvue_type_script_lang_js={components:{FLookupFieldWrapper:FLookupFieldWrapper/* default */.Z},props:{objectId:{type:Number,required:!0},isPortal:{type:Boolean,required:!1,default:!1},visible:{type:Boolean,required:!0},siteId:{type:Number,required:!1}},data:function(){return{rerenderEmplyWizard:!0,deskType:"Desk type",department:"Department",employee:"Employee",doneChanges:"Done Changes",departmentChange:!1,showdeskResetIcon:!1,propertiesData:{},record:{},moduleName:null,moveText:"",moveData:{},fromDesk:null,loading:!0,btnLoading:!1,object:null,btnState:!0,previsParking:null}},computed:{showbtn:function(){return!(this.btnLoading||!this.btnState)&&!(0,lodash.isEqual)(this.record,this.formatRecord(this.propertiesData.record))},isWebTabsEnabled:function(){return router/* isWebTabsEnabled */.tj}},mounted:function(){this.init()},watch:{objectId:{handler:function(newVal,oldVal){newVal!==oldVal&&this.init()}}},methods:{getModelData:function(){},reset:function(){this.previsParking=null,this.moveText="",this.record=this.$helpers.cloneObject(this.formatRecord(this.propertiesData.record)||{})},move:function(){var _this=this;(0,lodash.isEmpty)(this.moveData)?this.updateRecord().then((function(){_this.$emit("refresh"),_this.getPropertiesData(!0)})):this.updateMoveData(this.moveData).then((function(){_this.$emit("refresh"),_this.getPropertiesData(!0)}))},update:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.next=2,_this2.updateRecord();case 2:return _context.next=4,_this2.unassignEmployee();case 4:_this2.$emit("refresh"),_this2.getPropertiesData(!0);case 6:case"end":return _context.stop()}}),_callee)})))()},fetchEmployeeFromOtherParking:function(employee){return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var _data$parkingstall,filters,params,_yield$API$get,data;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return filters={employee:{operatorId:36,value:["".concat(employee.value)]}},params={moduleName:"parkingstall",includeParentFilter:!0,page:1,perPage:200,filters:JSON.stringify(filters)},_context2.next=4,api/* API */.bl.get("v3/modules/data/list",params);case 4:if(_yield$API$get=_context2.sent,data=_yield$API$get.data,null===data||void 0===data||null===(_data$parkingstall=data.parkingstall)||void 0===_data$parkingstall||!_data$parkingstall.length){_context2.next=8;break}return _context2.abrupt("return",data.parkingstall[0]);case 8:return _context2.abrupt("return",null);case 9:case"end":return _context2.stop()}}),_callee2)})))()},unassignEmployee:function(){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var record,params,_yield$API$post;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:if(record=_this3.previsParking,null===record){_context3.next=10;break}return null!==record&&void 0!==record&&record.employee&&delete record.employee,params={moduleName:"parkingstall",id:record.id,data:record},_context3.next=6,api/* API */.bl.post("v3/modules/data/update",params);case 6:_yield$API$post=_context3.sent,_yield$API$post.data,_yield$API$post.error;case 10:_this3.previsParking=null;case 11:case"end":return _context3.stop()}}),_callee3)})))()},constructEmployeeFilter:function(){var _this$record;return null!==(_this$record=this.record)&&void 0!==_this$record&&null!==(_this$record=_this$record.department)&&void 0!==_this$record&&_this$record.id?{department:{operatorId:36,value:["".concat(this.record.department.id)]}}:{}},setValue:function(value){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:_this4.moveText="",null!==value&&void 0!==value&&value.value&&value.value>0?_this4.fetchEmployee(value):_this4.unassign();case 2:case"end":return _context4.stop()}}),_callee4)})))()},fetchEmployee:function(employee){var _this5=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee5(){var parking;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context5){while(1)switch(_context5.prev=_context5.next){case 0:return _this5.btnState=!1,_context5.next=3,_this5.fetchEmployeeFromOtherParking(employee);case 3:parking=_context5.sent,_this5.previsParking=parking,null!==parking&&void 0!==parking&&parking.name&&(_this5.moveText="Employee will be moved from ".concat(parking.name)),_this5.btnState=!0;case 7:case"end":return _context5.stop()}}),_callee5)})))()},unassign:function(){var _record$employee,record=this.$helpers.cloneObject(this.formatRecord(this.propertiesData.record));null!==record&&void 0!==record&&null!==(_record$employee=record.employee)&&void 0!==_record$employee&&_record$employee.name?this.moveText="".concat(this.record.employee.name," will be unassigned from this parking"):this.moveText="",this.fromDesk=record},getMoveData:function(toEmployee){var toDesk=toEmployee&&this.record||null,fromDesk=this.fromDesk||null;return null!==toEmployee&&void 0!==toEmployee&&toEmployee.value&&toDesk&&this.$set(toDesk,"employee",{id:toEmployee.value}),{toDesk:toDesk,fromDesk:fromDesk}},setDepartmentValue:function(){var _this6=this,record=this.record;this.moveText="",record.employee={id:null},this.rerenderEmplyWizard=!1,this.$nextTick((function(){_this6.rerenderEmplyWizard=!0}))},handleClose:function(){this.$emit("update:visible",!1),this.$emit("close")},init:function(){this.getPropertiesData()},getPropertiesData:function(loadingfalse){var _this7=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee6(){var params;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context6){while(1)switch(_context6.prev=_context6.next){case 0:return _this7.moveText="",params={objectId:_this7.objectId},_this7.btnLoading=!0,loadingfalse||(_this7.loading=!0),_context6.next=6,api/* API */.bl.get("/v3/floorplan/propertiesdata",params).then((function(_ref){var _data$properties,data=_ref.data;null!==data&&void 0!==data&&data.properties&&(_this7.propertiesData=_this7.$helpers.cloneObject(data.properties),data.properties.moduleName&&(_this7.moduleName=_this7.$helpers.cloneObject(data.properties.moduleName)),null!==(_data$properties=data.properties)&&void 0!==_data$properties&&_data$properties.record&&(_this7.record=_this7.$helpers.cloneObject(_this7.formatRecord(data.properties.record)||{})),_this7.object=_this7.$helpers.cloneObject(data.properties.object||{}));_this7.loading=!1,_this7.btnLoading=!1})).catch((function(error){_this7.loading=!1,_this7.btnLoading=!1,error&&_this7.$message.error("Error While fetching the data")}));case 6:case"end":return _context6.stop()}}),_callee6)})))()},formatRecord:function(record){return"desks"===this.moduleName?(null!==record&&void 0!==record&&record.department||this.$set(record,"department",{id:null}),null!==record&&void 0!==record&&record.employee||this.$set(record,"employee",{id:null})):("lockers"===this.moduleName||"parkingstall"===this.moduleName)&&(null!==record&&void 0!==record&&record.employee||this.$set(record,"employee",{id:null})),record},setDepartment:function(desk){var _desk$department,_this$record2;null===desk||void 0===desk||null===(_desk$department=desk.department)||void 0===_desk$department||!_desk$department.id||null!==(_this$record2=this.record)&&void 0!==_this$record2&&null!==(_this$record2=_this$record2.department)&&void 0!==_this$record2&&_this$record2.id||(this.record.department={id:desk.department.id})},setEmployee:function(desk){var _desk$employee,_this$record3;null===desk||void 0===desk||null===(_desk$employee=desk.employee)||void 0===_desk$employee||!_desk$employee.id||null!==(_this$record3=this.record)&&void 0!==_this$record3&&null!==(_this$record3=_this$record3.employee)&&void 0!==_this$record3&&_this$record3.id||(this.record.employee={id:desk.employee.id})},loadMoveDetails:function(desk){if(this.fromDesk=null,desk){this.fromDesk=desk;var floorName=desk.floor&&desk.floor.name?desk.floor.name:null;this.moveText="Employee will be moved from ".concat(desk.name," ").concat(floorName?", "+floorName:""," to this desk")}},updateRecord:function(){var _this8=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee7(){var params,_yield$API$post2,data,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context7){while(1)switch(_context7.prev=_context7.next){case 0:return _this8.btnState=!1,params={moduleName:_this8.moduleName,id:_this8.record.id,data:_this8.record},_context7.next=4,api/* API */.bl.post("v3/modules/data/update",params);case 4:_yield$API$post2=_context7.sent,data=_yield$API$post2.data,error=_yield$API$post2.error,error?_this8.$message.error("".concat(error.message)):data&&_this8.$message.success("".concat(_this8.record.name," updated")),_this8.btnState=!0;case 9:case"end":return _context7.stop()}}),_callee7)})))()},openRecordSummary:function(_ref2){var id=_ref2.id,viewname="all";
// let { viewname } = this
// default view name should be dynamic
if((0,router/* isWebTabsEnabled */.tj)()){var _ref3=(0,router/* findRouteForModule */.Jp)("parkingstall",router/* pageTypes */.As.OVERVIEW)||{},name=_ref3.name;if(name){var routeData=this.$router.resolve({name:name,params:{viewname:viewname,id:id}});window.open(routeData.href,"_blank")}}}}},components_ParkingViewerPropertydialogvue_type_script_lang_js=ParkingViewerPropertydialogvue_type_script_lang_js,ParkingViewerPropertydialog_component=(0,componentNormalizer/* default */.Z)(components_ParkingViewerPropertydialogvue_type_script_lang_js,ParkingViewerPropertydialogvue_type_template_id_757b2353_scoped_true_render,ParkingViewerPropertydialogvue_type_template_id_757b2353_scoped_true_staticRenderFns,!1,null,"757b2353",null)
/* harmony default export */,ParkingViewerPropertydialog=ParkingViewerPropertydialog_component.exports,AssignmentViewLeagendsvue_type_template_id_75d99440_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("div",{staticClass:"assignment-viwe-leagends"},[_vm.hideLeagend?_vm._e():_c("el-tabs",{staticClass:"card-tab-fixed aignment-leagends",model:{value:_vm.activeTab,callback:function($$v){_vm.activeTab=$$v},expression:"activeTab"}},[_vm.deskList.length?_c("el-tab-pane",{attrs:{label:"Occupancy",name:"occupancy"}},[_c("div",{staticClass:"inline-flex pT10 pB10 border-bottom15"},[_c("inline-svg",{attrs:{src:"svgs/floorplan/desk",iconClass:"icon text-center icon-sm"}}),_c("div",{staticClass:"pL8 fc-black-13"},[_vm._v(" "+_vm._s(" Vacant Desks ("+_vm.statusVsDesk.vacant+")")+" ")])],1),_c("div",{staticClass:"inline-flex pT10 pB10 border-bottom15"},[_c("inline-svg",{attrs:{src:"svgs/floorplan/circle",iconClass:"icon text-center icon-sm"}}),_c("div",{staticClass:"pL8 fc-black-13"},[_vm._v(" "+_vm._s(" Occupied Desks ("+_vm.statusVsDesk.occupied+")")+" ")])],1),_c("div",{staticClass:"inline-flex pT10 pB10 border-bottom15"},[_c("inline-svg",{attrs:{src:"svgs/floorplan/desk",iconClass:"icon text-center icon-sm inactive-desk"}}),_c("div",{staticClass:"pL8 fc-black-13"},[_vm._v(" "+_vm._s("Reservable Desks ("+_vm.statusVsDesk.reservable+")")+" ")])],1)]):_vm._e(),_vm.deskList.length?_c("el-tab-pane",{attrs:{label:"Departments",name:"department"}},[_vm._l(_vm.departments,(function(department,index){return[_vm.departmentVsDesk[department.id]?_c("div",{key:index,staticClass:"inline-flex pT10 pB10 border-bottom15"},[department.color?_c("div",{style:{color:department.color}},[_c("i",{staticClass:"fa fa-circle f14",attrs:{"aria-hidden":"true"}})]):_c("div",{style:{color:"#ddd"}},[_c("i",{staticClass:"fa fa-circle f14",attrs:{"aria-hidden":"true"}})]),_c("div",{staticClass:"pL8 fc-black-13"},[_vm._v(" "+_vm._s(department.name+" ("+(_vm.departmentVsDesk[department.id]||0)+") ")+" ")])]):_vm._e()]}))],2):_vm._e(),_vm.lockers.length?_c("el-tab-pane",{attrs:{label:"Locker",name:"locker"}},[_c("div",{staticClass:"inline-flex pT10 pB10 border-bottom15"},[_c("div",{style:{color:"#22ae5c"}},[_c("i",{staticClass:"fa fa-circle f14",attrs:{"aria-hidden":"true"}})]),_c("div",{staticClass:"pL8 fc-black-13"},[_vm._v(" "+_vm._s("Vacant Lockers ("+(_vm.unAssignedLockers.length||0)+") ")+" ")])]),_c("div",{staticClass:"inline-flex pT10 pB10 border-bottom15"},[_c("div",{style:{color:"#dc4a4c"}},[_c("i",{staticClass:"fa fa-circle f14",attrs:{"aria-hidden":"true"}})]),_c("div",{staticClass:"pL8 fc-black-13"},[_vm._v(" "+_vm._s("Occupied Lockers ("+(_vm.assignedLockers.length||0)+") ")+" ")])])]):_vm._e(),_vm.parkingList.length?_c("el-tab-pane",{attrs:{label:"Parking",name:"parking"}},[_c("div",{staticClass:"inline-flex pT10 pB10 border-bottom15"},[_c("div",{style:{color:_vm.getParrkingUnassignedColor}},[_c("i",{staticClass:"fa fa-circle f14",attrs:{"aria-hidden":"true"}})]),_c("div",{staticClass:"pL8 fc-black-13"},[_vm._v(" "+_vm._s("Vacant Parking ("+(_vm.unAssignedParking.length||0)+") ")+" ")])]),_c("div",{staticClass:"inline-flex pT10 pB10 border-bottom15"},[_c("div",{style:{color:_vm.getParrkingAssignedColor}},[_c("i",{staticClass:"fa fa-circle f14",attrs:{"aria-hidden":"true"}})]),_c("div",{staticClass:"pL8 fc-black-13"},[_vm._v(" "+_vm._s("Occupied Parking ("+(_vm.assignedParking.length||0)+") ")+" ")])]),_c("div",{staticClass:"inline-flex pT10 pB10 border-bottom15"},[_c("div",{style:{color:_vm.getParrkingReservableColor}},[_c("i",{staticClass:"fa fa-circle f14",attrs:{"aria-hidden":"true"}})]),_c("div",{staticClass:"pL8 fc-black-13"},[_vm._v(" "+_vm._s("Reservable Parking ("+(_vm.getReservalbleList.length||0)+") ")+" ")])])]):_vm._e()],1),_vm.hideLeagend?_vm._e():_c("div",{staticClass:"sidebarhide",on:{click:function($event){_vm.hideLeagend=!0}}},[_c("div",{staticClass:"sidebarhide-bar"},[_vm.hideLeagend?_c("i",{staticClass:"el-icon-arrow-right"}):_c("i",{staticClass:"el-icon-d-arrow-left"})])])],1),_vm.hideLeagend?_c("div",{staticClass:"show-leadends-text",on:{click:function($event){_vm.hideLeagend=!1}}},[_vm._v(" Show Legend "),_c("i",{staticClass:"el-icon-d-arrow-left"})]):_vm._e()])},AssignmentViewLeagendsvue_type_template_id_75d99440_scoped_true_staticRenderFns=[],util=(__webpack_require__(947522),__webpack_require__(664333)),AssignmentViewLeagendsvue_type_script_lang_js={props:["departments","deskList","lockers","parkingList","settings"],data:function(){return{hideLeagend:!1,activeTab:"occupancy"}},computed:{getParrkingUnassignedColor:function(){var unAssignedColor=this.settings.assignmentState.unAssignedColor;return unAssignedColor||"#22ae5c"},getParrkingAssignedColor:function(){var assignedColor=this.settings.assignmentState.assignedColor;return assignedColor||"#dc4a4c"},getParrkingReservableColor:function(){var nonReservableColor=this.settings.bookingState.nonReservableColor;return nonReservableColor||"#dc4a4c"},unAssignedParking:function(){return(0,util/* getUnassignedList */.Iv)(this.parkingList)},assignedParking:function(){return(0,util/* getAssignedList */.vU)(this.parkingList)},unAssignedLockers:function(){return(0,util/* getUnassignedList */.Iv)(this.lockers)},assignedLockers:function(){return(0,util/* getAssignedList */.vU)(this.lockers)},getReservalbleList:function(){return(0,util/* getReservalbleList */.Iu)(this.parkingList)},departmentVsDesk:function(){var _this=this,departmentMap={};return this.deskList.forEach((function(desk){if(desk.department)if(departmentMap[desk.department.id]){var count=departmentMap[desk.department.id]+1;_this.$set(departmentMap,desk.department.id,count)}else _this.$set(departmentMap,desk.department.id,1)})),departmentMap},statusVsDesk:function(){var statusCount={vacant:0,occupied:0,reservable:0};return this.deskList.forEach((function(desk){if(desk.deskType>1){var count=statusCount["reservable"]+1;statusCount["reservable"]=count}else if(desk.employee){var _count=statusCount["occupied"]+1;statusCount["occupied"]=_count}else if(1===desk.deskType&&!desk.employee){var _count2=statusCount["vacant"]+1;statusCount["vacant"]=_count2}})),statusCount}},watch:{lockers:{handler:function(){this.setView()},immediate:!0}},mounted:function(){this.setView()},methods:{setView:function(){this.lockers.length&&!this.deskList.length?this.activeTab="locker":this.parkingList.length&&!this.deskList.length&&(this.activeTab="parking")}}},components_AssignmentViewLeagendsvue_type_script_lang_js=AssignmentViewLeagendsvue_type_script_lang_js,AssignmentViewLeagends_component=(0,componentNormalizer/* default */.Z)(components_AssignmentViewLeagendsvue_type_script_lang_js,AssignmentViewLeagendsvue_type_template_id_75d99440_scoped_true_render,AssignmentViewLeagendsvue_type_template_id_75d99440_scoped_true_staticRenderFns,!1,null,"75d99440",null)
/* harmony default export */,AssignmentViewLeagends=AssignmentViewLeagends_component.exports,FloorplanTypeSwitcher=__webpack_require__(758676),FloorPlanLoading=__webpack_require__(386046),mapbox_gl=__webpack_require__(706158),mapbox_gl_default=__webpack_require__.n(mapbox_gl),IndoorFloorPlanMarkerToolipNew=__webpack_require__(742727),FloorplanSettings=__webpack_require__(327679),NewFloorPlanSettings=__webpack_require__(30903),IndoorFloorPlanAssignmentViewvue_type_script_lang_js={props:["building","floor"],extends:IndoorFloorPlanViewer/* default */.Z,mixins:[ViewerActions/* default */.Z],components:{IndoorFloorplanSearch:IndoorFloorplanSearch/* default */.Z,IndoorFloorplanSearch2:IndoorFloorplanSearch2/* default */.Z,AssignmentViewSpaceDialog:AssignmentViewSpaceDialog,AssignmentViewLeagends:AssignmentViewLeagends,FloorPlanLoading:FloorPlanLoading/* default */.Z,IndoorFloorPlanMarkerTooltip:IndoorFloorPlanMarkerToolipNew/* default */.Z,LockerViewerPropertydialog:LockerViewerPropertydialog,ParkingViewerPropertydialog:ParkingViewerPropertydialog,FloorplanTypeSwitcher:FloorplanTypeSwitcher/* default */.Z,ViewerPropertyDialogWrapper:ViewerPropertyDialogWrapper,FloorplanSettings:FloorplanSettings/* default */.Z,IndoorFloorplanSearch3:IndoorFloorplanSearch3,NewFloorplanSettings:NewFloorPlanSettings/* default */.Z},mounted:function(){},beforeDestroy:function(){
//Avoid drag element remaining in DOM after component has been destroyed
var dragEle=document.querySelector("#dragItem");dragEle&&document.body.removeChild(dragEle)},data:function(){return{zoom:20,propertiesFeatureVisibile:!1,visibleFilter:!1,filterDialogOpen:!1,floorSearchBuilding:"",buildingActive:"",moveElement:!1,mouseMouseEnter:!1,spaceMapDialog:!1,lockerDialog:!1,parkingdialog:!1,selectedZone:{},viewerMode:"ASSIGNMENT"}},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)("webtabs",{currentTab:function(state){return state.selectedTab}})),(0,vuex_esm/* mapGetters */.Se)("webtabs",["tabHasPermission"])),{},{hasViewPermission:function(){var currentTab=this.currentTab,tabHasPermission=this.tabHasPermission;return tabHasPermission("VIEW",currentTab)},hasAssignPermission:function(){var currentTab=this.currentTab,tabHasPermission=this.tabHasPermission;return tabHasPermission("ASSIGN",currentTab)},settings:function(){return this.customization?this.customization:null},showAssignmentsidebar:function(){var showAssignment=!0;return this.showAssignOption&&showAssignment},showAssignOption:function(){return!(!this.hasViewPermission||!this.hasAssignPermission)},showViewOption:function(){return!!this.hasViewPermission},isNewSetting:function(){return this.$helpers.isLicenseEnabled("NEW_FLOORPLAN")}}),methods:{handleSettings:function(settings){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:_this.applySettings(settings),_this.patchUpdateFloorplan(settings);case 2:case"end":return _context.stop()}}),_callee)})))()},afterFloorplanLoadHook:function(){
// console.log('after floorplan hook called')
this.applySettings(this.settings)},applySettings:function(settings){if(settings){var spacePrimaryLabel=settings.spacePrimaryLabel,deskPrimaryLabel=settings.deskPrimaryLabel,deskSecondaryLabel=settings.deskSecondaryLabel,spaceBookingState=settings.spaceBookingState,spaceSecondaryLabel=settings.spaceSecondaryLabel,compactView=settings.compactView,textHalo=settings.textHalo,allowTextOverlap=settings.allowTextOverlap,imageOpacity=settings.imageOpacity,compactview=compactView,texthalo=textHalo,textoverlap=allowTextOverlap,deskfontColor=deskPrimaryLabel.color,deskNameColor=deskSecondaryLabel.color,spacePrimaryColor=spacePrimaryLabel.color,spaceSecondaryColor=spaceSecondaryLabel.color,spaceColor=spaceBookingState.nonReservableColor,deskPrimarySize=deskPrimaryLabel.fontSize,deskSecondarySize=deskSecondaryLabel.fontSize,spacePrimarySize=spacePrimaryLabel.fontSize,spaceSecondarySize=spaceSecondaryLabel.fontSize,alpha=spaceColor.replace(/^.*,(.+)\)/,"$1");"#000000"===alpha&&(alpha=.3);Number(alpha||.3);deskfontColor||(deskfontColor="black"),compactview&&(textoverlap=!0);var deskSecondaryText="secondary-label-marker",spaceSecondaryText="space-secondary-text-zone",spacePrimaryText="space-text-zone",deskCenterLabel="formated-secondary-label-marker",deskLabel="marker";this.isLayerAvailable(deskSecondaryText)&&this.map.setPaintProperty(deskSecondaryText,"text-color",deskfontColor),this.isLayerAvailable(deskLabel)&&this.map.setPaintProperty(deskLabel,"text-color",deskNameColor),this.isLayerAvailable(spaceSecondaryText)&&this.map.setPaintProperty(spaceSecondaryText,"text-color",spaceSecondaryColor),this.isLayerAvailable(spacePrimaryText)&&this.map.setPaintProperty(spacePrimaryText,"text-color",spacePrimaryColor),
// this.map.setPaintProperty('zone', 'fill-extrusion-opacity', opacity)
// this.map.setPaintProperty('zone', 'fill-extrusion-color', spaceColor)
this.map.setPaintProperty("ImageLayer","raster-opacity",imageOpacity),compactview?(this.map.setLayoutProperty(deskSecondaryText,"text-size",["interpolate",["linear"],["zoom"],this.minZoom,0,this.maxZoom,this.fontSize+1]),this.map.setLayoutProperty(deskLabel,"text-size",["interpolate",["linear"],["zoom"],this.minZoom,0,this.maxZoom,this.fontSize]),this.map.setLayoutProperty(spacePrimaryText,"text-size",["interpolate",["linear"],["zoom"],this.minZoom,0,this.maxZoom,this.fontSize+1]),this.map.setLayoutProperty(spaceSecondaryText,"text-size",["interpolate",["linear"],["zoom"],this.minZoom,0,this.maxZoom,this.fontSize+1])):(this.map.setLayoutProperty(deskSecondaryText,"text-size",["interpolate",["linear"],["zoom"],17,2,20,deskPrimarySize]),this.map.setLayoutProperty(deskLabel,"text-size",["interpolate",["linear"],["zoom"],17,0,20,deskSecondarySize-2]),this.map.setLayoutProperty(spacePrimaryText,"text-size",["interpolate",["linear"],["zoom"],17,2,20,spacePrimarySize]),this.map.setLayoutProperty(spaceSecondaryText,"text-size",["interpolate",["linear"],["zoom"],17,2,20,spaceSecondarySize])),texthalo?(this.map.setPaintProperty(deskCenterLabel,"text-halo-width",1),this.map.setPaintProperty(spacePrimaryText,"text-halo-width",1),this.map.setPaintProperty(spaceSecondaryText,"text-halo-width",1),this.map.setPaintProperty(deskSecondaryText,"text-halo-width",.2)):(this.map.setPaintProperty(deskCenterLabel,"text-halo-width",0),this.map.setPaintProperty(spacePrimaryText,"text-halo-width",0),this.map.setPaintProperty(spaceSecondaryText,"text-halo-width",0),this.map.setPaintProperty(deskSecondaryText,"text-halo-width",0)),textoverlap?(this.map.setLayoutProperty(deskSecondaryText,"text-allow-overlap",!0),this.map.setLayoutProperty(deskLabel,"text-allow-overlap",!0),this.map.setLayoutProperty(spacePrimaryText,"text-allow-overlap",!0),this.map.setLayoutProperty(spaceSecondaryText,"text-allow-overlap",!0)):(this.map.setLayoutProperty(deskSecondaryText,"text-allow-overlap",!1),this.map.setLayoutProperty(deskLabel,"text-allow-overlap",!1),this.map.setLayoutProperty(spacePrimaryText,"text-allow-overlap",!1),this.map.setLayoutProperty(spaceSecondaryText,"text-allow-overlap",!1))}},patchUpdateFloorplan:function(settings){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var customization;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return customization=settings,_context2.next=3,_this2.patchUpdateRecord(customization);case 3:return _context2.next=5,_this2.loadViewerData();case 5:_this2.$message.success("Updated!");case 6:case"end":return _context2.stop()}}),_callee2)})))()},updateLockerProperty:function(feature){var data=feature.moduleData;if(data){var dataIndex=this.moduleVsData[this.lockerModuleId].findIndex((function(rt){return rt.id===data.id}));dataIndex>-1&&this.moduleVsData[this.lockerModuleId].splice(dataIndex,1,data),this.$set(feature,"moduleData",data),data.employee&&data.employee.id?feature.properties.zoneBackgroundColor="green":feature.properties.zoneBackgroundColor="red"}},dropElement:function(){this.isDraging=!1;var div=document.getElementById("dragItem");div.style.display="none",this.dragElement=null,this.employeSideBar=!0},mousemove:function(e){this.isDraging&&this.dragElement&&this.ghostElemntHandle(e)},mouseup:function(e){this.dropElement(e)},markerMouseLeave:function(e,f){this.popup&&this.popup.remove(),this.popup=null,e.preventDefault();var map=this.map,canvas=map.getCanvasContainer();canvas.style.cursor="",this.isDraging&&f.active&&(f.properties.markerId=f.properties.normalClass),f&&f.properties.employeeId&&this.moveElement&&!this.mouseMouseEnter&&(map["dragPan"].disable(),f.properties.markerId="desk",
// map.setLayoutProperty(id, 'icon-image', 'desk')
f.desk&&f.desk.employee&&f.desk.employee.id&&this.mouseDownElement(e,f.desk.employee,f),f.properties.employeeId=null,this.$set(f.properties,"secondaryLabel",this.getDeskSecondaryLabel(f)),this.unassignDesk(f),this.updateProperty(f)),this.refreshData(),this.mouseMouseEnter=!1},closeSpaceDialog:function(){this.selectedZone&&this.unSelectFeature(this.selectedZone),this.spaceMapDialog=!1,this.lockerDialog=!1,this.parkingdialog=!1,this.selectedZone={}},handleZoneClick:function(e,f){var _f$properties;this.resetDialogs(),e.preventDefault(),null!==f&&void 0!==f&&null!==(_f$properties=f.properties)&&void 0!==_f$properties&&_f$properties.spaceCategory?"Lockers"===f.properties.spaceCategory?this.lockerDialog=!0:"Parking Stall"===f.properties.spaceCategory?this.parkingdialog=!0:this.spaceMapDialog=!0:this.spaceMapDialog=!0,this.selectedZone=f},markerMouseEnter:function(e,f){e.preventDefault();var map=this.map;this.mouseMouseEnter=!0;var canvas=map.getCanvasContainer();canvas.style.cursor="pointer",this.isDraging&&f.active?(this.hoveredMarker=f,f.properties.markerId=f.properties.hoverClass):(this.popup&&(this.popup.remove(),this.popup=null),this.popup=new(mapbox_gl_default().Popup)({closeButton:!1,closeOnClick:!1}),this.popup.setLngLat(f.geometry.coordinates).setDOMContent(this.$refs["markerTooltip"].$el).addTo(map)),this.refreshData()},zoneMouseEnter:function(e,f){e.preventDefault();var map=this.map;this.mouseMouseEnter=!0;var canvas=map.getCanvasContainer();canvas.style.cursor="pointer",this.popup&&(this.popup.remove(),this.popup=null),this.popup=new(mapbox_gl_default().Popup)({closeButton:!1,closeOnClick:!1}),null!==f&&void 0!==f&&f.geometry&&this.popup.setLngLat(this.getPolygonCenter([f.geometry.coordinates[0]])).setDOMContent(this.$refs["markerTooltip"].$el).addTo(map)},zoneMouseLeave:function(e){this.popup&&this.popup.remove(),this.popup=null,e.preventDefault();var map=this.map,canvas=map.getCanvasContainer();canvas.style.cursor=""},
// eslint-disable-next-line no-unused-vars
markerMouseDown:function(e,f,id){if(f.active){var map=this.map;map["dragPan"].disable(),this.moveElement=!0,this.mouseMouseEnter=!1,this.refreshData()}},markerMouseUp:function(e,f){if(f.active){e.preventDefault();var map=this.map,canvas=map.getCanvasContainer();if(canvas.style.cursor="pointer",this.isDraging&&this.dragElement){this.$set(f.properties,"employeeId",Number(this.dragElement.id)),this.$set(f.properties,"secondaryLabel",this.dragElement.name);var data=this.dragElement.data;this.$set(f,"employee",this.dragElement),data&&data.department&&data.department.id?(this.$set(f.properties,"departmentId",Number(data.department.id)),this.$set(f,"department",data.department)):f.properties.departmentId&&(delete f.properties.departmentId,delete f.department),this.updateProperty(f),this.updateMove(f),this.dropElement()}this.dragElement=null,this.moveElement=!1,map["dragPan"].enable()}},specialHandelCheck:function(feature){var _feature$properties;null!==feature&&void 0!==feature&&null!==(_feature$properties=feature.properties)&&void 0!==_feature$properties&&_feature$properties.openDialog?(this.resetDialogs(),this.specialHandelforMarkerClick(feature)):this.propertiesFeatureVisibile=!1;var properties=feature.properties;return(null===properties||void 0===properties?void 0:properties.deskType)>0},resetDialogs:function(){this.spaceMapDialog=!1,this.propertiesFeatureVisibile=!1},specialHandelforMarkerClick:function(_ref){var markerType=_ref.markerType,properties=_ref.properties;
// need to remove this method
(null===markerType||void 0===markerType?void 0:markerType.fileId)>0&&(null===markerType||void 0===markerType?void 0:markerType.recordModuleId)>0&&null!==properties&&void 0!==properties&&properties.recordId?this.redirectToSummary(markerType.recordModuleId,properties.recordId):this.propertiesFeatureVisibile=!0},handleMarkerClick:function(){
// if (feature?.properties?.openDialog) {
//   this.resetDialogs()
//   this.specialHandelforMarkerClick(feature)
// } else {
//   this.propertiesFeatureVisibile = false
// }
},
// Do not move this to mixin, mixin methods wont be properly overridden from children
//this methods makes sense to be in children
setDeskActiveState:function(feature){
// used to set desk active state
return feature}}},indoorFloorPlan_IndoorFloorPlanAssignmentViewvue_type_script_lang_js=IndoorFloorPlanAssignmentViewvue_type_script_lang_js,IndoorFloorPlanAssignmentView_component=(0,componentNormalizer/* default */.Z)(indoorFloorPlan_IndoorFloorPlanAssignmentViewvue_type_script_lang_js,IndoorFloorPlanAssignmentViewvue_type_template_id_b3444d2a_render,IndoorFloorPlanAssignmentViewvue_type_template_id_b3444d2a_staticRenderFns,!1,null,null,null)
/* harmony default export */,IndoorFloorPlanAssignmentView=IndoorFloorPlanAssignmentView_component.exports,IndoorFloorPlanBookingsView=__webpack_require__(426692),IndoorFloorPlanSwitcher=__webpack_require__(517185),IndoorFloorPlanFormvue_type_template_id_03dcc6e0_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{attrs:{visible:_vm.visibility,"before-close":_vm.closeDialog,"append-to-body":!0,fullscreen:!0,"custom-class":"fc-dialog-form setup-dialog-right setup-dialog40 setup-dialog fc-web-form-dialog f-webform-right-dialog"}},[_c("div",{staticClass:"fc-pm-main-content-H"},[_vm._v("New Floor Plan")]),_vm.isLoading?_c("div",{staticClass:"loading-container d-flex"},[_c("Spinner",{attrs:{show:_vm.isLoading}})],1):_c("f-webform",{staticClass:"pT20",attrs:{form:_vm.formObj,module:_vm.moduleName,moduleData:_vm.moduleData,moduleDataId:_vm.moduleDataId,moduleDisplayName:_vm.moduleDisplayName,isSaving:_vm.isSaving,formLabelPosition:"top",isV3Api:_vm.isV3Api,isEdit:_vm.isEdit,canShowPrimaryBtn:!0,canShowSecondaryBtn:!0},on:{"update:form":function($event){_vm.formObj=$event},onBlur:_vm.onBlurHook,save:_vm.saveRecord,cancel:_vm.closeDialog}})],1)},IndoorFloorPlanFormvue_type_template_id_03dcc6e0_staticRenderFns=[],FWebform=(__webpack_require__(425728),__webpack_require__(434500)),FormCreation=__webpack_require__(373729),IndoorFloorPlanFormvue_type_script_lang_js={extends:FormCreation/* default */.Z,components:{FWebform:FWebform/* default */.Z},props:["visibility","formData","recordData","moduleName"],data:function(){return{isSaving:!1,formList:[],defaultForm:null,floor:null}},computed:{moduleDisplayName:function(){return this.formObj&&this.formObj.module?this.formObj.module.displayName:"Indoor Floorplan"},moduleDataId:function(){var moduleData=this.moduleData,_ref=moduleData||{},id=_ref.id;return id||null},isV3Api:function(){return!0}},methods:{init:function(){this.formData?(this.formData&&(this.formObj=this.formData,this.selectedForm=this.formData),this.recordData&&(this.moduleData=this.recordData)):this.loadFloorplanForms()},loadFloorplanForms:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var _yield$API$get,data,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _this.isLoading=!0,_context.next=3,api/* API */.bl.get("/v2/forms",{moduleName:"indoorfloorplan"});case 3:_yield$API$get=_context.sent,data=_yield$API$get.data,error=_yield$API$get.error,error?_this.$message.error("error loading floorplan"):(_this.formList=data.forms,_this.defaultForm=_this.formList.find((function(form){return"default_workplace_floorplan_web"==form.name||"default_floorplan_web"==form.name||"default_floorplan_web_iwms"==form.name})),_this.defaultForm&&(_this.formObj=_this.defaultForm,_this.selectedForm=_this.defaultForm));case 7:case"end":return _context.stop()}}),_callee)})))()},afterSerializeHook:function(_ref2){var data=_ref2.data;
//why this is needed ?.-> copied from
return this.$set(data,"fileSource",1),this.$set(data,"height",0),this.$set(data,"width",0),data},afterSaveHook:function(_ref3){var error=_ref3.error,indoorfloorplan=_ref3.indoorfloorplan;error||(this.loadFloor(indoorfloorplan),this.closeDialog(),this.$emit("saved",indoorfloorplan))},loadFloor:function(indoorfloorplan){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var floorId,_yield$API$get2,error,data,message;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return floorId=indoorfloorplan.floor.id,_context2.next=3,api/* API */.bl.get("v2/module/data/".concat(floorId,"?moduleName=floor"));case 3:_yield$API$get2=_context2.sent,error=_yield$API$get2.error,data=_yield$API$get2.data,error?(message=error.message,_this2.$message.error(message)):(_this2.floor=data.moduleData||[],_this2.updateFloor(indoorfloorplan,_this2.floor));case 7:case"end":return _context2.stop()}}),_callee2)})))()},updateFloor:function(indoorfloorplan,floor){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var url;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:if(!(floor&&indoorfloorplan&&indoorfloorplan.id)){_context3.next=5;break}return url="floor/update",_this3.$set(floor,"indoorFloorPlanId",indoorfloorplan.id),_context3.next=5,api/* API */.bl.post(url,{floor:floor});case 5:case"end":return _context3.stop()}}),_callee3)})))()},closeDialog:function(){this.$emit("update:visibility",!1),this.$emit("close")}}},indoorFloorPlan_IndoorFloorPlanFormvue_type_script_lang_js=IndoorFloorPlanFormvue_type_script_lang_js,IndoorFloorPlanForm_component=(0,componentNormalizer/* default */.Z)(indoorFloorPlan_IndoorFloorPlanFormvue_type_script_lang_js,IndoorFloorPlanFormvue_type_template_id_03dcc6e0_render,IndoorFloorPlanFormvue_type_template_id_03dcc6e0_staticRenderFns,!1,null,null,null)
/* harmony default export */,IndoorFloorPlanForm=IndoorFloorPlanForm_component.exports,eventBus=__webpack_require__(398011),Layoutvue_type_script_lang_js={components:{IndoorFloorPlanAssignmentView:IndoorFloorPlanAssignmentView,IndoorFloorPlanSwitcher:IndoorFloorPlanSwitcher/* default */.Z,IndoorFloorPlanBookingsView:IndoorFloorPlanBookingsView["default"],floorplanUploader:IndoorFloorPlanForm,FloorPlanEditor:function(){return Promise.all(/* import() */[__webpack_require__.e(93208),__webpack_require__.e(50232),__webpack_require__.e(93765),__webpack_require__.e(95953),__webpack_require__.e(35309),__webpack_require__.e(18778),__webpack_require__.e(12303),__webpack_require__.e(84290),__webpack_require__.e(31721),__webpack_require__.e(64418),__webpack_require__.e(5603),__webpack_require__.e(57432),__webpack_require__.e(435),__webpack_require__.e(72230),__webpack_require__.e(94255),__webpack_require__.e(67683),__webpack_require__.e(44178),__webpack_require__.e(91132),__webpack_require__.e(20280),__webpack_require__.e(78256),__webpack_require__.e(22200),__webpack_require__.e(49081),__webpack_require__.e(89472),__webpack_require__.e(12085),__webpack_require__.e(55754),__webpack_require__.e(86494),__webpack_require__.e(3037),__webpack_require__.e(49908),__webpack_require__.e(22061),__webpack_require__.e(31602),__webpack_require__.e(73609),__webpack_require__.e(60713),__webpack_require__.e(82332)]).then(__webpack_require__.bind(__webpack_require__,760713))}},data:function(){return{fpEditor:!1,customTime:{},floorlPlanList:[],loading:!0,newFp:!1,viewerMode:"ASSIGNMENT",filterDialogOpen:!1,building:{name:"...loading"},floor:{name:"...loading"}}},watch:{floorplanIdFromRoute:{immediate:!0,handler:function(){this.floorIdfromRouted&&!this.floorplanIdFromRoute?this.fetchFloorDetails(this.floorIdfromRouted):this.floorIdfromRouted||this.floorplanIdFromRoute?(this.changeFloorPlan(),this.tempFuntion()):
//first time entering floor plan layout,no id in route url
this.loadDefaultFloorPlan()}}},created:function(){var _this=this;eventBus/* eventBus */.Y.$on("SWITCH_FLOORPLAN_MODE",(function(mode){mode&&_this.setViewModefromSwitcher(mode)})),!1===this.showViewOption||this.showViewAssignmentOption||this.showAssignmentDepartmentOption||this.showAssignmentOwnOption?this.viewerMode="ASSIGNMENT":this.viewerMode="BOOKING",this.portalLayout&&(this.viewerMode="BOOKING"),"BOOKING"==this.$route.query.viewMode&&(this.viewerMode="BOOKING",this.customTime={date:this.$route.query.date,startTime:this.$route.query.startTime,endTime:this.$route.query.endTime})},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapGetters */.Se)(["getCurrentUser"])),(0,vuex_esm/* mapState */.rn)("webtabs",{currentTab:function(state){return state.selectedTab}})),(0,vuex_esm/* mapGetters */.Se)("webtabs",["tabHasPermission"])),{},{hasEditPermission:function(){var currentTab=this.currentTab,tabHasPermission=this.tabHasPermission;return tabHasPermission("EDIT",currentTab)},hasCreatePermission:function(){var currentTab=this.currentTab,tabHasPermission=this.tabHasPermission;return tabHasPermission("CREATE",currentTab)},hasViewPermission:function(){var currentTab=this.currentTab,tabHasPermission=this.tabHasPermission;return tabHasPermission("VIEW",currentTab)},hasViewAssignmentPermission:function(){var currentTab=this.currentTab,tabHasPermission=this.tabHasPermission;return tabHasPermission("VIEW_ASSIGNMENT",currentTab)},hasAssignmentDepartmentPermission:function(){var currentTab=this.currentTab,tabHasPermission=this.tabHasPermission;return tabHasPermission("VIEW_ASSIGNMENT_DEPARTMENT",currentTab)},hasAssignmentOwnPermission:function(){var currentTab=this.currentTab,tabHasPermission=this.tabHasPermission;return tabHasPermission("VIEW_ASSIGNMENT_OWN",currentTab)},hasViewBookingPermission:function(){var currentTab=this.currentTab,tabHasPermission=this.tabHasPermission;return tabHasPermission("VIEW_BOOKING",currentTab)},hasBookingDepartmentPermission:function(){var currentTab=this.currentTab,tabHasPermission=this.tabHasPermission;return tabHasPermission("VIEW_BOOKING_DEPARTMENT",currentTab)},hasBookingOwnPermission:function(){var currentTab=this.currentTab,tabHasPermission=this.tabHasPermission;return tabHasPermission("VIEW_BOOKING_OWN",currentTab)},portalLayout:function(){
// if (this.$account.org.orgId === 429) {
//   return true
// }
var PORTALS=this.$constants.appCategory.PORTALS;return!(!(0,router/* getApp */.wx)()||(0,router/* getApp */.wx)().appCategory!==PORTALS)},floorplanIdFromRoute:function(){return this.$route&&this.$route.params.floorplanid?parseInt(this.$route.params.floorplanid):null},floorIdfromRouted:function(){return this.$route&&this.$route.params.floorId?parseInt(this.$route.params.floorId):null},floorId:function(){var floor=this.floor;return floor&&floor.id?floor.id:null},buildingId:function(){var building=this.building;return building&&building.id?building.id:null},showEditOption:function(){return!(!this.hasViewPermission||!this.hasEditPermission)},showCreateOption:function(){return!(!this.hasViewPermission||!this.hasCreatePermission)},showViewOption:function(){return!!this.hasViewPermission},showViewAssignmentOption:function(){return!(!this.hasViewPermission||!this.hasViewAssignmentPermission)},showAssignmentDepartmentOption:function(){return!(!this.hasViewPermission||!this.hasAssignmentDepartmentPermission)},showAssignmentOwnOption:function(){return!(!this.hasViewPermission||!this.hasAssignmentOwnPermission)},showViewBookingOption:function(){return!(!this.hasViewPermission||!this.hasViewBookingPermission)},showBookingDepartmentOption:function(){return!(!this.hasViewPermission||!this.hasBookingDepartmentPermission)},showBookingOwnOption:function(){return!(!this.hasViewPermission||!this.hasBookingOwnPermission)}}),beforeDestroy:function(){eventBus/* eventBus */.Y.$off("SWITCH_FLOORPLAN_MODE",(function(){
// handel floorplan swicth mode event off
}))},methods:{setViewModefromSwitcher:function(mode){mode&&"edit"!==mode?this.viewerMode=mode:"edit"==mode&&this.openEditor()},tempFuntion:function(){this.floor={name:"...loading"},this.building={name:"...loading"}},getFloorDetails:function(floorplan){var _floorplan$floor,_floorplan$building;null!==floorplan&&void 0!==floorplan&&null!==(_floorplan$floor=floorplan.floor)&&void 0!==_floorplan$floor&&_floorplan$floor.id?this.floor=floorplan.floor:this.floor={name:"Floor"},null!==floorplan&&void 0!==floorplan&&null!==(_floorplan$building=floorplan.building)&&void 0!==_floorplan$building&&_floorplan$building.id?this.building=floorplan.building:this.building={name:"Building"}},loadDefaultFloorPlan:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var currentlyAssignedFloor,_this2$formatFloorObj,floorId,indoorFloorPlanId;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.next=2,_this2.getCurrentUserFloor();case 2:currentlyAssignedFloor=_context.sent,_this2$formatFloorObj=_this2.formatFloorObject(currentlyAssignedFloor),floorId=_this2$formatFloorObj.floorId,indoorFloorPlanId=_this2$formatFloorObj.indoorFloorPlanId,indoorFloorPlanId?_this2.$router.push({params:{floorId:floorId,floorplanid:indoorFloorPlanId}}):_this2.getFirstActivePlanFromFloorList();case 5:case"end":return _context.stop()}}),_callee)})))()},formatFloorObject:function(floor){var _floor$data;return{indoorFloorPlanId:null===floor||void 0===floor||null===(_floor$data=floor.data)||void 0===_floor$data?void 0:_floor$data.indoorFloorPlanId,floorId:null===floor||void 0===floor?void 0:floor.id}},fetchFloorDetails:function(floorId){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var _data$floor,_data$floor2,params,_yield$API$post,data;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return params={floorId:floorId},_context2.next=3,api/* API */.bl.post("v2/floor/details",params);case 3:_yield$API$post=_context2.sent,data=_yield$API$post.data,null!==data&&void 0!==data&&null!==(_data$floor=data.floor)&&void 0!==_data$floor&&_data$floor.id&&null!==data&&void 0!==data&&null!==(_data$floor2=data.floor)&&void 0!==_data$floor2&&_data$floor2.indoorFloorPlanId?_this3.$router.push({params:{floorId:data.floor.id,floorplanid:data.floor.indoorFloorPlanId}}):_this3.loadDefaultFloorPlan();case 6:case"end":return _context2.stop()}}),_callee2)})))()},getCurrentUserFloor:function(){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var user,url,params,_yield$API$get,data,error,_data$desks,floor;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return user=_this4.getCurrentUser(),url="v2/servicePortalHome",params={fetchOnlyDesk:!0,count:1,recordId:user.peopleId},_context3.next=5,api/* API */.bl.get(url,params);case 5:if(_yield$API$get=_context3.sent,data=_yield$API$get.data,error=_yield$API$get.error,!error){_context3.next=12;break}_context3.next=14;break;case 12://console.log('floorplanId associated with current user is ',floorPlanId)
return floor=null===data||void 0===data||null===(_data$desks=data.desks)||void 0===_data$desks||null===(_data$desks=_data$desks[0])||void 0===_data$desks?void 0:_data$desks.floor,_context3.abrupt("return",floor);case 14:case"end":return _context3.stop()}}),_callee3)})))()},floorplanSaved:function(indoorfloorplan){var _this5=this;indoorfloorplan&&indoorfloorplan.id&&(this.$router.replace({params:{floorplanid:indoorfloorplan.id}}),this.$nextTick((function(){_this5.openEditor()})))},loadFloorAndBuildingInfo:function(){var _this6=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){var params,_yield$API$get2,data,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:return params={viewName:"all",page:1,perPage:1,moduleName:"floor",filters:JSON.stringify({indoorFloorPlanId:{operatorId:36,value:[String(_this6.floorplanIdFromRoute)]}})},_context4.next=3,api/* API */.bl.get("v2/module/data/list",params);case 3:_yield$API$get2=_context4.sent,data=_yield$API$get2.data,error=_yield$API$get2.error,error?_this6.$message.error("Error loading floor and building info"):(_this6.floor=data.moduleDatas[0],_this6.floor?_this6.building=_this6.floor.building:_this6.building=null);case 7:case"end":return _context4.stop()}}),_callee4)})))()},changeFloorPlan:function(){var _this7=this;this.loading=!0,this.$nextTick((function(){_this7.loading=!1}))},openEditor:function(){this.fpEditor=!0,"ASSIGNMENT"===this.viewerMode&&this.$refs["assignmentView"]&&this.$refs["assignmentView"].removeEventListenerevents&&this.$refs["assignmentView"].removeEventListenerevents()},actions:function(name){"edit"===name?this.openEditor():"new"===name&&(this.newFp=!0)},closeEditor:function(){this.fpEditor=!1,"ASSIGNMENT"===this.viewerMode?this.$refs["assignmentView"]&&(this.$refs["assignmentView"].addEventListenerevents&&this.$refs["assignmentView"].addEventListenerevents(),this.$refs["assignmentView"].init()):"BOOKING"===this.viewerMode&&this.$refs["bookingView"]&&(this.$refs["bookingView"].addEventListenerevents&&this.$refs["bookingView"].addEventListenerevents(),this.$refs["bookingView"].init())},showBuildingFilter:function(props){null!==props&&void 0!==props&&props.disableDialog||(this.filterDialogOpen=!0)},getFirstActivePlanFromFloorList:function(){var _this8=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee5(){var params,_yield$API$get3,data,error,floorPlanIdFromList,floor;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context5){while(1)switch(_context5.prev=_context5.next){case 0:
//get first floor with an  active floor plan
return params={viewName:"all",page:1,perPage:1,moduleName:"floor",filters:JSON.stringify({indoorFloorPlanId:{operatorId:2,value:[]}})},_context5.next=3,api/* API */.bl.get("v2/module/data/list",params);case 3:_yield$API$get3=_context5.sent,data=_yield$API$get3.data,error=_yield$API$get3.error,error?_this8.$error.message("Error loading all floors",error):(floorPlanIdFromList=data.moduleDatas[0].indoorFloorPlanId,floor=data.moduleDatas[0],_this8.$router.push({params:{floorId:floor.id,floorplanid:floorPlanIdFromList}})),_this8.loading=!1;case 8:case"end":return _context5.stop()}}),_callee5)})))()}}},indoorFloorPlan_Layoutvue_type_script_lang_js=Layoutvue_type_script_lang_js,Layout_component=(0,componentNormalizer/* default */.Z)(indoorFloorPlan_Layoutvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,Layout=Layout_component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/26755.js.map