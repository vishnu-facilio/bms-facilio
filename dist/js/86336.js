(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[86336],{
/***/201117:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FLookupFieldWrapper}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/FLookupFieldWrapper.vue?vue&type=template&id=0b196d62
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"lookup-wrapper"},[_vm.fieldObj.field?_c("FLookupField",{class:{"handle-wizard-icon":_vm.handleWizardIcon},attrs:{model:_vm.modelObj,field:_vm.fieldObj,disabled:_vm.disabled,siteId:_vm.siteId,hideLookupIcon:_vm.hideWizard,hideDropDown:_vm.hideDropDown,preHookFilterConstruction:_vm.filterConstruction,fetchOptionsOnLoad:_vm.fetchOptionsOnLoad,fetchOptionsMethod:_vm.fetchOptionsMethod},on:{"update:model":function($event){_vm.modelObj=$event},showLookupWizard:_vm.showLookupWizard,recordSelected:_vm.onRecordSelected}}):_c("el-input"),!_vm.hideWizard&&_vm.canShowLookupWizard?_c("div",[_c("FLookupFieldWizard",{attrs:{canShowLookupWizard:_vm.canShowLookupWizard,selectedLookupField:_vm.fieldObj,siteId:_vm.siteId,withReadings:_vm.withReadings},on:{"update:canShowLookupWizard":function($event){_vm.canShowLookupWizard=$event},"update:can-show-lookup-wizard":function($event){_vm.canShowLookupWizard=$event},setLookupFieldValue:_vm.setLookupFieldValue,showMainFieldSearch:function($event){return _vm.onWizardShow(!1)}}})],1):_vm._e()],1)},staticRenderFns=[],slicedToArray=__webpack_require__(554621),FLookupField=(__webpack_require__(879288),__webpack_require__(260228),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(450886),__webpack_require__(947522),__webpack_require__(670560),__webpack_require__(425728),__webpack_require__(434284),__webpack_require__(634338),__webpack_require__(891719),__webpack_require__(855048)),validation=__webpack_require__(990260),FLookupFieldWrappervue_type_script_lang_js={name:"f-lookup-field-wrapper",props:{value:[Number,String,Array],label:String,
// Label of selected value if any
formField:Object,field:Object,
// Pass field object if form field not available and field avaialble
moduleName:String,
// Pass module name and field name if field object not avaialble
fieldName:String,disabled:{type:Boolean,default:!1},siteId:Number,hideWizard:{type:Boolean,default:!1},hideDropDown:{type:Boolean,default:!1},fetchOptionsOnLoad:{type:Boolean,default:!0},fetchOptionsMethod:{type:Function},withReadings:Boolean,handleWizardIcon:{
// To handle wizard icon css
type:Boolean,default:!0},filterConstruction:{type:Function,default:function(field){return field.filters}}},components:{FLookupField:FLookupField/* default */.Z,FLookupFieldWizard:function(){return Promise.all(/* import() */[__webpack_require__.e(93208),__webpack_require__.e(50232),__webpack_require__.e(93765),__webpack_require__.e(95953),__webpack_require__.e(35309),__webpack_require__.e(18778),__webpack_require__.e(12303),__webpack_require__.e(84290),__webpack_require__.e(31721),__webpack_require__.e(64418),__webpack_require__.e(5603),__webpack_require__.e(57432),__webpack_require__.e(435),__webpack_require__.e(72230),__webpack_require__.e(94255),__webpack_require__.e(67683),__webpack_require__.e(44178),__webpack_require__.e(91132),__webpack_require__.e(20280),__webpack_require__.e(78256),__webpack_require__.e(22200),__webpack_require__.e(49081),__webpack_require__.e(89472),__webpack_require__.e(12085),__webpack_require__.e(55754),__webpack_require__.e(86494),__webpack_require__.e(3037),__webpack_require__.e(49908),__webpack_require__.e(22061),__webpack_require__.e(31602),__webpack_require__.e(73609),__webpack_require__.e(99751),__webpack_require__.e(42054)]).then(__webpack_require__.bind(__webpack_require__,499751))}},data:function(){return{fieldObj:{isDataLoading:!1,options:[],lookupModuleName:"",field:null,filters:{},isDisabled:!1},canShowLookupWizard:!1}},computed:{modelObj:{get:function(){return(0,validation/* isEmpty */.xb)(this.value)?this.value:(0,validation/* isArray */.kJ)(this.value)?this.value.map((function(val){return parseInt(val)})):parseInt(this.value)},set:function(value){this.$emit("input",value)}}},created:function(){this.handleDefaultOption()},mounted:function(){var formField=this.formField,field=this.field;(0,validation/* isEmpty */.xb)(formField)?(0,validation/* isEmpty */.xb)(field)?this.fetchField():this.setField(field):this.fieldObj=formField},watch:{canShowLookupWizard:function(value){value||this.onWizardShow(value)}},methods:{showLookupWizard:function(field,canShow){this.fieldObj=field,this.canShowLookupWizard=canShow,this.onWizardShow(!0)},setLookupFieldValue:function(props){var _this=this,field=props.field,_ref=field||{},multiple=_ref.multiple,selectedItems=_ref.selectedItems;if(multiple){var valueArr=[];selectedItems.forEach((function(item){var value=item.value,label=item.label;_this.addOption(value,label),valueArr.push(value)})),this.modelObj=valueArr,this.onRecordSelected(selectedItems,valueArr)}else{var _ref2=selectedItems||[],_ref3=(0,slicedToArray/* default */.Z)(_ref2,1),selectedItem=_ref3[0],value=selectedItem.value,label=selectedItem.label;this.addOption(value,label),this.modelObj=value,this.onRecordSelected(selectedItem)}this.onWizardShow(!1)},onWizardShow:function(show){this.$emit("showingLookupWizard",show)},fetchField:function(){var _this2=this,moduleName=this.moduleName,fieldName=this.fieldName;this.$util.loadModuleMeta(moduleName).then((function(meta){var field=meta.fields.find((function(field){return field.name===fieldName}));_this2.setField(field)}))},onRecordSelected:function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];this.$emit.apply(this,["recordSelected"].concat(args))},handleDefaultOption:function(){var label=this.label,value=this.value;(0,validation/* isEmpty */.xb)(label)||(0,validation/* isEmpty */.xb)(value)||this.addOption(value,label)},setField:function(field){var fieldObj=this.fieldObj;fieldObj.field=field,fieldObj.multiple=field.multiple,fieldObj.lookupModuleName=field.lookupModule.name,(0,validation/* isArray */.kJ)(this.modelObj)?fieldObj.selectedItems=this.modelObj.map((function(id){return{value:id}})):fieldObj.selectedItems={value:this.modelObj}},addOption:function(id,label){var fieldObj=this.fieldObj,options=fieldObj.options,newOptionObj={label:label,value:id};(0,validation/* isEmpty */.xb)(options)?options.push(newOptionObj):options.some((function(option){return option.value===id}))||options.unshift(newOptionObj),this.$set(this.fieldObj,"options",options)}}},components_FLookupFieldWrappervue_type_script_lang_js=FLookupFieldWrappervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FLookupFieldWrappervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FLookupFieldWrapper=component.exports},
/***/855048:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FLookupField}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/forms/FLookupField.vue?vue&type=template&id=473d4b8e
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.isFieldLoading?_c("FieldLoader",{attrs:{isLoading:_vm.isFieldLoading}}):_c("div",{staticClass:"f-lookup-chooser f-lookup-chooser-container"},[_c("el-select",{ref:"selectBox",class:["fc-input-full-border-select2 width100",(!_vm.canHideLookupIcon||_vm.canShowQuickCreateIcon)&&"resource-search",_vm.isMultiple&&"fc-tag",_vm.hideDropDown&&!_vm.disabled&&"skip-disable"],attrs:{"collapse-tags":"",remote:_vm.isRemote,filterable:"",clearable:_vm.canHideLookupIcon,multiple:_vm.isMultiple,popperAppendToBody:_vm.popperAppendToBody,"remote-method":function(searchText){return _vm.remoteMethod(searchText)},loading:_vm.field.isDataLoading,"loading-text":_vm.$t("common._common.searching"),disabled:_vm.disabled||_vm.hideDropDown,placeholder:_vm.field.placeHolderText||"Select"},on:{change:_vm.recordSelected},model:{value:_vm.modelObj,callback:function($$v){_vm.modelObj=$$v},expression:"modelObj"}},[_c("div",{staticClass:"flRight d-flex",class:!_vm.disabled&&"pointer",attrs:{slot:"prefix"},slot:"prefix"},[_vm.canShowSystemClear?_c("div",{staticClass:"flookup-remove-icon-alignment flookup-remove-icon",on:{click:_vm.clearData}},[_c("i",{staticClass:"el-icon-circle-close pointer fc-lookup-icon f13"})]):_vm._e(),_vm.canHideLookupIcon?_vm._e():_c("div",{staticClass:"icon-class-alignment",on:{click:function($event){return $event.stopPropagation(),_vm.openLookupFieldWizard(_vm.field)}}},[_c("inline-svg",{attrs:{src:"lookup",iconClass:"icon icon-sm-md fc-lookup-icon"}})],1),_vm.canShowQuickCreateIcon?_c("div",{staticClass:"icon-class-alignment",on:{click:function($event){return $event.stopPropagation(),_vm.openQuickCreate()}}},[_c("el-tooltip",{attrs:{effect:"dark",content:"Add\n          "+_vm.moduleDisplayName,placement:"top"}},[_c("inline-svg",{attrs:{src:"add-pink",iconClass:"icon icon-sm-md fc-lookup-icon"}})],1)],1):_vm._e()]),_vm._l(_vm.field.options,(function(option,index){return _c("el-option",{key:option.value+" "+index,staticClass:"fc-input-full-border-select2 width100",attrs:{label:option.label,value:option.value}},[_c("span",{staticClass:"fL"},[_vm._v(_vm._s(option.label))]),_vm.$validation.isEmpty(option.secondaryLabel)?_vm._e():_c("span",{staticClass:"select-float-right-text13"},[_vm._v(_vm._s(option.secondaryLabel))]),_vm.getIsSiteDecommissioned(option)?_c("span",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"select-float-right-text13 pL10",attrs:{title:_vm.$t("setup.decommission.decommissioned")}},[_c("fc-icon",{staticClass:"fR pT10",attrs:{group:"alert",name:"decommissioning",size:"16"}})],1):_vm._e()])}))],2),_vm.showQuickCreateData?_c("QuickCreateData",{attrs:{canShowDialog:_vm.showQuickCreateData,quickCreateField:_vm.field,setAddedRecord:_vm.setAddedRecord},on:{"update:canShowDialog":function($event){_vm.showQuickCreateData=$event},"update:can-show-dialog":function($event){_vm.showQuickCreateData=$event}}}):_vm._e()],1)},staticRenderFns=[],objectSpread2=__webpack_require__(595082),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),toConsumableArray=__webpack_require__(488478),validation=(__webpack_require__(879288),__webpack_require__(260228),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(434284),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(450886),__webpack_require__(538077),__webpack_require__(425728),__webpack_require__(634338),__webpack_require__(990260)),constant=__webpack_require__(354754),picklist=__webpack_require__(961358),field_utils=__webpack_require__(455344),FieldLoader=__webpack_require__(62979),isEqual=__webpack_require__(618446),isEqual_default=__webpack_require__.n(isEqual),LOOKUP_FIELD_PLACEHOLDER_MAP={people:{value:"${LOGGED_PEOPLE}",label:"Current User"},users:{value:"${LOGGED_USER}",label:"Current User"}},FLookupFieldvue_type_script_lang_js={name:"f-lookup-field",props:{model:{},field:{type:Object},disabled:{type:Boolean},siteId:{type:[Number,String]},categoryId:{type:Number},hideLookupIcon:{type:Boolean,default:!1},popperAppendToBody:{required:!1,type:Boolean,default:!0},fetchOptionsOnLoad:{type:Boolean,default:!0},fetchOptionsMethod:{type:Function},preHookFilterConstruction:{type:Function,default:function(field){return field.filters}},hideDropDown:{type:Boolean,default:!1},skipLoading:{type:Boolean,default:!1},isClearable:{type:Boolean,default:!0},userfilmoduleEnum:{type:String},parentModuleId:{type:Number},selectedOptions:{type:Array}},components:{FieldLoader:FieldLoader/* default */.Z,QuickCreateData:function(){return Promise.all(/* import() */[__webpack_require__.e(93208),__webpack_require__.e(50232),__webpack_require__.e(93765),__webpack_require__.e(95953),__webpack_require__.e(35309),__webpack_require__.e(18778),__webpack_require__.e(12303),__webpack_require__.e(84290),__webpack_require__.e(31721),__webpack_require__.e(64418),__webpack_require__.e(5603),__webpack_require__.e(57432),__webpack_require__.e(435),__webpack_require__.e(72230),__webpack_require__.e(94255),__webpack_require__.e(67683),__webpack_require__.e(44178),__webpack_require__.e(91132),__webpack_require__.e(20280),__webpack_require__.e(78256),__webpack_require__.e(22200),__webpack_require__.e(49081),__webpack_require__.e(89472),__webpack_require__.e(12085),__webpack_require__.e(55754),__webpack_require__.e(86494),__webpack_require__.e(3037),__webpack_require__.e(49908),__webpack_require__.e(22061),__webpack_require__.e(31602),__webpack_require__.e(73609),__webpack_require__.e(41323),__webpack_require__.e(99751),__webpack_require__.e(11305),__webpack_require__.e(80390),__webpack_require__.e(89142),__webpack_require__.e(97770),__webpack_require__.e(76422),__webpack_require__.e(99813)]).then(__webpack_require__.bind(__webpack_require__,676433))}},data:function(){return{localSearch:!1,isLoadedOnce:!1,currentModelValue:!1,showQuickCreateData:!1}},computed:{customOptions:function(){var _ref=this||{},field=_ref.field,_ref2=field||{},lookupModule=_ref2.lookupModule;if((0,validation/* isEmpty */.xb)(lookupModule))return[];var _ref3=lookupModule||{},name=_ref3.name;return(0,validation/* isEmpty */.xb)(LOOKUP_FIELD_PLACEHOLDER_MAP[name])?[]:[LOOKUP_FIELD_PLACEHOLDER_MAP[name]]},modelObj:{get:function(){return this.model},set:function(value){this.currentModelValue=value,this.$emit("update:model",value)}},moduleDisplayName:function(){var field=this.field,_ref4=field.field||{},lookupModule=_ref4.lookupModule,_ref5=lookupModule||{},displayName=_ref5.displayName;return displayName},isFieldLoading:function(){var field=this.field,defaultIds=this.defaultIds,skipLoading=this.skipLoading,isLoadedOnce=this.isLoadedOnce;return!skipLoading&&!isLoadedOnce&&!(0,validation/* isEmpty */.xb)(defaultIds)&&field.isDataLoading},isPickListTypeModule:function(){var field=this.field,fieldObj=field.field,_ref6=fieldObj||field,lookupModule=_ref6.lookupModule,_ref7=lookupModule||{},type=_ref7.type;
// type 1 is for base entity modules
return!!type&&1!==type},isRemote:function(){var localSearch=this.localSearch;return!localSearch},canHideLookupIcon:function(){var hideLookupIcon=this.hideLookupIcon,isPickListTypeModule=this.isPickListTypeModule,hideDropDown=this.hideDropDown,field=this.field,userfilmoduleEnum=this.userfilmoduleEnum,_ref8=field||{},config=_ref8.config,canHide=!1;if(!(0,validation/* isEmpty */.xb)(config)){var canShowLookupWizard=this.$getProperty(config,"canShowLookupWizard",null);(0,validation/* isNull */.Ft)(canShowLookupWizard)||(canHide=!canShowLookupWizard)}return!hideDropDown&&("PICK_LIST"===userfilmoduleEnum||(canHide||hideLookupIcon||isPickListTypeModule))},canShowQuickCreateIcon:function(){var disabled=this.disabled,field=this.field,_ref9=field||{},config=_ref9.config,canShow=!1;return(0,validation/* isEmpty */.xb)(config)||(canShow=this.$getProperty(config,"canShowQuickCreate")),disabled&&(canShow=!1),canShow},isSiteEnabled:function(){var siteId=Number(this.$cookie.get("fc.currentSite")),currentSiteId=siteId>0?siteId:-1;return!(0,validation/* isEmpty */.xb)(currentSiteId)},isMultiple:function(){var field=this.field;return!!field.multiple},resourceModuleName:function(){var field=this.field,config=field.config,lookupModuleName=field.lookupModuleName,_ref10=config||{},isFiltersEnabled=_ref10.isFiltersEnabled,filterValue=_ref10.filterValue;if(isFiltersEnabled&&constant/* default */.Z.LOOKUP_FILTER_ENABLED_FIELDS.includes(lookupModuleName)){var moduleName=constant/* default */.Z.LOOKUP_FILTERS_MAP[filterValue];return moduleName}return null},isResourceField:function(){var field=this.field,name=field.name,isResourceField=(0,field_utils/* isChooserTypeField */.Rq)(field)||"resource"===name;return isResourceField},
// To prefill the existing values, we have to send default ids in picklist api
defaultIds:function(){var modelObj=this.modelObj,selectedOptions=this.selectedOptions,isPlaceHoldersEnabled=constant/* default */.Z.FIELD_PLACEHOLDERS.includes(modelObj)||!1,defaultIds=[],selectedOptionsArr=(selectedOptions||[]).map((function(option){return parseInt(option)}));return(0,validation/* isEmpty */.xb)(selectedOptions)?(0,validation/* isEmpty */.xb)(modelObj)||isPlaceHoldersEnabled||(defaultIds=(0,validation/* isArray */.kJ)(modelObj)?(0,toConsumableArray/* default */.Z)(modelObj):[modelObj]):defaultIds=(0,toConsumableArray/* default */.Z)(selectedOptionsArr),defaultIds=defaultIds.filter((function(val){return!constant/* default */.Z.FIELD_PLACEHOLDERS.includes(val)})),defaultIds},operatorLookupModule:function(){var field=this.field,_ref11=field||{},operatorLookupModule=_ref11.operatorLookupModule;return operatorLookupModule||{}},skipSiteFilter:function(){var field=this.field,_ref12=field||{},config=_ref12.config,_ref13=config||{},_ref13$skipSiteFilter=_ref13.skipSiteFilter,skipSiteFilter=void 0!==_ref13$skipSiteFilter&&_ref13$skipSiteFilter;return skipSiteFilter},canShowSystemClear:function(){var canHideLookupIcon=this.canHideLookupIcon,isClearable=this.isClearable,modelObj=this.modelObj,disabled=this.disabled;return!canHideLookupIcon&&!disabled&&(isClearable&&!(0,validation/* isEmpty */.xb)(modelObj))}},watch:{model:function(newVal){var _this=this,currentModelValue=this.currentModelValue,isRemote=this.isRemote;isEqual_default()(newVal,currentModelValue)||(isRemote&&this.getOptions({initialFetch:!0}).then((function(options){_this.$set(_this.field,"options",options)})),this.$set(this,"modelObj",newVal))},siteId:{handler:function(newVal,oldVal){var _this2=this,isSiteEnabled=this.isSiteEnabled,skipSiteFilter=this.skipSiteFilter;skipSiteFilter||isSiteEnabled||newVal===oldVal||this.getOptions({initialFetch:!0}).then((function(options){_this2.$set(_this2.field,"options",options)}))}},parentModuleId:{handler:function(newVal,oldVal){var _this3=this;newVal!==oldVal&&this.getOptions({initialFetch:!0}).then((function(options){_this3.$set(_this3.field,"options",options)}))}},operatorLookupModule:{handler:function(newVal,oldVal){var _this4=this;isEqual_default()(newVal,oldVal)||this.getOptions({initialFetch:!0}).then((function(options){_this4.$set(_this4.field,"options",options)}))}},"field.clientCriteria":{handler:function(newVal,oldVal){var _this5=this;isEqual_default()(newVal,oldVal)||this.getOptions({initialFetch:!0}).then((function(options){_this5.$set(_this5.field,"options",options)}))}},categoryId:{handler:function(newVal,oldVal){var _this6=this;isEqual_default()(newVal,oldVal)||this.getOptions({initialFetch:!0}).then((function(options){_this6.$set(_this6.field,"options",options)}))}},"field.options":{handler:function(value){var modelObj=this.modelObj;if(!(0,validation/* isEmpty */.xb)(value))if((0,validation/* isEmpty */.xb)(modelObj))this.field.selectedItems=[];else if((0,validation/* isArray */.kJ)(modelObj)){var selectedItems=value.filter((function(option){return modelObj.includes(option.value)}));this.field.selectedItems=selectedItems}else{var selectedItem=value.find((function(option){return option.value===modelObj}));this.field.selectedItems=[selectedItem]}},immediate:!0},isLoadedOnce:{handler:function(value){value&&this.$emit("optionsLoadedOnce")}}},created:function(){var _this7=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var fetchOptionsOnLoad,field,modelObj,customOptions,options;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:
// Have to skip fetching options initially, when module is 'resource' and filters is not enabled
if(fetchOptionsOnLoad=_this7.fetchOptionsOnLoad,field=_this7.field,modelObj=_this7.modelObj,customOptions=_this7.customOptions,_this7.currentModelValue=modelObj,_this7.getIsSiteDecommissioned=picklist/* getIsSiteDecommissioned */.Yx,!fetchOptionsOnLoad){_context2.next=12;break}return _context2.next=6,_this7.getOptions({initialFetch:!0});case 6:if(_context2.t0=_context2.sent,_context2.t0){_context2.next=9;break}_context2.t0=[];case 9:options=_context2.t0,_this7.$set(_this7.field,"options",[].concat((0,toConsumableArray/* default */.Z)(customOptions),(0,toConsumableArray/* default */.Z)(options))),_this7.$set(_this7,"isLoadedOnce",!0);case 12:_this7.remoteMethod=_this7.$helpers.debounce(function(){var _ref14=(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(searchText){var isDataLoading,_options;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(isDataLoading=field.isDataLoading,isDataLoading){_context.next=6;break}return _context.next=4,_this7.getOptions({searchText:searchText});case 4:_options=_context.sent,_this7.$set(_this7.field,"options",_options);case 6:case"end":return _context.stop()}}),_callee)})));return function(_x){return _ref14.apply(this,arguments)}}(),1e3);case 13:case"end":return _context2.stop()}}),_callee2)})))()},methods:{focus:function(){(0,validation/* isEmpty */.xb)(this.$refs["selectBox"])||this.$refs["selectBox"].focus()},getOptions:function(params){var _this8=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var searchText,initialFetch,fetchOptionsMethod,field,siteId,categoryId,isRemote,defaultIds,resourceModuleName,isResourceField,skipSiteFilter,selectedOptions,_field$filters,fieldFilters,options,filters,props,perPageCount,_yield$_this8$fetchOp,_yield$_this8$fetchOp2,optionsArr,error,_ref15,message,_yield$getFieldOption,_yield$getFieldOption2,_optionsArr,_error,meta,_ref16,_message,_meta$localSearch,localSearch;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:
/*
                Have to return empty options if field is of resourcetype, if filters havent be enabled
                and if no values selected already
              */
if(searchText=params.searchText,initialFetch=params.initialFetch,fetchOptionsMethod=_this8.fetchOptionsMethod,field=_this8.field,siteId=_this8.siteId,categoryId=_this8.categoryId,isRemote=_this8.isRemote,defaultIds=_this8.defaultIds,resourceModuleName=_this8.resourceModuleName,isResourceField=_this8.isResourceField,skipSiteFilter=_this8.skipSiteFilter,selectedOptions=_this8.selectedOptions,_field$filters=field.filters,fieldFilters=void 0===_field$filters?{}:_field$filters,options=[],(0,validation/* isEmpty */.xb)(resourceModuleName)||(field.resourceLookupModuleName=resourceModuleName),filters=_this8.preHookFilterConstruction(field),(0,validation/* isEmpty */.xb)(filters)||(field.filters=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},fieldFilters),filters)),(0,validation/* isEmpty */.xb)(categoryId)||(field.filters=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},field.filters),{},{category:{operator:"is",value:["".concat(categoryId)]}})),props={field:field,searchText:searchText},skipSiteFilter||(props=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},props),{},{siteId:siteId})),!(isResourceField&&(0,validation/* isEmpty */.xb)(resourceModuleName)&&(0,validation/* isEmpty */.xb)(defaultIds))){_context3.next=12;break}return _context3.abrupt("return",options);case 12:if(initialFetch&&isRemote&&(perPageCount=defaultIds.length>50?defaultIds.length:50,props=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},props),{},{page:1,perPage:perPageCount,defaultIds:defaultIds}),((0,validation/* isEmpty */.xb)(resourceModuleName)&&isResourceField||!(0,validation/* isEmpty */.xb)(selectedOptions))&&(
// Have to fetch only selected values, which is same as the number of defaultids
props=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},props),{},{perPage:defaultIds.length}))),_this8.$set(field,"isDataLoading",!0),(0,validation/* isEmpty */.xb)(fetchOptionsMethod)){_context3.next=25;break}return _context3.next=17,_this8.fetchOptionsMethod(props);case 17:_yield$_this8$fetchOp=_context3.sent,_yield$_this8$fetchOp2=_yield$_this8$fetchOp.options,optionsArr=void 0===_yield$_this8$fetchOp2?[]:_yield$_this8$fetchOp2,error=_yield$_this8$fetchOp.error,error&&(_ref15=error||{},message=_ref15.message,_this8.$message.error(message||"Error Occured")),options=optionsArr,_context3.next=35;break;case 25:return _context3.next=27,(0,picklist/* getFieldOptions */._K)(props);case 27:_yield$getFieldOption=_context3.sent,_yield$getFieldOption2=_yield$getFieldOption.options,_optionsArr=void 0===_yield$getFieldOption2?[]:_yield$getFieldOption2,_error=_yield$getFieldOption.error,meta=_yield$getFieldOption.meta,_error&&(_ref16=_error||{},_message=_ref16.message,_this8.$message.error(_message||"Error Occured")),meta&&(0,validation/* isEmpty */.xb)(searchText)&&(_meta$localSearch=meta.localSearch,localSearch=void 0!==_meta$localSearch&&_meta$localSearch,_this8.$set(_this8,"localSearch",localSearch)),options=_optionsArr;case 35:return _this8.$set(field,"isDataLoading",!1),_context3.abrupt("return",options);case 37:case"end":return _context3.stop()}}),_callee3)})))()},clearData:function(){this.$emit("update:model",""),this.recordSelected("")},recordSelected:function(value){var field=this.field,_this$field$options=this.field.options,options=void 0===_this$field$options?[]:_this$field$options,isMultiple=this.isMultiple,selectedValues=null;isMultiple?(selectedValues=options.filter((function(e){return(value||[]).includes(e.value)})),field.selectedItems=selectedValues):(selectedValues=options.find((function(e){return e.value==value}))||{},field.selectedItems=[],(0,validation/* isEmpty */.xb)(selectedValues)||(field.selectedItems=[selectedValues])),this.$emit("recordSelected",selectedValues,field)},openLookupFieldWizard:function(field){var disabled=this.disabled;disabled||this.$emit("showLookupWizard",field,!0)},openQuickCreate:function(){var disabled=this.disabled;disabled||(this.showQuickCreateData=!0)},setAddedRecord:function(props){var record=props.record,_ref17=record||{},id=_ref17.id,name=record.displayName||record.name||record.subject,field=this.field;field.selectedItems=[{value:id,label:name}],this.$emit("setLookupFieldValue",{field:(0,objectSpread2/* default */.Z)({},field)})}}},forms_FLookupFieldvue_type_script_lang_js=FLookupFieldvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(forms_FLookupFieldvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FLookupField=component.exports},
/***/62979:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FieldLoader}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/forms/FieldLoader.vue?vue&type=template&id=7252e23e
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.isLoading?_c("div",{staticClass:"field-loading loading-shimmer"}):_vm._e()},staticRenderFns=[],FieldLoadervue_type_script_lang_js={props:{isLoading:{type:Boolean,required:!0}}},forms_FieldLoadervue_type_script_lang_js=FieldLoadervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(forms_FieldLoadervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FieldLoader=component.exports},
/***/929593:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FPagination}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/list/FPagination.vue?vue&type=template&id=7641710c&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_vm.total>0?_c("div",{staticClass:"flex-center-row-space mT-5",class:{"fc-black-small-txt-12":!_vm.hideToggle}},[_c("el-popover",{attrs:{placement:"bottom",trigger:"click",disabled:_vm.disablePopup}},[_c("span",{staticClass:"p8 pointer",class:[!_vm.disablePopup&&"button-hover"],attrs:{slot:"reference"},slot:"reference"},[_vm.from!==_vm.to?_c("span",[_vm._v(_vm._s(_vm.from)+" - ")]):_vm._e(),_c("span",[_vm._v(_vm._s(_vm.to))]),_vm._v(" of "+_vm._s(_vm.total)+" ")]),_c("el-pagination",{attrs:{layout:"prev, pager, next",total:_vm.total,"pager-count":5,"page-size":_vm.perPage,"current-page":_vm.page},on:{"current-change":_vm.handleCurrentChange,"update:pageSize":function($event){_vm.perPage=$event},"update:page-size":function($event){_vm.perPage=$event},"update:currentPage":function($event){_vm.page=$event},"update:current-page":function($event){_vm.page=$event}}})],1),_vm.hideToggle?_vm._e():_c("span",[_c("span",{staticClass:"el-icon-arrow-left pagination-arrow fc-black-small-txt-12 f16 fw-bold pointer p5",class:{disable:_vm.from<=1},on:{click:function($event){_vm.from>1&&_vm.prev()}}}),_c("span",{staticClass:"el-icon-arrow-right pagination-arrow fc-black-small-txt-12 f16 fw-bold pointer p5",class:{disable:_vm.to===_vm.total},on:{click:function($event){_vm.to!==_vm.total&&_vm.next()}}})])],1):_vm._e()])},staticRenderFns=[],router=(__webpack_require__(879288),__webpack_require__(670560),__webpack_require__(329435)),FPaginationvue_type_script_lang_js={props:{total:[Number,String],perPage:Number,hideToggle:{type:Boolean,default:!1},pageNo:Number,hidePopover:{type:Boolean,default:!1}},data:function(){return{from:0,to:0,page:1}},created:function(){(0,router/* isWebTabsEnabled */.tj)()&&document.addEventListener("keydown",this.keyDownHandler)},mounted:function(){this.init()},beforeDestroy:function(){(0,router/* isWebTabsEnabled */.tj)()&&document.removeEventListener("keydown",this.keyDownHandler)},computed:{pageQuery:function(){var _ref=this.$route||{},query=_ref.query,_ref2=query||{},page=_ref2.page;return parseInt(page)||1},hasMorePage:function(){return this.total/this.perPage>1},disablePopup:function(){return this.hidePopover||!this.hasMorePage}},watch:{total:function(){this.init()},pageQuery:function(){this.init()}},methods:{init:function(){if(this.page=this.pageQuery,this.from=(this.page-1)*this.perPage+1,this.from>this.total&&this.from&&this.from>0&&this.total&&this.total>0)this.reset();else{var to=this.from+this.perPage-1;this.to=this.total>to?to:this.total}},handleCurrentChange:function(val){this.page=val,this.from=(this.page-1)*this.perPage+1,this.to=this.total>=this.from+this.perPage?this.from+this.perPage-1:this.total,this.setPage()},next:function(){this.from=this.to+1,this.to+=this.perPage,this.to>this.total&&(this.to=this.total),this.page++,this.setPage()},prev:function(){this.to=this.from-1,this.from-=this.perPage,this.from<=1?this.from=this.page=1:this.page--,this.setPage()},reset:function(){this.page=1,this.setPage(!0)},setPage:function(isReset){if(this.pageNo)this.$emit("onPageChanged",this.page);else{var query={};Object.assign(query,this.$route.query),query?query.page=this.page:query={page:this.page},this.$router.push({query:query}),isReset||this.$emit("onPageChanged",this.page)}},keyDownHandler:function(e){e.shiftKey&&("ArrowRight"===e.key&&this.to!==this.total?this.next():"ArrowLeft"===e.key&&this.from>1&&this.prev())}}},list_FPaginationvue_type_script_lang_js=FPaginationvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(list_FPaginationvue_type_script_lang_js,render,staticRenderFns,!1,null,"7641710c",null)
/* harmony default export */,FPagination=component.exports},
/***/481582:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return AddPlannedInventory}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/workorder/jobplan/plannedInventory/AddPlannedInventory.vue?vue&type=template&id=bb6707b4&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{attrs:{visible:!0,fullscreen:!1,"before-close":_vm.onClose,open:"top","custom-class":"fc-dialog-up Inventoryaddvaluedialog","append-to-body":!0,width:"55%"}},[_c("div",[_c("div",{staticClass:"new-header-container pL30"},[_c("div",{staticClass:"fc-setup-modal-title"},[_vm._v(" "+_vm._s(_vm.getTitle)+" ")])]),_vm.inventoryList.length?_c("div",{staticClass:"new-header-container popup-container"},[_c("div",{staticClass:"search-container"},[_c("el-input",{staticClass:"el-input-textbox-full-border",attrs:{autofocus:!0,type:"text",placeholder:_vm.$t("common._common.search")},on:{change:_vm.loadInventory},model:{value:_vm.inventorySearchQuerry,callback:function($$v){_vm.inventorySearchQuerry=$$v},expression:"inventorySearchQuerry"}},[_c("span",{staticClass:"sub-divider"},[_vm._v("|")]),_c("i",{staticClass:"el-input__icon el-icon-search pointer search-text",attrs:{slot:"suffix"},slot:"suffix"})])],1),_c("div",{staticClass:"pagination"},[_vm.newItemPartToggle?_c("pagination",{attrs:{total:_vm.listCount,perPage:20,hidePopover:!0},on:{onPageChanged:_vm.onPageChange}}):_vm._e()],1)]):_vm._e(),_c("div",{staticClass:"fc-inv-container-body"},[_vm.inventoryListLoading?_c("table",{staticClass:"width100"},[_c("tr",[_c("td",{attrs:{colspan:"100%"}},[_c("div",{staticClass:"iTloading in-no-data"},[_c("spinner",{attrs:{show:!0,size:"80"}})],1)])])]):_c("table",{staticClass:"setting-list-view-table width100 invent-table-dialog inventor-store-adde-table"},[_vm.inventoryList.length?_c("tbody",[_vm._l(_vm.inventoryList,(function(inventory,index){return _c("tr",{key:inventory.id,staticClass:"tablerow asset-hover-td height100px"},[_c("td",{staticClass:"width80"},[_c("div",[_vm._v(_vm._s(_vm.$getProperty(inventory,"name")))]),_c("div",{staticClass:"item-description",class:_vm.getSubjectClassname(inventory,index)},[_vm._v(" "+_vm._s(_vm.$getProperty(inventory,"description"))+" ")]),_c("div",{staticClass:"flex flex-direction-row pT6"},[_vm.canShowMore(inventory)?_c("a",{staticClass:"text-capitalize letter-spacing0_3 f13 pR8 pointer",on:{click:function($event){return _vm.toggleVisibility(index)}}},[_vm._v(_vm._s(_vm.showMoreLinkText(index)))]):_vm._e()])]),_c("td",{staticClass:"width160px text-align-inventory"},[0===inventory.addedQuantity?[_c("el-button",{staticClass:"f-number-input",attrs:{size:"mini"},on:{click:function($event){return _vm.inventoryAdd(inventory)}}},[_vm._v(_vm._s(_vm.$t("common._common._add")))])]:[_c("el-input-number",{staticClass:"f-number-input",attrs:{size:"mini",min:0,max:inventory.quantity},on:{change:function($event){return _vm.check(inventory,index)}},model:{value:inventory.addedQuantity,callback:function($$v){_vm.$set(inventory,"addedQuantity",$$v)},expression:"inventory.addedQuantity"}})]],2)])}))],2):_c("tbody",[_c("tr",[_c("td",{attrs:{colspan:"100%"}},[_c("div",{staticClass:"flex-middle justify-content-center flex-direction-column"},[_c("inline-svg",{attrs:{src:"svgs/emptystate/inventory",iconClass:"icon text-center icon-100"}}),_c("div",{staticClass:"nowo-label"},[_vm._v(" "+_vm._s(_vm.getEmptyMessage)+" ")])],1)])])])])]),_c("div",{staticClass:"modal-dialog-footer-parts-dialog"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){return _vm.cancel()}}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",staticStyle:{"margin-left":"0px !important"},attrs:{type:"primary"},on:{click:function($event){return _vm.addPlannedItems()}}},[_vm._v(_vm._s(_vm.$t("common._common._add")))])],1)])])},staticRenderFns=[],createForOfIteratorHelper=__webpack_require__(566347),regeneratorRuntime=__webpack_require__(150124),defineProperty=__webpack_require__(482482),asyncToGenerator=__webpack_require__(548534),api=(__webpack_require__(976801),__webpack_require__(450886),__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(648324),__webpack_require__(564043),__webpack_require__(709873),__webpack_require__(670560),__webpack_require__(162506),__webpack_require__(32284)),validation=__webpack_require__(990260),filters=__webpack_require__(638203),InventoryPagination=__webpack_require__(926460),eventBus=__webpack_require__(398011),AddPlannedInventoryvue_type_script_lang_js={name:"AddPlannedInventory",props:["onClose","jobPlanId","moduleName","workOrderId"],components:{Pagination:InventoryPagination/* default */.Z},data:function(){return{selectedIndex:[],selectedInventory:null,inventoryList:[],newItemPartToggle:!0,inventorySearchQuerry:null,listCount:null,page:1,searchPage:1,inventoryListLoading:!1}},created:function(){this.loadInventory()},computed:{getTitle:function(){return["jobPlanItems","workOrderPlannedItems"].includes(this.moduleName)?this.$t("common.products.items_list"):this.$t("common.products.tools_list")},getEmptyMessage:function(){return["jobPlanItems","workOrderPlannedItems"].includes(this.moduleName)?this.$t("common.products.no_item_present"):this.$t("common.products.no_tools_present")}},methods:{check:function(inventory,index){0===inventory.addedQuantity&&((0,validation/* isEmpty */.xb)(this.$getProperty(this.inventoryList,"".concat(index,".checked")))||(this.inventoryList[index].checked=!0))},cancel:function(){this.onClose(),this.newItemPartToggle=!1},inventoryAdd:function(inventory){inventory.addedQuantity=1,inventory.checked=!0},onPageChange:function(pageNo){var inventorySearchQuerry=this.inventorySearchQuerry;this.page=pageNo,(0,validation/* isEmpty */.xb)(inventorySearchQuerry)||(this.searchPage=pageNo),this.loadInventory()},addPlannedItems:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var inventoryToBeAdded,moduleName,url,params,_yield$API$post,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(inventoryToBeAdded=_this.inventoryList.filter((function(inventory){return!0===inventory.checked})).map((function(inventory){var paramObj={quantity:inventory.addedQuantity};return["jobPlanItems","jobPlanTools"].includes(_this.moduleName)?paramObj["jobPlan"]={id:_this.jobPlanId}:paramObj["workOrder"]={id:_this.workOrderId},["jobPlanItems","workOrderPlannedItems"].includes(_this.moduleName)?paramObj["itemType"]={id:inventory.id}:["jobPlanTools","workOrderPlannedTools"].includes(_this.moduleName)&&(paramObj["toolType"]={id:inventory.id},paramObj["duration"]=1),paramObj})),!(inventoryToBeAdded.length>0)){_context.next=12;break}return moduleName=_this.moduleName,url="v3/modules/bulkCreate/".concat(moduleName),params={data:(0,defineProperty/* default */.Z)({},_this.moduleName,inventoryToBeAdded),moduleName:"".concat(_this.moduleName)},_context.next=7,api/* API */.bl.post(url,params);case 7:_yield$API$post=_context.sent,error=_yield$API$post.error,error?_this.$message.error(error.message||_this.$t("common._common.error_adding_inventory")):(_this.$message.success(_this.$t("common._common.added_successfully")),_this.cancel(),_this.$emit("save"),eventBus/* eventBus */.Y.$emit("reloadOverallCost")),_context.next=13;break;case 12:_this.$message.error(_this.$t("common._common.select_inventory_error"));case 13:case"end":return _context.stop()}}),_callee)})))()},loadInventory:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var page,inventorySearchQuerry,searchPage,params,isItemTypes,inventoryTypeName,_yield$API$fetchAll,list,error,_iterator,_step,inventory;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _this2.inventoryListLoading=!0,page=_this2.page,inventorySearchQuerry=_this2.inventorySearchQuerry,searchPage=_this2.searchPage,params={page:page,perPage:20,filters:JSON.stringify({isRotating:{operatorId:15,value:["false"]}})},inventorySearchQuerry&&(params.filters=JSON.stringify({isRotating:{operatorId:15,value:["false"]},name:{operatorId:5,value:["".concat(inventorySearchQuerry)]}}),_this2.$set(params,"page",searchPage)),isItemTypes=["jobPlanItems","workOrderPlannedItems"].includes(_this2.moduleName),inventoryTypeName=isItemTypes?"itemTypes":"toolTypes",_context2.next=8,api/* API */.bl.fetchAll(inventoryTypeName,params);case 8:if(_yield$API$fetchAll=_context2.sent,list=_yield$API$fetchAll.list,error=_yield$API$fetchAll.error,!error){_context2.next=16;break}return _this2.$message.error(error||_this2.$t("common._common.planned_inventory_list_error_msg")),_context2.abrupt("return",{});case 16:_this2.listCount=list.length,_iterator=(0,createForOfIteratorHelper/* default */.Z)(list);try{for(_iterator.s();!(_step=_iterator.n()).done;)inventory=_step.value,inventory.checked=!1,inventory.addedQuantity=0}catch(err){_iterator.e(err)}finally{_iterator.f()}_this2.inventoryList=list,_this2.inventoryListLoading=!1;case 21:case"end":return _context2.stop()}}),_callee2)})))()},showMoreLinkText:function(index){var selectedIndex=this.selectedIndex;return-1!==selectedIndex.indexOf(index)?"View Less":"View More"},canShowMore:function(itemType){var description=this.$getProperty(itemType,"description");if(description){var descriptionLength=description.length,htmlToString=(0,filters/* htmlToText */.s9)(description).split(/\r\n|\r|\n/).length;return htmlToString>2||descriptionLength>130}return!1},getSubjectClassname:function(itemType,index){return this.canShowMore(itemType)?-1!==this.selectedIndex.indexOf(index)?"description-content description-content-viewMore":"description-content description-content-viewLess":"popover-description"},toggleVisibility:function(index){var selectedIndex=this.selectedIndex;if(-1===selectedIndex.indexOf(index))selectedIndex.push(index);else{var indexOfDesc=selectedIndex.indexOf(index);selectedIndex.splice(indexOfDesc,1)}}}},plannedInventory_AddPlannedInventoryvue_type_script_lang_js=AddPlannedInventoryvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(plannedInventory_AddPlannedInventoryvue_type_script_lang_js,render,staticRenderFns,!1,null,"bb6707b4",null)
/* harmony default export */,AddPlannedInventory=component.exports},
/***/386336:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return PlannedInventoryItems}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/workorder/jobplan/plannedInventory/PlannedInventoryItems.vue?vue&type=template&id=7cf47736&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"p30 white-bg-block"},[_c("div",{staticClass:"inline-flex"},[_c("div",{staticClass:"fc-v1-icon-bg"},[_c("InlineSvg",{attrs:{src:"svgs/items",iconClass:"icon icon-lg stroke-white"}})],1),_c("div",{staticClass:"fc-black3-16 mL10 mT12"},[_vm._v(" "+_vm._s(_vm.$t("common.products.items"))+" ")])]),_c("div",{ref:"plannedItemsWidget",staticClass:"inventory-table pT20 "},[_vm.plannedItemsloading?_c("table",{staticClass:"width100"},[_c("tr",[_c("td",{staticClass:"iTloading in-no-data",attrs:{colspan:"100%"}},[_c("spinner",{attrs:{show:!0,size:"80"}})],1)])]):_c("table",{staticClass:"width100 inventory-table"},[_c("thead",[_c("tr",[_c("th",{staticClass:"header-width20"},[_vm._v(_vm._s(_vm.$t("common.header._item")))]),_c("th",{staticClass:"header-width20"},[_vm._v(" "+_vm._s(_vm.$t("common._common.description"))+" ")]),_c("th",{staticClass:"header-width20"},[_vm._v(" "+_vm._s(_vm.$t("common.products._storeroom"))+" ")]),_c("th",{staticClass:"header-width15"},[_vm._v(_vm._s(_vm.$t("common._common._quantity")))]),_c("th",{staticClass:"header-width10"},[_vm._v(" "+_vm._s(_vm.$t("common.header._unit_price"))+" ")]),_c("th",{staticClass:"text-right header-width10"},[_vm._v(" "+_vm._s(_vm.$t("common.tabs._cost"))+" ")]),_c("th",{staticClass:"width40px"})])]),_vm.plannedInventoryItems.length?_c("tbody",[_vm._l(_vm.plannedInventoryItems,(function(plannedInventoryItem,index){return[_c("tr",{key:plannedInventoryItem.id,staticClass:"border-top4 border-bottom9 visibility-visible-actions pointer"},[_c("td",{staticClass:"width180px"},[plannedInventoryItem.id>-1?_c("div",{staticClass:"pL17"},[_vm._v(" "+_vm._s(_vm.$getProperty(plannedInventoryItem,"itemType.name"))+" ")]):_c("el-input",{staticClass:"fc-input-full-border2",attrs:{type:"text",placeholder:_vm.$t("common.header.item_name")}},[_c("i",{staticClass:"el-input__icon el-icon-search",staticStyle:{"line-height":"0px !important","font-size":"16px !important",cursor:"pointer"},attrs:{slot:"suffix"},on:{click:function($event){return _vm.addItems()}},slot:"suffix"})])],1),_c("td",{staticClass:"pL17"},[_vm._v(" "+_vm._s(_vm.$getProperty(plannedInventoryItem,"itemType.description","---"))+" ")]),_c("td",{staticClass:"pL20"},[_c("FLookupFieldWrapper",{attrs:{field:_vm.storeRoomLookupData},on:{recordSelected:function($event){return _vm.updateStoreRoom(plannedInventoryItem)}},model:{value:plannedInventoryItem.storeRoom.id,callback:function($$v){_vm.$set(plannedInventoryItem.storeRoom,"id",$$v)},expression:"plannedInventoryItem.storeRoom.id"}})],1),_c("td",[_c("el-input",{staticClass:"fc-input-full-border2 width50px inventory-input-width text-center pL20",attrs:{type:"number"},on:{change:function($event){return _vm.updateQuantity(plannedInventoryItem)}},model:{value:plannedInventoryItem.quantity,callback:function($$v){_vm.$set(plannedInventoryItem,"quantity",$$v)},expression:"plannedInventoryItem.quantity"}})],1),_c("td",["---"!==_vm.getUnitPrice(plannedInventoryItem)?_c("currency",{staticClass:"text-right",attrs:{value:_vm.getUnitPrice(plannedInventoryItem)}}):_c("div",{staticClass:"text-right"},[_vm._v(_vm._s("---"))])],1),_c("td",["---"!==_vm.totalCost(plannedInventoryItem)?_c("currency",{staticClass:"text-right",attrs:{value:_vm.totalCost(plannedInventoryItem)}}):_c("div",{staticClass:"text-right"},[_vm._v(_vm._s("---"))])],1),_c("td",{staticClass:"text-right"},[_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"el-icon-delete pointer inv-delet-icon visibility-hide-actions pR10 pL10",attrs:{"data-arrow":"true",title:_vm.$t("common.header.delete_item")},on:{click:function($event){return _vm.deletePlannedItem(plannedInventoryItem,index)}}})])])]}))],2):_c("tbody",[_c("tr",[_c("td",{staticClass:"pL20",on:{click:function($event){return _vm.addItems()}}},[_vm._v(" "+_vm._s(_vm.$t("common.header.add_item"))+" ")]),_c("td",{staticClass:"pL20"},[_vm._v(" "+_vm._s("---")+" ")]),_c("td",{staticClass:"pL20"},[_c("FLookupFieldWrapper",{attrs:{field:_vm.storeRoomLookupData,disabled:""}})],1),_c("td",[_c("el-input",{staticClass:"fc-input-full-border2 width50px inventory-input-width text-center pL20",attrs:{placeholder:"",type:"number",disabled:""}})],1),_c("td",{staticClass:"fc-grey3-13 text-right"},[_c("currency",{attrs:{value:0}})],1),_c("td",{staticClass:"fc-grey3-13 text-right"},[_c("currency",{attrs:{value:0}})],1),_c("td")])])])]),_vm.plannedItemsloading?_vm._e():_c("div",{staticClass:"item-add"},[_c("div",{staticClass:"green-txt-13 fc-v1-add-txt pointer fL"},[_vm.plannedInventoryItems.length?_c("span",{staticClass:"mR20",on:{click:function($event){return _vm.addItems()}}},[_c("img",{attrs:{src:__webpack_require__(353654)}}),_vm._v(" "+_vm._s(_vm.$t("common.header.add_item"))+" ")]):_vm._e()]),_c("div",{staticClass:"fR inline-flex mR30"},[_c("div",{staticClass:"bold mR60"},[_vm._v(_vm._s(_vm.$t("common.header._total")))]),_c("div",{staticClass:"fc-black3-16 text-right bold pR7"},[_c("currency",{attrs:{value:_vm.itemsTotalCost}})],1)])]),_vm.showAddItemsDialog?_c("AddPlannedInventory",{attrs:{jobPlanId:_vm.details.id,moduleName:"jobPlanItems",onClose:function(){return _vm.showAddItemsDialog=!1,_vm.getPlannedItems()}}}):_vm._e()],1)},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),createForOfIteratorHelper=__webpack_require__(566347),InlineSvg=(__webpack_require__(897389),__webpack_require__(648324),__webpack_require__(162506),__webpack_require__(586166)),api=__webpack_require__(32284),AddPlannedInventory=__webpack_require__(481582),validation=__webpack_require__(990260),eventBus=__webpack_require__(398011),FLookupFieldWrapper=__webpack_require__(201117),PlannedInventoryItemsvue_type_script_lang_js={name:"PlannedInventoryItems",components:{InlineSvg:InlineSvg/* default */.Z,AddPlannedInventory:AddPlannedInventory/* default */.Z,FLookupFieldWrapper:FLookupFieldWrapper/* default */.Z},props:["details","resizeWidget"],data:function(){return{plannedItemsloading:!1,plannedInventoryItems:[],showAddItemsDialog:!1,selectedStoreroom:null,storeRoomLookupData:{lookupModule:{name:"storeRoom"},multiple:!1}}},created:function(){this.getPlannedItems()},mounted:function(){this.autoResize()},computed:{itemsTotalCost:function(){var _step,plannedInventoryItems=this.plannedInventoryItems,totalCost=0,_iterator=(0,createForOfIteratorHelper/* default */.Z)(plannedInventoryItems);try{for(_iterator.s();!(_step=_iterator.n()).done;){var item=_step.value,_ref=item||{},cost=_ref.cost;(0,validation/* isEmpty */.xb)(cost)||(totalCost+=cost)}}catch(err){_iterator.e(err)}finally{_iterator.f()}return eventBus/* eventBus */.Y.$emit("itemsTotalCost",totalCost.toFixed(2)),totalCost}},methods:{autoResize:function(){var _this=this;this.$nextTick((function(){var container=_this.$refs["plannedItemsWidget"];if(container){var height=container.scrollHeight+180,width=container.scrollWidth;_this.resizeWidget({height:height,width:width})}}))},getUnitPrice:function(plannedInventoryItem){var unitPrice=this.$getProperty(plannedInventoryItem,"itemType.lastPurchasedPrice");return(0,validation/* isEmpty */.xb)(unitPrice)?"---":unitPrice},getPlannedItems:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var jobPlanid,params,_yield$API$fetchAll,list,error,_iterator2,_step2,plannedInventoryItem,storeRoomId,id;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _this2.plannedItemsloading=!0,jobPlanid=_this2.$getProperty(_this2.details,"id"),params={filters:JSON.stringify({jobPlan:{operatorId:36,value:["".concat(jobPlanid)]}})},_context.next=5,api/* API */.bl.fetchAll("jobPlanItems",params);case 5:if(_yield$API$fetchAll=_context.sent,list=_yield$API$fetchAll.list,error=_yield$API$fetchAll.error,error)_this2.$message.error(error||_this2.$t("common._common.planned_items_list_error_msg"));else{_iterator2=(0,createForOfIteratorHelper/* default */.Z)(list);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;)plannedInventoryItem=_step2.value,storeRoomId=_this2.$getProperty(plannedInventoryItem,"storeRoom.id"),(0,validation/* isEmpty */.xb)(storeRoomId)&&(id={id:null},plannedInventoryItem.storeRoom=id)}catch(err){_iterator2.e(err)}finally{_iterator2.f()}_this2.plannedInventoryItems=list,_this2.plannedItemsloading=!1,_this2.autoResize()}case 9:case"end":return _context.stop()}}),_callee)})))()},addItems:function(){this.showAddItemsDialog=!0},totalCost:function(plannedInventoryItem){var quantity=this.$getProperty(plannedInventoryItem,"quantity"),unitPrice=this.$getProperty(plannedInventoryItem,"itemType.lastPurchasedPrice"),cost=(0,validation/* isEmpty */.xb)(unitPrice)?"---":quantity*unitPrice;return"---"!==cost&&(plannedInventoryItem.cost=cost),cost},updateQuantity:function(plannedInventoryItem){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var _ref2,quantity,id,_yield$API$updateReco,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _ref2=plannedInventoryItem||{},quantity=_ref2.quantity,id=_ref2.id,_context2.next=3,api/* API */.bl.updateRecord("jobPlanItems",{id:id,data:{quantity:quantity}});case 3:_yield$API$updateReco=_context2.sent,error=_yield$API$updateReco.error,error?_this3.$message.error(error||_this3.$t("common._common.unable_to_update_quantity")):(_this3.$message.success(_this3.$t("common._common.quantity_updated_successfully")),_this3.getPlannedItems(),eventBus/* eventBus */.Y.$emit("reloadOverallCost"));case 6:case"end":return _context2.stop()}}),_callee2)})))()},updateStoreRoom:function(plannedInventoryItem){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var _ref3,id,storeRoom,_yield$API$updateReco2,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return _ref3=plannedInventoryItem||{},id=_ref3.id,storeRoom=_ref3.storeRoom,_context3.next=3,api/* API */.bl.updateRecord("jobPlanItems",{id:id,data:{storeRoom:storeRoom}});case 3:_yield$API$updateReco2=_context3.sent,error=_yield$API$updateReco2.error,error?_this4.$message.error(error||_this4.$t("common._common.unable_to_update_storeroom")):(_this4.$message.success(_this4.$t("common._common.storeroom_updated_successfully")),_this4.getPlannedItems(),eventBus/* eventBus */.Y.$emit("reloadOverallCost"));case 6:case"end":return _context3.stop()}}),_callee3)})))()},deletePlannedItem:function(plannedInventoryItem,index){var _this5=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){var id,_yield$API$deleteReco,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:return id=plannedInventoryItem.id,_context4.next=3,api/* API */.bl.deleteRecord("jobPlanItems",[id]);case 3:_yield$API$deleteReco=_context4.sent,error=_yield$API$deleteReco.error,error?_this5.$message.error(error||_this5.$t("common._common.error_occurred_delete")):(_this5.plannedInventoryItems.splice(index,1),_this5.$message.success(_this5.$t("common._common.item_del")),eventBus/* eventBus */.Y.$emit("reloadOverallCost"),_this5.autoResize(),_this5.selectedStoreroom=null);case 6:case"end":return _context4.stop()}}),_callee4)})))()}}},plannedInventory_PlannedInventoryItemsvue_type_script_lang_js=PlannedInventoryItemsvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(plannedInventory_PlannedInventoryItemsvue_type_script_lang_js,render,staticRenderFns,!1,null,"7cf47736",null)
/* harmony default export */,PlannedInventoryItems=component.exports},
/***/926460:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return InventoryPagination}});
// EXTERNAL MODULE: ./src/components/list/FPagination.vue + 7 modules
var render,staticRenderFns,FPagination=__webpack_require__(929593),InventoryPaginationvue_type_script_lang_js={name:"InventoryPagination",extends:FPagination/* default */.Z,methods:{setPage:function(isReset){this.pageNo?this.$emit("onPageChanged",this.page):isReset||this.$emit("onPageChanged",this.page)}}},widgets_InventoryPaginationvue_type_script_lang_js=InventoryPaginationvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(widgets_InventoryPaginationvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,InventoryPagination=component.exports},
/***/353654:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"d7f1f315aba97cd14240ee6f3d34465f.svg";
/***/}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/86336.js.map