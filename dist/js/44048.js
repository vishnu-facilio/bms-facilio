"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[44048,27417],{
/***/436756:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FDialogNew}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/FDialogNew.vue?vue&type=template&id=388b7f7a
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"costdialog",class:["f-dialog",_vm.customClass],attrs:{visible:_vm.visible,"before-close":_vm.close,width:_vm.width,"append-to-body":!0},on:{"update:visible":function($event){_vm.visible=$event}}},[_c("div",{staticClass:"f-dialog-title",attrs:{slot:"title"},slot:"title"},[_vm._t("header",(function(){return[_c("div",{staticClass:"label-txt-black fwBold"},[_vm._v(" "+_vm._s(_vm.title)+" ")])]}))],2),_c("div",{staticClass:"f-dialog-content",style:_vm.styleCss},[_vm._t("content"),_vm._t("default")],2),_c("div",{staticClass:"f-footer row",staticStyle:{height:"46px"}},[_vm._t("footer",(function(){return[_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.close}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.loading},on:{click:_vm.save}},[_vm._v(_vm._s(_vm.loading?_vm.loadingTitle||"Saving...":_vm.confirmTitle||"Save"))])],1)]}))],2)])},staticRenderFns=[],FDialogNewvue_type_script_lang_js={props:["title","confirmTitle","visible","customClass","width","maxHeight","stayOnSave","loading","loadingTitle","record"],computed:{styleCss:function(){return this.maxHeight?{"max-height":this.maxHeight,overflow:"scroll"}:null}},methods:{close:function(){this.$emit("close"),this.$emit("update:visible",!1)},save:function(){this.$emit("save"),this.stayOnSave||this.$emit("update:visible",!1)}}},components_FDialogNewvue_type_script_lang_js=FDialogNewvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FDialogNewvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FDialogNew=component.exports},
/***/503658:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return BaseDialogBox}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/energy/pivot/Components/BaseDialogBox.vue?vue&type=template&id=4730d566
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_vm.visibility?_c("el-dialog",{attrs:{"custom-class":"base-dialog-box",title:_vm.title,visible:_vm.visibility,"append-to-body":!0,"show-close":!1,"close-on-click-modal":!1,width:_vm.width,"destroy-on-close":!0},on:{"update:visible":function($event){_vm.visibility=$event}}},[_c("div",{staticClass:"title-slot",style:{display:_vm.hideHeader?"none":"block"},attrs:{slot:"title"},slot:"title"},[_c("div",{staticClass:"title-div"},[_vm._v(" "+_vm._s(_vm.title)+" ")]),_c("hr")]),_c("div",{staticClass:"dialog-body"},[_vm._t("body")],2),_c("span",{class:_vm.isAlert?"dialog-footer-alert":"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[_c("el-button",{staticClass:"mR10 dialog-btn confirm-btn",attrs:{disabled:_vm.disableConfirm,type:"el-button  el-button--primary"},on:{click:_vm.onConfirm}},[_vm._v(_vm._s(_vm.confirmText))]),_c("el-button",{staticClass:"mL10 dialog-btn cancel-btn",attrs:{disabled:_vm.disableCancel},on:{click:_vm.onCancel}},[_vm._v(_vm._s(_vm.cancelText))]),_vm.onClearAll?_c("el-button",{staticClass:"clear-all-btn",staticStyle:{"margin-left":"20px !important","text-decoration":"underline"},attrs:{type:"text"},on:{click:_vm.onClearAll}},[_vm._v("Clear all")]):_vm._e()],1)]):_vm._e()],1)},staticRenderFns=[],BaseDialogBoxvue_type_script_lang_js={props:["title","visibility","width","onCancel","cancelText","onConfirm","confirmText","disableCancel","disableConfirm","hideHeader","onClearAll","isAlert"]},Components_BaseDialogBoxvue_type_script_lang_js=BaseDialogBoxvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(Components_BaseDialogBoxvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,BaseDialogBox=component.exports},
/***/611864:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return PivotFolderRename}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/energy/pivot/Components/PivotFolderRename.vue?vue&type=template&id=659400b0
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("base-dialog-box",{attrs:{visibility:_vm.visibility,onConfirm:_vm.saveFolderName,onCancel:_vm.closeDialog,disableCancel:!1,cancelText:"Cancel",confirmText:"Save",title:"Edit Folder Name",width:"490px"},on:{"update:visibility":function($event){_vm.visibility=$event}}},[_c("div",{staticClass:"dialog-content-body",staticStyle:{margin:"20px",display:"flex"},attrs:{slot:"body"},slot:"body"},[_c("span",{staticStyle:{width:"150px","text-align":"center","padding-top":"10px"}},[_vm._v("Folder Name : ")]),_c("el-input",{ref:"rename",staticClass:"fc-input-full-border-select2 name-field",model:{value:_vm.newFolderName,callback:function($$v){_vm.newFolderName=$$v},expression:"newFolderName"}})],1)])},staticRenderFns=[],BaseDialogBox=(__webpack_require__(434284),__webpack_require__(503658)),api=__webpack_require__(32284),PivotFolderRenamevue_type_script_lang_js={name:"PivotFolderRename",props:["visibility","folderObject"],data:function(){return{newFolderName:""}},watch:{folderObject:{handler:function(newState){this.newFolderName=null===newState||void 0===newState?void 0:newState.name},immediate:!0}},components:{BaseDialogBox:BaseDialogBox/* default */.Z},methods:{saveFolderName:function(){var _this=this,newName=this.newFolderName;if(""!==newName&&null!==newName){var reportFolder={};reportFolder["name"]=newName,reportFolder["id"]=this.folderObject.id,api/* API */.bl.put("/v3/report/folder/update",{reportFolder:reportFolder}).then((function(response){response.error&&_this.$message({message:_this.$t("common.wo_report.cannot_rename_folder"),type:"error"})})).catch((function(){_this.$message({message:_this.$t("common.wo_report.cannot_rename_folder"),type:"error"})}))}else this.$message({message:this.$t("common.wo_report.foldername_cannot_empty"),type:"error"});this.$emit("updateFolderList",{name:newName,id:this.folderObject.id})},closeDialog:function(){this.$emit("cancelRename")}}},Components_PivotFolderRenamevue_type_script_lang_js=PivotFolderRenamevue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(Components_PivotFolderRenamevue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,PivotFolderRename=component.exports},
/***/532267:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return PivotReportShare}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/energy/pivot/Components/PivotReportShare.vue?vue&type=template&id=752c2794
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.show?_c("div",[_vm.show?_c("f-dialog",{attrs:{visible:_vm.show,width:"30%",confirmTitle:_vm.$t("common._common._save"),stayOnSave:!0,customClass:"qr-dialog"},on:{"update:visible":function($event){_vm.show=$event},save:function($event){return _vm.share(_vm.reportDetails)},close:function($event){return _vm.$emit("cancel")}}},[_c("div",{staticClass:"fc-setup-modal-title"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.sharing_permission"))+" ")]),_c("div",{staticClass:"mT10"},[_c("div",[_c("el-radio",{staticClass:"fc-radio-btn pB10 pT10",attrs:{label:1},model:{value:_vm.shareTo,callback:function($$v){_vm.shareTo=$$v},expression:"shareTo"}},[_vm._v(_vm._s(_vm.$t("common.wo_report.only_me")))])],1),_c("div",[_c("el-radio",{staticClass:"fc-radio-btn pB10",attrs:{label:2},model:{value:_vm.shareTo,callback:function($$v){_vm.shareTo=$$v},expression:"shareTo"}},[_vm._v(_vm._s(_vm.$t("common.wo_report.everyone")))])],1),_c("div",[_c("el-radio",{staticClass:"fc-radio-btn pB10",attrs:{label:3},model:{value:_vm.shareTo,callback:function($$v){_vm.shareTo=$$v},expression:"shareTo"}},[_vm._v(_vm._s(_vm.$t("common.wo_report.specific")))])],1),3===_vm.shareTo?_c("el-row",{staticClass:"mT20 el-select-block"},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"label-txt-black pB5"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.team"))+" ")]),_c("el-select",{staticClass:"width100 fc-full-border-select-multiple2",attrs:{filterable:"",multiple:"","collapse-tags":"",placeholder:_vm.$t("common.wo_report.choose_teams")},model:{value:_vm.sharedGroups,callback:function($$v){_vm.sharedGroups=$$v},expression:"sharedGroups"}},_vm._l(_vm.groups,(function(group){return _c("el-option",{key:group.id,attrs:{label:group.name,value:group.id}})})),1)],1)],1):_vm._e(),3===_vm.shareTo?_c("el-row",{staticClass:"mT20 el-select-block"},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"label-txt-black pB5"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.role"))+" ")]),_c("el-select",{staticClass:"width100 fc-full-border-select-multiple2",attrs:{filterable:"",multiple:"","collapse-tags":"",placeholder:_vm.$t("common.wo_report.choose_roles")},model:{value:_vm.sharedRoles,callback:function($$v){_vm.sharedRoles=$$v},expression:"sharedRoles"}},_vm._l(_vm.roles,(function(role){return _c("el-option",{key:role.id,attrs:{label:role.name,value:role.id}})})),1)],1)],1):_vm._e(),3===_vm.shareTo?_c("el-row",{staticClass:"mT20 el-select-block"},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"label-txt-black pB5"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.staff"))+" ")]),_c("el-select",{staticClass:"width100 fc-full-border-select-multiple2",attrs:{filterable:"",multiple:"","collapse-tags":"",placeholder:_vm.$t("common.wo_report.choose_users")},model:{value:_vm.sharedUsers,callback:function($$v){_vm.sharedUsers=$$v},expression:"sharedUsers"}},_vm._l(_vm.users,(function(user){return _c("el-option",{key:user.id,attrs:{label:user.name,value:user.id}})})),1)],1)],1):_vm._e()],1),_c("div",{staticStyle:{padding:"25px 0px"}})]):_vm._e()],1):_vm._e()},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),objectSpread2=__webpack_require__(595082),validation=(__webpack_require__(450886),__webpack_require__(670560),__webpack_require__(990260)),FDialogNew=__webpack_require__(436756),vuex_esm=__webpack_require__(420629),api=__webpack_require__(32284),picklist=__webpack_require__(961358),router=__webpack_require__(329435),PivotReportSharevue_type_script_lang_js={components:{FDialog:FDialogNew/* default */.Z},props:["showPopUp","reportDetails"],emits:["cancel"],data:function(){return{reportShareData:[],shareTo:2,sharedGroups:[],sharedUsers:[],sharedRoles:[],reportSharing:{},roles:[],users:[],show:!1}},created:function(){this.$store.dispatch("loadGroups"),this.getdetails()},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({groups:function(state){return state.groups}})),(0,vuex_esm/* mapGetters */.Se)(["getCurrentUser"])),{},{showDialogPopup:function(){return this.showPopUp}}),watch:{showDialogPopup:function(newValue){1==newValue?this.setDefaultShare():0==newValue&&(this.show=!1)}},methods:{empty:function(){this.sharedGroups=[],this.sharedRoles=[],this.sharedUsers=[]},loadUsersList:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var appId,_yield$getFieldOption,error,options;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return appId=(0,router/* getApp */.wx)().id||null,_context.next=3,(0,picklist/* getFieldOptions */._K)({field:{lookupModuleName:"users",filters:{applicationId:{value:[appId]}}}});case 3:_yield$getFieldOption=_context.sent,error=_yield$getFieldOption.error,options=_yield$getFieldOption.options,error?_this.$message.error(error.message||"Error Occured"):_this.users=options.map((function(user){return{name:user.label,id:user.value}}));case 7:case"end":return _context.stop()}}),_callee)})))()},loadRoleList:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var appId,params,_yield$API$get,data,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if(appId=(0,router/* getApp */.wx)().id||null,!(0,validation/* isEmpty */.xb)(appId)){_context2.next=3;break}return _context2.abrupt("return");case 3:return params={appId:appId},_context2.next=6,api/* API */.bl.get("/setup/roles",params);case 6:_yield$API$get=_context2.sent,data=_yield$API$get.data,error=_yield$API$get.error,error?_this2.$message.error(error.message||"Error Occured"):_this2.roles=data.roles||[];case 10:case"end":return _context2.stop()}}),_callee2)})))()},getdetails:function(){this.loadUsersList(),this.loadRoleList()},setDefaultShare:function(){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var _response,response,i;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return _this3.empty(),_context3.next=3,api/* API */.bl.get("v3/report/share/get",{reportId:_this3.reportDetails.id||-1});case 3:if(response=_context3.sent,response=null===(_response=response)||void 0===_response||null===(_response=_response.data)||void 0===_response?void 0:_response.reportShareDetails,1==response.length&&response[0].userId==_this3.getCurrentUser().ouid)_this3.shareTo=1;else if(response.length>0)for(_this3.shareTo=3,i=0;i<response.length;i++)1===response[i].type?_this3.sharedUsers.push(response[i].userId):2===response[i].type?_this3.sharedRoles.push(response[i].roleId):3===response[i].type&&_this3.sharedGroups.push(response[i].groupId);else _this3.shareTo=2;_this3.show=!0;case 7:case"end":return _context3.stop()}}),_callee3)})))()},share:function(reportDetails){var _this4=this;if(this.reportSharing.reportId=reportDetails.id||null,1===this.shareTo)this.reportShareData.push({type:1,userId:this.getCurrentUser().ouid});else if(3===this.shareTo){if(this.sharedUsers.length>0)for(var i=0;i<this.sharedUsers.length;i++)this.reportShareData.push({type:1,userId:this.sharedUsers[i]});if(this.sharedRoles.length>0)for(var _i=0;_i<this.sharedRoles.length;_i++)this.reportShareData.push({type:2,roleId:this.sharedRoles[_i]});if(this.sharedGroups.length>0)for(var _i2=0;_i2<this.sharedGroups.length;_i2++)this.reportShareData.push({type:3,groupId:this.sharedGroups[_i2]})}this.reportSharing.reportShareInfo=this.reportShareData||{},api/* API */.bl.post("v3/report/share/create",this.reportSharing).catch((function(error){return _this4.$error.message(error)})),this.reportShareData=[],this.shareTo=2,this.empty(),this.$emit("cancel")}}},Components_PivotReportSharevue_type_script_lang_js=PivotReportSharevue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(Components_PivotReportSharevue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,PivotReportShare=component.exports},
/***/794654:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return FolderManagerLayout}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/report/FolderManagerLayout.vue?vue&type=template&id=6b39e44e
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"views-manager-container",style:"ScheduleViews"==_vm.activeTabName?"":"margin-bottom:37px;"},[_c("div",{staticClass:"header-container"},[_c("div",{staticClass:"d-flex flex-direction-column"},[_c("div",{staticClass:"d-flex pointer",on:{click:_vm.goBack}},[_c("InlineSvg",{attrs:{src:"arrow-pointing-to-left2",iconClass:"icon icon-xs self-center mR5"}}),_c("div",{staticClass:"text-fc-blue f11 letter-spacing0_5"},[_vm._v(" "+_vm._s(_vm.$t("viewsmanager.list.back"))+" ")])],1),"ScheduleViews"==_vm.activeTabName?_c("div",{staticClass:"header-heading pT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.ScheduledReports"))+" ")]):_vm._e(),"folderViews"==_vm.activeTabName?_c("div",{staticClass:"header-heading pT10"},[_vm._v(" "+_vm._s(_vm.$t("pivot.folderViews"))+" ")]):_vm._e()]),"ScheduleViews"==_vm.activeTabName?_c("div",{staticClass:"d-flex flex-direction-column"},[_c("el-button",{staticClass:"new-scheduler-btn",staticStyle:{"margin-top":"12px",border:"none",right:"5%",padding:"10px",width:"180px"},on:{click:_vm.openCreatePopupForScheduleReport}},[_vm._v("New Report Scheduler")])],1):_vm._e()]),_c("div",["folderViews"==_vm.activeTabName?_c("div",{staticClass:"manager-tabs-container",staticStyle:{padding:"10px"}},[_c("ReportFolderListView",{ref:"folderList",attrs:{moduleName:_vm.$attrs.moduleName,tabId:_vm.$attrs.tabId}})],1):_vm._e(),"ScheduleViews"==_vm.activeTabName?_c("div",{staticStyle:{padding:"10px"}},[_c("ReportScheduledList",{attrs:{Name:_vm.name,list:_vm.list,moduleName:_vm.$attrs.moduleName,webTabId:_vm.$attrs.tabId}})],1):_vm._e()]),_vm.isCreateScheduleReport?_c("ScheduleReportV2",{attrs:{moduleName:_vm.currentModule,visibility:_vm.isCreateScheduleReport,report:{},webtabId:_vm.$attrs.tabId,appId:_vm.appId},on:{"update:visibility":function($event){_vm.isCreateScheduleReport=$event}}}):_vm._e()],1)},staticRenderFns=[],ReportFolderListViewvue_type_template_id_3ae9ad30_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("div",{staticClass:"new-folder-pivot-btn",staticStyle:{display:"none"},on:{click:function($event){_vm.newFolderPopup=!0}}},[_c("i",{staticClass:"el-icon-plus pR5 fwBold",staticStyle:{transform:"scale(0.9)"}}),_vm._v("New Folder ")]),_c("div",{staticClass:"folder-list-view height100 overflow-y-scroll pB50",staticStyle:{height:"calc(100vh - 200px)"}},[_c("PivotFolderRename",{attrs:{visibility:_vm.showEditDialog,folderObject:_vm.editFolder},on:{updateFolderList:_vm.updateFolders,cancelRename:function($event){_vm.showEditDialog=!1}}}),_vm.isLoading?_c("div",_vm._l(3,(function(index){return _c("div",{key:index,staticClass:"fc__white__bg__asset d-flex width100 height50 mB10"},[_vm._m(0,!0),_vm._m(1,!0)])})),0):_c("draggable",{model:{value:_vm.reportFolders,callback:function($$v){_vm.reportFolders=$$v},expression:"reportFolders"}},_vm._l(_vm.reportFolders,(function(folder,index){return _c("div",{key:index,staticClass:"mB10"},[_c("el-collapse",{staticClass:"folder-collapse"},[_c("el-collapse-item",{staticClass:"manager-views-item visibility-visible-actions",attrs:{name:folder.name}},[_c("template",{slot:"title"},[_c("div",{staticClass:"d-flex width100"},[_c("inline-svg",{staticClass:"d-flex self-center mR30 cursor-drag",attrs:{src:"svgs/drag-and-drop",iconClass:"icon fill-lite-grey pointer"}}),_c("div",{staticClass:"d-flex self-center"},[_c("inline-svg",{staticClass:"d-flex mR10 self-center fill-grey",attrs:{src:"svgs/folder",iconClass:"icon pointer"}}),_c("div",{staticClass:"text-uppercase"},[_vm._v(" "+_vm._s(folder.name)+" ")])],1),_c("div",{staticClass:"d-flex visibility-hide-actions mL-auto"},[_c("el-button",{staticClass:"fl-buttons",staticStyle:{padding:"7px 15px",border:"none",scale:"0.8"},attrs:{size:"mini",circle:""},on:{click:function($event){return _vm.showEditDialogBox(folder)}}},[_c("InlineSvg",{attrs:{src:"svgs/pivot/edit",iconClass:"icon-sm flex icon scale6"}})],1),_c("el-button",{staticClass:"fl-buttons",staticStyle:{padding:"7px 15px",border:"none",scale:"0.8"},attrs:{size:"mini",circle:""},on:{click:function($event){return _vm.deleteReportFolder(folder)}}},[_c("InlineSvg",{attrs:{src:"svgs/pivot/delete-icon",iconClass:"icon-md flex icon"}})],1)],1)],1)]),_c("draggable",_vm._l(folder.reports,(function(report,index){return _c("div",{key:index,staticClass:"views-item"},[_c("inline-svg",{staticClass:"d-flex self-center mR30 cursor-drag",attrs:{src:"svgs/drag-and-drop",iconClass:"icon fill-lite-grey"}}),_c("inline-svg",{staticClass:"d-flex self-center mR20 cursor-drag",attrs:{src:"svgs/views-list",iconClass:"icon icon-sm views-list"}}),_c("div",{staticClass:"f12 bold letter-spacing1 text-uppercase self-center"},[_vm._v(" "+_vm._s(report.name)+" ")]),_c("div",{staticClass:"d-flex self-center mL-auto"},[_vm.hasCreateEditPermission?_c("el-button",{staticClass:"fl-buttons-report",staticStyle:{border:"none",scale:"0.8"},attrs:{size:"mini",circle:""},on:{click:function($event){return _vm.editReport(report)}}},[_c("InlineSvg",{attrs:{src:"svgs/pivot/edit",iconClass:"icon-md flex icon"}})],1):_vm._e(),_vm.hasDeletePermission?_c("el-button",{staticClass:"fl-buttons-report",staticStyle:{border:"none",scale:"0.8"},attrs:{size:"mini",circle:""},on:{click:function($event){return _vm.deleteReport(report)}}},[_c("InlineSvg",{attrs:{src:"svgs/pivot/delete-icon",iconClass:"icon-md flex icon"}})],1):_vm._e(),_vm.hasSharePermission?_c("el-button",{directives:[{name:"show",rawName:"v-show",value:_vm.showShareButton(),expression:"showShareButton()"}],staticClass:"fl-buttons-report",staticStyle:{border:"none",scale:"0.8"},attrs:{size:"mini",circle:""},on:{click:function($event){_vm.showReportSharePopup=!0,_vm.reportForShare=report}}},[_c("InlineSvg",{attrs:{src:"svgs/pivot/Share icon",iconClass:"icon-md flex icon"}})],1):_vm._e()],1)],1)})),0)],2)],1)],1)})),0),_vm.showShareButton()?_c("PivotReportShare",{attrs:{reportDetails:_vm.reportForShare,showPopUp:_vm.showReportSharePopup},on:{cancel:function($event){_vm.showReportSharePopup=!1}}}):_vm._e()],1)])},ReportFolderListViewvue_type_template_id_3ae9ad30_staticRenderFns=[function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"fL width85 self-center"},[_c("div",{staticClass:"fc-animated-background p10 width140px"})])},function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"fR self-center"},[_c("div",{staticClass:"fc-animated-background p10 width140px"})])}],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),objectSpread2=__webpack_require__(595082),api=(__webpack_require__(434284),__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(162506),__webpack_require__(670560),__webpack_require__(32284)),vuedraggable_umd=__webpack_require__(909980),vuedraggable_umd_default=__webpack_require__.n(vuedraggable_umd),vuex_esm=__webpack_require__(420629),PivotFolderRename=__webpack_require__(611864),PivotReportShare=__webpack_require__(532267),ModularAnalyticmixin=__webpack_require__(795e3),ReportHelper=__webpack_require__(507815),validation=__webpack_require__(990260),ReportTabPermissions=__webpack_require__(902040),router=__webpack_require__(329435),ReportFolderListViewvue_type_script_lang_js={props:["moduleName","tabId"],mixins:[ReportHelper/* default */.Z,ModularAnalyticmixin/* default */.Z,ReportTabPermissions/* default */.Z],components:{draggable:vuedraggable_umd_default(),PivotFolderRename:PivotFolderRename/* default */.Z,PivotReportShare:PivotReportShare/* default */.Z},data:function(){return{isLoading:!1,reportFolders:[],url:"/v3/report/folders?moduleName=",editFolder:null,showEditDialog:!1,reportForShare:null,showReportSharePopup:!1}},computed:(0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapGetters */.Se)(["getCurrentUser"])),created:function(){this.loadFoldersList()},methods:{showShareButton:function(){return!(1!=this.getCurrentUser().role.isPrevileged||!this.$helpers.isLicenseEnabled("REPORT_SHARE"))},showEditDialogBox:function(folder){this.editFolder=folder,this.showEditDialog=!0},updateFolders:function(_ref){var name=_ref.name,id=_ref.id;this.showEditDialog=!1,this.reportFolders.forEach((function(folder){folder.id==id&&(folder.name=name)}))},loadFoldersList:function(addFolder){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var moduleName,_yield$API$get,data,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return moduleName=null,moduleName=_this.$route.query.module?_this.$route.query.module:(0,router/* isWebTabsEnabled */.tj)()?_this.moduleName+"&webTabId="+_this.tabId:_this.getCurrentModule().module,"energy"===moduleName?moduleName="energyData":"custom"===moduleName&&(moduleName="custommodule"),addFolder||(_this.url+=moduleName),_context.next=6,api/* API */.bl.get(_this.url);case 6:_yield$API$get=_context.sent,data=_yield$API$get.data,error=_yield$API$get.error,error?_this.$message.error("Error on loading report folders"):_this.reportFolders=data.reportFolders;case 10:case"end":return _context.stop()}}),_callee)})))()},deleteReportFolder:function(folder){var self=this,promptObj={title:self.$t("common.wo_report.delete_folder"),message:self.$t("common.wo_report.delete_folder_msg"),rbDanger:!0,rbLabel:self.$t("common._common.delete")};self.$dialog.confirm(promptObj).then((function(value){value&&api/* API */.bl.post("/v3/report/folder/delete",{reportFolder:folder}).then((function(response){if(response.error)self.$message({message:self.$t("common.wo_report.cannot_delete_msg"),type:"error"});else{var index=self.reportFolders.indexOf(folder);self.reportFolders.splice(index,1),self.$message({message:self.$t("common.wo_report.folder_delete_success"),type:"success"})}})).catch((function(error){self.$message({message:self.$t("common.wo_report.cannot_delete_msg"),type:"error"})}))}))},editFolderName:function(folder){var _this2=this,newName=this.folderState[folder.id].newName;if(""!==newName&&null!==newName){var reportFolder={};reportFolder["name"]=newName,reportFolder["id"]=folder.id,this.editFolderId=null,api/* API */.bl.put("/v3/report/folder/update",{reportFolder:reportFolder}).then((function(response){response.error?(_this2.$message({message:_this2.$t("common.wo_report.cannot_rename_folder"),type:"error"}),folder.name=_this2.folderState[folder.id].name):(folder.name=response.data.reportFolder.name,_this2.folderState[folder.id].name=folder.name,_this2.folderState[folder.id].newName=folder.name)})).catch((function(){_this2.$message({message:_this2.$t("common.wo_report.cannot_rename_folder"),type:"error"}),folder.name=_this2.folderState[folder.id].name}))}else this.$message({message:this.$t("common.wo_report.foldername_cannot_empty"),type:"error"});this.$forceUpdate()},editReport:function(report){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var id,moduleName,path,resultObj,routePath,ANALYTIC_PORTFOLIO,ANALYTIC_BUILDING,HEAT_MAP,ANALYTIC_SITE,TREE_MAP,REGRESSION,SCATTER,url,_ref2,name,query,_path,_ref3,_name,_query,parentModule,_ref4,_name2;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if(id=report.id,moduleName=null,moduleName=(0,router/* isWebTabsEnabled */.tj)()?"":_this3.getCurrentModule().module,path=_this3.getModularReportEditURL(moduleName),"custom"===moduleName&&(moduleName=report.moduleName),!("energydata"===moduleName||(0,router/* isWebTabsEnabled */.tj)()&&"energydata"===_this3.moduleName)){_context2.next=28;break}return ANALYTIC_PORTFOLIO=router/* pageTypes */.As.ANALYTIC_PORTFOLIO,ANALYTIC_BUILDING=router/* pageTypes */.As.ANALYTIC_BUILDING,HEAT_MAP=router/* pageTypes */.As.HEAT_MAP,ANALYTIC_SITE=router/* pageTypes */.As.ANALYTIC_SITE,TREE_MAP=router/* pageTypes */.As.TREE_MAP,REGRESSION=router/* pageTypes */.As.REGRESSION,SCATTER=router/* pageTypes */.As.SCATTER,url="/v3/report/reading/view?reportId="+id,_context2.next=10,api/* API */.bl.put(url).then((function(response){response.error||(resultObj=response.data)}));case 10:_context2.t0=resultObj.report.analyticsType,_context2.next=1===_context2.t0?13:3===_context2.t0?15:6===_context2.t0?17:7===_context2.t0?19:8===_context2.t0?21:23;break;case 13:return routePath=resultObj.filters&&resultObj.filters.xCriteriaMode?{path:"portfolio",pageType:ANALYTIC_PORTFOLIO}:{path:"building",pageType:ANALYTIC_BUILDING},_context2.abrupt("break",24);case 15:return routePath={path:"heatmap",pageType:HEAT_MAP},_context2.abrupt("break",24);case 17:return routePath={path:"site",pageType:ANALYTIC_SITE},_context2.abrupt("break",24);case 19:return routePath={path:"treemap",pageType:TREE_MAP},_context2.abrupt("break",24);case 21:return routePath={path:"scatter",pageType:SCATTER},_context2.abrupt("break",24);case 23:routePath={path:"building",pageType:ANALYTIC_BUILDING};case 24:_this3.isRegressionReport&&(routePath={path:"regression",pageType:REGRESSION}),(0,router/* isWebTabsEnabled */.tj)()?(_ref2=(0,router/* findRouteForTab */.OD)(routePath.pageType)||{},name=_ref2.name,query={reportId:id},!0===_this3.duplicateReportToggle&&(query.duplicate=!0),name&&_this3.$router.push({name:name,query:query})):(_path="/app/em/analytics/"+routePath.path,!0===_this3.duplicateReportToggle?_this3.$router.push({path:_path,query:{reportId:id,duplicate:!0}}):_this3.$router.push({path:_path,query:{reportId:id}})),_context2.next=30;break;case 28:_this3.$helpers.isEtisalat()?path="/app/em/modulereports/new":_this3.isCustomModule&&(path="/app/ca/reports/new"),(0,router/* isWebTabsEnabled */.tj)()?(moduleName=_this3.$attrs.moduleName?_this3.$attrs.moduleName:_this3.moduleName,"inspectionResponse"===moduleName&&(moduleName="inspectionTemplate"),_ref3=(0,router/* findRouteForReport */.Mq)("module_reports",router/* pageTypes */.As.REPORT_FORM,{moduleName:moduleName})||{},_name=_ref3.name,_query={reportId:id,module:moduleName||null},!0===_this3.duplicateReportToggle&&(_query.duplicate=!0),_name?_this3.$router.push({name:_name,query:_query}):(0,validation/* isEmpty */.xb)(_name)&&(parentModule=ReportHelper/* default */.Z.findModuleFromSubmodule(_this3.moduleName),_ref4=(0,router/* findRouteForReport */.Mq)("module_reports",router/* pageTypes */.As.REPORT_FORM,{moduleName:parentModule})||{},_name2=_ref4.name,_name2&&_this3.$router.push({name:_name2,query:_query}))):_this3.duplicateReportToggle?_this3.$router.push({path:path,query:{reportId:id,duplicate:!0,module:moduleName||null}}):_this3.$router.push({path:path,query:{reportId:id,module:moduleName||null}});case 30:case"end":return _context2.stop()}}),_callee2)})))()},deleteReport:function(row){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var id,promptObj,deleteConfirmation,_API$post,data,error,confirmObj,widgetDeleteConfirm,resp;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return id=row.id,promptObj={title:"Delete Report",message:"Are you sure you want to delete this Report?",rbDanger:!0,rbLabel:"Delete"},_context3.next=4,_this4.$dialog.confirm(promptObj);case 4:if(deleteConfirmation=_context3.sent,!deleteConfirmation){_context3.next=25;break}if(_API$post=api/* API */.bl.post("/v2/report/deleteReport",{reportId:id||_this4.reportId}),data=_API$post.data,error=_API$post.error,!error){_context3.next=11;break}_this4.$message.error("Error deleting pivot report",error),
// API error on delete
_context3.next=25;break;case 11:if(!data||!data.errorString){_context3.next=23;break}
// Cannot delete as it's present in dashboard,confirm again
return confirmObj={title:"Delete Report",message:"This report is associated to a dashboard widget. Deleting this report will remove the widget from the dashboard. Are you sure you want to continue?",rbLabel:"Yes, delete",lbLabel:"No, cancel"},_context3.next=15,_this4.$dialog.confirm(confirmObj);case 15:if(widgetDeleteConfirm=_context3.sent,!widgetDeleteConfirm){_context3.next=21;break}return _context3.next=19,api/* API */.bl.post("/v2/report/deleteReport",{reportId:_this4.reportId,deleteWithWidget:!0});case 19:resp=_context3.sent,resp.error?_this4.$message.error("Error deleting pivot report and widget",error):_this4.$message.success("Report deleted successfully");case 21:_context3.next=25;break;case 23:_this4.$message.success("Report deleted successfully"),_this4.handleDelete(row);case 25:case"end":return _context3.stop()}}),_callee3)})))()},handleDelete:function(report){this.reportFolders.forEach((function(folder){return folder.reports.forEach((function(r,index,reports){r.id==report.id&&reports.splice(index,1)}))}))}}},report_ReportFolderListViewvue_type_script_lang_js=ReportFolderListViewvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(report_ReportFolderListViewvue_type_script_lang_js,ReportFolderListViewvue_type_template_id_3ae9ad30_render,ReportFolderListViewvue_type_template_id_3ae9ad30_staticRenderFns,!1,null,null,null)
/* harmony default export */,ReportFolderListView=component.exports,ReportScheduledList=__webpack_require__(613605),ScheduleReportNew=__webpack_require__(91699),FolderManagerLayoutvue_type_script_lang_js={components:{ReportFolderListView:ReportFolderListView,ReportScheduledList:ReportScheduledList["default"],ScheduleReportV2:ScheduleReportNew/* default */.Z},data:function(){return{name:"report",list:"report",activeTabName:"folderViews",addFolderDialog:!1,isCreateScheduleReport:!1}},methods:{goBack:function(){window.history.go(-1),this.$emit("goBack")},openCreatePopupForScheduleReport:function(){this.isCreateScheduleReport=!0}},created:function(){var activeTab=this.$route.query.activeTab;this.activeTabName=activeTab},computed:{currentModule:function(){return(0,router/* isWebTabsEnabled */.tj)()?this.$attrs.moduleName?this.$attrs.moduleName:"":this.$route.meta.module},users:function(){return this.$store.state.users},appId:function(){return(0,router/* getApp */.wx)().id}}},report_FolderManagerLayoutvue_type_script_lang_js=FolderManagerLayoutvue_type_script_lang_js,FolderManagerLayout_component=(0,componentNormalizer/* default */.Z)(report_FolderManagerLayoutvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FolderManagerLayout=FolderManagerLayout_component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/44048.js.map