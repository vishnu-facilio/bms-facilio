(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[70334],{
/***/713243:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return BulkForm}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/bulkform/BulkForm.vue?vue&type=template&id=e97f44fe
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.loadHot?_c("div",{staticClass:"bulk-form-container fc-hottable-com-page"},[_c("HotTableWrapper",{ref:"hotTableWrapper",attrs:{hotTableSettingsData:_vm.hotConfig,selectedSiteId:_vm.selectedSiteId,pasteDataMap:_vm.pasteDataMap,onRowChange:_vm.onRowChange,moduleData:_vm.moduleData},on:{"update:pasteDataMap":function($event){_vm.pasteDataMap=$event},"update:paste-data-map":function($event){_vm.pasteDataMap=$event}}})],1):_vm._e()},staticRenderFns=[],defineProperty=__webpack_require__(482482),objectSpread2=__webpack_require__(595082),objectWithoutProperties=__webpack_require__(62078),slicedToArray=__webpack_require__(554621),createForOfIteratorHelper=__webpack_require__(566347),toConsumableArray=__webpack_require__(488478),validation=(__webpack_require__(260228),__webpack_require__(670560),__webpack_require__(336585),__webpack_require__(634338),__webpack_require__(947522),__webpack_require__(538077),__webpack_require__(450886),__webpack_require__(434284),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(990260)),CustomValidator=__webpack_require__(314346),HotTableWrapper=__webpack_require__(513868),FWebform=__webpack_require__(434500),constant=__webpack_require__(354754),field_utils=__webpack_require__(455344),utils_field=__webpack_require__(815872),uuid=__webpack_require__(455877),range=__webpack_require__(396026),range_default=__webpack_require__.n(range),cloneDeep=__webpack_require__(150361),cloneDeep_default=__webpack_require__.n(cloneDeep),dset_es=__webpack_require__(444806),_excluded=["uuid"],BulkFormvue_type_script_lang_js={name:"bulk-form",extends:FWebform/* default */.Z,components:{HotTableWrapper:HotTableWrapper/* default */.Z},mounted:function(){this.initBulkForm(),this.loadHot=!0,window.handsonTable=this.$refs["hot"]},data:function(){return{loadHot:!1,hotConfig:{renderAllRows:!0,
//turn off virtual scrolling
viewportColumnRenderingOffset:"auto",rowHeaders:!0,data:[],dataSchema:{},uniqueDataKey:"uuid",colHeaders:[],columns:[],minRows:25,minSpareRows:3,maxRows:25,undo:!0,manualColumnResize:!0,manualRowResize:!0,autoRowSize:!1,autoColumnSize:!0,afterValidate:function(){},errormessage:"",fieldnames:[]},pasteDataMap:{}}},methods:{initBulkForm:function(){
//Bulk form has no section , accumulate fields from all section to single list
var allFields=this.form.sections.reduce((function(accum,section){return accum.push.apply(accum,(0,toConsumableArray/* default */.Z)(section.fields)),accum}),[]);this.constructHotColumns(allFields),this.hotConfig.stretchH="all"},
// triggered from outside
triggerSubmit:function(){var _this=this,formRowsData=this.getFormRows();return(0,validation/* isEmpty */.xb)(formRowsData)?Promise.reject({type:"warning",message:"Please enter the values for atleast one row"}):new Promise((function(res,rej){var usedRowIndices=_this.getUsedRowIndices();if(!(0,validation/* isEmpty */.xb)(usedRowIndices)){var $refs=_this.$refs,validationOption={rows:usedRowIndices};$refs["hotTableWrapper"].triggerValidate(validationOption,(function(isValid){if(isValid)res(formRowsData);else{var count=_this.errorRowIndex(),dialogObj={},classname="";classname=count<10?"f-dialog-minheight":"f-dialog-maxheight",dialogObj={title:"Please correct the following errors to proceed:",htmlMessage:"".concat(_this.errormessage),lbHide:!0,className:"".concat(classname)},_this.$dialog.confirm(dialogObj)}}))}}))},errorRowIndex:function(){var hotConfig=this.hotConfig,Required=[],celltype=[],usedRowIndex=this.getUsedRowIndices();this.errormessage="";var usedindex,_step,errorCount=1,index=0,formRowsData=this.getFormRows(),columns=hotConfig.columns,_iterator=(0,createForOfIteratorHelper/* default */.Z)(columns);try{for(_iterator.s();!(_step=_iterator.n()).done;){var column=_step.value,required=column.required,cellType=column.cellType;Required.push(required),celltype.push(cellType)}}catch(err){_iterator.e(err)}finally{_iterator.f()}usedindex=0;for(var _i=0,_Object$entries=Object.entries(formRowsData);_i<_Object$entries.length;_i++){var _Object$entries$_i=(0,slicedToArray/* default */.Z)(_Object$entries[_i],2),values=(_Object$entries$_i[0],_Object$entries$_i[1]);for(var value in index=0,values)1!=Required[index]||"lookup"!==celltype[index]&&"select"!==celltype[index]?1!=Required[index]||void 0!=celltype[index]||null!=values[value]&&""!=values[value]||(this.errormessage+="Row ".concat(usedRowIndex[usedindex]+1,": ").concat(this.hotConfig.fieldnames[index]," is mandatory\n"),errorCount++):null!=values[value].id&&""!=values[value].id||(this.errormessage+="Row ".concat(usedRowIndex[usedindex]+1,": ").concat(this.hotConfig.fieldnames[index]," is mandatory\n"),errorCount++),index++;usedindex++}return errorCount-1},onRowChange:function(props){var $refs=this.$refs,hotConfig=this.hotConfig,_ref=hotConfig||{},data=_ref.data,index=props.index,selectedRowData=data[index]||{},_ref2=selectedRowData||{},uuid=_ref2["uuid"],dataWithoutId=(0,objectWithoutProperties/* default */.Z)(_ref2,_excluded),canClearError=(0,validation/* areValuesEmpty */.sD)(dataWithoutId);!(0,validation/* isEmpty */.xb)($refs)&&canClearError&&$refs["hotTableWrapper"].clearRowError(uuid)},getFormRows:function(){var _this2=this,_this$hotConfig=this.hotConfig,uniqueDataKey=_this$hotConfig.uniqueDataKey,rows=_this$hotConfig.data,formRowsData=[];return rows.forEach((function(row){var isUsedRow=_this2.isRowUsed(row);if(isUsedRow){var data=cloneDeep_default()(row),id=data[uniqueDataKey];if(_this2.pasteDataMap[id]){var pasteData=_this2.pasteDataMap[id];Object.entries(pasteData).forEach((function(_ref3){var _ref4=(0,slicedToArray/* default */.Z)(_ref3,2),key=_ref4[0],value=_ref4[1];(0,dset_es/* default */.Z)(data,key,value)}))}delete data[uniqueDataKey],formRowsData.push(data)}})),formRowsData},getUsedRowIndices:function(){var _this3=this,rows=this.hotConfig.data,usedRowIndices=[];return rows.forEach((function(row,rowIndex){var isUsedRow=_this3.isRowUsed(row);isUsedRow&&usedRowIndices.push(rowIndex)})),usedRowIndices},isRowUsed:function(row){
// uuid or id must not be considered when checking for usage
// TODO check if visible fields are all null because id will be
// present in edit case and hidden fields might have default values
// during creation case
var uniqueDataKey=this.hotConfig.uniqueDataKey;return!(0,validation/* areValuesEmpty */.sD)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},row),{},(0,defineProperty/* default */.Z)({},uniqueDataKey,null)))},constructHotColumns:function(deserializedFormFields){var _this4=this,supportedFields=deserializedFormFields.filter((function(formField){return _this4.isBulkModeSupported(formField)}));if(this.hotConfig.fieldnames=supportedFields.map((function(field){var _ref5=field||{},displayName=_ref5.displayName;_ref5.required;return"".concat(displayName)})),this.hotConfig.colHeaders=supportedFields.map((function(field){var _ref6=field||{},displayName=_ref6.displayName,required=_ref6.required;return required?'<span class="required">'.concat(displayName,"*</span>"):"".concat(displayName)})),(0,validation/* isEmpty */.xb)(this.moduleData))this.hotConfig.dataSchema=cloneDeep_default()(this.formModel),this.hotConfig.data=range_default()(0,25).map((function(){return cloneDeep_default()((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},_this4.formModel),{},{uuid:(0,uuid.v4)()}))}));else{var temp=0;this.hotConfig.dataSchema=cloneDeep_default()(this.formModel),this.hotConfig.data=range_default()(0,25).map((function(){return cloneDeep_default()((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},_this4.moduleData[temp++]),{},{uuid:(0,uuid.v4)()}))}))}
//get appropriate column object for each field object
supportedFields.forEach((function(formField){_this4.hotConfig.columns.push(_this4.getHotColumn(formField))}))},getHotColumn:function(field){var name=field.name,displayTypeEnum=field.displayTypeEnum,required=field.required,columnObj={};(0,validation/* isObject */.Kn)(this.formModel[name])?columnObj["data"]="".concat(name,".id"):columnObj["data"]="".concat(name);
//Can be type:'systemTypeString' or type:{renderer,validator,editor} for customtypes'
//define props for column type and then mix into column object
var columnTypeObj={};return"TEXTBOX"===displayTypeEnum||"TEXTAREA"===displayTypeEnum?columnTypeObj.renderer="input":"NUMBER"===displayTypeEnum||"DECIMAL"===displayTypeEnum?columnTypeObj.type="numeric":"DATETIME"===displayTypeEnum?(columnTypeObj.editor="picker",columnTypeObj.pickerType="datetime",columnTypeObj.renderer="picker",columnTypeObj.width=200):(0,utils_field/* isLookupSimple */.qu)(field)||(0,field_utils/* isChooserTypeField */.Rq)(field)?(columnObj.editor="lookup",columnObj.renderer="lookup",columnObj.cellType="lookup",columnObj.field=field,columnObj.field.optionsCache={}):this.isDropdownTypeFields(field.displayTypeEnum)?(columnTypeObj.renderer="select",columnTypeObj.editor="select",columnObj.cellType="select",columnTypeObj.options=field.options):"DECISION_BOX"===displayTypeEnum&&(columnTypeObj.type="checkbox"),columnObj=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},columnObj),columnTypeObj),columnObj.required=required,required&&(columnObj.validateFn=CustomValidator/* requiredFieldValidator */.i),columnObj},isBulkModeSupported:function(field){return constant/* default */.Z.BULK_MODE_SUPPORTED_DISPLAY_TYPES.includes(field.displayTypeEnum)}}},bulkform_BulkFormvue_type_script_lang_js=BulkFormvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(bulkform_BulkFormvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,BulkForm=component.exports},
/***/874249:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return RichTextArea}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/forms/RichTextArea.vue?vue&type=template&id=7711575b
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.isRichText?_c("div",{staticClass:"richtext-area"},[_c("RichText",{style:{minHeight:_vm.minHeight,maxHeight:_vm.maxHeight,overflow:_vm.overflow},attrs:{readOnly:_vm.disabled,placeholder:_vm.placeholder,hideImgTool:_vm.hideImgTool,hideUnorderedList:_vm.hideUnorderedList,hideOrderedList:_vm.hideOrderedList,secondaryToolbar:_vm.secondaryToolbar,istoolbarPositionBottom:_vm.istoolbarPositionBottom,isMoreOption:_vm.isMoreOption,customToolOrder:_vm.customToolOrder,iconColor:_vm.iconColor},scopedSlots:_vm._u([_vm.canShowModeToggle?{key:"editorMode",fn:function(){return[_c("div",{staticClass:"self-center marginL-auto mR15 cursor-pointer mode-btn",on:{click:function($event){return _vm.changeMode()}}},[_vm._v(" "+_vm._s(_vm.$t("forms.builder.plain_text_mode"))+" ")])]},proxy:!0}:null],null,!0),model:{value:_vm.content,callback:function($$v){_vm.content=$$v},expression:"content"}})],1):_c("div",{staticClass:"richtext-area plain-text-mode"},[_c("div",{staticClass:"richtext-editor"},[_c("div",{staticClass:"richtext-toolbar"},[_c("div",{staticClass:"toolbar-button marginL-auto cursor-pointer mode-btn",on:{click:function($event){return _vm.changeMode()}}},[_vm._v(" "+_vm._s(_vm.$t("forms.builder.switch_to_richtext"))+" ")])]),_c("el-input",{key:"plain-text",staticClass:"richtext-content",attrs:{type:"textarea",resize:"none",placeholder:_vm.placeholder},model:{value:_vm.content,callback:function($$v){_vm.content=$$v},expression:"content"}})],1)])},staticRenderFns=[],ui_forms=(__webpack_require__(879288),__webpack_require__(141323)),filters=__webpack_require__(638203),RichTextAreavue_type_script_lang_js={props:{value:{type:String},field:{type:Object},rows:{type:Number,default:10},maxRows:{type:Number,default:12},disabled:{type:Boolean,default:!1},placeholder:{type:String,default:"Enter text here"},isEdit:{type:Boolean,default:!1},hideImgTool:{type:Boolean,default:!1},hideOrderedList:{type:Boolean,default:!1},hideUnorderedList:{type:Boolean,default:!1},isRichTextMode:{type:Boolean,default:!0},canShowModeToggle:{type:Boolean,default:!1},istoolbarPositionBottom:{type:Boolean},customToolOrder:{type:Array},isMoreOption:{type:Boolean},secondaryToolbar:{type:Boolean},iconColor:{type:String}},components:{RichText:ui_forms/* RichText */.Ho},computed:{content:{get:function(){return this.value},set:function(value){this.$emit("input",value)}},isRichText:{get:function(){return this.isRichTextMode},set:function(value){this.$emit("update:isRichTextMode",value)}},
// Assuming a <p></p> tag inside editor
// has fonts-size 1rem and margin-bottom 1rem
minHeight:function(){return"".concat(2*this.rows,"rem")},maxHeight:function(){return"".concat(2*this.maxRows,"rem")},overflow:function(){return"hidden"}},methods:{changeMode:function(){var isRichText=this.isRichText,value=this.value;if(isRichText)this.showConfirmModeSwitch();else{var htmlContent="<p>".concat(value,"</p>");this.content=htmlContent,this.proceedChangingModes()}},showConfirmModeSwitch:function(){var _this=this,dialogObj={htmlMessage:"".concat(this.$t("forms.builder.switch_alert")),rbDanger:!0,rbLabel:"Confirm"};this.$dialog.confirm(dialogObj).then((function(canProceed){if(canProceed){var value=_this.value,textContent=(0,filters/* htmlToText */.s9)(value);_this.content=textContent,_this.proceedChangingModes()}}))},proceedChangingModes:function(){var isRichText=this.isRichText;this.isRichText=!isRichText}}},forms_RichTextAreavue_type_script_lang_js=RichTextAreavue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(forms_RichTextAreavue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,RichTextArea=component.exports},
/***/784823:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return AdvancedSearch}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/newapp/components/search/AdvancedSearch.vue?vue&type=template&id=66305202
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("div",{staticClass:"d-flex align-center",on:{click:function($event){return _vm.openCloseSearch(!0)}}},[_vm._t("icon",(function(){return[_c("InlineSvg",{staticClass:"d-flex mT3 cursor-pointer",attrs:{src:"svgs/search",iconClass:"icon icon-sm self-center mR5"}})]}))],2),_vm.canShowSearchWiz?_c("el-dialog",{attrs:{title:_vm.title,visible:_vm.canShowSearchWiz,fullscreen:!0,"append-to-body":!0,"custom-class":"advance-search-container"},on:{"update:visible":function($event){_vm.canShowSearchWiz=$event}}},[_c("AdvancedSearch",{attrs:{moduleName:_vm.moduleName,searchParam:_vm.searchParam,hideQuery:_vm.hideQuery,filterList:_vm.filterList},on:{applyFilters:_vm.applyFilters,closeDialog:function(){return _vm.openCloseSearch(!1)}}})],1):_vm._e()],1)},staticRenderFns=[],objectSpread2=__webpack_require__(595082),router=(__webpack_require__(634338),__webpack_require__(564043),__webpack_require__(61514),__webpack_require__(329435)),dist=__webpack_require__(191853),validation=__webpack_require__(990260),vuex_esm=__webpack_require__(420629),AdvancedSearchvue_type_script_lang_js={props:["moduleName","moduleDisplayName","filterList","hideQuery","onSave"],components:{AdvancedSearch:dist/* AdvancedSearch */.ZJ},data:function(){return{searchText:"",canShowSearchWiz:!1,isSaving:!1,searchableFields:[],isOpenWizPressed:!1}},created:function(){(0,router/* isWebTabsEnabled */.tj)()&&(document.addEventListener("keydown",this.keyDownHandler),document.addEventListener("keyup",this.keyUpHandler))},beforeDestroy:function(){(0,router/* isWebTabsEnabled */.tj)()&&(document.removeEventListener("keydown",this.keyDownHandler),document.removeEventListener("keyup",this.keyUpHandler))},computed:{title:function(){var moduleDisplayName=this.moduleDisplayName,title="".concat(this.$t("commissioning.sheet.filter")," ").concat(moduleDisplayName," ").concat(this.$t("filters.search.by"));return title},searchParam:function(){var $route=this.$route,_ref=$route||{},query=_ref.query,_ref2=query||{},search=_ref2.search;return(0,validation/* isEmpty */.xb)(search)?"":search}},mounted:function(){this.fetchSearchableFields({moduleName:this.moduleName})},methods:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapActions */.nv)({fetchSearchableFields:"search/fetchSearchableFields"})),{},{openCloseSearch:function(canShow){this.searchText="",this.canShowSearchWiz=canShow},applyFilters:function(filters){var hideQuery=this.hideQuery;hideQuery?this.onSave({filters:filters}):this.$store.dispatch("search/applyFilters",filters),this.openCloseSearch(!1)},keyDownHandler:function(e){if(e.shiftKey&&"Slash"===e.code)this.isOpenWizPressed=!0;else{var _navigator=navigator,userAgentData=_navigator.userAgentData,platform=_navigator.platform,_ref3=userAgentData||{},userPlatform=_ref3.platform,currentOS=userPlatform||platform,isMac=currentOS.toUpperCase().indexOf("MAC")>=0;(isMac&&e.metaKey||!isMac&&e.ctrlKey)&&"Enter"===e.key&&this.applyFilter()}},keyUpHandler:function(){this.isOpenWizPressed&&(this.openCloseSearch(!0),this.isOpenWizPressed=!1)}})},search_AdvancedSearchvue_type_script_lang_js=AdvancedSearchvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(search_AdvancedSearchvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,AdvancedSearch=component.exports},
/***/520505:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return BulkActionBar}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/newapp/list/BulkActionBar.vue?vue&type=template&id=248f667a&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.visible?_c("div",{staticClass:"bulk-action-container"},[_c("span",[_vm._v(_vm._s(_vm.selectionText))]),_vm.isSelected?_c("span",{staticClass:"bulk-select-button",on:{click:_vm.toggleSelection}},[_vm._v(_vm._s(_vm.$t("filters.bulk_action.clear_selection")))]):_c("span",{staticClass:"bulk-select-button",on:{click:_vm.toggleSelection}},[_vm._v(_vm._s(_vm.$t("maintenance.pm.select_all")+" "+_vm.totalCount+" "+_vm.$t("filters.bulk_action.records")))])]):_vm._e()},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),defineProperty=__webpack_require__(482482),asyncToGenerator=__webpack_require__(548534),api=(__webpack_require__(634338),__webpack_require__(32284)),BulkActionBarvue_type_script_lang_js={name:"BulkActionBar",props:["totalCount","perPage","moduleName","visible","isAllSelected"],computed:{isSelected:{get:function(){return this.isAllSelected},set:function(value){this.$emit("update:isAllSelected",value)}},selectedCount:function(){var _ref=this||{},isSelected=_ref.isSelected,perPage=_ref.perPage,totalCount=_ref.totalCount;return isSelected?totalCount:perPage},selectionText:function(){var allText=this.$t("filters.bulk_action.all"),_ref2=this||{},selectedCount=_ref2.selectedCount,isSelected=_ref2.isSelected,selectText="";return selectText=isSelected?this.$t("filters.bulk_action.per_page_all_selected"):this.$t("filters.bulk_action.per_page_selected"),"".concat(allText," ").concat(selectedCount," ").concat(selectText)}},watch:{visible:function(value){value||(this.isSelected=!1)},isSelected:{handler:function(value){this.$emit("update:isAllSelected",value)},immediate:!0}},methods:{toggleSelection:function(){this.isSelected=!this.isSelected},updateRecord:function(params,filters){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var _ref3,moduleName,url,data,response;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _ref3=_this||{},moduleName=_ref3.moduleName,url="v3/bulkActionPatch/".concat(moduleName,"?filters=").concat(filters),data={moduleName:moduleName,data:(0,defineProperty/* default */.Z)({},moduleName,params)},_context.next=5,api/* API */.bl.post(url,data);case 5:return response=_context.sent,_context.abrupt("return",response);case 7:case"end":return _context.stop()}}),_callee)})))()},deleteRecord:function(filters){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var _ref4,moduleName,url,response;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _ref4=_this2||{},moduleName=_ref4.moduleName,url="v3/bulkActionDelete/".concat(moduleName,"?filters=").concat(filters),_context2.next=4,api/* API */.bl.post(url,{});case 4:return response=_context2.sent,_context2.abrupt("return",response);case 6:case"end":return _context2.stop()}}),_callee2)})))()},createRecord:function(params,filters){return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var url,response;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return url="v3/bulkAction/create?filters=".concat(filters),_context3.next=3,api/* API */.bl.post(url,params);case 3:return response=_context3.sent,_context3.abrupt("return",response);case 5:case"end":return _context3.stop()}}),_callee3)})))()}}},list_BulkActionBarvue_type_script_lang_js=BulkActionBarvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(list_BulkActionBarvue_type_script_lang_js,render,staticRenderFns,!1,null,"248f667a",null)
/* harmony default export */,BulkActionBar=component.exports},
/***/513868:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return HotTableWrapper}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/newcoms/HotTableWrapper.vue?vue&type=template&id=2dd8a344
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"hot-table-wrapper-container"},[_vm.$validation.isEmpty(_vm.hotTableSettingsData)?_vm._e():_c("div",{ref:"hotTableContainer",staticClass:"relative"},[_vm.isPasteInProgress?_c("div",{directives:[{name:"loading",rawName:"v-loading",value:_vm.isPasteInProgress,expression:"isPasteInProgress"}],staticClass:"loading-container"}):_vm._e(),_c("hot-table",{ref:"hotTableInstance",attrs:{settings:_vm.hotTableSettingsData}})],1),_vm.canShowInput?_c("el-input",{ref:"inputComponent",staticClass:"fc-handson-input hide",model:{value:_vm.proxyDataSetter,callback:function($$v){_vm.proxyDataSetter=$$v},expression:"proxyDataSetter"}}):_vm._e(),_vm.canShowSelect?_c("el-select",{key:"unit-dropdown",ref:"selectComponent",staticClass:"fc-handson-input hide",attrs:{"automatic-dropdown":!0,"popper-append-to-body":!1,placeholder:_vm.selectPlaceHolder,loading:(_vm.activeSelectField||{}).isSelectOptionsLoading||!1,"loading-text":_vm.$t("common._common.searching"),filterable:""},on:{change:_vm.handleSelectChange},nativeOn:{mousedown:function($event){return $event.stopPropagation(),function($event){return _vm.onMouseDownEvent($event)}.apply(null,arguments)},keydown:function($event){return $event.stopPropagation(),function($event){return _vm.onKeyDownEvent($event)}.apply(null,arguments)}},model:{value:_vm.proxyDataSetter,callback:function($$v){_vm.proxyDataSetter=$$v},expression:"proxyDataSetter"}},_vm._l(_vm.selectOptions,(function(option,index){return _c("el-option",{key:index,attrs:{label:option.label,value:option.value}})})),1):_vm._e(),_vm.canShowPicker?_c("f-date-picker",{ref:"pickerComponent",staticClass:"fc-input-full-border2 form-date-picker fc-handson-picker",attrs:{type:_vm.hotTableSettingsData.columns[_vm.activeColumnIndex].pickerType,format:_vm.EL_PICKER_DISPLAY_FORMAT,appendToBody:!1,arrowControl:!0},on:{pickerChange:function($event){return _vm.activeEditorInstance.finishEditing()}},nativeOn:{mousedown:function($event){return $event.stopPropagation(),function($event){return _vm.onMouseDownEvent($event)}.apply(null,arguments)}},model:{value:_vm.proxyDataSetter,callback:function($$v){_vm.proxyDataSetter=$$v},expression:"proxyDataSetter"}}):_vm._e(),_vm.canShowLookup?_c("FLookupField",{ref:"lookUpComponent",staticClass:"fc-handson-lookup",attrs:{model:_vm.proxyDataSetter,field:_vm.activeLookupField,popperAppendToBody:!1,skipLoading:!0,fetchOptionsMethod:_vm.getLookupOptions?_vm.getLookupOptionsForColumn:null,hideDropDown:_vm.$fieldUtils.isChooserTypeField(_vm.activeLookupField)&&!(_vm.activeLookupField.config||{}).isFiltersEnabled},on:{"update:model":function($event){_vm.proxyDataSetter=$event},recordSelected:_vm.handleRecordSelected,showLookupWizard:_vm.showLookupWizard},nativeOn:{mousedown:function($event){return $event.stopPropagation(),function($event){return _vm.onMouseDownEvent($event)}.apply(null,arguments)},keydown:function($event){return $event.stopPropagation(),function($event){return _vm.onKeyDownEvent($event)}.apply(null,arguments)}}}):_vm._e(),_vm.canShowLookupWizard?_c("div",[_c("FLookupFieldWizard",{attrs:{canShowLookupWizard:_vm.canShowLookupWizard,selectedLookupField:_vm.selectedLookupField,specialFilterValue:_vm.specialFilterValue},on:{"update:canShowLookupWizard":function($event){_vm.canShowLookupWizard=$event},"update:can-show-lookup-wizard":function($event){_vm.canShowLookupWizard=$event},setLookupFieldValue:_vm.setLookupFieldValue,closeWizard:_vm.handleCloseWizard}})],1):_vm._e(),_vm.canShowFilterDialog?_c("div",[_c("HandsonColumnFilter",{attrs:{canShowFilterDialog:_vm.canShowFilterDialog,currentFilterColumn:_vm.currentFilterColumn,filteredCondition:_vm.filteredCondition},on:{"update:canShowFilterDialog":function($event){_vm.canShowFilterDialog=$event},"update:can-show-filter-dialog":function($event){_vm.canShowFilterDialog=$event},"update:currentFilterColumn":function($event){_vm.currentFilterColumn=$event},"update:current-filter-column":function($event){_vm.currentFilterColumn=$event},"update:filteredCondition":function($event){_vm.filteredCondition=$event},"update:filtered-condition":function($event){_vm.filteredCondition=$event}}})],1):_vm._e()],1)},staticRenderFns=[],createForOfIteratorHelper=__webpack_require__(566347),slicedToArray=__webpack_require__(554621),constant=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(670560),__webpack_require__(162506),__webpack_require__(336585),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(354754)),validation=__webpack_require__(990260),vue_handsontable=__webpack_require__(366258),FDatePicker=__webpack_require__(358551),FLookupField=__webpack_require__(855048),FLookupFieldWizard=__webpack_require__(499751),HandsonColumnFiltervue_type_template_id_0e3067e1_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"handson-column-filter fc-dialog-center-container",attrs:{title:_vm.$t("commissioning.sheet.filter"),visible:_vm.canShowDialog,"append-to-body":!0,width:"30%"},on:{"update:visible":function($event){_vm.canShowDialog=$event}}},[_c("div",{staticClass:"height150"},[_c("div",{staticClass:"mT10"},[_vm._v(_vm._s(_vm.$t("commissioning.sheet.filter_by_value")))]),_c("div",[_c("el-input",{staticClass:"fc-input-full-border2 mT5",model:{value:_vm.searchText,callback:function($$v){_vm.searchText=$$v},expression:"searchText"}})],1)]),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.closeDialog}},[_vm._v("Cancel")]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:_vm.setFilter}},[_vm._v("Confirm")])],1)])},HandsonColumnFiltervue_type_template_id_0e3067e1_staticRenderFns=[],HandsonColumnFiltervue_type_script_lang_js=(__webpack_require__(879288),__webpack_require__(339772),{props:{canShowFilterDialog:{type:Boolean},currentFilterColumn:{type:Number},filteredCondition:{type:Array}},data:function(){return{searchText:""}},computed:{canShowDialog:{get:function(){return this.canShowFilterDialog},set:function(value){this.$emit("update:canShowFilterDialog",value)}},activeColumnIndex:{get:function(){return this.currentFilterColumn},set:function(value){this.$emit("update:currentFilterColumn",value)}},selectedColumn:function(){var filteredCondition=this.filteredCondition,activeColumnIndex=this.activeColumnIndex,selectedColumn={};return(0,validation/* isEmpty */.xb)(filteredCondition)||(selectedColumn=filteredCondition.find((function(condition){return condition.columnIndex===activeColumnIndex}))),selectedColumn},selectedColumnIndex:function(){var filteredCondition=this.filteredCondition,activeColumnIndex=this.activeColumnIndex,selectedColumnIndex=null;return(0,validation/* isEmpty */.xb)(filteredCondition)||(selectedColumnIndex=filteredCondition.findIndex((function(condition){return condition.columnIndex===activeColumnIndex}))),selectedColumnIndex}},created:function(){var selectedColumn=this.selectedColumn;if(!(0,validation/* isEmpty */.xb)(selectedColumn)){var searchText=selectedColumn.searchText;this.$set(this,"searchText",searchText)}},methods:{setFilter:function(){var searchText=this.searchText,filteredCondition=this.filteredCondition,activeColumnIndex=this.activeColumnIndex,selectedColumn=this.selectedColumn,selectedColumnIndex=this.selectedColumnIndex,conditionArr=filteredCondition;(0,validation/* isEmpty */.xb)(selectedColumn)?(0,validation/* isEmpty */.xb)(searchText)||conditionArr.push({columnIndex:activeColumnIndex,searchText:searchText}):(0,validation/* isEmpty */.xb)(searchText)?conditionArr.splice(selectedColumnIndex,1):selectedColumn.searchText=searchText,this.$emit("update:filteredCondition",conditionArr),this.closeDialog()},closeDialog:function(){this.canShowDialog=!1,this.activeColumnIndex=null}}}),handsontable_HandsonColumnFiltervue_type_script_lang_js=HandsonColumnFiltervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(handsontable_HandsonColumnFiltervue_type_script_lang_js,HandsonColumnFiltervue_type_template_id_0e3067e1_render,HandsonColumnFiltervue_type_template_id_0e3067e1_staticRenderFns,!1,null,null,null)
/* harmony default export */,HandsonColumnFilter=component.exports,hottableEvents=__webpack_require__(663763),hottableGetterSetter=__webpack_require__(906653),hottableSetup=__webpack_require__(580302),HotTableWrappervue_type_script_lang_js={components:{HotTable:vue_handsontable.HotTable,FDatePicker:FDatePicker/* default */.Z,FLookupField:FLookupField/* default */.Z,FLookupFieldWizard:FLookupFieldWizard["default"],HandsonColumnFilter:HandsonColumnFilter},mixins:[hottableEvents/* default */.Z,hottableGetterSetter/* default */.Z,hottableSetup/* default */.Z],props:{hotTableSettingsData:{type:Object,required:!0},isPasteInProgress:{type:Boolean},filterArr:{type:Array},getLookupOptions:{type:[Function,null]},getSelectOptions:{type:Function,default:function(){}},getDynamicPlaceHolder:{type:Function,default:function(){}},getSpecialFilterValue:{type:Function,default:function(){}},getReadingOptions:{type:Function,default:function(){}},onPasteEventHook:{type:Function,default:function(){}},afterPasteHook:{type:Function,default:function(){}},afterRowPaste:{type:Function,default:function(){}},handleAfterDocumentKeyDown:{type:Function,default:function(){}},preBeforePasteEventHanlder:{type:Function,default:function(){}},showEnumInputWizard:{type:Function,default:function(){}},resetActiveRowData:{type:Function,default:function(){}},showSetInputValues:{type:Function,default:function(){}},pasteDataMap:{type:Object},onAutoFillRowChange:{type:Function,default:function(){}},onRowChange:{type:Function,default:function(){}},showCustomFilter:{type:Boolean,default:!1},handleSorting:{type:Function,default:function(){}}},data:function(){return{EL_PICKER_DISPLAY_FORMAT:constant/* default */.Z.EL_PICKER_DISPLAY_FORMAT,canShowInput:!1,canShowSelect:!1,canShowPicker:!1,canShowLookup:!1,activePropName:null,activeRowIndex:null,activeColumnIndex:null,activeEditorInstance:null,isLoading:!0,canShowLookupWizard:!1,selectedLookupField:null,cellsErrorMap:{},canShowFilterDialog:!1,currentFilterColumn:null,specialFilterValue:{},physicalRowArr:[],previousData:null}},computed:{hotTableData:function(){var hotTableSettingsData=this.hotTableSettingsData,data=hotTableSettingsData.data;return data||[]},proxyDataSetter:{get:function(){var activeRowIndex=this.activeRowIndex,hotTableData=this.hotTableData,activePropName=this.activePropName,physicalRow=this.getPhysicalRowIndex(activeRowIndex),currentData=hotTableData[physicalRow]||{};return this.$getProperty(currentData,"".concat(activePropName),null)},set:function(value){var activeRowIndex=this.activeRowIndex,activePropName=this.activePropName,hotTableData=this.hotTableData,physicalRow=this.getPhysicalRowIndex(activeRowIndex),currentData=hotTableData[physicalRow]||{};this.$setProperty(currentData,"".concat(activePropName),value),
/*
          set property doesnot triggers the change, hence to rerender we're
          setting using Vue setter.
        */
this.$set(hotTableData,physicalRow,currentData)}},activeColumn:function(){var hotTableSettingsData=this.hotTableSettingsData,activeColumnIndex=this.activeColumnIndex,columns=hotTableSettingsData.columns;return(0,validation/* isEmpty */.xb)(columns)?{}:columns[activeColumnIndex]||{}},
// This field only exists if column of select type having different options for every row
activeSelectField:function(){var activeColumn=this.activeColumn;if(!(0,validation/* isEmpty */.xb)(activeColumn)){var field=activeColumn.field;return field||{}}return{}},activeLookupField:function(){var activeColumn=this.activeColumn;return activeColumn.field||null},selectOptions:{get:function(){var activeColumn=this.activeColumn,activeSelectField=this.activeSelectField;return(0,validation/* isEmpty */.xb)(activeSelectField)?activeColumn.options||[]:activeSelectField.options||[]},set:function(value){var activeColumn=this.activeColumn,activeSelectField=this.activeSelectField;(0,validation/* isEmpty */.xb)(activeSelectField)?this.$set(activeColumn,"options",value||[]):this.$set(activeSelectField,"options",value||[])}},selectPlaceHolder:function(){var activeColumn=this.activeColumn,activeRowIndex=this.activeRowIndex;if(!(0,validation/* isEmpty */.xb)(activeColumn)){var isDynamicPlaceHolderText=activeColumn.isDynamicPlaceHolderText;if(isDynamicPlaceHolderText){var text=this.getDynamicPlaceHolder({row:activeRowIndex});return text||""}var placeHolderText=activeColumn.placeHolderText;return placeHolderText||""}return""},filteredCondition:{get:function(){return this.filterArr||[]},set:function(value){this.$emit("update:filterArr",value)}}},created:function(){this.$set(this,"isLoading",!0),this.setupHotTableSettingsData(),this.$set(this,"isLoading",!1)},methods:{
/*
      Caching labels for selected options for both lookup and select fields
      Custom Renderer needs ID -> labels map to render
    */
cacheLookUpLabels:function(option){this.activeLookupField.optionsCache||this.$set(this.activeLookupField,"optionsCache",{}),this.$set(this.activeLookupField.optionsCache,option.value,option.label)},handleCloseWizard:function(data){var _data$field$selectedI,_this$getHotTableInst=this.getHotTableInstance(),hotInstance=_this$getHotTableInst.hotInstance;null!==(_data$field$selectedI=data.field.selectedItems[0])&&void 0!==_data$field$selectedI&&_data$field$selectedI.value&&(this.previousData.isAlreadyInvalid=!0,this.previousData.isValidEntry=!0,this.pushOrRemoveError(this.previousData)),hotInstance.render()},cacheSelectLabels:function(value){var activeSelectField=this.activeSelectField;if(!(0,validation/* isEmpty */.xb)(activeSelectField)&&!(0,validation/* isEmpty */.xb)(value)){var options=activeSelectField.options,_activeSelectField$op=activeSelectField.optionsCache,optionsCache=void 0===_activeSelectField$op?{}:_activeSelectField$op,selectedOption=options.find((function(option){return option.value===value}))||{},selectedOptionLabel=selectedOption.label||"";this.$set(optionsCache,value,selectedOptionLabel)}},setLookupFieldValue:function(props){var field=props.field,_ref=field||{},selectedItems=_ref.selectedItems,_selectedItems=(0,slicedToArray/* default */.Z)(selectedItems,1),selectedItem=_selectedItems[0],options=[],label=selectedItem.label,value=selectedItem.value;options=[{label:label,value:value}],this.$set(this.activeLookupField,"options",options),this.$set(this,"specialFilterValue",{}),this.proxyDataSetter=value,this.handleRecordSelected(selectedItem)},
/* Open dialog related methods */showLookupWizard:function(field,canShow){var activeColumnIndex=this.activeColumnIndex,activeRowIndex=this.activeRowIndex;if(this.$set(this,"selectedLookupField",field),this.$set(this,"canShowLookupWizard",canShow),(0,validation/* isFunction */.mf)(this.getSpecialFilterValue)){var filters=this.getSpecialFilterValue({row:activeRowIndex,column:activeColumnIndex});this.$set(this,"specialFilterValue",filters)}},openFilterDialog:function(column){var _ref2=this||{},showCustomFilter=_ref2.showCustomFilter;showCustomFilter?this.$emit("openCustomFilter",{column:column}):(this.$set(this,"canShowFilterDialog",!0),this.$set(this,"currentFilterColumn",column))},cellsErrorMaps:function(){var cellsErrorMap=this.cellsErrorMap;return cellsErrorMap},pushOrRemoveError:function(props){this.previousData=props;var isValidEntry=props.isValidEntry,isAlreadyInvalid=props.isAlreadyInvalid,id=props.id,propName=props.propName,cellsErrorMap=this.cellsErrorMap;if(id)if(isValidEntry){if(isAlreadyInvalid){cellsErrorMap[id].splice(cellsErrorMap[id].indexOf(propName),1);var isAllErrorsCleared=Object.entries(cellsErrorMap).every((function(_ref3){var _ref4=(0,slicedToArray/* default */.Z)(_ref3,2),value=_ref4[1];return(0,validation/* isEmpty */.xb)(value)}));isAllErrorsCleared&&(this.cellsErrorMap={})}}else(0,validation/* isEmpty */.xb)(cellsErrorMap[id])?cellsErrorMap[id]=[propName]:
// Don't have to push, if the entry is invalid again and again
isAlreadyInvalid||cellsErrorMap[id].push(propName)},clearRowError:function(id){var cellsErrorMap=this.cellsErrorMap;(0,validation/* isEmpty */.xb)(id)||(cellsErrorMap[id]=[],delete cellsErrorMap[id])},triggerValidate:function(props,callback){var _step,rows=props.rows,hotTableSettingsData=this.hotTableSettingsData,hotTableData=this.hotTableData,cellsErrorMap=this.cellsErrorMap,pasteDataMap=this.pasteDataMap,_ref5=hotTableSettingsData||{},columns=_ref5.columns,uniqueDataKey=_ref5.uniqueDataKey,_ref6=this.getHotTableInstance()||{},hotInstance=_ref6.hotInstance,_iterator=(0,createForOfIteratorHelper/* default */.Z)(rows);try{for(_iterator.s();!(_step=_iterator.n()).done;){var _step2,row=_step.value,_iterator2=(0,createForOfIteratorHelper/* default */.Z)(columns);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var column=_step2.value,required=column.required,validateFn=column.validateFn,data=column.data,cellType=column.cellType,rowData=hotTableData[row]||{},id=(0,validation/* isEmpty */.xb)(rowData)?null:rowData[uniqueDataKey],dataFromPasteMap=pasteDataMap[id]?pasteDataMap[id][data]:null,cellValue=dataFromPasteMap||this.$getProperty(rowData,data,null)||{},isValidEntry=!0;required&&!(0,validation/* isEmpty */.xb)(validateFn)&&(isValidEntry=validateFn({cellValue:cellValue,cellType:cellType,skipRowValidation:!0}));var isAlreadyInvalid=(cellsErrorMap[id]||[]).includes(data);isAlreadyInvalid||this.pushOrRemoveError({isValidEntry:isValidEntry,isAlreadyInvalid:isAlreadyInvalid,id:id,propName:data})}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}}catch(err){_iterator.e(err)}finally{_iterator.f()}(0,validation/* isEmpty */.xb)(cellsErrorMap)||hotInstance.render(),callback((0,validation/* isEmpty */.xb)(cellsErrorMap))},onEnumIconClick:function(rowIndex){this.showEnumInputWizard&&this.showEnumInputWizard(rowIndex)},_showSetInputValues:function(prop){return this.showSetInputValues(prop)}}},newcoms_HotTableWrappervue_type_script_lang_js=HotTableWrappervue_type_script_lang_js,HotTableWrapper_component=(0,componentNormalizer/* default */.Z)(newcoms_HotTableWrappervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,HotTableWrapper=HotTableWrapper_component.exports},
/***/549793:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return Planner}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/workorder/pm/create/pages/Planner.vue?vue&type=template&id=a3011b0e&scoped=true
var PlannerHotTable_render,PlannerHotTable_staticRenderFns,TaskCreation_render,TaskCreation_staticRenderFns,render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"planner-container"},[_c("div",{staticClass:"planner-header pm-content-width"},[_c("div",{staticClass:"section-heading mB10 mT20"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm.planner"))+" ")]),_c("div",{staticClass:"section-description"},[_vm._v(" "+_vm._s(_vm.getFormattedText(_vm.$t("maintenance.pm.planner_desc"),!0))+" ")])]),_vm.isPlannerListLoading||_vm.isPmLoading?_c("div",{staticClass:"width100"},[_c("div",{staticClass:"d-flex mT50 planner-body",class:_vm.isPlannerListLoading||_vm.isPmLoading?"planner-body-loading":""},[_c("Spinner",{attrs:{show:_vm.isPlannerListLoading||_vm.isPmLoading}})],1)]):_vm.$validation.isEmpty(_vm.plannerList)?_c("div",{staticClass:"planner-empty-state pm-content-width"},[_c("inline-svg",{attrs:{src:"svgs/emptystate/readings-empty",iconClass:"icon text-center icon-xxxxlg"}}),_c("div",{staticClass:"empty-state-txt"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm.no_planner"))+" ")]),_c("el-button",{staticClass:"save-button",attrs:{loading:_vm.isSavingPlanner},on:{click:_vm.addNewPlanner}},[_vm._v(_vm._s(_vm.$t("maintenance.pm.add_planner")))])],1):_c("div",{staticClass:"width100"},[_c("div",{staticClass:"planner-tab-container"},[_c("div",{staticClass:"pm-content-width flex"},[_vm._l(_vm.filteredPlannerList,(function(planner){return _c("div",{key:planner.id,staticClass:"planner-tab",class:planner.id===_vm.selectedPlanner?"selected-planner-tab":"",on:{click:function(){var args=[],len=arguments.length;while(len--)args[len]=arguments[len];return _vm.switchPlannerTab(args,planner)}}},[_c("div",[_vm._v(_vm._s(planner.name))]),_c("el-dropdown",{attrs:{trigger:"click"},on:{command:function(){var args=[],len=arguments.length;while(len--)args[len]=arguments[len];return _vm.handlePlannerActions(args,planner)}}},[_c("div",{staticClass:"more-icon"},[_c("fc-icon",{staticClass:"fwBold",attrs:{group:"default",name:"ellipsis-horizontal"}})],1),_c("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[_c("el-dropdown-item",{staticClass:"d-flex pT10",attrs:{command:"editPlanner"}},[_c("fc-icon",{staticClass:"mR2",attrs:{group:"default",name:"edit-solid",size:"16"}}),_c("span",{staticClass:"option-text"},[_vm._v(" "+_vm._s(_vm.$t("common._common.edit"))+" ")])],1),_c("el-dropdown-item",{staticClass:"d-flex pT10",attrs:{command:"deletePlanner"}},[_c("fc-icon",{staticClass:"mR2",attrs:{group:"default",name:"trash-can-solid",size:"16"}}),_c("span",{staticClass:"option-text"},[_vm._v(" "+_vm._s(_vm.$t("common._common.delete"))+" ")])],1)],1)],1)],1)})),_vm.$validation.isEmpty(_vm.dropDownPlannerList)?_vm._e():_c("el-dropdown",{attrs:{trigger:"click"},on:{command:_vm.moveTabSelection}},[_c("div",{staticClass:"flex align-center pR20 pL20 cursor-pointer height100"},[_c("i",{staticClass:"el-icon-more fwBold"})]),_c("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},_vm._l(_vm.dropDownPlannerList,(function(planner){return _c("el-dropdown-item",{key:planner.id,attrs:{command:planner.id}},[_vm._v(" "+_vm._s(planner.name)+" ")])})),1)],1),_c("div",{staticClass:"flex align-center pR20 pL20 cursor-pointer",on:{click:_vm.addNewPlanner}},[_vm.isSavingPlanner?_c("Spinner",{attrs:{size:"20",show:_vm.isSavingPlanner}}):_c("i",{staticClass:"el-icon-plus fwBold"})],1),_c("div")],2)]),_c("div",{staticClass:"width100 flex justify-center planner-body"},[_vm.isPlannerLoading?_c("div",{staticClass:"d-flex mT50 planner-body"},[_c("Spinner",{attrs:{show:_vm.isPlannerLoading}})],1):_c("div",{staticClass:"pm-content-width mT20"},[_c("TriggerSection",{attrs:{pmProps:_vm.pmProps,planner:_vm.selectedPlannerRecord,reloadPlanner:_vm.loadPlanner,trigger:_vm.trigger,pmRecord:_vm.pmRecord,showTaskButton:_vm.isJobPlanEmpty},on:{openTaskDialog:_vm.openTaskDialog}}),_c("div",{staticClass:"section-divider"}),_c("TaskSection",{attrs:{showTaskDialog:_vm.showTaskDialog,closeDialog:function(){return _vm.showTaskDialog=!1},reloadPlanner:_vm.loadPlanner,pmRecord:_vm.pmRecord,planner:_vm.selectedPlannerRecord},on:{"update:showTaskDialog":function($event){_vm.showTaskDialog=$event},"update:show-task-dialog":function($event){_vm.showTaskDialog=$event}}}),_vm.isJobPlanEmpty?_vm._e():_c("div",{staticClass:"section-divider"}),_c("ResourcePlanner",{attrs:{pmRecord:_vm.pmRecord,planner:_vm.selectedPlannerRecord}}),_c("div",{staticClass:"section-divider"})],1)])]),_vm.showPlannerEdit?_c("EditPlanner",{attrs:{planner:_vm.selectedPlannerAction,closeDialog:function(){return _vm.showPlannerEdit=!1},onSave:_vm.loadPlanners}}):_vm._e()],1)},staticRenderFns=[],slicedToArray=__webpack_require__(554621),objectSpread2=__webpack_require__(595082),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),api=(__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(648324),__webpack_require__(689730),__webpack_require__(564043),__webpack_require__(857267),__webpack_require__(976801),__webpack_require__(425728),__webpack_require__(162506),__webpack_require__(670560),__webpack_require__(32284)),validation=__webpack_require__(990260),Spinner=__webpack_require__(604947),TriggerSectionvue_type_template_id_72734da2_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("div",{staticClass:"mT5 planner-trigger-section"},[_c("div",{staticClass:"planner-tab-header"},[_c("div",{staticClass:"section-sub-heading"},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.trigger"))+" ")]),_c("div",{staticClass:"flex flex-no-wrap mT10 justify-between"},[_c("div",{staticClass:"section-description width60"},[_vm._v(" "+_vm._s(_vm.getFormattedText(_vm.$t("maintenance.pm.trigger_desc")))+" ")]),_vm.isEdit?_vm._e():_c("el-button",{staticClass:"add-trigger-btn",on:{click:_vm.openTrigger}},[_vm._v(_vm._s(_vm.$t("maintenance.pm.add_trigger")))])],1),_vm.isEdit?_c("div",{staticClass:"trigger-edit-section"},[_vm.isLoading?_c("div",{staticClass:"width100 flex-center-vH"},[_c("spinner",{attrs:{show:_vm.isLoading,size:"30"}})],1):[_c("div",{staticClass:"d-flex items-center"},[_c("div",{staticClass:"pm-green-dot mR8"}),_vm._v(" "+_vm._s(_vm.frequencyType)+" ")]),_c("div",{staticClass:"d-flex text-center items-center"},[_c("div",{staticClass:"mL10 pointer",on:{click:_vm.openTrigger}},[_c("fc-icon",{attrs:{group:"default",name:"edit-solid",size:"16"}})],1),_c("div",[_vm.isDeleting?_c("spinner",{staticClass:"mL10",attrs:{size:"20",show:_vm.isDeleting}}):_c("div",{staticClass:"mL10 pointer",on:{click:_vm.resetTrigger}},[_c("fc-icon",{staticClass:"mR2",attrs:{group:"default",name:"trash-can-solid",size:"16"}})],1)],1)])]],2):_vm._e()]),_vm.openTriggerDialog?_c("el-dialog",{staticClass:"fc-dialog-center-container new-add-triger-dialog fc-dialog-header-hide",attrs:{visible:_vm.openTriggerDialog,"append-to-body":!0},on:{"update:visible":function($event){_vm.openTriggerDialog=$event}}},[_vm.isLoading?_c("div",[_c("spinner",{attrs:{show:_vm.isLoading,size:"80"}})],1):[_c("div",{staticClass:"positon-relative trigger-dialog-body"},[_c("trigger",{attrs:{trigger:_vm.triggerEdit,customTriggerTypes:[1],pmProps:_vm.pmProps}})],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.cancel}},[_vm._v(_vm._s(_vm.$t("maintenance._workorder.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.isSaving},on:{click:_vm.save}},[_vm._v(_vm._s(_vm.$t("maintenance._workorder.save")))])],1)]],2):_vm._e()],1),_vm._e()])},TriggerSectionvue_type_template_id_72734da2_staticRenderFns=[],Triggervue_type_template_id_091715ec_render=(__webpack_require__(169358),function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"pm-tigger-dialog-form"},[_c("div",{staticClass:"pm-tigger-dialog-form-left",class:{"triger-right-side-width":!(1===_vm.trigger.type&&0!==_vm.trigger.schedule.frequencyType)}},[_c("div",{staticClass:"label-txt-black text-uppercase fwBold trigger-header-left"},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.trigger"))+" ")]),_c("div",{staticClass:"pL30 pR30"},[1===_vm.trigger.type?_c("schedule-trigger",{attrs:{trigger:_vm.trigger,canShowCustomFrequency:!0,fromPage:"pmtrigger"}}):_vm._e()],1)]),1===_vm.trigger.type&&0!==_vm.trigger.schedule.frequencyType?[_c("div",{staticClass:"pm-tigger-dialog-form-right",class:{"triger-right-side-hide":!(1===_vm.trigger.type&&0!==_vm.trigger.schedule.frequencyType)}},[_c("div",[_c("div",{staticClass:"flex-middle pm-trigger-left-header"},[_c("InlineSvg",{attrs:{src:"svgs/schedule",iconClass:"icon icon-md new-icon"}}),_c("div",{staticClass:"label-txt-black fwBold mL10"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm.next_ten",{totalSchedules:_vm.totalSchedules}))+" ")])],1),_c("div",{staticClass:"pR30 pL30 pT20"},[_c("scheduled-dates",{attrs:{trigger:_vm.trigger},on:{setTotalSchedules:_vm.setTotalSchedules}})],1)])])]:_vm._e()],2)}),Triggervue_type_template_id_091715ec_staticRenderFns=[],PMTrigger=__webpack_require__(438817),Triggervue_type_script_lang_js={name:"Trigger",extends:PMTrigger/* default */.Z,props:["pmProps"],data:function(){return{totalSchedules:10}},methods:{setTotalSchedules:function(schedules){this.$set(this,"totalSchedules",schedules)}}},planner_Triggervue_type_script_lang_js=Triggervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(planner_Triggervue_type_script_lang_js,Triggervue_type_template_id_091715ec_render,Triggervue_type_template_id_091715ec_staticRenderFns,!1,null,null,null)
/* harmony default export */,Trigger=component.exports,pm_utils=__webpack_require__(195123),SeasonTriggerMixin=__webpack_require__(747192),TriggerSectionvue_type_script_lang_js={props:["pmProps","planner","reloadPlanner","trigger","showTaskButton","pmRecord"],mixins:[SeasonTriggerMixin/* default */.Z],components:{Trigger:Trigger},data:function(){return{triggerEdit:null,openTriggerDialog:!1,isSaving:!1,moduleName:"pmTriggerV2",isLoading:!1,isDeleting:!1}},computed:{isEdit:function(){var _ref=this||{},planner=_ref.planner,_ref2=planner||{},trigger=_ref2.trigger,_ref3=trigger||{},id=_ref3.id;return id},frequencyType:function(){var frequencyType=this.$getProperty(this,"triggerEdit.schedule.frequencyType",""),facilioFrequency=this.$getProperty(this,"$constants.FACILIO_FREQUENCY");if(!(0,validation/* isEmpty */.xb)(frequencyType)){var frequencyValue=facilioFrequency[frequencyType];return(0,validation/* isEmpty */.xb)(frequencyValue)?frequencyType:frequencyValue}return"---"}},watch:{trigger:{handler:function(){var _ref4=this||{},isEdit=_ref4.isEdit;isEdit?this.loadTrigger():this.initTrigger()},deep:!0,immediate:!0}},methods:{getFormattedText:function(text,isUpperCase){var _ref5=this||{},pmRecord=_ref5.pmRecord;return(0,pm_utils/* getPlaceholderText */.Sb)({pmRecord:pmRecord,text:text,isUpperCase:isUpperCase})},openTaskDialog:function(){this.$emit("openTaskDialog")},openTrigger:function(){var trigger=this.trigger,isEdit=this.isEdit;isEdit&&(this.triggerEdit=this.deserializeTrigger(trigger)),this.openTriggerDialog=!0},resetTrigger:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var _ref6,planner,trigger,_ref7,id,params,_yield$API$updateReco,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _this.isDeleting=!0,_ref6=_this||{},planner=_ref6.planner,trigger=null,_ref7=planner||{},id=_ref7.id,params={id:id,data:{trigger:trigger}},_context.next=7,api/* API */.bl.updateRecord("pmPlanner",params);case 7:_yield$API$updateReco=_context.sent,error=_yield$API$updateReco.error,(0,validation/* isEmpty */.xb)(error)?(_this.$message.success(_this.$t("maintenance.pm.planner_update")),_this.openTriggerDialog=!1,_this.reloadPlanner()):_this.$message.error(error.message||"Error Occured"),_this.isDeleting=!1;case 11:case"end":return _context.stop()}}),_callee)})))()},initTrigger:function(){var type=1,startDate=new Date;startDate.setHours(0,0,0,0);var startTime=startDate.getTime(),name="Trigger";this.triggerEdit={name:name,type:type,startDate:startDate,startTime:startTime,basedOn:"Date",schedule:{times:["00:00"],frequency:1,skipEvery:-1,values:[],frequencyType:1,weekFrequency:-1,yearlyDayValue:null,monthValue:-1,yearlyDayOfWeekValues:[]},customTrigger:{customModuleId:null,fieldId:null,days:null,hours:null},stopAfter:"never",endTime:new Date,startReading:null,readingFieldId:null,stopAfterReading:"never",endReading:null,readingInterval:null,assignedTo:null,reminders:[],criteria:null,sharingContext:{shareTo:2,sharedRoles:[],sharedUsers:[],sharedGroups:[]}}},cancel:function(){var _ref8=this||{},isEdit=_ref8.isEdit,trigger=_ref8.trigger;isEdit?(0,validation/* isEmpty */.xb)(trigger)||(this.triggerEdit=this.deserializeTrigger(trigger)):this.initTrigger(),this.openTriggerDialog=!1},loadTrigger:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var _ref9,trigger,moduleName,_ref10,id,_yield$API$fetchRecor,record;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _this2.isLoading=!0,_ref9=_this2||{},trigger=_ref9.trigger,moduleName=_ref9.moduleName,_ref10=trigger||{},id=_ref10.id,_context2.next=5,api/* API */.bl.fetchRecord(moduleName,{id:id});case 5:_yield$API$fetchRecor=_context2.sent,record=_yield$API$fetchRecor[moduleName],_this2.triggerEdit=_this2.deserializeTrigger(record),_this2.isLoading=!1;case 9:case"end":return _context2.stop()}}),_callee2)})))()},deserializeTrigger:function(trigger){var schedule=trigger.schedule;if(!(0,validation/* isEmpty */.xb)(schedule)){schedule=JSON.parse(schedule);var _ref11=schedule||{},frequencyType=_ref11.frequencyType,basedOn="";return basedOn=["MONTHLY_DATE","QUARTERLY_DATE","HALF_YEARLY_DATE","ANNUALLY_DATE"].includes(pm_utils/* FREQUENCY_HASH */.UC[frequencyType])?"Date":"Week",["MONTHLY_DATE","MONTHLY_WEEK"].includes(pm_utils/* FREQUENCY_HASH */.UC[frequencyType])?frequencyType=3:["QUARTERLY_DATE","QUARTERLY_WEEK"].includes(pm_utils/* FREQUENCY_HASH */.UC[frequencyType])?frequencyType=4:["HALF_YEARLY_DATE","HALF_YEARLY_WEEK"].includes(pm_utils/* FREQUENCY_HASH */.UC[frequencyType])?frequencyType=5:["ANNUALLY_DATE","ANNUALLY_WEEK"].includes(pm_utils/* FREQUENCY_HASH */.UC[frequencyType])&&(frequencyType=6),schedule=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},schedule),{},{frequencyType:frequencyType}),(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},trigger),{},{schedule:schedule,basedOn:basedOn,frequency:frequencyType})}return trigger},serializeTrigger:function(){var _ref12=this||{},triggerEdit=_ref12.triggerEdit,pmProps=_ref12.pmProps,frequencyEnum=_ref12.frequencyType,_ref13=triggerEdit||{},schedule=_ref13.schedule,startDate=_ref13.startDate,basedOn=_ref13.basedOn,_ref14=schedule||{},frequencyType=_ref14.frequencyType,endDate=_ref14.endDate,_ref15=pmProps||{},pmId=_ref15.id;"Monthly"===frequencyEnum?frequencyType="Date"===basedOn?3:4:"Quarterly"===frequencyEnum?frequencyType="Date"===basedOn?7:8:"Half Yearly"===frequencyEnum?frequencyType="Date"===basedOn?9:10:"Annually"===frequencyEnum&&(frequencyType="Date"===basedOn?5:6),schedule=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},schedule),{},{frequencyType:frequencyType});var trigger=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},triggerEdit),{},{frequency:frequencyType,endTime:endDate,startDate:startDate,frequencyType:frequencyType,schedule:JSON.stringify(schedule),pmId:pmId});return trigger},save:function(){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var _ref16,planner,trigger,_ref17,id,params,_yield$API$updateReco2,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,_this3.canSaveTrigger();case 2:if(_context3.sent){_context3.next=4;break}return _context3.abrupt("return");case 4:return _this3.isSaving=!0,_ref16=_this3||{},planner=_ref16.planner,trigger=_this3.serializeTrigger(trigger),_ref17=planner||{},id=_ref17.id,params={id:id,data:{trigger:trigger}},_context3.next=11,api/* API */.bl.updateRecord("pmPlanner",params);case 11:_yield$API$updateReco2=_context3.sent,error=_yield$API$updateReco2.error,(0,validation/* isEmpty */.xb)(error)?(_this3.$message.success(_this3.$t("maintenance.pm.planner_update")),_this3.openTriggerDialog=!1,_this3.reloadPlanner()):_this3.$message.error(error.message||"Error Occured"),_this3.isSaving=!1;case 15:case"end":return _context3.stop()}}),_callee3)})))()}}},planner_TriggerSectionvue_type_script_lang_js=TriggerSectionvue_type_script_lang_js,TriggerSection_component=(0,componentNormalizer/* default */.Z)(planner_TriggerSectionvue_type_script_lang_js,TriggerSectionvue_type_template_id_72734da2_render,TriggerSectionvue_type_template_id_72734da2_staticRenderFns,!1,null,null,null)
/* harmony default export */,TriggerSection=TriggerSection_component.exports,ResourcePlannervue_type_template_id_44908059_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"mT5"},[_vm.isLoading?_c("div",{staticClass:"d-flex mT50 planner-body"},[_c("Spinner",{attrs:{show:_vm.isLoading}})],1):[_c("div",{staticClass:"section-sub-heading"},[_vm._v(" "+_vm._s(_vm.resourcePlaceholder+" "+_vm.$t("maintenance.pm.resource_planner"))+" ")]),_c("div",{staticClass:"flex flex-no-wrap mT10 justify-between"},[_c("div",{staticClass:"section-description width60"},[_vm._v(" "+_vm._s(_vm.getFormattedText(_vm.$t("maintenance.pm.resource_planner_desc")))+" ")]),_c("el-button",{staticClass:"add-config-btn",on:{click:_vm.setSelectorField}},[_vm._v(_vm._s(_vm.getFormattedText(_vm.$t("maintenance.pm.add_resources"),!0)))])],1),_vm.isConfigured?_c("div",{staticClass:"resource-planner-section"},[_c("div",{staticClass:"planner-text text-center width70 mT5"},[_vm._v(" "+_vm._s(_vm.heading)+" ")]),_c("div",{staticClass:"mT10 mB10"},[_c("div",{staticClass:"add-link",on:{click:_vm.openResourceSheet}},[_vm._v(" "+_vm._s(_vm.getFormattedText(_vm.$t("maintenance.pm.view_resources"),!0))+" ")])]),_vm.isConfigured?_vm._e():_c("div",{staticClass:"width40 text-center"},[_vm._v(" "+_vm._s(_vm.getFormattedText(_vm.$t("maintenance.pm.resource_section_desc")))+" ")])]):_vm._e(),_vm.showResourceSelector?_c("ResourceSelector",{attrs:{canShowLookupWizard:_vm.showResourceSelector,field:_vm.selectorField,planner:_vm.planner,pmRecord:_vm.pmRecord},on:{"update:canShowLookupWizard":function($event){_vm.showResourceSelector=$event},"update:can-show-lookup-wizard":function($event){_vm.showResourceSelector=$event},setLookupFieldValue:_vm.setResourceSelection,closeWizard:_vm.closeWizard}}):_vm._e(),_vm.canShowFieldSelector?_c("PlannerFieldSelector",{attrs:{closeDialog:function(){return _vm.canShowFieldSelector=!1},bulkCreateResources:_vm.bulkCreateResources,reloadPlanner:_vm.loadResourcePlanner,pmRecord:_vm.pmRecord,isBulkSelect:_vm.isBulkSelect,totalCount:_vm.totalCount}}):_vm._e(),_vm.showPlannerSheet?_c("PlannerSheet",{attrs:{closeDialog:_vm.closePlannerSheet,planner:_vm.planner,pmRecord:_vm.pmRecord,resourcePlaceholder:_vm.resourcePlaceholder}}):_vm._e()]],2)},ResourcePlannervue_type_template_id_44908059_staticRenderFns=[],defineProperty=__webpack_require__(482482),toConsumableArray=__webpack_require__(488478),ResourceSelectorvue_type_template_id_1240c916_scoped_true_render=(__webpack_require__(634338),__webpack_require__(450886),__webpack_require__(919649),__webpack_require__(821694),__webpack_require__(76265),function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"fc-dialog-center-container f-lookup-wizard scale-up-center fc-wizard-table-width100",attrs:{visible:_vm.canShowWizard,width:"70%",top:"5vh","append-to-body":!0,"show-close":!1,"before-close":_vm.closeWizard,"close-on-click-modal":!1},on:{"update:visible":function($event){_vm.canShowWizard=$event}}},[_c("template",{slot:"title"},[_c("div",{staticClass:"flex items-center"},[_c("div",{staticClass:"lookup-wizard-title"},[_vm._v(" "+_vm._s(_vm.title)+" ")]),_c("div",{staticClass:"ml-auto flex items-center"},[_c("div",{staticClass:"resource-filter-icon"},[_c("AdvancedSearch",{key:_vm.moduleName+"-search",attrs:{moduleName:_vm.moduleName,moduleDisplayName:_vm.moduleDisplayName,hideQuery:!0,onSave:_vm.applyFilters,filterList:_vm.filters},scopedSlots:_vm._u([{key:"icon",fn:function(){return[_c("el-badge",{staticClass:"item",attrs:{"is-dot":"",hidden:_vm.$validation.isEmpty(_vm.filters)}},[_c("div",{staticClass:"resource-icons"},[_c("InlineSvg",{staticClass:"fc-grey-svg2",staticStyle:{top:"2px"},attrs:{src:"svgs/filter2",iconClass:"icon icon-sm"}})],1)])]},proxy:!0}])})],1),_c("span",{staticClass:"separator"},[_vm._v("|")]),_c("pagination",{staticClass:"self-center",attrs:{currentPage:_vm.page,total:_vm.totalCount,perPage:_vm.perPage},on:{"update:currentPage":function($event){_vm.page=$event},"update:current-page":function($event){_vm.page=$event}}}),_vm.totalCount?_c("span",{staticClass:"separator"},[_vm._v("|")]):_vm._e(),_c("div",{staticClass:"el-dialog__close el-icon el-icon-close close-icon cursor-pointer resource-icons",on:{click:_vm.closeWizard}})],1)])]),_vm.showFTags?_c("div",{staticClass:"wizard-f-tag-container"},[_c("FTags",{attrs:{moduleName:_vm.moduleName,filters:_vm.filters,hideQuery:!0,hideSaveAs:!0},on:{updateFilters:_vm.updateFilters,clearFilters:function($event){return _vm.applyFilters({filters:{}})}}})],1):_vm._e(),_vm.isLoading?_c("div",{staticClass:"f-ui-lookup-empty"},[_c("Spinner",{attrs:{show:_vm.isLoading,size:"80"}})],1):_vm.$validation.isEmpty(_vm.moduleList)?_c("div",{staticClass:"f-ui-lookup-empty"},[_c("img",{staticClass:"mT20",attrs:{src:__webpack_require__(15482),width:"100",height:"100"}}),_c("div",{staticClass:"mT10 label-txt-black f14"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm.no_module_available",{moduleName:_vm.moduleDisplayName?_vm.moduleDisplayName.toLowerCase():_vm.moduleName}))+" ")])]):_c("div",{staticClass:"f-ui-lookup-table-container"},[_c("div"),_c("div",{staticClass:"flex flex-wrap w-10/12"},[_vm.$validation.isEmpty(_vm.selectedItem)?_vm._e():_c("div",{staticClass:"pT20 pL20 pB10 fc-black-color letter-spacing0_5 f13 bold d-flex items-baseline flex-direction-row flex-wrap"},[[_c("div",{staticClass:"mR10 mB10 mT5 flex-shrink-0"},[_vm._v(_vm._s(_vm.selectedLabel))]),_vm._l(_vm.filteredSelectedItems,(function(name,index){return _c("div",{key:index,staticClass:"action-badge mR10 mb5"},[_vm._v(" "+_vm._s(name)+" "),_vm.multiSelect?_c("i",{staticClass:"el-icon-close pointer",on:{click:function($event){return _vm.handleSelectedClose(name)}}}):_vm._e()])})),0!==_vm.selectedRemainingCount?_c("div",{staticClass:"action-badge mR10 mb5"},[_vm._v(" +"+_vm._s(_vm.selectedRemainingCount)+" ")]):_vm._e()]],2)]),_c("BulkActionBar",{ref:"bulk-action-bar",attrs:{visible:_vm.showBulkBar,totalCount:_vm.totalCount,perPage:_vm.perPage,isAllSelected:_vm.isAllSelected,moduleName:_vm.moduleName},on:{"update:isAllSelected":function($event){_vm.isAllSelected=$event},"update:is-all-selected":function($event){_vm.isAllSelected=$event}}}),_vm.isEmpty(_vm.moduleList)?_vm._e():_c("CommonList",{ref:"lookupCommonList",attrs:{viewDetail:_vm.viewDetail,records:_vm.moduleList,moduleName:_vm.moduleName,slotList:_vm.slotList,columnConfig:_vm.columnConfig,hideListSelect:!_vm.multiSelect},on:{"selection-change":_vm.handleSelection,selectAll:_vm.selectAll},scopedSlots:_vm._u([{key:"select",fn:function(ref){var record=ref.record;return[_vm.multiSelect?_vm._e():_c("el-radio",{attrs:{label:record.id},on:{change:_vm.setSelectedItem},model:{value:_vm.selectedItemId,callback:function($$v){_vm.selectedItemId=$$v},expression:"selectedItemId"}})]}},_vm.$validation.isEmpty(_vm.actualMainfield)?{key:_vm.slotList[1].name,fn:function(ref){var record=ref.record;return[_vm._v(" "+_vm._s(_vm.getMainFieldValue(record)))]}}:{key:_vm.slotList[1].criteria,fn:function(ref){var record=ref.record;return[_vm._v(" "+_vm._s(_vm.getMainFieldValue(record)))]}}],null,!0)}),_c("div",{staticClass:"footer-container"},[_c("el-button",{staticClass:"resource-selector-save",attrs:{type:"primary"},on:{click:_vm.saveSelected}},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm.proceed"))+" ")]),_c("el-button",{staticClass:"resource-selector-cancel",attrs:{type:"primary"},on:{click:_vm.closeWizard}},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.cancel"))+" ")])],1)],1),_vm.showProgressDialog?_c("BulkSaveDialog",{attrs:{closeDialog:_vm.clearSelection,totalCount:_vm.totalCount,saveRecord:_vm.selectAllSave},on:{cancel:_vm.clearSelection}}):_vm._e()],2)}),ResourceSelectorvue_type_template_id_1240c916_scoped_true_staticRenderFns=[],ui_forms=__webpack_require__(141323),app=__webpack_require__(782080),WidgetPagination=__webpack_require__(806339),AdvancedSearch=__webpack_require__(784823),dist=__webpack_require__(191853),BulkActionBar=__webpack_require__(520505),BulkSaveDialogvue_type_template_id_239e7dda_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"pm-bulk-save-dialog",attrs:{visible:!0,"before-close":function(){},"append-to-body":!0,"show-close":!1,width:"36%",top:"30vh"}},[_c("div",{staticClass:"bulk-save-dialog-heading"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm.all_records_selected"))+" ")]),_c("div",{staticClass:"bulk-save-dialog-sub-heading"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm.save_prompt_1")+" "+_vm.totalCount+" "+_vm.$t("maintenance.pm.save_prompt_2"))+" ")]),_c("div",{staticClass:"flex"},[_c("el-button",{staticClass:"progress-cancel",on:{click:_vm.undoSelection}},[_vm._v(_vm._s(_vm.$t("maintenance.pm.cancel_progress")))]),_c("el-button",{staticClass:"progress-save",on:{click:_vm.saveRecord}},[_vm._v(_vm._s(_vm.$t("maintenance.pm.save_all")+" ("+_vm.totalCount+")"))])],1)])},BulkSaveDialogvue_type_template_id_239e7dda_scoped_true_staticRenderFns=[],BulkSaveDialogvue_type_script_lang_js={props:["closeDialog","totalCount","saveRecord"],methods:{undoSelection:function(){this.$emit("cancel")}}},planner_BulkSaveDialogvue_type_script_lang_js=BulkSaveDialogvue_type_script_lang_js,BulkSaveDialog_component=(0,componentNormalizer/* default */.Z)(planner_BulkSaveDialogvue_type_script_lang_js,BulkSaveDialogvue_type_template_id_239e7dda_scoped_true_render,BulkSaveDialogvue_type_template_id_239e7dda_scoped_true_staticRenderFns,!1,null,"239e7dda",null)
/* harmony default export */,BulkSaveDialog=BulkSaveDialog_component.exports,MAX_SELECTION=5,ResourceSelectorvue_type_script_lang_js={name:"ResourceSelector",props:["planner","pmRecord"],extends:ui_forms/* LookupWizard */.ns,components:{Pagination:WidgetPagination/* default */.Z,Spinner:Spinner/* default */.Z,CommonList:app/* CommonList */.lv,AdvancedSearch:AdvancedSearch/* default */.Z,FTags:dist/* FTags */.KW,BulkActionBar:BulkActionBar/* default */.Z,BulkSaveDialog:BulkSaveDialog},data:function(){return{filters:null,columnConfig:{},isAllSelected:!1,showBulkActionBar:!1,showProgressDialog:!1}},computed:{showBulkBar:function(){var _ref=this||{},showBulkActionBar=_ref.showBulkActionBar,totalCount=_ref.totalCount,perPage=_ref.perPage;return showBulkActionBar&&totalCount>perPage},title:function(){var _ref2=this||{},pmRecord=_ref2.pmRecord,placeholder=(0,pm_utils/* getResourcePlaceholder */.$A)(pmRecord,!0);return"Select ".concat(placeholder)},showFTags:function(){var filters=this.filters;return!(0,validation/* isEmpty */.xb)(filters)},moduleDisplayName:function(){var _ref3=this||{},pmRecord=_ref3.pmRecord;return(0,pm_utils/* getResourcePlaceholder */.$A)(pmRecord,!0)},filteredSelectedItems:function(){var _ref4=this||{},selectedItemName=_ref4.selectedItemName;return(selectedItemName||[]).filter((function(_,index){return index<MAX_SELECTION}))},selectedRemainingCount:function(){var _ref5=this||{},length=_ref5.selectedListLength;return length>MAX_SELECTION?Math.abs(length-MAX_SELECTION):0},selectedListLength:function(){var _ref6=this||{},selectedItem=_ref6.selectedItem,_ref7=selectedItem||{},length=_ref7.length;return length},customFilters:function(){var _ref8=this||{},field=_ref8.field,_ref9=field||{},filters=_ref9.filters;return filters||{}}},watch:{isAllSelected:function(value){value&&(this.showProgressDialog=!0)}},methods:{saveSelected:function(){var _ref10=this||{},selectedItem=_ref10.selectedItem;(0,validation/* isEmpty */.xb)(selectedItem)?this.$message.error(this.$t("maintenance.pm.resources_proceed")):this.setSelectedItem()},selectAll:function(){var _ref11=this||{},selectedItem=_ref11.selectedItem;(0,validation/* isEmpty */.xb)(selectedItem)?this.showBulkActionBar=!1:this.showBulkActionBar=!0},closeWizard:function(){this.$emit("closeWizard")},applyFilters:function(_ref12){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var filters;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return filters=_ref12.filters,_this.isLoading=!0,_this.filters=filters,_this.selectedItem=[],_this.showBulkActionBar=!1,_context.next=7,_this.fetchModuleList();case 7:_this.isLoading=!1;case 8:case"end":return _context.stop()}}),_callee)})))()},fetchModuleList:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var _ref13,moduleName,page,perPage,planner,customFilters,filters,_ref14,id,params,_yield$API$fetchAll,list,error,meta;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _ref13=_this2||{},moduleName=_ref13.moduleName,page=_ref13.page,perPage=_ref13.perPage,planner=_ref13.planner,customFilters=_ref13.customFilters,filters=_ref13.filters,(0,validation/* isEmpty */.xb)(customFilters)||(filters=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},filters),customFilters)),"asset"===moduleName&&(filters=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},filters),{},{storeRoom:{operatorId:1}})),_ref14=planner||{},id=_ref14.id,params={viewname:"hidden-all",includeParentFilter:!0,page:page,perPage:perPage,withCount:!0,plannerId:id},(0,validation/* isEmpty */.xb)(filters)||(params["filters"]=JSON.stringify(filters)),_context2.next=8,api/* API */.bl.fetchAll(moduleName,params);case 8:_yield$API$fetchAll=_context2.sent,list=_yield$API$fetchAll.list,error=_yield$API$fetchAll.error,meta=_yield$API$fetchAll.meta,(0,validation/* isEmpty */.xb)(error)&&(_this2.moduleList=list,_this2.totalCount=_this2.$getProperty(meta,"pagination.totalCount",0));case 13:case"end":return _context2.stop()}}),_callee2)})))()},handleSelection:function(selectedList){(0,validation/* isEmpty */.xb)(selectedList)&&(this.showBulkActionBar=!1);var _ref15=this||{},mainFieldName=_ref15.mainFieldName,nonCurrentItems=this.getNonCurrentList(this.selectedItem),currentItems=(selectedList||[]).map((function(list){var id=list.id;return{label:list[mainFieldName],value:id}}));this.selectedItem=[].concat((0,toConsumableArray/* default */.Z)(nonCurrentItems),(0,toConsumableArray/* default */.Z)(currentItems))},clearSelection:function(){this.showProgressDialog=!1,this.isAllSelected=!1},selectAllSave:function(){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var _ref16,field,filters,totalCount;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_ref16=_this3||{},field=_ref16.field,filters=_ref16.filters,totalCount=_ref16.totalCount,_this3.$emit("setLookupFieldValue",{field:field,isBulkSelect:!0,filters:filters||{},totalCount:totalCount});case 2:case"end":return _context3.stop()}}),_callee3)})))()}}},planner_ResourceSelectorvue_type_script_lang_js=ResourceSelectorvue_type_script_lang_js,ResourceSelector_component=(0,componentNormalizer/* default */.Z)(planner_ResourceSelectorvue_type_script_lang_js,ResourceSelectorvue_type_template_id_1240c916_scoped_true_render,ResourceSelectorvue_type_template_id_1240c916_scoped_true_staticRenderFns,!1,null,"1240c916",null)
/* harmony default export */,ResourceSelector=ResourceSelector_component.exports,PlannerFieldSelectorvue_type_template_id_4b515a73_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"planner-selector-dialog",attrs:{visible:!0,"before-close":_vm.closeDialog,title:"","show-close":!1,width:"40%","close-on-click-modal":!1}},[_vm.isSaving&&_vm.isBulkSelect?_c("div",{staticClass:"flex flex-col items-center pT25 pB10"},[_c("div",{staticClass:"progress-dialog-heading"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm.selection_in_progress"))+" ")]),_c("div",{staticClass:"progress-dialog-sub-heading"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm.progress_prompt_1")+" "+_vm.totalCount+" "+_vm.$t("maintenance.pm.progress_prompt_2"))+" ")]),_c("spinner",{attrs:{show:_vm.isSaving,size:"80"}})],1):_c("div",{staticClass:"position-relative height280"},[_c("div",{staticClass:"p20"},[_c("div",{staticClass:"planner-selector-header"},[_vm._v(" "+_vm._s(_vm.selectorTitle)+" ")]),_c("div",{staticClass:"selector-name-label mT15"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.wr_list.assignedto"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{filterable:"",remote:"","remote-method":_vm.userSearch,clearable:""},model:{value:_vm.assoications.assignedTo,callback:function($$v){_vm.$set(_vm.assoications,"assignedTo",$$v)},expression:"assoications.assignedTo"}},_vm._l(_vm.userOptions,(function(user){return _c("el-option",{key:user.id,attrs:{label:user.label,value:user.value}})})),1),_c("div",{staticClass:"selector-name-label mT15"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm.job_plan"))+" ")]),_c("Lookup",{attrs:{field:_vm.lookupFields.jobplan},on:{showLookupWizard:_vm.showLookupWizard},model:{value:_vm.assoications.jobPlan,callback:function($$v){_vm.$set(_vm.assoications,"jobPlan",$$v)},expression:"assoications.jobPlan"}})],1),_c("div",{staticClass:"modal-dialog-footer planner-selector-footer"},[_c("div",{staticClass:"pR20 pB20 d-flex"},[_c("el-button",{staticClass:"pm-ps-save",attrs:{type:"primary",loading:_vm.isSaving},on:{click:_vm.saveResources}},[_vm._v(_vm._s(_vm.$t("jobplan.save")))])],1)])]),_vm.canShowLookupWizard?[_vm.checkNewLookupWizardEnabled?_c("LookupWizard",{attrs:{canShowLookupWizard:_vm.canShowLookupWizard,field:_vm.selectedLookupField},on:{"update:canShowLookupWizard":function($event){_vm.canShowLookupWizard=$event},"update:can-show-lookup-wizard":function($event){_vm.canShowLookupWizard=$event},setLookupFieldValue:_vm.setLookupFieldValue}}):_c("FLookupFieldWizard",{attrs:{canShowLookupWizard:_vm.canShowLookupWizard,selectedLookupField:_vm.selectedLookupField},on:{"update:canShowLookupWizard":function($event){_vm.canShowLookupWizard=$event},"update:can-show-lookup-wizard":function($event){_vm.canShowLookupWizard=$event},setLookupFieldValue:_vm.setLookupFieldValue}})]:_vm._e()],2)},PlannerFieldSelectorvue_type_template_id_4b515a73_staticRenderFns=[],FLookupFieldWizard=(__webpack_require__(843843),__webpack_require__(891719),__webpack_require__(434284),__webpack_require__(499751)),vuex_esm=__webpack_require__(420629),router=__webpack_require__(329435),debounce=__webpack_require__(23279),debounce_default=__webpack_require__.n(debounce),PlannerFieldSelectorvue_type_script_lang_js={props:["canShowFieldSelector","closeDialog","bulkCreateResources","reloadPlanner","pmRecord","isBulkSelect","totalCount"],components:{Lookup:ui_forms/* Lookup */.tY,LookupWizard:ui_forms/* LookupWizard */.ns,FLookupFieldWizard:FLookupFieldWizard["default"]},data:function(){return{assoications:{assignedTo:null,jobPlan:null},isSaving:!1,isLoading:!1,userOptions:[],selectedLookupField:null,canShowLookupWizard:!1}},created:function(){this.initResources(),this.userSearch=debounce_default()(this.loadUsers,500)},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({metaInfo:function(state){return state.view.metaInfo}})),{},{checkNewLookupWizardEnabled:function(){return this.$helpers.isLicenseEnabled("NEW_LOOKUP_WIZARD")},lookupFields:function(){var pmRecord=this.pmRecord,_ref=pmRecord||{},assignmentTypeEnum=_ref.assignmentTypeEnum,scopeCategory=pm_utils/* JOB_PLAN_SCOPE */.QY[assignmentTypeEnum],fields={user:{isDataLoading:!1,options:[],lookupModuleName:"users",field:{lookupModule:{name:"users",displayName:"Users"}},multiple:!1,filters:{user:{operatorId:15,value:["true"]}}},jobplan:{isDataLoading:!1,options:[],config:{},lookupModuleName:"jobplan",field:{lookupModule:{name:"jobplan",displayName:"Jobplan"}},filters:(0,objectSpread2/* default */.Z)({jobPlanCategory:{operatorId:54,value:["".concat(scopeCategory)]},jpStatus:{operatorId:54,value:["2"]}},(0,pm_utils/* getCategoryFilter */.Fl)(pmRecord,scopeCategory)),multiple:!1}};return fields},selectorTitle:function(){var pmRecord=this.pmRecord,title=(0,pm_utils/* getPlaceholderText */.Sb)({pmRecord:pmRecord,text:this.$t("maintenance.pm.field_selector_title"),replaceAll:!0});return title}}),methods:{showLookupWizard:function(field,canShow){this.$set(this,"selectedLookupField",field),this.$set(this,"canShowLookupWizard",canShow)},setLookupFieldValue:function(props){var selectedField,field=props.field,_field$options=field.options,options=void 0===_field$options?[]:_field$options,_field$selectedItems=field.selectedItems,selectedItems=void 0===_field$selectedItems?[]:_field$selectedItems,lookupModuleName=field.lookupModuleName,selectedItemIds=[];if(!(0,validation/* isEmpty */.xb)(selectedItems))if(selectedItemIds=(selectedItems||[]).map((function(item){return item.value})),(0,validation/* isEmpty */.xb)(options))options=(0,toConsumableArray/* default */.Z)(selectedItems);else{var _options,ids=options.map((function(item){return item.value})),newOptions=selectedItems.filter((function(item){return!ids.includes(item.value)}));(_options=options).unshift.apply(_options,(0,toConsumableArray/* default */.Z)(newOptions))}selectedField="jobplan"===lookupModuleName?"jobPlan":"assignedTo",(0,validation/* isEmpty */.xb)(selectedItemIds)||this.$set(this.assoications,"".concat(selectedField),selectedItemIds[0])},initResources:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.next=2,_this.loadUsers();case 2:case"end":return _context.stop()}}),_callee)})))()},loadUsers:function(search){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var _getApp,appId,params,_yield$API$get,error,data,_ref2,users;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _this2.isLoading=!0,_getApp=(0,router/* getApp */.wx)(),appId=_getApp.id,params={appId:appId,page:1,perPage:50,inviteAcceptStatus:!0},(0,validation/* isEmpty */.xb)(search)||(params=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},params),{},{search:search})),_context2.next=6,api/* API */.bl.get("/v2/application/users/list",params);case 6:_yield$API$get=_context2.sent,error=_yield$API$get.error,data=_yield$API$get.data,error?_this2.$message.error(error.message||"Error Occured"):(_ref2=data||{},users=_ref2.users,_this2.userOptions=(users||[]).map((function(user){var _ref3=user||{},name=_ref3.name,id=_ref3.id;return{label:name,value:id}}))),_this2.isLoading=!1;case 11:case"end":return _context2.stop()}}),_callee2)})))()},saveResources:function(){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var _ref4,assoications,response,_ref5,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return _ref4=_this3||{},assoications=_ref4.assoications,_this3.isSaving=!0,_context3.next=4,_this3.bulkCreateResources(assoications);case 4:response=_context3.sent,_ref5=response||{},error=_ref5.error,error?_this3.$message.error(error.message||"Error occured while associating resources"):(_this3.closeDialog(),_this3.reloadPlanner()),_this3.isSaving=!1;case 8:case"end":return _context3.stop()}}),_callee3)})))()}}},planner_PlannerFieldSelectorvue_type_script_lang_js=PlannerFieldSelectorvue_type_script_lang_js,PlannerFieldSelector_component=(0,componentNormalizer/* default */.Z)(planner_PlannerFieldSelectorvue_type_script_lang_js,PlannerFieldSelectorvue_type_template_id_4b515a73_render,PlannerFieldSelectorvue_type_template_id_4b515a73_staticRenderFns,!1,null,null,null)
/* harmony default export */,PlannerFieldSelector=PlannerFieldSelector_component.exports,PlannerSheetvue_type_template_id_561834ff_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"planner-sheet-dialog",attrs:{visible:!0,"before-close":_vm.closeDialog,width:"90%",top:"2vh","show-close":!1}},[_c("template",{slot:"title"},[_c("div",{staticClass:"flex items-center pB10"},[_c("div",{staticClass:"lookup-wizard-title"},[_vm._v(" "+_vm._s(_vm.getFormattedText(_vm.$t("maintenance.pm.resource_sheet"),!0))+" ")]),_c("div",{staticClass:"ml-auto flex items-center"},[_c("div",{staticClass:"el-dialog__close el-icon el-icon-close close-icon cursor-pointer resource-icons",on:{click:_vm.closeDialog}})])])]),_c("div",{staticClass:"fc-bulk-form-page"},[_vm.isLoading?_c("div",{staticClass:"d-flex mT50 planner-body"},[_c("Spinner",{attrs:{show:_vm.isLoading}})],1):[_c("div",{staticClass:"bulk-action-container"},[_c("el-button",{staticClass:"bulk-action-button mR10",attrs:{loading:_vm.isDeleting,disabled:!_vm.canShowBulkActions},on:{click:_vm.deleteResources}},[_c("i",{staticClass:"el-icon-delete pR3"}),_vm._v(" "+_vm._s(_vm.$t("asset.assets.delete"))+" ")]),_c("el-button",{staticClass:"bulk-action-button mR10",attrs:{loading:_vm.isJobPlanAssigning,disabled:!_vm.canShowBulkActions},on:{click:function($event){return _vm.showLookupWizard("jobplan")}}},[_c("i",{staticClass:"el-icon-document-checked pR3"}),_vm._v(" "+_vm._s(_vm.$t("maintenance.pm.update_jp"))+" ")]),_c("el-dropdown",{attrs:{trigger:"click"},on:{command:_vm.setBulkAssignedTo}},[_c("el-button",{staticClass:"bulk-action-button mR10",attrs:{loading:_vm.isAssigning,disabled:!_vm.canShowBulkActions}},[_c("i",{staticClass:"el-icon-user pR3"}),_vm._v(" "+_vm._s(_vm.$t("maintenance.pm.add_assignee"))+" "),_c("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),_c("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},_vm._l(_vm.users,(function(user){return _c("el-dropdown-item",{key:user.id,attrs:{command:user.id}},[_vm._v(_vm._s(user.name))])})),1)],1)],1),_c("div",[_c("BulkActionBar",{ref:"bulk-action-bar",attrs:{visible:_vm.showBulkBar,totalCount:_vm.totalCount,perPage:_vm.perPage,isAllSelected:_vm.isAllSelected,moduleName:_vm.moduleName},on:{"update:isAllSelected":function($event){_vm.isAllSelected=$event},"update:is-all-selected":function($event){_vm.isAllSelected=$event}}})],1),_c("div",{staticClass:"bulk-form-data-creation"},[_c("ResourceBulkForm",{ref:"resource-bulk-form",attrs:{form:_vm.formObj,moduleName:_vm.moduleName,moduleDisplayName:"Resource Selector",canShowPrimaryBtn:!1,canShowSecondaryBtn:!1,resourcePlannerList:_vm.resourcePlannerList,isEdit:!0,lookupOptions:_vm.lookupOptions},on:{"update:form":function($event){_vm.formObj=$event},onRowChange:_vm.setModelData,setFilters:function(props){return _vm.loadResources(props)},toggleSelectAll:_vm.selectAllResources}})],1),_c("div",{staticClass:"width100"},[_c("div",{staticClass:"pagination-container"},[_c("pagination",{staticClass:"self-center",attrs:{currentPage:_vm.page,total:_vm.totalCount,perPage:_vm.perPage},on:{"update:currentPage":function($event){_vm.page=$event},"update:current-page":function($event){_vm.page=$event}}})],1)])]],2),_vm.canShowLookupWizard?[_vm.checkNewLookupWizardEnabled?_c("LookupWizard",{attrs:{canShowLookupWizard:_vm.canShowLookupWizard,field:_vm.selectedLookupField},on:{"update:canShowLookupWizard":function($event){_vm.canShowLookupWizard=$event},"update:can-show-lookup-wizard":function($event){_vm.canShowLookupWizard=$event},setLookupFieldValue:_vm.setLookupFieldValue}}):_c("FLookupFieldWizard",{attrs:{canShowLookupWizard:_vm.canShowLookupWizard,selectedLookupField:_vm.selectedLookupField},on:{"update:canShowLookupWizard":function($event){_vm.canShowLookupWizard=$event},"update:can-show-lookup-wizard":function($event){_vm.canShowLookupWizard=$event},setLookupFieldValue:_vm.setLookupFieldValue}})]:_vm._e()],2)},PlannerSheetvue_type_template_id_561834ff_scoped_true_staticRenderFns=[],ResourceBulkFormvue_type_template_id_dc7a842c_render=(__webpack_require__(947522),__webpack_require__(336585),function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.loadHot?_c("div",{staticClass:"bulk-form-container fc-hottable-com-page"},[_c("HotTableWrapper",{ref:"hotTableWrapper",attrs:{hotTableSettingsData:_vm.hotConfig,selectedSiteId:_vm.selectedSiteId,pasteDataMap:_vm.pasteDataMap,onRowChange:_vm.onRowChange,showCustomFilter:_vm.showCustomFilter},on:{"update:pasteDataMap":function($event){_vm.pasteDataMap=$event},"update:paste-data-map":function($event){_vm.pasteDataMap=$event},openCustomFilter:_vm.openCustomFilter,toggleSelectAll:_vm.emitSelection}}),_c("AdvancedSearch",{key:"resource-search",ref:"resource-search",attrs:{moduleName:"resource",moduleDisplayName:"Resource",hideQuery:!0,onSave:_vm.applyResourceFilters,filterList:_vm.resourceFilters},scopedSlots:_vm._u([{key:"icon",fn:function(){return[_c("div")]},proxy:!0}],null,!1,882428920)})],1):_vm._e()}),ResourceBulkFormvue_type_template_id_dc7a842c_staticRenderFns=[],objectWithoutProperties=__webpack_require__(62078),BulkForm=__webpack_require__(713243),range=__webpack_require__(396026),range_default=__webpack_require__.n(range),cloneDeep=__webpack_require__(150361),cloneDeep_default=__webpack_require__.n(cloneDeep),CustomValidator=__webpack_require__(314346),utils_field=__webpack_require__(815872),field_utils=__webpack_require__(455344),createForOfIteratorHelper=__webpack_require__(566347),HotTableWrapper=__webpack_require__(513868),PlannerHotTablevue_type_script_lang_js={extends:HotTableWrapper/* default */.Z,methods:{toggleSelectAll:function(){this.$emit("toggleSelectAll")},setupHotTableSettingsData:function(){var _this=this,hotTableSettingsData=this.hotTableSettingsData,compInstance=this,columns=hotTableSettingsData.columns,colHeaders=hotTableSettingsData.colHeaders,uniqueDataKey=hotTableSettingsData.uniqueDataKey;
// By default, uniqueDataKey is id
(0,validation/* isEmpty */.xb)(uniqueDataKey)&&(hotTableSettingsData.uniqueDataKey="id"),
// Strech Columns to full width
hotTableSettingsData.colWidths=[10,void 0,void 0,void 0],hotTableSettingsData.stretchH="all",
// Only allow vertical drag to fill
hotTableSettingsData.fillHandle={direction:"vertical"},
/*
        Here normal function is used instead of arrow function to aviod parent scoping
        While copying from handson, have to convert id to corresponding label
      */
(0,validation/* isEmpty */.xb)(columns)||columns.forEach((function(column,index){if((0,validation/* isEmpty */.xb)(column.editor)||(column.editor=_this.getHotCustomEditor(column.editor)),(0,validation/* isEmpty */.xb)(column.renderer)||(column.renderer=_this.getHotCustomRenderer(column.renderer)),(0,validation/* isEmpty */.xb)(column.validateFn)&&(column.validateFn=_this.getValidateFn(column)),column.filters){var svgContent=__webpack_require__(567835),styledSvg='<svg class="icon icon-sm filter-icon"';svgContent=(svgContent||{}).default||"",svgContent=svgContent.replace(/<svg/,styledSvg),colHeaders[index]="".concat(colHeaders[index]," ").concat(svgContent)}}))
/* Hottable hooks setup */,hotTableSettingsData.beforeCopy=function(selectedRowsArr,coords){var _this2=this,_coords=(0,slicedToArray/* default */.Z)(coords,1),_coords$=_coords[0],selectedCellsCoords=void 0===_coords$?{}:_coords$,startRow=selectedCellsCoords.startRow,startCol=selectedCellsCoords.startCol;selectedRowsArr.forEach((function(row,rowIndex){var currentRow=startRow+rowIndex;(0,validation/* isEmpty */.xb)(row)||row.forEach((function(cellValue,cellIndex){var currentCol=startCol+cellIndex,cellProperties=_this2.getCellMeta(currentRow,currentCol),_ref=cellProperties||{},cellType=_ref.cellType,_ref$options=_ref.options,options=void 0===_ref$options?[]:_ref$options,_ref$field=_ref.field,field=void 0===_ref$field?{}:_ref$field;if(["select","lookup"].includes(cellType)){var _ref2=field||{},optionsCache=_ref2.optionsCache,optionsArr=field.options||options,selectedOption=optionsArr.find((function(option){return option.value===cellValue}))||{},selectedLabel=selectedOption.label;!(0,validation/* isEmpty */.xb)(optionsCache)&&(0,validation/* isEmpty */.xb)(selectedLabel)&&(selectedLabel=optionsCache[cellValue]),selectedRowsArr[rowIndex][cellIndex]=selectedLabel||cellValue}}))}))},hotTableSettingsData.beforeCut=function(selectedRowsArr,coords){var _this3=this,_coords2=(0,slicedToArray/* default */.Z)(coords,1),_coords2$=_coords2[0],selectedCellsCoords=void 0===_coords2$?{}:_coords2$,startRow=selectedCellsCoords.startRow,startCol=selectedCellsCoords.startCol,categoryRowIndexArr=[];selectedRowsArr.forEach((function(row,rowIndex){var currentRow=startRow+rowIndex;(0,validation/* isEmpty */.xb)(row)||row.forEach((function(cellValue,cellIndex){var currentCol=startCol+cellIndex,cellProperties=_this3.getCellMeta(currentRow,currentCol),_ref3=cellProperties||{},cellType=_ref3.cellType,_ref3$options=_ref3.options,options=void 0===_ref3$options?[]:_ref3$options,_ref3$field=_ref3.field,field=void 0===_ref3$field?{}:_ref3$field,prop=_ref3.prop,rowValue=_ref3.row;if("categoryId"===prop&&categoryRowIndexArr.push(rowValue),["select","lookup"].includes(cellType)){var _ref4=field||{},optionsCache=_ref4.optionsCache,optionsArr=field.options||options,selectedOption=optionsArr.find((function(option){return option.value===cellValue}))||{},selectedLabel=selectedOption.label;!(0,validation/* isEmpty */.xb)(optionsCache)&&(0,validation/* isEmpty */.xb)(selectedLabel)&&(selectedLabel=optionsCache[cellValue]),selectedRowsArr[rowIndex][cellIndex]=selectedLabel||cellValue}}))})),(0,validation/* isEmpty */.xb)(categoryRowIndexArr)||categoryRowIndexArr.forEach((function(row){compInstance.resetActiveRowData&&compInstance.resetActiveRowData({activeRowIndex:row})}))},hotTableSettingsData.beforePaste=function(selectedRowsArr,coords){compInstance.$emit("update:isPasteInProgress",!0),compInstance.handlePasteEvent(selectedRowsArr,coords,this)},hotTableSettingsData.afterChange=function(changes,source){var _this4=this;
// Skip validation for change triggered due to paste event
if(!(0,validation/* isEmpty */.xb)(changes)&&"CopyPaste.paste"!==source){var _step,promises=[],changedRows=new Set,_iterator=(0,createForOfIteratorHelper/* default */.Z)(changes.entries());try{var _loop=function(){var _step$value=(0,slicedToArray/* default */.Z)(_step.value,2),rowData=_step$value[1],_rowData=(0,slicedToArray/* default */.Z)(rowData,4),row=_rowData[0],prop=_rowData[1],newValue=_rowData[3],physicalRow=compInstance.getPhysicalRowIndex(row),cellsErrorMap=compInstance.cellsErrorMap,hotTableData=compInstance.hotTableData,hotTableSettingsData=compInstance.hotTableSettingsData,pasteDataMap=compInstance.pasteDataMap,_ref5=hotTableSettingsData||{},uniqueDataKey=_ref5.uniqueDataKey,data=hotTableData[physicalRow],id=(0,validation/* isEmpty */.xb)(data)?null:data[uniqueDataKey],columnsArr=_this4.getCellMetaAtRow(row)||[],selectedColumn=columnsArr.find((function(column){return column&&column.prop===prop}))||{};if(!(0,validation/* isEmpty */.xb)(selectedColumn)){var _ref6=selectedColumn||{},validateFn=_ref6.validateFn,cellType=_ref6.cellType,isValidEntry=!0;if((0,validation/* isFunction */.mf)(validateFn)){var rowsData=_this4.getDataAtRow(row),dataFromPasteMap=pasteDataMap[id]?pasteDataMap[id][prop]:null;isValidEntry=validateFn({cellValue:dataFromPasteMap||newValue,rowsData:rowsData,cellType:cellType})}var isAlreadyInvalid=(cellsErrorMap[id]||[]).includes(prop);compInstance.pushOrRemoveError({isValidEntry:isValidEntry,isAlreadyInvalid:isAlreadyInvalid,id:id,propName:prop})}changedRows.add(row)};for(_iterator.s();!(_step=_iterator.n()).done;)_loop()}catch(err){_iterator.e(err)}finally{_iterator.f()}if("Autofill.fill"===source){
// To execute hook for each row change only for autofill event
var _step2,_iterator2=(0,createForOfIteratorHelper/* default */.Z)(changedRows.values());try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var item=_step2.value;promises.push(compInstance.onAutoFillRowChange({index:item}))}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}
// To execute hook for each row change
var _step3,_iterator3=(0,createForOfIteratorHelper/* default */.Z)(changedRows.values());try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var _item=_step3.value;promises.push(compInstance.onRowChange({index:_item}))}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}Promise.all(promises).then((function(){return _this4.render()}))}},hotTableSettingsData.afterDocumentKeyDown=function(event){var key=event.key,_ref7=this.getSelectedRange()||[],_ref8=(0,slicedToArray/* default */.Z)(_ref7,1),range=_ref8[0];compInstance.handleAfterDocumentKeyDown({range:range},key)},hotTableSettingsData.beforeOnCellMouseDown=function(e,coords){var parentElem=e.target.parentElement.nodeName,svgClassName=e.target.classList.value,isSvgElement=svgClassName.includes("filter-icon")||["g","svg"].includes(parentElem);coords.row<0&&isSvgElement&&compInstance.openFilterDialog(coords.col),"selector-field"===svgClassName&&compInstance.toggleSelectAll()},hotTableSettingsData.beforeAutofill=function(){var _this$getSelectedRang=this.getSelectedRange(),_this$getSelectedRang2=(0,slicedToArray/* default */.Z)(_this$getSelectedRang,1),range=_this$getSelectedRang2[0];compInstance.selectedRange=range},hotTableSettingsData.beforeChange=function(changes,source){if("Autofill.fill"===source){
// When autofill happens fill pasteDataMap for those rows with the
// correct values to use when saving
var selectedRange=compInstance.selectedRange,from=selectedRange.from,to=selectedRange.to,pasteDataMap=compInstance.pasteDataMap;changes.forEach((function(change,index){var startRowIndex,referenceRowIndex,_compInstance$hotTabl=compInstance.hotTableSettingsData,data=_compInstance$hotTabl.data,uniqueDataKey=_compInstance$hotTabl.uniqueDataKey,_change=(0,slicedToArray/* default */.Z)(change,2),rowIndex=_change[0],colKey=_change[1],selectionRowLength=to.row-from.row+1;changes[0][0]<from.row?(
// Direction of autofill is towards the top
startRowIndex=to.row,referenceRowIndex=startRowIndex-index%selectionRowLength):(
// Direction of autofill is down
startRowIndex=from.row,referenceRowIndex=startRowIndex+index%selectionRowLength);var referenceRow=data[referenceRowIndex],referenceId=referenceRow[uniqueDataKey],valueToPaste=pasteDataMap[referenceId],targetRow=data[rowIndex],targetId=targetRow[uniqueDataKey];valueToPaste&&!(0,validation/* isEmpty */.xb)(valueToPaste[colKey])&&(pasteDataMap[targetId]?pasteDataMap[targetId][colKey]=cloneDeep_default()(valueToPaste[colKey]):pasteDataMap[targetId]=(0,defineProperty/* default */.Z)({},colKey,valueToPaste[colKey]))}))}}}}},planner_sheet_PlannerHotTablevue_type_script_lang_js=PlannerHotTablevue_type_script_lang_js,PlannerHotTable_component=(0,componentNormalizer/* default */.Z)(planner_sheet_PlannerHotTablevue_type_script_lang_js,PlannerHotTable_render,PlannerHotTable_staticRenderFns,!1,null,null,null)
/* harmony default export */,PlannerHotTable=PlannerHotTable_component.exports,_excluded=["uuid"],isChecked=!1,ResourceBulkFormvue_type_script_lang_js={props:["resourcePlannerList","lookupOptions"],extends:BulkForm/* default */.Z,data:function(){return{showCustomFilter:!0,resourceFilters:null}},watch:{hotConfig:{handler:function(value){this.$emit("setModelData",value)},deep:!0}},components:{AdvancedSearch:AdvancedSearch/* default */.Z,HotTableWrapper:PlannerHotTable},methods:{deserialize:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var form,removeFieldsHash,isEdit,moduleDataId,modifySectionPropsHook,isLiveSubForm,sections,ruleFieldIds,filteredSections,deserializedSections;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _this.isLoading=!0,form=_this.form,removeFieldsHash=_this.removeFieldsHash,isEdit=_this.isEdit,moduleDataId=_this.moduleDataId,modifySectionPropsHook=_this.modifySectionPropsHook,isLiveSubForm=_this.isLiveSubForm,sections=form.sections,ruleFieldIds=form.ruleFieldIds,(0,validation/* isEmpty */.xb)(ruleFieldIds)||_this.$set(_this,"ruleFieldIds",ruleFieldIds),filteredSections=(sections||[]).filter((function(section){var fields=section.fields,subFormId=section.subFormId,filteredFields=(fields||[]).filter((function(field){return(0,validation/* isEmpty */.xb)(removeFieldsHash)?"photo"!==field.name||!0!==field.hideField:!(removeFieldsHash||[]).includes(field.name)}));return section.fields=filteredFields,!(0,validation/* isEmpty */.xb)(subFormId)||!(0,validation/* isEmpty */.xb)(filteredFields)})),_context2.next=7,Promise.all(filteredSections.map(function(){var _ref=(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(section){var _section,fields,subFormId,subForm,subFormValue,subFormsArr,moduleName,records,modifiedSection;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(_section=section,fields=_section.fields,subFormId=_section.subFormId,subForm=_section.subForm,subFormValue=_section.subFormValue,subFormsArr=[],(0,validation/* isEmpty */.xb)(subFormId)){_context.next=11;break}if(!isEdit){_context.next=9;break}return moduleName=_this.$getProperty(form,"module.name"),_context.next=7,_this.loadSubFormRecords(section,moduleDataId,moduleName);case 7:records=_context.sent,subFormValue={data:records};case 9:subFormsArr=_this.constructSubFormValues({subForm:subForm,subFormValue:subFormValue,isEdit:isEdit,ruleFieldIds:ruleFieldIds}),_this.$set(section,"subFormsArr",subFormsArr);case 11:return(0,validation/* isEmpty */.xb)(fields)||_this.$set(section,"fields",_this.deserializeData(fields)),(0,validation/* isEmpty */.xb)(section)||_this.$set(section,"hideSection",!1),!(0,validation/* isEmpty */.xb)(modifySectionPropsHook)&&(0,validation/* isFunction */.mf)(modifySectionPropsHook)&&(modifiedSection=modifySectionPropsHook(section),(0,validation/* isEmpty */.xb)(modifiedSection)||(section=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},section),modifiedSection))),_context.abrupt("return",section);case 15:case"end":return _context.stop()}}),_callee)})));return function(_x){return _ref.apply(this,arguments)}}()));case 7:deserializedSections=_context2.sent,isLiveSubForm&&_this.onChangeHandler({field:{},isSubForm:!0}),_this.$set(form,"sections",deserializedSections),_this.isLoading=!1;case 11:case"end":return _context2.stop()}}),_callee2)})))()},applyResourceFilters:function(filters){this.resourceFilters=filters,this.$emit("setFilters",{filters:filters})},initBulkForm:function(){
//Bulk form has no section , accumulate fields from all section to single list
var allFields=this.form.sections.reduce((function(accum,section){return accum.push.apply(accum,(0,toConsumableArray/* default */.Z)(section.fields)),accum}),[]);this.constructHotColumns(allFields)},openCustomFilter:function(){
// let { column } = props
// let { hotConfig } = this || {}
// let { columns } = hotConfig || {}
// console.log(columns[column])
this.$refs["resource-search"].openCloseSearch(!0),this.showResourceFilter=!0},constructHotColumns:function(deserializedFormFields){var _this2=this,_ref2=this||{},resourcePlannerList=_ref2.resourcePlannerList,supportedFields=deserializedFormFields.filter((function(formField){return _this2.isBulkModeSupported(formField)}));supportedFields.unshift({name:"#selectorField"}),this.hotConfig.colHeaders=supportedFields.map((function(field){var _ref3=field||{},displayName=_ref3.displayName,name=_ref3.name;return"#selectorField"===name?'<div class="selector-field">\n            <input type="checkbox" class="bulk-select-checkbox" '.concat(isChecked?'checked="checked"':""," readonly>\n            </div>"):"".concat(displayName);
// Commenting now will be uncommented later
// if (name === 'resource') {
//   let svgContent = require(`!html-loader!svgo-loader?externalConfig=svgo.config.yml!./../../../../../../../assets/filter.svg`)
//   let styledSvg = `<svg class="icon icon-sm filter-icon"`
//   svgContent = (svgContent || {}).default || ''
//   svgContent = svgContent.replace(/<svg/, styledSvg)
//   return `<span class="pR10">${displayName}</span><span class="mT2 cursor-pointer">${svgContent}</span>`
// } else {
//   return `${displayName}`
// }
})),this.hotConfig.dataSchema=cloneDeep_default()(this.formModel),this.hotConfig.data=range_default()(0,25).map((function(_,i){var model=resourcePlannerList[i]||_this2.formModel;return cloneDeep_default()((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},model),{},{isSelected:!1,visitorPhone:"sample"}))})),
//get appropriate column object for each field object
supportedFields.forEach((function(formField){_this2.hotConfig.columns.push(_this2.getHotColumn(formField))}))},getHotColumn:function(field){var name=field.name,displayTypeEnum=field.displayTypeEnum,required=field.required,columnObj={};(0,validation/* isObject */.Kn)(this.formModel[name])?columnObj["data"]="".concat(name,".id"):columnObj["data"]="".concat(name);
//Can be type:'systemTypeString' or type:{renderer,validator,editor} for customtypes'
//define props for column type and then mix into column object
var columnTypeObj={};if("#selectorField"===name)columnTypeObj.type="checkbox";else if("TEXTBOX"===displayTypeEnum||"TEXTAREA"===displayTypeEnum)columnTypeObj.renderer="input";else if("NUMBER"===displayTypeEnum||"DECIMAL"===displayTypeEnum)columnTypeObj.type="numeric";else if("DATETIME"===displayTypeEnum)columnTypeObj.editor="picker",columnTypeObj.pickerType="datetime",columnTypeObj.renderer="picker",columnTypeObj.width=200;else if((0,utils_field/* isLookupSimple */.qu)(field)||(0,field_utils/* isChooserTypeField */.Rq)(field))if(columnObj.editor="lookup",columnObj.renderer="lookup",columnObj.cellType="lookup",columnObj.field=field,["resource","assignedTo","jobPlan"].includes(name)){var _ref4=this||{},lookupOptions=_ref4.lookupOptions,options=lookupOptions[name],optionsChache={};options.forEach((function(option){var label=option.label,value=option.value;optionsChache[value]=label})),columnObj.field.optionsCache=optionsChache,columnObj.field.options=options}else columnObj.field.optionsCache={};else this.isDropdownTypeFields(field.displayTypeEnum)?(columnTypeObj.renderer="select",columnTypeObj.editor="select",columnObj.cellType="select",columnTypeObj.options=field.options):"DECISION_BOX"===displayTypeEnum&&(columnTypeObj.type="checkbox");return columnObj=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},columnObj),columnTypeObj),columnObj.required=required,required&&(columnObj.validateFn=CustomValidator/* requiredFieldValidator */.i),columnObj},onRowChange:function(props){var $refs=this.$refs,hotConfig=this.hotConfig,_ref5=hotConfig||{},data=_ref5.data,index=props.index,selectedRowData=data[index]||{},_ref6=selectedRowData||{},uuid=_ref6["uuid"],dataWithoutId=(0,objectWithoutProperties/* default */.Z)(_ref6,_excluded),canClearError=(0,validation/* areValuesEmpty */.sD)(dataWithoutId);!(0,validation/* isEmpty */.xb)($refs)&&canClearError&&$refs["hotTableWrapper"].clearRowError(uuid),this.$emit("onRowChange",{data:data[index]})},toggleSelectAll:function(count,selection){var _this3=this,_ref7=this||{},hotConfig=_ref7.hotConfig,_ref8=hotConfig||{},data=_ref8.data;data=data.map((function(row,index){return index<count?(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},row),{},{"#selectorField":selection}):row})),this.$set(hotConfig,"data",data),data.forEach((function(row){_this3.$emit("onRowChange",{data:row})}))},emitSelection:function(){this.$emit("toggleSelectAll")}}},planner_sheet_ResourceBulkFormvue_type_script_lang_js=ResourceBulkFormvue_type_script_lang_js,ResourceBulkForm_component=(0,componentNormalizer/* default */.Z)(planner_sheet_ResourceBulkFormvue_type_script_lang_js,ResourceBulkFormvue_type_template_id_dc7a842c_render,ResourceBulkFormvue_type_template_id_dc7a842c_staticRenderFns,!1,null,null,null)
/* harmony default export */,ResourceBulkForm=ResourceBulkForm_component.exports,uuid=__webpack_require__(455877),relatedFieldUtil=__webpack_require__(850558),PlannerSheetvue_type_script_lang_js={props:["closeDialog","planner","pmRecord","resourcePlaceholder"],components:{Pagination:WidgetPagination/* default */.Z,Spinner:Spinner/* default */.Z,ResourceBulkForm:ResourceBulkForm,BulkActionBar:BulkActionBar/* default */.Z,LookupWizard:ui_forms/* LookupWizard */.ns,FLookupFieldWizard:FLookupFieldWizard["default"]},data:function(){return{page:1,perPage:25,totalCount:0,isLoading:!1,moduleName:"pmResourcePlanner",resourcePlannerList:[],lookupOptions:{resource:[],assignedTo:[],jobPlan:[]},model:{},isDeleting:!1,bulkAssignedTo:null,isAssigning:!1,isJobPlanAssigning:!1,showBulkActionBar:!1,isAllSelected:!1,selectedLookupField:null,canShowLookupWizard:!1}},created:function(){this.loadResources()},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapGetters */.Se)(["getUser"])),(0,vuex_esm/* mapState */.rn)({users:function(state){return state.users}})),{},{checkNewLookupWizardEnabled:function(){return this.$helpers.isLicenseEnabled("NEW_LOOKUP_WIZARD")},formObj:function(){var resourcePlaceholder=this.resourcePlaceholder;return{appId:63,description:null,displayName:"Resource Form",id:5818,labelPosition:1,labelPositionEnum:"TOP",labelPositionVal:"top",name:"resource_form",orgId:173,ruleFieldIds:null,sections:[{fields:[{allowCreate:!1,config:null,configJSON:null,configStr:null,createFormName:null,displayName:resourcePlaceholder,displayType:1,displayTypeEnum:"TEXTBOX",displayTypeVal:"text",field:{columnName:"VISITOR_PHONE",completeColumnName:"BaseVisit.resource",dataType:1,dataTypeEnum:"STRING",default:!0,disabled:!1,displayName:resourcePlaceholder,displayType:"TEXTBOX",displayTypeInt:1,fieldId:1763779,id:1763779,inputName:"basevisit.resource",isSystemUpdated:null,mainField:!1,maxLength:-1,modifiedTime:0,moduleId:156242,name:"resource",orgId:173,placeHolder:null,regex:null,required:!1,sequenceNumber:-1,sourceBundle:0,styleClass:null,tableAlias:null},fieldId:1763779,formId:5821,hideField:!1,id:113207,isDisabled:!1,lookupModuleName:null,name:"resource",required:!0,sequenceNumber:1,showField:!0,showFloorPlanConfig:null,span:1,validations:{maxLength:255},value:null},{allowCreate:!1,config:null,configJSON:null,configStr:null,createFormName:null,displayName:"Job Plan",displayType:1,displayTypeEnum:"TEXTBOX",displayTypeVal:"text",field:{columnName:"JOB_PLAN",completeColumnName:"BaseVisit.JOB_PLAN",dataType:1,dataTypeEnum:"STRING",default:!0,disabled:!1,displayName:"Job Plan",displayType:"TEXTBOX",displayTypeInt:1,fieldId:1763779,id:1763779,inputName:"basevisit.jobPlan",isSystemUpdated:null,mainField:!1,maxLength:-1,modifiedTime:0,moduleId:156242,name:"jobPlan",orgId:173,placeHolder:null,regex:null,required:!1,sequenceNumber:-1,sourceBundle:0,styleClass:null,tableAlias:null},fieldId:1763779,formId:5821,hideField:!1,id:113207,isDisabled:!1,lookupModuleName:null,name:"jobPlan",required:!0,sequenceNumber:1,showField:!0,showFloorPlanConfig:null,span:1,validations:{maxLength:255},value:null},{allowCreate:!1,config:null,configJSON:null,configStr:null,createFormName:null,displayName:"Assigned To",displayType:1,displayTypeEnum:"TEXTBOX",displayTypeVal:"text",field:{columnName:"ASSIGNED_TO",completeColumnName:"BaseVisit.ASSIGNED_TO",dataType:1,dataTypeEnum:"STRING",default:!0,disabled:!1,displayName:"Assigned To",displayType:"TEXTBOX",displayTypeInt:1,fieldId:1763779,id:1763779,inputName:"basevisit.assignedTo",isSystemUpdated:null,mainField:!1,maxLength:-1,modifiedTime:0,moduleId:156242,name:"assignedTo",orgId:173,placeHolder:null,regex:null,required:!1,sequenceNumber:-1,sourceBundle:0,styleClass:null,tableAlias:null},fieldId:1763779,formId:5821,hideField:!1,id:113207,isDisabled:!1,lookupModuleName:null,name:"assignedTo",required:!0,sequenceNumber:1,showField:!0,showFloorPlanConfig:null,span:1,validations:{maxLength:255},value:null}],formId:5818,id:28081,lookupFieldId:-1,lookupFieldName:null,name:"visitor",numberOfSubFormRecords:-1,orgId:173,sectionType:-1,sectionTypeEnum:null,sequenceNumber:1,showLabel:!1,subForm:null,subFormId:-1,subFormValue:null,subFormValueStr:null}],showInMobile:!0,showInWeb:!0,siteIds:null,stateFlowId:-1}},lookupFields:function(){var pmRecord=this.pmRecord,_ref=pmRecord||{},assignmentTypeEnum=_ref.assignmentTypeEnum,scopeCategory=pm_utils/* JOB_PLAN_SCOPE */.QY[assignmentTypeEnum],fields={user:{isDataLoading:!1,options:[],lookupModuleName:"users",field:{lookupModule:{name:"users",displayName:"Users"}},multiple:!1,filters:{user:{operatorId:15,value:["true"]}}},jobplan:{isDataLoading:!1,options:[],config:{},lookupModuleName:"jobplan",field:{lookupModule:{name:"jobplan",displayName:"Jobplan"}},filters:(0,objectSpread2/* default */.Z)({jobPlanCategory:{operatorId:54,value:["".concat(scopeCategory)]},jpStatus:{operatorId:54,value:["2"]}},(0,pm_utils/* getCategoryFilter */.Fl)(pmRecord,scopeCategory)),multiple:!1}};return fields},bulkActionFilter:function(){var _ref2=this||{},planner=_ref2.planner,_ref3=planner||{},id=_ref3.id;return{planner:{operatorId:36,value:["".concat(id)]}}},showBulkBar:function(){var _ref4=this||{},showBulkActionBar=_ref4.showBulkActionBar,totalCount=_ref4.totalCount,perPage=_ref4.perPage;return showBulkActionBar&&totalCount>perPage},selectedResources:function(){var _ref5=this||{},model=_ref5.model,selectedRecords=[];return Object.entries(model).forEach((function(_ref6){var _ref7=(0,slicedToArray/* default */.Z)(_ref6,2),key=_ref7[0],value=_ref7[1];value=value||model[key],value["#selectorField"]&&selectedRecords.push(value)})),selectedRecords},selectedResourceIds:function(){var _ref8=this||{},selectedResources=_ref8.selectedResources,resourcePlannerList=_ref8.resourcePlannerList;return selectedResources.map((function(resource){var _ref9=resource||{},uuid=_ref9.uuid,currResource=resourcePlannerList.find((function(resourceRecord){return resourceRecord.uuid===uuid}));return(currResource||{}).id}))},canShowBulkActions:function(){var _ref10=this||{},selectedResources=_ref10.selectedResources;return!(0,validation/* isEmpty */.xb)(selectedResources)},totalCountPerPage:function(){var _ref11=this||{},perPage=_ref11.perPage,totalCount=_ref11.totalCount;return totalCount>perPage?perPage:totalCount}}),watch:{page:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var _ref12,showBulkActionBar;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _ref12=_this||{},showBulkActionBar=_ref12.showBulkActionBar,_context.next=3,_this.loadResources();case 3:showBulkActionBar&&(_this.showBulkActionBar=!1,_this.model={});case 4:case"end":return _context.stop()}}),_callee)})))()},canShowBulkActions:function(val){val||(this.showBulkActionBar=val)},selectedResources:function(val){var _ref13=this||{},totalCountPerPage=_ref13.totalCountPerPage,page=_ref13.page,_ref14=val||{},length=_ref14.length;1===page&&totalCountPerPage!==length&&(this.showBulkActionBar=!1)}},methods:{showLookupWizard:function(field){var lookupFields=this.lookupFields,selectedLookupField=cloneDeep_default()(lookupFields["".concat(field)]||{});this.$set(this,"selectedLookupField",selectedLookupField),this.$set(this,"canShowLookupWizard",!0)},setLookupFieldValue:function(props){var field=props.field,_field$selectedItems=field.selectedItems,selectedItems=void 0===_field$selectedItems?[]:_field$selectedItems,lookupModuleName=field.lookupModuleName,selectedItemIds=[];(0,validation/* isEmpty */.xb)(selectedItems)||(selectedItemIds=(selectedItems||[]).map((function(item){return item.value})));var selectedValue=selectedItemIds[0];"jobplan"===lookupModuleName?this.setJobPlans(selectedValue):this.setBulkAssignedTo(selectedValue),this.selectedLookupField=null,this.canShowLookupWizard=!1},selectAllResources:function(value){var _ref15=this||{},totalCount=_ref15.totalCount,showBulkActionBar=_ref15.showBulkActionBar,isSelected=!showBulkActionBar;(0,validation/* isEmpty */.xb)(value)||(isSelected=value),this.$refs["resource-bulk-form"].toggleSelectAll(totalCount,isSelected),this.$nextTick((function(){var bulkSelect=document.getElementsByClassName("bulk-select-checkbox"),bulkCheckbox=bulkSelect[1];bulkCheckbox.checked=isSelected})),this.showBulkActionBar=isSelected},getFormattedText:function(text,isUpperCase){var _ref16=this||{},pmRecord=_ref16.pmRecord;return(0,pm_utils/* getPlaceholderText */.Sb)({pmRecord:pmRecord,text:text,isUpperCase:isUpperCase})},setBulkAssignedTo:function(id){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var _ref17,moduleName,selectedResourceIds,isAllSelected,resourcePlaceholder,successMessage,_ref18,bulkActionFilter,params,filters,bulkActionComponent,response,_params,_response;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if(_this2.isAssigning=!0,_ref17=_this2||{},moduleName=_ref17.moduleName,selectedResourceIds=_ref17.selectedResourceIds,isAllSelected=_ref17.isAllSelected,resourcePlaceholder=_ref17.resourcePlaceholder,successMessage=_this2.$t("maintenance.pm.resource_updated",{resourcePlaceholder:resourcePlaceholder}),!isAllSelected){_context2.next=14;break}return _ref18=_this2||{},bulkActionFilter=_ref18.bulkActionFilter,params={assignedTo:{id:id}},filters=encodeURIComponent(JSON.stringify(bulkActionFilter)),bulkActionComponent=_this2.$refs["bulk-action-bar"],_context2.next=10,bulkActionComponent.updateRecord(params,filters);case 10:response=_context2.sent,_this2.handleNotification(response,successMessage),_context2.next=19;break;case 14:return _params={moduleName:moduleName,data:(0,defineProperty/* default */.Z)({},moduleName,selectedResourceIds.map((function(selectedId){return{id:selectedId,assignedTo:{id:id}}})))},_context2.next=17,api/* API */.bl.post("v3/modules/bulkPatch/".concat(moduleName),_params);case 17:_response=_context2.sent,_this2.handleNotification(_response,successMessage);case 19:_this2.isAssigning=!1;case 20:case"end":return _context2.stop()}}),_callee2)})))()},setJobPlans:function(id){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var _ref19,moduleName,selectedResourceIds,isAllSelected,resourcePlaceholder,successMessage,_ref20,bulkActionFilter,params,filters,bulkActionComponent,response,_params2,_response2;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:if(_this3.isJobPlanAssigning=!0,_ref19=_this3||{},moduleName=_ref19.moduleName,selectedResourceIds=_ref19.selectedResourceIds,isAllSelected=_ref19.isAllSelected,resourcePlaceholder=_ref19.resourcePlaceholder,successMessage=_this3.$t("maintenance.pm.resource_updated",{resourcePlaceholder:resourcePlaceholder}),!isAllSelected){_context3.next=14;break}return _ref20=_this3||{},bulkActionFilter=_ref20.bulkActionFilter,params={jobPlan:{id:id}},filters=encodeURIComponent(JSON.stringify(bulkActionFilter)),bulkActionComponent=_this3.$refs["bulk-action-bar"],_context3.next=10,bulkActionComponent.updateRecord(params,filters);case 10:response=_context3.sent,_this3.handleNotification(response,successMessage),_context3.next=19;break;case 14:return _params2={moduleName:moduleName,data:(0,defineProperty/* default */.Z)({},moduleName,selectedResourceIds.map((function(selectedId){return{id:selectedId,jobPlan:{id:id}}})))},_context3.next=17,api/* API */.bl.post("v3/modules/bulkPatch/".concat(moduleName),_params2);case 17:_response2=_context3.sent,_this3.handleNotification(_response2,successMessage);case 19:_this3.isJobPlanAssigning=!1;case 20:case"end":return _context3.stop()}}),_callee3)})))()},handleNotification:function(response,successMessage){var _ref21=response||{},error=_ref21.error;(0,validation/* isEmpty */.xb)(error)?(this.$message.success(successMessage),this.loadResources(),this.model={},this.showBulkActionBar=!1):this.$message.error(error.message||"Error Occured")},deleteResources:function(){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){var _ref22,selectedResourceIds,moduleName,isAllSelected,resourcePlaceholder,successMessage,_ref23,bulkActionFilter,filters,bulkActionComponent,response,_response3;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:if(_this4.isDeleting=!0,_ref22=_this4||{},selectedResourceIds=_ref22.selectedResourceIds,moduleName=_ref22.moduleName,isAllSelected=_ref22.isAllSelected,resourcePlaceholder=_ref22.resourcePlaceholder,successMessage=_this4.$t("maintenance.pm.resource_deleted",{resourcePlaceholder:resourcePlaceholder}),!isAllSelected){_context4.next=13;break}return _ref23=_this4||{},bulkActionFilter=_ref23.bulkActionFilter,filters=encodeURIComponent(JSON.stringify(bulkActionFilter)),bulkActionComponent=_this4.$refs["bulk-action-bar"],_context4.next=9,bulkActionComponent.deleteRecord(filters);case 9:response=_context4.sent,_this4.handleNotification(response,successMessage),_context4.next=17;break;case 13:return _context4.next=15,api/* API */.bl.deleteRecord(moduleName,(0,toConsumableArray/* default */.Z)(selectedResourceIds));case 15:_response3=_context4.sent,_this4.handleNotification(_response3,successMessage);case 17:_this4.isDeleting=!1;case 18:case"end":return _context4.stop()}}),_callee4)})))()},setModelData:function(_ref24){var data=_ref24.data,_ref25=this||{},model=_ref25.model,_ref26=data||{},uuid=_ref26.uuid,modifiedData=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},model),{},(0,defineProperty/* default */.Z)({},uuid,data));this.model=modifiedData},loadResources:function(props){var _this5=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee5(){var _ref27,filters,_ref28,moduleName,planner,page,perPage,_ref29,id,params,relatedFieldName,relatedConfig,_yield$API$fetchAllRe,error,list,meta,count,data;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context5){while(1)switch(_context5.prev=_context5.next){case 0:return _this5.isLoading=!0,_ref27=props||{},filters=_ref27.filters,_ref28=_this5||{},moduleName=_ref28.moduleName,planner=_ref28.planner,page=_ref28.page,perPage=_ref28.perPage,_ref29=planner||{},id=_ref29.id,params={withCount:!0,page:page,perPage:perPage},(0,validation/* isEmpty */.xb)(filters)||(params=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},params),{},{filters:JSON.stringify(filters)})),relatedFieldName=(0,relatedFieldUtil/* getRelatedFieldName */.C9)("pmPlanner",moduleName),relatedConfig={moduleName:"pmPlanner",id:id,relatedModuleName:moduleName,relatedFieldName:relatedFieldName},_context5.next=10,api/* API */.bl.fetchAllRelatedList(relatedConfig,params,{force:!0});case 10:_yield$API$fetchAllRe=_context5.sent,error=_yield$API$fetchAllRe.error,list=_yield$API$fetchAllRe.list,meta=_yield$API$fetchAllRe.meta,(0,validation/* isEmpty */.xb)(error)?(count=_this5.$getProperty(meta,"pagination.totalCount"),_this5.totalCount=count,data=list.map((function(resourcePlanner){var _ref30=_this5||{},lookupOptions=_ref30.lookupOptions,_ref31=resourcePlanner||{},id=_ref31.id,resourceId=_this5.$getProperty(resourcePlanner,"resource.id"),resourceName=_this5.$getProperty(resourcePlanner,"resource.name"),jobPlanName=_this5.$getProperty(resourcePlanner,"jobPlan.name"),jobPlanId=_this5.$getProperty(resourcePlanner,"jobPlan.id"),decommission=_this5.$getProperty(resourcePlanner,"resource.decommission"),assignedToName=_this5.$getProperty(resourcePlanner,"assignedTo.name"),assignedToId=_this5.$getProperty(resourcePlanner,"assignedTo.id"),_ref32=lookupOptions||{},assignedTo=_ref32.assignedTo,resource=_ref32.resource,jobPlan=_ref32.jobPlan;return resource=[].concat((0,toConsumableArray/* default */.Z)(resource),[{label:resourceName,value:resourceId}]),assignedTo=[].concat((0,toConsumableArray/* default */.Z)(assignedTo),[{label:assignedToName,value:assignedToId}]),jobPlan=[].concat((0,toConsumableArray/* default */.Z)(jobPlan),[{label:jobPlanName,value:jobPlanId}]),_this5.lookupOptions=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},lookupOptions),{},{assignedTo:assignedTo,resource:resource,jobPlan:jobPlan}),{assignedTo:assignedToName,resource:resourceName,jobPlan:jobPlanName,decommission:!(0,validation/* isEmpty */.xb)(decommission)&&decommission,uuid:(0,uuid.v4)(),id:id}})),_this5.resourcePlannerList=data):_this5.$message.error(error.message||"Error occured"),_this5.isLoading=!1;case 16:case"end":return _context5.stop()}}),_callee5)})))()}}},planner_sheet_PlannerSheetvue_type_script_lang_js=PlannerSheetvue_type_script_lang_js,PlannerSheet_component=(0,componentNormalizer/* default */.Z)(planner_sheet_PlannerSheetvue_type_script_lang_js,PlannerSheetvue_type_template_id_561834ff_scoped_true_render,PlannerSheetvue_type_template_id_561834ff_scoped_true_staticRenderFns,!1,null,"561834ff",null)
/* harmony default export */,PlannerSheet=PlannerSheet_component.exports,ASSIGNMENT_HASH={ASSETS:"asset",SPACES:"space",ASSETCATEGORY:"asset",SPACECATEGORY:"space",SITES:"site",BUILDINGS:"building",FLOORS:"floor"},ResourcePlannervue_type_script_lang_js={props:["pmRecord","planner"],components:{ResourceSelector:ResourceSelector,PlannerFieldSelector:PlannerFieldSelector,PlannerSheet:PlannerSheet,Spinner:Spinner/* default */.Z},created:function(){this.loadResourcePlanner()},data:function(){return{showResourceSelector:!1,selectorField:{},canShowFieldSelector:!1,selectedResources:[],selectedResourceFilter:{},isBulkSelect:!1,moduleName:"pmResourcePlanner",resourcesCount:0,showPlannerSheet:!1,isLoading:!1,jpCount:0,assigneeCount:0,totalCount:0}},computed:{isConfigured:function(){var _ref=this||{},resourcesCount=_ref.resourcesCount;return resourcesCount>0},heading:function(){var _ref2=this||{},resourcesCount=_ref2.resourcesCount;return"".concat(this.$t("maintenance.pm.resources_conf_1")," ").concat(resourcesCount," ").concat(this.getFormattedPlannerText(this.$t("maintenance.pm.resources_conf_2")))},resourcePlaceholder:function(){var _ref3=this||{},pmRecord=_ref3.pmRecord;return(0,pm_utils/* getResourcePlaceholder */.$A)(pmRecord,!0)}},methods:{closePlannerSheet:function(){this.showPlannerSheet=!1,this.loadResourcePlanner()},loadResourcePlanner:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var _ref4,moduleName,planner,_ref5,id,params,relatedFieldName,relatedConfig,_yield$API$fetchAllRe,error,list,meta,count;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _this.isLoading=!0,_ref4=_this||{},moduleName=_ref4.moduleName,planner=_ref4.planner,_ref5=planner||{},id=_ref5.id,params={withCount:!0},relatedFieldName=(0,relatedFieldUtil/* getRelatedFieldName */.C9)("pmPlanner",moduleName),relatedConfig={moduleName:"pmPlanner",id:id,relatedModuleName:moduleName,relatedFieldName:relatedFieldName},_context.next=8,api/* API */.bl.fetchAllRelatedList(relatedConfig,params);case 8:if(_yield$API$fetchAllRe=_context.sent,error=_yield$API$fetchAllRe.error,list=_yield$API$fetchAllRe.list,meta=_yield$API$fetchAllRe.meta,!(0,validation/* isEmpty */.xb)(error)){_context.next=19;break}return count=_this.$getProperty(meta,"pagination.totalCount"),_this.resourcesCount=count,_context.next=17,_this.computeResourceAllotments(list);case 17:_context.next=20;break;case 19:_this.$message.error(error.message||"Error occured");case 20:_this.isLoading=!1;case 21:case"end":return _context.stop()}}),_callee)})))()},computeResourceAllotments:function(resources){if(!(0,validation/* isEmpty */.xb)(resources)){var jpMap=[],assigneeMap=[];jpMap=resources.map((function(resource){var _ref6=resource||{},jobPlan=_ref6.jobPlan,_ref7=jobPlan||{},jobPlanId=_ref7.id;return!(0,validation/* isEmpty */.xb)(jobPlanId)&&jobPlanId})),assigneeMap=resources.map((function(resource){var _ref8=resource||{},assignedTo=_ref8.assignedTo,_ref9=assignedTo||{},assignedToId=_ref9.id;return!(0,validation/* isEmpty */.xb)(assignedToId)&&assignedToId})),jpMap=jpMap.filter((function(jp){return jp})),assigneeMap=assigneeMap.filter((function(assignee){return assignee})),jpMap=(0,toConsumableArray/* default */.Z)(new Set(jpMap)),assigneeMap=(0,toConsumableArray/* default */.Z)(new Set(assigneeMap)),this.jpCount=jpMap.length,this.assigneeCount=assigneeMap.length}},setSelectorField:function(){var _ref10=this||{},pmRecord=_ref10.pmRecord,assignmentTypeEnum=pmRecord.assignmentTypeEnum,name=ASSIGNMENT_HASH[assignmentTypeEnum]||"site",sites=this.$getProperty(this,"pmRecord.sites");sites=sites.map((function(site){return"".concat(site.id)}));var filter={site:{operatorId:36,value:sites}};if("SPACECATEGORY"===assignmentTypeEnum){var spaceCategoryId=this.$getProperty(pmRecord,"spaceCategory.id");filter=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},filter),{},{spaceCategory:{operatorId:36,value:["".concat(spaceCategoryId)]}})}else if("ASSETCATEGORY"===assignmentTypeEnum){var assetCategoryId=this.$getProperty(pmRecord,"assetCategory.id");filter=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},filter),{},{category:{operatorId:36,value:["".concat(assetCategoryId)]}})}this.selectorField={field:{lookupModule:{name:name}},multiple:!0,config:{},filters:filter},this.showResourceSelector=!0},openResourceSheet:function(){this.showPlannerSheet=!0},setResourceSelection:function(data){var _this2=this;this.showResourceSelector=!1;var _ref11=data||{},field=_ref11.field,isBulkSelect=_ref11.isBulkSelect,totalCount=_ref11.totalCount,filters=this.$getProperty(data,"filters",{});if(isBulkSelect){this.isBulkSelect=isBulkSelect;var fieldFilters=this.$getProperty(field,"filters",{});this.selectedResourceFilter=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},filters),fieldFilters),this.selectedResources=[],this.totalCount=totalCount}else{var _ref12=field||{},selectedItems=_ref12.selectedItems;this.selectedResources=selectedItems,this.isBulkSelect=!1,this.selectedResourceFilter={}}this.$nextTick((function(){_this2.canShowFieldSelector=!0}))},closeWizard:function(){this.showResourceSelector=!1},getFormattedPlannerText:function(text){var assigneeCount=this.assigneeCount,jpCount=this.jpCount;return 1===jpCount&&1===assigneeCount&&(text=this.$t("maintenance.pm.default_planner_msg")),jpCount>1&&(text=text.replace("default Job Plan",this.$t("maintenance.pm.multiple_jp"))),1===assigneeCount&&(text=text.replace("multiple Assignees",this.$t("maintenance.pm.default_assign"))),0===jpCount&&0===assigneeCount?text=text.replace(" with a default Job Plan & multiple Assignees.","."):(0===jpCount&&(text=text.replace("a default Job Plan &","")),0===assigneeCount&&(text=text.replace(" & multiple Assignees.","."))),text=this.getFormattedText(text),text},bulkCreateResources:function(associations){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var _ref13,assignedTo,jobPlan,_ref14,selectedResources,selectedResourceFilter,isBulkSelect,moduleName,pmRecord,planner,selectorField,_ref15,pmId,_ref16,plannerId,url,params,scopeModuleName,response;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _ref13=associations||{},assignedTo=_ref13.assignedTo,jobPlan=_ref13.jobPlan,_ref14=_this3||{},selectedResources=_ref14.selectedResources,selectedResourceFilter=_ref14.selectedResourceFilter,isBulkSelect=_ref14.isBulkSelect,moduleName=_ref14.moduleName,pmRecord=_ref14.pmRecord,planner=_ref14.planner,selectorField=_ref14.selectorField,_ref15=pmRecord||{},pmId=_ref15.id,_ref16=planner||{},plannerId=_ref16.id,url="",params={},isBulkSelect?(url="v3/bulkAction/create",(0,validation/* isEmpty */.xb)(selectedResourceFilter)||(selectedResourceFilter=encodeURIComponent(JSON.stringify(selectedResourceFilter)),selectedResourceFilter=url+="?filters=".concat(selectedResourceFilter)),scopeModuleName=_this3.$getProperty(selectorField,"field.lookupModule.name"),params={moduleName:scopeModuleName,dataModuleName:moduleName,data:{assignedTo:{id:assignedTo},jobPlan:{id:jobPlan},pmId:pmId,planner:{id:plannerId}}}):(selectedResources=selectedResources.map((function(resources){var _ref17=resources||{},value=_ref17.value;return{resource:{id:value},assignedTo:{id:assignedTo},jobPlan:{id:jobPlan},pmId:pmId,planner:{id:plannerId}}})),url="v3/modules/bulkCreate/".concat(moduleName),params={data:(0,defineProperty/* default */.Z)({},moduleName,selectedResources),moduleName:moduleName}),_context2.next=9,api/* API */.bl.post(url,params);case 9:return response=_context2.sent,_context2.abrupt("return",response);case 11:case"end":return _context2.stop()}}),_callee2)})))()},getFormattedText:function(text,isUpperCase){var _ref18=this||{},pmRecord=_ref18.pmRecord,resourcesCount=_ref18.resourcesCount;return(0,pm_utils/* getPlaceholderText */.Sb)({pmRecord:pmRecord,text:text,isUpperCase:isUpperCase,isSingular:1===resourcesCount})}}},planner_ResourcePlannervue_type_script_lang_js=ResourcePlannervue_type_script_lang_js,ResourcePlanner_component=(0,componentNormalizer/* default */.Z)(planner_ResourcePlannervue_type_script_lang_js,ResourcePlannervue_type_template_id_44908059_render,ResourcePlannervue_type_template_id_44908059_staticRenderFns,!1,null,null,null)
/* harmony default export */,ResourcePlanner=ResourcePlanner_component.exports,EditPlannervue_type_template_id_16fca1b6_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"planner-edit-dialog",attrs:{visible:!0,"before-close":_vm.closeDialog,title:_vm.$t("common._common.edit")+" "+_vm.$t("maintenance.pm.planner")}},[_c("div",{staticClass:"position-relative height160"},[_c("div",{staticClass:"planner-dialog-body"},[_c("div",{staticClass:"planner-name-label"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm.planner_name"))+" ")]),_c("el-input",{staticClass:"fc-input-full-border2",model:{value:_vm.plannerName,callback:function($$v){_vm.plannerName=$$v},expression:"plannerName"}})],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.closeDialog}},[_vm._v(_vm._s(_vm.$t("maintenance._workorder.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.isSaving},on:{click:_vm.savePlanner}},[_vm._v(_vm._s(_vm.$t("maintenance._workorder.save")))])],1)])])},EditPlannervue_type_template_id_16fca1b6_staticRenderFns=[],EditPlannervue_type_script_lang_js={props:["closeDialog","planner","onSave"],data:function(){return{plannerName:"",moduleName:"pmPlanner",isSaving:!1}},created:function(){var _ref=this||{},planner=_ref.planner,_ref2=planner||{},name=_ref2.name;this.plannerName=name||""},methods:{savePlanner:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var _ref3,moduleName,name,planner,_ref4,id,params,_yield$API$updateReco,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _this.isSaving=!0,_ref3=_this||{},moduleName=_ref3.moduleName,name=_ref3.plannerName,planner=_ref3.planner,_ref4=planner||{},id=_ref4.id,params={data:{name:name},id:id},_context.next=6,api/* API */.bl.updateRecord(moduleName,params);case 6:_yield$API$updateReco=_context.sent,error=_yield$API$updateReco.error,(0,validation/* isEmpty */.xb)(error)?(_this.closeDialog(),_this.onSave()):_this.$message.error(error.message||"Error Occured"),_this.isSaving=!1;case 10:case"end":return _context.stop()}}),_callee)})))()}}},planner_EditPlannervue_type_script_lang_js=EditPlannervue_type_script_lang_js,EditPlanner_component=(0,componentNormalizer/* default */.Z)(planner_EditPlannervue_type_script_lang_js,EditPlannervue_type_template_id_16fca1b6_render,EditPlannervue_type_template_id_16fca1b6_staticRenderFns,!1,null,null,null)
/* harmony default export */,EditPlanner=EditPlanner_component.exports,TaskSectionvue_type_template_id_5df7e287_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_vm.isJobPlanEmpty?_vm._e():[_c("div",{staticClass:"mT5 planner-trigger-section"},[_c("div",{staticClass:"section-sub-heading"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm.ad_hoc_task"))+" ")]),_c("div",{staticClass:"flex flex-no-wrap mT10 justify-between align-center"},[_c("div",{staticClass:"section-description width60"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm.ad_hoc_desc"))+" ")]),_c("el-button",{staticClass:"edit-task-btn",on:{click:_vm.editTask}},[_vm._v(_vm._s(_vm.$t("maintenance.pm.edit_task")))])],1)])],_c("el-dialog",{staticClass:"planner-task-dialog",attrs:{visible:_vm.showTaskDialog,"before-close":_vm.closeDialog,width:"70%",top:"2vh"},scopedSlots:_vm._u([{key:"title",fn:function(){return[_c("div",[_c("div",{staticClass:"section-sub-heading mB10 f16"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm.ad_hoc_task"))+" ")]),_c("div",{staticClass:"section-description width60"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.pm.ad_hoc_desc"))+" ")])])]},proxy:!0}])},[_c("div",[_vm.isLoading?_c("div",{staticClass:"flex-middle m10"},[_c("spinner",{attrs:{show:_vm.isLoading,size:"80"}})],1):[_c("div",{staticClass:"planner-task-section"},[_c("TaskCreation",{attrs:{isPreRequisite:!1,isJobPlan:!1},model:{value:_vm.tasksList,callback:function($$v){_vm.tasksList=$$v},expression:"tasksList"}})],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.closeDialog}},[_vm._v(_vm._s(_vm.$t("maintenance._workorder.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.isSaving},on:{click:_vm.saveTask}},[_vm._v(_vm._s(_vm.$t("maintenance._workorder.save")))])],1)]],2)])],2)},TaskSectionvue_type_template_id_5df7e287_scoped_true_staticRenderFns=[],TasksLayout=__webpack_require__(189494),TaskCreationvue_type_script_lang_js={extends:TasksLayout/* default */.Z,created:function(){var value=this.value,isEdit=this.isEdit;this.loadWoForms(),!(0,validation/* isEmpty */.xb)(value)&&isEdit&&this.prefillJobPlanTasks(),(0,validation/* isEmpty */.xb)(value)&&this.addNewSection()}},tasks_TaskCreationvue_type_script_lang_js=TaskCreationvue_type_script_lang_js,TaskCreation_component=(0,componentNormalizer/* default */.Z)(tasks_TaskCreationvue_type_script_lang_js,TaskCreation_render,TaskCreation_staticRenderFns,!1,null,"4f078b7a",null)
/* harmony default export */,TaskCreation=TaskCreation_component.exports,SCOPE_OPTIONS={SPACES:2,SPACECATEGORY:3,ASSETCATEGORY:4,ASSETS:6,BUILDINGS:7,SITES:8},TaskSectionvue_type_script_lang_js={props:["closeDialog","reloadPlanner","pmRecord","showTaskDialog","planner"],components:{TaskCreation:TaskCreation},data:function(){return{tasksList:[],isSaving:!1,isLoading:!1}},computed:{moduleName:function(){return"jobplan"},isJobPlanEmpty:function(){var _ref=this||{},jobPlanId=_ref.jobPlanId;return(0,validation/* isEmpty */.xb)(jobPlanId)},jobPlanId:function(){var _ref2=this||{},planner=_ref2.planner,_ref3=planner||{},jobPlan=_ref3.jobPlan,_ref4=jobPlan||{},id=_ref4.id;return id}},methods:{saveTask:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var _ref5,tasksList,moduleName,pmRecord,_ref6,assignmentTypeEnum,params,_yield$API$createReco,data,error,_ref7,id;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _this.isSaving=!0,_ref5=_this||{},tasksList=_ref5.tasksList,moduleName=_ref5.moduleName,pmRecord=_ref5.pmRecord,_ref6=pmRecord||{},assignmentTypeEnum=_ref6.assignmentTypeEnum,assignmentTypeEnum=SCOPE_OPTIONS[assignmentTypeEnum],params={data:{jobPlanCategory:assignmentTypeEnum,jobplansection:tasksList}},_context.next=7,api/* API */.bl.createRecord(moduleName,params);case 7:if(_yield$API$createReco=_context.sent,data=_yield$API$createReco[moduleName],error=_yield$API$createReco.error,(0,validation/* isEmpty */.xb)(error)){_context.next=16;break}return _ref7=data||{},id=_ref7.id,_context.next=14,_this.associateJobPlan(id);case 14:_context.next=17;break;case 16:_this.$message.error(error.message||"Error occured");case 17:_this.isSaving=!1;case 18:case"end":return _context.stop()}}),_callee)})))()},editTask:function(){this.$emit("update:showTaskDialog",!0),this.loadJobPlan()},loadJobPlan:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var _ref8,moduleName,jobPlanId,params,_yield$API$fetchRecor,data,error,_ref9,jobplansection;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _this2.isLoading=!0,_ref8=_this2||{},moduleName=_ref8.moduleName,jobPlanId=_ref8.jobPlanId,params={id:jobPlanId},_context2.next=5,api/* API */.bl.fetchRecord(moduleName,params);case 5:_yield$API$fetchRecor=_context2.sent,data=_yield$API$fetchRecor[moduleName],error=_yield$API$fetchRecor.error,(0,validation/* isEmpty */.xb)(error)?(_ref9=data||{},jobplansection=_ref9.jobplansection,_this2.tasksList=jobplansection):_this2.$message.error(error.message||"Error occured"),_this2.isLoading=!1;case 10:case"end":return _context2.stop()}}),_callee2)})))()},associateJobPlan:function(id){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var params,_yield$API$updateReco,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return params={jobPlan:{id:id}},_context3.next=3,api/* API */.bl.updateRecord("pmPlanner",params);case 3:_yield$API$updateReco=_context3.sent,error=_yield$API$updateReco.error,(0,validation/* isEmpty */.xb)(error)?(_this3.$message.success(_this3.$t("maintenance.pm.planner_update")),_this3.reloadPlanner()):_this3.$message.error(error.message||"Error Occured");case 6:case"end":return _context3.stop()}}),_callee3)})))()}}},tasks_TaskSectionvue_type_script_lang_js=TaskSectionvue_type_script_lang_js,TaskSection_component=(0,componentNormalizer/* default */.Z)(tasks_TaskSectionvue_type_script_lang_js,TaskSectionvue_type_template_id_5df7e287_scoped_true_render,TaskSectionvue_type_template_id_5df7e287_scoped_true_staticRenderFns,!1,null,"5df7e287",null)
/* harmony default export */,TaskSection=TaskSection_component.exports,MAX_TABS=4,Plannervue_type_script_lang_js={props:["pmProps"],created:function(){this.init()},components:{Spinner:Spinner/* default */.Z,TriggerSection:TriggerSection,ResourcePlanner:ResourcePlanner,EditPlanner:EditPlanner,TaskSection:TaskSection},data:function(){return{moduleName:"pmPlanner",plannerList:[],isSavingPlanner:!1,isPlannerListLoading:!1,selectedPlanner:null,selectedPlannerAction:null,selectedPlannerRecord:null,isPlannerLoading:!1,showPlannerEdit:!1,pmRecord:{},showTaskDialog:!1,isPmLoading:!1}},watch:{pmProps:{handler:function(){this.loadPm()},deep:!0,immediate:!0}},computed:{filteredPlannerList:function(){var _ref=this||{},plannerList=_ref.plannerList;return(plannerList||[]).filter((function(_,index){return index<MAX_TABS}))},dropDownPlannerList:function(){var _ref2=this||{},plannerList=_ref2.plannerList;return(plannerList||[]).filter((function(_,index){return index>=MAX_TABS}))},trigger:function(){var _ref3=this||{},selectedPlannerRecord=_ref3.selectedPlannerRecord,_ref4=selectedPlannerRecord||{},trigger=_ref4.trigger;return trigger},isJobPlanEmpty:function(){var _ref5=this||{},selectedPlannerRecord=_ref5.selectedPlannerRecord,_ref6=selectedPlannerRecord||{},jobPlan=_ref6.jobPlan,_ref7=jobPlan||{},id=_ref7.id;return(0,validation/* isEmpty */.xb)(id)}},methods:{init:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var _ref8,plannerList;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _this.isPlannerListLoading=!0,_context.next=3,_this.loadPlanners({skipLoading:!0});case 3:if(_ref8=_this||{},plannerList=_ref8.plannerList,!(0,validation/* isEmpty */.xb)(plannerList)){_context.next=7;break}return _context.next=7,_this.addNewPlanner({skipLoading:!0,hideMessage:!0});case 7:_this.isPlannerListLoading=!1;case 8:case"end":return _context.stop()}}),_callee)})))()},loadPm:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var moduleName,_ref9,pmProps,id,_yield$API$fetchRecor,data,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _this2.isPmLoading=!0,moduleName="plannedmaintenance",_ref9=_this2||{},pmProps=_ref9.pmProps,id=pmProps.id,_context2.next=6,api/* API */.bl.fetchRecord(moduleName,{id:id},{force:!0});case 6:_yield$API$fetchRecor=_context2.sent,data=_yield$API$fetchRecor[moduleName],error=_yield$API$fetchRecor.error,(0,validation/* isEmpty */.xb)(error)?_this2.pmRecord=data:_this2.$message.error(error.message||"Error occured while fetching planned maintenance"),_this2.isPmLoading=!1;case 11:case"end":return _context2.stop()}}),_callee2)})))()},loadPlanners:function(props){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var _ref10,skipLoading,_ref11,moduleName,pmProps,selectedPlanner,_ref12,id,params,filters,_yield$API$fetchAll,list,error,isIdSelected,_ref13,_ref14,initPlanner,_ref15,_id;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:
// To decided if we have to load the planners list,
// not needed while adding new planner.
return _ref10=props||{},skipLoading=_ref10.skipLoading,skipLoading||(_this3.isPlannerListLoading=!0),_ref11=_this3||{},moduleName=_ref11.moduleName,pmProps=_ref11.pmProps,selectedPlanner=_ref11.selectedPlanner,_ref12=pmProps||{},id=_ref12.id,params={},(0,validation/* isEmpty */.xb)(id)||(filters=JSON.stringify({pmId:{operatorId:9,value:["".concat(id)]}}),params=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},params),{},{filters:filters})),_context3.next=8,api/* API */.bl.fetchAll(moduleName,params,{force:!0});case 8:if(_yield$API$fetchAll=_context3.sent,list=_yield$API$fetchAll.list,error=_yield$API$fetchAll.error,!(0,validation/* isEmpty */.xb)(error)){_context3.next=20;break}// No need to set selected planner if we have an already selected planner
if(_this3.plannerList=list,isIdSelected=list.some((function(planner){return planner.id===selectedPlanner})),isIdSelected||(0,validation/* isEmpty */.xb)(list)){_context3.next=20;break}return _ref13=list||[],_ref14=(0,slicedToArray/* default */.Z)(_ref13,1),initPlanner=_ref14[0],_ref15=initPlanner||{},_id=_ref15.id,_this3.selectedPlanner=_id,_context3.next=20,_this3.loadPlanner();case 20:skipLoading||(_this3.isPlannerListLoading=!1);case 21:case"end":return _context3.stop()}}),_callee3)})))()},loadPlanner:function(){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){var _ref16,moduleName,id,_yield$API$fetchRecor2,record,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:return _this4.isPlannerLoading=!0,_ref16=_this4||{},moduleName=_ref16.moduleName,id=_ref16.selectedPlanner,_context4.next=4,api/* API */.bl.fetchRecord(moduleName,{id:id},{force:!0});case 4:_yield$API$fetchRecor2=_context4.sent,record=_yield$API$fetchRecor2[moduleName],error=_yield$API$fetchRecor2.error,(0,validation/* isEmpty */.xb)(error)&&(_this4.selectedPlannerRecord=record),_this4.isPlannerLoading=!1;case 9:case"end":return _context4.stop()}}),_callee4)})))()},getFormattedText:function(text,isUpperCase,removePlural){var _ref17=this||{},pmRecord=_ref17.pmRecord,placeholder=(0,pm_utils/* getResourcePlaceholder */.$A)(pmRecord,isUpperCase),formattedPlaceholder=placeholder.slice(0,-1),formattedText=(0,pm_utils/* getPlaceholderText */.Sb)({pmRecord:pmRecord,text:text,isUpperCase:isUpperCase,removePlural:removePlural});return formattedText.replace(placeholder,formattedPlaceholder)},addNewPlanner:function(props){var _this5=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee5(){var _ref18,skipLoading,hideMessage,_ref19,moduleName,pmProps,plannerList,_ref20,length,_ref21,pmId,data,_yield$API$createReco,record,error,_ref22,id;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context5){while(1)switch(_context5.prev=_context5.next){case 0:return _ref18=props||{},skipLoading=_ref18.skipLoading,hideMessage=_ref18.hideMessage,_this5.isSavingPlanner=!0,_ref19=_this5||{},moduleName=_ref19.moduleName,pmProps=_ref19.pmProps,plannerList=_ref19.plannerList,_ref20=plannerList||[],length=_ref20.length,_ref21=pmProps||{},pmId=_ref21.id,data={pmId:pmId,name:"Planner ".concat(length+1)},_context5.next=8,api/* API */.bl.createRecord(moduleName,{data:data});case 8:if(_yield$API$createReco=_context5.sent,record=_yield$API$createReco[moduleName],error=_yield$API$createReco.error,!(0,validation/* isEmpty */.xb)(error)){_context5.next=17;break}return _context5.next=14,_this5.loadPlanners({skipLoading:skipLoading});case 14:hideMessage||_this5.$message.success(_this5.$t("maintenance.pm.planner_added")),_ref22=record||{},id=_ref22.id,length>=MAX_TABS?_this5.moveTabSelection(id):(_this5.selectedPlanner=id,_this5.loadPlanner());case 17:_this5.isSavingPlanner=!1;case 18:case"end":return _context5.stop()}}),_callee5)})))()},switchPlannerTab:function(args,planner){
// This method will be triggered even when the more icon is clicked,
// to avoid that we are checking if it belongs to that div.
var clickedElementClass=this.$getProperty(args,"0.target.className"),_ref23=planner||{},id=_ref23.id,_ref24=this||{},selectedPlanner=_ref24.selectedPlanner;["more-icon","el-icon-more fwBold"].includes(clickedElementClass)||selectedPlanner===id||(this.selectedPlanner=id,this.loadPlanner())},moveTabSelection:function(plannerId){var _ref25=this||{},plannerList=_ref25.plannerList,currentPlanner=plannerList.find((function(planner){return planner.id===plannerId}));plannerList=plannerList.filter((function(planner){return planner.id!==plannerId})),plannerList.splice(MAX_TABS-1,0,currentPlanner),this.$set(this,"plannerList",plannerList),this.selectedPlanner=plannerId,this.loadPlanner()},handlePlannerActions:function(args,currPlanner){var _this6=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee6(){var _ref26,moduleName,selectedPlanner,command,_ref27,id,dialogObj,canDelete,_yield$API$deleteReco,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context6){while(1)switch(_context6.prev=_context6.next){case 0:if(_ref26=_this6||{},moduleName=_ref26.moduleName,selectedPlanner=_ref26.selectedPlanner,command=_this6.$getProperty(args,"0"),_ref27=currPlanner||{},id=_ref27.id,"editPlanner"!==command){_context6.next=8;break}_this6.selectedPlannerAction=currPlanner,_this6.showPlannerEdit=!0,_context6.next=19;break;case 8:if("deletePlanner"!==command){_context6.next=19;break}return dialogObj={title:_this6.$t("maintenance.pm.planner_delete"),message:_this6.$t("maintenance.pm.planner_delete_prompt"),rbLabel:_this6.$t("common._common.delete"),rbClass:"pmv2-delete-dialog-btn",className:"pmv2-delete-dialog"},_context6.next=12,_this6.$dialog.confirm(dialogObj);case 12:if(canDelete=_context6.sent,!canDelete){_context6.next=19;break}return _context6.next=16,api/* API */.bl.deleteRecord(moduleName,[id]);case 16:_yield$API$deleteReco=_context6.sent,error=_yield$API$deleteReco.error,(0,validation/* isEmpty */.xb)(error)?(_this6.$message.success(_this6.$t("maintenance.pm.planner_delete_message")),id===selectedPlanner&&(_this6.selectedPlanner=null,_this6.selectedPlannerRecord={}),_this6.loadPlanners()):_this6.$message.error(error.message||"Error Occured");case 19:case"end":return _context6.stop()}}),_callee6)})))()},openTaskDialog:function(){this.showTaskDialog=!0},onSave:function(){var _ref28=this||{},pmRecord=_ref28.pmRecord,_ref29=pmRecord||{},id=_ref29.id;(0,validation/* isEmpty */.xb)(this.plannerList)?this.$message.warning("Please create a planner to publish it."):this.$router.push({path:"",query:{id:id,tab:"publish"}})},onCancel:function(){var _ref30=this||{},$route=_ref30.$route,_ref31=$route||{},query=_ref31.query;this.$router.push({path:"",query:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},query),{},{tab:"configuration"})})}}},pages_Plannervue_type_script_lang_js=Plannervue_type_script_lang_js,Planner_component=(0,componentNormalizer/* default */.Z)(pages_Plannervue_type_script_lang_js,render,staticRenderFns,!1,null,"a3011b0e",null)
/* harmony default export */,Planner=Planner_component.exports},
/***/188742:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"22bc1f7e3fecc069519710728d363ce9.svg";
/***/},
/***/754125:
/***/function(module,__unused_webpack_exports,__webpack_require__){var map={"./af":702525,"./af.js":702525,"./ar":689102,"./ar-dz":463778,"./ar-dz.js":463778,"./ar-kw":410960,"./ar-kw.js":410960,"./ar-ly":281490,"./ar-ly.js":281490,"./ar-ma":985507,"./ar-ma.js":985507,"./ar-sa":224042,"./ar-sa.js":224042,"./ar-tn":191523,"./ar-tn.js":191523,"./ar.js":689102,"./az":938365,"./az.js":938365,"./be":544860,"./be.js":544860,"./bg":709904,"./bg.js":709904,"./bm":660952,"./bm.js":660952,"./bn":709807,"./bn.js":709807,"./bo":858437,"./bo.js":858437,"./br":784557,"./br.js":784557,"./bs":979332,"./bs.js":979332,"./ca":493667,"./ca.js":493667,"./cs":276860,"./cs.js":276860,"./cv":515427,"./cv.js":515427,"./cy":158863,"./cy.js":158863,"./da":513520,"./da.js":513520,"./de":112111,"./de-at":30464,"./de-at.js":30464,"./de-ch":750701,"./de-ch.js":750701,"./de.js":112111,"./dv":494438,"./dv.js":494438,"./el":33121,"./el.js":33121,"./en-au":849197,"./en-au.js":849197,"./en-ca":753885,"./en-ca.js":753885,"./en-gb":551914,"./en-gb.js":551914,"./en-ie":880938,"./en-ie.js":880938,"./en-nz":619722,"./en-nz.js":619722,"./eo":742783,"./eo.js":742783,"./es":56820,"./es-do":559651,"./es-do.js":559651,"./es-us":146018,"./es-us.js":146018,"./es.js":56820,"./et":818686,"./et.js":818686,"./eu":831323,"./eu.js":831323,"./fa":261885,"./fa.js":261885,"./fi":263741,"./fi.js":263741,"./fo":219961,"./fo.js":219961,"./fr":802800,"./fr-ca":388121,"./fr-ca.js":388121,"./fr-ch":427979,"./fr-ch.js":427979,"./fr.js":802800,"./fy":428930,"./fy.js":428930,"./gd":695513,"./gd.js":695513,"./gl":224485,"./gl.js":224485,"./gom-latn":703878,"./gom-latn.js":703878,"./gu":25435,"./gu.js":25435,"./he":862825,"./he.js":862825,"./hi":727282,"./hi.js":727282,"./hr":402438,"./hr.js":402438,"./hu":591310,"./hu.js":591310,"./hy-am":614794,"./hy-am.js":614794,"./id":108761,"./id.js":108761,"./is":256593,"./is.js":256593,"./it":272196,"./it.js":272196,"./ja":812645,"./ja.js":812645,"./jv":471869,"./jv.js":471869,"./ka":174093,"./ka.js":174093,"./kk":919794,"./kk.js":919794,"./km":792637,"./km.js":792637,"./kn":828684,"./kn.js":828684,"./ko":94565,"./ko.js":94565,"./ky":465606,"./ky.js":465606,"./lb":472027,"./lb.js":472027,"./lo":280366,"./lo.js":280366,"./lt":327311,"./lt.js":327311,"./lv":531851,"./lv.js":531851,"./me":952700,"./me.js":952700,"./mi":673575,"./mi.js":673575,"./mk":195509,"./mk.js":195509,"./ml":429866,"./ml.js":429866,"./mr":713798,"./mr.js":713798,"./ms":526848,"./ms-my":701212,"./ms-my.js":701212,"./ms.js":526848,"./mt":863181,"./mt.js":863181,"./my":63977,"./my.js":63977,"./nb":47248,"./nb.js":47248,"./ne":891859,"./ne.js":891859,"./nl":127058,"./nl-be":66901,"./nl-be.js":66901,"./nl.js":127058,"./nn":561748,"./nn.js":561748,"./pa-in":634266,"./pa-in.js":634266,"./pl":79581,"./pl.js":79581,"./pt":687410,"./pt-br":906114,"./pt-br.js":906114,"./pt.js":687410,"./ro":138295,"./ro.js":138295,"./ru":539862,"./ru.js":539862,"./sd":59548,"./sd.js":59548,"./se":293236,"./se.js":293236,"./si":340289,"./si.js":340289,"./sk":658339,"./sk.js":658339,"./sl":574170,"./sl.js":574170,"./sq":615316,"./sq.js":615316,"./sr":668791,"./sr-cyrl":447630,"./sr-cyrl.js":447630,"./sr.js":668791,"./ss":65773,"./ss.js":65773,"./sv":731159,"./sv.js":731159,"./sw":422329,"./sw.js":422329,"./ta":267054,"./ta.js":267054,"./te":971280,"./te.js":971280,"./tet":154120,"./tet.js":154120,"./th":254679,"./th.js":254679,"./tl-ph":63270,"./tl-ph.js":63270,"./tlh":845386,"./tlh.js":845386,"./tr":664669,"./tr.js":664669,"./tzl":691434,"./tzl.js":691434,"./tzm":57217,"./tzm-latn":547665,"./tzm-latn.js":547665,"./tzm.js":57217,"./uk":969596,"./uk.js":969596,"./ur":985133,"./ur.js":985133,"./uz":349456,"./uz-latn":978737,"./uz-latn.js":978737,"./uz.js":349456,"./vi":905577,"./vi.js":905577,"./x-pseudo":464564,"./x-pseudo.js":464564,"./yo":68854,"./yo.js":68854,"./zh-cn":795817,"./zh-cn.js":795817,"./zh-hk":266634,"./zh-hk.js":266634,"./zh-tw":749292,"./zh-tw.js":749292};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=754125},
/***/567835:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);
// Module
var code='<svg width="17" height="11" viewBox="0 0 17 11" xmlns="http://www.w3.org/2000/svg"><g id="Page-1" stroke="none" stroke-width="1" stroke-linecap="round"><g id="Approval-Task-Page-Copy" transform="translate(-1224 -105)" stroke="#333" stroke-width="1.8"><g id="Filter" transform="translate(1225 105)"><path d="M.5 1.5h14" id="Line-11"/><path d="M.5 5.5H12" id="Line-11-Copy"/><path d="M.5 9.5h8" id="Line-11-Copy-2"/></g></g></g></svg>';
// Exports
/* harmony default export */__webpack_exports__["default"]=code},
/***/271741:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);
// Module
var code='<svg width="512" height="512" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><g transform="translate(32 .5)" fill="currentcolor" fill-rule="nonzero" id="lookup" stroke="none" stroke-width="1"><path d="M183.466 480.932c0 10.704-8.71 15.247-19.492 15.247H78.082C20.151 496.179 0 480.932 0 418.65V77.528C0 17.254 15.553 0 78.082 0h239.999c62.999 0 78.082 14.659 78.082 77.528v185.098c0 10.705-4.305 20.37-15.083 20.37-10.782 0-14.915-9.665-14.915-20.37V77.528c0-38.847-5.615-47.576-48.084-47.576H78.082c-39.68 0-47.917 13.097-47.917 47.576V418.65c0 40.768 6.732 47.518 47.917 47.518h85.892c10.782 0 19.492 4.058 19.492 14.763z" id="Path"/><path d="M298.56 116.292H97.497c-10.782 0-19.52 6.637-19.52 14.827 0 8.19 8.738 14.828 19.52 14.828H298.56c10.78 0 19.522-6.638 19.522-14.828s-8.743-14.827-19.522-14.827zm19.522 92.355c0-8.19-8.744-14.827-19.523-14.827H97.498c-10.782 0-19.52 6.637-19.52 14.827 0 8.19 8.738 14.827 19.52 14.827H298.56c10.78 0 19.522-6.637 19.522-14.827zm-220.584 62.7c-10.783 0-19.522 6.639-19.522 14.828 0 8.19 8.739 14.827 19.52 14.827h102.592c10.782 0 19.52-6.637 19.52-14.827 0-8.19-8.74-14.827-19.52-14.827H97.497z" id="Shape"/><path d="M313.307 293.274c31.684 0 62.96 12.212 92.762 35.826a230.97 230.97 0 0111.047 9.343c13.134 11.819 22.4 22.164 33.691 36.212l.773.963c.603.753 1.29 1.656 2.058 2.693l.897 1.222.937 1.295 1.133 1.59c8.391 11.835 8.391 27.68.026 39.48l-1.116 1.57c-1.147 1.6-2.36 3.25-3.376 4.56l-.558.709-1.538 1.914c-10.94 13.558-20.096 23.715-32.938 35.267a231.043 231.043 0 01-11.036 9.333c-29.8 23.615-61.078 35.827-92.762 35.827-31.683 0-62.96-12.211-92.761-35.826a230.993 230.993 0 01-11.047-9.343c-12.837-11.55-21.989-21.705-32.928-35.264l-1.54-1.914-.466-.592a121.78 121.78 0 01-2.179-2.9l-.745-1.024c-.288-.398-.569-.789-.841-1.17l-.792-1.113a34.168 34.168 0 01-.003-39.513l.802-1.126.412-.575.859-1.187.899-1.225a91.05 91.05 0 012.059-2.693l.792-.988c14.496-18.03 27.043-31.52 44.717-45.524 29.801-23.615 61.079-35.827 92.762-35.827zm0 29.8c-24.536 0-49.45 9.727-74.255 29.383-15.22 12.06-26.349 23.94-39.232 39.888l-1.671 2.08-.324.417c-.743.966-1.739 2.33-2.78 3.786l-.725 1.02a4.37 4.37 0 00.002 5.056l1.089 1.526c.899 1.251 1.757 2.42 2.414 3.276l.473.605 1.479 1.84c10.016 12.41 18.255 21.549 29.654 31.806a201.246 201.246 0 009.621 8.139c24.806 19.655 49.72 29.383 74.255 29.383 24.536 0 49.45-9.728 74.255-29.384a201.302 201.302 0 009.613-8.13c11.675-10.504 20.036-19.834 30.372-32.69l.911-1.14.34-.438c.664-.867 1.54-2.06 2.385-3.236l1.112-1.562a4.368 4.368 0 00-.01-5.06l-.931-1.309c-1.171-1.633-2.325-3.2-3.036-4.087l-.744-.927-1.54-1.908c-9.667-11.92-17.758-20.832-28.85-30.813a201.224 201.224 0 00-9.622-8.138c-24.806-19.656-49.719-29.383-74.255-29.383z" id="Path"/><path d="M313.6 365.35c-16.497 0-29.867 13.276-29.867 29.655 0 16.378 13.37 29.654 29.867 29.654s29.867-13.276 29.867-29.654c0-16.379-13.37-29.654-29.867-29.654z" id="Path"/></g></svg>';
// Exports
/* harmony default export */__webpack_exports__["default"]=code}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/70334.js.map