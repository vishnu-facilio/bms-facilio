"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[4662],{
/***/304662:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return Workflow}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/workflow/Workflow.vue?vue&type=template&id=5362484e
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"scrollable"},[_c("div",{staticClass:"fR m10"},[_c("el-button",{staticClass:"btn-blue-fill",on:{click:function($event){return _vm.submit()}}},[_vm._v(_vm._s(_vm.$t("common._common.run")))]),_vm.id?_c("el-button",{staticClass:"fc-btn-grey-fill",on:{click:_vm.update}},[_vm._v(_vm._s(_vm.$t("common._common.update")))]):_vm._e()],1),_c("div",{staticClass:"pL20 pR20 pT50"},[_c("script-editor",{attrs:{scriptClass:"pT20 pR20 height350 width100"},model:{value:_vm.code.payload,callback:function($$v){_vm.$set(_vm.code,"payload",$$v)},expression:"code.payload"}})],1),_c("div",{staticClass:"mT30"},[_c("div",{staticClass:"error-tags-container "},_vm._l(_vm.errors,(function(error,index){return _c("el-tag",{key:index,staticClass:"m5",attrs:{type:"danger"}},[_vm._v(_vm._s(error))])})),1),_c("el-input",{staticClass:"pL20 pR20 pT10 result-box",attrs:{type:"textarea",id:"resultBox",rows:2,placeholder:"Result"},model:{value:_vm.code.result,callback:function($$v){_vm.$set(_vm.code,"result",$$v)},expression:"code.result"}})],1)])},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),api=__webpack_require__(32284),setup=__webpack_require__(572552),Workflowvue_type_script_lang_js={data:function(){return{errors:[],code:{payload:"",result:""}}},components:{ScriptEditor:setup/* ScriptEditor */.Y},computed:{id:function(){return this.$route.query.id}},created:function(){var _this=this,id=this.id,defaultScript="void test(){\n    \n    \n}";if(id)api/* API */.bl.get("/v2/workflow/getFunctionMeta?ids[0]=".concat(id)).then((function(_ref){var data=_ref.data;_this.code.payload=data.workflowUserFunctions[0].workflowV2String}));else{var lst=window.localStorage.getItem("workflow.playground");lst&&(defaultScript=lst),this.code.payload=defaultScript}},methods:{submit:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var code,$route,_ref2,query,_ref3,cloudService,_ref4,payload,url;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:code=_this2.code,$route=_this2.$route,_ref2=$route||{},query=_ref2.query,_ref3=query||{},cloudService=_ref3.cloudService,_ref4=code||{},payload=_ref4.payload,_this2.setResult(""),window.localStorage.setItem("workflow.playground",payload),url="","true"===cloudService?(url="v3/agent/runWorkflow",api/* API */.bl.post(url,{data:{workflow:{workflowV2String:payload,isV2Script:!0}}}).then((function(response){response.data.workflowResponse&&_this2.setResult(response.data.workflowResponse),_this2.setError(response.data.workflowSyntaxError)})).catch((function(){}))):(url="/v2/workflow/runWorkflow",api/* API */.bl.post(url,{workflow:{workflowV2String:_this2.code.payload,isV2Script:!0}}).then((function(response){response.data.workflow.logString&&_this2.setResult(response.data.workflow.logString),_this2.setError(response.data.workflowSyntaxError)})).catch((function(){})));case 8:case"end":return _context.stop()}}),_callee)})))()},setError:function(errors){this.errors=errors&&errors.errors||[],this.errors=errors&&errors.errors?errors.errors:[]},setResult:function(result){this.code.result=result},update:function(){var _this3=this;this.setResult(""),window.localStorage.setItem("workflow.playground",this.code.payload),api/* API */.bl.post("/v2/workflow/updateWorkflow",{workflow:{workflowV2String:this.code.payload,id:this.id}}).then((function(_ref5){var error=_ref5.error;error?_this3.$message.error(error.message):_this3.setResult("Updated successfully")}))}}},workflow_Workflowvue_type_script_lang_js=Workflowvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(workflow_Workflowvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,Workflow=component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/4662.js.map