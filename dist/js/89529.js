"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[89529],{
/***/720096:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return PreviewFile}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/PreviewFile.vue?vue&type=template&id=447c7e89
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.currentFile?_c("div",{directives:[{name:"show",rawName:"v-show",value:_vm.show,expression:"show"}],staticClass:"preview-file"},[_c("div",{staticClass:"top-toolbar"},[_c("div",{staticClass:"a-top-toolbar"},[_c("div",{staticClass:"file-name word-break-keep"},[_vm._v(" "+_vm._s(_vm.currentFile.fileName)+" ")]),_c("div",{staticClass:"top-toolbar-icon-right flex align-center"},[_vm.currentFile.contentType.includes("image")?[_c("div",{staticClass:"flex-middle pL15"},[_vm.showOriginalImage?_c("div",{staticClass:"fc-white-14 word-break-keep pointer",on:{click:_vm.showOriginalPhoto}},[_vm._v(" "+_vm._s(_vm.$t("common._common.view_original"))+" ")]):_vm._e(),_vm.showCompressedImage?_c("div",{staticClass:"fc-white-14 word-break-keep pointer",on:{click:_vm.showCompressedPhoto}},[_vm._v(" "+_vm._s(_vm.$t("common._common.view_default"))+" ")]):_vm._e()]),_c("div",{staticClass:"download-icon round flex-middle pL15",on:{click:function($event){return _vm.downloadAttachment(_vm.currentFile)}}},[_c("i",{staticClass:"el-icon-download op8",staticStyle:{color:"#ffff"}})])]:_vm._e(),_vm.currentFile.contentType.includes("pdf")?[_c("div",{staticClass:"download-icon round flex-middle pL15",on:{click:function($event){return _vm.downloadAttachment(_vm.currentFile)}}},[_c("i",{staticClass:"el-icon-download op8",staticStyle:{color:"#ffff"}})])]:_vm._e(),_vm.showDeleteOption()?_c("div",{staticClass:"flex-middle pL15",on:{click:function($event){return _vm.deletePreview()}}},[_c("inline-svg",{staticClass:"pointer edit-icon-color close vertical-text-top",attrs:{src:"svgs/delete",iconClass:"icon icon-md"}})],1):_vm._e(),_c("div",{staticClass:"pL15"},[_c("i",{staticClass:"el-icon-close close",on:{click:_vm.closePreview}})])],2)])]),_vm.currentFileIndex>0?_c("a",{staticClass:"el-icon-arrow-left prev",staticStyle:{"font-size":"30px"},on:{click:function($event){return _vm.plusSlides(-1)}}}):_vm._e(),_vm.currentFileIndex<_vm.files.length-1?_c("a",{staticClass:"el-icon-arrow-right next",staticStyle:{"font-size":"30px"},on:{click:function($event){return _vm.plusSlides(1)}}}):_vm._e(),_c("div",{staticClass:"preview-content"},[_vm.currentFile.contentType.includes("image")?[_vm.compressedImage?_c("img",{staticClass:"content",staticStyle:{"box-shadow":"none"},attrs:{src:_vm.$prependBaseUrl(_vm.currentFile.previewUrl)}}):_vm.originalImage?_c("img",{staticClass:"content original",staticStyle:{"box-shadow":"none"},attrs:{src:_vm.$prependBaseUrl(_vm.currentFile.previewUrl+"?fetchOriginal=true")}}):_vm._e()]:_vm.currentFile.contentType.includes("pdf")?_c("div",{staticClass:"width100 height-100"},[_c("iframe",{staticClass:"fc-preview-pdf",attrs:{src:_vm.$prependBaseUrl(_vm.currentFile.previewUrl),height:"100%",width:"100%"}})]):_vm.isVideoSupported(_vm.currentFile.contentType)?_c("div",{staticClass:"width100 height-100 fc-preview-video"},[_c("video",{attrs:{controls:""}},[_c("source",{attrs:{src:_vm.$prependBaseUrl(_vm.$getProperty(_vm.currentFile,"downloadUrl",null)),type:_vm.$getProperty(_vm.currentFile,"contentType")}}),_vm._v(" "+_vm._s(_vm.$t("common._common.browser_not_supported"))+" ")])]):_c("div",{staticClass:"no-preview"},[_c("div",{staticClass:"flex justify-center pT24"},[_c("inline-svg",{staticClass:"d-flex",attrs:{src:_vm.getFileIcon(_vm.currentFile),iconClass:"icon icon-60 overlay"}})],1),_c("div",{staticClass:"f14 pT12 pB12"},[_vm._v("No preview available")]),_c("div",{staticClass:"download-button"},[_c("a",{staticClass:"flex flex-row",staticStyle:{color:"#ffff"},on:{click:function($event){return _vm.downloadAttachment(_vm.currentFile)}}},[_c("div",[_vm._v("Download")])])])])],2),_vm.exportDownloadUrl?_c("iframe",{staticStyle:{display:"none"},attrs:{src:_vm.exportDownloadUrl}}):_vm._e()]):_vm._e()},staticRenderFns=[],validation=(__webpack_require__(339772),__webpack_require__(260228),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(228436),__webpack_require__(990260)),PreviewFilevue_type_script_lang_js={props:["previewFile","files","visibility","showDelete","isLockedState","isTaskClosed"],data:function(){return{show:!0,previewUrl:null,currentFileIndex:0,currentFile:null,imageMargin:null,exportDownloadUrl:null,originalImage:!1,compressedImage:!0,showOriginalImage:!0,showCompressedImage:!1}},destroyed:function(){window.removeEventListener("keyup",this.handler)},mounted:function(){window.addEventListener("keyup",this.handler),this.preloadImages()},watch:{},computed:{},methods:{handler:function(){
// If escape key is pressed...
27===event.keyCode?this.closePreview():37===event.keyCode?this.plusSlides(-1):39===event.keyCode&&this.plusSlides(1)},preloadImages:function(){this.currentFile=this.previewFile?this.previewFile:this.files[0],this.currentFileIndex=this.files.indexOf(this.currentFile)},plusSlides:function(n){var index=this.currentFileIndex+n;index<0&&(index=0),index>=this.files.length&&(index=this.files.length-1),this.currentFileIndex=index,this.currentFile=this.files[index]},closePreview:function(){this.$emit("update:visibility",!1)},deletePreview:function(){var currentFile=this.currentFile;this.$emit("onDelete",currentFile)},downloadAttachment:function(file){var _this=this,_ref=file||{},url=_ref.downloadUrl;this.exportDownloadUrl&&(this.exportDownloadUrl=null),this.$nextTick((function(){_this.exportDownloadUrl=url}))},showOriginalPhoto:function(){this.originalImage=!0,this.showCompressedImage=!0,this.showOriginalImage=!1,this.compressedImage=!1},showCompressedPhoto:function(){this.showCompressedImage=!1,this.originalImage=!1,this.showOriginalImage=!0,this.compressedImage=!0},getFileIcon:function(attachment){var contentType=attachment.contentType,FILE_TYPE_ICONS=this.$constants.FILE_TYPE_ICONS,selectedIndex=FILE_TYPE_ICONS.findIndex((function(icons){var fileTypes=icons.fileTypes;return fileTypes.some((function(type){return contentType.includes(type)}))}));return(0,validation/* isEmpty */.xb)(selectedIndex)?FILE_TYPE_ICONS[0].path:FILE_TYPE_ICONS[selectedIndex].path},isVideoSupported:function(contentType){contentType=contentType||"";var supportedTypes=["video/webm","video/mp4","video/ogg"];return supportedTypes.includes(contentType.trim().toLowerCase())},showDeleteOption:function(){var showDelete=this.showDelete,isLockedState=this.isLockedState,isTaskClosed=this.isTaskClosed;return showDelete&&!isLockedState&&!isTaskClosed}}},components_PreviewFilevue_type_script_lang_js=PreviewFilevue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_PreviewFilevue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,PreviewFile=component.exports},
/***/604947:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return Spinner}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/Spinner.vue?vue&type=template&id=06a81286&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("transition",[_c("svg",{directives:[{name:"show",rawName:"v-show",value:_vm.show,expression:"show"}],staticClass:"spinner",class:{show:_vm.show},attrs:{width:_vm.spinnerSize,height:_vm.spinnerSize,viewBox:"0 0 44 44"}},[_c("circle",{staticClass:"path",style:{stroke:_vm.strokeColor},attrs:{fill:"none","stroke-width":"4","stroke-linecap":"round",cx:"22",cy:"22",r:"20"}})])])},staticRenderFns=[],Spinnervue_type_script_lang_js={name:"spinner",props:["show","size","colour"],computed:{spinnerSize:function(){return this.size?this.size+"px":"50px"},strokeColor:function(){return this.colour?this.colour:"#fd4b92"}}},components_Spinnervue_type_script_lang_js=Spinnervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_Spinnervue_type_script_lang_js,render,staticRenderFns,!1,null,"06a81286",null)
/* harmony default export */,Spinner=component.exports},
/***/952322:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return AuditLogPagination}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/setup/AuditLog/AuditLogPagination.vue?vue&type=template&id=7bfb080a
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"flex-middle fc-setup-pagination"},[_c("el-button",{staticClass:"fc-pagination-arrow",attrs:{type:"button",disabled:_vm.isInFirstPage},on:{click:function($event){_vm.currentPage>1&&_vm.onClickPreviousPage()}}},[_c("i",{staticClass:"el-icon-arrow-left"})]),_c("div",{staticClass:"mL10 fc-black-14 text-left bold"},[_vm._v(" "+_vm._s(_vm.currentPage)+" ")]),_c("el-button",{staticClass:"fc-pagination-arrow mL10",attrs:{type:"button",disabled:0===_vm.total},on:{click:function($event){_vm.startPage!==_vm.total&&_vm.onClickNextPage()}}},[_c("i",{staticClass:"el-icon-arrow-right"})])],1)},staticRenderFns=[],AuditLogPaginationvue_type_script_lang_js=(__webpack_require__(879288),__webpack_require__(670560),{props:{totalPages:{type:Number},total:{type:Number,required:!0},currentPage:{type:Number,required:!0}},computed:{isInFirstPage:function(){return 1===this.currentPage},isInLastPage:function(){return this.currentPage===this.totalPages},startPage:function(){return 1===this.currentPage?1:this.currentPage-1},endPage:function(){return Math.min(this.totalPages)},pages:function(){for(var range=[],i=this.startPage;i<=this.endPage;i+=1)range.push({name:i,isDisabled:i===this.currentPage});return range}},methods:{onPageChange:function(page){this.currentPage=page},onClickPreviousPage:function(){this.$emit("pagechanged",this.currentPage-1)},onClickPage:function(page){this.$emit("pagechanged",page)},onClickNextPage:function(){this.total&&this.$emit("pagechanged",this.currentPage+1)},isPageActive:function(page){return this.currentPage===page}}}),AuditLog_AuditLogPaginationvue_type_script_lang_js=AuditLogPaginationvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(AuditLog_AuditLogPaginationvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,AuditLogPagination=component.exports},
/***/435436:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return ViewSurveyResults}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/setup/survey/ViewSurveyResults.vue?vue&type=template&id=1a9c0143
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{ref:"timeLogListContainer",staticClass:"related-list-container"},[_c("div",{staticClass:"related-list-header"},[_c("div",{staticClass:"header justify-content-space"},[_c("div",{staticClass:"flex-direction-column"},[_c("div",{staticClass:"releated-widget-title d-flex flex-direction-column mL0 mB20"},[_vm._v(" "+_vm._s(_vm.$t("survey.surveys"))+" ")]),_c("div",{staticClass:"d-flex flex-direction-column justify-center mL0 mB20"},[_vm._v(" "+_vm._s(_vm.$t("survey.overall_score"))+_vm._s(_vm.overAllScore)+" ")])]),_c("div",{staticClass:"flex-middle"},[_c("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{arrow:!0,arrowType:"round",animation:"fade"},expression:"{ arrow: true, arrowType: 'round', animation: 'fade' }"}],staticClass:"pointer fwBold pL15 f16",attrs:{content:"Refresh"},on:{click:function($event){return _vm.loadAvailableSurveys()}}},[_c("i",{staticClass:"el-icon-refresh fwBold f16"})]),_c("pagination",{staticClass:"mL10",attrs:{total:_vm.totalSurveyPerPage,perPage:4,"current-page":_vm.surveyPage},on:{pagechanged:_vm.setPage}})],1)])]),_c("div",{staticClass:"width100"},[_c("div",{staticClass:"fc-related-list-table contract-table"},[_vm.isLoading?_c("div",{staticClass:"height55vh flex-center-vH"},[_c("spinner",{attrs:{show:_vm.isLoading,size:"80"}})],1):_vm.$validation.isEmpty(_vm.surveys)&&!_vm.isLoading?_c("div",{staticClass:"text-center  flex-center-vH"},[_c("InlineSvg",{staticClass:"mL40",attrs:{src:"svgs/emptystate/readings-empty",iconClass:"icon text-center icon-xxxxlg emptystate-icon-size "}}),_c("div",{staticClass:"fc-black-dark f18 bold pL50 line-height10"},[_vm._v(" "+_vm._s(_vm.$t("survey.no_surveys_available"))+" ")])],1):_c("el-table",{staticClass:"fc-table-th-pad0",staticStyle:{width:"100%"},attrs:{data:_vm.surveys,height:"100%",fit:!0}},[_c("el-table-column",{staticClass:"pR0",attrs:{label:_vm.$t("survey.survey_name")},scopedSlots:_vm._u([{key:"default",fn:function(survey){return[_c("div",{staticClass:"table-subheading main-field-column",on:{click:function($event){return _vm.showIndividualResult(survey.row)}}},[_vm._v(" "+_vm._s(survey.row.name)+" ")])]}}])}),_c("el-table-column",{staticClass:"pR0",attrs:{label:_vm.$t("survey.survey_respondent")},scopedSlots:_vm._u([{key:"default",fn:function(survey){return[_c("div",{staticClass:"table-subheading"},[_vm._v(" "+_vm._s(_vm.getSurveyRespondent(survey.row))+" ")])]}}])}),_c("el-table-column",{staticClass:"pR0",attrs:{label:_vm.$t("survey.score")},scopedSlots:_vm._u([{key:"default",fn:function(survey){return[_c("div",{staticClass:"table-subheading"},[_vm._v(" "+_vm._s(_vm.getSurveyScore(survey.row))+" ")])]}}])})],1)],1)]),_c("IndividualSurveyResult",{attrs:{showResultDialog:_vm.showResultDialog,details:_vm.details,surveyLoading:_vm.surveyLoading,recordName:_vm.recordName,moduleName:_vm.moduleName,moduleDisplayName:_vm.moduleDisplayName,surveyName:_vm.surveyName},on:{"update:showResultDialog":function($event){_vm.showResultDialog=$event},"update:show-result-dialog":function($event){_vm.showResultDialog=$event},"update:surveyLoading":function($event){_vm.surveyLoading=$event},"update:survey-loading":function($event){_vm.surveyLoading=$event}}})],1)},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),objectSpread2=__webpack_require__(595082),AuditLogPagination=(__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(434284),__webpack_require__(634338),__webpack_require__(952322)),Spinner=__webpack_require__(604947),validation=__webpack_require__(990260),vuex_esm=__webpack_require__(420629),IndividualSurveyResult=__webpack_require__(640879),SurveyUtil=__webpack_require__(575369),ViewSurveyResultsvue_type_script_lang_js={name:"surveyResponseWidget",data:function(){return{surveyPage:1,surveyPerPage:4,totalSurveyPerPage:0,templatePage:1,templatePerPage:50,isLoading:!1,surveys:[],templates:[],totalScore:null,showResultDialog:!1,details:null,surveyLoading:!1,surveyName:""}},components:{Pagination:AuditLogPagination/* default */.Z,Spinner:Spinner/* default */.Z,IndividualSurveyResult:IndividualSurveyResult/* default */.Z},props:["moduleName","moduleDisplayName","recordName"],computed:(0,objectSpread2/* default */.Z)({recordId:function(){return parseInt(this.$route.params.id)},viewName:function(){return"all"},answeredSurveyCount:function(){var surveys=this.surveys;return(0,validation/* isEmpty */.xb)(surveys)?null:(surveys=surveys.filter((function(survey){return 4===survey.responseStatus})),surveys.length)},overAllScore:function(){var surveys=this.surveys,overAllScore=0;if(!(0,validation/* isEmpty */.xb)(surveys)){var nonZeroScoreSurveys=surveys.filter((function(survey){return survey.hasOwnProperty("fullScore")&&0!==survey.fullScore}));if(!(0,validation/* isEmpty */.xb)(nonZeroScoreSurveys))return overAllScore=nonZeroScoreSurveys.reduce((function(acc,survey){return acc+survey.totalScore/survey.fullScore*100}),0)/nonZeroScoreSurveys.length,"".concat(Math.round(overAllScore),"%")}return"".concat(overAllScore,"%")}},(0,vuex_esm/* mapGetters */.Se)(["getUser"])),created:function(){this.initSurveyDetails()},watch:{surveyPage:{handler:function(newVal){(0,validation/* isEmpty */.xb)(newVal)||this.loadAvailableSurveys()},immediate:!0}},methods:{initSurveyDetails:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.next=2,_this.loadAvailableSurveys();case 2:case"end":return _context.stop()}}),_callee)})))()},loadAvailableSurveys:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var recordId,moduleName,surveyPage,surveyPerPage,viewName,type;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _this2.isLoading=!0,recordId=_this2.recordId,moduleName=_this2.moduleName,surveyPage=_this2.surveyPage,surveyPerPage=_this2.surveyPerPage,viewName=_this2.viewName,type={isViewSurveyResult:!0},_context2.next=5,(0,SurveyUtil/* loadAllSurveys */.UI)(moduleName,recordId,type,surveyPage,surveyPerPage,viewName);case 5:_this2.surveys=_context2.sent,_this2.totalSurveyPerPage=_this2.surveys.length,_this2.isLoading=!1;case 8:case"end":return _context2.stop()}}),_callee2)})))()},loadSurveyResponse:function(selectedSurvey){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return _this3.surveyLoading=!0,_context3.next=3,(0,SurveyUtil/* getSurveyDetails */["if"])(selectedSurvey);case 3:_this3.details=_context3.sent,_this3.surveyLoading=!1;case 5:case"end":return _context3.stop()}}),_callee3)})))()},showIndividualResult:function(survey){this.showResultDialog=!0,this.loadSurveyResponse(survey);var name=survey.name;this.surveyName=name},getSurveyRespondent:function(survey){var _ref=survey||{},assignedTo=_ref.assignedTo;if(!(0,validation/* isEmpty */.xb)(assignedTo)){var _ref2=assignedTo||{},name=_ref2.name;return name||"---"}return"---"},getSurveyScore:function(survey){var _ref3=survey||{},scorePercent=_ref3.scorePercent;return(0,validation/* isEmpty */.xb)(scorePercent)?"---":"".concat(scorePercent,"/100 (").concat(scorePercent,"%)")},setPage:function(page){this.surveyPage=page}}},survey_ViewSurveyResultsvue_type_script_lang_js=ViewSurveyResultsvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(survey_ViewSurveyResultsvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,ViewSurveyResults=component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/89529.js.map