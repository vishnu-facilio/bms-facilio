(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[99028],{
/***/359911:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FHeatMapCustomization}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/newcharts/components/FHeatMapCustomization.vue?vue&type=template&id=1e0241c0
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticStyle:{position:"relative"}},[_c("div",{staticClass:"customize-tab-body-axis clearboth pT0"},[_c("div",{staticClass:"customize-scroll-hidden"},[_vm.heatMapOptions?_c("div",{staticClass:"customize-scroll datapoints-malign mL20 mR20",staticStyle:{"margin-right":"20px"}},[_c("p",{staticClass:"label-txt-black mB0"},[_vm._v("Range")]),_c("div",{staticClass:"customize-input-block pT10"},[_c("el-row",{attrs:{gutter:20}},[_c("el-col",{attrs:{span:12}},[_c("p",{staticClass:"customize-label"},[_vm._v("Min")]),_c("el-input",{staticClass:"fc-input-full-border2 width100",attrs:{placeholder:"auto"},model:{value:_vm.heatMapOptions.minValue,callback:function($$v){_vm.$set(_vm.heatMapOptions,"minValue",_vm._n($$v))},expression:"heatMapOptions.minValue"}})],1),_c("el-col",{attrs:{span:12}},[_c("p",{staticClass:"customize-label"},[_vm._v("Max")]),_c("el-input",{staticClass:"fc-input-full-border2 width100",attrs:{placeholder:"auto"},model:{value:_vm.heatMapOptions.maxValue,callback:function($$v){_vm.$set(_vm.heatMapOptions,"maxValue",_vm._n($$v))},expression:"heatMapOptions.maxValue"}})],1)],1)],1),_vm._m(0),_c("div",{staticClass:"analytics-data-point flex-middle"},[_c("div",{staticClass:"colorPalette-main",on:{click:_vm.openDialog}},_vm._l(_vm.heatMapOptions.Colors[_vm.heatMapOptions.chosenColors],(function(color,idx){return _c("div",{key:idx,staticClass:"colorBlock",style:{background:color}})})),0),_c("div",{staticClass:"flex-middle mL30 pB10 pointer",on:{click:_vm.openDialog}},[_c("div",{staticClass:"fc-link2 f11"},[_vm._v("Change")]),_c("InlineSvg",{staticClass:"vertical-middle pointer color-pallete",staticStyle:{top:"2px"},attrs:{src:"svgs/painter-palette",iconClass:"icon icon-xs mL5"}})],1)]),"undefined"!==typeof _vm.heatMapOptions.reversePallete?_c("div",[_c("el-row",[_c("el-col",{attrs:{span:18}},[_c("div",{staticClass:"flex-middle"},[_c("p",{staticClass:"label-txt-black pT20 line-height20 mB10"},[_vm._v(" reverse pallete ")])])]),_c("el-col",{attrs:{span:6}},[_c("div",{staticClass:"flex-middle pT20"},[_c("span",{staticClass:"customize-label pR10"}),_c("el-checkbox",{model:{value:_vm.heatMapOptions.reversePallete,callback:function($$v){_vm.$set(_vm.heatMapOptions,"reversePallete",$$v)},expression:"heatMapOptions.reversePallete"}})],1)])],1)],1):_vm._e(),"undefined"!==typeof _vm.heatMapOptions.showGrandParent?_c("div",[_c("el-row",[_c("el-col",{attrs:{span:18}},[_c("div",{staticClass:"flex-middle"},[_c("p",{staticClass:"label-txt-black pT20 line-height20 mB10"},[_vm._v("Header")])])]),_c("el-col",{attrs:{span:6}},[_c("div",{staticClass:"flex-middle pT20"},[_c("span",{staticClass:"customize-label pR10"},[_vm._v("Show")]),_c("el-checkbox",{model:{value:_vm.heatMapOptions.showGrandParent,callback:function($$v){_vm.$set(_vm.heatMapOptions,"showGrandParent",$$v)},expression:"heatMapOptions.showGrandParent"}})],1)])],1)],1):_vm._e(),"undefined"!==typeof _vm.heatMapOptions.treemapTextMode?_c("div",{staticClass:"customize-input-block"},[_c("el-row",[_c("div",{staticClass:"label-txt-black pT20 pB10 label-line-height"},[_vm._v(" Display Label ")]),_c("el-select",{staticClass:"fc-input-full-border2 width100",attrs:{placeholder:"Select"},model:{value:_vm.heatMapOptions.treemapTextMode,callback:function($$v){_vm.$set(_vm.heatMapOptions,"treemapTextMode",$$v)},expression:"heatMapOptions.treemapTextMode"}},[_c("el-option",{attrs:{label:"Size Metric",value:1}}),_c("el-option",{attrs:{label:"Color Metric",value:2}}),_c("el-option",{attrs:{label:"Dimension Only",value:3}})],1)],1)],1):_vm._e(),"undefined"!==typeof _vm.heatMapOptions.showColorScale?_c("div",[_c("el-row",[_c("el-col",{attrs:{span:18}},[_c("div",{staticClass:"flex-middle"},[_c("div",{staticClass:"label-txt-black pT20 line-height20 mB10"},[_vm._v(" Color Scale ")])])]),_c("el-col",{attrs:{span:6}},[_c("div",{staticClass:"flex-middle pT20"},[_c("span",{staticClass:"customize-label pR10"},[_vm._v("Show")]),_c("el-checkbox",{model:{value:_vm.heatMapOptions.showColorScale,callback:function($$v){_vm.$set(_vm.heatMapOptions,"showColorScale",$$v)},expression:"heatMapOptions.showColorScale"}})],1)])],1)],1):_vm._e(),"undefined"!==typeof _vm.heatMapOptions.showWidgetLegends?_c("div",[_c("el-row",[_c("el-col",{attrs:{span:18}},[_c("div",{staticClass:"flex-middle"},[_c("div",{staticClass:"label-txt-black pT20 line-height20 mB10"},[_vm._v(" Widget Legends ")])])]),_c("el-col",{attrs:{span:6}},[_c("div",{staticClass:"flex-middle pT20"},[_c("span",{staticClass:"customize-label pR10"},[_vm._v("Show")]),_c("el-checkbox",{model:{value:_vm.heatMapOptions.showWidgetLegends,callback:function($$v){_vm.$set(_vm.heatMapOptions,"showWidgetLegends",$$v)},expression:"heatMapOptions.showWidgetLegends"}})],1)])],1),_vm.heatMapOptions.showWidgetLegends?_c("el-collapse",{staticClass:"customize-widget-legends mT20",staticStyle:{padding:"20 15px"},attrs:{accordion:""},model:{value:_vm.activeWidgetLegendItem,callback:function($$v){_vm.activeWidgetLegendItem=$$v},expression:"activeWidgetLegendItem"}},_vm._l(_vm.allPoints.filter((function(dp){return"x"!==dp.axes})),(function(point,index){return _c("el-collapse-item",{key:index,staticClass:"fc-analytics-legend-collapse",attrs:{title:point.label,name:point.alias}},[_c("el-checkbox-group",{staticClass:"pT20",model:{value:_vm.report.options.widgetLegend.variances[point.alias],callback:function($$v){_vm.$set(_vm.report.options.widgetLegend.variances,point.alias,$$v)},expression:"report.options.widgetLegend.variances[point.alias]"}},[[4,8].includes(point.dataTypeId)?_vm._l(point.enumMap,(function(value,key){return _c("el-checkbox",{key:key,staticClass:"width35 pL20 pB20",attrs:{label:key}},[_vm._v(_vm._s(value))])})):_vm._l(["min","max","sum","avg","lastValue"],(function(legend,index){return _c("el-checkbox",{key:index,staticClass:"width35 pL20 pB20",attrs:{label:legend}},[_vm._v(_vm._s(_vm.$constants.VarianceLabels[legend]))])}))],2)],1)})),1):_vm._e()],1):_vm._e(),_c("el-dialog",{staticClass:"fc-dialog-center-container color-pallete-lock",attrs:{title:"Colour palettes",width:"35%",visible:_vm.showColorPalette,"append-to-body":!0,"lock-scroll":!0},on:{"update:visible":function($event){_vm.showColorPalette=$event}}},[_c("div",{staticClass:"heatmap-custom-con"},[_c("el-row",{attrs:{gutter:20}},_vm._l(_vm.heatMapOptions.Colors,(function(colors,index){return _c("el-col",{key:index,staticClass:"dialogcolorpalette mB10",attrs:{span:12}},[_vm.loading?_c("div",{staticClass:"color-palette-loading-con mB10"},[_c("div",{staticClass:"fc-animated-background width100px height20"}),_c("div",{staticClass:"width100 height20 mT10 fc-animated-background"})]):_c("div",[_c("div",{staticClass:"fc-input-label-txt f13 flex-middle position-relative"},[_vm._v(" "+_vm._s(index)+" "),_vm.heatMapOptions.chosenColors===index?_c("div",{staticClass:"selected-icon-color position-absolute"},[_c("InlineSvg",{staticClass:"vertical-middle",attrs:{src:"svgs/check-icon",iconClass:"icon icon-xs mL10"}})],1):_vm._e()]),_c("div",{staticClass:"colorPalette position-relative",on:{click:function($event){return _vm.changeColor(index)}}},_vm._l(colors,(function(color,idx){return _c("div",{key:idx,staticClass:"colorBlock",style:{background:color}})})),0)])])})),1)],1)])],1):_vm._e()])])])},staticRenderFns=[function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"flex-middle"},[_c("p",{staticClass:"label-txt-black pT20 line-height20 mB10"},[_vm._v("Color Palette")])])}],InlineSvg=(__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(976801),__webpack_require__(670560),__webpack_require__(586166)),FHeatMapCustomizationvue_type_script_lang_js={props:["heatMapOptions","report"],data:function(){return{showColorPalette:!1,loading:!0,updateTimeout:null,activeWidgetLegendItem:null}},mounted:function(){},components:{InlineSvg:InlineSvg/* default */.Z},methods:{openDialog:function(){var _this=this;this.showColorPalette=!0,this.loading=!0,this.updateTimeout&&clearTimeout(this.updateTimeout),this.updateTimeout=setTimeout((function(){_this.loading=!1}),500)},changeColor:function(index){this.heatMapOptions.chosenColors=index,this.showColorPalette=!1}},computed:{dataPointObject:{get:function(){return this.report?this.$helpers.getDataPoints(this.report.options.dataPoints,[1,2,4],!0):[]},set:function(newDataPointObject){this.report.options.dataPoints=newDataPointObject}},allPoints:function(){var points=[],FieldsIncluded=[];return this.dataPointObject&&this.dataPointObject.forEach((function(dp){"group"===dp.type?dp.children.forEach((function(children){FieldsIncluded.includes(children.fieldId)||(FieldsIncluded.push(children.fieldId),points.push(children))})):FieldsIncluded.includes(dp.fieldId)||(FieldsIncluded.push(dp.fieldId),points.push(dp))})),points}}},components_FHeatMapCustomizationvue_type_script_lang_js=FHeatMapCustomizationvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FHeatMapCustomizationvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FHeatMapCustomization=component.exports},
/***/398758:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return AnalayticsFilter}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/energy/analytics/components/AnalayticsFilter.vue?vue&type=template&id=c060834c
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"building-popover"},[_c("div",{staticClass:"side-bar-site-details flex-middle"},[_vm.isSiteAnalysis?_c("div",[_c("InlineSvg",{staticClass:"pointer",attrs:{src:"svgs/spacemanagement/site",iconClass:"icon-50"}})],1):_c("div",{staticClass:"building-icon-container",staticStyle:{margin:"-10px -10px"}},[_c("InlineSvg",{staticClass:"pointer",attrs:{src:"svgs/spacemanagement/building",iconClass:"icon-50 resize_building_icon"}})],1),_c("div",{staticClass:"pL10 width100"},[_c("div",{staticClass:"display-flex-between-space"},[_c("div",{staticClass:"fc-id"},[_vm._v(_vm._s("#")+_vm._s(_vm.selectedBuildingId))]),_c("div",{staticStyle:{"margin-top":"12px","margin-right":"15px"}},[_c("div",{staticClass:"popover-text",attrs:{slot:"reference"},on:{click:function($event){return _vm.showLookupWizard()}},slot:"reference"},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.change_site_message_label"))+" ")])])]),_c("div",{staticClass:"display-flex-between-space",staticStyle:{"margin-top":"-8px"}},[_c("div",{staticClass:"label-text pointer label_text",on:{click:function($event){return _vm.showLookupWizard()}}},[_vm._v(" "+_vm._s(_vm.selectedBuildingLabel)+" ")])])])]),_vm.showingLookupWizard?_c("div",[_c("LookupWizard",{attrs:{canShowLookupWizard:_vm.showingLookupWizard,field:_vm.isSiteAnalysis?_vm.siteFieldObj:_vm.buildingFieldObj},on:{"update:canShowLookupWizard":function($event){_vm.showingLookupWizard=$event},"update:can-show-lookup-wizard":function($event){_vm.showingLookupWizard=$event},setLookupFieldValue:function(value){return _vm.toggleBuilding(value.field.selectedItems[0].value,value.field.selectedItems[0].label)}}})],1):_vm._e()])},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),ui_forms=(__webpack_require__(162506),__webpack_require__(670560),__webpack_require__(141323)),picklist=__webpack_require__(961358),AnalayticsFiltervue_type_script_lang_js={props:["config","selectedBuildings","multiple","zones","isSiteAnalysis"],components:{LookupWizard:ui_forms/* LookupWizard */.ns},data:function(){return{selectedBuildingsInternal:[],showingLookupWizard:!1,selectedBuildingLabel:"",selectedBuildingId:null,buildingFieldObj:{isDataLoading:!1,options:[],lookupModuleName:"building",field:{lookupModule:{name:"building",displayName:"Building"}},selectedItems:[],forceFetchAlways:!0,filters:{},isDisabled:!1},siteFieldObj:{isDataLoading:!1,options:[],lookupModuleName:"site",field:{lookupModule:{name:"site",displayName:"Site"}},selectedItems:[],forceFetchAlways:!0,filters:{},isDisabled:!1}}},created:function(){
// this.$store.dispatch('loadSites')
// this.$store.dispatch('loadBuildings')
},computed:{},mounted:function(){this.selectedBuildingsInternal=this.selectedBuildings,this.getBuildingLabel(),this.selectedBuildingId=this.selectedBuildings&&this.selectedBuildings[0]?this.selectedBuildings[0]:this.isSiteAnalysis?"No Sites":"No Buildings"},watch:{selectedBuildingsInternal:function(newVal){this.$emit("update:selectedBuildings",this.selectedBuildingsInternal)}},methods:{showLookupWizard:function(){this.showingLookupWizard=!0},getBuildingLabel:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(_this.selectedBuildingsInternal=_this.selectedBuildings,!_this.selectedBuildingsInternal[0]||_this.isSiteAnalysis){_context.next=6;break}return _context.next=4,(0,picklist/* getFieldValue */.oe)({lookupModuleName:"building",selectedOptionId:[_this.selectedBuildingsInternal[0]]}).then((function(_ref){var error=_ref.error,data=_ref.data;if(!error&&data){var value=data[0].label;_this.selectedBuildingLabel=value,_this.buildingFieldObj.selectedItems[0]={value:_this.selectedBuildingsInternal[0],label:_this.selectedBuildingLabel}}}));case 4:_context.next=12;break;case 6:if(!_this.selectedBuildingsInternal[0]||!_this.isSiteAnalysis){_context.next=11;break}return _context.next=9,(0,picklist/* getFieldValue */.oe)({lookupModuleName:"site",selectedOptionId:[_this.selectedBuildingsInternal[0]]}).then((function(_ref2){var error=_ref2.error,data=_ref2.data;if(!error&&data){var value=_this.$getProperty(data,"0.label");_this.selectedBuildingLabel=value,_this.siteFieldObj.selectedItems[0]={value:_this.selectedBuildingsInternal[0],label:_this.selectedBuildingLabel}}}));case 9:_context.next=12;break;case 11:_this.selectedBuildingLabel=_this.isSiteAnalysis?"No Sites":"No Buildings";case 12:case"end":return _context.stop()}}),_callee)})))()},toggleBuilding:function(buildingId,buildingName){if(this.multiple){var idx=this.selectedBuildingsInternal.indexOf(buildingId);-1!==idx?this.selectedBuildingsInternal.length>1&&this.selectedBuildingsInternal.splice(idx,1):this.selectedBuildingsInternal.push(buildingId)}else this.selectedBuildingsInternal=[buildingId],buildingId&&buildingName&&(this.selectedBuildingId=buildingId,this.selectedBuildingLabel=buildingName)},updateSelectedBuilding:function(buildings){this.selectedBuildingsInternal=buildings}}},components_AnalayticsFiltervue_type_script_lang_js=AnalayticsFiltervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_AnalayticsFiltervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,AnalayticsFilter=component.exports},
/***/486348:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FDerivation}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/energy/analytics/components/FDerivation.vue?vue&type=template&id=75dbeec2
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("div",[_vm.visibility?_c("f-dialog",{staticClass:"derivation newderivation",attrs:{visible:_vm.visibility,width:_vm.modelWidth,maxHeight:"500px"},on:{save:_vm.save,close:_vm.close}},[_c("div",{staticClass:"left-container",class:{active:_vm.showRightView},attrs:{slot:"content"},slot:"content"},[_c("el-col",{staticClass:"left-conatiner-content",attrs:{span:24}},[_c("div",[_c("div",{staticClass:"new-header-container"},[_c("div",{staticClass:"fc-setup-modal-title fL"},[_vm._v(" "+_vm._s(_vm.isEdit?"Edit Derivation":"Add Derivation")+" ")]),_c("div",{staticClass:"summation fR"},[_c("el-button",{staticClass:"formula-btn",attrs:{type:"button"},on:{click:function($event){return _vm.showFunctions()}}},[_c("img",{staticStyle:{width:"10px",height:"10px",opacity:"0.9"},attrs:{src:__webpack_require__(667527)}})])],1)]),_c("div",{staticClass:"fc-input-label-txt mB10 clearboth"},[_vm._v(" Derivation Name ")]),_c("el-input",{staticClass:"el-input-textbox-full-border",attrs:{placeholder:_vm.$t("common._common.enter_name")},model:{value:_vm.newDerivation.name,callback:function($$v){_vm.$set(_vm.newDerivation,"name",$$v)},expression:"newDerivation.name"}}),_c("el-row",{staticClass:"mT20"},[_c("el-col",{attrs:{span:18}},[_c("div",{staticClass:"fc-input-label-txt mB10"},[_vm._v("Expression")]),_c("el-input",{staticClass:"el-input-textbox-full-border",attrs:{placeholder:"Enter Expression"},model:{value:_vm.newDerivation.expResult,callback:function($$v){_vm.$set(_vm.newDerivation,"expResult",$$v)},expression:"newDerivation.expResult"}})],1),_c("el-col",{staticClass:"mL20",attrs:{span:5}},[_c("div",{staticClass:"fc-input-label-txt mB10"},[_vm._v("Unit")]),_c("el-input",{staticClass:"el-input-textbox-full-border",attrs:{placeholder:"Enter Unit"},model:{value:_vm.newDerivation.unitStr,callback:function($$v){_vm.$set(_vm.newDerivation,"unitStr",$$v)},expression:"newDerivation.unitStr"}})],1)],1),_c("div",{staticClass:"fbVariableLegendContainer mT20 formulalengendscontainer"},[_c("table",{attrs:{border:"0",cellspacing:"0",cellpadding:"0"}},_vm._l(_vm.dataPoints,(function(point,index){return _vm.isEdit&&_vm.higherDerivationAliases.includes(point.alias)?_vm._e():_c("tr",{key:index,staticClass:"fbVariableLegend"},[_c("td",{staticClass:"fbVariableLegend"},[_vm._v(_vm._s(point.alias))]),_c("td",{staticClass:"fbVariableLegendInfo"},[_c("span",[_vm._v(_vm._s(point.label))])])])})),0)])],1)])],1),_vm.showRightView?_c("div",{staticClass:"right-container",attrs:{slot:"content"},slot:"content"},[_c("div",{staticClass:"build-functions-scroll"},[_c("div",{staticClass:"fc-setup-modal-title mB20"},[_vm._v("BUILT IN FUNCTIONS")]),_vm._l(_vm.builtInFunctions,(function(fields){return _c("div",{key:fields.value,staticClass:"list-data"},[_c("div",{staticClass:"fields"},[_c("img",{staticClass:"selected-icon",staticStyle:{width:"15px",height:"15px",position:"relative",top:"17px",left:"4px"},attrs:{src:__webpack_require__(552184)},on:{click:function($event){return _vm.addFunction(fields.value)}}}),_c("div",{staticClass:"field-info"},[_vm._v(_vm._s(fields.label))]),_c("div",{staticClass:"bottom"},[_c("el-tooltip",{staticClass:"help-tooltip",attrs:{effect:"dark",placement:"bottom","popper-class":"element-tooltip"}},[_c("div",{attrs:{slot:"content"},slot:"content"},[_vm._v(_vm._s(fields.description))]),_c("img",{staticClass:"derivation-info-icon",attrs:{src:__webpack_require__(196510)}})])],1)])])}))],2)]):_vm._e()]):_vm._e()],1),_c("div")])},staticRenderFns=[],toConsumableArray=__webpack_require__(488478),createForOfIteratorHelper=__webpack_require__(566347),FDialogNew=(__webpack_require__(260228),__webpack_require__(564043),__webpack_require__(322462),__webpack_require__(670560),__webpack_require__(425728),__webpack_require__(450886),__webpack_require__(538077),__webpack_require__(947522),__webpack_require__(865137),__webpack_require__(434284),__webpack_require__(339772),__webpack_require__(919649),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(162506),__webpack_require__(634338),__webpack_require__(857267),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(436756)),expRegex=/(NOT|IF|MIN|MAX|ROUND|ABS|FLOOR|CEILING|LOG|LOG10|SQRT|FACT|PI|TRUE|FALSE|true|false|NULL|null)|([A-Za-z][0-9]*\.(sum|avg|lastValue|min|max))|([A-Za-z][0-9]*)|([^A-Za-z][0-9]*)+/g,alphaRegex=/[a-z]+|\d+/gi,FDerivationvue_type_script_lang_js={props:["report","config","visibility","selectedPoint"],components:{FDialog:FDialogNew/* default */.Z},data:function(){return{modelWidth:"38%",showRightView:!1,newDerivation:{name:"",expResult:"",unitStr:"",analyticsType:this.report.analyticsType},expressionIndex:0,builtInFunctions:[{value:"NOT()",label:"NOT(expression)",description:"Boolean negation, 1 (means true) if the expression is not zero"},{value:"IF()",label:"IF(condition,value_if_true,value_if_false)",description:"Returns one value if the condition evaluates to true or the other if it evaluates to false"},{value:"MIN()",label:"MIN(e1,e2, ...)",description:"Returns the smallest of the given expressions"},{value:"MAX()",label:"MAX(e1,e2, ...)",description:"Returns the biggest of the given expressions"},{value:"ROUND()",label:"ROUND(expression,precision)",description:"Rounds a value to a certain number of digits, uses the current rounding mode"},{value:"ABS()",label:"ABS(expression) ",description:"Returns the absolute (non-negative) value of the expression"},{value:"FLOOR()",label:"FLOOR(expression)",description:"Rounds the value down to the nearest integer"},{value:"CEILING()",label:"CEILING(expression)",description:"Rounds the value up to the nearest integer"},{value:"LOG()",label:"LOG(expression)",description:"Returns the natural logarithm (base e) of an expression"},{value:"LOG10()",label:"LOG10(expression)",description:"Returns the common logarithm (base 10) of an expression"},{value:"SQRT()",label:"SQRT(expression)",description:"Returns the square root of an expression"},{value:"FACT()",label:"FACT(expression)",description:"Retuns the factorial value of an integer. Will return 1 for 0 or a negative number"}]}},computed:{currentAlias:function(){var currentAlias,dpAlias={lastAlias:0,lastNum:0};if(this.isEdit)currentAlias=this.selectedPoint.alias;else{var _step,aliases=[],dataPoints=this.$helpers.getDataPoints(this.report.options.dataPoints,[1,2,4],!0),_iterator=(0,createForOfIteratorHelper/* default */.Z)(dataPoints);try{for(_iterator.s();!(_step=_iterator.n()).done;){var dataPoint=_step.value;if("datapoint"===dataPoint.type)aliases.push(dataPoint);else{var _step2,_iterator2=(0,createForOfIteratorHelper/* default */.Z)(dataPoint.children);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var child=_step2.value;aliases.push(child)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}}}catch(err){_iterator.e(err)}finally{_iterator.f()}aliases.forEach((function(dp){if(dp.alias.length>1){var num=dp.alias.match(alphaRegex)[1];dpAlias.lastNum=num>dpAlias.lastNum?num:dpAlias.lastNum}else dpAlias.lastAlias=dp.alias.charCodeAt(0)>dpAlias.lastAlias?dp.alias.charCodeAt(0):dpAlias.lastAlias})),currentAlias=this.$helpers.getNextAlias(dpAlias)}return currentAlias},configSelectedPoint:function(){var _this=this;return this.isEdit?this.$helpers.getDataPoints(this.config.dataPoints,[1,2,4],!0).find((function(dp){return dp.aliases.actual===_this.selectedPoint.key})):null},isEdit:function(){return void 0!==this.selectedPoint},higherDerivationAliases:function(){var _this2=this,aliases=[];return this.isEdit&&(aliases=this.$helpers.getDataPoints(this.report.options.dataPoints,[1,2,4],!0).filter((function(dp){return 2===dp.pointType&&_this2.isHigherAlias(dp.alias)})).map((function(dp){return dp.alias}))),aliases},dataPoints:function(){var dataPoints=[];return this.$helpers.getDataPoints(this.report.options.dataPoints,[1,2,4],!0).forEach((function(dp){"group"===dp.type||"rangeGroup"===dp.type?dataPoints.push.apply(dataPoints,(0,toConsumableArray/* default */.Z)(dp.children)):dataPoints.push(dp)})),dataPoints.sort()}},mounted:function(){var _this3=this;if(this.isEdit){this.newDerivation.name=this.configSelectedPoint.name,this.newDerivation.unitStr=this.configSelectedPoint.yAxis.unitStr;var alias=this.currentAlias;this.newDerivation.expResult=this.report.options.derivations[alias].result,this.expressionIndex=this.config.transformWorkflow.expressions[0].expressions.findIndex((function(exp){return"put"===exp.name&&exp.defaultFunctionContext&&exp.defaultFunctionContext.params===_this3.getResultFuncParam(alias)}))-1}else this.expressionIndex=this.config.transformWorkflow?this.config.transformWorkflow.expressions[0].expressions.length:0},methods:{close:function(){this.$emit("update:visibility",!1)},showFunctions:function(){this.showRightView=!this.showRightView,this.showRightView?this.modelWidth="60%":this.modelWidth="38%"},addFunction:function(fieldsList){this.newDerivation.expResult+=" "+fieldsList},save:function(){var _this4=this,aliasesUsed=(0,toConsumableArray/* default */.Z)(new Set(this.newDerivation.expResult.match(/[A-Z]+/g)));if(this.validate(aliasesUsed)){var alias=this.currentAlias;this.config.transformWorkflow||(this.config.transformWorkflow={parameters:[{name:"data",typeString:"list"},{name:"aggr",typeString:"map"}],expressions:[{workflowExpressionType:2,iteratableVariable:"data",loopVariableIndexName:"index",loopVariableValueName:"value",expressions:[]}]}),this.setWorkflowExpression(alias,this.config.transformWorkflow.expressions[0].expressions),this.setDerivationDetails(alias,aliasesUsed);var point={name:this.newDerivation.name,type:2,aliases:{actual:alias},xAxis:{label:"Timestamp"},yAxis:{dataType:3,label:this.newDerivation.name,unitStr:this.newDerivation.unitStr}};if(this.isEdit){var _this$report;if(null!==this&&void 0!==this&&null!==(_this$report=this.report)&&void 0!==_this$report&&null!==(_this$report=_this$report.options)&&void 0!==_this$report&&null!==(_this$report=_this$report.dataPoints)&&void 0!==_this$report&&_this$report.length){var option_idx=this.report.options.dataPoints.findIndex((function(dp){return dp.name===_this4.configSelectedPoint.name}));this.$set(this.report.options.dataPoints[option_idx],"label",this.newDerivation.name),this.$set(this.report.options.dataPoints[option_idx],"name",this.newDerivation.name)}var idx=this.config.dataPoints.findIndex((function(dp){return dp.name===_this4.configSelectedPoint.name}));this.$set(this.config.dataPoints,idx,point)}else this.config.dataPoints.push(point);this.close()}},setWorkflowExpression:function(alias,itrExp){var _this5=this,match=expRegex.exec(this.newDerivation.expResult),result="",expressions=[],_loop=function(){if(match[2]){var name="aggr".concat(match[2].replace(".",""));[].concat((0,toConsumableArray/* default */.Z)(itrExp),expressions).some((function(exp){return exp.name===name}))||(expressions.push({name:name,defaultFunctionContext:{nameSpace:"map",functionName:"get",params:"aggr, '"+match[2]+"'"}}),match[0]=name)}else if(match[4]&&(result+="param",![].concat((0,toConsumableArray/* default */.Z)(itrExp),expressions).some((function(exp){return exp.name==="param".concat(match[4])})))){var dp=_this5.dataPoints.find((function(dp){return dp.alias===match[4]})),value="value, '"+match[4];4!==dp.dataTypeId&&8!==dp.dataTypeId||(value+=".value"),value+="'",expressions.push({name:"param".concat(match[4]),defaultFunctionContext:{nameSpace:"map",functionName:"get",params:value}})}result+=match[0],match=expRegex.exec(_this5.newDerivation.expResult)};while(null!=match)_loop();expressions.push({name:"result",expr:result},{name:"put",
// Please change the expressionIndex finding also if name is changed
defaultFunctionContext:{nameSpace:"map",functionName:"put",params:this.getResultFuncParam(alias)}}),itrExp.splice.apply(itrExp,[this.expressionIndex,this.isEdit?2:0].concat(expressions))},getResultFuncParam:function(alias){return"value, '"+alias+"', result"},setDerivationDetails:function(alias,aliasesUsed){this.report.options.derivations||(this.report.options.derivations={}),this.report.options.derivations[alias]={result:this.newDerivation.expResult,
// usedIn: [],
usedAliases:aliasesUsed}},validate:function(aliasesUsed){var errorMessage,_this6=this,variables=aliasesUsed;if(this.newDerivation.name)if(this.newDerivation.expResult)if(variables.some((function(v){return _this6.higherDerivationAliases.includes(v)})))errorMessage="Some derivations cannot be used";else{var brackets=this.newDerivation.expResult.match(/[\\(\\)]/g);if(brackets){var openBrackets=brackets.filter((function(b){return"("===b})),closedBrackets=brackets.filter((function(b){return")"===b}));openBrackets.length!==closedBrackets.length&&(errorMessage="Please enter valid expression")}}else errorMessage="Please enter expression";else errorMessage="Please enter name";return!errorMessage||(this.$message.error(errorMessage),!1)},isHigherAlias:function(alias){return 1==alias.length&&1==this.currentAlias.length?alias.charCodeAt(0)>=this.currentAlias.charCodeAt(0):1!=alias.length&&(1==this.currentAlias.length||alias.match(alphaRegex)[1]>=this.currentAlias.match(alphaRegex)[1])}}},components_FDerivationvue_type_script_lang_js=FDerivationvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FDerivationvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FDerivation=component.exports},
/***/991797:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return Heatmap}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/energy/analytics/newTools/Heatmap.vue?vue&type=template&id=e9ffe0e2
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{key:_vm.$route.path,staticClass:"fc-energy-building-analysis"},[_c("div",{staticClass:"report-main-con"},[_c("div",{},[_c("f-report-options",{staticClass:"analytics-page-options-building-analysis fc-v1-portfolio-anlaysis",attrs:{isActionsDisabled:_vm.isActionsDisabled,optionClass:"analytics-page-options",optionsToEnable:[5,1,2],reportObject:_vm.reportObject,resultObject:_vm.resultObject,params:_vm.reportObject?_vm.reportObject.params:null,savedReport:_vm.analyticsConfig.savedReport,pdf:!1},on:{"update:savedReport":function($event){return _vm.$set(_vm.analyticsConfig,"savedReport",$event)},"update:saved-report":function($event){return _vm.$set(_vm.analyticsConfig,"savedReport",$event)}}})],1),_c("div",{staticClass:"report-sidebar-con"},[_vm.hideSideBar?_vm._e():_c("div",{class:{"new-report-sidebar fc-new-report-sidebar col-3 pT0":!_vm.hideSideBar}},[_c("div",{directives:[{name:"show",rawName:"v-show",value:_vm.showgeneratedata,expression:"showgeneratedata"}],staticClass:"report-sidebar-inner"},[_c("div",{staticClass:"analytics-body p20 clearboth"},[_c("div",{staticClass:"fc-text-pink"},[_vm._v(" "+_vm._s(_vm.$t("home.dashboard.generate_chart"))+" ")]),_c("el-row",{staticClass:"pT20"},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"label-txt-black pB10"},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.reading"))+" ")]),_vm.analyticsConfig.dataPoints.length?_vm._l(_vm.analyticsConfig.dataPoints,(function(data,index){return[_c("el-row",{key:index,staticClass:"visibility-visible-actions"},[_c("el-col",[_c("div",{staticClass:"fc-input-div-full-border-f14",on:{click:function($event){_vm.showDataPointSelector=!0}}},[_c("span",[_vm._v(" "+_vm._s(data.name)+" ")]),_c("i",{staticClass:" pointer mT12 el-icon-arrow-right pull-right "})])])],1)]})):_c("div",{staticClass:"fc-input-div-full-border-f14 position-relative",on:{click:function($event){_vm.showDataPointSelector=!0}}},[_c("span",[_vm._v(" "+_vm._s(_vm.$t("common._common.select"))+" ")]),_c("i",{staticClass:" pointer mT12 el-icon-arrow-right pull-right heatmap-right-icon"})])],2)],1),_vm.analyticsConfig.dataPoints.length?_c("el-row",[_c("el-col",{staticClass:"mT20",attrs:{span:24}},[_c("div",{staticClass:"label-txt-black pB5"},[_vm._v(" "+_vm._s(_vm.$t("common._common.aggregation"))+" ")]),_c("el-select",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"period-select width100 fc-input-full-border2 ",attrs:{placeholder:_vm.$t("common._common.aggregation"),title:_vm.$t("common.header.datapoint_aggregation"),"data-arrow":"true"},model:{value:_vm.analyticsConfig.dataPoints[0].yAxis.aggr,callback:function($$v){_vm.$set(_vm.analyticsConfig.dataPoints[0].yAxis,"aggr",$$v)},expression:"analyticsConfig.dataPoints[0].yAxis.aggr"}},_vm._l(_vm.aggregations,(function(aggr,index){return _c("el-option",{key:index,attrs:{label:aggr.label,value:aggr.value}})})),1)],1)],1):_vm._e(),2!==_vm.analyticsConfig.mode?_c("el-row",[_c("el-col",{staticClass:"mT20",attrs:{span:24}},[_c("div",{staticClass:"label-txt-black pB5"},[_vm._v(" "+_vm._s(_vm.$t("common.dashboard.time_period"))+" ")]),_c("el-select",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"period-select width100 fc-input-full-border2 ",attrs:{placeholder:_vm.$t("common.wo_report.period"),title:_vm.$t("common.dashboard.time_period"),"data-arrow":"true"},on:{change:_vm.onPeriodChange},model:{value:_vm.analyticsConfig.format,callback:function($$v){_vm.$set(_vm.analyticsConfig,"format",$$v)},expression:"analyticsConfig.format"}},_vm._l(_vm.availablePeriods,(function(period,index){return _c("el-option",{key:index,attrs:{label:period.name,value:period.format,disabled:!period.enable}})})),1)],1)],1):_vm._e(),_c("div",{staticClass:"border-top5"},[_c("div",{staticClass:"pR5"},[_c("el-row",{directives:[{name:"show",rawName:"v-show",value:_vm.isFilterActive,expression:"isFilterActive"}],staticClass:"clearboth pT20"},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"fL"},[_c("div",{staticClass:"label-txt-black f14 pB5"},[_vm._v(" "+_vm._s(_vm.$t("common.products.user_filters"))+" ")])])])],1),_c("div",[_c("el-row",{directives:[{name:"show",rawName:"v-show",value:_vm.isFilterActive,expression:"isFilterActive"}],staticClass:"mT10"},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"flex-middle justify-content-space"},[_c("div",{staticClass:"flex-middle"},[_c("el-checkbox",{staticClass:"mR10",attrs:{disabled:!_vm.isFilterActive},model:{value:_vm.filterToggle,callback:function($$v){_vm.filterToggle=$$v},expression:"filterToggle"}}),_c("div",{staticClass:"label-txt-black fw4 pR5"},[_vm._v(" "+_vm._s(_vm.filterTitle)+" ")])],1),_c("div",{staticClass:"pointer"},[_c("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"top",arrow:!0,animation:"shift-away"},expression:"{\n                              placement: 'top',\n                              arrow: true,\n                              animation: 'shift-away',\n                            }"}],staticClass:"fc-dark-blue4-12 pointer",attrs:{title:_vm.$t("common._common.edit")},on:{click:function($event){return _vm.openFilter()}}},[_vm._v(" "+_vm._s(null===_vm.analyticsConfig.template||"undefined"===typeof _vm.analyticsConfig.template?"Add":"Edit")+" ")])])])])],1)],1)],1)])],1)])]),_vm.hideSideBar?_vm._e():_c("div",{class:{"new-chart-custom fc-new-portfolio-chart-custom":!_vm.hideSideBar}},[_vm.reportObject?_c("div",{directives:[{name:"show",rawName:"v-show",value:_vm.showCustomization,expression:"showCustomization"}],staticClass:"customize-container building-customize-container col-3 fc-new-portfolio-cus fc-heatmap-cus",staticStyle:{top:"0px"}},[_c("div",{staticClass:"customize-header pB10"},[_c("div",{staticClass:"fc-text-pink"},[_vm._v(" "+_vm._s(_vm.$t("home.reports.chart_customization"))+" ")])]),_c("div",{staticClass:"customize-body fc-customize-body pT0"},[_vm.reportObject?_c("FHeatMapCustomization",{directives:[{name:"show",rawName:"v-show",value:_vm.showCustomization,expression:"showCustomization"}],attrs:{report:_vm.reportObject,heatMapOptions:_vm.heatMapOptions},on:{close:function($event){_vm.showCustomization=!1,_vm.showgeneratedata=!0}}}):_vm._e()],1)]):_vm._e()]),_c("f-heat-map-point-selector",{ref:"building-selector",attrs:{visibility:_vm.showDataPointSelector,enableFloatimngIcon:_vm.enableFloatimngIcon},on:{"update:visibility":function($event){_vm.showDataPointSelector=$event},"update:enableFloatimngIcon":function($event){_vm.enableFloatimngIcon=$event},"update:enable-floatimng-icon":function($event){_vm.enableFloatimngIcon=$event},updateDataPoints:_vm.updateDataPoints}}),_vm.hideSideBar?_vm._e():_c("div",{staticClass:"analytics-options-block"},[_c("div",{},[_c("div",{staticClass:"text-center analytics-report-icon-bg line-height50 height50",class:{"analytics-report-icon-bg-active":_vm.showgeneratedata},on:{click:function($event){return _vm.showgeneratedataDialog()}}},[_c("InlineSvg",{attrs:{src:"statistics",iconClass:"icon icon-sm-md  vertical-middle"}})],1),_c("div",{staticClass:"text-center analytics-report-icon-bg line-height50 height50",class:{"analytics-report-icon-bg-active":_vm.showCustomization},attrs:{disabled:!_vm.reportObject},on:{click:function($event){_vm.reportObject&&_vm.showCustomizationDialog()}}},[_c("InlineSvg",{attrs:{src:"settings-grey",iconClass:"icon icon-sm-md vertical-middle"}})],1),_c("div",{staticClass:"text-center analytics-report-icon-bg line-height50 height50",on:{click:function($event){return _vm.toggleSideBar()}}},[_c("InlineSvg",{attrs:{src:"arrow-pointing-to-left2",iconClass:"icon icon-sm-md vertical-middle"}})],1)])]),_vm.hideSideBar?_c("div",{staticClass:"analytics-options-block",style:{left:_vm.cssLeft}},[_c("div",{},[_c("div",{staticClass:"text-center analytics-report-icon-bg line-height50 height50",class:{"analytics-report-icon-bg-active":_vm.showgeneratedata},on:{click:function($event){return _vm.showgeneratedataDialog()}}},[_c("InlineSvg",{attrs:{src:"statistics",iconClass:"icon icon-sm-md  vertical-middle"}})],1),_c("div",{staticClass:"text-center analytics-report-icon-bg line-height50 height50",class:{"analytics-report-icon-bg-active":_vm.showCustomization},attrs:{disabled:!_vm.reportObject},on:{click:function($event){_vm.reportObject&&_vm.showCustomizationDialog()}}},[_c("InlineSvg",{attrs:{src:"settings-grey",iconClass:"icon icon-sm-md vertical-middle"}})],1),_c("div",{staticClass:"text-center analytics-report-icon-bg line-height50 height50",on:{click:function($event){return _vm.toggleSideBar()}}},[_c("InlineSvg",{staticStyle:{transform:"rotate(180deg)"},attrs:{src:"arrow-pointing-to-left2",iconClass:"icon icon-sm-md vertical-middle"}})],1)])]):_vm._e(),_c("div",{staticClass:"report-graph-con position-relative",class:{"new-report-graph-con-heatmap":!_vm.hideSideBar,"new-report-graph-con-stretch":_vm.hideSideBar},staticStyle:{height:"calc(100vh - 100px)","overflow-y":"scroll","padding-bottom":"100px"}},[_c("div",{ref:"chartSection",class:["self-center fchart-section building-graph-container heatmap-graph-container",{"prediction-timings-container":_vm.analyticsConfig.predictionTimings&&_vm.analyticsConfig.predictionTimings.length>1}]},[_vm.analyticsConfig.dataPoints.length?_c("div",[!1===_vm.isOptimize?_c("f-new-analytic-report-optimize",{ref:"newAnalyticReport",staticClass:"text-center",attrs:{config:_vm.analyticsConfig,baseLines:_vm.baseLineList,showTimePeriod:1===_vm.analyticsConfig.mode,showChartMode:!0,heatMapOptions:_vm.heatMapOptions,chartDimensions:_vm.chartDimensions},on:{"update:config":function($event){_vm.analyticsConfig=$event},reportLoaded:_vm.reportLoaded}}):_vm._e(),!0===_vm.isOptimize?_c("f-new-analytic-report",{ref:"newAnalyticReport",attrs:{config:_vm.analyticsConfig,baseLines:_vm.baseLineList,showTimePeriod:1===_vm.analyticsConfig.mode,showChartMode:!0},on:{"update:config":function($event){_vm.analyticsConfig=$event},reportLoaded:_vm.reportLoaded}}):_vm._e()],1):_c("div",{staticClass:"text-center"},[_vm.reportId||_vm.alarmId||_vm.cardId?_c("div",{staticClass:"p15"},[_c("spinner",{attrs:{show:!0}})],1):_c("div",{staticClass:"p15 flex-middle height80vh justify-content-center flex-direction-column"},[_c("div",[_c("inline-svg",{attrs:{src:"svgs/emptystate/reportlist",iconClass:"icon text-center icon-xxxlg"}})],1),_c("div",{staticClass:"nowo-label"},[_vm._v(" "+_vm._s(_vm.$t("common._common.please_select_data_points_analyze"))+" ")])])])])])],1)]),_vm.showDerivation?_c("derivation",{attrs:{visibility:_vm.showDerivation,report:_vm.reportObject,config:_vm.analyticsConfig},on:{"update:visibility":function($event){_vm.showDerivation=$event}}}):_vm._e(),_c("el-dialog",{staticClass:"fc-dialog-center-container",attrs:{visible:_vm.showFilter,width:"50%",title:_vm.$t("common.wo_report.configure_asset_filter"),"lock-scroll":!1},on:{"update:visible":function($event){_vm.showFilter=$event}}},[_c("div",{staticClass:"height400"},[_vm.showFilter?_c("new-criteria-builder",{staticClass:"report-criteria-buuilder",attrs:{exrule:_vm.analyticsConfig.template?_vm.analyticsConfig.template.criteria:null,showSiteField:!0,module:"asset",title:_vm.$t("setup.users_management.specify_rules_for_assigment_rules")},on:{condition:_vm.setTemplateFilterCriteria}}):_vm._e()],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){_vm.showFilter=!1}}},[_vm._v(_vm._s(_vm.$t("common._common.close")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:_vm.addFilterCriteria}},[_vm._v(_vm._s(_vm.$t("home.reports.add_criteria")))])],1)])],1)},staticRenderFns=[],toConsumableArray=__webpack_require__(488478),createForOfIteratorHelper=__webpack_require__(566347),AnalyticsMixin=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(538077),__webpack_require__(169358),__webpack_require__(670560),__webpack_require__(434284),__webpack_require__(648324),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(947522),__webpack_require__(339772),__webpack_require__(634338),__webpack_require__(244936)),FNewAnalyticsReportV1=__webpack_require__(937376),FNAROptimize=__webpack_require__(520245),FHeatMapPointSelector=__webpack_require__(315065),FDerivation=__webpack_require__(486348),FHeatMapCustomization=__webpack_require__(359911),FReportOptions=__webpack_require__(791514),NewDateHelper=__webpack_require__(105534),InlineSvg=__webpack_require__(586166),NewReportSummaryHelper=__webpack_require__(601458),NewCriteriaBuilder=__webpack_require__(859850),Heatmapvue_type_script_lang_js={props:["mobileConfig"],mixins:[AnalyticsMixin/* default */.Z,NewReportSummaryHelper/* default */.Z],components:{Derivation:FDerivation/* default */.Z,FNewAnalyticReport:FNewAnalyticsReportV1/* default */.Z,FNewAnalyticReportOptimize:FNAROptimize/* default */.Z,FHeatMapCustomization:FHeatMapCustomization/* default */.Z,FHeatMapPointSelector:FHeatMapPointSelector/* default */.Z,FReportOptions:FReportOptions/* default */.Z,InlineSvg:InlineSvg/* default */.Z,NewCriteriaBuilder:NewCriteriaBuilder/* default */.Z},data:function(){return{hideSideBar:!1,showFilter:!1,enableFloatimngIcon:!0,showDataPointSelector:!1,showgeneratedata:!0,showCustomization:!1,showDerivation:!1,selectedBaseLineId:"",baseLineList:null,baseLineCasecaderOptions:[],oldBaseLine:null,analyticsConfig:{name:"Heat Map Analysis",key:"HEAT_MAP_ANALYSIS",analyticsType:3,hidechartoptions:!0,hidecharttypechanger:!0,type:"reading",format:"hours",period:20,mode:1,baseLine:null,dateFilter:NewDateHelper/* default */.Z.getDatePickerObject(49,30),chartViewOption:0,dataPoints:[],predictionTimings:[],transformWorkflow:null},chartDimensions:{width:980,height:800},aggregations:[{label:this.$t("common._common.sum"),value:3,name:this.$t("common._common.sum")},{label:this.$t("common.header.avg"),value:2,name:this.$t("common.header.avg")},{label:this.$t("common._common.min"),value:4,name:this.$t("common._common.min")},{label:this.$t("common._common.max"),value:5,name:this.$t("common._common.max")}],heatMapOptions:{Colors:{Default:["#1d7f01","#6cb302","#e9f501","#fda504","#fb5905"],"Palette 1":["#93d5ed","#45a5f5","#4285f4","#2f5ec4","#073a93"],"Palette 2":["#04b9bd","#007e80","#004852","#f63700","#fb6900"],"Palette 3":["#ffaf00","#ff7300","#ff0057","#500083","#0b0411"],"Palette 4":["#b0f400","#74c700","#00696d","#002e5b","#2e004d"],"Palette 5":["#00fff1","#00c0d0","#4c60a6","#4d177c","#4a0052"],"Palette 6":["#00effc","#00b9e7","#357ac9","#793fad","#980084"],"Palette 7":["#c5ff00","#fef800","#00daff","#0050ff","#1700ff"],"Palette 8":["#39678a","#27916e","#becd70","#d7e1b2","#9db4a4"],"Palette 9":["#eeebff","#c0b8dd","#9184ba","#635198","#341e75"],"Palette 10":["#e1f6de","#a9d0b2","#71a986","#38835a","#005c2e"],"Palette 11":["#ffed95","#f0b277","#e0775a","#d13b3c","#c1001e"],"Palette 12":["#eaf9a8","#b1c5a0","#779299","#3d5e91","#042a89"],"Palette 13":["#ffc300","#eead09","#de9812","#cd821b","#bc6c24"],"Palette 14":["#58edf9","#4bd4f5","#3fbcf1","#32a3ec","#258be8"],"Palette 15":["#E81A50","#C44086","#AE6CD8","#5E7AD3","#2B97F9"]},chosenColors:"Default",minValue:null,maxValue:null},reportObject:null,resultObject:null,selectedBuildings:[],selectedBuildingTitle:"",zones:null,dataPointSummaryList:null,filterTitle:"Assets",filterToggle:!1,templateCriteria:null,assetCategoryName:"",isFilterActive:!1}},watch:{availablePeriods:{handler:function(){var _this=this,avail=this.availablePeriods,selected=avail.find((function(a){return a.value===_this.analyticsConfig.period&&a.enable}));if(!selected){var filterName=this.analyticsConfig.dateFilter.operationOn,defaultPeriod=avail.filter((function(a){return a.enable}))[0].value;("week"===filterName||"month"===filterName||"year"===filterName)&&(defaultPeriod=20),this.analyticsConfig.period=defaultPeriod}},immediate:!0},filterToggle:{handler:function(newData){this.toggleFilter(newData)}},"analyticsConfig.period":{handler:function(newData,oldData){if(20===newData){this.$set(this.analyticsConfig,"dateFilter",NewDateHelper/* default */.Z.getDatePickerObject(49,30)),this.$refs["newAnalyticReport"]&&this.$refs["newAnalyticReport"].forceRerender()}else if(12===newData){this.$set(this.analyticsConfig,"dateFilter",NewDateHelper/* default */.Z.getDatePickerObject(44)),this.$refs["newAnalyticReport"]&&this.$refs["newAnalyticReport"].forceRerender()}},immediate:!0}},mounted:function(){if(this.isSiteAnalysis&&(this.analyticsConfig.analyticsType=6),this.$route.query.filters){var filters=this.$route.query.filters,filtersJSON=JSON.parse(filters);this.analyticsConfig=filtersJSON}(this.reportId||this.alarmId||this.cardId)&&(this.$mobile?this.loadReport(this.mobileConfig):this.loadReport());var self=this;self.$http.get("/baseline/all").then((function(response){if(200===response.status){self.baseLineList=response.data?response.data:[],self.baseLineCasecaderOptions=[],self.baseLineCasecaderOptions.push({label:"None",value:-1});var _step,_iterator=(0,createForOfIteratorHelper/* default */.Z)(self.baseLineList);try{for(_iterator.s();!(_step=_iterator.n()).done;){var b=_step.value,children=null;"PREVIOUS_MONTH"===b.rangeTypeEnum||"ANY_MONTH"===b.rangeTypeEnum?children=[{label:"Same date",value:4},{label:"Same week",value:1}]:"PREVIOUS_YEAR"!==b.rangeTypeEnum&&"ANY_YEAR"!==b.rangeTypeEnum||(children=[{label:"Same date",value:3},{label:"Same week",value:1}]),"PREVIOUS"!==b.rangeTypeEnum&&self.baseLineCasecaderOptions.push({label:b.name,value:b.id,children:children})}}catch(err){_iterator.e(err)}finally{_iterator.f()}}})),self.loadZones()},computed:{cssLeft:function(){return"0px !important"},isOptimize:function(){return!!this.$route.query.newchart},isSiteAnalysis:function(){return this.$route.meta&&"site"===this.$route.meta.analyticsType},isSameDataPoint:function(){if(this.analyticsConfig&&this.analyticsConfig.dataPoints.length){var _step2,dp={},_iterator2=(0,createForOfIteratorHelper/* default */.Z)(this.analyticsConfig.dataPoints);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var d=_step2.value;dp[d.yAxis.fieldId]=!0}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}if(1===Object.keys(dp).length)return!0}return!1},availablePeriods:function(){this.analyticsConfig.dateFilter.operationOnId;var avail=[];return avail.push({name:this.$t("common.header.hour_of_day"),value:20,format:"hours",enable:!0}),avail.push({name:this.$t("common.header.day_of_month"),value:12,format:"days",enable:!0}),avail.push({name:this.$t("common.header.day_of_week"),value:12,format:"weeks",enable:!0}),avail}},methods:{toggleFilter:function(val){var _this2=this;if(this.analyticsConfig&&this.analyticsConfig.template)this.$set(this.analyticsConfig.template,"show",val);else{
// create a new template
var config=JSON.parse(JSON.stringify(this.analyticsConfig)),duplicateCase=this.getDuplicateCase(this.reportObject);this.prepareReportTemplate(this.resultObject,duplicateCase.case).then((function(newTemplate){newTemplate.show=val,config.template=newTemplate,_this2.analyticsConfig=config}))}},setTemplateFilterCriteria:function(val){this.templateCriteria=val},addFilterCriteria:function(){var _this3=this,config=JSON.parse(JSON.stringify(this.analyticsConfig));if(this.showFilter=!1,config.parentId=null,config.template)config.template.criteria=this.templateCriteria,this.analyticsConfig=config;else{var duplicateCase=this.getDuplicateCase(this.reportObject);this.prepareReportTemplate(this.resultObject,duplicateCase.case).then((function(newTemplate){newTemplate.criteria=_this3.templateCriteria,config.template=newTemplate,_this3.analyticsConfig=config}))}},openFilter:function(){this.isFilterActive?this.showFilter=!0:this.showFilter=!1},checkFilterActive:function(){if(this.reportObject){var FilterFeasibility=this.checkFilterFeasibility(this.reportObject);FilterFeasibility&&(this.filterTitle=this.analyticsConfig.template&&this.analyticsConfig.template.criteria?"Specific "+this.assetCategoryName+" Selected":"All "+this.assetCategoryName),this.isFilterActive=FilterFeasibility}else this.isFilterActive=!1},toggleSideBar:function(){this.hideSideBar?(this.hideSideBar=!1,this.chartDimensions.width=980,this.chartDimensions.height=800):(this.hideSideBar=!0,this.chartDimensions.width=1340,this.chartDimensions.height=800)},prepareDataPointSummary:function(){var _this4=this;if(this.resultObject){var _step3,summaryList=[],weatherModules={weather:"Live Weather",weatherDaily:"Daily Weather",psychrometric:"Psychrometric",cdd:"Degree Days",wdd:"Degree Days",hdd:"Degree Days"},_iterator3=(0,createForOfIteratorHelper/* default */.Z)(this.resultObject.report.dataPoints);try{var _loop=function(){var dataPoint=_step3.value;if(dataPoint.yAxis&&dataPoint.yAxis.module)if(Object.keys(weatherModules).includes(dataPoint.yAxis.module.name))_this4.addToGroup(dataPoint,weatherModules[dataPoint.yAxis.module.name],summaryList);else if(dataPoint.metaData.parentIds[0]===parseInt(_this4.selectedBuildings[0])&&"scheduled_formula"===dataPoint.yAxis.module.typeEnum.toLowerCase())_this4.addToGroup(dataPoint,"Enpi",summaryList);else{var self=_this4;self.$http.post("v2/resource/getResourcesDetails",{resourceId:dataPoint.metaData.parentIds}).then((function(response){"SPACE"===response.data.result.resource[0].resourceTypeEnum?_this4.addToGroup(dataPoint,"Space",summaryList):_this4.addToGroup(dataPoint,"Asset",summaryList)}))}};for(_iterator3.s();!(_step3=_iterator3.n()).done;)_loop()}catch(err){_iterator3.e(err)}finally{_iterator3.f()}return summaryList}},addToGroup:function(dataPoint,label,summaryList){var _this5=this,reading={};if(reading["readingId"]=dataPoint.yAxis.fieldId,reading["readingLabel"]=dataPoint.yAxis.field.displayName,reading["resourceId"]="Asset"===label?parseInt(dataPoint.metaData.parentIds[0]):"Space"===label||"Enpi"===label?parseInt(this.selectedBuildings[0]):this.$store.state.buildings.filter((function(building){return building.id===parseInt(_this5.selectedBuildings[0])}))[0].siteId,reading["resourceLabel"]=dataPoint.resourceName,reading["marked"]=null,reading["location"]=this.selectedBuildingTitle,reading["categoryId"]=dataPoint.assetCategoryId,reading["buildingId"]=dataPoint.buildingId,summaryList&&0===summaryList.length){var temp={};temp["label"]=label,temp["readings"]=[],temp.readings.push(reading),summaryList.push(temp)}else if(summaryList&&summaryList.length>0){var readingGroup=summaryList.filter((function(group){return group.label===label}));if(0!==readingGroup.length)readingGroup[0].readings.push(reading);else{var _temp={};_temp["label"]=label,_temp["readings"]=[],_temp.readings.push(reading),summaryList.push(_temp)}}},loadAlarmMeta:function(){var _this6=this;this.$http.post("/dashboard/getReportMetaForAlarms",{alarmId:this.$route.query.alarmId}).then((function(response){response.data&&response.data.reportMeta&&(_this6.analyticsConfig.dataPoints=response.data.reportMeta.dataPoints)}))},reportLoaded:function(report,result){this.reportObject=report,this.checkFilterActive(),this.$route.query.reportId&&(this.filterToggle=4===report.reportType),this.resultObject=result,(this.analyticsConfig.savedReport||this.$route.query.filters)&&(this.dataPointSummaryList=this.prepareDataPointSummary()),4===this.reportObject.reportType&&this.reportObject.options.reportTemplate.buildingId?(report.options.common.buildingIds.push(this.reportObject.options.reportTemplate.buildingId),this.resetDataPointSelector(report.options.common.buildingIds)):report.options.common&&report.options.common.buildingIds&&(!report.options.common.buildingIds.length&&this.selectedBuildings?this.$route.query.filters||this.$route.query.alarmId||this.$route.query.cardId?(this.analyticsConfig.buildingId?this.reportObject.options.common.buildingIds.push(this.analyticsConfig.buildingId):this.$route.query.buildingId?this.reportObject.options.common.buildingIds.push(this.$route.query.buildingId):this.reportObject.options.common.buildingIds=this.selectedBuildings,this.resetDataPointSelector(this.reportObject.options.common.buildingIds)):this.reportObject.options.common.buildingIds=this.selectedBuildings:this.resetDataPointSelector(report.options.common.buildingIds))},loadZones:function(){var self=this;self.$http.get("/zone").then((function(response){response.data&&response.data.records&&(self.zones=response.data.records)}))},resetDataPointSelector:function(buildingIds){this.$refs["building-selector"].setInitialValues(this.analyticsConfig.dataPoints,buildingIds)},updateDataPoints:function(changedDataPoints){var _this7=this;if(this.analyticsConfig.dataPoints.length){var configIndexes=[],alreadyAddedIndexes=[],pointsToRemove=[],optionPoints=[];this.reportObject.options.dataPoints.forEach((function(dp){"group"===dp.type?optionPoints.push.apply(optionPoints,(0,toConsumableArray/* default */.Z)(dp.children)):optionPoints.push(dp)}));var isValid=optionPoints.filter((function(dp){return 2!==dp.pointType})).every((function(dp){var idx=changedDataPoints.findIndex((function(cdp){return cdp.parentId===dp.parentId&&cdp.yAxis.fieldId===dp.fieldId}));if(-1===idx){if(!_this7.checkAndDeletePointsRel(_this7.reportObject.options,dp.alias))return _this7.$message.error(dp.label+_this7.$t("common.header.has_been_used_derivation_removing_point")),_this7.resetDataPointSelector(),!1;pointsToRemove.push(dp.alias)}if(-1!==idx){var configIdx=_this7.getConfigDataPointFromOptionDP(_this7.analyticsConfig,dp,!0);configIndexes.push(configIdx),alreadyAddedIndexes.push(idx)}return!0}));isValid&&(this.removeOptionPoints(this.reportObject.options,pointsToRemove),this.analyticsConfig.dataPoints=[].concat((0,toConsumableArray/* default */.Z)(this.analyticsConfig.dataPoints.filter((function(dp,idx){return 2===dp.type||configIndexes.includes(idx)}))),(0,toConsumableArray/* default */.Z)(changedDataPoints.filter((function(cdp,idx){return!alreadyAddedIndexes.includes(idx)})))))}else this.analyticsConfig.dataPoints=changedDataPoints;this.addPredictionFields(this.analyticsConfig),this.showDataPointSelector=!1},showCustomizationDialog:function(){this.hideSideBar=!1,this.showgeneratedata=!1,this.showCustomization=!0},hideChartCustomizationDialog:function(){this.showCustomization=!1},showgeneratedataDialog:function(){this.hideSideBar=!1,this.showCustomization=!1,this.showgeneratedata=!0},setSelectedBuildings:function(_ref){var name=_ref.name,ids=_ref.ids;this.selectedBuildingTitle=name,this.selectedBuildings=ids,this.reportObject&&this.reportObject.options&&this.reportObject.options.common&&(this.reportObject.options.common.buildingIds=this.selectedBuildings)},onPeriodChange:function(){if("hours"===this.analyticsConfig.format?this.analyticsConfig.period=20:this.analyticsConfig.period=12,!this.analyticsConfig.dataPoints.length){var filter=22;20===this.analyticsConfig.period?filter=31:12===this.analyticsConfig.period?filter=28:10===this.analyticsConfig.period&&(filter=44),this.analyticsConfig.dateFilter=NewDateHelper/* default */.Z.getDatePickerObject(filter)}},onSettingsChange:function(changedOption){"alarm"===changedOption&&(this.reportObj.alarms&&this.reportObj.alarms.regions.length||!this.reportObj.options.settings.alarm||this.initChart())}}},newTools_Heatmapvue_type_script_lang_js=Heatmapvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(newTools_Heatmapvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,Heatmap=component.exports},
/***/196510:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"2da26706fa3b7cf6cb36528c88c86d0d.svg";
/***/},
/***/552184:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"c993f6dafb3c0b9ebe399cdf6c4b3a02.svg";
/***/},
/***/587758:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"5ee9b0f49c6e73cc51f35d51be8bad36.svg";
/***/},
/***/134105:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"32593a37e7348ae1623e9e42913d7e55.svg";
/***/},
/***/667527:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"00e2f8b54392f5c9d15bf4a60fcf5285.svg";
/***/}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/99028.js.map