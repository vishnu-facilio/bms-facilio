"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[66827,50788],{
/***/405469:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return GaugeChart}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/GaugeChart.vue?vue&type=template&id=f235c9a6
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("div",{ref:"gauge",staticClass:"p10 gauge"})])},staticRenderFns=[],d3=(__webpack_require__(897389),__webpack_require__(879288),__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(348727)),cardtooltip=__webpack_require__(960111),GaugeChartvue_type_script_lang_js={props:["widget","config","gaugeData"],mixins:[cardtooltip/* default */.Z],data:function(){return{type:"semidoughnut",id:100*Math.random().toFixed(2),configdata:{size:710,clipWidth:200,clipHeight:110,ringInset:20,ringWidth:20,pointerWidth:10,pointerTailLength:5,pointerHeadLengthPercent:.9,minValue:0,maxValue:10,minAngle:-90,maxAngle:90,transitionMs:750,majorTicks:5,labelFormat:d3.format("d"),labelInset:10,arcColorFn:d3.interpolateHsl(d3.rgb("#e8e2ca"),d3.rgb("#3e6c0a"))},data:{value:100,target:10,max:200,color:"#1ce6e5,#1ce6e5",centerText:[{label:"6174.20 kwh"},{label:"THIS MONTH"}]}}},watch:{gaugeData:{handler:function(newData,oldData){this.$refs["gauge"].innerHTML="";var self=this;setTimeout((function(){self.generate()}),400)},deep:!0}},mounted:function(){this.generate()},methods:{deg2rad:function(deg){return deg*Math.PI/180},generate:function(){var chartContext={};this.id=100*Math.random().toFixed(2),chartContext.id=this.id,chartContext.selecter=this.$refs["gauge"],chartContext.width=100,chartContext.height=100,chartContext.isMaxpointer=!1,chartContext.pointerColor=this.gaugeData.meta.pointerColor||"rgba(29, 25, 50, 0.85)",chartContext.unitTextSize=this.gaugeData.meta.unitTextSize?this.gaugeData.meta.unitTextSize:"0.4vw",chartContext.remainingTextSize=this.gaugeData.meta.remainingTextSize?this.gaugeData.meta.remainingTextSize:"0.5vw",this.gaugeData&&this.gaugeData.value&&this.gaugeData.value.needMax&&"usetarget"!==this.gaugeData.value.needMax&&(chartContext.isMaxpointer=!0),chartContext.svg=d3.select(chartContext.selecter).append("svg").attr("width","100%").attr("height","100%").attr("viewBox","0 0 "+Math.min(chartContext.width,chartContext.height)+" "+Math.min(chartContext.width,chartContext.height)).attr("preserveAspectRatio","xMinYMin").append("g"),chartContext.svg.attr("transform","translate("+Math.min(chartContext.width,chartContext.height)/2+","+Math.min(chartContext.width,chartContext.height)/2+") "),this.gaugeData.meta.color=this.gaugeData.meta.color||"#1ce6e5,#1ce6e5",chartContext.data=this.gaugeData,this.draw(chartContext)},centerTranslation:function(r){return"translate("+r+","+r+")"},draw:function(chartContext,newValue){var self=this,data=chartContext.data.meta||null,value=chartContext.data.value||null,config=this.configdata,percentage=data.targetValue&&data.baseValue?data.baseValue/data.targetValue:0,maxPointer=!1,maxPercentage=data.targetValue&&data.baseValue?data.baseValue/data.targetValue:0;percentage>1&&(maxPointer=!0,maxPercentage%=1);var t=Math.PI,width=100,height=100,outerRadius=Math.min(width,height)/2,innerRadius=outerRadius/5*3;chartContext.arc=d3.arc().innerRadius(innerRadius).outerRadius(outerRadius),chartContext.arc1=d3.arc().innerRadius(innerRadius).outerRadius(outerRadius),chartContext.targetArc=d3.arc().innerRadius(innerRadius).outerRadius(outerRadius);var svg=chartContext.svg;chartContext.defs=svg.append("defs"),chartContext.gradient=chartContext.defs.append("linearGradient").attr("id",(function(){return"svgGradient"+chartContext.id})).attr("x1","100%").attr("x2","0%").attr("y1","0%").attr("y2","100%"),chartContext.gradient.append("stop").attr("class","start").attr("offset","0%").attr("stop-color",(function(){return value&&value.startColor?value.startColor:"#1ce6e5"})).attr("stop-opacity",.2),chartContext.gradient.append("stop").attr("class","end").attr("offset","2000%").attr("stop-color",(function(){return value&&value.end?value.end:"#1ce6e5"})).attr("stop-opacity",1),percentage=percentage>1?1:percentage<-1?0:percentage;// to omit the -ve percentage
var unit=data.fieldObj&&data.fieldObj.unit?data.fieldObj.unit:null;svg.append("path").datum({startAngle:0,endAngle:t}).style("fill","#f1f3f4").attr("d",chartContext.arc).attr("class","arc").on("mouseover",(function(d){var tooltipdata=[{label:"Target",value:data.targetValue+" "+(unit||"")},{label:"Achieved",value:data.baseValue+" "+(unit||"")},{label:maxPointer?"Exceeded by":"Remaining",value:data?maxPointer?(Number(data.baseValue)-Number(data.targetValue)).toFixed(2)+" "+(unit||""):(Number(data.targetValue)-Number(data.baseValue)).toFixed(2)+" "+(unit||""):""}],tooltipConfig={title1:"",position:{left:d3.event.pageX,top:d3.event.pageY},data:tooltipdata};
// if (!self.$mobile) {
//   self.showTooltipForCard1(tooltipConfig, 'kpi-gauge-chart')
// }
self.showTooltipForCard1(tooltipConfig,"kpi-gauge-chart")})).on("mouseout",(function(d){self.hideTooltip("kpi-gauge-chart")})),data.colorPlates&&data.colorPlates.length?data.colorPlates.forEach((function(rt){rt.startAngle!==rt.endAngle&&rt.startAngle<percentage&&svg.append("path").datum({startAngle:rt.startAngle*t,endAngle:percentage>=rt.endAngle?rt.endAngle*t:percentage*t}).style("fill",(function(){return rt.color})).attr("d",chartContext.arc).attr("class","arc")})):chartContext.midground=svg.append("path").datum({startAngle:0,endAngle:(percentage||0)*t}).style("fill",(function(){return"url(#svgGradient"+chartContext.id+")"})).attr("d",chartContext.arc).attr("class","arc").on("mouseover",(function(d){var tooltipdata=[{label:"Target",value:data.targetValue+" "+(unit||"")},{label:"Achieved",value:data.baseValue+" "+(unit||"")},{label:maxPointer?"Exceeded by":"Remaining",value:maxPointer?(Number(data.baseValue)-Number(data.targetValue)).toFixed(2)+" "+(unit||""):(Number(data.targetValue)-Number(data.baseValue)).toFixed(2)+" "+(unit||"")}],tooltipConfig={title1:"",position:{left:d3.event.pageX,top:d3.event.pageY},data:tooltipdata};self.showTooltipForCard1(tooltipConfig,"kpi-gauge-chart")})).on("mouseout",(function(d){self.hideTooltip("kpi-gauge-chart")}));var arcTween=function(transition,newAngle){transition.attrTween("d",(function(d){}))};
// chartContext.midground
//   .transition()
//   .duration(1000)
//   .call(arcTween, percentage * t)
// max pointer
maxPointer&&(chartContext.midground1=svg.append("path").datum({startAngle:(maxPercentage-.005)*t,endAngle:maxPercentage*t}).style("fill","#000").attr("d",chartContext.arc1).attr("class","arc"),chartContext.midground1.transition().duration(1e3).call(arcTween,maxPercentage*t));
// draw pointer
this.centerTranslation(innerRadius);var range=config.maxAngle-config.minAngle,pointerHeadLength=Math.round(innerRadius*config.pointerHeadLengthPercent),lineData=[[config.pointerWidth/4,0],[0,-pointerHeadLength],[-config.pointerWidth/4,0],[0,0],[config.pointerWidth/4,0]],pointerLine=d3.line().curve(d3.curveLinear),pg=svg.append("g").data([lineData]).attr("class","pointer").attr("transform",0),pointer=pg.append("path").attr("d",pointerLine/*function(d) { return pointerLine(d) +'Z';}*/).attr("transform","rotate("+config.minAngle+")").attr("fill",chartContext.pointerColor);
// svg
//   .append('circle')
//   .attr('cx', 0)
//   .attr('cy', 0)
//   .attr('r', 5)
//   .attr('fill', '#fff')
//   .attr('transform', 'rotate(' + config.minAngle + ')')
// svg
//   .append('circle')
//   .attr('cx', 0)
//   .attr('cy', 0)
//   .attr('r', 4)
//   .attr('fill', 'rgb(102, 102, 102)')
//   .attr('transform', 'rotate(' + config.minAngle + ')')
svg.append("text").attr("text-anchor","middle").style("font-size",chartContext.remainingTextSize).attr("dy",25).attr("dx",0).style("letter-spacing","0.3px").text((function(){var value="Remaining : ";if(unit){var obj=self.$convert(Number(data.targetValue)-Number(data.baseValue)).from(unit).toBest(),ob=self.$convert(Number(data.baseValue)-Number(data.targetValue)).from(unit).toBest();value+=Number(obj.val).toFixed(2),maxPointer&&(value="Exceeded by : ",value+=Number(ob.val).toFixed(2)),data.fieldObj&&data.fieldObj.unit&&!maxPointer?value+=" "+obj.unit:maxPointer&&(value+=" "+ob.unit)}else value+=(Number(data.targetValue)-Number(data.baseValue)).toFixed(2),maxPointer&&(value="Exceeded by : ",value+=(Number(data.targetValue)-Number(data.baseValue)).toFixed(2));return value})).style("letter-spacing"," 0.3px").style("padding-top"," 5px").attr("class","gauge-center-period").attr("fill","#6d7278"),svg.append("text").attr("text-anchor","middle").style("font-size",chartContext.unitTextSize).attr("dy",10).attr("dx",-40).style("letter-spacing","0.3px").text((function(){return"0 "+(unit||"")})).style("letter-spacing"," 0.3px").style("padding-top"," 5px").attr("fill","#6d7278"),svg.append("text").attr("text-anchor","middle").style("font-size",chartContext.unitTextSize).attr("dy",10).attr("dx",unit?30:40).style("letter-spacing","0.3px").text((function(){if(unit){var obj=self.$convert(Number(data.baseValue)>Number(data.targetValue)?data.baseValue:data.targetValue).from(unit).toBest();return Number(obj.val).toFixed(2)+" "+obj.unit}return Number(data.baseValue)>Number(data.targetValue)?data.baseValue:data.targetValue})).style("letter-spacing"," 0.3px").style("padding-top"," 5px").attr("fill","#6d7278"),svg.append("line").attr("x1",-50).attr("y1",30).attr("x2",50).attr("y2",30).attr("stroke","#6d7278").attr("stroke-width","0.1").attr("fill","#f1f3f4");var _tooltip=svg.append("g").attr("class","target-meter-group");_tooltip.append("div").attr("class","target-meter-tooltip").style("background-color","#fff").text("test");var scale=d3.scaleLinear().range([0,1]).domain([config.minValue,config.maxValue]),ratio=scale(newValue);config.minAngle;pointer.transition().duration(config.transitionMs).ease(d3.easeLinear).attr("transform","rotate("+(180*(percentage||0)-90)+")")}}},components_GaugeChartvue_type_script_lang_js=GaugeChartvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_GaugeChartvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,GaugeChart=component.exports},
/***/850788:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return SmartEnergyMap}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/dashboard/widget/cards/v2/SmartEnergyMap.vue?vue&type=template&id=106c0503
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"dragabale-card height100"},[_vm.loading?_c("shimmer-loading",{staticClass:"map-shimmer"}):_c("div",{staticClass:"height100"},[_vm.mapdata&&_vm.mapdata.length?_c("f-map",{attrs:{markers:_vm.mapdata,categoryId:_vm.assetCategoryID,category:_vm.assetCategory}}):_vm._e()],1)],1)},staticRenderFns=[],DashboardFilters=(__webpack_require__(865137),__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(169358),__webpack_require__(648324),__webpack_require__(634338),__webpack_require__(584645),__webpack_require__(497337),__webpack_require__(313429),__webpack_require__(337462),__webpack_require__(506319)),DateHelper=__webpack_require__(281230),ShimmerLoading=(__webpack_require__(519898),__webpack_require__(405469),__webpack_require__(516400)),FNewMap=__webpack_require__(786900),SmartEnergyMapvue_type_script_lang_js={props:["widget","config"],mixins:[DateHelper/* default */.Z,DashboardFilters/* default */.Z],data:function(){return{loading:!1,mapdata:[],data:{typeName:"swimmingpool"},siteAlarmData:[],buildingLoaction:{1240236:{city:null,contact:null,country:null,currentTime:1570128211345,data:null,deleted:!1,empty:!0,faxPhone:null,formId:-1,id:35531,lat:25.2510166,lng:55.2898577,localId:0,moduleId:-1,moduleState:null,name:null,offlineModifiedTime:-1,orgId:-1,phone:null,primaryValue:null,siteId:-1,state:null,stateFlowId:0,street:null,sysCreatedBy:null,sysCreatedTime:-1,sysDeletedBy:null,sysDeletedTime:-1,sysModifiedBy:null,sysModifiedTime:-1,zip:null},1240225:{city:null,contact:null,country:null,currentTime:1570128211294,data:null,deleted:!1,empty:!0,faxPhone:null,formId:-1,id:35530,lat:25.2510166,lng:55.2898577,localId:0,moduleId:-1,moduleState:null,name:null,offlineModifiedTime:-1,orgId:-1,phone:null,primaryValue:null,siteId:-1,state:null,stateFlowId:0,street:null,sysCreatedBy:null,sysCreatedTime:-1,sysDeletedBy:null,sysDeletedTime:-1,sysModifiedBy:null,sysModifiedTime:-1,zip:null},1240580:{city:null,contact:null,country:null,currentTime:1570128882023,data:null,deleted:!1,empty:!0,faxPhone:null,formId:-1,id:35543,lat:25.2788468,lng:55.3309395,localId:0,moduleId:-1,moduleState:null,name:null,offlineModifiedTime:-1,orgId:-1,phone:null,primaryValue:null,siteId:-1,state:null,stateFlowId:0,street:null,sysCreatedBy:null,sysCreatedTime:-1,sysDeletedBy:null,sysDeletedTime:-1,sysModifiedBy:null,sysModifiedTime:-1,zip:null}}}},created:function(){},mounted:function(){this.getParams(),this.getMapData()},components:{shimmerLoading:ShimmerLoading/* default */.Z,FMap:FNewMap/* default */.Z},methods:{getTspanX:function(count,def){return count+="",1===count.length?def+5:def},getMapData:function(){this.loading=!0;var self=this,params={};self.$http.post("/report/energy/portfolio/getAllBuildingsWithRootMeterMeta",params).then((function(response){var reportData=response.data.reportData;reportData&&reportData.buildingsWithRootMeterMeta&&(self.mapdata=self.pereparemapData(reportData.buildingsWithRootMeterMeta)),self.loading=!1})).catch((function(error){self.loading=!1}))},pereparemapData:function(data){var self=this,i=1,opacity=.5/data.length;return data=data.sort((function(a,b){return a.thisMonthKwh<b.thisMonthKwh?-1:1})),data.forEach((function(rt){var obj=self.$convert(rt.thisMonthKwh).from("kWh").toBest();rt.count=Math.round(obj.val)+" "+obj.unit,rt.location=self.buildingLoaction[rt.building],rt.opacity=opacity*i+.5,rt.markerUrl=self.getMapMarkers(rt,1),i++})),data},getParams:function(){this.widget.dataOptions.metaJson&&this.widget.dataOptions.metaJson.length?this.data=JSON.parse(this.widget.dataOptions.metaJson):this.widget.dataOptions.metaJson=JSON.stringify(this.data)},getMapMarkers:function(rt,type){var x=this.getTspanX(rt.count,16.5459096),x1=this.getTspanX(rt.count,35),svg1="";svg1=type&&1===type?'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="85px" height="85px" viewBox="0 0 85 85" version="1.1">\n    \x3c!-- Generator: Sketch 55.2 (78181) - https://sketchapp.com --\x3e\n    <title>Group 2</title>\n    <desc>Created with Sketch.</desc>\n    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n        <g id="Artboard-Copy" transform="translate(-160.000000, -111.000000)" style="opacity:'.concat(rt.opacity,'">\n            <g id="Group-2" transform="translate(160.000000, 111.000000)">\n                <circle id="Oval-Copy-4" fill="#FF5E5E" opacity="0.699999988" cx="42.5" cy="42.5" r="22.5"/>\n                <circle id="Oval-Copy-5" fill="#FF5E5E" opacity="0.300000012" cx="42.5" cy="42.5" r="32.5"/>\n                <circle id="Oval-Copy-6" fill="#FF5E5E" opacity="0.200000003" cx="42.5" cy="42.5" r="42.5"/>\n                <circle id="Oval" fill="#EF5151" cx="42.5" cy="42.5" r="14.5"/>\n                <text id="24" font-family="ProximaNova-Bold, Proxima Nova" font-size="12" font-weight="bold" fill="#FFFFFF">\n                    <tspan x="').concat(x1,'" y="46">').concat(rt.count,"</tspan>\n                </text>\n            </g>\n        </g>\n    </g>\n</svg>"):'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="62px" height="80px" viewBox="0 0 62 80" version="1.1">\n                  <title>Group 2 Copy</title>\n                  <desc>Created with Sketch.</desc>\n                  <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                      <g id="Group-2-Copy" transform="translate(0.200000, 0.200000)">\n                          <g id="Group">\n                              <path d="M30.7526226,55.4684967 C17.1645388,55.4684967 6.14942237,44.4533803 6.14942237,30.8652965 C6.14942237,17.2772127 17.1645388,6.2684967 30.7526226,6.2684967 C44.3407064,6.2684967 55.3558228,17.2772127 55.3558228,30.8652965 C55.3558228,44.4533803 44.3407064,55.4684967 30.7526226,55.4684967" id="Path" fill="#FFFFFF"/>\n                              <path d="M30.7526226,53.0684967 C18.4902055,53.0684967 8.54973459,43.1280258 8.54973459,30.8656087 C8.54973459,18.6031916 18.4902055,8.6684967 30.7526226,8.6684967 C43.0150396,8.6684967 52.9555106,18.6031916 52.9555106,30.8656087 C52.9555106,43.1280258 43.0150396,53.0684967 30.7526226,53.0684967 M30.7526226,0 C13.7687878,0 -2.84217094e-14,13.7687878 -2.84217094e-14,30.7526226 C-2.84217094e-14,54.2033366 24.8890244,79.6 30.8519433,79.6 C36.8148621,79.6 61.5052452,54.2033366 61.5052452,30.7526226 C61.5052452,13.7687878 47.7364573,0 30.7526226,0" id="Fill-1" fill="'.concat(rt.color,'"/>\n                              <path d="M30.7526226,53.0684967 C18.4902055,53.0684967 8.54973459,43.1280258 8.54973459,30.8656087 C8.54973459,18.6031916 18.4902055,8.6684967 30.7526226,8.6684967 C43.0150396,8.6684967 52.9555106,18.6031916 52.9555106,30.8656087 C52.9555106,43.1280258 43.0150396,53.0684967 30.7526226,53.0684967" id="Path" fill="#FFFFFF"/>\n                              <path d="M29.724641,2.1193783 C38.1787772,2.1193783 45.7455395,5.9161022 50.8109907,11.8980598 C45.9002953,7.41174931 39.3624732,4.67517793 32.1850571,4.67517793 C16.9337201,4.67517793 4.5702952,17.031419 4.5702952,32.282756 C4.5702952,39.0818397 7.0274003,45.3069802 11.1020923,50.1186593 C5.57644711,45.068923 2.10987904,37.802809 2.10987904,29.7269564 C2.10987904,14.4756193 14.4733039,2.1193783 29.724641,2.1193783 Z" id="Combined-Shape" fill="').concat(rt.color,'"/>\n                              <path d="M35.8098164,15.4051386 C42.2018576,15.4051386 47.922767,18.2766474 51.7515365,22.8005079 C48.0397747,19.4068702 43.0965477,17.3369571 37.6695387,17.3369571 C26.1417121,17.3369571 16.7967335,26.6765057 16.7967335,38.2043323 C16.7967335,43.3410644 18.6522178,48.044383 21.7295199,51.6806217 C17.5551836,47.8645317 14.9370113,42.3743058 14.9370113,36.2725138 C14.9370113,24.7446872 24.2819898,15.4051386 35.8098164,15.4051386 Z" id="Combined-Shape" fill="#F1F3F4" transform="translate(33.344274, 33.542880) rotate(-180.000000) translate(-33.344274, -33.542880) "/>\n                          </g>\n                          <text id="75" font-family="ProximaNova-Semibold, Proxima Nova" font-size="25" font-weight="500" fill="#000" style="font-family: sans-serif;font-weight: 700;">\n                              <tspan x="').concat(x,'" y="40">').concat(rt.count,"</tspan>\n                          </text>\n                      </g>\n                  </g>\n              </svg>");var base64=btoa(unescape(encodeURIComponent(svg1)));return"data:image/svg+xml;base64,".concat(base64)}}},v2_SmartEnergyMapvue_type_script_lang_js=SmartEnergyMapvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(v2_SmartEnergyMapvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,SmartEnergyMap=component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/66827.js.map