(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[74481],{
/***/478264:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return ViewCustomization}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/ViewCustomization.vue?vue&type=template&id=a8fd5fbc
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{attrs:{visible:_vm.showDialog,fullscreen:!0,"custom-class":"cc-dialog",title:"View Settings","append-to-body":!0},on:{"update:visible":function($event){_vm.showDialog=$event}}},[_c("div",{staticClass:"scrollable",staticStyle:{padding:"30px","max-height":"85vh"}},[_c("draggable",{attrs:{options:{handle:".icon-right",ghostClass:"drag-ghost",dragClass:"custom-drag",animation:150},list:_vm.viewList}},_vm._l(_vm.viewList,(function(view){return _c("div",{key:view.name,staticClass:"column-item"},[view?_c("div",[_vm._v(_vm._s(_vm.menu?view.label:view.displayName))]):_vm._e(),_c("i",{staticClass:"fa fa-exchange icon-right",attrs:{"aria-hidden":"true"}})])})),0)],1),_c("div",{staticClass:"row cc-dialog-footer",attrs:{slot:"footer"},slot:"footer"},[_c("button",{staticClass:"el-button col-6 uppercase ls9 f12 form-btn el-button--default",staticStyle:{"background-color":"#f4f4f4",border:"0","border-left":"1px solid white","border-radius":"0px",padding:"18px","font-size":"13px","font-weight":"500","letter-spacing":"0.8px","text-align":"center",color:"#5f5f5f",margin:"0"},attrs:{type:"button"},on:{click:function($event){_vm.showDialog=!1}}},[_c("span",[_vm._v("Cancel")])]),_c("button",{staticClass:"el-button col-6 uppercase ls9 f12 form-btn  el-button--default",staticStyle:{"margin-left":"0px",color:"#ffffff","background-color":"#39b2c2",border:"0","border-radius":"0px","font-size":"13px","font-weight":"500","letter-spacing":"0.8px","text-align":"center"},attrs:{type:"button"},on:{click:_vm.save}},[_c("span",[_vm._v("Save")])])])])},staticRenderFns=[],objectSpread2=__webpack_require__(595082),validation=(__webpack_require__(450886),__webpack_require__(434284),__webpack_require__(990260)),vuex_esm=__webpack_require__(420629),vuedraggable_umd=__webpack_require__(909980),vuedraggable_umd_default=__webpack_require__.n(vuedraggable_umd),ViewCustomizationvue_type_script_lang_js={props:["visible","moduleName","menu","reload"],data:function(){return{showDialog:this.visible,viewList:[],lists:{}}},components:{draggable:vuedraggable_umd_default()},computed:(0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({views:function(state){return state.view.views}})),mounted:function(){(0,validation/* isEmpty */.xb)(this.menu)?this.viewList=this.$helpers.cloneObject(this.views):this.viewList=this.$helpers.cloneObject(this.menu)},watch:{visible:function(val){this.showDialog=val},showDialog:function(val){this.$emit("update:visible",val)},views:function(val){this.viewList=this.$helpers.cloneObject(val)},menu:function(val){this.viewList=this.$helpers.cloneObject(val)}},methods:{save:function(){var _this=this;this.$store.dispatch("view/customizeView",{moduleName:this.moduleName,views:this.viewList.map((function(view,index){return{id:view.id,sequenceNumber:index+1,name:view.name}}))}).then((function(){_this.showDialog=!1,_this.reload&&_this.$emit("onchange")}))}}},components_ViewCustomizationvue_type_script_lang_js=ViewCustomizationvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_ViewCustomizationvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,ViewCustomization=component.exports},
/***/482912:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return Tags}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/newapp/components/Tags.vue?vue&type=template&id=33f85a81&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.$validation.isEmpty(_vm.filterForTag)?_vm._e():_c("div",{staticClass:"d-flex tags-parent-container items-baseline"},[_c("div",{staticClass:"mT24 mL20 d-flex flex-grow items-baseline"},[_c("div",{staticClass:"tag-inline"},[_vm._l(_vm.filterForTag,(function(filterObj,filterName){return[_vm.checkForDateTimeField(filterName,filterObj)?_c("el-tag",{key:filterName,staticClass:"search-filter-tag",attrs:{closable:!_vm.disableCloseIcon,"disable-transitions":!0},on:{close:function($event){return _vm.handleClose(filterName)}}},[_vm._v(" "+_vm._s(_vm.checkForDateTimeField(filterName,filterObj))+" ")]):["asset","space","resourceId","resource","resourceIdSpace","resourceIdAsset"].includes(filterName)?_c("el-tag",{key:filterName,staticClass:"search-filter-tag",attrs:{closable:!_vm.disableCloseIcon,"disable-transitions":!0},on:{close:function($event){return _vm.handleClose(filterName)}}},[_vm._v(" "+_vm._s(_vm.resourceTag(filterObj,filterName))+" ")]):_vm.$validation.isEmpty(filterObj.value)?_c("el-tag",{key:filterName,staticClass:"search-filter-tag",attrs:{closable:!_vm.disableCloseIcon,"disable-transitions":!0},on:{close:function($event){return _vm.handleClose(filterName)}}},[_vm._v(" "+_vm._s(_vm.fieldLabelMap[filterName])+" "+_vm._s(_vm.operatorMap[filterObj.operatorId])+" ")]):1===filterObj.value.length?_c("el-tag",{key:filterName,staticClass:"search-filter-tag",attrs:{closable:!_vm.disableCloseIcon,"disable-transitions":!0},on:{close:function($event){return _vm.handleClose(filterName)}}},[_vm._v(" "+_vm._s(_vm.fieldLabelMap[filterName])+" "+_vm._s(_vm.operatorMap[filterObj.operatorId])+" "+_vm._s(_vm.getValue(filterName,filterObj,null))+" ")]):_vm._l(filterObj.value,(function(id){return _c("el-tag",{key:_vm.fieldLabelMap[filterName]+id,staticClass:"search-filter-tag",attrs:{closable:!_vm.disableCloseIcon,"disable-transitions":!0},on:{close:function($event){return _vm.handleClose(filterName,id)}}},[_vm._v(" "+_vm._s(_vm.fieldLabelMap[filterName])+" "+_vm._s(_vm.operatorMap[filterObj.operatorId])+" "+_vm._s(_vm.getValue(filterName,filterObj,Number(id)))+" ")])}))]}))],2),_vm.disableFilterAdd||!_vm.canShowOptions&&!_vm.showOptions?_vm._e():_c("div",{staticClass:"d-flex align-center"},[_c("div",{staticClass:"f13 fc-dark-blue-txt13 pointer mL10 mR10 fwBold",on:{click:function($event){$event.stopPropagation(),_vm.showFilterList=!0}}},[_c("i",{staticClass:"el-icon-plus fc-dark-blue-txt13 f13 fwBold"}),_vm._v(" "+_vm._s(_vm.$t("common._common.add_filter"))+" ")]),_vm.showFilterList?_c("el-popover",{attrs:{value:!0,visibleArrow:!1,popperClass:"add-filter-popover p0"}},[_c("outside-click",{staticClass:"tag-list-block z-index1234",attrs:{visibility:!0},on:{onOutsideClick:function($event){return _vm.close()}}},[_c("div",{staticClass:"tag-list-header"},[_c("el-input",{staticClass:"tag-list-search",attrs:{type:"text",placeholder:"Search...",autofocus:!0},model:{value:_vm.addFilter,callback:function($$v){_vm.addFilter=$$v},expression:"addFilter"}}),_vm._l(_vm.filterObjectsData,(function(filterObj,filterName){return[""===_vm.addFilter||filterObj.label.toLowerCase().startsWith(_vm.addFilter.toLowerCase())?_c("div",{key:filterName,attrs:{value:filterName}},[_c("div",{staticClass:"label-txt-black2 pT10 pB10 pL20 pR20 pointer fc-list-active-hover",on:{click:function($event){return $event.stopPropagation(),_vm.openFilterCondition(filterName)}}},[_vm._v(" "+_vm._s(filterObj.label)+" ")])]):_vm._e()]}))],2)])],1):_vm._e(),_vm.showFilterCondition?_c("filter-condition",{attrs:{fieldName:_vm.fieldName,isTag:!0,popClass:"popover-position"},on:{back:function($event){return _vm.backCondition()},close:function($event){_vm.showFilterCondition=!1}}}):_vm._e()],1)]),_c("div",{staticClass:"mL-auto mT20 mR20 d-flex"},[_vm.disableActions||!_vm.canShowOptions&&!_vm.showOptions?_vm._e():_c("div",{staticClass:"d-flex align-center"},[_vm.disableSaveFilters?_vm._e():[_vm.viewDetail.isDefault?_c("el-button",{staticClass:"saveas-btn",on:{click:function($event){return _vm.savingView("Save As")}}},[_vm._v(_vm._s(_vm.$t("common._common.save_filters")))]):_c("el-dropdown",{on:{command:_vm.savingView}},[_c("el-button",{staticClass:"saveas-btn",attrs:{type:"primary"}},[_vm._v(" "+_vm._s(_vm.$t("common._common.save_filters"))+" "),_c("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),_c("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[_c("el-dropdown-item",{attrs:{command:"Save"}},[_vm._v(_vm._s(_vm.$t("common._common._save")))]),_c("el-dropdown-item",{attrs:{command:"Save As"}},[_vm._v(_vm._s(_vm.$t("common._common.save_as")))])],1)],1)],_c("div",{staticClass:"clear-filter",on:{click:function($event){return _vm.resetFilters()}}},[_vm._v(" "+_vm._s(_vm.$t("common._common.clear_all_filters"))+" ")])],2)])])},staticRenderFns=[],defineProperty=__webpack_require__(482482),objectSpread2=__webpack_require__(595082),vuex_esm=(__webpack_require__(564043),__webpack_require__(61514),__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(434284),__webpack_require__(169358),__webpack_require__(648324),__webpack_require__(425728),__webpack_require__(976801),__webpack_require__(212826),__webpack_require__(857267),__webpack_require__(879288),__webpack_require__(634338),__webpack_require__(843843),__webpack_require__(339772),__webpack_require__(162506),__webpack_require__(420629)),validation=__webpack_require__(990260),FilterCondition=__webpack_require__(930871),OutsideClick=__webpack_require__(21864),SearchTagMixin=__webpack_require__(200689),cloneDeep=__webpack_require__(150361),cloneDeep_default=__webpack_require__.n(cloneDeep),SPECIAL_OPS={88:"is"},Tagsvue_type_script_lang_js={name:"Tags",props:["filter","disableFilterAdd","disableCloseIcon","disableActions","showOptions","disableSaveFilters"],components:{FilterCondition:FilterCondition/* default */.Z,OutsideClick:OutsideClick/* default */.Z},mixins:[SearchTagMixin/* default */.Z],data:function(){return{fieldName:null,showFilterList:!1,addFilter:"",showFilterCondition:!1,canShowOptions:!1}},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({config:function(state){return state.search.configData},viewDetail:function(state){return state.view.currentViewDetail}})),{},{isAssetsCategory:function(){var _this$config$moduleNa=this.config.moduleName,moduleName=void 0===_this$config$moduleNa?"":_this$config$moduleNa;return"asset"===moduleName},filterForTag:function(){return this.filter?this.filter:this.appliedFilters},fieldLabelMap:function(){var _this=this,fieldmap={},metaFields=this.$getProperty(this.metaInfo,"fields",null);if((0,validation/* isEmpty */.xb)(metaFields)||metaFields.forEach((function(field){fieldmap[field.name]=field.displayName})),this.filterObjectsData){var fieldName=Object.keys(this.filterObjectsData);fieldName.forEach((function(field){var filterField=_this.$getProperty(_this.filterObjectsData,field,{});(0,validation/* isEmpty */.xb)(filterField.key)?fieldmap[field]=filterField.label:fieldmap[filterField.key]=filterField.label}))}return fieldmap},operatorMap:function(){var _this2=this,opMap=(0,objectSpread2/* default */.Z)({},SPECIAL_OPS),metaOperators=this.$getProperty(this.metaInfo,"operators",null);if(!(0,validation/* isEmpty */.xb)(metaOperators)){var operators=Object.keys(metaOperators);operators.forEach((function(operator){var metaOp=_this2.$getProperty(metaOperators,operator,{})||{},opKeys=Object.keys(metaOp);opKeys.forEach((function(key){var operatorObj=_this2.$getProperty(metaOp,key,{});opMap[operatorObj.operatorId]=operatorObj.operator}))}))}return opMap}}),watch:{appliedFilters:{handler:function(value,oldValue){(0,validation/* isEmpty */.xb)(value)?this.canShowOptions=!1:this.canShowOptions=!0,JSON.stringify(value)!==JSON.stringify(oldValue)&&(this.setFilterApplied(),this.resetFilterData())},immediate:!0},showFilterList:function(value){value&&this.setFilterApplied()}},methods:{getValue:function(field,fieldObj,fieldId){var metaFields=this.$getProperty(this.metaInfo,"fields",null);if((0,validation/* isEmpty */.xb)(metaFields))return"";var filterField=metaFields.find((function(fld){return fld.name===field}));field=this.getFilterKey(field);var fieldVal=this.$getProperty(fieldObj,"value",[]),filterFieldName=this.$getProperty(filterField,"dataTypeEnum._name",""),filterFieldType=this.$getProperty(this.filterObjectsData[field],"displayType",""),filterOptions=this.$getProperty(this.filterObjectsData[field],"options",{});return fieldId&&(0,validation/* isEmpty */.xb)(fieldVal)?"":88===fieldObj.operatorId||"LOOKUP"===filterFieldName&&"lookup"===filterFieldType?(0,validation/* isArray */.kJ)(fieldObj)?fieldObj[0].selectedLabel:fieldObj.selectedLabel:"STRING"===filterFieldName||"string"===filterFieldType?fieldVal[0]:["NUMBER","DECIMAL","ID"].includes(filterFieldName)&&!["siteId","frequency"].includes(field)?fieldVal[0].toString():fieldId?filterOptions[fieldId]:filterOptions[fieldVal[0]]},getFilterKey:function(field){var metaName=this.$getProperty(this.metaInfo,"name",""),fieldMap={preventivemaintenance:{type:"ticketType",typeId:"ticketType",categoryId:"category",assignedToId:"assignedTo",priorityId:"priority",tenantId:"tenant"},workorder:{type:"ticketType",typeId:"ticketType"},isAssetsCategory:{category:"assetCategory",type:"assetType"},department:"assetDepartment",alarmSeverityId:"severity",assetCategoryId:"assetCategoryId"};return["preventivemaintenance","workorder"].includes(metaName)&&this.hasFieldInMap(field,fieldMap[metaName])?field=fieldMap[metaName][field]:this.isAssetsCategory&&this.hasFieldInMap(field,fieldMap["isAssetsCategory"])?field=fieldMap["isAssetsCategory"][field]:this.hasFieldInMap(field,fieldMap)&&(field=fieldMap[field]),field},hasFieldInMap:function(field,fieldMap){return this.$getProperty(fieldMap,field,null)},checkForDateTimeField:function(field,fieldObject){var fieldObj=(0,validation/* isArray */.kJ)(fieldObject)?fieldObject[0]:fieldObject,metaFields=this.$getProperty(this.metaInfo,"fields",null);if(!(0,validation/* isEmpty */.xb)(metaFields)){var dateField=metaFields.find((function(fld){return fld.name===field}));if(!(0,validation/* isEmpty */.xb)(dateField)){var dateFieldName=this.$getProperty(dateField.dataTypeEnum,"_name","");if(["DATE","DATETIME","DATE_TIME"].includes(dateFieldName)){var dateVal=this.$getProperty(fieldObj,"value",[]);if((0,validation/* isEmpty */.xb)(dateVal))return this.fieldLabelMap[field]+" is "+this.operatorMap[fieldObj.operatorId];if(1===dateVal.length)return this.fieldLabelMap[field]+" is "+this.operatorMap[fieldObj.operatorId].replace(" N "," ".concat(dateVal[0]," "));if(dateVal.length>1)return this.fieldLabelMap[field]+" is "+this.formatDate(Number(dateVal[0]))+" - "+this.formatDate(Number(dateVal[1]))}}}},formatDate:function(value){return this.$options.filters.formatDate(Number(value),!0,!1)},resourceTag:function(resObj,value){var resObject=(0,validation/* isArray */.kJ)(resObj)?resObj[0]:resObj,resVal=this.$getProperty(resObject,"value",null);if((0,validation/* isEmpty */.xb)(resVal))return"".concat(this.fieldLabelMap[value]," ").concat(this.operatorMap[resObject.operatorId]);var spaceFields=["space","visitedSpace","resourceIdSpace"],assetFields=["resourceIdAsset"];if(["resource","resourceId"].includes(value))return resVal.length+(resVal.length>1?" Spaces/Assets Selected":" Space/Asset Selected");if(spaceFields.includes(value))return resVal.length+(resVal.length>1?" Spaces selected":" Space selected");if(assetFields.includes(value))return resVal.length+(resVal.length>1?" Assets selected":" Asset selected");var lookupField={},metaFields=this.$getProperty(this.metaInfo,"fields",[]);return metaFields&&(lookupField=metaFields.find((function(field){return field.name===value}))||{},resObject.selectedLabel&&"LOOKUP"===this.$getProperty(lookupField.dataTypeEnum,"_name",""))?lookupField.displayName+" is "+resObject.selectedLabel:void 0},resetFilters:function(){this.$store.dispatch("search/resetFilters"),this.$store.dispatch("search/toggleActiveStatus",!1)},handleClose:function(tag,id){var filter=cloneDeep_default()(this.appliedFilters);if(!(0,validation/* isEmpty */.xb)(id)&&this.dateTimeFields.includes(tag)){var filterObj=filter[tag],filterObjValue=filterObj.filter((function(item){return item["operatorId"]!==id}));filter[tag]=filterObjValue,(0,validation/* isEmpty */.xb)(filterObjValue)?this.deleteFilter(tag):this.appliedFilters[tag]=filter[tag]}else if((0,validation/* isEmpty */.xb)(id))this.deleteFilter(tag);else{var _filterObjValue=filter[tag].value,indexOfValue=_filterObjValue.findIndex((function(val){return val===id}));(0,validation/* isEmpty */.xb)(indexOfValue)||_filterObjValue.splice(indexOfValue,1),(0,validation/* isEmpty */.xb)(_filterObjValue)?this.deleteFilter(tag):this.appliedFilters[tag].value=_filterObjValue}(0,validation/* isEmpty */.xb)(this.appliedFilters)?this.$store.dispatch("search/resetFilters"):this.$store.dispatch("search/applyFilters",this.appliedFilters),this.resetFilterData()},deleteFilter:function(tag){var _this3=this;if(delete this.appliedFilters[tag],["subject","name","title","resource"].includes(tag)){var filterData=this.filterObjectsData[tag]||{};this.filterObjectsData=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},this.filterObjectsData),{},(0,defineProperty/* default */.Z)({},tag,(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},filterData),{},{value:""})))}else if("resourceId"===tag)Object.keys(this.filterObjectsData||{}).forEach((function(fieldName){var filterData=_this3.filterObjectsData[fieldName],key=filterData.key?filterData.key:fieldName;"resourceId"===key&&(_this3.filterObjectsData=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},_this3.filterObjectsData),{},(0,defineProperty/* default */.Z)({},key,(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},filterData),{},{value:[]}))))}));else{tag=this.getFilterKey(tag);var _filterData=this.filterObjectsData[tag]||{};this.filterObjectsData=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},this.filterObjectsData),{},(0,defineProperty/* default */.Z)({},tag,(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},_filterData),{},{value:[]})))}},savingView:function(command){"Save"===command?this.$store.dispatch("search/updateSaveExistingView",!0):"Save As"===command&&(this.$store.dispatch("search/updateViewDialogState",!0),this.$store.dispatch("search/updateNewViewFilter",!0))},openFilterCondition:function(fieldName){this.showFilterList=!1,this.showFilterCondition=!0,this.fieldName=fieldName;var filterObj=this.$getProperty(this.filterObjectsData,fieldName,null);this.setOperatorId(filterObj,fieldName)},backCondition:function(){this.showFilterCondition=!1,this.showFilterList=!0},close:function(){this.showFilterCondition||(this.showFilterList=!1)}}},components_Tagsvue_type_script_lang_js=Tagsvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_Tagsvue_type_script_lang_js,render,staticRenderFns,!1,null,"33f85a81",null)
/* harmony default export */,Tags=component.exports},
/***/629039:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return ViewHeader}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/newapp/components/ViewHeader.vue?vue&type=template&id=4fa3ae39&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("ul",{staticClass:"subheader-tabs pull-left",class:{"has-more-views":!_vm.$validation.isEmpty(_vm.filteredViews.more)&&!_vm.showCurrentViewOnly}},[_c("div",{staticClass:"flex-middle"},[_c("div",{staticClass:"fL fc-subheader-left d-flex"},[!_vm.canShowViewsSidePanel&&_vm.currentView?_c("inline-svg",{staticClass:"d-flex pointer hamburger-icon self-center",attrs:{src:"svgs/hamburger-menu",iconClass:"icon icon-sm"},nativeOn:{click:function($event){return _vm.openViewsSidePanel.apply(null,arguments)}}}):_vm._e(),_c("div",{staticClass:"pR15 pointer self-center"},[_vm.groupViews&&_vm.groupViews.length>1?_c("el-dropdown",{staticClass:"fc-dropdown-menu pL10",attrs:{trigger:"click"},on:{command:_vm.openGroup}},[_c("span",{staticClass:"el-dropdown-link"},[_vm._v(" "+_vm._s(_vm.currentGroup?_vm.currentGroup.displayName||_vm.currentGroup.name:"")+" "),_vm.showCurrentViewOnly?_vm._e():_c("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),_vm.groupViews&&!_vm.showCurrentViewOnly?_c("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},_vm._l(_vm.groupViews,(function(group,key){return _c("el-dropdown-item",{key:key,attrs:{command:group.name}},[_vm.$validation.isEmpty(group.views)?_vm._e():[_vm._v(" "+_vm._s(group.displayName||group.name)+" ")]],2)})),1):_vm._e()],1):_vm._e()],1),_vm.groupViews&&_vm.groupViews.length>1?_c("div",{staticClass:"fc-separator-lg mL10 mR10 self-center"}):_vm._e()],1),_vm._l(_vm.filteredViews.list,(function(item,index){return _c("li",{key:item.name+index,staticClass:"self-center",class:[_vm.currentView===item.name&&"active"],on:{click:function($event){return _vm.goToView(item,_vm.currentGroup)}}},[_c("a",[_vm._v(_vm._s(item.label))]),item.disable?_vm._e():_c("div",{staticClass:"sh-selection-bar"})])})),_vm.$validation.isEmpty(_vm.filteredViews.more)||_vm.showCurrentViewOnly?_vm._e():[_c("el-dropdown",{staticClass:"mL20 pointer more-views-dropdown",attrs:{trigger:"click"},on:{command:_vm.goToView}},[_c("span",{staticClass:"el-dropdown-link more-icon-container"},[_c("i",{staticClass:"el-icon-more"})]),_c("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[_vm._l(_vm.filteredViews.more,(function(item,index){return _c("el-dropdown-item",{key:item.name+index,attrs:{command:item}},[_vm._v(" "+_vm._s(item.label)+" ")])})),_vm.showRearrange?_c("el-dropdown-item",{staticClass:"rearrange-option",attrs:{command:{name:"rearrange-views"}}},[_vm._v(_vm._s(_vm.$t("setup.users_management.rearrange")))]):_vm._e()],2)],1)]],2),_c("ViewCustomization",{attrs:{visible:_vm.showReorderPanel,reload:!0,menu:_vm.currentViews,moduleName:_vm.moduleName||""},on:{"update:visible":function($event){_vm.showReorderPanel=$event},onchange:function($event){return _vm.loadViews()}}}),_c("NewView",{attrs:{pathPrefix:_vm.pathPrefix}})],1)},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),toConsumableArray=__webpack_require__(488478),objectSpread2=__webpack_require__(595082),ViewCustomization=(__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(425728),__webpack_require__(434284),__webpack_require__(450886),__webpack_require__(339772),__webpack_require__(689730),__webpack_require__(634338),__webpack_require__(538077),__webpack_require__(670560),__webpack_require__(478264)),NewViewvue_type_template_id_2b44488b_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("el-dialog",{staticStyle:{"z-index":"999999","overflow-y":"scroll !important"},attrs:{visible:_vm.showSaveDialog,"append-to-body":!0,fullscreen:!0,"custom-class":"fc-dialog-form fc-dialog-right setup-dialog55 setup-dialog save-dialog","before-close":_vm.closeDialog}},[_c("div",{staticClass:"wo-save-dialog"},[_vm.isNewView?_c("p",{staticClass:"setup-modal-title",staticStyle:{margin:"0"}},[_vm._v(" Save as New View ")]):_c("p",{staticClass:"setup-modal-title",staticStyle:{margin:"0"}},[_vm._v("Edit View")]),_c("el-row",[_vm.viewDetail&&!_vm.viewDetail.isDefault||_vm.isNewView?_c("el-col",{attrs:{span:13}},[_c("el-input",{attrs:{placeholder:"Name"},model:{value:_vm.newViewNames,callback:function($$v){_vm.newViewNames=$$v},expression:"newViewNames"}})],1):_c("el-col",{attrs:{span:13}},[_c("el-input",{attrs:{disabled:!_vm.$validation.isEmpty(_vm.newViewNames),placeholder:"Name"},model:{value:_vm.newViewNames,callback:function($$v){_vm.newViewNames=$$v},expression:"newViewNames"}})],1)],1),_c("el-row",[_c("div",{staticClass:"wo-save-subH"},[_vm._v("FOLDER NAME")]),_c("el-col",{attrs:{span:13}},[_c("el-select",{staticClass:"fc-input-full-border2 width100",attrs:{placeholder:"Select the group",filterable:""},model:{value:_vm.groupId,callback:function($$v){_vm.groupId=$$v},expression:"groupId"}},_vm._l(_vm.groupViewsList,(function(group,index){return _c("el-option",{key:index,attrs:{label:group.displayName,value:group.id}})})),1)],1)],1),_vm.configData.disableColumnCustomization?_vm._e():_c("div",[_c("div",{staticClass:"wo-save-subH"},[_vm._v("CUSTOMIZE COLUMNS")]),_c("div",{staticClass:"wo-save-greytxt"},[_vm._v(" Drag and drop columns that you wish to save in this view ")]),_c("div",{staticClass:"wo-rearrage-container"},[_c("div",{staticClass:"wo-rearrage-left wo-rearrange-box mR40"},[_c("p",{staticClass:"rearrange-box-header"},[_c("span",{staticClass:"rearrange-box-H"},[_vm._v("AVAILABLE COLUMNS")])]),_c("div",{staticClass:"rearrange-box-body"},[_vm.metaInfo?_c("div",[_c("draggable",{staticClass:"dragArea",attrs:{group:"people"},model:{value:_vm.allColumns,callback:function($$v){_vm.allColumns=$$v},expression:"allColumns"}},_vm._l(_vm.availableColumns,(function(element,index){return _c("div",{key:index,staticClass:"rearrange-el-block"},[_c("span",{staticClass:"rearrange-plus-icon",staticStyle:{cursor:"pointer"},on:{click:function($event){return _vm.addcolumn(element,index)}}},[_vm._v("+")]),_c("span",{staticClass:"rearrange-txt"},[_vm._v(_vm._s(element.label))]),_c("span",{staticStyle:{"text-align":"right",float:"right","margin-right":"4px","margin-top":"4px"}},[_c("img",{staticClass:"icon-right",staticStyle:{height:"16px"},attrs:{src:__webpack_require__(57197)}})])])})),0)],1):_vm._e()])]),_c("div",{staticClass:"wo-rearrage-right wo-rearrange-box"},[_c("p",{staticClass:"rearrange-box-header"},[_c("span",{staticClass:"rearrange-box-H"},[_vm._v("SELECTED COLUMNS")])]),_c("div",{staticClass:"rearrange-box-body"},[_vm.metaInfo?_c("div",[_vm._l(_vm.fixedSelectedCol,(function(col,index){return _c("div",{key:index,staticClass:"rearrange-el-block",staticStyle:{border:"solid 1px #f0f0f0"}},[_c("span",{staticClass:"rearrange-txt2",staticStyle:{opacity:"0.5"}},[_vm._v(_vm._s(col.label))])])})),_c("draggable",{staticClass:"dragArea",attrs:{group:"people"},model:{value:_vm.selectedColumns,callback:function($$v){_vm.selectedColumns=$$v},expression:"selectedColumns"}},_vm._l(_vm.selectedColumns,(function(element,index){return _c("div",{key:index,staticClass:"rearrange-el-block"},[_c("span",[_c("i",{staticClass:"el-icon-close rearrange-plus-icon3",staticStyle:{"font-size":"16px","font-weight":"600",cursor:"pointer"},on:{click:function($event){return _vm.removeColumn(element,index)}}})]),_c("span",{staticClass:"rearrange-txt2"},[_vm._v(_vm._s(element.label))]),_c("span",{staticStyle:{"text-align":"right",float:"right","margin-right":"4px","margin-top":"4px"}},[_c("img",{staticClass:"icon-right",staticStyle:{height:"16px"},attrs:{src:__webpack_require__(57197)}})])])})),0)],2):_vm._e()])])])]),_vm.$validation.isEmpty(_vm.viewFilters)&&null===_vm.appliedFilters?_vm._e():_c("div",{staticClass:"wo-save-subH"},[_vm._v(" FILTERS ")]),_vm.$validation.isEmpty(_vm.viewFilters)?_vm._e():_c("div",[_c("div",{staticClass:"fc-grey-text-input-label pB10"},[_vm._v(" Existing Filters ")]),_c("tag",{staticClass:"saveas-newtag",attrs:{filter:_vm.viewFilters,disableFilterAdd:!0,disableCloseIcon:!0,disableActions:!0}})],1),_vm.viewDetail&&_vm.viewDetail.isDefault&&!_vm.isNewView?_c("div"):_c("div",[_c("div",{staticClass:"fc-grey-text-input-label pB10 pT10"},[_vm._v("New Filters")]),_c("div",[_c("tag",{staticClass:"saveas-newtag",attrs:{disableActions:!0,showOptions:!0}})],1)]),_c("div",{staticClass:"wo-save-subH"},[_vm._v("SHARING PERMISSIONS")]),_c("el-row",{staticStyle:{margin:"0px"},attrs:{align:"middle",gutter:20}},[_c("el-col",{staticStyle:{"padding-right":"35px","padding-left":"0px"},attrs:{span:24}},[_c("div",{staticClass:"add"},[_c("el-radio",{staticClass:"newradio",attrs:{label:1},model:{value:_vm.shareTo,callback:function($$v){_vm.shareTo=$$v},expression:"shareTo"}},[_vm._v("Only Me")]),_c("el-radio",{staticClass:"newradio",attrs:{label:2},model:{value:_vm.shareTo,callback:function($$v){_vm.shareTo=$$v},expression:"shareTo"}},[_vm._v("Everyone")]),_c("el-radio",{staticClass:"newradio",attrs:{label:3},model:{value:_vm.shareTo,callback:function($$v){_vm.shareTo=$$v},expression:"shareTo"}},[_vm._v("Specific")])],1)])],1),3===_vm.shareTo?_c("el-row",{staticClass:"mT30 el-select-block"},[_c("el-col",{attrs:{span:24}},[_c("label",{staticClass:"sharing-label"},[_vm._v("Team")]),_c("el-select",{staticClass:"width60",attrs:{filterable:"",multiple:"","collapse-tags":"",placeholder:_vm.$t("common.wo_report.choose_users")},model:{value:_vm.sharedGroups,callback:function($$v){_vm.sharedGroups=$$v},expression:"sharedGroups"}},_vm._l(_vm.groups,(function(group){return _c("el-option",{key:group.id,attrs:{label:group.name,value:group.id}})})),1)],1)],1):_vm._e(),3===_vm.shareTo?_c("el-row",{staticClass:"mT30 el-select-block"},[_c("el-col",{attrs:{span:24}},[_c("label",{staticClass:"sharing-label"},[_vm._v("Role")]),_c("el-select",{staticClass:"width60",attrs:{filterable:"",multiple:"","collapse-tags":"",placeholder:_vm.$t("common.wo_report.choose_roles")},model:{value:_vm.sharedRoles,callback:function($$v){_vm.sharedRoles=$$v},expression:"sharedRoles"}},_vm._l(_vm.roles,(function(role){return _c("el-option",{key:role.id,attrs:{label:role.name,value:role.id}})})),1)],1)],1):_vm._e(),3===_vm.shareTo?_c("el-row",{staticClass:"mT30 el-select-block"},[_c("el-col",{attrs:{span:24}},[_c("label",{staticClass:"sharing-label"},[_vm._v("Staff")]),_c("el-select",{staticClass:"width60",attrs:{filterable:"",multiple:"","collapse-tags":"",placeholder:_vm.$t("common.wo_report.choose_teams")},model:{value:_vm.sharedUsers,callback:function($$v){_vm.sharedUsers=$$v},expression:"sharedUsers"}},_vm._l(_vm.users,(function(user){return _c("el-option",{key:user.id,attrs:{label:user.name,value:user.id}})})),1)],1)],1):_vm._e()],1),_c("span",{staticClass:"dialog-footer modal-footer-fixed",attrs:{slot:"footer"},slot:"footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){return _vm.closeDialog()}}},[_vm._v("Cancel")]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:function($event){return _vm.saveView()}}},[_vm._v("Save")])],1)])],1)},NewViewvue_type_template_id_2b44488b_staticRenderFns=[],vuex_esm=(__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(564043),__webpack_require__(61514),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(162506),__webpack_require__(648324),__webpack_require__(169358),__webpack_require__(420629)),ViewMixin=__webpack_require__(453877),validation=__webpack_require__(990260),vuedraggable_umd=__webpack_require__(909980),vuedraggable_umd_default=__webpack_require__.n(vuedraggable_umd),Tags=__webpack_require__(482912),SearchTagMixin=__webpack_require__(200689),cloneDeep=__webpack_require__(150361),cloneDeep_default=__webpack_require__.n(cloneDeep),utility_methods=__webpack_require__(773258),NewViewvue_type_script_lang_js={name:"SaveAsNewView",mixins:[ViewMixin/* default */.Z,SearchTagMixin/* default */.Z],components:{draggable:vuedraggable_umd_default(),Tag:Tags/* default */.Z},data:function(){return{allColumns:[],selectedColumns:[],configData:{},availableColumns:[],newViewNames:"",shareTo:2,sharedGroups:[],sharedUsers:[],sharedRoles:[],viewSharing:[],groupId:null}},created:function(){this.configData=this.getFilterConfig||{},Promise.all([this.$store.dispatch("loadRoles"),this.$store.dispatch("loadGroups")]),this.init()},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({users:function(state){return state.users},groups:function(state){return state.groups},viewDetail:function(state){return state.view.currentViewDetail},userDetails:function(state){return state.account.user},roles:function(state){return state.roles},showSaveDialog:function(state){return state.search.openViewDialog},view:function(state){return state.search.viewToEdit},isNewView:function(state){return state.search.newView},saveWithExistingViewFilter:function(state){return state.search.saveWithExistingViewFilter}})),(0,vuex_esm/* mapGetters */.Se)("search",["getFilterConfig"])),(0,vuex_esm/* mapGetters */.Se)("view",["getViewsFolderList"])),{},{groupViewsList:function(){var getViewsFolderList=this.getViewsFolderList;return(0,utility_methods/* deepCloneObject */.kh)(getViewsFolderList())},allFields:function(){var list=[],_this$configData=this.configData,configData=void 0===_this$configData?{}:_this$configData,_this$metaInfo=this.metaInfo,metaInfo=void 0===_this$metaInfo?{}:_this$metaInfo,$getProperty=this.$getProperty;return $getProperty(metaInfo,"fields")&&!(0,validation/* isEmpty */.xb)(configData)&&(list=(metaInfo.fields||[]).filter((function(field){var _ref=configData||{},_ref$availableColumns=_ref.availableColumns,availableColumns=void 0===_ref$availableColumns?[]:_ref$availableColumns,_ref$fixedCols=_ref.fixedCols,fixedCols=void 0===_ref$fixedCols?[]:_ref$fixedCols;return(availableColumns||availableColumns.includes(field.name)||!field.default)&&(!fixedCols||!fixedCols.includes(field.name))})).map((function(field){return{id:field.id,label:field.columnDisplayName||field.displayName,key:field.name||""}}))),list},fixedSelectedCol:function(){var _this=this;return this.configData.fixedCols&&this.metaInfo.fields?this.metaInfo.fields.filter((function(field){return _this.configData.fixedCols.includes(field.name)})).map((function(field){return{id:field.id,label:field.columnDisplayName||field.displayName}})):[]},includeParentFilter:function(){return this.$route.query.includeParentFilter&&("true"===this.$route.query.includeParentFilter||!0===this.$route.query.includeParentFilter)},currentView:function(){return this.$route.params.viewname?this.$route.params.viewname:null},viewFilters:function(){return this.viewDetail?this.viewDetail.filters:null}}),watch:{allFields:{handler:function(val){this.allColumns=val?cloneDeep_default()(val):[],this.checkColumns()},deep:!0},viewColumns:function(){this.availableColumns=[],this.selectedColumns=[],this.checkColumns()},shareTo:function(val){3===val&&this.sharedUsers.push(this.userDetails.id)},view:{handler:function(value){(0,validation/* isEmpty */.xb)(value)||this.edit(value)},immediate:!0},viewFilters:function(){this.resetFilterData(),this.init()},saveWithExistingViewFilter:{handler:function(value){value&&this.confirmationEditViews()},immediate:!0},showSaveDialog:function(){this.resetValues(),this.configData=this.getFilterConfig,this.init()}},methods:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapActions */.nv)({saveNewView:"view/saveNewView",editView:"view/editView"})),{},{edit:function(view){var _this2=this;((0,validation/* isEmpty */.xb)(view.moduleName)||["newreadingalarm"].includes(view.moduleName))&&(view.moduleName=this.configData.moduleName);var moduleName=view.moduleName;this.$store.dispatch("view/loadModuleMeta",moduleName).then((function(){_this2.$router.push(view.name),_this2.selectedColumns=[];var url="/view/"+view.name+"?moduleName="+moduleName;_this2.$http.get(url).then((function(_ref2){var data=_ref2.data;_this2.newViewNames=data.displayName;var viewSharing=data.viewSharing;if((0,validation/* isEmpty */.xb)(viewSharing))_this2.shareTo=2;else{viewSharing=viewSharing.filter((function(viewSharingContext){return"APP"!=viewSharingContext.typeEnum}));var sharingTypeLength=viewSharing.length;sharingTypeLength>1?_this2.shareTo=3:1===sharingTypeLength&&viewSharing[0].userId===_this2.$account.user.ouid?_this2.shareTo=1:_this2.shareTo=2}if(3===_this2.shareTo)for(var i=0;i<viewSharing.length;i++)(0,validation/* isEmpty */.xb)(viewSharing[i].typeEnum)||("USER"===viewSharing[i].typeEnum?_this2.sharedUsers.push(viewSharing[i].userId):"ROLE"===viewSharing[i].typeEnum?_this2.sharedRoles.push(viewSharing[i].roleId):"GROUP"===viewSharing[i].typeEnum&&_this2.sharedGroups.push(viewSharing[i].groupId));data.fields&&data.fields.forEach((function(field){var fieldObj={id:_this2.$getProperty(field.field,"fieldId",field.fieldId),label:_this2.$getProperty(field.field,"displayName",field.columnDisplayName)};(0,validation/* isEmpty */.xb)(field.field)&&(fieldObj.fieldName=field.fieldName),_this2.selectedColumns.push(fieldObj)})),_this2.$router.push(data.name),_this2.$store.dispatch("search/updateViewDialogState",!0)}))})).catch((function(){})),this.$store.dispatch("search/updateViewToEdit",null)},closeDialog:function(){this.$store.dispatch("search/updateViewDialogState",!1)},addcolumn:function(element,index){this.selectedColumns.push(element),this.availableColumns.splice(index,1)},removeColumn:function(element,index){this.availableColumns.push(element),this.selectedColumns.splice(index,1)},saveView:function(){this.isNewView?this.saveAsNewView():this.editViews()},saveAsNewView:function(){var _this3=this,groupId=this.groupId;if(this.validateViewData()){this.applySharing();var data=this.constructViewData();data.view=Object.assign(data.view,{includeParentCriteria:!0,filtersJson:JSON.stringify(this.appliedFilters),groupId:groupId}),this.saveNewView(data).then((function(data){_this3.closeDialog(),_this3.resetValues(),_this3.$router.push({path:_this3.configData.path+data.name,query:{}}),_this3.$store.dispatch("view/loadGroupViews",{moduleName:_this3.configData.moduleName}),_this3.$message({message:"View created successfully!",type:"success"})})).catch((function(){_this3.$message({message:"View creation failed!",type:"error"})}))}},editViews:function(){var groupId=this.groupId;if(this.validateViewData()){this.applySharing();var data=this.constructViewData();data.view=Object.assign(data.view,{id:this.viewDetail.id,name:this.viewDetail.name,groupId:groupId}),this.saveFiltersInExistingView(data)}},validateViewData:function(){var groupId=this.groupId;if(!this.newViewNames)return this.$message({message:"Please name this view",type:"error"}),!1;if((0,validation/* isEmpty */.xb)(groupId))return this.$message({message:"Please select a folder",type:"error"}),!1;var isNewView=this.isNewView,configData=this.configData,selectedColumns=this.selectedColumns;if(isNewView){if(!configData.disableColumnCustomization&&(0,validation/* isEmpty */.xb)(selectedColumns))return this.$message({message:"Please select atleast one customize column",type:"error"}),!1}else if((0,validation/* isEmpty */.xb)(selectedColumns))return this.$message({message:"Please select atleast one customize column",type:"error"}),!1;return!0},constructViewData:function(){var fields=null;if(!this.configData.disableColumnCustomization){var columns=[].concat((0,toConsumableArray/* default */.Z)(this.fixedSelectedCol),(0,toConsumableArray/* default */.Z)(this.selectedColumns));fields=columns.map((function(col){return{fieldId:col.id,columnDisplayName:col.label,fieldName:col.key||""}}))}var data={moduleName:this.configData.moduleName,view:{displayName:this.newViewNames,fields:fields,viewSharing:this.viewSharing},parentView:this.currentView};return data},applySharing:function(){var _this4=this,currentUser=this.$account.user.ouid;this.viewSharing=[],1===this.shareTo?this.viewSharing.push({type:1,userId:currentUser}):3===this.shareTo&&((0,validation/* isEmpty */.xb)(this.sharedUsers)||(this.viewSharing.push({type:1,userId:currentUser}),this.sharedUsers.forEach((function(user){user!==currentUser&&_this4.viewSharing.push({type:1,userId:user})}))),(0,validation/* isEmpty */.xb)(this.sharedRoles)||this.sharedRoles.forEach((function(role){_this4.viewSharing.push({type:2,roleId:role})})),(0,validation/* isEmpty */.xb)(this.sharedGroups)||this.sharedGroups.forEach((function(group){_this4.viewSharing.push({type:3,groupId:group})})))},setFieldValue:function(filterVal,field,fieldKey){filterVal&&(["assignmentGroup","assignedTo"].includes(fieldKey)?(filterVal="assignmentGroup"===fieldKey?filterVal.filter((function(id){return"-100"!==id})).map((function(id){return id+"_group"})):filterVal,field.value&&!field.single?field.value=[].concat((0,toConsumableArray/* default */.Z)(field.value),(0,toConsumableArray/* default */.Z)(filterVal)):field.value=filterVal):field.value=filterVal)},confirmationEditViews:function(){var _this5=this;this.$dialog.confirm({title:"Edit View",message:"Are you sure you want to EDIT the view?",rbDanger:!0,rbLabel:"Edit"}).then((function(value){value&&_this5.saveFiltersInExistingView(),_this5.$store.dispatch("search/updateSaveExistingView",!1)}))},saveFiltersInExistingView:function(data){var _this6=this;(0,validation/* isEmpty */.xb)(data)&&(data={moduleName:this.configData.moduleName,view:{name:this.viewDetail.name,id:this.viewDetail.id}});var finalFilteredJsonWithParentFilters={};finalFilteredJsonWithParentFilters=this.viewFilters?(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},this.viewFilters),this.appliedFilters):this.appliedFilters,data.view.filtersJson=JSON.stringify(finalFilteredJsonWithParentFilters),this.editView(data).then((function(data){_this6.closeDialog(),_this6.resetValues(),_this6.$router.push({path:_this6.configData.path+data.view.name,query:{}}),_this6.$message.success("View Edited successfully!")})).catch((function(error){_this6.$message.error(error.message)}))},resetValues:function(){this.allColumns=cloneDeep_default()(this.allFields),this.selectedColumns=[],this.newViewNames="",this.sharedGroups=[],this.sharedUsers=[],this.sharedRoles=[],this.viewSharing=[]},getLookupValue:function(field,filter,fieldName){var _this7=this,name=Object.keys(filter.value)[0],lookupFilter=filter.value[name],operatorId=lookupFilter.operatorId,valuesToCheck=lookupFilter.value,optionsToSelect=[],filterObj=this.$getProperty(this.filterObjectsData,fieldName,{}),idsArr=Object.keys(this.$getProperty(filterObj,"options",{}));
// TODO needs to check more operators and support multiple lookups
// TODO needs to get operatorid from metainfo
// All the option values for the field
return"typeCode"===name&&"status"===fieldName&&(valuesToCheck=["Closed"],"1"===lookupFilter.value[0]&&(operatorId=4)),idsArr.forEach((function(id){
// TODO check more operator ids
valuesToCheck.includes(_this7.filterObjectsData[fieldName].options[id])?4!==operatorId&&optionsToSelect.push(id):4===operatorId&&optionsToSelect.push(id)})),optionsToSelect},getValuesFromFilter:function(field,filter,fieldName){var value;
// TODO temporary...needs to improve
if(35===filter.operatorId)value=this.getLookupValue(field,filter,fieldName);else if(15===filter.operatorId||15===field.operatorId)value=filter.value&&"true"===filter.value[0]?"true":"false";else if(field.customdate&&(0,validation/* isEmpty */.xb)(filter.value)&&field.options[filter.operatorId])value=field.single?filter.operatorId+"":[filter.operatorId+""];else if(filter.value)if("date"===field.type&&20===filter.operatorId)value="20",field.dateRange=filter.value;else if([39,40,41,50,59,60,61].includes(filter.operatorId))value=filter.value[0]+"_"+filter.operatorId,value=field.single?value:[value];else if(10===filter.operatorId||10===field.operatorId){var options=this.filterObjectsData[fieldName].options,idsArr=Object.keys(options);value=[],idsArr.forEach((function(id){filter.value.includes(id)||value.push(id)}))}else value=field.single?filter.value[0]:filter.value;return value},init:function(){var _this8=this,filters=cloneDeep_default()(this.viewFilters)||{},fieldKeyMap={};for(var fieldName in this.filterObjectsData){var key=this.$getProperty(this.filterObjectsData[fieldName],"key",null);key&&(fieldKeyMap[fieldName]=key)}var _loop=function(fieldKey){var field,filterVal,filter=filters[fieldKey],fieldName="assignmentGroup"===fieldKey?"assignedTo":fieldKey,isResourceField=!1;if(["resource","resourceId"].includes(fieldName))field=_this8.filterObjectsData.space||_this8.filterObjectsData.asset?{parent:"resource"}:null,isResourceField=!0;else{var _this8$filterObjectsD=_this8.filterObjectsData,filterObjectsData=void 0===_this8$filterObjectsD?{}:_this8$filterObjectsD,$getProperty=_this8.$getProperty;field=$getProperty(filterObjectsData,fieldName),field||(field=$getProperty(fieldKeyMap,fieldName)?$getProperty(filterObjectsData,$getProperty(fieldKeyMap,fieldName)):null)}field&&((0,validation/* isArray */.kJ)(filter)?(filterVal=[],filter.forEach((function(fval){isResourceField&&(filterVal=[],field=38===fval.operatorId?_this8.filterObjectsData.space:_this8.filterObjectsData.asset);var val=_this8.getValuesFromFilter(field,fval,fieldKeyMap[fieldName]||fieldName);(0,validation/* isArray */.kJ)(val)?filterVal=[].concat((0,toConsumableArray/* default */.Z)(filterVal),(0,toConsumableArray/* default */.Z)(val)):15===field.operatorId?filterVal=val:filterVal.push(val),isResourceField&&_this8.setFieldValue(filterVal,field,fieldKey)}))):(isResourceField&&(field=38===filter.operatorId?_this8.filterObjectsData.space:_this8.filterObjectsData.asset),filterVal=_this8.getValuesFromFilter(field,filter,fieldKeyMap[fieldName]||fieldName)),(0,validation/* isArray */.kJ)(filter)&&isResourceField||_this8.setFieldValue(filterVal,field,fieldKey))};for(var fieldKey in filters)_loop(fieldKey)},checkColumns:function(){var _this9=this,nonSelectableColumns=["assignmentGroup","asset","week","hour","month","day","localId","photoId","space","hideToCustomer","parentAssetId","moduleState","stateFlowId","id"];this.selectedColumns=[],this.allColumns.forEach((function(column){var isColumnSelected=!1;_this9.viewColumns.forEach((function(viewColumn){column.label===viewColumn.displayName&&(_this9.selectedColumns.push(column),isColumnSelected=!0)})),isColumnSelected||nonSelectableColumns.includes(column.key)||_this9.availableColumns.push(column)}))}})},components_NewViewvue_type_script_lang_js=NewViewvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_NewViewvue_type_script_lang_js,NewViewvue_type_template_id_2b44488b_render,NewViewvue_type_template_id_2b44488b_staticRenderFns,!1,null,null,null)
/* harmony default export */,NewView=component.exports,router=__webpack_require__(329435),ViewHeadervue_type_script_lang_js={props:["moduleName","pathPrefix","showCurrentViewOnly","maxVisibleMenu","showRearrange","retainFilters","canShowViewsSidePanel"],components:{ViewCustomization:ViewCustomization/* default */.Z,NewView:NewView},created:function(){this.init()},data:function(){return{showReorderPanel:!1}},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({groupViews:function(state){return(0,validation/* isEmpty */.xb)(state.view.groupViews)?[]:state.view.groupViews}})),(0,vuex_esm/* mapState */.rn)("webtabs",{currentTabGroup:function(state){return state.selectedTabGroup},currentTab:function(state){return state.selectedTab}})),{},{currentView:function(){return this.$route.params.viewname?this.$route.params.viewname:null},currentViews:function(){var groupViews=this.groupViews,currentView=this.currentView,selectedViews=[];return groupViews.forEach((function(group){var views=group.views,selectedView=(views||[]).find((function(v){return v.name===currentView}));selectedView&&(selectedViews=views)})),selectedViews.map((function(view){return{label:view.displayName,id:view.id,name:view.name,isCustom:!view.isDefault,primary:view.primary}}))},currentGroup:function(){var _this=this,groupViews=this.groupViews,selectedGroup=(groupViews||[]).find((function(group){var views=group.views,selectedView=(views||[]).find((function(v){return v.name===_this.currentView}));return!(0,validation/* isEmpty */.xb)(selectedView)}));return selectedGroup},maxMenuLength:function(){return this.maxVisibleMenu||3},filteredViews:function(){var list=[],more=null,showCurrentViewOnly=this.showCurrentViewOnly,currentViews=this.currentViews,currentView=this.currentView,maxLength=this.maxMenuLength,currentViewPosition=currentViews.findIndex((function(v){return v.name===currentView}));return showCurrentViewOnly?list=[currentViews[currentViewPosition]]:currentViews.length-1<maxLength?list=currentViews:currentViewPosition<maxLength?(list=currentViews.slice(0,maxLength),more=currentViews.slice(maxLength)):(list=[].concat((0,toConsumableArray/* default */.Z)(currentViews.slice(0,maxLength-1)),[currentViews[currentViewPosition]]),more=currentViews.slice(maxLength-1).filter((function(v){return v.name!==currentView}))),{list:list,more:more}}}),watch:{moduleName:function(newVal,oldVal){newVal!==oldVal&&this.init()},currentView:{handler:function(newVal,oldVal){(0,validation/* isEmpty */.xb)(newVal,oldVal)?newVal!==oldVal&&(0,validation/* isEmpty */.xb)(newVal)&&this.initializeViews():this.loadViewDetails()},immediate:!0}},methods:{init:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.next=2,_this2.$store.dispatch("view/clearViews");case 2:return _context.next=4,_this2.loadViews();case 4:case"end":return _context.stop()}}),_callee)})))()},loadViews:function(){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var moduleName;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return moduleName=_this3.moduleName,_context2.next=3,_this3.$store.dispatch("view/loadGroupViews",{moduleName:moduleName});case 3:_this3.initializeViews();case 4:case"end":return _context2.stop()}}),_callee2)})))()},loadViewDetails:function(){var currentView=this.currentView,moduleName=this.moduleName,currentGroup=this.currentGroup,viewObj=this.$getProperty(currentGroup,"views",[]).find((function(v){return v.name===currentView}))||{},viewModuleName=this.$getProperty(viewObj,"moduleName",null);if(!(0,validation/* isEmpty */.xb)(currentView)&&(!(0,validation/* isEmpty */.xb)(moduleName)||!(0,validation/* isEmpty */.xb)(viewModuleName))){var param={viewName:currentView,moduleName:(0,validation/* isEmpty */.xb)(viewModuleName)?moduleName:viewModuleName};this.$store.dispatch("view/loadViewDetail",param).catch((function(){}))}},initializeViews:function(){var groupViews=this.groupViews,currentView=this.currentView,viewsList=(groupViews||[]).reduce((function(res,_ref){var views=_ref.views;return[].concat((0,toConsumableArray/* default */.Z)(res),(0,toConsumableArray/* default */.Z)(views||[]))}),[]),isCurrentViewNotAvailable=(0,validation/* isEmpty */.xb)((viewsList||[]).find((function(view){return view.name===currentView})));if(isCurrentViewNotAvailable){var firstGroup=groupViews&&groupViews[0],firstGroupWithViews=groupViews.find((function(group){return!(0,validation/* isEmpty */.xb)(group.views)})),_ref2=firstGroupWithViews||{},name=_ref2.name;firstGroup&&name?(this.$emit("hideViewSidebar",!1),this.openGroup(name)):this.$emit("hideViewSidebar",!0)}},goToView:function(view){var group=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!(0,validation/* isEmpty */.xb)(view)){var viewname=view.name;if("rearrange-views"===viewname)return void(this.showReorderPanel=!0);var currentTab=this.currentTab,_this$retainFilters=this.retainFilters,retainFilters=void 0===_this$retainFilters?[]:_this$retainFilters,query=this.$route.query,retainedQuery=retainFilters.reduce((function(filter,key){return filter[key]=query[key],filter}),{});if((0,router/* isWebTabsEnabled */.tj)()){var route=(0,router/* findRouteForTab */.OD)(currentTab.id,{pageType:router/* pageTypes */.As.LIST})||{};route&&this.$router.push((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},route),{},{params:{viewname:viewname},query:retainedQuery})).catch((function(error){}))}else{var path=this.getPathForView(view,group);this.$router.push({path:path,query:retainedQuery}).catch((function(){}))}}},openGroup:function(command){var view,group=(this.groupViews||[]).find((function(g){return g.name===command}));(0,validation/* isEmpty */.xb)(group)||(0,validation/* isEmpty */.xb)(group.views)||(view=group.views&&group.views[0],this.goToView(view,group))},openViewsSidePanel:function(){this.$emit("update:canShowViewsSidePanel",!0)},getPathForView:function(view){var pathPrefix=this.pathPrefix,prefix="/"===pathPrefix[pathPrefix.length-1]?pathPrefix.slice(0,-1):pathPrefix;return"".concat(prefix,"/").concat(view.name)}}},components_ViewHeadervue_type_script_lang_js=ViewHeadervue_type_script_lang_js,ViewHeader_component=(0,componentNormalizer/* default */.Z)(components_ViewHeadervue_type_script_lang_js,render,staticRenderFns,!1,null,"4fa3ae39",null)
/* harmony default export */,ViewHeader=ViewHeader_component.exports},
/***/409886:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return ViewsSidePanel}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/views/ViewsSidePanel.vue?vue&type=template&id=a8f1e2a8
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("transition",{attrs:{name:"fade"}},[_c("div",{staticClass:"view-panel"},[_c("div",{staticClass:"view-list-container"},[_c("div",{staticClass:"header-container"},[_c("div",{staticClass:"label-txt-black fwBold text-uppercase"},[_vm._v(" "+_vm._s(_vm.$t("common._common.views"))+" ")]),_vm.hideArrowIcon?_vm._e():_c("inline-svg",{staticClass:"rotate-90 pointer d-flex back-icon mL-auto",attrs:{src:"svgs/arrow",iconClass:"icon icon-xs"},nativeOn:{click:function($event){return _vm.closeViewSidePanel()}}})],1),_c("div",{staticClass:"search-container mT20 mb25"},[_c("el-input",{staticClass:"fc-input-full-border2",attrs:{placeholder:"Search",type:"search","prefix-icon":"el-icon-search"},model:{value:_vm.searchText,callback:function($$v){_vm.searchText=$$v},expression:"searchText"}})],1),_c("div",{staticClass:"views-group"},_vm._l(_vm.filteredList,(function(group){return _c("div",{key:group.id},[_vm.$validation.isEmpty(group.views)?_vm._e():[_vm.$validation.isEmpty(_vm.searchText)?_c("div",{staticClass:"folder-name pB10 mT20 text-uppercase"},[_vm._v(" "+_vm._s(group.displayName||group.name)+" ")]):_vm._e(),_vm._l(group.views,(function(view,index){return _c("div",{key:index,staticClass:"view-item pT10 pB15 pointer",class:_vm.isActiveView(view)?"active":"",on:{click:function($event){return _vm.changeView(view,group)}}},[_c("div",{staticClass:"view-name ellipsis"},[_vm._v(" "+_vm._s(view.displayName)+" ")])])}))]],2)})),0)]),_vm.isWebTabsEnabled?_c("div",{staticClass:"view-manager-btn",on:{click:_vm.loadViewManager}},[_c("inline-svg",{staticClass:"d-flex",attrs:{src:"svgs/hamburger-menu",iconClass:"icon icon-sm"}}),_c("span",{staticClass:"label mL10 text-uppercase"},[_vm._v(" "+_vm._s(_vm.$t("viewsmanager.list.views_manager"))+" ")])],1):_c("portal-target",{attrs:{name:"view-manager-link"}})],1)])},staticRenderFns=[],objectSpread2=__webpack_require__(595082),validation=(__webpack_require__(434284),__webpack_require__(260228),__webpack_require__(538077),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(670560),__webpack_require__(990260)),router=__webpack_require__(329435),vuex_esm=__webpack_require__(420629),ViewsSidePanelvue_type_script_lang_js={props:["groupViews","moduleName","canShowViewsSidePanel","hideArrowIcon"],data:function(){return{searchText:"",isWebTabsEnabled:(0,router/* isWebTabsEnabled */.tj)()}},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapGetters */.Se)({getCurrentViewDetail:"view/getCurrentViewDetail"})),{},{currentViewDetail:function(){return this.getCurrentViewDetail()},currentViewName:function(){var currentViewDetail=this.currentViewDetail,_ref=currentViewDetail||{},name=_ref.name;return name},filteredList:function(){var _this=this;return(0,validation/* isEmpty */.xb)(this.searchText)?this.groupViews:this.groupViews.reduce((function(res,group){var filteredViews=group.views.filter((function(view){return view.displayName.toLowerCase().includes(_this.searchText)}));return(0,validation/* isEmpty */.xb)(filteredViews)||res.push((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},group),{},{views:filteredViews})),res}),[])}}),methods:{isActiveView:function(view){var currentViewName=this.currentViewName,name=view.name;return currentViewName===name},changeView:function(view,group){this.$emit("onChange",view,group)},closeViewSidePanel:function(){this.$emit("update:canShowViewsSidePanel",!1)},loadViewManager:function(){var moduleName=this.moduleName,$route=this.$route,query=$route.query,route=(0,router/* findRouteForModule */.Jp)(moduleName,router/* pageTypes */.As.VIEW_MANAGER);route&&this.$router.push({name:route.name,query:query}).catch((function(){}))}}},views_ViewsSidePanelvue_type_script_lang_js=ViewsSidePanelvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(views_ViewsSidePanelvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,ViewsSidePanel=component.exports},
/***/57197:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"5e90307bf0660533e9223683666781aa.svg";
/***/}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/74481.js.map