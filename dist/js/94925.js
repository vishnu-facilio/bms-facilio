"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[94925],{
/***/746036:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FChartSettings}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/newcharts/components/FChartSettings.vue?vue&type=template&id=18cd30e5
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-popover",{attrs:{width:250,"popper-class":"chartsettings-container"}},[!1!==_vm.showChartMode?_c("div",{staticClass:"pL10 pB20"},[_c("div",{staticClass:"label-txt-black pb5"},[_vm._v("Mode")]),_c("div",{},[_c("el-radio-group",{staticClass:"fc-radio-btn chart-setting-group pT10",attrs:{disabled:_vm.disableChartMode},on:{change:_vm.onChartModeChange},model:{value:_vm.settings.chartMode,callback:function($$v){_vm.$set(_vm.settings,"chartMode",$$v)},expression:"settings.chartMode"}},[_c("el-radio",{attrs:{label:"single"}},[_vm._v("Single")]),_c("el-radio",{attrs:{label:"multi"}},[_vm._v("Multiple")])],1)],1)]):_vm._e(),!1!==_vm.showAlarm?_c("div",{staticClass:"pL10 pB20"},[_c("div",{staticClass:"label-txt-black pb5"},[_vm._v("Alarm")]),_c("div",[_c("el-radio-group",{staticClass:"chart-setting-group fc-radio-btn pT10",on:{change:function($event){return _vm.onSettingsChange("alarm")}},model:{value:_vm.settings.alarm,callback:function($$v){_vm.$set(_vm.settings,"alarm",$$v)},expression:"settings.alarm"}},[_c("el-radio",{attrs:{label:!0}},[_vm._v("Show")]),_c("el-radio",{attrs:{label:!1}},[_vm._v(_vm._s(_vm.$t("fields.properties.hideFieldTxt")))])],1)],1)]):_vm._e(),!1!==_vm.showTimePeriod?_c("div",{staticClass:"pL10 pB20"},[_c("div",{staticClass:"label-txt-black pb5"},[_vm._v("Time period")]),_c("div",[_c("el-radio-group",{staticClass:"chart-setting-group fc-radio-btn pT10",model:{value:_vm.settings.timeperiod,callback:function($$v){_vm.$set(_vm.settings,"timeperiod",$$v)},expression:"settings.timeperiod"}},[_c("el-radio",{attrs:{label:!0}},[_vm._v("Show")]),_c("el-radio",{attrs:{label:!1}},[_vm._v(_vm._s(_vm.$t("fields.properties.hideFieldTxt")))])],1)],1)]):_vm._e(),_c("div",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"mR30 chart-icon pointer flRight",attrs:{slot:"reference",title:"Report Settings","data-arrow":"true"},slot:"reference"},[_c("img",{staticClass:"chart-icon-new",attrs:{src:__webpack_require__(108277)}})])])},staticRenderFns=[],NewDataFormatHelper=(__webpack_require__(169358),__webpack_require__(162506),__webpack_require__(670560),__webpack_require__(804911)),FChartSettingsvue_type_script_lang_js={props:["dataPoints","settings","showChartMode","showAlarm","showChart","showTable","showSafelimit","disableChartMode","showTimePeriod"],data:function(){return{}},mixins:[NewDataFormatHelper/* default */.Z],methods:{onChartModeChange:function(){if("multi"===this.settings.chartMode){var unitCount=this.countUnits(this.dataPoints);Object.keys(unitCount).length>1?(this.settings.autoGroup=!0,this.autoGroupDataPoints(unitCount)):this.settings.autoGroup=!1}else this.settings.autoGroup=!1,this.autoGroupDataPoints()},onToggleChart:function(){this.settings.chart||(this.settings.table=!0)},onToggleTable:function(){this.settings.table||(this.settings.chart=!0)},autoGroupDataPoints:function(unitCount){if(this.settings.autoGroup)this.groupDataPoints(unitCount,this.dataPoints);else
// remove groups enabled by autogrouping
for(var groupIndex=(null===(_this$dataPoints=this.dataPoints)||void 0===_this$dataPoints?void 0:_this$dataPoints.length)-1;groupIndex>=0;groupIndex--){var _this$dataPoints;if("group"===this.dataPoints[groupIndex].type&&(!this.dataPoints[groupIndex].unit||!this.dataPoints[groupIndex].dataType))for(var group=this.dataPoints.splice(groupIndex,1),children=group[0].children,childIndex=children.length-1;childIndex>=0;childIndex--){var removedChild=children.splice(childIndex,1);this.dataPoints.push(removedChild[0])}}},groupDataPoints:function(unitCount,dataPoints){this.dataPoints=this.groupPoints(unitCount,dataPoints)},onSettingsChange:function(option){this.$emit("onSettingsChange",option)}}},components_FChartSettingsvue_type_script_lang_js=FChartSettingsvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FChartSettingsvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FChartSettings=component.exports},
/***/875963:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FNewChart}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/newcharts/components/FNewChart.vue?vue&type=template&id=8078524e
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"height100 f-singlechart"},[_vm.hidecharttypechanger?_vm._e():_c("f-chart-type",{staticClass:"charttypechanger fc-new-chart-type-single top-minus-86",attrs:{options:_vm.options},on:{getOptions:_vm.getOptionsFromTypeChart}}),_vm.chartContext&&!1!==_vm.options.settings.chart?_c("div",{staticStyle:{"text-align":"center"}},[_c("div",{style:_vm.isWidget?"position: relative; top: 15px;":""},[_vm.showAlarms&&_vm.showAlarmTitle?_c("div",{staticClass:"fc-alarms-chart-title",style:"sensorrollupalarm"===_vm.moduleName?"color: #324056 !important;font-weight: bold;":""},[_vm._v(" Alarms ")]):_vm._e(),_c("div",{ref:"alarmsChartEle",staticClass:"fc-alarms-chart pdf-chart"})]),_vm.relatedAlarms?_c("div",[_vm._l(_vm.relatedAlarms,(function(relAlarm,idx){return[_c("div",{key:idx,style:_vm.isWidget?"position: relative; top: 15px;":""},[_c("div",{staticClass:"fc-alarms-chart-title",staticStyle:{"text-transform":"capitalize",color:"#324056 !important"}},[_vm._v(" "+_vm._s(relAlarm?relAlarm.alarmTitle:"")+" ")]),_c("div",{ref:"relatedAlarmsChartEle",refInFor:!0,staticClass:"fc-alarms-chart pdf-chart"})])]}))],2):_vm._e(),_vm.chartContext.options.legend.show&&"top"===_vm.chartContext.options.legend.position?_c("f-chart-legends",{ref:"chartLegend",attrs:{chart:_vm.c3.chart,options:_vm.options,resultObj:_vm.resultObj,xValueMode:_vm.chartContext.xValueMode,xLabelMap:_vm.chartContext.xLabelMap,config:_vm.config,isScatterPlot:_vm.chartContext&&_vm.chartContext.scatterConfig},on:{ontoggle:_vm.ontoggle}}):_vm._e(),_vm.chartContext.options.regionConfig?_c("f-chart-title",{ref:"chartTitle",attrs:{chart:_vm.c3.chart,options:_vm.options,xValueMode:_vm.chartContext.xValueMode,xLabelMap:_vm.chartContext.xLabelMap,config:_vm.config,chartContext:_vm.chartContext},on:{ontoggle:_vm.ontoggle}}):_vm._e(),_vm.drilldownParams?_c("drilldown-breadcrumb",{attrs:{drilldownParams:_vm.drilldownParams},on:{crumbClick:function($event){return _vm.$emit("crumbClick",$event)}}}):_vm._e(),_c("div",{staticClass:"fc-newchart-container",class:{"scatter-full-opacity":_vm.c3.params&&_vm.c3.params.data&&_vm.c3.params.data.types&&!Object.values(_vm.c3.params.data.types).includes("bubble")}},[_c("div",{ref:"newChartEle",staticClass:"fc-new-chart pdf-chart",class:{"hide-y2-axis":_vm.options&&_vm.options.axis&&!1===_vm.options.axis.showy2axis}}),_vm.chartContext.options.legend.show&&"right"===_vm.chartContext.options.legend.position?_c("f-chart-legends",{style:{width:_vm.chartContext.options.legend.width+"px"},attrs:{chart:_vm.c3.chart,options:_vm.options,xValueMode:_vm.chartContext.xValueMode,xLabelMap:_vm.chartContext.xLabelMap,config:_vm.config},on:{ontoggle:_vm.ontoggle}}):_vm._e()],1),_vm.chartContext.options.legend.show&&"bottom"===_vm.chartContext.options.legend.position?_c("f-chart-legends",{ref:"chartLegend",attrs:{chart:_vm.c3.chart,options:_vm.options,xValueMode:_vm.chartContext.xValueMode,xLabelMap:_vm.chartContext.xLabelMap},on:{ontoggle:_vm.ontoggle}}):_vm._e(),_vm.showWidget?_c("f-widget-legends",{ref:"newWidget",staticClass:"widget-legends",attrs:{chart:_vm.c3.chart,reportVarianceData:_vm.resultObj?_vm.resultObj.reportData.aggr:null,data:_vm.data,options:_vm.options},on:{ontoggle:_vm.ontoggle}}):_vm._e()],1):_vm._e()],1)},staticRenderFns=[],createForOfIteratorHelper=__webpack_require__(566347),billboard=(__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(260228),__webpack_require__(212826),__webpack_require__(670560),__webpack_require__(76265),__webpack_require__(169358),__webpack_require__(795765),__webpack_require__(879288),__webpack_require__(872695)),basechart=__webpack_require__(503162),ReportDataUtil=__webpack_require__(760396),c3_helper=__webpack_require__(167021),FChartLegends=__webpack_require__(906575),DrilldownBreadcrumb=__webpack_require__(374520),FChartTitle=__webpack_require__(23369),FWidgetLegends=__webpack_require__(547301),FChartType=__webpack_require__(294309),JumpToHelper=__webpack_require__(921466),tooltip=__webpack_require__(460895),color_helper=__webpack_require__(794211),deepmerge=__webpack_require__(708634),d3=__webpack_require__(348727),formatter=__webpack_require__(676240),validation=__webpack_require__(990260),FNewChartvue_type_script_lang_js={mixins:[basechart/* default */.Z,JumpToHelper/* default */.Z,ReportDataUtil/* default */.Z],props:["resultObj","isWidget","showWidgetLegends","config","specialScatter","relatedAlarms","moduleName","drilldownParams"],components:{FChartLegends:FChartLegends/* default */.Z,FWidgetLegends:FWidgetLegends/* default */.Z,FChartType:FChartType/* default */.Z,FChartTitle:FChartTitle/* default */.Z,DrilldownBreadcrumb:DrilldownBreadcrumb/* default */.Z},computed:{showWidget:function(){return!("undefined"!==typeof this.showWidgetLegends&&!this.showWidgetLegends)},isRegression:function(){return!!(this.$route.path.includes("regression")||this.resultObj&&this.resultObj.regressionConfig&&0!==this.resultObj.regressionConfig.length&&!0===this.resultObj.regression)},showAlarmTitle:function(){return!this.chartContext||!this.chartContext.options||!this.chartContext.options.hideAlarmTitle}},data:function(){return{chartContext:null,chartId:Math.random().toString(36).substr(2,9),c3:{params:null,chart:null},showAlarms:!1,updateTimeout:null}},mounted:function(){this.isRegression&&(this.hidecharttypechanger=!0),this.render()},beforeDestroy:function(){tooltip/* default */.Z.hideTooltip(),this.c3&&this.c3.chart&&this.c3.chart.destroy(),this.chartContext=null,this.c3.params=null,this.c3.chart=null},methods:{render:function(){var _this=this;this.data&&(this.chartContext=null,this.$nextTick((function(){_this.chartContext={},_this.chartContext.options=_this.getOptions(),_this.chartContext.dateRange=_this.dateRange,_this.chartContext.options.general&&_this.chartContext.options.general.hideZeroes?_this.chartContext.data=_this.formatZeroesInData(_this.data):_this.chartContext.data=_this.data,_this.chartContext.options.benchmark&&_this.chartContext.options.benchmark.show&&(_this.chartContext.reportVarianceData=_this.resultObj?_this.resultObj.reportData.aggr:null),_this.chartContext.xValueMode=_this.isXValueMode(_this.chartContext.options,_this.data),_this.options.defaultDurationUnit&&(_this.chartContext.defaultDurationUnit=_this.options.defaultDurationUnit),_this.chartContext.specialScatter=!!_this.specialScatter,_this.chartContext.unitMap=_this.getUnitMap(_this.options.dataPoints),_this.chartContext.enumMap=_this.getEnumMap(_this.options.dataPoints),_this.resultObj&&_this.resultObj.baselineData&&(_this.chartContext.baselineColors=_this.resultObj.baselineDataColors,_this.chartContext.baselineData=_this.resultObj.baselineData),_this.chartContext.openAlarm=function(alarmList){if(alarmList){var _step,alarmId=[],_iterator=(0,createForOfIteratorHelper/* default */.Z)(alarmList);try{for(_iterator.s();!(_step=_iterator.n()).done;){var a=_step.value;alarmId.push(a.id)}}catch(err){_iterator.e(err)}finally{_iterator.f()}_this.jumpToAlarms(alarmId)}},"pie"!==_this.chartContext.options.type&&"donut"!==_this.chartContext.options.type||(_this.chartContext.options.padding.top=20),_this.resultObj&&_this.resultObj.Readingdp&&(_this.chartContext["Readingdp"]=_this.resultObj.Readingdp),_this.resultObj&&_this.resultObj.scatterConfig&&(_this.chartContext["scatterConfig"]=_this.resultObj.scatterConfig,_this.chartContext["xMap"]=_this.resultObj.xMap);var c3Params=c3_helper/* default */.Z.prepare(_this.chartContext);c3Params&&(c3Params.data.onclick=function(d){var _d;if(null==(null===(_d=d)||void 0===_d?void 0:_d.index))for(var i=0;i<d.values.length;i++){var _d2;if((null===(_d2=d)||void 0===_d2?void 0:_d2.values[i].id)==d.id){d=d.values[i];break}}_this.$emit("drilldown",d)}),_this.mergeOption&&(_this.chartContext.options.padding.left=_this.mergeOption.padding.left,_this.chartContext.options.padding.right=_this.mergeOption.padding.right,_this.chartContext.options.axis.x.label.text="Month",c3Params.axis.y.label.text="No of Work Request"),_this.isWidget&&(_this.chartContext.options.legend.show?c3Params.size.height=c3Params.size.height-50:c3Params.size.height=c3Params.size.height-20,_this.options.widgetLegend.show&&(c3Params.size.height=c3Params.size.height-75),_this.resultObj&&_this.resultObj.report.userFilters&&(c3Params.size.height=c3Params.size.height-65)),_this.drilldownParams&&(c3Params.size.height=c3Params.size.height-25,_this.isWidget&&(c3Params.size.height=c3Params.size.height-25)),"gauge"===_this.chartContext.options.type&&c3Params.size.height>350&&(c3Params.size.height=350);var self=_this;self.showAlarms=1===_this.getOptions().common.mode&&_this.getOptions().settings.alarm,_this.config&&_this.config.hasOwnProperty("showAlarms")&&(self.showAlarms=_this.config.showAlarms),self.showAlarms&&(_this.chartContext.alarms=_this.alarms,c3Params.size.height=c3Params.size.height-100);var alarmsParams=null;if(self.showAlarms&&(alarmsParams=c3_helper/* default */.Z.prepareBooleanChart(_this.chartContext,c3Params.data.json.x,_this.alarms),self.$refs["alarmsChartEle"]&&(alarmsParams.bindto=self.$refs["alarmsChartEle"],billboard.bb.generate(alarmsParams))),self.relatedAlarms&&self.relatedAlarms.length)for(var idx in self.relatedAlarms)if(self.$refs["relatedAlarmsChartEle"]&&self.$refs["relatedAlarmsChartEle"][idx]){var relalarmsParams=c3_helper/* default */.Z.prepareBooleanChart(_this.chartContext,c3Params.data.json.x,self.relatedAlarms[idx]);relalarmsParams.bindto=self.$refs["relatedAlarmsChartEle"][idx],billboard.bb.generate(relalarmsParams)}if(_this.chartContext.options.customizeC3){var defaultOptions={},mergedOptions=deepmerge/* default */.Z.objectAssignDeep(defaultOptions,c3Params,_this.chartContext.options.customizeC3);c3Params=mergedOptions}var print=JSON.parse(_this.$getProperty(_this,"$route.query.printing")||null);if(self.$refs["newChartEle"]){c3Params.bindto=self.$refs["newChartEle"],self.isWidget&&self.$refs["chartLegend"]&&(c3Params.size.height=c3Params.size.height-(self.$refs["chartLegend"].$el.clientHeight-20)),self.fixedChartHeight&&(c3Params.size.height=self.fixedChartHeight);var width=self.$refs["newChartEle"].clientWidth;print&&!(0,validation/* isEmpty */.xb)(width)&&(c3Params.size.width=self.$refs["newChartEle"].clientWidth),self.c3.params=c3Params,self.c3.chart=billboard.bb.generate(_this.byPassSetting(c3Params))}else _this.$nextTick((function(){if(self.showAlarms&&self.$refs["alarmsChartEle"]&&(alarmsParams.bindto=self.$refs["alarmsChartEle"],billboard.bb.generate(alarmsParams)),self.relatedAlarms&&self.relatedAlarms.length)for(var _idx in self.relatedAlarms)if(self.$refs["relatedAlarmsChartEle"]&&self.$refs["relatedAlarmsChartEle"][_idx]){var _relalarmsParams=c3_helper/* default */.Z.prepareBooleanChart(this.chartContext,c3Params.data.json.x,self.relatedAlarms[_idx]);_relalarmsParams.bindto=self.$refs["relatedAlarmsChartEle"][_idx],billboard.bb.generate(_relalarmsParams)}c3Params.bindto=self.$refs["newChartEle"];var width=self.$refs["newChartEle"].clientWidth;print&&!(0,validation/* isEmpty */.xb)(width)&&(c3Params.size.width=self.$refs["newChartEle"].clientWidth),self.isWidget&&self.$refs["chartLegend"]&&(c3Params.size.height=c3Params.size.height-(self.$refs["chartLegend"].$el.clientHeight-20)),self.fixedChartHeight&&(c3Params.size.height=self.fixedChartHeight),self.c3.params=c3Params,self.c3.chart=billboard.bb.generate(this.byPassSetting(c3Params))}))})))},ontoggle:function(key,hiddenLegends){if(this.c3.params.ontoggle&&"function"===typeof this.c3.params.ontoggle){var callback=this.c3.params.ontoggle.bind(this.c3.chart.internal,key);callback()}if("bar"===this.chartContext.options.type&&this.chartContext.options.bar.showGroupTotal){var groupTotalData=c3_helper/* default */.Z.getGroupTotalDataPoint(this.c3.params,hiddenLegends);groupTotalData&&this.c3.chart.load({json:{group_total:groupTotalData}})}},byPassSetting:function(params){if(params&&params.data&&params.data.hasOwnProperty("labels")&&!0===params.data.labels){var formattedLabel={centered:!1,format:function(v){return Number.isInteger(v)?d3.format(",")(v):v?(0,formatter/* formatCurrency */.xG)(v):null}};this.$set(params.data,"labels",formattedLabel)}return params},getOptionsFromTypeChart:function(options,ctype){
//to set the chart type based on the widget
this.config&&this.config.widget&&this.config.widget.dataOptions&&(this.config.widget.dataOptions.chartType=ctype.chartTypeInt,this.config.widget.dataOptions.chartTypeInt=ctype.chartTypeInt)},isXValueMode:function(options,data){if(("pie"===options.type||"donut"===options.type)&&data&&data.x&&2===Object.keys(data).length){if(options.xColorMap)return!0;for(var colors=color_helper/* default */.Z.newColorPicker(data.x.length),xColorMap={},i=0;i<data.x.length;i++){var xVal=data.x[i];xColorMap[xVal]=options.xColorMap&&options.xColorMap[xVal]?options.xColorMap[xVal]:colors[i]}return options.xColorMap=xColorMap,!0}return options.xColorMap=null,!1},reRender:function(){var _this2=this;this.updateTimeout&&clearTimeout(this.updateTimeout),this.updateTimeout=setTimeout((function(){return _this2.render()}),500)},resize:function(){this.reRender(),this.$refs["newWidget"]&&this.$refs["newWidget"].resize()},update:function(){this.reRender()}}},components_FNewChartvue_type_script_lang_js=FNewChartvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FNewChartvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FNewChart=component.exports},
/***/794925:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return FNewAnalyticReport}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/energy/analytics/components/FNewAnalyticReport.vue?vue&type=template&id=0e8d9e6d&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"analytics-section"},[_c("div",{staticClass:"new-analytics-filter-section"},[_vm.config.hidedatepicker?_vm._e():_c("new-date-picker",{ref:"newDatePicker",staticClass:"filter-field date-filter-comp inline",attrs:{zone:_vm.$timezone,dateObj:_vm.config.dateFilter,isDateFixed:_vm.config.applyReportDate},on:{date:_vm.setDateFilter}}),!_vm.config.hidechartoptions&&_vm.reportObj&&!0===!_vm.isRegression?_c("f-chart-settings",{attrs:{dataPoints:_vm.reportObj.options.dataPoints,settings:_vm.reportObj.options.settings,showChart:!1,showTable:!1,showChartMode:_vm.reportObj.data&&Object.keys(_vm.reportObj.data).length>2,showAlarm:!(!_vm.reportObj.options||!_vm.reportObj.options.common||1!==_vm.reportObj.options.common.type),showSafelimit:!(!_vm.reportObj.options||!_vm.reportObj.options.common||1!==_vm.reportObj.options.common.type||"undefined"!==typeof _vm.resultObj.regression),disableChartMode:_vm.reportObj.booleanData},on:{onSettingsChange:_vm.onSettingsChange}}):_vm._e(),_vm.resultObj&&_vm.resultObj.report&&0!==_vm.resultObj.report.dataPoints.length&&!_vm.isRegression?_c("span"):_vm._e()],1),!_vm.$mobile&&_vm.predictive&&_vm.config.predictionTimings&&_vm.config.predictionTimings.length?_c("prediction-timings-bar",{staticClass:"prediction-timing-bar",attrs:{reportObj:_vm.reportObj,config:_vm.config}}):_vm._e(),_vm.loading?_c("spinner",{staticClass:"analytics-spinner",attrs:{show:_vm.loading,size:"80"}}):_vm.failed?_c("div",{staticStyle:{"margin-top":"30px",opacity:"0.7","font-size":"13px",padding:"50px","line-height":"25px","text-align":"center"}},[_c("div",[_vm._v(_vm._s(_vm.$t("home.dashboard.data_loading_failed")))])]):_vm.reportObj&&_vm.reportObj.data&&!_vm.noData?_c("div",[_vm.config.hidechart?_vm._e():_c("div",[_vm.$route.meta&&_vm.$route.meta.layout&&"mobile"===_vm.$route.meta.layout&&"multi"===_vm.reportObj.options.settings.chartMode?_c("f-mobile-multi-chart",{ref:"multiChart",attrs:{isWidget:!!_vm.config,width:_vm.config&&_vm.config.width?_vm.config.width:null,resultObj:_vm.resultObj,height:_vm.config&&_vm.config.height?_vm.config.height:null,data:_vm.reportObj.data,options:_vm.reportObj.options,alarms:_vm.reportObj.alarms,dateRange:_vm.reportObj.dateRange,hidecharttypechanger:_vm.config&&_vm.config.widget,booleanData:_vm.reportObj.booleanData}}):"multi"===_vm.reportObj.options.settings.chartMode?_c("f-multi-chart",{ref:"multiChart",attrs:{data:_vm.reportObj.data,options:_vm.reportObj.options,alarms:_vm.reportObj.alarms,booleanData:_vm.reportObj.booleanData,dateRange:_vm.reportObj.dateRange,resultObj:_vm.resultObj,relatedAlarms:_vm.reportObj.relatedAlarms,hidecharttypechanger:_vm.config.hidecharttypechanger||_vm.isRegression}}):_c("div",[_vm.$route.meta&&_vm.$route.meta.layout&&"mobile"===_vm.$route.meta.layout?_c("f-mobile-chart",{ref:"newChart",staticClass:"mobile-chart",attrs:{data:_vm.reportObj.data,options:_vm.reportObj.options,alarms:_vm.reportObj.alarms,dateRange:_vm.reportObj.dateRange,resultObj:_vm.resultObj}}):_c("f-new-chart",{ref:"newChart",attrs:{data:_vm.reportObj.data,options:_vm.reportObj.options,alarms:_vm.reportObj.alarms,dateRange:_vm.reportObj.dateRange,resultObj:_vm.resultObj,relatedAlarms:_vm.reportObj.relatedAlarms,hidecharttypechanger:_vm.config.hidecharttypechanger||_vm.isRegression,showWidgetLegends:_vm.config.showWidgetLegends,fixedChartHeight:_vm.config.fixedChartHeight,config:_vm.config,moduleName:_vm.moduleName}})],1)],1),_vm.config.hidetabular?_vm._e():_c("f-tabular-report",{ref:"newTable",staticClass:"new-analytics-table",class:{"regression-table-fit":_vm.isRegression},attrs:{reportObject:_vm.resultObj,reportConfig:_vm.reportObj}})],1):_c("div",{staticClass:"analytics-report-empty-state",staticStyle:{"margin-top":"30px","font-size":"13px",padding:"50px","line-height":"25px","text-align":"center"}},[_c("inline-svg",{attrs:{src:"svgs/emptystate/reportlist",iconClass:"icon text-center icon-100"}}),_c("div",{staticClass:"nowo-label f13"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.empty_data"))+" "),_vm.resultObj&&_vm.resultObj.dateRange?_c("span",{staticClass:"bold"},[_vm._v(_vm._s(_vm._f("formatPeriod")(_vm.resultObj.dateRange.value,"MMM DD, YYYY")))]):_vm._e()])],1),_vm.resultObj?_c("RangeChartDialog",{attrs:{visibility:_vm.showRangeChartDialog,dataPoints:_vm.resultObj.report.dataPoints},on:{"update:visibility":function($event){_vm.showRangeChartDialog=$event},rangePoints:_vm.addRangePoints}}):_vm._e()],1)},staticRenderFns=[],objectSpread2=__webpack_require__(595082),createForOfIteratorHelper=__webpack_require__(566347),NewDatePicker=(__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(670560),__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(434284),__webpack_require__(425728),__webpack_require__(162506),__webpack_require__(648324),__webpack_require__(900773)),FNewChart=__webpack_require__(875963),FMobileChart=__webpack_require__(242208),FMultiChart=__webpack_require__(649206),NewDataFormatHelper=__webpack_require__(804911),AnalyticsMixin=__webpack_require__(244936),FTabularReportNew=__webpack_require__(979),FChartSettings=__webpack_require__(746036),FMobileMultiChart=__webpack_require__(696593),PredictionTimingsBar=__webpack_require__(107387),NewDateHelper=__webpack_require__(105534),RangeChartDialog=__webpack_require__(515326),deepmerge=__webpack_require__(708634),validation=__webpack_require__(990260),FNewAnalyticReportvue_type_script_lang_js={props:["config","baseLines","readings","moduleName"],mixins:[NewDataFormatHelper/* default */.Z,AnalyticsMixin/* default */.Z,NewDateHelper/* default */.Z],components:{NewDatePicker:NewDatePicker/* default */.Z,FNewChart:FNewChart/* default */.Z,FMultiChart:FMultiChart/* default */.Z,FTabularReport:FTabularReportNew/* default */.Z,FMobileChart:FMobileChart/* default */.Z,FChartSettings:FChartSettings/* default */.Z,FMobileMultiChart:FMobileMultiChart/* default */.Z,PredictionTimingsBar:PredictionTimingsBar/* default */.Z,RangeChartDialog:RangeChartDialog/* default */.Z},data:function(){return{loading:!0,predictive:!0,failed:!1,noData:!1,reportObj:null,resultObj:null,showRangeChartDialog:!1}},mounted:function(){this.init()},created:function(){this.$store.dispatch("loadAssetCategory")},computed:{isRegression:function(){return!!this.$route.path.includes("regression")}},watch:{config:{handler:function(newData,oldData){this.config.applyReportDate||this.init(!1)},deep:!0}},methods:{addRangePoints:function(val,remainingDataPoints){var _step,ranges=["min","max","avg"],dataPoints=[],_iterator=(0,createForOfIteratorHelper/* default */.Z)(val);try{for(_iterator.s();!(_step=_iterator.n()).done;){var rangeConfig=_step.value;for(var key in rangeConfig){var config={};ranges.includes(key)&&(config["parentId"]=rangeConfig[key].parentId,config["prediction"]=!1,config["aliases"]={actual:rangeConfig[key].alias},config["yAxis"]={aggr:rangeConfig[key].aggr,fieldId:rangeConfig[key].fieldId},dataPoints.push(config))}}}catch(err){_iterator.e(err)}finally{_iterator.f()}var _step2,_iterator2=(0,createForOfIteratorHelper/* default */.Z)(remainingDataPoints);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var dataPoint=_step2.value,_config={};_config["parentId"]=dataPoint.metaData.parentIds[0],_config["prediction"]=!1,_config["aliases"]={actual:dataPoint.aliases.actual},_config["yAxis"]={aggr:dataPoint.yAxis.aggr,fieldId:dataPoint.yAxis.fieldId},dataPoints.push(_config)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}var analyticConfig=this.$helpers.cloneObject(this.config);analyticConfig.dataPoints=dataPoints,analyticConfig.period="undefined"!==typeof this.config.period&&null!==this.config.period?0===this.config.period?this.getXAggr():this.config.period:0,this.$emit("update:config",analyticConfig)},setDateFilter:function(dateFilter){this.$set(this.config,"dateFilter",dateFilter);
// this.$emit('update:config', this.config)
},init:function(){this.initChart()},resize:function(){this.$refs["newChart"]&&this.$refs["newChart"].resize(),this.$refs["multiChart"]&&this.$refs["multiChart"].resize(),this.$refs["newTable"]&&this.$refs["newTable"].resize()},getReportParams:function(){var baselines,baselineNames,_this=this;if(this.config.baseLine&&Array.isArray(this.config.baseLine)&&this.config.baseLine.length){if(this.config.baseLine[0]>0){var bl={};bl.baseLineId=this.config.baseLine[0],this.config.baseLine.length>1&&(bl.adjustType=this.config.baseLine[1]);var blList=[];blList.push(bl),baselines=blList}}else this.config.baseLine&&this.config.baseLine>0&&(baselines=[{baseLineId:this.config.baseLine}]);baselines&&this.baseLines&&(baselineNames=[],baselines.forEach((function(baseline){var baseLineName=_this.baseLines.find((function(bl){return bl.id===baseline.baseLineId})).name;baselineNames.push(baseLineName)})));var fields=[];if(3===this.config.mode){var _step3,parentId=[],fieldId=null,yAggr=3,dynamicKpi=-1,_iterator3=(0,createForOfIteratorHelper/* default */.Z)(this.config.dataPoints);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var dp=_step3.value;parentId.push(dp.parentId),fieldId=dp.yAxis.fieldId,yAggr=dp.yAxis.aggr;var _dp$kpiType=dp.kpiType,kpiType=void 0===_dp$kpiType?"":_dp$kpiType;"DYNAMIC"===kpiType&&(dynamicKpi=dp.yAxis.dynamicKpi)}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}if(fields.push({parentId:parentId,yAxis:{fieldId:fieldId,aggr:0!==this.config.period&&0===yAggr?3:yAggr},type:1,aliases:{actual:"A"}}),!(0,validation/* isEmpty */.xb)(dynamicKpi)){var field=fields[0]||{};fields.splice(0,1,(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},field),{},{yAxis:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},field.yAxis),{},{dynamicKpi:dynamicKpi}),kpiType:"DYNAMIC"}))}this.setAlias(fields,baselineNames)}else{this.setAlias(this.config.dataPoints,baselineNames);var _step4,_iterator4=(0,createForOfIteratorHelper/* default */.Z)(this.config.dataPoints);try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var _dp=_step4.value,metaData={};_dp.categoryId&&(metaData.categoryId=_dp.categoryId),fields.push({parentId:_dp.parentId?Array.isArray(_dp.parentId)?_dp.parentId:[_dp.parentId]:null,name:_dp.name,metaData:metaData,yAxis:_dp.yAxis,aliases:_dp.aliases,type:_dp.type>0?_dp.type:1,predictedTime:_dp.predictedTime,rule_aggr_type:null===_dp||void 0===_dp?void 0:_dp.rule_aggr_type,kpiType:_dp.kpiType})}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}}if(this.config.sorting&&(6===this.config.mode||7===this.config.mode||8===this.config.mode)&&(this.config.sorting.orderByFunc||this.config.sorting.limit)){var sortByField=this.config.sorting.sortByField;if(sortByField){var _field=fields.find((function(f){return f.yAxis.fieldId===sortByField}));_field||(sortByField=null)}sortByField||(sortByField=fields[0].yAxis.fieldId,this.config.sorting.sortByField=fields[0].yAxis.fieldId);var _field2=fields.find((function(f){return f.yAxis.fieldId===sortByField}));_field2&&(_field2.defaultSortPoint=!0,this.config.sorting.orderByFunc&&(_field2.orderByFunc=this.config.sorting.orderByFunc),this.config.sorting.limit&&(_field2.limit=this.config.sorting.limit))}var params={mode:this.config.mode,startTime:this.config.dateFilter.value[0],endTime:this.config.dateFilter.value[1],xAggr:1===this.config.mode||3===this.config.mode||4===this.config.mode||5===this.config.mode?this.config.period:0,fields:JSON.stringify(fields),transformWorkflow:this.config.transformWorkflow};if(this.reportObj&&this.reportObj.options&&this.reportObj.options.settings?(params.showAlarms=this.reportObj.options.settings.alarm,params.showSafeLimit=this.reportObj.options.settings.safelimit):this.config.savedReport?(params.showAlarms=this.config.savedReport.showAlarms,params.showSafeLimit=this.config.savedReport.showSafeLimit):params.showSafeLimit=!0,baselines&&(params.baseLines=JSON.stringify(baselines)),this.config.filters&&this.config.filters.xCriteriaMode)if(params.xCriteriaMode=this.config.filters.xCriteriaMode,this.config.filters.parentId&&this.config.filters.parentId.length)params.parentId=this.config.filters.parentId;else{var categoryId=this.config.filters.assetCategory;if(!categoryId||!categoryId.length){categoryId=[];var _step5,_iterator5=(0,createForOfIteratorHelper/* default */.Z)(this.config.dataPoints);try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var _dp2=_step5.value;-1===categoryId.indexOf(_dp2.categoryId)&&categoryId.push(_dp2.categoryId)}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}}categoryId.length&&(params.assetCategory=categoryId),this.config.filters.spaceId&&this.config.filters.spaceId.length&&(params.spaceId=this.config.filters.spaceId)}return this.$route.query&&this.$route.query.alarmId&&(params.alarmId=parseInt(this.$route.query.alarmId),params.showAlarms=!0),params},initChart:function(){var self=this,moduleName=self.moduleName;this.loading=!0,this.failed=!1,this.noData=!1;var apiURL=this.config.api?this.config.api:"/v2/report/readingReport",params=null;if(this.config.alarmId&&this.$mobile?(apiURL="/v2/report/fetchReadingsFromAlarm",params={alarmId:this.config.alarmId,mode:1,xAggr:this.$constants.OPERATOR_TO_XAGG[this.config.dateFilter.operatorId]||0,startTime:this.config.dateFilter.value[0],endTime:this.config.dateFilter.value[1],showAlarms:!0}):this.config.alarmId&&(apiURL="/v2/report/fetchReadingsFromAlarm",params={alarmId:this.config.alarmId,mode:1,xAggr:0,startTime:this.config.dateFilter.value[0],endTime:this.config.dateFilter.value[1],showAlarms:!0}),this.config.readingRuleId&&(params||(params={}),params.readingRuleId=this.config.readingRuleId),this.config.isFromSiteSummary&&this.config.params&&(params=this.config.params),this.config.isFromFaultInsight&&!(0,validation/* isEmpty */.xb)(this.config.params)){var config=this.config,_ref=config||{},dateFilter=_ref.dateFilter,configParams=_ref.params,_ref2=dateFilter||{},value=_ref2.value,startTime=value[0],endTime=value[1];params=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},configParams),{},{startTime:startTime,endTime:endTime})}this.config.isWithPrerequsite&&(params.isWithPrerequsite=this.config.isWithPrerequsite),params||(params=self.getReportParams()),this.config.analyticsType&&(params.analyticsType=this.config.analyticsType),"sensorrollupalarm"===this.moduleName&&(params.shouldIncludeMarked=!0),params.newFormat=!0,self.$http.post(apiURL,params).then((function(response){if(response.data&&0===response.data.responseCode){var result=response.data.result;if(result.xAggr=params.xAggr,result.mode=params.mode,self.config.analyticsType&&(result.report.analyticsType=self.config.analyticsType),self.config.filters&&(result.filters=self.config.filters),self.config.sorting&&(result.sorting=self.config.sorting),self.config.applyReportDate?(self.config.dateFilter=result.dateRange=NewDateHelper/* default */.Z.getDatePickerObject(self.config.dateFilter.operatorId,result.report.dateValue),self.$nextTick((function(){self.$refs.newDatePicker.loadFromObject()}))):result.dateRange=self.config.dateFilter,self.reportObj?(result.report.chartState=self.reportObj.options,result.report.tabularState=self.reportObj.params.tabularState):self.config.savedReport&&(result.report.chartState=self.config.savedReport.chartState,result.report.tabularState=self.config.savedReport.tabularState),self.config.groupByMetrics&&(result.groupByMetrics=!0),self.reportObj=self.prepareReport(result),self.config.customizeChartOptions&&self.reportObj&&self.reportObj.options&&(self.reportObj.options=deepmerge/* default */.Z.objectAssignDeep(self.reportObj.options,self.config.customizeChartOptions)),(self.$route.query&&self.$route.query.alarmId||self.config.alarmId)&&(self.reportObj.options.settings.alarm=!0),self.resultObj=result,self.reportObj.params=params,self.reportObj.alarms=self.prepareBooleanReport(result.reportData.aggr),!(0,validation/* isEmpty */.xb)(self.reportObj.alarms)&&!(0,validation/* isEmpty */.xb)(moduleName)){var displayName="newreadingalarm"===moduleName?"Faults":null;self.$set(self.reportObj.alarms,"barTitle",displayName)}self.config.hideAlarmSubject&&(self.reportObj.alarms.showTimeOnly=!0),result.reportData.aggr&&result.reportData.aggr.relatedAlarms&&(self.reportObj.relatedAlarms=self.prepareRelatedAlarms(result.reportData.aggr.relatedAlarms)),self.config.alarmId&&(self.reportObj.alarms.barSize="medium"),self.reportObj.options.predictionTimings=self.config.predictionTimings,self.config.regionConfig&&(self.reportObj.options.regionConfig=self.config.regionConfig),self.$emit("reportLoaded",self.reportObj,self.resultObj),self.loading=!1}else"In sufficient params for Reading Analysis"===response.data.message?(self.loading=!1,self.noData=!0):(self.loading=!1,self.failed=!0)})).catch((function(error){"In sufficient params for Reading Analysis"===error?(self.loading=!1,self.noData=!0):error&&(self.loading=!1,self.failed=!0)}))},onSettingsChange:function(changedOption){"alarm"===changedOption?this.reportObj.alarms&&this.reportObj.alarms.regions.length||!this.reportObj.options.settings.alarm||this.init():"safelimit"===changedOption&&!this.reportObj.options.safeLimit.length&&this.reportObj.options.settings.safelimit&&this.init()}}},components_FNewAnalyticReportvue_type_script_lang_js=FNewAnalyticReportvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FNewAnalyticReportvue_type_script_lang_js,render,staticRenderFns,!1,null,"0e8d9e6d",null)
/* harmony default export */,FNewAnalyticReport=component.exports},
/***/107387:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return PredictionTimingsBar}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/energy/analytics/components/PredictionTimingsBar.vue?vue&type=template&id=3628f290
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.localtimings&&_vm.localtimings.length?_c("div",{staticClass:"prediction-component row"},[_c("div",{staticClass:"col-12 pr-date-picker"},[_vm._m(0),_c("el-date-picker",{ref:"new-prediction-time-picker",staticClass:"date-picker flLeft",attrs:{"prefix-icon":" ","clear-icon":" ",align:"right",type:"date","value-format":"timestamp","picker-options":_vm.pickerOptions},on:{change:_vm.changedate},model:{value:_vm.newTime,callback:function($$v){_vm.newTime=$$v},expression:"newTime"}})],1),_c("div",{staticClass:"date-picker col-12"},_vm._l(_vm.localtimings,(function(time,index){return _c("div",{key:index,staticClass:"prediction-container",class:{active:_vm.getActive(time),disabled:time>=_vm.currentTime}},[_c("div",{staticClass:"prediction-cube",class:{active:_vm.getActive(time)},on:{click:function($event){return _vm.addNewTime(time)}}},[_c("div",{staticClass:"prediction-time"},[_vm._v(" "+_vm._s(_vm.formatTime(time,"h a",!1))+" ")]),_c("div",{class:{active:_vm.getActive(time)}})])])})),0)]):_vm._e()},staticRenderFns=[function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"pr-label"},[_c("i",{staticClass:"el-icon-time"}),_vm._v(" Predicted Timing : ")])}],AnalyticsMixin=(__webpack_require__(162506),__webpack_require__(339772),__webpack_require__(670560),__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(244936)),moment_timezone=__webpack_require__(480008),moment_timezone_default=__webpack_require__.n(moment_timezone),NewDateHelper=__webpack_require__(105534),PredictionTimingsBarvue_type_script_lang_js={props:["config","reportObj"],mixins:[AnalyticsMixin/* default */.Z,NewDateHelper/* default */.Z],data:function(){var time=moment_timezone_default()((new Date).valueOf()).tz(this.$timezone).startOf("day").valueOf();return{showPicker:!1,localtimings:[],splitRatio:10,newTime:time,timings:[],pickerOptions:{disabledDate:function(time){return time.getTime()>(new Date).valueOf()}}}},watch:{"config.dataPoints":{handler:function(newData,oldData){this.reloadBar()},deep:!0}},computed:{currentTime:function(){return moment_timezone_default()().tz(this.$timezone).startOf("hour").valueOf()},today:function(){return moment_timezone_default()().tz(this.$timezone).startOf("day").valueOf()}},mounted:function(){this.timings=this.$helpers.cloneObject(this.config.predictionTimings),this.getFullDayTimes(!1)},methods:{removeTime:function(index){this.removePrediction(index),this.config.predictionTimings.splice(index,1),this.timings.splice(index,1)},reloadBar:function(){this.timings=this.$helpers.cloneObject(this.config.predictionTimings)},formatTime:function(date,period,enableFormating){var dateFormat=period||"DD-MM-YYY",today=moment_timezone_default()().tz(this.$timezone).startOf("day").valueOf(),yesterday=moment_timezone_default()().tz(this.$timezone).subtract(1,"day").startOf("day").valueOf();return date>yesterday&&enableFormating&&date<=today?"YESTERDAY":date>today&&enableFormating?"TODAY":moment_timezone_default()(date).tz(this.$timezone).format(dateFormat)},changeTime:function(index){var time=this.getTime(this.timings[index]);this.changePredictionTime(index,time),this.$set(this.config.predictionTimings,index,time),this.$set(this.timings,index,time)},addNewTime:function(time){time<=this.currentTime&&(this.timings.findIndex((function(rt){return rt===time}))<0?(this.timings.push(time),
// this.setDateFilter(this.timings)
this.config.predictionTimings.push(time),this.addPredictionFields(this.config)):this.removeTime(this.timings.findIndex((function(rt){return rt===time}))))},
// setDateFilter (time) {
//   if (time && time.length) {
//     let dateFilter = {}
//     time = time.sort()
//     if (time.length === 1 && time[0] < this.today) {
//       dateFilter = newDateHelper.getDatePickerObject(20, [this.$options.filters.startOfDay(time[0]), this.$options.filters.endOfDay(time[0])])
//        this.config.dateFilter = dateFilter
//     }
//     else if (time[0] < this.today) {
//       dateFilter = newDateHelper.getDatePickerObject(20, [this.$options.filters.startOfDay(time[0]), this.$options.filters.endOfDay(time[time.length - 1])])
//        this.config.dateFilter = dateFilter
//        this.config.period = 20
//     }
//   }
// },
getActive:function(time){return!(this.timings.findIndex((function(rt){return rt===time}))<0)&&(this.timings.findIndex((function(rt){return rt===time}))>-1||void 0)},addTime:function(){var time=this.getTime(this.newTime);this.config.predictionTimings.push(time),this.timings.push(time),this.newTime=null,this.addPredictionFields(this.config)},getTime:function(time){return this.$options.filters.startOfHour(this.$helpers.getTimeInOrg(time))},getDpIndexes:function(predictionIndex){var oldTime=this.config.predictionTimings[predictionIndex],indexes=[];return this.config.dataPoints.forEach((function(point,idx){point.prediction&&point.predictedTime===oldTime&&indexes.push(idx)})),indexes},selectPredictedTime:function(){this.config.predictionTimings=this.timings},removePrediction:function(index){var _this=this,indexes=this.getDpIndexes(index);indexes.forEach((function(idx){_this.config.dataPoints.splice(idx,1)}))},changePredictionTime:function(index,newTime){var _this2=this,indexes=this.getDpIndexes(index);indexes.forEach((function(idx){_this2.$set(_this2.config.dataPoints[idx],"predictedTime",newTime)}))},changedate:function(){this.getFullDayTimes()},getFullDayTimes:function(mounted){for(var timings=[],time=moment_timezone_default()(this.newTime).tz(this.$timezone).valueOf(),i=0;i<24;i++)timings.push(this.$options.filters.nextHour(this.$helpers.getTimeInOrg(time),i));this.localtimings=this.$helpers.cloneObject(timings)}}},components_PredictionTimingsBarvue_type_script_lang_js=PredictionTimingsBarvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_PredictionTimingsBarvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,PredictionTimingsBar=component.exports},
/***/515326:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return RangeChartDialog}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/energy/analytics/components/RangeChartDialog.vue?vue&type=template&id=58e68532
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"fc-dialog-center-container",attrs:{visible:_vm.visibility,title:"Range chart",width:"40%","append-to-body":!0,"show-close":!1,"close-on-click-modal":!1},on:{"update:visible":function($event){_vm.visibility=$event},keydown:function($event){return!$event.type.indexOf("key")&&_vm._k($event.keyCode,"esc",27,$event.key,["Esc","Escape"])?null:_vm.closeRangeDialog.apply(null,arguments)}}},[_c("div",{staticClass:"height400 pB80"},[_c("el-button",{attrs:{type:"primary"},on:{click:function($event){return _vm.addNewRangeTemplate()}}},[_vm._v("New range point")]),_vm.showNewRangeTemplate?_c("div",[_c("div",[_c("el-row",[_c("el-col",{attrs:{span:24}},[_vm._v(" Avg: "),_c("el-select",{attrs:{clearable:""},on:{clear:function($event){return _vm.clearPoint("avg")},change:function($event){return _vm.setPointMeta($event,"avg")}},model:{value:_vm.rangeTemplate["avg"]["clientId"],callback:function($$v){_vm.$set(_vm.rangeTemplate["avg"],"clientId",$$v)},expression:"rangeTemplate['avg']['clientId']"}},_vm._l(_vm.filteredDataPoints,(function(dataPointAvg,dataPointAvgIdx){return!0===dataPointAvg.show?_c("el-option",{key:dataPointAvgIdx,attrs:{label:dataPointAvg.name,value:dataPointAvg.clientId}}):_vm._e()})),1)],1)],1),_c("el-row",[_c("el-col",{attrs:{span:12}},[_vm._v(" Min: "),_c("el-select",{attrs:{clearable:"",disabled:"undefined"===typeof _vm.rangeTemplate.avg.alias},on:{clear:function($event){return _vm.clearPoint("min")},change:function($event){return _vm.setPointMeta($event,"min")}},model:{value:_vm.rangeTemplate["min"]["clientId"],callback:function($$v){_vm.$set(_vm.rangeTemplate["min"],"clientId",$$v)},expression:"rangeTemplate['min']['clientId']"}},_vm._l(_vm.filteredDataPoints,(function(dataPointMin,dataPointMinIdx){return!0===dataPointMin.show?_c("el-option",{key:dataPointMinIdx,attrs:{label:dataPointMin.name,value:dataPointMin.clientId}}):_vm._e()})),1)],1),_c("el-col",{attrs:{span:12}},[_vm._v(" Max: "),_c("el-select",{attrs:{clearable:"",disabled:"undefined"===typeof _vm.rangeTemplate.avg.alias},on:{clear:function($event){return _vm.clearPoint("max")},change:function($event){return _vm.setPointMeta($event,"max")}},model:{value:_vm.rangeTemplate["max"]["clientId"],callback:function($$v){_vm.$set(_vm.rangeTemplate["max"],"clientId",$$v)},expression:"rangeTemplate['max']['clientId']"}},_vm._l(_vm.filteredDataPoints,(function(dataPointMax,dataPointMaxIdx){return!0===dataPointMax.show?_c("el-option",{key:dataPointMaxIdx,attrs:{label:dataPointMax.name,value:dataPointMax.clientId}}):_vm._e()})),1)],1)],1),_c("el-row",[_c("el-button",{attrs:{type:"primary"},on:{click:function($event){return _vm.insertRangePoint()}}},[_vm._v(" Add ")])],1)],1)]):_vm._e(),_vm.allRanges&&0!==_vm.allRanges.length?_c("div",_vm._l(_vm.allRanges,(function(allRange,allRangeIdx){return _c("div",{key:allRangeIdx},[_c("div",[_c("div",[_c("i",{staticClass:"el-icon-edit",on:{click:function($event){return _vm.editRangeConfig(allRange)}}}),_c("i",{staticClass:"el-icon-delete",on:{click:function($event){return _vm.deleteRangeConfig(allRangeIdx)}}})]),_c("div",[_vm._v(_vm._s("Avg:"+allRange.avg.displayName))]),_c("div",[_vm._v(_vm._s("Min:"+allRange.min.displayName))]),_c("div",[_vm._v(_vm._s("Max:"+allRange.max.displayName))])])])})),0):_vm._e(),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.closeRangeDialog}},[_vm._v("CANCEL")]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:_vm.addAllRangePoints}},[_vm._v("SAVE")])],1)],1)])},staticRenderFns=[],createForOfIteratorHelper=__webpack_require__(566347),toConsumableArray=__webpack_require__(488478),RangeChartDialogvue_type_script_lang_js=(__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(670560),__webpack_require__(169358),__webpack_require__(648324),__webpack_require__(162506),__webpack_require__(919649),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(434284),{props:["visibility","dataPoints","chartState"],data:function(){return{showNewRangeTemplate:!1,rangeTemplate:null,allRanges:null,usedPoints:[],lastClientId:0}},watch:{dataPoints:{handler:function(newVal,oldVal){newVal&&this.filterDataPoints()},deep:!0}},computed:{filteredDataPoints:function(){return 0!==this.dataPoints.length?this.filterDataPoints():[]}},methods:{filterDataPoints:function(){var _this=this,points=[];if(points=(0,toConsumableArray/* default */.Z)(this.dataPoints.filter((function(dp){return 4!==dp.yAxis.dataType}))),points=this.reducePoints(points),this.usedPoints&&0!==this.usedPoints.length){var _step,_iterator=(0,createForOfIteratorHelper/* default */.Z)(this.usedPoints);try{var _loop=function(){var uP=_step.value,inDp=points.filter((function(dp){return dp.metaData.parentIds&&dp.metaData.parentIds[0]===uP.parentId&&dp.yAxis&&dp.yAxis.fieldId===uP.fieldId}));0!==inDp.length?inDp[0]["clientId"]=uP.clientId:_this.deleteUsedPoint(uP)};for(_iterator.s();!(_step=_iterator.n()).done;)_loop()}catch(err){_iterator.e(err)}finally{_iterator.f()}}return this.setBooleanFilters(points),this.setClientIds(points),points},setBooleanFilters:function(points){var _this2=this;if(this.usedPoints&&0!==this.usedPoints.length){var _step2,_iterator2=(0,createForOfIteratorHelper/* default */.Z)(points);try{var _loop2=function(){var p=_step2.value,upFilter=_this2.usedPoints.filter((function(uP){return uP.fieldId===p.yAxis.fieldId&&uP.parentId===p.metaData.parentIds[0]}));0===upFilter.length?p["show"]=!0:p["show"]=!1};for(_iterator2.s();!(_step2=_iterator2.n()).done;)_loop2()}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}else{var _step3,_iterator3=(0,createForOfIteratorHelper/* default */.Z)(points);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var d=_step3.value;d["show"]=!0}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}}},reducePoints:function(points){
// Object with parent and filedId key
var _step4,uniqueKeys={},dpByAlias={},finalDataPoints=[],_iterator4=(0,createForOfIteratorHelper/* default */.Z)(points);try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var dp=_step4.value;dpByAlias[dp.aliases.actual]=JSON.parse(JSON.stringify(dp)),dp.metaData.parentIds&&dp.yAxis.fieldId&&(uniqueKeys.hasOwnProperty(dp.metaData.parentIds[0]+"."+dp.yAxis.fieldId)||(uniqueKeys[dp.metaData.parentIds[0]+"."+dp.yAxis.fieldId]=[]),uniqueKeys[dp.metaData.parentIds[0]+"."+dp.yAxis.fieldId].push(dp.aliases.actual))}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}for(var key in uniqueKeys){var dataPoint=dpByAlias[uniqueKeys[key][0]];uniqueKeys[key].length>1?(
// reducing to a single point
dataPoint.aliases.actual=dataPoint.aliases.actual.split(".")[0],finalDataPoints.push(dataPoint)):finalDataPoints.push(dpByAlias[uniqueKeys[key][0]])}return finalDataPoints},deleteUsedPoint:function(point){var uPointIndex=this.usedPoints.indexOf(point);if(this.usedPoints.splice(uPointIndex,1),this.allRanges){var _step5,index=[],_iterator5=(0,createForOfIteratorHelper/* default */.Z)(this.allRanges);try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var range=_step5.value;for(var key in range)range[key].parentId===point.parentId&&range[key].fieldId===point.fieldId&&index.push(this.allRanges.indexOf(range))}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}for(var _i=0,_index=index;_i<_index.length;_i++){var i=_index[_i];this.allRanges.splice(i,1)}}},setClientIds:function(dataPoints){var _step6,_iterator6=(0,createForOfIteratorHelper/* default */.Z)(dataPoints);try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var p=_step6.value;p.clientId||(p["clientId"]=this.lastClientId),this.lastClientId++}}catch(err){_iterator6.e(err)}finally{_iterator6.f()}},clearPoint:function(label){this.rangeTemplate[label]={}},insertRangePoint:function(){this.showNewRangeTemplate=!1,this.allRanges||(this.allRanges=[]);var uniqueStrings=new Set;for(var key in this.rangeTemplate)"min"!==key&&"avg"!==key&&"max"!==key||uniqueStrings.add(this.rangeTemplate[key].parentId+"."+this.rangeTemplate[key].fieldId+"."+this.rangeTemplate[key].clientId);var _step7,_iterator7=(0,createForOfIteratorHelper/* default */.Z)(uniqueStrings);try{for(_iterator7.s();!(_step7=_iterator7.n()).done;){var string=_step7.value,split=string.split(".");this.usedPoints.push({parentId:parseInt(split[0]),fieldId:parseInt(split[1]),clientId:parseInt(split[2])})}}catch(err){_iterator7.e(err)}finally{_iterator7.f()}this.hideDataPoints(),this.rangeTemplate["index"]=0===this.allRanges.length?this.allRanges.length:this.allRanges.length-1,this.allRanges.push(this.rangeTemplate),this.rangeTemplate=null},hideDataPoints:function(uniqueStrings){var _step8,_this3=this,_iterator8=(0,createForOfIteratorHelper/* default */.Z)(this.usedPoints);try{var _loop3=function(){var dP=_step8.value,mDataPoint=_this3.dataPoints.filter((function(mDp){return mDp.yAxis.fieldId===dP.fieldId&&mDp.metaData.parentIds[0]===dP.parentId}));0!==mDataPoint.length&&(mDataPoint["show"]=!1)};for(_iterator8.s();!(_step8=_iterator8.n()).done;)_loop3()}catch(err){_iterator8.e(err)}finally{_iterator8.f()}},deleteRangeConfig:function(rangeConfigIdx){var _this4=this,dataPointKeys=new Set;for(var key in this.allRanges[rangeConfigIdx])"min"!==key&&"max"!==key&&"avg"!==key||dataPointKeys.add(this.allRanges[rangeConfigIdx][key].parentId+"."+this.allRanges[rangeConfigIdx][key].fieldId);var _step9,_iterator9=(0,createForOfIteratorHelper/* default */.Z)(dataPointKeys.values());try{var _loop4=function(){var uKey=_step9.value,split=uKey.split("."),usedPoint=_this4.usedPoints.filter((function(uP){return uP.fieldId===parseInt(split[1])&&uP.parentId===parseInt(split[0])}));if(0!==usedPoint.length){var index=_this4.usedPoints.indexOf(usedPoint[0]);_this4.usedPoints.splice(index,1)}};for(_iterator9.s();!(_step9=_iterator9.n()).done;)_loop4()}catch(err){_iterator9.e(err)}finally{_iterator9.f()}this.rangeTemplate&&this.rangeTemplate.index===rangeConfigIdx&&(this.rangeTemplate=null),this.allRanges.splice(rangeConfigIdx,1)},editRangeConfig:function(rangeConfig){this.rangeTemplate=rangeConfig,this.showNewRangeTemplate=!0},setPointMeta:function(event,label,dp){var dataPoint=this.filteredDataPoints.filter((function(point){return point.clientId===parseInt(event)}));if(0!==dataPoint.length){var alias=dataPoint[0].aliases.actual;if("avg"===label)0===Object.keys(this.rangeTemplate.min).length&&0===Object.keys(this.rangeTemplate.max).length&&(this.$set(this.rangeTemplate.min,"clientId",event),this.$set(this.rangeTemplate.max,"clientId",event),this.rangeTemplate.min["fieldId"]=dataPoint[0].yAxis.fieldId,this.rangeTemplate.max["fieldId"]=dataPoint[0].yAxis.fieldId,this.rangeTemplate.min["displayName"]=dataPoint[0].name,this.rangeTemplate.max["displayName"]=dataPoint[0].name,this.rangeTemplate.min["alias"]=alias+".min",this.rangeTemplate.max["alias"]=alias+".max",this.rangeTemplate.min["aggr"]=4,this.rangeTemplate.max["aggr"]=5,this.rangeTemplate.min["parentId"]=dataPoint[0].metaData.parentIds[0],this.rangeTemplate.max["parentId"]=dataPoint[0].metaData.parentIds[0]),this.rangeTemplate.avg["fieldId"]=dataPoint[0].yAxis.fieldId,this.rangeTemplate.avg["parentId"]=dataPoint[0].metaData.parentIds[0],this.rangeTemplate.avg["aggr"]=2,this.rangeTemplate.avg["alias"]=alias+".avg";else if("min"===label){this.$set(this.rangeTemplate.min,"clientId",event),this.$set(this.rangeTemplate.min,"fieldId",dataPoint[0].yAxis.fieldId);var centrePointAlias=this.rangeTemplate.avg.alias.split(".");this.rangeTemplate.min["alias"]=centrePointAlias[0]+".min",this.rangeTemplate.min["fieldId"]=dataPoint[0].yAxis.fieldId,this.rangeTemplate.min["aggr"]=4}else{this.$set(this.rangeTemplate.max,"clientId",event),this.$set(this.rangeTemplate.max,"fieldId",dataPoint[0].yAxis.fieldId);var _centrePointAlias=this.rangeTemplate.avg.alias.split(".");this.rangeTemplate.max["alias"]=_centrePointAlias[0]+".max",this.rangeTemplate.max["fieldId"]=dataPoint[0].yAxis.fieldId,this.rangeTemplate.max["aggr"]=5}this.rangeTemplate[label].displayName=dataPoint[0].name,this.rangeTemplate[label].parentId=dataPoint[0].metaData.parentIds[0]}},addNewRangeTemplate:function(){var rangeTemplate={min:{},max:{},avg:{}};this.rangeTemplate=rangeTemplate,this.showNewRangeTemplate=!0},closeRangeDialog:function(){this.showNewRangeTemplate=!1,this.rangeTemplate=null,this.$emit("update:visibility",!1)},addAllRangePoints:function(){var _step10,allDataPoints=(0,toConsumableArray/* default */.Z)(this.filteredDataPoints),_iterator10=(0,createForOfIteratorHelper/* default */.Z)(this.usedPoints);try{var _loop5=function(){var usedPoint=_step10.value,point=allDataPoints.filter((function(f){return f.metaData.parentIds[0]+""+f.yAxis.fieldId===usedPoint.parentId+""+usedPoint.fieldId}));0!==point.length&&allDataPoints.splice(allDataPoints.indexOf(point[0]),1)};for(_iterator10.s();!(_step10=_iterator10.n()).done;)_loop5()}catch(err){_iterator10.e(err)}finally{_iterator10.f()}this.$emit("rangePoints",this.allRanges,allDataPoints),this.closeRangeDialog()}}}),components_RangeChartDialogvue_type_script_lang_js=RangeChartDialogvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_RangeChartDialogvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,RangeChartDialog=component.exports},
/***/374520:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return DrilldownBreadcrumb}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/report/components/DrilldownBreadcrumb.vue?vue&type=template&id=77c09de1
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"drilldown-breadcrumb  p5 mL90 d-flex"},[_c("div",{staticClass:"crumb-item"},[_c("span",{staticClass:"f12 bold breadcrumb-text mR5 letter-spacing0_5 ",on:{click:function($event){return _vm.handleClick(-1)}}},[_vm._v(" "+_vm._s(_vm.$t("reportdrilldown.all"))+" ")]),_c("i",{staticClass:"el-icon-arrow-right f12 mR3"})]),_vm._l(_vm.drilldownParams.drilldownCriteria,(function(drilldownCriteria,stepIndex){return _c("div",{key:stepIndex,staticClass:"crumb-item",class:[{"is-last":stepIndex==_vm.drilldownParams.drilldownCriteria.length-1}]},[_c("span",{key:"crumb-text"+stepIndex,staticClass:"f12 bold breadcrumb-text mR5 letter-spacing0_5 ",class:[{"is-last":stepIndex==_vm.drilldownParams.drilldownCriteria.length-1}],on:{click:function($event){return _vm.handleClick(stepIndex)}}},[_vm._v(" "+_vm._s(drilldownCriteria.breadcrumbLabel))]),stepIndex!=_vm.drilldownParams.drilldownCriteria.length-1?_c("i",{key:"crumb-icon"+stepIndex,staticClass:"el-icon-arrow-right f12 mR3"}):_c("i",{key:"crumb-close"+stepIndex,staticClass:"el-icon-circle-close pointer f12 hide-v",on:{click:function($event){return _vm.handleClick(stepIndex-1)}}})])}))],2)},staticRenderFns=[],DrilldownBreadcrumbvue_type_script_lang_js={props:{drilldownParams:{type:Object,default:null}},data:function(){return{}},methods:{handleClick:function(crumbIndex){
//ignore click on last item
crumbIndex!=this.drilldownParams.length-1&&this.$emit("crumbClick",crumbIndex)}}},components_DrilldownBreadcrumbvue_type_script_lang_js=DrilldownBreadcrumbvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_DrilldownBreadcrumbvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,DrilldownBreadcrumb=component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/94925.js.map