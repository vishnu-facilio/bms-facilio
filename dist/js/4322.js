"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[4322],{
/***/4322:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return Rules}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/firealarm/rules/Rules.vue?vue&type=template&id=62730fca
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("div",{staticClass:"height100 fc-list-table-container fc-table-td-height rules-list-table rules-list-page",class:_vm.$route.query.search?"fc-list-table-search-scroll":""},[-1===_vm.openRuleId?_c("div",[_vm.loading?_c("div",{staticClass:"flex-middle fc-empty-white p10 mT10 mL10"},[_c("spinner",{attrs:{show:_vm.loading,size:"80"}})],1):_vm._e(),_vm.$validation.isEmpty(_vm.rules)&&!_vm.loading?_c("div",{staticClass:"height100vh fc-empty-white flex-middle justify-content-center flex-direction-column"},[_c("inline-svg",{attrs:{src:"svgs/list-empty",iconClass:"icon text-center icon-xxxxlg"}}),_c("div",{staticClass:"mT10 fc-black-dark f16 fw6"},[_c("div",{staticClass:"mT10 label-txt-black f14"},[_vm._v(" "+_vm._s(_vm.$t("setup.users_management.no_rules_available"))+" ")])])],1):_vm._e(),_vm.loading||_vm.$validation.isEmpty(_vm.rules)?_vm._e():_c("div",{staticClass:"fc-full-table-wrap"},[_c("div",{staticClass:"pT0 height100 fc-list-table-container"},[_c("el-table",{staticStyle:{width:"100%"},attrs:{data:_vm.rules,height:"100%"}},[_c("el-table-column",{staticClass:"pL0",attrs:{fixed:"",prop:"id",label:_vm.$t("common._common.id"),width:"110"},scopedSlots:_vm._u([{key:"default",fn:function(rule){return[_c("div",{staticClass:"fc-id"},[_vm._v(_vm._s("#"+rule.row.id))])]}}],null,!1,2029234455)}),_c("el-table-column",{staticClass:"pL0",attrs:{fixed:"",prop:"id",label:_vm.$t("common._common.rule_id"),width:"350"},scopedSlots:_vm._u([{key:"default",fn:function(rule){return[_c("div",{on:{click:function($event){return _vm.openSummaryRules(rule.row.id)}}},[_c("div",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"table-subject-heading fw5 ellipsis textoverflow-ellipsis width280px",attrs:{small:"",title:rule.row.name}},[_vm._v(" "+_vm._s(rule.row.name)+" ")])])]}}],null,!1,3400443714)}),_c("el-table-column",{attrs:{prop:"assetCategoryId",label:"Type",width:"100"},scopedSlots:_vm._u([{key:"default",fn:function(rule){return[_c("div",{staticClass:"table-subheading"},[_vm._v(" "+_vm._s(rule.row.assetCategoryId>0?"Asset":"Space")+" ")])]}}],null,!1,3921488762)}),_c("el-table-column",{attrs:{prop:"assetCategoryId",label:_vm.$t("common._common.category"),width:"150"},scopedSlots:_vm._u([{key:"default",fn:function(rule){return[_c("div",{staticClass:"table-subheading",on:{click:function($event){return _vm.openSummaryRules(rule.row.id)}}},[_vm._v(" "+_vm._s(rule.row.assetCategoryId>0?_vm.getCategoryName(rule.row.assetCategoryId):"Space")+" ")])]}}],null,!1,1533667628)}),_c("el-table-column",{attrs:{label:_vm.$t("common._common.space/asset"),width:"200"},scopedSlots:_vm._u([{key:"default",fn:function(rule){return[_c("div",{staticClass:"table-subheading"},[_vm._v(" "+_vm._s(_vm.getResourceName(rule.row))+" ")])]}}],null,!1,2291470364)}),_c("el-table-column",{attrs:{prop:"alarmSeverityId",label:_vm.$t("common._common.severity"),width:"180"},scopedSlots:_vm._u([{key:"default",fn:function(rule){return[_c("div",{staticClass:"table-subheading"},[rule.row.alarmSeverityId?_c("i",{staticClass:"fa fa-circle prioritytag",style:{color:_vm.getAlarmSeverity(rule.row.alarmSeverityId).color},attrs:{"aria-hidden":"true"}}):_vm._e(),_vm._v(" "+_vm._s(rule.row.alarmSeverityId?_vm.getAlarmSeverity(rule.row.alarmSeverityId).displayName:"--")+" ")])]}}],null,!1,3010498618)}),_c("el-table-column",{attrs:{prop:"status",label:_vm.$t("common._common.status"),width:"100"},scopedSlots:_vm._u([{key:"default",fn:function(rule){return[_c("el-switch",{staticClass:"Notification-toggle",attrs:{"active-color":"rgba(57, 178, 194, 0.8)","inactive-color":"#e5e5e5"},on:{change:function($event){return _vm.changeRuleStatus(rule.row)}},model:{value:rule.row.status,callback:function($$v){_vm.$set(rule.row,"status",$$v)},expression:"rule.row.status"}})]}}],null,!1,2812123075)}),_c("el-table-column",{staticClass:"visibility-visible-actions",attrs:{prop:"",label:"",width:"100",fixed:"right"},scopedSlots:_vm._u([{key:"default",fn:function(rule){return[_c("div",{staticClass:"text-center"},[_vm.$hasPermission("alarmrules:UPDATE,UPDATE_TEAM,UPDATE_OWN")?_c("i",{staticClass:"el-icon-edit pointer visibility-hide-actions",on:{click:function($event){return _vm.editThresholdRule(rule.row)}}}):_vm._e(),_vm.$hasPermission("alarmrules:DELETE")?_c("i",{staticClass:"el-icon-delete pointer visibility-hide-actions mL10",on:{click:function($event){return _vm.deleteRule(rule.row)}}}):_vm._e()])]}}],null,!1,3904918005)}),_c("el-table-column",[void 0],2)],1)],1)])]):_c("div",{staticClass:"fc-column-view height100"},[_c("div",{staticClass:"row fc-column-view-title height100"},[_c("div",{staticClass:"rules-left-side"},[_c("div",{staticClass:"fc__layout__has__row fc__layout__box"},[_c("div",{staticClass:"fc__layout__has__row fc__submenu__left fc__layout__box"},[_c("div",{staticClass:"fc__layout_media_center fc__submenu__header fc__layout__has__columns pointer"},[_c("i",{staticClass:"el-icon-back fw6",on:{click:_vm.back}}),_c("div",{staticClass:"label-txt-black pL10"},[_c("el-popover",{attrs:{placement:"bottom",width:"200","popper-class":"popover-height inventory-list-popover",trigger:"click"},model:{value:_vm.toggle,callback:function($$v){_vm.toggle=$$v},expression:"toggle"}},[_c("ul",_vm._l(_vm.views,(function(view,index){return _c("li",{key:index,class:{active:_vm.currentViewDetail.displayName===view.displayName},on:{click:function($event){return _vm.switchCategory(view)}}},[_vm._v(" "+_vm._s(view.displayName)+" ")])})),0),_c("span",{attrs:{slot:"reference"},slot:"reference"},[_vm._v(" "+_vm._s(_vm.currentViewDetail.displayName)+" "),_c("i",{staticClass:"el-icon-arrow-down el-icon-arrow-down-tv",staticStyle:{"padding-left":"8px"}})])])],1),_c("div",{staticClass:"pointer",on:{click:_vm.toggleQuickSearch}},[_c("i",{staticClass:"fa fa-search asset__search__icon",attrs:{"aria-hidden":"true"}})]),_vm.showQuickSearch?_c("div",{staticClass:"row"},[_c("div",{staticClass:"col-12 fc-list-search"},[_c("div",{staticClass:"fc-list-search-wrapper asset__inventory_search__con"},[_c("svg",{staticClass:"search-icon-asset hide",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32"}},[_c("title",[_vm._v(_vm._s(_vm.$t("common._common.search")))]),_c("path",{attrs:{d:"M21.487 22.927l7.037 7.037c.473.473 1.238.475 1.71.003s.47-1.237-.003-1.71l-7.037-7.037c3.96-4.82 3.675-11.967-.846-16.487C17.539-.076 9.757-.092 4.966 4.699S.191 17.272 5 22.081c4.52 4.52 11.667 4.805 16.487.846zM6.679 6.413c3.848-3.848 10.099-3.836 13.962.027s3.875 10.114.027 13.962c-3.848 3.848-10.099 3.836-13.962-.027S2.831 10.261 6.679 6.413z"}})]),_c("input",{directives:[{name:"model",rawName:"v-model",value:_vm.quickSearchQuery,expression:"quickSearchQuery"}],ref:"quickSearchQuery",staticClass:"quick-search-input-asset asset__inventory__search",attrs:{autofocus:"",type:"text",placeholder:_vm.$t("common._common.search")},domProps:{value:_vm.quickSearchQuery},on:{keyup:function($event){return!$event.type.indexOf("key")&&_vm._k($event.keyCode,"enter",13,$event.key,"Enter")?null:_vm.quickSearch.apply(null,arguments)},input:function($event){$event.target.composing||(_vm.quickSearchQuery=$event.target.value)}}}),_c("svg",{staticClass:"asset__inventory__close",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32","aria-hidden":"true"},on:{click:_vm.closeSearch}},[_c("title",[_vm._v(_vm._s(_vm.$t("common._common.close")))]),_c("path",{attrs:{d:"M17.992 16l8.796-8.796a1.409 1.409 0 0 0-1.992-1.992L16 14.008 7.204 5.212a1.409 1.409 0 0 0-1.992 1.992L14.008 16l-8.796 8.796a1.409 1.409 0 0 0 1.992 1.992L16 17.992l8.796 8.796a1.409 1.409 0 0 0 1.992-1.992L17.992 16z"}})])])])]):_vm._e()]),_c("v-infinite-scroll",{staticStyle:{height:"100vh","padding-bottom":"150px","overflow-y":"scroll"},attrs:{loading:_vm.subListLoading,offset:20},on:{bottom:_vm.nextPage}},[_vm._l(_vm.rules,(function(rule){return _c("div",{key:rule.id,staticClass:"menu-item space-secondary-color sp-li ellipsis f12 pointer rule-item p20",class:{fcactivelist:_vm.openRuleId===rule.id},on:{click:function($event){return _vm.openSummaryRules(rule.id)}}},[_c("span",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"top",animation:"shift-away",arrow:!0},expression:"{\n                      placement: 'top',\n                      animation: 'shift-away',\n                      arrow: true,\n                    }"}],staticClass:"label",attrs:{title:rule.name}},[_vm._v(_vm._s(rule.name))])])})),_vm.subListLoading?_c("div",{staticClass:"menu-item space-secondary-color sp-li ellipsis f12 pointer rule-item p20"},[_c("spinner",{attrs:{show:_vm.subListLoading,size:"80"}})],1):_vm._e()],2)],1)])]),_c("div",{staticClass:"fc-column-view-right-approval"},[_c("div",{attrs:{slot:"right"},slot:"right"},[_c("router-view",{attrs:{name:"summary"}})],1)])])])])])},staticRenderFns=[],objectSpread2=__webpack_require__(595082),v_infinite_scroll=(__webpack_require__(564043),__webpack_require__(61514),__webpack_require__(169358),__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(434284),__webpack_require__(162506),__webpack_require__(670560),__webpack_require__(648324),__webpack_require__(857267),__webpack_require__(425728),__webpack_require__(561364)),v_infinite_scroll_default=__webpack_require__.n(v_infinite_scroll),vuex_esm=__webpack_require__(420629),router=__webpack_require__(329435),Rulesvue_type_script_lang_js={created:function(){this.$store.dispatch("loadAssetCategory"),this.$store.dispatch("loadAlarmSeverity")},data:function(){return{showDialog:!1,selectAll:!1,loading:!1,subListLoading:!1,thresholddialog:!1,selectedRules:null,selectedRule:null,showQuickSearch:!1,quickSearchQuery:null,toggle:!1,fetchingMore:!1,perPage:30}},title:function(){},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({currentViewDetails:function(state){return state.view.currentViewDetail},rules:function(state){return state.rule.rules},count:function(state){return state.rule.count},assetCategoryList:function(state){return state.assetCategory},views:function(state){return state.view.views},searchQuery:function(state){return state.rule.quickSearchQuery}})),(0,vuex_esm/* mapGetters */.Se)(["getAlarmSeverity"])),{},{filters:function(){return this.$route.query.search?JSON.parse(this.$route.query.search):null},canLoadMore:function(){return this.$store.state.rule.canLoadMore},scrollDisabled:function(){return this.loading||!this.canLoadMore||this.fetchingMore},openRuleId:function(){return this.$route.params.id?parseInt(this.$route.params.id):-1},currentView:function(){
// if (this.$route.query.search && this.openRuleId > -1) {
//   this.views.push({
//     displayName: 'Filtered Rules',
//     name: 'filteredRules',
//   })
//   return 'Filtered Rules Types'
// }
return this.$route.params.viewname?this.$route.params.viewname:"all"},page:function(){return this.$route.query.page||1},includeParentFilter:function(){return this.$route.query.includeParentFilter&&("true"===this.$route.query.includeParentFilter||!0===this.$route.query.includeParentFilter)},currentViewDetail:function(){return this.$route.query.search?{displayName:"Filtered Rules",name:"filteredrules"}:this.$store.state.view.currentViewDetail},moduleName:function(){return"readingrule"}}),mounted:function(){this.$store.dispatch("view/loadViews","readingrule"),this.$store.dispatch("view/loadModuleMeta","readingrule"),this.getViewDetail(),this.loadNewPageData()},methods:{getViewDetail:function(){this.$store.dispatch("view/loadViewDetail",{viewName:this.currentView,moduleName:"readingrule"})},switchCategory:function(index){var indexs;if(this.views.filter((function(d,i){"filteredRules"===d.name&&(indexs=i)})),indexs&&-1!==indexs&&this.views.splice(indexs,1),(0,router/* isWebTabsEnabled */.tj)()){this.moduleName;var _ref=(0,router/* findRouteForTab */.OD)(router/* pageTypes */.As.RULES_SUMMARY)||{},name=_ref.name;name&&this.$router.push({name:name,params:{id:this.$route.params.id,viewname:index.name},query:this.$route.query})}else this.$router.push({name:"ruleOverview",params:{viewname:index.name,id:this.$route.params.id}});this.toggle=!1},back:function(){if((0,router/* isWebTabsEnabled */.tj)()){this.moduleName;var _ref2=(0,router/* findRouteForTab */.OD)(router/* pageTypes */.As.RULES_LIST)||{},name=_ref2.name;name&&this.$router.push({name:name,params:{viewname:this.$route.params.viewname},query:this.$route.query})}else{var url="/app/fa/rules/"+this.$route.params.viewname;this.$router.push({path:url,query:this.$route.query})}},handleSelectionChange:function(val){this.multipleSelection=val},toggleQuickSearch:function(){this.showQuickSearch=!this.showQuickSearch},closeSearch:function(){this.toggleQuickSearch(),this.quickSearchQuery=null,this.quickSearch()},quickSearch:function(){this.$store.dispatch("rule/updateRuleSearchQuery",this.quickSearchQuery)},editThresholdRule:function(rule){var self=this;if((0,router/* isWebTabsEnabled */.tj)()){var _ref3=(0,router/* findRouteForTab */.OD)(router/* pageTypes */.As.RULES_EDIT)||{},name=_ref3.name;name&&this.$router.push({name:name,params:{id:rule.id},query:this.$route.query})}else self.$util.fetchRules("alarm",rule.id).then((function(rules){var url="/app/fa/rule/edit/"+rule.id;self.$router.replace({path:url}),self.$router.push(),self.selectedRules=rules,self.selectedRule=rule.id}))},openSummaryRules:function(id){if((0,router/* isWebTabsEnabled */.tj)()){this.moduleName;var _ref4=(0,router/* findRouteForTab */.OD)(router/* pageTypes */.As.RULES_SUMMARY)||{},name=_ref4.name;name&&this.$router.push({name:name,params:{id:id,viewname:this.$route.params.viewname},query:this.$route.query})}else this.$router.push({name:"ruleOverview",params:{viewname:this.$route.params.viewname,id:id},query:this.$route.query})},getCategoryName:function(categoryId){if(categoryId>0&&this.assetCategoryList){var category=this.assetCategoryList.find((function(category){return category.id===categoryId}));if(category)return category.name}},deleteRule:function(rule){var _this=this;this.$dialog.confirm({title:this.$t("common.wo_report.delete_rule_title"),message:this.$t("common.wo_report.delete_this_rule"),rbDanger:!0,rbLabel:"Delete"}).then((function(value){value&&_this.$util.deleteRule("alarm",rule.id).then((function(response){_this.loadNewPageData()}))}))},getResourceName:function(rule){if(rule.assetCategoryId>0){var message,selectedCount,isIncluded=rule.includedResources&&rule.includedResources.length;isIncluded?selectedCount=rule.includedResources.length:rule.excludedResources&&rule.excludedResources.length&&(selectedCount=rule.excludedResources.length);var categoryName=this.getCategoryName(rule.assetCategoryId);return message=selectedCount?(isIncluded?selectedCount:"Some")+" "+categoryName+(!isIncluded||selectedCount>1?"s":""):"All "+categoryName+"s",message}return rule.resourceId>0?rule.matchedResources?rule.matchedResources[Object.keys(rule.matchedResources)[0]].name:"--- ":"---"},changeRuleStatus:function(rule){var _this2=this;this.$util.changeRuleStatus("alarm",rule.id,rule.status).then((function(response){_this2.$message.success((rule.status?"Enabled":"Disabled")+" rule successfully.")})).catch((function(error){}))},nextPage:function(){this.scrollDisabled||(this.subListLoading=!0,this.fetchingMore=!0,this.loadRuleList(!0,this.state))},loadRuleList:function(subList){this.setTitle(this.currentViewDetail.displayName+" - Rules");var self=this,queryObj={subList:subList,viewname:this.currentView,page:subList?this.$store.state.rule.currentPage+1:this.page,filters:this.filters,search:this.searchQuery,isNew:!0,includeParentFilter:this.includeParentFilter};self.$store.dispatch("rule/fetchRules",queryObj).then((function(response){self.loading=!1,self.subListLoading=!1,self.fetchingMore=!1})).catch((function(error){error&&(self.loading=!1,self.subListLoading=!1,self.fetchingMore=!1)}))},loadRulesCount:function(){var self=this,queryObj={viewname:this.currentView,filters:this.filters,search:this.searchQuery,isNew:!0,isCount:!0,includeParentFilter:this.includeParentFilter};self.$store.dispatch("rule/fetchRules",queryObj).then((function(response){self.fetchingMore=!1,self.$emit("syncCount",self.count)})).catch((function(error){error&&(self.fetchingMore=!1)}))},loadNewPageData:function(){this.openRuleId>0?this.subListLoading=!0:this.loading=!0,this.resetPagination(),this.loadRuleList(),this.loadRulesCount()},resetPagination:function(){this.fetchingMore=!1,this.hasMorePages=!1,Object.assign([],this.rules)},opensummary:function(id){this.$router.push({path:"/app/fa/rules/"+this.$route.params.viewname+"/summary/"+id})}},watch:{currentView:function(newVal,oldVal){oldVal!==newVal&&this.loadNewPageData()},currentViewDetails:function(newVal,oldVal){newVal!=oldVal&&this.setTitle(this.currentViewDetails?this.currentViewDetails.displayName:" - Rules")},filters:function(newVal){this.loadNewPageData()},page:function(newVal,oldVal){oldVal===newVal||this.loading||(this.loading=!0,this.loadRuleList())},searchQuery:function(){this.loadRuleList()},search:function(newVal){this.loadNewPageData()}},components:{VInfiniteScroll:v_infinite_scroll_default()}},rules_Rulesvue_type_script_lang_js=Rulesvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(rules_Rulesvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,Rules=component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/4322.js.map