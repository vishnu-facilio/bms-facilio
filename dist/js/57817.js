"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[57817],{
/***/357817:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return SafetyPlanPrecautionList}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/safetyplan/component/SafetyPlanPrecautionList.vue?vue&type=template&id=9a877026&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticStyle:{height:"100%"}},[_vm.isLoading?_c("div",{staticClass:"flex-middle fc-empty-white"},[_c("spinner",{attrs:{show:_vm.isLoading,size:"80"}})],1):[_c("LineItemList",_vm._b({key:_vm.renderKey,ref:"lineItemComponent",staticStyle:{height:"95%"},attrs:{config:_vm.listConfiguration,moduleDisplayName:_vm.moduleDisplayName,moduleName:_vm.moduleName,widgetDetails:_vm.widgetDetails,viewname:"hidden-all"}},"LineItemList",_vm.$attrs,!1),[_c("div",{staticClass:"pL10 pointer marginR-auto",attrs:{slot:"header-additional-actions"},slot:"header-additional-actions"},[_c("FLookupField",{attrs:{disabled:_vm.$validation.isEmpty(_vm.hazardIds),model:_vm.selectedHazard,field:_vm.hazardField,hideLookupIcon:!0},on:{"update:model":function($event){_vm.selectedHazard=$event}}})],1)])]],2)},staticRenderFns=[],defineProperty=__webpack_require__(482482),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),objectSpread2=__webpack_require__(595082),LineItemListOld=(__webpack_require__(434284),__webpack_require__(450886),__webpack_require__(976801),__webpack_require__(648324),__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(666237)),api=__webpack_require__(32284),FLookupField=__webpack_require__(855048),validation=__webpack_require__(990260),eventBus=__webpack_require__(398011),EQUALS_OPERATOR=9,SafetyPlanPrecautionListvue_type_script_lang_js={props:["widget","details"],components:{LineItemList:LineItemListOld/* default */.Z,FLookupField:FLookupField/* default */.Z},data:function(){return{hazardIds:[],isLoading:!1,selectedHazard:null}},computed:{moduleName:function(){return"hazardPrecaution"},moduleDisplayName:function(){return"Precautions of"},filters:function(){var widget=this.widget,hazardIds=this.hazardIds,selectedHazard=this.selectedHazard,_ref=widget||{},relatedList=_ref.relatedList,_ref2=relatedList||{},field=_ref2.field,fieldName=(field||{}).name||"hazard",filterObj={};return(0,validation/* isEmpty */.xb)(selectedHazard)||(hazardIds=this.getStringifyHazards(selectedHazard)),(0,validation/* isEmpty */.xb)(hazardIds)?filterObj[fieldName]={operatorId:36,value:["0"]}:filterObj[fieldName]={operatorId:36,value:hazardIds},filterObj},editConfig:function(){return{canHideEdit:!0}},deleteConfig:function(){return{canHideDelete:!0}},quickCreateConfig:function(){return{canHideAddBtn:!0}},widgetDetails:function(){var moduleDisplayName=this.moduleDisplayName,emptyStateText=this.$t("common.safetyPlan.no_precaution_added",{moduleName:moduleDisplayName});return{perPage:7,emptyStateText:emptyStateText,emptyStateBtnList:[]}},listConfiguration:function(){var filters=this.filters,editConfig=this.editConfig,deleteConfig=this.deleteConfig,columnCustomConfig=this.columnCustomConfig,searchAndFilterConfig=this.searchAndFilterConfig,quickCreateConfig=this.quickCreateConfig;return(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({expand:!1,isSelectionEnabled:!1,isIndexEnabled:!1,filters:filters,mainfieldAction:function(){},canHideFooter:!0},editConfig||{}),deleteConfig||{}),columnCustomConfig||{}),quickCreateConfig||{}),searchAndFilterConfig||{}),{},{canEnableMainFieldAction:!1})},renderKey:function(){var selectedHazard=this.selectedHazard;return!(0,validation/* isEmpty */.xb)(selectedHazard)&&Array.isArray(selectedHazard)?selectedHazard.length+selectedHazard[0]:1},hazardField:function(){var hazardIds=this.hazardIds,field={isDataLoading:!1,options:[],lookupModuleName:"hazard",field:{lookupModule:{name:"hazard",displayName:"Hazards"}},multiple:!0,forceFetchAlways:!0,placeHolderText:this.$t("common.safetyPlan.all_hazards"),selectedItems:[]};return(0,validation/* isEmpty */.xb)(hazardIds)||(field["filters"]={id:{operatorId:36,value:hazardIds}}),field}},created:function(){this.fetchSafetyPlanHazards()},mounted:function(){eventBus/* eventBus */.Y.$on("refresh-sf-precautions",this.refreshList)},methods:{init:function(){this.hazardIds=[],this.selectedHazard=null},refreshList:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _this.init(),_context.next=3,_this.fetchSafetyPlanHazards();case 3:case"end":return _context.stop()}}),_callee)})))()},getStringifyHazards:function(selectedHazard){if(!(0,validation/* isEmpty */.xb)(selectedHazard)){var hazards=selectedHazard.map((function(id){return"".concat(id)}));return hazards}return null},getParentModuleName:function(){var pageModuleName=this.$attrs.moduleName,baseSpaces=["site","building","floor","space"];return baseSpaces.includes(pageModuleName)?"space":pageModuleName},fetchSafetyPlanHazards:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var _this2$details,parentModuleName,filter,params,_yield$API$fetchAll,list,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _this2.isLoading=!0,parentModuleName=_this2.getParentModuleName(),filter=(0,defineProperty/* default */.Z)({},"".concat(parentModuleName),{operatorId:EQUALS_OPERATOR,value:["".concat(null===(_this2$details=_this2.details)||void 0===_this2$details?void 0:_this2$details.id)]}),params={withCount:!0,filters:JSON.stringify(filter)},_context2.next=6,api/* API */.bl.fetchAll("".concat(parentModuleName,"Hazard"),params,{force:!0});case 6:_yield$API$fetchAll=_context2.sent,list=_yield$API$fetchAll.list,error=_yield$API$fetchAll.error,!error&&(null===list||void 0===list?void 0:list.length)>0&&(_this2.hazardIds=(list||[]).filter((function(data){var _ref3=data||{},hazard=_ref3.hazard,_ref4=hazard||{},id=_ref4.id;return!(0,validation/* isEmpty */.xb)(id)})).map((function(data){var _ref5=data||{},hazard=_ref5.hazard,_ref6=hazard||{},id=_ref6.id;return"".concat(id)}))),_this2.isLoading=!1;case 11:case"end":return _context2.stop()}}),_callee2)})))()}}},component_SafetyPlanPrecautionListvue_type_script_lang_js=SafetyPlanPrecautionListvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(component_SafetyPlanPrecautionListvue_type_script_lang_js,render,staticRenderFns,!1,null,"9a877026",null)
/* harmony default export */,SafetyPlanPrecautionList=component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/57817.js.map