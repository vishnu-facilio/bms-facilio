"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[67027],{
/***/630104:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return LabourForm}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/setup/Labour/LabourForm.vue?vue&type=template&id=cc3a1372&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticStyle:{"z-index":"999999"},attrs:{visible:_vm.dialogVisibility,fullscreen:!0,"append-to-body":!0,width:"75%","custom-class":"fc-dialog-form fc-dialog-right setup-dialog55 setup-dialog fc-tabs-layout-page"}},[_c("el-form",{ref:"labourForm",staticClass:"fc-form",attrs:{model:_vm.labourFormDetails,rules:_vm.rules}},[_c("div",{staticClass:"new-header-container"},[_c("div",{staticClass:"new-header-text"},[_c("div",{staticClass:"fc-setup-modal-title"},[_vm._v(" "+_vm._s(_vm.isNew?_vm.$t("setup.labour.form.add_labour"):_vm.$t("setup.labour.form.edit_labour"))+" ")])])]),_vm.loading?_c("div",{staticClass:"new-body-modal"},[_vm._l([1,2,3,4,5],(function(index){return _c("div",{key:index},[_c("el-row",{staticClass:"mB20"},[_c("el-col",{attrs:{span:24}},[_c("span",{staticClass:"lines loading-shimmer width50 mB10"}),_c("span",{staticClass:"inputlines loading-shimmer"})])],1)],1)})),_c("el-row",{staticClass:"mB10 mT10"},[_c("el-col",{attrs:{span:24}},[_c("span",{staticClass:"lines loading-shimmer width50 mB10"}),_c("div",{staticClass:"mT10 d-flex"},_vm._l([1,2,3],(function(index){return _c("div",{key:index,staticClass:"flex-middle flex-grow"},[_c("span",{staticClass:"circle loading-shimmer"}),_c("span",{staticClass:"lines loading-shimmer mL10 mR30 flex-grow"})])})),0)])],1)],2):_c("div",{staticClass:"new-body-modal"},[_c("div",{staticClass:"body-scroll"},[_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"name"}},[_c("p",{staticClass:"labour-input-label"},[_vm._v(" "+_vm._s(_vm.$t("setup.labour.form.name"))+" "),_c("span",{staticClass:"mandatory-field-color"},[_vm._v("*")])]),_c("el-input",{staticClass:"width100 fc-input-full-border2 labour-input",attrs:{autofocus:"",type:"text",placeholder:_vm.$t("setup.labour.form.name")},model:{value:_vm.labourFormDetails.name,callback:function($$v){_vm.$set(_vm.labourFormDetails,"name",$$v)},expression:"labourFormDetails.name"}})],1)],1)],1),_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"siteId"}},[_c("p",{staticClass:"labour-input-label"},[_vm._v(" "+_vm._s(_vm.$t("setup.labour.form.site"))+" ")]),_c("FLookupField",{staticClass:"quick-filter",attrs:{model:_vm.labourFormDetails.siteId,hideLookupIcon:!0,field:_vm.siteLookup},on:{"update:model":function($event){return _vm.$set(_vm.labourFormDetails,"siteId",$event)}}})],1)],1)],1),_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"peopleId"}},[_c("p",{staticClass:"labour-input-label"},[_vm._v(" "+_vm._s(_vm.$t("setup.labour.form.people"))+" "),_c("span",{staticClass:"mandatory-field-color"},[_vm._v("*")])]),_c("FLookupField",{staticClass:"quick-filter",attrs:{model:_vm.labourFormDetails.peopleId,disabled:_vm.fromPeople,field:_vm.peopleLookup},on:{"update:model":function($event){return _vm.$set(_vm.labourFormDetails,"peopleId",$event)},recordSelected:_vm.setPeopleEmailandPhone,showLookupWizard:function($event){_vm.showLookupFieldWizard=!0}}})],1)],1)],1),_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"email"}},[_c("p",{staticClass:"labour-input-label"},[_vm._v(" "+_vm._s(_vm.$t("setup.labour.form.email"))+" ")]),_c("el-input",{staticClass:"width100 fc-input-full-border2",attrs:{autofocus:"",disabled:_vm.disableEmail,type:"text",placeholder:_vm.$t("setup.labour.form.email")},model:{value:_vm.labourFormDetails.email,callback:function($$v){_vm.$set(_vm.labourFormDetails,"email",$$v)},expression:"labourFormDetails.email"}})],1)],1)],1),_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"phone"}},[_c("p",{staticClass:"labour-input-label"},[_vm._v(" "+_vm._s(_vm.$t("setup.labour.form.phone"))+" ")]),_c("el-input",{staticClass:"width100 fc-input-full-border2",attrs:{autofocus:"",disabled:!_vm.showEmail,type:"number",placeholder:_vm.$t("setup.labour.form.phone")},model:{value:_vm.labourFormDetails.phone,callback:function($$v){_vm.$set(_vm.labourFormDetails,"phone",$$v)},expression:"labourFormDetails.phone"}})],1)],1)],1),_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("p",{staticClass:"labour-label"},[_vm._v(" "+_vm._s(_vm.$t("setup.labour.form.Address"))+" ")])])],1),_c("el-row",{attrs:{gutter:20}},[_c("el-col",{attrs:{span:12}},[_c("el-form-item",[_c("p",{staticClass:"labour-input-label"},[_vm._v(" "+_vm._s(_vm.$t("setup.setup_profile.street"))+" ")]),_c("el-input",{staticClass:"fc-input-full-border-select2",attrs:{placeholder:_vm.$t("setup.setup_profile.enter_street")},model:{value:_vm.labourFormDetails.location.street,callback:function($$v){_vm.$set(_vm.labourFormDetails.location,"street",$$v)},expression:"labourFormDetails.location.street"}})],1)],1),_c("el-col",{attrs:{span:12}},[_c("el-form-item",[_c("p",{staticClass:"labour-input-label"},[_vm._v(" "+_vm._s(_vm.$t("setup.setup_profile.city"))+" ")]),_c("el-input",{staticClass:"fc-input-full-border-select2",attrs:{placeholder:_vm.$t("setup.setup_profile.entre_city")},model:{value:_vm.labourFormDetails.location.city,callback:function($$v){_vm.$set(_vm.labourFormDetails.location,"city",$$v)},expression:"labourFormDetails.location.city"}})],1)],1)],1),_c("el-row",{attrs:{gutter:20}},[_c("el-col",{attrs:{span:12}},[_c("el-form-item",[_c("p",{staticClass:"labour-input-label"},[_vm._v(" "+_vm._s(_vm.$t("setup.setup_profile.state"))+" ")]),_c("el-input",{staticClass:"fc-input-full-border-select2",attrs:{placeholder:_vm.$t("setup.setup_profile.enter_state")},model:{value:_vm.labourFormDetails.location.state,callback:function($$v){_vm.$set(_vm.labourFormDetails.location,"state",$$v)},expression:"labourFormDetails.location.state"}})],1)],1),_c("el-col",{attrs:{span:12}},[_c("el-form-item",[_c("p",{staticClass:"labour-input-label"},[_vm._v(" "+_vm._s(_vm.$t("setup.setup_profile.zipcode"))+" ")]),_c("el-input",{staticClass:"fc-input-full-border-select2",attrs:{type:"number",placeholder:_vm.$t("setup.setup_profile.enter_zipcode")},model:{value:_vm.labourFormDetails.location.zip,callback:function($$v){_vm.$set(_vm.labourFormDetails.location,"zip",$$v)},expression:"labourFormDetails.location.zip"}})],1)],1)],1),_c("el-row",{attrs:{gutter:20}},[_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"profile-input-group pB20"},[_c("p",{staticClass:"labour-input-label"},[_vm._v(" "+_vm._s(_vm.$t("setup.setup_profile.country"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width100",attrs:{filterable:"",clearable:"",placeholder:_vm.$t("setup.setup_profile.enter_country")},model:{value:_vm.labourFormDetails.location.country,callback:function($$v){_vm.$set(_vm.labourFormDetails.location,"country",$$v)},expression:"labourFormDetails.location.country"}},_vm._l(_vm.countryList,(function(country){return _c("el-option",{key:country.value,attrs:{label:country.label,value:String(country.value)}})})),1)],1)])],1),_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"d-flex "},[_c("p",{staticClass:"labour-input-label"},[_vm._v(" "+_vm._s(_vm.$t("setup.labour.form.rate_per_hour"))+" ")]),_c("el-tooltip",{staticClass:"mT15 mL5",attrs:{effect:"dark",placement:"top"}},[_c("div",{attrs:{slot:"content"},slot:"content"},[_vm._v(" "+_vm._s(_vm.$t("setup.labour.tooltipcontent1"))+" "),_c("br"),_vm._v(" "+_vm._s(_vm.$t("setup.labour.tooltipcontent2"))+" "),_c("br"),_vm._v(" "+_vm._s(_vm.$t("setup.labour.tooltipcontent3"))+" ")]),_c("inline-svg",{attrs:{src:"svgs/info-2",iconClass:"icon icon-xs"}})],1)],1),_c("el-input",{staticClass:"width100 fc-input-full-border2 mB20",attrs:{placeholder:_vm.$t("setup.labour.form.enter_rate"),type:"number"},model:{value:_vm.labourFormDetails.cost,callback:function($$v){_vm.$set(_vm.labourFormDetails,"cost",$$v)},expression:"labourFormDetails.cost"}})],1)],1),_c("el-row",[_c("p",{staticClass:"labour-label"},[_vm._v(" "+_vm._s(_vm.$t("setup.labour.form.craftandskills"))+" ")])]),_c("LabourCraftBuilder",{ref:"labourCraftBuilder",attrs:{editLabourCraftSkill:_vm.labourFormDetails.labourCraftSkill},on:{"update:editLabourCraftSkill":function($event){return _vm.$set(_vm.labourFormDetails,"labourCraftSkill",$event)},"update:edit-labour-craft-skill":function($event){return _vm.$set(_vm.labourFormDetails,"labourCraftSkill",$event)}}})],1)]),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel mT12",on:{click:function($event){return _vm.closeDialog()}}},[_vm._v(" "+_vm._s(_vm.$t("common._common.cancel"))+" ")]),_c("el-button",{staticClass:"modal-btn-save mT12",attrs:{type:"primary"},on:{click:function($event){return _vm.submitForm()}}},[_vm._v(" "+_vm._s(_vm.saving?_vm.$t("common._common._saving"):_vm.$t("common._common._save"))+" ")])],1)]),_vm.showLookupFieldWizard?[_vm.isNewLookupWizardEnabled?_c("LookupWizard",{attrs:{canShowLookupWizard:_vm.showLookupFieldWizard,field:_vm.peopleLookup},on:{"update:canShowLookupWizard":function($event){_vm.showLookupFieldWizard=$event},"update:can-show-lookup-wizard":function($event){_vm.showLookupFieldWizard=$event},setLookupFieldValue:_vm.setLookupFieldValue}}):_c("FLookupFieldWizard",{attrs:{canShowLookupWizard:_vm.showLookupFieldWizard,selectedLookupField:_vm.peopleLookup},on:{"update:canShowLookupWizard":function($event){_vm.showLookupFieldWizard=$event},"update:can-show-lookup-wizard":function($event){_vm.showLookupFieldWizard=$event},setLookupFieldValue:_vm.setLookupFieldValue}})]:_vm._e()],2)},staticRenderFns=[],objectSpread2=__webpack_require__(595082),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),countries=(__webpack_require__(821057),__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(450886),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(434284),__webpack_require__(587207)),FLookupField=__webpack_require__(855048),LabourCraftBuildervue_type_template_id_2da5e24c_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("div",[_c("el-row",{staticClass:"margin-bottom: 10px",attrs:{gutter:10}},[_c("el-col",{attrs:{span:3}},[_c("p",{staticClass:"labourcraft-label"},[_vm._v(" "+_vm._s(_vm.$t("setup.labour.labourcraftbuilder.default"))+" ")])]),_c("el-col",{attrs:{span:6}},[_c("p",{staticClass:"labourcraft-label"},[_vm._v(" "+_vm._s(_vm.$t("setup.labour.labourcraftbuilder.craft"))+" ")])]),_c("el-col",{attrs:{span:6}},[_c("p",{staticClass:"labourcraft-label"},[_vm._v(" "+_vm._s(_vm.$t("setup.labour.labourcraftbuilder.skill"))+" ")])]),_c("el-col",{attrs:{span:6}},[_c("p",{staticClass:"labourcraft-label"},[_vm._v(" "+_vm._s(_vm.$t("setup.labour.labourcraftbuilder.rateperhour"))+" ")])])],1)],1),_vm._l(_vm.labourCraftSkillList,(function(craftAndSkill,index){return _c("div",{key:index},[_c("div",[_c("el-row",{staticClass:"mB10",attrs:{gutter:10}},[_c("el-col",{attrs:{span:3}},[_c("el-radio",{staticClass:"fc-radio-btn mT10 labourcraft-radio-button-colour setup-labour-craft-radio",attrs:{label:index},model:{value:_vm.defaultId,callback:function($$v){_vm.defaultId=$$v},expression:"defaultId"}},[_vm._v(" "+_vm._s("")+" ")])],1),_c("el-col",{attrs:{span:6}},[_c("el-select",{staticClass:"width100 fc-input-full-border2",attrs:{autofocus:"",type:"text",filterable:"",clearable:"",remote:!0,"remote-method":_vm.remoteSearchCrafts,placeholder:_vm.$t("setup.labour.labourcraftbuilder.select_craft")},on:{change:function($event){return _vm.fetchSkillforCraft(index)}},model:{value:craftAndSkill.craftId,callback:function($$v){_vm.$set(craftAndSkill,"craftId",$$v)},expression:"craftAndSkill.craftId"}},_vm._l(_vm.craftlist,(function(craft){return _c("el-option",{key:craft.id,attrs:{label:craft.name,value:craft.id}})})),1)],1),_c("el-col",{attrs:{span:6}},[_c("el-select",{staticClass:"width100 fc-input-full-border2",attrs:{autofocus:"",clearable:"",type:"text",disabled:!craftAndSkill.craftId,loading:craftAndSkill.skillOptionLoading,placeholder:_vm.$t("setup.labour.labourcraftbuilder.select_skill")},on:{change:function($event){return _vm.fetchSkillRate(index,craftAndSkill.skillId)}},model:{value:craftAndSkill.skillId,callback:function($$v){_vm.$set(craftAndSkill,"skillId",$$v)},expression:"craftAndSkill.skillId"}},_vm._l(craftAndSkill.skillOptions,(function(skill){return _c("el-option",{key:skill.id,attrs:{label:skill.name,value:skill.id}})})),1)],1),_c("el-col",{attrs:{span:6}},[_c("el-input",{staticClass:"width100 fc-input-full-border2",attrs:{disabled:"",autofocus:"",type:"number",placeholder:_vm.$t("setup.labour.labourcraftbuilder.enter_rate")},model:{value:craftAndSkill.rate,callback:function($$v){_vm.$set(craftAndSkill,"rate",$$v)},expression:"craftAndSkill.rate"}})],1),_c("el-col",{attrs:{span:1}},[_c("div",{on:{click:_vm.addlabourCraft}},[_c("inline-svg",{staticClass:"delete-icon m10",attrs:{src:"add-icon",iconClass:"icon icon-md"}})],1)]),_c("el-col",{attrs:{span:1}},[_vm.labourCraftSkillList.length>1?_c("div",{on:{click:function($event){return _vm.subtractCraft(craftAndSkill)}}},[_c("inline-svg",{staticClass:"delete-icon m10",attrs:{src:"remove-icon",iconClass:"icon icon-md"}})],1):_vm._e()])],1)],1)])}))],2)},LabourCraftBuildervue_type_template_id_2da5e24c_scoped_true_staticRenderFns=[],api=(__webpack_require__(339772),__webpack_require__(947522),__webpack_require__(648324),__webpack_require__(670560),__webpack_require__(162506),__webpack_require__(32284)),cloneDeep=__webpack_require__(150361),cloneDeep_default=__webpack_require__.n(cloneDeep),validation=__webpack_require__(990260),debounce=__webpack_require__(23279),debounce_default=__webpack_require__.n(debounce),craftAndSkillModel={craftId:null,skillId:null,rate:null,skillOptions:[],isDefault:!1,skillOptionLoading:!1},LabourCraftBuildervue_type_script_lang_js={props:["editLabourCraftSkill"],data:function(){return{craftlist:[],loading:!1,rate:"",skills:[],deleteLabourCraftList:[],currentCraftRate:null,defaultId:null}},created:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var defaultId;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return(0,validation/* isEmpty */.xb)(_this.editLabourCraftSkill)||(defaultId=_this.editLabourCraftSkill.findIndex((function(labour){return labour.isDefault})),-1!==defaultId&&(_this.defaultId=defaultId)),_context.next=3,_this.fetchCraftList();case 3:case"end":return _context.stop()}}),_callee)})))()},computed:{labourCraftSkillList:{get:function(){return this.editLabourCraftSkill},set:function(val){this.$emit("update:editLabourCraftSkill",val)}}},watch:{defaultId:function(newVal){var _this2=this;(0,validation/* isNullOrUndefined */.le)(newVal)||this.labourCraftSkillList.forEach((function(craftSkill,index){var isDefault=!1;index===parseInt(newVal)&&(isDefault=!0),_this2.$set(craftSkill,"isDefault",isDefault)}))}},methods:{fetchCraftList:function(props){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var _ref,filters,params,_yield$API$fetchAll,list,error,message;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _this3.loading=!0,_ref=props||{},filters=_ref.filters,params={page:1,perPage:20,withCount:!0,moduleName:"crafts"},(0,validation/* isEmpty */.xb)(filters)||(params=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},params),{},{filters:JSON.stringify(filters)})),_context2.next=6,api/* API */.bl.fetchAll("crafts",params);case 6:_yield$API$fetchAll=_context2.sent,list=_yield$API$fetchAll.list,error=_yield$API$fetchAll.error,error?(message=error.message,_this3.$message.error(message||_this3.$t("setup.labour.labourcraftbuilder.fetch_craft_error"))):_this3.craftlist=list||[],_this3.loading=!1;case 11:case"end":return _context2.stop()}}),_callee2)})))()},remoteSearchCrafts:debounce_default()(function(){var _ref2=(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(searchText){var filters;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:(0,validation/* isEmpty */.xb)(searchText)||(filters={name:{operatorId:5,value:["".concat(searchText)]}},this.fetchCraftList({filters:filters}));case 1:case"end":return _context3.stop()}}),_callee3,this)})));return function(_x){return _ref2.apply(this,arguments)}}(),1e3),fetchSkillforCraft:function(index){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){var labourCraftSkillList,craftObj,_ref3,craftId,_yield$API$fetchRecor,crafts,error,_ref4,skills,_ref5,standardRate,_labourCraftSkillList;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:if(!(0,validation/* isEmpty */.xb)(_this4.labourCraftSkillList[index].craftId)){_context4.next=6;break}labourCraftSkillList=_this4.labourCraftSkillList.map((function(item,itemIndex){return index===itemIndex?(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},item),{},{rate:null,skillId:null}):item})),_this4.labourCraftSkillList=labourCraftSkillList,_this4.currentCraftRate=null,_context4.next=20;break;case 6:return craftObj=_this4.labourCraftSkillList[index],craftObj.skillOptionLoading=!0,_ref3=craftObj||{},craftId=_ref3.craftId,_context4.next=11,api/* API */.bl.fetchRecord("crafts",{id:craftId});case 11:_yield$API$fetchRecor=_context4.sent,crafts=_yield$API$fetchRecor.crafts,error=_yield$API$fetchRecor.error,error?_this4.$message.error(error.message||_this4.$t("setup.labour.labourcraftbuilder.fetch_craft_error")):(_ref4=crafts||{},skills=_ref4.skills,craftObj.skillOptions=skills),craftObj.skillOptionLoading=!1,_ref5=crafts||{},standardRate=_ref5.standardRate,_this4.currentCraftRate=standardRate,_labourCraftSkillList=_this4.labourCraftSkillList.map((function(item,itemIndex){return index===itemIndex?(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},item),{},{rate:standardRate,skillId:null}):item})),_this4.labourCraftSkillList=_labourCraftSkillList;case 20:case"end":return _context4.stop()}}),_callee4)})))()},fetchSkillRate:function(index,skillId){var modifyRate=null;if((0,validation/* isEmpty */.xb)(skillId)){var currentCraftRate=this.currentCraftRate;modifyRate=currentCraftRate}else{var skillobj=this.$getProperty(this,"labourCraftSkillList.".concat(index,".skillOptions"));skillobj=skillobj.filter((function(skill){if(skill.id===skillId)return skill})),modifyRate=this.$getProperty(skillobj,"0.standardRate")}this.labourCraftSkillList=this.labourCraftSkillList.map((function(item,itemIndex){return index===itemIndex?(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},item),{},{rate:modifyRate}):item}))},addlabourCraft:function(){var craftAndSkillModelObj=cloneDeep_default()(craftAndSkillModel);craftAndSkillModelObj.craftId=null,craftAndSkillModelObj.skillId=null,craftAndSkillModelObj.rate=null,craftAndSkillModelObj.skillOptions=[],this.labourCraftSkillList.push(craftAndSkillModelObj)},subtractCraft:function(deletedCraft){var index=this.labourCraftSkillList.findIndex((function(labourCraftSkill){return labourCraftSkill.id===deletedCraft.id}));-1!=index&&this.labourCraftSkillList.splice(index,1),this.deleteLabourCraftList.push(deletedCraft.id)}}},Labour_LabourCraftBuildervue_type_script_lang_js=LabourCraftBuildervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(Labour_LabourCraftBuildervue_type_script_lang_js,LabourCraftBuildervue_type_template_id_2da5e24c_scoped_true_render,LabourCraftBuildervue_type_template_id_2da5e24c_scoped_true_staticRenderFns,!1,null,"2da5e24c",null)
/* harmony default export */,LabourCraftBuilder=component.exports,FLookupFieldWizard=__webpack_require__(499751),ui_forms=__webpack_require__(141323),peopleLookup={isDataLoading:!1,options:[],lookupModuleName:"people",field:{lookupModule:{name:"people",displayName:"Peoples"}},forceFetchAlways:!0,filters:{labour:{operatorId:15,value:["false"]}},multiple:!1,isDisabled:!1},siteLookup={isDataLoading:!1,options:[],lookupModuleName:"site",field:{lookupModule:{name:"site",displayName:"Sites"}},filters:{},multiple:!1,forceFetchAlways:!0,isDisabled:!1},LabourFormvue_type_script_lang_js={props:["editLabourDetails","isNew","fromPeople"],data:function(){return{saving:!1,showLookupFieldWizard:!1,dialogVisibility:!0,labourFormDetails:{name:null,siteId:null,peopleId:null,location:{street:null,city:null,state:null,zip:null,country:null,lat:1.1,lng:1.1},availability:!1,email:null,phone:null,cost:null,labourCraftSkill:[{craftId:null,skillId:null,rate:null,isDefault:!1,skillOptions:[]}]},peopleLookup:peopleLookup,siteLookup:siteLookup,loading:!1,countryList:countries/* default */.Z,showEmail:!1,rules:{name:{required:!0,message:this.$t("setup.labour.mandatory_fields.name"),trigger:"blur"},peopleId:{required:!0,validator:function(rule,value,callback){(0,validation/* isEmpty */.xb)(value)?callback(new Error(this.$t("setup.labour.mandatory_fields.people"))):callback()}.bind(this),trigger:"change"}}}},components:{FLookupField:FLookupField/* default */.Z,FLookupFieldWizard:FLookupFieldWizard["default"],LookupWizard:ui_forms/* LookupWizard */.ns,LabourCraftBuilder:LabourCraftBuilder},created:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.next=2,_this.initCraft();case 2:case"end":return _context.stop()}}),_callee)})))()},computed:{isNewLookupWizardEnabled:function(){return this.$helpers.isLicenseEnabled("NEW_LOOKUP_WIZARD")},disableEmail:function(){var showEmail=this.showEmail,fromPeople=this.fromPeople;return!showEmail||fromPeople}},methods:{setLookupFieldValue:function(field){var selectedItems=this.$getProperty(field,"field.selectedItems",[]);if(!(0,validation/* isEmpty */.xb)(selectedItems)){var selectedItem=selectedItems[0];this.labourFormDetails.peopleId=null===selectedItem||void 0===selectedItem?void 0:selectedItem.value,this.setPeopleEmailandPhone(selectedItem)}},initCraft:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var fromPeople,isNew;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if(fromPeople=_this2.fromPeople,isNew=_this2.isNew,!isNew||fromPeople){_context2.next=3;break}return _context2.abrupt("return");case 3:return _this2.loading=!0,_context2.next=6,_this2.deserializelabour();case 6:_this2.labourFormDetails=_context2.sent,_this2.loading=!1;case 8:case"end":return _context2.stop()}}),_callee2)})))()},submitForm:function(){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var labourData,_yield$API$createReco,error,deletingLabourCraft,_yield$API$deleteReco,_error,message,_yield$API$updateReco,_error2;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:if(labourData=_this3.serializeLabour(),!_this3.isNew){_context3.next=9;break}return _context3.next=4,api/* API */.bl.createRecord("labour",{data:labourData});case 4:_yield$API$createReco=_context3.sent,error=_yield$API$createReco.error,error?_this3.$message.error(error.message||"setup.labour.add_failure_message"):(_this3.$message.success(_this3.$t("setup.labour.add_success_message")),_this3.$emit("onSubmit"),_this3.closeDialog()),_context3.next=21;break;case 9:if(deletingLabourCraft=_this3.$refs["labourCraftBuilder"].deleteLabourCraftList,(0,validation/* isEmpty */.xb)(deletingLabourCraft)){_context3.next=16;break}return _context3.next=13,api/* API */.bl.deleteRecord("labourCraftSkill",deletingLabourCraft);case 13:_yield$API$deleteReco=_context3.sent,_error=_yield$API$deleteReco.error,_error?(message=_error.message,_this3.$message.error(message||_this3.$t("setup.labour.labourCraft_delete_error_message"))):_this3.$message.success(_this3.$t("setup.labour.labourCraft_delete_success_message"));case 16:return _context3.next=18,api/* API */.bl.updateRecord("labour",{data:labourData,id:_this3.editLabourDetails.id});case 18:_yield$API$updateReco=_context3.sent,_error2=_yield$API$updateReco.error,_error2?_this3.$message.error(_error2.message||"error"):(_this3.$message.success(_this3.$t("setup.labour.update_success_message")),_this3.$emit("onSubmit"),_this3.closeDialog());case 21:_this3.closeDialog();case 22:case"end":return _context3.stop()}}),_callee3)})))()},setPeopleEmailandPhone:function(peopleData){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){var _yield$API$fetchRecor,people,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:if(!(0,validation/* isEmpty */.xb)(peopleData)){_context4.next=6;break}_this4.labourFormDetails.email="",_this4.labourFormDetails.phone="",_this4.showEmail=!1,_context4.next=12;break;case 6:return _context4.next=8,api/* API */.bl.fetchRecord("people",{id:peopleData.value});case 8:_yield$API$fetchRecor=_context4.sent,people=_yield$API$fetchRecor.people,error=_yield$API$fetchRecor.error,error?_this4.$message.error(error.message||"error"):(_this4.labourFormDetails.email=_this4.$getProperty(people,"email",""),_this4.labourFormDetails.phone=_this4.$getProperty(people,"phone",""),_this4.showEmail=!0);case 12:case"end":return _context4.stop()}}),_callee4)})))()},serializeLabourCraftSkill:function(){var labourCraftSkill=this.labourFormDetails.labourCraftSkill,filtereLabourCraftSkill=(labourCraftSkill||[]).filter((function(craftSkill){return!(0,validation/* isEmpty */.xb)(craftSkill.craftId)})),serializedLabourCraftSkill=filtereLabourCraftSkill.map((function(craftSkill){var _ref=craftSkill||{},craftId=_ref.craftId,skillId=_ref.skillId,rate=_ref.rate,id=_ref.id,isDefault=_ref.isDefault,craft={id:craftId},skill={id:skillId||null};return{craft:craft,skill:skill,rate:(0,validation/* isEmpty */.xb)(rate)?0:parseInt(rate),isDefault:isDefault,id:id}}));return serializedLabourCraftSkill},serializeLabour:function(){var labourData=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},this.labourFormDetails),{},{labourCraftSkill:this.serializeLabourCraftSkill()}),_ref2=labourData||{},peopleId=_ref2.peopleId,cost=_ref2.cost,people={id:peopleId};return delete labourData.peopleId,labourData.people=people,labourData.location.zip=parseInt(labourData.location.zip),labourData.cost=(0,validation/* isEmpty */.xb)(cost)?0:parseInt(cost),labourData.phone=parseInt(labourData.phone),labourData.availability=!0,labourData},deserializeCraftAndSkills:function(craftSkills){return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee6(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context6){while(1)switch(_context6.prev=_context6.next){case 0:return _context6.next=2,Promise.all((craftSkills||[]).map(function(){var _ref3=(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee5(labourDetail){var _ref4,craft,skill,rate,_ref4$isDefault,isDefault,id,_ref5,craftId,_yield$API$fetchRecor2,crafts;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context5){while(1)switch(_context5.prev=_context5.next){case 0:return _ref4=labourDetail||{},craft=_ref4.craft,skill=_ref4.skill,rate=_ref4.rate,_ref4$isDefault=_ref4.isDefault,isDefault=void 0!==_ref4$isDefault&&_ref4$isDefault,id=_ref4.id,_ref5=craft||{},craftId=_ref5.id,_context5.next=4,api/* API */.bl.fetchRecord("crafts",{id:craftId});case 4:return _yield$API$fetchRecor2=_context5.sent,crafts=_yield$API$fetchRecor2.crafts,_context5.abrupt("return",{id:id,craftId:craftId,skillId:null===skill||void 0===skill?void 0:skill.id,rate:rate,isDefault:isDefault,skillOptions:(null===crafts||void 0===crafts?void 0:crafts.skills)||[]});case 7:case"end":return _context5.stop()}}),_callee5)})));return function(_x){return _ref3.apply(this,arguments)}}()));case 2:return _context6.abrupt("return",_context6.sent);case 3:case"end":return _context6.stop()}}),_callee6)})))()},deserializelabour:function(){var _this5=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee7(){var _ref6,name,id,siteId,email,phone,cost,people,labourCrafts,location,locationId,_ref7,peopleId,labourCraftSkill,labourObj,locationInfo,labourCraftSkillList;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context7){while(1)switch(_context7.prev=_context7.next){case 0:return _ref6=_this5.editLabourDetails||{},name=_ref6.name,id=_ref6.id,siteId=_ref6.siteId,email=_ref6.email,phone=_ref6.phone,cost=_ref6.cost,people=_ref6.people,labourCrafts=_ref6.labourCrafts,location=_ref6.location,locationId=_ref6.locationId,_ref7=people||{},peopleId=_ref7.id,_context7.next=4,_this5.deserializeCraftAndSkills(labourCrafts);case 4:return labourCraftSkill=_context7.sent,(0,validation/* isEmpty */.xb)(peopleId)||(_this5.showEmail=!0),labourObj={name:name,id:id,email:email,phone:phone,siteId:siteId,cost:cost,peopleId:peopleId,locationId:locationId,labourCraftSkill:labourCraftSkill},locationInfo={},labourCraftSkillList=[],locationInfo=(0,validation/* isEmpty */.xb)(location)?{street:null,city:null,state:null,zip:null,country:null,lat:1.1,lng:1.1}:location,labourCraftSkillList=(0,validation/* isEmpty */.xb)(labourCraftSkill)?[{craftId:null,skillId:null,rate:null,isDefault:!1,skillOptions:[]}]:labourCraftSkill,labourObj=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},labourObj),{},{location:locationInfo,labourCraftSkill:labourCraftSkillList}),_context7.abrupt("return",labourObj);case 13:case"end":return _context7.stop()}}),_callee7)})))()},closeDialog:function(){this.$emit("onClose")}}},Labour_LabourFormvue_type_script_lang_js=LabourFormvue_type_script_lang_js,LabourForm_component=(0,componentNormalizer/* default */.Z)(Labour_LabourFormvue_type_script_lang_js,render,staticRenderFns,!1,null,"cc3a1372",null)
/* harmony default export */,LabourForm=LabourForm_component.exports},
/***/456337:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return NewPersonForm}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/setup/people/NewPersonForm.vue?vue&type=template&id=12ae6ad4
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticStyle:{"z-index":"999999"},attrs:{visible:_vm.showPersonDialog,fullscreen:!0,"custom-class":"fc-dialog-form setup-dialog-right setup-dialog45 setup-dialog show-right-dialog","before-close":_vm.closeDialog},on:{"update:visible":function($event){_vm.showPersonDialog=$event}}},[_c("el-form",{ref:"personForm",attrs:{model:_vm.person,rules:_vm.rules,"label-position":"top"}},[_c("div",{staticClass:"new-header-container"},[_c("div",{staticClass:"new-header-text"},[_c("div",{staticClass:"fc-setup-modal-title"},[_vm._v(" "+_vm._s(_vm.formTitle)+" ")])])]),_c("div",{staticClass:"new-body-modal"},[_c("el-row",{attrs:{gutter:20}},[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"name",label:_vm.$t("setup.users_management._name"),required:!0}},[_c("el-input",{staticClass:"fc-input-full-border2",attrs:{autofocus:!0,placeholder:_vm.$t("setup.users_management.enter_name")},model:{value:_vm.person.name,callback:function($$v){_vm.$set(_vm.person,"name",$$v)},expression:"person.name"}})],1)],1)],1),_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"email",label:_vm.$t("setup.users_management.email"),required:!0}},[_c("el-input",{staticClass:"fc-input-full-border2",attrs:{type:"text",autocomplete:"off",disabled:!_vm.isNew,placeholder:_vm.$t("setup.users_management._enter_email")},model:{value:_vm.person.email,callback:function($$v){_vm.$set(_vm.person,"email",$$v)},expression:"person.email"}})],1)],1)],1),_c("el-row",{staticClass:"mT20",attrs:{gutter:20}},[_c("el-col",{attrs:{span:12}},[_c("el-form-item",{attrs:{label:_vm.$t("setup.users_management.phone_number"),prop:"phone"}},[_c("el-input",{staticClass:"fc-input-full-border2",attrs:{type:"number",autocomplete:"off",placeholder:_vm.$t("setup.users_management.enter_phone_number")},model:{value:_vm.person.phone,callback:function($$v){_vm.$set(_vm.person,"phone",$$v)},expression:"person.phone"}})],1)],1)],1)],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.closeDialog}},[_vm._v(" "+_vm._s(_vm.$t("setup.users_management.cancel"))+" ")]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.isSaving},on:{click:_vm.savePerson}},[_vm._v(" "+_vm._s(_vm.saveBtn)+" ")])],1)])],1)},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),api=(__webpack_require__(821057),__webpack_require__(228436),__webpack_require__(564043),__webpack_require__(907409),__webpack_require__(32284)),validation=__webpack_require__(990260),cloneDeep=__webpack_require__(150361),cloneDeep_default=__webpack_require__.n(cloneDeep),NewPersonFormvue_type_script_lang_js={name:"NewPerson",data:function(){var _this=this;return{person:{name:"",email:"",phone:""},isSaving:!1,rules:{name:[{required:!0,message:this.$t("setup.users_management.please_enter_name"),trigger:"blur"}],email:[{required:!0,validator:function(rule,email,callback){if((0,validation/* isEmpty */.xb)(email))callback(new Error(_this.$t("setup.users_management._enter_email")));else{email=email.trim();var emailRegx=/^(([^<>()\\[\]\\.,;:\s@"]+(\.[^<>()\\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;!emailRegx.test(email)&&_this.isNew?callback(new Error(_this.$t("setup.users_management._valid_email"))):callback()}},trigger:"blur"}]}}},props:["isNew","selectedPerson","showPersonDialog"],created:function(){var isNew=this.isNew,selectedPerson=this.selectedPerson;isNew||(0,validation/* isEmpty */.xb)(selectedPerson)||(this.person=cloneDeep_default()(selectedPerson))},computed:{saveBtn:function(){var isSaving=this.isSaving;return isSaving?this.$t("setup.users_management.saving"):this.$t("setup.users_management.save")},formTitle:function(){var isNew=this.isNew;return isNew?this.$t("setup.users_management.new_person"):this.$t("setup.users_management.edit_person")},moduleName:function(){return"people"}},methods:{closeDialog:function(){this.$emit("closeDialog",!0)},savePerson:function(){var _this2=this;this.$refs["personForm"].validate(function(){var _ref=(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(valid){var person,moduleName,isNew,promise,_ref2,id,_ref3,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(_this2.isSaving=!0,valid){_context.next=3;break}return _context.abrupt("return");case 3:if(person=_this2.person,moduleName=_this2.moduleName,isNew=_this2.isNew,!isNew){_context.next=10;break}return _context.next=7,api/* API */.bl.createRecord(moduleName,{data:person});case 7:promise=_context.sent,_context.next=14;break;case 10:return _ref2=person||{},id=_ref2.id,_context.next=13,api/* API */.bl.updateRecord(moduleName,{id:id,data:person});case 13:promise=_context.sent;case 14:_ref3=promise||{},error=_ref3.error,error?_this2.$message.error(error.message||"Error Occured"):(_this2.$emit("savePerson"),isNew?_this2.$message.success(_this2.$t("setup.users_management.people_created")):_this2.$message.success(_this2.$t("setup.users_management.people_updated")));case 16:case"end":return _context.stop()}}),_callee)})));return function(_x){return _ref.apply(this,arguments)}}()),this.isSaving=!1}}},people_NewPersonFormvue_type_script_lang_js=NewPersonFormvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(people_NewPersonFormvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,NewPersonForm=component.exports},
/***/775286:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return PeopleSummary}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/setup/people/PeopleSummary.vue?vue&type=template&id=63164750&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"fc-setup-summary"},[_vm.isLoading?_c("div",{staticClass:"p20 fc-setup-page-loader-height"},[_c("SetupLoader",{scopedSlots:_vm._u([{key:"setupLoading",fn:function(){return[_c("spinner",{attrs:{show:_vm.isLoading,size:"80"}})]},proxy:!0}],null,!1,3036156284)})],1):_c("div",[_c("el-header",{staticClass:"fc-setup-summary-header pT10 people-header"},[_c("div",{staticClass:"flex-middle fc-setup-breadcrumb"},[_c("div",{staticClass:"fc-setup-breadcrumb-inner pointer",on:{click:_vm.setupHomeRoute}},[_vm._v(" "+_vm._s(_vm.$t("common.products.home"))+" ")]),_c("div",{staticClass:"fc-setup-breadcrumb-inner pL10 pR10"},[_c("i",{staticClass:"el-icon-arrow-right f14 fwBold"})]),_c("div",{staticClass:"fc-setup-breadcrumb-inner pointer",on:{click:_vm.setupPeopleRoute}},[_vm._v(" "+_vm._s(_vm.$t("setup.users_management.people"))+" ")]),_c("div",{staticClass:"fc-setup-breadcrumb-inner pL10 pR10"},[_c("i",{staticClass:"el-icon-arrow-right f14 fwBold"})]),_c("div",{staticClass:"fc-breadcrumbBold-active"},[_vm._v("# "+_vm._s(_vm.peopleId))])]),_c("div",{staticClass:"display-flex-between-space pT10"},[_c("div",{staticClass:"d-flex"},[_c("Avatar",{attrs:{size:"lg",user:{name:_vm.getPersonProperty("name","---")}}}),_c("div",{staticClass:"d-flex flex-middle fc-grey-txt18"},[_vm._v(" "+_vm._s(_vm.getPersonProperty("name","---"))+" ")])],1),_c("el-dropdown",{staticClass:"pointer",on:{command:function($event){return _vm.onOptionsSelect($event,_vm.selectedPerson)}}},[_c("span",{staticClass:"el-dropdown-link"},[_c("i",{staticClass:"el-icon-more fc-black2-18 text-left rotate-90 "})]),_c("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[_c("el-dropdown-item",{attrs:{command:"edit"}},[_vm._v(_vm._s(_vm.$t("setup.users_management.edit_person")))])],1)],1)],1)]),_c("el-tabs",{model:{value:_vm.peopleSummaryTab,callback:function($$v){_vm.peopleSummaryTab=$$v},expression:"peopleSummaryTab"}},[_c("el-tab-pane",{attrs:{label:_vm.$t("setup.users_management.summary"),name:"summary"}},[_c("div",{staticClass:"fc-grey3-text14 bold"},[_vm._v(" "+_vm._s(_vm.$t("setup.users_management.basic_information"))+" ")]),_c("el-card",{staticClass:"fc-setup-summary-card heightInitial mB20 mT15",attrs:{shadow:"never"}},[_c("el-row",{attrs:{gutter:24}},[_c("el-col",{attrs:{span:6}},[_c("div",{staticClass:"fc-grey2-text12 bold line-height20"},[_vm._v(" "+_vm._s(_vm.$t("setup.approvalprocess.name"))+" ")]),_c("div",{staticClass:"fc-black-14 text-left bold mT5   break-word"},[_vm._v(" "+_vm._s(_vm.getPersonProperty("name","---"))+" ")])]),_c("el-col",{attrs:{span:8}},[_c("div",{staticClass:"fc-grey2-text12 bold line-height20"},[_vm._v(" "+_vm._s(_vm.$t("setup.from_address.email"))+" ")]),_c("div",{staticClass:"fc-black-14 text-left bold mT5 break-word"},[_vm._v(" "+_vm._s(_vm.getPersonProperty("email","---"))+" ")])]),_c("el-col",{attrs:{span:4}},[_c("div",{staticClass:"fc-grey2-text12 bold line-height20"},[_vm._v(" "+_vm._s(_vm.$t("setup.users_management.phone"))+" ")]),_c("div",{staticClass:"fc-black-14 text-left bold mT5 break-word"},[_vm._v(" "+_vm._s(_vm.getPersonProperty("phone","---"))+" ")])]),_c("el-col",{attrs:{span:6}},[_c("div",{staticClass:"fc-grey2-text12 bold line-height20"},[_vm._v(" "+_vm._s(_vm.$t("setup.users_management.people_type"))+" ")]),_c("div",{staticClass:"fc-black-14 text-left bold mT5 break-word"},[_vm._v(" "+_vm._s(_vm.peopleType)+" ")])]),_c("el-col",{staticClass:"mT15",attrs:{span:6}},[_c("div",{staticClass:"fc-grey2-text12 bold line-height20"},[_vm._v(" "+_vm._s(_vm.$t("setup.users_management.is_person_labour"))+" ")]),_c("div",{staticClass:"fc-black-14 text-left bold mT5 break-word"},[_vm._v(" "+_vm._s(_vm.isLabour)+" ")])])],1)],1),_c("div",{staticClass:"fc-grey3-text14 bold"},[_vm._v(" "+_vm._s(_vm.$t("setup.users_management.system_info"))+" ")]),_c("el-card",{staticClass:"fc-setup-summary-card heightInitial mB20 mT15",attrs:{shadow:"never"}},[_c("el-row",{attrs:{gutter:24}},[_c("el-col",{attrs:{span:6}},[_c("div",{staticClass:"fc-grey2-text12 bold line-height20"},[_vm._v(" "+_vm._s(_vm.$t("setup.users_management.created_by"))+" ")]),_c("div",{staticClass:"fc-black-14 text-left bold mT5   break-word"},[_vm._v(" "+_vm._s(_vm.getCreatorInfo("sysCreatedBy","---"))+" ")])]),_c("el-col",{attrs:{span:6}},[_c("div",{staticClass:"fc-grey2-text12 bold line-height20"},[_vm._v(" "+_vm._s(_vm.$t("setup.users_management.created_time"))+" ")]),_c("div",{staticClass:"fc-black-14 text-left bold mT5 break-word"},[_vm._v(" "+_vm._s(_vm.getCreatorTime("sysCreatedTime","---"))+" ")])]),_c("el-col",{attrs:{span:6}},[_c("div",{staticClass:"fc-grey2-text12 bold line-height20"},[_vm._v(" "+_vm._s(_vm.$t("setup.users_management.modified_by"))+" ")]),_c("div",{staticClass:"fc-black-14 text-left bold mT5 break-word"},[_vm._v(" "+_vm._s(_vm.getCreatorInfo("sysModifiedBy","---"))+" ")])]),_c("el-col",{attrs:{span:6}},[_c("div",{staticClass:"fc-grey2-text12 bold line-height20"},[_vm._v(" "+_vm._s(_vm.$t("setup.users_management.modified_time"))+" ")]),_c("div",{staticClass:"fc-black-14 text-left bold mT5 break-word"},[_vm._v(" "+_vm._s(_vm.getCreatorTime("sysModifiedTime","---"))+" ")])])],1)],1)],1)],1),_vm.showUserForm?_c("EditUser",{attrs:{user:_vm.selectedUser,isNew:_vm.isNewUser,appId:_vm.appId,applications:_vm.appInfo,fromPeople:!0},on:{close:function($event){_vm.showUserForm=!1},save:_vm.reLoadPerson}}):_vm._e(),_vm.showLaborForm?_c("LabourForm",{attrs:{isNew:_vm.isNewLabour,editLabourDetails:_vm.selectedLabour,fromPeople:!0},on:{onSubmit:_vm.reLoadPerson,onClose:function($event){_vm.showLaborForm=!1}}}):_vm._e(),_vm.showPersonDialog?_c("NewPersonForm",{attrs:{showPersonDialog:_vm.showPersonDialog,selectedPerson:_vm.selectedPerson,isNew:!1},on:{closeDialog:function($event){_vm.showPersonDialog=!1},savePerson:_vm.reLoadPerson}}):_vm._e()],1)])},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),objectSpread2=__webpack_require__(595082),api=(__webpack_require__(634338),__webpack_require__(564043),__webpack_require__(857267),__webpack_require__(434284),__webpack_require__(670560),__webpack_require__(32284)),SetupLoader=__webpack_require__(233432),Avatar=__webpack_require__(574752),validation=__webpack_require__(990260),filters=__webpack_require__(273861),vuex_esm=__webpack_require__(420629),EditUser=__webpack_require__(323755),router=__webpack_require__(329435),LabourForm=__webpack_require__(630104),NewPersonForm=__webpack_require__(456337),PeopleSummaryvue_type_script_lang_js={name:"PeopleSummary",data:function(){return{isLoading:!1,selectedPerson:null,peopleSummaryTab:"summary",peopleTypeHash:{1:"Tenant Contact",2:"Vendor Contact",3:"Employee",4:"Client Contact",5:"Occupant",6:"Default",7:"Others"},showUserForm:!1,showLaborForm:!1,selectedUser:null,selectedLabour:null,isNewUser:!0,isNewLabour:!0,showPersonDialog:!1}},components:{SetupLoader:SetupLoader/* default */.Z,Avatar:Avatar["default"],EditUser:EditUser/* default */.Z,LabourForm:LabourForm/* default */.Z,NewPersonForm:NewPersonForm/* default */.Z},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapGetters */.Se)(["getUser"])),{},{canShowLabourWidget:function(){return this.$helpers.isLicenseEnabled("RESOURCES")},peopleId:function(){var $route=this.$route,_ref=$route||{},params=_ref.params,_ref2=params||{},id=_ref2.id;return parseInt(id)||null},peopleType:function(){var selectedPerson=this.selectedPerson,peopleTypeHash=this.peopleTypeHash,_ref3=selectedPerson||{},peopleType=_ref3.peopleType;return(0,validation/* isEmpty */.xb)(peopleType)?"---":peopleTypeHash[peopleType]},canShowUserActions:function(){var superAdmin=this.superAdmin,selectedPerson=this.selectedPerson,_ref4=selectedPerson||{},userContext=_ref4.userContext;return!(0,validation/* isEmpty */.xb)(userContext)&&!superAdmin},inviteAcceptedState:function(){return this.getContextProperty("userContext","inviteAcceptStatus",!1)},hideUser:function(){var selectedPerson=this.selectedPerson,_ref5=selectedPerson||{},user=_ref5.user,userContext=_ref5.userContext;return user&&(0,validation/* isEmpty */.xb)(userContext)},laborCost:function(){return"".concat(this.$currency).concat(this.getContextProperty("labourContext","cost","---"))},hideLabour:function(){var selectedPerson=this.selectedPerson,_ref6=selectedPerson||{},labour=_ref6.labour,labourContext=_ref6.labourContext;return labour&&(0,validation/* isEmpty */.xb)(labourContext)},userAssociated:function(){var selectedPerson=this.selectedPerson,_ref7=selectedPerson||{},userContext=_ref7.userContext;return!(0,validation/* isEmpty */.xb)(userContext)},laborAssociated:function(){var selectedPerson=this.selectedPerson;return this.$getProperty(selectedPerson,"labour",!1)},moduleName:function(){return"people"},isLabour:function(){var laborAssociated=this.laborAssociated;return laborAssociated?this.$t("common.products.yes"):this.$t("common.products._no")},appId:function(){var _ref8=(0,router/* getApp */.wx)()||{},id=_ref8.id;return id},appInfo:function(){return(0,router/* getApp */.wx)()||{}},superAdmin:function(){return"Super Administrator"===this.getContextProperty("userContext","role","---")}}),created:function(){this.loadPersonSummary()},methods:{loadPersonSummary:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var peopleId,moduleName,_yield$API$fetchRecor,people,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _this.isLoading=!0,peopleId=_this.peopleId,moduleName=_this.moduleName,_context.next=4,api/* API */.bl.fetchRecord(moduleName,{id:peopleId});case 4:_yield$API$fetchRecor=_context.sent,people=_yield$API$fetchRecor.people,error=_yield$API$fetchRecor.error,error?_this.$message.error(error.message||"Error Occured"):_this.selectedPerson=people,_this.isLoading=!1;case 9:case"end":return _context.stop()}}),_callee)})))()},setupHomeRoute:function(){this.$router.replace({name:"setup"})},setupPeopleRoute:function(){this.$router.replace({name:"setup.people"})},loadUserForm:function(){var selectedPerson=this.selectedPerson,_ref9=selectedPerson||{},peopleId=_ref9.id,email=_ref9.email,name=_ref9.name,phone=_ref9.phone;this.selectedUser={email:email,peopleId:peopleId,name:name,phone:phone},this.showUserForm=!0},loadLaborForm:function(){var selectedPerson=this.selectedPerson,_ref10=selectedPerson||{},peopleId=_ref10.id,email=_ref10.email,name=_ref10.name,phone=_ref10.phone;this.selectedLabour={email:email,people:{id:peopleId},name:name,phone:phone},this.showLaborForm=!0},getPersonProperty:function(property,defaultValue){var selectedPerson=this.selectedPerson;return this.$getProperty(selectedPerson,property,defaultValue)},getCreatorTime:function(property,defaultValue){var selectedPerson=this.selectedPerson,time=this.$getProperty(selectedPerson,property,null);return(0,validation/* isEmpty */.xb)(time)?defaultValue:(0,filters.formatDate)(time)},getCreatorInfo:function(property,defaultValue){var selectedPerson=this.selectedPerson,ouid=this.$getProperty(selectedPerson,"".concat(property,".uid"),null);return(0,validation/* isEmpty */.xb)(ouid)?defaultValue:this.getUser(ouid).name},getContextProperty:function(context,property,defaultValue){var selectedPerson=this.selectedPerson,_ref11=selectedPerson||{},record=_ref11["".concat(context)];if("role"===property){var _ref12=record||{},role=_ref12.role;return this.$getProperty(role,"name",{})}return this.$getProperty(record,property,defaultValue)},onOptionsSelect:function(command,person){"edit"===command&&this.editPerson(person)},editUser:function(){var selectedPerson=this.selectedPerson,_ref13=selectedPerson||{},userContext=_ref13.userContext;this.selectedUser=userContext,this.isNewUser=!1,this.showUserForm=!0},deleteUser:function(){var _this2=this,selectedPerson=this.selectedPerson,_ref14=selectedPerson||{},user=_ref14.userContext,formData=new FormData;formData.append("user.uid",user.uid),formData.append("user.ouid",user.ouid),this.$dialog.confirm({title:this.$t("setup.users_management.delete_user_msg"),message:"".concat(this.$t("setup.users_management.delete_user_msg2")," User ").concat(user.name," ?"),rbDanger:!0,rbLabel:this.$t("setup.users_management.delete")}).then((function(value){value&&api/* API */.bl.post("/setup/deleteUser",formData).then((function(_ref15){var error=_ref15.error;error?_this2.$message.error(_this2.$t("setup.users_management.unable_to_delete")):(_this2.$message.success(_this2.$t("setup.users_management.user_delete_success")),_this2.loadPersonSummary(),_this2.$store.dispatch("loadUsers",!0))}))}))},reInvite:function(){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var selectedPerson,_ref16,user,_yield$API$post,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return selectedPerson=_this3.selectedPerson,_ref16=selectedPerson||{},user=_ref16.userContext,_context2.next=4,api/* API */.bl.post("setup/resendinvite",{userId:user.id,isPortal:!0});case 4:_yield$API$post=_context2.sent,error=_yield$API$post.error,error?_this3.$message.error(_this3.$t("setup.users_management.error_occured")):_this3.$message.success(_this3.$t("setup.users_management.invitation_send_success"));case 7:case"end":return _context2.stop()}}),_callee2)})))()},editPerson:function(person){this.showPersonDialog=!0,this.selectedPerson=person},editLabour:function(){var selectedPerson=this.selectedPerson,_ref17=selectedPerson||{},labourContext=_ref17.labourContext;this.selectedLabour=labourContext,this.isNewLabour=!1,this.showLaborForm=!0},openUserSummary:function(){var selectedPerson=this.selectedPerson,appId=this.appId,_ref18=selectedPerson||{},user=_ref18.userContext;this.$router.push({name:"userSummary",params:{id:user.id,appId:appId}})},deleteLabour:function(){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var selectedPerson,_ref19,labourContext,_ref20,laborId,value,_yield$API$deleteReco,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:return selectedPerson=_this4.selectedPerson,_ref19=selectedPerson||{},labourContext=_ref19.labourContext,_ref20=labourContext||{},laborId=_ref20.id,_context3.next=5,_this4.$dialog.confirm({title:_this4.$t("setup.users_management.delete_labor"),message:_this4.$t("setup.users_management.are_you_sure_delete_people"),rbDanger:!0,rbLabel:"Delete"});case 5:if(value=_context3.sent,!value){_context3.next=12;break}return _context3.next=9,api/* API */.bl.deleteRecord("labour",laborId);case 9:_yield$API$deleteReco=_context3.sent,error=_yield$API$deleteReco.error,error?_this4.$message.error(error.message||"Error Occured"):(_this4.loadPersonSummary(),_this4.$message.success(_this4.$t("setup.users_management.delete_labor_successfully")));case 12:case"end":return _context3.stop()}}),_callee3)})))()},reLoadPerson:function(){this.showUserForm=!1,this.showLaborForm=!1,this.showPersonDialog=!1,this.loadPersonSummary()},closeDialog:function(canClose){canClose&&(this.showPersonDialog=!1)}}},people_PeopleSummaryvue_type_script_lang_js=PeopleSummaryvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(people_PeopleSummaryvue_type_script_lang_js,render,staticRenderFns,!1,null,"63164750",null)
/* harmony default export */,PeopleSummary=component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/67027.js.map