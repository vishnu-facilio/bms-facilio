"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[40367],{
/***/823479:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return ScatterAnalysis}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/energy/analytics/newTools/ScatterAnalysis.vue?vue&type=template&id=75ae035a
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{key:_vm.$route.path,staticClass:"fc-energy-building-analysis"},[_c("div",{staticClass:"report-main-con"},[_c("div",{},[_c("f-report-options",{staticClass:"analytics-page-options-building-analysis fc-v1-portfolio-anlaysis",attrs:{isActionsDisabled:_vm.isActionsDisabled,optionClass:"analytics-page-options",optionsToEnable:[5,1,2],reportObject:_vm.reportObject,resultObject:_vm.resultObject,params:_vm.reportObject?_vm.reportObject.params:null,savedReport:_vm.analyticsConfig.savedReport,pdf:!1},on:{"update:savedReport":function($event){return _vm.$set(_vm.analyticsConfig,"savedReport",$event)},"update:saved-report":function($event){return _vm.$set(_vm.analyticsConfig,"savedReport",$event)}}})],1),_c("div",{staticClass:"report-sidebar-con"},[_vm.hideSideBar?_vm._e():_c("div",{class:{"new-report-sidebar fc-new-report-sidebar col-3 pT0":!_vm.hideSideBar}},[_c("div",{directives:[{name:"show",rawName:"v-show",value:_vm.showgeneratedata,expression:"showgeneratedata"}],staticClass:"report-sidebar-inner"},[_c("div",{staticClass:"analytics-body p20 clearboth"},[_c("div",{staticClass:"fc-text-pink"},[_vm._v(" "+_vm._s(_vm.$t("home.dashboard.generate_chart"))+" ")]),_c("el-row",[_c("el-col",{staticClass:"mT20",attrs:{span:24}},[_c("div",{staticClass:"label-txt-black pB5"},[_vm._v(" "+_vm._s(_vm.$t("common.dashboard.time_period"))+" ")]),_c("el-select",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"period-select width100 fc-input-full-border2 ",attrs:{placeholder:_vm.$t("common.wo_report.period"),title:_vm.$t("common.dashboard.time_period"),"data-arrow":"true"},on:{change:_vm.onPeriodChange},model:{value:_vm.analyticsConfig.period,callback:function($$v){_vm.$set(_vm.analyticsConfig,"period",$$v)},expression:"analyticsConfig.period"}},_vm._l(_vm.getAvailablePeriods,(function(period,index){return _c("el-option",{key:index,attrs:{label:period.name,value:period.value,disabled:!period.enable}})})),1)],1)],1)],1),_c("FScatterPointSelector",{attrs:{visibility:"true",enableFloatimngIcon:_vm.enableFloatimngIcon,analyticsConfig:_vm.analyticsConfig},on:{resetState:_vm.resetState,"update:enableFloatimngIcon":function($event){_vm.enableFloatimngIcon=$event},"update:enable-floatimng-icon":function($event){_vm.enableFloatimngIcon=$event},updateDataPoints:_vm.applyscatter,"update:analyticsConfig":function($event){_vm.analyticsConfig=$event},"update:analytics-config":function($event){_vm.analyticsConfig=$event}}}),_vm.reportObject?_c("div",[_c("el-row",[_c("el-col",{staticClass:"mT20",attrs:{span:24}},[_c("div",{staticClass:"fL"},[_c("div",{staticClass:"label-txt-black f14 pB5"},[_vm._v(" "+_vm._s(_vm.$t("common.products.trendline"))+" ")])])])],1),_c("el-row",{staticClass:"mT10"},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"flex-middle justify-content-space"},[_c("div",{staticClass:"flex-middle"},[_c("el-checkbox",{staticClass:"mR10",on:{change:function($event){return _vm.openTrendLineDialog()}},model:{value:_vm.reportObject.options.trendLine.enable,callback:function($$v){_vm.$set(_vm.reportObject.options.trendLine,"enable",$$v)},expression:"reportObject.options.trendLine.enable"}}),_c("div",{staticClass:"label-txt-black fw4 pR5"},[_vm._v(" "+_vm._s(_vm.$t("common._common.enable"))+" ")])],1),_vm.reportObject.options.trendLine.enable?_c("div",{staticClass:"pointer"},[_c("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"top",arrow:!0,animation:"shift-away"},expression:"{\n                        placement: 'top',\n                        arrow: true,\n                        animation: 'shift-away',\n                      }"}],staticClass:"fc-dark-blue4-12 pointer",attrs:{title:"Edit"},on:{click:function($event){return _vm.openTrendLineDialog()}}},[_vm._v(" "+_vm._s(_vm.$t("common._common.edit"))+" ")])]):_vm._e()])])],1)],1):_vm._e()],1)]),_vm.hideSideBar?_vm._e():_c("div",{class:{"new-chart-custom fc-new-portfolio-chart-custom":!_vm.hideSideBar}},[_vm.reportObject?_c("div",{directives:[{name:"show",rawName:"v-show",value:_vm.showChartCustomization,expression:"showChartCustomization"}],staticClass:"customize-container building-customize-container col-3 fc-new-portfolio-cus",staticStyle:{top:"0px"}},[_c("div",{staticClass:"customize-header"},[_c("div",{staticClass:"customize-H"},[_vm._v(" "+_vm._s(_vm.$t("home.reports.chart_customization"))+" ")])]),_c("div",{staticClass:"customize-body fc-customize-body"},[_vm.reportObject?_c("f-chart-customization",{directives:[{name:"show",rawName:"v-show",value:_vm.showChartCustomization,expression:"showChartCustomization"}],attrs:{report:_vm.reportObject,resultDataPoints:_vm.resultObject?_vm.resultObject.report.dataPoints:[],config:_vm.analyticsConfig},on:{close:function($event){_vm.showChartCustomization=!1,_vm.showgeneratedata=!0},resetPoints:_vm.resetDataPointSelector}}):_vm._e()],1)]):_vm._e()]),!_vm.hideSideBar&&_vm.enableFloatimngIcon?_c("div",{staticClass:"analytics-options-block"},[_c("div",{},[_c("div",{staticClass:"text-center analytics-report-icon-bg line-height50 height50",class:{"analytics-report-icon-bg-active":_vm.showgeneratedata},on:{click:function($event){return _vm.showgeneratedataDialog()}}},[_c("InlineSvg",{attrs:{src:"statistics",iconClass:"icon icon-sm-md  vertical-middle"}})],1),_c("div",{staticClass:"text-center analytics-report-icon-bg line-height50 height50",class:{"analytics-report-icon-bg-active":_vm.showChartCustomization},attrs:{disabled:!_vm.reportObject||0===_vm.analyticsConfig.dataPoints.length},on:{click:function($event){_vm.reportObject&&_vm.showChartCustomizationDialog()}}},[_c("InlineSvg",{attrs:{src:"settings-grey",iconClass:"icon icon-sm-md vertical-middle"}})],1),_c("div",{staticClass:"text-center analytics-report-icon-bg line-height50 height50",on:{click:function($event){return _vm.toggleSideBar()}}},[_c("InlineSvg",{attrs:{src:"arrow-pointing-to-left2",iconClass:"icon icon-sm-md vertical-middle"}})],1)])]):_vm._e(),_vm.hideSideBar?_c("div",{staticClass:"analytics-options-block",style:{left:_vm.cssLeft}},[_c("div",{},[_c("div",{staticClass:"text-center analytics-report-icon-bg line-height50 height50",class:{"analytics-report-icon-bg-active":_vm.showgeneratedata},on:{click:function($event){return _vm.showgeneratedataDialog()}}},[_c("InlineSvg",{attrs:{src:"statistics",iconClass:"icon icon-sm-md  vertical-middle"}})],1),_c("div",{staticClass:"text-center analytics-report-icon-bg line-height50 height50",class:{"analytics-report-icon-bg-active":_vm.showChartCustomization},attrs:{disabled:!_vm.reportObject||0===_vm.analyticsConfig.dataPoints.length},on:{click:function($event){_vm.reportObject&&_vm.showChartCustomizationDialog()}}},[_c("InlineSvg",{attrs:{src:"settings-grey",iconClass:"icon icon-sm-md vertical-middle"}})],1),_c("div",{staticClass:"text-center analytics-report-icon-bg line-height50 height50",on:{click:function($event){return _vm.toggleSideBar()}}},[_c("InlineSvg",{staticStyle:{transform:"rotate(180deg)"},attrs:{src:"arrow-pointing-to-left2",iconClass:"icon icon-sm-md vertical-middle"}})],1)])]):_vm._e(),_c("div",{staticClass:"report-graph-con position-relative",class:{"new-report-graph-con":!_vm.hideSideBar,"new-report-graph-con-stretch":_vm.hideSideBar},staticStyle:{height:"calc(100vh - 100px)","overflow-y":"scroll","padding-bottom":"100px"}},[_c("div",{ref:"chartSection",class:["self-center fchart-section building-graph-container",{"prediction-timings-container":_vm.analyticsConfig.predictionTimings&&_vm.analyticsConfig.predictionTimings.length>1}]},[_vm.analyticsConfig.dataPoints.length?_c("div",[!1===_vm.isOptimize?_c("f-new-analytic-report-optimize",{ref:"newAnalyticReport",attrs:{config:_vm.analyticsConfig,baseLines:_vm.baseLineList,showTimePeriod:1===_vm.analyticsConfig.mode,showFilterBar:!1,showChartMode:!0,noChartState:_vm.noChartState},on:{"update:config":function($event){_vm.analyticsConfig=$event},reportLoaded:_vm.reportLoaded}}):_vm._e(),!0===_vm.isOptimize?_c("f-new-analytic-report",{ref:"newAnalyticReport",attrs:{config:_vm.analyticsConfig,showFilterBar:!1,baseLines:_vm.baseLineList,showTimePeriod:1===_vm.analyticsConfig.mode,showChartMode:!0},on:{"update:config":function($event){_vm.analyticsConfig=$event},reportLoaded:_vm.reportLoaded}}):_vm._e()],1):_c("div",{staticClass:"text-center"},[(_vm.reportId||_vm.alarmId||_vm.cardId)&&_vm.spinnerToggle?_c("div",{staticClass:"p15"},[_c("spinner",{attrs:{show:_vm.spinnerToggle}})],1):_c("div",{staticClass:"p15 flex-middle height80vh justify-content-center flex-direction-column"},[_c("div",[_c("inline-svg",{attrs:{src:"svgs/emptystate/reportlist",iconClass:"icon text-center icon-xxxxlg"}})],1),_c("div",{staticClass:"nowo-label"},[_vm._v(" "+_vm._s(_vm.$t("common._common.please_select_data_points_analyze"))+" ")])])])])])])]),_vm.showTrendLine?_c("trend-line",{attrs:{visibility:_vm.showTrendLine,report:_vm.reportObject},on:{"update:visibility":function($event){_vm.showTrendLine=$event},onTrendLineChange:_vm.onTrendLineChange}}):_vm._e()],1)},staticRenderFns=[],toConsumableArray=__webpack_require__(488478),objectSpread2=__webpack_require__(595082),createForOfIteratorHelper=__webpack_require__(566347),AnalyticsMixin=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(538077),__webpack_require__(169358),__webpack_require__(670560),__webpack_require__(434284),__webpack_require__(976801),__webpack_require__(648324),__webpack_require__(634338),__webpack_require__(843843),__webpack_require__(947522),__webpack_require__(339772),__webpack_require__(244936)),FNewAnalyticsReportV1=__webpack_require__(937376),FNAROptimize=__webpack_require__(520245),FScatterPointSelector=__webpack_require__(608998),NewFChartCustomization=__webpack_require__(280843),FReportOptions=__webpack_require__(791514),NewDateHelper=__webpack_require__(105534),InlineSvg=__webpack_require__(586166),NewReportSummaryHelper=__webpack_require__(601458),cloneDeep=__webpack_require__(150361),cloneDeep_default=__webpack_require__.n(cloneDeep),vuex_esm=__webpack_require__(420629),deepmerge=__webpack_require__(708634),TrendLine=__webpack_require__(839662),ScatterAnalysisvue_type_script_lang_js={props:["mobileConfig"],mixins:[AnalyticsMixin/* default */.Z,NewReportSummaryHelper/* default */.Z],components:{FNewAnalyticReport:FNewAnalyticsReportV1/* default */.Z,FNewAnalyticReportOptimize:FNAROptimize/* default */.Z,FChartCustomization:NewFChartCustomization/* default */.Z,FScatterPointSelector:FScatterPointSelector/* default */.Z,FReportOptions:FReportOptions/* default */.Z,InlineSvg:InlineSvg/* default */.Z,TrendLine:TrendLine/* default */.Z},data:function(){return{enableFloatimngIcon:!0,templateCriteria:null,showFilter:!1,hideSideBar:!1,showDataPointSelector:!1,showBuildingPointSelector:!1,showHeatMapPointSelector:!1,showChartCustomization:!1,showgeneratedata:!0,showDerivation:!1,chartCustomizationActiveTab:"datapoints",selectedBaseLineId:"",baseLineList:null,baseLineCasecaderOptions:[],oldBaseLine:null,spinnerToggle:!0,assetCategoryMap:null,spacefiltersPopover:!1,analyticsConfig:{name:"Building Analysis",key:"BUILDING_ANALYSIS",analyticsType:this.isSiteAnalysis?6:2,type:"reading",period:0,groupByTimeAggr:null,mode:1,baseLine:null,dateFilter:NewDateHelper/* default */.Z.getDatePickerObject(22),chartViewOption:0,dataPoints:[],dimensionDataPoint:null,defaultDate:!1,predictionTimings:[],transformWorkflow:null,trendLineChange:0,filters:{xCriteriaMode:2},sorting:{sortByField:null,orderByFunc:3,limit:10},reportFilter:{timeFilter:{conditions:{}},dataFilter:{conditions:{}}}},reportFilterForm:{floorFilter:[],SpaceFilter:[],categoryFilter:[],assetFilter:[],liveFilterField:"none",liveFilterType:"single"},selectedCategory:{categoryId:[],assetList:null,allAsset:null,categoryList:null,FloorList:[],spaceList:[],allBuildings:this.$store.state.buildings?cloneDeep_default()(this.$store.state.buildings):null},assetsMap:null,analyticsMode:1,setfilter:0,noChartState:!1,reportObject:null,resultObject:null,selectedBuildings:[],selectedBuildingTitle:"",zones:null,dataPointSummaryList:null,dPSummaryList:null,filterToggle:!1,showTrendLine:!1,assetCategoryName:"",filterTitle:"Assets",enableReadingSelection:!1,savedPoints:[],reportFilterEnable:!1,showReportFilter:!1}},watch:{reportId:function(){this.reportId&&this.loadReport()},
// 'selectedBuildings': function () {
//     this.loadSpaceList()
// },
filterToggle:{handler:function(newData,oldData){this.toggleFilter(newData)}},
// derivations: {
//   handler (val) {
//     this.setDerivationPoints()
//   },
//   deep: true
// },
getAvailablePeriods:{handler:function(newData,oldData){var _this=this,avail=this.getAvailablePeriods,selected=avail.find((function(a){return a.value===_this.analyticsConfig.period&&a.enable}));if(!selected){var filterName=this.analyticsConfig.dateFilter.operationOn,defaultPeriod=avail.filter((function(a){return a.enable}))[0].value;"week"===filterName||"month"===filterName?defaultPeriod=12:"year"===filterName&&(defaultPeriod=10),this.analyticsConfig.period=defaultPeriod}},immediate:!0},showChartCustomization:function(newVal){var self=this;self.$nextTick((function(){self.$refs["newAnalyticReport"]&&self.$refs["newAnalyticReport"].resize&&self.$refs["newAnalyticReport"].resize()}))}},created:function(){this.$store.dispatch("loadBuildings"),this.$store.dispatch("loadAlarmSeverity"),this.$store.dispatch("loadAssetCategory")},mounted:function(){if(this.isSiteAnalysis&&(this.analyticsConfig.analyticsType=6),this.$route.query.filters){var filters=this.$route.query.filters,filtersJSON=JSON.parse(filters);this.analyticsConfig=deepmerge/* default */.Z.objectAssignDeep(this.analyticsConfig,filtersJSON)}(this.reportId||this.alarmId||this.cardId)&&(this.$mobile?this.loadReport(this.mobileConfig):this.loadReport());var self=this;self.$http.get("/baseline/all").then((function(response){if(200===response.status){self.baseLineList=response.data?response.data:[],self.baseLineCasecaderOptions=[],self.baseLineCasecaderOptions.push({label:"None",value:-1});var _step,_iterator=(0,createForOfIteratorHelper/* default */.Z)(self.baseLineList);try{for(_iterator.s();!(_step=_iterator.n()).done;){var b=_step.value,children=null;"PREVIOUS_MONTH"===b.rangeTypeEnum||"ANY_MONTH"===b.rangeTypeEnum?children=[{label:"Same date",value:4},{label:"Same week",value:1}]:"PREVIOUS_YEAR"!==b.rangeTypeEnum&&"ANY_YEAR"!==b.rangeTypeEnum||(children=[{label:"Same date",value:3},{label:"Same week",value:1}]),"PREVIOUS"!==b.rangeTypeEnum&&self.baseLineCasecaderOptions.push({label:b.name,value:b.id,children:children})}}catch(err){_iterator.e(err)}finally{_iterator.f()}}})),self.loadZones()},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({assetCategory:function(state){return state.assetCategory}})),{},{isFilterActive:function(){var self=this;if(this.reportObject){var isFilterActive=self.checkFilterFeasibility(self.reportObject);return isFilterActive&&(self.filterTitle=self.analyticsConfig.template&&self.analyticsConfig.template.criteria?"Specific "+self.assetCategoryName+" Selected":"All "+self.assetCategoryName),isFilterActive}return!1},cssLeft:function(){return"3px !important"},isOptimize:function(){return!!this.$route.query.newchart},show:function(){return!(this.resultObject&&this.resultObject.report.dataPoints.length>1)||!!this.analyticsConfig.sorting.sortByField},isSiteAnalysis:function(){return this.$route.meta&&"site"===this.$route.meta.analyticsType},isSameDataPoint:function(){if(this.analyticsConfig&&this.analyticsConfig.dataPoints.length){var _step2,dp={},_iterator2=(0,createForOfIteratorHelper/* default */.Z)(this.analyticsConfig.dataPoints);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var d=_step2.value;dp[d.yAxis.fieldId]=!0}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}if(1===Object.keys(dp).length)return!0}return!1},isSameCategoryDataPoint:function(){if(this.analyticsConfig&&this.analyticsConfig.dataPoints.length>1){var _step3,dp={},_iterator3=(0,createForOfIteratorHelper/* default */.Z)(this.analyticsConfig.dataPoints);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var d=_step3.value;dp[d.categoryId]=!0}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}if(1===Object.keys(dp).length)return!1}return!0},getAvailableGroupAggr:function(){var avail=[];return avail.push({name:this.$t("common.wo_report.none"),value:null,enable:!0}),avail.push({name:this.$t("common._common.daily"),value:12,enable:19===this.analyticsConfig.period}),avail.push({name:this.$t("common._common.monthly"),value:10,enable:[17,18,19].includes(this.analyticsConfig.period)}),avail.push({name:this.$t("common.header.hour_of_day"),
// 12, 1, 2, 3
value:19,enable:[12,11,10,8,25,17,18].includes(this.analyticsConfig.period)}),avail.push({name:this.$t("common.header.day_of_week"),
// sun, mon
value:17,enable:[11,10,8,25].includes(this.analyticsConfig.period)}),avail.push({name:this.$t("common.header.day_of_month"),
// 1,2,3
value:18,enable:[10,8,25].includes(this.analyticsConfig.period)}),avail},getAvailablePeriods:function(){var operationOnId=this.analyticsConfig.dateFilter.operationOnId,avail=[];
// avail.push({
//   name:'Week of year', // W1, W2
//   value: 16,
//   enable: true
// })
// avail.push({
//   name:'Month of year', // Jan, Feb , march
//   value: 15,
//   enable: true
// })
return avail.push({name:this.$t("common.wo_report.high_res"),value:0,enable:6===operationOnId||4!==operationOnId}),avail.push({name:this.$t("common.wo_report.hourly"),value:20,enable:6===operationOnId||4!==operationOnId}),avail.push({name:this.$t("common._common.daily"),value:12,enable:!0}),avail.push({name:this.$t("common._common.weekly"),value:11,enable:!0}),avail.push({name:this.$t("common._common.monthly"),value:10,enable:!0}),avail.push({name:this.$t("common.products.quarterly"),value:25,enable:4===operationOnId||5===operationOnId}),avail.push({name:this.$t("common._common.yearly"),value:8,enable:4===operationOnId}),avail.push({name:this.$t("common.header.hour_of_day"),
// 12, 1, 2, 3
value:19,enable:!0}),avail.push({name:this.$t("common.header.day_of_week"),
// sun, mon
value:17,enable:!0}),avail.push({name:this.$t("common.header.day_of_month"),
// 1,2,3
value:18,enable:!0}),avail},hasBooleanEnumPoints:function(){if(this.analyticsConfig.dataPoints.length){var highResPoints=this.analyticsConfig.dataPoints.filter((function(dp){return[4,8].includes(dp.yAxis.dataType)}));if(highResPoints.length)return!0}return!1}}),methods:{resetState:function(){Object.assign(this.$data,this.$options.data.apply(this))},prepareOptionDataPoints:function(rConfig){var dataPoints=[];if(0!==rConfig.length){var _step4,_iterator4=(0,createForOfIteratorHelper/* default */.Z)(rConfig);try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var point=_step4.value,yAxis=!1;for(var key in point)if("yAxis"===key&&!1===yAxis||"xAxis"===key)if("yAxis"===key&&(yAxis=!0),"xAxis"===key){var _step5,_iterator5=(0,createForOfIteratorHelper/* default */.Z)(point[key]);try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var dp=_step5.value,temp={};temp["parentId"]="string"===typeof dp.parentId?parseInt(dp.parentId):dp.parentId,temp["prediction"]=!1,temp["aliases"]=dp.aliases,temp["yAxis"]={},temp.yAxis["fieldId"]=dp.readingId,temp.yAxis["aggr"]=dp.aggr,dataPoints.push(temp)}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}}else{var _temp={};_temp["parentId"]="string"===typeof point[key].parentId?parseInt(point[key].parentId):point[key].parentId,_temp["prediction"]=!1,_temp["aliases"]=point[key].aliases,_temp["yAxis"]={},_temp.yAxis["fieldId"]=point[key].readingId,_temp.yAxis["aggr"]=point[key].aggr,_temp["xDataPoint"]=!0,dataPoints.push(_temp)}}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}}return dataPoints},applyscatter:function(dataPoints){if(this.checkPointStructure(dataPoints)){var scatterPoints=dataPoints.scatterPoints,config=JSON.parse(JSON.stringify(this.analyticsConfig));dataPoints.result.meta&&(this.selectedBuildings=dataPoints.result.meta.selectedBuildingIds,this.selectedBuildingTitle=dataPoints.result.meta.selectedBuildingTitle),0===dataPoints.scatterPoints.length?(this.reportObj=null,this.resultObj=null,this.analyticsConfig.scatterConfig=[],this.analyticsConfig.dataPoints=[]):(config["dataPoints"]=this.prepareOptionDataPoints(scatterPoints),config["scatterConfig"]=dataPoints.scatterPoints,
// config['hidechartoptions'] = true
config["hidecharttypechanger"]=!0,this.analyticsConfig=config)}},checkPointStructure:function(dataPoints){var _step6,scatterPoints=dataPoints.scatterPoints,_iterator6=(0,createForOfIteratorHelper/* default */.Z)(scatterPoints);try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var rPoint=_step6.value;if(!rPoint.xAxis||!rPoint.yAxis)return!1}}catch(err){_iterator6.e(err)}finally{_iterator6.f()}return!0},toggleFilter:function(val){var _this2=this;if(this.analyticsConfig&&this.analyticsConfig.template)this.$set(this.analyticsConfig.template,"show",val);else{
// create a new template
var config=JSON.parse(JSON.stringify(this.analyticsConfig)),duplicateCase=this.getDuplicateCase(this.reportObject);this.prepareReportTemplate(this.resultObject,duplicateCase.case).then((function(newTemplate){newTemplate.show=val,config.template=newTemplate,_this2.analyticsConfig=config}))}},toggleTemplateFilter:function(val){var _this3=this;this.analyticsConfig&&this.analyticsConfig.template&&this.$nextTick((function(){_this3.analyticsConfig.template.show=val}))},setTemplateFilterCriteria:function(val){this.templateCriteria=val},PointSelector:function(){1===this.analyticsConfig.mode||11===this.analyticsConfig.mode||"reading"===this.analyticsConfig.mode?this.showDataPointSelector=!0:this.showBuildingPointSelector=!0},addFilterCriteria:function(){var _this4=this,config=JSON.parse(JSON.stringify(this.analyticsConfig));if(this.showFilter=!1,config.parentId=null,config.template)config.template.criteria=this.templateCriteria,this.analyticsConfig=config;else{var duplicateCase=this.getDuplicateCase(this.reportObject);this.prepareReportTemplate(this.resultObject,duplicateCase.case).then((function(newTemplate){newTemplate.criteria=_this4.templateCriteria,config.template=newTemplate,_this4.analyticsConfig=config}))}},openFilter:function(){this.isFilterActive?this.showFilter=!0:this.showFilter=!1},toggleSideBar:function(){this.hideSideBar?(this.hideSideBar=!1,this.$refs["newAnalyticReport"]&&this.$refs["newAnalyticReport"].resize()):(this.hideSideBar=!0,this.$refs["newAnalyticReport"]&&this.$refs["newAnalyticReport"].resize())},loadSpaceList:function(){var self=this;if(self.selectedBuildings)for(var buildingId in self.selectedCategory.FloorList=[],self.selectedCategory.spaceList=[],self.loading=!0,self.selectedBuildings)self.$http.get("/floor?buildingId="+self.selectedBuildings[buildingId]).then((function(response){self.selectedCategory.FloorList=response.data.records})),self.$util.loadSpacesContext(4,null,[{key:"building",operator:"is",value:self.selectedBuildings[buildingId]},{key:"floor",operator:"is empty"}]).then((function(response){self.selectedCategory.spaceList=response.records}))},loadReadings:function(){},loadAssetCategories:function(readings){var self=this;if(readings){var categoryIds=Object.keys(readings.categoryWithFields);self.selectedCategory.categoryList=self.assetCategory.filter((function(ele){for(var index=0;index<categoryIds.length;index++){var element=categoryIds[index];if(parseInt(element)===ele.id)return ele.toggle=!1,ele}})),self.filterAssetsFromCategory(readings)}},updateFilterdata:function(root){if("category"===root){this.selectedCategory.assetList=[];for(var i=0;i<this.reportFilterForm.categoryFilter.length;i++)this.selectedCategory.assetList=[].concat((0,toConsumableArray/* default */.Z)(this.selectedCategory.assetList),(0,toConsumableArray/* default */.Z)(Object.keys(this.assetCategoryMap[this.reportFilterForm.categoryFilter[i]])))}},filterAssetsFromCategory:function(readings){var self=this;self.assetCategoryMap=readings.categoryWithAssets,this.selectedCategory.assetList=[];for(var i=0;i<this.reportFilterForm.categoryFilter.length;i++)this.selectedCategory.assetList=[].concat((0,toConsumableArray/* default */.Z)(this.selectedCategory.assetList),(0,toConsumableArray/* default */.Z)(Object.keys(this.assetCategoryMap[this.reportFilterForm.categoryFilter[i]])));this.selectedCategory.allAsset=self.selectedCategory.assetList,self.assetsMap=readings.assets},resetspaceFilter:function(){this.reportFilterForm={floorFilter:[],SpaceFilter:[],categoryFilter:[],assetFilter:[],liveFilterField:"none",liveFilterType:"single"},this.applyFilter(null)},applyFilter:function(){if(this.reportFilterForm.categoryFilter.length||this.reportFilterForm.assetFilter.length||"none"!==this.reportFilterForm.liveFilterField||"single"!==this.reportFilterForm.liveFilterType)if(this.setfilter=1,this.reportFilterForm.categoryFilter.length||this.reportFilterForm.assetFilter.length)if(this.reportFilterForm.assetFilter.length)this.analyticsConfig.filters={xCriteriaMode:3,parentId:this.reportFilterForm.assetFilter,filterState:this.$helpers.cloneObject(this.reportFilterForm)};else{var spaceFilter=this.selectedBuildings;this.analyticsConfig.filters={xCriteriaMode:4,assetCategory:this.reportFilterForm.categoryFilter,spaceId:spaceFilter,filterState:this.$helpers.cloneObject(this.reportFilterForm)}}else this.analyticsConfig.filters={xCriteriaMode:2,filterState:this.$helpers.cloneObject(this.reportFilterForm)};else this.setfilter=0;this.spacefiltersPopover=!1},prepareDataPointSummary:function(){var _this5=this;if(this.resultObject){var _step7,summaryList=[],weatherModules={weather:"Live Weather",weatherDaily:"Daily Weather",psychrometric:"Psychrometric",cdd:"Degree Days",wdd:"Degree Days",hdd:"Degree Days"},_iterator7=(0,createForOfIteratorHelper/* default */.Z)(this.resultObject.report.dataPoints);try{var _loop=function(){var dataPoint=_step7.value;if(2!==dataPoint.type&&!dataPoint.duplicateDataPoint&&5!==dataPoint.type)if(Object.keys(weatherModules).includes(dataPoint.yAxis.module.name))_this5.addToGroup(dataPoint,weatherModules[dataPoint.yAxis.module.name],summaryList);else if("MV_Readings"===dataPoint.yAxis.module.tableName)_this5.addToGroup(dataPoint,"M&Vs",summaryList);else{var self=_this5;self.$http.post("v2/resource/getResourcesDetails",{resourceId:dataPoint.metaData.parentIds}).then((function(response){response.data.result.resource[0]&&"SPACE"===response.data.result.resource[0].resourceTypeEnum?"scheduled_formula"===dataPoint.yAxis.module.typeEnum.toLowerCase()?_this5.addToGroup(dataPoint,"Enpi",summaryList):_this5.addToGroup(dataPoint,"Space",summaryList):_this5.addToGroup(dataPoint,"Asset",summaryList)}))}};for(_iterator7.s();!(_step7=_iterator7.n()).done;)_loop()}catch(err){_iterator7.e(err)}finally{_iterator7.f()}return summaryList}},addToGroup:function(dataPoint,label,summaryList){var reading={};if(reading["readingId"]=dataPoint.yAxis.fieldId,reading["readingLabel"]=dataPoint.yAxis.field.displayName,reading["resourceId"]=parseInt(dataPoint.metaData.parentIds[0]),reading["resourceLabel"]=dataPoint.resourceName,reading["marked"]=null,reading["location"]="Space"===label||"Enpi"===label?dataPoint.resourceName:this.selectedBuildingTitle,reading["categoryId"]=dataPoint.assetCategoryId,reading["buildingId"]="Space"===label||"Enpi"===label?dataPoint.metaData.parentIds[0]:dataPoint.buildingId,summaryList&&0===summaryList.length){var temp={};temp["label"]=label,temp["readings"]=[],temp.readings.push(reading),summaryList.push(temp)}else if(summaryList&&summaryList.length>0){var readingGroup=summaryList.filter((function(group){return group.label===label}));if(0!==readingGroup.length)readingGroup[0].readings.push(reading);else{var _temp2={};_temp2["label"]=label,_temp2["readings"]=[],_temp2.readings.push(reading),summaryList.push(_temp2)}}},loadAlarmMeta:function(){var _this6=this;this.$http.post("/dashboard/getReportMetaForAlarms",{alarmId:this.$route.query.alarmId}).then((function(response){response.data&&response.data.reportMeta&&(_this6.analyticsConfig.dataPoints=response.data.reportMeta.dataPoints)}))},reportLoaded:function(report,result){!0===this.noChartState&&(this.noChartState=!1),this.reportObject=report,this.$route.query.reportId&&(this.filterToggle=4===report.reportType),this.resultObject=result,(this.analyticsConfig.savedReport||this.$route.query.filters||this.analyticsConfig.template)&&([8,9,10,"mv"].includes(this.analyticsConfig.mode)||(this.dataPointSummaryList=this.prepareDataPointSummary())),4===this.reportObject.reportType&&this.reportObject.options.reportTemplate.buildingId?(report.options.common.buildingIds.push(this.reportObject.options.reportTemplate.buildingId),this.resetDataPointSelector(report.options.common.buildingIds)):report.options.common&&report.options.common.buildingIds&&(!report.options.common.buildingIds.length&&this.selectedBuildings?this.$route.query.filters||this.$route.query.alarmId||this.$route.query.cardId?(this.analyticsConfig.buildingId?this.reportObject.options.common.buildingIds.push(this.analyticsConfig.buildingId):this.$route.query.buildingId?this.reportObject.options.common.buildingIds.push(this.$route.query.buildingId):this.reportObject.options.common.buildingIds=this.selectedBuildings,this.resetDataPointSelector(this.reportObject.options.common.buildingIds)):this.reportObject.options.common.buildingIds=this.selectedBuildings:
// this.selectedBuildings = report.options.common.buildingIds
this.resetDataPointSelector(report.options.common.buildingIds))},loadZones:function(){var self=this;self.$http.get("/zone").then((function(response){response.data&&response.data.records&&(self.zones=response.data.records)}))},resetDataPointSelector:function(buildingIds){if(1===this.analyticsConfig.mode||"reading"===this.analyticsConfig.mode||11===this.analyticsConfig.mode)if("reading"===this.analyticsMode){var filteredPoints=this.analyticsConfig.dataPoints.filter((function(dp){return!(dp.xDataPoint&&!0===dp.xDataPoint)}));this.$refs["building-selector"].setInitialValues(filteredPoints,buildingIds)}else this.$refs["building-selector"].setInitialValues(this.analyticsConfig.dataPoints,buildingIds);else[8,9,10,"mv"].includes(this.analyticsConfig.mode)&&this.$refs["portfolio-building-selector"].setInitialValues(this.analyticsConfig.dataPoints,buildingIds)},updateDataPoints:function(changedDataPoints){var _this7=this;if([8,9,10].includes(this.analyticsConfig.mode))this.analyticsConfig.filters={xCriteriaMode:4,spaceId:this.selectedBuildings};else if("mv"===this.analyticsConfig.mode){var siteId=this.$store.state.buildings.filter((function(building){return building.id===parseInt(_this7.selectedBuildings[0])}))[0].siteId;this.analyticsConfig.filters={xCriteriaMode:4,spaceId:[siteId+""]}}else this.analyticsConfig.filters={xCriteriaMode:2};var pointToAdd=null;if(this.analyticsConfig.dataPoints.length){var configIndexes=[],alreadyAddedIndexes=[],pointsToRemove=[];this.enableReadingSelection=changedDataPoints.length>1,"reading"===this.analyticsMode&&null!==this.analyticsConfig.dimensionDataPoint&&(pointToAdd=this.analyticsConfig.dataPoints[this.analyticsConfig.dimensionDataPoint]);var optionPoints=[];this.reportObject.options.dataPoints.forEach((function(dp){"group"===dp.type?optionPoints.push.apply(optionPoints,(0,toConsumableArray/* default */.Z)(dp.children)):optionPoints.push(dp)}));var isValid=optionPoints.filter((function(dp){return 2!==dp.pointType&&!dp.duplicateDataPoint})).every((function(dp){var idx=changedDataPoints.findIndex((function(cdp){return cdp.parentId===dp.parentId&&cdp.yAxis.fieldId===dp.fieldId}));if(-1===idx){if(!_this7.checkAndDeletePointsRel(_this7.reportObject.options,dp.alias))return _this7.$message.error(dp.label+_this7.$t("common.header.has_been_used_derivation_removing_point")),_this7.resetDataPointSelector(),!1;pointsToRemove.push(dp.alias)}if(-1!==idx){var configIdx=_this7.getConfigDataPointFromOptionDP(_this7.analyticsConfig,dp,!0);configIndexes.push(configIdx),alreadyAddedIndexes.push(idx)}return!0}));isValid&&(this.removeOptionPoints(this.reportObject.options,pointsToRemove),this.analyticsConfig.dataPoints=[].concat((0,toConsumableArray/* default */.Z)(this.analyticsConfig.dataPoints.filter((function(dp,idx){return 2===dp.type||dp.duplicateDataPoint||configIndexes.includes(idx)}))),(0,toConsumableArray/* default */.Z)(changedDataPoints.filter((function(cdp,idx){return!alreadyAddedIndexes.includes(idx)})))))}else this.analyticsConfig.dataPoints=changedDataPoints;
// if(this.analyticsMode === 11 && this.analyticsConfig.dimensionDataPoint >= this.analyticsConfig.dataPoints.length){
//   this.analyticsConfig.dimensionDataPoint = 0
//   this.$refs['single-point-selector'].setInitialValues([],this.selectedBuildings)
// }
if(null!==pointToAdd){var idx=this.analyticsConfig.dataPoints.findIndex((function(adp){return adp.parentId===pointToAdd.parentId&&adp.yAxis.fieldId===pointToAdd.yAxis.fieldId}));-1===idx&&(this.analyticsConfig.dataPoints.push(pointToAdd),this.analyticsConfig.dimensionDataPoint=this.analyticsConfig.dataPoints.length-1)}this.hasBooleanEnumPoints&&this.analyticsConfig.groupByTimeAggr&&(this.analyticsConfig.groupByTimeAggr=null),this.addPredictionFields(this.analyticsConfig),this.showDataPointSelector=!1,this.showBuildingPointSelector=!1},updateDimensionDataPoints:function(changedDataPoints){
// if (this.analyticsConfig.dimensionDataPoint!==null) {
var index=this.analyticsConfig.dataPoints.findIndex((function(dp){return dp.parentId===changedDataPoints[0].parentId&&dp.yAxis.fieldId===changedDataPoints[0].yAxis.fieldId}));if(-1===index){var idx=this.analyticsConfig.dataPoints.findIndex((function(dp){return!0===dp.xDataPoint}));changedDataPoints[0]["xDataPoint"]=!0,-1===idx?(idx=0,this.analyticsConfig.dataPoints.push(changedDataPoints[0]),this.analyticsConfig.dimensionDataPoint=this.analyticsConfig.dataPoints.length-1):(this.analyticsConfig.dataPoints[idx]=changedDataPoints[0],this.analyticsConfig.dimensionDataPoint=idx)}else this.analyticsConfig.dimensionDataPoint=index;
// }
// else {
//   changedDataPoints[0]['xDataPoint']=true
//   this.analyticsConfig.dataPoints.push(changedDataPoints[0])
//   this.analyticsConfig.dimensionDataPoint=this.analyticsConfig.dataPoints.length-1
// }
this.addPredictionFields(this.analyticsConfig),this.showHeatMapPointSelector=!1},showChartCustomizationDialog:function(defaultTab){this.hideSideBar=!1,this.showgeneratedata=!1,this.showChartCustomization=!0,defaultTab&&(this.chartCustomizationActiveTab=defaultTab)},hideChartCustomizationDialog:function(){this.showChartCustomization=!1},showgeneratedataDialog:function(){this.hideSideBar=!1,this.showChartCustomization=!1,this.showgeneratedata=!0},setSelectedBuildings:function(_ref){var name=_ref.name,ids=_ref.ids;this.selectedBuildingTitle=name,this.selectedBuildings=ids,this.reportObject&&this.reportObject.options&&this.reportObject.options.common&&(this.reportObject.options.common.buildingIds=this.selectedBuildings)},onPeriodChange:function(){if([8,10,11,12,17,18,19,25].includes(this.analyticsConfig.period)||(this.analyticsConfig.groupByTimeAggr=null),this.analyticsConfig.groupByTimeAggr&&([17,18].includes(this.analyticsConfig.period)&&![10,19].includes(this.analyticsConfig.groupByTimeAggr)||12===this.analyticsConfig.period&&19!==this.analyticsConfig.groupByTimeAggr?this.analyticsConfig.groupByTimeAggr=19:11!==this.analyticsConfig.period||[19,17].includes(this.analyticsConfig.groupByTimeAggr)?19!==this.analyticsConfig.period||[12,10].includes(this.analyticsConfig.groupByTimeAggr)||(this.analyticsConfig.groupByTimeAggr=12):this.analyticsConfig.groupByTimeAggr=17),!this.analyticsConfig.dataPoints.length){var filter=22;20===this.analyticsConfig.period?filter=31:12===this.analyticsConfig.period?filter=28:10===this.analyticsConfig.period&&(filter=44),this.analyticsConfig.dateFilter=NewDateHelper/* default */.Z.getDatePickerObject(filter)}},onModeChange:function(){(this.reportId||this.alarmId||this.cardId)&&(this.spinnerToggle=!1),this.noChartState=!0,![8,9,10].includes(this.analyticsConfig.mode)&&[8,9,10].includes(this.analyticsMode)||"mv"===this.analyticsMode?(
//Asset,Floor,Space,M&V
this.analyticsConfig.dataPoints=[],this.resetDataPointSelector(this.selectedBuildings),this.analyticsConfig.dimensionDataPoint=null):1===this.analyticsConfig.mode||"reading"===this.analyticsConfig.mode||[8,9,10].includes(this.analyticsMode)?8===this.analyticsMode&&this.isSameCategoryDataPoint&&(this.$message({message:this.$t("common.header.please_choose_single_asset_category_point"),type:"warning"}),this.analyticsConfig.dataPoints=[],this.resetDataPointSelector(this.selectedBuildings),this.analyticsConfig.dimensionDataPoint=null):(
//Reading,Time,TimeDuration
this.analyticsConfig.dataPoints=[],this.resetDataPointSelector(this.selectedBuildings)),"reading"!==this.analyticsMode&&(this.analyticsConfig.dimensionDataPoint=null),this.analyticsConfig.mode=this.analyticsMode,this.enableReadingSelection=this.analyticsConfig.dataPoints.length>1},OnXdatapointChange:function(){if("reading"===this.analyticsConfig.mode&&null!==this.analyticsConfig.dimensionDataPoint){var point=this.analyticsConfig.dataPoints[this.analyticsConfig.dimensionDataPoint];point.xDataPoint&&!0===point.xDataPoint||(this.analyticsConfig.dataPoints=this.analyticsConfig.dataPoints.filter((function(dp){return!(dp.xDataPoint&&!0===dp.xDataPoint)})))}11===this.analyticsConfig.mode&&null!==this.analyticsConfig.dimensionDataPoint&&(this.analyticsConfig.dataPoints=[this.analyticsConfig.dataPoints[this.analyticsConfig.dimensionDataPoint]]),this.$refs["single-point-selector"].setInitialValues([],this.selectedBuildings)},onBaseLineChange:function(newBaseLine){var _this8=this;if(!this.oldBaseLine||this.oldBaseLine[0]!==newBaseLine[0]){if(this.oldBaseLine&&-1!==this.oldBaseLine[0]){var oldBlName=this.baseLineList.find((function(bl){return bl.id===_this8.oldBaseLine[0]})).name,dp=this.reportObject.options.dataPoints.find((function(dp){return dp.baseLineName===oldBlName}));if(!this.checkAndDeletePointsRel(this.reportObject.options,dp.alias))return this.$message.error(dp.baseLineName+this.$t("common.header.has_been_derivation_please_delete_derivation")),void this.$set(this.analyticsConfig,"baseLine",this.oldBaseLine)}this.oldBaseLine=(0,toConsumableArray/* default */.Z)(newBaseLine),this.$set(this.analyticsConfig,"baseLine",newBaseLine)}},onSettingsChange:function(changedOption){"alarm"===changedOption&&(this.reportObj.alarms&&this.reportObj.alarms.regions.length||!this.reportObj.options.settings.alarm||this.initChart())},openTrendLineDialog:function(){this.reportObject.options.trendLine.enable?this.showTrendLine=!0:this.analyticsConfig.trendLineChange++},onTrendLineChange:function(trendLineObj){this.reportObject.options.trendLine=trendLineObj,this.analyticsConfig.trendLineChange++}}},newTools_ScatterAnalysisvue_type_script_lang_js=ScatterAnalysisvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(newTools_ScatterAnalysisvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,ScatterAnalysis=component.exports},
/***/937376:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FNewAnalyticsReportV1}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/energy/analytics/newTools/v1/FNewAnalyticsReportV1.vue?vue&type=template&id=1fa73ec3&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"analytics-section mT20 height100"},[_c("div",{staticClass:"new-analytics-filter-section"},[_vm.config.hidedatepicker?_vm._e():_c("new-date-picker",{ref:"newDatePicker",staticClass:"filter-field date-filter-comp inline",attrs:{zone:_vm.$timezone,dateObj:_vm.config.dateFilter,isDateFixed:_vm.config.applyReportDate},on:{date:_vm.setDateFilter}}),this.reportObj&&this.reportObj.options&&!0===this.reportObj.options.settings.timeperiod&&[1,4].includes(_vm.config.mode)?_c("div",{staticClass:"chart-icon pointer flRight pB8 el-popover__reference",staticStyle:{"margin-right":"120px"}},[_c("el-select",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"period-select width20 fc-input-full-border2 ",attrs:{placeholder:"Period",title:"Time period","data-arrow":"true"},on:{change:_vm.onPeriodChange},model:{value:_vm.config.period,callback:function($$v){_vm.$set(_vm.config,"period",$$v)},expression:"config.period"}},_vm._l(_vm.getAvailablePeriods,(function(period,index){return _c("el-option",{key:index,attrs:{label:period.name,value:period.value,disabled:!period.enable}})})),1)],1):_vm._e(),_vm.showTemplateFilter&&_vm.resultObj&&_vm.resultObj.report&&_vm.resultObj.report.currentTemplate&&_vm.resultObj.report.currentTemplate.show?_c("div",[_c("el-select",{staticClass:"fc-input-full-border-h35 fc-report-label-position",attrs:{filterable:""},on:{change:_vm.changeParentForTemplate},model:{value:_vm.resultObj.report.currentTemplate.parentId,callback:function($$v){_vm.$set(_vm.resultObj.report.currentTemplate,"parentId",$$v)},expression:"resultObj.report.currentTemplate.parentId"}},_vm._l(_vm.resultObj.report.currentTemplate.chooseValues,(function(asset,assetIdx){return _c("el-option",{key:assetIdx,attrs:{value:asset.id,label:asset.name}})})),1)],1):_vm._e(),!_vm.config.hidechartoptions&&_vm.reportObj&&!0===!_vm.isRegression?_c("f-chart-settings",{attrs:{dataPoints:_vm.reportObj.options.dataPoints,settings:_vm.reportObj.options.settings,showChart:!1,showTable:!1,showChartMode:_vm.showChartMode,showTimePeriod:_vm.showTimePeriod,showAlarm:!(!_vm.reportObj.options||!_vm.reportObj.options.common||1!==_vm.reportObj.options.common.type),showSafelimit:!(!_vm.reportObj.options||!_vm.reportObj.options.common||1!==_vm.reportObj.options.common.type||"undefined"!==typeof _vm.resultObj.regression),disableChartMode:_vm.reportObj.booleanData},on:{onSettingsChange:_vm.onSettingsChange}},[_vm._v(_vm._s(_vm.showTimePeriod))]):_vm._e(),_vm.resultObj&&_vm.resultObj.report&&0!==_vm.resultObj.report.dataPoints.length&&!_vm.isRegression?_c("span"):_vm._e()],1),!_vm.$mobile&&_vm.predictive&&_vm.config.predictionTimings&&_vm.config.predictionTimings.length?_c("prediction-timings-bar",{staticClass:" prediction-timing-bar",attrs:{reportObj:_vm.reportObj,config:_vm.config}}):_vm._e(),_vm.loading?_c("spinner",{staticClass:"analytics-spinner",attrs:{show:_vm.loading,size:"80"}}):_vm.failed?_c("div",{staticStyle:{"margin-top":"30px",opacity:"0.7","font-size":"13px",padding:"50px","line-height":"25px","text-align":"center"}},[_c("div",[_vm._v(_vm._s(_vm.$t("home.dashboard.data_loading_failed")))])]):_vm.reportObj.data?_c("div",{staticClass:"height100"},[_vm.config.hidechart?_vm._e():_c("div",{staticClass:"height100"},[_vm.$route.meta&&_vm.$route.meta.layout&&"mobile"===_vm.$route.meta.layout&&_vm.reportObj&&"multi"===_vm.reportObj.options.settings.chartMode?_c("f-mobile-multi-chart",{ref:"multiChart",attrs:{isWidget:!!_vm.config,width:_vm.config&&_vm.config.width?_vm.config.width:null,resultObj:_vm.resultObj,height:_vm.config&&_vm.config.height?_vm.config.height:null,data:_vm.reportObj.data,options:_vm.reportObj.options,alarms:_vm.reportObj.alarms,dateRange:_vm.reportObj.dateRange,hidecharttypechanger:_vm.config&&_vm.config.widget,booleanData:_vm.reportObj.booleanData}}):_vm._e(),_vm.$route.meta&&_vm.$route.meta.layout&&"mobile"===_vm.$route.meta.layout&&_vm.reportObj&&"multi"===_vm.reportObj.options.settings.chartMode?_c("div",{staticClass:"empty-multi-chart"},[_vm._v(" Currently this chart not supported in the mobile ")]):_vm.reportObj&&"multi"===_vm.reportObj.options.settings.chartMode?_c("f-multi-chart",{ref:"multiChart",attrs:{data:_vm.reportObj.data,options:_vm.reportObj.options,alarms:_vm.reportObj.alarms,booleanData:_vm.reportObj.booleanData,dateRange:_vm.reportObj.dateRange,resultObj:_vm.resultObj,hidecharttypechanger:_vm.config.hidecharttypechanger||_vm.isRegression}}):_c("div",{staticClass:"height100"},[_vm.$route.meta&&_vm.$route.meta.layout&&"mobile"===_vm.$route.meta.layout&&!_vm.isHeatMap?_c("f-mobile-chart",{ref:"newChart",staticClass:"mobile-chart",attrs:{data:_vm.reportObj.data,options:_vm.reportObj.options,dateRange:_vm.reportObj.dateRange,resultObj:_vm.resultObj}}):_vm.isHeatMap?_vm._e():_c("f-new-chart",{ref:"newChart",attrs:{data:_vm.reportObj.data,options:_vm.reportObj.options,alarms:_vm.reportObj.alarms,dateRange:_vm.reportObj.dateRange,resultObj:_vm.resultObj,hidecharttypechanger:_vm.config.hidecharttypechanger||_vm.isRegression,fixedChartHeight:_vm.config.fixedChartHeight,config:_vm.config,showWidgetLegends:!_vm.config||_vm.config.showWidgetLegends,chartTypeTarget:_vm.chartTypeTarget}},[_c("template",{slot:"relatedAlarmBar"},[_vm._t("relatedAlarmBarLayout")],2)],2),_vm.isHeatMap?_c("FNewHeatMap",{attrs:{config:_vm.config,resultObject:_vm.resultObj,reportObject:_vm.reportObj}}):_vm._e()],1)],1),_vm.config.hidetabular?_vm._e():_c("f-tabular-report",{ref:"newTable",staticClass:"new-analytics-table mL30 mR30",class:{"regression-table-fit":_vm.isRegression},attrs:{reportObject:_vm.resultObj,reportConfig:_vm.reportObj}})],1):_c("div",{staticStyle:{"margin-top":"30px","font-size":"13px",padding:"50px","line-height":"25px","text-align":"center"}},[_c("inline-svg",{attrs:{src:"svgs/emptystate/reportlist",iconClass:"icon text-center icon-100"}}),_c("div",{staticClass:"nowo-label f13"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.empty_data"))+" "),_vm.resultObj&&_vm.resultObj.dateRange?_c("span",{staticClass:"bold"},[_vm._v(_vm._s(_vm._f("formatPeriod")(_vm.resultObj.dateRange.value,"MMM DD, YYYY")))]):_vm._e()])],1),_vm.resultObj?_c("RangeChartDialog",{attrs:{visibility:_vm.showRangeChartDialog,dataPoints:_vm.resultObj.report.dataPoints},on:{"update:visibility":function($event){_vm.showRangeChartDialog=$event},rangePoints:_vm.addRangePoints}}):_vm._e()],1)},staticRenderFns=[],createForOfIteratorHelper=__webpack_require__(566347),NewDatePicker=(__webpack_require__(670560),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(538077),__webpack_require__(947522),__webpack_require__(434284),__webpack_require__(648324),__webpack_require__(169358),__webpack_require__(900773)),FNewchartV1vue_type_template_id_4ddd8122_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"height100 f-singlechart mL20 mR20"},[_vm.chartTypeTarget&&!_vm.hidecharttypechanger?_c("portal",{attrs:{to:_vm.chartTypeTarget,slim:""}},[_c("f-chart-type",{attrs:{options:_vm.options}})],1):_vm.hidecharttypechanger?_vm._e():_c("f-chart-type",{staticClass:"charttypechanger fc-new--chart-type-single",attrs:{options:_vm.options}}),_vm.chartContext&&!1!==_vm.options.settings.chart?_c("div",{staticStyle:{"text-align":"center"}},[_vm.chartContext.options.legend.show&&"top"===_vm.chartContext.options.legend.position?_c("f-chart-legends",{ref:"chartLegend",attrs:{chart:_vm.c3.chart,options:_vm.options,xValueMode:_vm.chartContext.xValueMode,xLabelMap:_vm.chartContext.xLabelMap,config:_vm.config}}):_vm._e(),_vm._t("relatedAlarmBar"),_vm.chartContext.options.regionConfig?_c("f-chart-title",{ref:"chartTitle",attrs:{chart:_vm.c3.chart,options:_vm.options,xValueMode:_vm.chartContext.xValueMode,xLabelMap:_vm.chartContext.xLabelMap,config:_vm.config,chartContext:_vm.chartContext}}):_vm._e(),_c("div",{style:_vm.isWidget?"position: relative; top: 15px;":""},[_vm.showAlarms&&_vm.showAlarmTitle?_c("div",{staticClass:"fc-alarms-chart-title"},[_vm._v(" Alarms ")]):_vm._e(),_c("div",{ref:"alarmsChartEle",staticClass:"fc-alarms-chart pdf-chart"})]),_c("div",{staticClass:"fc-newchart-container"},[_c("div",{ref:"newChartEle",staticClass:"fc-new-chart pdf-chart",class:{"hide-y2-axis":_vm.options&&_vm.options.axis&&!1===_vm.options.axis.showy2axis}}),_vm.chartContext.options.legend.show&&"right"===_vm.chartContext.options.legend.position?_c("f-chart-legends",{style:{width:_vm.chartContext.options.legend.width+"px"},attrs:{chart:_vm.c3.chart,options:_vm.options,xValueMode:_vm.chartContext.xValueMode,xLabelMap:_vm.chartContext.xLabelMap,config:_vm.config}}):_vm._e()],1),_vm.chartContext.options.legend.show&&"bottom"===_vm.chartContext.options.legend.position?_c("f-chart-legends",{ref:"chartLegend",attrs:{chart:_vm.c3.chart,options:_vm.options,xValueMode:_vm.chartContext.xValueMode,xLabelMap:_vm.chartContext.xLabelMap}}):_vm._e(),_vm.showWidget?_c("f-widget-legends",{ref:"newWidget",staticClass:"widget-legends",attrs:{chart:_vm.c3.chart,reportVarianceData:_vm.resultObj?_vm.resultObj.reportData.aggr:null,data:_vm.data,options:_vm.options}}):_vm._e()],2):_vm._e()],1)},FNewchartV1vue_type_template_id_4ddd8122_staticRenderFns=[],billboard=(__webpack_require__(212826),__webpack_require__(872695)),basechart=__webpack_require__(503162),c3_helper=__webpack_require__(167021),FChartLegends=__webpack_require__(906575),FChartTitle=__webpack_require__(23369),FWidgetLegends=__webpack_require__(547301),FNewChartType=__webpack_require__(270352),JumpToHelper=__webpack_require__(921466),tooltip=__webpack_require__(460895),color_helper=__webpack_require__(794211),deepmerge=__webpack_require__(708634),FNewchartV1vue_type_script_lang_js={mixins:[basechart/* default */.Z,JumpToHelper/* default */.Z],props:["resultObj","isWidget","showWidgetLegends","config","chartTypeTarget"],components:{FChartLegends:FChartLegends/* default */.Z,FWidgetLegends:FWidgetLegends/* default */.Z,FChartType:FNewChartType/* default */.Z,FChartTitle:FChartTitle/* default */.Z},computed:{showWidget:function(){return"undefined"===typeof this.showWidgetLegends||!!this.config.hasOwnProperty("showWidgetLegends")&&this.config.showWidgetLegends},isRegression:function(){return!!(this.$route.path.includes("regression")||this.resultObj&&this.resultObj.regressionConfig&&0!==this.resultObj.regressionConfig.length&&!0===this.resultObj.regression)},showAlarmTitle:function(){return!this.chartContext||!this.chartContext.options||!this.chartContext.options.hideAlarmTitle}},data:function(){return{chartContext:null,chartId:Math.random().toString(36).substr(2,9),c3:{params:null,chart:null},showAlarms:!1,updateTimeout:null}},mounted:function(){this.config.hidecharttypechanger&&(this.hidecharttypechanger=!0),this.isRegression&&(this.hidecharttypechanger=!0),this.render()},beforeDestroy:function(){tooltip/* default */.Z.hideTooltip(),this.c3&&this.c3.chart&&this.c3.chart.destroy(),this.chartContext=null,this.c3.params=null,this.c3.chart=null},methods:{render:function(){var _this=this;this.data&&(this.chartContext=null,this.$nextTick((function(){_this.chartContext={},_this.chartContext.options=_this.getOptions(),_this.chartContext.dateRange=_this.dateRange,_this.chartContext.data=_this.data,_this.chartContext.xValueMode=_this.isXValueMode(_this.chartContext.options,_this.data),_this.chartContext.unitMap=_this.getUnitMap(_this.options.dataPoints),_this.chartContext.enumMap=_this.getEnumMap(_this.options.dataPoints),_this.chartContext.openAlarm=function(alarmList){if(alarmList){var _step,alarmId=[],_iterator=(0,createForOfIteratorHelper/* default */.Z)(alarmList);try{for(_iterator.s();!(_step=_iterator.n()).done;){var a=_step.value;alarmId.push(a.id)}}catch(err){_iterator.e(err)}finally{_iterator.f()}_this.jumpToAlarms(alarmId)}},"pie"!==_this.chartContext.options.type&&"donut"!==_this.chartContext.options.type||(_this.chartContext.options.padding.top=20);var c3Params=c3_helper/* default */.Z.prepare(_this.chartContext);c3Params&&(c3Params.data.onclick=function(d){_this.$emit("drilldown",d)}),_this.mergeOption&&(_this.chartContext.options.padding.left=_this.mergeOption.padding.left,_this.chartContext.options.padding.right=_this.mergeOption.padding.right,_this.chartContext.options.axis.x.label.text="Month",c3Params.axis.y.label.text="No of Work Request"),_this.isWidget&&(_this.chartContext.options.legend.show?c3Params.size.height=c3Params.size.height-50:c3Params.size.height=c3Params.size.height-20,_this.options.widgetLegend.show&&(c3Params.size.height=c3Params.size.height-75),_this.resultObj&&_this.resultObj.report.userFilters&&(c3Params.size.height=c3Params.size.height-65));var self=_this;self.showAlarms=1===_this.getOptions().common.mode&&_this.getOptions().settings.alarm,_this.config&&_this.config.hasOwnProperty("showAlarms")&&(self.showAlarms=_this.config.showAlarms),self.showAlarms&&(_this.chartContext.alarms=_this.alarms,c3Params.size.height=c3Params.size.height-100);var alarmsParams=null;if(self.showAlarms&&(alarmsParams=c3_helper/* default */.Z.prepareBooleanChart(_this.chartContext,c3Params.data.json.x,_this.alarms),self.$refs["alarmsChartEle"]&&(alarmsParams.bindto=self.$refs["alarmsChartEle"],billboard.bb.generate(alarmsParams))),_this.chartContext.options.customizeC3){var defaultOptions={},mergedOptions=deepmerge/* default */.Z.objectAssignDeep(defaultOptions,c3Params,_this.chartContext.options.customizeC3);c3Params=mergedOptions}self.$refs["newChartEle"]?(c3Params.bindto=self.$refs["newChartEle"],self.isWidget&&self.$refs["chartLegend"]&&(c3Params.size.height=c3Params.size.height-(self.$refs["chartLegend"].$el.clientHeight-20)),self.fixedChartHeight&&(c3Params.size.height=self.fixedChartHeight),self.c3.params=c3Params,self.c3.chart=billboard.bb.generate(c3Params)):_this.$nextTick((function(){self.showAlarms&&self.$refs["alarmsChartEle"]&&(alarmsParams.bindto=self.$refs["alarmsChartEle"],billboard.bb.generate(alarmsParams)),c3Params.bindto=self.$refs["newChartEle"],self.isWidget&&self.$refs["chartLegend"]&&(c3Params.size.height=c3Params.size.height-(self.$refs["chartLegend"].$el.clientHeight-20)),self.fixedChartHeight&&(c3Params.size.height=self.fixedChartHeight),self.c3.params=c3Params,self.c3.chart=billboard.bb.generate(c3Params)}))})))},isXValueMode:function(options,data){if("pie"===options.type||"donut"===options.type){if(options.xColorMap)return!0;if(data&&data.x&&2===Object.keys(data).length&&data.x.length<=15){for(var colors=color_helper/* default */.Z.newColorPicker(data.x.length),xColorMap={},i=0;i<data.x.length;i++){var xVal=data.x[i];xColorMap[xVal]=options.xColorMap&&options.xColorMap[xVal]?options.xColorMap[xVal]:colors[i]}return options.xColorMap=xColorMap,!0}}return!1},reRender:function(){var _this2=this;this.updateTimeout&&clearTimeout(this.updateTimeout),this.updateTimeout=setTimeout((function(){return _this2.render()}),500)},resize:function(){this.reRender(),this.$refs["newWidget"]&&this.$refs["newWidget"].resize()},update:function(){this.reRender()}}},components_FNewchartV1vue_type_script_lang_js=FNewchartV1vue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FNewchartV1vue_type_script_lang_js,FNewchartV1vue_type_template_id_4ddd8122_render,FNewchartV1vue_type_template_id_4ddd8122_staticRenderFns,!1,null,null,null)
/* harmony default export */,FNewchartV1=component.exports,FMobileChart=__webpack_require__(242208),FMultiChart=__webpack_require__(649206),NewDataFormatHelper=__webpack_require__(804911),AnalyticsMixin=__webpack_require__(244936),FTabularReportNew=__webpack_require__(979),FNewChartSettings=__webpack_require__(83322),FMobileMultiChart=__webpack_require__(696593),PredictionTimingsBar=__webpack_require__(107387),NewDateHelper=__webpack_require__(105534),RangeChartDialog=__webpack_require__(515326),NewReportSummaryHelper=__webpack_require__(601458),FNewHeatMap=__webpack_require__(283938),FNewAnalyticsReportV1vue_type_script_lang_js={props:["config","baseLines","readings","showChartMode","showTimePeriod","chartTypeTarget"],mixins:[NewDataFormatHelper/* default */.Z,AnalyticsMixin/* default */.Z,NewDateHelper/* default */.Z,NewReportSummaryHelper/* default */.Z],components:{NewDatePicker:NewDatePicker/* default */.Z,FNewChart:FNewchartV1,FMultiChart:FMultiChart/* default */.Z,FTabularReport:FTabularReportNew/* default */.Z,FMobileChart:FMobileChart/* default */.Z,FChartSettings:FNewChartSettings/* default */.Z,FMobileMultiChart:FMobileMultiChart/* default */.Z,PredictionTimingsBar:PredictionTimingsBar/* default */.Z,RangeChartDialog:RangeChartDialog/* default */.Z,FNewHeatMap:FNewHeatMap/* default */.Z},data:function(){return{loading:!0,predictive:!0,failed:!1,reportObj:null,resultObj:null,showRangeChartDialog:!1,showTemplateFilter:!1}},mounted:function(){this.init()},created:function(){this.$store.dispatch("loadAssetCategory")},computed:{isHeatMap:function(){return!(!this.$route||!this.$route.meta||"heatmap"!==this.$route.meta.analyticsType)},getAvailablePeriods:function(){var operationOnId=this.config.dateFilter.operationOnId,avail=[];
// avail.push({
//   name:'Week of year', // W1, W2
//   value: 16,
//   enable: true
// })
// avail.push({
//   name:'Month of year', // Jan, Feb , march
//   value: 15,
//   enable: true
// })
return avail.push({name:"High-res",value:0,enable:6===operationOnId||4!==operationOnId}),avail.push({name:"Hourly",value:20,enable:6===operationOnId||4!==operationOnId}),avail.push({name:"Daily",value:12,enable:!0}),avail.push({name:"Weekly",value:11,enable:!0}),avail.push({name:"Monthly",value:10,enable:!0}),avail.push({name:"Quarterly",value:25,enable:4===operationOnId||5===operationOnId}),avail.push({name:"Yearly",value:8,enable:4===operationOnId}),avail.push({name:"Hour of day",
// 12, 1, 2, 3
value:19,enable:!0}),avail.push({name:"Day of week",
// sun, mon
value:17,enable:!0}),avail.push({name:"Day of month",
// 1,2,3
value:18,enable:!0}),avail},isRegression:function(){return!!this.$route.path.includes("regression")}},watch:{config:{handler:function(newData,oldData){this.config.applyReportDate&&this.config.period||this.init(!1)},deep:!0},getAvailablePeriods:{handler:function(newData,oldData){var _this=this,avail=this.getAvailablePeriods,selected=avail.find((function(a){return a.value===_this.config.period&&a.enable}));if(!selected){var filterName=this.config.dateFilter.operationOn,defaultPeriod=avail.filter((function(a){return a.enable}))[0].value;"week"===filterName||"month"===filterName?defaultPeriod=12:"year"===filterName&&(defaultPeriod=10),this.config.period=defaultPeriod}},immediate:!0}},methods:{changeParentForTemplate:function(){this.config.template&&(this.config.template.parentId=this.resultObj.report.currentTemplate.parentId)},onPeriodChange:function(){if(!this.config.dataPoints.length){var filter="D";20===this.config.period?filter="W":12===this.config.period?filter="M":10===this.config.period&&(filter="Y"),this.config.dateFilter=this.getDefaultDateFilter(filter)}},addRangePoints:function(val,remainingDataPoints){var _step,ranges=["min","max","avg"],dataPoints=[],_iterator=(0,createForOfIteratorHelper/* default */.Z)(val);try{for(_iterator.s();!(_step=_iterator.n()).done;){var rangeConfig=_step.value;for(var key in rangeConfig){var config={};ranges.includes(key)&&(config["parentId"]=rangeConfig[key].parentId,config["prediction"]=!1,config["aliases"]={actual:rangeConfig[key].alias},config["yAxis"]={aggr:rangeConfig[key].aggr,fieldId:rangeConfig[key].fieldId},dataPoints.push(config))}}}catch(err){_iterator.e(err)}finally{_iterator.f()}var _step2,_iterator2=(0,createForOfIteratorHelper/* default */.Z)(remainingDataPoints);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var dataPoint=_step2.value,_config={};_config["parentId"]=dataPoint.metaData.parentIds[0],_config["prediction"]=!1,_config["aliases"]={actual:dataPoint.aliases.actual},_config["yAxis"]={aggr:dataPoint.yAxis.aggr,fieldId:dataPoint.yAxis.fieldId},dataPoints.push(_config)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}var analyticConfig=this.$helpers.cloneObject(this.config);analyticConfig.dataPoints=dataPoints,analyticConfig.period="undefined"!==typeof this.config.period&&null!==this.config.period?0===this.config.period?this.getXAggr():this.config.period:0,this.$emit("update:config",analyticConfig)},setDateFilter:function(dateFilter){this.$set(this.config,"dateFilter",dateFilter);
// this.$emit('update:config', this.config)
},init:function(){this.initChart()},resize:function(){this.$refs["newChart"]&&this.$refs["newChart"].resize(),this.$refs["multiChart"]&&this.$refs["multiChart"].resize(),this.$refs["newTable"]&&this.$refs["newTable"].resize()},getReportParams:function(){var baselines,baselineNames,_this2=this;if(this.config.baseLine&&Array.isArray(this.config.baseLine)&&this.config.baseLine.length){if(this.config.baseLine[0]>0){var bl={};bl.baseLineId=this.config.baseLine[0],this.config.baseLine.length>1&&(bl.adjustType=this.config.baseLine[1]);var blList=[];blList.push(bl),baselines=blList}}else this.config.baseLine&&this.config.baseLine>0&&(baselines=[{baseLineId:this.config.baseLine}]);baselines&&this.baseLines&&(baselineNames=[],baselines.forEach((function(baseline){var baseLineName=_this2.baseLines.find((function(bl){return bl.id===baseline.baseLineId})).name;baselineNames.push(baseLineName)})));var fields=[];if(3===this.config.mode){var _step3,parentId=[],fieldId=null,yAggr=3,_iterator3=(0,createForOfIteratorHelper/* default */.Z)(this.config.dataPoints);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var dp=_step3.value;parentId.push(dp.parentId),fieldId=dp.yAxis.fieldId,yAggr=dp.yAxis.aggr}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}fields.push({parentId:parentId,yAxis:{fieldId:fieldId,aggr:0!==this.config.period&&0===yAggr?3:yAggr},type:1,aliases:{actual:"A"}}),this.setAlias(fields,baselineNames)}else{this.setAlias(this.config.dataPoints,baselineNames);var _step4,_iterator4=(0,createForOfIteratorHelper/* default */.Z)(this.config.dataPoints);try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var _dp=_step4.value,metaData={};_dp.categoryId&&(metaData.categoryId=_dp.categoryId),this.config.template?fields.push({parentId:_dp.parentId?Array.isArray(_dp.parentId)?_dp.parentId:[_dp.parentId]:null,buildingId:_dp.buildingId?_dp.buildingId:-1,metaData:metaData,yAxis:{fieldId:_dp.yAxis.fieldId,aggr:_dp.yAxis.aggr},aliases:_dp.aliases,type:_dp.type>0?_dp.type:1,predictedTime:_dp.predictedTime,rule_aggr_type:null===_dp||void 0===_dp?void 0:_dp.rule_aggr_type}):fields.push({parentId:_dp.parentId?Array.isArray(_dp.parentId)?_dp.parentId:[_dp.parentId]:null,name:_dp.name,buildingId:_dp.buildingId?_dp.buildingId:-1,metaData:metaData,yAxis:_dp.yAxis,aliases:_dp.aliases,type:_dp.type>0?_dp.type:1,predictedTime:_dp.predictedTime,moduleName:_dp.reportModuleName})}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}}if(this.config.sorting&&(6===this.config.mode||7===this.config.mode||8===this.config.mode)&&(this.config.sorting.orderByFunc||this.config.sorting.limit)){var sortByField=this.config.sorting.sortByField;if(sortByField){var _field=fields.find((function(f){return f.yAxis.fieldId===sortByField}));_field||(sortByField=null)}sortByField||(sortByField=fields[0].yAxis.fieldId,this.config.sorting.sortByField=fields[0].yAxis.fieldId);var field=null;sortByField?field=fields.find((function(f){return f.yAxis.fieldId===sortByField})):this.config.dataPoints.length<=1&&(field=fields[0]),field&&(field.defaultSortPoint=!0,this.config.sorting.orderByFunc&&(field.orderByFunc=this.config.sorting.orderByFunc),this.config.sorting.limit&&(field.limit=this.config.sorting.limit))}this.config.template&&null!==this.config.template.parentId&&fields.forEach((function(d){d.parentId=[_this2.config.template.parentId]}));var params={mode:this.config.mode,startTime:this.config.dateFilter.value[0],endTime:this.config.dateFilter.value[1],xAggr:1===this.config.mode||3===this.config.mode||4===this.config.mode||5===this.config.mode?this.config.period:0,fields:JSON.stringify(fields),transformWorkflow:this.config.transformWorkflow};if(this.reportObj&&this.reportObj.options&&this.reportObj.options.settings?(params.showAlarms=this.reportObj.options.settings.alarm,params.showSafeLimit=this.reportObj.options.settings.safelimit):this.config.savedReport?(params.showAlarms=this.config.savedReport.showAlarms,params.showSafeLimit=this.config.savedReport.showSafeLimit):params.showSafeLimit=!0,window.fetchMarkedAlso&&(params.shouldIncludeMarked=!0),baselines&&(params.baseLines=JSON.stringify(baselines)),this.config.filters&&this.config.filters.xCriteriaMode)if(params.xCriteriaMode=this.config.filters.xCriteriaMode,this.config.filters.parentId&&this.config.filters.parentId.length)params.parentId=this.config.filters.parentId;else{var categoryId=this.config.filters.assetCategory;if(!categoryId||!categoryId.length){categoryId=[];var _step5,_iterator5=(0,createForOfIteratorHelper/* default */.Z)(this.config.dataPoints);try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var _dp2=_step5.value;-1===categoryId.indexOf(_dp2.categoryId)&&categoryId.push(_dp2.categoryId)}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}}categoryId.length&&(params.assetCategory=categoryId),this.config.filters.spaceId&&this.config.filters.spaceId.length&&(params.spaceId=this.config.filters.spaceId)}return this.$route.query&&this.$route.query.alarmId&&(params.alarmId=parseInt(this.$route.query.alarmId),params.showAlarms=!0),params},initChart:function(){var self=this;self.loading=!0,self.failed=!1;var apiURL=this.config.api?this.config.api:"/v2/report/readingReport",params=null;this.config.alarmId&&(apiURL="/v2/report/fetchReadingsFromAlarm",params={alarmId:this.config.alarmId,mode:1,xAggr:this.config.period||0,startTime:this.config.dateFilter.value[0],endTime:this.config.dateFilter.value[1],showAlarms:!0}),this.config.readingRuleId&&(params.readingRuleId=this.config.readingRuleId),this.config.isWithPrerequsite&&(params.isWithPrerequsite=this.config.isWithPrerequsite),params||(params=self.getReportParams()),this.config.template&&this.config.template.show&&(apiURL=apiURL+"?templateString="+encodeURIComponent(JSON.stringify(this.config.template))),this.config.analyticsType&&(params.analyticsType=this.config.analyticsType),params.newFormat=!0,self.$http.post(apiURL,params).then((function(response){var result=response.data.result;if(result.xAggr=params.xAggr,result.mode=params.mode,self.config.analyticsType&&(result.report.analyticsType=self.config.analyticsType),self.config.filters&&(result.filters=self.config.filters),self.config.sorting&&(result.sorting=self.config.sorting),self.config.applyReportDate?(self.config.dateFilter=result.dateRange=NewDateHelper/* default */.Z.getDatePickerObject(self.config.dateFilter.operatorId,result.report.dateValue),self.$nextTick((function(){self.$refs.newDatePicker.loadFromObject()}))):result.dateRange=self.config.dateFilter,self.reportObj&&!self.config.alarmId?(result.report.chartState=self.reportObj.options,result.report.tabularState=self.reportObj.params.tabularState):self.config.savedReport&&(result.report.chartState=self.config.savedReport.chartState,result.report.tabularState=self.config.savedReport.tabularState),self.reportObj=self.prepareReport(result),self.config.customizeC3&&self.reportObj.options&&(self.reportObj.options["customizeC3"]=self.config.customizeC3),self.config.customizeChartOptions&&self.reportObj.options&&(self.reportObj.options=deepmerge/* default */.Z.objectAssignDeep(self.reportObj.options,self.config.customizeChartOptions)),self.config.template){var currentTemplate=JSON.parse(JSON.stringify(self.config.template)),filters=self.getFiltersFromCriteria(currentTemplate);self.loadReportTemplateValues(currentTemplate,filters).then((function(){currentTemplate.parentId=null===currentTemplate.parentId?currentTemplate.defaultValue:currentTemplate.parentId,self.$set(self.resultObj.report,"currentTemplate",currentTemplate),self.showTemplateFilter=!0}))}(self.config.isFromAlarmSummary||self.$route.query&&self.$route.query.isFromAlarmSummary&&!self.resultObj)&&self.reportObj.booleanData&&(self.reportObj.options.dataPoints=self.groupNonBooleanPoints(self.reportObj.options.dataPoints)),(self.$route.query&&self.$route.query.alarmId||self.config.alarmId)&&(self.reportObj.options.settings.alarm=!0),self.config.alarmId&&"undefined"!=typeof self.config.showAlarmBar&&(self.reportObj.options.settings.alarm=self.config.showAlarmBar),self.resultObj=result,self.reportObj.params=params,self.reportObj.tableConfig=self.config.tableConfig,self.reportObj.alarms=self.prepareBooleanReport(result.reportData.aggr),self.config.alarmId&&(self.reportObj.alarms.barSize="medium"),self.config.regionConfig&&(self.reportObj.options.regionConfig=self.config.regionConfig),self.config.hideDataPoints&&(self.reportObj.options.hideDataPoints=self.config.hideDataPoints),self.config.hasOwnProperty("disbaleNiceTickMarks")&&(self.reportObj.options.disbaleNiceTickMarks=self.config.disbaleNiceTickMarks),self.config.chartType&&(self.reportObj.options.chartType=self.config.chartType),self.config.diffChartConfig&&(self.reportObj.options.diffChartConfig=self.config.diffChartConfig),self.config.hideLegends&&self.reportObj.options.legend&&(self.reportObj.options.legend.show=!1),self.config.paddingOptions&&(self.reportObj.options.padding=self.config.paddingOptions),self.config.intersections&&(self.reportObj.options.intersections=self.config.intersections),self.config.point&&(self.config.pointShowRule?self.reportObj.options.point=self.pointShowRule(self.reportObj.dateRange,self.config.pointShowRule):self.reportObj.options.point=self.config.point),self.config.zoom&&(self.reportObj.options.zoom=self.config.zoom),self.config.size&&(self.config.size.width||self.config.size.height)&&(self.reportObj.options.size=self.config.size),self.config.axes&&(self.reportObj.options.axes=self.config.axes),self.reportObj.options.xFormat="MM-DD-YYYY",self.config.xFormat&&(self.reportObj.options.xFormat=self.config.xFormat),self.config.colors&&self.reportObj.options.dataPoints&&self.reportObj.options.dataPoints.length&&self.reportObj.options.dataPoints.forEach((function(rt){rt.color=self.config.colors[rt.key]})),self.config.axis&&(self.reportObj.options.fixedAxis=self.config.axis),self.reportObj.options.predictionTimings=self.config.predictionTimings,self.$emit("reportLoaded",self.reportObj,self.resultObj),self.loading=!1})).catch((function(error){error&&(self.loading=!1,self.failed=!0)}))},onSettingsChange:function(changedOption){"alarm"===changedOption?this.reportObj.alarms&&this.reportObj.alarms.regions.length||!this.reportObj.options.settings.alarm||this.init():"safelimit"===changedOption&&!this.reportObj.options.safeLimit.length&&this.reportObj.options.settings.safelimit&&this.init()}}},v1_FNewAnalyticsReportV1vue_type_script_lang_js=FNewAnalyticsReportV1vue_type_script_lang_js,FNewAnalyticsReportV1_component=(0,componentNormalizer/* default */.Z)(v1_FNewAnalyticsReportV1vue_type_script_lang_js,render,staticRenderFns,!1,null,"1fa73ec3",null)
/* harmony default export */,FNewAnalyticsReportV1=FNewAnalyticsReportV1_component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/40367.js.map