(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[24784,32686,80865,53021,51201],{
/***/436756:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FDialogNew}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/FDialogNew.vue?vue&type=template&id=388b7f7a
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"costdialog",class:["f-dialog",_vm.customClass],attrs:{visible:_vm.visible,"before-close":_vm.close,width:_vm.width,"append-to-body":!0},on:{"update:visible":function($event){_vm.visible=$event}}},[_c("div",{staticClass:"f-dialog-title",attrs:{slot:"title"},slot:"title"},[_vm._t("header",(function(){return[_c("div",{staticClass:"label-txt-black fwBold"},[_vm._v(" "+_vm._s(_vm.title)+" ")])]}))],2),_c("div",{staticClass:"f-dialog-content",style:_vm.styleCss},[_vm._t("content"),_vm._t("default")],2),_c("div",{staticClass:"f-footer row",staticStyle:{height:"46px"}},[_vm._t("footer",(function(){return[_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.close}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.loading},on:{click:_vm.save}},[_vm._v(_vm._s(_vm.loading?_vm.loadingTitle||"Saving...":_vm.confirmTitle||"Save"))])],1)]}))],2)])},staticRenderFns=[],FDialogNewvue_type_script_lang_js={props:["title","confirmTitle","visible","customClass","width","maxHeight","stayOnSave","loading","loadingTitle","record"],computed:{styleCss:function(){return this.maxHeight?{"max-height":this.maxHeight,overflow:"scroll"}:null}},methods:{close:function(){this.$emit("close"),this.$emit("update:visible",!1)},save:function(){this.$emit("save"),this.stayOnSave||this.$emit("update:visible",!1)}}},components_FDialogNewvue_type_script_lang_js=FDialogNewvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FDialogNewvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FDialogNew=component.exports},
/***/350367:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FUploadPhotos}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/FUploadPhotos.vue?vue&type=template&id=5a0f9682
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"upload-photos-dialog fc-dialog-center-container",attrs:{title:"Upload Photos",visible:_vm.showDialog,"append-to-body":!0},on:{"update:visible":function($event){_vm.showDialog=$event},"before-close":_vm.closeDialog}},[_vm.showDialog?_c("el-upload",{attrs:{multiple:"","list-type":"picture-card","file-list":_vm.photos,action:"",accept:"image/*","http-request":_vm.onUpload,"on-success":_vm.onUploadSuccess,"on-error":_vm.onError,"on-remove":_vm.onRemove}},[_c("i",{staticClass:"el-icon-plus"})]):_vm._e(),_c("span",{staticClass:"dialog-footer modal-dialog-footer",attrs:{slot:"footer"},slot:"footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.closeDialog}},[_vm._v("Cancel")]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:_vm.done}},[_vm._v("Done")])],1)],1)},staticRenderFns=[],toConsumableArray=__webpack_require__(488478),validation=(__webpack_require__(434284),__webpack_require__(670560),__webpack_require__(339772),__webpack_require__(162506),__webpack_require__(990260)),eventBus=__webpack_require__(398011),FUploadPhotosvue_type_script_lang_js={props:["module","record","list"],data:function(){return{photos:[],showDialog:!1,isChanged:!1}},methods:{open:function(){this.photos=(0,validation/* isEmpty */.xb)(this.list)?[]:this.list,this.showDialog=!0},onUpload:function(_ref){var file=_ref.file,data=(_ref.onError,{parentId:this.record.id,module:this.module}),formData=new FormData;for(var key in formData.append("file",file,file.name),data)this.$helpers.setFormData(key,data[key],formData);return this.$http.post("v2/photos/upload",formData)},onUploadSuccess:function(response){var _response$data=response.data,responseCode=_response$data.responseCode,result=_response$data.result;0===responseCode&&(this.list.push(result.photos[0]),this.isChanged=!0)},onError:function(){this.$message.error(this.$t("setup.users_management.Invalid_image"))},onRemove:function(file){var _this=this;this.$http.post("/v2/photos/delete",{id:file.id,photoId:file.photoId,module:this.module,parentId:this.record.id}).then((function(response){if(0===response.data.responseCode){var list=(0,toConsumableArray/* default */.Z)(_this.list),index=list.findIndex((function(f){return f.id===file.id}));list.splice(index,1),_this.$emit("updatePhotos",list),_this.isChanged=!0}})).catch((function(){}))},done:function(){this.showDialog=!1,this.photos=[],this.isChanged&&(eventBus/* eventBus */.Y.$emit("refreshDetails"),this.isChanged=!1)},closeDialog:function(){this.isChanged&&(eventBus/* eventBus */.Y.$emit("refreshDetails"),this.isChanged=!1),this.showDialog=!1}}},components_FUploadPhotosvue_type_script_lang_js=FUploadPhotosvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FUploadPhotosvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FUploadPhotos=component.exports},
/***/391810:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return MobileAttachment2}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/MobileAttachment2.vue?vue&type=template&id=46fd5568
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_vm.loading?_c("div",{staticClass:"text-center"},[_c("spinner",{attrs:{show:_vm.loading}})],1):_c("div",[_c("div",{staticClass:"row"},[_c("div",{staticClass:"col-12 col-lg-12 col-md-12 col-sm-12 col-xs-12"},[_c("div",{staticClass:"row"},[_c("div",[_c("div",{staticClass:"header-label pB15"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.before"))+" ")]),_vm.beforeImage?_c("div",[_c("div",[_c("img",{staticClass:"custom-file-upload",staticStyle:{padding:"0px"},attrs:{width:"100",height:"auto",src:_vm.beforeImage},on:{click:function($event){return _vm.imgaeBefore(1)}}})])]):_c("div",[_c("div",{staticClass:"inputover"},[_vm._m(0),_vm.doNotSave?_c("input",{attrs:{id:"file-upload",type:"file",accept:"image/*",disabled:_vm.disabled},on:{change:function($event){return _vm.marshallFile($event.target.files,1)}}}):_c("input",{attrs:{id:"file-upload",type:"file",accept:"image/*",disabled:_vm.disabled},on:{change:function($event){return _vm.filesChange($event.target.files,1)}}})])])]),_c("div",{staticClass:"mL30"},[_c("div",{staticClass:"header-label pB15",staticStyle:{"padding-left":"0px"}},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.after"))+" ")]),_vm.afterImage?_c("div",[_c("div",[_c("img",{staticClass:"custom-file-upload",staticStyle:{padding:"0px"},attrs:{width:"100",height:"auto",src:_vm.afterImage},on:{click:function($event){return _vm.imgaeBefore(2)}}})])]):_c("div",[_c("div",{staticClass:"inputover"},[_vm._m(1),_vm.doNotSave?_c("input",{attrs:{id:"file-upload",type:"file",accept:"image/*",disabled:_vm.disabled},on:{change:function($event){return _vm.marshallFile($event.target.files,2)}}}):_c("input",{attrs:{id:"file-upload",type:"file",accept:"image/*",disabled:_vm.disabled},on:{change:function($event){return _vm.filesChange($event.target.files,2)}}})])])])])])])]),_vm.visibility&&_vm.selectedAttachment?_c("preview-file",{attrs:{visibility:_vm.visibility,showDelete:"true",previewFile:_vm.selectedAttachment,files:_vm.attachments},on:{"update:visibility":function($event){_vm.visibility=$event},onDelete:_vm.taskPhotoDletion}}):_vm._e()],1)},staticRenderFns=[function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("label",{staticClass:"custom-file-upload",attrs:{for:"file-upload"}},[_c("i",{staticClass:"fa fa-camera"})])},function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("label",{staticClass:"custom-file-upload",attrs:{for:"file-upload"}},[_c("i",{staticClass:"fa fa-camera"})])}],createForOfIteratorHelper=__webpack_require__(566347),PreviewFile=(__webpack_require__(434284),__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(670560),__webpack_require__(720096)),api=__webpack_require__(32284),validation=__webpack_require__(990260),MobileAttachment2vue_type_script_lang_js={props:["module","record","disabled","doNotSave"],data:function(){return{loading:!0,before:!1,after:null,status:{UPLOADING:1,SUCCESS:2,FAILED:3},beforeImage:null,afterImage:null,attachments:[],formFieldName:"attachment",attachmentType:-1,selectedAttachment:null,visibility:!1,afterImageDetail:{},beforeImageDetail:{}}},watch:{record:function(recordObj){this.loadAttachments()},attachments:function(newVal){this.record.noOfAttachments=this.attachments.length}},components:{PreviewFile:PreviewFile/* default */.Z},mounted:function(){this.loadAttachments()},methods:{taskPhotoDletion:function(file){var _this=this,dialogObj={title:"Delete Task Attachment",message:"Are you sure you want to delete this attachment?",rbDanger:!0,rbLabel:"Delete"};this.$dialog.confirm(dialogObj).then((function(value){if(value){var url="/v2/tasks/deleteTaskAttachment",id=file.id,params={recordId:_this.record.id,attachmentId:[id],module:"taskattachments"};api/* API */.bl.post(url,params).then((function(_ref){_ref.data;var error=_ref.error;error?_this.$message.error(error.message||"Error Occured"):(1===file.type?_this.beforeImage=null:2===file.type&&(_this.afterImage=null),_this.$emit("taskattachmentactivity"),_this.visibility=!1)}))}}))},marshallFile:function(fileList,attType){var _this2=this,attachmentInfo={module:this.module,recordId:this.record.id,attachmentType:attType,formFieldName:this.formFieldName,file:fileList[0],fileName:fileList[0].name},picReader=new FileReader;picReader.addEventListener("load",(function(event){var picFile=event.target;1===attType?_this2.beforeImage=picFile.result:2===attType&&(_this2.afterImage=picFile.result)})),picReader.readAsDataURL(fileList[0]),this.$emit("marshalled",attachmentInfo)},loadAttachments:function(){if(!this.record&&!this.record.id)return!1;var self=this;return self.loading=!0,this.$http.get("/attachment?module="+this.module+"&recordId="+this.record.id).then((function(response){if(200===response.status)if(self.loading=!1,self.attachments=response.data.attachments?response.data.attachments:[],self.attachments.length>0){var _step,_iterator=(0,createForOfIteratorHelper/* default */.Z)(self.attachments);try{for(_iterator.s();!(_step=_iterator.n()).done;){var attachment=_step.value;1===attachment.type?self.beforeImage=attachment.previewUrl:2===attachment.type&&(self.afterImage=attachment.previewUrl),self.setAttachmentDetail(attachment)}}catch(err){_iterator.e(err)}finally{_iterator.f()}}else self.beforeImage=null,self.afterImage=null}))},imgaeBefore:function(type){if(this.attachments.length>0){this.visibility=!0;var _step2,_iterator2=(0,createForOfIteratorHelper/* default */.Z)(this.attachments);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var attachment=_step2.value;type===attachment.type&&(this.selectedAttachment=attachment,this.setAttachmentDetail(attachment))}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}},filesChange:function(fileList,attType){var self1=this,formData=new FormData;formData.append("module",this.module),formData.append("recordId",this.record.id),formData.append("attachmentType",attType),formData.append(this.formFieldName,fileList[0],fileList[0].name);var picReader=new FileReader;picReader.addEventListener("load",(function(event){var picFile=event.target;1===attType?(self1.beforeImage=picFile.result,self1.beforeImageDetail={}):2===attType&&(self1.afterImage=picFile.result,self1.afterImageDetail={})})),picReader.readAsDataURL(fileList[0]);var self=this;self.$http.post("/attachment/add",formData).then((function(response){if(self.$emit("taskattachmentactivity"),200===response.status){self.$message.success("Attachment added successfully");var _ref2=response||{},data=_ref2.data,_ref3=data||[],attachments=_ref3.attachments;(0,validation/* isEmpty */.xb)(attachments)||attachments.forEach((function(attachment){self.attachments.push(attachment),self.setAttachmentDetail(attachment)}));
// window.location.reload()
}})).catch((function(){self.$message.error("Error in adding attachment")}))},setAttachmentDetail:function(attachment){1==attachment.type&&(this.beforeImageDetail=attachment),2==attachment.type&&(this.afterImageDetail=attachment)}}},components_MobileAttachment2vue_type_script_lang_js=MobileAttachment2vue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_MobileAttachment2vue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,MobileAttachment2=component.exports},
/***/720096:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return PreviewFile}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/PreviewFile.vue?vue&type=template&id=447c7e89
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.currentFile?_c("div",{directives:[{name:"show",rawName:"v-show",value:_vm.show,expression:"show"}],staticClass:"preview-file"},[_c("div",{staticClass:"top-toolbar"},[_c("div",{staticClass:"a-top-toolbar"},[_c("div",{staticClass:"file-name word-break-keep"},[_vm._v(" "+_vm._s(_vm.currentFile.fileName)+" ")]),_c("div",{staticClass:"top-toolbar-icon-right flex align-center"},[_vm.currentFile.contentType.includes("image")?[_c("div",{staticClass:"flex-middle pL15"},[_vm.showOriginalImage?_c("div",{staticClass:"fc-white-14 word-break-keep pointer",on:{click:_vm.showOriginalPhoto}},[_vm._v(" "+_vm._s(_vm.$t("common._common.view_original"))+" ")]):_vm._e(),_vm.showCompressedImage?_c("div",{staticClass:"fc-white-14 word-break-keep pointer",on:{click:_vm.showCompressedPhoto}},[_vm._v(" "+_vm._s(_vm.$t("common._common.view_default"))+" ")]):_vm._e()]),_c("div",{staticClass:"download-icon round flex-middle pL15",on:{click:function($event){return _vm.downloadAttachment(_vm.currentFile)}}},[_c("i",{staticClass:"el-icon-download op8",staticStyle:{color:"#ffff"}})])]:_vm._e(),_vm.currentFile.contentType.includes("pdf")?[_c("div",{staticClass:"download-icon round flex-middle pL15",on:{click:function($event){return _vm.downloadAttachment(_vm.currentFile)}}},[_c("i",{staticClass:"el-icon-download op8",staticStyle:{color:"#ffff"}})])]:_vm._e(),_vm.showDeleteOption()?_c("div",{staticClass:"flex-middle pL15",on:{click:function($event){return _vm.deletePreview()}}},[_c("inline-svg",{staticClass:"pointer edit-icon-color close vertical-text-top",attrs:{src:"svgs/delete",iconClass:"icon icon-md"}})],1):_vm._e(),_c("div",{staticClass:"pL15"},[_c("i",{staticClass:"el-icon-close close",on:{click:_vm.closePreview}})])],2)])]),_vm.currentFileIndex>0?_c("a",{staticClass:"el-icon-arrow-left prev",staticStyle:{"font-size":"30px"},on:{click:function($event){return _vm.plusSlides(-1)}}}):_vm._e(),_vm.currentFileIndex<_vm.files.length-1?_c("a",{staticClass:"el-icon-arrow-right next",staticStyle:{"font-size":"30px"},on:{click:function($event){return _vm.plusSlides(1)}}}):_vm._e(),_c("div",{staticClass:"preview-content"},[_vm.currentFile.contentType.includes("image")?[_vm.compressedImage?_c("img",{staticClass:"content",staticStyle:{"box-shadow":"none"},attrs:{src:_vm.$prependBaseUrl(_vm.currentFile.previewUrl)}}):_vm.originalImage?_c("img",{staticClass:"content original",staticStyle:{"box-shadow":"none"},attrs:{src:_vm.$prependBaseUrl(_vm.currentFile.previewUrl+"?fetchOriginal=true")}}):_vm._e()]:_vm.currentFile.contentType.includes("pdf")?_c("div",{staticClass:"width100 height-100"},[_c("iframe",{staticClass:"fc-preview-pdf",attrs:{src:_vm.$prependBaseUrl(_vm.currentFile.previewUrl),height:"100%",width:"100%"}})]):_vm.isVideoSupported(_vm.currentFile.contentType)?_c("div",{staticClass:"width100 height-100 fc-preview-video"},[_c("video",{attrs:{controls:""}},[_c("source",{attrs:{src:_vm.$prependBaseUrl(_vm.$getProperty(_vm.currentFile,"downloadUrl",null)),type:_vm.$getProperty(_vm.currentFile,"contentType")}}),_vm._v(" "+_vm._s(_vm.$t("common._common.browser_not_supported"))+" ")])]):_c("div",{staticClass:"no-preview"},[_c("div",{staticClass:"flex justify-center pT24"},[_c("inline-svg",{staticClass:"d-flex",attrs:{src:_vm.getFileIcon(_vm.currentFile),iconClass:"icon icon-60 overlay"}})],1),_c("div",{staticClass:"f14 pT12 pB12"},[_vm._v("No preview available")]),_c("div",{staticClass:"download-button"},[_c("a",{staticClass:"flex flex-row",staticStyle:{color:"#ffff"},on:{click:function($event){return _vm.downloadAttachment(_vm.currentFile)}}},[_c("div",[_vm._v("Download")])])])])],2),_vm.exportDownloadUrl?_c("iframe",{staticStyle:{display:"none"},attrs:{src:_vm.exportDownloadUrl}}):_vm._e()]):_vm._e()},staticRenderFns=[],validation=(__webpack_require__(339772),__webpack_require__(260228),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(228436),__webpack_require__(990260)),PreviewFilevue_type_script_lang_js={props:["previewFile","files","visibility","showDelete","isLockedState","isTaskClosed"],data:function(){return{show:!0,previewUrl:null,currentFileIndex:0,currentFile:null,imageMargin:null,exportDownloadUrl:null,originalImage:!1,compressedImage:!0,showOriginalImage:!0,showCompressedImage:!1}},destroyed:function(){window.removeEventListener("keyup",this.handler)},mounted:function(){window.addEventListener("keyup",this.handler),this.preloadImages()},watch:{},computed:{},methods:{handler:function(){
// If escape key is pressed...
27===event.keyCode?this.closePreview():37===event.keyCode?this.plusSlides(-1):39===event.keyCode&&this.plusSlides(1)},preloadImages:function(){this.currentFile=this.previewFile?this.previewFile:this.files[0],this.currentFileIndex=this.files.indexOf(this.currentFile)},plusSlides:function(n){var index=this.currentFileIndex+n;index<0&&(index=0),index>=this.files.length&&(index=this.files.length-1),this.currentFileIndex=index,this.currentFile=this.files[index]},closePreview:function(){this.$emit("update:visibility",!1)},deletePreview:function(){var currentFile=this.currentFile;this.$emit("onDelete",currentFile)},downloadAttachment:function(file){var _this=this,_ref=file||{},url=_ref.downloadUrl;this.exportDownloadUrl&&(this.exportDownloadUrl=null),this.$nextTick((function(){_this.exportDownloadUrl=url}))},showOriginalPhoto:function(){this.originalImage=!0,this.showCompressedImage=!0,this.showOriginalImage=!1,this.compressedImage=!1},showCompressedPhoto:function(){this.showCompressedImage=!1,this.originalImage=!1,this.showOriginalImage=!0,this.compressedImage=!0},getFileIcon:function(attachment){var contentType=attachment.contentType,FILE_TYPE_ICONS=this.$constants.FILE_TYPE_ICONS,selectedIndex=FILE_TYPE_ICONS.findIndex((function(icons){var fileTypes=icons.fileTypes;return fileTypes.some((function(type){return contentType.includes(type)}))}));return(0,validation/* isEmpty */.xb)(selectedIndex)?FILE_TYPE_ICONS[0].path:FILE_TYPE_ICONS[selectedIndex].path},isVideoSupported:function(contentType){contentType=contentType||"";var supportedTypes=["video/webm","video/mp4","video/ogg"];return supportedTypes.includes(contentType.trim().toLowerCase())},showDeleteOption:function(){var showDelete=this.showDelete,isLockedState=this.isLockedState,isTaskClosed=this.isTaskClosed;return showDelete&&!isLockedState&&!isTaskClosed}}},components_PreviewFilevue_type_script_lang_js=PreviewFilevue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_PreviewFilevue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,PreviewFile=component.exports},
/***/372587:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return SpaceAssetChooser}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/SpaceAssetChooser.vue?vue&type=template&id=daefb110
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{attrs:{visible:_vm.visibility,fullscreen:!1,open:"top","custom-class":" fc-dialog-up spaceassetchooser setup-dialog60","append-to-body":!0,"before-close":_vm.handleclose},on:{"update:visible":function($event){_vm.visibility=$event}}},[_c("div",{attrs:{id:"spaceassetchooser"}},[_c("div",{staticStyle:{height:"600px","max-height":"600px"}},[_vm.hideSidebar?_vm._e():_c("div",{staticClass:"sidebar",staticStyle:{height:"100%",width:"33%",display:"inline-block"}},[_c("div",{staticClass:"pT30",staticStyle:{"margin-left":"30px","z-index":"100"}},[_c("div",{staticClass:"flLeft",staticStyle:{"padding-right":"30px"},attrs:{disabled:"asset"===_vm.picktype},on:{click:function($event){"asset"!==_vm.picktype&&_vm.openSpace()}}},[_c("div",{staticClass:"flLeft",staticStyle:{"padding-top":"1px"}},[_c("i",{staticClass:"el-icon-circle-check",class:_vm.isAsset?"normalspace":"selectedspace"})]),_c("div",{staticClass:"txtstyle pointer flLeft",staticStyle:{"padding-left":"5px"}},[_vm._v(" "+_vm._s(_vm.$t("common.space_asset_chooser.space"))+" ")]),_c("div",{staticClass:"clearboth"})]),_c("div",{staticClass:"flLeft",attrs:{disabled:"space"===_vm.picktype},on:{click:function($event){"space"!==_vm.picktype&&_vm.openAsset()}}},[_c("div",{staticClass:"flLeft",staticStyle:{"padding-top":"1px"}},[_c("i",{staticClass:"el-icon-circle-check",class:_vm.isAsset?"selectedspace":"normalspace"})]),_c("div",{staticClass:"flLeft"},[_c("span",{staticClass:"txtstyle pointer",staticStyle:{"padding-left":"5px"}},[_vm._v(_vm._s(_vm.$t("common.space_asset_chooser.asset")))])]),_c("div",{staticClass:"clearboth"})]),_c("div",{staticClass:"clearboth"})]),_c("div",{staticStyle:{"margin-left":"30px"}},[_c("div",{staticClass:"space-heading pT30 pB5"},[_vm._v(" "+_vm._s(_vm.$t("common.space_asset_chooser.by_location"))+" ")]),_vm._l(_vm.resourceConfig,(function(field){return _c("div",{key:field.spaceType,staticClass:"pB15"},[_c("el-select",{attrs:{filterable:"",clearable:"",placeholder:field.placeHolder,"data-test-selector":""+field.placeHolder,disabled:4===field.spaceType&&!_vm.isAsset||field.disabled},on:{change:function($event){return _vm.onLocationSelected(field)}},model:{value:field.value,callback:function($$v){_vm.$set(field,"value",$$v)},expression:"field.value"}},_vm._l(field.options,(function(option){return _c("el-option",{key:option.id,attrs:{label:option.name,value:option.id,"data-test-selector":field.placeHolder+"_"+option.name}})})),1)],1)})),_c("div",{staticClass:"pT30"},[_c("div",{staticClass:"space-heading pT15 pB5"},[_vm._v(" "+_vm._s(_vm.$t("common.space_asset_chooser.by_category"))+" ")]),_c("div",[_vm.isAsset?_c("el-select",{attrs:{filterable:"",clearable:"",placeholder:_vm.assetCategory.placeHolder,"data-test-selector":""+_vm.$t("common.space_asset_chooser.by_category"),disabled:!_vm.isAsset},on:{change:_vm.onCategorySelected},model:{value:_vm.assetCategory.value,callback:function($$v){_vm.$set(_vm.assetCategory,"value",$$v)},expression:"assetCategory.value"}},_vm._l(_vm.assetCategory.options,(function(label,value){return _c("el-option",{key:value,attrs:{label:label,value:value,"data-test-selector":_vm.$t("common.space_asset_chooser.by_category")+"_"+label}})})),1):_c("el-select",{staticClass:"inline asset-category fc-input-full-border2",attrs:{filterable:"",clearable:"",placeholder:_vm.spaceCategory.placeHolder},on:{change:_vm.onSpaceCategorySelected},model:{value:_vm.spaceCategory.value,callback:function($$v){_vm.$set(_vm.spaceCategory,"value",$$v)},expression:"spaceCategory.value"}},_vm._l(_vm.spaceCategory.options,(function(label,value){return _c("el-option",{key:value,attrs:{label:label,value:value}})})),1)],1)])],2)]),_c("div",{staticClass:"pull-right heightlist",style:{width:_vm.hideSidebar?"100%":"67%"}},[_c("div",{staticStyle:{"padding-left":"20px","padding-right":"20px"}},[_vm.showQuickSearch?_c("div",{staticStyle:{display:"inline-block",width:"100%"}},[_c("div",{staticClass:"col-6 fc-list-search"},[_c("div",{staticClass:"fc-list-search-wrapper relative chooser-search"},[_c("svg",{staticClass:"search-icon",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32"}},[_c("title",[_vm._v(_vm._s(_vm.$t("common._common.search")))]),_c("path",{attrs:{d:"M21.487 22.927l7.037 7.037c.473.473 1.238.475 1.71.003s.47-1.237-.003-1.71l-7.037-7.037c3.96-4.82 3.675-11.967-.846-16.487C17.539-.076 9.757-.092 4.966 4.699S.191 17.272 5 22.081c4.52 4.52 11.667 4.805 16.487.846zM6.679 6.413c3.848-3.848 10.099-3.836 13.962.027s3.875 10.114.027 13.962c-3.848 3.848-10.099 3.836-13.962-.027S2.831 10.261 6.679 6.413z"}})]),_c("input",{directives:[{name:"model",rawName:"v-model",value:_vm.quickSearchQuery,expression:"quickSearchQuery"}],ref:"quickSearchQuery",staticClass:"quick-search-input",attrs:{autofocus:"autofocus",type:"text",placeholder:"Search"},domProps:{value:_vm.quickSearchQuery},on:{keyup:function($event){return!$event.type.indexOf("key")&&_vm._k($event.keyCode,"enter",13,$event.key,"Enter")?null:_vm.loadResourceData.apply(null,arguments)},input:function($event){$event.target.composing||(_vm.quickSearchQuery=$event.target.value)}}}),_c("svg",{staticClass:"close-icon",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32","aria-hidden":"true"},on:{click:_vm.toggleQuickSearch}},[_c("title",[_vm._v("close")]),_c("path",{attrs:{d:"M17.992 16l8.796-8.796a1.409 1.409 0 0 0-1.992-1.992L16 14.008 7.204 5.212a1.409 1.409 0 0 0-1.992 1.992L14.008 16l-8.796 8.796a1.409 1.409 0 0 0 1.992 1.992L16 17.992l8.796 8.796a1.409 1.409 0 0 0 1.992-1.992L17.992 16z"}})])])])]):_c("div",{staticClass:"flex-middle justify-content-space"},[_c("span",{staticClass:"spaceheading",staticStyle:{display:"inline-block"}},[_vm._v(_vm._s(_vm.isAsset?this.$t("common.space_asset_chooser.asset_list"):this.$t("common.space_asset_chooser.space_list")))]),_c("span",{staticClass:"pull-right pointer"},[_c("span",{on:{click:_vm.toggleQuickSearch}},[_c("i",{staticClass:"el-icon-search"})])])])]),_c("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:_vm.loadMores,expression:"loadMores"}],staticClass:"scroll",attrs:{"infinite-scroll-distance":"10","infinite-scroll-immediate-check":"true"}},[_c("v-infinite-scroll",{staticStyle:{"max-height":"500px",height:"500px","overflow-y":"scroll"},attrs:{loading:_vm.loading,offset:20},on:{bottom:_vm.nextPage}},[_c("table",{staticClass:" pT15 fc-list-view-table"},[_c("thead",[_c("tr",{staticClass:"tablerow pT30",staticStyle:{"background-color":"#ffffff",padding:"15px"}},[_c("td",{staticClass:"headerrow width30"},[_vm._v(" #"+_vm._s(_vm.$t("common._common.id"))+" ")]),_c("td",{staticClass:"headerrow width30"},[_vm._v(" "+_vm._s(_vm.$t("common.space_asset_chooser.name"))+" ")]),_vm.hideSidebar?_vm._e():_c("td",{staticClass:"headerrow width30"},[_vm._v(" "+_vm._s(_vm.$t("common.space_asset_chooser.category"))+" ")]),_c("td"),_c("td")])]),_c("tbody",[_vm._l(_vm.spaceList,(function(space){return _vm.isAsset?_vm._e():_c("tr",{key:space.id,staticClass:"tablerow",class:{selectedrow:_vm.selectedObj===space},attrs:{"data-test-selector":""+space.name},on:{click:function($event){return _vm.select(space,1)}}},[_c("td",{staticClass:"contentrow width30"},[_vm._v(" #"+_vm._s(1==space.spaceType?"SI"+space.id:2==space.spaceType?"BU"+space.id:3==space.spaceType?"FL"+space.id:4==space.spaceType?"SP"+space.id:space.id)+" ")]),_c("td",{staticClass:"contentrow width30"},[_vm._v(_vm._s(space.name))]),_c("td",{staticClass:"contentrow width30"},[_vm._v(_vm._s(space.spaceTypeVal))]),_c("td"),_c("td",[_c("i",{staticClass:"el-icon-check",staticStyle:{color:"#39b2c2","padding-left":"20px"},style:{visibility:_vm.selectedObj===space?"visible":"hidden"}})])])})),_vm._l(_vm.assetList,(function(asset){return _vm.isAsset?_c("tr",{key:"asset_"+asset.id,staticClass:"tablerow",class:{selectedrow:_vm.selectedObj===asset},attrs:{"data-test-selector":""+asset.name},on:{click:function($event){return _vm.select(asset,2)}}},[_c("td",{staticClass:"contentrow width30"},[_vm._v("#"+_vm._s(asset.id))]),_c("td",{staticClass:"contentrow width30"},[_vm._v(_vm._s(asset.name))]),_vm.hideSidebar?_vm._e():_c("td",{staticClass:"contentrow width30"},[_vm._v(" "+_vm._s(asset.category?_vm.getAssetCategory(asset.category.id).displayName:"---")+" ")]),_c("td"),_c("td",[_c("i",{staticClass:"el-icon-check",staticStyle:{color:"#39b2c2","padding-left":"20px"},style:{visibility:_vm.selectedObj===asset?"visible":"hidden"}})])]):_vm._e()})),_vm.spaceList.length<1&&_vm.assetList.length<1?_c("tr",{staticStyle:{background:"none",border:"none","margin-top":"20px"}},[_c("td",{staticClass:"text-center label-txt-black",staticStyle:{"border-bottom":"none","font-size":"14px","padding-top":"40px",cursor:"auto"},attrs:{colspan:"100%"}},[_vm._v(" No "+_vm._s(_vm.isAsset?"Asset":"Space")+" to display! ")])]):_vm._e()],2)])])],1),_c("div",{staticClass:"space-asset-footer"},[_c("div",{staticClass:"space-asset-footer-align"},[_c("el-button",{staticStyle:{"font-size":"13px","font-weight":"bold",border:"2px solid #cde2e5",color:"#8eb1b6","letter-spacing":"0.5px",padding:"8px",width:"100px","text-transform":"uppercase"},attrs:{"data-test-selector":"SpaceAsset_cancel"},on:{click:_vm.handleclose}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_c("el-button",{staticStyle:{"font-size":"13px","font-weight":"bold","letter-spacing":"0.5px","background-color":"#39b2c2","border-color":"#39b2c2",padding:"8px","text-transform":"uppercase"},attrs:{"data-test-selector":"SpaceAsset_save",type:"primary"},on:{click:_vm.associate}},[_vm._v(_vm._s(_vm.$t("common._common.select")))])],1)])])]),_c("div",{staticStyle:{position:"absolute",top:"40%",left:"55%","z-index":"5"}},[_c("spinner",{attrs:{show:_vm.resourceLoading,size:"70"}})],1)])])},staticRenderFns=[],objectSpread2=__webpack_require__(595082),vue_infinite_scroll=__webpack_require__(49026),vue_infinite_scroll_default=__webpack_require__.n(vue_infinite_scroll),ResourceMixin=__webpack_require__(22637),v_infinite_scroll=__webpack_require__(561364),v_infinite_scroll_default=__webpack_require__.n(v_infinite_scroll),Spinner=__webpack_require__(604947),vuex_esm=__webpack_require__(420629),SpaceAssetChooservue_type_script_lang_js={mixins:[ResourceMixin/* default */.Z],props:["visibility","appendToBody","query","picktype","hideSidebar","isService"],directives:{infiniteScroll:vue_infinite_scroll_default()},components:{Spinner:Spinner/* default */.Z,VInfiniteScroll:v_infinite_scroll_default()},data:function(){return{fetchingMore:!1,selected:!1,selectedObj:{},showQuickSearch:!1}},created:function(){this.$store.dispatch("loadAssetCategory"),this.$store.dispatch("loadSpaceCategory")},mounted:function(){
// quickSearchQuery
"asset"===this.picktype&&(this.isAsset=!0),this.initResourceData()},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapGetters */.Se)(["getAssetCategory"])),{},{scrollDisabled:function(){return!1}}),component:{Spinner:Spinner/* default */.Z},watch:{visibility:function(val){var _this=this;val&&!this.query?(this.reInit(),this.hideSidebar&&(this.showQuickSearch=!0,this.$nextTick((function(){_this.$refs.quickSearchQuery&&_this.$refs.quickSearchQuery.focus()})))):val||!this.query||this.selectedObj&&this.selectedObj.id||this.$emit("associate",{},this.isAsset?"asset":"space")},query:function(val){var _this2=this;this.quickSearchQuery=val,val&&this.$refs.quickSearchQuery&&(this.selectedObj={},this.showQuickSearch=!0,this.$nextTick((function(){_this2.$refs.quickSearchQuery.focus()})),this.loadResourceData())}},methods:{loadMores:function(){this.fetchingMore=!0,this.openAsset(!0)},reInit:function(){this.showQuickSearch=!1,this.quickSearchQuery=null,this.paging.page=1,this.checkAndInitResourceData()},handleclose:function(){this.$emit("update:visibility",!1)},openSpace:function(){this.isAsset=!1,this.paging.page=1,this.loadSpace()},openAsset:function(isLoad){this.isAsset=!0,this.paging.page=1,this.loadAsset(isLoad)},select:function(obj,type){this.selectedObj=obj},associate:function(){this.$emit("associate",this.selectedObj,this.isAsset?"asset":"space")},toggleQuickSearch:function(){var _this3=this;this.showQuickSearch=!this.showQuickSearch,this.showQuickSearch?this.$nextTick((function(){_this3.$refs.quickSearchQuery.focus()})):(this.quickSearchQuery=null,this.loadResourceData())}}},components_SpaceAssetChooservue_type_script_lang_js=SpaceAssetChooservue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_SpaceAssetChooservue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,SpaceAssetChooser=component.exports},
/***/751201:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return Asset}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/avatar/Asset.vue?vue&type=template&id=30a11ac8
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.asset?_c("div",{staticClass:"inline"},[_c("div",{staticClass:"fc-avatar-element q-item-division relative-position cursor-pointer"},[!_vm.showSlide||"undefined"!==typeof _vm.disableSlide&&!1!==_vm.disableSlide?_c("div",{staticClass:"q-item-side q-item-side-left q-item-section relative"},[_vm.avatarUrl?_c("img",{staticClass:"fc-avatar",class:_vm.sizeClass,attrs:{src:_vm.avatarUrl}}):_vm._e()]):_c("div",{staticClass:"q-item-side q-item-side-left q-item-section relative",class:_vm.sizeClass},[_c("el-carousel",{staticClass:"fc-avatar-carousel",attrs:{trigger:"click",autoplay:!1,"indicator-position":"none"}},[_vm._l(_vm.photos,(function(photo,index){return[photo.url?_c("el-carousel-item",{key:index},[_c("img",{staticClass:"fc-avatar-square",class:_vm.sizeClass,attrs:{target:"_blank",src:photo.url},on:{click:function($event){return _vm.openPhotoUrl(photo.originalUrl)}}})]):_vm._e()]}))],2)],1),_vm.showName?_c("div",[_c("div",[_c("span",{staticClass:"q-item-label"},[_vm._v(_vm._s(_vm.asset.name))])])]):_vm._e(),!_vm.showUpload||"undefined"!==typeof _vm.disableUpload&&!1!==_vm.disableUpload?_vm._e():_c("div",[_c("span",{staticClass:"upload-space-photos pointer",on:{click:_vm.showUploadPhotoDialog}},[_c("i",{staticClass:"fa fa-camera",attrs:{"aria-hidden":"true"}})]),_c("f-upload-photos",{ref:"uploadDialog",attrs:{module:"assetphotos",list:_vm.photos,record:_vm.asset},on:{updatePhotos:function($event){return _vm.handleUpdate()}}})],1)])]):_vm._e()},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),createForOfIteratorHelper=__webpack_require__(566347),objectSpread2=__webpack_require__(595082),FUploadPhotos=(__webpack_require__(434284),__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(350367)),vuex_esm=__webpack_require__(420629),validation=__webpack_require__(990260),api=__webpack_require__(32284),Assetvue_type_script_lang_js={props:["size","asset","name","hovercard","disableUpload","disableSlide"],data:function(){return{avatarUrl:null,sizeClass:"fc-avatar-"+this.size,hoverCardId:"spaceHoverCardId-"+this.asset.id,showName:"undefined"===typeof this.name||"true"===this.name,showHoverCard:"undefined"===typeof this.hovercard||"true"===this.hovercard,loadHoverCardData:!1,photosLoading:!0,photos:[],sliderEnabledSize:["shuge","huge","xhuge","widget"]}},components:{FUploadPhotos:FUploadPhotos/* default */.Z},mounted:function(){this.loadAvatarUrl()},created:function(){this.$store.dispatch("loadAssetType")},computed:(0,objectSpread2/* default */.Z)({showSlide:function(){if(this.photos&&this.photos.length){if(this.sliderEnabledSize.indexOf(this.size)>=0){var _step,allUrlNull=!0,_iterator=(0,createForOfIteratorHelper/* default */.Z)(this.photos);try{for(_iterator.s();!(_step=_iterator.n()).done;){var photo=_step.value;if(photo.url){allUrlNull=!1;break}}}catch(err){_iterator.e(err)}finally{_iterator.f()}return!allUrlNull}return!1}return!1},showUpload:function(){return this.sliderEnabledSize.indexOf(this.size)>=0}},(0,vuex_esm/* mapGetters */.Se)(["getAssetType"])),watch:{asset:function(){this.loadAvatarUrl()}},methods:{loadAvatarUrl:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var asset,size,sliderEnabledSize,disableSlide,_ref,avatarUrl,assetId,_yield$API$get,error,data,_ref2,_ref2$photos,photos,defaultAvatarUrl;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(asset=_this.asset,size=_this.size,sliderEnabledSize=_this.sliderEnabledSize,disableSlide=_this.disableSlide,_ref=asset||{},avatarUrl=_ref.avatarUrl,assetId=_ref.id,!(sliderEnabledSize.indexOf(size)>=0&&(!disableSlide||disableSlide&&"true"===disableSlide))){_context.next=12;break}if(!assetId){_context.next=12;break}return _this.photosLoading=!0,_context.next=7,api/* API */.bl.get("/photos/get?module=assetphotos&parentId=".concat(assetId));case 7:_yield$API$get=_context.sent,error=_yield$API$get.error,data=_yield$API$get.data,error||(_ref2=data||{},_ref2$photos=_ref2.photos,photos=void 0===_ref2$photos?[]:_ref2$photos,(0,validation/* isEmpty */.xb)(photos)||photos.forEach((function(photo){var _ref3=photo||{},url=_ref3.url;(0,validation/* isEmpty */.xb)(url)||(avatarUrl=url)})),_this.$set(_this,"photos",photos)),_this.photosLoading=!1;case 12:(0,validation/* isEmpty */.xb)(avatarUrl)?(defaultAvatarUrl=_this.getDefaultAvatar()||"",_this.$set(_this,"avatarUrl",defaultAvatarUrl)):_this.$set(_this,"avatarUrl",avatarUrl);case 13:case"end":return _context.stop()}}),_callee)})))()},handleUpdate:function(){this.loadAvatarUrl()},openPhotoUrl:function(url){window.open(url,"_blank")},getDefaultAvatar:function(){if(this.asset&&this.asset.type&&this.asset.type.id){var name=this.getAssetType(this.asset.type.id)?this.getAssetType(this.asset.type.id).name:"";return __webpack_require__("Plumbing Equipment"===name||"Equipment"===name?164065:"Furniture"===name?703659:"Vehicle"===name?916803:164065)}return __webpack_require__(164065)},loadHoverCard:function(){this.loadHoverCardData=!0},hideHoverCard:function(){this.loadHoverCardData=!1},showUploadPhotoDialog:function(){this.$refs.uploadDialog.open()}}},avatar_Assetvue_type_script_lang_js=Assetvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(avatar_Assetvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,Asset=component.exports},
/***/638507:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return Activities2}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/relatedlist/Activities2.vue?vue&type=template&id=0cb76648
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticStyle:{"padding-top":"20px"}},[_vm.loading?_c("div",[_c("spinner",{attrs:{show:_vm.loading}})],1):_vm.activities&&_vm.activities.length?_vm._l(_vm.activities,(function(activity,index){return _c("div",{key:index,staticClass:"tactivity"},[_c("div",{staticClass:"tlContent2"},[_vm._m(0,!0),_c("div",{},[_c("div",{staticStyle:{display:"inline-flex"}},[_c("div",{staticClass:"tlContentMain pR10 pull-left"},[_c("avatar",{attrs:{size:"sm",user:{name:activity.name}}})],1),_c("div",{staticClass:"pull-left ",staticStyle:{"line-height":"1.4"}},[_c("span",[_vm._v(_vm._s(activity.name))]),16==activity.activityType?_c("span",[_vm._v(" "+_vm._s(activity.message)+" "),_c("avatar",{attrs:{size:"sm",user:{name:_vm.getAssignedBy(activity.info.updatedFields)}}}),_c("span",{staticClass:"updval"},[_vm._v(_vm._s(_vm.getAssignedBy(activity.info.updatedFields)))])],1):_c("span",{staticClass:"tlContentMain"},[_vm._v(" "+_vm._s(_vm.getMessage(activity).message?_vm.getMessage(activity).message:"")+" "),_vm.getMessage(activity).value?_c("span",{staticClass:"updval"},[_vm._v(_vm._s(_vm.getMessage(activity).value))]):_vm._e()]),_c("div",{staticClass:"tlDate2 col-12"},[_c("span",[_vm._v(_vm._s(_vm._f("fromNow")(activity.modifiedTime)))])])])])]),_c("div",{staticClass:"clearboth"})]),_c("div",{staticClass:"clearboth"})])})):_c("div",[_vm._v(" "+_vm._s(_vm.$t("common.products.no_activities_tracked_yet"))+" ")])],2)},staticRenderFns=[function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"flLeft activityIconDiv2"},[_c("i",{staticClass:"fa fa-circle-o ",attrs:{"aria-hidden":"true"}})])}],Activities2vue_type_script_lang_js=__webpack_require__(942577),relatedlist_Activities2vue_type_script_lang_js=Activities2vue_type_script_lang_js/* default */.Z,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(relatedlist_Activities2vue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,Activities2=component.exports},
/***/526971:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return SummaryAttachment}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/relatedlist/SummaryAttachment.vue?vue&type=template&id=3eb46d89
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"fc-attachments p0"},[_vm.exportDownloadUrl?_c("iframe",{staticStyle:{display:"none"},attrs:{src:_vm.exportDownloadUrl}}):_vm._e(),_vm.loading?_c("div",{staticClass:"text-center"},[_c("spinner",{attrs:{show:_vm.loading}})],1):_c("div",[_c("div",{staticClass:"row fc-summary-attchment",staticStyle:{"padding-top":"20px","margin-left":"15px","margin-right":"15px","margin-bottom":"20px","padding-left":"0px"}},_vm._l(_vm.attachments,(function(attachment){return _c("el-row",{key:attachment.attachmentId,staticStyle:{"border-bottom":"1px solid #ededed",width:"100%","padding-top":"10px","padding-bottom":"10px"}},[_c("el-col",{attrs:{span:22}},[_c("el-col",{staticClass:"mT5",attrs:{span:2}},[_c("img",{staticClass:"svg-icon",staticStyle:{width:"20px"},attrs:{src:__webpack_require__(250620)}})]),_c("el-col",{attrs:{span:18}},[_c("div",[attachment.previewUrl?_c("a",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"top",animation:"shift-away",arrow:!0},expression:"{\n                  placement: 'top',\n                  animation: 'shift-away',\n                  arrow: true,\n                }"}],staticClass:"self-center show text-left fc-black-13 textoverflow-ellipsis max-width300px",staticStyle:{border:"none"},attrs:{title:attachment.fileName},on:{click:function($event){return _vm.selectedFile(attachment)}}},[_vm._v(_vm._s(attachment.fileName))]):_c("a",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"top",animation:"shift-away",arrow:!0},expression:"{\n                  placement: 'top',\n                  animation: 'shift-away',\n                  arrow: true,\n                }"}],staticClass:"self-center show text-left fc-black-13 textoverflow-ellipsis max-width300px",staticStyle:{border:"none"},attrs:{title:attachment.fileName}},[_vm._v(_vm._s(attachment.fileName))]),_vm.getUser(attachment)>0?_c("div",{staticClass:"col-4 comment-file mT2",staticStyle:{border:"none"}},[_vm._v(" "+_vm._s(_vm.getUser(attachment))+" "),attachment.createdTime?_c("span",[_vm._v("| "+_vm._s(_vm._f("formatDate")(attachment.createdTime,"DD-MM_YYYY")))]):_vm._e()]):_c("div",{staticClass:"col-4 comment-file mT2",staticStyle:{border:"none"}},[_vm._v(" "+_vm._s(_vm._f("formatDate")(attachment.createdTime,"DD-MM_YYYY"))+" ")])])])],1),_c("el-col",{staticClass:"mT5 pointer",attrs:{span:2}},[_c("img",{attrs:{src:__webpack_require__(365565),width:"16",height:"16"},on:{click:function($event){return _vm.downloadAttachment(attachment.downloadUrl)}}})])],1)})),1),_vm.diasbleAttachment?_vm._e():_c("form",{staticStyle:{"margin-left":"15px","margin-right":"15px"},attrs:{enctype:"multipart/form-data",novalidate:""}},[_c("div",{staticClass:"dropbox"},[_c("input",{staticClass:"input-file",attrs:{type:"file",multiple:""},on:{change:function($event){return _vm.filesChange($event.target.files)}}}),_c("img",{staticClass:"upload-img mT10 opacity-05",attrs:{src:__webpack_require__(581121),height:"20",width:"20"}}),_c("p",[_vm._v(" "+_vm._s(_vm.$t("common.attachment_form.drag_and_drop_files"))),_c("br"),_vm._v(" "+_vm._s(_vm.$t("common.attachment_form.click_to_browse"))+" ")])])])]),_vm.visibility&&_vm.selectedAttachedFile?_c("preview-file",{attrs:{visibility:_vm.visibility,previewFile:_vm.selectedAttachedFile,files:_vm.attachments},on:{"update:visibility":function($event){_vm.visibility=$event}}}):_vm._e()],1)},staticRenderFns=[],objectSpread2=__webpack_require__(595082),PreviewFile=(__webpack_require__(677049),__webpack_require__(821694),__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(434284),__webpack_require__(891719),__webpack_require__(339772),__webpack_require__(720096)),validation=__webpack_require__(990260),SummaryAttachmentvue_type_script_lang_js={props:["module","record","diasbleAttachment"],data:function(){return{loading:!0,status:{UPLOADING:1,SUCCESS:2,FAILED:3},attachments:[],formFieldName:"attachment",exportDownloadUrl:null,selectedAttachedFile:null,visibility:!1}},components:{PreviewFile:PreviewFile/* default */.Z},mounted:function(){this.loadAttachments()},watch:{record:function(recordObj){this.loadAttachments()}},methods:{selectedFile:function(inList){this.selectedAttachedFile=inList,this.visibility=!0},loadAttachments:function(){var self=this;return self.loading=!0,this.$http.get("/attachment?module="+this.module+"&recordId="+this.record.id).then((function(response){self.loading=!1,self.attachments=response.data.attachments?response.data.attachments:[]})).catch((function(error){error&&(self.loading=!1,self.attachments=null)}))},filesChange:function(files){var _this=this,fileList=Array.from(files);if(fileList.length){
// append the files to FormData
var formData=new FormData;formData.append("module",this.module),formData.append("recordId",this.record.id);var _this$status=this.status,UPLOADING=_this$status.UPLOADING,SUCCESS=_this$status.SUCCESS,FAILED=_this$status.FAILED;fileList.forEach((function(file){var _ref=file||{},name=_ref.name,size=_ref.size,type=_ref.type,fileEntry={fileId:-1,fileName:name,fileSize:size,contentType:type,status:UPLOADING,error:null,previewUrl:null,uploadedBy:_this.$account.user.id};formData.append(_this.formFieldName,file,name),_this.attachments.unshift(fileEntry)})),this.$http.post("/attachment/add",formData).then((function(_ref2){var data=_ref2.data;data.attachments.forEach((function(attachment){var fileId=attachment.fileId,fileName=attachment.fileName,fileSize=attachment.fileSize,attachmentIdx=_this.attachments.findIndex((function(a){return a.fileName===fileName&&a.fileSize===fileSize}));if(!(0,validation/* isEmpty */.xb)(attachmentIdx)){var attachmentFile=_this.attachments[attachmentIdx];attachmentFile=fileId?(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},attachmentFile),attachment),{},{status:SUCCESS}):(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},attachmentFile),{},{status:FAILED,error:"Upload failed."}),_this.$set(_this.attachments,attachmentIdx,attachmentFile)}}))})).catch((function(){fileList.forEach((function(file){var _ref3=file||{},name=_ref3.name,size=_ref3.size,attachmentIdx=_this.attachments.findIndex((function(a){return a.fileName===name&&a.fileSize===size}));if(!(0,validation/* isEmpty */.xb)(attachmentIdx)){var attachmentFile=_this.attachments[attachmentIdx];attachmentFile=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},attachmentFile),{},{status:FAILED,error:"Upload failed."}),_this.$set(_this.attachments,attachmentIdx,attachmentFile)}}))}))}},getUser:function(assign){if(null!==assign&&assign.id){var assignto=this.$store.getters.getUser(assign.id);return assignto?assignto.name:"---"}return"---"},downloadAttachment:function(url){this.exportDownloadUrl=url},icon:function(file){return file&&"image/png"===file?"statics/icons/png.svg":"statics/icons/pdf.svg"}}},relatedlist_SummaryAttachmentvue_type_script_lang_js=SummaryAttachmentvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(relatedlist_SummaryAttachmentvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,SummaryAttachment=component.exports},
/***/987612:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return TransitionButtons}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/stateflow/TransitionButtons.vue?vue&type=template&id=cca90304&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"display-flex",class:_vm.rootClass},[_vm.hasTransitionBtns?_c("div",{staticClass:"d-flex"},[_c("div",{staticClass:"stateflow-btn-wrapper mL10"},[_c("async-button",{directives:[{name:"tippy",rawName:"v-tippy"}],attrs:{buttonType:"primary",buttonClass:_vm.asyncBtnClassName,disable:_vm.transitions.featured[0].scheduled,clickAction:_vm.startTransition,actionParams:[_vm.transitions.featured[0]],disabled:_vm.isDisabled,"data-test-selector":_vm.transitions.featured[0].name,title:""+_vm.transitions.featured[0].name,loading:_vm.firstBtnLoading}},[_vm._v(" "+_vm._s(_vm.transitions.featured[0].name)+" ")])],1),_vm.hasDropDownBtns?_c("div",{staticClass:"mL10"},[_c("el-dropdown",{staticClass:"pointer stateflow-btn-wrapper",attrs:{"split-button":"","data-test-selector":_vm.transitions.featured[1].name,disabled:_vm.isDisabled},on:{click:function($event){return _vm.initiateDropdownTransition(_vm.transitions.featured[1])},command:_vm.initiateDropdownTransition}},[_c("div",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"transition-btn-name",attrs:{title:""+_vm.transitions.featured[1].name}},[_vm.dropdownLoading?_c("span",[_c("i",{staticClass:"el-icon-loading"}),_vm._v(" "+_vm._s(_vm.$t("common._common.loading"))+" ")]):_c("span",[_vm._v(_vm._s(_vm.transitions.featured[1].name))])]),_c("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},_vm._l(_vm.transitions.dropdown,(function(transition,index){return _c("el-dropdown-item",{key:index,attrs:{command:transition,disabled:_vm.isDisabled,"data-test-selector":transition.name}},[_vm._v(" "+_vm._s(transition.name)+" ")])})),1)],1)],1):_vm.hasOnly2Btns?_c("div",{staticClass:"stateflow-btn-wrapper mL10"},[_c("async-button",{directives:[{name:"tippy",rawName:"v-tippy"}],attrs:{buttonClass:_vm.asyncBtnClassName,disable:_vm.transitions.featured[1].scheduled,clickAction:_vm.startTransition,actionParams:[_vm.transitions.featured[1]],disabled:_vm.isDisabled,"data-test-selector":_vm.transitions.featured[1].name,title:""+_vm.transitions.featured[1].name,loading:_vm.lastBtnLoading}},[_vm._v(" "+_vm._s(_vm.transitions.featured[1].name)+" ")])],1):_vm._e()]):_vm._e(),_vm.canShowForm?_c("TransitionForm",_vm._b({},"TransitionForm",_vm.transitionFormProps,!1)):_vm._e(),_vm.showConfirmationDialog?_c("ConfirmationDialog",{attrs:{transition:_vm.selectedTransition,confirmations:_vm.confirmationDialogs,onConfirm:_vm.continueTransition,onCancel:_vm.cancelTransition}}):_vm._e()],1)},staticRenderFns=[],defineProperty=__webpack_require__(482482),objectSpread2=__webpack_require__(595082),slicedToArray=__webpack_require__(554621),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),toConsumableArray=__webpack_require__(488478),api=(__webpack_require__(865137),__webpack_require__(976801),__webpack_require__(689730),__webpack_require__(634338),__webpack_require__(538077),__webpack_require__(260228),__webpack_require__(336585),__webpack_require__(425728),__webpack_require__(434284),__webpack_require__(947522),__webpack_require__(169358),__webpack_require__(32284)),AsyncButton=__webpack_require__(303514),TransitionForm=__webpack_require__(323796),TransitionConfirmationsvue_type_template_id_08a79305_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticStyle:{"z-index":"999999"},attrs:{visible:_vm.dialogVisible,title:_vm.activeDialog.title,width:"540px","custom-class":"confirmation-dialog","append-to-body":"","close-on-click-modal":!1,"before-close":_vm.activeDialog.cancel},on:{"update:visible":function($event){_vm.dialogVisible=$event}}},[_c("div",{staticClass:"message-block"},[_vm._v(" "+_vm._s(_vm.activeDialog.message)+" ")]),_c("div",{staticClass:"dialog-footer"},[_c("el-button",{staticClass:"btn btn--secondary cancel-btn",attrs:{type:"button"},on:{click:_vm.activeDialog.cancel}},[_vm._v(" Cancel ")]),_c("el-button",{staticClass:"btn btn--primary btn--danger delete-btn",attrs:{type:"button",disabled:_vm.loadingOnConfirm,loading:_vm.loadingOnConfirm},on:{click:_vm.activeDialog.proceed}},[_vm._v(" Confirm ")])],1)])},TransitionConfirmationsvue_type_template_id_08a79305_staticRenderFns=[],TransitionConfirmationsvue_type_script_lang_js={props:["confirmations","onConfirm","onCancel"],data:function(){return{dialogVisible:!1,activeDialog:null,currentIndex:0,loadingOnConfirm:!1}},watch:{confirmations:{handler:"startConfirmation",immediate:!0}},methods:{startConfirmation:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var confirmations,currentIndex,delay,dialog,dialogObj;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:confirmations=_this.confirmations,currentIndex=_this.currentIndex,delay=_this.$helpers.delay,dialog=confirmations[currentIndex],dialogObj={title:dialog.name,message:dialog.message,proceed:function(){var _proceed=(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(currentIndex!==confirmations.length-1){_context.next=9;break}return _this.loadingOnConfirm=!0,_context.next=4,_this.onConfirm();case 4:_this.loadingOnConfirm=!1,_this.dialogVisible=!1,_this.currentIndex=0,_context.next=12;break;case 9:_this.currentIndex+=1,_this.dialogVisible=!1,delay(200).then((function(){return _this.startConfirmation()}));case 12:case"end":return _context.stop()}}),_callee)})));function proceed(){return _proceed.apply(this,arguments)}return proceed}(),cancel:function(){var _cancel=(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_this.dialogVisible=!1,_this.currentIndex=0,_this.onCancel();case 3:case"end":return _context2.stop()}}),_callee2)})));function cancel(){return _cancel.apply(this,arguments)}return cancel}()},_this.activeDialog=dialogObj,_this.$nextTick((function(){return _this.dialogVisible=!0}));case 5:case"end":return _context3.stop()}}),_callee3)})))()}}},stateflow_TransitionConfirmationsvue_type_script_lang_js=TransitionConfirmationsvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(stateflow_TransitionConfirmationsvue_type_script_lang_js,TransitionConfirmationsvue_type_template_id_08a79305_render,TransitionConfirmationsvue_type_template_id_08a79305_staticRenderFns,!1,null,null,null)
/* harmony default export */,TransitionConfirmations=component.exports,validation=__webpack_require__(990260),cloneDeep=__webpack_require__(150361),cloneDeep_default=__webpack_require__.n(cloneDeep),TransitionButtonsUtils=__webpack_require__(982072),TransitionButtonsvue_type_script_lang_js={props:["moduleName","record","updateFn","updateUrl","transformFn","transitionFilter","buttonClass","disabled","hideNotifications"],components:{AsyncButton:AsyncButton/* default */.Z,TransitionForm:TransitionForm/* default */.Z,ConfirmationDialog:TransitionConfirmations},created:function(){this.fetchAvailableStates()},data:function(){return{stateTransitions:null,loading:!1,canShowForm:!1,selectedTransition:null,dataForCurrentTransition:null,confirmationDialogs:null,showConfirmationDialog:!1,dropdownLoading:!1,selectedTransitionActions:null,firstBtnLoading:!1,lastBtnLoading:!1}},computed:{isV3:function(){var moduleName=this.moduleName,updateUrl=this.updateUrl;return!(0,validation/* isEmpty */.xb)(moduleName)&&(0,validation/* isEmpty */.xb)(updateUrl)},transitions:function(){if((0,validation/* isEmpty */.xb)(this.stateTransitions))return null;var transitions=(0,toConsumableArray/* default */.Z)(this.stateTransitions).sort((function(first,second){
// sorts array in ascending order but placing all '-1' values at the end
return[-1,0,3].includes(first.buttonType)?1:[-1,0,3].includes(second.buttonType)?-1:first.buttonType-second.buttonType}));return{featured:transitions.slice(0,2)||[],dropdown:transitions.slice(2)||[]}},shouldCreateModuleRecord:function(){var _this$selectedTransit=this.selectedTransition,selectedTransition=void 0===_this$selectedTransit?{}:_this$selectedTransit,_ref=selectedTransition||{},_ref$dialogType=_ref.dialogType,dialogType=void 0===_ref$dialogType?null:_ref$dialogType,formModuleName=_ref.formModuleName;return!(0,validation/* isEmpty */.xb)(dialogType)&&!(0,validation/* isEmpty */.xb)(formModuleName)&&2===dialogType},shouldCreateNotes:function(){var _ref2=this.selectedTransition||{},form=_ref2.form;return 5===this.$getProperty(form,"module.type",null)},rootClass:function(){return""},isDisabled:function(){var loading=this.loading,disabled=this.disabled,dropdownLoading=this.dropdownLoading,firstBtnLoading=this.firstBtnLoading,lastBtnLoading=this.lastBtnLoading;return loading||disabled||dropdownLoading||firstBtnLoading||lastBtnLoading},hasTransitionBtns:function(){var _ref3=this.transitions||{},featured=_ref3.featured;return!(0,validation/* isEmpty */.xb)(featured)},hasDropDownBtns:function(){var _ref4=this.transitions||{},featured=_ref4.featured,dropdown=_ref4.dropdown;return this.hasTransitionBtns&&!(0,validation/* isEmpty */.xb)(dropdown)&&featured.length>1&&dropdown.length>0},hasOnly2Btns:function(){var _ref5=this.transitions||{},featured=_ref5.featured;return this.hasTransitionBtns&&featured.length>1},asyncBtnClassName:function(){var buttonClass=this.buttonClass,isDisabled=this.isDisabled;return"".concat(buttonClass," ").concat(isDisabled&&"disabled"," transition-btn-name")},transitionFormProps:function(){var selectedTransition=this.selectedTransition,record=this.record,shouldCreateModuleRecord=this.shouldCreateModuleRecord,saveDataForTransition=this.saveDataForTransition,cancelTransition=this.cancelTransition,isV3=this.isV3,_ref6=selectedTransition||{},moduleName=_ref6.moduleName,formId=_ref6.formId,_ref7=record||{},recordId=_ref7.id;return{moduleName:moduleName,recordId:recordId,formId:formId,record:record,isV3:isV3,transition:selectedTransition,isExternalModule:shouldCreateModuleRecord,saveAction:saveDataForTransition,closeAction:cancelTransition}}},watch:{moduleName:function(newVal,oldVal){newVal!==oldVal&&this.fetchAvailableStates()},record:function(newVal,oldVal){newVal!==oldVal&&this.fetchAvailableStates({force:!0})}},methods:{refresh:function(){this.fetchAvailableStates()},fetchAvailableStates:function(){var _arguments=arguments,_this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var _ref8,_ref8$force,force,_yield$API$get,data,error,_ref9,_ref9$currentState,currentState,_ref9$states,states;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _ref8=_arguments.length>0&&void 0!==_arguments[0]?_arguments[0]:{},_ref8$force=_ref8.force,force=void 0!==_ref8$force&&_ref8$force,_this.loading=!0,_context.next=4,api/* API */.bl.get("/v2/statetransition/getAvailableState",{moduleName:_this.moduleName,id:_this.record.id},{force:force});case 4:_yield$API$get=_context.sent,data=_yield$API$get.data,error=_yield$API$get.error,error?_this.stateTransitions=null:(_ref9=data||{},_ref9$currentState=_ref9.currentState,currentState=void 0===_ref9$currentState?null:_ref9$currentState,_ref9$states=_ref9.states,states=void 0===_ref9$states?[]:_ref9$states,currentState&&_this.$emit("currentState",currentState.id),(0,validation/* isEmpty */.xb)(_this.transitionFilter)||(0,validation/* isEmpty */.xb)(_this.states)||(states=states.filter(_this.transitionFilter)),_this.stateTransitions=states||[]),_this.loading=!1;case 9:case"end":return _context.stop()}}),_callee)})))()},startTransition:function(transition){var _ref10=this.transitions||{},featured=_ref10.featured;if(!this.dropdownLoading&&!(0,validation/* isEmpty */.xb)(featured)){var _ref11=featured[0]||{},firstTransitionId=_ref11.id,_ref12=featured[1]||{},lastTransitionId=_ref12.id,_ref13=transition||{},currentTransitionId=_ref13.id;this.firstBtnLoading=currentTransitionId===firstTransitionId,this.lastBtnLoading=currentTransitionId===lastTransitionId}var NOT_CONFIGURED=TransitionButtonsUtils/* actionStatusFlag */.Zj.NOT_CONFIGURED,YET_TO_START=TransitionButtonsUtils/* actionStatusFlag */.Zj.YET_TO_START;return this.selectedTransitionActions=Object.entries(TransitionButtonsUtils/* transitionBtnActions */._M||{}).reduce((function(actionList,_ref14){var _ref15=(0,slicedToArray/* default */.Z)(_ref14,2),action=_ref15[0],transKey=_ref15[1];return actionList[action]=(0,validation/* isEmpty */.xb)(transition[transKey])?NOT_CONFIGURED:YET_TO_START,actionList}),{}),this.selectedTransition=cloneDeep_default()(transition),this.startTransitionProcess()},startTransitionProcess:function(){var selectedTransitionActions=this.selectedTransitionActions,selectedTransition=this.selectedTransition,YET_TO_START=TransitionButtonsUtils/* actionStatusFlag */.Zj.YET_TO_START,IN_PROCESS=TransitionButtonsUtils/* actionStatusFlag */.Zj.IN_PROCESS,FAILED=TransitionButtonsUtils/* actionStatusFlag */.Zj.FAILED,isAnyActionFailed=TransitionButtonsUtils/* transitionBtnActionsOrder */.jt.some((function(action){return selectedTransitionActions[action]===FAILED})),currentRunningProcess=TransitionButtonsUtils/* transitionBtnActionsOrder */.jt.some((function(action){return selectedTransitionActions[action]===IN_PROCESS}));if(!isAnyActionFailed&&!currentRunningProcess){var nextProcessToStart=TransitionButtonsUtils/* transitionBtnActionsOrder */.jt.find((function(action){return selectedTransitionActions[action]===YET_TO_START}))||null;return(0,validation/* isEmpty */.xb)(nextProcessToStart)?this.continueTransition():(this.$set(this.selectedTransitionActions,nextProcessToStart,IN_PROCESS),"FORM"===nextProcessToStart?(this.showStateFlowForm(),Promise.resolve()):"CONFIRMATION"===nextProcessToStart?this.checkConfirmations(selectedTransition):void 0)}},saveDataForTransition:function(formData){return this.dataForCurrentTransition=cloneDeep_default()(formData),this.$set(this.selectedTransitionActions,"FORM",TransitionButtonsUtils/* actionStatusFlag */.Zj.SUCCESS),this.closeStateFlowForm(),this.startTransitionProcess()},checkConfirmations:function(transition){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var moduleName,record,params,dataForCurrentTransition,formData,_yield$API$post,error,data,validConfirmationDialogs;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return moduleName=_this2.moduleName,record=_this2.record,params={id:record.id,moduleName:moduleName,transitionId:transition.id},dataForCurrentTransition=_this2.dataForCurrentTransition,(0,validation/* isEmpty */.xb)(transition.formId)||(0,validation/* isEmpty */.xb)(dataForCurrentTransition)||(formData=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},dataForCurrentTransition),dataForCurrentTransition.data||{}),delete formData.data,params["data"]=formData),_context2.next=6,api/* API */.bl.post("v2/statetransition/confirmationDialogs",params);case 6:if(_yield$API$post=_context2.sent,error=_yield$API$post.error,data=_yield$API$post.data,!error){_context2.next=14;break}_this2.defaultResponseHandler({error:error}),_this2.cancelTransition(),_context2.next=22;break;case 14:if(validConfirmationDialogs=data.validConfirmationDialogs,(0,validation/* isEmpty */.xb)(validConfirmationDialogs)){_context2.next=20;break}_this2.confirmationDialogs=validConfirmationDialogs,_this2.showConfirmationDialog=!0,_context2.next=22;break;case 20:return _this2.$set(_this2.selectedTransitionActions,"CONFIRMATION",TransitionButtonsUtils/* actionStatusFlag */.Zj.SUCCESS),_context2.abrupt("return",_this2.startTransitionProcess());case 22:case"end":return _context2.stop()}}),_callee2)})))()},proceedAfterConfirmation:function(){this.$set(this.selectedTransitionActions,"CONFIRMATION",TransitionButtonsUtils/* actionStatusFlag */.Zj.SUCCESS),this.startTransitionProcess()},initiateDropdownTransition:function(transition){this.dropdownLoading=!0,this.startTransition(transition)},continueTransition:function(){var selectedTransition=this.selectedTransition,_this$dataForCurrentT=this.dataForCurrentTransition,formData=void 0===_this$dataForCurrentT?null:_this$dataForCurrentT;return this.transitionToState(formData,selectedTransition)},cancelTransition:function(){this.selectedTransition=null,this.dataForCurrentTransition=null,this.confirmationDialogs=null,this.dropdownLoading=!1,this.firstBtnLoading=!1,this.lastBtnLoading=!1,this.selectedTransitionActions=null,this.closeStateFlowForm(),this.closeConfirmationDialogs()},getParams:function(_ref16){var formData=_ref16.formData,transition=_ref16.transition,moduleName=this.moduleName,record=this.record,_ref17=record||{},id=_ref17.id,_ref18=transition||{},stateTransitionId=_ref18.id,formId=_ref18.formId,formModuleName=_ref18.formModuleName,serializedFormData=formData;if(this.shouldCreateModuleRecord&&(serializedFormData={relations:(0,defineProperty/* default */.Z)({},formModuleName,[{data:[(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},formData),{},{formId:formId})]}])}),this.shouldCreateNotes||!this.isV3){var firstArg={moduleName:moduleName,id:id,stateTransitionId:stateTransitionId},secondArg=this.isV3||this.shouldCreateNotes?null:formData;return this.transformFn(firstArg,secondArg)}return{id:id,stateTransitionId:stateTransitionId,data:serializedFormData||{}}},transitionToState:function(formData,transition){var _this3=this;(0,validation/* isEmpty */.xb)(transition)&&(transition=this.selectedTransition);var url=this.getUrl(transition),params=this.getParams({formData:formData,transition:transition}),defaultResponseHandler=this.defaultResponseHandler,updateFn=this.updateFn,moduleName=this.moduleName,record=this.record;if(this.isV3){if(!(0,validation/* isEmpty */.xb)(updateFn)&&(0,validation/* isFunction */.mf)(updateFn))return updateFn(moduleName,params).then(defaultResponseHandler);var _ref19=record||{},recordId=_ref19.id,_url="v3/action/".concat(moduleName,"/").concat(recordId,"/transition");return api/* API */.bl.patch(_url,params).then(defaultResponseHandler)}return api/* API */.bl.post(url,params).then(function(){var _ref21=(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(_ref20){var error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:error=_ref20.error,error?defaultResponseHandler({error:error}):_this3.shouldCreateNotes||_this3.shouldCreateModuleRecord?_this3.v2SubModuleHandler(formData,transition).then((function(){return defaultResponseHandler({})})).catch((function(){
// Edge case where transition is success but record creation fails
_this3.fetchAvailableStates({force:!0}),_this3.$emit("transitionSuccess"),defaultResponseHandler({error:{}})})):defaultResponseHandler({});case 2:case"end":return _context3.stop()}}),_callee3)})));return function(_x){return _ref21.apply(this,arguments)}}())},v2SubModuleHandler:function(formData,transition){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){var shouldCreateNotes,shouldCreateModuleRecord,formModuleName;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:if(shouldCreateNotes=_this4.shouldCreateNotes,shouldCreateModuleRecord=_this4.shouldCreateModuleRecord,formModuleName=transition.formModuleName,!shouldCreateNotes){_context4.next=6;break}return _context4.abrupt("return",_this4.createNoteForModule(formModuleName,formData,transition));case 6:if(!shouldCreateModuleRecord){_context4.next=8;break}return _context4.abrupt("return",_this4.createRecordForModule(formModuleName,formData,transition));case 8:case"end":return _context4.stop()}}),_callee4)})))()},createNoteForModule:function(moduleName,formData){var _this5=this;return new Promise((function(resolve,reject){api/* API */.bl.post("v2/notes/add",{module:moduleName,ticketModuleName:_this5.moduleName,note:{parentId:_this5.record.id,notifyRequester:!1,body:formData.body}}).then((function(_ref22){var error=_ref22.error;error?reject():resolve()}))}))},createRecordForModule:function(moduleName,formData,transition){var data,_ref23=this.record||{},_ref23$siteId=_ref23.siteId,siteId=void 0===_ref23$siteId?null:_ref23$siteId,formId=transition.formId||null,form=transition.form,isCustomModule=this.$getProperty(form,"module.custom",!1);if(isCustomModule)data=(0,objectSpread2/* default */.Z)({moduleName:moduleName,withLocalId:!1},this.constructCustomModuleData({},formData,transition));else
// TODO MOVE to v3
if("workpermit"===moduleName){var datum=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},formData),{},{ticket:{id:this.record.id}});(0,validation/* isEmpty */.xb)(siteId)||(datum.siteId=siteId),(0,validation/* isEmpty */.xb)(formId)||(datum.formId=formId),data={workPermitRecords:[datum]}}else{var formObj=this.constructWoModuleData(formData,transition);data={workorder:(0,objectSpread2/* default */.Z)({},formObj)},moduleName="workorders"}var url=isCustomModule?"v2/module/data/add":"/v2/".concat(moduleName,"/add");return new Promise((function(resolve,reject){api/* API */.bl.post(url,data).then((function(_ref24){var error=_ref24.error;error?reject():resolve()}))}))},constructCustomModuleData:function(returnObj,data,transition){var _this6=this;
// Remove once v3 is done for custom modules
if(returnObj["moduleData"]={},data){data.comment&&(returnObj.comment=data.comment,delete data.comment),returnObj["moduleData"]=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},returnObj["moduleData"]),data);var _ref25=this.record||{},_ref25$siteId=_ref25.siteId,siteId=void 0===_ref25$siteId?null:_ref25$siteId,formId=transition.formId||null;!(0,validation/* isEmpty */.xb)(siteId)&&(0,validation/* isEmpty */.xb)(returnObj["moduleData"].siteId)&&(returnObj["moduleData"].siteId=siteId),(0,validation/* isEmpty */.xb)(formId)||(returnObj["moduleData"].formId=formId)}var formFields=this.$getProperty(transition,"form.fields")||[],currentModuleLookupField=formFields.find((function(field){return field.lookupModuleName===_this6.moduleName}));return currentModuleLookupField&&(returnObj["moduleData"].data=returnObj["moduleData"].data||{},returnObj["moduleData"].data[currentModuleLookupField.name]=this.record.id),returnObj},constructWoModuleData:function(data,transition){var _this7=this,formData=(0,objectSpread2/* default */.Z)({},data),_ref26=this.record||{},_ref26$siteId=_ref26.siteId,siteId=void 0===_ref26$siteId?null:_ref26$siteId,formId=transition.formId||null;
// Remove once v3 is done for workorders, handle it through relations
!(0,validation/* isEmpty */.xb)(siteId)&&(0,validation/* isEmpty */.xb)(formData.siteId)&&(formData.siteId=siteId),(0,validation/* isEmpty */.xb)(formId)||(formData.formId=formId);var formFields=this.$getProperty(transition,"form.fields")||[],currentModuleLookupField=formFields.find((function(field){var fieldObj=field.field;return field.lookupModuleName===_this7.moduleName&&!fieldObj.default}));return currentModuleLookupField&&(formData.data=formData.data||{},formData.data[currentModuleLookupField.name]={id:this.record.id}),Object.keys(formData).forEach((function(name){var value=formData[name];(0,validation/* isObject */.Kn)(value)&&-99===value.id&&(formData[name]=null)})),formData},defaultResponseHandler:function(){var _this8=this,_ref27=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},error=_ref27.error,delay=this.$helpers.delay,$message=this.$message;error?this.$emit("transitionFailure"):(this.fetchAvailableStates({force:!0}),this.$emit("transitionSuccess")),this.cancelTransition(),this.hideNotifications||(error?$message.error(error.message||this.$t("maintenance._workorder.state_update_failed")):delay(200).then((function(){$message.success(_this8.$t("maintenance._workorder.state_update_success"))})))},closeStateFlowForm:function(){this.canShowForm=!1},showStateFlowForm:function(){this.canShowForm=!0},closeConfirmationDialogs:function(){this.showConfirmationDialog=!1},getUrl:function(transition){return(0,validation/* isFunction */.mf)(this.updateUrl)?this.updateUrl(transition):this.updateUrl}}},stateflow_TransitionButtonsvue_type_script_lang_js=TransitionButtonsvue_type_script_lang_js,TransitionButtons_component=(0,componentNormalizer/* default */.Z)(stateflow_TransitionButtonsvue_type_script_lang_js,render,staticRenderFns,!1,null,"cca90304",null)
/* harmony default export */,TransitionButtons=TransitionButtons_component.exports},
/***/76975:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return ApprovalSummaryFullView}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/workorder/approval/ApprovalSummaryFullView.vue?vue&type=template&id=71f097c0
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{attrs:{id:"summarylayout"}},[_c("div",{staticClass:"subheader-preventive-summary"},[_c("div",{staticClass:"subheader-block"},[_c("div",{staticClass:"flRight",staticStyle:{"padding-top":"25px","padding-right":"25px"}},[_vm.workorder.moduleState&&_vm.workorder.moduleState.id>0?_c("approve-reject",{attrs:{record:_vm.workorder,moduleName:"workorder",transformFn:_vm.transformFormData,updateUrl:"/v2/workorders/update"},on:{transitionSuccess:_vm.fetchWo}},[_c("div",{staticClass:"fc-summary-chip",attrs:{slot:"waiting"},slot:"waiting"},[_vm._v(" "+_vm._s(_vm.$t("maintenance.approval.waiting_for_approval"))+" ")])]):_vm._e()],1),_c("div",{staticClass:"summary-back",staticStyle:{"text-transform":"uppercase"},on:{click:_vm.back}},[_c("i",{staticClass:"el-icon-back"}),_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.back"))+" ")]),_c("div",{staticClass:"summary-title-container"},[_c("div",{staticClass:"summary-title-block wo-title-block"},[_c("div",{staticClass:"summary-title"},[_vm.canEdit?_vm._e():_c("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"fa fa-lock locked-wo",attrs:{"data-arrow":"true",title:_vm.$t("common.products.waiting_for_approval")}}),_vm._v(" "+_vm._s(_vm.workorder.subject)+" "),_vm.workorder.urgency>0?_c("span",{staticClass:"fc-tag-urgent mL20",style:{background:_vm.urgencyColorCode[_vm.workorder.urgency]}},[_vm._v(" "+_vm._s(_vm.$constants.WO_URGENCY[_vm.workorder.urgency]))]):_vm._e()])])]),_c("div",{staticStyle:{"font-size":"13px",position:"relative",clear:"both",top:"4px",left:"0px"}},[_c("span",{staticClass:"fc-id bold"},[_vm._v("#"+_vm._s(_vm.workorder.serialNumber))]),_vm.workorder.sourceType?_c("span",{staticClass:"separator"},[_vm._v("|")]):_vm._e(),[_c("span",{staticStyle:{color:"#8ca1ad","padding-right":"5px"}},[2===_vm.workorder.sourceType?_c("i",{staticClass:"fa fa-envelope-o"}):10===_vm.workorder.sourceType?_c("i",{staticClass:"f14 fa fa-globe"}):1===_vm.workorder.sourceType?_c("i",{staticClass:"f14 el-icon-service approval-el-icon-service"}):4===_vm.workorder.sourceType?_c("i",{staticClass:"f14 el-icon-bell approval-el-icon-bell"}):5===_vm.workorder.sourceType?_c("i",{staticClass:"f14 el-icon-date approval-el-icon-date"}):_vm._e()]),_vm.workorder.requester?_c("span",{staticStyle:{color:"#2ea2b2","font-size":"13px","vertical-align":"middle","padding-right":"8px","padding-left":"5px"}},[_vm._v(_vm._s(_vm.workorder.requester.name))]):_vm._e()],_c("div",{staticClass:"clearboth"})],2)])]),_c("el-row",{staticStyle:{margin:"20px"}},[_c("el-col",{class:{width66:!_vm.showAddTask,width56:_vm.showAddTask},staticStyle:{"margin-right":"20px"}},[_c("div",{staticClass:"scrollable",staticStyle:{background:"white",height:"80vh","padding-bottom":"50px"}},[_c("div",{staticClass:"fc-summary2",staticStyle:{padding:"6px","padding-left":"15px","border-bottom":"1px solid #eeeeee"}},[_c("div",{staticClass:"row",staticStyle:{position:"relative","padding-bottom":"6px"}},[_c("div",{staticClass:"tabel-selector subtitle",class:{tabselected:"summarypage"===_vm.subSection},staticStyle:{"padding-top":"14px"},on:{click:function($event){_vm.selectSubSection("summarypage"),_vm.closedisplay()}}},[_vm._v(" "+_vm._s(_vm.$t("common._common._summary"))+" "),_c("div",{class:{selectionbar:"summarypage"===_vm.subSection},staticStyle:{position:"absolute","margin-top":"12px"}})]),"taskpage"===_vm.subSection?_c("div",{staticStyle:{position:"absolute",right:"30px",top:"25%"}},[_c("el-button",{staticClass:"fc-summary-chip",staticStyle:{"text-align":"left"},attrs:{disabled:!_vm.allTaskStatus},on:{click:_vm.closeAllTask}},[_vm._v(_vm._s(_vm.$t("maintenance._workorder.close_all_task"))+" ")])],1):_vm._e(),_c("div",{staticClass:"clearboth"})])]),"summarypage"===_vm.subSection?_c("div",{staticStyle:{"margin-top":"32px","margin-left":"0px"}},[_c("div",{staticClass:"flLeft"},[_c("div",{staticStyle:{"padding-left":"30px","font-size":"13px",color:"#39b2c2 !important","letter-spacing":"0.4px"}},[_vm._v(" #"+_vm._s(_vm.workorder.serialNumber)+" ")]),_c("div",{staticClass:"coltitle",staticStyle:{"padding-left":"30px","font-weight":"normal","padding-top":"5px"}},[_vm._v(" "+_vm._s(_vm.workorder.subject?_vm.workorder.subject:"---")+" ")])]),_vm.workorder.requester&&_vm.workorder.requester.name?_c("div",{staticClass:"flRight",staticStyle:{"margin-right":"30px"}},[_c("avatar",{attrs:{size:"lg",user:{name:_vm.workorder.requester.name}}})],1):_vm._e(),_c("div",{staticClass:"flRight",staticStyle:{"margin-right":"8px"}},[_vm.workorder.requester&&_vm.workorder.requester.name?_c("div",{staticStyle:{"text-align":"right","padding-top":"3px"}},[_vm._v(" "+_vm._s(_vm.workorder.requester.name)+" ")]):_vm._e()]),_c("div",{staticClass:"clearboth"}),_c("div",{staticClass:"row",staticStyle:{"padding-left":"30px","padding-top":"8px"}},[_c("span",{staticClass:"coldisc",staticStyle:{"max-width":"100%","white-space":"pre-wrap"}},[_vm._v(_vm._s(_vm.workorder.description))])]),_c("div",{staticStyle:{"padding-top":"50px"}},[_c("span",{staticClass:"commenttitle",staticStyle:{"padding-bottom":"10px","padding-left":"30px"}},[_vm._v(_vm._s(_vm.$t("maintenance.wr_list.comments")))])]),_c("div",{staticStyle:{"padding-top":"10px","border-bottom":"1px solid #f0f0f0","margin-right":"30px","margin-left":"30px"}}),_c("div",{class:{mT20:_vm.comments.length>0},staticStyle:{"margin-left":"30px",width:"70%"}},_vm._l(_vm.comments,(function(comment){return _c("div",{key:comment.id,staticClass:"fc-comment-row col-12",staticStyle:{"padding-bottom":"30px"}},[_c("div",{staticClass:"flLeft"},[_c("avatar",{attrs:{size:"md",user:{name:comment.createdBy.name}}})],1),_c("div",{staticClass:"flLeft",staticStyle:{"margin-top":"7px","padding-left":"10px","max-width":"90%"}},[_c("div",{staticClass:"flex-middle"},[_c("div",{staticClass:"flLeft"},[_c("span",{staticStyle:{"font-size":"13px","font-weight":"500","letter-spacing":"0.2px"}},[_vm._v(_vm._s(comment.createdBy.name))])]),_c("div",{staticClass:"flLeft",staticStyle:{width:"6px",height:"6px",background:"rgb(216, 216, 216)","border-radius":"50%","margin-left":"10px"}}),_c("div",{staticClass:"flLeft pL5 secondary-color f12 comment-time col-4",staticStyle:{color:"#8c8c8c","font-size":"13px","letter-spacing":"0.2px","padding-left":"11px"}},[_vm._v(" "+_vm._s(_vm._f("fromNow")(comment.createdTime))+" ")]),_c("div",{staticClass:"clearboth"})]),_c("div",{staticStyle:{"padding-top":"5px"}},[_c("div",{staticStyle:{"font-size":"13px","font-weight":"normal","letter-spacing":"0.2px",color:"#333333","white-space":"pre-line"}},[_vm._v(" "+_vm._s(comment.body)+" ")])])]),_c("div",{staticClass:"clearboth"})])})),0),_vm.comments.length>0?_c("div",{staticStyle:{"padding-top":"10px","border-bottom":"1px solid #f0f0f0","margin-right":"30px","margin-left":"30px"}}):_vm._e(),_c("div",{staticClass:"row comment-area2",attrs:{id:"commentBoxPar"}},[_c("form",{staticClass:"col-12",on:{submit:function($event){return $event.preventDefault(),_vm.addComment.apply(null,arguments)}}},[_c("textarea",{directives:[{name:"model",rawName:"v-model",value:_vm.newComment.body,expression:"newComment.body"}],ref:"commentBoxRef",staticClass:"comment-box",class:{height75:_vm.commentFocus,height35:!_vm.commentFocus},staticStyle:{"font-size":"13px","letter-spacing":"0.3px",color:"#333333","border-color":"#d6d6d6"},attrs:{placeholder:_vm.$t("common._common.write_comment")},domProps:{value:_vm.newComment.body},on:{click:_vm.focusCommentBox,input:function($event){$event.target.composing||_vm.$set(_vm.newComment,"body",$event.target.value)}}}),_vm._v(" "),_vm.commentFocus?_c("div",[_c("div",{staticClass:"flRight"},[_c("button",{staticClass:"comment-btn",staticStyle:{"text-transform":"uppercase"}},[_vm._v(" "+_vm._s(_vm.$t("common._common.comment"))+" ")])]),_vm.workorder.requester?_c("div",{staticClass:"flLeft"},[_c("input",{directives:[{name:"model",rawName:"v-model",value:_vm.newComment.notifyRequester,expression:"newComment.notifyRequester"}],attrs:{type:"checkbox",name:"notifyRequester"},domProps:{checked:Array.isArray(_vm.newComment.notifyRequester)?_vm._i(_vm.newComment.notifyRequester,null)>-1:_vm.newComment.notifyRequester},on:{change:function($event){var $$a=_vm.newComment.notifyRequester,$$el=$event.target,$$c=!!$$el.checked;if(Array.isArray($$a)){var $$v=null,$$i=_vm._i($$a,$$v);$$el.checked?$$i<0&&_vm.$set(_vm.newComment,"notifyRequester",$$a.concat([$$v])):$$i>-1&&_vm.$set(_vm.newComment,"notifyRequester",$$a.slice(0,$$i).concat($$a.slice($$i+1)))}else _vm.$set(_vm.newComment,"notifyRequester",$$c)}}}),_c("label",{staticClass:"notify-req",attrs:{for:"notifyRequester"}},[_vm._v(_vm._s(_vm.$t("common._common.notify")))])]):_vm._e(),_c("div",{staticClass:"clearboth"})]):_vm._e()])])]):_vm._e(),"taskpage"===_vm.subSection?_c("div",{staticStyle:{"padding-right":"30px","margin-top":"30px","padding-left":"30px"},attrs:{id:"summarytask"}},[_c("div",[_vm._l(_vm.newTaskList,(function(obj,index){return _vm.sequencedData?_c("div",{key:index},[_vm.sections[obj.sectionId]?_c("div",{staticStyle:{"padding-top":"35px","font-size":"13px","font-weight":"bold","letter-spacing":"0.6px",color:"#333333","padding-bottom":"10px","padding-left":"8px"},style:{"border-bottom":_vm.sections[obj.sectionId]?"solid 2px #d9f4f7":"0"}},[_vm._v(" "+_vm._s(_vm.sections[obj.sectionId]?_vm.sections[obj.sectionId].name:"")+" ")]):_vm._e(),_vm._l(obj.taskList,(function(task,index1){return _c("div",{key:index1,staticClass:"task-list",class:{selected:_vm.selectedTask===task,closed:"OPEN"!==task.status.type}},[_c("div",{staticStyle:{cursor:"pointer","padding-left":"5px","margin-right":"8px"},on:{click:function($event){return _vm.changeTaskStatus(task)}}},["OPEN"===task.status.type?_c("i",{staticClass:"el-icon-circle-check-outline",staticStyle:{color:"#b8e5eb","font-size":"24px"}}):_c("i",{staticClass:"el-icon-circle-check",staticStyle:{color:"#39b2c2","font-size":"24px"}})]),_c("div",{staticClass:"task-item",staticStyle:{"padding-left":"5px",position:"relative"},style:{width:_vm.showAddTask?"50%":"60%"},on:{click:function($event){return _vm.showTaskDetails(task)}}},[-1===task.id?_c("el-input",{staticStyle:{width:"100%"},attrs:{type:"text",placeholder:_vm.$t("maintenance._workorder.write_a_task_name")},model:{value:task.subject,callback:function($$v){_vm.$set(task,"subject",$$v)},expression:"task.subject"}}):_c("div",{class:[{closedTask:"OPEN"!==task.status.type},"task-subject"],staticStyle:{width:"100%","word-wrap":"break-word"},attrs:{type:"text",placeholder:""}},[_vm._v(" "+_vm._s(task.subject)+" ")]),-1===task.id||task.resource&&task.resource.name?_c("div",{staticClass:"pT5"},[-1===task.id?_c("div",{staticClass:"flLeft",staticStyle:{height:"10px",width:"10px",cursor:"pointer"},on:{click:function($event){return _vm.showSpaceAssetChooser()}}},[_c("img",{attrs:{src:__webpack_require__(539884)}})]):_c("div",{staticClass:"flLeft"},[1===task.resource.resourceType?_c("img",{staticStyle:{height:"12px",width:"14px"},attrs:{src:__webpack_require__(572902)}}):_c("img",{staticStyle:{height:"11px",width:"14px"},attrs:{src:__webpack_require__(30684)}})]),_c("div",{staticStyle:{"padding-left":"6px","text-overflow":"ellipsis","letter-spacing":"0.5px",width:"85%","white-space":"nowrap",overflow:"hidden",color:"#878787","font-size":"12px"}},[_vm._v(" "+_vm._s(task.resource.name||"")+" ")])]):_vm._e()],1),1!==task.inputType&&-1!==task.id?_c("div",{staticClass:"task-item f-element"},[2===task.inputType||"2"===task.inputType?_c("div",[_c("el-input",{staticClass:"inline",class:[{"validation-failed":_vm.errorMap[task.id]}],staticStyle:{width:"auto"},attrs:{type:"number",placeholder:_vm.$t("maintenance._workorder.enter_reading"),disabled:"OPEN"!==task.status.type},on:{focus:function($event){return _vm.checkAndShowTask(task)},change:function($event){return _vm.onReadingChange(task)}},model:{value:task.inputValue,callback:function($$v){_vm.$set(task,"inputValue",$$v)},expression:"task.inputValue"}}),task.readingField&&task.readingField.unit?_c("div",{staticClass:"inline",staticStyle:{"padding-left":"7px"}},[_vm._v(" "+_vm._s(task.readingField.unit)+" ")]):_vm._e(),task.lastReading&&-1!==task.lastReading&&"-1"!==task.lastReading?_c("div",{staticClass:"inline"},[_c("q-icon",{directives:[{name:"tippy",rawName:"v-tippy",value:{html:"#prevpopup_"+task.id,position:"bottom",arrow:!0,theme:"light",animation:"scale"},expression:"{\n                          html: '#prevpopup_' + task.id,\n                          position: 'bottom',\n                          arrow: true,\n                          theme: 'light',\n                          animation: 'scale',\n                        }"}],staticClass:"info-icon",staticStyle:{position:"absolute",top:"-14px",right:"-21px","vertical-align":"middle"},attrs:{name:"info_outline",size:"18px",title:""}})],1):_vm._e(),_c("div",{staticClass:"hide",attrs:{id:"prevpopup_"+task.id}},[_c("div",{staticClass:"task-prevreading"},[_vm._v(" "+_vm._s(task.lastReading)+_vm._s(task.readingField&&task.readingField.unit?task.readingField.unit:"")),_c("span",[_vm._v(" ("+_vm._s(_vm.$t("common.header.previous_reading"))+")")])])]),_c("el-date-picker",{staticClass:"reading-time",attrs:{placeholder:_vm.$t("maintenance._workorder.time_of_reading"),type:"datetime",editable:!1,disabled:"OPEN"!==task.status.type,"default-value":new Date(_vm.workorder.createdTime)},on:{change:function($event){return _vm.onReadingChange(task)}},model:{value:task.inputTime,callback:function($$v){_vm.$set(task,"inputTime",$$v)},expression:"task.inputTime"}})],1):_vm._e(),3===task.inputType||"3"===task.inputType?_c("el-input",{attrs:{type:"text",placeholder:_vm.$t("maintenance._workorder.enter_text"),disabled:"OPEN"!==task.status.type},on:{focus:function($event){return _vm.checkAndShowTask(task)},change:function($event){return _vm.addTask(task)}},model:{value:task.inputValue,callback:function($$v){_vm.$set(task,"inputValue",$$v)},expression:"task.inputValue"}}):_vm._e(),4===task.inputType||"4"===task.inputType?_c("el-input",{class:[{"validation-failed":_vm.errorMap[task.id]}],attrs:{type:"number",placeholder:_vm.$t("maintenance._workorder.enter_numeric_value"),disabled:"OPEN"!==task.status.type},on:{focus:function($event){return _vm.checkAndShowTask(task)},change:function($event){return _vm.addTask(task)}},model:{value:task.inputValue,callback:function($$v){_vm.$set(task,"inputValue",$$v)},expression:"task.inputValue"}}):_vm._e(),_c("div",{directives:[{name:"show",rawName:"v-show",value:_vm.errorMap[task.id],expression:"errorMap[task.id]"}],staticClass:"err-msg"},[_vm._v(" "+_vm._s(_vm.errorMessage[task.id])+" ")]),5===task.inputType||"5"===task.inputType?_c("span",[_vm.checkOptionsLength(task.options)?_c("el-radio-group",{attrs:{disabled:"OPEN"!==task.status.type},on:{change:function($event){_vm.checkAndShowTask(task),_vm.addTask(task)}},model:{value:task.inputValue,callback:function($$v){_vm.$set(task,"inputValue",$$v)},expression:"task.inputValue"}},_vm._l(task.options,(function(option,index){return _c("el-radio",{key:index,staticClass:"pT15",attrs:{color:"secondary",label:option}},[_vm._v(_vm._s(option))])})),1):_c("el-select",{attrs:{"popper-class":"f-dropdown",disabled:"OPEN"!==task.status.type},on:{change:function($event){return _vm.addTask(task)},focus:function($event){return _vm.checkAndShowTask(task)}},model:{value:task.inputValue,callback:function($$v){_vm.$set(task,"inputValue",$$v)},expression:"task.inputValue"}},_vm._l(task.options,(function(option,index){return _c("el-option",{key:index,attrs:{label:option,value:option}})})),1)],1):_vm._e()],1):_vm._e()])}))],2):_vm._e()})),_vm._l(Object.keys(_vm.taskList).sort(),(function(section,index){return _vm.sequencedData?_vm._e():_c("div",{key:index},[_vm.sections[section]?_c("div",{staticStyle:{"padding-top":"35px","font-size":"13px","font-weight":"bold","letter-spacing":"0.6px",color:"#333333","padding-bottom":"10px","padding-left":"8px"},style:{"border-bottom":_vm.sections[section]?"solid 2px #d9f4f7":"0"}},[_vm._v(" "+_vm._s(_vm.sections[section]?_vm.sections[section].name:"")+" ")]):_vm._e(),_vm._l(_vm.taskList[section],(function(task,index1){return _c("div",{key:index1,staticClass:"task-list",class:{selected:_vm.selectedTask===task,closed:"OPEN"!==task.status.type}},[_c("div",{staticStyle:{cursor:"pointer","padding-left":"5px","margin-right":"8px"},on:{click:function($event){return _vm.changeTaskStatus(task)}}},["OPEN"===task.status.type?_c("i",{staticClass:"el-icon-circle-check-outline",staticStyle:{color:"#b8e5eb","font-size":"24px"}}):_c("i",{staticClass:"el-icon-circle-check",staticStyle:{color:"#39b2c2","font-size":"24px"}})]),_c("div",{staticClass:"task-item",staticStyle:{"padding-left":"5px",position:"relative"},style:{width:_vm.showAddTask?"50%":"57%"},on:{click:function($event){return _vm.showTaskDetails(task)}}},[-1===task.id?_c("el-input",{staticStyle:{width:"100%"},attrs:{type:"text",placeholder:_vm.$t("maintenance._workorder.write_a_task_name")},model:{value:task.subject,callback:function($$v){_vm.$set(task,"subject",$$v)},expression:"task.subject"}}):_c("div",{class:[{closedTask:"OPEN"!==task.status.type},"task-subject"],staticStyle:{width:"100%","word-wrap":"break-word"},attrs:{type:"text",placeholder:""}},[_vm._v(" "+_vm._s(task.subject)+" ")]),-1===task.id||task.resource&&task.resource.name?_c("div",{staticClass:"pT5"},[-1===task.id?_c("div",{staticClass:"flLeft",staticStyle:{height:"10px",width:"10px",cursor:"pointer"},on:{click:function($event){return _vm.showSpaceAssetChooser()}}},[_c("img",{attrs:{src:__webpack_require__(539884)}})]):_c("div",{staticClass:"flLeft"},[1===task.resource.resourceType?_c("img",{staticStyle:{height:"12px",width:"14px"},attrs:{src:__webpack_require__(572902)}}):_c("img",{staticStyle:{height:"11px",width:"14px"},attrs:{src:__webpack_require__(30684)}})]),_c("div",{staticStyle:{"padding-left":"6px","text-overflow":"ellipsis","letter-spacing":"0.5px",width:"85%","white-space":"nowrap",overflow:"hidden",color:"#878787","font-size":"12px"}},[_vm._v(" "+_vm._s(task.resource.name||"")+" ")])]):_vm._e()],1),1!==task.inputType&&-1!==task.id?_c("div",{staticClass:"task-item f-element"},[2===task.inputType||"2"===task.inputType?_c("div",[_c("el-input",{staticClass:"inline",staticStyle:{width:"auto"},attrs:{type:"number",placeholder:_vm.$t("maintenance._workorder.enter_reading"),disabled:"OPEN"!==task.status.type},on:{focus:function($event){return _vm.checkAndShowTask(task)},change:function($event){return _vm.onReadingChange(task)}},model:{value:task.inputValue,callback:function($$v){_vm.$set(task,"inputValue",$$v)},expression:"task.inputValue"}}),task.readingField&&task.readingField.unit?_c("div",{staticClass:"inline",staticStyle:{"padding-left":"7px"}},[_vm._v(" "+_vm._s(task.readingField.unit)+" ")]):_vm._e(),task.lastReading&&-1!==task.lastReading&&"-1"!==task.lastReading?_c("div",{staticClass:"inline"},[_c("q-icon",{directives:[{name:"tippy",rawName:"v-tippy",value:{html:"#prevpopup_"+task.id,position:"bottom",arrow:!0,theme:"light",animation:"scale"},expression:"{\n                          html: '#prevpopup_' + task.id,\n                          position: 'bottom',\n                          arrow: true,\n                          theme: 'light',\n                          animation: 'scale',\n                        }"}],staticClass:"info-icon",staticStyle:{"margin-left":"22px","vertical-align":"middle"},attrs:{name:"info_outline",size:"18px",title:""}})],1):_vm._e(),_c("div",{staticClass:"hide",attrs:{id:"prevpopup_"+task.id}},[_c("div",{staticClass:"task-prevreading"},[_vm._v(" "+_vm._s(task.lastReading)+_vm._s(task.readingField&&task.readingField.unit?task.readingField.unit:"")),_c("span",[_vm._v(" ("+_vm._s(_vm.$t("common.header.previous_reading"))+")")])])]),_c("el-date-picker",{staticClass:"reading-time",attrs:{placeholder:_vm.$t("maintenance._workorder.time_of_reading"),type:"datetime",editable:!1,disabled:"OPEN"!==task.status.type,"default-value":new Date(_vm.workorder.createdTime)},on:{change:function($event){return _vm.onReadingChange(task)}},model:{value:task.inputTime,callback:function($$v){_vm.$set(task,"inputTime",$$v)},expression:"task.inputTime"}})],1):_vm._e(),3===task.inputType||"3"===task.inputType?_c("el-input",{attrs:{type:"text",placeholder:_vm.$t("maintenance._workorder.enter_text"),disabled:"OPEN"!==task.status.type},on:{focus:function($event){return _vm.checkAndShowTask(task)},change:function($event){return _vm.addTask(task)}},model:{value:task.inputValue,callback:function($$v){_vm.$set(task,"inputValue",$$v)},expression:"task.inputValue"}}):_vm._e(),4===task.inputType||"4"===task.inputType?_c("el-input",{attrs:{type:"number",placeholder:_vm.$t("maintenance._workorder.enter_numeric_value"),disabled:"OPEN"!==task.status.type},on:{focus:function($event){return _vm.checkAndShowTask(task)},change:function($event){return _vm.addTask(task)}},model:{value:task.inputValue,callback:function($$v){_vm.$set(task,"inputValue",$$v)},expression:"task.inputValue"}}):_vm._e(),5===task.inputType||"5"===task.inputType?_c("span",[_vm.checkOptionsLength(task.options)?_c("el-radio-group",{attrs:{disabled:"OPEN"!==task.status.type},on:{change:function($event){_vm.checkAndShowTask(task),_vm.addTask(task)}},model:{value:task.inputValue,callback:function($$v){_vm.$set(task,"inputValue",$$v)},expression:"task.inputValue"}},_vm._l(task.options,(function(option,index){return _c("el-radio",{key:index,staticClass:"pT15",attrs:{color:"secondary",label:option}},[_vm._v(_vm._s(option))])})),1):_c("el-select",{attrs:{"popper-class":"f-dropdown",disabled:"OPEN"!==task.status.type},on:{change:function($event){return _vm.addTask(task)},focus:function($event){return _vm.checkAndShowTask(task)}},model:{value:task.inputValue,callback:function($$v){_vm.$set(task,"inputValue",$$v)},expression:"task.inputValue"}},_vm._l(task.options,(function(option,index){return _c("el-option",{key:index,attrs:{label:option,value:option}})})),1)],1):_vm._e()],1):_vm._e()])}))],2)})),5!==_vm.workorder.sourceType&&_vm.canEdit?_c("div",{staticClass:"pT15",staticStyle:{"padding-bottom":"30px"}},[_c("el-button",{staticClass:"btnsize txt",staticStyle:{"font-size":"10px","font-weight":"bold","padding-right":"13px !important","padding-left":"13px !important",border:"1px solid rgb(57, 178, 194)",color:"rgb(57, 178, 194)","padding-top":"6px !important","padding-bottom":"6px !important","border-radius":"3px"},on:{click:_vm.addNewTask}},[_vm._v(_vm._s(_vm.$t("maintenance._workorder.add_task")))]),_c("el-button",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"btnsize txt",staticStyle:{"font-size":"10px","font-weight":"bold","padding-right":"13px !important","padding-left":"13px !important",border:"1px solid rgb(57, 178, 194)",color:"rgb(57, 178, 194)","padding-top":"6px !important","padding-bottom":"6px !important","border-radius":"3px"},on:{click:_vm.addNewTask}},[_vm._v(_vm._s(_vm.$t("maintenance._workorder.add_section")))])],1):_vm._e()],2)]):_vm._e()])]),_vm.showAddTask&&-1!==_vm.selectedTask.id?_c("el-col",{staticClass:"cardpadding width42"},[_c("div",{staticClass:"scrollable",staticStyle:{background:"white",height:"80vh","padding-bottom":"50px"}},[_c("div",{staticClass:"subheader-section ",staticStyle:{"padding-bottom":"25px","padding-top":"17px","padding-left":"30px"}},[_c("div",{staticClass:"taskdetails",staticStyle:{"padding-bottom":"20px"}},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.task_details"))+" ")]),_c("i",{staticClass:"q-icon el-icon-close material-icons destroy pull-right pointer",attrs:{"aria-hidden":"true"},on:{click:_vm.closedisplay}}),_c("div",[_c("div",{staticClass:"flLeft",staticStyle:{cursor:"pointer"},on:{click:function($event){return _vm.changeTaskStatus(_vm.selectedTask)}}},["OPEN"===_vm.selectedTask.status.type?_c("i",{staticClass:"el-icon-circle-check-outline",staticStyle:{color:"#b8e5eb","font-size":"40px"}}):_c("i",{staticClass:"el-icon-circle-check",staticStyle:{color:"#62c1cd","font-size":"40px"}})]),_c("div",{staticClass:"flLeft",staticStyle:{"padding-left":"8px",position:"relative",width:"85%"}},[_c("div",{staticClass:"taskheader"},[_vm._v(_vm._s(_vm.selectedTask.subject))]),_c("div",[_vm.selectedTask.resource?_c("div",{staticClass:"flLeft",staticStyle:{"margin-right":"5px","padding-top":"1px"}},[1===_vm.selectedTask.resource.resourceType?_c("img",{staticStyle:{height:"12px",width:"14px"},attrs:{src:__webpack_require__(572902)}}):_c("img",{staticStyle:{height:"11px",width:"14px"},attrs:{src:__webpack_require__(30684)}})]):_vm._e(),_c("div",{staticClass:"tasksubheader flLeft"},[_vm._v(" "+_vm._s(_vm.selectedTask.resource?_vm.selectedTask.resource.name:"")+" ")]),_c("div",{staticClass:"clearboth"})])]),_c("div",{staticClass:"clearboth"})])]),_c("div",{staticStyle:{"margin-left":"30px","margin-right":"30px"}},[_c("div",{staticClass:"taskdisc",staticStyle:{"margin-top":"30px"}},[_vm._v(" "+_vm._s(_vm.selectedTask.description)+" ")]),_c("div",[2===_vm.selectedTask.inputType||"2"===_vm.selectedTask.inputType?_c("div",[_c("div",{staticClass:"pT30 taskoptions"},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.enter"))+" "+_vm._s(_vm.selectedTask.readingField.displayName)+" "+_vm._s(_vm.selectedTask.readingField.unit?"(in "+_vm.selectedTask.readingField.unit+")":"")+" ")]),_c("el-input",{attrs:{type:"number",disabled:"OPEN"!==_vm.selectedTask.status.type},on:{change:function($event){return _vm.addTask(_vm.selectedTask)}},model:{value:_vm.selectedTask.inputValue,callback:function($$v){_vm.$set(_vm.selectedTask,"inputValue",$$v)},expression:"selectedTask.inputValue"}}),_c("div",{staticClass:"pT30 taskoptions"},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.time_of_reading"))+" ")]),_c("el-date-picker",{staticClass:"inputtime-detail",attrs:{type:"datetime",disabled:"OPEN"!==_vm.selectedTask.status.type},on:{change:function($event){return _vm.onReadingChange(_vm.selectedTask)}},model:{value:_vm.selectedTask.inputTime,callback:function($$v){_vm.$set(_vm.selectedTask,"inputTime",$$v)},expression:"selectedTask.inputTime"}})],1):_vm._e(),3===_vm.selectedTask.inputType||"3"===_vm.selectedTask.inputType?_c("div",[_c("div",{staticClass:"pT30 taskoptions"},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.specify_input"))+" ")]),_c("el-input",{attrs:{type:"text",disabled:"OPEN"!==_vm.selectedTask.status.type},on:{change:function($event){return _vm.addTask(_vm.selectedTask)}},model:{value:_vm.selectedTask.inputValue,callback:function($$v){_vm.$set(_vm.selectedTask,"inputValue",$$v)},expression:"selectedTask.inputValue"}})],1):_vm._e(),4===_vm.selectedTask.inputType||"4"===_vm.selectedTask.inputType?_c("div",[_c("div",{staticClass:"pT30 taskoptions"},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.specify_input"))+" ")]),_c("el-input",{attrs:{type:"number",disabled:"OPEN"!==_vm.selectedTask.status.type},on:{change:function($event){return _vm.addTask(_vm.selectedTask)}},model:{value:_vm.selectedTask.inputValue,callback:function($$v){_vm.$set(_vm.selectedTask,"inputValue",$$v)},expression:"selectedTask.inputValue"}})],1):_vm._e(),5===_vm.selectedTask.inputType||"5"===_vm.selectedTask.inputType?_c("div",{staticClass:"f-element"},[_c("div",{staticClass:"pT30 taskoptions"},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.select_input"))+" ")]),_vm._l(_vm.selectedTask.options,(function(option,index){return _c("div",{key:index},[_c("el-radio",{staticClass:"pT15",attrs:{color:"secondary",label:option,disabled:"OPEN"!==_vm.selectedTask.status.type},on:{change:function($event){return _vm.addTask(_vm.selectedTask)}},model:{value:_vm.selectedTask.inputValue,callback:function($$v){_vm.$set(_vm.selectedTask,"inputValue",$$v)},expression:"selectedTask.inputValue"}},[_vm._v(_vm._s(option))])],1)}))],2):_vm._e(),6===_vm.selectedTask.inputType||"6"===_vm.selectedTask.inputType?_c("div",[_c("div",{staticClass:"pT30 taskoptions"},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.select_input"))+" ")]),_c("el-checkbox-group",{attrs:{disabled:"OPEN"!==_vm.selectedTask.status.type},on:{change:function($event){return _vm.addTask(_vm.selectedTask)}},model:{value:_vm.selectedTask.inputValues,callback:function($$v){_vm.$set(_vm.selectedTask,"inputValues",$$v)},expression:"selectedTask.inputValues"}},_vm._l(_vm.selectedTask.options,(function(option,index){return _c("el-checkbox",{key:index,staticClass:"newradio pT15 f-checkbox",attrs:{color:"secondary",label:option}},[_vm._v(_vm._s(option))])})),1)],1):_vm._e(),_c("div",{staticClass:"pT30 taskoptions"},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.remarks"))+" ")]),_c("div",[_c("el-input",{attrs:{type:"text",disabled:"OPEN"!==_vm.selectedTask.status.type},on:{change:function($event){return _vm.addTask(_vm.selectedTask)}},model:{value:_vm.selectedTask.remarks,callback:function($$v){_vm.$set(_vm.selectedTask,"remarks",$$v)},expression:"selectedTask.remarks"}})],1),_c("div",{staticClass:"pT30 taskoptions"},[_c("mobile-attachment",{attrs:{module:"taskattachments",record:_vm.selectedTask,disabled:"OPEN"!==_vm.selectedTask.status.type}})],1)])])])]):_vm.showAddTask&&-1===_vm.selectedTask.id?_c("el-col",{staticClass:"cardpadding width42"},[_c("div",{staticClass:"scrollable",staticStyle:{background:"white",height:"75vh"}},[_c("div",{staticClass:"subheader-section ",staticStyle:{"padding-bottom":"25px","padding-top":"17px","padding-left":"30px"}},[_c("div",{staticClass:"taskdetails",staticStyle:{"padding-bottom":"20px"}},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.add_task"))+" ")]),_c("i",{staticClass:"q-icon el-icon-close material-icons destroy pull-right pointer",attrs:{"aria-hidden":"true"},on:{click:_vm.closedisplay}}),_c("div",[_c("div",{staticClass:"flLeft"},[_c("i",{staticClass:"el-icon-circle-check-outline",staticStyle:{color:"#b8e5eb","font-size":"40px"}})]),_c("div",{staticClass:"flLeft"},[_c("div",{staticClass:"taskheader"},[_c("el-input",{staticStyle:{width:"100%"},attrs:{type:"text",placeholder:_vm.$t("maintenance._workorder.write_a_task_name")},model:{value:_vm.selectedTask.subject,callback:function($$v){_vm.$set(_vm.selectedTask,"subject",$$v)},expression:"selectedTask.subject"}})],1),_c("div",{staticStyle:{"margin-top":"-3px"}},[_c("div",{staticClass:"tasksubheader flLeft",staticStyle:{"padding-left":"10px"}},[_vm._v(" "+_vm._s(_vm.selectedTask.selectedResourceName)+" ")]),_c("div",{staticClass:"flLeft",staticStyle:{height:"10px",width:"10px","margin-left":"10px",cursor:"pointer"},on:{click:function($event){return _vm.showSpaceAssetChooser()}}},[_c("img",{attrs:{src:__webpack_require__(539884)}})]),_c("div",{staticClass:"clearboth"})])]),_c("div",{staticClass:"clearboth"})])]),_c("div",{staticStyle:{"margin-left":"30px","margin-right":"30px","margin-top":"30px"}},[_c("div",[_c("el-row",{attrs:{align:"middle"}},[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"textcolor"},[_c("div",{staticClass:"taskdescinput",staticStyle:{"font-size":"13px","letter-spacing":"0.4px",color:"#6b7e91"}},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.description"))+" ")]),_c("el-input",{staticClass:"form-item ",staticStyle:{"padding-top":"10px"},attrs:{type:"textarea"},model:{value:_vm.selectedTask.description,callback:function($$v){_vm.$set(_vm.selectedTask,"description",$$v)},expression:"selectedTask.description"}})],1)])],1),_c("div",{staticClass:"enableInput",staticStyle:{"padding-top":"25px"}},[_c("el-checkbox",{model:{value:_vm.selectedTask.attachmentRequired,callback:function($$v){_vm.$set(_vm.selectedTask,"attachmentRequired",$$v)},expression:"selectedTask.attachmentRequired"}},[_vm._v(_vm._s(_vm.$t("maintenance._workorder.photo")))])],1),_c("div",{staticClass:"enableInput",staticStyle:{"padding-top":"25px"}},[_c("el-checkbox",{on:{change:function($event){_vm.selectedTask.inputType=_vm.selectedTask.enableInput?_vm.selectedTask.inputType:1}},model:{value:_vm.selectedTask.enableInput,callback:function($$v){_vm.$set(_vm.selectedTask,"enableInput",$$v)},expression:"selectedTask.enableInput"}},[_vm._v(_vm._s(_vm.$t("maintenance._workorder.enable_input")))])],1),_vm.selectedTask.enableInput?_c("div",{staticClass:"f-element"},[_c("div",{staticClass:"pT30",staticStyle:{"font-size":"13px","letter-spacing":"0.4px",color:"#6b7e91"}},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.task_type"))+" ")]),_c("el-radio",{staticClass:"pT15",attrs:{disabled:!this.selectedTask.resource||!_vm.selectedTask.resource.id||-1===_vm.selectedTask.resource.id,color:"secondary",label:"2"},on:{change:_vm.onSelectInput},model:{value:_vm.selectedTask.inputType,callback:function($$v){_vm.$set(_vm.selectedTask,"inputType",$$v)},expression:"selectedTask.inputType"}},[_vm._v(_vm._s(_vm.$t("maintenance._workorder.reading"))+" "+_vm._s(_vm.selectedTask.resource&&_vm.selectedTask.resource.id&&-1!==_vm.selectedTask.resource.id?"":_vm.$t("maintenance._workorder.select_asset_space")))]),_c("div",[_c("el-radio",{staticClass:"pT15",attrs:{color:"secondary",label:"3"},on:{change:_vm.onSelectInput},model:{value:_vm.selectedTask.inputType,callback:function($$v){_vm.$set(_vm.selectedTask,"inputType",$$v)},expression:"selectedTask.inputType"}},[_vm._v(_vm._s(_vm.$t("maintenance._workorder.text")))])],1),_c("el-radio",{staticClass:"pT15",attrs:{color:"secondary",label:"4"},on:{change:_vm.onSelectInput},model:{value:_vm.selectedTask.inputType,callback:function($$v){_vm.$set(_vm.selectedTask,"inputType",$$v)},expression:"selectedTask.inputType"}},[_vm._v(_vm._s(_vm.$t("maintenance._workorder.numeric")))]),_c("div",[_c("el-radio",{staticClass:"pT15",attrs:{color:"secondary",label:"5"},on:{change:_vm.onSelectInput},model:{value:_vm.selectedTask.inputType,callback:function($$v){_vm.$set(_vm.selectedTask,"inputType",$$v)},expression:"selectedTask.inputType"}},[_vm._v(_vm._s(_vm.$t("maintenance._workorder.option")))])],1),_c("el-radio",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"newradio pT15",attrs:{color:"secondary",label:"6"},on:{change:_vm.onSelectInput},model:{value:_vm.selectedTask.inputType,callback:function($$v){_vm.$set(_vm.selectedTask,"inputType",$$v)},expression:"selectedTask.inputType"}},[_vm._v(_vm._s(_vm.$t("maintenance._workorder.checkbox")))])],1):_vm._e(),"2"===_vm.selectedTask.inputType?_c("div",{staticStyle:{"padding-top":"20px"}},[_c("div",{staticStyle:{"padding-top":"20px","font-size":"13px","letter-spacing":"0.4px",color:"#6b7e91"}},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.reading_field"))+" ")]),_c("div",[_c("el-select",{staticClass:"form-item",staticStyle:{width:"100%"},attrs:{placeholder:" "},model:{value:_vm.selectedTask.readingFieldId,callback:function($$v){_vm.$set(_vm.selectedTask,"readingFieldId",$$v)},expression:"selectedTask.readingFieldId"}},_vm._l(_vm.taskReadingFields,(function(readingField){return _c("el-option",{key:readingField.id,attrs:{label:readingField.displayName,value:readingField.id}})})),1)],1)]):_vm._e(),"5"===_vm.selectedTask.inputType||"6"===_vm.selectedTask.inputType?_c("div",[_c("div",{staticClass:"pT30",staticStyle:{"font-size":"13px","letter-spacing":"0.4px",color:"#6b7e91","padding-bottom":"10px"}},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.options"))+" ")]),_vm._l(_vm.selectedTask.options,(function(option){return _c("div",{key:option,staticStyle:{"padding-bottom":"10px"}},["5"===_vm.selectedTask.inputType?_c("div",{staticClass:"circle flLeft",staticStyle:{width:"14px",height:"14px","margin-top":"9px"}}):_vm._e(),"6"===_vm.selectedTask.inputType?_c("div",{staticClass:"flLeft",staticStyle:{width:"14px",height:"14px","margin-top":"9px","margin-right":"7px","border-radius":"3px",border:"1px solid #c4d1dd"}}):_vm._e(),_c("div",{staticClass:"flLeft",staticStyle:{"padding-left":"3px",width:"200px"}},[_c("el-input",{staticStyle:{width:"100%"},attrs:{type:"text",placeholder:""},model:{value:option.name,callback:function($$v){_vm.$set(option,"name",$$v)},expression:"option.name"}})],1),_c("div",{staticClass:"clearboth"})])})),_c("div",{staticStyle:{"margin-bottom":"30px","font-size":"13px",color:"rgb(57, 178, 194)",cursor:"pointer","border-bottom":"1px solid rgb(57, 178, 194)",width:"70px","padding-top":"10px"},on:{click:function($event){return _vm.addTaskOption(_vm.selectedTask)}}},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.add_option"))+" ")])],2):_vm._e()],1),_c("div",{staticClass:"pT15",staticStyle:{"padding-top":"30px","padding-bottom":"30px"}},[_c("el-button",{staticClass:"btnsize txt",staticStyle:{"font-size":"11px","font-weight":"bold",padding:"9px 17px !important",border:"1px solid rgb(57, 178, 194)",color:"rgb(57, 178, 194)","border-radius":"3px"},on:{click:function($event){return _vm.addTask(_vm.selectedTask)}}},[_vm._v(_vm._s(_vm.$t("maintenance._workorder.save")))])],1)])])]):_c("el-col",{staticClass:"cardpadding width32"},[_c("div",{staticClass:"scrollable",staticStyle:{background:"white",height:"80vh","padding-bottom":"50px"}},[_c("div",{staticStyle:{padding:"0px","border-bottom":"solid 1px #eeeeee"}},[_c("div",{staticClass:"flLeft",staticStyle:{"border-right":"solid 1px #eeeeee",cursor:"pointer"},on:{click:function($event){return _vm.selectSummarySection("details")}}},[_c("img",{staticStyle:{"padding-top":"20px","padding-left":"20px","padding-right":"20px","padding-bottom":"12px"},attrs:{src:__webpack_require__(304081)}}),"details"===_vm.summarySection?_c("div",{staticClass:"selectionbar",staticStyle:{"margin-top":"0px",width:"100%"}}):_vm._e()]),_c("div",{staticClass:"flLeft",staticStyle:{"border-right":"solid 1px #eeeeee",cursor:"pointer"},on:{click:function($event){return _vm.selectSummarySection("attachments")}}},[_c("img",{staticStyle:{"padding-top":"20px","padding-left":"20px","padding-right":"20px","padding-bottom":"12px"},attrs:{src:__webpack_require__(984428)}}),"attachments"===_vm.summarySection?_c("div",{staticClass:"selectionbar",staticStyle:{"margin-top":"0px",width:"100%"}}):_vm._e()]),_c("div",{staticClass:"flLeft",staticStyle:{"border-right":"solid 1px #eeeeee",cursor:"pointer"},on:{click:function($event){return _vm.selectSummarySection("activities")}}},[_c("img",{staticStyle:{"padding-top":"20px","padding-left":"20px","padding-right":"20px","padding-bottom":"12px"},attrs:{src:__webpack_require__(222223)}}),"activities"===_vm.summarySection?_c("div",{staticClass:"selectionbar",staticStyle:{"margin-top":"0px",width:"100%"}}):_vm._e()]),_c("div",{staticClass:"clearboth"})]),"details"===_vm.summarySection?_c("div",{staticStyle:{"margin-left":"30px"}},[_vm.workorder.space?_c("div",[_c("div",{staticClass:"raised",staticStyle:{"margin-top":"30px"}},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.raised_for"))+" ")]),"Building"===_vm.workorder.space.spaceTypeVal?_c("div",[_c("div",{staticClass:"place"},[_vm._v(" "+_vm._s(_vm.workorder.space.id?_vm.getSpace(_vm.workorder.space.siteId).name:"---")+" ")])]):"Site"===_vm.workorder.space.spaceTypeVal?_c("div",[_c("div",{staticClass:"place",staticStyle:{"padding-bottom":"35px"}},[_vm._v(" "+_vm._s(_vm.workorder.space.id?_vm.getSpace(_vm.workorder.space.id).name:"---")+" ")])]):_vm._e(),"Building"===_vm.workorder.space.spaceTypeVal?_c("div",[_c("div",{staticClass:"inplace",staticStyle:{"padding-bottom":"35px"}},[_vm._v(" "+_vm._s(_vm.workorder.space.name)+" ")])]):_vm._e()]):_c("div",{staticStyle:{"margin-top":"40px"}}),_c("div",[_vm.showSiteEdit?_c("div",{staticStyle:{"padding-bottom":"23px"}},[_c("div",{staticClass:"flLeft heading",staticStyle:{width:"30%","padding-top":"2px","text-transform":"uppercase"}},[_vm._v(" "+_vm._s(_vm.$t("maintenance.wr_list.site"))+" ")]),_c("div",{class:["flLeft picklist",{pointer:_vm.canEdit}],staticStyle:{"font-size":"14px","letter-spacing":"0.6px",color:"#333"}},[_vm.workorder.siteId&&_vm.workorder.siteId>0?_c("div",{staticClass:"flLeft"},[_vm._v(" "+_vm._s(_vm.getSiteName(_vm.workorder.siteId))+" ")]):_c("div",{staticClass:"flLeft color-d"},[_vm._v("---")]),_vm.canEdit?_c("div",{staticClass:"flLeft",staticStyle:{"padding-left":"10px"}},[_c("span",{staticClass:"picklist-downarrow"},[_c("i",{staticClass:"fa fa-sort-desc wl-icon-downarrow",attrs:{"aria-hidden":"true"}})])]):_vm._e(),_c("div",{staticClass:"clearboth"}),_vm.canEdit?_c("q-popover",{ref:"sitepopover"},[_c("q-list",{staticClass:"scroll",staticStyle:{"min-width":"180px"},attrs:{link:""}},_vm._l(_vm.sites,(function(site,key){return _c("q-item",{key:key,on:{click:function($event){_vm.updateSite(_vm.workorder.id,site.id),_vm.$refs.sitepopover.close()}}},[_c("q-item-main",{staticStyle:{"font-size":"13px"},attrs:{label:site.name}})],1)})),1)],1):_vm._e()],1),_c("div",{staticClass:"clearboth"})]):_vm._e(),_c("div",{staticStyle:{"padding-bottom":"23px"}},[_c("div",{staticClass:"flLeft heading",staticStyle:{width:"30%","padding-top":"2px","text-transform":"uppercase"}},[_vm._v(" "+_vm._s(_vm.$t("maintenance.wr_list.type"))+" ")]),_c("div",{class:["flLeft picklist",{pointer:_vm.canEdit}],staticStyle:{"font-size":"14px","letter-spacing":"0.6px",color:"#333"}},[_vm.workorder.type&&_vm.workorder.type.id>0?_c("div",{staticClass:"flLeft"},[_vm._v(" "+_vm._s(_vm.getPMType(_vm.workorder.type.id))+" ")]):_c("div",{staticClass:"flLeft color-d"},[_vm._v("---")]),_vm.canEdit?_c("div",{staticClass:"flLeft",staticStyle:{"padding-left":"10px"}},[_c("span",{staticClass:"picklist-downarrow"},[_c("i",{staticClass:"fa fa-sort-desc wl-icon-downarrow",attrs:{"aria-hidden":"true"}})])]):_vm._e(),_c("div",{staticClass:"clearboth"}),_vm.canEdit?_c("q-popover",{ref:"typepopover"},[_c("q-list",{staticClass:"scroll",staticStyle:{"min-width":"180px"},attrs:{link:""}},_vm._l(_vm.tickettype,(function(type,key){return _c("q-item",{key:key,on:{click:function($event){_vm.updateWorkOrder([_vm.workorder.id],{type:{id:key,name:type}}),_vm.$refs.typepopover.close()}}},[_c("q-item-main",{staticStyle:{"font-size":"13px"},attrs:{label:type}})],1)})),1)],1):_vm._e()],1),_c("div",{staticClass:"clearboth"})]),_c("div",{staticStyle:{"padding-bottom":"23px"}},[_c("div",{staticClass:"flLeft heading",staticStyle:{width:"30%","padding-top":"2px","text-transform":"uppercase"}},[_vm._v(" "+_vm._s(_vm.$t("maintenance.wr_list.priority"))+" ")]),_c("div",{class:["flLeft picklist",{pointer:_vm.canEdit}],staticStyle:{"font-size":"14px","letter-spacing":"0.6px",color:"#333"}},[_vm.workorder.priority&&_vm.workorder.priority.id>0?_c("div",{staticClass:"flLeft"},[_c("span",{staticClass:"q-item-label"},[_c("i",{staticClass:"fa fa-circle prioritytag",style:{color:_vm.getTicketPriority(_vm.workorder.priority.id).colour},attrs:{"aria-hidden":"true"}}),_vm._v(_vm._s(_vm.workorder.priority&&_vm.workorder.priority.id>0?_vm.getTicketPriority(_vm.workorder.priority.id).displayName:"---"))])]):_c("div",{staticClass:"flLeft color-d"},[_vm._v("---")]),_vm.canEdit?_c("div",{staticClass:"flLeft",staticStyle:{"padding-left":"10px"}},[_c("span",{staticClass:"picklist-downarrow"},[_c("i",{staticClass:"fa fa-sort-desc wl-icon-downarrow",attrs:{"aria-hidden":"true"}})])]):_vm._e(),_c("div",{staticClass:"clearboth"}),_vm.canEdit?_c("q-popover",{ref:"prioritypopover"},[_c("q-list",{staticClass:"scroll",staticStyle:{"min-width":"180px"},attrs:{link:""}},_vm._l(_vm.ticketpriority,(function(priority,key){return _c("q-item",{key:key,on:{click:function($event){_vm.updateWorkOrder([_vm.workorder.id],{priority:{id:key,priority:priority}}),_vm.$refs.prioritypopover.close()}}},[_c("q-item-main",{staticStyle:{"font-size":"13px"},attrs:{label:priority}})],1)})),1)],1):_vm._e()],1),_c("div",{staticClass:"clearboth"})]),_c("div",{staticStyle:{"padding-bottom":"23px"}},[_c("div",{staticClass:"flLeft heading",staticStyle:{width:"30%","padding-top":"2px","text-transform":"uppercase"}},[_vm._v(" "+_vm._s(_vm.$t("maintenance.wr_list.category"))+" ")]),_c("div",{class:["flLeft picklist",{pointer:_vm.canEdit}],staticStyle:{"font-size":"14px","letter-spacing":"0.6px",color:"#333"}},[_vm.workorder.category&&_vm.workorder.category.id>0?_c("div",{staticClass:"flLeft"},[_vm._v(" "+_vm._s(_vm.getTicketCategory(_vm.workorder.category.id).displayName)+" ")]):_c("div",{staticClass:"flLeft color-d"},[_vm._v("---")]),_vm.canEdit?_c("div",{staticClass:"flLeft",staticStyle:{"padding-left":"10px"}},[_c("span",{staticClass:"picklist-downarrow"},[_c("i",{staticClass:"fa fa-sort-desc wl-icon-downarrow",attrs:{"aria-hidden":"true"}})])]):_vm._e(),_c("div",{staticClass:"clearboth"}),_vm.canEdit?_c("q-popover",{ref:"categorypopover"},[_c("q-list",{staticClass:"scroll",staticStyle:{"min-width":"180px"},attrs:{link:""}},_vm._l(_vm.ticketcategory,(function(category,key){return _c("q-item",{key:key,on:{click:function($event){_vm.updateWorkOrder([_vm.workorder.id],{category:{id:key,name:category}}),_vm.$refs.categorypopover.close()}}},[_c("q-item-main",{staticStyle:{"font-size":"13px"},attrs:{label:category}})],1)})),1)],1):_vm._e()],1),_c("div",{staticClass:"clearboth"})]),_c("div",{staticStyle:{"padding-bottom":"23px"}},[_vm.workorder.resource&&2===_vm.workorder.resource.resourceType?_c("div",[_c("div",{staticClass:"flLeft heading",staticStyle:{width:"30%","padding-top":"2px","text-transform":"uppercase"}},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.asset"))+" ")]),_c("div",[_c("div",[_c("div",{staticStyle:{float:"left",width:"10%"}},[_c("asset-avatar",{staticClass:"asset-space-img",attrs:{size:"mobile-xlg",name:"false",asset:{id:-1,name:""}}})],1),_c("div",{staticStyle:{float:"right",width:"53%"}},[_c("div",{staticClass:"profile-name-txt",staticStyle:{cursor:"pointer"},on:{click:function($event){return _vm.openAsset(_vm.workorder.resource.id)}}},[_vm._v(" "+_vm._s(_vm.workorder.resource?_vm.workorder.resource.name:"---")+" ")]),_c("div",{staticClass:"heading"},[_vm._v(" "+_vm._s(_vm.workorder.resource.spaceId>0?_vm.getSpace(_vm.workorder.resource.spaceId).name:"---")+" ")])])])])]):_vm.workorder.resource&&1===_vm.workorder.resource.resourceType?_c("div",[_c("div",{staticClass:"flLeft heading",staticStyle:{width:"30%","padding-top":"2px","text-transform":"uppercase"}},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.space"))+" ")]),_c("div",{staticClass:"flLeft"},[_c("div",{staticStyle:{display:"flex"}},[_c("div",{staticStyle:{float:"left"}},[_c("space-avatar",{staticClass:"asset-space-img",attrs:{name:!1,size:"mobile-xlg",space:_vm.workorder.resource}})],1),_c("div",{staticStyle:{float:"right"}},[_c("div",{staticClass:"bluetxt",staticStyle:{cursor:"pointer"},on:{click:_vm.redirect}},[_vm._v(" "+_vm._s(_vm.workorder.resource.name)+" ")])])])])]):_c("div",[_c("div",{staticClass:"flLeft heading",staticStyle:{width:"30%","padding-top":"2px","text-transform":"uppercase"}},[_vm._v(" "+_vm._s(_vm.$t("maintenance.wr_list.space_asset"))+" ")]),_c("div",{staticClass:"heading"},[_vm._v("---")])]),_c("div",{staticClass:"clearboth"})]),_c("div",{staticStyle:{"padding-bottom":"39px"}},[_c("div",{staticClass:"flLeft heading",staticStyle:{width:"30%","padding-top":"2px","text-transform":"uppercase"}},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.created_time"))+" ")]),_c("div",{staticClass:"flLeft picklist",staticStyle:{"font-size":"14px","letter-spacing":"0.6px"}},[_c("div",{staticClass:"flLeft"},[_vm._v(" "+_vm._s(_vm._f("formatDate")(_vm.workorder.createdTime))+" ")])])]),_c("div",{staticClass:"clearboth"}),_c("div",{staticClass:"picklist",staticStyle:{"padding-bottom":"11px"}},[_c("div",{staticClass:"flLeft heading",staticStyle:{width:"30%","padding-top":"2px","text-transform":"uppercase"}},[_vm._v(" "+_vm._s(_vm.$t("maintenance.wr_list.duedate"))+" ")]),_vm.canEdit?_c("div",{staticClass:"flLeft color-d",attrs:{id:"showdatepicker"}},[_c("el-date-picker",{ref:"showdatepicker",staticClass:"f-custom-datepicker",attrs:{"prefix-icon":" ","clear-icon":" ",align:"right",type:"datetime","picker-options":_vm.pickerOptions},on:{change:_vm.onChangeDueDate},model:{value:_vm.duedate,callback:function($$v){_vm.duedate=$$v},expression:"duedate"}})],1):_vm._e(),-1!==_vm.workorder.dueDate?_c("div",{class:["flLeft",{pointer:_vm.canEdit}],on:{click:function($event){return _vm.$refs.showdatepicker.focus()}}},[_vm._v(" "+_vm._s(_vm._f("formatDate")(_vm.workorder.dueDate))+" ")]):_c("div",{class:["flLeft color-d",{pointer:_vm.canEdit}],on:{click:function($event){_vm.canEdit&&_vm.$refs.showdatepicker.focus()}}},[_vm._v(" --- ")]),_vm.canEdit?_c("div",{staticClass:"flLeft",staticStyle:{"padding-left":"10px"}},[_c("span",{staticClass:"picklist-downarrow"},[_c("i",{staticClass:"fa fa-sort-desc wl-icon-downarrow",attrs:{"aria-hidden":"true"}})])]):_vm._e(),_c("div",{staticClass:"clearboth"})]),_c("div",{staticClass:"picklist",staticStyle:{"padding-bottom":"23px"}},[_c("div",{staticClass:"flLeft heading",staticStyle:{width:"30%","padding-top":"2px","text-transform":"uppercase"}},[_vm._v(" "+_vm._s(_vm.$t("maintenance.wr_list.assignedto"))+" ")]),_vm.workorder.assignedTo&&_vm.workorder.assignedTo.id>0||_vm.workorder.assignmentGroup&&_vm.workorder.assignmentGroup.id>0?_c("div",{staticClass:"flLeft"},[_c("user-avatar",{attrs:{size:"md",user:_vm.workorder.assignedTo,group:_vm.workorder.assignmentGroup,showPopover:!0,showLabel:!0,moduleName:"workorder"}})],1):_c("div",{staticClass:"flLeft color-d"},[_vm._v("--- / ---")]),_vm.canEdit?_c("div",{staticClass:"flLeft",staticStyle:{"padding-left":"10px"}},[_c("span",{staticClass:"picklist-downarrow"},[_c("i",{staticClass:"fa fa-sort-desc wl-icon-downarrow",attrs:{"aria-hidden":"true"}})])]):_vm._e(),_c("div",{staticClass:"clearboth"}),_vm.canEdit?_c("f-assignment",{attrs:{viewtype:"view",record:_vm.workorder,siteId:_vm.workorder.siteId}}):_vm._e()],1),5===_vm.workorder.sourceType?_c("div",{staticStyle:{"padding-bottom":"23px"}},[_c("div",{staticClass:"flLeft heading",staticStyle:{width:"30%","padding-top":"2px"}},[_vm._v(" "+_vm._s(_vm.$t("maintenance._workorder.pm_id"))+" ")]),_c("div",{staticClass:"flLeft bluetxt",staticStyle:{cursor:"pointer"},on:{click:_vm.openPM}},[_vm._v(" #"+_vm._s(_vm.workorder.pm.id)+" ")]),_c("div",{staticClass:"clearboth"})]):_vm._e(),_c("div",{staticClass:"flLeft color-d",attrs:{id:"showcustomdatepicker"}},[_c("el-date-picker",{ref:"showcustomdatepicker",staticClass:"f-custom-datepicker",attrs:{"prefix-icon":" ","clear-icon":" ",align:"right",type:"datetime"},on:{change:_vm.onChangeCustomField},model:{value:_vm.selectedFieldValue,callback:function($$v){_vm.selectedFieldValue=$$v},expression:"selectedFieldValue"}})],1),_vm._l(_vm.fields,(function(field,index){return field.default?_vm._e():_c("div",{key:index,staticClass:"edit-icon-block",staticStyle:{"padding-bottom":"23px"}},[_c("div",{staticClass:"flLeft heading",staticStyle:{"text-transform":"uppercase",width:"30%","padding-top":"2px"}},[_vm._v(" "+_vm._s(field.displayName)+" ")]),_vm.workorder.data&&_vm.workorder.data[field.name]&&("DATE"===field.dataTypeEnum||"DATE"===field.dataTypeEnum._name)||_vm.workorder.data&&_vm.workorder.data[field.name]&&("DATE_TIME"===field.dataTypeEnum||"DATE_TIME"===field.dataTypeEnum._name)?_c("div",{class:["flLeft",{pointer:_vm.canEdit}],on:{click:function($event){_vm.canEdit&&(_vm.$refs.showcustomdatepicker.focus(),_vm.selectedFieldUpdate=field,_vm.selectedFieldValue=_vm.workorder.data[field.name])}}},[_vm._v(" "+_vm._s(_vm._f("formatDate")(_vm.workorder.data[field.name]))+" ")]):_vm.workorder.data&&_vm.workorder.data[field.name]?_c("div",{class:["flLeft",{pointer:_vm.canEdit}],on:{click:function($event){_vm.canEdit&&(_vm.customFieldUpdate=!0,_vm.selectedFieldUpdate=field,_vm.selectedFieldValue=_vm.workorder.data[field.name])}}},[_vm._v(" "+_vm._s(_vm.workorder.data[field.name])+" ")]):_c("div",{class:["flLeft color-d",{pointer:_vm.canEdit}],on:{click:function($event){_vm.canEdit&&(_vm.selectedFieldUpdate=field,_vm.selectedFieldValue=null,_vm.updateEmptyField())}}},[_vm._v(" --- ")]),_vm.canEdit?_c("div",{staticClass:"flLeft",staticStyle:{"padding-left":"10px"}},[_c("span",{staticClass:"picklist-downarrow"},[_c("i",{staticClass:"fa fa-sort-desc wl-icon-downarrow",attrs:{"aria-hidden":"true"}})])]):_vm._e(),_c("div",{staticClass:"clearboth"})])}))],2)]):"attachments"===_vm.summarySection?_c("div",[_c("attachments",{attrs:{module:"ticketattachments",record:_vm.workorder}})],1):"activities"===_vm.summarySection?_c("div",{staticStyle:{"margin-left":"30px"}},[_c("activities",{ref:"activitiesDiv",attrs:{record:_vm.workorder}})],1):_vm._e()])])],1),_vm.customFieldUpdate?_c("f-dialog",{attrs:{visible:_vm.customFieldUpdate,width:"20%",title:"Enter "+_vm.selectedFieldUpdate.displayName+" Value",confirmTitle:"Update",maxHeight:"200px"},on:{save:function($event){return _vm.updateCustomFields()},close:_vm.closeUpdateDialog}},[_c("div",{attrs:{slot:"content"},slot:"content"},["TEXTAREA"===_vm.selectedFieldUpdate.dataTypeEnum||"TEXTAREA"===_vm.selectedFieldUpdate.dataTypeEnum._name||"STRING"===_vm.selectedFieldUpdate.dataTypeEnum||"STRING"===_vm.selectedFieldUpdate.dataTypeEnum._name?_c("el-input",{attrs:{type:"textarea"},model:{value:_vm.selectedFieldValue,callback:function($$v){_vm.selectedFieldValue=$$v},expression:"selectedFieldValue"}}):"NUMBER"===_vm.selectedFieldUpdate.dataTypeEnum||"NUMBER"===_vm.selectedFieldUpdate.dataTypeEnum._name||"DECIMAL"===_vm.selectedFieldUpdate.dataTypeEnum||"DECIMAL"===_vm.selectedFieldUpdate.dataTypeEnum._name?_c("el-input",{attrs:{type:"number"},model:{value:_vm.selectedFieldValue,callback:function($$v){_vm.selectedFieldValue=$$v},expression:"selectedFieldValue"}}):_vm._e()],1)]):_vm._e(),_c("task-space-asset-chooser",{attrs:{visibility:_vm.visibility,quickSearchQuery:_vm.quickSearchQuery},on:{associate:_vm.associate,"update:visibility":function($event){_vm.visibility=$event}}}),_vm.showWorkDurationDialog?_c("work-hours",{attrs:{visible:_vm.showWorkDurationDialog,id:_vm.workorder.id,callback:_vm.workDurationCallBack},on:{"update:visible":function($event){_vm.showWorkDurationDialog=$event}}}):_vm._e()],1)},staticRenderFns=[],createForOfIteratorHelper=__webpack_require__(566347),esm_typeof=__webpack_require__(103336),objectSpread2=__webpack_require__(595082),SummaryAttachment=(__webpack_require__(879288),__webpack_require__(434284),__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(564043),__webpack_require__(857267),__webpack_require__(670560),__webpack_require__(634338),__webpack_require__(538077),__webpack_require__(947522),__webpack_require__(169358),__webpack_require__(450886),__webpack_require__(228436),__webpack_require__(903650),__webpack_require__(865137),__webpack_require__(526971)),Activities2=__webpack_require__(638507),vuex_esm=__webpack_require__(420629),Avatar=__webpack_require__(574752),User=__webpack_require__(426803),Asset=__webpack_require__(751201),FDialogNew=__webpack_require__(436756),SpaceAssetChooser=__webpack_require__(372587),MobileAttachment2=__webpack_require__(391810),FAssignment=__webpack_require__(383274),WorkHours=__webpack_require__(16297),helpers=__webpack_require__(778390),ApproveReject=__webpack_require__(600675),validation=__webpack_require__(990260),workorderTransform=__webpack_require__(112143),quasar_esm=__webpack_require__(641358),router=__webpack_require__(329435),log_map_getters=__webpack_require__(160799),ApprovalSummaryFullViewvue_type_script_lang_js={name:"ApprovalSummaryFullView",mixins:[workorderTransform/* default */.Z],data:function(){return{showSiteEdit:!0,validationRules:{},errorMap:{},errorQue:{},errorMessage:{},taskBulkList:[],fields:[],noOfUpdatedTAsk:0,testVar:null,customFieldUpdate:!1,visibility:!1,quickSearchQuery:"",loading:!0,summoryview:!0,fieldvisibility:!1,showWorkDurationDialog:!1,workDurationCallBack:null,radio2:"",selectedFieldUpdate:null,selectedFieldValue:null,summaryWindow:"true",subSection:"summarypage",sequencedData:!1,summarySection:"details",taskReadingFields:[],duedate:"",value1:"",subheaderMenu:[{label:this.$t("common.events.today"),path:{path:"/app/fa/events/today"}},{label:this.$t("common.events.yesterday"),path:{path:"/app/fa/events/yesterday"}},{label:this.$t("common.events.this_week"),path:{path:"/app/fa/events/thisweek"}},{label:this.$t("common.events.last_week"),path:{path:"/app/fa/events/lastweek"}},{label:this.$t("common.events.all_events"),path:{path:"/app/fa/events/all"}}],comments:[],taskList:{},newTaskList:[],sections:{},newComment:{parentModuleLinkName:"ticketnotes",parentId:this.$route.params.id,body:null,notifyRequester:!1},commentFocus:!1,newTask:{subject:"",description:"",resource:{id:-1},isReadingTask:!1,readingFieldId:null,options:[],taskType:-1,enableInput:!1,inputType:1,attachmentRequired:!1,inputValidation:null,minSafeLimit:null,maxSafeLimit:null,id:-1},showAddTask:!1,selectedTask:{inputValidationRuleId:-1,inputValidation:null,safeLimitRuleId:-1,minSafeLimit:null,maxSafeLimit:null,options:[],taskType:-1,enableInput:!1,inputType:1,attachmentRequired:!1,subject:"",selectedResourceName:"",inputValues:[]},urgencyColorCode:{1:"#7fa5ff",2:"#f56837",3:"#e65244"},pickerOptions:{disabledDate:function(time){return time.getTime()<Date.now()-864e5}},waitBoolean:!0}},created:function(){this.$store.dispatch("loadTicketStatus","workorder"),this.$store.dispatch("loadSite"),this.$store.dispatch("loadTicketCategory"),this.$store.dispatch("loadTicketType"),this.$store.dispatch("loadGroups"),this.fetchWo(),window.addEventListener("click",this.blurCommentBox)},mounted:function(){this.loadComments(),this.loadTasks(),this.loadFields();var currentSiteId=Number(this.$cookie.get("fc.currentSite"))||-1;-1!==currentSiteId&&(this.showSiteEdit=!1)},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({users:function(state){return state.users},groups:function(state){return state.groups},ticketcategory:function(state){return state.ticketCategory},ticketpriority:function(state){return state.ticketPriority},ticketstatus:function(state){return state.ticketStatus.workorder},sites:function(state){return state.site}})),(0,vuex_esm/* mapGetters */.Se)(["getTicketTypePickList","getTicketStatusByLabel","getTicketPriority","getTicketCategory"])),(0,log_map_getters/* mapGettersWithLogging */.t)(["getSpace"])),{},{tickettype:function(){return this.getTicketTypePickList()},canEdit:function(){var moduleId=this.$getProperty(this.workorder,"moduleState.id",null);return!(0,validation/* isEmpty */.xb)(moduleId)&&!this.$store.getters.isStatusLocked(this.workorder.moduleState.id,"workorder")},openWorkorderId:function(){return this.$route.params.id?parseInt(this.$route.params.id):-1},allTaskStatus:function(){var status=null,closedCount=0,taskCount=0;for(var idx in this.taskList)for(var idx2 in this.taskList[idx]){taskCount+=1;var completed="OPEN"===this.taskList[idx][idx2].status.type;completed&&1!==this.taskList[idx][idx2].inputType&&!this.taskList[idx][idx2].inputValue?(null===status&&(status=!1),status=status&&!1):(completed||(closedCount+=1),null===status&&(status=!0),status=status&&!0)}return closedCount===taskCount&&(status=!1),status},openStatusId:function(){var id=this.getTicketStatusByLabel("Submitted","workorder").id;return id?parseInt(id):id},closedStatusId:function(){var id=this.getTicketStatusByLabel("Closed","workorder").id;return id?parseInt(id):id},workorder:function(){return this.$store.state.workorder.currentWorkOrder},ticketStatusValue:function(){return this.workorder&&this.workorder.status&&this.workorder.status.id&&this.$store.getters.getTicketStatus(this.workorder.status.id,"workorder").status||""}}),watch:{workorder:function(){var title="[#"+this.workorder.serialNumber+"] "+this.workorder.subject;this.setTitle(title),this.setDueDate(this.workorder.dueDate)},openWorkorderId:function(newVal){this.fetchWo()}},methods:{fetchWo:function(force){this.$store.dispatch("workorder/fetchWorkOrder",{id:this.openWorkorderId,force:force})},updateEmptyField:function(){"DATE"===this.selectedFieldUpdate.dataTypeEnum||"DATE"===this.selectedFieldUpdate.dataTypeEnum._name||"DATE_TIME"===this.selectedFieldUpdate.dataTypeEnum||"DATE_TIME"===this.selectedFieldUpdate.dataTypeEnum._name?this.$refs.showcustomdatepicker.focus():this.customFieldUpdate=!0},updateCustomFields:function(){var updateCustomfield={};updateCustomfield[this.selectedFieldUpdate.name]=this.selectedFieldValue,this.updateWorkOrder([this.workorder.id],{data:updateCustomfield}),this.customFieldUpdate=!1},closeUpdateDialog:function(){this.customFieldUpdate=!1},getSiteName:function(siteId){if(this.sites){var s=this.sites.find((function(i){return i.id===siteId}));return s?s.name:"---"}return"---"},openAsset:function(id){if(id)if((0,router/* isWebTabsEnabled */.tj)()){var _ref=(0,router/* findRouteForModule */.Jp)("asset",router/* pageTypes */.As.OVERVIEW)||{},name=_ref.name;name&&this.$router.replace({name:name,params:{viewname:"all",id:id}})}else{var url="/app/at/assets/all/"+id+"/overview";this.$router.replace({path:url})}},updateSite:function(woId,siteId){var _this=this;this.$dialog.confirm({title:this.$t("maintenance._workorder.change_site"),message:this.$t("maintenance._workorder.change_site_message"),rbDanger:!0,rbLabel:this.$t("maintenance._workorder.change_site_message_label")}).then((function(value){value&&_this.updateWorkOrder([woId],{siteId:siteId})}))},setDueDate:function(duedate){this.duedate=-1===duedate?Date.now()-864e5:new Date(duedate)},onChangeDueDate:function(pickVal){this.updateWorkOrderDueDate([this.workorder.id],new Date(pickVal).getTime())},onChangeCustomField:function(pickVal){var updateCustomfield={};updateCustomfield[this.selectedFieldUpdate.name]=new Date(pickVal).getTime(),this.updateWorkOrder([this.workorder.id],{data:updateCustomfield})},back:function(){this.$router.go(-1)},closeAllTask:function(){var ticketId,taskIds=[];for(var idx in this.taskList)for(var idx2 in this.taskList[idx]){var task=this.taskList[idx][idx2];ticketId=task.parentTicketId,taskIds.push(this.taskList[idx][idx2].id)}var data={taskIdList:taskIds,parentTicketId:ticketId},self=this;this.$http.post("/task/closeAllTask",data).then((function(response){self.loadTasks()}))},findRoute:function(){if((0,router/* isWebTabsEnabled */.tj)()){var tabType=router/* tabTypes */.VF.CUSTOM,config={type:"portfolio"},route=(0,router/* findRouteForTab */.OD)(tabType,{config:config})||{};return(0,validation/* isEmpty */.xb)(route)?null:this.$router.resolve({name:route.name}).href}return"/app/home/portfolio"},redirect:function(){if(this.workorder.resource.siteId){var parentPath=this.findRoute();if(parentPath){var url="".concat(parentPath,"/site/").concat(this.workorder.resource.siteId);1===this.workorder.resource.spaceType?url+="/overview":2===this.workorder.resource.spaceType?url+="/building/"+this.workorder.resource.spaceId:3===this.workorder.resource.spaceType?url+="/floor/"+this.workorder.resource.spaceId:4===this.workorder.resource.spaceType&&(url+="/space/"+this.workorder.resource.spaceId),this.$router.push({path:url})}}},loadFields:function(){var self=this;self.loading=!0,self.$http.get("/module/fields?moduleName=workorder").then((function(response){self.fields=response.data.fields,self.loading=!1}))},taskStatus:function(task){var completed="OPEN"===task.status.type,data={id:[task.id],task:{id:task.id,parentTicketId:task.parentTicketId,status:{id:completed?this.closedStatusId:this.openStatusId,type:completed?"CLOSED":"OPEN"}}},self=this;this.$http.post("/task/updatestatus",data).then((function(response){"object"===(0,esm_typeof/* default */.Z)(response.data)?(completed?(task.status={id:self.closedStatusId,type:"CLOSED"},self.$message({message:self.$t("maintenance._workorder.task_close_success"),type:"success"})):(task.status={id:self.openStatusId,type:"OPEN"},self.$message({message:self.$t("maintenance._workorder.task_open_success"),type:"success"})),"Work in Progress"!==self.ticketstatusvalue&&(self.workorder.status.id=self.getTicketStatusByLabel("Work in Progress","workorder").id)):self.$message({message:self.$t("maintenance._workorder.operation_failed"),type:"error"})}))},changeTaskStatus:function(task){var _this2=this,completed="OPEN"===task.status.type;!completed||1===task.inputType||task.inputValue?completed&&this.taskBulkList.length?setTimeout((function(){return _this2.taskStatus(task)}),5e3):this.taskStatus(task):this.$message({message:this.$t("maintenance._workorder.task_input"),type:"warning"})},showSpaceAssetChooser:function(){this.visibility=!0},associate:function(selectedObj){this.visibility=!1,this.selectedTask.resource=selectedObj,this.selectedTask.selectedResourceName=selectedObj.name},onReadingChange:function(task){task.inputValue&&this.addTask(task)},asyncTaskUpdate:function(){var doValidation=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],self=this,taskListContext=[];self.waitBoolean&&self.taskBulkList&&(self.taskBulkList.filter((function(task){var data={id:task.id,inputValue:task.inputValue,inputValues:task.inputValues,remarks:task.remarks,readingFieldId:task.readingFieldId};task.inputTime>0&&(data.inputTime=self.$helpers.getTimeInOrg(task.inputTime)),taskListContext.push(data)})),taskListContext&&self.updateTaskList({taskContextList:taskListContext},doValidation))},updateTaskList:function(data){var doValidation=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.taskBulkList=[],this.waitBoolean=!1;var self=this;self.$http.post("/task/updateAllTask?doValidation=".concat(doValidation),data).then((function(response){if("object"===(0,esm_typeof/* default */.Z)(response.data)){if(self.waitBoolean=!0,self.noOfUpdatedTAsk=self.noOfUpdatedTAsk+response.data.rowsUpdated,"undefined"!==typeof response.data.error&&response.data.error?(data.taskContextList.forEach((function(datum){datum.id in response.data.error||(self.$set(self.errorMap,datum.id,!1),self.$set(self.errorMessage,datum.id,null))})),Object.assign(self.errorQue,response.data.error)):data.taskContextList.forEach((function(datum){self.$set(self.errorMap,datum.id,!1),self.$set(self.errorMessage,datum.id,null)})),self.taskBulkList.length>0)return void self.asyncTaskUpdate(doValidation);self.$message({showClose:!0,message:self.noOfUpdatedTAsk+self.$t("maintenance._workorder.task_updated_success"),type:"success"}),self.noOfUpdatedTAsk=0,"Work in Progress"!==self.ticketstatusvalue&&(self.workorder.status.id=self.getTicketStatusByLabel("Work in Progress","workorder").id),Object.keys(self.errorQue).length>0&&self.$dialog.confirm({title:self.$t("_workoder.add_readings"),message:self.$t("_workoder.add_readings_message"),rbDanger:!0,rbLabel:self.$t("maintenance._workorder.save")}).then((function(val){if(val){var tasks=self.newTaskList.map((function(v){return v.taskList})).reduce((function(a,b){return a.concat(b)})).filter((function(v){return v.id in self.errorQue})),taskContextList=[];tasks.forEach((function(t){var data={id:t.id,inputValue:t.inputValue,inputValues:t.inputValues,remarks:t.remarks,readingFieldId:t.readingFieldId};taskContextList.push(data)})),self.errorQue={},self.updateTaskList({taskContextList:taskContextList},!1)}else Object.keys(self.errorQue).forEach((function(key){self.$set(self.errorMessage,key,self.errorQue[key].message),self.$set(self.errorMap,key,!0)}));self.errorQue={}})),self.taskBulkList=[]}else self.$message({showClose:!0,message:this.$t("maintenance._workorder.task_updated_failed"),type:"error"})}))},waitFunc:helpers/* default */.ZP.debounce((function(){this.taskBulkList.length&&this.asyncTaskUpdate()}),5e3),addTask:function(task){var self=this;if(-1!==task.id)this.taskBulkList.push(task),this.asyncTaskUpdate();else{var formData={};if(""===task.subject.trim())return void this.$message({message:this.$t("maintenance._workorder.task_title_required"),type:"error"});if(task.resource.id||delete task.resource,task.assignedTo||delete task.assignedTo,task.readingFieldId||(task.readingFieldId=-1),"5"===task.inputType||"6"===task.inputType){var taskOptions=[];for(var key in task.options){var option=task.options[key];taskOptions[key]=option.name}task.options=taskOptions}task.parentTicketId=self.workorder.id,formData.task=task,self.$http.post("/task/add",formData).then((function(response){task.id=response.data.taskId,self.tasks.push(task),self.newTask={subject:"",description:"",resource:{id:-1},isReadingTask:!1,readingFieldId:-1,options:[],taskType:-1,enableInput:!1,attachmentRequired:!1,id:-1}}));var TaskAddedmsg=quasar_esm/* Alert */.bZ.create({html:self.$t("maintenance._workorder.task_added_success"),color:"positive",position:"top-center"});setTimeout((function(){TaskAddedmsg.dismiss()}),1500)}},addTaskOption:function(selectedTask){selectedTask.options.push({name:""})},getPMType:function(type){return this.tickettype[type]},addNewTask:function(){this.selectedTask&&""!==this.selectedTask.subject&&this.addTask(this.selectedTask);var lastSection=-1;for(var key in this.taskList)this.taskList.hasOwnProperty(key)&&(-1!==key||-1===key&&1===Object.keys(this.taskList).length)&&(lastSection=key);this.newTask={subject:"",description:"",resource:{id:-1},isReadingTask:!1,readingFieldId:null,options:[],taskType:-1,enableInput:!1,inputType:1,attachmentRequired:!1,status:{type:"OPEN",typeCode:1,id:-1},id:-1,sectionId:lastSection},this.taskList[lastSection]||(this.taskList[lastSection]=[]),this.taskList[lastSection].push(this.newTask),this.showTaskDetails(this.newTask)},checkAndShowTask:function(task){this.showAddTask&&this.showTaskDetails(task)},checkOptionsLength:function(options){return options.length<=2&&!options.some((function(option){return option.length>10}))},onSelectInput:function(){"2"===this.selectedTask.inputType&&this.fillTaskReadings()},fillTaskReadings:function(){var _this3=this;if(this.selectedTask.resource&&2===this.selectedTask.resource.resourceType&&this.selectedTask.resource.category){var url="/reading/getassetreadings?parentCategoryId="+this.selectedTask.resource.category.id;this.$http.get(url).then((function(response){var _step,readings=response.data,_iterator=(0,createForOfIteratorHelper/* default */.Z)(readings);try{for(_iterator.s();!(_step=_iterator.n()).done;){var _step2,reading=_step.value,_iterator2=(0,createForOfIteratorHelper/* default */.Z)(reading.fields);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var field=_step2.value;_this3.taskReadingFields.push(field)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}}catch(err){_iterator.e(err)}finally{_iterator.f()}}))}else if(this.selectedTask.resource){var parentCategoryId=-1;self.selectedTask.resource.category&&(parentCategoryId=self.selectedTask.resource.category.id);var _url="/reading/getwospacereadings?parentCategoryId="+parentCategoryId;this.$http.get(_url).then((function(response){var _step3,readings=response.data,_iterator3=(0,createForOfIteratorHelper/* default */.Z)(readings);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var _step4,reading=_step3.value,_iterator4=(0,createForOfIteratorHelper/* default */.Z)(reading.fields);try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var field=_step4.value;self.taskReadingFields.push(field)}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}}))}},showTaskDetails:function(task){this.showAddTask=!0,this.selectedTask=task},focusCommentBox:function(){this.$refs.commentBoxRef.focus(),this.commentFocus=!0},blurCommentBox:function(e){var itTargetPar=e.path.filter((function(ele){if("commentBoxPar"===ele.id)return!0}));this.newComment.body&&""!==this.newComment.body.trim()||itTargetPar.length||(this.commentFocus=!1)},addComment:function(){if(this.newComment.body){var _self=this;_self.$http.post("/note/add",{note:_self.newComment,module:"ticketnotes",parentModuleName:"workorder"}).then((function(response){_self.comments.push(response.data.note),_self.reset(),_self.commentFocus=!1,_self.$refs["activitiesDiv"]&&_self.$refs["activitiesDiv"].loadActivities()}))}},loadactivitie:function(){this.$refs["activitiesDiv"]&&this.$refs["activitiesDiv"].loadActivities()},reset:function(){this.newComment={parentModuleLinkName:"ticketnotes",parentId:this.$route.params.id,body:null,notifyRequester:!1}},loadComments:function(){var self=this;return self.loading=!0,this.$http.get("/note/get?module=ticketnotes&parentId="+this.$route.params.id).then((function(response){self.loading=!1,self.comments=response.data?response.data:[]})).catch((function(error){error&&(self.loading=!1,self.comments=[])}))},sort:function(arr){for(var len=arr.length,i=len-1;i>=0;i--)for(var j=1;j<=i;j++)if(arr[j-1].seq>arr[j].seq){var temp=arr[j-1];arr[j-1]=arr[j],arr[j]=temp}return arr},loadTasks:function(){var self=this;return self.loading=!0,this.$http.get("/task?module=task&recordId="+this.$route.params.id).then((function(response){if(self.loading=!1,-1!==response.data.tasks[Object.keys(response.data.tasks)[0]][0].sequence){var unsorted=[];Object.keys(response.data.tasks).forEach((function(key){unsorted.push({secId:key,seq:response.data.tasks[key][0].sequence})}));var sorted=self.sort(unsorted),newTaskList=[];sorted.forEach((function(ele){newTaskList.push({sectionId:ele.secId,taskList:response.data.tasks[ele.secId]})})),newTaskList=newTaskList.map((function(obj,objInx){var tasks=obj.taskList.map((function(task,index){return task.status&&task.status.id!==self.openStatusId?task.status={type:"CLOSED",typeCode:2,id:self.closedStatusId}:task.status={type:"OPEN",typeCode:1,id:self.openStatusId},-1===task.inputTime&&(task.inputTime=null),task}));return obj.taskList=tasks,obj})),self.newTaskList=newTaskList,self.sequencedData=!0}else self.sequencedData=!1;for(var idx in self.taskList=response.data.tasks?response.data.tasks:{},self.taskList)for(var idx2 in self.taskList[idx])self.taskList[idx][idx2].status&&self.taskList[idx][idx2].status.id!==self.openStatusId?self.taskList[idx][idx2].status={type:"CLOSED",typeCode:2,id:self.closedStatusId}:self.taskList[idx][idx2].status={type:"OPEN",typeCode:1,id:self.openStatusId},-1===self.taskList[idx][idx2].inputTime&&(self.taskList[idx][idx2].inputTime=null);self.sections=response.data.sections?response.data.sections:{}})).catch((function(error){error&&(self.loading=!1,self.tasks=[])}))},workorderstatus:function(id){var priority=this.getTicketPriority(id);return priority||""},closedisplay:function(){this.showAddTask=!1},ticketstatusvalue:function(id){if(null!==id){var status=this.$store.getters.getTicketStatus(id,"workorder").status;return status||""}return""},assignWorkOrder:function(assignedTo,assignmentGroup){var self=this,assignObj={};assignObj.id=[this.workorder.id],assignedTo&&(assignObj.assignedTo=assignedTo),assignmentGroup&&(assignObj.assignmentGroup=assignmentGroup),assignObj.status={id:this.getTicketStatusByLabel("Assigned","workorder").id,status:"Assigned"},self.$store.dispatch("workorder/assignWorkOrder",assignObj).then((function(){self.$dialog.notify(self.$t("maintenance._workorder.wo_assigned_success")),self.loadactivitie(),self.fetchWo(!0)}))},updateWorkOrderDueDate:function(idList,datetime){var _this4=this,updateObj={id:idList,fields:{dueDate:datetime}};this.$store.dispatch("workorder/updateWorkOrder",updateObj).then((function(response){_this4.loading=!0,_this4.$message.success(_this4.$t("maintenance._workorder.wo_duedate_update_success")),_this4.loading=!1,_this4.fetchWo(!0)})).catch((function(){_this4.$message.error("Workorder Due Date updation failed")}))},updateWorkOrder:function(idList,field,actualTimings){var _this5=this,updateObj={id:idList,fields:field,actualTimings:actualTimings};this.$store.dispatch("workorder/updateWorkOrder",updateObj).then((function(response){_this5.$message.success(_this5.$t("maintenance._workorder.wo_update_success")),_this5.fetchWo(!0),_this5.loadactivitie()})).catch((function(){_this5.$message.error(_this5.$t("maintenance._workorder.wo_update_failed"))}))},resolveWorkOrder:function(idList,actualWorkDuration,actualTimings,statusField){var _this6=this,updateObj={id:idList};actualWorkDuration>0&&(updateObj.actualWorkDuration=actualWorkDuration,updateObj.actualTimings=actualTimings),this.$store.dispatch("workorder/resolve",updateObj).then((function(response){_this6.$message.success(_this6.$t("maintenance._workorder.wo_resolved_success")),_this6.loading=!1,_this6.fetchWo(!0),_this6.loadactivitie()})).catch((function(){_this6.$message.error(_this6.$t("maintenance._workorder.wo_resolved_failed"))}))},updateStatus:function(status){var self=this;if("On Hold"!==status)return"Resolved"===status&&self.workorder.isWorkDurationChangeAllowed?(self.workDurationCallBack=self.setStatusUpdate.bind(self,status),void(self.showWorkDurationDialog=!0)):void self.setStatusUpdate(status);self.rejectWorkOrderDialog()},rejectWorkOrderDialog:function(){var self=this,promptObj={title:self.$t("maintenance._workorder.wo_pause_title"),message:self.$t("maintenance._workorder.wo_pause_message"),promptType:"textarea",promptPlaceholder:self.$t("maintenance._workorder.wo_pause_message_area"),rbDanger:!0,rbLabel:self.$t("maintenance._workorder.pause")};self.$dialog.prompt(promptObj).then((function(value){if(null!==value){var newComments={parentModuleLinkName:"ticketnotes",parentId:self.workorder.id,body:value,notifyRequester:!1};self.setStatusUpdate("On Hold"),self.$http.post("/note/add",{note:newComments,module:"ticketnotes",ticketModuleName:"workorder"}).then((function(response){self.comments.push(response.data.note),self.reset(),self.loadactivitie()}))}}))},setStatusUpdate:function(status,actualDuration){var self=this,statusField={id:this.getTicketStatusByLabel(status,"workorder").id,status:status},paramObj={status:statusField},workTimings=[],duration=-1;actualDuration&&(workTimings=actualDuration.workTimings,duration=actualDuration.duration),"Resolved"===status?self.resolveWorkOrder([this.workorder.id],duration,workTimings,statusField):status&&(self.updateWorkOrder([this.workorder.id],paramObj,workTimings),self.workorder.status=statusField)},closeWO:function(){if(this.checkInputTasksCompletion())return this.workorder.isWorkDurationChangeAllowed&&"Resolved"!==this.ticketStatusValue?(this.workDurationCallBack=this.closeWorkOrder.bind(this),void(this.showWorkDurationDialog=!0)):void this.closeWorkOrder()},closeWorkOrder:function(actualDuration){var _this7=this,paramObj={id:[this.workorder.id]};actualDuration&&-1!==actualDuration.duration&&(paramObj.actualWorkDuration=actualDuration.duration),this.$store.dispatch("workorder/closeWorkOrder",paramObj).then((function(response){_this7.$message.success(_this7.$t("maintenance._workorder.wo_closed_success")),_this7.closeSummary()})).catch((function(){_this7.$message.error(_this7.$t("maintenance._workorder.wo_close_error_failed"))}))},checkInputTasksCompletion:function(){for(var idx in this.taskList)if(this.taskList.hasOwnProperty(idx)){var check=this.taskList[idx].some((function(task){return"OPEN"===task.status.type}));if(check)return this.$message({message:this.$t("maintenance._workorder.wo_resolved_failed"),type:"warning"}),!1}return!0},closeSummary:function(){this.summoryview=!1;var newpath=this.$route.path.substring(0,this.$route.path.indexOf("/summary/"));this.$router.replace({path:newpath})},selectSubSection:function(section){this.subSection=section},selectSummarySection:function(section){this.summarySection=section}},components:{Avatar:Avatar["default"],UserAvatar:User/* default */.Z,Attachments:SummaryAttachment/* default */.Z,Activities:Activities2/* default */.Z,QIcon:quasar_esm/* QIcon */.oF,QList:quasar_esm/* QList */.tu,QItem:quasar_esm/* QItem */.ry,QItemMain:quasar_esm/* QItemMain */.Ui,QPopover:quasar_esm/* QPopover */.oe,AssetAvatar:Asset["default"],FDialog:FDialogNew/* default */.Z,TaskSpaceAssetChooser:SpaceAssetChooser/* default */.Z,MobileAttachment:MobileAttachment2/* default */.Z,FAssignment:FAssignment/* default */.Z,WorkHours:WorkHours/* default */.Z,ApproveReject:ApproveReject/* default */.Z},filters:{getUser:function(id,users){var userObj=users.find((function(user){return user.id===id}));return userObj||{name:"System"}},options:function(jsonobj,type){var array=[];if("category"===type||"priority"===type)for(var jsonkey in jsonobj){var val=jsonobj[jsonkey];array.push({label:val,value:parseInt(jsonkey)})}else if("user"===type||"space"===type)for(var key in jsonobj)array.push({label:jsonobj[key].name,value:jsonobj[key].id});return array}}},approval_ApprovalSummaryFullViewvue_type_script_lang_js=ApprovalSummaryFullViewvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(approval_ApprovalSummaryFullViewvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,ApprovalSummaryFullView=component.exports},
/***/16297:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return WorkHours}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/workorder/widgets/dialogs/WorkHours.vue?vue&type=template&id=4efda2fd
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"duration-dialog setup-dialog",attrs:{visible:_vm.showDialog,width:"40%"},on:{"update:visible":function($event){_vm.showDialog=$event}}},[_c("div",{staticClass:"new-header-container"},[_c("div",{staticClass:"new-header-text"},[_c("div",{staticClass:"fc-setup-modal-title"},[_vm._v("Set Work Hours")])])]),_c("div",{staticClass:"duration-body-scroll"},[_vm.id&&-1!=_vm.id?_c("div",[_c("div",{staticClass:"fc-dark-grey-txt14"},[_vm._v("Estimated Duration")]),_c("el-row",{staticClass:"el-row"},[_vm.estimatedDuration.days?_c("div",{staticClass:"el-col el-col-7"},[_vm._v(" "+_vm._s(_vm.estimatedDuration.days+" Days")+" ")]):_vm._e(),_c("div",{staticClass:"el-col el-col-11"},[_vm._v(" "+_vm._s(_vm.estimatedDuration.hours+" Hour"+(_vm.estimatedDuration.hours>1?"s":""))+" ")])])],1):_vm._e(),_c("div",[_c("duration",{staticClass:"fc-dark-grey-txt14",attrs:{label:"Work Hours"},model:{value:_vm.actualDuration,callback:function($$v){_vm.actualDuration=$$v},expression:"actualDuration"}})],1)]),_c("div",{staticClass:"modal-dialog-footer"},[_c("span",{attrs:{slot:"footer"},slot:"footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.close}},[_vm._v("CANCEL")]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:_vm.setDuration}},[_vm._v("SET")])],1)])])},staticRenderFns=[],FWorkHourDurationvue_type_template_id_630dc428_render=(__webpack_require__(897389),function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("div",{class:_vm.labelClass},[_vm._v(_vm._s(_vm.label?_vm.label:"Duration"))]),_c("el-row",{attrs:{gutter:10}},[_vm._t("prefix"),_c("el-col",{attrs:{span:"l"==_vm.size?8:5}},[_c("el-input",{staticStyle:{width:"37%"},attrs:{type:"number",min:"0"},on:{change:function($event){return _vm.updateDuration("manual-entry")}},model:{value:_vm.duration.day,callback:function($$v){_vm.$set(_vm.duration,"day",$$v)},expression:"duration.day"}}),_c("span",{staticClass:"textcolor pL10"},[_vm._v("Day(s)")])],1),_c("el-col",{attrs:{span:11}},[_c("el-select",{staticStyle:{width:"50%"},on:{change:function($event){return _vm.updateDuration("manual-entry")}},model:{value:_vm.duration.hour,callback:function($$v){_vm.$set(_vm.duration,"hour",$$v)},expression:"duration.hour"}},_vm._l(_vm.getNumberRange(23),(function(hour){return _c("el-option",{key:hour.value,attrs:{label:hour.label,value:hour.value}})})),1),_c("span",{staticClass:"textcolor pL10"},[_vm._v("Hour(s)")])],1)],2),_vm._l(_vm.workTimings,(function(v,i){return _c("el-row",{key:i},[_c("div",{staticClass:"creteria-delete-new"},[_c("el-date-picker",{attrs:{type:"datetimerange","start-placeholder":"Start Time","end-placeholder":"End Time",format:"yyyy-MM-dd HH","value-format":"timestamp","range-separator":"To"},on:{change:function($event){return _vm.updateDuration("split")}},model:{value:_vm.workTimings[i],callback:function($$v){_vm.$set(_vm.workTimings,i,$$v)},expression:"workTimings[i]"}}),_vm.workTimings.length===parseInt(i)+1?_c("img",{staticClass:"delete-icon",staticStyle:{height:"18px",width:"37px"},attrs:{src:__webpack_require__(353654)},on:{click:_vm.addTiming}}):_vm._e(),0!==i?_c("img",{staticClass:"delete-icon",staticStyle:{height:"18px",width:"18px","margin-right":"3px"},attrs:{src:__webpack_require__(385769)},on:{click:function($event){return _vm.deleteTiming(i)}}}):_vm._e()],1)])}))],2)}),FWorkHourDurationvue_type_template_id_630dc428_staticRenderFns=[],moment_timezone=(__webpack_require__(670560),__webpack_require__(879288),__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(162506),__webpack_require__(480008)),moment_timezone_default=__webpack_require__.n(moment_timezone),FWorkHourDurationvue_type_script_lang_js={props:["value","label","labelClass","format","size"],data:function(){return{duration:{day:0,hour:0},workTimings:[],now:moment_timezone_default()()}},watch:{duration:{handler:function(){this.onValueChange()},deep:!0}},mounted:function(){this.workTimings.push([Number(this.now.format("x")),Number(this.now.format("x"))]);var unwatch=this.$watch("value",(function(value){if(value&&-1!==value.duration){var duration=value.duration,factor=1;factor="h"===this.format?1:3600;var days=Math.floor(duration/(24*factor));duration-=24*days*factor;var hours=Math.floor(duration/factor);this.duration.day=days,this.duration.hour=hours,unwatch()}}),{immediate:!0})},methods:{updateDuration:function(val){if("manual-entry"===val){var start=this.now.clone().subtract(this.duration.day,"days").subtract(this.duration.hour,"hours");this.workTimings=[[Number(start.format("x")),Number(this.now.format("x"))]],this.onValueChange()}else"split"===val&&this.setDuration(this.workTimings)},setDuration:function(val){var totalDuration=moment_timezone_default().duration(0);val.forEach((function(e){if(0!==e.length){var duration=moment_timezone_default().duration(moment_timezone_default()(e[1],"x").diff(moment_timezone_default()(e[0],"x")));totalDuration.add(duration)}})),this.$set(this.duration,"day",totalDuration.get("days")),this.$set(this.duration,"hour",totalDuration.get("hours"))},addTiming:function(){this.workTimings.push([])},deleteTiming:function(i){this.workTimings.splice(i,1)},getNumberRange:function(no){for(var list=[],i=0;i<=no;i++)list.push({label:i+"",value:i});return list},onValueChange:function(){var factor=1;factor="h"===this.format?1:3600;var duration=24*this.duration.day*factor;duration+=this.duration.hour*factor,duration=duration||-1,this.$emit("input",{workTimings:this.workTimings,duration:duration})}}},components_FWorkHourDurationvue_type_script_lang_js=FWorkHourDurationvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FWorkHourDurationvue_type_script_lang_js,FWorkHourDurationvue_type_template_id_630dc428_render,FWorkHourDurationvue_type_template_id_630dc428_staticRenderFns,!1,null,null,null)
/* harmony default export */,FWorkHourDuration=component.exports,WorkHoursvue_type_script_lang_js={props:["visible","id","callback"],components:{Duration:FWorkHourDuration},data:function(){return{showDialog:this.visible,estimatedDuration:{hours:0,days:0},actualDuration:null}},watch:{visible:{handler:function(val){val&&this.getEstimatedDuration()},immediate:!0},showDialog:function(val){this.$emit("update:visible",val)}},methods:{getEstimatedDuration:function(){var _this=this;this.id&&-1!==this.id&&this.$http.get("/workorder/getEstimatedWorkDuration?workOrderId="+this.id).then((function(response){if(response&&response.data){var duration=response.data.estimatedDuration;if(duration&&-1!==duration){var days=Math.floor(duration/86400);duration-=86400*days;var hours=(duration/3600).toFixed(2);_this.estimatedDuration.days=days,_this.estimatedDuration.hours=hours}}}))},setDuration:function(){this.callback&&this.callback(this.actualDuration)},close:function(){this.showDialog=!1}}},dialogs_WorkHoursvue_type_script_lang_js=WorkHoursvue_type_script_lang_js,WorkHours_component=(0,componentNormalizer/* default */.Z)(dialogs_WorkHoursvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,WorkHours=WorkHours_component.exports},
/***/365565:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"d022638208d4baab3e4d8fbec8ac38ca.svg";
/***/},
/***/250620:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"03daa5e7a5fe4964f41cd5e0c6dbcdb3.svg";
/***/},
/***/539884:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"0583a4b2baa10f449134fd3347e2951c.svg";
/***/},
/***/984428:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"a85b3ab9b3b686b8b23bf9622ab18495.svg";
/***/},
/***/222223:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"d236c969d897fa58eea8bbdad6f29b83.svg";
/***/},
/***/304081:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"3a0872133bc8c3376d8fc7012d1c157f.svg";
/***/},
/***/164065:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"ee31f43b8151f3590eba8e0562377413.svg";
/***/},
/***/703659:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"782922838e1b33e6568fd666d379c2b8.svg";
/***/},
/***/916803:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"45e80daecf3b2313cd875b1056bb278b.svg";
/***/},
/***/942577:
/***/function(module,__webpack_exports__,__webpack_require__){"use strict";
/* harmony import */var _Users_abishekrakavel_Desktop_facilioClient_facilio_client_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(595082),_Avatar__WEBPACK_IMPORTED_MODULE_5__=(__webpack_require__(434284),__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(538077),__webpack_require__(574752)),vuex__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(420629);
/* harmony import */
/* module decorator */module=__webpack_require__.hmd(module),
/* harmony default export */__webpack_exports__.Z={props:["record","serviceportal"],data:function(){return{activities:[],loading:!0}},components:{Avatar:_Avatar__WEBPACK_IMPORTED_MODULE_5__["default"]},mounted:function(){this.serviceportal?this.loadServicePortalActivities():this.loadActivities()},watch:{record:function(){this.serviceportal?this.loadServicePortalActivities():this.loadActivities()}},computed:(0,_Users_abishekrakavel_Desktop_facilioClient_facilio_client_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */.Z)({},(0,vuex__WEBPACK_IMPORTED_MODULE_6__/* .mapGetters */.Se)(["getUser"])),methods:{getUserCall:function(names){return this.serviceportal&&this.$account.user.id===names?this.$account.user.name:this.getUser(names).name},getAssignedBy:function(updatedFields){var user=updatedFields.find((function(el){return"assignedTo"===el.fieldName}));return user.newValue?this.getUser(user.newValue.id).name:user.oldValue?this.getUser(user.oldValue.id).name:void 0},getMessage:function(activity){if(131072===activity.activityType)return{message:activity.message};if(2===activity.activityType){if(activity.info.updatedFields&&activity.info.updatedFields.length>0){if(activity.info.updatedFields.find((function(el){return"category"===el.fieldName}))&&"category"===activity.info.updatedFields.find((function(el){return"category"===el.fieldName})).fieldName)return{message:"updated category as",value:activity.info.updatedFields.find((function(el){return"category"===el.fieldName})).newValue};if(activity.info.updatedFields.find((function(el){return"priority"===el.fieldName}))&&"priority"===activity.info.updatedFields.find((function(el){return"priority"===el.fieldName})).fieldName)return{message:"updated priority as",value:activity.info.updatedFields.find((function(el){return"priority"===el.fieldName})).newValue};if(activity.info.updatedFields.find((function(el){return"actualWorkStart"===el.fieldName}))&&"actualWorkStart"===activity.info.updatedFields.find((function(el){return"actualWorkStart"===el.fieldName})).fieldName||activity.info.updatedFields.find((function(el){return"resumedWorkStart"===el.fieldName}))&&"resumedWorkStart"===activity.info.updatedFields.find((function(el){return"resumedWorkStart"===el.fieldName})).fieldName)return{message:"started work"};if(activity.info.updatedFields.find((function(el){return"actualWorkEnd"===el.fieldName}))&&"actualWorkEnd"===activity.info.updatedFields.find((function(el){return"actualWorkEnd"===el.fieldName})).fieldName)return{message:"resolved work"};if(activity.info.updatedFields.find((function(el){return"dueDateString"===el.fieldName}))&&"dueDateString"===activity.info.updatedFields.find((function(el){return"dueDateString"===el.fieldName})).fieldName)return{message:"updated Due Date as",value:activity.info.updatedFields.find((function(el){return"dueDateString"===el.fieldName})).newValue};if(activity.info.updatedFields.find((function(el){return"type"===el.fieldName}))&&"type"===activity.info.updatedFields.find((function(el){return"type"===el.fieldName})).fieldName)return{message:"updated Type as",value:activity.info.updatedFields.find((function(el){return"type"===el.fieldName})).newValue};if(activity.info.updatedFields.find((function(el){return"status"===el.fieldName}))&&"status"===activity.info.updatedFields.find((function(el){return"status"===el.fieldName})).fieldName)return{message:"pause the work"}}}else if(16384===activity.activityType){if(activity.info.updatedFields.length>0){if(activity.info.updatedFields.find((function(el){return"remarks"===el.fieldName}))&&"remarks"===activity.info.updatedFields.find((function(el){return"remarks"===el.fieldName})).fieldName)return{message:"updated task ("+activity.info.task.subject+") remarks as",value:activity.info.updatedFields.find((function(el){return"remarks"===el.fieldName})).newValue};if(activity.info.updatedFields.find((function(el){return"inputValue"===el.fieldName}))&&"inputValue"===activity.info.updatedFields.find((function(el){return"inputValue"===el.fieldName})).fieldName)return{message:"updated task ("+activity.info.task.subject+") input Value as",value:activity.info.updatedFields.find((function(el){return"inputValue"===el.fieldName})).newValue}}}else{if(128===activity.activityType)return activity.info.attachments?{message:"attached",value:this.getAttachmentsString(activity.info.attachments)}:{message:"attached",value:null};if(256===activity.activityType)return{message:"added the task",value:activity.info.task};if(72===(activity||{}).type){
// Approval Activity Message
var approvalMessage="",approvalStatus=this.$getProperty(activity,"info.status",""),moduleSingularDisplayName=this.$constants.moduleSingularDisplayNameMap[module]?this.$constants.moduleSingularDisplayNameMap[module]:module;return"Approved"===approvalStatus?approvalMessage="<b> Approved the ".concat(moduleSingularDisplayName,"</b>"):"Rejected"===approvalStatus?approvalMessage="<b> Rejected the ".concat(moduleSingularDisplayName,"</b>"):"Requested"===approvalStatus&&(approvalMessage="<b> resent for Approval.</b>"),{message:approvalMessage}}if(73===(activity||{}).type)return{message:"<b> initiated Approval process</b>"}}return{message:activity.message}},loadActivities:function(){var self=this;self.loading=!0,self.$http.get("/workorder/activities?workOrderId="+self.record.id).then((function(response){self.activities=response.data.filter((function(activity){return 16!==activity.activityType||activity.info.updatedFields&&activity.info.updatedFields.length>0&&activity.info.updatedFields.find((function(el){return"assignedTo"===el.fieldName}))})),self.loading=!1})).catch((function(){}))},loadServicePortalActivities:function(){var self=this;self.loading=!0,self.$http.get("/activities?workOrderRequestId="+self.record.id).then((function(response){self.activities=response.data,self.loading=!1}))},getAttachmentsString:function(obj){for(var str="",item=0;item<obj.length;item++)0!==item&&(item===obj.length-1?str+=" and ":str+=", "),str+=obj[item];return str}}}}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/24784.js.map