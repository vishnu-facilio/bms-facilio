"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[98850],{
/***/297157:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return ErrorBanner}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/ErrorBanner.vue?vue&type=template&id=3d9e5288
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_vm.hasError?_c("div",{staticClass:"error-block",attrs:{id:"error"}},[_c("p",{staticClass:"error-txt"},[_c("i",{staticClass:"fa fa-info-circle",attrs:{"aria-hidden":"true"}}),_vm._v(" "+_vm._s(_vm.errorMessage?_vm.errorMessage:"Please fill all mandatory fields.")+" ")]),_c("i",{staticClass:"el-icon-close error-close-icon",on:{click:_vm.closeBanner}})]):_vm._e()])},staticRenderFns=[],ErrorBannervue_type_script_lang_js={props:["error","errorMessage"],computed:{hasError:{get:function(){return this.error},set:function(value){this.$emit("update:error",value)}}},methods:{closeBanner:function(){this.hasError=!1,this.$emit("update:errorMessage","")}}},components_ErrorBannervue_type_script_lang_js=ErrorBannervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_ErrorBannervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,ErrorBanner=component.exports},
/***/798850:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return AssetCostDetails}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/page/widget/cost/AssetCostDetails.vue?vue&type=template&id=98eee6ee&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("portal",{attrs:{to:_vm.widget.key+"-title-section"}},[_c("div",{staticClass:"widget-header d-flex flex-direction-row justify-content-space mB15 mT5"},[_c("div",{staticClass:"widget-header-name"},[_vm._v("ASSET COST DETAILS")]),!_vm.$validation.isEmpty(_vm.getFieldData)||_vm.loading||_vm.decommission?_vm._e():_c("div",{staticClass:"fc-pink f13 pointer",on:{click:function($event){_vm.showAddDepreciationForm=!0}}},[_c("inline-svg",{staticClass:"vertical-middle mR5",attrs:{src:"svgs/add",iconClass:"icon icon-xs"}}),_vm._v(" Apply Depreciation ")],1)])]),_c("div",[_vm.loading?_c("div",{staticClass:"container"},_vm._l([1,2,3,4,5],(function(index){return _c("div",{key:index,staticClass:"field"},[_c("el-row",[_c("el-col",{attrs:{span:12}},[_c("span",{staticClass:"lines loading-shimmer"})]),_c("el-col",{attrs:{span:12}},[_c("span",{staticClass:"lines loading-shimmer"})])],1)],1)})),0):_vm.$validation.isEmpty(_vm.getFieldData)?_c("div",{staticClass:"mT20",staticStyle:{color:"#324056"}},[_c("div",{staticClass:"d-flex flex-direction-column text-center"},[_c("inline-svg",{attrs:{src:"svgs/emptystate/reportlist",iconClass:"icon text-center icon-100"}}),_c("div",{staticClass:"nowo-label f13"},[_vm._v(" No depreciation schedules configured ")])],1)]):_c("div",{staticClass:"container"},_vm._l(_vm.getFieldData,(function(fieldValue,displayName,index){return _c("div",{key:index,staticClass:"field"},[_c("el-row",{staticClass:"d-flex"},[_c("el-col",{staticClass:"field-label mL20 mR20",attrs:{span:12}},[_vm._v(" "+_vm._s(displayName)+" ")]),_c("el-col",{staticClass:"field-value mL20 mR20",attrs:{span:12}},[_vm._v(" "+_vm._s(fieldValue)+" ")])],1)],1)})),0)]),_vm.showAddDepreciationForm?_c("depreciation-form",{attrs:{asset:_vm.details},on:{fetchAssetDetail:function($event){return _vm.init()},onClose:function($event){_vm.showAddDepreciationForm=!1}}}):_vm._e()],1)},staticRenderFns=[],objectSpread2=__webpack_require__(595082),api=(__webpack_require__(434284),__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(976801),__webpack_require__(634338),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(32284)),vuex_esm=__webpack_require__(420629),validation=__webpack_require__(990260),moment_timezone=__webpack_require__(480008),moment_timezone_default=__webpack_require__.n(moment_timezone),AddDepreciationForm=__webpack_require__(328955),AssetCostDetailsvue_type_script_lang_js={props:["details","widget"],data:function(){return{loading:!1,depreciation:null,showAddDepreciationForm:!1}},components:{DepreciationForm:AddDepreciationForm/* default */.Z},created:function(){this.init()},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({metaInfo:function(state){return state.view.metaInfo}})),{},{decommission:function(){return this.$getProperty(this,"details.decommission",!1)},expectedLife:function(){var _ref=this.depreciation||{},frequencyType=_ref.frequencyType,frequency=_ref.frequency;if(!(0,validation/* isEmpty */.xb)(frequency)&&!(0,validation/* isEmpty */.xb)(frequencyType)){if(1===frequencyType){var years=parseInt(frequency/12),months=frequency%12,expectedLife="";return expectedLife+=years?"".concat(years," Year(s) "):"",expectedLife+=months?"".concat(months," Month(s)"):"",expectedLife}if(2===frequencyType){var _years=parseInt(frequency/4),_months=frequency%4*3,_expectedLife="";return _expectedLife+=_years?"".concat(_years," Year(s) "):"",_expectedLife+=_months?"".concat(_months," Month(s)"):"",_expectedLife}if(3===frequencyType){var _years2=parseInt(frequency/2),_months2=frequency%2*6,_expectedLife2="";return _expectedLife2+=_years2?"".concat(_years2," Year(s) "):"",_expectedLife2+=_months2?"".concat(_months2," Month(s)"):"",_expectedLife2}if(4===frequencyType)return"".concat(frequency," Year(s)")}return"---"},constructRemainingTime:function(){var depreciation=this.depreciation,details=this.details,fields=this.$getProperty(this.metaInfo,"fields",null);if(!(0,validation/* isEmpty */.xb)(depreciation)&&!(0,validation/* isEmpty */.xb)(fields)){var constructExpectedLife,startDateField=details[(fields.find((function(field){return field.id===depreciation.startDateFieldId}))||{}).name||""],expiredTime=moment_timezone_default().duration(new Date-startDateField),frequencyType=depreciation.frequencyType,frequency=depreciation.frequency;if(1===frequencyType)constructExpectedLife=moment_timezone_default().duration(frequency,"M");else if(2===frequencyType){var years=parseInt(frequency/4),months=frequency%4*3;constructExpectedLife=moment_timezone_default().duration({M:months,y:years})}else if(3===frequencyType){var _years3=parseInt(frequency/2),_months3=frequency%2*6;constructExpectedLife=moment_timezone_default().duration({M:_months3,y:_years3})}else 4===frequencyType&&(constructExpectedLife=moment_timezone_default().duration(frequency,"y"));var remainingTime=constructExpectedLife.subtract(expiredTime),_ref2=remainingTime||{},_ref2$_data=_ref2._data,_data=void 0===_ref2$_data?{}:_ref2$_data,remainingPeriod="";if(remainingPeriod+=_data.years>0?"".concat(_data.years," Year(s) "):"",remainingPeriod+=_data.months>0?"".concat(_data.months," Month(s)"):"",!(0,validation/* isEmpty */.xb)(remainingPeriod))return remainingPeriod}return"---"},getFieldData:function(){var fieldData={},depreciation=this.depreciation,details=this.details,$currency=this.$currency,fields=this.$getProperty(this.metaInfo,"fields",null);if(!(0,validation/* isEmpty */.xb)(depreciation)&&!(0,validation/* isEmpty */.xb)(fields)){fieldData["Current Price"]=(0,validation/* isEmpty */.xb)(details.currentPrice)?"---":["$","₹"].includes($currency)?"".concat($currency).concat(details.currentPrice):"".concat(details.currentPrice).concat($currency),fieldData["Total Price"]=(0,validation/* isEmpty */.xb)(details.unitPrice)?"---":["$","₹"].includes($currency)?"".concat($currency).concat(details.unitPrice):"".concat(details.unitPrice).concat($currency),fieldData["Salvage Price"]=(0,validation/* isEmpty */.xb)(details.salvageAmount)?["$","₹"].includes($currency)?"".concat($currency,"0"):"0".concat($currency):["$","₹"].includes($currency)?"".concat($currency).concat(details.salvageAmount):"".concat(details.salvageAmount).concat($currency);var startDateField=details[(fields.find((function(field){return field.id===depreciation.startDateFieldId}))||{}).name||""];fieldData["Start Date"]=startDateField?moment_timezone_default()(startDateField).tz(this.$timezone).format("MMM YYYY"):"---",fieldData["Expected Life of Asset"]=this.expectedLife,fieldData["Expected Life Remaining"]=this.constructRemainingTime}return fieldData}}),methods:{init:function(){var _this=this;this.loading=!0,Promise.all([this.$store.dispatch("view/loadModuleMeta","asset"),this.getDepreciation()]).finally((function(){return _this.loading=!1}))},getDepreciation:function(){var _this2=this,url="v2/asset/depreciation/getForAsset",param={assetId:this.details.id};return api/* API */.bl.post(url,param).then((function(_ref3){var data=_ref3.data,error=_ref3.error;error?_this2.$message.error(error.messsage||"Error Occured"):_this2.depreciation=data.assetdepreciation}))}}},cost_AssetCostDetailsvue_type_script_lang_js=AssetCostDetailsvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(cost_AssetCostDetailsvue_type_script_lang_js,render,staticRenderFns,!1,null,"98eee6ee",null)
/* harmony default export */,AssetCostDetails=component.exports},
/***/328955:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return AddDepreciationForm}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/assets/asset/v1/AddDepreciationForm.vue?vue&type=template&id=5ae10516&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("el-dialog",{staticClass:"fc-dialog-center-container",attrs:{visible:!_vm.canShowAddNewForm,title:"Apply Depreciation Schedule",width:"50%",height:"50%","append-to-body":!0,"before-close":_vm.closeDialog}},[_c("error-banner",{attrs:{error:_vm.error,errorMessage:_vm.errorText},on:{"update:error":function($event){_vm.error=$event},"update:errorMessage":function($event){_vm.errorText=$event},"update:error-message":function($event){_vm.errorText=$event}}}),_c("div",{staticClass:"height400 mT15"},[_vm.loading?_c("div",{staticStyle:{"margin-bottom":"22px"}},[_c("span",{staticClass:"lines loading-shimmer width50 height45"})]):_c("el-form",{ref:"depreciationForm",attrs:{rules:_vm.rules,model:_vm.selectedDepreciation}},[_c("el-form-item",{attrs:{prop:"id"}},[_c("div",{staticClass:"d-flex"},[_c("el-select",{staticClass:"fc-input-full-border-select2 width50",attrs:{filterable:"",placeholder:"Select Depreciation Schedule"},model:{value:_vm.selectedDepreciation.id,callback:function($$v){_vm.$set(_vm.selectedDepreciation,"id",$$v)},expression:"selectedDepreciation.id"}},_vm._l(_vm.depreciationList,(function(depreciation){return _c("el-option",{key:depreciation.id,attrs:{label:depreciation.name,value:depreciation.id}})})),1),_c("div",{staticClass:"text-fc-green pointer mL20",on:{click:function($event){_vm.canShowAddNewForm=!0}}},[_c("inline-svg",{staticClass:"vertical-middle pT5",attrs:{src:"add-icon",iconClass:"icon icon-md mR5"}}),_vm._v(" Add New ")],1)],1)])],1),_c("div",{staticClass:"fc-modal-sub-title pB10",staticStyle:{color:"#385571"}},[_vm._v(" Preview ")]),_c("depreciation-schedule",{attrs:{asset:_vm.asset,selectedDepreciationId:_vm.selectedDepreciation.id},on:{appliedDepreciationId:_vm.setDepreciationId,depreciationRel:_vm.setDepreciationRel,error:_vm.errorBanner}}),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.closeDialog}},[_vm._v(" Cancel ")]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.applyingDepreciation},on:{click:function($event){return _vm.submitForm()}}},[_vm._v(" Confirm ")])],1)],1)],1),_vm.canShowAddNewForm?_c("new-asset-depreciation",{on:{onRecordSaved:_vm.addDepreciation,onClose:function($event){_vm.canShowAddNewForm=!1}}}):_vm._e()],1)},staticRenderFns=[],objectSpread2=__webpack_require__(595082),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),NewAssetDepreciation=(__webpack_require__(670560),__webpack_require__(468495)),api=__webpack_require__(32284),ScheduleList=__webpack_require__(849621),ErrorBanner=__webpack_require__(297157),validation=__webpack_require__(990260),AddDepreciationFormvue_type_script_lang_js={props:["asset"],data:function(){return{selectedDepreciation:{id:null},loading:!1,appliedDepreciationId:null,depreciationList:[],canShowAddNewForm:!1,applyingDepreciation:!1,depreciationRelId:null,error:!1,errorText:"",rules:{id:{required:!0,message:"Please select a Depreciation Schedule",trigger:"change"}}}},components:{NewAssetDepreciation:NewAssetDepreciation/* default */.Z,DepreciationSchedule:ScheduleList/* default */.Z,ErrorBanner:ErrorBanner/* default */.Z},created:function(){this.loadDepreciation()},watch:{"selectedDepreciation.id":function(value){value&&(this.error=!1,this.errorText="")}},methods:{loadDepreciation:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var _yield$API$fetchAll,list,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _this.loading=!0,_context.next=3,api/* API */.bl.fetchAll("assetdepreciation");case 3:_yield$API$fetchAll=_context.sent,list=_yield$API$fetchAll.list,error=_yield$API$fetchAll.error,error?_this.$message.error(error.message||"Error Occured"):_this.depreciationList=list,_this.loading=!1;case 8:case"end":return _context.stop()}}),_callee)})))()},addDepreciation:function(depreciation){this.depreciationList.push(depreciation),this.selectedDepreciation.id=depreciation.id},setDepreciationId:function(id){this.appliedDepreciationId=id,this.selectedDepreciation.id=id},setDepreciationRel:function(rel){var _ref=rel||{},id=_ref.id;this.depreciationRelId=id},errorBanner:function(errorMsg){this.error=!0,this.errorText=errorMsg||"Error Occured"},submitForm:function(){var _this2=this;this.$refs["depreciationForm"].validate(function(){var _ref2=(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(valid){var asset,depreciationRelId,param,promise,_ref3,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if(valid){_context2.next=2;break}return _context2.abrupt("return",!1);case 2:if(asset=_this2.asset,depreciationRelId=_this2.depreciationRelId,param={data:{asset:{id:asset.id},depreciation:{id:_this2.selectedDepreciation.id}}},promise={},!(0,validation/* isEmpty */.xb)(depreciationRelId)){_context2.next=11;break}return _context2.next=8,api/* API */.bl.createRecord("assetdepreciationRel",param);case 8:promise=_context2.sent,_context2.next=14;break;case 11:return _context2.next=13,api/* API */.bl.updateRecord("assetdepreciationRel",(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},param),{},{id:depreciationRelId}));case 13:promise=_context2.sent;case 14:_ref3=promise||{},error=_ref3.error,error?_this2.$message.error(error.message||"Error Occured"):(_this2.$message.success(_this2.$t("setup.users_management.Depreciation_scheduled")),_this2.$emit("fetchAssetDetail"),_this2.applyingDepreciation=!1,_this2.closeDialog());case 16:case"end":return _context2.stop()}}),_callee2)})));return function(_x){return _ref2.apply(this,arguments)}}())},closeDialog:function(){this.$emit("onClose")}}},v1_AddDepreciationFormvue_type_script_lang_js=AddDepreciationFormvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(v1_AddDepreciationFormvue_type_script_lang_js,render,staticRenderFns,!1,null,"5ae10516",null)
/* harmony default export */,AddDepreciationForm=component.exports},
/***/468495:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return NewAssetDepreciation}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/setup/depreciation/NewAssetDepreciation.vue?vue&type=template&id=b2639826&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticStyle:{"z-index":"999999"},attrs:{visible:!0,fullscreen:!0,"append-to-body":!0,"custom-class":"fc-dialog-form fc-dialog-right setup-dialog40 setup-dialog","before-close":_vm.closeDialog}},[_c("div",{staticClass:"depreciation-form"},[_c("el-form",{ref:"depreciationForm",staticClass:"fc-form",attrs:{model:_vm.depreciation,rules:_vm.rules,"label-position":"top"}},[_c("div",{staticClass:"new-header-container"},[_c("div",{staticClass:"new-header-text"},[_c("div",{staticClass:"fc-setup-modal-title"},[_vm._v(" "+_vm._s(_vm.id?_vm.$t("common.header.edit_depreciation_schedule"):_vm.$t("common.products.new_depreciation_schedule"))+" ")])])]),_c("div",{staticClass:"new-body-modal enpi-body-modal"},[_c("div",{staticClass:"body-scroll"},[_vm.loading?_c("div",[_vm._l([1,2],(function(index){return _c("div",{key:index},[_c("el-row",{staticClass:"mB10"},[_c("el-col",{attrs:{span:24}},[_c("span",{staticClass:"lines loading-shimmer width50 mB10"}),_c("span",{staticClass:"lines loading-shimmer width100 mB10 height40"})])],1)],1)})),_vm._l([3,4],(function(index){return _c("div",{key:index},[_c("el-row",{staticClass:"mB10 d-flex"},[_c("el-col",{staticClass:"mR10",attrs:{span:12}},[_c("span",{staticClass:"lines loading-shimmer width50"}),_c("span",{staticClass:"lines loading-shimmer width100 mT13 mB10 height40"})]),4!==index?_c("el-col",{staticClass:"mL10",attrs:{span:12}},[_c("span",{staticClass:"lines loading-shimmer width50"}),_c("span",{staticClass:"lines loading-shimmer width100 mT13 mB10 height40"})]):_vm._e()],1)],1)}))],2):_c("div",[_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"name"}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.$t("common.products.name"))+" ")]),_c("el-input",{staticClass:"width100 fc-input-full-border2",attrs:{autofocus:"",type:"text",placeholder:_vm.$t("common.placeholders.enter_depreciation_name")},model:{value:_vm.depreciation.name,callback:function($$v){_vm.$set(_vm.depreciation,"name",$$v)},expression:"depreciation.name"}})],1)],1)],1),_c("el-row",{staticClass:"mT10"},[_c("el-col",{attrs:{span:24}},[_c("el-form-item",{attrs:{prop:"depreciationType"}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.$t("common.products.depreciation_type"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border2 width100",attrs:{placeholder:_vm.$t("common.placeholders.select_depreciation_type")},model:{value:_vm.depreciation.depreciationType,callback:function($$v){_vm.$set(_vm.depreciation,"depreciationType",$$v)},expression:"depreciation.depreciationType"}},_vm._l(_vm.depreciationTypes,(function(displayName,key){return _c("el-option",{key:key,attrs:{label:displayName,value:Number(key)}})})),1)],1)],1)],1),_c("el-row",{staticClass:"mT10"},[_c("el-col",{staticClass:"pR10",attrs:{span:12}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.$t("common.products.period_type"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border2 width100",attrs:{filterable:""},model:{value:_vm.depreciation.frequencyType,callback:function($$v){_vm.$set(_vm.depreciation,"frequencyType",$$v)},expression:"depreciation.frequencyType"}},_vm._l(_vm.frequencyTypes,(function(displayName,key){return _c("el-option",{key:key,attrs:{label:displayName,value:Number(key)}})})),1)],1),_c("el-col",{staticClass:"pL10",attrs:{span:12}},[_c("el-form-item",{attrs:{prop:"frequency"}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.period"))+" ")]),_c("el-input",{staticClass:"width100 fc-input-full-border2",attrs:{autofocus:"",type:"number",placeholder:_vm.$t("common._common.enter_period")},model:{value:_vm.depreciation.frequency,callback:function($$v){_vm.$set(_vm.depreciation,"frequency",$$v)},expression:"depreciation.frequency"}})],1)],1)],1),_c("el-row",{staticClass:"mT10"},[_c("el-col",{staticClass:"pR10",attrs:{span:12}},[_c("el-form-item",{attrs:{prop:"startDateFieldId"}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.$t("common.header.start_date_field"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border2 width100",attrs:{filterable:"",placeholder:_vm.$t("common._common.select_start_date")},model:{value:_vm.depreciation.startDateFieldId,callback:function($$v){_vm.$set(_vm.depreciation,"startDateFieldId",$$v)},expression:"depreciation.startDateFieldId"}},_vm._l(_vm.dateFields,(function(dateField,dateFldIdx){return _c("el-option",{key:dateField.id+"-"+dateFldIdx,attrs:{label:dateField.displayName,value:dateField.id}})})),1)],1)],1)],1)],1)])]),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){return _vm.closeDialog()}}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.saving},on:{click:function($event){return _vm.submitForm()}}},[_vm._v(_vm._s(_vm.saving?_vm.$t("common._common._saving"):_vm.$t("common._common._save")))])],1)])],1)])},staticRenderFns=[],objectSpread2=__webpack_require__(595082),api=(__webpack_require__(670560),__webpack_require__(260228),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(186466),__webpack_require__(538077),__webpack_require__(425728),__webpack_require__(434284),__webpack_require__(32284)),vuex_esm=__webpack_require__(420629),validation=__webpack_require__(990260),utils_field=__webpack_require__(815872),DepreciationConstant=__webpack_require__(793428),NewAssetDepreciationvue_type_script_lang_js={props:["id"],data:function(){return{depreciation:{name:"",depreciationType:1,frequency:null,frequencyType:1,totalPriceFieldId:null,salvagePriceFieldId:null,currentPriceFieldId:null,startDateFieldId:null},loading:!1,saving:!1,dateFields:{},rules:{name:{required:!0,message:this.$t("common._common.please_enter_a_name"),trigger:"change"},frequency:{required:!0,message:this.$t("common.header.please_select_period"),trigger:"change"},startDateFieldId:{required:!0,message:this.$t("common._common.please_select_a_start_date"),trigger:"change"}}}},created:function(){var _this=this,promises=[];promises.push(this.$store.dispatch("view/loadModuleMeta","asset")),this.id&&promises.push(this.init()),Promise.all(promises).then((function(){_this.filterOptions(),_this.loading=!1})),this.depreciationTypes=DepreciationConstant/* DEPRECIATION_TYPES */.ik},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({metaInfo:function(state){return state.view.metaInfo}})),{},{frequencyTypes:function(){return Object.values(DepreciationConstant/* FREQUENCY_TYPES */.ze).reduce((function(res,freq){return res[freq.id]=freq.label,res}),{})}}),methods:{init:function(){var _this2=this;this.loading=!0;var param={id:this.id};return api/* API */.bl.fetchRecord("assetdepreciation",param).then((function(_ref){var assetdepreciation=_ref.assetdepreciation,error=_ref.error;error?_this2.$message.error(error.messsage||"Error Occured"):_this2.depreciation=assetdepreciation}))},filterOptions:function(){var fields=this.$getProperty(this.metaInfo,"fields",null);(0,validation/* isEmpty */.xb)(fields)||(this.dateFields=fields.filter((function(field){return(0,utils_field/* isDateTypeField */.S6)(field)})),this.id||(this.depreciation.totalPriceFieldId=(fields.find((function(field){return"unitPrice"===field.name}))||{}).id,this.depreciation.currentPriceFieldId=(fields.find((function(field){return"currentPrice"===field.name}))||{}).id,this.depreciation.salvagePriceFieldId=(fields.find((function(field){return"salvageAmount"===field.name}))||{}).id,this.depreciation.startDateFieldId=(fields.find((function(field){return"purchasedDate"===field.name}))||{}).id))},submitForm:function(){var _this3=this;this.$refs["depreciationForm"].validate((function(valid){if(!valid)return!1;_this3.id?_this3.updateDepreciation():_this3.createDepreciation()}))},createDepreciation:function(){var _this4=this,param={data:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},this.depreciation),{},{active:!0})};this.saving=!0,api/* API */.bl.createRecord("assetdepreciation",param).then((function(_ref2){var assetdepreciation=_ref2.assetdepreciation,error=_ref2.error;error?_this4.$message.error(error.messsage||"Error Occured"):(_this4.$emit("onRecordSaved",assetdepreciation),_this4.$message.success(_this4.$t("common.products.depreciation_schedule_created"))),_this4.saving=!1,_this4.closeDialog()}))},updateDepreciation:function(){var _this5=this,param={id:this.id,data:this.depreciation};this.saving=!0,api/* API */.bl.updateRecord("assetdepreciation",param).then((function(_ref3){var error=_ref3.error;error?_this5.$message.error(error.messsage||"Error Occured"):(_this5.$emit("onRecordSaved"),_this5.$message.success(_this5.$t("common.products.depreciation_schedule_updated"))),_this5.saving=!1,_this5.closeDialog()}))},closeDialog:function(){this.$emit("onClose")}}},depreciation_NewAssetDepreciationvue_type_script_lang_js=NewAssetDepreciationvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(depreciation_NewAssetDepreciationvue_type_script_lang_js,render,staticRenderFns,!1,null,"b2639826",null)
/* harmony default export */,NewAssetDepreciation=component.exports},
/***/849621:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return ScheduleList}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/setup/depreciation/ScheduleList.vue?vue&type=template&id=7cc11731
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"depreciation-list"},[_vm.canShowMethod?_c("div",{staticClass:"flex-middle justify-content-space p20 width100 "},[_vm.loading?_c("span",{staticClass:"loading-shimmer width250px",staticStyle:{height:"16px","border-radius":"5px"}}):_c("div",{staticClass:"label-txt-black bold"},[_vm._v(" Depreciation Method - "),_c("span",{staticClass:"fw4"},[_vm._v(_vm._s(_vm.depreciationMethod)+" ")])])]):_vm._e(),_c("div",[_vm.loading?_c("div",{staticClass:"mT8"},_vm._l([1,2,3,4],(function(index){return _c("div",{key:index,staticClass:"d-flex"},_vm._l([0,1],(function(idx){return _c("div",{key:idx,class:["d-flex",0!==idx?"width100":"mL-20"]},[_c("span",{class:["lines loading-shimmer",0===idx?"width210px":"width100"]})])})),0)})),0):_vm.$validation.isEmpty(_vm.depreciationTable)?_c("div",{staticClass:"text-center d-flex flex-direction-column mT30",staticStyle:{color:"#324056"}},[_c("inline-svg",{attrs:{src:"svgs/emptystate/reportlist",iconClass:"icon text-center icon-100"}}),_c("div",{staticClass:"nowo-label f13"},[_vm._v(" No depreciation schedule applied ")])],1):_c("div",{staticClass:"mT8"},[_c("el-table",{ref:"depreciationSchedule",staticClass:"mL15",staticStyle:{width:"98%"},attrs:{data:_vm.depreciationTable,height:"auto",fit:!0,"cell-style":{padding:"10px 20px"},"header-row-class-name":"hide","row-class-name":_vm.rowStyle,"cell-class-name":_vm.cellStyle}},[_c("el-table-column",{attrs:{fixed:"","min-width":"250",prop:"displayName"}}),_vm._l(_vm.depreciationSchedule.length,(function(data,index){return _c("el-table-column",{key:index,attrs:{"min-width":"150",align:"right",prop:"col"+index}})}))],2)],1)])])},staticRenderFns=[],api=(__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(976801),__webpack_require__(634338),__webpack_require__(670560),__webpack_require__(162506),__webpack_require__(843843),__webpack_require__(212826),__webpack_require__(169358),__webpack_require__(32284)),validation=__webpack_require__(990260),moment_timezone=__webpack_require__(480008),moment_timezone_default=__webpack_require__.n(moment_timezone),DepreciationConstant=__webpack_require__(793428),ScheduleListvue_type_script_lang_js={props:["asset","selectedDepreciationId","showMethod"],data:function(){return{depreciationSchedule:null,depreciation:null,loading:!1}},created:function(){(0,validation/* isEmpty */.xb)(this.selectedDepreciationId)?this.getDepreciation():this.fetchDepreciation()},computed:{depreciationTable:function(){var _this=this,tableData=[],depreciationSchedule=this.depreciationSchedule,depreciation=this.depreciation,$currency=this.$currency;if(!(0,validation/* isEmpty */.xb)(depreciationSchedule)&&!(0,validation/* isEmpty */.xb)(depreciation)){var listObjKeys=["calculatedDate","openPrice","depreciatedAmount","currentPrice"];listObjKeys.forEach((function(key){var columnData={};"calculatedDate"===key?depreciationSchedule.forEach((function(listData,index){columnData["col".concat(index)]=moment_timezone_default()(listData[key]).tz(_this.$timezone).format("MMM YYYY").toUpperCase()})):"openPrice"===key?(columnData["col0"]=["$","₹"].includes($currency)?"".concat($currency).concat(_this.asset.unitPrice):"".concat(_this.asset.unitPrice).concat($currency),depreciationSchedule.forEach((function(listData,idx){var index=idx+1;index!==depreciationSchedule.length&&(["$","₹"].includes($currency)?columnData["col".concat(index)]="".concat($currency).concat(listData["currentPrice"]):columnData["col".concat(index)]="".concat(listData["currentPrice"]).concat($currency))}))):depreciationSchedule.forEach((function(listData,index){["$","₹"].includes($currency)?columnData["col".concat(index)]="".concat($currency).concat(listData[key]):columnData["col".concat(index)]="".concat(listData[key]).concat($currency)})),tableData.push(columnData)}));var data=["Opening Book Value","Depreciation","Ending Book Value"],_ref=depreciation||{},frequencyTypeEnum=_ref.frequencyTypeEnum;data.splice(0,0,frequencyTypeEnum),data.forEach((function(data,index){tableData[index].displayName=data}))}return tableData},currentDepreciationDate:function(){var depreciation=this.depreciation,frequencyTypes=this.frequencyTypes,today=moment_timezone_default()(new Date),dateToCompare=[];if(!(0,validation/* isEmpty */.xb)(depreciation)){var frequencyType=depreciation.frequencyType;if(frequencyType===frequencyTypes.MONTHLY)dateToCompare.push(today.month());else if([frequencyTypes.QUARTERLY,frequencyTypes.HALFYEARLY].includes(frequencyType)){var quarterDate=today.quarter();frequencyType===frequencyTypes.HALFYEARLY&&(DepreciationConstant/* QUARTERLY_FREQUENCY */.u5.FIRSTHALFYEAR.includes(quarterDate)?quarterDate=1:DepreciationConstant/* QUARTERLY_FREQUENCY */.u5.SECONDHALFYEAR.includes(quarterDate)&&(quarterDate=2)),dateToCompare.push(quarterDate)}dateToCompare.push(today.year())}return dateToCompare},currentDepreciationCol:function(){var currentDepreciationDate=this.currentDepreciationDate,depreciation=this.depreciation,depreciationSchedule=this.depreciationSchedule,frequencyTypes=this.frequencyTypes,currentCol=null;return(0,validation/* isEmpty */.xb)(currentDepreciationDate)||depreciationSchedule.forEach((function(listData,index){var dateRange=moment_timezone_default()(listData["date"]),frequencyType=depreciation.frequencyType,currentDateValue=[];if(frequencyType===frequencyTypes.MONTHLY)currentDateValue.push(dateRange.month());else if([frequencyTypes.QUARTERLY,frequencyTypes.HALFYEARLY].includes(frequencyType)){var quarterDate=dateRange.quarter();frequencyType===frequencyTypes.HALFYEARLY&&(DepreciationConstant/* QUARTERLY_FREQUENCY */.u5.FIRSTHALFYEAR.includes(quarterDate)?quarterDate=1:DepreciationConstant/* QUARTERLY_FREQUENCY */.u5.SECONDHALFYEAR.includes(quarterDate)&&(quarterDate=2)),currentDateValue.push(quarterDate)}currentDateValue.push(dateRange.year()),currentDepreciationDate.toString()===currentDateValue.toString()&&(currentCol=index+1)})),currentCol},frequencyTypes:function(){return Object.keys(DepreciationConstant/* FREQUENCY_TYPES */.ze).reduce((function(res,freq){return res[freq]=DepreciationConstant/* FREQUENCY_TYPES */.ze[freq].id,res}),{})},canShowMethod:function(){var depreciation=this.depreciation,depreciationTable=this.depreciationTable,showMethod=this.showMethod;return!(0,validation/* isEmpty */.xb)(depreciation)&&!(0,validation/* isEmpty */.xb)(depreciationTable)&&showMethod},depreciationMethod:function(){var _this$depreciation$de=this.depreciation.depreciationType,depreciationType=void 0===_this$depreciation$de?1:_this$depreciation$de;return DepreciationConstant/* DEPRECIATION_TYPES */.ik[depreciationType.toString()]}},watch:{selectedDepreciationId:{handler:function(newValue,oldValue){newValue&&newValue!==oldValue&&this.fetchDepreciation()},immediate:!0}},methods:{getDepreciation:function(){var _this2=this,url="v2/asset/depreciation/getForAsset",param={assetId:this.asset.id};this.loading=!0,api/* API */.bl.post(url,param).then((function(_ref2){var data=_ref2.data,error=_ref2.error;if(error)_this2.$message.error(error.messsage||"Error Occured");else if(_this2.depreciation=data.assetdepreciation,(0,validation/* isEmpty */.xb)(_this2.depreciation))_this2.loading=!1;else{var depreciation=_this2.depreciation,_ref3=depreciation||{},_ref3$assetDepreciati=_ref3.assetDepreciationRelList,assetDepreciationRelList=void 0===_ref3$assetDepreciati?[]:_ref3$assetDepreciati;_this2.$emit("appliedDepreciationId",depreciation.id),_this2.$emit("depreciationRel",assetDepreciationRelList[0]),_this2.fetchTableList()}}))},fetchTableList:function(){var _this3=this,url="v2/asset/depreciation/chart",id=this.depreciation.id,params={id:id,assetId:this.asset.id};api/* API */.bl.post(url,params).then((function(_ref4){var data=_ref4.data,error=_ref4.error;error?(_this3.$emit("error",error.message),_this3.canShowMethod&&_this3.$message.error(error.message||"Error Occured"),_this3.depreciationSchedule=null):_this3.depreciationSchedule=data.depreciationList||[],_this3.loading=!1}))},fetchDepreciation:function(){var _this4=this,param={id:this.selectedDepreciationId};this.loading=!0,api/* API */.bl.fetchRecord("assetdepreciation",param).then((function(_ref5){var assetdepreciation=_ref5.assetdepreciation,error=_ref5.error;error?(_this4.$message.error(error.messsage||"Error Occured"),_this4.depreciation=null,_this4.loading=!1):(_this4.depreciation=assetdepreciation,_this4.fetchTableList())}))},rowStyle:function(rowObject){var rowIndex=rowObject.rowIndex;return 0===rowIndex?"bold-row":2===rowIndex?"border-top":void 0},cellStyle:function(cellObject){var rowIndex=cellObject.rowIndex,columnIndex=cellObject.columnIndex,currentDepreciationCol=this.currentDepreciationCol,cellClass="";return columnIndex===currentDepreciationCol&&(cellClass="high-light-background current-border-left-and-right",0===rowIndex?cellClass+=" current-border-top":3===rowIndex&&(cellClass+=" current-border-bottom")),cellClass}}},depreciation_ScheduleListvue_type_script_lang_js=ScheduleListvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(depreciation_ScheduleListvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,ScheduleList=component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/98850.js.map