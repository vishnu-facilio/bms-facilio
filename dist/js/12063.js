(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[12063,10321,32686,80865,53021],{
/***/350367:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FUploadPhotos}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/FUploadPhotos.vue?vue&type=template&id=5a0f9682
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("el-dialog",{staticClass:"upload-photos-dialog fc-dialog-center-container",attrs:{title:"Upload Photos",visible:_vm.showDialog,"append-to-body":!0},on:{"update:visible":function($event){_vm.showDialog=$event},"before-close":_vm.closeDialog}},[_vm.showDialog?_c("el-upload",{attrs:{multiple:"","list-type":"picture-card","file-list":_vm.photos,action:"",accept:"image/*","http-request":_vm.onUpload,"on-success":_vm.onUploadSuccess,"on-error":_vm.onError,"on-remove":_vm.onRemove}},[_c("i",{staticClass:"el-icon-plus"})]):_vm._e(),_c("span",{staticClass:"dialog-footer modal-dialog-footer",attrs:{slot:"footer"},slot:"footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.closeDialog}},[_vm._v("Cancel")]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:_vm.done}},[_vm._v("Done")])],1)],1)},staticRenderFns=[],toConsumableArray=__webpack_require__(488478),validation=(__webpack_require__(434284),__webpack_require__(670560),__webpack_require__(339772),__webpack_require__(162506),__webpack_require__(990260)),eventBus=__webpack_require__(398011),FUploadPhotosvue_type_script_lang_js={props:["module","record","list"],data:function(){return{photos:[],showDialog:!1,isChanged:!1}},methods:{open:function(){this.photos=(0,validation/* isEmpty */.xb)(this.list)?[]:this.list,this.showDialog=!0},onUpload:function(_ref){var file=_ref.file,data=(_ref.onError,{parentId:this.record.id,module:this.module}),formData=new FormData;for(var key in formData.append("file",file,file.name),data)this.$helpers.setFormData(key,data[key],formData);return this.$http.post("v2/photos/upload",formData)},onUploadSuccess:function(response){var _response$data=response.data,responseCode=_response$data.responseCode,result=_response$data.result;0===responseCode&&(this.list.push(result.photos[0]),this.isChanged=!0)},onError:function(){this.$message.error(this.$t("setup.users_management.Invalid_image"))},onRemove:function(file){var _this=this;this.$http.post("/v2/photos/delete",{id:file.id,photoId:file.photoId,module:this.module,parentId:this.record.id}).then((function(response){if(0===response.data.responseCode){var list=(0,toConsumableArray/* default */.Z)(_this.list),index=list.findIndex((function(f){return f.id===file.id}));list.splice(index,1),_this.$emit("updatePhotos",list),_this.isChanged=!0}})).catch((function(){}))},done:function(){this.showDialog=!1,this.photos=[],this.isChanged&&(eventBus/* eventBus */.Y.$emit("refreshDetails"),this.isChanged=!1)},closeDialog:function(){this.isChanged&&(eventBus/* eventBus */.Y.$emit("refreshDetails"),this.isChanged=!1),this.showDialog=!1}}},components_FUploadPhotosvue_type_script_lang_js=FUploadPhotosvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_FUploadPhotosvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FUploadPhotos=component.exports},
/***/42525:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return ApprovalBar}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/approval/ApprovalBar.vue?vue&type=template&id=4fea8923&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("div",{class:["sidebar-loader",(_vm.loading||_vm.isSaving)&&"on"]}),_vm.loading?_c("div",{staticClass:"d-flex approval-bar"},[_vm._v(" "+_vm._s(_vm.$t("panel.loading_load"))+" ")]):_c("div",{staticClass:"d-flex approval-bar"},[_c("div",{staticClass:"approval-desc mR30 f14"},[_vm.isRejected?[_c("span",{staticClass:"bold"},[_vm._v(_vm._s(_vm.policyName))]),_vm._v(" "+_vm._s(_vm.$t("panel.was"))+" "),_c("span",{staticClass:"bold",staticStyle:{color:"#dd7171"}},[_vm._v(_vm._s(_vm.$t("panel.rejected")))]),_vm._v(" for this "+_vm._s(_vm.moduleDisplayName||_vm.moduleName)+". "),_vm.resendApproval?[_c("span",[_vm._v("You can")]),_vm.canShowEdit?[_c("span",{staticClass:"mL5"},[_vm._v("either")]),_c("span",{class:[_vm.isSaving&&"cursor-not-allowed"]},[_c("a",{class:["mL5 bold",_vm.isSaving&&"pointer-events-none"],on:{click:function($event){return _vm.$emit("onEdit")}}},[_vm._v(" edit ")])]),_c("span",{staticClass:"mL5"},[_vm._v("or")])]:_vm._e(),_c("span",{class:[_vm.isSaving&&"cursor-not-allowed"]},[_c("a",{class:["mL5 bold",_vm.isSaving&&"pointer-events-none"],on:{click:function($event){return _vm.requestToSave(_vm.resendApproval)}}},[_vm._v(" resend ")])]),_c("span",{staticClass:"mL5"},[_vm._v("for approval.")])]:_vm._e()]:_vm.hasApprovalList&&!_vm.hideApprovers?[_c("span",{staticClass:"bold"},[_vm._v(_vm._s(_vm.policyName))]),_vm._v(" is pending from "),_c("span",{staticClass:"bold"},[_vm._v(_vm._s(_vm.approvers[0].name))]),_vm.approvers.length>1?_c("el-popover",{attrs:{placement:"bottom",width:"200",trigger:"hover"}},[_vm._t("default",(function(){return[_c("div",{staticClass:"mL5 approvers-more-icon"},[_vm._v(" +"+_vm._s(_vm.approvers.length-1)+" ")])]}),{slot:"reference"}),_c("div",_vm._l(_vm.approvers.slice(1),(function(approver){return _c("div",{key:approver.name,staticClass:"mB10"},[_c("ApproverTypeAvatar",{attrs:{size:"md",user:approver,userType:_vm.getApproverType(approver),moduleName:_vm.moduleName,approvalMeta:_vm.approvalMeta}})],1)})),0)],2):_vm._e()]:(_vm.$validation.isEmpty(_vm.transitions),[_c("span",{staticClass:"bold"},[_vm._v(_vm._s(_vm.policyName))]),_vm._v(" is pending ")])],2),_vm.$validation.isEmpty(_vm.transitions)?_vm._e():_c("div",{staticClass:"approval-links text-uppercase f12 bold"},[_c("div",{class:[_vm.isSaving&&"cursor-not-allowed"]},[_vm.approveTransition?_c("a",{class:["link-approve mR15",_vm.isSaving&&"pointer-events-none"],on:{click:function($event){return _vm.requestToSave(_vm.approveTransition)}}},[_c("inline-svg",{attrs:{src:"tick-sign",iconClass:"icon icon-xs"}}),_vm._v(" "+_vm._s(_vm.approveTransition.name)+" ")],1):_vm._e(),_vm.rejectTransition?_c("a",{class:["link-reject",_vm.isSaving&&"pointer-events-none"],on:{click:function($event){return _vm.requestToSave(_vm.rejectTransition)}}},[_c("inline-svg",{attrs:{src:"svgs/close",iconClass:"icon icon-xxs"}}),_vm._v(" "+_vm._s(_vm.rejectTransition.name)+" ")],1):_vm._e()])])]),_vm.canShowForm?[_c("TransitionForm",{attrs:{moduleName:_vm.selectedTransition.moduleName,recordId:_vm.record.recordId,formId:_vm.selectedTransition.formId,record:_vm.record,transition:_vm.selectedTransition,approvalRule:_vm.approvalRule,saveAction:_vm.saveAction,closeAction:_vm.closeStateFlowForm,isV3:_vm.isV3}})]:_vm._e()],2)},staticRenderFns=[],toConsumableArray=__webpack_require__(488478),objectSpread2=__webpack_require__(595082),ApprovalButtons=(__webpack_require__(689730),__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(670560),__webpack_require__(425728),__webpack_require__(434284),__webpack_require__(976801),__webpack_require__(634338),__webpack_require__(840889)),ApprovalForm=__webpack_require__(548127),ApprovalUserAvatar=__webpack_require__(400438),validation=__webpack_require__(990260),vuex_esm=__webpack_require__(420629),ApprovalBarvue_type_script_lang_js={extends:ApprovalButtons/* default */.Z,props:["hideApprovers","canShowEdit","canHideMsg"],components:{TransitionForm:ApprovalForm/* default */.Z,ApproverTypeAvatar:ApprovalUserAvatar/* default */.Z},data:function(){return{isSaving:!1}},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({metaInfo:function(state){return state.view.metaInfo}})),{},{transitions:function(){return(0,validation/* isEmpty */.xb)(this.stateTransitions)?[]:(0,toConsumableArray/* default */.Z)(this.stateTransitions).slice(0,2)},policyName:function(){return(0,validation/* isEmpty */.xb)(this.approvalRule)?"Approval":this.$getProperty(this.approvalRule,"name")},shouldCurrentUserApprove:function(){return!(0,validation/* isEmpty */.xb)(this.transitions)},hasApprovalList:function(){return!(0,validation/* isEmpty */.xb)(this.approvers)},approvalMeta:function(){return{approvalList:this.pendingApprovalList}},approvers:function(){var approvers=[];return this.pendingApprovalList.forEach((function(approver){var value=approver.value,type=approver.type;(0,validation/* isEmpty */.xb)(value)?"TENANT"===type?approvers.push({name:"Tenant",type:"TENANT"}):"VENDOR"===type&&approvers.push({name:"Vendor",type:"VENDOR"}):(0,validation/* isArray */.kJ)(value)?approvers.push.apply(approvers,(0,toConsumableArray/* default */.Z)(value)):approvers.push(value)})),approvers},isRejected:function(){return"Rejected"===this.$getProperty(this.currentState,"status")},shouldCreateModuleRecord:function(){return!1},shouldCreateNotes:function(){return!1},approveTransition:function(){return this.transitions.find((function(t){return"Approve"===t.name}))},rejectTransition:function(){return this.transitions.find((function(t){return"Reject"===t.name}))},resendApproval:function(){return this.transitions.find((function(t){return!["Approve","Reject"].includes(t.name)}))},moduleDisplayName:function(){var _this$metaInfo;return null===(_this$metaInfo=this.metaInfo)||void 0===_this$metaInfo?void 0:_this$metaInfo.displayName}}),methods:{showMessage:function(transition){
/* override */
var name=transition.name,action="";["Approve","Reject"].includes(name)?"Approve"===name?action="approved":"Reject"===name&&(action="rejected"):action="resent for approval",this.$message.success("".concat(this.moduleDisplayName||this.moduleName," was ").concat(action))},requestToSave:function(transition){var _this=this;this.isSaving=!0,this.startTransition(transition).finally((function(){return _this.isSaving=!1}))},saveAction:function(formData){return this.transitionToState(formData)},getApproverType:function(approver){return approver.id?{type:"USER",value:approver}:approver},defaultResponseHandler:function(_ref,transition){var error=_ref.error,canShowForm=this.canShowForm;error?(!this.canHideMsg&&this.$message.error(error.message),this.$emit("onFailure",{error:error,transition:transition})):(canShowForm&&this.closeStateFlowForm(),this.fetchAvailableStates(),this.$emit("onSuccess",{error:error,transition:transition}),!this.canHideMsg&&this.showMessage(transition))}}},approval_ApprovalBarvue_type_script_lang_js=ApprovalBarvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(approval_ApprovalBarvue_type_script_lang_js,render,staticRenderFns,!1,null,"4fea8923",null)
/* harmony default export */,ApprovalBar=component.exports},
/***/882401:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return ItemTool}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/avatar/ItemTool.vue?vue&type=template&id=eff8209c
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.recordData?_c("div",{staticClass:"inline"},[_c("div",{staticClass:"fc-avatar-element q-item-division relative-position cursor-pointer"},[_vm.showSlide?_c("div",{staticClass:"q-item-side q-item-side-left q-item-section relative",class:_vm.sizeClass},[_c("el-carousel",{attrs:{trigger:"click",height:"120px",autoplay:!1,"indicator-position":"none"}},_vm._l(_vm.photos,(function(photo,index){return photo.url?_c("el-carousel-item",{key:index},[_c("img",{staticClass:"fc-avatar-square",class:_vm.sizeClass,attrs:{target:"_blank",src:photo.url},on:{click:function($event){return _vm.openPhotoUrl(photo.originalUrl)}}})]):_vm._e()})),1)],1):_c("div",{staticClass:"q-item-side q-item-side-left q-item-section relative"},[_vm.avatarUrl?_c("img",{staticClass:"fc-avatar",class:_vm.sizeClass,attrs:{src:_vm.avatarUrl}}):_vm._e()]),_vm.showName?_c("div",[_c("div",{staticClass:"textoverflow-ellipsis width110px pL8"},[_vm._v(" "+_vm._s("others"===_vm.module?_vm.recordData:_vm.recordData.name)+" ")])]):_vm._e()])]):_vm._e()},staticRenderFns=[],createForOfIteratorHelper=__webpack_require__(566347),ItemToolvue_type_script_lang_js=(__webpack_require__(434284),{props:["size","recordData","name","hovercard","module"],data:function(){return{avatarUrl:null,sizeClass:"fc-avatar-"+this.size,hoverCardId:"spaceHoverCardId-"+this.recordData.id,showName:"undefined"===typeof this.name||"true"===this.name,showHoverCard:"undefined"===typeof this.hovercard||"true"===this.hovercard,loadHoverCardData:!1,photosLoading:!0,photos:[],sliderEnabledSize:["shuge","huge","xhuge"]}},mounted:function(){this.loadAvatarUrl()},computed:{showSlide:function(){if(this.photos.length){if(this.sliderEnabledSize.indexOf(this.size)>=0){var _step,allUrlNull=!0,_iterator=(0,createForOfIteratorHelper/* default */.Z)(this.photos);try{for(_iterator.s();!(_step=_iterator.n()).done;){var photo=_step.value;if(photo.url){allUrlNull=!1;break}}}catch(err){_iterator.e(err)}finally{_iterator.f()}return!allUrlNull}return!1}return!1},showUpload:function(){return this.sliderEnabledSize.indexOf(this.size)>=0}},watch:{recordData:function(){this.loadAvatarUrl()}},methods:{loadAvatarUrl:function(){this.avatarUrl=this.recordData.photoUrl,this.recordData.photoUrl?this.avatarUrl=this.recordData.photoUrl:this.avatarUrl=this.getDefaultAvatar()},openPhotoUrl:function(url){window.open(url,"_blank")},getDefaultAvatar:function(){if(this.recordData){if("item"===this.module)return __webpack_require__(73188);if("tool"===this.module)return __webpack_require__(392708);if("others"===this.module)return __webpack_require__(73188)}return __webpack_require__(73188)},loadHoverCard:function(){this.loadHoverCardData=!0},hideHoverCard:function(){this.loadHoverCardData=!1},showUploadPhotoDialog:function(){this.$refs.uploadDialog.open()}}}),avatar_ItemToolvue_type_script_lang_js=ItemToolvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(avatar_ItemToolvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,ItemTool=component.exports},
/***/664281:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return Storeroom}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/avatar/Storeroom.vue?vue&type=template&id=1587f6ed
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.storeRoom?_c("div",{staticClass:"inline"},[_c("div",{staticClass:"fc-avatar-element q-item-division relative-position cursor-pointer"},[!_vm.showSlide||"undefined"!==typeof _vm.disableSlide&&!1!==_vm.disableSlide?_vm.isSummary?_c("div",{staticClass:"q-item-side q-item-side-left q-item-section relative"},[_vm.avatarUrl?_c("img",{staticClass:"fc-avatar-square",class:_vm.sizeClass,attrs:{src:_vm.avatarUrl}}):_vm._e()]):_c("div",{staticClass:"q-item-side q-item-side-left q-item-section relative"},[_vm.avatarUrl?_c("img",{staticClass:"fc-avatar",class:_vm.sizeClass,attrs:{src:_vm.avatarUrl}}):_vm._e()]):_c("div",{staticClass:"q-item-side q-item-side-left q-item-section relative",class:_vm.sizeClass},[_c("el-carousel",{attrs:{trigger:"click",height:"180px",autoplay:!1,"indicator-position":"none"}},_vm._l(_vm.photos,(function(photo,index){return photo.url?_c("el-carousel-item",{key:index},[_c("img",{staticClass:"fc-avatar-square",class:_vm.sizeClass,attrs:{target:"_blank",src:photo.url},on:{click:function($event){return _vm.openPhotoUrl(photo.originalUrl)}}})]):_vm._e()})),1)],1),_vm.showName?_c("div",[_c("div",[_c("span",{staticClass:"q-item-label"},[_vm._v(_vm._s(_vm.storeRoom.name))])])]):_vm._e(),!_vm.showUpload||"undefined"!==typeof _vm.disableUpload&&!1!==_vm.disableUpload?_vm._e():_c("div",[_c("span",{staticClass:"upload-space-photos pointer",on:{click:_vm.showUploadPhotoDialog}},[_c("i",{staticClass:"fa fa-camera",attrs:{"aria-hidden":"true"}})]),_c("f-upload-photos",{ref:"uploadDialog",attrs:{list:_vm.photos,module:"storeroomphotos",record:_vm.storeRoom}})],1)])]):_vm._e()},staticRenderFns=[],createForOfIteratorHelper=__webpack_require__(566347),FUploadPhotos=(__webpack_require__(434284),__webpack_require__(350367)),Storeroomvue_type_script_lang_js={props:["size","storeRoom","name","hovercard","disableUpload","disableSlide","isSummary"],data:function(){return{avatarUrl:null,sizeClass:"fc-avatar-"+this.size,hoverCardId:"spaceHoverCardId-"+this.storeRoom.id,showName:"undefined"===typeof this.name||"true"===this.name,showHoverCard:"undefined"===typeof this.hovercard||"true"===this.hovercard,loadHoverCardData:!1,photosLoading:!0,photos:[],sliderEnabledSize:["shuge","huge","xhuge","mxhuge"]}},components:{FUploadPhotos:FUploadPhotos/* default */.Z},mounted:function(){this.loadAvatarUrl()},computed:{showSlide:function(){if(this.photos.length){if(this.sliderEnabledSize.indexOf(this.size)>=0){var _step,allUrlNull=!0,_iterator=(0,createForOfIteratorHelper/* default */.Z)(this.photos);try{for(_iterator.s();!(_step=_iterator.n()).done;){var photo=_step.value;if(photo.url){allUrlNull=!1;break}}}catch(err){_iterator.e(err)}finally{_iterator.f()}return!allUrlNull}return!1}return!1},showUpload:function(){return this.sliderEnabledSize.indexOf(this.size)>=0}},watch:{storeRoom:function(){this.loadAvatarUrl()}},methods:{loadAvatarUrl:function(){var self=this;this.storeRoom.id>0&&(self.photosLoading=!0,self.$http.get("/photos/get?module=storeroomphotos&parentId="+this.storeRoom.id).then((function(response){if(self.photos=response.data.photos?response.data.photos:[],self.photosLoading=!1,self.photos.length){var _step2,_iterator2=(0,createForOfIteratorHelper/* default */.Z)(self.photos);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var photo=_step2.value;if(photo.url){self.avatarUrl=photo.url;break}}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}}))),this.storeRoom.avatarUrl?this.avatarUrl=this.storeRoom.avatarUrl:(this.avatarUrl=this.getDefaultAvatar(),this.storeRoom.avatarUrl=this.avatarUrl)},openPhotoUrl:function(url){window.open(url,"_blank")},getDefaultAvatar:function(){if(this.storeRoom)return __webpack_require__(494194)},loadHoverCard:function(){this.loadHoverCardData=!0},hideHoverCard:function(){this.loadHoverCardData=!1},showUploadPhotoDialog:function(){this.$refs.uploadDialog.open()}}},avatar_Storeroomvue_type_script_lang_js=Storeroomvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(avatar_Storeroomvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,Storeroom=component.exports},
/***/646716:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return FetchViewsMixin}});
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js
var render,staticRenderFns,regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),validation=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(434284),__webpack_require__(990260)),api=__webpack_require__(32284),FetchViewsMixinvue_type_script_lang_js={methods:{fetchView:function(moduleName){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var params,_yield$API$get,data,error,_ref,groupViews;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.prev=0,params={moduleName:moduleName,groupType:1,viewType:1},_context.next=4,api/* API */.bl.get("/v2/views/viewList",params);case 4:if(_yield$API$get=_context.sent,data=_yield$API$get.data,error=_yield$API$get.error,error){_context.next=10;break}return _ref=data||{},groupViews=_ref.groupViews,_context.abrupt("return",_this.getFirstView(groupViews));case 10:_context.next=15;break;case 12:return _context.prev=12,_context.t0=_context["catch"](0),_context.abrupt("return","all");case 15:case"end":return _context.stop()}}),_callee,null,[[0,12]])})))()},getFirstView:function(groupViews){var _ref2=(groupViews||[]).find((function(group){return!(0,validation/* isEmpty */.xb)(group.views)}))||{},views=_ref2.views,_this$$getProperty=this.$getProperty(views,"0",{}),name=_this$$getProperty.name;return name||"all"}}},base_FetchViewsMixinvue_type_script_lang_js=FetchViewsMixinvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(base_FetchViewsMixinvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,FetchViewsMixin=component.exports;
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js
},
/***/760218:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return PageBuilder}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/page/PageBuilder.vue?vue&type=template&id=0dd0982f
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.showPage&&_vm.pagebuilderComponent?_c(_vm.pagebuilderComponent,_vm._b({tag:"component",attrs:{module:_vm.module},on:{forceOldPage:function($event){_vm.forceOld=!0}}},"component",_vm.$attrs,!1)):_vm._e()},staticRenderFns=[],objectSpread2=__webpack_require__(595082),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),vuex_esm=(__webpack_require__(260228),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(420629)),PageBuildervue_type_script_lang_js={props:["module"],data:function(){return{forceOld:!1,showPage:!1}},components:{NewPageBuilder:function(){return Promise.all(/* import() */[__webpack_require__.e(93208),__webpack_require__.e(50232),__webpack_require__.e(93765),__webpack_require__.e(95953),__webpack_require__.e(35309),__webpack_require__.e(18778),__webpack_require__.e(12303),__webpack_require__.e(84290),__webpack_require__.e(31721),__webpack_require__.e(64418),__webpack_require__.e(5603),__webpack_require__.e(57432),__webpack_require__.e(435),__webpack_require__.e(72230),__webpack_require__.e(94255),__webpack_require__.e(67683),__webpack_require__.e(44178),__webpack_require__.e(91132),__webpack_require__.e(20280),__webpack_require__.e(78256),__webpack_require__.e(22200),__webpack_require__.e(49081),__webpack_require__.e(89472),__webpack_require__.e(12085),__webpack_require__.e(55754),__webpack_require__.e(86494),__webpack_require__.e(3037),__webpack_require__.e(49908),__webpack_require__.e(22061),__webpack_require__.e(31602),__webpack_require__.e(73609),__webpack_require__.e(44119),__webpack_require__.e(88262),__webpack_require__.e(82080),__webpack_require__.e(88506)]).then(__webpack_require__.bind(__webpack_require__,110570))},OldPageBuilder:function(){return Promise.all(/* import() */[__webpack_require__.e(93208),__webpack_require__.e(50232),__webpack_require__.e(93765),__webpack_require__.e(95953),__webpack_require__.e(35309),__webpack_require__.e(18778),__webpack_require__.e(12303),__webpack_require__.e(84290),__webpack_require__.e(31721),__webpack_require__.e(64418),__webpack_require__.e(5603),__webpack_require__.e(57432),__webpack_require__.e(435),__webpack_require__.e(72230),__webpack_require__.e(94255),__webpack_require__.e(67683),__webpack_require__.e(44178),__webpack_require__.e(91132),__webpack_require__.e(20280),__webpack_require__.e(78256),__webpack_require__.e(22200),__webpack_require__.e(49081),__webpack_require__.e(89472),__webpack_require__.e(12085),__webpack_require__.e(55754),__webpack_require__.e(86494),__webpack_require__.e(3037),__webpack_require__.e(49908),__webpack_require__.e(22061),__webpack_require__.e(31602),__webpack_require__.e(73609),__webpack_require__.e(23803),__webpack_require__.e(55246)]).then(__webpack_require__.bind(__webpack_require__,223803))}},created:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(_context.prev=0,!_this.$helpers.isLicenseEnabled("PAGE_BUILDER")){_context.next=4;break}return _context.next=4,_this.$store.dispatch("pagebuilder/loadNewPageEnabledModules");case 4:_context.next=8;break;case 6:_context.prev=6,_context.t0=_context["catch"](0);case 8:_this.$nextTick((function(){_this.showPage=!0}));case 9:case"end":return _context.stop()}}),_callee,null,[[0,6]])})))()},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({newPageEnabledModules:function(state){return state.pagebuilder.newPageEnabledModules}})),{},{pagebuilderComponent:function(){var newPageEnabledModules=this.newPageEnabledModules,module=this.module,forceOld=this.forceOld,isNew=(newPageEnabledModules||[]).includes(module),showNew=!forceOld&&(this.showNewPageBuilder||isNew);return showNew?"NewPageBuilder":"OldPageBuilder"},showNewPageBuilder:function(){var query=this.$route.query,_query$showNewPageBui=query.showNewPageBuilder,showNewPageBuilder=void 0!==_query$showNewPageBui&&_query$showNewPageBui;return!0===showNewPageBuilder||"true"===showNewPageBuilder}})},page_PageBuildervue_type_script_lang_js=PageBuildervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(page_PageBuildervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,PageBuilder=component.exports},
/***/694120:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return ItemSummary}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/Inventory/Items/ItemSummary.vue?vue&type=template&id=e42f3e82
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"custom-module-overview"},[_vm.isLoading?_c("div",{staticClass:"flex-middle fc-empty-white"},[_c("spinner",{attrs:{show:_vm.isLoading,size:"80"}})],1):_vm.$validation.isEmpty(_vm.record)?_vm._e():[_c("div",{staticClass:"header p20"},[_c("div",{staticClass:"custom-module-details"},[_c("div",{staticClass:"d-flex flex-middle align-center"},[_c("div",{on:{click:function($event){return _vm.showAvatarPreview()}}},[_c("item-avatar",{attrs:{name:!1,size:"xlg",module:"item",recordData:_vm.record.itemType}})],1),_c("div",{staticClass:"mL10"},[_c("div",{staticClass:"custom-module-id pB10"},[_vm.$account.portalInfo?_c("i",{directives:[{name:"tippy",rawName:"v-tippy",value:{animateFill:!1,animation:"shift-toward"},expression:"{ animateFill: false, animation: 'shift-toward' }"}],staticClass:"el-icon-back fc-grey3-text14 fw6 pR10 pointer",attrs:{content:"back",arrow:""},on:{click:_vm.back}}):_vm._e(),_vm._v(" #"+_vm._s(_vm.record&&_vm.record.id)+" ")]),_c("div",{staticClass:"custom-module-name d-flex max-width300px"},[_c("el-tooltip",{attrs:{placement:"bottom",effect:"dark",content:_vm.$getProperty(_vm.record,"itemType.name")}},[_c("span",{staticClass:"whitespace-pre-wrap custom-header"},[_vm._v(_vm._s(_vm.$getProperty(_vm.record,"itemType.name")))])])],1)])])]),_c("div",{staticClass:"marginL-auto flex-middle"},[_c("CustomButton",{staticClass:"pR10",attrs:{record:_vm.record,moduleName:_vm.moduleName,position:_vm.POSITION.SUMMARY},on:{refresh:function($event){return _vm.refreshData()},onError:function(){}}}),_vm.$hasPermission("inventory:CREATE")&&!_vm.rotating?_c("el-button",{staticClass:"fc__add__btn mR15",on:{click:function($event){return _vm.openStockItem()}}},[_vm._v(_vm._s(_vm.$t("common.header.stock_item")))]):_vm._e(),_vm.$hasPermission("inventory:UPDATE,UPDATE_OWN")?_c("el-dropdown",{staticClass:"mL10 self-center fc-btn-ico-lg pT3 pB3 pL8 pR8 pointer",attrs:{trigger:"click"},on:{command:function(action){return _vm.summaryDropDownAction(action)}}},[_c("span",{staticClass:"el-dropdown-link"},[_c("inline-svg",{staticClass:"vertical-middle",attrs:{src:"svgs/menu",iconClass:"icon icon-md"}})],1),_c("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[_c("el-dropdown-item",{key:1,attrs:{command:"edit"}},[_vm._v(_vm._s(_vm.$t("common._common.edit")))]),_c("el-dropdown-item",{key:2,attrs:{command:"go_to_itemType"}},[_vm._v(_vm._s(_vm.$t("common._common.go_to_itemType")))]),_vm.canIssueItem(_vm.record)?_c("el-dropdown-item",{key:3,attrs:{command:"issue_item"}},[_vm._v(_vm._s(_vm.$t("common.products.issue_item")))]):_vm._e(),_vm.canReturnItem(_vm.record)?_c("el-dropdown-item",{key:4,attrs:{command:"return_item"}},[_vm._v(_vm._s(_vm.$t("common._common.return_item")))]):_vm._e(),_vm.rotating?_vm._e():_c("el-dropdown-item",{key:5,attrs:{command:"adjust_balance"}},[_vm._v(_vm._s(_vm.$t("common._common.adjust_balance")))])],1)],1):_vm._e()],1)]),_c("Page",{key:_vm.record.id,attrs:{module:_vm.moduleName,id:_vm.record.id,details:_vm.record,primaryFields:_vm.primaryFields,notesModuleName:_vm.notesModuleName,isV3Api:!0,attachmentsModuleName:_vm.attachmentsModuleName,showDescriptionTitle:!0}})],_vm.photoUrl?_c("el-dialog",{staticStyle:{"z-index":"9999999999"},attrs:{visible:_vm.showPreviewImage,width:"60%","append-to-body":!0},on:{"update:visible":function($event){_vm.showPreviewImage=$event}}},[_c("img",{staticStyle:{width:"100%"},attrs:{src:_vm.photoUrl}})]):_vm._e(),_vm.showItemIssueReturn?_c("item-issue-return",{key:_vm.record.id,attrs:{item:_vm.record,itemType:_vm.record.itemType,showItemIssueReturn:_vm.showItemIssueReturn,type:_vm.issueReturnType},on:{"update:showItemIssueReturn":function($event){_vm.showItemIssueReturn=$event},"update:show-item-issue-return":function($event){_vm.showItemIssueReturn=$event},refresh:_vm.refreshItem}}):_vm._e(),_vm.newFormVisibility?_c("update-item-form",{attrs:{visibility:_vm.newFormVisibility,itemData:_vm.itemEditObj,editId:_vm.editId},on:{"update:visibility":function($event){_vm.newFormVisibility=$event},saved:function($event){return _vm.loadRecord(!0)}}}):_vm._e(),_c("stock-item",{attrs:{visibility:_vm.stockItemVisibility,record:_vm.record,moduleName:_vm.moduleName},on:{"update:visibility":function($event){_vm.stockItemVisibility=$event},saved:function($event){return _vm.loadRecord(!0)}}})],2)},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),CustomModuleSummary=(__webpack_require__(434284),__webpack_require__(670560),__webpack_require__(162506),__webpack_require__(848277)),api=__webpack_require__(32284),ItemTool=__webpack_require__(882401),ItemIssueReturnvue_type_template_id_1f2fc71e_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",["issue"===_vm.type?_c("div",[_vm.item.itemType.isRotating?_c("div",[_c("el-dialog",{key:_vm.itemType.id,attrs:{visible:_vm.showItemIssueReturn,title:_vm.$t("common.products.issue_item"),"before-close":_vm.cancelForm,"custom-class":"fc-dialog-center-container"},on:{"update:visible":function($event){_vm.showItemIssueReturn=$event}}},[_vm.loading?_c("div",[_c("spinner",{attrs:{show:_vm.loading}})],1):_c("div",{staticClass:"height400"},[_vm.item.itemType.isRotating&&_vm.item.id?_c("div",[_c("el-table",{directives:[{name:"loading",rawName:"v-loading",value:_vm.purLoading,expression:"purLoading"}],staticClass:"width100 inventory-inner-table",attrs:{height:"200",data:_vm.purchasedUnUsedItemList,"empty-text":_vm.$t("common.products.no_rotating_assets_available"),"default-sort":{prop:"costDate",order:"descending"}},on:{"selection-change":_vm.toggleUnUsedItemSelection}},[_c("el-table-column",{attrs:{type:"selection",width:"60"}}),_c("el-table-column",{attrs:{prop:"serialNumber",sortable:"",label:_vm.$t("common._common.serial_number")}}),_c("el-table-column",{attrs:{sortable:"",label:_vm.$t("common.header._price")},scopedSlots:_vm._u([{key:"default",fn:function(scope){return[_c("currency",{attrs:{value:scope.row.unitPrice>0?scope.row.unitPrice:"---"}})]}}],null,!1,2712200387)}),_c("el-table-column",{attrs:{sortable:"",prop:"purchasedDate",formatter:_vm.getDateTimePurchasedDate,label:_vm.$t("common.products.purchased_items")}})],1),_c("el-row",{staticClass:"mT20"},[_c("el-col",{attrs:{span:12}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v(" "+_vm._s(_vm.$t("common.products.issue_to"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width100 mT5",attrs:{filterable:"",clearable:"",placeholder:"Select User"},model:{value:_vm.userid,callback:function($$v){_vm.userid=$$v},expression:"userid"}},_vm._l(_vm.users,(function(user){return _c("el-option",{key:user.id,attrs:{label:user.name,value:parseInt(user.id)}})})),1)],1)],1)],1):_vm._e()]),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){return _vm.cancelForm()}}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.saving},on:{click:function($event){return _vm.saveIssueForm()}}},[_vm._v(_vm._s(_vm.saving?_vm.$t("common._common.submitting"):_vm.$t("common._common._save")))])],1)])],1):_vm._e(),_vm.item.itemType.isRotating?_vm._e():_c("div",[_c("el-dialog",{key:_vm.itemType.id,attrs:{visible:_vm.showItemIssueReturn,title:_vm.$t("common.products.issue_item"),width:"40%","before-close":_vm.cancelForm,"custom-class":"fc-dialog-center-container"},on:{"update:visible":function($event){_vm.showItemIssueReturn=$event}}},[_vm.loading?_c("div",[_c("spinner",{attrs:{show:_vm.loading}})],1):!_vm.item.itemType.isRotating&&_vm.item.id?_c("div",{staticClass:"height300"},[_c("div",[_c("el-row",{attrs:{gutter:20}},[_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"fc-id"},[_vm._v("#"+_vm._s(_vm.item.itemType.id))]),_c("div",{staticClass:"fc-black3-16 text-left"},[_vm._v(" "+_vm._s(_vm.item.itemType.name)+" ")])]),_c("el-col",{attrs:{span:12}},[_c("store-room-avatar",{attrs:{name:"true",size:"lg",storeRoom:_vm.item.storeRoom}})],1)],1)],1),_c("el-row",{staticClass:"mT40",attrs:{gutter:10}},[_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"fc-black3-16 text-left fw4"},[_vm._v(" "+_vm._s(_vm.$t("common.products.issue_quantity"))+" ")]),_c("el-input",{staticClass:"fc-input-full-border2 mT5",attrs:{placeholder:_vm.$t("common.products.issue_quantity"),min:1,max:_vm.item.quantity,type:"number"},model:{value:_vm.quantity,callback:function($$v){_vm.quantity=$$v},expression:"quantity"}},[_c("span",{staticClass:"width100 item-input-txt",attrs:{slot:"suffix"},slot:"suffix"},[_vm._v(_vm._s(_vm.$t("common.header.item")))])]),_c("div",{staticClass:"green-txt2-13 mT10 fw4"},[_vm._v(" "+_vm._s(_vm.item.quantity)+" "+_vm._s(_vm.$t("common.header._current_balance"))+" ")])],1),_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"fc-black3-16 text-left fw4"},[_vm._v(" "+_vm._s(_vm.$t("common.products.issue_to"))+" ")]),_c("el-select",{staticClass:"fc-input-full-border-select2 width100 mT5",attrs:{filterable:"",clearable:"",placeholder:_vm.$t("common.products.select_user")},model:{value:_vm.userid,callback:function($$v){_vm.userid=$$v},expression:"userid"}},_vm._l(_vm.users,(function(user){return _c("el-option",{key:user.id,attrs:{label:user.name,value:parseInt(user.id)}})})),1)],1)],1)],1):_vm._e(),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){return _vm.cancelForm()}}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.saving},on:{click:function($event){return _vm.saveIssueForm()}}},[_vm._v(_vm._s(_vm.saving?_vm.$t("common._common.submitting"):_vm.$t("common._common._save")))])],1)])],1)]):_vm._e(),"adjustment"===_vm.type?_c("div",[_vm.item.itemType.isRotating?_vm._e():_c("div",[_c("el-dialog",{key:_vm.itemType.id,attrs:{visible:_vm.showItemIssueReturn,title:_vm.$t("common._common.adjust_balance"),width:"40%","before-close":_vm.cancelForm,"custom-class":"fc-dialog-center-container"},on:{"update:visible":function($event){_vm.showItemIssueReturn=$event}}},[_vm.loading?_c("div",[_c("spinner",{attrs:{show:_vm.loading}})],1):!_vm.item.itemType.isRotating&&_vm.item.id?_c("div",{staticClass:"height300"},[_c("div",[_c("el-row",{attrs:{gutter:20}},[_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"fc-id"},[_vm._v("#"+_vm._s(_vm.item.itemType.id))]),_c("div",{staticClass:"fc-black3-16 text-left"},[_vm._v(" "+_vm._s(_vm.item.itemType.name)+" ")])]),_c("el-col",{attrs:{span:12}},[_c("store-room-avatar",{attrs:{name:"true",size:"lg",storeRoom:_vm.item.storeRoom}})],1)],1)],1),_c("el-row",{staticClass:"mT40",attrs:{gutter:10}},[_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"fc-black3-16 text-left fw4"},[_vm._v(" "+_vm._s(_vm.$t("common.header._new_quantity"))+" ")]),_c("el-input",{staticClass:"fc-input-full-border2 mT5",attrs:{placeholder:_vm.$t("common.header._new_quantity"),type:"number"},model:{value:_vm.quantity,callback:function($$v){_vm.quantity=$$v},expression:"quantity"}},[_c("span",{staticClass:"width100 item-input-txt",attrs:{slot:"suffix"},slot:"suffix"},[_vm._v(_vm._s(_vm.$t("common.header.item")))])]),_vm.item.quantity>=0?_c("div",{staticClass:"green-txt2-13 mT10 fw4"},[_vm._v(" "+_vm._s(_vm.item.quantity)+" "+_vm._s(_vm.$t("common.header._current_quantity"))+" ")]):_vm._e(),-1===_vm.item.quantity?_c("div",{staticClass:"green-txt2-13 mT10 fw4"},[_vm._v(" "+_vm._s("___")+" "+_vm._s(_vm.$t("common.header._current_quantity"))+" ")]):_vm._e()],1),_c("el-col",{attrs:{span:12}},[_c("div",{staticClass:"fc-black3-16 text-left fw4"},[_vm._v(" "+_vm._s(_vm.$t("common.header.unit_price"))+" ")]),_vm.checkForMultiCurrency("unitcost",_vm.metaFieldTypeMap)?_c("td",{staticClass:"item-unit-price-currency"},[_c("FNewCurrencyField",{key:_vm.item.currencyCode,attrs:{isSubform:!0,moduleData:_vm.item,disabled:this.quantity<=_vm.item.quantity},on:{setCurrencyCodeInSubform:_vm.setCurrencyCodeInSubform,calculateExchangeRate:_vm.calculateExchangeRate},model:{value:_vm.price,callback:function($$v){_vm.price=$$v},expression:"price"}})],1):_c("el-input",{staticClass:"fc-input-full-border2 mT5",attrs:{placeholder:_vm.$t("common.header.unit_price"),disabled:this.quantity<=_vm.item.quantity},model:{value:_vm.price,callback:function($$v){_vm.price=$$v},expression:"price"}},[_c("span",{staticClass:"width100 item-input-txt",attrs:{slot:"suffix"},slot:"suffix"},[_vm._v(_vm._s(_vm.$t("common.header.price")))])])],1)],1)],1):_vm._e(),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){return _vm.cancelForm()}}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.saving},on:{click:function($event){return _vm.saveAdjustmentForm()}}},[_vm._v(_vm._s(_vm.saving?_vm.$t("common._common.submitting"):_vm.$t("common._common._save")))])],1)])],1)]):_vm._e(),"return"===_vm.type?_c("div",[_c("el-dialog",{key:_vm.itemType.id,attrs:{visible:_vm.showItemIssueReturn,fullscreen:!1,title:_vm.$t("common._common.return_item"),"before-close":_vm.cancelForm,width:"65%",open:"top","custom-class":"fc-dialog-center-container","append-to-body":!0},on:{"update:visible":function($event){_vm.showItemIssueReturn=$event}}},[_c("div",{staticClass:"height400"},[_vm.itemType.isRotating?_vm._e():_c("div",[_vm.selectedIssuedItems.length>0?_c("div",{staticClass:"rv-sum-table-click",on:{click:function($event){return _vm.markAsFullyReturned(_vm.issuedItems)}}},[_c("img",{staticClass:"mR10",attrs:{src:__webpack_require__(619257)}}),_vm._v(" "+_vm._s(_vm.$t("common.wo_report.mark_as_fully_returned"))+" ")]):_vm._e(),_c("el-table",{ref:"returnTable",staticClass:"inventory-inner-table width100",attrs:{data:_vm.issuedItems,height:"300","empty-text":_vm.$t("common.products.this_item_not_issued"),"default-sort":{prop:"item.storeRoom.name",order:"descending"}},on:{"selection-change":_vm.selectIssuedItemActions}},[_c("el-table-column",{attrs:{width:"60",type:"selection"}}),_c("el-table-column",{attrs:{prop:"item.storeRoom.name",sortable:"",width:"190",label:_vm.$t("common.products.storeroom_name")}}),_c("el-table-column",{attrs:{prop:"remainingQuantity",sortable:"",width:"130",label:_vm.$t("common._common.quantity")}}),_c("el-table-column",{attrs:{prop:"sysModifiedTime",formatter:_vm.getDateTimeIssuedTime,sortable:"",label:_vm.$t("common.products.issued_time")}}),_c("el-table-column",{attrs:{label:_vm.$t("common.products.issued_to"),width:"250"},scopedSlots:_vm._u([{key:"default",fn:function(item){return[2===item.row.transactionType?_c("div",[_vm._v(" WO-"),_c("router-link",{staticClass:"fc-id",attrs:{to:{path:"/app/wo/orders/summary/"+item.row.parentId}}},[_vm._v(" #"+_vm._s(item.row.parentId)+" ")])],1):_vm._e(),3===item.row.transactionType?_c("div",[4===item.row.resource.resourceType?_c("user-avatar",{attrs:{size:"md",user:_vm.$store.getters.getUser(item.row.parentId)}}):2===item.row.resource.resourceType?_c("span",[_vm._v("Asset-"),_c("router-link",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"top",arrow:!0,animation:"shift-away"},expression:"{\n                        placement: 'top',\n                        arrow: true,\n                        animation: 'shift-away',\n                      }"}],staticClass:"fc-id",attrs:{title:item.row.resource?item.row.resource.name:"",to:{path:"/app/at/assets/all/"+item.row.parentId+"/overview/"}}},[_vm._v("#"+_vm._s(item.row.parentId))])],1):1===item.row.resource.resourceType?_c("span",[_vm._v("Space- "),_c("router-link",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"top",arrow:!0,animation:"shift-away"},expression:"{\n                        placement: 'top',\n                        arrow: true,\n                        animation: 'shift-away',\n                      }"}],staticClass:"fc-id",attrs:{title:item.row.resource?item.row.resource.name:"",to:{path:_vm.getSpaceRouteLink(item.row.resource)}}},[_vm._v("#"+_vm._s(item.row.parentId))])],1):_vm._e()],1):_vm._e()]}}],null,!1,1080196264)}),_c("el-table-column",{attrs:{width:"180",label:_vm.$t("common._common.return_quantity")},scopedSlots:_vm._u([{key:"default",fn:function(issuedItem){return[_c("div",[_c("el-input",{ref:"quantityElInput",staticClass:"fc-input-full-border-select2",attrs:{placeholder:_vm.$t("common._common.quantity"),min:1,max:issuedItem.row.remainingQuantity,type:"number"},model:{value:issuedItem.row.updateQuantity,callback:function($$v){_vm.$set(issuedItem.row,"updateQuantity",$$v)},expression:"issuedItem.row.updateQuantity"}})],1)]}}],null,!1,502091292)})],1)],1),_vm.item.itemType.isRotating?_c("div",[_c("el-table",{staticClass:"width100 inventory-inner-table",attrs:{data:_vm.issuedItems,"empty-text":_vm.$t("common.products.this_item_not_issued"),height:"310","default-sort":{prop:"item.storeRoom.name",order:"descending"}},on:{"selection-change":_vm.toggleReturnItemSelection}},[_c("el-table-column",{attrs:{type:"selection",width:"60"}}),_c("el-table-column",{attrs:{prop:"item.storeRoom.name",sortable:"",label:_vm.$t("common.products.storeroom_name"),width:"190"}}),_c("el-table-column",{attrs:{prop:"asset.name",sortable:"",label:_vm.$t("common.products.name"),width:"140"}}),_c("el-table-column",{attrs:{prop:"asset.serialNumber",sortable:"",label:_vm.$t("common._common._serial_number"),width:"170"}}),_c("el-table-column",{attrs:{label:_vm.$t("common.products.issued_to"),width:"150"},scopedSlots:_vm._u([{key:"default",fn:function(item){return[2===item.row.transactionType?_c("div",[_vm._v(" WO-"),_c("router-link",{staticClass:"fc-id",attrs:{to:{path:"/app/wo/orders/summary/"+item.row.parentId}}},[_vm._v(" #"+_vm._s(item.row.parentId)+" ")])],1):_vm._e(),3===item.row.transactionType?_c("div",[4===item.row.resource.resourceType?_c("user-avatar",{attrs:{size:"md",user:_vm.$store.getters.getUser(item.row.parentId)}}):2===item.row.resource.resourceType?_c("span",[_vm._v("Asset-"),_c("router-link",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"top",arrow:!0,animation:"shift-away"},expression:"{\n                        placement: 'top',\n                        arrow: true,\n                        animation: 'shift-away',\n                      }"}],staticClass:"fc-id",attrs:{title:item.row.resource?item.row.resource.name:"",to:{path:"/app/at/assets/all/"+item.row.parentId+"/overview/"}}},[_vm._v("#"+_vm._s(item.row.parentId))])],1):1===item.row.resource.resourceType?_c("span",[_vm._v("Space- "),_c("router-link",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"top",arrow:!0,animation:"shift-away"},expression:"{\n                        placement: 'top',\n                        arrow: true,\n                        animation: 'shift-away',\n                      }"}],staticClass:"fc-id",attrs:{title:item.row.resource?item.row.resource.name:"",to:{path:_vm.getSpaceRouteLink(item.row.resource)}}},[_vm._v("#"+_vm._s(item.row.parentId))])],1):_vm._e()],1):_vm._e()]}}],null,!1,1080196264)}),_c("el-table-column",{attrs:{sortable:"",prop:"sysModifiedTime",formatter:_vm.getDateTimeIssuedTime,label:_vm.$t("common.products.issued_time")}})],1)],1):_vm._e()]),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){return _vm.cancelForm()}}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.saving},on:{click:function($event){return _vm.returnItem()}}},[_vm._v(_vm._s(_vm.saving?_vm.$t("common._common.submitting"):_vm.$t("common._common.return")))])],1)])],1):_vm._e()])},ItemIssueReturnvue_type_template_id_1f2fc71e_scoped_true_staticRenderFns=[],objectSpread2=__webpack_require__(595082),vuex_esm=(__webpack_require__(450886),__webpack_require__(648324),__webpack_require__(260228),__webpack_require__(76265),__webpack_require__(947522),__webpack_require__(420629)),User=__webpack_require__(426803),Storeroom=__webpack_require__(664281),inventoryHelper=__webpack_require__(424477),validation=__webpack_require__(990260),CurrencyUtil=__webpack_require__(15426),FNewCurrencyField=__webpack_require__(533206),transactionTypeEnum={STOCK:1,MANUAL:3},transactionStateEnum={ISSUE:2,RETURN:3,ADJUSTMENT_INCREASE:7,ADJUSTMENT_DECREASE:8},resourceTypeEnum={USER:4},ItemIssueReturnvue_type_script_lang_js={props:["itemType","showItemIssueReturn","type","item"],mixins:[inventoryHelper/* default */.Z],components:{UserAvatar:User/* default */.Z,StoreRoomAvatar:Storeroom/* default */.Z,FNewCurrencyField:FNewCurrencyField/* default */.Z},data:function(){return{saving:!1,selectedItem:null,loading:!1,items:null,fetchingMore:!1,quantity:null,userid:null,workorderid:null,purchasedUnUsedItemList:[],selectedUnUsedItems:null,issueForm:null,transactionList:null,selectedIndTrackReturnItem:null,issuedItems:[],purLoading:!0,editQuantityVisibility:!1,selectedIssuedItems:[],price:null,metaFieldTypeMap:{},checkForMultiCurrency:CurrencyUtil/* checkForMultiCurrency */.eu}},mounted:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return"issue"===_this.type?_this.loadPurchasedUnUsedItemsList():"return"===_this.type&&_this.loadIssuedItem(),_context.next=3,(0,CurrencyUtil/* getMetaFieldMapForModules */.en)("purchasedItem");case 3:_this.metaFieldTypeMap=_context.sent;case 4:case"end":return _context.stop()}}),_callee)})))()},computed:(0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({users:function(state){return state.users}})),methods:{cancelForm:function(){this.$emit("update:showItemIssueReturn",!1)},savedForm:function(){this.cancelForm(),this.$emit("refresh")},itemTransaction:function(itemTransactionData,transaction){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var param,_yield$API$createReco,error,successMsg;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return param="ISSUE"===transaction?{issue:!0}:{adjustQuantity:!0},_context2.next=3,api/* API */.bl.createRecord("itemTransactions",{data:itemTransactionData,params:param});case 3:_yield$API$createReco=_context2.sent,error=_yield$API$createReco.error,error?(_this2.$message.error(error.message||_this2.$t("common.wo_report.unable_to_update")),_this2.saving=!1):(successMsg="ISSUE"===transaction?_this2.$t("common.header.item_issued_successfully"):_this2.$t("common.header.item_adjusted_successfully"),_this2.$message.success(successMsg),_this2.savedForm());case 6:case"end":return _context2.stop()}}),_callee2)})))()},saveIssueForm:function(){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var itemTransactionData,_itemTransactionData,param,self,_param,_self;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:if(_this3.userid){_context3.next=4;break}_this3.$message.error(_this3.$t("common._common.choose_user_issue")),_context3.next=21;break;case 4:if(!_this3.userid||_this3.itemType.isRotating){_context3.next=14;break}if(null!==_this3.quantity&&void 0!==_this3.quantity&&"0"!==_this3.quantity){_context3.next=9;break}_this3.$message.error(_this3.$t("common._common.enter_quantity")),_context3.next=12;break;case 9:return itemTransactionData={item:{id:_this3.item.id},parentId:_this3.userid,issuedTo:{ouid:_this3.userid},transactionType:transactionTypeEnum.MANUAL,transactionState:transactionStateEnum.ISSUE,quantity:_this3.quantity,resource:{resourceType:resourceTypeEnum.USER}},_context3.next=12,_this3.itemTransaction(itemTransactionData,"ISSUE");case 12:_context3.next=21;break;case 14:if(!(_this3.userid&&_this3.itemType.isRotating&&_this3.selectedUnUsedItems)){_context3.next=20;break}return _itemTransactionData={item:{id:_this3.item.id},parentId:_this3.userid,issuedTo:{ouid:_this3.userid},transactionType:transactionTypeEnum.MANUAL,transactionState:transactionStateEnum.ISSUE,assetIds:_this3.selectedUnUsedItems,resource:{resourceType:resourceTypeEnum.USER}},_context3.next=18,_this3.itemTransaction(_itemTransactionData,"ISSUE");case 18:_context3.next=21;break;case 20:_this3.workorderid&&!_this3.itemType.isRotating&&_this3.quantity?(param={workorderItems:[{parentId:_this3.workorderid,item:{id:_this3.item.id},quantity:_this3.quantity}]},self=_this3,_this3.$http.post("/v2/workorderItems/addOrUpdate",param).then((function(response){self.loadWoItemParts(),0!==response.data.responseCode?(self.$message.success(_this3.$t("common.header.item_issued_successfully")),self.savedForm()):self.$message.error(response.data.message)})).catch((function(){_this3.$message.error(_this3.$t("common.header.unable_to_update"))}))):_this3.workorderid&&_this3.itemType.isRotating&&(_param={workorderItems:[{parentId:_this3.workorderid,item:{id:_this3.item.id}}],purchasedItems:_this3.selectedUnUsedItems},_self=_this3,_this3.$http.post("/v2/workorderItems/addOrUpdate",_param).then((function(response){_self.loadWoItemParts(),0!==response.data.responseCode?(_self.$message.success(_this3.$t("common.header.item_issued_successfully")),_self.savedForm()):_self.$message.error(response.data.message)})).catch((function(){_this3.$message.error(_this3.$t("common.header.unable_to_update"))})));case 21:case"end":return _context3.stop()}}),_callee3)})))()},saveAdjustmentForm:function(){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){var itemQuantity,itemId,itemTransactionData,qua,quantity,_itemTransactionData2;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:if(itemQuantity=_this4.$getProperty(_this4.item,"quantity",null),itemId=_this4.$getProperty(_this4.item,"id",null),_this4.itemType.isRotating){_context4.next=28;break}if(null!==_this4.quantity&&(void 0!==_this4.quantity||_this4.quantity)){_context4.next=7;break}_this4.$message.error(_this4.$t("common._common.quantity_error")),_context4.next=28;break;case 7:if(!(_this4.quantity<itemQuantity)){_context4.next=13;break}return itemTransactionData={item:{id:itemId},transactionType:transactionTypeEnum.STOCK,transactionState:transactionStateEnum.ADJUSTMENT_DECREASE,quantity:itemQuantity-_this4.quantity},_context4.next=11,_this4.itemTransaction(itemTransactionData,"ADJUST_QUANTITY");case 11:_context4.next=28;break;case 13:if(!(_this4.quantity>itemQuantity)){_context4.next=27;break}if(!(0,validation/* isEmpty */.xb)(_this4.price)){_context4.next=18;break}_this4.$message.error(_this4.$t("common._common.unit_price_error")),_context4.next=25;break;case 18:return qua=0,qua=itemQuantity>=0?itemQuantity:0,quantity=_this4.quantity,quantity-=qua,_itemTransactionData2={item:{id:itemId},purchasedItem:{unitcost:_this4.price,quantity:quantity},transactionType:transactionTypeEnum.STOCK,transactionState:transactionStateEnum.ADJUSTMENT_INCREASE,quantity:quantity},_context4.next=25,_this4.itemTransaction(_itemTransactionData2,"ADJUST_QUANTITY");case 25:_context4.next=28;break;case 27:_this4.$message.error("Unable to Adjust with the same Quantity");case 28:case"end":return _context4.stop()}}),_callee4)})))()},loadPurchasedUnUsedItemsList:function(){var _this5=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee5(){var filters;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context5){while(1)switch(_context5.prev=_context5.next){case 0:if(!_this5.item.itemType.isRotating){_context5.next=7;break}return filters={rotatingItem:{operatorId:36,value:[_this5.item.id+""]},isUsed:{operatorId:15,value:[!1+""]}},_this5.purLoading=!0,_context5.next=5,_this5.$util.getFilteredAssetList(filters);case 5:_this5.purchasedUnUsedItemList=_context5.sent,_this5.purLoading=!1;case 7:case"end":return _context5.stop()}}),_callee5)})))()},toggleUnUsedItemSelection:function(selected){this.selectedUnUsedItems=selected.map((function(value){return value.id}))},toggleReturnItemSelection:function(selected){this.selectedIndTrackReturnItem=selected},getDateTimePurchasedDate:function(val){var value=val.purchasedDate;return value&&-1!==value?this.$options.filters.formatDate(value,!0):""},getDateTimeIssuedTime:function(val){var value=val.sysModifiedTime;return value&&-1!==value?this.$options.filters.formatDate(value,!0):""},loadIssuedItem:function(){var self=this,filters={item:{operatorId:36,value:[this.item.id+""]}};self.loading=!0,this.$http.get("/v2/itemTransactions/view/showItemTransactionListForReturn?showItemsForReturn=true&filters="+encodeURIComponent(JSON.stringify(filters))).then((function(response){for(var i in self.loading=!1,self.issuedItems=response.data.result.itemTransactions,self.issuedItems)self.$set(self.issuedItems[i],"updateQuantity",null)})).catch((function(error){error&&(self.loading=!1,self.fetchingMore=!1)}))},isValid:function(val){if(null!==val&&""!==val&&void 0!==val)return!0},returnItem:function(){var _this6=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee6(){var itemTransaction,i,iTemp,isRotating,_itemTransaction,_i,temp,_isRotating;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context6){while(1)switch(_context6.prev=_context6.next){case 0:if(_this6.itemType.isRotating){_context6.next=16;break}itemTransaction=[],_context6.t0=(0,regeneratorRuntime/* default */.Z)().keys(_this6.issuedItems);case 3:if((_context6.t1=_context6.t0()).done){_context6.next=11;break}if(i=_context6.t1.value,!(_this6.isValid(_this6.issuedItems[i].updateQuantity)&&_this6.issuedItems[i].updateQuantity>_this6.issuedItems[i].remainingQuantity)){_context6.next=8;break}return _this6.$message.error(_this6.$t("common._common.return_quantity_greater_issued")),_context6.abrupt("return");case 8:_this6.isValid(_this6.issuedItems[i].updateQuantity)&&!isNaN(_this6.issuedItems[i].updateQuantity)&&(iTemp={item:{id:_this6.issuedItems[i].item.id},parentTransactionId:_this6.issuedItems[i].id,parentId:_this6.issuedItems[i].parentId,transactionType:_this6.issuedItems[i].transactionType,transactionState:transactionStateEnum.RETURN,quantity:parseInt(_this6.issuedItems[i].updateQuantity)},itemTransaction.push(iTemp)),_context6.next=3;break;case 11:return isRotating=_this6.$getProperty(_this6.itemType,"isRotating",null),_context6.next=14,_this6.returnItemCall(itemTransaction,isRotating);case 14:_context6.next=22;break;case 16:if(!_this6.itemType.isRotating){_context6.next=22;break}for(_i in _itemTransaction=[],_this6.selectedIndTrackReturnItem)temp={item:{id:_this6.selectedIndTrackReturnItem[_i].item.id},parentId:_this6.selectedIndTrackReturnItem[_i].parentId,parentTransactionId:_this6.selectedIndTrackReturnItem[_i].id,transactionType:_this6.selectedIndTrackReturnItem[_i].transactionType,transactionState:transactionStateEnum.RETURN,assetIds:[_this6.selectedIndTrackReturnItem[_i].asset.id]},_itemTransaction.push(temp);return _isRotating=_this6.$getProperty(_this6.itemType,"isRotating"),_context6.next=22,_this6.returnItemCall(_itemTransaction,_isRotating);case 22:case"end":return _context6.stop()}}),_callee6)})))()},returnItemCall:function(itemTransaction,rotating){var _this7=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee7(){var url,params,_yield$API$post,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context7){while(1)switch(_context7.prev=_context7.next){case 0:if(!(itemTransaction.length<1)){_context7.next=4;break}_this7.$message.error(_this7.$t("common._common.return_error")),_context7.next=11;break;case 4:return url="v3/modules/data/bulkCreate",params={data:{itemTransactions:itemTransaction},moduleName:"itemTransactions",params:{return:!0}},_context7.next=8,api/* API */.bl.post(url,params);case 8:_yield$API$post=_context7.sent,error=_yield$API$post.error,error?_this7.$message.error(error.message||_this7.$t("common.wo_report.unable_to_update")):(_this7.$message.success(_this7.$t("common.header.item_returned_successfully")),_this7.loadIssuedItem(),rotating&&(_this7.selectedIndTrackReturnItem=null),_this7.savedForm());case 11:case"end":return _context7.stop()}}),_callee7)})))()},selectIssuedItemActions:function(val){this.selectedIssuedItems=val},markAsFullyReturned:function(val){var _this8=this;val.forEach((function(element){_this8.selectedIssuedItems.forEach((function(obj){element.id===obj.id&&(element.updateQuantity=element.remainingQuantity)}))})),this.$refs.returnTable.clearSelection()},setCurrencyCodeInSubform:function(currencyCode,exchangeRate){var _ref=this.item||{},purchasedItem=_ref.purchasedItem;this.$setProperty(this.item,"purchasedItem",(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},purchasedItem||{}),{},{currencyCode:currencyCode,exchangeRate:exchangeRate}))},calculateExchangeRate:function(rateObj){var _ref2=this.item||{},purchasedItem=_ref2.purchasedItem;purchasedItem.unitcost=(0,CurrencyUtil/* getCalculatedCurrencyValue */.sd)(rateObj,purchasedItem.unitcost),this.$setProperty(this.item,"purchasedItem",(0,objectSpread2/* default */.Z)({},purchasedItem||{}))}}},Items_ItemIssueReturnvue_type_script_lang_js=ItemIssueReturnvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(Items_ItemIssueReturnvue_type_script_lang_js,ItemIssueReturnvue_type_template_id_1f2fc71e_scoped_true_render,ItemIssueReturnvue_type_template_id_1f2fc71e_scoped_true_staticRenderFns,!1,null,"1f2fc71e",null)
/* harmony default export */,ItemIssueReturn=component.exports,UpdateItemForm=__webpack_require__(910774),StockItem=__webpack_require__(198625),FetchViewsMixin=__webpack_require__(646716),router=__webpack_require__(329435),ItemSummaryvue_type_script_lang_js={extends:CustomModuleSummary["default"],props:["viewname"],mixins:[FetchViewsMixin/* default */.Z],components:{ItemAvatar:ItemTool/* default */.Z,ItemIssueReturn:ItemIssueReturn,UpdateItemForm:UpdateItemForm/* default */.Z,StockItem:StockItem/* default */.Z},data:function(){return{notesModuleName:"itemnotes",attachmentsModuleName:"itemattachments",primaryFields:["localId","category","lastPurchasedDate","lastPurchasedPrice","reservedQuantity","storeRoom","quantity"],newFormVisibility:!1,itemEditObj:!1,emitForm:!1,resetForm:!1,saving:!1,showPreviewImage:!1,showItemIssueReturn:!1,refreshItemTransactions:!1,refreshItemStoreRoom:!1,editId:null,stockItemVisibility:!1}},computed:{moduleName:function(){return"item"},rotating:function(){return this.$getProperty(this,"record.itemType.isRotating")},photoUrl:function(){return this.$getProperty(this,"record.itemType.photoUrl",null)}},title:function(){},methods:{openStockItem:function(){this.stockItemVisibility=!0},editData:function(data){this.newFormVisibility=!0,this.itemEditObj=data,this.editId=data.id},refreshItem:function(){this.refreshItemTransactions=!0,this.refreshItemStoreRoom=!0,this.loadRecord(!0)},openIssueDialog:function(){this.showItemIssueReturn=!0,this.issueReturnType="issue"},openReturnDialog:function(){this.showItemIssueReturn=!0,this.issueReturnType="return"},openAdjustmentDialog:function(){this.showItemIssueReturn=!0,this.issueReturnType="adjustment"},summaryDropDownAction:function(action){if("adjust_balance"===action)this.openAdjustmentDialog();else if("issue_item"===action)this.openIssueDialog();else if("return_item"===action)this.openReturnDialog();else if("edit"===action){var record=this.record;this.editData(record)}else"go_to_itemType"===action&&this.redirectToItemTypeSummary(this.$getProperty(this.record,"itemType.id"))},redirectToItemTypeSummary:function(id){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var moduleName,currentView,_ref,name;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return moduleName="itemTypes",_context.next=3,_this.fetchView(moduleName);case 3:currentView=_context.sent,(0,router/* isWebTabsEnabled */.tj)()?(_ref=(0,router/* findRouteForModule */.Jp)(moduleName,router/* pageTypes */.As.OVERVIEW)||{},name=_ref.name,name&&_this.$router.push({name:name,params:{viewname:currentView,id:id}})):_this.$router.push({name:"itemtypeSummary",params:{viewname:currentView,id:id}});case 5:case"end":return _context.stop()}}),_callee)})))()},showAvatarPreview:function(){this.photoUrl&&(this.showPreviewImage=!0)},cancelForm:function(){this.resetForm=!0,this.newFormVisibility&&(this.newFormVisibility=!1)},canIssueItem:function(record){var _ref2=record||{},itemType=_ref2.itemType,storeRoom=_ref2.storeRoom,_ref3=itemType||{},consumable=_ref3.consumable,rotating=_ref3.rotating,approvalNeeded=_ref3.approvalNeeded,_ref4=storeRoom||{},storeRoomApproval=_ref4.approvalNeeded;return!(approvalNeeded||storeRoomApproval)&&consumable&&!rotating},canReturnItem:function(record){var _ref5=record||{},itemType=_ref5.itemType,_ref6=itemType||{},consumable=_ref6.consumable,rotating=_ref6.rotating;return consumable&&!rotating},submitForm:function(data){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var record,purchasedItems,storeRoomId,param,i,url,_yield$API$post,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if(record=_this2.record,purchasedItems=data.purchasedItems,storeRoomId=_this2.$getProperty(data,"storeRoom.id"),!_this2.newFormVisibility){_context2.next=14;break}if(_this2.newFormVisibility=!1,!record.isRotating)for(i=purchasedItems.length-1;i>=0;i--)purchasedItems[i].hasOwnProperty("unitcost")&&null===purchasedItems[i].unitcost&&purchasedItems[i].hasOwnProperty("serialNumber")&&null===purchasedItems[i].serialNumber&&purchasedItems.splice(i,1);return param={storeRoom:storeRoomId,item:data},url="/v2/item/add",_context2.next=10,api/* API */.bl.post(url,param);case 10:_yield$API$post=_context2.sent,error=_yield$API$post.error,error?_this2.$message.error(error):(_this2.$message.success(_this2.$t("common._common.added_successfully")),_this2.loadRecord(!0)),_this2.cancelForm();case 14:_this2.emitForm=!1;case 15:case"end":return _context2.stop()}}),_callee2)})))()}}},Items_ItemSummaryvue_type_script_lang_js=ItemSummaryvue_type_script_lang_js,ItemSummary_component=(0,componentNormalizer/* default */.Z)(Items_ItemSummaryvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,ItemSummary=ItemSummary_component.exports},
/***/910774:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return UpdateItemForm}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/Inventory/Items/UpdateItemForm.vue?vue&type=template&id=7f26ea7a
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("el-dialog",{attrs:{visible:_vm.visibility,"before-close":_vm.closeDialog,"append-to-body":!0,title:_vm.formDisplayName,fullscreen:!0,"custom-class":"fc-dialog-form setup-dialog50 setup-dialog fc-web-form-dialog f-webform-right-dialog"},on:{"update:visible":function($event){_vm.visibility=$event}}},[_vm.isLoading?_vm._e():_c("div",{staticClass:"fc-pm-main-content-H"},[_vm._v(" "+_vm._s(_vm.formDisplayName)+" ")]),_vm.isLoading?_c("div",{staticClass:"loading-container d-flex"},[_c("Spinner",{attrs:{show:_vm.isLoading}})],1):_c("f-webform",{attrs:{form:_vm.formObj,module:_vm.moduleName,moduleDisplayName:_vm.formDisplayName,isSaving:_vm.isSaving,canShowPrimaryBtn:!0,canShowSecondaryBtn:!0,moduleDataId:_vm.moduleDataId,isEdit:!_vm.$validation.isEmpty(_vm.moduleDataId),modifyFieldPropsHook:_vm.modifyFieldPropsHook},on:{"update:form":function($event){_vm.formObj=$event},save:_vm.saveRecord,cancel:_vm.closeDialog}})],1)],1)},staticRenderFns=[],objectSpread2=__webpack_require__(595082),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),FWebform=(__webpack_require__(434284),__webpack_require__(976801),__webpack_require__(434500)),FormCreation=__webpack_require__(373729),api=__webpack_require__(32284),validation=__webpack_require__(990260),UpdateItemFormvue_type_script_lang_js={extends:FormCreation/* default */.Z,components:{FWebform:FWebform/* default */.Z},props:["itemData","visibility","editId"],data:function(){return{isSaving:!1}},computed:{formDisplayName:function(){return(this.formObj||{}).displayName},moduleDisplayName:function(){return this.formObj&&this.formObj.module?this.formObj.module.displayName:""},moduleDataId:function(){return this.editId},moduleName:function(){return"item"},isV3Api:function(){return!0}},methods:{saveRecord:function(formModel){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var formObj,moduleName,moduleDataId,formId,response,data,_response,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return formObj=_this.formObj,moduleName=_this.moduleName,moduleDataId=_this.moduleDataId,formId=formModel.formId,response={},data=_this.serializedData(formObj,formModel),(0,validation/* isEmpty */.xb)(formId)||(data.formId=formId),(0,validation/* isEmpty */.xb)(moduleDataId)||(data.id=moduleDataId),_this.isSaving=!0,_context.next=9,api/* API */.bl.updateRecord(moduleName,{id:moduleDataId,data:data});case 9:response=_context.sent,_this.isSaving=!1,
// Hook to handle notification after crud operation
_this.notificationHandler(response),_response=response,error=_response.error,error||(_this.$emit("saved"),_this.closeDialog());case 14:case"end":return _context.stop()}}),_callee)})))()},closeDialog:function(){this.$emit("update:visibility",!1)},modifyFieldPropsHook:function(field){var _ref=field||{},name=_ref.name,rotating=this.$getProperty(this,"itemData.itemType.rotating");return["itemType","storeRoom"].includes(name)?(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},field),{},{isDisabled:!0}):"costType"===name&&rotating?(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},field),{},{hideField:!0}):"issuanceCost"!==name||rotating?void 0:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},field),{},{hideField:!0})}}},Items_UpdateItemFormvue_type_script_lang_js=UpdateItemFormvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(Items_UpdateItemFormvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,UpdateItemForm=component.exports},
/***/198625:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return StockItem}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/Inventory/Items/components/StockItem.vue?vue&type=template&id=3d3bb76c&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("el-dialog",{attrs:{visible:_vm.visibility,"before-close":_vm.closeDialog,"append-to-body":!0,title:_vm.$t("common.header.stock_item"),fullscreen:!0,"custom-class":"fc-dialog-form setup-dialog50 setup-dialog fc-web-form-dialog f-webform-right-dialog"},on:{"update:visible":function($event){_vm.visibility=$event}}},[_c("div",{staticClass:"fc-pm-main-content-H pL30"},[_vm._v(" "+_vm._s(_vm.$t("common.header.stock_item"))+" ")]),_c("div",{staticClass:"p30 pT20 facilio-inventory-web-form-body"},[_c("el-row",{staticClass:"pB10"},[_c("el-col",{attrs:{span:24}},[_c("p",{staticClass:"stock-form-field pB5"},[_vm._v(" "+_vm._s(_vm.$t("common.header.item_type"))+" ")]),_c("FLookupFieldWrapper",{staticClass:"fc-input-full-border2 width100",attrs:{disabled:"",field:_vm.itemTypesLookupData},model:{value:_vm.getItemtype,callback:function($$v){_vm.getItemtype=$$v},expression:"getItemtype"}})],1)],1),_c("el-row",{staticClass:"pB10"},[_c("el-col",{attrs:{span:24}},[_c("p",{staticClass:"stock-form-field pB5"},[_vm._v(" "+_vm._s(_vm.$t("common.products.storeroom"))+" ")]),"itemTypes"===_vm.moduleName?_c("FLookupFieldWrapper",{staticClass:"fc-input-full-border2 width100 ",attrs:{field:_vm.storeRoomLookupData},model:{value:_vm.storeRoomId,callback:function($$v){_vm.storeRoomId=$$v},expression:"storeRoomId"}}):"storeRoom"===_vm.moduleName||"item"===_vm.moduleName?_c("FLookupFieldWrapper",{staticClass:"fc-input-full-border2 width100 ",attrs:{disabled:"",field:_vm.storeRoomLookupData},model:{value:_vm.getStoreroom,callback:function($$v){_vm.getStoreroom=$$v},expression:"getStoreroom"}}):_vm._e()],1)],1),_vm.isRotating?_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("p",{staticClass:"cost-form-field pB5"},[_vm._v(" "+_vm._s(_vm.$t("common.inventory.issuance_cost"))+" ")]),_c("el-input",{staticClass:"fc-input-full-border2 width100 ",attrs:{type:"number",min:0},model:{value:_vm.issuanceCost,callback:function($$v){_vm.issuanceCost=$$v},expression:"issuanceCost"}})],1)],1):_vm._e(),_vm.isRotating?_vm._e():_c("el-row",[_c("el-col",{attrs:{span:24}},[_c("div",{staticClass:"position-relative"},[_c("div",{staticClass:"stock-form-field mT20  mB10"},[_vm._v(" "+_vm._s(_vm.$t("common.products.purchased_items"))+" ")]),_c("table",{staticClass:"setting-list-view-table fc-inventory-item-table store-table"},[_c("thead",[_c("tr",[_c("th",{staticClass:"setting-table-th setting-th-text uppercase",staticStyle:{width:"240px"}},[_vm._v(" "+_vm._s(_vm.$t("common._common.quantity"))+" ")]),_c("th",{class:[!_vm.checkForMultiCurrency("unitcost",_vm.metaFieldTypeMap)&&"setting-table-th","setting-th-text uppercase"],staticStyle:{width:"240px"}},[_vm._v(" "+_vm._s(_vm.$t("common.header.unit_price"))+" ")]),_c("th")])]),_c("tbody",_vm._l(_vm.purchasedItems,(function(purchasedItem,index){return _c("tr",{key:index,staticClass:"visibility-visible-actions"},[_c("td",{staticClass:"module-builder-td"},[_c("el-input",{staticClass:"fc-input-full-border-select2 duration-input",attrs:{placeholder:_vm.$t("common._common.quantity"),type:"number",min:0},model:{value:purchasedItem.quantity,callback:function($$v){_vm.$set(purchasedItem,"quantity",$$v)},expression:"purchasedItem.quantity"}})],1),_vm.checkForMultiCurrency("unitcost",_vm.metaFieldTypeMap)?_c("td",{staticClass:"item-unit-price-currency"},[_c("FNewCurrencyField",{key:purchasedItem.currencyCode,attrs:{isSubform:!0,moduleData:purchasedItem},on:{setCurrencyCodeInSubform:function(code,rate){return _vm.setCurrencyCodeInSubform(code,rate,index)},calculateExchangeRate:function(rateObj){return _vm.calculateExchangeRate(rateObj,index)}},model:{value:purchasedItem.unitcost,callback:function($$v){_vm.$set(purchasedItem,"unitcost",$$v)},expression:"purchasedItem.unitcost"}})],1):_c("td",{staticClass:"module-builder-td"},[_c("el-input",{staticClass:"fc-input-full-border-select2 duration-input",attrs:{placeholder:_vm.$t("common.header.unit_price"),type:"number",min:0},model:{value:purchasedItem.unitcost,callback:function($$v){_vm.$set(purchasedItem,"unitcost",$$v)},expression:"purchasedItem.unitcost"}})],1),_c("td",[_c("div",{staticClass:"flex-middle"},[_vm.purchasedItems.length-1===index?_c("i",{staticClass:"el-icon-circle-plus-outline fc-row-add-icon f20 bold pL5",on:{click:function($event){return _vm.addPurchasedItems()}}}):_vm._e(),_vm.purchasedItems.length>1?_c("i",{staticClass:"el-icon-remove-outline fc-row-delete-icon f20 bold pL10",on:{click:function($event){return _vm.removePurchasedItems(index)}}}):_vm._e()])])])})),0)])])])],1)],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){return _vm.closeDialog()}}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary",loading:_vm.saving},on:{click:_vm.saveRecord}},[_vm._v(_vm._s(_vm.$t("common._common._save")))])],1)])],1)},staticRenderFns=[],objectSpread2=__webpack_require__(595082),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),picklist=(__webpack_require__(976801),__webpack_require__(670560),__webpack_require__(162506),__webpack_require__(648324),__webpack_require__(961358)),utility_methods=__webpack_require__(773258),constant=__webpack_require__(354754),api=__webpack_require__(32284),FLookupFieldWrapper=__webpack_require__(201117),validation=__webpack_require__(990260),FNewCurrencyField=__webpack_require__(533206),CurrencyUtil=__webpack_require__(15426),StockItemvue_type_script_lang_js={props:["visibility","record","moduleName"],components:{FLookupFieldWrapper:FLookupFieldWrapper/* default */.Z,FNewCurrencyField:FNewCurrencyField/* default */.Z},data:function(){return{saving:!1,storerooms:{},issuanceCost:null,data:{},purchasedItems:[{quantity:null,unitcost:null}],storeRoomId:null,itemId:null,itemsList:[],itemTypesLookupData:{lookupModule:{name:"itemTypes"},multiple:!1},storeRoomLookupData:{lookupModule:{name:"storeRoom"},multiple:!1},metaFields:[],metaFieldTypeMap:{},checkForMultiCurrency:CurrencyUtil/* checkForMultiCurrency */.eu}},created:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _this.loadPickList(),_context.next=3,(0,CurrencyUtil/* getMetaFieldMapForModules */.en)("purchasedItem");case 3:_this.metaFieldTypeMap=_context.sent;case 4:case"end":return _context.stop()}}),_callee)})))()},computed:{getItemtype:function(){return["item","storeRoom"].includes(this.moduleName)?this.$getProperty(this,"record.itemType.id"):this.$getProperty(this,"record.id")},itemtypeId:function(){return"itemTypes"===this.moduleName?this.$getProperty(this,"record.id"):this.$getProperty(this,"record.itemType.id")},getStoreroom:function(){return this.$getProperty(this,"record.storeRoom.id")},storeId:function(){var storeRoomId=this.storeRoomId,getStoreroom=this.getStoreroom,moduleName=this.moduleName;return"itemTypes"===moduleName?storeRoomId:getStoreroom},isRotating:function(){return"itemTypes"===this.moduleName?this.$getProperty(this,"record.rotating",null):"storeRoom"===this.moduleName&&this.$getProperty(this,"record.itemType.isRotating",null)}},methods:{addPurchasedItems:function(){var purchasedItems=this.purchasedItems;purchasedItems.push((0,utility_methods/* deepCloneObject */.kh)(constant/* default */.Z.PURCHASEDITEM_DEFAULTS))},removePurchasedItems:function(index){var purchasedItems=this.purchasedItems;purchasedItems.splice(index,1)},loadPickList:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var _yield$getFieldOption,error,options;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _this2.storerooms={},_context2.next=3,(0,picklist/* getFieldOptions */._K)({field:{lookupModuleName:"storeRoom",skipDeserialize:!0}});case 3:_yield$getFieldOption=_context2.sent,error=_yield$getFieldOption.error,options=_yield$getFieldOption.options,error?_this2.$message.error(error.message||"Error Occured"):_this2.storerooms=options;case 7:case"end":return _context2.stop()}}),_callee2)})))()},setCurrencyCodeInSubform:function(currencyCode,exchangeRate,index){var purchasedItems=this.purchasedItems,purchasedItem=purchasedItems[index];purchasedItems.splice(index,1,(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},purchasedItem),{},{currencyCode:currencyCode,exchangeRate:exchangeRate}))},calculateExchangeRate:function(rateObj,index){var purchasedItems=this.purchasedItems,purchasedItem=purchasedItems[index];purchasedItem.unitcost=(0,CurrencyUtil/* getCalculatedCurrencyValue */.sd)(rateObj,purchasedItem.unitcost),purchasedItems.splice(index,1,purchasedItem)},saveRecord:function(){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var recordId,purchasedItems,record,storeId,itemtypeId,isRotating,issuanceCost,_ref,currencyCode,exchangeRate,lastPurchasedLineItem,promise,status,itemId,itemRecord,_ref2,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:if(_this3.saving=!0,recordId=_this3.$getProperty(_this3,"record.id"),purchasedItems=_this3.purchasedItems,record=_this3.record,storeId=_this3.storeId,itemtypeId=_this3.itemtypeId,isRotating=_this3.isRotating,issuanceCost=_this3.issuanceCost,_ref=record||{},currencyCode=_ref.currencyCode,exchangeRate=_ref.exchangeRate,(0,validation/* isEmpty */.xb)(purchasedItems)||(lastPurchasedLineItem=purchasedItems[purchasedItems.length-1],currencyCode=lastPurchasedLineItem.currencyCode,exchangeRate=lastPurchasedLineItem.exchangeRate),null!==purchasedItems[0].quantity&&null!==purchasedItems[0].unitcost||isRotating){_context3.next=9;break}_this3.$message.error("Please enter Purchased Items"),_context3.next=53;break;case 9:if("item"!==_this3.moduleName){_context3.next=17;break}return record.purchasedItems=purchasedItems,record=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},record),{},{currencyCode:currencyCode,exchangeRate:exchangeRate}),_context3.next=14,api/* API */.bl.updateRecord("item",{id:recordId,data:record});case 14:promise=_context3.sent,_context3.next=44;break;case 17:if(!["itemTypes","storeRoom"].includes(_this3.moduleName)){_context3.next=44;break}if(!(0,validation/* isEmpty */.xb)(storeId)){_context3.next=22;break}_this3.$message.error("Please Select the Storeroom"),_context3.next=44;break;case 22:return _context3.next=24,_this3.isAlreadyPresentInStore();case 24:if(status=_context3.sent,!status||!isRotating){_context3.next=29;break}return _this3.$message.error("Item already present in storeroom"),_this3.saving=!1,_context3.abrupt("return");case 29:if(itemId=_this3.itemId,itemRecord={itemType:{id:itemtypeId},storeRoom:{id:storeId}},itemRecord=(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},itemRecord),{},{currencyCode:currencyCode,exchangeRate:exchangeRate}),isRotating||(itemRecord["purchasedItems"]=purchasedItems),!(0,validation/* isEmpty */.xb)(issuanceCost)&&isRotating&&(itemRecord["issuanceCost"]=issuanceCost),!status){_context3.next=40;break}return _context3.next=37,api/* API */.bl.updateRecord("item",{id:itemId,data:itemRecord});case 37:promise=_context3.sent,_context3.next=44;break;case 40:return itemRecord["costType"]=1,_context3.next=43,api/* API */.bl.createRecord("item",{data:itemRecord});case 43:promise=_context3.sent;case 44:if((0,validation/* isEmpty */.xb)(promise)){_context3.next=53;break}return _context3.next=47,promise;case 47:if(_context3.t0=_context3.sent,_context3.t0){_context3.next=50;break}_context3.t0={};case 50:_ref2=_context3.t0,error=_ref2.error,error?_this3.$message.error(error.message||_this3.$t("common._common.error_stock_items")):(_this3.closeDialog(),_this3.$message.success(_this3.$t("common.header.item_added_successfully")),_this3.$emit("saved"));case 53:_this3.saving=!1;case 54:case"end":return _context3.stop()}}),_callee3)})))()},isAlreadyPresentInStore:function(){var _this4=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee4(){var params,_yield$API$fetchAll,list,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context4){while(1)switch(_context4.prev=_context4.next){case 0:return params={filters:JSON.stringify({itemType:{operatorId:36,value:[_this4.itemtypeId+""]},storeRoom:{operatorId:36,value:[_this4.storeId+""]}})},_context4.next=3,api/* API */.bl.fetchAll("item",params);case 3:if(_yield$API$fetchAll=_context4.sent,list=_yield$API$fetchAll.list,error=_yield$API$fetchAll.error,!error){_context4.next=11;break}return _this4.$message.error(error||"Error ocurred while checking the availability"),_context4.abrupt("return",!1);case 11:return list.length>0&&(_this4.itemId=list[0].id),_context4.abrupt("return",list.length>0);case 13:case"end":return _context4.stop()}}),_callee4)})))()},closeDialog:function(){this.$emit("update:visibility",!1),this.purchasedItems=[{quantity:null,unitcost:null}],this.storeRoomId=null}}},components_StockItemvue_type_script_lang_js=StockItemvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_StockItemvue_type_script_lang_js,render,staticRenderFns,!1,null,"3d3bb76c",null)
/* harmony default export */,StockItem=component.exports},
/***/400438:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return ApprovalUserAvatar}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/approvals/components/ApprovalUserAvatar.vue?vue&type=template&id=443099a5&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"inline"},[_c("div",{staticClass:"fc-avatar-element q-item-division relative-position"},[_c("div",{staticClass:"q-item-side-left q-item-section"},[_vm.hasUser?_c("avatarPopover",{attrs:{user:_vm.userObj,moduleName:_vm.moduleName}},[_c("span",{attrs:{slot:"reference"},slot:"reference"},[_c("avatar",{attrs:{size:_vm.size,user:_vm.userObj,color:_vm.color}})],1)]):_vm.fieldType?_c("avatarPopover",{attrs:{user:_vm.fieldTypeUserValue,moduleName:_vm.moduleName}},[_c("span",{attrs:{slot:"reference"},slot:"reference"},[_c("avatar",{attrs:{size:_vm.size,user:_vm.fieldTypeUserValue,color:_vm.color}})],1)]):_c("div",{class:["icon-border",_vm.userTypeIcon[_vm.userType.type].background]},[_c("inline-svg",{class:["mT2",_vm.userTypeIcon[_vm.userType.type].marginLeft],attrs:{src:_vm.userTypeIcon[_vm.userType.type].icon,iconClass:"icon text-center fc-fill-path fill-path-white "+_vm.userTypeIcon[_vm.userType.type].iconSize}})],1)],1),_c("div",{staticClass:"flex-middle"},[_vm.$validation.isObject(_vm.typeLabel)?_c("span",{staticClass:"q-item-label d-flex flex-wrap"},[_vm._v(" "+_vm._s(_vm.typeLabel.value)+" "),_vm.typeLabel.type?_c("span",{staticClass:"text-fc-grey mL5"},[_vm._v(" ("+_vm._s(_vm.typeLabel.type)+") ")]):_vm._e()]):_c("span",{staticClass:"q-item-label d-flex flex-wrap user-type"},[_vm._v(" "+_vm._s(_vm.typeLabel)+" ")]),_vm.approvers.length>1?_c("el-popover",{attrs:{placement:"bottom",width:"200",trigger:"hover"}},[_vm._t("default",(function(){return[_c("div",{staticClass:"approvers-more-icon"},[_vm._v("+"+_vm._s(_vm.approvers.length-1))])]}),{slot:"reference"}),_c("div",_vm._l(_vm.approvers.slice(1),(function(approver){return _c("div",{key:approver.name,staticClass:"mB10"},[_c("ApprovalUserAvatar",{attrs:{size:"md",user:approver,userType:_vm.getApproverType(approver),moduleName:_vm.moduleName,approvalMeta:_vm.approvalMeta}})],1)})),0)],2):_vm._e()],1)])])},staticRenderFns=[],validation=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(434284),__webpack_require__(990260)),User=__webpack_require__(426803),ApprovalUserAvatarvue_type_script_lang_js={name:"ApprovalUserAvatar",extends:User/* default */.Z,props:["userType","approvalMeta","approverObj"],computed:{hasUser:function(){var id=this.$getProperty(this.userObj,"id");return!(0,validation/* isEmpty */.xb)(id)},fieldType:function(){var _this$userType=this.userType,type=_this$userType.type,value=_this$userType.value;return"FIELD"===type&&!(0,validation/* isEmpty */.xb)(value)},fieldTypeUserValue:function(){var fieldType=this.fieldType,userType=this.userType,value=userType.value;return fieldType?(0,validation/* isArray */.kJ)(value)&&!(0,validation/* isEmpty */.xb)(value)?value[0]:value:null},fieldName:function(){var approverObj=this.approverObj,approvalMeta=this.approvalMeta,_ref=approvalMeta||{},_ref$approvalList=_ref.approvalList,approvalList=void 0===_ref$approvalList?[]:_ref$approvalList;if(!(0,validation/* isEmpty */.xb)(approvalList)){var displayName=approvalList.find((function(list){return list.approverGroup===approverObj.approverGroup})).field.displayName;return displayName}return null},color:function(){return-1!==this.userObj.id||this.fieldType?"":this.group?"#c3c3c3":"#e3e3e3"},userTypeIcon:function(){var userIcon={TENANT:{icon:"svgs/tenant",background:"green",iconSize:"icon-lg",marginLeft:"mL4"},VENDOR:{icon:"svgs/apps/vendor",background:"orange",iconSize:"icon-lg",marginLeft:"mL4"},ROLE:{icon:"svgs/role",background:"yellow",iconSize:"icon-xl",marginLeft:"mL3"},GROUP:{icon:"svgs/team",background:"blue",iconSize:"icon-xl",marginLeft:"mL3"},FIELD:{icon:"user",background:"brown",iconSize:"icon-lg",marginLeft:"mL4"}};return userIcon},typeLabel:function(){var _this$userType2=this.userType,type=_this$userType2.type,value=_this$userType2.value;if("USER"===type)return{value:this.userObj.name,type:null};if("TENANT"===type)return value?{value:value.name,type:"Tenant"}:"Tenant";if("VENDOR"===type)return value?{value:value.name,type:"Vendor"}:"Vendor";if("FIELD"===type){var _ref2=this.fieldTypeUserValue||{},name=_ref2.name;return{value:name||this.fieldName,type:"Field"}}return value.name},approvers:function(){var _this$userType3=this.userType,type=_this$userType3.type,value=_this$userType3.value;return"USER"===type?[this.userObj]:(0,validation/* isArray */.kJ)(value)?value:[value]}},methods:{getApproverType:function(approver){return approver.id?{type:"USER",value:approver}:approver}}},components_ApprovalUserAvatarvue_type_script_lang_js=ApprovalUserAvatarvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_ApprovalUserAvatarvue_type_script_lang_js,render,staticRenderFns,!1,null,"443099a5",null)
/* harmony default export */,ApprovalUserAvatar=component.exports},
/***/848277:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return CustomModuleSummary}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/custom-module/CustomModuleSummary.vue?vue&type=template&id=2c44e6b2&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"custom-module-overview",class:_vm.customClass},[_vm.isLoading?_c("div",{staticClass:"flex-middle fc-empty-white"},[_c("spinner",{attrs:{show:_vm.isLoading,size:"80"}})],1):_vm.$validation.isEmpty(_vm.record)?_vm._e():[_c("div",{staticClass:"header p20"},[_c("div",{staticClass:"custom-module-details"},[_c("div",{staticClass:"d-flex flex-middle align-center"},[_vm.showPhotoField?_c("div",{staticClass:"mR5"},[_vm.record[_vm.photoFieldName]?_c("div",[_vm.$helpers.isLicenseEnabled("THROW_403_WEBTAB")?_c("img",{staticClass:"img-container",attrs:{src:_vm.record.getImageUrl("photoUrl")}}):_c("img",{staticClass:"img-container",attrs:{src:_vm.record.getImage(_vm.photoFieldName)}})]):_vm.showAvatar?_c("div",[_c("avatar",{attrs:{size:"lg",user:{name:_vm.record.name}}})],1):_vm._e()]):_vm._e(),_c("div",{staticClass:"mL5"},[_c("div",{staticClass:"custom-module-id"},[_vm.$account.portalInfo?_c("i",{directives:[{name:"tippy",rawName:"v-tippy",value:{animateFill:!1,animation:"shift-toward"},expression:"{ animateFill: false, animation: 'shift-toward' }"}],staticClass:"el-icon-back fc-grey3-text14 fw6 pR10 pointer",attrs:{content:"back",arrow:""},on:{click:_vm.back}}):_vm._e(),_vm._v(" #"+_vm._s(_vm.record&&_vm.record.id)+" ")]),_c("div",{staticClass:"custom-module-name "},[_c("div",{staticClass:"d-flex max-width300px"},[_c("el-tooltip",{attrs:{placement:"bottom",effect:"dark",content:_vm.record[_vm.mainFieldKey]}},[_c("span",{staticClass:"whitespace-pre-wrap custom-header"},[_vm._v(_vm._s(_vm.record[_vm.mainFieldKey]))])])],1),_vm.record.isStateFlowEnabled()&&_vm.record.currentModuleState()?_c("div",{staticClass:"fc-badge text-uppercase inline vertical-middle mL15"},[_vm._v(" "+_vm._s(_vm.record.currentModuleState())+" ")]):_vm._e()])])])]),_c("div",{staticClass:"marginL-auto flex-middle"},[_c("CustomButton",{staticClass:"pR10",attrs:{record:_vm.record,moduleName:_vm.moduleName,position:_vm.POSITION.SUMMARY},on:{refresh:function($event){return _vm.refreshData()},onError:function(){}}}),_vm.record.isStateFlowEnabled()?[_c("TransitionButtons",{key:_vm.record.id+"transitions",staticClass:"mR10",attrs:{moduleName:_vm.moduleName,record:_vm.record,disabled:_vm.record.isApprovalEnabled(),buttonClass:"asset-el-btn"},on:{currentState:function(){},transitionSuccess:function($event){return _vm.refreshData()},transitionFailure:function(){}}})]:_vm._e(),_vm.record.isApprovalEnabled()?_c("portal",{attrs:{to:"pagebuilder-sticky-top"}},[_c("ApprovalBar",{key:_vm.record.id+"approval-bar",staticClass:"approval-bar-shadow",attrs:{moduleName:_vm.moduleName,record:_vm.record,hideApprovers:_vm.shouldHideApprovers},on:{onSuccess:function($event){return _vm.refreshData()},onFailure:function(){}}})],1):_vm._e(),_vm.showEdit?_c("el-button",{staticClass:"fc-wo-border-btn pL15 pR15 self-center",attrs:{type:"button"},on:{click:_vm.editRecord}},[_c("i",{staticClass:"el-icon-edit"})]):_vm._e()],2)]),_c("Page",{key:_vm.record.id,attrs:{module:_vm.moduleName,id:_vm.record.id,details:_vm.record,primaryFields:_vm.primaryFields,notesModuleName:_vm.notesModuleName,isV3Api:!0,attachmentsModuleName:_vm.attachmentsModuleName}})]],2)},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),PageBuilder=(__webpack_require__(425728),__webpack_require__(260228),__webpack_require__(434284),__webpack_require__(670560),__webpack_require__(760218)),api=__webpack_require__(32284),router=__webpack_require__(329435),CustomButton=__webpack_require__(623857),CustomButtonUtil=__webpack_require__(746095),TransitionButtons=__webpack_require__(987612),ApprovalBar=__webpack_require__(42525),constant=__webpack_require__(354754),CustomModuleData=__webpack_require__(689565),eventBus=__webpack_require__(398011),CustomModuleSummaryvue_type_script_lang_js={name:"CustomModuleSummary",components:{Page:PageBuilder/* default */.Z,CustomButton:CustomButton/* default */.Z,TransitionButtons:TransitionButtons/* default */.Z,ApprovalBar:ApprovalBar/* default */.Z},data:function(){return{isLoading:!1,record:null,primaryFields:[],notesModuleName:"cmdnotes",attachmentsModuleName:"cmdattachments",formFields:null,POSITION:CustomButtonUtil/* POSITION_TYPE */.Rz,customClass:""}},created:function(){this.$store.dispatch("loadApprovalStatus")},mounted:function(){eventBus/* eventBus */.Y.$on("refresh-overview",this.refreshData)},beforeDestroy:function(){eventBus/* eventBus */.Y.$off("refresh-overview",this.refreshData)},computed:{moduleName:function(){return this.$route.params.moduleName?this.$route.params.moduleName:this.$attrs.moduleName||""},id:function(){var paramId=this.$attrs.id||this.$route.params.id;return paramId&&"null"!==paramId?parseInt(this.$route.params.id):""},showEdit:function(){var $org=this.$org,$hasPermission=this.$hasPermission,record=this.record,orgIdsToCheck=constant/* default */.Z.isCustomModulePermissionsEnabled,canShowEdit=!orgIdsToCheck($org.id)&&!(0,router/* isWebTabsEnabled */.tj)()||$hasPermission("".concat(this.moduleName,":UPDATE"));return canShowEdit&&record.canEdit()},mainFieldKey:function(){return"name"},photoFieldName:function(){return"photoId"},showPhotoField:function(){var formFields=this.formFields;if(formFields){var photoField=formFields.find((function(field){return"photo"===field.name}));return!!photoField&&!photoField.hideField}return!1},showAvatar:function(){return!1},shouldHideApprovers:function(){return!1},modelDataClass:function(){return CustomModuleData/* CustomModuleData */.u}},watch:{id:{handler:function(){this.loadRecord(!0)},immediate:!0},moduleName:function(){this.loadRecord(!0)}},methods:{refreshData:function(){this.loadRecord(!0)},loadRecord:function(){var _arguments=arguments,_this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var force,moduleName,id;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return force=_arguments.length>0&&void 0!==_arguments[0]&&_arguments[0],_context.prev=1,moduleName=_this.moduleName,id=_this.id,_this.isLoading=!0,_context.next=6,_this.modelDataClass.fetch({moduleName:moduleName,id:id,force:force});case 6:return _this.record=_context.sent,_context.next=9,_this.getFormMeta();case 9:_context.next=14;break;case 11:_context.prev=11,_context.t0=_context["catch"](1),_this.$message.error((null===_context.t0||void 0===_context.t0?void 0:_context.t0.message)||_this.$t("custommodules.summary.record_summary_error"));case 14:_this.isLoading=!1;case 15:case"end":return _context.stop()}}),_callee,null,[[1,11]])})))()},editRecord:function(){var moduleName=this.moduleName,id=this.id;if((0,router/* isWebTabsEnabled */.tj)()){var _ref=(0,router/* findRouteForModule */.Jp)(moduleName,router/* pageTypes */.As.EDIT)||{},name=_ref.name;name&&this.$router.push({name:name,params:{id:id}})}else{var creationName="custommodules-edit";this.$router.push({name:creationName,params:{moduleName:moduleName,id:id}})}},getFormMeta:function(){var _this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var _this2$record,_this2$record2,formId,moduleName,url,_yield$API$get,data,error,formFields;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return _this2$record=_this2.record,_this2$record2=void 0===_this2$record?{}:_this2$record,formId=_this2$record2.formId,moduleName=_this2.moduleName,url="/v2/forms/".concat(moduleName),_context2.next=4,api/* API */.bl.get(url,{formId:formId||-1});case 4:_yield$API$get=_context2.sent,data=_yield$API$get.data,error=_yield$API$get.error,error||(formFields=(data.form||{}).fields,_this2.formFields=formFields);case 8:case"end":return _context2.stop()}}),_callee2)})))()},back:function(){this.$router.go(-1)}}},custom_module_CustomModuleSummaryvue_type_script_lang_js=CustomModuleSummaryvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(custom_module_CustomModuleSummaryvue_type_script_lang_js,render,staticRenderFns,!1,null,"2c44e6b2",null)
/* harmony default export */,CustomModuleSummary=component.exports},
/***/619257:
/***/function(module,__unused_webpack_exports,__webpack_require__){module.exports=__webpack_require__.p+"b0e8e9091860c5af0950a491c2268b7f.svg";
/***/},
/***/73188:
/***/function(module,__unused_webpack_exports,__webpack_require__){"use strict";module.exports=__webpack_require__.p+"img/item-img.7bf6d6bd.jpg"},
/***/494194:
/***/function(module,__unused_webpack_exports,__webpack_require__){"use strict";module.exports=__webpack_require__.p+"img/store-img.8acd997f.jpg"},
/***/392708:
/***/function(module,__unused_webpack_exports,__webpack_require__){"use strict";module.exports=__webpack_require__.p+"img/tool-img.a48b92e6.jpg"}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/12063.js.map