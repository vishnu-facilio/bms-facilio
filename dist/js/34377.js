"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[34377,10527],{
/***/405469:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return GaugeChart}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/GaugeChart.vue?vue&type=template&id=f235c9a6
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("div",{ref:"gauge",staticClass:"p10 gauge"})])},staticRenderFns=[],d3=(__webpack_require__(897389),__webpack_require__(879288),__webpack_require__(260228),__webpack_require__(947522),__webpack_require__(348727)),cardtooltip=__webpack_require__(960111),GaugeChartvue_type_script_lang_js={props:["widget","config","gaugeData"],mixins:[cardtooltip/* default */.Z],data:function(){return{type:"semidoughnut",id:100*Math.random().toFixed(2),configdata:{size:710,clipWidth:200,clipHeight:110,ringInset:20,ringWidth:20,pointerWidth:10,pointerTailLength:5,pointerHeadLengthPercent:.9,minValue:0,maxValue:10,minAngle:-90,maxAngle:90,transitionMs:750,majorTicks:5,labelFormat:d3.format("d"),labelInset:10,arcColorFn:d3.interpolateHsl(d3.rgb("#e8e2ca"),d3.rgb("#3e6c0a"))},data:{value:100,target:10,max:200,color:"#1ce6e5,#1ce6e5",centerText:[{label:"6174.20 kwh"},{label:"THIS MONTH"}]}}},watch:{gaugeData:{handler:function(newData,oldData){this.$refs["gauge"].innerHTML="";var self=this;setTimeout((function(){self.generate()}),400)},deep:!0}},mounted:function(){this.generate()},methods:{deg2rad:function(deg){return deg*Math.PI/180},generate:function(){var chartContext={};this.id=100*Math.random().toFixed(2),chartContext.id=this.id,chartContext.selecter=this.$refs["gauge"],chartContext.width=100,chartContext.height=100,chartContext.isMaxpointer=!1,chartContext.pointerColor=this.gaugeData.meta.pointerColor||"rgba(29, 25, 50, 0.85)",chartContext.unitTextSize=this.gaugeData.meta.unitTextSize?this.gaugeData.meta.unitTextSize:"0.4vw",chartContext.remainingTextSize=this.gaugeData.meta.remainingTextSize?this.gaugeData.meta.remainingTextSize:"0.5vw",this.gaugeData&&this.gaugeData.value&&this.gaugeData.value.needMax&&"usetarget"!==this.gaugeData.value.needMax&&(chartContext.isMaxpointer=!0),chartContext.svg=d3.select(chartContext.selecter).append("svg").attr("width","100%").attr("height","100%").attr("viewBox","0 0 "+Math.min(chartContext.width,chartContext.height)+" "+Math.min(chartContext.width,chartContext.height)).attr("preserveAspectRatio","xMinYMin").append("g"),chartContext.svg.attr("transform","translate("+Math.min(chartContext.width,chartContext.height)/2+","+Math.min(chartContext.width,chartContext.height)/2+") "),this.gaugeData.meta.color=this.gaugeData.meta.color||"#1ce6e5,#1ce6e5",chartContext.data=this.gaugeData,this.draw(chartContext)},centerTranslation:function(r){return"translate("+r+","+r+")"},draw:function(chartContext,newValue){var self=this,data=chartContext.data.meta||null,value=chartContext.data.value||null,config=this.configdata,percentage=data.targetValue&&data.baseValue?data.baseValue/data.targetValue:0,maxPointer=!1,maxPercentage=data.targetValue&&data.baseValue?data.baseValue/data.targetValue:0;percentage>1&&(maxPointer=!0,maxPercentage%=1);var t=Math.PI,width=100,height=100,outerRadius=Math.min(width,height)/2,innerRadius=outerRadius/5*3;chartContext.arc=d3.arc().innerRadius(innerRadius).outerRadius(outerRadius),chartContext.arc1=d3.arc().innerRadius(innerRadius).outerRadius(outerRadius),chartContext.targetArc=d3.arc().innerRadius(innerRadius).outerRadius(outerRadius);var svg=chartContext.svg;chartContext.defs=svg.append("defs"),chartContext.gradient=chartContext.defs.append("linearGradient").attr("id",(function(){return"svgGradient"+chartContext.id})).attr("x1","100%").attr("x2","0%").attr("y1","0%").attr("y2","100%"),chartContext.gradient.append("stop").attr("class","start").attr("offset","0%").attr("stop-color",(function(){return value&&value.startColor?value.startColor:"#1ce6e5"})).attr("stop-opacity",.2),chartContext.gradient.append("stop").attr("class","end").attr("offset","2000%").attr("stop-color",(function(){return value&&value.end?value.end:"#1ce6e5"})).attr("stop-opacity",1),percentage=percentage>1?1:percentage<-1?0:percentage;// to omit the -ve percentage
var unit=data.fieldObj&&data.fieldObj.unit?data.fieldObj.unit:null;svg.append("path").datum({startAngle:0,endAngle:t}).style("fill","#f1f3f4").attr("d",chartContext.arc).attr("class","arc").on("mouseover",(function(d){var tooltipdata=[{label:"Target",value:data.targetValue+" "+(unit||"")},{label:"Achieved",value:data.baseValue+" "+(unit||"")},{label:maxPointer?"Exceeded by":"Remaining",value:data?maxPointer?(Number(data.baseValue)-Number(data.targetValue)).toFixed(2)+" "+(unit||""):(Number(data.targetValue)-Number(data.baseValue)).toFixed(2)+" "+(unit||""):""}],tooltipConfig={title1:"",position:{left:d3.event.pageX,top:d3.event.pageY},data:tooltipdata};
// if (!self.$mobile) {
//   self.showTooltipForCard1(tooltipConfig, 'kpi-gauge-chart')
// }
self.showTooltipForCard1(tooltipConfig,"kpi-gauge-chart")})).on("mouseout",(function(d){self.hideTooltip("kpi-gauge-chart")})),data.colorPlates&&data.colorPlates.length?data.colorPlates.forEach((function(rt){rt.startAngle!==rt.endAngle&&rt.startAngle<percentage&&svg.append("path").datum({startAngle:rt.startAngle*t,endAngle:percentage>=rt.endAngle?rt.endAngle*t:percentage*t}).style("fill",(function(){return rt.color})).attr("d",chartContext.arc).attr("class","arc")})):chartContext.midground=svg.append("path").datum({startAngle:0,endAngle:(percentage||0)*t}).style("fill",(function(){return"url(#svgGradient"+chartContext.id+")"})).attr("d",chartContext.arc).attr("class","arc").on("mouseover",(function(d){var tooltipdata=[{label:"Target",value:data.targetValue+" "+(unit||"")},{label:"Achieved",value:data.baseValue+" "+(unit||"")},{label:maxPointer?"Exceeded by":"Remaining",value:maxPointer?(Number(data.baseValue)-Number(data.targetValue)).toFixed(2)+" "+(unit||""):(Number(data.targetValue)-Number(data.baseValue)).toFixed(2)+" "+(unit||"")}],tooltipConfig={title1:"",position:{left:d3.event.pageX,top:d3.event.pageY},data:tooltipdata};self.showTooltipForCard1(tooltipConfig,"kpi-gauge-chart")})).on("mouseout",(function(d){self.hideTooltip("kpi-gauge-chart")}));var arcTween=function(transition,newAngle){transition.attrTween("d",(function(d){}))};
// chartContext.midground
//   .transition()
//   .duration(1000)
//   .call(arcTween, percentage * t)
// max pointer
maxPointer&&(chartContext.midground1=svg.append("path").datum({startAngle:(maxPercentage-.005)*t,endAngle:maxPercentage*t}).style("fill","#000").attr("d",chartContext.arc1).attr("class","arc"),chartContext.midground1.transition().duration(1e3).call(arcTween,maxPercentage*t));
// draw pointer
this.centerTranslation(innerRadius);var range=config.maxAngle-config.minAngle,pointerHeadLength=Math.round(innerRadius*config.pointerHeadLengthPercent),lineData=[[config.pointerWidth/4,0],[0,-pointerHeadLength],[-config.pointerWidth/4,0],[0,0],[config.pointerWidth/4,0]],pointerLine=d3.line().curve(d3.curveLinear),pg=svg.append("g").data([lineData]).attr("class","pointer").attr("transform",0),pointer=pg.append("path").attr("d",pointerLine/*function(d) { return pointerLine(d) +'Z';}*/).attr("transform","rotate("+config.minAngle+")").attr("fill",chartContext.pointerColor);
// svg
//   .append('circle')
//   .attr('cx', 0)
//   .attr('cy', 0)
//   .attr('r', 5)
//   .attr('fill', '#fff')
//   .attr('transform', 'rotate(' + config.minAngle + ')')
// svg
//   .append('circle')
//   .attr('cx', 0)
//   .attr('cy', 0)
//   .attr('r', 4)
//   .attr('fill', 'rgb(102, 102, 102)')
//   .attr('transform', 'rotate(' + config.minAngle + ')')
svg.append("text").attr("text-anchor","middle").style("font-size",chartContext.remainingTextSize).attr("dy",25).attr("dx",0).style("letter-spacing","0.3px").text((function(){var value="Remaining : ";if(unit){var obj=self.$convert(Number(data.targetValue)-Number(data.baseValue)).from(unit).toBest(),ob=self.$convert(Number(data.baseValue)-Number(data.targetValue)).from(unit).toBest();value+=Number(obj.val).toFixed(2),maxPointer&&(value="Exceeded by : ",value+=Number(ob.val).toFixed(2)),data.fieldObj&&data.fieldObj.unit&&!maxPointer?value+=" "+obj.unit:maxPointer&&(value+=" "+ob.unit)}else value+=(Number(data.targetValue)-Number(data.baseValue)).toFixed(2),maxPointer&&(value="Exceeded by : ",value+=(Number(data.targetValue)-Number(data.baseValue)).toFixed(2));return value})).style("letter-spacing"," 0.3px").style("padding-top"," 5px").attr("class","gauge-center-period").attr("fill","#6d7278"),svg.append("text").attr("text-anchor","middle").style("font-size",chartContext.unitTextSize).attr("dy",10).attr("dx",-40).style("letter-spacing","0.3px").text((function(){return"0 "+(unit||"")})).style("letter-spacing"," 0.3px").style("padding-top"," 5px").attr("fill","#6d7278"),svg.append("text").attr("text-anchor","middle").style("font-size",chartContext.unitTextSize).attr("dy",10).attr("dx",unit?30:40).style("letter-spacing","0.3px").text((function(){if(unit){var obj=self.$convert(Number(data.baseValue)>Number(data.targetValue)?data.baseValue:data.targetValue).from(unit).toBest();return Number(obj.val).toFixed(2)+" "+obj.unit}return Number(data.baseValue)>Number(data.targetValue)?data.baseValue:data.targetValue})).style("letter-spacing"," 0.3px").style("padding-top"," 5px").attr("fill","#6d7278"),svg.append("line").attr("x1",-50).attr("y1",30).attr("x2",50).attr("y2",30).attr("stroke","#6d7278").attr("stroke-width","0.1").attr("fill","#f1f3f4");var _tooltip=svg.append("g").attr("class","target-meter-group");_tooltip.append("div").attr("class","target-meter-tooltip").style("background-color","#fff").text("test");var scale=d3.scaleLinear().range([0,1]).domain([config.minValue,config.maxValue]),ratio=scale(newValue);config.minAngle;pointer.transition().duration(config.transitionMs).ease(d3.easeLinear).attr("transform","rotate("+(180*(percentage||0)-90)+")")}}},components_GaugeChartvue_type_script_lang_js=GaugeChartvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_GaugeChartvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,GaugeChart=component.exports},
/***/734377:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return KPITargetMeter}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/dashboard/widget/cards/v2/KPITargetMeter.vue?vue&type=template&id=f30d7994
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"dragabale-card height100"},[_vm.loading?_c("shimmer-loading"):_c("div",{staticClass:"p10"},[_vm.data&&_vm.data.name?_c("div",{staticClass:"p10 target-meter-header"},[_vm._v(" "+_vm._s(_vm.data.name)+" ")]):_c("div",{staticClass:"p10 target-meter-header"},[_vm._v(" "+_vm._s(_vm.data.expressions&&_vm.data.expressions.length?_vm.data.expressions[0].actualName:"")+" ")]),_vm.loading?_vm._e():_c("gauge-chart",{attrs:{widget:_vm.widget,config:_vm.config,gaugeData:_vm.gaugeData,id:"widget"}})],1)],1)},staticRenderFns=[],DashboardFilters=(__webpack_require__(648324),__webpack_require__(169358),__webpack_require__(879288),__webpack_require__(506319)),DateHelper=__webpack_require__(281230),colors=__webpack_require__(519898),GaugeChart=__webpack_require__(405469),ShimmerLoading=__webpack_require__(516400),validation=__webpack_require__(990260),KPITargetMetervue_type_script_lang_js={props:["widget","config"],mixins:[DateHelper/* default */.Z,DashboardFilters/* default */.Z],data:function(){return{enable:{10227:10227,10228:10228,10229:10229,10230:10230,10231:10231,10232:10232,10233:10233,10234:10234,10235:10235},gaugeData:{meta:{baseValue:0,targetValue:0,color:"#1ce6e5,#ecb0c8"},value:{needMax:"usetarget"}},data:{style:{color:"red",bgcolor:"pink"},unitString:""},style:{bgcolor:"#fff",color:"#000"},result:null,domRerender:!0,predefineColors:colors/* default */.Z.readingcardColors,loading:!1}},mounted:function(){this.loadCardData()},components:{GaugeChart:GaugeChart/* default */.Z,shimmerLoading:ShimmerLoading/* default */.Z},computed:{mode:function(){return!(!this.$route.query||!this.$route.query.create||"edit"!==this.$route.query.create)||!(!this.$route.query||!this.$route.query.create||"new"!==this.$route.query.create)},getScale:function(){return this.$style.responsiveScale(200,200,1,this.currentWidth,this.currentHeight)},currentWidth:function(){return this.$el&&this.$el.clientWidth?this.$el.clientWidth:200},currentHeight:function(){return this.$el&&this.$el.clientHeight?this.$el.clientHeight:200},getStyle:function(){return"background:"+this.style.bgcolor+";color:"+this.style.color}},watch:{dashboardDateFilter:{handler:function(newData,oldData){newData&&this.refresh()}}},methods:{refresh:function(){this.updateCard()},loadCardData:function(){var self=this,params=null;this.widget&&this.widget.id>-1?(params={widgetId:self.widget.id},this.dashboardDateFilter&&(params.startTime=this.getDateFilterStartTime(),params.endTime=this.getDateFilterEndTime())):params={workflow:{expressions:this.widget.dataOptions.data&&this.widget.dataOptions.data.expressions?this.widget.dataOptions.data.expressions:[],workflowUIMode:1},staticKey:"kpiCard"},this.loading=!0,self.$http.post("dashboard/getCardData",params).then((function(response){self.getParams(),self.getData(response.data.cardResult),self.loading=!1})).catch((function(error){self.loading=!1}))},updateCard:function(){var self=this,params=null;params={workflow:{expressions:this.widget.dataOptions.data&&this.widget.dataOptions.data.expressions?this.widget.dataOptions.data.expressions:[],workflowUIMode:1},staticKey:"kpiCard"},this.loading=!0,self.getParams(),self.$http.post("dashboard/getCardData",params).then((function(response){self.getData(response.data.cardResult),self.loading=!1})).catch((function(error){self.loading=!1}))},setColor:function(mode,color){"bg"===mode?this.style.bgcolor=color:"color"===mode&&(this.style.color=color),this.domRerender=!1,this.domRerender=!0,this.setParams()},getParams:function(){this.widget.dataOptions.data?(this.widget.dataOptions.metaJson=JSON.stringify(this.widget.dataOptions.data),this.data=this.widget.dataOptions.data):this.widget.id>-1&&this.widget.dataOptions.metaJson&&(this.data=JSON.parse(this.widget.dataOptions.metaJson)),this.widget.hasOwnProperty("widgetVsWorkflowContexts")&&this.widget.widgetVsWorkflowContexts.length&&this.widget.widgetVsWorkflowContexts[0].workflow&&(this.data["v2Script"]=this.widget.widgetVsWorkflowContexts[0].workflow["v2Script"],this.data["workflowV2String"]=this.widget.widgetVsWorkflowContexts[0].workflow["workflowV2String"]),this.setParams()},setParams:function(){this.data&&!this.data.style?this.data.style={color:this.color,bgcolor:this.bgcolor}:this.style=this.data.style,this.widget.dataOptions.metaJson=JSON.stringify(this.data)},getData:function(data){data.hasOwnProperty("result")?(this.result=data,this.gaugeData=this.resultToGaugeData(data)):this.gaugeData={}},formatData:function(result){return!(0,validation/* isEmpty */.xb)(result)&&result.hasOwnProperty("result")?null!==result.result?result.result.value?Number(result.result.value):Number(result.result):0:result},getUnit:function(result){return result&&result.result&&result.result.unit?result.result.unit:""},resultToGaugeData:function(data){if(data)return{meta:{baseValue:this.formatData(data),targetValue:this.data.targetConstant||0,color:"#1ce6e5,#ecb0c8",fieldObj:this.data.fieldObj||{unit:this.getUnit(data)}},value:{needMax:"usetarget"}};this.gaugeData}}},v2_KPITargetMetervue_type_script_lang_js=KPITargetMetervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(v2_KPITargetMetervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,KPITargetMeter=component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/34377.js.map