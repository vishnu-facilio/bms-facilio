"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[74507,32686,80865,53021],{
/***/703117:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return AlarmModel}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/AlarmModel.vue?vue&type=template&id=5b251d32
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticStyle:{background:"#fff",width:"400px",height:"420px !important"}},[_vm._m(0),_c("div",{staticClass:"model-container",staticStyle:{background:"#fff"}},[_c("p",{staticClass:"fc-input-label-txt"},[_vm._v("Category")]),_c("el-select",{staticClass:"fc-input-full-border2 width100",model:{value:_vm.alarmRequest.category,callback:function($$v){_vm.$set(_vm.alarmRequest,"category",$$v)},expression:"alarmRequest.category"}},_vm._l(_vm.ticketcategory,(function(category){return _c("el-option",{key:category.id,attrs:{label:category.displayName,value:category.id}})})),1),_c("p",{staticClass:"fc-input-label-txt mT20"},[_vm._v("Team/Staff")]),_c("div",{staticStyle:{border:"1px solid #d8dce5",display:"inline-block",position:"relative",width:"100%",height:"40px","line-height":"40px","padding-left":"10px","padding-right":"10px","border-radius":"3px"}},[_c("span",[_vm._v(_vm._s(_vm.getTeamStaffLabel(_vm.alarmRequest)))]),_vm._m(1),_c("f-assignment",{attrs:{model:_vm.alarmRequest,viewtype:"form"}})],1),_c("p",{staticClass:"fc-input-label-txt mT20"},[_vm._v("Priority")]),_c("el-select",{staticClass:"fc-input-full-border2 width100",model:{value:_vm.alarmRequest.priority,callback:function($$v){_vm.$set(_vm.alarmRequest,"priority",$$v)},expression:"alarmRequest.priority"}},_vm._l(_vm.ticketpriority,(function(priority){return _c("el-option",{key:priority.priority,attrs:{label:priority.displayName,value:parseInt(priority.id)}})})),1),_c("p",{staticClass:"fc-input-label-txt mT20"},[_vm._v("Site")]),_c("el-select",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"fc-input-full-border2 width100",attrs:{filterable:"",clearable:"","collapse-tags":"",placeholder:"Sites"},model:{value:_vm.alarmRequest.siteId,callback:function($$v){_vm.$set(_vm.alarmRequest,"siteId",$$v)},expression:"alarmRequest.siteId"}},_vm._l(_vm.sites,(function(site,index){return _c("el-option",{key:index,attrs:{label:site.name,value:site.id}})})),1)],1),_c("div",{staticClass:"modal-dialog-footer",staticStyle:{background:"#fff"}},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:_vm.closeDialog}},[_vm._v("CANCEL")]),_c("el-button",{staticClass:"modal-btn-save",on:{click:function($event){return _vm.createWO()}}},[_vm._v("CREATE")])],1)])},staticRenderFns=[function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticStyle:{padding:"20px 20px 10px 20px"},attrs:{label:"Create Workorder"}},[_c("div",{staticClass:"setup-modal-title"},[_vm._v("Create workorder")])])},function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("span",{staticStyle:{float:"right"}},[_c("i",{staticClass:"el-icon-arrow-down",staticStyle:{position:"relative",top:"-4px",right:"3px",color:"#c0c4cc"}})])}],objectSpread2=__webpack_require__(595082),vuex_esm=__webpack_require__(420629),FAssignment=__webpack_require__(383274),TeamStaffMixin=__webpack_require__(462599),AlarmModelvue_type_script_lang_js={props:["id"],components:{FAssignment:FAssignment/* default */.Z},mixins:[TeamStaffMixin/* default */.Z],data:function(){return{alarmRequest:{category:null,assignedTo:{id:-1},assignmentGroup:{id:-1},siteId:null,priority:null}}},created:function(){this.$store.dispatch("loadTicketCategory"),this.$store.dispatch("loadTicketPriority"),this.$store.dispatch("loadGroups")},computed:(0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({users:function(state){return state.users},sites:function(state){return state.sites},ticketcategory:function(state){return state.ticketCategory},ticketpriority:function(state){return state.ticketPriority}})),methods:{createWO:function(event){this.$emit("submit",this.alarmRequest)},closeDialog:function(){this.reset(),this.$emit("closed")},reset:function(){this.alarmRequest={category:null,assignedTo:{id:-1},assignmentGroup:{id:-1},priority:null}}}},components_AlarmModelvue_type_script_lang_js=AlarmModelvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(components_AlarmModelvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,AlarmModel=component.exports},
/***/760218:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return PageBuilder}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/page/PageBuilder.vue?vue&type=template&id=0dd0982f
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.showPage&&_vm.pagebuilderComponent?_c(_vm.pagebuilderComponent,_vm._b({tag:"component",attrs:{module:_vm.module},on:{forceOldPage:function($event){_vm.forceOld=!0}}},"component",_vm.$attrs,!1)):_vm._e()},staticRenderFns=[],objectSpread2=__webpack_require__(595082),regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),vuex_esm=(__webpack_require__(260228),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(976801),__webpack_require__(843843),__webpack_require__(420629)),PageBuildervue_type_script_lang_js={props:["module"],data:function(){return{forceOld:!1,showPage:!1}},components:{NewPageBuilder:function(){return Promise.all(/* import() */[__webpack_require__.e(93208),__webpack_require__.e(50232),__webpack_require__.e(93765),__webpack_require__.e(95953),__webpack_require__.e(35309),__webpack_require__.e(18778),__webpack_require__.e(12303),__webpack_require__.e(84290),__webpack_require__.e(31721),__webpack_require__.e(64418),__webpack_require__.e(5603),__webpack_require__.e(57432),__webpack_require__.e(435),__webpack_require__.e(72230),__webpack_require__.e(94255),__webpack_require__.e(67683),__webpack_require__.e(44178),__webpack_require__.e(91132),__webpack_require__.e(20280),__webpack_require__.e(78256),__webpack_require__.e(22200),__webpack_require__.e(49081),__webpack_require__.e(89472),__webpack_require__.e(12085),__webpack_require__.e(55754),__webpack_require__.e(86494),__webpack_require__.e(3037),__webpack_require__.e(49908),__webpack_require__.e(22061),__webpack_require__.e(31602),__webpack_require__.e(73609),__webpack_require__.e(44119),__webpack_require__.e(88262),__webpack_require__.e(82080),__webpack_require__.e(88506)]).then(__webpack_require__.bind(__webpack_require__,110570))},OldPageBuilder:function(){return Promise.all(/* import() */[__webpack_require__.e(93208),__webpack_require__.e(50232),__webpack_require__.e(93765),__webpack_require__.e(95953),__webpack_require__.e(35309),__webpack_require__.e(18778),__webpack_require__.e(12303),__webpack_require__.e(84290),__webpack_require__.e(31721),__webpack_require__.e(64418),__webpack_require__.e(5603),__webpack_require__.e(57432),__webpack_require__.e(435),__webpack_require__.e(72230),__webpack_require__.e(94255),__webpack_require__.e(67683),__webpack_require__.e(44178),__webpack_require__.e(91132),__webpack_require__.e(20280),__webpack_require__.e(78256),__webpack_require__.e(22200),__webpack_require__.e(49081),__webpack_require__.e(89472),__webpack_require__.e(12085),__webpack_require__.e(55754),__webpack_require__.e(86494),__webpack_require__.e(3037),__webpack_require__.e(49908),__webpack_require__.e(22061),__webpack_require__.e(31602),__webpack_require__.e(73609),__webpack_require__.e(23803),__webpack_require__.e(55246)]).then(__webpack_require__.bind(__webpack_require__,223803))}},created:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:if(_context.prev=0,!_this.$helpers.isLicenseEnabled("PAGE_BUILDER")){_context.next=4;break}return _context.next=4,_this.$store.dispatch("pagebuilder/loadNewPageEnabledModules");case 4:_context.next=8;break;case 6:_context.prev=6,_context.t0=_context["catch"](0);case 8:_this.$nextTick((function(){_this.showPage=!0}));case 9:case"end":return _context.stop()}}),_callee,null,[[0,6]])})))()},computed:(0,objectSpread2/* default */.Z)((0,objectSpread2/* default */.Z)({},(0,vuex_esm/* mapState */.rn)({newPageEnabledModules:function(state){return state.pagebuilder.newPageEnabledModules}})),{},{pagebuilderComponent:function(){var newPageEnabledModules=this.newPageEnabledModules,module=this.module,forceOld=this.forceOld,isNew=(newPageEnabledModules||[]).includes(module),showNew=!forceOld&&(this.showNewPageBuilder||isNew);return showNew?"NewPageBuilder":"OldPageBuilder"},showNewPageBuilder:function(){var query=this.$route.query,_query$showNewPageBui=query.showNewPageBuilder,showNewPageBuilder=void 0!==_query$showNewPageBui&&_query$showNewPageBui;return!0===showNewPageBuilder||"true"===showNewPageBuilder}})},page_PageBuildervue_type_script_lang_js=PageBuildervue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(page_PageBuildervue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,PageBuilder=component.exports},
/***/520973:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return BmsAlarmSummary}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/pages/firealarm/alarms/alarms/v3/BmsAlarmSummary.vue?vue&type=template&id=773b719e&scoped=true
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"main-div fc-v1-alarm-overview"},[_vm.alarmOverviewLoading?_c("div",{staticClass:"flex-middle fc-empty-white"},[_c("spinner",{attrs:{show:_vm.alarmOverviewLoading,size:"80"}})],1):[_c("div",{staticClass:"\n      fc__layout__align fc__asset__main__header\n      pT20\n      pB20\n      pL20\n      pR20\n      position-relative\n      summary-basic\n    "},[_vm.currentAlarm?_c("div",[_c("div",{staticClass:"wos-id",attrs:{title:_vm.$t("common.header.back")}},[_c("span",{staticClass:"fc-id"},[_vm._v("#"+_vm._s(_vm.currentAlarm.id))])]),_c("div",{staticClass:"fc-black-22 fw3 flex-middle"},[_c("div",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"top",animation:"shift-away",arrow:!0},expression:"{\n              placement: 'top',\n              animation: 'shift-away',\n              arrow: true,\n            }"}],staticClass:"max-width550px fw4 flex-middle",attrs:{title:_vm.currentAlarm.subject}},[_c("div",{staticClass:"fc-black-22 textoverflow-ellipsis"},[_vm._v(" "+_vm._s(_vm.currentAlarm.subject)+" ")]),_vm.currentAlarm.severity?_c("div",{staticClass:"flex-middle mT10 pL10"},[_c("div",{staticClass:"uppercase secondary-color summaryseverityTag f11",style:{"background-color":_vm.getAlarmColor(_vm.currentAlarm)}},[_vm._v(" "+_vm._s(_vm.getAlarmDisplayName(_vm.currentAlarm))+" ")])]):_vm._e()])])]):_vm._e(),_c("div",{staticClass:"display-flex mR10"},[_c("div",{staticClass:"display-flex mR5"},[_c("CustomButton",{staticClass:"pR10",attrs:{record:_vm.currentAlarm,moduleName:_vm.moduleName,position:_vm.POSITION.SUMMARY},on:{refresh:function($event){return _vm.refreshData()},onError:function(){}}})],1),_vm.canAcknowledge&&_vm.$hasPermission("bmsalarm:ACKNOWLEDGE_ALARM")?_c("el-button",{staticClass:"fc-btn-green-lg-fill",on:{click:_vm.acknowledgeAlarms}},[_vm._v(_vm._s(_vm.$t("common.header.acknowledge")))]):_vm.isActiveAlarm(_vm.currentAlarm)||_vm.$getProperty(_vm.currentAlarm,"acknowledged")?_vm._e():_c("div",{staticClass:"q-item-label fc-summary-ack status-btn1 pR10 pointer"},[_vm._v(" "+_vm._s(_vm.$t("common.header.unacknowledged"))+" ")]),"sensorrollupalarm"!==_vm.currentModuleName?_c("div",{staticClass:"flRight fc-el-button mL10"},[_vm.isActiveAlarm(_vm.currentAlarm)&&_vm.$hasPermission("bmsalarm:CLEAR_ALARM")?_c("el-button",{staticClass:"fc-btn-green-lg-border",attrs:{disabled:_vm.buttonStatus},on:{click:function($event){return _vm.updateAlarmStatus(_vm.currentAlarm)}}},[_vm._v(_vm._s(_vm.$t("common.header._clear")))]):_vm._e()],1):_vm._e(),_vm.alarmOverviewLoading?_vm._e():_c("div",{staticClass:"flex-middle z-10 alarm-timer"},[_c("div",{staticClass:"fc-black-12"},[_vm._v(_vm._s(_vm.$t("common._common.duration"))+":")]),_vm.isAlarmClear?_c("timer",{staticClass:"fc-red-new bold f14 p10 alarm-timer-duration",attrs:{time:_vm.occurrence.createdTime,twoDigits:!0,title:_vm._f("formatDate")(_vm.occurrence.createdTime)}}):_c("timer",{staticClass:"fc-red-new bold f14 p10 alarm-cleared-duration",attrs:{time:_vm.duration,staticTime:!0,twoDigits:!0,title:_vm.durationDate}})],1),_c("el-dropdown",{staticClass:"mL10 fc-btn-ico-lg pointer",attrs:{trigger:"click"},on:{command:function($event){return _vm.handleDropDown($event)}},scopedSlots:_vm._u([{key:"dropdown",fn:function(){return[_c("el-dropdown-menu",{attrs:{slot:"dropdown",trigger:"click"},slot:"dropdown"},[_vm.isActiveAlarm(_vm.currentAlarm)&&_vm.$hasPermission("bmsalarm:CREATE_WORKORDER")?_c("el-dropdown-item",{attrs:{command:"createWo"}},[_vm.isWoCreated()?_c("div",[_vm._v(" "+_vm._s(_vm.$t("common._common.view_workorder"))+" ")]):_c("div",[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.create_workorder"))+" ")])]):_vm._e(),_vm.$hasPermission("bmsalarm:EXPORT")?_c("div",[_c("el-dropdown-item",{attrs:{command:"exportCSV"}},[_vm.isActiveAlarm(_vm.currentAlarm)?_c("div",[_vm._v(" "+_vm._s(_vm.$t("alarm.alarm.export_csv"))+" ")]):_vm._e()]),_c("el-dropdown-item",{attrs:{command:"exportExcel"}},[_vm.isActiveAlarm(_vm.currentAlarm)?_c("div",[_vm._v(" "+_vm._s(_vm.$t("alarm.alarm.export_excel"))+" ")]):_vm._e()])],1):_vm._e()],1)]},proxy:!0}])},[_c("span",{staticClass:"el-dropdown-link"},[_c("fc-icon",{attrs:{group:"action",name:"options-vertical",color:"rgb(0 0 0)"}})],1)])],1)]),_c("page",{attrs:{module:_vm.currentModuleName,id:_vm.id,details:_vm.detailsForPageBuilder,notesModuleName:_vm.notesModuleName,primaryFields:_vm.primaryFields}}),_vm.exportDownloadUrl?_c("iframe",{staticStyle:{display:"none"},attrs:{src:_vm.exportDownloadUrl}}):_vm._e(),_c("el-dialog",{attrs:{visible:_vm.dialogVisible,width:"32%","custom-class":"dialog"},on:{"update:visible":function($event){_vm.dialogVisible=$event}}},[_c("AlarmModel",{ref:"confirmWoModel",on:{submit:_vm.createWO,closed:_vm.closeWoDialog}})],1),_vm.showAssetExport?_c("el-dialog",{attrs:{visible:_vm.showAssetExport,width:"30%"},on:{"update:visible":function($event){_vm.showAssetExport=$event}}},[_c("BMSAlarmsExportDialog",{attrs:{assetFields:_vm.assetFields},on:{submit:_vm.exportEvent,closed:_vm.closeExportDialog}})],1):_vm._e()]],2)},staticRenderFns=[],regeneratorRuntime=__webpack_require__(150124),asyncToGenerator=__webpack_require__(548534),api=(__webpack_require__(260228),__webpack_require__(821694),__webpack_require__(76265),__webpack_require__(32284)),PageBuilder=__webpack_require__(760218),NewAlarmMixin=__webpack_require__(230255),Timer=__webpack_require__(114857),validation=__webpack_require__(990260),AlarmModel=__webpack_require__(703117),BMSAlarmsExportDialogvue_type_template_id_7f42195e_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("div",{staticClass:"new-header-container"},[_c("div",{staticClass:"new-header-text"},[_c("div",{staticClass:"fc-setup-modal-title"},[_vm._v(" "+_vm._s(_vm.$t("common.wo_report.export_alarm_summary"))+" ")])])]),_c("div",{staticClass:"export-body-dailog"},[_c("div",[_c("el-checkbox",{staticStyle:{"padding-bottom":"10px","padding-left":"40px","padding-top":"10px"},attrs:{checked:"",disabled:""}},[_vm._v(_vm._s(_vm.$t("common.events.all_events")))])],1),_c("el-checkbox-group",{staticClass:"check-padding-remove",model:{value:_vm.selectedFields,callback:function($$v){_vm.selectedFields=$$v},expression:"selectedFields"}},[_c("div",{staticClass:"row"},_vm._l(_vm.assetFields,(function(field){return _c("el-checkbox",{key:field.id,staticClass:"check-width",attrs:{label:field.id}},[_vm._v(_vm._s(field?field.displayName:""))])})),1)])],1),_c("div",{staticClass:"modal-dialog-footer"},[_c("el-button",{staticClass:"modal-btn-cancel",on:{click:function($event){return _vm.closeExportDialog()}}},[_vm._v(_vm._s(_vm.$t("common._common.cancel")))]),_c("el-button",{staticClass:"modal-btn-save",attrs:{type:"primary"},on:{click:function($event){return _vm.submitExportDialogue()}}},[_vm._v(_vm._s(_vm.$t("common.wo_report.export_data")))])],1)])},BMSAlarmsExportDialogvue_type_template_id_7f42195e_scoped_true_staticRenderFns=[],BMSAlarmsExportDialogvue_type_script_lang_js={props:["assetFields"],data:function(){return{selectedFields:[]}},methods:{submitExportDialogue:function(){this.$emit("submit",this.selectedFields)},closeExportDialog:function(){this.$emit("close")}}},v1_BMSAlarmsExportDialogvue_type_script_lang_js=BMSAlarmsExportDialogvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(v1_BMSAlarmsExportDialogvue_type_script_lang_js,BMSAlarmsExportDialogvue_type_template_id_7f42195e_scoped_true_render,BMSAlarmsExportDialogvue_type_template_id_7f42195e_scoped_true_staticRenderFns,!1,null,"7f42195e",null)
/* harmony default export */,BMSAlarmsExportDialog=component.exports,CustomButton=__webpack_require__(623857),CustomButtonUtil=__webpack_require__(746095),BmsAlarmSummaryvue_type_script_lang_js={props:["viewname","moduleName"],name:"BmsAlarmsSummary",mixins:[NewAlarmMixin/* default */.Z],components:{Page:PageBuilder/* default */.Z,Timer:Timer/* default */.Z,AlarmModel:AlarmModel/* default */.Z,BMSAlarmsExportDialog:BMSAlarmsExportDialog,CustomButton:CustomButton/* default */.Z},created:function(){this.init()},data:function(){return{assetFields:[],selectedFields:[],exportType:null,currentModuleName:this.moduleName,currentAlarm:null,primaryFields:["description","source","condition","lastOccurredTime","lastOccurredTimeString"],alarmOverviewLoading:!1,buttonStatus:!1,showAssetExport:!1,exportDownloadUrl:null,notesModuleName:"basealarmnotes",POSITION:CustomButtonUtil/* POSITION_TYPE */.Rz}},computed:{id:function(){var paramId=this.$attrs.id||this.$route.params.id;return(0,validation/* isEmpty */.xb)(paramId)?"":parseInt(this.$route.params.id)},alarm:function(){return this.currentAlarm},clearedTime:function(){return this.$getProperty(this,"occurrence.clearedTime")},createdTime:function(){return this.$getProperty(this,"occurrence.createdTime")},isAlarmClear:function(){return this.occurrence&&this.createdTime&&(0,validation/* isEmpty */.xb)(this.clearedTime)},duration:function(){return this.clearedTime-this.createdTime},durationDate:function(){return this.$options.filters.formatDate(this.duration)},detailsForPageBuilder:function(){return{alarm:this.currentAlarm,occurrence:this.occurrence,id:this.$getProperty(this.currentAlarm,"id")}},canAcknowledge:function(){var currentAlarm=this.currentAlarm;return!this.$getProperty(currentAlarm,"acknowledged")&&this.isActiveAlarm(currentAlarm)&&this.$hasPermission("alarm:ACKNOWLEDGE_ALARM")}},watch:{id:{handler:function(){this.loadRecords()}// immediate: true,
},occurrence:function(){var currentAlarmId=this.$getProperty(this,"currentAlarm.id");this.getOccurrenceFromId(currentAlarmId),this.getEventsFromId(currentAlarmId)}},methods:{init:function(){var _this=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee(){var currentAlarmId;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.next=2,_this.loadRecords();case 2:return currentAlarmId=_this.$getProperty(_this,"currentAlarm.id"),_context.next=5,Promise.all([_this.getOccurrenceFromId(currentAlarmId),_this.getEventsFromId(currentAlarmId)]);case 5:case"end":return _context.stop()}}),_callee)})))()},loadRecords:function(){var _arguments=arguments,_this2=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee2(){var force,currentModuleName,_yield$API$fetchRecor,bmsalarm,error,_yield$API$fetchRecor2,alarmoccurrence;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context2){while(1)switch(_context2.prev=_context2.next){case 0:return force=!(_arguments.length>0&&void 0!==_arguments[0])||_arguments[0],_this2.alarmOverviewLoading=!0,currentModuleName=_this2.currentModuleName,_context2.next=5,api/* API */.bl.fetchRecord(currentModuleName,{id:_this2.id},{force:force});case 5:if(_yield$API$fetchRecor=_context2.sent,bmsalarm=_yield$API$fetchRecor.bmsalarm,error=_yield$API$fetchRecor.error,!error){_context2.next=12;break}_this2.$message.error(error.message),_context2.next=20;break;case 12:return _this2.currentAlarm=bmsalarm,_context2.next=15,_this2.loadSpaceDetails();case 15:return _context2.next=17,api/* API */.bl.fetchRecord("alarmoccurrence",{id:_this2.$getProperty(bmsalarm,"lastOccurrenceId")},{force:force});case 17:_yield$API$fetchRecor2=_context2.sent,alarmoccurrence=_yield$API$fetchRecor2.alarmoccurrence,_this2.occurrence=alarmoccurrence;case 20:_this2.alarmOverviewLoading=!1;case 21:case"end":return _context2.stop()}}),_callee2)})))()},loadSpaceDetails:function(){var _this3=this;return(0,asyncToGenerator/* default */.Z)((0,regeneratorRuntime/* default */.Z)().mark((function _callee3(){var currentAlarm,_ref,resource,_ref2,spaceId,buildingId,siteId,locationId,url,_yield$API$get,data,error;return(0,regeneratorRuntime/* default */.Z)().wrap((function(_context3){while(1)switch(_context3.prev=_context3.next){case 0:if(currentAlarm=_this3.currentAlarm,_ref=currentAlarm||{},resource=_ref.resource,(0,validation/* isEmpty */.xb)(resource)){_context3.next=13;break}if(_ref2=resource||{},spaceId=_ref2.spaceId,buildingId=_ref2.buildingId,siteId=_ref2.siteId,locationId=spaceId>0?spaceId:buildingId>0?buildingId:siteId,!(locationId>0)){_context3.next=13;break}return url="v2/basespaces/".concat(spaceId),_context3.next=9,api/* API */.bl.get(url);case 9:_yield$API$get=_context3.sent,data=_yield$API$get.data,error=_yield$API$get.error,(0,validation/* isEmpty */.xb)(error)?_this3.currentAlarm["spaceDetails"]=_this3.$getProperty(data,"basespace"):_this3.$message.error(error.message);case 13:case"end":return _context3.stop()}}),_callee3)})))()},refreshData:function(){this.loadRecords(!0)},goBack:function(){window.history.go(-1)},closeExportDialog:function(){this.showAssetExport=!1,this.selectedFields=[]},exportSummary:function(type){var _this4=this;this.exportType=type,this.showAssetExport=!0,this.$util.loadAssetReadingFields(this.$getProperty(this,"alarm.resource.id")).then((function(fields){_this4.assetFields=fields}))},isWoCreated:function(){var woId=this.$getProperty(this,"alarm.lastWoId");return!(0,validation/* isEmpty */.xb)(woId)&&woId>0},handleDropDown:function(command){var woId=this.$getProperty(this,"alarm.lastWoId");"createWo"===command?woId>0?this.openWorkorder(woId):this.createWoDialog(this.$getProperty(this,"currentAlarm.lastOccurrenceId")):"exportCSV"===command?this.exportSummary(1):this.exportSummary(2)}}},v3_BmsAlarmSummaryvue_type_script_lang_js=BmsAlarmSummaryvue_type_script_lang_js,BmsAlarmSummary_component=(0,componentNormalizer/* default */.Z)(v3_BmsAlarmSummaryvue_type_script_lang_js,render,staticRenderFns,!1,null,"773b719e",null)
/* harmony default export */,BmsAlarmSummary=BmsAlarmSummary_component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/74507.js.map