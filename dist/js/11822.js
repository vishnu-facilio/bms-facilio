"use strict";(self["webpackChunkfacilio_web"]=self["webpackChunkfacilio_web"]||[]).push([[11822],{
/***/381056:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return AnomalyMixin}});
// EXTERNAL MODULE: ./node_modules/core-js/modules/es.object.to-string.js
__webpack_require__(260228),__webpack_require__(670560);
// EXTERNAL MODULE: ./node_modules/core-js/modules/es.array.push.js
var render,staticRenderFns,moment_timezone=__webpack_require__(480008),moment_timezone_default=__webpack_require__.n(moment_timezone),NewDateHelper=__webpack_require__(105534),AnomalyMixinvue_type_script_lang_js={computed:{lastMonth:function(){return moment_timezone_default()().tz(this.$timezone).subtract(1,"months").format("MMMM")},currentMonth:function(){return moment_timezone_default()().tz(this.$timezone).startOf("month").format("MMMM")},isMetricsApiLoading:function(){return this.$store.state.anomalies.isLoading},currMntNLastMntRanges:function(){var thisMonthdateRange=NewDateHelper/* default */.Z.getDatePickerObject(28,this.$timezone),lastMonthDateRange=NewDateHelper/* default */.Z.getDatePickerObject(27,this.$timezone),dateRanges={};return dateRanges.startTime=lastMonthDateRange.value[0],dateRanges.endTime=thisMonthdateRange.value[1],dateRanges}},methods:{loadEnrgyByCdd:function(resourcesIds){return this.$util.getWorkFlowResult(49,[resourcesIds,this.details.alarm.resource.siteId])},loadEnergyWastage:function(resourceIds){return this.$util.getWorkFlowResult(99,[resourceIds,this.details.alarm.id])},loadAnomaliesCount:function(resourceIds,isRCA){return this.$util.getWorkFlowResult(100,[resourceIds,this.details.alarm.id,isRCA||!1])},loadDeviation:function(resourceIds){return this.$util.getWorkFlowResult(46,[resourceIds,this.details.alarm.id])},loadMetrics:function(resourceId,alarmId,siteId,dateRange,rca){var _this=this,url="/v2/mlAnomalyAlarm/metrics",paramJson={};return paramJson.alarmId=alarmId,paramJson.resourceId=resourceId,paramJson.siteId=siteId,null!=dateRange&&(paramJson.dateRange=dateRange),rca&&(paramJson.rca=rca),this.loading=!0,new Promise((function(resolve,reject){_this.$http.post(url,paramJson).then((function(response){resolve(response.data.result.metrics)})).catch((function(error){reject(error)}))}))},loadMeanMetrics:function(){var workflowID,_this2=this;workflowID="readingalarm"===this.moduleName?8:"newreadingalarm"===this.moduleName?108:"agentAlarm"===this.moduleName||"operationalarm"===this.moduleName?11:47;
// if (!this.details.metricsPromise) {
var params=[this.details.alarm.id];"newreadingalarm"===this.moduleName&&params.push(this.cardId);var promise=this.$util.getWorkFlowResult(workflowID,params).finally((function(_){_this2.$set(_this2.details,"metricsPromise",null)}));
// }
return this.$set(this.details,"metricsPromise",promise),this.details.metricsPromise}}},mixins_AnomalyMixinvue_type_script_lang_js=AnomalyMixinvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(mixins_AnomalyMixinvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,AnomalyMixin=component.exports},
/***/811822:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__),
// EXPORTS
__webpack_require__.d(__webpack_exports__,{default:function(){/* binding */return AnomalyMTBAWidget}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/page/widget/anomalies/AnomalyMTBAWidget.vue?vue&type=template&id=350dff1d
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("metrics-widget",{attrs:{details:_vm.details,isMttc:!1,moduleName:_vm.moduleName,title:"Mean Time Between Occurrences",cardId:"3"}})},staticRenderFns=[],AnomalyMeanMetricWidget=__webpack_require__(408886),AnomalyMTBAWidgetvue_type_script_lang_js={components:{MetricsWidget:AnomalyMeanMetricWidget/* default */.Z},props:["details","layoutParams","hideTitleSection","activeTab","moduleName","widget","resizeWidget","eventBus"]},anomalies_AnomalyMTBAWidgetvue_type_script_lang_js=AnomalyMTBAWidgetvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(anomalies_AnomalyMTBAWidgetvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,AnomalyMTBAWidget=component.exports},
/***/408886:
/***/function(__unused_webpack_module,__webpack_exports__,__webpack_require__){
// EXPORTS
__webpack_require__.d(__webpack_exports__,{Z:function(){/* binding */return AnomalyMeanMetricWidget}});// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules/.cache/vue-loader","cacheIdentifier":"5f5f0a0c-vue-loader-template"}!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/components/page/widget/anomalies/AnomalyMeanMetricWidget.vue?vue&type=template&id=09f8a665
var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"p30 pT30 d-flex flex-direction-column ml-mean-metric-card"},[_vm.loading?_c("spinner",{attrs:{show:_vm.loading}}):[_c("div",{staticClass:"f12 bold text-uppercase mB10 fc-black-13 text-left letter-spacing1"},[_vm._v(" "+_vm._s(_vm.title)+" ")]),_c("div",{staticClass:"d-flex pT20"},[_c("div",{staticClass:"items-baseline width50 pR8"},[_c("div",{staticClass:"flex-middle"},[_vm._l(_vm.stats.thisMonthData,(function(value,key,index){return[_c("div",{key:key,staticClass:"f18 bold",class:{pL8:index>0}},[_vm._v(" "+_vm._s(value)+" "),_c("span",{staticClass:"pL2 f12 fw4"},[_vm._v(_vm._s(key))])])]}))],2),_c("div",{staticClass:"secondary-text pT5"},[_vm._v(" "+_vm._s(_vm.$t("common.date_picker.this_month"))+" ")])]),_c("div",{staticClass:"items-baseline width50 pL15 border-left2"},[_c("div",{staticClass:"flex-middle"},[_vm._l(_vm.stats.lastMonthData,(function(value,key,index){return[_c("div",{key:key,staticClass:"f18 bold",class:{pL8:index>0}},[_vm._v(" "+_vm._s(value)+" "),_c("span",{staticClass:"pL2 f12 fw4"},[_vm._v(_vm._s(key))])])]}))],2),_c("div",{staticClass:"letter-spacing0_5 fc-blue-label f12 text-capitalize pT5"},[_vm._v(" Last Month ")])])])]],2)},staticRenderFns=[],slicedToArray=__webpack_require__(554621),AnomalyMixin=(__webpack_require__(260228),__webpack_require__(336585),__webpack_require__(381056)),validation=__webpack_require__(990260),AnomalyMeanMetricWidgetvue_type_script_lang_js={props:["isMttc","title","details","moduleName","cardId"],mixins:[AnomalyMixin/* default */.Z],data:function(){return{metrics:{},loading:!1}},watch:{details:{handler:function(value,oldValue){var id=value.id,_ref=oldValue||{},_ref$id=_ref.id,oldId=void 0===_ref$id?null:_ref$id;id!==oldId&&this.loadData()},immediate:!0}},mounted:function(){
// this.loadData()
},computed:{stats:function(){var _this=this;return(0,validation/* isEmpty */.xb)(this.metrics)?{thisMonthData:{Hrs:0},lastMonthData:{Hrs:0}}:Object.entries(this.metrics).reduce((function(result,_ref2){var _ref3=(0,slicedToArray/* default */.Z)(_ref2,2),key=_ref3[0],value=_ref3[1];return result[key]=_this.$helpers.getDuration(value,"seconds"),result}),{})}},methods:{loadData:function(){var _this2=this;this.details&&this.details.alarm&&(this.loading=!0,this.loadMeanMetrics().then((function(response){response&&(_this2.isMttc?_this2.metrics={thisMonthData:response.mttc,lastMonthData:response.mttcLastMonth}:_this2.metrics={thisMonthData:response.mtba,lastMonthData:response.mtbaLastMonth}),_this2.loading=!1})).catch((function(){_this2.loading=!1})))}}},anomalies_AnomalyMeanMetricWidgetvue_type_script_lang_js=AnomalyMeanMetricWidgetvue_type_script_lang_js,componentNormalizer=__webpack_require__(801001),component=(0,componentNormalizer/* default */.Z)(anomalies_AnomalyMeanMetricWidgetvue_type_script_lang_js,render,staticRenderFns,!1,null,null,null)
/* harmony default export */,AnomalyMeanMetricWidget=component.exports}}]);
//# sourceMappingURL=http://localhost:5050/sourcemaps/js/11822.js.map